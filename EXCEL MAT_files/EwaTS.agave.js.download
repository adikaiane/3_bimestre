'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[13],{1005:function(y,r,a){a.d(r,"a",function(){return c});y=a(0);class c{constructor(b,f,k,x){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=b;this.controlId=f;this.ddaBinding=k;this.ArrayData=void 0===x?null:x}getDispid(){return this.dispid}getDdaBinding(){return this.ddaBinding}}Object(y.a)(c,"DdaEventArgs",null,[])},1052:function(y,r,a){a.d(r,"a",function(){return b});y=a(0);
class c{constructor(){this.title=this.id=this.tabs=null}}Object(y.a)(c,"AddInDataTransferObject",null,[]);class b{constructor(f,k,x){this.tbc=f;this.pih=k;this.qih=x}get px(){return this.tbc}get Tzh(){return this.pih}get Uzh(){return this.qih}static EOb(f){return(f=f.q3)?Object.assign(new c,{tabs:f.px.toArray(),id:f.Tzh,title:f.Uzh}):null}}Object(y.a)(b,"OneLineRibbonExtensibility",null,[])},1073:function(y,r,a){a.d(r,"a",function(){return c});y=a(0);var c;(function(b){b[b.OK=0]="OK";b[b.Tyl=1]="notReady";
b[b.CAl=2]="storeDisabled";b[b.zsl=3]="invokeFailure";b[b.iAl=4]="serviceDisabled";b[b.Gql=5]="builtinAddinDetails"})(c||(c={}));Object(y.b)("AddinDetailsQueryError",c)},1074:function(y,r,a){function c(w,z){var E=document.getElementById(w);E?z?E.innerHTML=z:E.remove():z&&(E=document.createElement("style"),E.id=w,E.type="text/css",E.innerHTML=z,document.head.appendChild(E))}function b(w,z){w=w.map(E=>{var M;E=l.q+E;return`[data-icon-name=${E}]::after {
      content: "";
      position: absolute;
      top: 9px;
      right: 18px;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background-color: ${null!==(M=null===z||void 0===z?void 0:z.palette.red)&&void 0!==M?M:"#CC4A31"};
      }
      @media screen and (-ms-high-contrast: active) {
        [data-icon-name=${E}]::after {
          border: WindowText 1px solid;
        }
      }
      `}).join("");c("RedDotNotification",w)}function f(w,z){w=w.map(E=>{var M,G,A;E=l.q+E;return`[data-icon-name=${E}]::after {
        content: "New";
        position: absolute;
        top: 6px;
        right: 10px;
        width: 30px;
        height: 16px;
        border-radius: 50%/100%;
        border: 1px solid;
        border-color: ${null!==(M=null===z||void 0===z?void 0:z.palette.dOa)&&void 0!==M?M:"white"};
        background-color: ${null!==(G=null===z||void 0===z?void 0:z.palette.SAl)&&void 0!==G?G:"#0078D4"};
        color: ${null!==(A=null===z||void 0===z?void 0:z.palette.dOa)&&void 0!==A?A:"white"};
        font-size: 10px;
        font-style: normal;
    }
      @media screen and (-ms-high-contrast: active) {
        [data-icon-name=${E}]::after {
          border-color: WindowText;
          color: WindowText;
        }
      }`}).join("");c("NewStringNotification",w)}function k(w){c(w,'[id="Ribbon-InsertAddInFlyoutDropdown"] div[class^="header-"] {padding: 20px 18px 0px}\n            [id="InsertAddInFlyoutMenuId"] div[class^="header-"] {padding: 20px 18px 0px}\n            [id="Ribbon-InsertAddInFlyoutDropdown"] div[class^="container-"] {padding-top: 0px}\n            [id="InsertAddInFlyoutMenuId"] div[class^="container-"] {padding-top: 0px}\n            [id="Ribbon-InsertAddInFlyoutDropdown"] div[class^="container-"] {min-height: 350px}\n            [id="InsertAddInFlyoutMenuId"] div[class^="container-"] {min-height: 350px}')}
async function x(w){try{let z;for(let L=0;10>L;++L)(z=document.getElementById("fluent-default-layer-host"))||await new Promise(J=>window.setTimeout(J,1E3));if(!z)throw Error("Cannot find the flyout container.");let E=!1,M=performance.now(),G;const A=L=>{const J=performance.now();L?(E=!0,w(!0,0),M=J):E&&(E=!1,w(!1,J-M))},N=L=>{G&&G.disconnect();const J=L.querySelector('[id="InsertAddInFlyoutMenuId"]');J?(G=new MutationObserver(B=>{for(const Y of B)"attributes"===Y.type&&Y.target instanceof HTMLElement&&
("InsertAddInFlyoutMenuId"!==Y.target.id?A(!1):A(!0))}),G.observe(J,{attributes:!0,attributeFilter:["id"]}),A(!0)):(G=new MutationObserver(B=>{for(const Y of B)"attributes"===Y.type&&Y.target instanceof HTMLElement&&("hidden"===Y.target.style.visibility?A(!1):A(!0))}),G.observe(L,{attributes:!0,attributeFilter:["style"]}),"hidden"!==L.style.visibility&&A(!0))},K=new WeakSet,I=new MutationObserver(L=>{for(const B of L){for(L=0;L<B.addedNodes.length;++L){var J=B.addedNodes.item(L);J instanceof HTMLElement&&
(J.querySelector(`[id="${l.c}"]`)||J.querySelector(`[id="${l.d}"]`))&&(N(J.querySelector(".ms-Callout-container")),K.add(J))}for(L=0;L<B.removedNodes.length;++L)J=B.removedNodes.item(L),K.has(J)&&(K.delete(J),A(!1))}});I.observe(z,{attributes:!1,childList:!0});return{dispose:()=>{I.disconnect();null===G||void 0===G?void 0:G.disconnect()}}}catch(z){return e.ULS.sendTraceTag(507799683,220,15,"Failed to listen flyout open close event: "+((null===z||void 0===z?void 0:z.toString())||void 0)),{dispose:()=>
{}}}}function d(w,z){const E=[];z=new t.a(z);for(var M=0;M<l.u;M++)Array.add(E,z.next(w.count));z=0;for(const G of w){M=!1;for(const A of E)if(z===A){M=!0;break}z++;if(M){let A;(A=G.addinInfo).AUP=20*A.AUP}else if(1===G.addinInfo.priority){let A;(A=G.addinInfo).AUP=4*A.AUP}else if(2===G.addinInfo.priority){let A;(A=G.addinInfo).AUP=2*A.AUP}}w.Sc((G,A)=>G.addinInfo.AUP<A.addinInfo.AUP?1:-1);return w}function h(w){return Telemetry.PrivacyRules.GetPrivacyCompliantId(w.solutionId,w.storeType,w.assetId,
null,null,w.storeId)}function n(w,z){return Object.assign(new w,z)}function m(w,z,E){return`<a href="${z}" target="${void 0===E?"_blank":E}" >${w}</a>`}function u(){const w=document.getElementById(l.c);w&&(w.style.border="transparent",w.addEventListener("focus",()=>{const z=document.getElementById("AddinDialogControlSearchBox");z&&z.focus()},{once:!0}))}a.d(r,"d",function(){return c});a.d(r,"f",function(){return b});a.d(r,"e",function(){return f});a.d(r,"a",function(){return k});a.d(r,"h",function(){return x});
a.d(r,"i",function(){return d});a.d(r,"b",function(){return h});a.d(r,"j",function(){return n});a.d(r,"g",function(){return m});a.d(r,"c",function(){return u});var l=a(1075),t=a(1292),e=a(15)},1075:function(y,r,a){a.d(r,"q",function(){return"AddinFlyoutControl"});a.d(r,"u",function(){return 30});a.d(r,"e",function(){return"AddinGalleryButton"});a.d(r,"f",function(){return"Add"});a.d(r,"k",function(){return"ReloadAddInPicker"});a.d(r,"l",function(){return"ReloadCitationAddInPicker"});a.d(r,"p",function(){return"StoreDisabled"});
a.d(r,"i",function(){return"Common"});a.d(r,"j",function(){return"NoSearchResults"});a.d(r,"n",function(){return"GPT"});a.d(r,"o",function(){return 100});a.d(r,"t",function(){return"https://aka.ms/Officeaddins"});a.d(r,"r",function(){return"https://aka.ms/OfficeAddinOverview"});a.d(r,"v",function(){return"https://appsource.microsoft.com/en-us/product/office/"});a.d(r,"m",function(){return"SearchAddinInFlyout"});a.d(r,"c",function(){return"Ribbon-InsertAddInFlyoutDropdown"});a.d(r,"d",function(){return"InsertAddInFlyoutMenuId"});
a.d(r,"h",function(){return"citation"});a.d(r,"g",function(){return 50});a.d(r,"s",function(){return 3});a.d(r,"b",function(){return b});a.d(r,"a",function(){return f});var c=a(24);const b=()=>({["APIC"]:Object(c.a)("AddInCategoryTitleAddingPicturesIconsAndCharts"),["APID"]:Object(c.a)("AddInCategoryTitleAddingPicturesIconsAndDiagrams"),["BBM"]:Object(c.a)("AddInCategoryTitleBuildByMicrosoft"),["CAIP"]:Object(c.a)("AddInCategoryTitleDesigningAnInteractivePresentation"),["DA"]:Object(c.a)("AddInCategoryTitleDataSyncAndAnalysis"),
["DWT"]:Object(c.a)("AddInCategoryTitleDesigningWithTemplates"),["ER"]:Object(c.a)("AddInCategoryTitleEducationalPurpose"),["FA"]:Object(c.a)("AddInCategoryTitleFinancialAnalytics"),["IPWAI"]:Object(c.a)("AddInCategoryTitleImprovingProductivityWithAI"),["TD"]:Object(c.a)("AddInCategoryTitleTrendingAddins"),["WN"]:Object(c.a)("AddInCategoryTitleNewAddins"),["WF"]:Object(c.a)("AddInCategoryTitleWritingFluently"),["PAIYO"]:Object(c.a)("AddInCategoryTitlePopularAddinsInYourOrg"),["CE"]:"Copilot Extensions",
default:Object(c.a)("PopularAddins")}),f=()=>({["Word"]:{["APID"]:Object(c.a)("AddInCategoryDescriptionAddingPicturesIconsDiagramsWord")||"Add photos, icons, and diagrams to your documents.",["ER"]:Object(c.a)("AddInCategoryDescriptionEducationalResources")||"Resources for educators and students.",["IPWAI"]:Object(c.a)("AddInCategoryDescriptionImprovingProductivityWithAIWord")||"Draft and summarize with the power of generative AI.",["WF"]:Object(c.a)("AddInCategoryDescriptionWritingFluently")||"Get help with spelling, grammar, and more."},
["Excel"]:{["APID"]:Object(c.a)("AddInCategoryDescriptionAddingPicturesIconsDiagramsExcel")||"Add photos, icons, and diagrams to spreadsheets.",["DA"]:Object(c.a)("AddInCategoryDescriptionDataAnalytics")||"Get key insights about the data in your speadsheets",["IPWAI"]:Object(c.a)("AddInCategoryDescriptionImprovingProductivityWithAIExcel")||"Use the power of AI to capture and understand your data.",["FA"]:Object(c.a)("AddInCategoryDescriptionFinancialAnalytics")||"Track expenses, budget, and more."},
["PowerPoint"]:{["IPWAI"]:Object(c.a)("AddInCategoryDescriptionImprovingProductivityWithAIPowerPoint")||"Use the power of AI in your presentations.",["APID"]:Object(c.a)("AddInCategoryDescriptionAddingPicturesIconsDiagramsPowerPoint")||"Add photos, icons, and diagrams to slides.",["CAIP"]:Object(c.a)("AddInCategoryDescriptionCreatingAnInteractivePresentation")||"Add polls, timers, and more.",["DWT"]:Object(c.a)("AddInCategoryDescriptionDesigningWithTemplates")||"Create beautiful slides with templates you can customize."},
oAl:{["BBM"]:Object(c.a)("AddInCategoryDescriptionBuildByMicrosoft")||"Create surveys, visualize data, and more, all from Microsoft.",["TD"]:Object(c.a)("AddInCategoryDescriptionTrending")||"Recently added by others.",["WN"]:Object(c.a)("AddInCategoryDescriptionWhatsNew")||"Brand new or updated add ins.",["PAIYO"]:Object(c.a)("AddInCategoryDescriptionPopularAddinsInYourOrg")||"Add ins people add and use the most in your organization."}})},1076:function(y,r,a){a.d(r,"a",function(){return c});a.d(r,
"b",function(){return b});const c=f=>{let k=null;switch(f){case 0:k="omex";break;case 1:k="spcatalog";break;case 2:k="spapp";break;case 3:k="filesystem";break;case 4:k="exchange";break;case 6:k="registry";break;case 7:k="inmemory";break;case 8:k="uploadfiledevcatalog";break;case 9:k="hardcodedpreinstall";break;case 10:k="excatalog";break;case 16:k="wopicatalog"}return k},b=f=>{let k=-1;switch(f.toLowerCase()){case "omex":k=0;break;case "spcatalog":k=1;break;case "spapp":k=2;break;case "filesystem":k=
3;break;case "exchange":k=4;break;case "registry":k=6;break;case "inmemory":k=7;break;case "uploadfiledevcatalog":k=8;break;case "hardcodedpreinstall":k=9;break;case "excatalog":k=10;break;case "wopicatalog":k=16}return k}},1077:function(y,r,a){a.d(r,"a",function(){return f});var c=a(6),b=a(64);const f=(k,x)=>b.a.s2d(66,()=>window.OfficeExtension&&!!window.OfficeExtension.WacRuntime,c.AFrameworkApplication.ea.Rd("MaxRetriesForLoadingScript",0),k,x)},1143:function(y,r,a){r=a(490);a=a(1511);a=a.Di?
a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);r(a,{insert:"head",Oj:!1});y.exports=a.Fk||{}},1146:function(y,r,a){a.d(r,"a",function(){return c});y=a(0);var c;(function(b){b[b.sOj=0]="myAddins";b[b.JHh=1]="adminManaged";b[b.zzl=2]="popular"})(c||(c={}));Object(y.b)("AddinCollectionType",c)},1147:function(y,r,a){a.d(r,"a",function(){return b});y=a(0);var c=a(13);class b{constructor(){this.pzf={["tabhome"]:"Ribbon.Home",["tabinsert"]:"Ribbon.Insert",["tabdata"]:"Ribbon.Data",["tabreview"]:"Ribbon.Review",
["tabview"]:"Ribbon.View"};this.nzf={["tabpagelayoutexcel"]:["Ribbon.PageLayoutExcel",c.a.instance.ia(1633),c.a.instance.ia(1637)],["tabformulas"]:["Ribbon.Formulas",c.a.instance.ia(1634),c.a.instance.ia(1638)],["tabdeveloper"]:["Ribbon.Developer",c.a.instance.ia(1635),c.a.instance.ia(1639)],["tabaddins"]:["Ribbon.AddIns",c.a.instance.ia(1636),c.a.instance.ia(1640)]};this.rwc=null}get Gra(){return"SourceControlId"}get kI(){return"Workbook"}get formFactor(){return"DesktopFormFactor"}hVi(){if(!this.rwc){this.rwc=
{};for(const f of Object.keys(this.pzf))this.rwc[f]=this.pzf[f];for(const f of Object.keys(this.nzf))this.rwc[f]=this.nzf[f][0]}}}Object(y.a)(b,"AddinCommandsStringProvider",null,[366])},1148:function(y,r,a){a.d(r,"a",function(){return c});y=a(0);class c{constructor(){this.MYa=0;this.fra=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.dDc=!1;this.xVf=this.fsa=null}}Object(y.a)(c,"AddInCommandsNotificationParameters",null,[])},1149:function(y,r,a){a.d(r,"a",function(){return c});
const c=b=>b.ra.Tb(34)},1196:function(y,r,a){a.d(r,"a",function(){return J});y=a(0);var c=a(19),b=a(1290),f=a(15),k=a(141),x=a(165),d=a(16),h=a(488),n=a(24);class m extends Sys.UI.Control{constructor(B,Y,U,O){super(document.createElement("div"));this.o_=this.m_=this.qA=this.VOa=this.uM=this.kAa=this.KBa=null;this.FAb=this.YAa=!1;this.content=this.Gs=null;this.z$=0;this.Z9e=null;this.w0=0;this.Ysg=null;this.mT=()=>{this.dismiss();return!0};this.HZe=B;this.JUe=Y;this.DW=U;this.LD=O;this.jh=Y.ownerDocument;
this.JCc=this.ov=this.ZAb=!1}get t3(){this.KBa||(this.KBa=this.jh.createElement("div"),this.KBa.id=this.qj("WACCalloutOuter"),this.KBa.className="WACCalloutOuter",this.KBa.setAttribute(h.a.Ae,h.a.OSa),this.KBa.style.width=this.z$+"px");return this.KBa}get hHb(){if(!this.kAa){this.kAa=this.jh.createElement("div");this.kAa.id=this.qj("WACCalloutBeakContainer");this.kAa.className="WACCalloutBeakContainer";var B="CalloutBeakTopFilled_32x16x32";if(5===this.w0||6===this.w0||4===this.w0)B="CalloutBeakBottomFilled_32x16x32";
B=x.a(32,16,B,"WACCalloutBeak",!0,"");this.kAa.appendChild(B)}return this.kAa}set hHb(B){this.kAa=B}get IZa(){return this.ZAb}get title(){return this.Gs}set title(B){this.Gs!==B&&(this.Gs=B,this.m_&&(this.m_.innerText=this.Gs))}get ov(){return this.YAa}set ov(B){this.YAa!==B&&(this.YAa=B,this.uM&&(this.uM.contains(this.qA)&&!this.YAa?this.uM.removeChild(this.qA):!this.uM.contains(this.qA)&&this.YAa&&this.e2e()))}get JCc(){return this.FAb}set JCc(B){this.FAb!==B&&(this.FAb=B,this.uM&&(this.uM.contains(this.m_)&&
!this.FAb?this.uM.removeChild(this.m_):!this.uM.contains(this.m_)&&this.FAb&&this.x3e()))}show(){this.ZAb||(this.n7h(),this.Co(),this.JUe.appendChild(this.t3),this.t3.style.display="Block",this.RMk(),this.ZAb=!0,this.Ysg&&this.Ysg())}dismiss(){this.ZAb&&(this.Sba(),this.JUe.removeChild(this.t3),this.ZAb=!1,this.LD&&this.LD())}dispose(){this.dismiss();this.m_=this.qA=this.VOa=this.kAa=this.uM=this.KBa=null;Sys.Component.prototype.dispose.call(this)}qj(B){return this.get_element().id+B}n7h(){this.uM=
this.jh.createElement("div");this.uM.id=this.qj("WACCalloutHeader");this.uM.className="WACCalloutHeader";this.ov&&this.e2e();this.JCc&&this.x3e();this.VOa=this.jh.createElement("div");this.VOa.id=this.qj("WACCalloutContent");this.VOa.className="WACCalloutContent";this.VOa.style.width=190<this.z$?this.z$-26+"px":"164px";this.VOa.appendChild(this.content);this.t3.appendChild(this.hHb);this.t3.appendChild(this.uM);this.t3.appendChild(this.VOa)}e2e(){this.qA=this.jh.createElement("a");this.qA.className=
"WACCalloutCloseAnchor";this.qA.id=this.qj("WACCalloutCloseAnchor");this.qA.href="#";this.uM.appendChild(this.qA);const B=x.a(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,Object(n.a)("DialogClose"));this.qA.appendChild(B)}x3e(){this.m_=this.jh.createElement("div");this.m_.className="WACCalloutTitle UIFontBold";this.m_.style.width=190<this.z$?this.z$-30+"px":"160px";this.m_.id=this.qj("WACCalloutTitle");this.m_.innerText=this.title;this.uM.contains(this.qA)?this.uM.insertBefore(this.m_,
this.qA):this.uM.appendChild(this.m_)}RMk(){var B=this.HZe;let Y;if(1===this.w0){var U=this.Z9e.y+16;Y=-16}else 2===this.w0||3===this.w0||0===this.w0?(U=B.y+B.height+15,Y=-15):(U=B.y-this.t3.clientHeight-15-2,Y=this.t3.clientHeight-1);this.t3.style.top=U+"px";this.hHb.style.top=Y+"px";1===this.w0?(B=this.Z9e.x-16,this.t3.style.left="50%",this.t3.style.marginLeft=-this.z$/2+"px",U=Sys.UI.DomElement.getBounds(this.t3),this.hHb.style.left=B-U.x+"px"):(U=B.x+this.HZe.width/2,2===this.w0||5===this.w0?
(B=20,U-=36):0===this.w0||4===this.w0?(B=this.z$/2-16,U-=this.z$/2):(B=this.z$-20-32,U=U-this.z$+36),this.t3.style.left=U+"px",this.hHb.style.left=B+"px")}Co(){this.ov&&!this.o_&&(this.o_=this.mT,this.DW.va(d.a.click,this.qA,this.o_,null))}Sba(){this.ov&&this.o_&&(this.DW.Ua(d.a.click,this.qA,this.o_),this.o_=null)}}Object(y.a)(m,"Callout",Sys.UI.Control,[211]);class u extends m{constructor(B,Y,U,O,C,X){super(B,U,C.E4,void 0===X?null:X);this.NSe=0;this.Hd=()=>{this.dismiss();return!0};this.z$=this.pVi(O);
this.$ab=Y;this.dh=C;this.p5k=7;this.yn=this.$ab.ownerDocument.createElement("div");this.yn.className="ModalCalloutControlOverlay";this.yn.tabIndex=0;this.$ab.insertBefore(this.yn,this.$ab.firstChild)}show(){this.IZa||(this.dh.tRc(),this.dh.cX(!1),this.yn.style.zIndex=String(this.dh.Faa),super.show(),this.Aj(),this.NSe=window.setTimeout(Object(k.a)(this,this.dismiss,"dismiss"),1E3*this.p5k))}dismiss(){this.IZa&&(this.dh.yT(!1),this.Bi(),this.$ab&&this.$ab.contains(this.yn)&&this.$ab.removeChild(this.yn),
super.dismiss(),window.clearTimeout(this.NSe))}Aj(){this.dh.PCa(Object(k.a)(this,this.dismiss,"dismiss"));this.dh.JE.va(d.a.click,this.yn,this.Hd)}Bi(){this.dh.ksb(Object(k.a)(this,this.dismiss,"dismiss"));this.dh.JE.Ua(d.a.click,this.yn,this.Hd)}pVi(B){let Y=0;switch(B){case 0:Y=190;break;case 1:Y=250;break;case 2:Y=300;break;case 3:Y=360}return Y}}Object(y.a)(u,"ModalCallout",m,[]);var l=a(539),t=a(179);class e extends u{constructor(B,Y,U,O,C,X){super(B,Y,U,O,C,void 0===X?null:X);this.tgc=null}show(){if(!this.IZa){const B=
Object.assign(new l.a,{onShow:()=>{u.prototype.show.call(this)}});t.a.QF().then(Y=>{const U=Y.externalNotification();this.tgc=Y.addNotification(U,B);return null},Y=>{f.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",Y);return null})}}dismiss(){this.IZa&&this.tgc&&(t.a.QF().then(B=>{B.removeNotification(this.tgc);return this.tgc=null},B=>{f.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",B);return null}),super.dismiss())}}Object(y.a)(e,"ReactManagedModalCallout",
u,[]);var w=a(6);class z{static d9h(B,Y,U){var O=void 0===O?null:O;return w.AFrameworkApplication.ua.Ab.vU?new e(B,Y,U,3,w.AFrameworkApplication.ua,O):new u(B,Y,U,3,w.AFrameworkApplication.ua,O)}}Object(y.a)(z,"ModalCalloutControlFactory",null,[]);var E=a(1144),M=a(691),G=a(1145),A=a(190),N=a(69),K=a(55),I=a(1052),L=a(932);class J{static get Fcb(){return J.j5||(J.j5=Object(c.f)(b.a))}static vjf(B,Y,U,O){J.lP&&J.lP.IZa&&J.lP.dismiss();J.lP=z.d9h(Y,B,B);J.lP.content=U;L.b(O)||(J.lP.title=O,J.lP.JCc=
!0);B=new Sys.UI.Bounds(0,0,N.a.OQb(),N.a.NQb());J.lP.w0=J.ALi(B,Y,J.lP.z$);J.lP.show();J.Fcb&&J.Fcb.cya(U.innerText,!0)}static Ayd(B,Y,U,O){O=void 0===O?null:O;t.a.QF().then(C=>{let X=null;J.XCb&&(C.removeNotification(J.XCb),J.XCb=null);const S=C.callout(Object.assign(new E.a,{target:B,title:Y,content:U,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new G.a,{onDismiss:()=>{C.removeNotification(X)},directionalHint:null!=O?O:null})})),ea=Object.assign(new l.a,
{expirationOptions:Object.assign(new M.a,{displayTimeoutSeconds:7,onExpire:()=>{C.removeNotification(J.XCb)}})});X=J.XCb=C.addNotification(S,ea);return null},C=>{f.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",C);return null})}static Ese(B,Y){Y=void 0===Y?null:Y;J.lP&&J.lP.IZa&&J.lP.dismiss();const U=new A.a;U.NMa=!1;U.hc=0;U.JG(27,Object(n.a)("DialogError"),L.b(B)?J.PHf():B,Y)}static Fse(B){J.lP&&J.lP.IZa&&J.lP.dismiss();f.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",
B.errorCode));const Y=L.b(B.description)?J.PHf():B.description,U=new A.a;let O=null;B.fra?(U.hc=1,U.Ic(1,B.buttonText),U.hfa(1)):U.hc=0;O=C=>{1===C?B.fra():B.fsa&&B.fsa()};U.NMa=!1;0===B.MYa?U.JG(B.errorCode,B.title?B.title:Object(n.a)("DialogError"),Y,O):1===B.MYa?U.XR(B.title?B.title:Object(n.a)("DialogWarning"),Y,O):U.Cya(B.title?B.title:Object(n.a)("DialogInfo"),Y,O)}static ALi(B,Y,U){let O=4;const C=B.x+B.width-Y.x-Y.width;Y.x-B.x+Y.width/2<=U/2?O=5:C+Y.width/2<=U/2&&(O=6);return O}static rUk(B,
Y,U,O){O=void 0===O?!1:O;(Y=I.a.EOb(Y))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Y,C=>{C&&(O||J.Ayd(C,U,B,5))})}static sUk(B,Y,U){U=void 0===U?!1:U;J.rUk(Y.startedNode?Y.startedNode.description:String.format(Object(n.a)("NewAddInLoadedContent"),B),Y,Y.startedNode?Y.startedNode.title:String.format(Object(n.a)("NewAddInLoadedTitle"),B),U)}static qUk(B,Y,U,O){if(J.I9g)B=String.format(Object(n.a)("ErrorLoadingAddInsContentOuterString"),
String.format(Object(n.a)("ErrorLoadingAddInsContentInnerString"),U,O,Object(n.a)("InsertionDialogRefresh"))),J.Ayd(Y,Object(n.a)("ErrorLoadingAddInsTitle"),B,1);else{Y=K.a.pp(Y);var C=Object(n.a)("ErrorLoadingAddInsContentOuterString").split("{0}"),X=document.createElement("span");X.innerText=C[0];var S=document.createElement("span");S.innerText=String.format(Object(n.a)("ErrorLoadingAddInsContentInnerString"),U,O,Object(n.a)("InsertionDialogRefresh"));S.className="UIFontBold";U=document.createElement("span");
U.innerText=C[1];O=document.createElement("div");Sys.UI.DomElement.addCssClass(O,"ModalCalloutControl");O.appendChild(X);O.appendChild(S);O.appendChild(U);J.vjf(B,Y,O,Object(n.a)("ErrorLoadingAddInsTitle"))}}static $Vk(B,Y,U,O){J.I9g?J.Ayd(Y,U,O):(Y=K.a.pp(Y),J.vjf(B,Y,J.WRh(O),U))}static WRh(B){const Y=document.createElement("div");Sys.UI.DomElement.addCssClass(Y,"ModalCalloutControl");Y.innerText=B;return Y}static PHf(){return Object(n.a)("InternalError")+" "+Object(n.a)("InternalError_Directive")}static get I9g(){return w.AFrameworkApplication.ua.Ab.$k&&
w.AFrameworkApplication.ua.Ab.vU}}J.lP=null;J.XCb=null;J.j5=null;Object(y.a)(J,"AddInCommandsNotificationFactory",null,[])},1201:function(y,r,a){a.r(r);a.d(r,"DynamicRibbon",function(){return l});y=a(0);var c=a(15),b=a(126),f=a(948),k=a(966),x=a(130);class d{constructor(t,e,w,z){this.$o=!1;this._id=t;this.OB=e;this.N$=w;this.Vd=z}get enabled(){return this.$o}set enabled(t){const {DynamicRibbon:e}=a(1201);var w=this.Vd.OwnerAddinStoreType?this.Vd.OwnerAddinStoreType:this.Vd.PrimaryMarketplace.MarketplaceType;
const z=this.Vd.PrimaryMarketplace.MarketplaceRef,E=this.Vd.AssetMarketplace?this.Vd.AssetMarketplace.SolutionId:null,M=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.OB,w,null,null,null,z);w={["addinSolutionId"]:M,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Vd.OwnerAddinSolutionId,w,E,null,null,z),["ownerAddinStoreType"]:w,["ribbonControlType"]:"Button",["toggle"]:t};x.a.otc(e.D0c+"ControlUpdate",b.a.Eh(w));this.$o=t;this.N$.yQ(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:1,
["SolutionId"]:this.OB,["PrivacyCompliantSolutionId"]:M,["SourceControlId"]:this.id,["MethodData"]:this.$o})}get id(){return this._id}get label(){return null}setEnabled(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonButton"}invokePropertyGet(t){switch(t){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);}invokePropertyGetAsync(t){t=this.invokePropertyGet(t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)}invokePropertySet(t,
e){switch(t){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(e,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);}invokePropertySetAsync(t,e){this.invokePropertySet(t,e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(t,e){switch(t){case 5:return this.xJk(e);case 1:return this.pOa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);}invokeMethodAsync(t,e){t=this.invokeMethod(t,
e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)}xJk(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");this.setEnabled(t);return null}pOa(){this._OnAccess();return null}}Object(y.a)(d,"RibbonButton",null,[]);class h{constructor(t,e,w,z){this._id=t;this.OB=e;this.N$=w;this.Vd=z}get id(){return this._id}setVisibility(t){const {DynamicRibbon:e}=a(1201),w=this.Vd.OwnerAddinStoreType?this.Vd.OwnerAddinStoreType:this.Vd.PrimaryMarketplace.MarketplaceType;
var z=this.Vd.PrimaryMarketplace.MarketplaceRef;const E=this.Vd.AssetMarketplace?this.Vd.AssetMarketplace.SolutionId:null,M=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.OB,w,E,null,null,z);z={["addinSolutionId"]:M,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Vd.OwnerAddinSolutionId,w,E,null,null,z),["ownerAddinStoreType"]:w,["ribbonControlType"]:"Tab",["toggle"]:t};x.a.otc(e.D0c+"ControlUpdate",b.a.Eh(z));this.N$.yQ(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:2,
["SolutionId"]:this.OB,["PrivacyCompliantSolutionId"]:M,["StoreType"]:w,["SourceControlId"]:this.id,["MethodData"]:t})}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonTab"}invokePropertyGet(t){switch(t){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);}invokePropertyGetAsync(t){t=this.invokePropertyGet(t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)}invokePropertySet(t){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);
}invokePropertySetAsync(t,e){this.invokePropertySet(t,e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(t,e){switch(t){case 3:return this.BNk(e);case 1:return this.pOa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);}invokeMethodAsync(t,e){t=this.invokeMethod(t,e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)}BNk(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");this.setVisibility(t);
return null}pOa(){this._OnAccess();return null}}Object(y.a)(h,"RibbonTab",null,[]);var n=a(1308),m=a(1678),u;(function(t){t[t.static=0]="static";t[t.dynamic=1]="dynamic"})(u||(u={}));Object(y.b)("RibbonExtensionGenerateType",u);class l{constructor(t,e,w,z,E){this.OB=t;this.Fu=w;this.N$=z;this.Vd=E;this.vAa=this.Fu.Cf;this.pD=this.vAa.getOsfControl(e);this.Iqh=this.pD.getManifest()}get buttons(){return null}executeRequestCreate(t){try{var e=this.Vd.OwnerAddinStoreType?this.Vd.OwnerAddinStoreType:this.Vd.PrimaryMarketplace.MarketplaceType;
const z=this.Vd.PrimaryMarketplace.MarketplaceRef,E=this.Vd.AssetMarketplace?this.Vd.AssetMarketplace.SolutionId:null;var w=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.OB,e,E,null,null,z);const M={["addinSolutionId"]:w,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Vd.OwnerAddinSolutionId,e,E,null,null,z),["ownerAddinStoreType"]:this.Vd.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};x.a.otc(l.D0c+"ExecuteRequestCreate",b.a.Eh(M));const G=x.a.Xj(t);t={};e={};
e[f.a.uVa]=this.pD;e[f.a.vVa]=G;e[f.a.QCd]=this.Vd;t[f.a.pMb]=3;t[f.a.$ba]=this.OB;t[f.a.Huc]=w;t[f.a.Zba]=e;this.N$.yQ(-1014260128,t);let A=l.tyc("ExecuteRequestCreate",!0,"");c.ULS.sendTraceTag(538572826,0,50,A)}catch(z){w=l.tyc("ExecuteRequestCreate",!1,z.toString()),c.ULS.sendTraceTag(538572825,0,50,w)}return null}executeRequestUpdate(t){try{var e=this.Vd.OwnerAddinStoreType?this.Vd.OwnerAddinStoreType:this.Vd.PrimaryMarketplace.MarketplaceType;const z=this.Vd.PrimaryMarketplace.MarketplaceRef,
E=this.Vd.AssetMarketplace?this.Vd.AssetMarketplace.SolutionId:null;var w=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.OB,e,E,null,null,z);const M={["addinSolutionId"]:w,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Vd.OwnerAddinSolutionId,e,E,null,null,z),["ownerAddinStoreType"]:this.Vd.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};x.a.otc(l.D0c+"ExecuteRequestCreate",b.a.Eh(M));const G=x.a.Xj(t);t={};e={};e[f.a.uVa]=this.pD;e[f.a.vVa]=G;e[f.a.QCd]=this.Vd;
t[f.a.pMb]=3;t[f.a.$ba]=this.OB;t[f.a.Huc]=w;t[f.a.Zba]=e;this.N$.yQ(-1014260128,t);let A=l.tyc("ExecuteRequestUpdate",!0,"");c.ULS.sendTraceTag(538572824,0,50,A)}catch(z){w=l.tyc("ExecuteRequestUpdate",!1,z.toString()),c.ULS.sendTraceTag(538572823,0,50,w)}return null}getButton(t){let e=null;if(!this.F_f())return this.yjf();if(t&&0<t.length){if(!this.nef(t))return this.Qjf(t);e=new d(t,this.OB,this.N$,this.Vd)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}getTab(t){let e=null;
if(!this.F_f())return this.yjf();if(this.pD.getOwnerAddinControlRecreated())return this.m8h();if(t&&0<t.length){if(!this.nef(t))return this.Qjf(t);e=new h(t,this.OB,this.N$,this.Vd)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(e)}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.DynamicRibbon"}invokePropertyGet(t){switch(t){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);}invokePropertyGetAsync(t){t=this.invokePropertyGet(t);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)}invokePropertySet(t){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);}invokePropertySetAsync(t,e){this.invokePropertySet(t,e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(t){switch(t){case 1:return this.pOa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);}invokeMethodAsync(t,e){switch(t){case 7:return this.iyi(e);case 6:return this.jyi(e);case 3:return this.dLi(e);
case 5:return this.q2i(e)}t=this.invokeMethod(t,e);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)}iyi(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return this.executeRequestCreate(t)}jyi(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return this.executeRequestUpdate(t)}dLi(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return this.getButton(t)}q2i(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,
0,"string");return this.getTab(t)}pOa(){this._OnAccess();return null}Qjf(t){return n.a(k.a.y3h,x.a.ia(1771)+t)}yjf(){return n.a(k.a.yAk,x.a.ia(1767))}m8h(){return n.a(k.a.hostRestartNeeded,x.a.ia(1772))}F_f(){var t=this.pD.getSharedRuntimeId();t=!!t&&0<t.length;c.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",t));return t}nef(t){const e=this.Iqh.getRibbonExtensionControlMap();return t in e||this.yXh(t)}yXh(t){var e=this.GBi();if(e){e=e.xrf;
for(const w of e.tabs){if(w.id===t)return!0;for(const z of w.groups)for(const E of z.controls){if(E.id===t)return!0;if("Menu"===E.type){e=E;for(const M of e.items)if(M.id===t)return!0}}}}return!1}GBi(){return m.a.getInstance().Qsa(this.Vd.PrimaryMarketplace.MarketplaceType,this.Vd.PrimaryMarketplace.SolutionId,u.dynamic)}static tyc(t,e,w){const z={};z.methodName="DynamicRibbon."+t;z.result=e?"Succeeded":"Failed";z.message=w;return x.a.Nc(z)}}l.D0c="Office.Online.Extensibility.Ribbon.";Object(y.a)(l,
"DynamicRibbon",null,[])},1291:function(y,r,a){function c(h){if(!d){var n=f.AFrameworkApplication.ea.getStringFeatureGate("Microsoft.Office.SharedOnline.AddinTitleIdMappingOverride","");n=n.trim();if(0==n.length)var m={};else{m={};n=n.split("|");for(const u of n){const [l,t]=u.split(";");m[l.toLowerCase()]=t}}Object.assign({},x,m);d=!0}m=x;if(h&&h.toLowerCase()in m)return m[h.toLowerCase()];b.ULS.sendTraceTag(507261966,220,50,"{0}",`getAddinTitleIdMapping: solutionId not found in mapping. Returning the input solutionId ${h}.`);
return h}a.d(r,"a",function(){return k});a.d(r,"b",function(){return c});var b=a(15),f=a(6);const k="wa200004080 wa200003113 wa200001679 wa104382005 wa200002488 wa200000764 wa200002140 wa104381626 16f285ab-9176-4270-94d3-acf051b9258d c9a2c994-a5c5-4323-8b65-739d3f9cca4f 1651c735-2dc7-4bc1-b83c-093b3a311c12 1a2cd312-8f5d-4019-89b2-250d082e3648 aca50012-71e5-4bcd-bec4-49d548e20ab1 d31e002e-6b41-4ef8-80d9-be7fb1a33e45".split(" "),x={["wa200004080"]:"4b00bbbb-d524-419c-bb3b-9f42aee17424",["wa104381626"]:"c738b607-88dd-4f16-aefe-6a824c65d25d",
["wa200002140"]:"aa183fd9-7104-46c4-af9f-9ee9b81d717e",["wa200001679"]:"40906836-4323-4bbe-875e-3cbb134c40a2",["wa104382005"]:"5be2b320-a5b7-4221-893c-dee506e4e365",["wa200003113"]:"30bb610c-6321-40fe-a047-056e7d0dac96",["wa200002488"]:"6b9cc557-e24a-4744-a370-407e717f2195",["wa200000764"]:"87000000-3db9-bb44-5015-0b4a327a6597",["wa102957661"]:"P_a9f2cb2f-d28d-7b39-3c93-767babd2cf33",["wa102957665"]:"P_5219b8c4-ceef-624c-0a26-7537dfb546a1",["wa103147117"]:"P_524c6548-4b87-c209-70a6-8048294f63a6",
["wa103296784"]:"P_4f812270-fba7-ae5e-f1a8-c7040a2b5248",["wa103304320"]:"P_84f3efc2-4d07-f702-f043-767957e17f00",["wa104051163"]:"P_be8aef0c-b9ff-7091-69e4-f1b059f82492",["wa104099688"]:"P_ffc337a4-5225-8772-43e7-aa09494b6fb2",["wa104100404"]:"P_00820542-56e7-74c7-9afc-1e2091dc7a44",["wa104104476"]:"P_32757c1e-e38b-c4aa-cc01-ddfc793c3a99",["wa104178141"]:"P_7297314b-7311-094a-a8a3-73f95d4f5384",["wa104218065"]:"P_9f3473ab-0ff2-3ba7-35d8-3732e5ccbd88",["wa104218073"]:"P_f15aab22-d8bf-b8a9-2b96-7b500783297a",
["wa104221182"]:"P_fe8439a3-99c2-d703-9dd8-ac24211d2c5b",["wa104295828"]:"P_792111c6-1b7f-7d23-8705-0edddf6e04f1",["wa104379169"]:"P_34d79b94-da2b-f1b3-6c68-77b8f6ae46f1",["wa104379190"]:"P_45561daa-22c0-655a-0883-1ab69c3ea77a",["wa104379220"]:"P_05526e86-3804-956e-9085-4bd471e2ab20",["wa104379261"]:"P_a3a69bf8-a429-d88e-4503-09e533895d5b",["wa104379279"]:"P_efb564b9-2324-f370-f8d1-c4546f3ded28",["wa104379370"]:"P_e6722102-1828-3a43-176a-7c0cce9dd260",["wa104379585"]:"P_d42c8184-10a7-6cb2-04f9-740b4dea17a4",
["wa104379629"]:"P_ebfa1f51-e487-235b-1e69-1e0a51785b7c",["wa104379997"]:"P_4428315b-d836-0e0b-1024-1dafe364576e",["wa104380050"]:"P_7c939726-f9d6-9d39-81ea-424acc20958a",["wa104380118"]:"P_19f744bf-c905-7fea-2bcd-9bbf276ae521",["wa104380121"]:"P_686e1588-ad09-809e-862e-b47d23fd8259",["wa104380122"]:"P_705cbcd3-18d1-ac64-ba8d-f3effb64c5fb",["wa104380140"]:"P_403da369-8ee8-bfca-63ce-93e8c3a84c4a",["wa104380194"]:"P_80878967-c321-b49f-8a34-1cefece280a6",["wa104380278"]:"P_17b7e343-0c25-7788-a441-ef61d595f44a",
["wa104380330"]:"P_f252b4ce-4462-9aae-16e7-993f73260edc",["wa104380429"]:"P_2e87f2e6-c059-f6f5-2874-0d7fe655e8e0",["wa104380510"]:"P_5e5b6003-f623-557f-994e-cf3510ac7e84",["wa104380518"]:"P_851677c6-b0e9-2efb-6fdb-7ff49d5bc378",["wa104380519"]:"P_fd41a53e-64bf-7ac7-fdad-df0b8d472b2e",["wa104380526"]:"P_844bab03-ebc1-658d-067b-b11fac8b1350",["wa104380529"]:"P_1480ad84-cf5d-999b-0578-c9528451041f",["wa104380602"]:"P_3d65655c-16c8-43f1-471c-87c4d8f18834",["wa104380662"]:"P_557c0410-0ab7-a13c-0f19-4a7f75f83022",
["wa104380667"]:"P_b20dc2fa-8322-a7db-7b74-e1861360a76d",["wa104380711"]:"P_a266630d-5e65-c61c-3a70-ea737b06839e",["wa104380848"]:"P_f682c826-0625-fd0d-97ac-444714d48adb",["wa104380862"]:"P_14cbedd1-d1b3-2ee7-e09a-cb1e33e957db",["wa104380902"]:"P_ce799d80-be34-606f-ef48-df4246aa3e3e",["wa104380917"]:"P_7e094672-7c65-2e2b-706a-7b917da19dab",["wa104380955"]:"P_279904ae-d676-a39a-2a27-cc6c45f1bff5",["wa104380978"]:"P_8931d775-ae17-22d9-c798-4a159c5a30f1",["wa104381026"]:"P_cfc9731a-757f-39e8-dfb6-6cd34e250f40",
["wa104381063"]:"P_27189266-b7fa-15e5-fb07-02c70aa364cb",["wa104381155"]:"P_462ca0d7-4b39-e3d8-43ec-4b2ccdc2a9a9",["wa104381411"]:"P_d2c84ed4-890b-671c-8013-04a4a7b32d77",["wa104381430"]:"P_24753404-253e-6904-08c1-b700ca476daf",["wa104381448"]:"P_686c06d4-c63b-ed63-cf9a-f156cd264c63",["wa104381504"]:"P_f415e9dc-aedc-5108-d50e-b32f5ff2fa72",["wa104381519"]:"P_3f549988-9b6a-5a17-073d-eb6ad490d0af",["wa104381526"]:"P_0a90a072-da85-df1a-44ea-69623986a796",["wa104381613"]:"P_dea3bf0c-90b0-71db-d274-32a19b120ba3",
["wa104381637"]:"P_713e67f9-af29-6f0c-0e4b-85bd59065483",["wa104381658"]:"P_4aaf9986-4de4-421a-ba21-57ae7c34c737",["wa104381682"]:"P_e1701f7d-b7dc-b68a-217e-dd9a00fb21e8",["wa104381695"]:"P_0acecfa0-8d7d-11b6-201d-dd16a1b18ae7",["wa104381701"]:"P_a2a98f5e-3db7-7e90-266b-62d70f078e00",["wa104381714"]:"P_a5a96919-31fa-8802-cc98-3dc3d96d9379",["wa104381717"]:"P_93256933-6836-3955-8342-893159dc908f",["wa104381727"]:"P_3dd620a7-8895-04fc-4780-5c93081dc2f2",["wa104381787"]:"P_70fc8606-a04c-aef1-2b58-3f429c148141",
["wa104381807"]:"P_544d258c-989d-983f-71c3-a20f3f10f938",["wa104381841"]:"P_547c3928-aa01-f71a-86dd-1e522095ea34",["wa104381859"]:"P_33c237c1-a01d-7988-9827-c3db4a3b9d99",["wa104381909"]:"P_856bb40e-496c-b679-54ae-4a9e282fc6a5",["wa104381973"]:"P_9d2d1d3e-a85f-2bd7-574d-a74824d7a7cc",["wa104382023"]:"P_8a1ea4f9-dac2-a984-22c8-fe4df7448f11",["wa104382046"]:"P_4356b6d9-6815-15e0-b2e2-954a2022b4c5",["wa104382064"]:"P_93c1b12e-77d9-c268-df23-88de2d81f611",["wa104382081"]:"P_e160242e-0eb4-b4fe-ec03-9091f5581893",
["wa200000011"]:"P_c67d8bfd-d55f-a997-46c7-e0fa5e683a6e",["wa200000018"]:"P_6f990ef3-f78b-022b-77cc-adfcd1ff701c",["wa200000019"]:"P_f382affa-caba-a802-c26b-79b75d2220ed",["wa200000025"]:"P_48e9c3f2-9ad7-bc86-84f4-1d544a28553f",["wa200000068"]:"P_551df044-9ef8-2d27-819a-1b6d8c9bacf4",["wa200000094"]:"P_357ef366-410b-1787-3e76-79d2de414d1d",["wa200000113"]:"P_58c2debb-a23c-4e40-13e3-9e8fe6bf8a7a",["wa200000133"]:"P_57feaf55-08ea-2409-b794-40a9f0ba3ac1",["wa200000169"]:"P_496cdbf4-6ddc-d429-8ee2-4bf60bb411ac",
["wa200000199"]:"P_1e782646-4535-8852-97c3-59edd010d06b",["wa200000368"]:"P_6513fdb1-a2e5-0d47-0ec9-4aa92eb42add",["wa200000421"]:"P_39102611-fcce-9f1a-a9cc-3932d570fc8b",["wa200000556"]:"P_13c91dfa-df97-2d7b-6a19-d350bafcd0dd",["wa200000565"]:"P_0ccf9d6f-c1be-0457-c78c-bdfa0381fd61",["wa200000729"]:"P_9a3aca48-df5b-bb15-1102-6071c79fbeb0",["wa200001011"]:"P_f4b0f2e1-1e69-441a-4363-bd82e50ff0d0",["wa200001313"]:"P_6bfb1740-f067-db08-d576-4a3ad30804ac",["wa200001361"]:"P_d3706ea5-bc75-ee96-9c21-67a9e564fa1c",
["wa200001396"]:"P_79cc7f35-44ea-0c0f-4459-a2123db893a3",["wa200001409"]:"P_ff13a116-e010-53ae-661f-ede4b41fbd5c",["wa200001482"]:"P_12fcfbfd-5d8c-1b0d-52cb-d16a3be7e9e6",["wa200001486"]:"P_0a032e6c-84a0-8127-4331-6921bb8c3d8b",["wa200001584"]:"P_a968f674-a886-9bbd-5c81-0c6dc2fabac6",["wa200001625"]:"P_b47b6c8b-a50f-f132-5999-f97a569569b1",["wa200001661"]:"P_70143232-601c-eaae-d7e8-8ca1a5fcebc3",["wa200001766"]:"P_019bb795-a6ee-2926-12aa-469d29855b07",["wa200001841"]:"P_1e32dce0-b25a-6d3d-0083-5bda558dc5ba",
["wa200002281"]:"P_d2f48b38-ef77-ebd7-e312-5ece8ba73bed",["wa200002311"]:"P_f810b987-2c5f-3dde-ab94-d8211e38294e",["wa200002334"]:"P_4a04a1c8-9868-968c-58a1-e438d9f7c1c9",["wa200002503"]:"P_b8222565-9160-68a8-41b5-89b7fdb84209",["wa200002534"]:"P_84572ac5-3824-d02a-c2c3-661e7b66a522",["wa200002663"]:"P_8451aad0-b730-6b74-0699-cde1b6305764",["wa200002683"]:"P_7f3c21b9-833f-926e-386f-47dd625384cc",["wa200002891"]:"P_0dea20e7-8dfc-1472-8e9c-a745faad522f",["wa200002908"]:"P_20660a66-073d-991e-9efb-667c0b14f310",
["wa200003052"]:"P_d5ad3a0e-faac-e059-6e91-8c88c3c057f3",["wa200003157"]:"P_ed7df63c-6c5e-2daf-1671-cbfc4260206c",["wa200003216"]:"P_84c646f5-4e40-73be-11b3-69f512ab47ca",["wa200003220"]:"P_c89428cc-7705-6bd5-117f-8468b7016470",["wa200003233"]:"P_cce29b7c-3600-aeed-8699-9686af350971",["wa200003676"]:"P_b4c48381-9829-994d-28ec-05b8b90d832a",["wa200003692"]:"P_90f2b54f-d1e2-b4b1-1636-33e95f8c8218",["wa200003696"]:"P_b92537e9-566a-20a4-d096-203b0bd985c8",["wa200003706"]:"P_e47524aa-39a0-c178-a910-e40cd5c0ce56",
["wa200003784"]:"P_6d35c944-18f5-29f0-5bca-f4d81a28e1be",["wa200003891"]:"P_fe70a1e2-943e-b803-4ffe-2d73d595a20a",["wa200003915"]:"P_b13f89ae-6f1c-60fa-dab9-393f2c0a9991",["wa200003944"]:"P_d97cdd9e-55ce-a957-6c58-9b024c2822a8",["wa200003964"]:"P_607a3cd2-df46-9956-4530-bab4a809bb8c",["wa200004179"]:"P_14b037b6-ab20-a4a2-bded-ff7aeef9c918",["wa200004216"]:"P_445bbb72-70a9-1c7e-dfee-fa2ac47e38cd",["wa200004257"]:"P_62a66d59-2c21-3b39-59d4-ab547f9b49f8",["wa200004566"]:"P_c1b2d23e-f864-ee3e-d0e0-71077136e0c7",
["wa200004571"]:"P_2f45ba8f-94f7-b2fc-0941-0245060766ad",["wa200004632"]:"P_30e88af4-8d70-4574-5267-3f51baa98fad",["wa200004643"]:"P_b23318a6-a1cb-22c6-9f26-8e4d628dcf65",["wa200004687"]:"P_9e74def9-585e-d455-1518-cabe6127d78a",["wa200004688"]:"P_e38d9c34-1c4c-5559-52cf-492585739543",["wa200004709"]:"P_0f5b30a9-15db-5064-8658-693c420611e9",["wa200004774"]:"P_b432d518-2cbc-2fe6-0a87-69cd9370badb",["wa200004805"]:"P_4689634a-c95d-7613-52cf-d2e628b118fb",["wa200004858"]:"P_1f0cc2ec-b327-ebb3-56d7-d5c34ca14247",
["wa200004935"]:"P_8f61fcd0-cbce-bc4b-55fe-1eeacd4c85ae",["wa200005106"]:"P_fbda2031-1696-b741-8eb9-dca08c516204",["wa200005107"]:"P_310a2397-ea5f-fd46-98df-63c8de6de709",["wa200005246"]:"P_88d7a7cc-e08e-acfa-bebd-7a24788a2e77",["wa200005260"]:"P_3c3b16a4-49d4-3e3c-1ab6-f54463dbfbc3",["wa200005271"]:"P_242b943a-26a7-89e7-3ff5-606c09230903",["wa200005281"]:"P_fb568bd6-24d0-9ef6-86e3-04c9123f8b91",["wa200005287"]:"P_949635df-d45b-166b-a234-c7ed373d20bb",["wa200005298"]:"P_333bb2da-f335-4f74-d373-f85562edf126",
["wa200005312"]:"P_ac1fe108-0386-39e8-11a6-4bf692dd7afa",["wa200005313"]:"P_89c93c91-a86d-f73a-abff-8fa8ab2819ce",["wa200005333"]:"P_0f461388-0ba1-d861-8213-f5b0503c286f",["wa200005339"]:"P_022de418-d8c2-f490-ce76-87d0f0df32dc",["wa200005348"]:"P_b8f22572-3157-cb6a-d313-67d83c2f9955",["wa200005360"]:"P_61812a36-984b-78a5-ef08-c3777ef15387",["wa200005444"]:"P_102c0230-1f68-42aa-ead6-682f81bf7352",["wa200005502"]:"P_368b0e99-b793-5c7f-e3e2-2d7ad1020b73",["wa200005565"]:"P_04d63246-eff8-5662-6ada-264ea5d58628",
["wa200005566"]:"P_081ab0df-c58b-eeda-e7e5-b23af24f71f6",["wa200005669"]:"P_09f3b3c2-b002-45f4-7a4b-9f1695d11f52",["wa200005702"]:"P_2e63cc44-aea3-4c09-fe53-9823162b04b8",["wa200005777"]:"P_cea5ff16-fc25-ca86-0fae-2bd787a3ef18",["wa200005782"]:"P_8ee90f79-22e5-f498-8b6e-87e381b17e1e",["wa200005801"]:"P_ffa95d91-4069-9f34-9d41-6ff8e94ea312",["wa200005817"]:"P_039aae68-14cb-e9ac-117b-292187c4b049",["wa200005826"]:"P_e8b53ae3-33c8-6cc4-a38b-0986b7bd27f4",["wa200005876"]:"P_52b80fe3-f2b7-1040-9134-0f9f732603cb",
["wa200005960"]:"P_2613062e-37ce-89ad-9d9c-873772b7d64a",["wa200005983"]:"P_02a55bde-4916-195f-f732-8719bdec38ac",["wa200006000"]:"P_289f838d-9544-3286-1cb4-fcf003d89703",["wa200006001"]:"P_8da133f1-09a2-ee94-d11a-42f7aecc97da",["wa200006005"]:"P_ba70f3ee-fd0d-6c65-61b7-761493e4b582",["wa200006007"]:"P_349729d8-bf82-faf0-0fcb-564c5bb7587b",["wa200006008"]:"P_60542ed9-5ebf-3133-1779-c82ddcc95763",["wa200006009"]:"P_4b4a71cb-3caf-507a-2b19-157922618730",["wa200006017"]:"P_ecc66b69-aa1a-fe26-0426-be262899d0f1",
["wa200006038"]:"P_8cdf8f27-a427-22f0-b83d-ef80287cc656",["wa200006046"]:"P_66694a89-79e7-cdf0-4354-9e1e4dec68cb",["wa200006067"]:"P_5f887bc4-684d-1584-9a4b-14cced258951",["wa200006466"]:"P_f563335d-a408-1bc2-e314-aa78ea149134",["wa200006533"]:"P_0637069b-ed1f-0230-3c5f-b409188944e8",["wa104380907"]:"P_a92c6fd3-ff9a-e9c8-767a-428a6e472f8a",["wa200003251"]:"P_ff386961-7538-1eed-9252-620eee015253",["wa200002270"]:"P_5efaae07-5448-6128-0722-32f2d12fe612",["wa104381648"]:"P_c9a064ce-b11c-ee36-c2e0-d0aeedb54080",
["wa200001700"]:"P_69530cea-09dd-f0da-929d-1906b5dda48f",["wa200002513"]:"P_cb1e0f2c-ca90-60c8-6d98-8b76de171b35"};let d=!1},1292:function(y,r,a){a.d(r,"a",function(){return c});y=a(0);class c{constructor(b){this.$id=b}next(b){this.$id=(9301*this.$id+49297)%233280;return Math.floor(this.$id/233280*b)}}Object(y.a)(c,"Random",null,[])},1297:function(y,r,a){a.d(r,"a",function(){return c});const c=(b,f)=>{let k=!1;b&&(b=f.osfControl,(f=b.getManifest())&&f.getSharedRuntimeForCustomFunctions("Workbook")&&
!b.getIsUpgrading()&&(k=!0));return k}},1298:function(y,r,a){a.d(r,"a",function(){return n});y=a(0);var c=a(254),b=a(386),f=a(15),k=a(6),x=a(284),d=a(32),h=a(687);class n{getUserId(m,u){const l=new c.a;l.add(new b.a("corr",m));this.LZ("getUserId",l,1,u)}getLastStoreUpdate(m,u,l){const t=new c.a;t.add(new b.a("lc",m));t.add(new b.a("corr",u));this.LZ("laststoreupdate",t,1,l)}getEntitlement(m,u,l,t){m=new c.a;m.add(new b.a("av",u));m.add(new b.a("corr",l));this.LZ("getEntitlements",m,1,t)}getEToken(m,
u,l,t,e,w){const z=new c.a;z.add(new b.a("cmu",m));z.add(new b.a("cmf",u));z.add(new b.a("assetid",l));z.add(new b.a("expver",t));z.add(new b.a("corr",e));this.LZ("getEToken",z,1,w)}getManifest(m,u,l,t){const e=new c.a;e.add(new b.a("cmu",m));e.add(new b.a("assetid",u));e.add(new b.a("corr",l));this.LZ("getManifest",e,1,t)}getAppState(m,u,l){const t=new c.a;t.add(new b.a("ma",m));t.add(new b.a("corr",u));this.LZ("getAppState",t,1,l)}getKilledApps(m,u){const l=new c.a;l.add(new b.a("corr",m));this.LZ("getRemovedAddins",
l,1,u)}getAppDetails(m,u,l,t){const e=new c.a;e.add(new b.a("cmo",m));e.add(new b.a("corr",l));this.sendWithBody("getAppDetails",e,u,2,t,!1)}removeApps(m,u,l){const t=new c.a;t.add(new b.a("corr",u));this.sendWithBody("removeAddin",t,m,2,l,!1)}getLastPrivateCatalogUpdate(m,u,l,t,e,w){const z=new c.a;z.add(new b.a("catalog","privatecatalog"));z.add(new b.a("clientCode",m));z.add(new b.a("clientVersion",u));z.add(new b.a("corr",e));m=String.format("authorizationCode={0}&refreshToken={1}",l?d.a.Jf(l):
"",t?d.a.Jf(t):"");this.sendWithBody("getLastPrivateCatalogUpdate",z,m,2,w,!0)}getPrivateCatalogAddIns(m,u,l,t,e,w){var z;(null===(z=k.AFrameworkApplication.ea)||void 0===z?0:z.getBooleanFeatureGate("Microsoft.Office.WordOnline.SkipAddInEntitlementsCheckIfAppIsShuttingDown",!1))&&k.AFrameworkApplication.Sf||(z=new c.a,z.add(new b.a("catalog","privatecatalog")),z.add(new b.a("clientCode",m)),z.add(new b.a("clientVersion",u)),z.add(new b.a("corr",e)),m=String.format("authorizationCode={0}&refreshToken={1}",
l?d.a.Jf(l):"",t?d.a.Jf(t):""),this.sendWithBody("getAddIns",z,m,2,w,!0))}getPrivateCatalogManifests(m,u,l,t,e){const w=new c.a;w.add(new b.a("catalog","privatecatalog"));w.add(new b.a("corr",t));m=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",d.a.Jf(m),u?d.a.Jf(u):"",l?d.a.Jf(l):"");this.sendWithBody("getAppManifests",w,m,2,e,!0)}isStoreDisabled(m,u){const l=new c.a;l.add(new b.a("corr",m));this.LZ("isStoreDisabled",l,2,u)}LZ(m,u,l,t){this.sendWithBody(m,u,null,l,t,!1)}sendWithBody(m,
u,l,t,e,w){const z=new x.QueryStringBuilder("AddinServiceHandler.ashx");z.uj("action",m);z.uj("app",h.a[k.AFrameworkApplication.ua.Ab.gi]);for(const E of u)z.uj(E.key,E.value);u=String.format("{0}{1}&{2}",k.AFrameworkApplication.ua.Ab.fR,z.toString(),k.AFrameworkApplication.Uh);k.AFrameworkApplication.od.Wn(u,t,l,null,!1,2,E=>{let M=null,G=null;E&&E.data&&(E.data.responseHeaders["X-BlockedForMinor"]&&"1"===E.data.responseHeaders["X-BlockedForMinor"].toString()&&(E.data.httpStatus=451),M=E.data.responseData,
G=E.data.responseHeaders);e(E.data.httpStatus,M,G)},E=>{var M=null;let G=null;w&&E&&E.data&&E.data.responseData&&(M=E.data.responseData,G=E.data.responseHeaders);e(E.data.httpStatus,M,G);if(k.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){M={message:"AddinServiceHandler request failed"};M.code=E.data.httpStatus;M.action=m;if(E.data.request||E.data.request.get_headers())M["X-UserSessionId"]=E.data.request.get_headers()["X-UserSessionId"];
408===E.data.httpStatus||503===E.data.httpStatus?f.ULS.sendTraceTag(538784582,220,50,JSON.stringify(M)):f.ULS.sendTraceTag(18392345,220,50,JSON.stringify(M))}else f.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",E.data.httpStatus)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+m,void 0,void 0,void 0,["X-UserKey"])}}Object(y.a)(n,"S2SWebRequestManager",null,[])},1304:function(y,r,a){a.d(r,"a",function(){return c});y=a(0);class c{constructor(){this.token=null;this.errorCode=
0;this.expiresOn=this.mDa=this.d7a=this.LJf=this.tBc=this.MXa=this.Bwe=null}}Object(y.a)(c,"AppsForOfficeOauthResult",null,[])},1305:function(y,r,a){a.r(r);a.d(r,"WebExtensionView",function(){return M});y=a(0);var c=a(91),b=a(154);r=a(383);var f=a(31),k=a(20),x=a(296),d=a(49),h=a(227),n=a(1149),m=a(468),u=a(74),l=a(73),t=a(17),e=a(71),w=a(65),z=a(5),E=a(1143);a.n(E);Object(w.b)(z.WebExtensionViewService,{we:"singleton"})(async G=>{G=await w.a.resolve(z.EwaControlService,G);return new M(G,new m.FloatingObjectBlockManager(G,
G.fa,G.ma.eC,3,0),G.Wf.appendChild(G.Wf.ownerDocument.createElement("div")))});class M extends r.a{constructor(G,A,N){super(N,G);this.YGa=this.hashCode=null;this.$qc=!1;this.qr=(K,I)=>{I.he.hash===this.hashCode&&this.YGa&&(z.DdaFacadeService.Oa()?w.a.Cb(z.DdaFacadeService):Object(b.a)(a(958).DdaFacade,this.$.ra.Tb(35))).vVk(this.YGa.InstanceId)};this.onBlockCacheItemChanged=(K,I)=>{switch(I.he.block.state){case 1:case 3:case 5:this.oya(I)}};this.Ij=()=>{this.jSc(!0)};this.onActiveItemChanging=(K,
I)=>{this.isVisible&&this.x7a(I.Vx);this.clearCache()};this.onActiveItemChanged=(K,I)=>{this.LZg(I.la,!!I.Vx)};this.iL=()=>{this.$.fa.sKa()};this.f8a=A;this.domElement.classList.add(f.a.jNb);this.domElement.classList.add(k.a.YD);N.tabIndex=0;this.LZg(this.$.la,!1);this.Dd.Ea("mousedown",this.iL);this.Dd.Ea("contextmenu",K=>{e.g(K)});this.$.qa.VS(this.onActiveItemChanging);this.$.wc.VS(this.onActiveItemChanging);this.$.wc.mh(this.onActiveItemChanged);this.$.qa.mh(this.onActiveItemChanged);this.za.$t(this.onBlockCacheItemChanged);
this.za.xP(this.qr);this.za.Or(this.Ij);this.aw(this.ipb)}get za(){return this.f8a}dispose(){this.$&&(this.$.qa.xZ(this.onActiveItemChanging),this.$.wc.xZ(this.onActiveItemChanging),this.$.wc.xh(this.onActiveItemChanged),this.$.qa.xh(this.onActiveItemChanged));this.f8a&&(this.f8a.yu(this.onBlockCacheItemChanged),this.f8a.AR(this.qr),this.f8a.Gq(this.Ij));this.Zz(this.ipb);this.clearCache();c.a.vb(this.f8a);this.f8a=null;t.DOMElementExtensions.vh(this.domElement);super.dispose()}sQg(G){t.DOMElementExtensions.vh(t.DOMElementExtensions.getElementById(this.domElement,
G.id));this.domElement.appendChild(G)}OSb(){if(this.YGa&&!this.$qc){var G=(z.DdaFacadeService.Oa()?w.a.Cb(z.DdaFacadeService):Object(b.a)(a(958).DdaFacade,h.a(this.$))).Rp(this.YGa.InstanceId);G&&(G.resize(this.YGa.Width,this.YGa.Height),G.Ea(this.domElement),G.showHide(!0),this.$qc=!0)}}pWb(){return!0}oya(G){this.YGa=G.he.block.oe;this.$qc=!1;this.OSb()}x7a(G){this.$.fa.Y7&&G&&(G.Mv||(G.Mv=new x.a),G.Mv.Ci=new d.a(this.domElement.scrollLeft,this.domElement.scrollTop),G.Mv.o1b=20)}clearCache(){this.za.asb(this.hashCode,
"ClearCacheWebExtensionView");this.YGa=this.hashCode=null;this.$qc=!1}LZg(G,A){if(this.isVisible=!!G&&u.n(G))this.hashCode=this.za.FCa(G,l.a.UAd,this.hashCode,!1),this.hYc(A)}static YGb(G){if(!n.a(G)){const A=G.Wf;G.ra.zc(34,new M(G,new m.FloatingObjectBlockManager(G,G.fa,G.ma.eC,3,0),A.appendChild(A.ownerDocument.createElement("div"))))}}}Object(y.a)(M,"WebExtensionView",r.a,[313,6,4]);String(E);window.___1717508015710_closurehack=E},1308:function(y,r,a){a.d(r,"a",function(){return c});const c=(b,
f)=>OfficeExtension.WacRuntime.Utility.createPromise((k,x)=>{x(OfficeExtension.WacRuntime.Utility.createRichApiException(b,f))})},1431:function(y,r,a){a.r(r);a.d(r,"CustomFunctionsInstaller",function(){return Pa});y=a(0);var c=a(2),b=a(15),f=a(6),k=a(182),x=a(154),d=a(213),h=a(61),n=a(43),m=a(259),u=a(124),l=a(631);class t{constructor(za){za=za.split("|");this.OB=za[1];this.Zjd=za[2];this.wve=za[3]}get solutionId(){return this.OB}get solutionVersion(){return this.Zjd}get needToRestoreManifest(){return this.wve===
OSF.StoreTypeEnum.Registry.toString()}}Object(y.a)(t,"AddinStoreInfo",null,[]);class e{}Object(y.a)(e,"CustomFunctionRegistrationInfos",null,[]);var w=a(222),z=a(79);const E=(za,wa,db)=>M(za,wa,w.a.none,z.a.current,db),M=(za,wa,db,Ba,Ka)=>{db=za.continueWith(()=>{wa(za)},3,db,Ba);db.continueWith(()=>{b.ULS.sendTraceTag(537163463,0,10,Ka)},4);return db},G=(za,wa,db)=>A(za,wa,w.a.none,z.a.current,db),A=(za,wa,db,Ba,Ka)=>{db=za.jw(()=>wa(za),3,db,Ba);db.continueWith(()=>{b.ULS.sendTraceTag(537163462,
0,10,Ka)},4);return n.TaskExtensions.p2c(db)},N=(za,wa,db)=>K(za,wa,w.a.none,z.a.current,db),K=(za,wa,db,Ba,Ka)=>{db=za.jw(()=>wa(za),3,db,Ba);db.continueWith(()=>{b.ULS.sendTraceTag(537163461,0,10,Ka)},4);return db},I=(za,wa,db)=>L(za,wa,w.a.none,z.a.current,db),L=(za,wa,db,Ba,Ka)=>{db=za.jw(()=>wa(za),3,db,Ba);db.continueWith(()=>{b.ULS.sendTraceTag(537163460,0,10,Ka)},4);return n.TaskExtensions.p2c(db)},J=(za,wa,db)=>B(za,wa,w.a.none,z.a.current,db),B=(za,wa,db,Ba,Ka)=>{db=za.continueWith(()=>
{wa(za)},3,db,Ba);db.continueWith(()=>{b.ULS.sendTraceTag(537163459,0,10,Ka)},4);return db},Y=(za,wa)=>{N(a(1431).CustomFunctionsInstaller.AKf("CustomFunctionsRuntimeLogging"),db=>{if(db.result&&window.console)switch(db=U(za.severity)+" "+za.message+wa,za.severity){case 2:window.console.log&&window.console.log(db);break;case 0:window.console.info&&window.console.info(db);break;case 1:window.console.error&&window.console.error(db)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")},
U=za=>{switch(za){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};var O=a(1297);class C{}Object(y.a)(C,"InstallationInfo",null,[]);class X{}Object(y.a)(X,"UninstallationInfo",null,[]);var S=a(33),ea=a(83),Oa=a(42),Ha=a(36),Za=a(1),fa=a(28),la=a(266),ba=a(617),aa=a(67);class oa{constructor(za,wa){this.qjd=za;this._message=wa}get severity(){return this.qjd}get message(){return this._message}}Object(y.a)(oa,"CustomFunctionLog",null,[]);var Na=a(5),Ia=a(88),Sa=
a(65);class Pa{constructor(za,wa,db){this.Cka=!1;this.JK={};this.$=za;this.sn=wa;this.$Td().Nxa();this.indexedDB=db;this.indexedDB.Tf()&&(this.Cka=!0,this.indexedDB.initialize(Pa.KYa,Pa.LYa))}get n2(){return this.sn.n2}BXf(za,wa,db,Ba){if(Ba.invariantNamespace)for(let Ka=0;Ka<Ba.invariantNamespace.length;++Ka){const da=Ba.invariantNamespace.charAt(Ka);if("."!==da&&"_"!==da&&"a">da&&"z"<da&&"A">da&&"Z"<da&&"0">da&&"9"<da)throw b.ULS.sendTraceTag(537163552,0,10,`CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='${da}', Position=${Ka}.`),
Error.create("InvariantNamespace validation failed");}return G(this.cTh(db,Ba.manifest),()=>G(this.Yfe(za),Ka=>{let da=Ka.result;return(null===da||void 0===da?0:da.isDynamicMetadata)?this.ihe(za,wa,da,!1,!1,!1):G(this.mll(za,wa,Ba),sa=>{da=new C;da.addinId=db;da.locale=Ba.locale;da.addinInvariantNamespace=Ba.invariantNamespace;da.addinNamespace=Ba.namespace;da.addinTitle=Ba.title;da.isXllCompatible=Ba.isXllCompatible;da.metadataContent=JSON.stringify(JSON.parse(sa.result));return this.ihe(za,wa,da,
!1,Pa.jzi(Ba.osfControl.getStoreType()),O.a(this.$,Ba))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed"),"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")}CXf(za,wa,db,Ba){if(!Pa.C_d(db))throw b.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Error.create("Invalid Metadata JSON");
return G(this.Yfe(za),Ka=>{Ka=Ka.result;if(!Ka&&(Ka=Oa.a.Od(this.n2,za),!Ka))throw b.ULS.sendTraceTag(537163550,0,10,`CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId ${Telemetry.PrivacyRules.GetPrivacyCompliantId(za,wa,null)} hasn't been installed yet.`),Error.create("Customfunctions dynamic registration failed");Ka.metadataContent=JSON.stringify(JSON.parse(db));Ka.isDynamicMetadata=!0;return this.ihe(za,wa,Ka,!0,!0,Ba)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")}P5g(za,
wa){this.sn.vsa();const db=Object(c.a)(new X,{solutionId:za}),Ba=`CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(za,wa,null)}.`;return G(this.The(za),()=>G(this.Zhe(za),()=>this.kze(this.sn,za,wa,db),"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed"),Ba)}mll(za,wa,db){const Ba=new k.a;OSF.OUtil.xhrGet(db.metadataUrl,Ka=>{Ka?Ba.setResult(Ka):Ba.setException(Error.create("Invalid manifest"))},
Ka=>{b.ULS.sendTraceTag(537163548,0,10,`CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(za,wa,null)}. ErrorCode: ${Ka}.`);Ba.Yx()});return Ba.task}$Td(){return G(this.BSc(),za=>{const wa=za.result;if(!wa.length)return aa.Task.Va(!0);b.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");za=[];const db=[];for(let Ba=
0;Ba<wa.length;Ba++){const Ka=Object(x.a)(String,wa[Ba]);za.push(N(this.Yfe(Ka),da=>{if(da=da.result){const sa=Oa.a.Od(this.JK,da.addinId);sa&&sa===da.metadataContent||(this.JK[da.addinId]=da.metadataContent,this.n2[Ka]=da,db.push(da))}return!0},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"))}return I(aa.Task.VE(...za),()=>{if(db.length){const Ba=new e;Ba.registrationInfos=db;return this.Gnc(this.sn,wa,Ba)}b.ULS.sendTraceTag(537163546,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");
return aa.Task.Va(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},"CustomFunctionsInstaller::InstallFromCacheAsync failed")}DXf(){var za=new k.a;const wa=[],db=[];Object.keys(this.n2).forEach(Ba=>{Ba=Object(x.a)(String,Ba);const Ka=Oa.a.Od(this.n2,Ba);wa.push(Ka);db.push(Ba)});if(!db.length)return za.setResult(!0),za.task;za=Object(c.a)(new e,{registrationInfos:wa});return this.Gnc(this.sn,db,za)}BSc(){return N(this.yMd(l.a.ccb),za=>{za=za.result;
return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(za||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(za||"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")}sbh(za){return this.mpe(l.a.ccb,Sys.Serialization.JavaScriptSerializer.serialize(za))}Yfe(za){return G(this.yMd(l.a.Pib(za)),wa=>{wa=wa.result||"";return 0<wa.length?aa.Task.Va(Sys.Serialization.JavaScriptSerializer.deserialize(wa,!0)):aa.Task.Va(null)},
"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")}cll(za,wa){return G(this.wtf(za),()=>G(this.mpe(l.a.Pib(za),Sys.Serialization.JavaScriptSerializer.serialize(wa)),()=>Pa.npe(l.a.dRd,"true"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")}The(za){return G(this.JFg(za),()=>G(this.fGg(l.a.Pib(za)),
()=>G(this.BSc(),wa=>wa.result.length?aa.Task.Va(!0):Pa.npe(l.a.dRd,"false"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}kDg(za){return this.yMd(l.a.Nib(za))}obh(za,wa){return G(this.wtf(za),()=>this.mpe(l.a.Nib(za),
wa),"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")}Zhe(za){return G(this.JFg(za),()=>this.fGg(l.a.Nib(za)),"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}wtf(za){return G(this.BSc(),wa=>{wa=wa.result;const db=za.toLowerCase();if(wa.includes(db))return aa.Task.Va(!0);wa.push(db);return this.sbh(wa)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}JFg(za){return G(this.BSc(),
wa=>{wa=wa.result;const db=za.toLowerCase();return wa.includes(db)?(wa.splice(Array.indexOf(wa,db),1),this.sbh(wa)):aa.Task.Va(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}cTh(za,wa){if(Za.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return za=new OSF.AddinIdInfo(za),za.needToRestoreManifest()?this.obh(za.getSolutionId(),wa):aa.Task.Va(!0);za=new t(za);return za.needToRestoreManifest?this.obh(za.solutionId,
wa):aa.Task.Va(!0)}Wzk(za){if(Za.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){const db=new OSF.AddinIdInfo(za);return db.needToRestoreManifest()?N(this.kDg(db.getSolutionId()),Ba=>{(Ba=Ba.result)&&OSF.OsfManifestManager.cacheManifestFromXml(db.getSolutionId(),db.getSolutionVersion(),Ba,this.$.ta.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):aa.Task.Va(!0)}const wa=new t(za);return wa.needToRestoreManifest?
N(this.kDg(wa.solutionId),db=>{(db=db.result)&&OSF.OsfManifestManager.cacheManifestFromXml(wa.solutionId,wa.solutionVersion,db,this.$.ta.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):aa.Task.Va(!0)}fGg(za){return this.Cka?this.indexedDB.mBd(za):Pa.Uqk(za)}mpe(za,wa){return this.Cka?this.indexedDB.Qxa(new ba.a(za,wa)):Pa.npe(za,wa)}yMd(za){return this.Cka?this.indexedDB.zta(za):Pa.AKf(za)}ihe(za,wa,db,Ba,Ka,da){const sa=`CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(za,
wa,null)}.`;return n.TaskExtensions.p2c(N(this.jhe(this.sn,za,wa,db,!1,Ba,da),()=>Ka?this.cll(za,db):aa.Task.Va(!0),sa))}jhe(za,wa,db,Ba,Ka,da,sa){if(!da&&(da=Oa.a.Od(this.JK,Ba.addinId))&&da===Ba.metadataContent)return aa.Task.Va(!0);this.JK[Ba.addinId]=Ba.metadataContent;this.n2[wa]=Ba;sa||za.a3b(wa);za.vsa();return G(this.Onk(wa,db,Ba),()=>this.Aee(Ba.addinId,Ka),"Failed to register functions for customfunction addin")}Onk(za,wa,db){const Ba=new k.a,Ka=this.kTa(db);return this.jca(da=>{Y(Pa.YKb,
za);(da=da.Result)&&204===da.ResponseStatusCode?Ba.setResult(!0):(delete this.JK[db.addinId],delete this.n2[za],E(this.The(za),()=>{E(this.Zhe(za),()=>{this.kWg()},"Failed to show customfunctions installation error info")},`CustomFunctionsInstaller: Failed to register Custom Functions for solution: ${za}. Received status code ${da?da.ResponseStatusCode.toString():"Unknown"}.`),Ba.setResult(!1))},da=>{da=u.a.te(da.data);b.ULS.sendTraceTag(537163544,0,10,`CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(za,
wa,null)}. Errors: ${Ha.a.pc(da)}.`);Y(Pa.XKb,za);delete this.JK[db.addinId];delete this.n2[za];Ba.setResult(!1)},Ka,Ba,!0)}Gnc(za,wa,db){const Ba=new k.a,Ka=S.a.zb.me.m;wa.forEach(sa=>{sa=Object(x.a)(String,sa);za.Tdf(sa)});za.vsa();const da=this.Ssd(db);return this.jca(sa=>{Y(Pa.YKb,Sys.Serialization.JavaScriptSerializer.serialize(wa));sa=sa.Result;let mb=!0,Ma=[];if(null===sa||void 0===sa?0:sa.ResponseBody){var hb=Sys.Serialization.JavaScriptSerializer.deserialize(sa.ResponseBody.toString());Array.isArray(hb.value)&&
(Ma=hb.value)}hb=[];for(let $a=0;$a<Ma.length;$a++)if(!Ma[$a]){mb=!1;const Va=`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code ${sa.ResponseStatusCode}.`;hb.push(G(this.The(wa[$a]),()=>{delete this.JK[db.registrationInfos[$a].addinId];delete this.n2[wa[$a]];return this.Zhe(wa[$a])},Va))}J(aa.Task.VE(...hb),()=>{E(this.Aee("",!1),()=>{b.ULS.sendTraceTag(537163542,0,50,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes ${S.a.zb.me.m-
Ka} Millisecond.`);mb?Ba.setResult(mb):J(this.kWg(),()=>{Ba.setResult(mb)},"Failed to show customfunctions installation error info")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},sa=>{sa=u.a.te(sa.data);b.ULS.sendTraceTag(537163541,0,10,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: ${Ha.a.pc(sa)}.`);
Y(Pa.XKb,Sys.Serialization.JavaScriptSerializer.serialize(wa));for(sa=0;sa<db.registrationInfos.length;sa++)delete this.JK[db.registrationInfos[sa].addinId],delete this.n2[wa[sa]];Ba.setResult(!1)},da,Ba,!0)}kze(za,wa,db,Ba){return G(this.pal(za,wa,db,Ba),()=>this.Aee(Ba.solutionId,!1),"Failed to unregister functions for customfunction addin")}pal(za,wa,db,Ba){const Ka=new k.a;za.a3b(wa);(za=Oa.a.Od(this.n2,wa))&&delete this.JK[za.addinId];delete this.n2[wa];Ba=this.htd(Ba);return this.jca(()=>{Y(Pa.oAd,
wa);Ka.setResult(!0)},da=>{da=u.a.te(da.data);b.ULS.sendTraceTag(537163539,0,10,`CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(wa,db,null)}. Errors: ${Ha.a.pc(da)}.`);Y(Pa.nAd,wa);Ka.setResult(!1)},Ba,Ka,!1)}jca(za,wa,db,Ba,Ka){const da=this.$.userOperationManager,sa=this.$.ma;let mb=null,Ma=null,hb=null;const $a=()=>{if(da.mUa()||0<sa.sa.kca||0<sa.eC.kca)return!1;mb&&da.kn(mb);Ma&&sa.xG(Ma);
hb&&sa.sV(hb);const Va=db.request;da.rK(new d.a(507,0,(xa,ia,Z)=>{Y(Ka?Pa.mAd:Pa.pAd,Va.RequestBody);return h.h(sa.sa,"ExecuteRichApiRequest",db,la.c(xa,za),la.b(ia,wa),Z,null,0)},Va.RequestFlags&1&&256!==(Va.RequestFlags&256)?64:80));return!0};$a()||(mb=()=>{$a()},Ma=()=>{$a()},hb=()=>{$a()},da.Kp(mb),sa.ED(Ma),sa.yP(hb));return Ba.task}kTa(za){const wa={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};wa.RequestBody=JSON.stringify(za);wa.RequestFlags=1;wa.RequestFlags|=
256;za=this.$.ma.sa.$a(1);za.request=wa;return za}Ssd(za){const wa={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};wa.RequestBody=JSON.stringify(za);wa.RequestFlags=1;wa.RequestFlags|=256;za=this.$.ma.sa.$a(1);za.request=wa;return za}htd(za){const wa={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};wa.RequestBody=JSON.stringify(za);wa.RequestFlags=1;wa.RequestFlags|=256;za=this.$.ma.sa.$a(1);za.request=wa;return za}Aee(za,wa){const db=
Object(Ia.d)(Sa.a.resolve(Na.FunctionInfoManagerService,{xa:1}));return A(db,()=>{db.result.Hke();return za&&wa?this.Wzk(za):aa.Task.Va(!0)},this.$.Aa,m.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")}kWg(){const za=new ea.a(1949669462,0,this.$.xc,0,null);return this.$.Ia.Gb(za)}static AKf(za){try{return aa.Task.Va(localStorage.getItem(za))}catch(wa){return b.ULS.sendTraceTag(537163537,0,50,`CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: ${wa.message||
"Unknown"}`),aa.Task.Va(null)}}static npe(za,wa){try{return localStorage.setItem(za,wa),aa.Task.Va(!0)}catch(db){return b.ULS.sendTraceTag(537163536,0,50,`CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: ${db.message||"Unknown"}`),aa.Task.Va(!1)}}static Uqk(za){try{return localStorage.removeItem(za),aa.Task.Va(!0)}catch(wa){return b.ULS.sendTraceTag(537163535,0,50,`CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: ${wa.message||
"Unknown"}`),aa.Task.Va(!1)}}static jzi(za){return fa.a.equals(za,"registry",!0)||fa.a.equals(za,"uploadfiledevcatalog",!0)||f.AFrameworkApplication.userNameUnknown||f.AFrameworkApplication.limitedEdit}static C_d(za){if(!za)return!1;try{JSON.parse(za)}catch(wa){return!1}return!0}}Pa.KYa="CustomFunctionCache";Pa.LYa="CustomFunction";Pa.mAd=new oa(2,"CustomFunctions [Registration] [Begin] SolutionId=");Pa.YKb=new oa(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");Pa.XKb=new oa(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
Pa.pAd=new oa(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");Pa.oAd=new oa(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");Pa.nAd=new oa(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(y.a)(Pa,"CustomFunctionsInstaller",null,[358])},1433:function(y,r,a){a.r(r);a.d(r,"CustomFunctionsLegacyInstaller",function(){return X});y=a(0);var c=a(2),b=a(15),f=a(1196),k=a(182),x=a(154),d=a(213),h=a(61),n=a(81),m=a(43),u=a(124),l=a(631),t=a(1297);class e{constructor(S){S=
S.split("|");this.OB=S[1];this.Zjd=S[2];this.wve=S[3]}get solutionId(){return this.OB}get solutionVersion(){return this.Zjd}get needToRestoreManifest(){return this.wve===OSF.StoreTypeEnum.Registry.toString()}}Object(y.a)(e,"AddinStoreInfo",null,[]);class w{}Object(y.a)(w,"CustomFunctionRegistrationInfos",null,[]);const z=(S,ea)=>{if(a(1433).CustomFunctionsLegacyInstaller.ZPb("CustomFunctionsRuntimeLogging")&&window.console)switch(ea=E(S.severity)+" "+S.message+ea,S.severity){case 2:window.console.log&&
window.console.log(ea);break;case 0:window.console.info&&window.console.info(ea);break;case 1:window.console.error&&window.console.error(ea)}},E=S=>{switch(S){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};class M{}Object(y.a)(M,"InstallationInfo",null,[]);class G{}Object(y.a)(G,"UninstallationInfo",null,[]);var A=a(197),N=a(42),K=a(36),I=a(13),L=a(266),J=a(1148),B=a(67);class Y{constructor(S,ea){this.qjd=S;this._message=ea}get severity(){return this.qjd}get message(){return this._message}}
Object(y.a)(Y,"CustomFunctionLog",null,[]);var U=a(5),O=a(88),C=a(65);class X{constructor(S){this.JK={};this.$=S;this.$Td().Nxa()}BXf(S,ea,Oa,Ha){const Za=new k.a;if(Ha.invariantNamespace)for(ea=0;ea<Ha.invariantNamespace.length;++ea){const la=Ha.invariantNamespace.charAt(ea);if("."!==la&&"_"!==la&&"a">la&&"z"<la&&"A">la&&"Z"<la&&"0">la&&"9"<la)return b.ULS.sendTraceTag(537163530,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='${la}', Position=${ea}.`),
Za.setResult(!1),Za.task}X.cacheManifest(Oa,Ha.manifest);let fa=X.Zfe(S);(null===fa||void 0===fa?0:fa.isDynamicMetadata)?this.hhe(S,fa,Za,!1,!1):OSF.OUtil.xhrGet(Ha.metadataUrl,la=>{fa=Object(c.a)(new M,{addinId:Oa,locale:Ha.locale,addinInvariantNamespace:Ha.invariantNamespace,addinNamespace:Ha.namespace,addinTitle:Ha.title,isXllCompatible:Ha.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(la))});this.hhe(S,fa,Za,!1,t.a(this.$,Ha))},la=>{b.ULS.sendTraceTag(537163528,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution ${S}. ErrorCode: ${la}.`);
Za.setResult(!1)});return Za.task}CXf(S,ea,Oa,Ha){ea=new k.a;if(!X.C_d(Oa))return b.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),ea.setResult(!1),ea.task;const Za=X.Zfe(S);if(!Za)return b.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),ea.setResult(!1),ea.task;Za.metadataContent=JSON.stringify(JSON.parse(Oa));Za.isDynamicMetadata=
!0;this.hhe(S,Za,ea,!0,Ha);return ea.task}P5g(S){const ea=new k.a,Oa=U.DdaFacadeService.Oa()?Object(O.d)(C.a.resolve(U.DdaFacadeService,{xa:1})):n.GetServiceTaskFactory.create(this.$.ra,106,this.$.Aa,1);m.TaskExtensions.tb(Oa,()=>{const Ha=Oa.result;Ha.vsa();const Za=Object(c.a)(new G,{solutionId:S});X.Uhe(S);X.$he(S);m.TaskExtensions.tb(this.kze(Ha,S,Za),fa=>{A.b(fa)?ea.setResult(fa.result):(fa.Ng?b.ULS.sendTraceTag(537163524,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${S}.`):
fa.fi&&b.ULS.sendTraceTag(537163523,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: ${S}.`),ea.setResult(!1))},this.$.Aa,0)},this.$.Aa,3);return ea.task}$Td(){const S=new k.a,ea=X.cge();0<ea.length&&b.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");const Oa=[];ea.forEach(Za=>{Za=Object(x.a)(String,Za);if(Za=X.Zfe(Za)){const fa=N.a.Od(this.JK,Za.addinId);
fa&&fa===Za.metadataContent||(this.JK[Za.addinId]=Za.metadataContent,Oa.push(Za))}});if(!Oa.length)return S.setResult(!0),b.ULS.sendTraceTag(537163521,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),S.task;const Ha=U.DdaFacadeService.Oa()?Object(O.d)(C.a.resolve(U.DdaFacadeService,{xa:1})):n.GetServiceTaskFactory.create(this.$.ra,106,this.$.Aa,1);m.TaskExtensions.tb(Ha,()=>{const Za=Ha.result,fa=Object(c.a)(new w,{registrationInfos:Oa});
m.TaskExtensions.tb(this.Gnc(Za,ea,fa),la=>{A.b(la)?S.setResult(la.result):(la.Ng?b.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):la.fi&&b.ULS.sendTraceTag(537163490,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),S.setResult(!1))},this.$.Aa,0)},this.$.Aa,3);return S.task}Vzk(S){S=new e(S);if(S.needToRestoreManifest){const ea=X.Pkk(S.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(S.solutionId,
S.solutionVersion,ea,this.$.ta.UICultureTag)}}hhe(S,ea,Oa,Ha,Za){const fa=U.DdaFacadeService.Oa()?Object(O.d)(C.a.resolve(U.DdaFacadeService,{xa:1})):n.GetServiceTaskFactory.create(this.$.ra,106,this.$.Aa,1);m.TaskExtensions.tb(fa,()=>{m.TaskExtensions.tb(this.jhe(fa.result,S,ea,!1,Ha,Za),la=>{A.b(la)?((la=la.result)&&X.dll(S,ea),Oa.setResult(la)):(la.Ng?b.ULS.sendTraceTag(537163488,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: ${S}.`):la.fi&&
b.ULS.sendTraceTag(537163487,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: ${S}.`),Oa.setResult(!1))},this.$.Aa,0)},this.$.Aa,3)}jhe(S,ea,Oa,Ha,Za,fa){if(!Za&&(Za=N.a.Od(this.JK,Oa.addinId))&&Za===Oa.metadataContent)return B.Task.Va(!0);this.JK[Oa.addinId]=Oa.metadataContent;const la=new k.a;fa||S.a3b(ea);S.vsa();S=this.kTa(Oa);return this.jca(ba=>{z(X.YKb,ea);const aa=ba.Result;204===aa.ResponseStatusCode?m.TaskExtensions.tb(this.zee(la,
Oa.addinId,Ha),oa=>{oa.Ng?ea?b.ULS.sendTraceTag(537163485,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${ea}.`):b.ULS.sendTraceTag(537163484,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId ${Oa.addinId}.`):oa.fi&&(ea?b.ULS.sendTraceTag(537163483,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution ${ea}.`):
b.ULS.sendTraceTag(537163482,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId ${Oa.addinId}.`));la.setResult(!1)},this.$.Aa,4):(ba=()=>{delete this.JK[Oa.addinId];X.Uhe(ea);X.$he(ea);b.ULS.sendTraceTag(537163481,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: ${ea}. Received status code ${aa.ResponseStatusCode}.`);la.setResult(!1)},ba=Object(c.a)(new J.a,{MYa:OSF.InfoType.Error,title:Oa.addinTitle,
description:String.format(I.a.instance.Ib(153),I.a.instance.ia(1892)),buttonText:I.a.instance.ia(4),fra:ba,dDc:!1,fsa:ba,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),f.a.Fse(ba))},ba=>{ba=u.a.te(ba.data);b.ULS.sendTraceTag(537163480,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${ea}. Errors: ${K.a.pc(ba)}.`);z(X.XKb,ea);delete this.JK[Oa.addinId];la.setResult(!1)},S,la,!0)}Gnc(S,ea,Oa){const Ha=new k.a;
ea.forEach(fa=>{fa=Object(x.a)(String,fa);S.Tdf(fa)});S.vsa();const Za=this.Ssd(Oa);return this.jca(fa=>{z(X.YKb,Sys.Serialization.JavaScriptSerializer.serialize(ea));fa=fa.Result;let la=!0;var ba=[];ba=Sys.Serialization.JavaScriptSerializer.deserialize(fa.ResponseBody.toString()),ba=Array.isArray(ba.value)?ba.value:null;for(let aa=0;aa<ba.length;aa++)ba[aa]||(la=!1,delete this.JK[Oa.registrationInfos[aa].addinId],X.Uhe(ea[aa]),X.$he(ea[aa]),b.ULS.sendTraceTag(537163478,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: ${ea[aa]}. Received status code ${fa.ResponseStatusCode}.`));
m.TaskExtensions.tb(this.zee(Ha,"",!1),aa=>{aa.Ng?b.ULS.sendTraceTag(537163477,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):aa.fi&&b.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");Ha.setResult(!1)},this.$.Aa,4);Ha.setResult(la)},fa=>{fa=u.a.te(fa.data);b.ULS.sendTraceTag(537163475,0,10,`CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds ${Sys.Serialization.JavaScriptSerializer.serialize(ea)}. Errors: ${K.a.pc(fa)}.`);
z(X.XKb,Sys.Serialization.JavaScriptSerializer.serialize(ea));for(const la of Oa.registrationInfos)delete this.JK[la.addinId];Ha.setResult(!1)},Za,Ha,!0)}kze(S,ea,Oa){const Ha=new k.a;S.a3b(ea);S=this.htd(Oa);return this.jca(()=>{z(X.oAd,ea);m.TaskExtensions.tb(this.zee(Ha,Oa.solutionId,!1),Za=>{Za.Ng?ea&&b.ULS.sendTraceTag(537163473,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${ea}.`):Za.fi&&ea&&b.ULS.sendTraceTag(537163472,
0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution ${ea}.`);Ha.setResult(!1)},this.$.Aa,4)},Za=>{Za=u.a.te(Za.data);b.ULS.sendTraceTag(537163471,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${ea}. Errors: ${K.a.pc(Za)}.`);z(X.nAd,ea);Ha.setResult(!1)},S,Ha,!1)}jca(S,ea,Oa,Ha,Za){const fa=this.$.userOperationManager,la=this.$.ma;let ba=null,aa=null,
oa=null;const Na=()=>{if(fa.mUa()||0<la.sa.kca||0<la.eC.kca)return!1;ba&&fa.kn(ba);aa&&la.xG(aa);oa&&la.sV(oa);const Ia=Oa.request;fa.rK(new d.a(507,0,(Sa,Pa,za)=>{z(Za?X.mAd:X.pAd,Ia.RequestBody);return h.h(la.sa,"ExecuteRichApiRequest",Oa,L.c(Sa,S),L.b(Pa,ea),za,null,0)},(Ia.RequestFlags&1?0:16)|64));return!0};Na()||(ba=()=>{Na()},aa=()=>{Na()},oa=()=>{Na()},fa.Kp(ba),la.ED(aa),la.yP(oa));return Ha.task}kTa(S){const ea={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};
ea.RequestBody=JSON.stringify(S);ea.RequestFlags=1;S=this.$.ma.sa.$a(1);S.request=ea;return S}Ssd(S){const ea={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};ea.RequestBody=JSON.stringify(S);ea.RequestFlags=1;S=this.$.ma.sa.$a(1);S.request=ea;return S}htd(S){const ea={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};ea.RequestBody=JSON.stringify(S);ea.RequestFlags=1;S=this.$.ma.sa.$a(1);S.request=ea;return S}zee(S,ea,Oa){const Ha=
Object(O.d)(C.a.resolve(U.FunctionInfoManagerService,{xa:1}));m.TaskExtensions.tb(Ha,()=>{Ha.result.Hke();ea&&Oa&&this.Vzk(ea);S.setResult(!0)},this.$.Aa,3);return Ha}DXf(){return B.Task.Va(!0)}static cge(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(X.ZPb(l.a.ccb)||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(X.ZPb(l.a.ccb)||"[]"):null)||[]}static tbh(S){X.ope(l.a.ccb,Sys.Serialization.JavaScriptSerializer.serialize(S))}static Zfe(S){S=X.ZPb(l.a.Pib(S))||
"";return 0<S.length?Sys.Serialization.JavaScriptSerializer.deserialize(S,!0):null}static dll(S,ea){X.vtf(S);X.ope(l.a.Pib(S),Sys.Serialization.JavaScriptSerializer.serialize(ea))}static Uhe(S){X.IFg(S);X.gGg(l.a.Pib(S))}static Pkk(S){return X.ZPb(l.a.Nib(S))}static ell(S,ea){X.vtf(S);X.ope(l.a.Nib(S),ea)}static $he(S){X.IFg(S);X.gGg(l.a.Nib(S))}static vtf(S){const ea=X.cge();S=S.toLowerCase();ea.includes(S)||(ea.push(S),X.tbh(ea))}static IFg(S){const ea=X.cge();S=S.toLowerCase();ea.includes(S)&&
(ea.splice(Array.indexOf(ea,S),1),X.tbh(ea))}static cacheManifest(S,ea){S=new e(S);S.needToRestoreManifest&&X.ell(S.solutionId,ea)}static ZPb(S){try{return localStorage.getItem(S)}catch(ea){return b.ULS.sendTraceTag(537163469,0,50,`CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: ${ea.message||"Unknown"}`),null}}static ope(S,ea){try{localStorage.setItem(S,ea)}catch(Oa){b.ULS.sendTraceTag(537163468,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${Oa.message||
"Unknown"}`)}}static gGg(S){try{localStorage.removeItem(S)}catch(ea){b.ULS.sendTraceTag(537163467,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${ea.message||"Unknown"}`)}}static C_d(S){if(!S)return!1;try{JSON.parse(S)}catch(ea){return!1}return!0}}X.mAd=new Y(2,"CustomFunctions [Registration] [Begin] SolutionId=");X.YKb=new Y(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");X.XKb=new Y(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
X.pAd=new Y(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");X.oAd=new Y(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");X.nAd=new Y(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(y.a)(X,"CustomFunctionsLegacyInstaller",null,[358])},1443:function(y,r,a){a.d(r,"a",function(){return M});y=a(0);var c=a(222),b=a(15);class f{}Object(y.a)(f,"AddinCommandsHost",null,[]);var k=a(1512),x=a(1660),d=a(1147),h=a(61);const n=(G,A,N,K,I,L)=>{const J=G.$a(9);
J.sharedInfo=A;return h.h(G,"InsertAgaveTaskpane",J,N,K,I,L,0)};var m=a(429),u=a(213),l=a(43),t=a(1),e=a(266);r=a(238);class w extends r.a{constructor(G){super();this.uf=this.fPa="AddInCommandsDialog";this.hc=5;this.dialogWidth=695;this.dialogHeight=438;this.I2h="100%";this.F2h="408px";this.G2h="15px";this.H2h="0";this.trh=G}get containerDiv(){return this.fj}rB(){super.rB();this.fj.style.width=this.I2h;this.fj.style.height=this.F2h;this.fj.style.marginTop=this.G2h;this.fj.style.padding=this.H2h}IO(){super.IO();
this.Fb.style.width=String.format("{0}px",this.dialogWidth);this.Fb.style.height=String.format("{0}px",this.dialogHeight)}dispose(){super.dispose();this.trh()}}Object(y.a)(w,"AddInCommandsDialog",r.a,[]);var z=a(67),E=a(79);a=a(113);class M extends f{constructor(G,A,N,K,I){K=void 0===K?null:K;I=void 0===I?null:I;super();this.$=G;this.Gc=A;this.ownerAddinInfo=N;this.fc=I;this.Tsb=K||z.Task.Va(!0)}C2h(){const G=this.Tsb;this.Tsb=z.Task.Va(!0);return G}disposeHost(G){this.Gc.W3a(G)}setOwnerAddinEToken(G){this.ownerAddinInfo.eToken=
G}showTaskpane(G,A,N){b.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");let K=null,I=!1;const L=(new k.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.solutionId,new d.a,!0)).Kmf(G.solutionId.substr(this.ownerAddinInfo.solutionId.length));K=A.getSharedRuntimeForTaskpane("Workbook",L);I=!!K&&1===K.LifeTime;this.Gc.Wdf(I?this.ownerAddinInfo.solutionId:G.solutionId,I?K:null,null)||(this.dbg(I,!0),this.Tsb=this.YTd(G,K,(J,B)=>{J?(I&&(J.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,
J.SharedRuntime=K),J.WebExtensionOsfControlType=3,this.Gc.BUa(J),N(J.InstanceId,B),this.dbg(I,!1),t.EwaSettings.isChangeGateEnabled("OfficeVSO:6085876_TelemetryForActiveAddinSuccessOnExcelWacEnabled")&&b.ULS.sendTraceTag(524818146,220,50,"ShowTaskpane: succeed to call.")):(b.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),N(null,B))}))}getSettings(G,A){const N=this.Gc.UX(G.solutionId);N?A(this.Gc.JT(N).OsfPropertyBag):this.Tsb=this.YTd(G,null,K=>{K?A(K.OsfPropertyBag):b.ULS.sendTraceTag(537170641,
220,10,"GetSettings: insertData is null.")})}showDialog(G,A,N){b.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");const K=this.$.ma.sa,I=J=>{const B=J.Result,Y=B?B.AgaveData:null;Y?(this.Gc.wlf(Y,()=>{const U=new w(()=>{this.disposeHost(Y.InstanceId)});U.initializeAndShow("",null,null);return U.containerDiv}),N(Y.InstanceId,0)):(b.ULS.sendTraceTag(537170638,220,10,"ShowDialog: instance id is null."),N(null,J.Errors?J.Errors[0].ErrorCause:5001))},L=M.mEa(G,this.ownerAddinInfo);this.Tsb=
m.a(this.$.userOperationManager,(J,B,Y)=>n(K,L,e.c(J,I),B,Y,null),J=>new u.a(500,0,J,64),this.fc)}createUILessSandbox(G,A,N){b.ULS.sendTraceTag(537170637,220,50,"UILess action called.");const K=A.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),I=!!K&&1===K.LifeTime;(A=this.Gc.KBi(I?this.ownerAddinInfo.solutionId:G.solutionId,I?K:null))?N(A,0):this.Tsb=this.YTd(G,K,(L,J)=>{L?(I?(L.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,L.SharedRuntime=K,L.TaskpaneVisible=!1,L.WebExtensionOsfControlType=
3,this.Gc.BUa(L)):(L.WebExtensionOsfControlType=4,this.Gc.wlf(L,()=>{M.vwb.ga(L.InstanceId,new x.a);return M.vwb.pa(L.InstanceId).Tia})),N(L.InstanceId,J)):(b.ULS.sendTraceTag(537170636,220,10,"UILess: instance id is null."),N(null,J))})}YTd(G,A,N){let K=null;const I=this.$.ma.sa,L=O=>{const C=O.Result;(K=C?C.AgaveData:null)||N(null,O.Errors?O.Errors[0].ErrorCause:5001)},J=M.mEa(G,this.ownerAddinInfo);A&&(b.ULS.sendTraceTag(537170634,220,50,"Shared runtime agave is inserted."),J.SharedRuntimeId=A.Resid);
let B=500;var Y=(O,C,X)=>n(I,J,e.c(O,L),C,X,null);let U=0;void 0===J.IsToBePersisted||null===J.IsToBePersisted||J.IsToBePersisted||(B=538,Y=(O,C,X)=>{b.ULS.sendTraceTag(537170633,220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ownerAddinInfo.solutionId,this.ownerAddinInfo.storeType,this.ownerAddinInfo.assetId,null,null,this.ownerAddinInfo.storeId));O=e.c(O,L);const S=I.$a(9,null);S.sharedInfo=J;return h.h(I,
"ShowAgaveTaskpane",S,O,C,X,null,0)},U=16);U|=64;Y=m.a(this.$.userOperationManager,Y,O=>new u.a(B,0,O,U),this.fc);return l.TaskExtensions.ts(Y,()=>K?this.t2d(I,K.InstanceId,(O,C)=>{if(O){A||(K.PrimaryMarketplace.MarketplaceType=G.storeType);G.assetId?G.assetId.toLowerCase().startsWith("wa")?K.AssetMarketplace={SolutionId:G.assetId,SolutionVersion:G.version,MarketplaceType:OSF.StoreType.OMEX,MarketplaceRef:G.assetStoreId}:(K.AssetMarketplace=null,b.ULS.sendTraceTag(512325019,344,10,"WACExcelAddinCommandsHost: AssetId is not a valid value")):
K.AssetMarketplace=null;K.OwnerAddinSolutionId=this.ownerAddinInfo.solutionId;K.OwnerAddinStoreType=this.ownerAddinInfo.storeType;K.OsfPropertyBag=[];for(C=0;C<O.Settings.length;C++){const X=[];X[0]=O.Settings[C].Name;X[1]=O.Settings[C].Value;K.OsfPropertyBag[C]=X}N(K,0)}else N(null,C.Errors?C.Errors[0].ErrorCause:5001)}):z.Task.Va(!1),c.a.none,3,E.a.current)}t2d(G,A,N){const K=I=>{N(I.Result,I)};return m.a(this.$.userOperationManager,(I,L,J)=>{I=e.c(I,K);const B=G.$a(1);B.controlId=A;return h.h(G,
"DdaLoadSettings",B,I,L,J,null,0)},I=>new u.a(501,0,I,80),this.fc)}dbg(G,A){var N;G&&(null===(N=window.performance)||void 0===N?0:N.memory)&&b.ULS.sendTraceTag(537170630,220,50,`Shared runtime memory usage: before=${A}, jsHeapSizeLimit=${window.performance.memory.jsHeapSizeLimit}, totalJSHeapSize=${window.performance.memory.totalJSHeapSize}, usedJSHeapSize=${window.performance.memory.usedJSHeapSize}`)}static showUILessDialog(G){M.vwb.Bb(G)&&M.vwb.pa(G).initializeAndShowWithTitle()}static hideUILessDialog(G){M.vwb.Bb(G)&&
M.vwb.pa(G).hide()}static mEa(G,A){var N,K;const I={};I.SolutionId=G.solutionId;I.Version=G.version;I.StoreType=A.storeType;I.StoreId=G.storeId;I.AssetId=null!==(N=G.assetId)&&void 0!==N?N:G.solutionId;I.AssetStoreId=null!==(K=G.assetStoreId)&&void 0!==K?K:"omex";I.TargetType=1;I.Width=350;I.OwnerAddinSolutionId=A.solutionId;I.OwnerAddinStoreType=A.storeType;I.SharedRuntimeId=null;I.Preload=!1;return I}}M.vwb=new a.a;Object(y.a)(M,"WACExcelAddinCommandsHost",f,[])},1459:function(y,r,a){a.d(r,"a",
function(){return h});y=a(0);var c=a(661),b=a(15),f=a(239);class k{constructor(n,m,u){this.QRf=l=>{try{if(l&&l.rawEvent&&l.rawEvent.origin&&this.iframe&&this.iframe.id){var t=this.ewg(l.rawEvent.origin);const e=this.ewg(document.domain);if(c.a.Ef().equals(e,t))if(l.rawEvent.source&&l.rawEvent.source.frameElement&&l.rawEvent.source.frameElement.id&&c.a.Ef().equals(l.rawEvent.source.frameElement.id,this.iframe.id)){t=null;try{t=JSON.parse(l.rawEvent.data)}catch(w){b.ULS.sendTraceTag(39112971,344,50,
"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",w.message)}t?(t.statusCode!==f.a.nA||void 0!==t.error&&t.error?(b.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",t.statusCode,t.error),this.onError()):(b.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.nG(t.authorizationCode?t.authorizationCode:t.signInUrl)),
$removeHandler(window,"message",this.QRf),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):b.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):b.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):b.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else b.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");
else b.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else b.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(e){b.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",e.message)}};this.iframe=n;this.nG=m;this.onError=u;$addHandler(window,"message",this.QRf)}ewg(n){let m="";try{n&&(m=-1<n.indexOf("//")?n.split("/")[2]:
n.split("/")[0])&&(m=m.split(":")[0],m=m.split("?")[0])}catch(u){b.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",u.message)}return m}static Ea(n,m,u){new k(n,m,u)}}Object(y.a)(k,"ResponseHandler",null,[]);var x=a(6),d=a(284);class h{constructor(n){this.ORa=n}tryAuthenticate(n,m){this.Cqb(h.poh,()=>{n()},m)}tryAuthorize(n,m){this.Cqb(h.pjh,n,m)}getSignInUrl(n,m){this.Cqb(h.EYe,n,m)}signOut(n,m){this.Cqb(h.Buh,n,m)}Cqb(n,m,u){var l=new d.QueryStringBuilder("AuthenticationProxyHandler.aspx");
l.uj("responseType",n);x.AFrameworkApplication.Ebb(l);l=String.format("{0}{1}&{2}",this.ORa,l.toString(),x.AFrameworkApplication.Uh);const t=document.createElement("iframe");t.setAttribute("id","privateCatalogIframe");t.setAttribute("name","privateCatalogIframe");t.setAttribute("style","display: none");c.a.Ef().equals(n,h.EYe)||t.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");k.Ea(t,m,u);t.setAttribute("src",l);document.body.appendChild(t)}}h.pjh=
"authcode";h.poh="identitytoken";h.EYe="signinurl";h.Buh="signout";Object(y.a)(h,"AuthenticationProxy",null,[])},1511:function(y,r,a){r=a(489)(!1);r.push([y.i,".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}",""]);y.exports=r},1512:function(y,r,a){a.d(r,"a",function(){return b});y=a(0);a(15);var c=a(6);class b{constructor(f,k,x,d){this.iCb=f;c.AFrameworkApplication.ea.ka("AddInCommandsMissingTabIsEnabled")&&
x.hVi();this.OB=k;this.iuh=d}get iZb(){return this.iCb}get solutionId(){return this.OB}get Rre(){return this.iuh}$Wa(f){f=this.iZb+this.solutionId+f;return this.Rre?(f in b.Ulc||(b.Ulc[f]="AddinControl"+b.RGh++),b.Ulc[f]):f}Kmf(f){if(this.Rre){const x=b.Ulc;for(const d in x){var k=d;if(f===x[d])return k.substr(this.iZb.length+this.solutionId.length)}}return f}oOf(f){f=this.iZb+this.solutionId+f;return this.Rre?(f in b.upd||(b.upd[f]="AddinTab"+b.dHh++),b.upd[f]):f}}b.Ulc={};b.upd={};b.dHh=0;b.RGh=
0;Object(y.a)(b,"DefaultRibbonNamingProvider",null,[166])},1615:function(y,r,a){a.d(r,"a",function(){return N});y=a(0);var c=a(254),b=a(15),f=a(113);class k{constructor(){this.startTime=0;this.callback=null}}Object(y.a)(k,"SSOCallbackInfo",null,[]);class x{constructor(){this.accessToken=null}}Object(y.a)(x,"AccessTokenInformation",null,[466]);var d=a(1304);class h{constructor(){this.token=null;this.expiresOn=0;this.mDa=this.authChallenge=null}}Object(y.a)(h,"CachedTokenInfo",null,[]);class n{constructor(){this.hcc=
new c.a;this.Cqa=this.Bqa=!1;this.bza=this.authChallenge=null;this.startTime=this.retryCount=0;this.v5e=null}get callbacks(){return this.hcc}}Object(y.a)(n,"SSORequestInfo",null,[]);class m extends n{constructor(){super();this.errorCode=0}}Object(y.a)(m,"SSOFailedRequestInfo",n,[]);var u=a(6),l=a(126),t=a(178);class e{static Fda(K,I,L,J){var B=K.startTime;let Y=0;0<B&&(Y=e.ZA()-B);B={["callInstanceId"]:B.toString(),["callDuration"]:Y.toString(),["errorCode"]:I.toString()};if(J)for(const U in J)B[U]=
J[U];b.ULS.sendTraceTag(51401116,344,50,"{0}",B);t.a.sendTelemetryEvent({name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:l.a.Eh(B)});K.callback(I,L)}static ZA(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(K){}return Date.now()}}Object(y.a)(e,"AppsForOfficeSingleSignOnManagerStatic",null,[]);class w{constructor(K,I,L,J){this.Q_=new c.a;this.pM=new c.a;this.oAa=null;this.eab=new c.a;this.fRe=Promise.resolve(null);this.CYe=!1;this.WQa=
I;this.fP=K;this.jZe=L;this.wih=J}static Tsf(){return u.AFrameworkApplication.ea.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ReduceAddinSSOThrottleErrors")}oSk(K){if(this.oAa&&this.oAa.authChallenge===K.authChallenge){if(Date.now()/1E3+w.zKj>this.oAa.expiresOn)return this.oAa=null,!1;K=new d.a;K.token=this.oAa.token;K.expiresOn=this.oAa.expiresOn;K.mDa=this.oAa.mDa;K.d7a=!0;K.MXa=0;this.mRb(K);return!0}return!1}JQk(K){for(let I=0;I<this.pM.count;I++)if(this.pM.pa(I).authChallenge===
K.authChallenge&&this.pM.pa(I).bza===K.bza){let L;(L=this.pM.pa(I)).retryCount=L.retryCount+1;K.retryCount=this.pM.pa(I).retryCount;if(this.pM.pa(I).retryCount<w.ZKj||!this.pM.pa(I).Bqa&&K.Bqa||!this.pM.pa(I).Cqa&&K.Cqa){if(!this.pM.pa(I).Bqa&&K.Bqa||!this.pM.pa(I).Cqa&&K.Cqa)K.retryCount=0;this.pM.removeAt(I);break}K=new d.a;K.errorCode=this.pM.pa(I).errorCode;this.mRb(K);return!0}return!1}XBh(K,I){for(let L=0;L<this.pM.count;L++)if(this.pM.pa(L).bza===K.bza&&this.pM.pa(L).authChallenge===K.authChallenge)return;
this.pM.add(Object.assign(new m,{Bqa:K.Bqa,Cqa:K.Cqa,authChallenge:K.authChallenge,bza:K.bza,errorCode:I,retryCount:K.retryCount}))}get resource(){return this.WQa}vJd(K,I,L,J,B,Y){""===L&&(L=null);if(this.CYe)e.Fda(Y,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var U=null;for(const O of this.Q_)if(O.Bqa===K&&O.Cqa===I&&O.authChallenge===L&&O.bza===B){U=O;break}U||(U=Object.assign(new n,{Bqa:K,Cqa:I,authChallenge:L,v5e:J,bza:B,retryCount:0,startTime:e.ZA()}),this.Q_.add(U));
U.retryCount=0;U.callbacks.add(Y);this.fRe=this.fRe.then(()=>{if(0<this.Q_.count){var O=this.Q_.pa(0);if(this.oSk(O)||this.JQk(O))return null;for(var C=0;C<this.eab.count;)this.eab.pa(C)+w.k4k<e.ZA()?this.eab.removeAt(C):C++;C=w.Tsf()?w.VKj:w.WKj;if(this.eab.count>=C||this.Q_.count>=w.tKj)return O=new d.a,O.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.mRb(O),null;let X=null;u.AFrameworkApplication.ua&&(C=u.AFrameworkApplication.ua.KE)&&(X=C.Uc("ComponentAttach",this.fP+w.Wuh));
return O.bza.yxh(this.resource,O.Bqa,O.Cqa,O.authChallenge,this.wih,O.v5e).then(S=>{X&&X.stop();this.mRb(S)},()=>{X&&X.stop();const S=new d.a;S.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.mRb(S)})}return null})}}mRb(K){try{if(this.Q_.count){var I=this.Q_.pa(0);this.Q_.removeAt(0);var L=null;K.errorCode||(L=new x,L.accessToken=K.token);K.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&K.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&
K.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&K.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.XBh(I,K.errorCode);var J={};null!=K.MXa&&(J.getTokenSilentTime=K.MXa.toString());null!=K.tBc&&(J.getTokenPopupTime=K.tBc.toString());null!=K.LJf&&(J.getIDTokenTime=K.LJf.toString());null!=K.d7a&&(J.tokenCached=K.d7a.toString());K.Bwe&&(J.detailedError=K.Bwe);K.mDa&&(J.authLibrary=K.mDa);I.retryCount&&(J.retryCount=I.retryCount);for(var B of I.callbacks)e.Fda(B,
K.errorCode,L,J);if(w.Tsf()){const Y=Number.isFinite(K.MXa)&&0<=K.MXa&&K.MXa<w.xzi;(0<K.tBc||!Y&&!K.d7a)&&this.eab.add(I.startTime)}else null!=K.d7a&&K.d7a||this.eab.add(I.startTime);if(!K.errorCode)for(null!=K.expiresOn&&(this.oAa=Object.assign(new h,{token:K.token,expiresOn:K.expiresOn,authChallenge:I.authChallenge,mDa:K.mDa})),this.pM.clear(),B=0;B<this.Q_.count;)if(this.Q_.pa(B).authChallenge===I.authChallenge){for(const Y of this.Q_.pa(B).callbacks)e.Fda(Y,K.errorCode,L,J);this.Q_.removeAt(B)}else B++}}catch(Y){b.ULS.sendTraceTag(21628945,
344,10,"ReceivedAccessTokenHandler: exception message: {0}",Y.message)}}shutdown(){this.CYe=!0;this.Q_.clear()}}w.k4k=6E4;w.WKj=6;w.VKj=8;w.tKj=6;w.ZKj=3;w.zKj=300;w.xzi=100;w.Wuh="GetAccessToken";Object(y.a)(w,"SSOCallbackManager",null,[]);var z=a(948),E=a(609),M=a(78),G=a(39),A=a(32);class N{constructor(K,I,L){L=void 0===L?null:L;this.E6c=new f.a;const J=new c.a;I&&J.add(I.NIj);L&&J.addRange(L);this.xl=K;this.awh=J}NOb(K,I,L,J,B,Y,U,O,C,X){X=Object.assign(new k,{startTime:e.ZA(),callback:X});try{const Oa=
!!L&&""!==L;var S=X.startTime;const Ha=this.getOsfControl(K);let Za=Ha.getStoreType()||"",fa=Ha.getOwnerAddinStoreType()||"",la=Ha.getSolutionId()||"";const ba=Ha.getVersion()||"";Za=Za.toLowerCase();fa=fa.toLowerCase();la=la.toLowerCase();var ea=M.a.$Ld(I)||"";const aa=M.a.$Ld(Ha.getIframeUrl())||"",oa=ea.toLowerCase()===aa.toLowerCase();ea=Za;"inmemory"===Za&&(ea=fa);const Na=Telemetry.PrivacyRules.GetPrivacyCompliantId(la,ea,Ha.getAssetId(),null,null,Ha.getStoreId()),Ia={["callInstanceId"]:S.toString(),
["controlSolutionId"]:Na,["controlVersion"]:ba,["storeType"]:Za,["ownerStoreType"]:fa,["allowConsentPrompt"]:J.toString(),["forMSGraphAccess"]:B.toString(),["allowSignInPrompt"]:Y.toString(),["hasAddinAuthChallenge"]:Oa.toString(),["securityOriginEqualsSourceLocation"]:oa.toString(),["singleSignOnEnabled"]:U.toString(),["accountTypeFilter"]:O||""};b.ULS.sendTraceTag(51401115,344,50,"{0}",Ia);t.a.sendTelemetryEvent({name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:l.a.Eh(Ia)});
S=!0;const Sa=u.AFrameworkApplication.ea.Qa("HostAuthType");switch(O){case "aad":S="aad"===Sa;break;case "msa":S="msa"===Sa;break;default:S=!O||"noFilter"===O}if(S){O=null;if(U)for(const Pa of this.awh)if(Pa.Fpj(la)){O=Pa;break}O?this.isSSOAddin(K)?(U=!0,"omex"===ea&&(U=!1),"spapp"===ea||"spcatalog"===ea?(b.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),e.Fda(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):B&&!U?(b.ULS.sendTraceTag(51234570,
344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),e.Fda(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(B&&"exchange"===ea&&(J=!1),this.vJd(K,I,L,ea,J,Y,C,O,X))):(b.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),e.Fda(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):e.Fda(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else e.Fda(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,
null,null)}catch(Oa){this.CKc(),b.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",Oa.message),e.Fda(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(K,I,L,J){this.NOb(K,L[z.a.spd]||null,L[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,L[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,L[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,L[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||
!1,I,L[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||null,L[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,J)}vJd(K,I,L,J,B,Y,U,O,C){this.E6c.Bb(K)?J=this.E6c.pa(K):(J=new w(K,this.getWebApplicationResource(K).split(",")[0],J,this.getDefaultDisplayName(K)),this.E6c.add(K,J));const X=J.resource;K=N.m_i(X,this.getWebApplicationId(K));const S=OfficeExt.WACUtils.getHostSecure(I);K&&S?K.toLowerCase()===S.toLowerCase()?J.vJd(B,Y,L,U,O,C):(N.N0a('SSO Resource "'+
X+'" cannot be used from "'+I+'" origin due to domain mismatch.'),b.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),e.Fda(C,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(K||b.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),S||b.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),e.Fda(C,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))}CKc(){b.ULS.sendTraceTag(39068820,
344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(K){return this.xl.getOsfControl(K)}isSSOAddin(K){return this.getOsfControl(K).getManifest().isSSOAddin()}getWebApplicationId(K){return this.getOsfControl(K).getManifest().getWebApplicationId()}getWebApplicationResource(K){return this.getOsfControl(K).getManifest().getWebApplicationResource()}getDefaultDisplayName(K){return this.getOsfControl(K).getManifest().getDefaultDisplayName()}static m1i(){try{const K=
{};G.a.CIa&&E.a.hostPageSupportsAuth&&(K.UiHostSupportsAuthTokenAddinList=N.ZBf);K.UiHostSupportsAuthToken=E.a.hostPageSupportsAuth;return K}catch(K){b.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",K.message)}return null}static getInstance(K,I,L){N.Wa||(N.Wa=new N(K,void 0===L?null:L));return N.Wa}static N0a(K){window.console.warn&&window.console.warn(K)}static m_i(K,I){if(!K)return"";I||(I="");let L=K.toLowerCase();var J=I.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(J)||
(N.N0a('SSO App Id "'+I+'" is not a valid format. It will be rejected from store submission.'),b.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));L.endsWith(J)||(N.N0a('SSO Resource "'+K+'" does not end with App Id "'+I+'". It will be rejected from store submission.'),b.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!L.startsWith("https://")&&!L.startsWith("api://"))return N.N0a('SSO Resource "'+K+'" must be https:// or api:// protocol.'),b.ULS.sendTraceTag(590962909,
344,10,"Resource not using https or api protocol."),"";for(I=0;I<K.length;I++){J=K.charAt(I);const B=A.a.charCodeAt(K,I);if(33>B||126<B||"&"===J||"?"===J||"#"===J||"%"===J||"\\"===J)return N.N0a('SSO Resource "'+K+'" contains an invalid character "'+J+'".'),b.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+J+"' in resource URI."),""}if(0<=K.indexOf("::"))return N.N0a('SSO Resource "'+K+'" contains an invalid string "::".'),b.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<
K.length)return N.N0a('SSO Resource "'+K+'" is '+K.length+" characters and exceeds the max length of 120 characters."),b.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+K.length+"."),"";L.startsWith("api://")&&(L="https://"+L.substring(6,L.length));return 8===L.length?"":OfficeExt.WACUtils.getHostSecure(L)||""}}N.ZBf="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5 wa200003233 ad3bb869-dfe9-409b-95f2-98016482b42 wa200003251 b2177d0c-a1d8-4c60-bc46-b1d116be3eee".split(" ");
N.Wa=null;Object(y.a)(N,"AppsForOfficeSingleSignOnManager",null,[436])},1624:function(y,r,a){a.r(r);a.d(r,"DdaEventDispatch",function(){return t});y=a(0);var c=a(15),b=a(154),f;(function(e){e[e.none=0]="none";e[e.testEvent=1]="testEvent";e[e.test1Event=2]="test1Event";e[e.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";e[e.worksheetActivatedEvent=11]="worksheetActivatedEvent";e[e.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";e[e.worksheetAddedEvent=13]="worksheetAddedEvent";
e[e.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";e[e.worksheetDeletedEvent=15]="worksheetDeletedEvent";e[e.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";e[e.worksheetFilteredEvent=17]="worksheetFilteredEvent";e[e.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";e[e.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";e[e.worksheetColumnSortedEvent=20]="worksheetColumnSortedEvent";e[e.worksheetSingleClickedEvent=21]="worksheetSingleClickedEvent";e[e.worksheetRowHiddenChangedEvent=
22]="worksheetRowHiddenChangedEvent";e[e.worksheetFormulaChangedEvent=23]="worksheetFormulaChangedEvent";e[e.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";e[e.worksheetNameChangedEvent=25]="worksheetNameChangedEvent";e[e.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";e[e.worksheetMovedEvent=27]="worksheetMovedEvent";e[e.worksheetNavigationObjectChangedEvent=28]="worksheetNavigationObjectChangedEvent";e[e.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";
e[e.workbookFormulaReferenceStyleChangedEvent=30]="workbookFormulaReferenceStyleChangedEvent";e[e.chartAddedEvent=50]="chartAddedEvent";e[e.chartActivatedEvent=51]="chartActivatedEvent";e[e.chartDeactivatedEvent=52]="chartDeactivatedEvent";e[e.chartDeletedEvent=53]="chartDeletedEvent";e[e.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";e[e.tableDataChangedEvent=101]="tableDataChangedEvent";e[e.tableAddedEvent=102]="tableAddedEvent";e[e.tableDeletedEvent=103]="tableDeletedEvent";e[e.tableFilteredEvent=
104]="tableFilteredEvent";e[e.agaveVisualUpdateEvent=150]="agaveVisualUpdateEvent";e[e.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";e[e.customFunctionExecutionEndEvent=201]="customFunctionExecutionEndEvent";e[e.commentAddedEvent=250]="commentAddedEvent";e[e.commentDeletedEvent=251]="commentDeletedEvent";e[e.commentChangedEvent=252]="commentChangedEvent";e[e.invocationMessage=1E3]="invocationMessage";e[e.cancellationMessage=1001]="cancellationMessage";e[e.metadataMessage=
1002]="metadataMessage";e[e.visualSelectionChangedEvent=2E3]="visualSelectionChangedEvent";e[e.visualChangeEvent=2001]="visualChangeEvent";e[e.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";e[e.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";e[e.shapeActivatedEvent=2101]="shapeActivatedEvent";e[e.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";e[e.shapeAddedEvent=2103]="shapeAddedEvent";e[e.shapeDeletedEvent=2104]="shapeDeletedEvent";e[e.workbookAutoSaveSettingChangedEvent=
2200]="workbookAutoSaveSettingChangedEvent";e[e.wacOperationEvent=2201]="wacOperationEvent";e[e.recordingStateChangedEvent=2202]="recordingStateChangedEvent";e[e.workbookActivatedEvent=2203]="workbookActivatedEvent";e[e.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";e[e.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";e[e.linkedDataTypeRefreshRequestCompletedEvent=2500]="linkedDataTypeRefreshRequestCompletedEvent";e[e.linkedDataTypeRefreshModeChangedEvent=
2501]="linkedDataTypeRefreshModeChangedEvent";e[e.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";e[e.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";e[e.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";e[e.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";e[e.rangePickerDeactivatedEvent=2701]="rangePickerDeactivatedEvent";e[e.lineageActivityUpdateAvailableEvent=2800]=
"lineageActivityUpdateAvailableEvent";e[e.lineageActivityFilterUpdatedEvent=2801]="lineageActivityFilterUpdatedEvent";e[e.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";e[e.pivotTableAddedEvent=2900]="pivotTableAddedEvent";e[e.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";e[e.namedItemAddedEvent=3E3]="namedItemAddedEvent";e[e.namedItemDeletedEvent=3001]="namedItemDeletedEvent";e[e.guidedReapplyManagerUpdateAvailableEvent=3100]="guidedReapplyManagerUpdateAvailableEvent";
e[e.vbaRecorderRecordingChangedEvent=3200]="vbaRecorderRecordingChangedEvent";e[e.vbaRecorderRecordingChanged2Event=3202]="vbaRecorderRecordingChanged2Event";e[e.workbookActionRecordedEvent=3201]="workbookActionRecordedEvent";e[e.externalCodeServiceDiagnosticsNewEntryEvent=3300]="externalCodeServiceDiagnosticsNewEntryEvent";e[e.externalCodeServiceDiagnosticsFilterUpdatedEvent=3301]="externalCodeServiceDiagnosticsFilterUpdatedEvent";e[e.rangeValuesPreviewDismissedEvent=3400]="rangeValuesPreviewDismissedEvent";
e[e.applicationUndoChangedEvent=3500]="applicationUndoChangedEvent";e[e.linkedEntityDataDomainLinkedEntityDataDomainAddedEvent=3600]="linkedEntityDataDomainLinkedEntityDataDomainAddedEvent";e[e.linkedEntityDataDomainRefreshCompletedEvent=3601]="linkedEntityDataDomainRefreshCompletedEvent";e[e.linkedEntityDataDomainRefreshModeChangedEvent=3602]="linkedEntityDataDomainRefreshModeChangedEvent";e[e.externalCodeServiceInitializationSettingsEnvironmentDefinitionInitializationResponseReceivedEvent=3603]=
"externalCodeServiceInitializationSettingsEnvironmentDefinitionInitializationResponseReceivedEvent";e[e.tableApplyPowerQueryTableUpdatePlanCompletedEvent=3604]="tableApplyPowerQueryTableUpdatePlanCompletedEvent";e[e.externalCodeServiceInitializationSettingsEnvironmentDefinitionResponseReceivedEvent=3605]="externalCodeServiceInitializationSettingsEnvironmentDefinitionResponseReceivedEvent";e[e.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";e[e.beforeCloseNotifiactionCancelledEvent=
65540]="beforeCloseNotifiactionCancelledEvent";e[e.augmentationLoopAnnotationAddedEvent=65541]="augmentationLoopAnnotationAddedEvent";e[e.premiumLicenseChangedEvent=65542]="premiumLicenseChangedEvent"})(f||(f={}));Object(y.b)("MessageType",f);var k=a(1005),x=a(227),d=a(958),h=a(58),n=a(43),m=a(197),u=a(1),l=a(5);class t{constructor(e,w){this.HF=null;this.o3g={};this.s3g={};this.fHd={};this.C7d={};this.NQd=(z,E)=>{z=this.$.Vb.Uc("Task","DdaEventDispatch.HandleServerEvent");E=E.xPg;for(let N=0;N<E.length;N++)switch(E[N].EventType){case 2:var M=
E[N],G={};G.Name=M.Name;G.BindingType=M.BindingType;G.ColCount=M.ColCount;G.RowCount=M.RowCount;this.dHa(M.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,G,null);break;case 4:this.dHa(E[N].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(M=E[N],M.InstanceId){G=Array(M.Entries.length);for(var A=0;A<M.Entries.length;A++)G[A]=t.$Ac(M.Entries[A],M.IsRemoteOverride);0<M.Entries.length&&1===M.Entries[0].Category?this.Ufk(M.InstanceId,G):M.InstanceId&&this.dHa(M.InstanceId,
OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,G)}else{this.fHd={};this.C7d={};for(G=0;G<M.Entries.length;G++)this.Jpf(M.Entries[G],M.IsRemoteOverride);M=JSON.stringify(this.fHd);G=JSON.stringify(this.C7d);A=JSON.stringify(this.o3g);const K=JSON.stringify(this.s3g);c.ULS.sendTraceTag(537170593,0,50,`Number of Fired event: ${M}, Number of Not Fired event: ${G}, Total Number of Fired event: ${A}, Total Number of Not Fired event: ${K}`)}}z.stop()};this.v5b=(z,E)=>{this.dHa(z,OSF.DDA.EventDispId.dispidRichApiMessageEvent,
null,E)};this.$=e;this.ddaFacade=w;this.YWc=this.NQd}zlc(e){e&&(this.vsa(),this.HF.push(e))}fUc(e){this.HF&&(Array.remove(this.HF,e),this.HF.length||(this.$.wantServerEvents=!1,this.$.Puk(this.YWc),this.HF=null))}Ufk(e,w){const z=l.DdaFacadeService.Oa()?this.ddaFacade:Object(b.a)(d.DdaFacade,x.a(this.$));n.TaskExtensions.tb(z.cXi(e),E=>{if(m.b(E)){var M=E.result;E=z.Rp(M);if(M)if(E.oHc)this.dHa(M,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,w);else if(E.Hsc)for(M=0;M<w.length;M++)E.Hsc.push(w[M]);
else E.Hsc=w}else E.Ng?c.ULS.sendTraceTag(537170591,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):E.fi&&c.ULS.sendTraceTag(537170590,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.Aa,0)}rgk(e,w){const z=l.DdaFacadeService.Oa()?this.ddaFacade:Object(b.a)(d.DdaFacade,x.a(this.$)),E=z.SIi(e);E?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(E,w,this.v5b):z.n5h(e,w)}Jpf(e,
w){let z=!1;const E=parseInt(e.Type,10);var M=e.Target;const G=l.DdaFacadeService.Oa()?this.ddaFacade:Object(b.a)(d.DdaFacade,x.a(this.$));if((M=G.xi.lXi(E,M))&&0<Object.keys(M).length){z=!0;for(const N in M)if(M=N,G.xi.Zmc(M)){const K=Array(1);K[0]=t.$Ac(e,w);if(u.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var A=K[0][3];if(void 0!==A&&null!==A&&(A=Object(b.a)(Object,h.a.Xj(A)))&&void 0!==A.triggerControlId&&null!==A.triggerControlId&&void 0!==A.triggerSource&&
null!==A.triggerSource){let I=!1;w?(A.triggerSource="Unknown",I=!0):G.Hii(A.triggerControlId,M)&&(A.triggerSource="ThisLocalAddin",I=!0);I&&(K[0][3]=h.a.Nc(A))}}this.dHa(M,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,K)}}z?(this.JDc(f[E],this.fHd),this.JDc(f[E],this.o3g)):(this.JDc(f[E],this.C7d),this.JDc(f[E],this.s3g))}vsa(){this.HF||(this.HF=[],this.$.Z4e(this.YWc),this.$.wantServerEvents=!0)}JDc(e,w){e in w||(w[e]=0);w[e]+=1}vK(e,w,z){const E={};E.Target=w;E.Category=65536;E.Type=e;E.Message=
z;E.Id=-1;this.Jpf(E,!1)}bCi(e,w){const z={Target:"",Category:2,Type:1E3};z.Message=w;z.Id=0;w=Array(1);w[0]=t.$Ac(z,!1);this.rgk(e,w)}yxc(e,w,z,E){const M={};M.Target=z;M.Category=65536;M.Type=w;M.Message=E;M.Id=-1;w=Array(1);w[0]=t.$Ac(M,!1);this.dHa(e,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,w)}aCi(e,w){this.dHa(e,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,w)}dHa(e,w,z,E){if(this.HF){var M=l.DdaFacadeService.Oa()?this.ddaFacade:Object(b.a)(d.DdaFacade,x.a(this.$));if(!M||w!==
OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&w!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||M.xi.Zmc(e)){e=new k.a(w,e,z,E);for(let G=0,A=this.HF.length;G<A;G++)(w=this.HF[G])&&w(e)}}}static $Ac(e,w){const z=Array(6);z[0]=e.Category;z[1]=e.Type;z[2]=e.Target;z[3]=e.Message;z[4]=e.Id;z[5]=w;return z}}Object(y.a)(t,"DdaEventDispatch",null,[])},1660:function(y,r,a){a.d(r,"a",function(){return f});y=a(0);r=a(238);var c=a(488),b=a(24);class f extends r.a{constructor(){super(void 0,void 0,void 0,
!0);this.fPa="AddinCommandsUILessDialog";this.bld="WACDialogTitleText";this.n5="0";this.pJ=380;this.bH=190;this.uf=this.fPa;this.hc=5;this.Tkh=String.format("{0}px",this.pJ);this.m5=String.format("{0}px",this.bH);this.ZQd=this.ov=!1;this.rB()}rB(){super.rB();this.fj.style.width=this.Tkh;this.fj.style.height=this.m5;this.fj.style.padding=this.n5}HG(k){this.IO();document.getElementById(this.qj(this.bld)).innerText=k}IO(){super.IO();this.Fb.style.width=String.format("{0}px",this.pJ);this.Fb.style.height=
String.format("{0}px",this.bH);this.Fb.removeAttribute(c.a.Ae);this.Fb.removeAttribute(c.a.GP)}hide(){this.Pjb()}get Tia(){return this.fj}initializeAndShowWithTitle(){this.initializeAndShow(Object(b.a)("NotificationUITitle"),null,null)}}Object(y.a)(f,"AddinCommandsUILessDialog",r.a,[171])},1678:function(y,r,a){a.d(r,"a",function(){return x});y=a(0);var c=a(254),b=a(112);class f{constructor(){this.xrf=this.displayName=this.MJb=this.Hq=this.pG=null;this.isUpgraded=!1}s4f(d,h){return this.pG.getStoreType().toLowerCase()===
d.toLowerCase()&&this.pG.getSolutionId().toLowerCase()===h.toLowerCase()}}Object(y.a)(f,"AddinCommandsResourceItem",null,[]);var k=a(24);class x{constructor(){this.G6c=null;this.$ad=0;this.Jcd=!1;this.xb=new b.a;this.Hoh=new c.a}BCh(d){this.xb.addHandler("AddinCommandsLoadingMessageChanged",d)}Hrk(d){this.xb.removeHandler("AddinCommandsLoadingMessageChanged",d)}get SCa(){return this.G6c}eub(d){d!==this.G6c&&(this.G6c=d,this.xb.raiseEvent("AddinCommandsLoadingMessageChanged"))}hIk(){this.$ad++;this.SCa||
this.eub(Object(k.a)("LoadingAddInsTitle"))}Woe(){this.$ad--;this.wKc()&&(this.Jcd?this.SCa!==Object(k.a)("ErrorLoadingAddInsTitle")&&this.eub(Object(k.a)("ErrorLoadingAddInsTitle")):this.eub(null))}QQg(d){this.Jcd=!0;this.eub((void 0===d?0:d)?Object(k.a)("InstallingCustomFunctionsErrorStatusBarMsg"):Object(k.a)("ErrorLoadingAddInsTitle"))}Fef(){this.Jcd=!1;this.wKc()?this.eub(null):this.eub(Object(k.a)("LoadingAddInsTitle"))}wKc(){return 0>=this.$ad}get ykb(){return this.Hoh}Qsa(d,h,n){n=void 0===
n?0:n;for(const m of this.ykb)if(m.s4f(d,h)&&(!m.Hq||m.Hq.mIi===n))return m;return null}R2e(d,h,n,m){const u=new f;u.pG=d;u.Hq=h;u.MJb=n;u.displayName=m;this.ykb.add(u)}qAh(d,h,n,m){const u=new f;u.pG=d;u.Hq=h;u.MJb=null;u.xrf=n;u.displayName=m;this.ykb.add(u)}Spk(d,h){let n=0;for(const m of this.ykb)m.pG.getStoreType()===d&&m.pG.getSolutionId()===h?this.ykb.removeAt(n):n++}static getInstance(){x.Wa||(x.Wa=new x);return x.Wa}}x.Wa=null;Object(y.a)(x,"AddinCommandsResourceManager",null,[])},370:function(y,
r,a){function c(D){return{[zf.a.ebc]:0,[zf.a.aFe]:1,[zf.b.$4c]:df.lEe,[zf.b.X4c]:df.eEe,[zf.b.YCe]:df.fEe,[zf.b.Y4c]:df.gEe,[zf.b.a5c]:df.nEe,[zf.b.Z4c]:df.hEe,[zf.b.ZCe]:df.kEe,[zf.b.$Ce]:df.mEe,[zf.b.Qac]:df.iEe,[zf.b.Rac]:df.jEe,[zf.a.efh]:2147500033,[zf.a.j5c]:2147647531,[zf.a.t5c]:2147942487,[zf.a.Fail]:2147500037}[D]}function b(){return Kf.a.instance.pKd("NewClpCopilotTelemetryEnabled")}a.r(r);var f={};a.r(f);a.d(f,"AgaveCommandHandler",function(){return J});var k={};a.r(k);a.d(k,"AgaveListenerHandler",
function(){return Y});var x={};a.r(x);a.d(x,"AgaveOnSelectedReadoutHandler",function(){return ea});var d={};a.r(d);a.d(d,"DdaMethodHandler",function(){return ra});var h={};a.r(h);a.d(h,"MacroRecorderEventHandler",function(){return kj});var n={};a.r(n);var m={};a.r(m);a.d(m,"SmartLookupCommandHandler",function(){return Xa});var u=a(133),l=a(0),t=a(6),e=a(615),w=a(25),z=a(29),E=a(43),M=a(1),G=a(209),A=a(36),N=a(369),K=a(5),I=a(684),L=a(65);let J=class{constructor(D,ma){this.$=D;this.agaveCommandManager=
ma;this.Mre=vb=>t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.flyoutStoreExpEnabled",!1)&&"InsertMoreAddInsFromFooter"===(null===vb||void 0===vb?void 0:vb.SourceControlId)?!0:!1;this.ha=w.f(this.$).ha;this.oa=this.ha.oa}td(){return!1}gd(){return!1}Rc(D,ma,vb,lc){let Nc=!1;switch(ma.command){case -684355545:Nc=!0;break;case -741808261:Nc=!!vb;break;case -859308420:Nc=!!lc&&1===lc.DH;break;case 418618014:Nc=1===D&&!!lc&&1===lc.DH;break;case -167264441:Nc=z.a.pUb(this.$)&&
1===D&&!!lc&&1===lc.DH;break;case -515602470:Nc=1===D&&!!lc&&1===lc.DH;break;case -1444574190:case -336193495:Nc=1===D&&!!lc&&1===lc.DH;break;case 1296389134:Nc=!this.Mre(vb)&&1===D&&!!lc&&1===lc.DH;break;case 1221897806:Nc=M.EwaSettings.Ra(155)&&2===D;break;case 1172793074:case 1930653487:Nc=M.EwaSettings.Ra(155)&&2===D;break;case -1753056834:Nc=!0;break;case 932597253:Nc=!0;break;case 301511274:Nc=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:Nc=
M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",!0)&&this.$.isEditMode;break;case 1723441034:Nc=this.$.isEditMode&&this.$.fa.M6b;break;case -1997160483:Nc=z.a.CN()&&this.$.isEditMode&&this.oa.fE();break;case 1485761473:Nc=z.a.CN()&&this.$.isEditMode;break;case 762629271:Nc=z.a.CN()&&M.EwaSettings.isChangeGateEnabled("OfficeVSO:8386937_NoCopilotTaskPaneWhenNoExtractPermissions")}return Nc}executeCommand(D,ma,vb){D=E.TaskExtensions.kl();const lc=ma.command;switch(ma.command){case 1296389134:t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowFlyoutSurveyOnExcelEnabled",
!1)&&e.a.instance.getItem("removeFlyoutTaskTimeoutId")&&(window.clearTimeout(Number(e.a.instance.getItem("removeFlyoutTaskTimeoutId"))),e.a.instance.removeItem("removeFlyoutTaskTimeoutId"));this.agaveCommandManager.O_k(vb.SourceControlId,vb.LabelText);break;case -684355545:this.agaveCommandManager.Wtd();break;case -741808261:D=this.agaveCommandManager.insertAgave(vb,ma);break;case 1172793074:M.EwaSettings.Ra(155)&&(D=this.agaveCommandManager.fCc(vb,ma));break;case -1997160483:case 1485761473:if(M.EwaSettings.isChangeGateEnabled("OfficeVSO:8386937_NoCopilotTaskPaneWhenNoExtractPermissions")&&
this.iji()){this.Q6h();break}D=this.agaveCommandManager.fCc(vb,ma);break;case -859308420:case -515602470:case -167264441:case -336193495:case -1444574190:case 418618014:case 1221897806:case 1930653487:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:case 762629271:D=this.agaveCommandManager.fCc(vb,ma);M.EwaSettings.EN()&&this.$.lza();break;default:D=G.a(lc)}return D}iji(){var D=this.$.Fe;const ma=D.get(1),vb=D.get(4);D=D.get(117);return(ma||vb)&&!D}Q6h(){const D=A.a.Cd(1,
1,751,2407,0,0,"CopilotNoExtractPermissionsErrorDialog");new N.a(this.$,D)}};J=Object(u.__decorate)([Object(L.d)(K.AgaveCommandHandlerService),Object(u.__param)(0,Object(K.EwaControlService)()),Object(u.__param)(1,Object(I.a)())],J);Object(l.a)(J,"AgaveCommandHandler",null,[29]);var B=a(15);let Y=class{constructor(D){this.$=D;this.DRf=ma=>{if(null!==ma&&void 0!==ma&&ma.data&&(ma=ma.data)&&"OfficeCopilotExcelTaskPane"===ma.Origin)switch(ma.Event){case "Office.Excel.Copilot.AnalyzeReceived":this.m$(-168711560);
break;case "Office.Excel.Copilot.GenerateReceived":this.m$(-1805433217);break;case "Office.Excel.Copilot.CommandReceived":this.m$(-112212005);break;case "Office.Excel.Copilot.AnalyzeApplied":this.m$(347349230);break;case "Office.Excel.Copilot.GenerateApplied":this.m$(-2005275355);break;case "Office.Excel.Copilot.CommandApplied":this.m$(306959157);break;default:B.ULS.sendTraceTag(508044939,0,10,"AgaveListenerHandler.handleMessageReceived - Unhandled Event.")}}}addListener(){window.addEventListener("message",
this.DRf,!1)}removeListener(){window.removeEventListener("message",this.DRf,!1)}m$(D){this.$.Dc(D,-1,0,null)}};Y=Object(u.__decorate)([Object(L.d)(K.AgaveListenerHandlerService),Object(u.__param)(0,Object(K.EwaControlService)())],Y);Object(l.a)(Y,"AgaveListenerHandler",null,[]);var U=a(91),O=a(363),C=a(154),X=a(57),S=a(53);let ea=class{constructor(D,ma){this.y3a=this.z3a=null;this.$3g=(vb,lc)=>{let Nc=null,wd=null,Yd=null;lc?(Object(O.a)(230,lc)?(Nc=lc.eGb,Yd=lc.instanceId):Object(O.a)(314,lc)&&(Nc=
lc.get_element(),Yd=lc.instanceId),Nc)?(wd=Object(C.a)(315,vb),wd)?this.sDg(Yd,Nc,wd)||Yd in this.y3a||(this.z3a[Yd]=0,this.y3a[Yd]=X.a.instance.fK(()=>{10<=this.z3a[Yd]||this.sDg(Yd,Nc,wd)?(delete this.z3a[Yd],this.y3a[Yd].dispose(),delete this.y3a[Yd]):this.z3a[Yd]+=1},500,S.a.THh,!0,!1)):B.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):B.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):B.ULS.sendTraceTag(537170626,
0,10,"Invalid parameter for ReadoutSelection")};this.ariaLiveNotifier=D;this.$=ma;this.nrd=!1}Ea(D){this.nrd?B.ULS.sendTraceTag(537170629,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):(this.nrd=!0,this.y3a={},this.z3a={},D?D.rDh(this.$3g):B.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))}detach(D){if(D){D.ssk(this.$3g);D=this.y3a;for(const ma in D)U.a.vb(D[ma]);this.z3a=this.y3a=null;this.nrd=!1}else B.ULS.sendTraceTag(537170627,
0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")}sDg(D,ma,vb){if(this.jmj(vb,D))return!1;D=ma.querySelector("iframe");if(!D)return B.ULS.sendTraceTag(537170595,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;D=D.title;if(!D||!D.length)return B.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;this.ariaLiveNotifier.readText(D);return!0}jmj(D,ma){return(D=D.Cf.getOsfControl(ma))?
D.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0}};ea=Object(u.__decorate)([Object(L.d)(K.AgaveOnSelectedReadoutHandlerService),Object(u.__param)(0,Object(K.AriaLiveNotifierService)()),Object(u.__param)(1,Object(K.EwaControlService)())],ea);Object(l.a)(ea,"AgaveOnSelectedReadoutHandler",null,[316]);var Oa=a(958),Ha=a(19);const Za=Object(Ha.b)("Common.App.WopiIdentity.WopiIdentityManager"),fa=Object(Ha.c)(Za);var la=a(1615);class ba{constructor(){this.context=null;this.errorCode=0}}Object(l.a)(ba,
"NestedAppAuthContextResult",null,[]);class aa{static PMd(D,ma){const vb=new ba;(D=D.getOsfControl(ma))&&D.isFirstParty()||t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AgaveAuthContextApiEnabled",!1)?(vb.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,D={},ma=t.AFrameworkApplication.ea.Qa("AADUserObjectId"),D.userObjectId=ma?ma:t.AFrameworkApplication.ea.Qa("LoggableUserId"),D.userPrincipalName=t.AFrameworkApplication.ea.Qa("UserPrincipalName"),D.tenantId=
t.AFrameworkApplication.ea.Qa("TenantId"),D.puid=t.AFrameworkApplication.ea.Qa("Puid"),D.authorityBaseUrl=t.AFrameworkApplication.ea.Qa("HostAuthAuthority"),ma=(t.AFrameworkApplication.ea.Qa("HostAuthType")||"").toLowerCase(),D.authorityType="aad"===ma?"aad":"msa"===ma?"msa":"other",vb.context=D):vb.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeAccessDenied;return vb}}Object(l.a)(aa,"NestedAppAuthUtil",null,[]);var oa=a(1150),Na=a(1304),Ia=a(1208);class Sa{}Sa.generalException="generalException";
Sa.invalidArgument="invalidArgument";Sa.Chg="notAllowed";Sa.xmc="apiNotAvailable";Sa.Pal="unresolvedPendingRequest";Sa.timeout="timeout";Sa.mnd="adalTimeout";Sa.S$b="userNotSignedIn";Sa.Zwb="userAborted";Sa.jYg="silentSignInFailed";Sa.Bkb="invalidResourceUrl";Sa.Akb="invalidGrant";Sa.Khf="connectionLost";Sa.bqc="clientError";Sa.serverError="serverError";Object(l.a)(Sa,"WopiHostErrorCodes",null,[]);var Pa=a(948),za=a(609);class wa{}Object(l.a)(wa,"OAuthCallerMetadata",null,[]);var db=a(39),Ba=a(24);
class Ka{constructor(D){this.Xva=D;this.jmh=t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}yxh(D,ma,vb,lc,Nc,wd){if(!this.Xva)return lc=new Na.a,lc.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(lc);const Yd=new wa;Yd.AddinName=Nc;Yd.AddinTrustId=wd;let ee=-1,ae=-1;wd=null;const he=t.AFrameworkApplication.ea.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.EnableAddinPopupTimerTelemetry"),De=(Se,
qf,kg,$f,Cg)=>{const sg=Date.now();return this.Xva.qza(Se,qf,kg,$f,Cg).then(ng=>{ae=Date.now()-sg;return ng})};if(lc&&this.K1f())wd=he?De(Pa.a.Nvb,D,lc,Ka.MAc(Nc),Yd):this.Xva.qza(Pa.a.Nvb,D,lc,Ka.MAc(Nc),Yd);else{const Se=Date.now();wd=this.Xva.ey(Pa.a.Nvb,D,Yd).then(qf=>{ee=Date.now()-Se;const kg=(ma||vb)&&("login_required"===qf.ErrorCode||"Cookies Disabled"===qf.ErrorCode);return(ma&&("interaction_required"===qf.ErrorCode||"consent_required"===qf.ErrorCode||"invalid_grant"===qf.ErrorCode||"UserInteractionRequired"===
qf.ErrorCode)||kg)&&this.K1f()?he?De(Pa.a.Nvb,D,null,Ka.MAc(Nc),Yd):this.Xva.qza(Pa.a.Nvb,D,null,Ka.MAc(Nc),Yd):Promise.resolve(qf)})}return wd.then(Se=>{const qf=new Na.a;Se.IsSuccess?(qf.token=Se.Token,Se.Telemetry&&(qf.d7a=Se.Telemetry.fromCache,qf.expiresOn=Se.Telemetry.expiresOn)):(qf.errorCode=this.LJj(Se),qf.Bwe=this.w$j(Se));return qf}).catch(()=>{const Se=new Na.a;Se.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(Se)}).then(Se=>{Se.mDa="OauthManager";
0<=ee&&(Se.MXa=ee);0<=ae&&(Se.tBc=ae);return Se})}Fpj(D){const ma=(t.AFrameworkApplication.ea.Qa(t.AFrameworkApplication.fW)||"").toLowerCase();return(t.AFrameworkApplication.ea.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.Enable3rdPartySsoApiForTeams")||!(db.a.CIa||"teams"===ma&&za.a.hostPageSupportsAuth)||Ka.hpj(D))&&this.Xva&&this.Xva.jZa()?!0:!1}K1f(){return this.jmh||1!==Ia.a.Jyc()}LJj(D){switch(D.ErrorCode){case "UserCancelled":case "interaction_required":D=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;
break;case "UserInteractionRequired":case "consent_required":case "invalid_grant":D=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":D=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":D=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":D=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":D=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;
break;default:D=D.ErrorCode===Sa.Zwb?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:D.ErrorCode===Sa.jYg?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:D.ErrorCode===Sa.Bkb?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:D.ErrorCode===Sa.Akb?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:D.ErrorCode===Sa.Khf?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return D}w$j(D){let ma="";(D=RegExp("AADSTS(\\d+)").exec(D.ErrorMessage))&&
1<D.length&&(ma=D[1]);return ma}static MAc(D){return String.format(Object(Ba.a)("SSOSignInNeededNotification_Description_Text_Addins"),D)}static hpj(D){if(!D)return!1;D=D.toLowerCase();for(const ma of la.a.ZBf)if(ma===D)return!0;return!1}}Object(l.a)(Ka,"AppsforOfficeTokenFromOauthManager",null,[438]);class da{constructor(D){this.NIj=D}static Nfa(){if(t.AFrameworkApplication.ea.ka("AppForOfficeSSOV2IsEnabled")){var D=null;try{D=Object(Ha.a)(oa.a)}catch(ma){B.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+
ma)}D=new Ka(D);da.Wa=new da(D)}}static getInstance(){da.aOe||(da.Nfa(),da.aOe=!0);return da.Wa}}da.Wa=null;da.aOe=!1;Object(l.a)(da,"AppsForOfficeOauthManagerFactory",null,[415]);var sa=a(249),mb=a(189),Ma=a(1488),hb=a(190);class $a{constructor(D,ma,vb,lc){this.menuItemId=D;this.fA=ma;this.c1k=vb;this.hAi=lc}}Object(l.a)($a,"NewDocumentParameters",null,[]);var Va=a(10),xa=a(1022);const ia=D=>{var ma=D.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",
3,0);var vb=ma.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);vb.addParameter("shortcuts","String[]",1,null,0);ma.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);vb=ma.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);vb.addParameter("shortcuts","Object",1,null,0);ma=D.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);vb=ma.addMethod("GetSharedFilePickerResponse",1,"Object",
1,1,"SharedFilePickerResponse",0);vb.addParameter("pickerCustomizationJsonString","String",1,null,0);Object(xa.a)()&&(ma=D.addEnumType("Microsoft.Authentication.IdentityType"),ma.addEnumField("OrganizationAccount",0),ma.addEnumField("MicrosoftAccount",1),ma.addEnumField("Unsupported",2),ma=D.addEnumType("Microsoft.Authentication.AuthorityType"),ma.addEnumField("External",0),ma.addEnumField("Msa",1),ma.addEnumField("Aad",2),ma=D.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}",
"{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0),ma.addProperty("DisplayName",4,"String",1,!1,null,0),ma.addProperty("Email",3,"String",1,!1,null,0),ma.addProperty("FederationProvider",2,"String",1,!1,null,0),ma.addProperty("IdentityType",1,"Microsoft.Authentication.IdentityType",1,!1,null,0),ma=D.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}","{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0),ma.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",
3,!0,null,0),vb=ma.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4),vb.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0),ma.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",2,1,"PrimaryIdentityInfo",4),ma=D.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0),ma.addProperty("AppName",8,"String",1,!1,null,
0),ma.addProperty("AuthChallenge",3,"String",1,!1,null,0),ma.addProperty("CorrelationId",7,"String",1,!1,null,0),ma.addProperty("Policy",4,"String",1,!1,null,0),ma.addProperty("Resource",2,"String",1,!1,null,0),ma.addProperty("Scope",5,"String",1,!1,null,0),ma.addProperty("SilentLogin",6,"Boolean",1,!1,null,0),ma=D.addType("Microsoft.Authentication.SingleSignOnToken","{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0),ma.addProperty("AccessToken",2,"String",1,!1,
null,0),ma.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0),ma=D.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0),ma.addProperty("Id",1,"String",1,!0,null,0),ma.addProperty("Value",2,"Object",1,!1,null,0),ma=D.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}","",3,0),vb=ma.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0),vb.addParameter("id",
"String",1,null,0),vb=ma.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0),vb.addParameter("id","String",1,null,0));ma=D.addType("Microsoft.Office.Auth","{8f3d8395-fba3-422f-9e98-33e38d23c2ba}","{e1b105a8-d9d5-4fc8-aa4e-3d90aeb48abf}",3,2);vb=ma.addMethod("GetAccessTokenFirstPartyOAuth",1,"Object",1,1,"AccessTokenFirstPartyOAuth",4);vb.addParameter("appName","String",1,null,0);vb.addParameter("target","String",1,null,0);ma=D.addType("Microsoft.Office.AugLoopHostMessageReceivedEventArgs",
"{52ebe40e-6476-4f8d-81cb-89f5c90e2e76}","{891f2f5b-6598-4c8e-af9d-dc48bf34839f}",2,0);ma.addProperty("Data",4,"String",1,!1,null,0);ma=D.addType("Microsoft.Office.AugLoopEventService","{846cb932-2065-4d2e-b051-5d6673cca2d9}","{019765ca-6d77-447a-9bd8-b07dc47bc657}",3,2);vb=ma.addMethod("SendMessage",1,"Void",0,1,"SendMessage",4);vb.addParameter("data","String",1,null,0);ma.addMethod("_RegisterHostMessageReceivedEvent",2,"Void",0,1,"_RegisterHostMessageReceivedEvent",4);ma.addMethod("_UnregisterHostMessageReceivedEvent",
3,"Void",0,1,"_UnregisterHostMessageReceivedEvent",4);ma=D.addType("Microsoft.Office.CopilotOperationStartedEventArgs","{45400499-b374-4bc9-a709-18989d9cebd1}","{a7c458d5-f043-4d71-b091-03160b2c450e}",2,0);ma.addProperty("BatchId",6,"String",1,!1,null,0);ma=D.addType("Microsoft.Office.UndoService","{69f39738-6c6b-4497-9833-02728cf72dc3}","{9628bdd5-9267-4ca8-8162-82d0a7e484f8}",3,2);vb=ma.addMethod("EndCopilotOperation",5,"Void",0,0,"EndCopilotOperation",4);vb.addParameter("batchId","String",1,null,
0);vb=ma.addMethod("StartCopilotOperation",4,"Boolean",1,0,"StartCopilotOperation",4);vb.addParameter("batchId","String",1,null,0);ma.addMethod("Undo",1,"Boolean",1,0,"Undo",4);ma.addMethod("_RegisterUndoStackChangedEvent",2,"Void",0,1,"_RegisterUndoStackChangedEvent",4);ma.addMethod("_UnregisterUndoStackChangedEvent",3,"Void",0,1,"_UnregisterUndoStackChangedEvent",4);ma=D.addEnumType("Microsoft.Office.TriStateOption");ma.addEnumField("NotSet",0);ma.addEnumField("True",1);ma.addEnumField("False",
2);ma=D.addEnumType("Microsoft.Office.UserFeedbackType");ma.addEnumField("Like",0);ma.addEnumField("Dislike",1);ma.addEnumField("Idea",2);ma.addEnumField("Unclassified",3);ma=D.addEnumType("Microsoft.Office.UserFeedbackUIType");ma.addEnumField("ModalDialog",0);ma.addEnumField("Taskpane",1);ma=D.addType("Microsoft.Office.UserFeedbackContextDataFileInformation","{21b1ea50-e97e-4893-8a5e-96984282bebf}","{d128c57c-e563-4a69-8a81-2c481938c1d8}",2,0);ma.addProperty("Base64Data",8,"String",1,!1,null,0);
ma.addProperty("FileName",6,"String",1,!1,null,0);ma.addProperty("FileType",7,"String",1,!1,null,0);ma=D.addType("Microsoft.Office.UserFeedbackScenarioQuestionStringType","{d2d93fa6-df0d-49db-8b8a-cda39d2accdd}","{cecae31e-da58-44e2-aee7-e9d07c49aef4}",2,0);ma.addProperty("DisplayedString",16,"String",1,!1,null,0);ma.addProperty("DisplayedStringInEnglish",17,"String",1,!1,null,0);ma=D.addType("Microsoft.Office.UserFeedbackScenarioQuestionDetails","{f1875c86-5668-4f56-992e-e6a1b6af0262}","{78a630fd-480c-4f73-85b0-2185ad58dbc2}",
2,0);ma.addProperty("QuestionInstruction",13,"Microsoft.Office.UserFeedbackScenarioQuestionStringType",2,!1,null,0);ma.addProperty("QuestionOptions",14,"Microsoft.Office.UserFeedbackScenarioQuestionStringType[]",2,!1,null,0);ma.addProperty("QuestionUIBehavior",15,"String[]",1,!1,null,0);ma.addProperty("QuestionUIType",12,"String",1,!1,null,0);ma=D.addType("Microsoft.Office.UserFeedbackScenarioConfig","{0ce6634a-8328-403a-9bed-9efdb763a386}","{3d0ddc8f-b131-4928-8dec-a624ac5ce35e}",2,0);ma.addProperty("IsScenarioEnabled",
9,"Boolean",1,!1,null,0);ma.addProperty("Question",11,"Microsoft.Office.UserFeedbackScenarioQuestionDetails",2,!1,null,0);ma.addProperty("ScenarioType",10,"String",1,!1,null,0);ma=D.addType("Microsoft.Office.UserFeedbackAiChatHistory","{65332057-3d51-48b4-91de-0e8aecf6dc3d}","{dc6ce264-c94e-4fc0-8e10-577a8c041e20}",2,0);ma.addProperty("ErrorType",55,"String",1,!1,null,0);ma.addProperty("Message",53,"String",1,!1,null,0);ma.addProperty("User",54,"String",1,!1,null,0);ma=D.addType("Microsoft.Office.FeedbackUserData",
"{250faa2f-30a4-413c-8520-7d0d1fd2067e}","{21dd2535-0df7-44cf-a759-ebeb0b8e102f}",2,0);ma.addProperty("AiChatHistory",52,"Microsoft.Office.UserFeedbackAiChatHistory[]",2,!1,null,0);ma.addProperty("AiErrorType",51,"String",1,!1,null,0);ma.addProperty("AiInteractionId",47,"String",1,!1,null,0);ma.addProperty("AiPrompt",48,"String",1,!1,null,0);ma.addProperty("AiPromptId",49,"String",1,!1,null,0);ma.addProperty("AiResponseMessage",50,"String",1,!1,null,0);ma=D.addType("Microsoft.Office.UserFeedbackV2Config",
"{6fb0b66c-2f8d-4df9-bc61-208588109b44}","{28b6a6c5-384d-4ab0-bb7b-a6c78deed8e5}",2,0);ma.addProperty("AccountCountryCode",43,"String",1,!1,null,0);ma.addProperty("AffectedProcessSessionId",44,"String",1,!1,null,0);ma.addProperty("AppVersion",45,"String",1,!1,null,0);ma.addProperty("ContextDataFiles",4,"Microsoft.Office.UserFeedbackContextDataFileInformation[]",2,!1,null,0);ma.addProperty("EntryPoint",39,"String",1,!1,null,0);ma.addProperty("FeatureName",40,"String",1,!1,null,0);ma.addProperty("FeedbackUserData",
38,"Microsoft.Office.FeedbackUserData",2,!1,null,0);ma.addProperty("HostManagedContextDataExplanationUrl",25,"String",1,!1,null,0);ma.addProperty("IntegrationSource",41,"String",1,!1,null,0);ma.addProperty("IsEmailCollectionEnabled",22,"Microsoft.Office.TriStateOption",1,!1,null,0);ma.addProperty("IsFileUploadEnabled",20,"Microsoft.Office.TriStateOption",1,!1,null,0);ma.addProperty("IsHostManagedContextDataEnabled",24,"Microsoft.Office.TriStateOption",1,!1,null,0);ma.addProperty("IsRetrieveFormDataEnabled",
26,"Microsoft.Office.TriStateOption",1,!1,null,0);ma.addProperty("IsScreenRecordingEnabled",31,"Microsoft.Office.TriStateOption",1,!1,null,0);ma.addProperty("IsScreenshotEnabled",21,"Microsoft.Office.TriStateOption",1,!1,null,0);ma.addProperty("IsThankYouPageDisabled",23,"Microsoft.Office.TriStateOption",1,!1,null,0);ma.addProperty("ScenarioConfig",5,"Microsoft.Office.UserFeedbackScenarioConfig",2,!1,null,0);ma.addProperty("SubFeatureName",42,"String",1,!1,null,0);ma.addProperty("UiHost",46,"String",
1,!1,null,0);ma=D.addType("Microsoft.Office.UserFeedbackOptions","{a2797168-aee4-4884-a718-324db59831b0}","{ae223634-80d7-4cd7-aedf-7a202501376b}",2,0);ma.addProperty("TelemetryData",2,"String",1,!1,null,0);ma.addProperty("V2Config",3,"Microsoft.Office.UserFeedbackV2Config",2,!1,null,0);ma=D.addType("Microsoft.Office.UserFeedbackUIDismissedEventArgs","{df85e6f2-da7b-4b75-8bbf-5bade8628aa9}","{44b87528-d60f-495f-96ef-00f35dad35fc}",2,0);ma.addProperty("IsFeedbackSent",20,"Boolean",1,!1,null,0);ma=
D.addType("Microsoft.Office.UserFeedbackResponseEventArgs","{c68eaffd-8d93-415f-ac0f-cb264aaef767}","{3d0ecef1-777e-43f4-b09e-2abdf49e9b16}",2,0);ma.addProperty("ResponseData",30,"String",1,!1,null,0);ma=D.addEnumType("Microsoft.Office.UserFeedbackScreenshotInfoSourceType");ma.addEnumField("AutoCapture",0);ma.addEnumField("AutoCaptureWithHtml2Canvas",1);ma.addEnumField("ProvidedAtInitialization",2);ma.addEnumField("DynamicallyProvided",3);ma=D.addEnumType("Microsoft.Office.UserFeedbackScreenshotInfoImageFormat");
ma.addEnumField("jpeg",0);ma.addEnumField("png",1);ma=D.addType("Microsoft.Office.UserFeedbackScreenshotInfo","{8c240fae-21d2-4f43-8079-cdce416f5029}","{f64c6a1e-7c07-4faa-a479-01491dde1787}",2,0);ma.addProperty("ScreenshotBase64",36,"String[]",1,!1,null,0);ma.addProperty("ScreenshotImageFormat",37,"Microsoft.Office.UserFeedbackScreenshotInfoImageFormat",1,!1,null,0);ma.addProperty("ScreenshotSourceType",35,"Microsoft.Office.UserFeedbackScreenshotInfoSourceType",1,!1,null,0);ma=D.addType("Microsoft.Office.UserFeedbackService",
"{92a3da31-eaf9-4225-b909-6c696483a7fb}","{c6f22ae8-52fa-45d5-a1bf-6b7b67f60f8b}",3,2);ma.addMethod("CanCollectUserFeedback",27,"Boolean",1,1,"CanCollectUserFeedback",4);vb=ma.addMethod("CollectUserFeedback",1,"Void",0,1,"CollectUserFeedback",4);vb.addParameter("feedbacktype","Microsoft.Office.UserFeedbackType",1,null,0);vb.addParameter("UIType","Microsoft.Office.UserFeedbackUIType",1,null,0);vb.addParameter("featureArea","String",1,null,0);vb.addParameter("options","Object",1,null,0);ma.addMethod("CollectUserFeedbackData",
56,"String",1,0,"CollectUserFeedbackData",4);ma.addMethod("GetHostScreenshot",33,"Microsoft.Office.UserFeedbackScreenshotInfo",2,1,"HostScreenshot",4);ma.addMethod("GetInitializationData",32,"String",1,1,"InitializationData",4);vb=ma.addMethod("InvokeDiagnosticsLogsUpload",34,"Void",0,1,"InvokeDiagnosticsLogsUpload",4);vb.addParameter("diagnosticsUploadId","String",1,null,0);ma.addMethod("_RegisterUserFeedbackResponseEvent",28,"Void",0,1,"_RegisterUserFeedbackResponseEvent",4);ma.addMethod("_RegisterUserFeedbackUIDismissedEvent",
18,"Void",0,1,"_RegisterUserFeedbackUIDismissedEvent",4);ma.addMethod("_UnregisterUserFeedbackResponseEvent",29,"Void",0,1,"_UnregisterUserFeedbackResponseEvent",4);ma.addMethod("_UnregisterUserFeedbackUIDismissedEvent",19,"Void",0,1,"_UnregisterUserFeedbackUIDismissedEvent",4);ma=D.addType("Microsoft.Office.NotificationService","{d9d9f329-4dbd-46fd-937d-8534fca075f2}","{f665e4ed-18e6-496d-9693-4622a232c1bc}",3,2);vb=ma.addMethod("AddNotification",1,"String",1,0,"AddNotification",4);vb.addParameter("props",
"String",1,null,0);vb.addParameter("options","String",1,null,0);vb=ma.addMethod("RemoveNotification",3,"Void",0,0,"RemoveNotification",4);vb.addParameter("id","String",1,null,0);vb=ma.addMethod("UpdateNotification",2,"Void",0,0,"UpdateNotification",4);vb.addParameter("id","String",1,null,0);vb.addParameter("props","String",1,null,0);ma=D.addType("Microsoft.Office.SensitivityResultDetails","{38aa453f-09b7-442d-9c98-018d8a2fde40}","{b3285f73-6874-4d7c-b3b8-06b35465706a}",2,0);ma.addProperty("Message",
24,"String",1,!1,null,0);ma.addProperty("Severity",25,"Microsoft.Office.LabelResultSeverity",1,!1,null,0);ma.addProperty("Version",23,"Int32",1,!1,null,0);ma=D.addType("Microsoft.Office.SensitivityLabelInfo","{9c48b796-11fa-4374-9910-4495541ed32f}","{57df5dd1-1d5c-49c2-954e-54cdce9d6082}",2,0);ma.addProperty("Color",15,"String",1,!1,null,0);ma.addProperty("Description",13,"String",1,!1,null,0);ma.addProperty("DisplayName",12,"String",1,!1,null,0);ma.addProperty("EncryptionType",8,"Microsoft.Office.EncryptionType",
1,!1,null,0);ma.addProperty("HasExtractForUser",10,"Boolean",1,!1,null,0);ma.addProperty("IsDke",9,"Boolean",1,!1,null,0);ma.addProperty("IsEnabled",7,"Boolean",1,!1,null,0);ma.addProperty("LabelId",5,"String",1,!1,null,0);ma.addProperty("Order",11,"Int32",1,!1,null,0);ma.addProperty("ParentName",14,"String",1,!1,null,0);ma.addProperty("TenantId",6,"String",1,!1,null,0);ma.addProperty("Version",4,"Int32",1,!1,null,0);ma=D.addType("Microsoft.Office.SensitivityLabelChangedEventArgs","{ca0930bd-14ec-4274-baf8-b0d81b2cd6af}",
"{afcf1725-5270-469f-91c8-ad4f0268a459}",2,0);ma.addProperty("Context",20,"String",1,!1,null,0);ma.addProperty("Error",21,"Microsoft.Office.TryUpgradeLabelError",1,!1,null,0);ma.addProperty("NewLabel",19,"Microsoft.Office.SensitivityLabelInfo",2,!1,null,0);ma.addProperty("PreviousLabel",18,"Microsoft.Office.SensitivityLabelInfo",2,!1,null,0);ma=D.addType("Microsoft.Office.SensitivityService","{c7d4ae5b-a48c-4bfd-bf0b-1532a604d330}","{774bff62-b736-4038-a7a8-7bc1eeef213e}",3,2);vb=ma.addMethod("GetHighestSensitivityLabel",
3,"Microsoft.Office.SensitivityLabelInfo",2,0,"HighestSensitivityLabel",4);vb.addParameter("sensitivityLabelInfo","Microsoft.Office.SensitivityLabelInfo[]",2,null,0);ma.addMethod("GetLabel",1,"Microsoft.Office.SensitivityLabelInfo",2,0,"Label",4);vb=ma.addMethod("GetSensitivityResultDetails",22,"Microsoft.Office.SensitivityResultDetails",2,0,"SensitivityResultDetails",4);vb.addParameter("hrResult","Int32",1,null,0);vb.addParameter("displayContext","Microsoft.Office.LabelMessageContext",1,null,0);
vb=ma.addMethod("TryUpgradeLabel",2,"Void",0,0,"TryUpgradeLabel",4);vb.addParameter("sensitivityLabelInfo","Microsoft.Office.SensitivityLabelInfo",2,null,0);vb.addParameter("context","String",1,null,0);ma.addMethod("_RegisterSensitivityLabelChangedEvent",16,"Void",0,1,"_RegisterSensitivityLabelChangedEvent",4);ma.addMethod("_UnregisterSensitivityLabelChangedEvent",17,"Void",0,1,"_UnregisterSensitivityLabelChangedEvent",4);ma=D.addType("Microsoft.Office.CopilotService","{d81cdd7f-f828-45a1-89fd-b1f6d0af7f76}",
"{c86a3d8f-7782-4ef9-8ded-2b569327f30c}",3,2);vb=ma.addMethod("LaunchHelpPaneByArticleId",2,"Void",0,0,"LaunchHelpPaneByArticleId",4);vb.addParameter("articleId","Int32",1,null,0);vb=ma.addMethod("LaunchHelpPaneByArticleIdString",3,"Void",0,0,"LaunchHelpPaneByArticleIdString",4);vb.addParameter("articleId","String",1,null,0);vb=ma.addMethod("LaunchHelpPaneByQuery",1,"Void",0,0,"LaunchHelpPaneByQuery",4);vb.addParameter("query","String",1,null,0);ma=D.addEnumType("Microsoft.Office.BusinessBarType");
ma.addEnumField("Info",0);ma.addEnumField("Error",1);ma.addEnumField("Blocked",2);ma.addEnumField("SevereWarning",3);ma.addEnumField("Success",4);ma.addEnumField("Warning",5);ma=D.addType("Microsoft.Office.BusinessBarShowArgs","{9cd04f48-f89b-4720-affd-b69cda192318}","{fb97b13e-bd55-46f2-a1bc-92cf8525546f}",2,0);ma.addProperty("HideCloseButton",6,"Boolean",1,!1,null,0);ma.addProperty("Message",4,"String",1,!1,null,0);ma.addProperty("MessageType",5,"Microsoft.Office.BusinessBarType",1,!1,null,0);ma.addProperty("Title",
3,"String",1,!1,null,0);ma=D.addType("Microsoft.Office.BusinessBarService","{0234fef7-ca58-4b3e-9ae8-6972ccf29564}","{8787e4f8-8270-480c-8721-5854ecbc8227}",3,2);vb=ma.addMethod("Hide",2,"Void",0,0,"Hide",4);vb.addParameter("caller","String",1,null,0);vb=ma.addMethod("Show",1,"Void",0,0,"Show",4);vb.addParameter("caller","String",1,null,0);vb.addParameter("options","Microsoft.Office.BusinessBarShowArgs",2,null,0);ma=D.addEnumType("Microsoft.Office.SimpleDialogCategory");ma.addEnumField("information",
0);ma.addEnumField("error",1);ma.addEnumField("warning",2);ma.addEnumField("question",3);ma.addEnumField("other",4);ma=D.addType("Microsoft.Office.ShowSimpleDialog","{55fc9dc0-9f07-4859-8ba1-f33c353972da}","{f55bd118-7884-4f60-9e0e-e3a7972b7ecb}",3,2);vb=ma.addMethod("LaunchSimpleDialog",1,"Microsoft.Office.SimpleDialogState",1,0,"LaunchSimpleDialog",4);vb.addParameter("title","String",1,null,0);vb.addParameter("description","String",1,null,0);vb.addParameter("telemetryid","String",1,null,0);vb.addParameter("Category",
"Microsoft.Office.SimpleDialogCategory",1,null,0);vb.addParameter("hasButton","Boolean",1,null,0);vb.addParameter("buttonLabel","String",1,null,0);vb.addParameter("hasCheckbox","Boolean",1,null,0);vb.addParameter("checkboxLabel","String",1,null,0);ma=D.addType("Microsoft.Office.DispatchApiService","{1e3afc74-fb27-4b5d-a37b-fda697c46f78}","{82297de7-ac3a-4ee2-853d-26598d2e90e2}",3,2);vb=ma.addMethod("Execute",1,"String",1,1,"Execute",4);vb.addParameter("apiName","String",1,null,0);vb.addParameter("paramsData",
"String",1,null,0);ma=D.addEnumType("Microsoft.Office.DevicePermissionType");ma.addEnumField("camera",0);ma.addEnumField("microphone",1);ma.addEnumField("geolocation",2);ma=D.addType("Microsoft.Office.DevicePermissionService","{31dd135c-e19d-4a24-9247-ed31f197e3fb}","{6ed57f43-8908-4730-8c45-d5579c9e3c1c}",3,2);vb=ma.addMethod("RequestPermissions",1,"Boolean",1,1,"RequestPermissions",4);vb.addParameter("permissions","Microsoft.Office.DevicePermissionType[]",1,null,0);ma=D.addType("Microsoft.Office.PrivateApiEventArgs",
"{dc4efadd-dbcb-4c2a-afce-f12f3b05de53}","{9c665518-7879-446f-8fee-baefda7494b9}",2,0);ma.addProperty("MessageData",3,"String",1,!1,null,0);ma=D.addType("Microsoft.Office.PrivateApiService","{c2f650f1-6c66-489e-bcb1-f638bead0a2f}","{ea9b2f4b-4a14-4ecb-8377-4693cd15f9df}",3,2);vb=ma.addMethod("Execute",1,"String",1,0,"Execute",4);vb.addParameter("messageData","String",1,null,0);ma.addMethod("_RegisterPrivateApiEvent",4,"Void",0,1,"_RegisterPrivateApiEvent",4);ma.addMethod("_UnregisterPrivateApiEvent",
5,"Void",0,1,"_UnregisterPrivateApiEvent",4);ma=D.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);vb=ma.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",0);vb.addParameter("base64File","String",1,null,0);ma=D.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}","",3,0);ma.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);vb=ma.addMethod("SetAppRuntimeState",
1,"Void",0,1,"SetAppRuntimeState",0);vb.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);ma=D.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);ma.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,0);vb=ma.addMethod("Register",1,"Void",0,0,"Register",0);vb.addParameter("metadata","String",1,null,0);vb.addParameter("javascript","String",1,null,
0);ma=D.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);ma.addProperty("Enabled",1,"Boolean",1,!1,null,0);ma.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);ma.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);xa.a()||(ma=D.addEnumType("Microsoft.Authentication.IdentityType"),ma.addEnumField("OrganizationAccount",0),ma.addEnumField("MicrosoftAccount",1),ma=D.addEnumType("Microsoft.Authentication.AuthorityType"),ma.addEnumField("External",
0),ma.addEnumField("Msa",1),ma.addEnumField("Aad",2),ma=D.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0),ma.addProperty("DisplayName",4,"String",1,!1,null,0),ma.addProperty("Email",3,"String",1,!1,null,0),ma.addProperty("FederationProvider",2,"String",1,!1,null,0),ma.addProperty("IdentityType",1,"Microsoft.Authentication.IdentityType",1,!1,null,0),ma=D.addType("Microsoft.Authentication.AuthContext","{fd7bb67b-838a-4e86-84df-43023e360260}",
"{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0),ma.addProperty("AppId",4,"String",1,!1,null,0),ma.addProperty("Authority",2,"String",1,!1,null,0),ma.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0),ma.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0),ma.addProperty("TenantId",6,"String",1,!1,null,0),ma.addProperty("Upn",1,"String",1,!1,null,0),ma=D.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}","{799af6f3-8bf5-4859-8aca-7dd712862fca}",
3,0),ma.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0),vb=ma.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4),vb.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0),ma.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",2,1,"AuthContext",0),ma.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",2,1,"PrimaryIdentityInfo",4),
ma=D.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0),ma.addProperty("AuthChallenge",3,"String",1,!1,null,0),ma.addProperty("CorrelationId",7,"String",1,!1,null,0),ma.addProperty("Policy",4,"String",1,!1,null,0),ma.addProperty("Resource",2,"String",1,!1,null,0),ma.addProperty("Scope",5,"String",1,!1,null,0),ma.addProperty("SilentLogin",6,"Boolean",1,!1,null,0),ma=D.addType("Microsoft.Authentication.SingleSignOnToken",
"{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0),ma.addProperty("AccessToken",2,"String",1,!1,null,0),ma.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0),ma=D.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0),ma.addProperty("Id",1,"String",1,!0,null,0),ma.addProperty("Value",2,"Object",1,!1,null,0),ma=D.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}",
"",3,0),vb=ma.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0),vb.addParameter("id","String",1,null,0),vb=ma.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0),vb.addParameter("id","String",1,null,0));ma=D.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);ma.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,
"AppRuntimeState",0);vb=ma.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);vb.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);ma=D.addEnumType("Microsoft.AppRuntime.AppRuntimeState");ma.addEnumField("Inactive",0);ma.addEnumField("Background",1);ma.addEnumField("Visible",2);ma=D.addEnumType("Microsoft.AppRuntime.Visibility");ma.addEnumField("Hidden",1);ma.addEnumField("Visible",2);ma=D.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}",
"{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);ma.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);vb=ma.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);vb.addParameter("jsonCreate","String",1,null,0);vb=ma.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);vb.addParameter("jsonUpdate","String",1,null,0);vb=ma.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);vb.addParameter("id","String",
1,null,0);vb=ma.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);vb.addParameter("id","String",1,null,0);ma.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ma=D.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);ma.addProperty("Id",2,"String",1,!0,null,0);vb=ma.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",0);vb.addParameter("visibility","Boolean",1,null,0);ma.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ma=D.addType("Microsoft.DynamicRibbon.RibbonButton",
"{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);ma.addProperty("Enabled",3,"Boolean",1,!1,null,0);ma.addProperty("Id",2,"String",1,!0,null,0);ma.addProperty("Label",4,"String",1,!0,null,0);vb=ma.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);vb.addParameter("enabled","Boolean",1,null,0);ma.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ma=D.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);ma.addMethod("GetCount",3,"Int32",1,1,"Count",
0);vb=ma.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);vb.addParameter("key","String",1,null,0);ma.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ma.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);ma=D.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");ma.addEnumField("Unknown",0);ma.addEnumField("Basic",1);ma.addEnumField("Premium",2);ma=D.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",
3,0);vb=ma.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);vb.addParameter("feature","String",1,null,0);vb.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);vb=ma.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0);vb.addParameter("feature","String",1,null,0);vb=ma.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);vb.addParameter("feature","String",
1,null,0);vb.addParameter("fallbackValue","Boolean",1,null,0);ma.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);vb=ma.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);vb.addParameter("experienceId","String",1,null,0);vb=ma.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4);vb.addParameter("feature","String",1,null,0);ma=D.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}",
"",3,0);ma.addProperty("Id",5,"String",1,!0,null,0);ma.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);ma.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);ma=D.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);ma.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);ma=D.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification",
"{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",3,0);ma.addMethod("Disable",3,"Void",0,1,"Disable",0);ma.addMethod("Enable",2,"Void",0,1,"Enable",0);ma.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)};var Z=a(966),ta=a(130);class pa{constructor(D,ma){this.Jqh=D;this.crh=ma}createAndOpenWorkbook(D){if(D&&D.length>this.Jqh)throw B.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",D.length),OfficeExtension.WacRuntime.Utility.createRichApiException(Z.a.invalidArgument,
ta.a.ia(1769));const ma=new $a("blank","agave",D?"streamBase64":"streamEmpty",D);let vb=null;return OfficeExtension.WacRuntime.Utility.createPromise((lc,Nc)=>{const wd=new hb.a,Yd=ta.a.mzc("GeneralAddInMessageDialogTitle"),ee=ta.a.mzc("NewFileAPIConsentMessage");wd.hc=4;wd.Ni(Yd,ee,1,ae=>{2===ae||0===ae?Nc("Cancelled"):(vb=window.open(""),this.crh.create(lc,Nc,ma).dfb())})}).then(lc=>{if(!lc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(Z.a.generalException,ta.a.ia(1765));try{vb.top.location.href=
lc}catch(Nc){B.ULS.sendTraceTag(538572820,0,10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",db.a.Wp,Nc),B.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),vb.location.replace(lc)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},lc=>{if("Cancelled"===lc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(Z.a.ebe,ta.a.ia(1768));
vb.close();this.s4k();return null})}getTypeName(){return"Microsoft.ExcelServices.WacWorkbook"}invokePropertyGet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);
}invokeMethodAsync(D,ma){switch(D){case 1:return this.E5h(ma)}D=this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}E5h(D){D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,0,"string");return this.createAndOpenWorkbook(D)}s4k(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(Z.a.generalException,ta.a.ia(1765));}}Object(l.a)(pa,"WacWorkbook",null,[]);const Ga=(D,ma)=>{console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+
typeof D+", objectId="+D+", value="+ma);return null},Ca=D=>{D.add("InternalTest","PreviewExecutionMethod",Ga)};var kb=a(227),eb=a(964),Yb=a(965);class Gb{constructor(D){this.Qb=D}get $(){return this.Qb}}Object(l.a)(Gb,"RichApiPreviewExecutionContext",null,[]);var Mb=a(27),Rb=a(74),$b=a(70),cc=a(58),fb=a(44),Sb=a(1307),kc=a(81),na=a(674),fc=a(240),Cc=a(32),tc=a(244),nb=a(147),tb=a(20),La=a(17),wb=a(12),Wa=a(28);class Fa extends tc.a{constructor(D,ma,vb,lc,Nc){super(D,"Select Data");this.mHb=null;this.fnf=
ma;this.KAd=vb;this.Mc=Nc;this.callback=lc}get Tc(){return"DdaBindingPrompt"}start(D,ma){let vb="<div class='"+nb.a.nqi+" "+tb.a.YD+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+nb.a.JX+"' /></div>";vb=String.format(vb,Cc.a.$l(this.KAd.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");this.Mc.vl(this.Ld,vb);this.mHb=La.DOMElementExtensions.getElementById(this.Ld,"bindingText");D=ma?D.rhb(ma,this.KAd.DdaBindingsMethod.BindingId):null;(null===
D||void 0===D?0:D.IsValidRef)?(ma=new Mb.Range(D.Reference.FirstRow+1,D.Reference.FirstColumn+1,D.Reference.LastRow+1,D.Reference.LastColumn+1,!1,!1),this.mHb.value=D.Reference.SheetName+"!"+ma):(D=w.f(this.$).ha,this.mHb.value=Rb.f(this.$.la)||!D.oa.vi?"":D.Xra);this.initialize();this.Om()}cA(){this.wvd();this.addButton(0);this.addButton(1);super.cA()}setFocus(){La.DOMElementExtensions.setFocus(this.mHb)}validate(){return!0}commit(){let D=this.mHb.value.trim();const ma=D.indexOf("!");-1!==ma&&(D=
this.Y0i(D.substring(0,ma))+D.substr(ma));this.fnf.addBinding(this.KAd,D,0,this.callback);return!0}gIb(){this.fnf.GX.si(eb.a.internalError,this.callback);super.gIb()}Y0i(D){D=Wa.a.trimStart(D.trim(),"=");return D.length?D.startsWith("'")&&D.endsWith("'")?D:wb.HelperMethods.rvc(D):""}}Object(l.a)(Fa,"DdaBindingPrompt",tc.a,[]);class Da{constructor(D){this.fa=D}si(D,ma){if(ma){const vb={};vb.Error=D;vb.Version=this.fa.Je;ma(vb)}}GWa(D,ma){this.si(D,ma)}iN(D,ma){this.si(eb.a.XDf(D.Errors[0].MessageId),
ma)}Bz(D){D&&D(this.VM())}VM(){const D={Error:0};D.Version=this.fa.Je;return D}}Object(l.a)(Da,"DdaErrorGenerator",null,[]);var ja=a(255);class Qa{constructor(D,ma,vb){this.$=D;this.GX=ma;this.UE=vb}F6d(D,ma){const vb=D.DdaGoToByIdMethod.GoToType,lc=D.DdaGoToByIdMethod.SelectionMode,Nc=D.DdaGoToByIdMethod.Id.toString().trim(),wd=Yd=>{const ee=this.$.qa.getItemByName(Yd.SheetName);(null===ee||void 0===ee?0:ee.visible)?(w.f(this.$).lj(Yd,null,null,null,3,"DdaNavigator.NavigateTo",void 0,void 0,void 0,
void 0,!0),this.GX.Bz(ma)):this.GX.si(eb.a.AVh,ma)};0===vb?this.TOj(Nc,lc,D.DdaMethod.ControlId,wd,ma):1===vb?this.WOj(Nc,lc,wd,ma):this.GX.si(eb.a.hbl,ma)}TOj(D,ma,vb,lc,Nc){this.UE.ddaGetBinding(vb,D,wd=>{if(!ja.a(wd)&&wd.Result&&wd.Result.Reference){wd=wd.Result;var Yd={};Yd.SheetName=wd.Reference.SheetName;Yd.FirstRow=wd.Reference.FirstRow;Yd.FirstColumn=wd.Reference.FirstColumn;Yd.LastRow=wd.Reference.LastRow;Yd.LastColumn=wd.Reference.LastColumn;Qa.Dpd(Yd,ma);1!==wd.BindingType?lc(Yd):this.UE.ddaGetBindingData(vb,
D,1,0,2,0,0,-1,-1,ee=>{ja.a(ee)||!ee.Result?this.GX.iN(ee,Nc):(ee=ee.Result,2!==ma&&(Yd.FirstRow-=ee.Headers.length,0>Yd.FirstRow&&(Yd.FirstRow=0)),lc(Yd))},Nc)}else this.GX.GWa(eb.a.cZg,Nc)},Nc)}WOj(D,ma,vb,lc){var Nc=fb.E(D);Nc?(Nc=fb.y(Nc,this.$),Qa.Dpd(Nc,ma),vb(Nc)):this.$.fa.isNamedObjectViewMode&&this.$.wc.Bl(D)?this.$.wc.hya(this.$.wc.getItemByName(D),"dda"):(Nc=wd=>{ja.a(wd)||!wd.Result?this.$.qa.contains(D)?(wd={},wd.SheetName=D,wd.FirstRow=0,wd.FirstColumn=0,wd.LastRow=0,wd.LastColumn=
0,vb(wd)):this.GX.GWa(eb.a.cZg,lc):(wd=wd.Result,Qa.Dpd(wd,ma),vb(wd))},this.$.qa.la?this.UE.parseRangeForGoto(D,this.$.qa.la.name,Nc,lc):this.UE.parseRange(D,Nc,lc))}static Dpd(D,ma){D.LastRow=2===ma?D.FirstRow:D.LastRow;D.LastColumn=2===ma?D.FirstColumn:D.LastColumn}}Object(l.a)(Qa,"DdaNavigator",null,[]);var Ob=a(213),Ub=a(61);const Zb=(D,ma,vb,lc,Nc,wd)=>{const Yd=D.$a(1);Yd.request=ma;return Ub.h(D,"ExecuteRichApiRequest",Yd,vb,lc,Nc,wd,0)};var uc=a(346),Hc=a(90),Dd=a(790),jc=a(661),$c;(function(D){D[D.unsupported=
0]="unsupported";D[D.surface=1]="surface";D[D.combo=2]="combo";D[D.column=3]="column";D[D.column3D=4]="column3D";D[D.bar=5]="bar";D[D.bar3D=6]="bar3D";D[D.line=7]="line";D[D.line3D=8]="line3D";D[D.pie=9]="pie";D[D.pie3D=10]="pie3D";D[D.scatter=11]="scatter";D[D.bubble=12]="bubble";D[D.area=13]="area";D[D.area3D=14]="area3D";D[D.doughnut=15]="doughnut";D[D.radar=16]="radar";D[D.stock=17]="stock";D[D.waterfall=18]="waterfall";D[D.funnel=19]="funnel";D[D.treemap=20]="treemap";D[D.sunburst=21]="sunburst";
D[D.boxWhisker=22]="boxWhisker";D[D.histogram=23]="histogram";D[D.pareto=24]="pareto";D[D.regionMap=25]="regionMap";D[D.noVisibleSeries=26]="noVisibleSeries";D[D.complexDataSource=27]="complexDataSource";D[D.pivotChart=28]="pivotChart"})($c||($c={}));Object(l.b)("ChartCategory",$c);class ud{constructor(D,ma){this.source=D;this.eventId=ma}}Object(l.a)(ud,"MacroRecorderEventData",null,[]);class Ud{constructor(D,ma,vb){this.response=this.request=this.eventId=this.source=null;D&&(this.source=D.source,
this.eventId=D.eventId,this.request=ma,this.response=vb)}get isValid(){return!(void 0===this.source||null===this.source)&&!(void 0===this.eventId||null===this.eventId)&&!0}}Object(l.a)(Ud,"MacroRecorderRichApiRequestExecutedPayload",null,[67]);class ec{constructor(D,ma,vb){this.parentName=D;this.$=ma;this.request=vb}d_i(D){var ma;if(void 0===D||null===D||void 0===D.RequestBody||null===D.RequestBody)return null;const vb=JSON.parse(D.RequestBody);if(void 0!==D.ActiveFloatingObjectId&&null!==D.ActiveFloatingObjectId){vb.ActiveFloatingObjectId=
D.ActiveFloatingObjectId;const lc=w.f(this.$).ha.ob.Wb;if(null===(ma=null===lc||void 0===lc?void 0:lc.floatingObject)||void 0===ma?0:ma.Zc)vb.ActiveChartType=$c[lc.floatingObject.Zc.ChartCategory]}void 0!==D.SheetMultiRange&&null!==D.SheetMultiRange&&(vb.SheetName=D.SheetMultiRange.SheetName);return vb}o_i(D){if(void 0===D||null===D||void 0===D.Result||null===D.Result)return null;D=D.Result;return void 0===D.ResponseBody||null===D.ResponseBody||D.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(D.ResponseBody.join(""))}yvj(D){return!!D&&
!(void 0===D.eventId||null===D.eventId)&&0<D.eventId.length}Bn(D){return()=>{if(this.$.oda){const ma=this.iRh(this.request);if(this.yvj(ma)){const vb=this.d_i(this.request),lc=this.o_i(D);if(vb&&!Hc.a.isEmpty(vb)&&lc&&!Hc.a.isEmpty(lc))return B.ULS.sendTraceTag(537163164,0,50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),new Ud(ma,vb,lc);B.ULS.sendTraceTag(537163163,0,50,`[RichApiRecorder]: Failed due to bad data: ${`requestInfo: ${vb?"(not null)":"(null)"}; responseInfo: ${lc?
"(not null)":"(null)"}`}`)}}return new Ud(null,null,null)}}iRh(D){const ma=this.zvj(D.SolutionId),vb=ec.GZi(D);if(vb&&ma)return B.ULS.sendTraceTag(537163162,0,50,`[RichApiRecorder][${this.parentName}]: ${({["recorderEventId"]:vb,["request.SolutionId"]:D.SolutionId})}`),new ud(D.SolutionId,vb);D=JSON.stringify({["recorderEventId"]:vb,["isRecorderAwareAddin"]:ma,["request.SolutionId"]:D.SolutionId});B.ULS.sendTraceTag(537163161,0,50,`[RichApiRecorder][${this.parentName}]: ${D}`);return null}zvj(D){if(!D)return!1;
D=D.toLowerCase();return ec.G5i().contains(D)}static G5i(){ec.lLa||(ec.lLa=new Dd.a(jc.a.Ef()),ec.lLa.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),ec.lLa.add("fa000000005"),ec.lLa.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),ec.lLa.add("fa000000014"),ec.lLa.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));return ec.lLa}static GZi(D){let ma=null;var vb=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',"mi");if(vb.test(D.RequestBody))ma=vb.exec(D.RequestBody)[1];else{D=D.RequestHeaders;
if(!D)return ma;vb=Va.a.dSj.toLowerCase();for(let lc=0;lc<D.length;lc++)if(D[lc].Name.toLowerCase()===vb){ma=D[lc].Value;break}}return ma}}ec.lLa=null;Object(l.a)(ec,"DdaRichApiRequestRecorder",null,[]);var Db=a(266);class ic extends uc.a{constructor(D,ma,vb,lc,Nc,wd,Yd,ee){super(10,0,ma,ee);this.YDb=vb;this.bAb=lc;this.Qba=Nc;this.GRa=wd;this.request=Yd;this.Lle=new ec("10",D,Yd)}get O3c(){return this.GRa}get PL(){return this.YDb}get Ksa(){return this.bAb}jba(D){return super.jba(D)||this.nUh(D)}Bn(){return this.Lle.Bn(this.Ge)}Vvb(){const D=
{OperationType:3};D.RichApiRequest=this.request;return D}nUh(D){return(ma,vb,lc)=>Zb(D,this.request,Db.c(ma,this.YDb),Db.b(vb,this.bAb),lc,this.Qba)}}Object(l.a)(ic,"DdaRichApiRequestBatchOperation",uc.a,[]);class Pc extends Ob.a{constructor(D,ma,vb,lc){super(576,0,vb,lc);this.Lle=new ec("576",D,ma)}Bn(){return this.Lle.Bn(this.Ge)}}Object(l.a)(Pc,"DdaRichApiRequestOperation",Ob.a,[]);class Ed{constructor(D,ma){this.nO=(vb,lc)=>{this.GX.GWa(eb.a.internalError,lc)};this.$=D;this.GX=ma}ddaAddBinding(D,
ma,vb,lc,Nc,wd,Yd){this.cQ((ee,ae,he)=>{var De=this.$.ma.sa,Se=this.sta();ee=Db.c(ee,wd);ae=Db.b(ae,this.nO);const qf=De.$a(9);qf.controlId=D;qf.bindingId=ma;qf.bindingType=vb;qf.currentSheetName=Se;qf.formula=lc;qf.options=Nc;return Ub.h(De,"DdaAddBinding",qf,ee,ae,he,Yd,0)},Yd,563)}ddaReleaseBinding(D,ma,vb,lc){this.cQ((Nc,wd,Yd)=>{var ee=this.$.ma.sa;Nc=Db.c(Nc,vb);wd=Db.b(wd,this.nO);const ae=ee.$a(9);ae.controlId=D;ae.bindingId=ma;return Ub.h(ee,"DdaReleaseBinding",ae,Nc,wd,Yd,lc,0)},lc,564)}ddaGetBinding(D,
ma,vb,lc){this.cQ((Nc,wd,Yd)=>{var ee=this.$.ma.sa;Nc=Db.c(Nc,vb);wd=Db.b(wd,this.nO);const ae=ee.$a(1);ae.controlId=D;ae.bindingId=ma;return Ub.h(ee,"DdaGetBinding",ae,Nc,wd,Yd,lc,0)},lc,565,16)}ddaGetAllBindings(D,ma,vb){this.cQ((lc,Nc,wd)=>{var Yd=this.$.ma.sa;lc=Db.c(lc,ma);Nc=Db.b(Nc,this.nO);const ee=Yd.$a(1);ee.controlId=D;return Ub.h(Yd,"DdaGetAllBindings",ee,lc,Nc,wd,vb,0)},vb,566,16)}ddaGetBindingData(D,ma,vb,lc,Nc,wd,Yd,ee,ae,he,De){this.cQ((Se,qf,kg)=>{var $f=this.$.ma.sa,Cg=this.sta();
Se=Db.c(Se,he);qf=Db.b(qf,this.nO);const sg=$f.$a(1);sg.controlId=D;sg.bindingId=ma;sg.coerceType=vb;sg.valueFormat=lc;sg.filterType=Nc;sg.startRow=wd;sg.startCol=Yd;sg.rowCount=ee;sg.colCount=ae;sg.currentSheetName=Cg;return Ub.h($f,"DdaGetBindingData",sg,Se,qf,kg,De,0)},De,567,16)}ddaSetBindingData(D,ma,vb,lc,Nc,wd,Yd){this.cQ((ee,ae,he)=>{var De=this.$.ma.sa,Se=this.sta();ee=Db.c(ee,wd);ae=Db.b(ae,this.nO);const qf=De.$a(9);qf.controlId=D;qf.bindingId=ma;qf.startRow=vb;qf.startCol=lc;qf.currentSheetName=
Se;qf.bindingData=Nc;return Ub.h(De,"DdaSetBindingData",qf,ee,ae,he,Yd,0)},Yd,568)}ddaGetSelectedData(D,ma,vb,lc,Nc,wd,Yd){this.cQ((ee,ae,he)=>{var De=this.$.ma.sa,Se=this.sta();ee=Db.c(ee,wd);ae=Db.b(ae,this.nO);const qf=De.$a(1);qf.controlId=D;qf.coerceType=ma;qf.valueFormat=vb;qf.filterType=lc;qf.currentSheetName=Se;qf.formula=Nc;return Ub.h(De,"DdaGetSelectedData",qf,ee,ae,he,Yd,0)},Yd,569,16)}ddaSetSelectedData(D,ma,vb,lc,Nc){this.cQ((wd,Yd,ee)=>{var ae=this.$.ma.sa,he=this.sta();wd=Db.c(wd,
lc);Yd=Db.b(Yd,this.nO);const De=ae.$a(9);De.controlId=D;De.currentSheetName=he;De.formula=ma;De.bindingData=vb;return Ub.h(ae,"DdaSetSelectedData",De,wd,Yd,ee,Nc,0)},Nc,570)}ddaLoadSettings(D,ma,vb){this.cQ((lc,Nc,wd)=>{var Yd=this.$.ma.sa;lc=Db.c(lc,ma);Nc=Db.b(Nc,this.nO);const ee=Yd.$a(1);ee.controlId=D;return Ub.h(Yd,"DdaLoadSettings",ee,lc,Nc,wd,vb,0)},vb,501,16)}ddaSaveSettings(D,ma,vb,lc,Nc){this.cQ((wd,Yd,ee)=>{var ae=this.$.ma.sa;wd=Db.c(wd,lc);Yd=Db.b(Yd,this.nO);const he=ae.$a(9);he.controlId=
D;he.settings=ma;he.overwriteIfStale=vb;return Ub.h(ae,"DdaSaveSettings",he,wd,Yd,ee,Nc,0)},Nc,571)}ddaAddRowsColumns(D,ma,vb,lc,Nc,wd){this.cQ((Yd,ee,ae)=>{var he=this.$.ma.sa,De=this.sta();Yd=Db.c(Yd,Nc);ee=Db.b(ee,this.nO);const Se=he.$a(9);Se.controlId=D;Se.bindingId=ma;Se.isRow=vb;Se.currentSheetName=De;Se.bindingData=lc;return Ub.h(he,"DdaAddRowsColumns",Se,Yd,ee,ae,wd,0)},wd,572)}ddaDeleteAllDataValues(D,ma,vb,lc){this.cQ((Nc,wd,Yd)=>{var ee=this.$.ma.sa,ae=this.sta();Nc=Db.c(Nc,vb);wd=Db.b(wd,
this.nO);const he=ee.$a(9);he.controlId=D;he.bindingId=ma;he.currentSheetName=ae;return Ub.h(ee,"DdaDeleteAllDataValues",he,Nc,wd,Yd,lc,0)},lc,573)}ddaClearBindingFormats(D,ma,vb,lc){this.cQ((Nc,wd,Yd)=>{var ee=this.$.ma.sa,ae=this.sta();Nc=Db.c(Nc,vb);wd=Db.b(wd,this.nO);const he=ee.$a(9);he.controlId=D;he.bindingId=ma;he.currentSheetName=ae;return Ub.h(ee,"DdaClearBindingFormats",he,Nc,wd,Yd,lc,0)},lc,574)}ddaSetBindingFormats(D,ma,vb,lc,Nc,wd){this.cQ((Yd,ee,ae)=>{var he=this.$.ma.sa,De=this.sta();
Yd=Db.c(Yd,Nc);ee=Db.b(ee,this.nO);const Se=he.$a(9);Se.controlId=D;Se.bindingId=ma;Se.currentSheetName=De;Se.bindingData=vb;Se.isSetFormats=lc;return Ub.h(he,"DdaSetBindingFormats",Se,Yd,ee,ae,wd,0)},wd,575)}parseRange(D,ma,vb){this.cQ((lc,Nc,wd)=>{const Yd=this.$.ma.sa.mc();return Ub.w(this.$.ma.sa,D,-1,Db.c(lc,ma),Db.b(Nc,this.nO),wd,vb,Yd)},vb,162,16)}parseRangeForGoto(D,ma,vb,lc){this.cQ((Nc,wd,Yd)=>{const ee=this.$.ma.sa.mc();return Ub.x(this.$.ma.sa,D,ma,Db.c(Nc,vb),Db.b(wd,this.nO),Yd,lc,
ee)},lc,562,16)}executeRichApiRequest(D,ma,vb){D.RequestFlags&=12287;if(M.EwaSettings.isChangeGateEnabled("OfficeVSO:7867662_RichApiUndoThirdPartyFlight")){var lc=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichApiUndoThirdParty",!1);const Nc=0!==(D.RequestFlags&128);lc||"sdxcatalog"===D.MarketplaceType||Nc||(D.RequestFlags&=-17)}M.EwaSettings.Ra(233)?this.nyi(this.$.ma.sa.mc(),ma,()=>{this.GX.GWa(eb.a.internalError,vb)},vb,D):(lc=Oa.DdaFacade.iNd(D),!this.$.Mb.DC||lc&16?(lc|=64,this.$.userOperationManager.rK(new Pc(this.$,
D,(Nc,wd,Yd)=>Zb(this.$.ma.sa,D,Db.c(Nc,ma),Db.b(wd,this.nO),Yd,vb),lc))):(this.GX.GWa(eb.a.L4c,vb),B.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed")))}sta(){return this.$.fa.isNamedObjectViewMode?this.$.la.sheetName:this.$.activeItemName}cQ(D,ma,vb,lc){lc=void 0===lc?0:lc;!this.$.Mb.DC||lc&16?this.$.userOperationManager.rK(new Ob.a(vb,0,D,lc|64)):(this.GX.GWa(eb.a.L4c,ma),B.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))}nyi(D,ma,vb,lc,Nc){let wd=Oa.DdaFacade.iNd(Nc);
if(!this.$.Mb.DC||wd&16){var Yd=this.$.Vb.Uc("UserAction","Rich Api request");this.$.userOperationManager.enqueueOperation(new ic(this.$,D,ma,vb,lc,Yd,Nc,wd|64),null)}else this.GX.GWa(eb.a.L4c,lc),B.ULS.sendTraceTag(537163158,0,50,"Write operation is not allowed")}}Object(l.a)(Ed,"DdaWebServiceHelper",null,[]);class de{constructor(D,ma,vb,lc){this.Xzi=D;this.fileSize=ma;this.PYk=lc}}Object(l.a)(de,"DocumentFile",null,[]);class se{}se.generalException="GeneralException";se.bJh="ApiNotFound";se.ebe=
"OperationCancelled";se.invalidArgument="InvalidArgument";Object(l.a)(se,"ErrorCodes",null,[]);class Fe{replaceShortcuts(){return Promise.reject("ReplaceShortcuts method is not overridden")}getShortcuts(){return Promise.reject("GetShortcuts method is not overridden")}checkShortcutsInUse(){return Promise.reject("CheckShortcutsInUse method is not overridden")}}Object(l.a)(Fe,"WacApiDelegates",null,[]);var fe=a(754);class Tc extends Fe{constructor(D,ma){super();this.Y4f=(vb,lc)=>{vb=Tc.Q3h(vb,lc);if(!fe.a(this.$,
vb))return!0;vb=this.$.shortcutKeyManager.tOd(vb);return!!vb&&0<vb.length};this.addinId=D;this.$=ma}replaceShortcuts(D){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,D,this.Y4f)}getShortcuts(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)}checkShortcutsInUse(D){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(D,this.Y4f)}static D8h(D,ma){const vb=document.createEvent("KeyboardEvent");if(db.a.lE)vb.initKeyboardEvent("keydown",!1,!1,
window.self,"A",0,!!(D&8),!!(D&32),!!(D&4),!!(D&256));else{const lc=[];D&4&&lc.push("Shift");D&8&&lc.push("Control");D&32&&lc.push("Alt");vb.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,lc.join(" "),!1,"en-US")}D=new Sys.UI.DomEvent(vb);D.keyCode=ma;return D}static Q3h(D,ma){if(db.a.Yg)switch(ma){case 189:ma=173;break;case 187:ma=61;break;case 186:ma=59}return Tc.D8h(D,ma)}}Object(l.a)(Tc,"ExcelWacApiDelegates",Fe,[]);class ed{constructor(D){this.nVa={};this.IKj=D}ozh(D,ma){this.yCc(D)||(this.nVa[D]=
{});if(this.gpj(D))return B.ULS.sendTraceTag(537163157,344,50,`App ${D} has reach the limit of number of cached files.`),eb.a.wLj;this.nVa[D][ma.Xzi.toString()]=ma;return eb.a.success}qPi(D,ma){let vb=null;this.yCc(D)&&(vb=this.nVa[D][ma.toString()]);vb||B.ULS.sendTraceTag(537163156,344,15,`File cache for [agave:${D}, fileHandler:${ma}] doesn't exist`);return vb}yCc(D){return D in this.nVa}Gpk(D,ma){if(this.yCc(D)){const vb=this.nVa[D];delete vb[ma.toString()];1>Object.keys(vb).length&&delete this.nVa[D];
return ma.toString()in vb?eb.a.internalError:eb.a.success}return eb.a.internalError}gpj(D){return this.yCc(D)?Object.keys(this.nVa[D]).length>=this.IKj:!1}static getInstance(D){return D.ra.Tb(200)||D.ra.zc(200,new ed(ed.JKj))}static JPj(){return++ed.hTh}}ed.kKj=4194304;ed.JKj=1;ed.hTh=0;Object(l.a)(ed,"GetFileApiHelper",null,[]);var pd=a(1515),Kb=a(1155);class rb{constructor(D){this.Um=D}notifyActionHandlerReady(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.Um)}getTypeName(){return"Microsoft.InternalService.AddinInternalService"}invokePropertyGet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);
}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D){switch(D){case 1:return this.uQj()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,ma){D=this.invokeMethod(D,
ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}uQj(){this.notifyActionHandlerReady();return null}}Object(l.a)(rb,"AddinInternalService",null,[]);class rc{constructor(D,ma){this.Fu=ma;this.Um=D}getAppRuntimeState(){let D=this.Um;ta.a.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload",!1)&&this.Fu.WV&&(D=this.Fu.jY(this.Um));return this.Fu.getAppRuntimeState(D)?2:1}setAppRuntimeState(D){switch(D){case 2:D=!0;break;case 1:D=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(Z.a.invalidArgument,
ta.a.ia(1769));}let ma=this.Um;ta.a.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload",!1)&&this.Fu.WV&&(ma=this.Fu.jY(this.Um));this.Fu.setAppRuntimeState(ma,D)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);
}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D,ma){switch(D){case 2:return this.IJi();case 1:return this.YHk(ma)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,ma){D=this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}IJi(){return this.getAppRuntimeState()}YHk(D){D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,
0,"int");this.setAppRuntimeState(D);return null}}Object(l.a)(rc,"AppRuntimeService",null,[]);var ld=a(1308);class Tb{constructor(D,ma,vb,lc){this.OB=D;this.N$=vb;this.pD=lc.Cf.getOsfControl(ma)}disable(){try{if(!ta.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.zjf();if(!this.r4f())return this.Ajf();this.N$.hal(this.OB)}catch(D){return B.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",D.message||"Unknown"),
this.xjf()}return null}enable(){try{if(!ta.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.zjf();if(!this.r4f())return this.Ajf();this.N$.snk(this.OB)}catch(D){return B.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",D.message||"Unknown"),this.xjf()}return null}_OnAccess(){}getTypeName(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"}invokePropertyGet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);
}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D){switch(D){case 1:return this.pOa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,ma){switch(D){case 3:return this.ehi();
case 2:return this.kmi()}D=this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}ehi(){return this.disable()}kmi(){return this.enable()}pOa(){this._OnAccess();return null}zjf(){return ld.a(Z.a.notImplemented,ta.a.ia(1770))}Ajf(){return ld.a(Z.a.sharedRuntimeNotAvailable,ta.a.ia(1774))}xjf(){return ld.a(Z.a.generalException,ta.a.ia(1765))}r4f(){const D=this.pD.getSharedRuntimeId();return!!D&&0<D.length}}Object(l.a)(Tb,"BeforeDocumentCloseNotification",null,[]);
class Wc{constructor(){this.kZe=this.gTe=this.$o=!1}get enabled(){return this.$o}set enabled(D){this.$o=D}get nativeRuntime(){return this.gTe}set nativeRuntime(D){this.gTe=D}get streamingEnabled(){return this.kZe}set streamingEnabled(D){this.kZe=D}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"}invokePropertyGet(D){switch(D){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);
}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D,ma){switch(D){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"boolean");return;case 3:this.nativeRuntime=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);
}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,ma){D=this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}}Object(l.a)(Wc,"CustomFunctionEngineStatus",null,[]);class Ac{constructor(D,ma,vb){this.Ooh=D;this.Poh=ma;this.Osh=vb}get status(){const D=new Wc;D.enabled=this.Ooh;
D.streamingEnabled=this.Poh;D.nativeRuntime=!1;return D}register(D){return OfficeExtension.WacRuntime.Utility.createPromise(this.Osh(D))}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionManager"}invokePropertyGet(D){switch(D){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);
}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,ma){switch(D){case 1:return this.kok(ma)}D=this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}kok(D){const ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,0,"string");D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,
1,"string");return this.register(ma,D)}}Object(l.a)(Ac,"CustomFunctionManager",null,[]);var nd=a(1201);class qd{constructor(D,ma,vb,lc){this.sIe="";this.Ldc=0;this.pW=D;this._id=ma;this.Um=vb;this.Fu=lc}get id(){return this._id}_RegisterStateChange(){this.Ldc||this.pW.execute(D=>{this.sIe=D.oLa(this._id,ma=>{this.Fu.$Bi(this.Um,this._id,JSON.stringify(ma))})});this.Ldc++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.Ldc--;this.Ldc||this.pW.execute(D=>
{D.ATc(this._id,this.sIe)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(D){switch(D){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);
}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,ma){switch(D){case 6:return this.Vhh();case 7:return this.bih()}D=this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}Vhh(){return this._RegisterStateChange()}bih(){return this._UnregisterStateChange()}}Object(l.a)(qd,"LicenseFeature",
null,[]);class Xd{constructor(D,ma){this.pW=sa.a.instance.Msb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.Um=D;this.Fu=ma;this.AQa=this.Fu.Cf.getOsfControl(this.Um)}getFeatureTier(D,ma){return OfficeExtension.WacRuntime.Utility.createPromise(vb=>{const lc=1===ma?1:2===ma?2:0;this.pW.execute(Nc=>{Nc.getFeatureTier(D,lc).then(wd=>{vb(this.wUi(wd))},()=>{vb(ma)})})})}getLicenseFeature(D){D=new qd(this.pW,D,this.Um,this.Fu);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}isFeatureEnabled(D,
ma){return OfficeExtension.WacRuntime.Utility.createPromise(vb=>{this.pW.execute(lc=>{lc.isFeatureEnabled(D,ma).then(Nc=>{vb(Nc)},()=>{vb(ma)})})})}isFreemiumUpsellEnabled(){return OfficeExtension.WacRuntime.Utility.createPromise(D=>{this.pW.execute(ma=>{ma=ma.isFreemiumUpsellEnabled();D(ma)})})}launchUpsellExperience(D){if(this.AQa.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(()=>{this.pW.execute(ma=>{ma.launchUpsellExperience(D)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException(Z.a.accessDenied,
"");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D,
ma){switch(D){case 6:return this.Yhh(ma)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,ma){switch(D){case 2:return this.wQi(ma);case 5:return this.vUi(ma);case 1:return this.eqj(ma);case 3:return this.drj();case 4:return this.MBj(ma)}D=this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}wQi(D){const ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,0,"string");D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,
1,"int");return this.getFeatureTier(ma,D)}vUi(D){D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,0,"string");return this.getLicenseFeature(D)}eqj(D){const ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,0,"string");D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,1,"boolean");return this.isFeatureEnabled(ma,D)}drj(){return this.isFreemiumUpsellEnabled()}MBj(D){D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,0,"string");return this.launchUpsellExperience(D)}Yhh(D){D=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,0,"string");this._TestFireStateChangedEvent(D);return null}wUi(D){switch(D){case 1:return 1;case 2:return 2;default:return 0}}}Object(l.a)(Xd,"License",null,[]);class Hd{constructor(){this.nyb=null;this.rDb=this.WQa=this.qD="";this.LDb=!0;this.options=null}get authChallenge(){return this.nyb}set authChallenge(D){this.nyb=D}get correlationId(){return this.qD}set correlationId(D){this.qD=D}get policy(){return null}set policy(D){}get resource(){return this.WQa}set resource(D){this.WQa=
D}get scope(){return this.rDb}set scope(D){this.rDb=D}get silentLogin(){return this.LDb}set silentLogin(D){this.LDb=D}getTypeName(){return"Microsoft.Authentication.TokenParameters"}invokePropertyGet(D){switch(D){case 3:return this.authChallenge;case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D,ma){switch(D){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return;case 7:this.correlationId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");
return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,
ma){D=this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}}Object(l.a)(Hd,"TokenParameters",null,[365]);var Zc=a(197),Jc=a(13);const gc=(D,ma,vb)=>lc=>(Nc,wd)=>{E.TaskExtensions.tb(kc.GetServiceTaskFactory.create(ma.ra,279,ma.Aa,1),Yd=>{Yd=Yd.result;let ee=!1;var ae=vb.Cf.getOsfControl(D);let he=null;ae&&(he=ae.getStoreType(),(ae=ae.getManifest())&&ae.getSharedRuntimeForCustomFunctions("Workbook")&&(ee=!0));E.TaskExtensions.tb(Yd.CXf(D,he,lc,ee),De=>{Zc.b(De)?
De.result?Nc(null):wd(OfficeExtension.WacRuntime.Utility.createRichApiException(Z.a.invalidArgument,Jc.a.instance.ia(1769))):wd(OfficeExtension.WacRuntime.Utility.createRichApiException(Z.a.generalException,Jc.a.instance.ia(1765)))},ma.Aa,3)},ma.Aa,3)};class dd{constructor(D){if(!D)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.G4d=D}areShortcutsInUse(D){return OfficeExtension.WacRuntime.Utility.createPromise((ma,vb)=>{this.G4d.checkShortcutsInUse(D).then(lc=>
{ma(lc)}).catch(lc=>{vb(lc)})})}getShortcuts(){return OfficeExtension.WacRuntime.Utility.createPromise((D,ma)=>{this.G4d.getShortcuts().then(vb=>{D(vb)}).catch(vb=>{ma(vb)})})}replaceShortcuts(D){return OfficeExtension.WacRuntime.Utility.createPromise((ma,vb)=>{this.G4d.replaceShortcuts(D).then(()=>{ma(null)}).catch(lc=>{vb(lc)})})}getTypeName(){return"Microsoft.Office.ActionService"}invokePropertyGet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertyGetAsync(D){D=
this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,ma){switch(D){case 3:return this.UKh(ma);case 1:return this.d1i();case 2:return this.nwk(ma)}D=
this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}UKh(D){D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,0,"Array<string>");return this.areShortcutsInUse(D)}d1i(){return this.getShortcuts()}nwk(D){D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,0,"any");return this.replaceShortcuts(D)}}Object(l.a)(dd,"ActionService",null,[]);class Bb{constructor(){this.data=null}}Object(l.a)(Bb,"AugLoopHostMessageReceivedEventArgs",null,[]);var pc=
a(1309);class wc{constructor(D,ma,vb){this.fP=D;this.wD=void 0===ma?!1:ma;this.vS=(void 0===vb?null:vb)||OfficeExtension.WacRuntime.RichApi.getEventManager()}sendMessage(D){this.wD||pc.a.vGk(D)}_RegisterHostMessageReceivedEvent(){this.wD||(wc.fFg||(pc.a.bok(D=>{this.vS.fireEvent("",65542,Object.assign(new Bb,{data:D}))}),wc.fFg=!0),this.vS.register(this.fP,"",65542))}_UnregisterHostMessageReceivedEvent(){this.wD||this.vS.unregister(this.fP,"",65542)}getTypeName(){return"Microsoft.Office.AugLoopEventService"}invokePropertyGet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);
}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D,ma){switch(D){case 1:return this.fGk(ma);case 2:return this.Shh();case 3:return this.Zhh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);
}invokeMethodAsync(D,ma){D=this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}fGk(D){D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,0,"string");this.sendMessage(D);return null}Shh(){this._RegisterHostMessageReceivedEvent();return null}Zhh(){this._UnregisterHostMessageReceivedEvent();return null}}wc.fFg=!1;Object(l.a)(wc,"AugLoopEventService",null,[]);var cd=a(971),Vd=a(990),xb=a(66),ub=a(613);class Fc{constructor(D,ma,vb){this.xQa=this.JMe=
null;this.fP=D;this.uUe=ma;if(this.ya=vb)this.JMe=this.ya.Qa("GetAccessTokenOAuthFirstPartyAllowList")}IWi(){this.xQa||(this.xQa=ub.a.Jq(Object(Ha.d)(cd.b)));return this.xQa}rrj(D,ma){if(!this.uUe||""===this.fP||!this.ya)return!1;const vb=this.uUe.getOsfControl(this.fP);if(!vb)return!1;let lc=!1;this.JMe.split(";").forEach(Nc=>{ma===Nc&&(lc=!0)});return 1===t.AFrameworkApplication.ua.Ab.gi&&vb.isFirstParty()&&D===Fc.zIh&&lc&&xb.d(vb.getSolutionId())===Fc.AIh}getAccessTokenFirstPartyOAuth(D,ma){let vb;
vb=this.rrj(D,ma)?lc=>{const Nc=this.IWi();Nc.continueWith(()=>{Nc.result.ey(D,ma).then(wd=>{lc(wd);return wd})})}:lc=>{lc(Object.assign(new Vd.a,{IsSuccess:!1,Token:null,ErrorCode:"NotEnabled",ErrorMessage:"OAuthManager is disabled."}))};return OfficeExtension.WacRuntime.Utility.createPromise(vb)}getTypeName(){return"Microsoft.Office.Auth"}invokePropertyGet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);
}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,ma){switch(D){case 1:return this.zIi(ma)}D=this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}zIi(D){const ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,0,"string");D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,
1,"string");return this.getAccessTokenFirstPartyOAuth(ma,D)}}Fc.zIh="Maker";Fc.AIh="fa000000043";Object(l.a)(Fc,"Auth",null,[]);var xd=a(1078),Ic=a(48),bd=a(67);class yb{constructor(){this.cCa=null}O0i(){this.cCa||(this.cCa=ub.a.Jq(Object(Ha.d)(xd.a)));return this.cCa}getSharedFilePickerResponse(D){return OfficeExtension.WacRuntime.Utility.createPromise((ma,vb)=>{try{const lc=this.O0i();bd.Task.WAA.call(null,lc).continueWith(()=>{const Nc=lc.result;if(Nc){let wd={};(()=>{let Yd=Ic.d(D);({Ws:wd}=Yd);
return Yd})().returnValue?Nc.Izc(wd).then(Yd=>{Yd&&0<Yd.length?ma(Yd):vb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker returned null or an empty array."))}).catch(Yd=>{vb(Yd)}):vb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else vb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker is resolved as null."))})}catch(lc){vb(lc)}})}getTypeName(){return"Microsoft.Office.SharedFilePicker"}invokePropertyGet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);
}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,ma){switch(D){case 1:return this.N0i(ma)}D=this.invokeMethod(D,
ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}N0i(D){D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,0,"string");return this.getSharedFilePickerResponse(D)}}Object(l.a)(yb,"SharedFilePicker",null,[]);var Oc=a(179);class kd{Nif(D){return'[data-unique-id="Ribbon-'+D+'"]'}gwg(D,ma){ma=JSON.parse(ma);if("callout"===ma.type)return ma.params.target=this.Nif(ma.params.target),D.callout(ma.params);ma.props.target=this.Nif(ma.props.target);return ma.props}M$j(D){return JSON.parse(D)}addNotification(D,
ma){if(!this.wD)return Oc.a.QF().then(vb=>vb.addNotification(this.gwg(vb,D),this.M$j(ma)))}removeNotification(D){if(!this.wD)return Oc.a.QF().then(ma=>ma.removeNotification(D))}updateNotification(D,ma){if(!this.wD)return Oc.a.QF().then(vb=>vb.updateNotification(D,this.gwg(vb,ma)))}getTypeName(){return"Microsoft.Office.NotificationService"}invokePropertyGet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);
}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,ma){switch(D){case 1:return this.vAh(ma);case 3:return this.Yqk(ma);case 2:return this.cel(ma)}D=this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}vAh(D){const ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,
0,"string");D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,1,"string");return this.addNotification(ma,D)}Yqk(D){D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,0,"string");return this.removeNotification(D)}cel(D){const ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,0,"string");D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,1,"string");return this.updateNotification(ma,D)}}Object(l.a)(kd,"NotificationService",null,[]);class Rc{constructor(D){this.gdg=
D}execute(D,ma){if(this.gdg){const vb=this.gdg.lookupApi(D);if(vb)return vb.doExecutionAsync(ma)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}getTypeName(){return"Microsoft.Office.DispatchApiService"}invokePropertyGet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);
}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,ma){switch(D){case 1:return this.KFd(ma)}D=this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}KFd(D){const ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,0,"string");D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,
1,"string");return this.execute(ma,D)}}Object(l.a)(Rc,"DispatchApiService",null,[]);class Xb{constructor(D,ma){this.Onb=D;this.f4d=(void 0===ma?null:ma)||OfficeExtension.WacRuntime.RichApi.getEventManager()}execute(D){if(this.Onb){const ma=this.Onb.getSdxPrivateApi();if(ma)return ma.execute(D)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException("SdxPrivateApi");}_RegisterPrivateApiEvent(){if(this.Onb){const D=this.Onb.getSdxPrivateApi();if(D)return this.f4d.register(this.Onb.getID(),
"",65552),D.register(ma=>this.f4d.fireEvent("",65552,{messageData:ma}))}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException("SdxPrivateApi");}_UnregisterPrivateApiEvent(){this.f4d.unregister(this.Onb.getID(),"",65552)}getTypeName(){return"Microsoft.Office.PrivateApiService"}invokePropertyGet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);
}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D){switch(D){case 4:return this.Thh();case 5:return this.$hh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,ma){switch(D){case 1:return this.KFd(ma)}D=this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}KFd(D){D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,
0,"string");return this.execute(D)}Thh(){this._RegisterPrivateApiEvent();return null}$hh(){this._UnregisterPrivateApiEvent();return null}}Object(l.a)(Xb,"PrivateApiService",null,[]);class dc{constructor(){this.jy="";this.nyb=null;this.rDb=this.WQa=this.qD="";this.LDb=!0;this.options=null}get appName(){return this.jy}set appName(D){this.jy=D}get authChallenge(){return this.nyb}set authChallenge(D){this.nyb=D}get correlationId(){return this.qD}set correlationId(D){this.qD=D}get policy(){return null}set policy(D){}get resource(){return this.WQa}set resource(D){this.WQa=
D}get scope(){return this.rDb}set scope(D){this.rDb=D}get silentLogin(){return this.LDb}set silentLogin(D){this.LDb=D}getTypeName(){return"Microsoft.Authentication.TokenParameters"}invokePropertyGet(D){switch(D){case 8:return this.appName;case 3:return this.authChallenge;case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertyGetAsync(D){D=
this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D,ma){switch(D){case 8:this.appName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return;case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return;case 7:this.correlationId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,
0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);
}invokeMethodAsync(D,ma){D=this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}}Object(l.a)(dc,"TokenParameters",null,[]);class Vc{createInstance(D,ma,vb,lc,Nc,wd,Yd,ee){vb=void 0===vb?"":vb;lc=void 0===lc?null:lc;Nc=void 0===Nc?null:Nc;wd=void 0===wd?null:wd;Yd=void 0===Yd?null:Yd;ee=void 0===ee?null:ee;switch(D){case "Microsoft.Office.ActionService":return new dd(ma);case "Microsoft.Authentication.TokenParameters":if(Object(xa.a)())return new dc;break;case "Microsoft.Office.SharedFilePicker":return new yb;
case "Microsoft.Office.Auth":return new Fc(vb,lc,Nc);case "Microsoft.Office.AugLoopEventService":return new wc(vb);case "Microsoft.Office.NotificationService":return new kd;case "Microsoft.Office.DispatchApiService":return new Rc(wd);case "Microsoft.Office.PrivateApiService":if(null===Yd||void 0===Yd?0:Yd.isFirstParty())return new Xb(Yd,ee)}return null}}Object(l.a)(Vc,"WacApiHost",null,[]);var yd=a(1229);class Pd{constructor(){this.dAb=this.Wzb=this.u5=null;this.Y$=0}get displayName(){return this.u5}set displayName(D){this.u5=
D}get email(){return this.Wzb}set email(D){this.Wzb=D}get federationProvider(){return this.dAb}set federationProvider(D){this.dAb=D}get identityType(){return this.Y$}set identityType(D){this.Y$=D}getTypeName(){return"Microsoft.Authentication.OfficeIdentityInfo"}invokePropertyGet(D){switch(D){case 4:return this.displayName;case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertyGetAsync(D){D=
this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D,ma){switch(D){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,
0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,ma){D=this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}}Object(l.a)(Pd,"OfficeIdentityInfo",null,[]);class re{}re.accessDenied="AccessDenied";
re.Akb="InvalidGrant";re.serverError="ServerError";re.S$b="UserNotSignedIn";re.cze="UnexpectedError";re.Akj="InteractiveFlowAborted";re.J6f="ItemNotFound";Object(l.a)(re,"ErrorCodes",null,[]);class ue{constructor(D){this.qid=D}get id(){return this.qid.getId()}get value(){return this.qid.bE()}set value(D){this.uth=this.qid.setValue(D)}getTypeName(){return"Microsoft.Authentication.RoamingSetting"}invokePropertyGet(D){switch(D){case 1:return this.id;case 2:return this.value}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);
}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D,ma){switch(D){case 2:this.value=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"any");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return this.uth}invokeMethod(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,
ma){D=this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}}Object(l.a)(ue,"RoamingSetting",null,[]);class He{constructor(D){this.mDb=D}getItem(D){return(async()=>{const ma=await this.mDb.D_i(D);if(null==ma)throw re.J6f;return new ue(ma)})()}getItemOrNullObject(D){return(async()=>{const ma=await this.mDb.D_i(D);return null==ma?null:new ue(ma)})()}getTypeName(){return"Microsoft.Authentication.RoamingSettingCollection"}invokePropertyGet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);
}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,ma){switch(D){case 1:return this.OTi(ma);case 2:return this.PTi(ma)}D=
this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}OTi(D){D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,0,"string");return this.getItem(D)}PTi(D){D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,0,"string");return this.getItemOrNullObject(D)}}Object(l.a)(He,"RoamingSettingCollection",null,[]);class bf{constructor(D,ma){this.rOa=D;this.Y$=ma}get accessToken(){return this.rOa}set accessToken(D){this.rOa=D}get tokenIdenityType(){return this.Y$}set tokenIdenityType(D){this.Y$=
D}getTypeName(){return"Microsoft.Authentication.SingleSignOnToken"}invokePropertyGet(D){switch(D){case 2:return this.accessToken;case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D,ma){switch(D){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return;case 3:this.tokenIdenityType=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,ma){D=this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}}Object(l.a)(bf,
"SingleSignOnToken",null,[]);const af=new Map([["fa000000124",{kJh:["OfficeInsightsServices"],resources:["79d1f229-c1e5-4bd5-b2fd-4764b025b103"]}]]);class Pe{constructor(D,ma,vb,lc){this.dgd=null;this.vAa=ma;this.Um=D;this.mDb=vb;this.wD=void 0===lc?!1:lc}getOsfControl(){return this.vAa.getOsfControl(this.Um)}KWi(){null==this.dgd&&(this.dgd=new Promise((D,ma)=>{Object(cd.a)().execute(vb=>{vb||(B.ULS.sendTraceTag(507115601,356,15,"AuthenticationService oauthManager not valid"),ma("AuthenticationService oauthManager not valid"));
D(vb)})}));return this.dgd}BYi(){const D=t.AFrameworkApplication.ea.Qa("HostAuthType");return"aad"===D.toLowerCase()?0:"msa"===D.toLowerCase()?1:2}BHj(D,ma){B.ULS.sendTraceTag(507115600,344,50,"{0}",{["manifestId"]:ma,["correlationId"]:D.correlationId,["appName"]:D.appName})}AHj(D,ma){B.ULS.sendTraceTag(507115599,344,15,"{0}",{["manifestId"]:D,["error"]:ma})}static KJj(D){switch(D.ErrorCode){case "interaction_required":case "UserInteractionRequired":return re.Akb;case "Cookies Disabled":return re.S$b;
case "UserCancelled":return re.Akj}return re.cze}GUd(D,ma){const vb=D.getWebApplicationAuthorizations();D=null;for(const lc of vb)if(lc.getResource().toLowerCase()===ma.resource.toLowerCase()){D=lc;break}if(!D)return!1;ma=ma.scope.split(" ,+");for(const lc of ma)if(lc&&lc.length){ma=!1;for(const Nc of D.getScopes())lc.toLowerCase()===Nc.toLowerCase()&&(ma=!0);if(!ma)return!1}return!0}async NOb(D){const ma=this.getOsfControl();var vb=ma.getManifest();const lc=vb.getMarketplaceID();this.BHj(D,lc);const Nc=
wd=>{this.AHj(lc,wd);return Promise.reject(wd)};try{if(!ma.isFirstParty()||!this.vAa._enableFirstPartySSO||!this.GUd(vb,D))return Nc(re.accessDenied);const wd=D.appName;vb="";if(wd){const Yd=af.get(ma.getSolutionId().toLocaleLowerCase()),ee=D.resource;if(!(ee&&Yd&&Yd.kJh.includes(wd)&&Yd.resources.includes(ee)))return Nc(re.accessDenied);const ae=await this.KWi();let he;he=D.silentLogin?await ae.ey(wd,D.resource,void 0,D.authChallenge):await ae.qza(wd,D.resource,void 0,D.authChallenge);if(!he.IsSuccess)return Nc(Pe.KJj(he));
vb=he.Token}else{const Yd=Object(yd.a)();try{vb=(await Yd.getAccessToken(D,lc)).accessToken}catch(ee){return Nc("string"===typeof ee?ee:re.cze)}}return new bf(vb,this.BYi())}catch(wd){return Nc(re.cze)}}async zYi(){var D=this.getOsfControl();if(!D.isFirstParty())return Promise.reject(re.accessDenied);D=D.getManifest().getMarketplaceID();D=await Object(yd.a)().getPrimaryIdentityInfo(D);const ma=new Pd;ma.displayName=D.displayName;ma.email=D.email;switch(D.authority){case "MicrosoftAccount":ma.identityType=
1;break;case "AzureActiveDirectoryAccount":ma.identityType=0;break;default:ma.identityType=2}ma.federationProvider="";return ma}get roamingSettings(){return this.wD||null==this.mDb||!this.getOsfControl().isFirstParty()?null:new He(this.mDb)}getAccessToken(D){if(!this.wD)return this.NOb(D)}getPrimaryIdentityInfo(){if(!this.wD)return this.zYi()}getTypeName(){return"Microsoft.Authentication.AuthenticationService"}invokePropertyGet(D){switch(D){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);
}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,ma){switch(D){case 1:return this.wJd(ma);case 2:return this.GNd()}D=
this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}wJd(D){D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,0,dc);return this.getAccessToken(D)}GNd(){return this.getPrimaryIdentityInfo()}}Object(l.a)(Pe,"AuthenticationService",null,[]);var wf=a(141);class xf{constructor(){this.responseData=null}}Object(l.a)(xf,"UserFeedbackResponseEventArgs",null,[]);class Cf{constructor(){this.isFeedbackSent=!1}}Object(l.a)(Cf,"UserFeedbackUIDismissedEventArgs",
null,[]);var tf=a(242);class Jf{constructor(D,ma,vb,lc){this.fP=D;this.s5=ma;this.wD=void 0===vb?!1:vb;this.vS=(void 0===lc?null:lc)||OfficeExtension.WacRuntime.RichApi.getEventManager()}onDismiss(D){this.vS.fireEvent("",65546,Object.assign(new Cf,{isFeedbackSent:D}))}onError(){}Yyi(D){this.vS.fireEvent("",65550,Object.assign(new xf,{responseData:JSON.stringify(D)}))}cNd(D){switch(D){case 0:return"Smile";case 1:return"Frown";case 2:return"Idea";case 3:return"Unclassified";default:return"Unclassified"}}dNd(D){switch(D){case 0:return"Modal";
case 1:return"SidePane";default:return"Modal"}}bNd(D){const ma={};ma.isScenarioEnabled=D.isScenarioEnabled;ma.scenarioType=D.scenarioType;if(D=D.question){const vb={};vb.questionUiType=D.questionUIType;vb.questionUiBehavior=D.questionUiBehavior;vb.questionUiBehaviour=D.questionUiBehaviour;vb.questionInstruction=D.questionInstruction;vb.questionOptions=D.questionOptions;ma.questionDetails=vb}return ma}US(D,ma,vb){"True"===vb?D[ma]=!0:"False"===vb&&(D[ma]=!1)}canCollectUserFeedback(){return t.AFrameworkApplication.Gv}collectUserFeedback(D,
ma,vb,lc){if(!this.wD){const Nc={};t.AFrameworkApplication.ea.Nkc(Nc);const wd=this.s5.getContext(Nc);wd.initialFeedbackType=this.cNd(D);wd.uiType=this.dNd(ma);wd.telemetryGroup.featureArea=vb;lc.v2Config.contextDataFiles&&(wd.isShareContextDataEnabled=!0,wd.getContextData=()=>Promise.all(tf.a.map(lc.v2Config.contextDataFiles,Yd=>window.fetch("data:application/octet-stream;base64,"+Yd.base64Data).then(ee=>ee.blob()).then(ee=>new File([ee],Yd.fileName,{type:Yd.fileType})))));(D=lc.v2Config.scenarioConfig)&&
(wd.scenarioConfig=this.bNd(D));this.US(wd,"showEmailAddress",lc.v2Config.isEmailCollectionEnabled);this.US(wd,"isFileUploadEnabled",lc.v2Config.isFileUploadEnabled);this.US(wd,"screenshot",lc.v2Config.isScreenshotEnabled);this.US(wd,"isScreenRecordingEnabled",lc.v2Config.isScreenRecordingEnabled);this.US(wd,"isThankYouPageDisabled",lc.v2Config.isThankYouPageDisabled);this.US(wd,"isHostManagedContextDataEnabled",lc.v2Config.isHostManagedContextDataEnabled);this.US(wd,"isRetrieveFormDataEnabled",lc.v2Config.isRetrieveFormDataEnabled);
wd.hostManagedContextDataExplanationUrl=lc.v2Config.hostManagedContextDataExplanationUrl;Oc.a.aNd().then(Yd=>{Yd.initializeFeedbackModal(wd,Object(wf.a)(this,this.onDismiss,"onDismiss"),Object(wf.a)(this,this.onError,"onError"),Object(wf.a)(this,this.Yyi,"extractFeedbackDataForHost"));return Yd})}}collectUserFeedbackData(){return null}getHostScreenshot(){return null}getInitializationData(){return null}invokeDiagnosticsLogsUpload(){}_RegisterUserFeedbackResponseEvent(){this.wD||this.vS.register(this.fP,
"",65550)}_RegisterUserFeedbackUIDismissedEvent(){this.wD||this.vS.register(this.fP,"",65546)}_UnregisterUserFeedbackResponseEvent(){this.wD||this.vS.unregister(this.fP,"",65550)}_UnregisterUserFeedbackUIDismissedEvent(){this.wD||this.vS.unregister(this.fP,"",65546)}getTypeName(){return"Microsoft.Office.UserFeedbackService"}invokePropertyGet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);
}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D,ma){switch(D){case 27:return this.LUh();case 1:return this.L_h(ma);case 33:return this.QSi();case 32:return this.iTi();case 34:return this.blj(ma);case 28:return this.Whh();case 18:return this.Xhh();case 29:return this.cih();case 19:return this.dih()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,ma){switch(D){case 56:return this.K_h()}D=
this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}LUh(){return this.canCollectUserFeedback()}L_h(D){const ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,0,"int"),vb=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,1,"int"),lc=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,2,"string");D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,3,"object");this.collectUserFeedback(ma,vb,lc,D);return null}K_h(){return this.collectUserFeedbackData()}QSi(){return this.getHostScreenshot()}iTi(){return this.getInitializationData()}blj(D){D=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,0,"string");this.invokeDiagnosticsLogsUpload(D);return null}Whh(){this._RegisterUserFeedbackResponseEvent();return null}Xhh(){this._RegisterUserFeedbackUIDismissedEvent();return null}cih(){this._UnregisterUserFeedbackResponseEvent();return null}dih(){this._UnregisterUserFeedbackUIDismissedEvent();return null}}Object(l.a)(Jf,"UserFeedbackService",null,[]);class dg{constructor(){this.displayName=this.description=this.color="";this.encryptionType=
0;this.isEnabled=this.isDke=this.hasExtractForUser=!1;this.labelId="";this.order=0;this.tenantId=this.parentName="";this.version=0;this.displayName=this.description=this.color="";this.encryptionType=0;this.isEnabled=this.isDke=this.hasExtractForUser=!1;this.labelId="";this.order=0;this.tenantId=this.parentName="";this.version=0}getTypeName(){return"Microsoft.Office.SensitivityLabelInfo"}invokePropertyGet(D){switch(D){case 15:return this.color;case 13:return this.description;case 12:return this.displayName;
case 8:return this.encryptionType;case 10:return this.hasExtractForUser;case 9:return this.isDke;case 7:return this.isEnabled;case 5:return this.labelId;case 11:return this.order;case 14:return this.parentName;case 6:return this.tenantId;case 4:return this.version}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D,ma){switch(D){case 15:this.color=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return;case 13:this.description=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return;case 12:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return;case 8:this.encryptionType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"int");return;case 10:this.hasExtractForUser=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"boolean");return;
case 9:this.isDke=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"boolean");return;case 7:this.isEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"boolean");return;case 5:this.labelId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return;case 11:this.order=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"int");return;case 14:this.parentName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return;
case 6:this.tenantId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return;case 4:this.version=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,
ma){D=this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}}Object(l.a)(dg,"SensitivityLabelInfo",null,[]);var uf=a(178),lf=a(126),Pf;(function(D){D[D.rIi=0]="generic";D[D.coherencyFailure=1]="coherencyFailure";D[D.upf=2]="disabledByPolicy";D[D.Prl=3]="fileCheckedOut";D[D.Qrl=4]="fileEncrypted";D[D.Rrl=5]="fileLocked";D[D.Trl=6]="fileNotSupported";D[D.fileTooLarge=7]="fileTooLarge";D[D.ysl=8]="invalidOperationOnZeroByteFile";D[D.BAj=9]="labelDisabled";D[D.Rsl=
10]="labelErrorRetryLater";D[D.CAj=11]="labelIdNotFound";D[D.Ssl=12]="labelIrmDisabledByTenant";D[D.Tsl=13]="labelNotSupported";D[D.jtl=14]="mandatoryConflict";D[D.otl=15]="minorVersionLimitExceeded";D[D.gBl=16]="unprotectedLabelNotSupported";D[D.szl=17]="permissionChangeNotSupported"})(Pf||(Pf={}));Object(l.b)("SetPolicyLabelErrorType",Pf);var Rf=a(1311);a(1310);class Mf{constructor(D,ma){this.message="";this.severity=2;this.version=0;this.message=D;this.severity=ma;this.version=0}getTypeName(){return"Microsoft.Office.SensitivityResultDetails"}invokePropertyGet(D){switch(D){case 24:return this.message;
case 25:return this.severity;case 23:return this.version}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D,ma){switch(D){case 24:this.message=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return;case 25:this.severity=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"int");return;case 23:this.version=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,ma){D=this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}}Object(l.a)(Mf,
"SensitivityResultDetails",null,[]);var zf=a(1312),df;(function(D){D[D.gpl=0]="S_APPLYLABEL_OK";D[D.Odh=2147467259]="E_APPLYLABEL_FAIL";D[D.lEe=2147205120]="E_APPLYLABEL_UNSUPPORTED_CROSSTENANT";D[D.eEe=2147205119]="E_APPLYLABEL_DOCUMENT_READONLY";D[D.fEe=2147205118]="E_APPLYLABEL_INSUFFICIENTPERMISSION";D[D.gEe=2147205117]="E_APPLYLABEL_LABELDISABLED";D[D.nEe=2147205116]="E_APPLYLABEL_UNSUPPORTED_UDP";D[D.hEe=2147205115]="E_APPLYLABEL_LABELING_DISABLED";D[D.kEe=2147205114]="E_APPLYLABEL_UNSUPPORTED_CONTENTTYPE";
D[D.mEe=2147205113]="E_APPLYLABEL_UNSUPPORTED_DKE";D[D.iEe=2147205112]="E_APPLYLABEL_LABELNOTFOUND";D[D.jEe=2147205105]="E_APPLYLABEL_NEWLABELSENSITIVITYORDER"})(df||(df={}));Object(l.b)("TryUpgradeLabelError",df);class Bf{constructor(){this.context="";this.error=2147467259;this.previousLabel=this.newLabel=null;this.context="";this.error=2147467259;this.previousLabel=this.newLabel=null}getTypeName(){return"Microsoft.Office.SensitivityLabelChangedEventArgs"}invokePropertyGet(D){switch(D){case 20:return this.context;
case 21:return this.error;case 19:return this.newLabel;case 18:return this.previousLabel}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D,ma){switch(D){case 20:this.context=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return;case 21:this.error=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,
"int");return;case 19:this.newLabel=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"SensitivityLabelInfo");return;case 18:this.previousLabel=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"SensitivityLabelInfo");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);
}invokeMethodAsync(D,ma){D=this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}}Object(l.a)(Bf,"SensitivityLabelChangedEventArgs",null,[]);var Kf=a(985);class Vf{constructor(D,ma){this.vS=OfficeExtension.WacRuntime.RichApi.getEventManager();this.fP=D;if(b()&&!ma)throw B.ULS.sendTraceTag(507039969,306,10,"futurePolicyManager is null"),Error.argumentNull("futurePolicyManager");this.vAb=ma}IN(){var D;return null===(D=t.AFrameworkApplication.ea)||void 0===D?void 0:
D.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSensitivityLabelingInOfficeJS",!1)}HHc(){var D;return null===(D=t.AFrameworkApplication.ea)||void 0===D?void 0:D.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRefactoringErrorEventInOfficeJS",!1)}wxc(D,ma,vb){const lc=new Bf;lc.context=D;lc.error=ma;lc.newLabel=vb;this.vS.fireEvent("",65549,lc)}tv(D,ma){this.YGj(D,ma);b()&&this.gJa(D,ma)}YGj(D,ma){uf.a.sendTelemetryEvent({name:"Office.Online.Extensibility.ContextualTabsRichApi.Diagnostics",
dataFields:lf.a.Eh({["Class"]:"SensitivityService",["ControlId"]:this.fP,["Api"]:D,["Hr"]:ma.toString()})})}gJa(D,ma){var vb;switch(D){case this.getLabel.name:D="GetLabel";break;case this.getHighestSensitivityLabel.name:D="GetHighestSensitivityLabel";break;case this.tryUpgradeLabel.name:D="TryUpgradeLabel";break;case this.getSensitivityResultDetails.name:D="GetSensitivityResultDetails";break;case this._RegisterSensitivityLabelChangedEvent.name:D="RegisterSensitivityLabelChangedEvent";break;default:return}uf.a.sendTelemetryEvent({name:`Office.Online.Security.Clp.SensitivityService${D}`,
dataFields:[{name:"Hr",int64:ma},{name:"SupportsPolicies",bool:Kf.b.instance.supportsPolicies()},{name:"SupportsCoauthoring",bool:Kf.b.instance.supportsOfficeClientCoauthoring()},{name:"FullAppSettingsReady",bool:!(null===(vb=t.AFrameworkApplication.ea)||void 0===vb||!vb.XZa)}]})}$4i(D){return D.HasUserDefinedPermissions?2:D.IsEndpointProtectionEnabled?1:0}nac(D){var ma;const vb=new dg;vb.color=D.Color;vb.description=D.Tooltip;vb.displayName=D.ParentName?D.ParentName+"\\"+D.DisplayName:D.DisplayName;
vb.encryptionType=this.$4i(D);vb.hasExtractForUser=D.HasExtractForUser;vb.isDke=!1;vb.isEnabled=D.Enabled;vb.labelId=D.Id;vb.order=D.Order;vb.parentName=D.ParentName;vb.tenantId=null===(ma=t.AFrameworkApplication.ea)||void 0===ma?void 0:ma.Qa("TenantId");vb.version=0;return vb}NLk(D){switch(D){case Pf.rIi:return 2147467259;case Pf.upf:return 2147205115;case Pf.CAj:return 2147205112;case Pf.BAj:return 2147205117;default:return 2147467259}}frj(D){var ma;return D.tenantId===(null===(ma=t.AFrameworkApplication.ea)||
void 0===ma?void 0:ma.Qa("TenantId"))}getHighestSensitivityLabel(D){return OfficeExtension.WacRuntime.Utility.createPromise((ma,vb)=>{var lc;const Nc=Yd=>{this.tv(this.getHighestSensitivityLabel.name,Yd);vb(Yd)};if(this.IN())if(null!==(lc=t.AFrameworkApplication.ea)&&void 0!==lc&&lc.ka("SupportsPolicies"))if(D&&0!=D.length){if(lc=this.vAb.instance){var wd=D.map(Yd=>Yd.labelId);if(Object(Rf.b)()){lc=lc.getHighestSensitivityLabel(wd);if(lc.val)return b()&&this.gJa(this.getHighestSensitivityLabel.name,
0),ma(this.nac(lc.val));ma=c(lc.Igb);if(b())return Nc(ma);this.tv("getHighestSensitivityLabel",ma);return vb(ma)}if(lc=lc.KSi(wd))return b()&&this.gJa(this.getHighestSensitivityLabel.name,0),ma(this.nac(lc));if(b())return Nc(2147647531);this.tv("getHighestSensitivityLabel",2147647531);return vb(2147647531)}if(b())return Nc(2147942488);this.tv("getHighestSensitivityLabel",2147942488);vb(2147942488)}else{if(b())return Nc(2147942487);this.tv("getHighestSensitivityLabel",2147942487);vb(2147942487)}else{if(b())return Nc(2147205115);
this.tv("getHighestSensitivityLabel",2147205115);vb(2147205115)}else{if(b())return Nc(2147500033);this.tv("getHighestSensitivityLabel",2147500033);vb(2147500033)}})}getLabel(){return OfficeExtension.WacRuntime.Utility.createPromise((D,ma)=>{const vb=Nc=>{this.tv(this.getLabel.name,Nc);ma(Nc)};if(this.IN()){var lc=this.vAb.instance;if(lc){if(Object(Rf.b)()){lc=lc.JJi();if(lc.val)return b()&&this.gJa(this.getLabel.name,0),D(this.nac(lc.val));D=c(lc.Igb);return vb(D)}const [Nc,wd]=lc.LJi();if(Nc)b()&&
this.gJa(this.getLabel.name,0),D(this.nac(wd));else{if(b())return vb(wd);this.tv("getLabel",wd);ma(wd)}}else{if(b())return vb(2147942488);this.tv("getLabel",2147942488);ma(2147942488)}}else{if(b())return vb(2147500033);this.tv("getLabel",2147500033);ma(2147500033)}})}tryUpgradeLabel(D,ma){return OfficeExtension.WacRuntime.Utility.createPromise((vb,lc)=>{var Nc,wd=ae=>{this.tv(this.tryUpgradeLabel.name,ae);lc(ae)};const Yd=()=>{this.gJa(this.tryUpgradeLabel.name,0);vb(0)},ee=ae=>{this.HHc()&&this.wxc(ma,
ae,D)};if(this.IN())if(null!==(Nc=t.AFrameworkApplication.ea)&&void 0!==Nc&&Nc.ka("SupportsPolicies")){if(!Object(Rf.e)()){if(!D){if(b())return wd(2147942487);this.tv("tryUpgradeLabel",2147942487);lc(2147942487);return}if(!this.frj(D)){if(b()){ee(2147205120);wd(2147205120);return}this.tv("tryUpgradeLabel",2147205120);this.HHc()&&this.wxc(ma,2147205120,D);lc(2147205120);return}}if(Nc=this.vAb.instance){wd="OFFICEJS_SENSITIVITY_CONTEXT_"+ma;Object(Rf.b)()?(wd=Nc.tryUpgradeLabel((null===D||void 0===
D?void 0:D.labelId)||"",Object(Rf.e)()?(null===D||void 0===D?void 0:D.tenantId)||"":"",wd),wd=c(wd)):wd=Nc.e$k((null===D||void 0===D?void 0:D.labelId)||"",Object(Rf.e)()?(null===D||void 0===D?void 0:D.tenantId)||"":"",wd);if(0===wd)return b()?Yd():vb(wd);b()?this.tv(this.tryUpgradeLabel.name,wd):this.tv("tryUpgradeLabel",wd);if(this.HHc()&&(Object.values(df).includes(wd)&&(b()?ee(wd):this.wxc(ma,wd,D)),2147205105===wd)){if(b())return Yd();vb(0);return}lc(wd)}else{if(b())return wd(2147942488);this.tv("tryUpgradeLabel",
2147942488);lc(2147942488)}}else b()?(ee(2147205117),wd(2147205117)):(this.tv("tryUpgradeLabel",2147205115),this.HHc()&&this.wxc(ma,2147205115,D),lc(2147205115));else{if(b())return wd(2147500033);this.tv("tryUpgradeLabel",2147500033);lc(2147500033)}})}getSensitivityResultDetails(D,ma){return OfficeExtension.WacRuntime.Utility.createPromise((vb,lc)=>{var Nc=Yd=>{this.tv(this.getSensitivityResultDetails.name,Yd);lc(Yd)};if(this.IN()){var wd=this.vAb.instance;if(wd){if(Object.values(df).includes(D))return Nc=
wd.qHf(D),wd=wd.BNi(D,ma),wd=new Mf(wd,Nc),b()&&this.gJa(this.getSensitivityResultDetails.name,0),vb(wd);if(b())return Nc(2147942487);this.tv("getSensitivityResultDetails",2147942487);lc(2147942487)}else{if(b())return Nc(2147942488);this.tv("getSensitivityResultDetails",2147942488);lc(2147942488)}}else{if(b())return Nc(2147500033);this.tv("getSensitivityResultDetails",2147500033);lc(2147500033)}})}_RegisterSensitivityLabelChangedEvent(){var D;const ma=vb=>{this.tv(this._RegisterSensitivityLabelChangedEvent.name,
vb)};this.IN()?null!==(D=t.AFrameworkApplication.ea)&&void 0!==D&&D.ka("SupportsPolicies")?(D=this.vAb.instance)?(D.MCa((vb,lc)=>{var Nc;vb=new Bf;vb.context=(null===(Nc=lc.context)||void 0===Nc?0:Nc.startsWith("OFFICEJS_SENSITIVITY_CONTEXT_"))?lc.context.substring(29):lc.context;vb.error=lc.nG?0:this.NLk(lc.kSg);vb.newLabel=this.nac(lc.Lmc);this.vS.fireEvent("",65549,vb)}),this.vS.register(this.fP,"",65549),b()&&this.gJa(this._RegisterSensitivityLabelChangedEvent.name,0)):b()?ma(2147942488):this.tv("registerSensitivityLabelChangedEvent",
2147942488):b()?ma(2147205115):this.tv("registerSensitivityLabelChangedEvent",2147205115):b()?ma(2147500033):this.tv("registerSensitivityLabelChangedEvent",2147500033)}_UnregisterSensitivityLabelChangedEvent(){this.IN()?this.vS.unregister(this.fP,"",65549):this.tv("unregisterSensitivityLabelChangedEvent",2147500033)}getTypeName(){return"Microsoft.Office.SensitivityService"}invokePropertyGet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D){switch(D){case 16:return this.Uhh();case 17:return this.aih()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,ma){switch(D){case 3:return this.JSi(ma);
case 1:return this.cUi();case 22:return this.v0i(ma);case 2:return this.d$k(ma)}D=this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}JSi(D){D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,0,"Array<Common.App.AppsForOffice.SensitivityLabelInfo>");return this.getHighestSensitivityLabel(D)}cUi(){return this.getLabel()}v0i(D){const ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,0,"int");D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,
1,"int");return this.getSensitivityResultDetails(ma,D)}d$k(D){const ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,0,"SensitivityLabelInfo");D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,1,"string");return this.tryUpgradeLabel(ma,D)}Uhh(){this._RegisterSensitivityLabelChangedEvent();return null}aih(){this._UnregisterSensitivityLabelChangedEvent();return null}}Object(l.a)(Vf,"SensitivityService",null,[]);class sb{launchSimpleDialog(){return null}getTypeName(){return"Microsoft.Office.ShowSimpleDialog"}invokePropertyGet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);
}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,ma){switch(D){case 1:return this.GBj(ma)}D=this.invokeMethod(D,
ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}GBj(D){const ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,0,"string"),vb=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,1,"string"),lc=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,2,"string"),Nc=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,3,"int"),wd=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,4,"boolean"),Yd=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,
5,"string"),ee=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,6,"boolean");D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,7,"string");return this.launchSimpleDialog(ma,vb,lc,Nc,wd,Yd,ee,D)}}Object(l.a)(sb,"ShowSimpleDialog",null,[]);var Gc=a(1024),ad=a(1676),Wd=a(1301),je=a(1303),Ie=a(1299),Je=a(1302);class $e{CQd(D){const ma=new Wd.a("FA000000012","sdxcatalog","sdxcatalog","0.0.0.0"),vb=new Je.a(Gc.a.MWi(),"Web","en-Us"),lc=new je.a;lc.$q=D;ad.a.instance.Jva(ma,Ie.a.taskpane,
"CopilotHelpTaskpane",vb,lc)}launchHelpPaneByArticleId(D){this.CQd({SourceControlId:"SearchHelp",query:"AssetID="+D});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}launchHelpPaneByArticleIdString(D){this.CQd({SourceControlId:"SearchHelp",query:"AssetID="+D});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}launchHelpPaneByQuery(D){this.CQd({SourceControlId:"SearchHelp",query:D});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.CopilotService"}invokePropertyGet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);
}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,ma){switch(D){case 2:return this.mBj(ma);case 3:return this.nBj(ma);
case 1:return this.oBj(ma)}D=this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}mBj(D){D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,0,"int");return this.launchHelpPaneByArticleId(D)}nBj(D){D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,0,"string");return this.launchHelpPaneByArticleIdString(D)}oBj(D){D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,0,"string");return this.launchHelpPaneByQuery(D)}}Object(l.a)($e,
"CopilotService",null,[]);class Ib{constructor(D,ma){this.hideInternal=D;this.showInternal=ma}hide(D){this.checkInvalidArgument(D,"caller");return OfficeExtension.WacRuntime.Utility.createPromise((ma,vb)=>{this.hideInternal(D).then(ma).catch(vb)})}show(D,ma){this.checkInvalidArgument(D,"caller");this.checkInvalidArgument(ma,"options");return OfficeExtension.WacRuntime.Utility.createPromise((vb,lc)=>{this.showInternal(D,ma).then(vb).catch(lc)})}getTypeName(){return"Microsoft.Office.BusinessBarService"}checkInvalidArgument(D,
ma){if(OfficeExtension.WacRuntime.Utility.isNullOrUndefined(D))throw OfficeExtension.WacRuntime.Utility.createInvalidArgumentException(ma);}invokePropertyGet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertySetAsync(D,ma){this.invokePropertySet(D,
ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,ma){switch(D){case 2:return this.icj(ma);case 1:return this.NVk(ma)}D=this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}icj(D){D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,0,"string");return this.hide(D)}NVk(D){const ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,
0,"string");D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,1,"BusinessBarShowArgs");return this.show(ma,D)}}Object(l.a)(Ib,"BusinessBarService",null,[]);class Nb{constructor(){this.m_hideCloseButton=!1;this.m_message="";this.m_messageType=0;this.m_title=""}get hideCloseButton(){return this.m_hideCloseButton}set hideCloseButton(D){this.m_hideCloseButton=D}get message(){return this.m_message}set message(D){this.m_message=D}get messageType(){return this.m_messageType}set messageType(D){this.m_messageType=
D}get title(){return this.m_title}set title(D){this.m_title=D}getTypeName(){return"Microsoft.Office.BusinessBarShowArgs"}invokePropertyGet(D){switch(D){case 6:return this.hideCloseButton;case 4:return this.message;case 5:return this.messageType;case 3:return this.title}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D,ma){switch(D){case 6:this.hideCloseButton=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"boolean");return;case 4:this.message=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return;case 5:this.messageType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"int");return;case 3:this.title=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertySetAsync(D,ma){this.invokePropertySet(D,
ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,ma){D=this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}}Object(l.a)(Nb,"BusinessBarShowArgs",null,[]);var Bc;(function(D){D[D.info=0]="info";D[D.error=1]="error";D[D.zOh=2]="blocked";D[D.kAl=3]="severeWarning";D[D.success=4]="success";D[D.warning=5]="warning"})(Bc||(Bc={}));
Object(l.b)("BusinessBarType",Bc);var Af=a(675);class gf{doExecutionAsync(D){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}}Object(l.a)(gf,"DoEchoRichApi",null,[414]);var Qe;(function(D){D[D.Kql=0]="camera";D[D.ntl=1]="microphone";D[D.geolocation=2]="geolocation"})(Qe||(Qe={}));Object(l.b)("DevicePermissionType",Qe);class Aa{constructor(D,ma){this.AQa=D;this.wD=ma}apj(){var D;let ma=t.AFrameworkApplication.ea.Qa("OfficeApplicationName")||"";return(ma=ma.replace("Web",""))&&
"excel"!==ma.toLowerCase()?null===(D=t.AFrameworkApplication.ea)||void 0===D?void 0:D.getBooleanFeatureGate(`Microsoft.Office.${ma}Online.IsDevicePermissionServiceEnabled`,!1):!0}async requestPermissions(D){if(!this.wD){if(!this.apj())throw Error("DevicePermissionService is not enabled");var ma=[2];D=D.filter(he=>!ma.includes(he));D=D.map(he=>Qe[he]);var vb=await this.AQa.getBrowserPermissions(),lc=D.filter(he=>!vb.includes(he));if(0===lc.length)return await this.AQa.setBrowserPermissions(lc,!1),
Promise.resolve(!0);D=lc.map(he=>{let De="";switch(he){case "camera":De=Object(Ba.a)("CameraPermission");break;case "microphone":De=Object(Ba.a)("MicrophonePermission");break;case "geolocation":De=Object(Ba.a)("GeolocationPermission")}return De});D=(new Intl.ListFormat(t.AFrameworkApplication.uiCulture,{style:"long",type:"conjunction"})).format(D);var Nc=this.AQa.getManifest().getDefaultDisplayName(),wd=new hb.a;wd.hc=9;wd.ov=!1;wd.Ic(1,Object(Ba.a)("DialogAllow"));wd.Ic(2,Object(Ba.a)("DialogAllowOnce"));
wd.Ic(0,Object(Ba.a)("DialogDeny"));wd.wnd(Object(Ba.a)("LearnMore"),null,"2263603");var Yd=String.format(Object(Ba.a)("AddInRequestPermissionsTitle"),Nc,D),ee=String.format(Object(Ba.a)("AddInRequestPermissionsDescription"),D),ae;return new Promise(he=>{wd.Ni(Yd,ee,0,De=>{1===De?(ae=!0,this.AQa.setBrowserPermissions(lc,!0)):2===De?(ae=!0,this.AQa.setBrowserPermissions(lc,!1)):ae=!1;he(ae)})})}}getTypeName(){return"Microsoft.Office.DevicePermissionService"}invokePropertyGet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);
}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,ma){switch(D){case 1:return this.Rxk(ma)}D=this.invokeMethod(D,
ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}Rxk(D){D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,0,"Array<string>");return this.requestPermissions(D)}}Object(l.a)(Aa,"DevicePermissionService",null,[]);class Fb{constructor(D,ma,vb,lc,Nc){this.Thc=this.ibb=null;this.Hbc=D;this.Um=ma;this.Fu=vb;this.Qb=lc;this.n0e=Nc;this.Thc=new Map;this.Thc.set("Sample.doEcho",new gf)}hostName(){return"ExcelOnline"}appId(){return this.Hbc}createInstance(D){const ma=K.DdaFacadeService.Oa()?
this.Fu:kb.a(this.Qb);var vb=Nc=>(wd,Yd,ee)=>{ma.xi.UQf({actionType:Nc,controlId:wd,messageType:ee,targetId:Yd,message:""})};vb={register:vb(1),unregister:vb(2),fireEvent:(Nc,wd,Yd)=>{ma.xi.HQ(wd,Nc)&&ma.vK(wd,Nc,JSON.stringify(Yd))}};switch(D){case "Microsoft.Authentication.AuthenticationService":return D=this.Fu.Cf,vb=this.Um,this.Fu.gE&&(vb=this.Fu.jY(this.Um)),Object(xa.a)()?new Pe(vb,D,null):sa.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").create(vb,
D);case "Microsoft.Authentication.TokenParameters":if(Object(xa.a)()){if(vb=this.B4g(D,vb))return vb}else return new Hd;break;case "Microsoft.ExcelServices.CustomFunctionManager":return D=M.EwaSettings.Ra(114),vb=M.EwaSettings.Ra(115),new Ac(D,vb,gc(this.Hbc,this.Qb,this.Fu));case "Microsoft.AppRuntime.AppRuntimeService":return new rc(this.Um,this.Fu);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return new Tb(this.Hbc,this.Um,ma,this.Fu);case "Microsoft.DynamicRibbon.DynamicRibbon":return D=
null,D=ma.oWa(this.Um).Bj,new nd.DynamicRibbon(this.Hbc,this.Um,this.Fu,ma,D);case "Microsoft.Office.Licensing.License":return new Xd(this.Um,this.Fu);case "Microsoft.InternalService.AddinInternalService":return new rb(this.Um);case "Microsoft.Office.AugLoopEventService":let Nc=null;Nc=ma.oWa(this.Um).Bj;var lc=()=>"9202c06a-b7d3-466f-9adb-acad75789dbc"===Nc.PrimaryMarketplace.SolutionId&&M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.AugLoopEventServiceDevBypass",!1)&&("TestHost"===
this.Qb.ta.DocumentHostInfo.HostTier||"Dogfood"===t.AFrameworkApplication.tc.AudienceGroup);if(Af.a(Nc)||lc())return new wc(this.Um,!1,vb);break;case "Microsoft.Office.UserFeedbackService":let wd=null;wd=ma.oWa(this.Um).Bj;lc=()=>"9202c06a-b7d3-466f-9adb-acad75789dbc"===wd.PrimaryMarketplace.SolutionId&&M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.UserFeedbackServiceDevBypass",!1)&&("TestHost"===this.Qb.ta.DocumentHostInfo.HostTier||"Dogfood"===t.AFrameworkApplication.tc.AudienceGroup);
if(Af.a(wd)||lc())return new Jf(this.Um,Object(Ha.a)(pd.a),!1,vb);break;case "Microsoft.Office.SensitivityLabelInfo":return new dg;case "Microsoft.Office.SensitivityService":vb=null;vb=ma.oWa(this.Um).Bj;if(Af.a(vb))return new Vf(this.Um,Object(Ha.d)(Kb.a));break;case "Microsoft.Office.CopilotService":vb=null;vb=ma.oWa(this.Um).Bj;if("9202c06a-b7d3-466f-9adb-acad75789dbc"===vb.PrimaryMarketplace.SolutionId)return new $e;break;case "Microsoft.Office.BusinessBarShowArgs":return new Nb;case "Microsoft.Office.BusinessBarService":vb=
ma.Rp(this.Um).Bj;if(Af.a(vb)){const Yd={officeScriptsRunningStatus:64,msFormsDataSyncRunningStatus:69},ee=L.a.resolve(K.BusinessBarManagerService,{xa:1}).catch(ae=>{throw ae;});return new Ib(async ae=>{if(OfficeExtension.WacRuntime.Utility.isNullOrUndefined(Yd[ae]))throw OfficeExtension.WacRuntime.Utility.createInvalidArgumentException("caller");(await ee).removeEntry(Yd[ae])},async(ae,he)=>{if(OfficeExtension.WacRuntime.Utility.isNullOrUndefined(Yd[ae]))throw OfficeExtension.WacRuntime.Utility.createInvalidArgumentException("caller");
he.businessBarType=Bc[he.messageType];(await ee).Ukc(Yd[ae],he)})}break;case "Microsoft.Office.ShowSimpleDialog":vb=ma.Rp(this.Um).Bj;if(Af.a(vb))return new sb;break;case "Microsoft.Office.DispatchApiService":if(vb=this.Fu.Cf)if(lc=vb.getOsfControl(this.Um),null===lc||void 0===lc?0:lc.isFirstParty())return this.ibb||(this.ibb=new Vc),this.ibb.createInstance(D,this.n0e,this.Um,vb,t.AFrameworkApplication.ea,this);break;case "Microsoft.Office.DevicePermissionService":vb=this.Fu.jY(this.Um);if(M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IsDevicePermissionServiceEnabled",
!1))return D=ma.Cf.getOsfControl(vb),new Aa(D,!1);break;default:if(vb=this.B4g(D,vb))return vb}B.ULS.sendTraceTag(537163155,0,10,`Typename: ${D} is an invalid parameter for the RichApiHost.CreateInstance method.`);throw OfficeExtension.WacRuntime.Utility.createRichApiException(Z.a.generalException,Z.a.generalException);}lookupApi(D){if(this.Thc)return this.Thc.get(D)}B4g(D,ma){this.ibb||(this.ibb=new Vc);const vb=this.Fu.Cf;let lc=this.Um;this.Fu.gE&&(lc=this.Fu.jY(this.Um));return this.ibb.createInstance(D,
this.n0e,lc,vb,t.AFrameworkApplication.ea,this,vb.getOsfControl(lc),ma)}}Object(l.a)(Fb,"RichApiHost",null,[]);var Ta=a(447),Eb=a(33),oc=a(145),Lc=a(83),Jd=a(42),Ab=a(117),Uc=a(333),Od=a(99),le=a(45),ge=a(283),ze=a(59),Le=a(8),nf=a(76),cf=a(1077),Te=a(1489);class Wf{constructor(){this.dAb=this.Wzb=this.u5=null;this.Y$=0}get displayName(){return this.u5}set displayName(D){this.u5=D}get email(){return this.Wzb}set email(D){this.Wzb=D}get federationProvider(){return this.dAb}set federationProvider(D){this.dAb=
D}get identityType(){return this.Y$}set identityType(D){this.Y$=D}getTypeName(){return"Microsoft.Authentication.OfficeIdentityInfo"}invokePropertyGet(D){switch(D){case 4:return this.displayName;case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D,
ma){switch(D){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertySetAsync(D,
ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,ma){D=this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}static W7h(D){const ma=new Wf;ma.displayName=D.displayName;ma.email=D.email;if(ta.a.isChangeGateEnabled("OfficeVSO:8577366_FixIdentityType"))switch(D.authority){case "MicrosoftAccount":ma.identityType=
1;break;default:ma.identityType=0}else switch(D.authority){case Te.a.Wug:ma.identityType=1;break;default:ma.identityType=0}ma.federationProvider="";return ma}}Object(l.a)(Wf,"OfficeIdentityInfo",null,[]);class Hf{static get buf(){return Hf.smh}static Bib(D){return D in Hf.buf?Hf.buf[D].toString():D}}Hf.smh={["GeneralException"]:Z.a.generalException,["AccessDenied"]:Z.a.accessDenied,["ApiNotAvailable"]:Z.a.xmc,["UserNotSignedIn"]:Z.a.S$b,["UserAborted"]:Z.a.Zwb,["UnsupportedUserIdentity"]:Z.a.kbl,
["InvalidResourceUrl"]:Z.a.Bkb,["InvalidGrant"]:Z.a.Akb,["AddinIsAlreadyRequestingToken"]:Z.a.YGh,["ResourceNotAllowed"]:Z.a.yzk,["ClientError"]:Z.a.bqc,["ServerError"]:Z.a.serverError};Hf.map=null;Object(l.a)(Hf,"SingleSignOnErrorCodeMap",null,[]);class ib{constructor(D,ma){this.rOa=D;this.Y$=ma}get accessToken(){return this.rOa}set accessToken(D){this.rOa=D}get tokenIdenityType(){return this.Y$}set tokenIdenityType(D){this.Y$=D}getTypeName(){return"Microsoft.Authentication.SingleSignOnToken"}invokePropertyGet(D){switch(D){case 2:return this.accessToken;
case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D,ma){switch(D){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);
}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,ma){D=this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}}Object(l.a)(ib,"SingleSignOnToken",null,[]);class xc{constructor(D,ma){this.vAa=ma;this.Um=D}get roamingSettings(){return null}getAccessToken(D){const ma=this.vAa.getOsfControl(this.Um),
vb=ma.getManifest(),lc=vb.getMarketplaceID();this.UN(D,lc);return OfficeExtension.WacRuntime.Utility.createPromise((Nc,wd)=>{ma.isFirstParty()&&this.vAa._enableFirstPartySSO?this.GUd(vb,D)?sa.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(D,lc).then(Yd=>{Nc(Yd)},Yd=>{wd(Yd)}):wd(Z.a.accessDenied):wd(Z.a.xmc)}).then(Nc=>{let wd;switch(Nc.authority){case Te.a.Wug:wd=1;break;default:wd=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new ib(Nc.accessToken,
wd))},Nc=>{this.logErrorResponse(D,lc,Nc);return Nc?OfficeExtension.WacRuntime.Utility.createPromise((wd,Yd)=>{Yd(OfficeExtension.WacRuntime.Utility.createRichApiException(Nc,Hf.Bib(Nc)))}):OfficeExtension.WacRuntime.Utility.createPromise((wd,Yd)=>{Yd(OfficeExtension.WacRuntime.Utility.createRichApiException(Z.a.generalException,Hf.Bib(Z.a.generalException)))})})}getAuthContext(){return null}getPrimaryIdentityInfo(){const D=this.vAa.getOsfControl(this.Um);D.getManifest();const ma=D.getManifest().getMarketplaceID();
return OfficeExtension.WacRuntime.Utility.createPromise((vb,lc)=>{sa.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(ma).then(Nc=>{vb(Nc)},Nc=>{lc(Nc.toString())})}).then(vb=>{vb=Wf.W7h(vb);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(vb)},vb=>vb?OfficeExtension.WacRuntime.Utility.createPromise((lc,Nc)=>{Nc(OfficeExtension.WacRuntime.Utility.createRichApiException(vb,Hf.Bib(vb)))}):OfficeExtension.WacRuntime.Utility.createPromise((lc,Nc)=>
{Nc(OfficeExtension.WacRuntime.Utility.createRichApiException(Z.a.generalException,Hf.Bib(Z.a.generalException)))}))}getTypeName(){return"Microsoft.Authentication.AuthenticationService"}invokePropertyGet(D){switch(D){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokePropertyGetAsync(D){D=this.invokePropertyGet(D);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}invokePropertySet(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);
}invokePropertySetAsync(D,ma){this.invokePropertySet(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(D){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(D);}invokeMethodAsync(D,ma){switch(D){case 1:return this.wJd(ma);case 3:return this.aKi();case 2:return this.GNd()}D=this.invokeMethod(D,ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}wJd(D){D=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(D,0,Hd);return this.getAccessToken(D)}aKi(){return this.getAuthContext()}GNd(){return this.getPrimaryIdentityInfo()}GUd(D,
ma){let vb=!1;const lc=D.getWebApplicationAuthorizations();D=null;for(const Nc of lc)if(Nc.getResource().toLowerCase()===ma.resource.toLowerCase()){D=Nc;vb=!0;break}if(!vb)return!1;ma=ma.scope.split(" ,+");for(const Nc of ma)if(Nc&&Nc.length){ma=!1;for(const wd of D.getScopes())Nc.toLowerCase()===wd.toLowerCase()&&(ma=!0);if(!ma)return!1}return!0}UN(D,ma){D=this.yig(D.resource);B.ULS.sendTraceTag(538572831,369,50,"{0}",{["manifestId"]:ma,["resource"]:D})}logErrorResponse(D,ma,vb){D=this.yig(D.resource);
B.ULS.sendTraceTag(538572830,369,10,"{0}",{["manifestId"]:ma,["resource"]:D,["error"]:vb})}yig(D){return D.replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(l.a)(xc,"AuthenticationService",null,[]);class Kc{create(D,ma){return new xc(D,ma)}}Object(l.a)(Kc,"AuthenticationServiceFactory",null,[]);Object(L.b)(K.DdaMethodHandlerService,{we:"singleton"})(async D=>{var ma;const vb=await L.a.resolve(K.EwaControlService,D),lc=await L.a.resolve(K.DdaFacadeService,D);if(M.EwaSettings.PQ()&&
!lc)return null;const Nc=await L.a.resolve(K.HtmlSanitizationHelperService,D),wd=await L.a.resolve(K.ExternalLinksManagerService,D),Yd=await L.a.resolve(K.NewDocumentFromStreamOperationService,D);await cf.a(vb.Aa,null!==(ma=D.xa)&&void 0!==ma?ma:0);await L.a.resolve(K.HostMessengerService,D);sa.a.instance.register(Kc,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").Lc().Qc(()=>new Kc);return new ra(vb,lc,Yd,Nc,wd)});class ra{constructor(D,ma,vb,lc,Nc){this.Mc=this.rangePicker=
this.externalLinksManager=null;this.$=D;this.Gc=ma;this.Mc=lc;this.qf=new Da(D.fa);this.UE=new Ed(D,this.qf);this.ahg=vb;this.Lwc=new Map;this.externalLinksManager=Nc}get GX(){return this.qf}dispose(){this.$=this.Lwc=null}gd(){return!1}td(){return!1}executeCommand(D,ma,vb){D=ma.command;switch(D){case 451041795:this.qf.si(vb[$b.a.Bf],vb[$b.a.Qba]);break;case 974713501:this.Q8i(vb[$b.a.Bf],vb[$b.a.Qba]);break;case 1237877382:this.qf.Bz(vb[$b.a.Qba]);break;default:return G.a(D)}return bd.Task.Va(!0)}Rc(D,
ma,vb){if(D=!!vb)switch(ma.command){case 974713501:case 1237877382:case 451041795:break;default:D=!1}return D}Q8i(D,ma){var vb;const lc=D.DdaMethod;"undefined"===typeof lc.DispatchId?this.qf.si(eb.a.internalError,ma):ra.Roj(D)||this.$.$d&1?(lc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new Fa(this.$,this,D,ma,this.Mc)).start(this.Gc,D.DdaMethod.ControlId):lc.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.k0i(D,ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?
this.KMk(D,ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?this.addBinding(D,this.LKd(D.DdaMethod.ControlId),0,ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.vKi(D,ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.iIk(D,ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.uKi(D,ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.Fpk(D,ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?
this.kJi(D,ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?this.t2d(D,ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(D,ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(D.DdaAddRowsColumns.IsRow=!0,this.i3e(D,ma)):lc.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(D.DdaAddRowsColumns.IsRow=!1,this.i3e(D,ma)):lc.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?this.Fei(D,ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?
this.DYh(D,ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?(D.DdaSetBindingFormats.IsSetFormats=!0,this.XPg(D,ma)):lc.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(D.DdaSetBindingFormats.IsSetFormats=!1,this.XPg(D,ma)):lc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(D,D.DdaBindingsMethod.ItemName,D.DdaBindingsMethod.FailOnCollision?2:1,ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.EQi(ma):lc.DispatchId===
OSF.DDA.MethodDispId.dispidNavigateToMethod?this.F6d(D,ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(D,ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.nPi(D,ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.oPi(D,ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.Hpk(D,ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(D.DdaMethod.ControlId,
D),this.qf.Bz(ma)):lc.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?this.SLj(D,ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?this.PLj(D,ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(D,ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?this.getAuthContext(D,ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidGetNestedAppAuthContextMethod?this.PMd(D,ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidExecuteFeature?this.executeFeature(D,
ma):lc.DispatchId===OSF.DDA.MethodDispId.dispidQueryFeature?this.queryFeature(D,ma):this.qf.si(eb.a.hbe,ma),M.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&lc.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(ma=D.DdaMethod.ControlId,this.Gc.gE&&(ma=this.Gc.jY(D.DdaMethod.ControlId)),D=this.Gc.JT(ma),ma="",D&&(ma=Oa.DdaFacade.getSolutionId(D,this.$),ma=Telemetry.PrivacyRules.GetPrivacyCompliantId(ma,D.OwnerAddinStoreType||D.PrimaryMarketplace.MarketplaceType,
null===(vb=D.AssetMarketplace)||void 0===vb?void 0:vb.SolutionId,null,null,D.PrimaryMarketplace.MarketplaceRef)),B.ULS.sendTraceTag(537163224,344,50,`DDA method Id: ${lc.DispatchId}, AppID: ${ma}`))):this.qf.si(eb.a.yqf,ma)}vKi(D,ma){D.DdaGetBindingData.CoerceType=ra.lqc(D.DdaGetBindingData.CoerceType);D.DdaGetBindingData.FilterType=ra.oBf(D.DdaGetBindingData.FilterType);D.DdaGetBindingData.ValueFormat=ra.B$g(D.DdaGetBindingData.ValueFormat);if(this.QIc(D.DdaGetBindingData.CoerceType,ma)){if(D.DdaGetBindingData){var vb=
D.DdaGetBindingData;0===vb.FilterType&&(vb.FilterType=2);vb.StartCol|=0;vb.StartRow|=0;vb.ColCount=void 0===vb.ColCount?-1:vb.ColCount;vb.RowCount=void 0===vb.RowCount?-1:vb.RowCount}vb=D.DdaMethod.ControlId;this.Gc.gE&&this.Gc.WV&&(vb=this.Gc.Gta(D.DdaMethod.ControlId));this.UE.ddaGetBindingData(vb,D.DdaGetBindingData.BindingId,D.DdaGetBindingData.CoerceType,D.DdaGetBindingData.ValueFormat,D.DdaGetBindingData.FilterType,D.DdaGetBindingData.StartRow,D.DdaGetBindingData.StartCol,D.DdaGetBindingData.RowCount,
D.DdaGetBindingData.ColCount,lc=>{if(ja.a(lc)||!lc.Result)this.qf.iN(lc,ma);else{const Nc=this.qf.VM();Nc.Data=ra.maf(lc.Result);ma(Nc)}},ma)}}iIk(D,ma){D.DdaSetBindingData.CoerceType=ra.lqc(D.DdaSetBindingData.CoerceType);if(this.QIc(D.DdaSetBindingData.CoerceType,ma)){var vb=ra.Tsd(D.DdaSetBindingData.CoerceType,D.DdaSetBindingData.Data);if(ra.PEc(vb))this.qf.si(eb.a.m2c,ma);else{1===vb.CoerceType&&(vb.CellFormat||(vb.CellFormat=D.DdaSetBindingData.CellFormat),vb.TableOptions||(vb.TableOptions=
D.DdaSetBindingData.TableOptions));D.DdaSetBindingData&&(D.DdaSetBindingData.StartCol|=0,D.DdaSetBindingData.StartRow|=0);var lc=D.DdaMethod.ControlId;this.Gc.gE&&this.Gc.WV&&(lc=this.Gc.Gta(D.DdaMethod.ControlId));this.UE.ddaSetBindingData(lc,D.DdaSetBindingData.BindingId,D.DdaSetBindingData.StartRow,D.DdaSetBindingData.StartCol,vb,Nc=>{ja.a(Nc)?this.qf.iN(Nc,ma):this.qf.Bz(ma)},ma)}}}k0i(D,ma){D.DdaGetBindingData.CoerceType=ra.lqc(D.DdaGetBindingData.CoerceType);D.DdaGetBindingData.ValueFormat=
ra.B$g(D.DdaGetBindingData.ValueFormat);D.DdaGetBindingData.FilterType=ra.oBf(D.DdaGetBindingData.FilterType);if(this.QIc(D.DdaGetBindingData.CoerceType,ma)){var vb=this.LKd(D.DdaMethod.ControlId);vb?this.UE.ddaGetSelectedData(D.DdaMethod.ControlId,D.DdaGetBindingData.CoerceType,D.DdaGetBindingData.ValueFormat,D.DdaGetBindingData.FilterType,vb,lc=>{if(ja.a(lc))this.qf.iN(lc,ma);else{const Nc=this.qf.VM();Nc.Data=ra.maf(lc.Result);ma(Nc)}},ma):this.qf.si(eb.a.zNf,ma)}}nPi(D,ma){const vb=D[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],
lc=D[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],Nc=D.DdaMethod.ControlId,wd=ed.getInstance(this.$);if(0>=lc)B.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),this.qf.si(eb.a.Rkj,ma);else if(lc>ed.kKj)B.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),this.qf.si(eb.a.GHf,ma);else{var Yd=null;switch(vb){case 1:Yd="Compressed";break;case 0:Yd="Text";break;case 2:Yd="Pdf";break;default:B.ULS.sendTraceTag(537163219,
344,15,`Requested file type ${vb} is not supported.`);this.qf.si(eb.a.bBf,ma);return}if("Text"===Yd)B.ULS.sendTraceTag(537163218,344,15,`Requested file type ${Yd} is not supported.`),this.qf.si(eb.a.bBf,ma);else{M.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?(D=new Sys.StringBuilder,D.append(Sb.a(this.$,Yd)),"Pdf"===Yd&&fc.a.ol(D,Va.a.aBg,"WholeWorkbook"),D=D.toString()):D=Sb.a(this.$,Yd);var ee=null,ae=new XMLHttpRequest;ae.onreadystatechange=()=>{if(4===
ae.readyState)if(200===ae.status){var he=ae.response;if(he){ee=new Uint8Array(he);he=this.qf.VM();var De=ee.length,Se=ed.JPj(),qf={},kg=0;for(let $f=0;$f<De;$f+=lc){const Cg=[],sg=$f+lc<De?$f+lc:De;for(let ng=0,eh=$f;eh<sg;ng++,eh++)Cg[ng]=ee[eh];qf[(kg++).toString()]=Cg}qf=new de(Se,De,lc,qf);qf=wd.ozh(Nc,qf);qf!==eb.a.success?this.qf.si(qf,ma):(he[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=Se,he[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=De,B.ULS.sendTraceTag(537163216,
344,50,`GetFileAsync get file successfully for file type ${Yd}, the file size is ${De}`),ma(he))}else B.ULS.sendTraceTag(537163217,344,15,`Request is successful, but respone have no data for file type ${Yd}.`),this.qf.si(eb.a.internalError,ma)}else 500===ae.status?this.qf.si(eb.a.XDf(parseInt(ae.statusText,10)),ma):(B.ULS.sendTraceTag(537163215,344,15,`Request failed to obtain the file for type ${Yd}.`),this.qf.si(eb.a.mPj,ma))};ae.open("GET",D,!0);ae.responseType="arraybuffer";ae.setRequestHeader("If-Modified-Since",
"0");ae.send(null)}}}oPi(D,ma){var vb=D[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],lc=D[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];D=D.DdaMethod.ControlId;(vb=ed.getInstance(this.$).qPi(D,vb))?(vb=vb.PYk,0>lc||lc>=Object.keys(vb).length?this.qf.si(eb.a.Wej,ma):(lc=vb[lc.toString()],vb=this.qf.VM(),vb[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=lc,vb[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=lc.length,ma(vb))):this.qf.si(eb.a.internalError,
ma)}Hpk(D,ma){var vb=D[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];D=D.DdaMethod.ControlId;vb=ed.getInstance(this.$).Gpk(D,vb);vb===eb.a.success?this.qf.Bz(ma):this.qf.si(vb,ma)}KMk(D,ma){D.DdaSetBindingData.CoerceType=ra.lqc(D.DdaSetBindingData.CoerceType);if(this.QIc(D.DdaSetBindingData.CoerceType,ma)){var vb=this.LKd(D.DdaMethod.ControlId);if(vb){var lc=ra.Tsd(D.DdaSetBindingData.CoerceType,D.DdaSetBindingData.Data),Nc=w.f(this.$).ha;1===lc.CoerceType&&(!lc.Data&&Nc.oa.I2&&(lc.Headers||
(lc.Headers=[]),lc.Headers.length||lc.Headers.push([]),lc.Headers[0].length||lc.Headers[0].push("")),ra.PEc(lc)||(lc.CellFormat||(lc.CellFormat=D.DdaSetBindingData.CellFormat),lc.TableOptions||(lc.TableOptions=D.DdaSetBindingData.TableOptions)));if(ra.PEc(lc))this.qf.si(eb.a.m2c,ma);else{var wd=Nc.oa.Ed.clone(),Yd=Nc.oa.activeCell.clone();this.UE.ddaSetSelectedData(D.DdaMethod.ControlId,vb,lc,ee=>{var ae;if(ja.a(ee))this.qf.iN(ee,ma);else{ee=wd.clone();const he=lc.Headers?lc.Headers[0].length:lc.Data[0].length;
1!==lc.CoerceType||lc.Data?1===lc.CoerceType&&(null===(ae=lc.TableOptions)||void 0===ae?0:ae.length)&&0==lc.TableOptions[0]?(ee.top+=1,ee.bottom=ee.top+lc.Data.length-1):ee.bottom=ee.top+lc.Data.length-(1===lc.CoerceType?0:1):ee.bottom=ee.top+1;ee.right=ee.left+he-1;ae=ee.contains(Yd)?Yd:ee.topLeft;Nc.updateSelection(ee,ae,0);this.qf.Bz(ma)}},ma)}}else this.qf.si(eb.a.Qcf,ma)}}addBinding(D,ma,vb,lc){if(ma){var Nc=D.DdaMethod.ControlId;this.Gc.gE&&this.Gc.WV&&(Nc=this.Gc.Gta(D.DdaMethod.ControlId));
this.UE.ddaAddBinding(Nc,D.DdaBindingsMethod.BindingId,D.DdaBindingsMethod.BindingType,ma,vb,wd=>{if(ja.a(wd))this.qf.iN(wd,lc);else{const Yd=this.qf.VM();Yd.Bindings=Array(1);Yd.Bindings[0]=this.Gc.Jnc(wd.Result);lc(Yd)}},lc)}else this.qf.si(eb.a.lFk,lc)}uKi(D,ma){let vb=D.DdaMethod.ControlId;this.Gc.gE&&this.Gc.WV&&(vb=this.Gc.Gta(D.DdaMethod.ControlId));this.UE.ddaGetBinding(vb,D.DdaBindingsMethod.BindingId,lc=>{if(ja.a(lc)||!lc.Result)this.qf.iN(lc,ma);else{const Nc=this.qf.VM();Nc.Bindings=Array(1);
Nc.Bindings[0]=this.Gc.Jnc(lc.Result);ma(Nc)}},ma)}EQi(D){const ma=this.qf.VM(),vb={};vb[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;ma[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=vb;D(ma)}Fpk(D,ma){let vb=D.DdaMethod.ControlId;this.Gc.gE&&this.Gc.WV&&(vb=this.Gc.Gta(D.DdaMethod.ControlId));this.UE.ddaReleaseBinding(vb,D.DdaBindingsMethod.BindingId,lc=>{ja.a(lc)?this.qf.iN(lc,ma):this.qf.Bz(ma)},ma)}kJi(D,ma){let vb=D.DdaMethod.ControlId;
this.Gc.gE&&this.Gc.WV&&(vb=this.Gc.Gta(D.DdaMethod.ControlId));this.UE.ddaGetAllBindings(vb,lc=>{if(ja.a(lc))this.qf.iN(lc,ma);else{const Nc=this.qf.VM();if(lc.Result){lc=lc.Result;Nc.Bindings=Array(lc.length);for(let wd=0;wd<lc.length;wd++)Nc.Bindings[wd]=this.Gc.Jnc(lc[wd])}else Nc.Bindings=null;ma(Nc)}},ma)}t2d(D,ma){this.UE.ddaLoadSettings(D.DdaMethod.ControlId,vb=>{if(ja.a(vb))this.qf.iN(vb,ma);else{const lc=this.qf.VM();lc.Properties=vb.Result;ma(lc)}},ma)}saveSettings(D,ma){const vb={Settings:[]};
for(let lc=0;lc<D.DdaSettingsMethod.Properties.length;lc++){const Nc={};Nc.Name=D.DdaSettingsMethod.Properties[lc][0];Nc.Value=D.DdaSettingsMethod.Properties[lc][1];vb.Settings[lc]=Nc}this.UE.ddaSaveSettings(D.DdaMethod.ControlId,vb,D.DdaSettingsMethod.OverwriteIfStale,lc=>{ja.a(lc)?this.qf.iN(lc,ma):this.qf.Bz(ma)},ma)}i3e(D,ma){const vb=ra.Tsd(1,D.DdaAddRowsColumns.Data);ra.PEc(vb)?this.qf.si(eb.a.m2c,ma):this.UE.ddaAddRowsColumns(D.DdaMethod.ControlId,D.DdaAddRowsColumns.BindingId,D.DdaAddRowsColumns.IsRow,
vb,lc=>{ja.a(lc)?this.qf.iN(lc,ma):this.qf.Bz(ma)},ma)}Fei(D,ma){this.UE.ddaDeleteAllDataValues(D.DdaMethod.ControlId,D.DdaBindingsMethod.BindingId,vb=>{ja.a(vb)?this.qf.iN(vb,ma):this.qf.Bz(ma)},ma)}DYh(D,ma){this.UE.ddaClearBindingFormats(D.DdaMethod.ControlId,D.DdaClearBindingFormats.BindingId,vb=>{ja.a(vb)?this.qf.iN(vb,ma):this.qf.Bz(ma)},ma)}XPg(D,ma){const vb={},lc=D.DdaSetBindingFormats.IsSetFormats;lc?vb.CellFormat=D.DdaSetBindingFormats.CellFormat:vb.TableOptions=D.DdaSetBindingFormats.TableOptions;
this.UE.ddaSetBindingFormats(D.DdaMethod.ControlId,D.DdaSetBindingFormats.BindingId,vb,lc,Nc=>{ja.a(Nc)?this.qf.iN(Nc,ma):this.qf.Bz(ma)},ma)}executeRichApiRequest(D,ma){var vb;const lc=D.ArrayData,Nc={},wd=w.f(this.$).ha;if(lc){if("WacPartition"===lc[0]){this.Uxi(D,ma);return}const Se=K.DdaFacadeService.Oa()?this.Gc:Object(C.a)(Oa.DdaFacade,kb.a(this.$));var Yd=D.DdaMethod.ControlId;this.Gc.gE&&this.Gc.WV&&(Yd=this.Gc.jY(D.DdaMethod.ControlId));"SetOsfControlContainerReadyForCustomFunctions"===lc[0]&&
(Yd=Se.Rp(Yd))&&(Yd.oHc=!0,Yd.fAg());Nc.HttpMethod=lc[1];Nc.PathAndQuery=lc[2];Nc.RequestHeaders=ra.vJf(lc[3]);Nc.RequestBody=lc[4];Nc.AppPermission=lc[5];Yd=lc[6];Nc.RequestFlags=Yd;var ee=0;if(Rb.i(this.$.la))switch(wd.gf){case 1:ee=2;break;case 2:ee=3;break;case 64:ee=16;break;case 128:ee=4;break;default:ee=1}var ae=null;wd.ob.FF&&(ae=wd.ob.FF.ll);Nc.SheetMultiRange=fb.u(wd.oa.selectedRanges,this.$);Nc.ActiveCell=fb.y(wd.oa.activeCell,this.$);Nc.ActiveFloatingObjectId=ae;Nc.SelectionState=ee;ee=
null;this.Gc.gE?this.Gc.WV?(ae=this.Gc.Gta(D.DdaMethod.ControlId),ee=this.Gc.jY(D.DdaMethod.ControlId),ee=this.Gc.JT(ee),Nc.InstanceId=ae):(ee=this.Gc.JT(D.DdaMethod.ControlId),Nc.InstanceId=ee?ee.InstanceId:""):(ee=this.Gc.JT(D.DdaMethod.ControlId),Nc.InstanceId=ee?ee.InstanceId:"");if(ee&&ee.PrimaryMarketplace){let qf;if(ee.PrimaryMarketplace.MarketplaceType!==OSF.StoreType.InMemory)qf=ee.PrimaryMarketplace.SolutionId,ae=ee.PrimaryMarketplace.MarketplaceType;else{if(!ee.OwnerAddinSolutionId){B.ULS.sendTraceTag(512325018,
344,10,"executeRichApiRequest: No OwnerAddinSolutionId for AppCommand");this.qf.si(eb.a.kTb,ma);return}if(!ee.OwnerAddinStoreType){B.ULS.sendTraceTag(512325017,344,10,"executeRichApiRequest: No OwnerAddinStoreType for AppCommand");this.qf.si(eb.a.kTb,ma);return}qf=ee.OwnerAddinSolutionId;ae=ee.OwnerAddinStoreType}const kg=Telemetry.PrivacyRules.GetPrivacyCompliantId(qf,ae,null===(vb=ee.AssetMarketplace)||void 0===vb?void 0:vb.SolutionId,null,null,ee.PrimaryMarketplace.MarketplaceRef);Nc.CompliantSolutionId=
kg;Nc.SolutionId=qf;Nc.MarketplaceType=ae;Nc.SolutionVersion=ee.PrimaryMarketplace.SolutionVersion;Nc.StoreLocation=ee.PrimaryMarketplace.MarketplaceRef}else Nc.SolutionId=Nc.MarketplaceType="",Nc.CompliantSolutionId="";Nc.IsEventsEnabled=void 0===Se||null===Se||Se.xi.Zmc(Nc.InstanceId);Nc.RequestGuid=mb.a.create().toString();vb=Nc.RequestBody.length;if(vb>this.$.ta.ExcelRichApiMaxAllowedRequestPayloadSize){this.qf.si(eb.a.Oxk,ma);B.ULS.sendTraceTag(537163213,0,50,`Request payload size:${vb} exceeded the limit`);
return}M.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&Yd&4096&&(vb=new Gb(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(vb,Ca,lc),Nc.RequestBody=lc[4])}const he=ra.aNf(Nc.RequestHeaders);ra.fce++;const De=Eb.a.zb.Jc;M.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&Nc&&Nc.RequestBody&&B.ULS.sendTraceTag(537163212,0,50,`Richapi json request body size is ${Nc.RequestBody.length}`);this.UE.executeRichApiRequest(Nc,Se=>{var qf;
this.hPg(De,!0,Se.ServerCorrelationId);let kg=null,$f=null;var Cg=Se.ServerCorrelationId;if(null===(qf=null===Se||void 0===Se?void 0:Se.Errors)||void 0===qf?0:qf[0])kg=Se.Errors[0].MessageIdName,$f=Se.Errors[0].Description,nf.a(this.$).Kd.oF(Se.Errors[0].MessageId);if(ja.a(Se)||!Se.Result)this.Lnb(Cg,he,"Server error",kg,$f),this.qf.iN(Se,ma);else{let ng=null;if(M.EwaSettings.Ra(233))if((qf=Se.Result)&&qf.length){for(let Ph=0;Ph<qf.length;Ph++)if(qf[Ph].RequestGuid===Nc.RequestGuid){ng=qf[Ph];break}ng||
this.qf.iN(Se,ma)}else ng=Se.Result;else ng=Se.Result;if(!kg&&ng&&ng.ResponseBody&&ng.ResponseBody[0])if(Se=ng.ResponseBody[0],Se.startsWith('{"Error":')){1<ng.ResponseBody.length&&(Se=Se.substring(0,Se.indexOf("}")+1),Se+="}");try{var sg=cc.a.Xj(Se);sg.Error&&this.Lnb(Cg,he,"Pipeline error",sg.Error.Code,sg.Error.Message)}catch(Ph){this.Lnb(Cg,he,"Json deserialize error",null,"Error info cannot be deserialized.")}}else this.Lnb(Cg,he);else this.Lnb(Cg,he,"Server error",kg,$f);const eh=(Cg=ng.SheetMultiRange)?
Cg.SheetName:null;sg=ng.ActiveFloatingObjectId;const yh=ng.SelectionState;Se=5===yh&&!!Cg||6===yh||7===yh||17===yh||8===yh;if(this.$.Mb.DC&&Se)this.qf.si(eb.a.L4c,ma),B.ULS.sendTraceTag(537163211,0,50,`${yh.toString()} is not allowed`);else if(5===yh&&Cg){if(this.$.qa&&eh)if(this.$.qa.Bl(eh))this.Rmd(eh);else{let Ph=null;Ph=()=>{this.$.qa.Bl(eh)&&(B.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),this.Rmd(eh),this.$.qa.cUc(Ph))};this.$.qa.tlc(Ph);if(M.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){let Yj=
null;Yj=()=>{this.$.qa.Bl(eh)&&(this.Rmd(eh),this.$.qa.zxa(Yj))};this.$.qa.sqa(Yj)}}}else if(6===yh||7===yh||17===yh||8===yh||9===yh){if(Cg){const Ph=fb.i(Cg.Ranges);if(eh&&fb.nb(Ph,!0))if(M.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&!this.$.qa.Bl(eh)){let Yj=null;Yj=()=>{this.N8g(wd,Ph,eh,yh);this.$.qa.zxa(Yj)};this.$.qa.sqa(Yj)}else this.N8g(wd,Ph,eh,yh)}if(7===yh||17===yh||8===yh)sg="{"+xb.e(sg)+"}",Od.a(this.$).YEk(sg);9===yh&&(this.$.ta.ApiCallToSetPageLayout=
!0)}ng.PostProcessActions?(Cg=cc.a.Xj(ng.PostProcessActions),this.rdk(Cg).then(()=>{this.ytb(ng,ma);this.dHd(D.DdaMethod.ControlId,Nc);return Promise.resolve(null)},Ph=>{this.ytb(ng,ma,Ph);return Promise.reject(Ph)})):this.ytb(ng,ma)}},Se=>{this.hPg(De,!1,null);this.Lnb(null,he,"Web service error");ma(Se)})}dHd(D,ma){const vb=K.DdaFacadeService.Oa()?this.Gc:Object(C.a)(Oa.DdaFacade,kb.a(this.$));(null===vb||void 0===vb?0:vb.Kle)&&vb.Rp(D)&&ra.oRk(ma.RequestHeaders)&&(B.ULS.sendTraceTag(537163209,
0,50,`ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: ${D}; SolutionId: ${ma.SolutionId}.`),vb.Kle.Ini(D))}Uxi(D,ma){var vb=D.DdaMethod.ControlId;this.Gc.gE&&this.Gc.WV&&(vb=this.Gc.jY(D.DdaMethod.ControlId));const lc=this.Gc.JT(vb),Nc=Oa.DdaFacade.getSolutionId(lc,this.$);var wd=null;wd=Oa.DdaFacade.cGa(lc,this.$);wd=new Tc(wd,this.$);this.Gc.gE&&this.Gc.WV&&(vb=this.Gc.Gta(D.DdaMethod.ControlId));wd=new Fb(Nc,vb,this.Gc,this.$,wd);const Yd={ResponseHeaders:[]};
Yd.ResponseBody=Array(1);vb=ra.vJf(D.ArrayData[3]);const ee=ra.aNf(vb);vb=new pa(this.$.ta.CreateWorkbookMaxAllowedBase64Size,this.ahg);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(wd,ia,vb,D.ArrayData).then(ae=>{if(!ae)return this.m3d(!1,"The rich api executor call failed",ee),B.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),Yd.ResponseStatusCode=500,this.ytb(Yd,ma),null;this.m3d(!0,"The rich api executor call succeeded",ee);Yd.ResponseStatusCode=ae[0];Yd.ResponseBody[0]=
ae[2];this.ytb(Yd,ma);return null},ae=>{Yd.ResponseStatusCode=400;Yd.ResponseBody[0]=ae.toString();this.m3d(!1,"The rich api executor call failed",ee);B.ULS.sendTraceTag(537163207,0,10,`A Excel Rich API batch execution was failed, AppId:${Nc}`);this.ytb(Yd,ma);return null})}hPg(D,ma,vb){ra.fce--;D=oc.a(Eb.a.zb,D);B.ULS.sendTraceTag(36763356,0,50,`Rich Api perf log -- total milliseconds used:${D}, requests pending:${ra.fce}, request result:${ma?"success":"false"}, server correlationid: ${vb}.`)}ytb(D,
ma,vb){vb=void 0===vb?null:vb;const lc=Array(3);lc[0]=D.ResponseStatusCode;lc[1]=ra.T1i(D.ResponseHeaders);const Nc=[];var wd=!1;if(vb&&D.ResponseBody){const Yd=cc.a.Xj(D.ResponseBody.join(""));Yd.Error||(wd={},wd.Error=vb,wd.TraceIds=Yd.TraceIds,wd.ProcessedResults={},wd.ProcessedResults.Results=Yd.Results,Nc[0]=cc.a.Nc(wd),wd=!0)}lc[2]=wd?Nc:D.ResponseBody;D=this.qf.VM();D.Data=lc;ma(D)}F6d(D,ma){(new Qa(this.$,this.qf,this.UE)).F6d(D,ma)}SLj(D,ma){B.ULS.sendTraceTag(537163206,0,50,"MessageParent API called!");
const vb=D[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],lc=D[Pa.a.spd],Nc=D[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];D=this.$.ra.Tb(232).Qfb.TLj(D.DdaMethod.ControlId,vb,lc,Nc);D===eb.a.success?this.qf.Bz(ma):(B.ULS.sendTraceTag(537163205,0,10,"MessageParent API Failed!"),this.qf.si(D,ma))}PLj(D,ma){B.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");const vb=D[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],lc=D[Pa.a.spd],Nc=D[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin],
wd=this.$.ra.Tb(232);let Yd=D.DdaMethod.ControlId;this.Gc.gE&&(Yd=this.Gc.jY(D.DdaMethod.ControlId));wd.Qfb.gGk(Yd,vb,lc,Nc);this.qf.Bz(ma)}getAccessToken(D,ma){B.ULS.sendTraceTag(537163203,0,50,"GetAccessToken API called!");let vb=D.DdaMethod.ControlId;this.Gc.gE&&(vb=this.Gc.jY(D.DdaMethod.ControlId));const lc=(Nc,wd)=>{var Yd;if(Nc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)Nc=this.qf.VM(),Nc[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=wd.accessToken,ma(Nc);else{wd=
this.Gc.JT(vb);const ee=null!==wd.OwnerAddinStoreType?wd.OwnerAddinStoreType:wd.PrimaryMarketplace.MarketplaceType;B.ULS.sendTraceTag(537163202,0,10,`${({["errorCode"]:Nc.toString(),["appId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Oa.DdaFacade.getSolutionId(wd,this.$),ee,null===(Yd=wd.AssetMarketplace)||void 0===Yd?void 0:Yd.SolutionId,null,null,wd.PrimaryMarketplace.MarketplaceRef),["storeType"]:ee})}.`);this.qf.si(Nc,ma)}};K.HostMessengerService.Oa()?void L.a.resolve(K.HostMessengerService,
{xa:1}).then(Nc=>{const wd=this.Gc.Cf,Yd=da.getInstance();la.a.getInstance(wd,Nc,Yd).getAccessToken(vb,!0,D,lc)}):E.TaskExtensions.tb(kc.GetServiceTaskFactory.create(this.$.ra,137,this.$.Aa,1),Nc=>{const wd=this.Gc.Cf,Yd=da.getInstance();la.a.getInstance(wd,Nc.result,Yd).getAccessToken(vb,!0,D,lc)},this.$.Aa)}getAuthContext(D,ma){const vb=()=>{var lc=this.Gc.Cf,Nc=D.DdaMethod.ControlId;this.Gc.gE&&(Nc=this.Gc.jY(D.DdaMethod.ControlId));lc=lc.getOsfControl(Nc);if(lc.isFirstParty()){lc=lc.getManifest();
Nc=lc.getMarketplaceID();var wd=lc.getWebApplicationId(),Yd=lc.getWebApplicationMsaId();Object(Ha.a)(fa).getAuthContext(Nc).then(ee=>{const ae=this.qf.VM(),he={};he[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=wd;he[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Yd||wd;he[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=ee.upn;he[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=ee.userId;he[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=
ee.authority;he[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Ma.a.dKi(ee.authorityType);he[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=ee.isAnonymous;he[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=ee.tenantId;he[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=ee.supportsAuthToken;he.hostPageSupportsAuth=ee.hostPageSupportsAuth;he.authenticationApiEnabled=ee.authenticationApiEnabled;ae[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=
he;ma(ae)},ee=>{const ae=this.qf.VM(),he={},De=new Ma.a;he[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=wd;he[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Yd||wd;he[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=De.upn;he[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=De.userId;he[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=De.authority;he[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=De.authorityType;he[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=
De.isAnonymous;he[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=De.tenantId;he[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=ee;he[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=De.supportsAuthToken;he.hostPageSupportsAuth=De.hostPageSupportsAuth;he.authenticationApiEnabled=De.authenticationApiEnabled;ae[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=he;ae.Error=1;ma(ae)})}};K.HostMessengerService.Oa()?void L.a.resolve(K.HostMessengerService,
{xa:1}).then(()=>{vb()}):E.TaskExtensions.tb(kc.GetServiceTaskFactory.create(this.$.ra,137,this.$.Aa,1),()=>{vb()},this.$.Aa)}PMd(D,ma){let vb=D.DdaMethod.ControlId;this.Gc.gE&&(vb=this.Gc.jY(D.DdaMethod.ControlId));D=aa.PMd(this.Gc.Cf,vb);D.errorCode===eb.a.success?(D=Object.assign({},this.qf.VM(),D.context),ma(D)):this.qf.si(D.errorCode,ma)}executeFeature(D,ma){32===t.AFrameworkApplication.Kb.hf(D[0],2)?ma(this.qf.VM()):this.qf.si(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,ma)}queryFeature(D,
ma){D=[32===t.AFrameworkApplication.Kb.hf(D[0],1),!0];D=Object.assign({},this.qf.VM(),D);ma(D)}Boj(D){const ma=w.f(this.$).ha;return 16===ma.gf&&!!ma.ob.Wb&&!!ma.ob.Wb.floatingObject&&Wa.a.equals(ma.ob.Wb.floatingObject.id,D,!0)}LKd(D){const ma=w.f(this.$).ha;return ma.oa.vi?1===ma.gf||this.Boj(D)?ma.Xra:null:null}QIc(D,ma){return 1!==D&&2!==D&&3!==D?(this.qf.si(eb.a.igf,ma),!1):!0}m3d(D,ma,vb){const lc={};lc.a=this.$.ta.UserSessionId;lc.b=D;lc.c=ma;lc.d=null;lc.e=vb;ze.logData(37,lc)}Lnb(D,ma,vb,
lc,Nc){vb=void 0===vb?null:vb;lc=void 0===lc?null:lc;Nc=void 0===Nc?null:Nc;const wd={};D&&(wd.ServerCorrelationId=D);void 0!==ma&&null!==ma&&(wd.Source=ma);vb&&(wd.ErrorType=vb);lc&&(wd.MessageId=lc);Nc&&(wd.StatusDescription=Nc);M.EwaSettings.isChangeGateEnabled("OfficeVSO:6144055_EUIIDataInDbxheTag")&&lc&&"ExternalDataRefreshFailed"===lc&&(wd.StatusDescription="");B.ULS.sendTraceTag(50688452,0,50,cc.a.Nc(wd))}rdk(D){let ma=new Promise(vb=>{vb(null)});for(let vb=0;vb<D.length;vb++)ma=this.qdk(ma,
D[vb]);return ma}async qdk(D,ma){if(!ma)return B.ULS.sendTraceTag(537163201,0,10,"Null PostProcessAction."),D.then(()=>Promise.reject(ra.bib(se.generalException,Jc.a.instance.ia(1765),null)));switch(ma.actionType){case 1:case 2:D=D.then(()=>{const Nc=K.DdaFacadeService.Oa()?this.Gc:Object(C.a)(Oa.DdaFacade,kb.a(this.$));if(Nc.Rp(ma.controlId))switch(Nc.xi.UQf(ma),ma.messageType){case 14:case 100:Nc.Jle.tnc(ma);break;case 11:case 12:Nc.YAk.XGb(ma);break;case 51:case 52:Nc.WAk.XGb(ma);break;case 2101:case 2102:Nc.XAk.XGb(ma);
break;case 2E3:Nc.ZAk.tnc(ma);break;case 2201:this.$.bva&&Nc.Kle.VLh(ma);break;case 2203:Nc.$Ak.WLh(ma);break;case 2700:M.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&Nc.Ile.tnc(ma);break;case 65541:Nc.Hle.ULh(ma)}else B.ULS.sendTraceTag(537163171,0,10,`OsfControl with instanceId[${ma.controlId}] doesn't exist.`);return Promise.resolve(null)});break;case 3:D=D.then(()=>{this.u7i(ma);return Promise.resolve(null)});break;case 15:M.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&
(D=D.then(()=>{this.F9i(ma);return Promise.resolve(null)}));break;case 4:D=D.then(()=>{var Nc=w.f(this.$).ha.oa.activeCell;Nc.top!==ma.row+1&&Nc.left!==ma.column+1&&(Nc=fb.y(Mb.Range.Hc(ma.row+1,ma.column+1),this.$),w.f(this.$).lj(Nc,null,null,null,3,"DdaMethodHandler.ShowCard"));K.CardViewManagerService.Oa()?void L.a.resolve(K.CardViewManagerService,{xa:0}).then(wd=>{wd.J5a(ma.row+1,ma.column+1,1,!1,!1)}):na.a(this.$,243,242,0,wd=>{wd.J5a(ma.row+1,ma.column+1,1,!1,!1)});return Promise.resolve(null)});
break;case 7:D=D.then(()=>{(K.DdaFacadeService.Oa()?this.Gc:Object(C.a)(Oa.DdaFacade,kb.a(this.$))).xi.Osf(ma.controlId,ma.isEnableEvents);return Promise.resolve(null)});break;case 5:D=D.then(()=>this.Hbi(ma));break;case 6:D=D.then(()=>this.D8j(ma));break;case 8:D=D.then(()=>{M.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&(K.DdaFacadeService.Oa()?this.Gc:Object(C.a)(Oa.DdaFacade,kb.a(this.$))).CYh();const Nc=new ge.a(Le.a.dk,5,null);le.a(this.$).Dt(Nc);
return Promise.resolve(null)});break;case 9:D=D.then(()=>this.mIk(ma));break;case 10:D=D.then(()=>this.Ukl(ma));break;case 11:D=D.then(()=>this.Tkl());break;case 12:D=D.then(()=>this.Qkl());break;case 13:D=D.then(()=>this.Rkl(ma));break;case 14:D=D.then(()=>this.Skl(ma));break;case 16:D=D.then(()=>Promise.resolve(ma));break;case 17:D=D.then(()=>this.hEk(ma,Object(C.a)(Oa.DdaFacade,K.DdaFacadeService.Oa()?this.Gc:kb.a(this.$))));break;case 18:w.f(this.$).focus();break;case 19:this.AQf(ma.entryType,
!1,ma.options);break;case 20:this.AQf(ma.entryType,!0,ma.options);break;case 21:const vb=K.DdaFacadeService.Oa()?this.Gc:kb.a(this.$);D=D.then(()=>vb.Hle.X6i(ma));break;case 22:const lc=K.DdaFacadeService.Oa()?this.Gc:kb.a(this.$);D=D.then(()=>lc.Hle.Y6i(ma));break;case 23:(z.a.pUb(this.$)||z.a.CN())&&this.Gc.ELg.v$i(ma.worksheetId,ma.anchorCell,ma.values,ma.options);break;case 24:(z.a.pUb(this.$)||z.a.CN())&&this.Gc.ELg.j8i(ma.worksheetId);break;default:D=D.then(()=>Promise.reject(ra.bib(se.bJh,
Jc.a.instance.ia(1766),null)))}return D}F9i(D){var ma=(K.DdaFacadeService.Oa()?this.Gc:Object(C.a)(Oa.DdaFacade,kb.a(this.$))).Rp(D.controlId);if(ma&&!(0===D.operationType^!ma.Cma)){w.f(this.$).wSb=!0;switch(D.operationType){case 0:var vb=new Uc.a(document.createElement("input"));vb.text=D.range;ma.Iij(w.f(this.$).$h.bai(vb,new Ta.a(this.$)));ma.Cma.startEdit(!0);break;case 1:ma.wGg();this.rangePicker=null;break;case 2:ma.Cma.c9g(D.range);break;case 3:ma.Cma.c9g(D.startingRange);ma=D.expandSelection;
vb=D.getNextDataRegionCell;let lc=0;switch(D.keyboardDirectionValue){case 2:lc=38;D=ma&&vb?105288353:ma?-31900117:vb?542791952:137938150;break;case 3:lc=40;D=ma&&vb?-1297307319:ma?-1603798598:vb?1713663844:-798660877;break;case 0:lc=37;D=ma&&vb?-403586027:ma?2039316657:vb?-2012742350:-1470715894;break;case 1:lc=39;D=ma&&vb?784916030:ma?589730764:vb?1324884057:-1231471547;break;default:D=1461300262}ma=this.Rrc("keydown",lc,ma,vb);w.f(this.$).L4b(ma,new Lc.a(D,1,0,8,null))}w.f(this.$).wSb=!1}}Rrc(D,
ma,vb,lc){const Nc=document.createEvent("KeyboardEvent");if(db.a.lE)Nc.initKeyboardEvent(D,!1,!1,window.self,"A",0,lc,!1,vb,!1);else{let wd="";vb&&(wd+="Shift");lc&&(wd+=0<wd.length?" Control":"Control");Nc.initKeyboardEvent(D,!1,!1,window.self,"A",0,wd,!1,"en-US")}D=new Sys.UI.DomEvent(Nc);D.keyCode=ma;return D}u7i(D){switch(D.operationType){case 1:void L.a.resolve(K.FunctionInfoManagerService,{xa:0}).then(ma=>{ma.Hke()});break;case 2:if(D=(K.DdaFacadeService.Oa()?this.Gc:Object(C.a)(Oa.DdaFacade,
kb.a(this.$))).Rp(D.controlId))D.oHc=!0,D.fAg()}}Hbi(D){const ma=D.fileBase64;return ma&&ma.length>this.$.ta.CreateWorkbookMaxAllowedBase64Size?Promise.reject(ra.bib(se.invalidArgument,Jc.a.instance.ia(1769),"Application.CreateWorkbook")):(new Promise((vb,lc)=>{const Nc=new hb.a;Nc.hc=4;Nc.Ni(t.AFrameworkApplication.ea.ka("IsNewStringEnabled")?CommonUiStrings.GeneralAddInMessageDialogTitle:CommonUIStrings.l_GeneralAddInMessageDialogTitle,t.AFrameworkApplication.ea.ka("IsNewStringEnabled")?CommonUiStrings.NewFileAPIConsentMessage:
CommonUIStrings.l_NewFileAPIConsentMessage,1,wd=>{2!==wd&&0!==wd||lc(ra.bib(se.ebe,Jc.a.instance.ia(1768),"Application.CreateWorkbook"));wd=new $a("blank","agave",ma?"streamBase64":"streamEmpty",ma);this.ahg.create(vb,lc,wd).dfb()})})).then(vb=>{this.Lwc.set(D.fakeFileId,vb);return Promise.resolve(null)},vb=>vb?Promise.reject(vb):Promise.reject(ra.bib(se.generalException,Jc.a.instance.ia(1765),"Application.CreateWorkbook")))}D8j(D){return new Promise((ma,vb)=>{if(this.Lwc.has(D.fakeFileId)){const lc=
this.Lwc.get(D.fakeFileId);vb=new hb.a;vb.hc=4;t.AFrameworkApplication.ea.ka("IsNewStringEnabled")?vb.Ni(CommonUiStrings.GeneralAddInMessageDialogTitle,CommonUiStrings.OpenWindowConsentMessage,1,Nc=>{1===Nc&&wb.HelperMethods.Rg(lc,void 0,void 0,"DdaMethodHandler.fileUrl");ma(null)}):vb.Ni(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,Nc=>{1===Nc&&wb.HelperMethods.Rg(lc,void 0,void 0,"DdaMethodHandler.fileUrl");ma(null)})}else vb(ra.bib(se.generalException,
Jc.a.instance.ia(1765),"Document.Open"))})}mIk(D){return new Promise(ma=>{(K.DdaFacadeService.Oa()?this.Gc:Object(C.a)(Oa.DdaFacade,kb.a(this.$))).FLg=D.runtimeCalculationMode;const vb=L.a.Cb(K.InstantaneousSupportInformationManagerService);vb&&vb.G7d(3===D.runtimeCalculationMode);ma(null)})}Ukl(D){z.a.rWb(this.$)&&(K.ExternalLinksManagerService.Oa()?this.externalLinksManager:this.$.ra.Tb(331)).ztb(0,D.urlStr,!0,!0,null);return Promise.resolve(null)}Tkl(){z.a.rWb(this.$)&&(K.ExternalLinksManagerService.Oa()?
this.externalLinksManager:this.$.ra.Tb(331)).ztb(1,null,!0,!0,null);return Promise.resolve(null)}Qkl(){z.a.rWb(this.$)&&(K.ExternalLinksManagerService.Oa()?this.externalLinksManager:this.$.ra.Tb(331)).Wuc();return Promise.resolve(null)}Rkl(D){z.a.rWb(this.$)&&(K.ExternalLinksManagerService.Oa()?this.externalLinksManager:this.$.ra.Tb(331)).ztb(5,D.urlStr,!0,!0,null);return Promise.resolve(null)}Skl(D){if(z.a.rWb(this.$)){const ma=K.ExternalLinksManagerService.Oa()?this.externalLinksManager:this.$.ra.Tb(331);
for(const vb of ma.hja)vb.IsActive&&vb.HostEditUrl&&vb.UrlStr===D.hostEditUrlStr&&wb.HelperMethods.Rg(vb.HostEditUrl,"_blank")}return Promise.resolve(null)}hEk(D,ma){const vb=Yb.a.GR;D=cc.a.Xj(D.payload);const lc={};"eventId"in D&&"payload"in D&&(lc.eventId=D.eventId,lc.payload=D.payload);ma.vK(2201,vb,cc.a.Nc(lc));return Promise.resolve(null)}AQf(D,ma,vb){const lc=L.a.Cb(K.BusinessBarManagerService);lc&&(D=this.aLi(D))&&(ma?lc.removeEntry(D):lc.Ukc(D,vb))}aLi(D){switch(D){case 0:return 64}}Rmd(D){D=
Object(C.a)(Ab.a,this.$.qa.getItemByName(D));(null===D||void 0===D?0:D.visible)&&D.activate({disableAutoFocusOnGrid:!0,scenario:"dda"})}N8g(D,ma,vb,lc){var Nc=D.oa.mt;const wd=Nc<ma.length&&ma[Nc].contains(D.oa.activeCell);D=wd?D.oa.activeCell:ma[0].topLeft;Nc=wd?Nc:0;w.f(this.$).oY(ma,Nc,vb,null,D,null,null,3,"DdaMethodHandler.UpdateSelection",void 0,void 0,void 0,6===lc)}static get Xci(){ra.EAa||(ra.EAa={},ra.EAa[Microsoft.Office.WebExtension.CoercionType.Table]=1,ra.EAa[Microsoft.Office.WebExtension.CoercionType.Text]=
2,ra.EAa[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,ra.EAa[Microsoft.Office.WebExtension.CoercionType.Html]=4,ra.EAa[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5);return ra.EAa}static get $ci(){ra.qzb||(ra.qzb={},ra.qzb[Microsoft.Office.WebExtension.FilterType.All]=1,ra.qzb[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2);return ra.qzb}static get adi(){ra.rzb||(ra.rzb={},ra.rzb[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=2,ra.rzb[Microsoft.Office.WebExtension.ValueFormat.Formatted]=
1);return ra.rzb}static vJf(D){if(!D||!D.length)return null;const ma=Array(D.length/2);for(let vb=0;vb<D.length/2;vb++)ma[vb]={},ma[vb].Name=D[2*vb],ma[vb].Value=D[2*vb+1];return ma}static T1i(D){if(!D||!D.length)return null;const ma=Array(2*D.length);for(let vb=0;vb<D.length;vb++)ma[2*vb]=D[vb].Name,ma[2*vb+1]=D[vb].Value;return ma}static vHd(D){if(!D||!D.length)return null;const ma=Array(D.length);for(let vb=0,lc=D.length;vb<lc;vb++){const Nc=D[vb].length;if(Nc){ma[vb]=Array(Nc);for(let wd=0;wd<
Nc;wd++)ma[vb][wd]=null==D[vb][wd]?null:D[vb][wd].toString()}else return null}return ma}static lqc(D){return"string"===typeof D?Jd.a.Mq(ra.Xci,D,0):D}static oBf(D){return"string"===typeof D?Jd.a.Mq(ra.$ci,D,0):D}static B$g(D){return"string"===typeof D?Jd.a.Mq(ra.adi,D,0):D}static Roj(D){switch(D.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1}static Tsd(D,ma){const vb={};vb.CoerceType=D;1===vb.CoerceType?(vb.Data=ra.vHd(ma.Rows),vb.Headers=ra.vHd(ma.Headers)):
vb.Data=ra.vHd(ma);return vb}static maf(D){return 1===D.CoerceType?{["Headers"]:D.Headers,["Rows"]:D.Data}:D.Data}static PEc(D){return 1===D.CoerceType?!D.Data&&!D.Headers:!D.Data}static aNf(D){let ma="Unknown";if(!D)return ma;for(let vb=0;vb<D.length;vb++)if(D[vb].Name.toLowerCase()===Va.a.aBk){ma=D[vb].Value;break}return ma}static oRk(D){if(!D)return!1;const ma=Va.a.eSj.toLowerCase();for(let vb=0;vb<D.length;vb++)if(D[vb].Name.toLowerCase()===ma)return!0;return!1}static bib(D,ma,vb){const lc={};
lc.Code=D;lc.Message=ma;lc.Location=vb;lc.ActionIndex=0;return lc}}ra.EAa=null;ra.qzb=null;ra.rzb=null;ra.fce=0;Object(l.a)(ra,"DdaMethodHandler",null,[29,4]);class jb{constructor(){this.P$c=this.Q$c=this.rgd=this.Eld=null}get operations(){this.rgd||(this.rgd=[],this.Fc());return this.rgd}get b4c(){this.Eld||(this.Eld=[],this.oh());return this.Eld}get GAf(){this.P$c||(this.P$c=[]);return this.P$c}get featureGates(){this.Q$c||(this.Q$c=[],this.initializeFeatureGates());return this.Q$c}oh(){}initializeFeatureGates(){}Wd(D){this.b4c.push(D)}rc(D){this.operations.includes(D)||
this.operations.push(D)}v2e(D){this.GAf.push(D)}}Object(l.a)(jb,"MacroRecorderEventBase",null,[]);class vc extends jb{constructor(){super()}get eventId(){return 130}Fc(){this.rc(100)}}Object(l.a)(vc,"AccessibilityCheckRunEvent",jb,[]);class md extends jb{constructor(){super()}get eventId(){return 160}Fc(){this.rc(241)}oh(){this.Wd(D=>D.addToPrintArea)}}Object(l.a)(md,"AddedToPrintAreaEvent",jb,[]);class Qd extends jb{constructor(){super()}get eventId(){return 65}Fc(){this.rc(516)}}Object(l.a)(Qd,
"AutoFilterToggledEvent",jb,[]);class v extends jb{constructor(){super()}get eventId(){return 118}Fc(){this.rc(502)}oh(){this.Wd(D=>!(D.djb().FirstColumn===D.djb().LastColumn&&D.djb().FirstRow===D.djb().LastRow))}}Object(l.a)(v,"AutoSumEvent",jb,[]);class Qb extends jb{constructor(){super()}get eventId(){return 223}Fc(){this.rc(1032)}}Object(l.a)(Qb,"CellImageAltTextAppliedEvent",jb,[]);class Dc extends jb{constructor(D,ma){super();this.zoa=D;this.gil=ma}get eventId(){return this.zoa}Fc(){this.rc(529);
this.rc(594)}oh(){this.Wd(D=>this.gil.includes(D.jNd()))}}Object(l.a)(Dc,"ChartPropertyAppliedEventBase",jb,[]);class id extends Dc{constructor(){super(84,[348,349,350,351,352,353,354,355,356,357,372,373,374,375])}}Object(l.a)(id,"ChartAxisChangedEvent",Dc,[]);class Md extends Dc{constructor(){super(80,[-104,-103,300,301,302,303,304,305,306,307,308,309,310,311])}}Object(l.a)(Md,"ChartAxisTitleChangedEvent",Dc,[]);class Sd extends Dc{constructor(){super(82,[200,201,202,203,204,205,206,207,208,209,
210])}}Object(l.a)(Sd,"ChartDataLabelsChangedEvent",Dc,[]);class ne extends Dc{constructor(){super(76,[-100])}}Object(l.a)(ne,"ChartDataSelectedEvent",Dc,[]);class Ce extends Dc{constructor(){super(83,[500,501,502])}}Object(l.a)(Ce,"ChartDataTableChangedEvent",Dc,[]);class Ge extends jb{constructor(){super()}}Object(l.a)(Ge,"RichApiRequestExecutedEventBase",jb,[]);class Ee extends Ge{constructor(){super()}get eventId(){return 117}eG(D){Ee.Jea||(Ee.Jea=new Dd.a(jc.a.Ef()),Ee.Jea.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),
Ee.Jea.add("fa000000014"));return!!D&&Ee.Jea.contains(D.toLowerCase())}Fc(){this.rc(507);this.rc(10);this.rc(576)}oh(){this.Wd(D=>Object(O.a)(Ud,D)&&(D=Object(C.a)(Ud,D),D.isValid&&this.eG(D.source))?(B.ULS.sendTraceTag(537155427,0,50,`[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: ${D.eventId}`),!0):!1)}}Ee.Jea=null;Object(l.a)(Ee,"ChartFormatRichApiRequestExecutedEvent",Ge,[]);class Ue extends Dc{constructor(){super(85,[328,329,330,331,332,333,334,335])}}Object(l.a)(Ue,
"ChartGridlinesChangedEvent",Dc,[]);class We extends jb{constructor(){super()}get eventId(){return 66}Fc(){this.rc(528)}}Object(l.a)(We,"ChartInsertedEvent",jb,[]);class ya extends Dc{constructor(){super(81,[100,101,102,103,104,105,106])}}Object(l.a)(ya,"ChartLegendChangedEvent",Dc,[]);class Cb extends Dc{constructor(){super(75,[-101])}}Object(l.a)(Cb,"ChartRowColumnSwitchedEvent",Dc,[]);class qa extends Dc{constructor(){super(79,[0,1,2,-102])}}Object(l.a)(qa,"ChartTitleChangedEvent",Dc,[]);class qb extends Dc{constructor(){super(78,
[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131])}}Object(l.a)(qb,"ChartTypeChangedEvent",Dc,[]);class bc extends jb{constructor(){super()}get eventId(){return 131}Fc(){this.rc(521)}}Object(l.a)(bc,"ConnectorFloatingObjectResizedEvent",jb,[]);class R extends jb{constructor(){super()}get eventId(){return 129}Fc(){this.rc(109)}}Object(l.a)(R,"EntitySelectedEvent",jb,[]);class cb extends jb{constructor(){super()}get eventId(){return 49}Fc(){this.rc(149);
this.rc(147)}}Object(l.a)(cb,"FindCellEvent",jb,[]);class zb extends jb{constructor(){super()}get eventId(){return 96}Fc(){this.rc(122)}}Object(l.a)(zb,"FloatingObjectAltTextAppliedEvent",jb,[]);class V extends jb{constructor(){super()}get eventId(){return 93}Fc(){this.rc(522)}}Object(l.a)(V,"FloatingObjectDeletedEvent",jb,[]);class Ea extends jb{constructor(){super()}get eventId(){return 94}Fc(){this.rc(524)}}Object(l.a)(Ea,"FloatingObjectMovedAndResizedEvent",jb,[]);class pb extends jb{constructor(){super()}get eventId(){return 95}Fc(){this.rc(523)}}
Object(l.a)(pb,"FloatingObjectRotatedEvent",jb,[]);class Jb extends jb{constructor(){super()}get eventId(){return 100}Fc(){this.rc(543)}}Object(l.a)(Jb,"GroupDetailsShownOrHiddenEvent",jb,[]);class zc extends jb{constructor(){super()}get eventId(){return 154}Fc(){this.rc(125)}}Object(l.a)(zc,"HyperlinksRemovedFromRangeEvent",jb,[]);class Mc extends Ge{constructor(){super()}get eventId(){return 125}eG(D){Mc.Jea||(Mc.Jea=new Dd.a(jc.a.Ef()),Mc.Jea.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),Mc.Jea.add("fa000000005"));
return!!D&&Mc.Jea.contains(D.toLowerCase())}Fc(){this.rc(507);this.rc(10);this.rc(576)}oh(){this.Wd(D=>Object(O.a)(Ud,D)?(D=Object(C.a)(Ud,D),D.isValid&&this.eG(D.source)):!1)}}Mc.Jea=null;Object(l.a)(Mc,"IdeasRichApiRequestExecutedEvent",Ge,[]);class od extends jb{constructor(){super()}get eventId(){return 136}Fc(){this.rc(115)}}Object(l.a)(od,"LinkedEntityConvertedEvent",jb,[]);class Td extends jb{constructor(){super()}get eventId(){return 148}Fc(){this.rc(114)}}Object(l.a)(Td,"LinkedEntityDisambiguationPaneToggledEvent",
jb,[]);class Zd extends jb{constructor(){super()}get eventId(){return 127}Fc(){this.rc(119)}}Object(l.a)(Zd,"MovedToEdgeEvent",jb,[]);class xe extends jb{constructor(){super()}get eventId(){return 135}Fc(){this.rc(191)}}Object(l.a)(xe,"NamedSheetViewCreatedEvent",jb,[]);class pe extends jb{constructor(){super()}get eventId(){return 166}Fc(){this.rc(200)}}Object(l.a)(pe,"NamedSheetViewDeletedEvent",jb,[]);class Re extends jb{constructor(){super()}get eventId(){return 133}Fc(){this.rc(192)}}Object(l.a)(Re,
"NamedSheetViewExitedEvent",jb,[]);class pf extends jb{constructor(){super()}get eventId(){return 162}Fc(){this.rc(199)}}Object(l.a)(pf,"NamedSheetViewRenamedEvent",jb,[]);class vf extends jb{constructor(){super()}get eventId(){return 167}Fc(){this.rc(195)}}Object(l.a)(vf,"NamedSheetViewSwitchedEvent",jb,[]);class Qf extends jb{constructor(){super()}get eventId(){return 99}Fc(){this.rc(174)}}Object(l.a)(Qf,"OutlineLevelSetEvent",jb,[]);class yf extends jb{constructor(){super()}get eventId(){return 156}Fc(){this.rc(244)}}
Object(l.a)(yf,"PageBreakInsertedEvent",jb,[]);class Df extends jb{constructor(){super()}get eventId(){return 157}Fc(){this.rc(245)}}Object(l.a)(Df,"PageBreakRemovedEvent",jb,[]);class pg extends jb{constructor(){super()}get eventId(){return 158}Fc(){this.rc(246)}}Object(l.a)(pg,"PageBreaksAllResetEvent",jb,[]);class Zf extends jb{constructor(){super()}get eventId(){return 112}Fc(){this.rc(503)}oh(){this.Wd(D=>!!D.pasteParameters.ClientEstimationFloatingObjectId&&2===D.pasteParameters.CopyPasteTargetType&&
!D.isFromCurrentSession)}}Object(l.a)(Zf,"PasteArtOtherWorkbookEvent",jb,[]);class Tg extends jb{constructor(){super()}get eventId(){return 52}Fc(){this.rc(503)}oh(){this.Wd(D=>!!D.pasteParameters.ClientEstimationFloatingObjectId&&2===D.pasteParameters.CopyPasteTargetType&&D.isFromCurrentSession)}}Object(l.a)(Tg,"PasteArtSameWorkbookEvent",jb,[]);class Wg extends jb{constructor(){super()}get eventId(){return 110}Fc(){this.rc(204)}}Object(l.a)(Wg,"PasteHtmlEvent",jb,[]);class ph extends jb{constructor(){super()}get eventId(){return 35}Fc(){this.rc(506)}}
Object(l.a)(ph,"PasteRangeEvent",jb,[]);class Ug extends jb{constructor(){super()}get eventId(){return 111}Fc(){this.rc(503)}oh(){this.Wd(D=>1===D.pasteParameters.CopyPasteTargetType)}}Object(l.a)(Ug,"PasteShadowWorkbookRangeEvent",jb,[]);class fh extends jb{constructor(){super()}get eventId(){return 42}Fc(){this.rc(180)}}Object(l.a)(fh,"PasteStringEvent",jb,[]);class rg extends jb{constructor(){super()}get eventId(){return 134}Fc(){this.rc(220)}}Object(l.a)(rg,"PendingMergeEvent",jb,[]);class jh extends jb{constructor(){super()}get eventId(){return 122}Fc(){this.rc(510)}}
Object(l.a)(jh,"PictureInsertedEvent",jb,[]);class zh extends jb{constructor(){super()}get eventId(){return 153}Fc(){this.rc(161)}}Object(l.a)(zh,"PivotDrillToggledEvent",jb,[]);class zg extends jb{constructor(D,ma){super();this.zoa=D;this.opType=ma}get eventId(){return this.zoa}Fc(){this.rc(225)}oh(){this.Wd(D=>D.opType===this.opType)}}Object(l.a)(zg,"PivotTableSettingsChangedEventBase",jb,[]);class Zg extends zg{constructor(){super(171,4)}}Object(l.a)(Zg,"PivotTableAllItemLabelsRepeatedEvent",zg,
[]);class ab extends zg{constructor(){super(184,17)}}Object(l.a)(ab,"PivotTableAltTextDescriptionChangedEvent",zg,[]);class Ua extends zg{constructor(){super(183,16)}}Object(l.a)(Ua,"PivotTableAltTextTitleChangedEvent",zg,[]);class hd extends zg{constructor(){super(173,6)}}Object(l.a)(hd,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",zg,[]);class qe extends zg{constructor(){super(172,5)}}Object(l.a)(qe,"PivotTableBlankLineAfterEachItemToggledEvent",zg,[]);class Ae extends zg{constructor(){super(170,
3)}}Object(l.a)(Ae,"PivotTableColumnGrandTotalShownEvent",zg,[]);class ef extends jb{constructor(){super()}get eventId(){return 98}Fc(){this.rc(132)}}Object(l.a)(ef,"PivotTableCreatedEvent",jb,[]);class Tf extends zg{constructor(){super(177,10)}}Object(l.a)(Tf,"PivotTableDisplayErrorStringToggledEvent",zg,[]);class Nf extends zg{constructor(){super(178,11)}}Object(l.a)(Nf,"PivotTableDisplayNullStringToggledEvent",zg,[]);class wg extends zg{constructor(){super(179,12)}}Object(l.a)(wg,"PivotTableErrorStringChangedEvent",
zg,[]);class Uf extends zg{constructor(){super(174,7)}}Object(l.a)(Uf,"PivotTableExpandCollapseButtonsShownEvent",zg,[]);class lg extends zg{constructor(){super(187,20)}}Object(l.a)(lg,"PivotTableIndentChangedEvent",zg,[]);class Kg extends zg{constructor(){super(176,9)}}Object(l.a)(Kg,"PivotTableItemsWithNoDataOnColumnsShownEvent",zg,[]);class If extends zg{constructor(){super(175,8)}}Object(l.a)(If,"PivotTableItemsWithNoDataOnRowsShownEvent",zg,[]);class hg extends zg{constructor(){super(186,19)}}
Object(l.a)(hg,"PivotTableLayoutTypeSetEvent",zg,[]);class gh extends zg{constructor(){super(180,13)}}Object(l.a)(gh,"PivotTableNullStringChangedEvent",zg,[]);class mc extends jb{constructor(){super()}get eventId(){return 149}Fc(){this.rc(219)}}Object(l.a)(mc,"PivotTablePivotLocationChangedEvent",jb,[]);class sd extends jb{constructor(){super()}get eventId(){return 102}Fc(){this.rc(145)}}Object(l.a)(sd,"PivotTablePivotedEvent",jb,[]);class ie extends zg{constructor(){super(182,15)}}Object(l.a)(ie,
"PivotTableRefreshDataOnLoadToggledEvent",zg,[]);class te extends jb{constructor(){super()}get eventId(){return 104}Fc(){this.rc(50)}oh(){this.Wd(D=>!!D.pivotTableId&&!!D.pivotTableName)}}Object(l.a)(te,"PivotTableRefreshedEvent",jb,[]);class Ve extends zg{constructor(){super(168,1)}}Object(l.a)(Ve,"PivotTableRenamedEvent",zg,[]);class kf extends zg{constructor(){super(169,2)}}Object(l.a)(kf,"PivotTableRowGrandTotalShownEvent",zg,[]);class Of extends zg{constructor(){super(181,14)}}Object(l.a)(Of,
"PivotTableSaveSourceDataWithFileToggledEvent",zg,[]);var Sf=a(761);class fg extends jb{constructor(){super()}get eventId(){return 155}Fc(){this.rc(131)}oh(){this.Wd(D=>{D=Object(C.a)(Sf.a,D);return!!D&&!!D.getFieldName()&&!!D.hierarchyName})}}Object(l.a)(fg,"PivotTableSortedEvent",jb,[]);class Pg extends zg{constructor(){super(185,18)}}Object(l.a)(Pg,"PivotTableSubTotalsVisibilitySettingSetEvent",zg,[]);class lh extends jb{constructor(){super()}get eventId(){return 206}Fc(){this.rc(560)}}Object(l.a)(lh,
"PivotValueFieldSettingAppliedEvent",jb,[]);class Qg extends jb{constructor(){super()}get eventId(){return 161}Fc(){this.rc(243)}}Object(l.a)(Qg,"PrintAreaClearedEvent",jb,[]);class tg extends jb{constructor(){super()}get eventId(){return 159}Fc(){this.rc(241)}oh(){this.Wd(D=>!D.addToPrintArea)}}Object(l.a)(tg,"PrintAreaSetEvent",jb,[]);class Dh extends jb{constructor(){super()}get eventId(){return 57}Fc(){this.rc(517)}}Object(l.a)(Dh,"RangeAutoFilterClearedEvent",jb,[]);class Gg extends jb{constructor(D,
ma){super();this.zoa=D;this.jBe=ma}get eventId(){return this.zoa}Fc(){this.rc(11)}oh(){this.Wd(D=>16===D.eY().ValidMembers);this.Wd(D=>D.eY().Font.ValidMembers===this.jBe)}}Object(l.a)(Gg,"RangeFontFormattedEventBase",jb,[]);class gg extends Gg{constructor(){super(3,4)}}Object(l.a)(gg,"RangeBoldedEvent",Gg,[]);class Hg extends jb{constructor(){super()}get eventId(){return 2}Fc(){this.rc(11)}oh(){this.Wd(D=>128===D.eY().ValidMembers)}}Object(l.a)(Hg,"RangeBorderedEvent",jb,[]);class Lg{}Lg.Upb="Table";
Lg.XPc="Sheet";Object(l.a)(Lg,"MacroRecorderEventConstants",null,[]);class qh extends jb{constructor(){super()}get eventId(){return 113}Fc(){this.rc(208)}oh(){this.Wd(D=>D.getParameters().FilterType===Lg.XPc)}}Object(l.a)(qh,"RangeCheckedItemsFilteredEvent",jb,[]);class Dg extends jb{constructor(){super()}get eventId(){return 109}Fc(){this.rc(105)}}Object(l.a)(Dg,"RangeConditionalFormattingCreatedEvent",jb,[]);class mh extends jb{constructor(){super()}get eventId(){return 124}Fc(){this.rc(221)}}Object(l.a)(mh,
"RangeConditionalFormattingRuleDeletedEvent",jb,[]);class Rg extends jb{constructor(){super()}get eventId(){return 29}Fc(){this.rc(508)}oh(){this.Wd(D=>3===D.yy()||1===D.yy()||4===D.yy())}}Object(l.a)(Rg,"RangeContentClearedEvent",jb,[]);class xg extends jb{constructor(){super()}get eventId(){return 40}Fc(){this.rc(104)}}Object(l.a)(xg,"RangeCopiedCutCellsInsertedEvent",jb,[]);class nh extends jb{constructor(){super()}get eventId(){return 114}Fc(){this.rc(209)}oh(){this.Wd(D=>D.getParameters().FilterType===
Lg.XPc)}}Object(l.a)(nh,"RangeCustomFilteredEvent",jb,[]);class Ah extends jb{constructor(){super()}get eventId(){return 106}Fc(){this.rc(121)}}Object(l.a)(Ah,"RangeDataValidationChangedEvent",jb,[]);class sh extends Gg{constructor(){super(4,64)}}Object(l.a)(sh,"RangeDoubleUnderlinedEvent",Gg,[]);class eg extends jb{constructor(){super()}get eventId(){return 69}Fc(){this.rc(190)}}Object(l.a)(eg,"RangeDuplicatesRemovedEvent",jb,[]);class th extends jb{constructor(){super()}get eventId(){return 1}Fc(){this.rc(527);
this.rc(12)}}Object(l.a)(th,"RangeEditedEvent",jb,[]);class uh extends jb{constructor(){super()}get eventId(){return 164}Fc(){this.rc(255)}oh(){this.Wd(D=>4===D.actionType)}}Object(l.a)(uh,"RangeExternalLinksBrokeAllLinksEvent",jb,[]);class ka extends jb{constructor(){super()}get eventId(){return 119}Fc(){this.rc(255)}oh(){this.Wd(D=>3===D.actionType)}}Object(l.a)(ka,"RangeExternalLinksBrokeLinkEvent",jb,[]);class ac extends jb{constructor(){super()}get eventId(){return 205}Fc(){this.rc(256)}initializeFeatureGates(){this.v2e("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")}}
Object(l.a)(ac,"RangeExternalLinksChangeSourceEvent",jb,[]);class Xc extends jb{constructor(){super()}get eventId(){return 163}Fc(){this.rc(553)}oh(){this.Wd(D=>1===D.actionType)}}Object(l.a)(Xc,"RangeExternalLinksRefreshedAllEvent",jb,[]);class Bd extends jb{constructor(){super()}get eventId(){return 77}Fc(){this.rc(553)}oh(){this.Wd(D=>0===D.actionType)}}Object(l.a)(Bd,"RangeExternalLinksRefreshedEvent",jb,[]);class we extends jb{constructor(){super()}get eventId(){return 165}Fc(){this.rc(224)}}
Object(l.a)(we,"RangeExternalLinksSetAutoRefreshEvent",jb,[]);class Cd extends jb{constructor(){super()}get eventId(){return 5}Fc(){this.rc(11)}oh(){this.Wd(D=>64===D.eY().ValidMembers)}}Object(l.a)(Cd,"RangeFillColoredEvent",jb,[]);class Q extends jb{constructor(){super()}get eventId(){return 59}Fc(){this.rc(155)}}Object(l.a)(Q,"RangeFilledEvent",jb,[]);class Ja extends jb{constructor(){super()}get eventId(){return 115}Fc(){this.rc(176)}oh(){this.Wd(D=>D.autoFilterOptions.AutoFilterType===Lg.XPc&&
!!D.autoFilterOptions.CriteriaType)}}Object(l.a)(Ja,"RangeFilterAppliedEvent",jb,[]);class ob extends jb{constructor(){super()}get eventId(){return 58}Fc(){this.rc(176)}oh(){this.Wd(D=>D.autoFilterOptions.AutoFilterType===Lg.XPc&&!D.autoFilterOptions.CriteriaType)}}Object(l.a)(ob,"RangeFilterClearedEvent",jb,[]);class qc extends jb{constructor(){super()}get eventId(){return 41}Fc(){this.rc(518)}}Object(l.a)(qc,"RangeFilterReappliedEvent",jb,[]);class gd extends jb{constructor(){super()}get eventId(){return 86}Fc(){this.rc(150)}}
Object(l.a)(gd,"RangeFlashFilledEvent",jb,[]);class td extends Gg{constructor(){super(6,32)}}Object(l.a)(td,"RangeFontColoredEvent",Gg,[]);class ca extends Gg{constructor(){super(7,8)}}Object(l.a)(ca,"RangeFontItalicizedEvent",Gg,[]);class bb extends Gg{constructor(){super(8,1)}oh(){this.Wd(D=>16===D.eY().ValidMembers);this.Wd(D=>1===(D.eY().Font.ValidMembers&1))}}Object(l.a)(bb,"RangeFontNamedEvent",Gg,[]);class Hb extends Gg{constructor(){super(9,2)}}Object(l.a)(Hb,"RangeFontSizedEvent",Gg,[]);
class Vb extends jb{constructor(){super()}get eventId(){return 74}Fc(){this.rc(215)}}Object(l.a)(Vb,"RangeFormattedAsTableEvent",jb,[]);class Ec extends jb{constructor(){super()}get eventId(){return 97}Fc(){this.rc(188)}}Object(l.a)(Ec,"RangeGroupedOrUngroupedEvent",jb,[]);class rd extends jb{constructor(){super()}get eventId(){return 60}Fc(){this.rc(11)}oh(){this.Wd(D=>2===D.eY().ValidMembers)}}Object(l.a)(rd,"RangeHorizontallyAlignedEvent",jb,[]);class Id extends jb{constructor(){super()}get eventId(){return 43}Fc(){this.rc(526)}}
Object(l.a)(Id,"RangeHyperlinkAppliedEvent",jb,[]);class W extends jb{constructor(){super()}get eventId(){return 63}Fc(){this.rc(11)}oh(){this.Wd(D=>256===D.eY().ValidMembers)}}Object(l.a)(W,"RangeIndentChangedEvent",jb,[]);class Ra extends jb{constructor(){super()}get eventId(){return 53}Fc(){this.rc(156)}oh(){this.Wd(D=>2===D.yy()||5===D.yy()||6===D.yy()||7===D.yy())}}Object(l.a)(Ra,"RangeMergedEvent",jb,[]);class nc extends jb{constructor(){super()}get eventId(){return 107}Fc(){this.rc(216)}}Object(l.a)(nc,
"RangeNamedCellStyleAppliedEvent",jb,[]);class yc extends jb{constructor(){super()}get eventId(){return 12}Fc(){this.rc(11)}oh(){this.Wd(D=>32===D.eY().ValidMembers)}}Object(l.a)(yc,"RangeNumberFormattedEvent",jb,[]);var Fd=a(1252);class $d extends jb{constructor(){super()}get eventId(){return 108}Fc(){this.rc(141)}oh(){this.Wd(D=>Object(O.a)(Fd.a,D))}}Object(l.a)($d,"RangeSortedEvent",jb,[]);class Me extends Gg{constructor(){super(10,128)}}Object(l.a)(Me,"RangeStrikedThroughEvent",Gg,[]);class ff extends Gg{constructor(){super(11,
16)}}Object(l.a)(ff,"RangeUnderlinedEvent",Gg,[]);class jf extends jb{constructor(){super()}get eventId(){return 61}Fc(){this.rc(11)}oh(){this.Wd(D=>1===D.eY().ValidMembers)}}Object(l.a)(jf,"RangeVerticallyAlignedEvent",jb,[]);class Lf extends jb{constructor(){super()}get eventId(){return 62}Fc(){this.rc(11)}oh(){this.Wd(D=>8===D.eY().ValidMembers)}}Object(l.a)(Lf,"RangeWrapTextToggledEvent",jb,[]);class Ef extends jb{constructor(){super()}get eventId(){return 103}Fc(){this.rc(51)}}Object(l.a)(Ef,
"RefreshedAllEvent",jb,[]);class jg extends jb{constructor(){super()}get eventId(){return 47}Fc(){this.rc(148)}}Object(l.a)(jg,"ReplaceAllEvent",jb,[]);class Eg extends jb{constructor(){super()}get eventId(){return 226}Fc(){this.rc(1025)}}Object(l.a)(Eg,"SampleTableCreatedEvent",jb,[]);class bh extends jb{constructor(){super()}get eventId(){return 91}Fc(){this.rc(532)}oh(){this.Wd(D=>95!==D.getShapeType()&&96!==D.getShapeType()&&97!==D.getShapeType()&&98!==D.getShapeType()&&100!==D.getShapeType()&&
102!==D.getShapeType()&&103!==D.getShapeType())}}Object(l.a)(bh,"ShapeInsertedEvent",jb,[]);class ch extends jb{constructor(){super()}get eventId(){return 92}Fc(){this.rc(531)}}Object(l.a)(ch,"ShapeStyleSetEvent",jb,[]);var Fg=a(1070);class og extends jb{constructor(D,ma){super();this.zoa=D;this.jBe=ma}get eventId(){return this.zoa}Fc(){this.rc(581)}oh(){this.Wd(D=>Object(O.a)(Fg.a,D)&&4===D.getShapeTextFormat().ValidMembers);this.Wd(D=>Object(O.a)(Fg.a,D)&&D.getShapeTextFormat().Font.ValidMembers===
this.jBe)}}Object(l.a)(og,"ShapeTextFontFormattedEventBase",jb,[]);class qg extends og{constructor(){super(193,4)}}Object(l.a)(qg,"ShapeTextBoldedEvent",og,[]);var Bh=a(1275);class Jh extends jb{constructor(){super()}get eventId(){return 191}Fc(){this.rc(581)}oh(){this.Wd(D=>Object(O.a)(Bh.a,D))}}Object(l.a)(Jh,"ShapeTextChangedEvent",jb,[]);class Rh extends og{constructor(){super(196,32)}}Object(l.a)(Rh,"ShapeTextFontColorChangedEvent",og,[]);class hi extends og{constructor(){super(197,1)}}Object(l.a)(hi,
"ShapeTextFontNameChangedEvent",og,[]);class Ni extends og{constructor(){super(198,2)}}Object(l.a)(Ni,"ShapeTextFontSizeChangedEvent",og,[]);class Eh extends jb{constructor(){super()}get eventId(){return 199}Fc(){this.rc(581)}oh(){this.Wd(D=>Object(O.a)(Fg.a,D)&&2===D.getShapeTextFormat().ValidMembers)}}Object(l.a)(Eh,"ShapeTextHorizontallyAlignedEvent",jb,[]);class ri extends og{constructor(){super(194,8)}}Object(l.a)(ri,"ShapeTextItalicizedEvent",og,[]);class Oi extends og{constructor(){super(195,
16)}}Object(l.a)(Oi,"ShapeTextUnderlinedEvent",og,[]);class Gh extends jb{constructor(){super()}get eventId(){return 200}Fc(){this.rc(581)}oh(){this.Wd(D=>Object(O.a)(Fg.a,D)&&1===D.getShapeTextFormat().ValidMembers)}}Object(l.a)(Gh,"ShapeTextVerticallyAlignedEvent",jb,[]);class bi extends jb{constructor(){super()}get eventId(){return 13}Fc(){this.rc(138)}}Object(l.a)(bi,"SheetAddedEvent",jb,[]);class Ig extends jb{constructor(){super()}get eventId(){return 142}Fc(){this.rc(237)}oh(){this.Wd(D=>!!D.insertDeleteMultiRangeParameters);
this.Wd(D=>!D.insertDeleteMultiRangeParameters.IsTableCommand);this.Wd(D=>{D=D.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>D.DeltaColumn&&!D.DeltaRow&&(!!D.InsertDeleteRange.FirstRow||D.InsertDeleteRange.LastRow!==Va.a.Qz)||!D.DeltaColumn&&0>D.DeltaRow&&(!!D.InsertDeleteRange.FirstColumn||D.InsertDeleteRange.LastColumn!==Va.a.Ny)})}}Object(l.a)(Ig,"SheetCellsDeletedEvent",jb,[]);class Ci extends jb{constructor(){super()}get eventId(){return 143}Fc(){this.rc(237)}oh(){this.Wd(D=>
!!D.insertDeleteMultiRangeParameters);this.Wd(D=>!D.insertDeleteMultiRangeParameters.IsTableCommand);this.Wd(D=>{D=D.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<D.DeltaColumn&&!D.DeltaRow&&(!!D.InsertDeleteRange.FirstRow||D.InsertDeleteRange.LastRow!==Va.a.Qz)||!D.DeltaColumn&&0<D.DeltaRow&&(!!D.InsertDeleteRange.FirstColumn||D.InsertDeleteRange.LastColumn!==Va.a.Ny)})}}Object(l.a)(Ci,"SheetCellsInsertedEvent",jb,[]);class ci extends jb{constructor(){super()}get eventId(){return 139}Fc(){this.rc(237)}oh(){this.Wd(D=>
!!D.insertDeleteMultiRangeParameters);this.Wd(D=>!D.insertDeleteMultiRangeParameters.IsTableCommand);this.Wd(D=>0>D.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Wd(D=>!D.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.Wd(D=>!D.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.Wd(D=>D.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===Va.a.Qz)}}Object(l.a)(ci,"SheetColumnDeletedEvent",
jb,[]);class di extends jb{constructor(){super()}get eventId(){return 138}Fc(){this.rc(237)}oh(){this.Wd(D=>!!D.insertDeleteMultiRangeParameters);this.Wd(D=>!D.insertDeleteMultiRangeParameters.IsTableCommand);this.Wd(D=>0<D.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Wd(D=>!D.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.Wd(D=>!D.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.Wd(D=>D.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===
Va.a.Qz)}}Object(l.a)(di,"SheetColumnInsertedEvent",jb,[]);class Vi extends jb{constructor(){super()}get eventId(){return 14}Fc(){this.rc(137)}}Object(l.a)(Vi,"SheetDeletedEvent",jb,[]);class Ch extends jb{constructor(){super()}get eventId(){return 137}Fc(){this.rc(185)}}Object(l.a)(Ch,"SheetDirectionChangedEvent",jb,[]);class Pi extends jb{constructor(){super()}get eventId(){return 54}Fc(){this.rc(139)}}Object(l.a)(Pi,"SheetDuplicatedEvent",jb,[]);class Di extends jb{constructor(){super()}get eventId(){return 15}Fc(){this.rc(207)}}
Object(l.a)(Di,"SheetNameEditedEvent",jb,[]);class Wi extends jb{constructor(){super()}get eventId(){return 90}Fc(){this.rc(151)}}Object(l.a)(Wi,"SheetPaneFrozenEvent",jb,[]);class Wh extends jb{constructor(){super()}get eventId(){return 120}Fc(){this.rc(226)}}Object(l.a)(Wh,"SheetPrintSettingsSavedEvent",jb,[]);var Sh=a(1156);class ah extends jb{constructor(){super()}get eventId(){return 215}Fc(){this.rc(507)}initializeFeatureGates(){this.v2e("Microsoft.Office.Excel.SheetProtectionMacroRecording")}oh(){this.Wd(D=>
Object.getType(D)===Sh.a)}}Object(l.a)(ah,"SheetProtectionPausedResumedEvent",jb,[]);class ei extends jb{constructor(){super()}get eventId(){return 64}Fc(){this.rc(557)}}Object(l.a)(ei,"SheetReorderedEvent",jb,[]);class Uh extends jb{constructor(){super()}get eventId(){return 141}Fc(){this.rc(237)}oh(){this.Wd(D=>!!D.insertDeleteMultiRangeParameters);this.Wd(D=>!D.insertDeleteMultiRangeParameters.IsTableCommand);this.Wd(D=>!D.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.Wd(D=>0>D.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.Wd(D=>!D.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.Wd(D=>D.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===Va.a.Ny)}}Object(l.a)(Uh,"SheetRowDeletedEvent",jb,[]);class gj extends jb{constructor(){super()}get eventId(){return 140}Fc(){this.rc(237)}oh(){this.Wd(D=>!!D.insertDeleteMultiRangeParameters);this.Wd(D=>!D.insertDeleteMultiRangeParameters.IsTableCommand);
this.Wd(D=>!D.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Wd(D=>0<D.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.Wd(D=>!D.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.Wd(D=>D.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===Va.a.Ny)}}Object(l.a)(gj,"SheetRowInsertedEvent",jb,[]);class ii extends jb{constructor(){super()}get eventId(){return 39}Fc(){this.rc(135)}}
Object(l.a)(ii,"SheetRowsColumnsAutoFitEvent",jb,[]);class Kh extends jb{constructor(){super()}get eventId(){return 36}Fc(){this.rc(136)}}Object(l.a)(Kh,"SheetRowsColumnsResizedEvent",jb,[]);class ji extends jb{constructor(){super()}get eventId(){return 68}Fc(){this.rc(183)}}Object(l.a)(ji,"SheetShowGridlinesToggledEvent",jb,[]);class ki extends jb{constructor(){super()}get eventId(){return 67}Fc(){this.rc(184)}}Object(l.a)(ki,"SheetShowHeadingsToggledEvent",jb,[]);class Zi extends jb{constructor(){super()}get eventId(){return 89}Fc(){this.rc(213)}}
Object(l.a)(Zi,"SheetSpellCheckedEvent",jb,[]);class Lh extends jb{constructor(){super()}get eventId(){return 70}Fc(){this.rc(515)}}Object(l.a)(Lh,"SheetTabColoredEvent",jb,[]);class Fh extends jb{constructor(){super()}get eventId(){return 71}Fc(){this.rc(157)}}Object(l.a)(Fh,"SheetVisibilityChangedEvent",jb,[]);class fi extends jb{constructor(){super()}get eventId(){return 126}Fc(){this.rc(239)}}Object(l.a)(fi,"SheetsVisibilityChangedEvent",jb,[]);class Qi extends jb{constructor(){super()}get eventId(){return 188}Fc(){this.rc(203)}}
Object(l.a)(Qi,"SlicerInsertedEvent",jb,[]);class si extends jb{constructor(){super()}get eventId(){return 189}Fc(){this.rc(173)}oh(){this.Wd(D=>!D.clearFilter)}}Object(l.a)(si,"SlicerSelectionAppliedEvent",jb,[]);class hj extends jb{constructor(){super()}get eventId(){return 190}Fc(){this.rc(173)}oh(){this.Wd(D=>D.clearFilter)}}Object(l.a)(hj,"SlicerSelectionClearedEvent",jb,[]);class li extends jb{constructor(){super()}get eventId(){return 27}Fc(){this.rc(208)}oh(){this.Wd(D=>D.getParameters().FilterType===
Lg.Upb)}}Object(l.a)(li,"TableCheckedItemsFilteredEvent",jb,[]);class $i extends jb{constructor(){super()}get eventId(){return 144}Fc(){this.rc(237)}oh(){this.Wd(D=>!!D.insertDeleteMultiRangeParameters);this.Wd(D=>D.insertDeleteMultiRangeParameters.IsTableCommand);this.Wd(D=>0>D.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Wd(D=>!D.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(l.a)($i,"TableColumnDeletedEvent",jb,[]);class xj extends jb{constructor(){super()}get eventId(){return 145}Fc(){this.rc(237)}oh(){this.Wd(D=>
!!D.insertDeleteMultiRangeParameters);this.Wd(D=>D.insertDeleteMultiRangeParameters.IsTableCommand);this.Wd(D=>0<D.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Wd(D=>!D.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(l.a)(xj,"TableColumnInsertedEvent",jb,[]);var ti=a(1251);class Ei extends jb{constructor(){super()}get eventId(){return 121}Fc(){this.rc(141)}oh(){this.Wd(D=>Object(O.a)(ti.a,D))}}Object(l.a)(Ei,"TableColumnSortedEvent",jb,
[]);class Ag extends jb{constructor(){super()}get eventId(){return 105}Fc(){this.rc(193)}}Object(l.a)(Ag,"TableConvertedToRangeEvent",jb,[]);class vh extends jb{constructor(){super()}get eventId(){return 16}Fc(){this.rc(206)}}Object(l.a)(vh,"TableCreatedEvent",jb,[]);class Fi extends jb{constructor(){super()}get eventId(){return 30}Fc(){this.rc(209)}oh(){this.Wd(D=>D.getParameters().FilterType===Lg.Upb)}}Object(l.a)(Fi,"TableCustomFilteredEvent",jb,[]);var mi=a(1656);class ui extends jb{constructor(){super()}get eventId(){return 25}Fc(){this.rc(187)}oh(){this.Wd(D=>
D.options.OperationType===mi.d.CustomSort)}}Object(l.a)(ui,"TableCustomSortedEvent",jb,[]);class Qh extends jb{constructor(){super()}get eventId(){return 28}Fc(){this.rc(176)}oh(){this.Wd(D=>D.autoFilterOptions.AutoFilterType===Lg.Upb);this.Wd(D=>0===D.autoFilterOptions.CriteriaType)}}Object(l.a)(Qh,"TableFilterClearedEvent",jb,[]);class Xi extends jb{constructor(){super()}get eventId(){return 32}Fc(){this.rc(176)}oh(){this.Wd(D=>D.autoFilterOptions.AutoFilterType===Lg.Upb);this.Wd(D=>[1,2,8,9,10,
11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39].includes(D.autoFilterOptions.CriteriaType))}}Object(l.a)(Xi,"TableItemFilteredEvent",jb,[]);class ij extends jb{constructor(){super()}get eventId(){return 101}Fc(){this.rc(217)}}Object(l.a)(ij,"TableRenamedEvent",jb,[]);class Rd extends jb{constructor(){super()}get eventId(){return 73}Fc(){this.rc(211)}}Object(l.a)(Rd,"TableResizedEvent",jb,[]);class ve extends jb{constructor(){super()}get eventId(){return 44}Fc(){this.rc(514)}}
Object(l.a)(ve,"TableRowColumnRearrangedEvent",jb,[]);class Ej extends jb{constructor(){super()}get eventId(){return 146}Fc(){this.rc(237)}oh(){this.Wd(D=>!!D.insertDeleteMultiRangeParameters);this.Wd(D=>D.insertDeleteMultiRangeParameters.IsTableCommand);this.Wd(D=>!D.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Wd(D=>0>D.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(l.a)(Ej,"TableRowDeletedEvent",jb,[]);class hh extends jb{constructor(){super()}get eventId(){return 147}Fc(){this.rc(237)}oh(){this.Wd(D=>
!!D.insertDeleteMultiRangeParameters);this.Wd(D=>D.insertDeleteMultiRangeParameters.IsTableCommand);this.Wd(D=>!D.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Wd(D=>0<D.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(l.a)(hh,"TableRowInsertedEvent",jb,[]);class Ri extends jb{constructor(){super()}get eventId(){return 26}Fc(){this.rc(177)}oh(){this.Wd(D=>D.autoFilterOptions.AutoFilterType===Lg.Upb)}}Object(l.a)(Ri,"TableSortedEvent",jb,[]);
class wi extends jb{constructor(){super()}get eventId(){return 87}Fc(){this.rc(212)}}Object(l.a)(wi,"TableStyleAppliedEvent",jb,[]);class Si extends jb{constructor(){super()}get eventId(){return 88}Fc(){this.rc(196)}}Object(l.a)(Si,"TableStyleOptionToggledEvent",jb,[]);class ni extends jb{constructor(){super()}get eventId(){return 31}Fc(){this.rc(210)}oh(){this.Wd(D=>D.getParameters().FilterType===Lg.Upb)}}Object(l.a)(ni,"TableTop10FilteredEvent",jb,[]);class oi extends jb{constructor(){super()}get eventId(){return 207}Fc(){this.rc(238)}}
Object(l.a)(oi,"TextToColumnsEvent",jb,[]);class aj extends jb{constructor(){super()}get eventId(){return 128}Fc(){this.rc(559)}}Object(l.a)(aj,"ValuesSortedEvent",jb,[]);class jj extends jb{constructor(){super()}get eventId(){return 55}Fc(){this.rc(197)}}Object(l.a)(jj,"WorkbookCalculationModeSetEvent",jb,[]);class Gi extends jb{constructor(){super()}get eventId(){return 34}Fc(){this.rc(181)}oh(){this.Wd(D=>!!D.parentCommentId)}}Object(l.a)(Gi,"WorkbookCommentRepliedEvent",jb,[]);class sj extends jb{constructor(){super()}get eventId(){return 33}Fc(){this.rc(181)}oh(){this.Wd(D=>
!D.parentCommentId)}}Object(l.a)(sj,"WorkbookCommentedEvent",jb,[]);class oh extends jb{constructor(){super()}get eventId(){return 56}Fc(){this.rc(128)}}Object(l.a)(oh,"WorkbookRecalculatedEvent",jb,[]);class Yh extends jb{constructor(){super()}get eventId(){return 46}Fc(){this.rc(171)}}Object(l.a)(Yh,"WorkbookRedoEvent",jb,[]);class xi extends jb{constructor(){super()}get eventId(){return 45}Fc(){this.rc(170);this.rc(1033)}}Object(l.a)(xi,"WorkbookUndoEvent",jb,[]);class Zh extends jb{constructor(){super()}get eventId(){return 116}Fc(){this.rc(507);
this.rc(576);this.rc(10)}oh(){this.Wd(D=>{if(Object(O.a)(Ud,D)&&(D=Object(C.a)(Ud,D),void 0!==D.source&&null!==D.source&&void 0!==D.eventId&&null!==D.eventId))return B.ULS.sendTraceTag(537155426,0,50,`[RichApiRecorder]: received a valid but unhandled event: source: ${D.source}; eventId: ${D.eventId}.`),!0;B.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");return!1})}}Object(l.a)(Zh,"DefaultRichApiRequestExecutedEvent",jb,[]);class bj extends jb{constructor(){super()}get eventId(){return 216}Fc(){this.rc(1022)}}
Object(l.a)(bj,"TablelAltTextEditedEvent",jb,[]);class tj extends jb{constructor(){super()}get eventId(){return 217}Fc(){this.rc(263)}}Object(l.a)(tj,"FloatingObjectZOrderChangedEvent",jb,[]);var $h=a(1274);class Fj extends jb{constructor(){super()}get eventId(){return 192}Fc(){this.rc(507)}oh(){this.Wd(D=>Object(O.a)($h.a,D)?!0:!1)}}Object(l.a)(Fj,"VisualPropertySetEvent",jb,[]);class cj extends Dc{constructor(){super(219,[510])}}Object(l.a)(cj,"ChartSeriesDeletedEvent",Dc,[]);class Mh extends jb{get eventId(){return 220}Fc(){this.rc(1027)}}
Object(l.a)(Mh,"ChartDataChangedEvent",jb,[]);class yj extends Dc{constructor(){super(221,[512])}}Object(l.a)(yj,"ChartSeriesDataChangedEvent",Dc,[]);class cg extends jb{constructor(){super()}get eventId(){return 225}Fc(){this.rc(269)}}Object(l.a)(cg,"FloatingObjectPutFloatingImageInCellEvent",jb,[]);class mf extends jb{constructor(){super()}get eventId(){return 224}Fc(){this.rc(268)}}Object(l.a)(mf,"ImageInCellConvertToFloatingObjectEvent",jb,[]);class Vg{constructor(D){this.C$a=null;this.$=D}get macroRecorderEvents(){this.C$a||
(this.C$a=[new th,new Hg,new gg,new sh,new Cd,new td,new ca,new bb,new Hb,new Me,new ff,new yc,new bi,new Vi,new Di,new vh,new $i,new xj,new Ej,new hh,new di,new ci,new gj,new Uh,new ui,new Ri,new li,new Qh,new Rg,new Fi,new ni,new Xi,new sj,new Gi,new ph,new Kh,new Ig,new Ci,new ii,new xg,new qc,new Id,new fh,new ve,new Yh,new xi,new jg,new cb,new Tg,new Ra,new Pi,new jj,new oh,new Dh,new ob,new Q,new rd,new jf,new Lf,new W,new ei,new Qd,new We,new ki,new ji,new eg,new Fh,new Lh,new Rd,new Vb,new Cb,
new ne,new Bd,new Qb,new qb,new qa,new Md,new ya,new Sd,new Ce,new id,new Ue,new gd,new wi,new Si,new Zi,new Wi,new bh,new ch,new V,new Ea,new pb,new zb,new Ec,new ef,new Qf,new Jb,new ij,new sd,new Ef,new te,new Ag,new Ah,new nc,new $d,new Dg,new Wg,new Ug,new Zf,new qh,new nh,new Ja,new v,new jh,new ka,new Wh,new Ei,new mh,new fi,new Zd,new aj,new R,new vc,new bc,new Re,new rg,new xe,new od,new Ch,new Td,new mc,new zh,new zc,new fg,new yf,new Df,new pg,new tg,new md,new Qg,new pf,new Xc,new uh,
new we,new pe,new vf,new Ve,new kf,new Ae,new Zg,new qe,new hd,new Uf,new If,new Kg,new Tf,new Nf,new wg,new gh,new Of,new ie,new Ua,new ab,new Pg,new hg,new lg,new Qi,new si,new hj,new Jh,new qg,new ri,new Oi,new Rh,new hi,new Ni,new Eh,new Gh,new ac,new lh,new oi,new ah,new bj,new tj,new Fj,new cj,new yj,new Mh,new mf,new cg,new Eg],M.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&this.rqk());return this.C$a}LKf(D,ma){let vb=this.MKf(D,this.macroRecorderEvents,ma);vb||
(vb=this.MKf(D,Vg.D5i(),ma),!vb&&this.g2f(D,Vg.Knf,ma)&&(vb=Vg.Knf));return vb}MKf(D,ma,vb){const lc=[];for(const Nc of ma)this.g2f(D,Nc,vb)&&lc.push(Nc);return 1===lc.length?lc[0]:1<lc.length?Vg.tKi(lc):null}g2f(D,ma,vb){const lc=Vg.L8j(D,ma);return vb?lc&&Vg.ajl(D,ma):lc}rqk(){var D=[];for(const ma of this.C$a){let vb=!1;for(const lc of ma.featureGates)if(!M.EwaSettings.Ra(lc)){D.push(ma);vb=!0;break}if(!vb)for(const lc of ma.GAf)if(!M.EwaSettings.getBooleanFeatureGate(lc,!1)){D.push(ma);break}}for(const ma of D)D=
this.C$a.indexOf(ma),-1<D&&this.C$a.splice(D,1)}static D5i(){Vg.I4d||(Vg.I4d=[new Ee,new Mc]);return Vg.I4d}static L8j(D,ma){return ma.operations.includes(D.operation)}static ajl(D,ma){ma=ma.b4c;if(!ma.length)return!0;let vb=!0;for(const lc of ma)if(!lc(D.payload)){vb=!1;break}return vb}static tKi(D){let ma=D[0];for(const vb of D)vb.b4c.length>ma.b4c.length&&(ma=vb);return ma}}Vg.I4d=null;Vg.Knf=new Zh;Object(l.a)(Vg,"MacroRecorderEventList",null,[]);var Hh=a(714);class Nh{constructor(){this.H7c=
null}get ENh(){this.H7c||(this.H7c=[12,11]);return this.H7c}Imj(D){return this.ENh.includes(D.operation)}C$k(D){const ma=[],vb=D.payload;for(const lc of vb.batchedOperations)ma.push(new Hh.a(D.operation,lc));return ma}}Object(l.a)(Nh,"MacroRecorderBatchedEventList",null,[]);var Yi=a(118);class pi{equals(D,ma){return D===ma}getHashCode(D){return D}wta(D){return D}}Object(l.a)(pi,"UserOperationNameComparer",null,[111,112]);class rf{static J5i(){rf.dd||(rf.dd=new Dd.a(new pi),rf.dd.add(507),rf.dd.add(10),
rf.dd.add(576),rf.dd.add(563),rf.dd.add(564),rf.dd.add(565),rf.dd.add(566),rf.dd.add(567),rf.dd.add(568),rf.dd.add(569),rf.dd.add(570),rf.dd.add(571),rf.dd.add(572),rf.dd.add(573),rf.dd.add(574),rf.dd.add(575),rf.dd.add(501),rf.dd.add(520),rf.dd.add(1),rf.dd.add(1002),rf.dd.add(129),rf.dd.add(198),rf.dd.add(500),rf.dd.add(519),rf.dd.add(538),rf.dd.add(1E3),rf.dd.add(1003),rf.dd.add(144),rf.dd.add(502),rf.dd.add(505),rf.dd.add(179),rf.dd.add(205),rf.dd.add(134),rf.dd.add(230),rf.dd.add(103),rf.dd.add(110),
rf.dd.add(112),rf.dd.add(113),rf.dd.add(124),rf.dd.add(133),rf.dd.add(154),rf.dd.add(162),rf.dd.add(168),rf.dd.add(172),rf.dd.add(201),rf.dd.add(222),rf.dd.add(227),rf.dd.add(513),rf.dd.add(534),rf.dd.add(539),rf.dd.add(545),rf.dd.add(600),rf.dd.add(547),rf.dd.add(555),rf.dd.add(558),rf.dd.add(562),rf.dd.add(585),rf.dd.add(1001),rf.dd.add(1005),rf.dd.add(1008),rf.dd.add(1010),rf.dd.add(1011),rf.dd.add(1012),rf.dd.add(1018),rf.dd.add(252),rf.dd.add(253),rf.dd.add(258),rf.dd.add(101),rf.dd.add(102),
rf.dd.add(108),rf.dd.add(257),rf.dd.add(119),rf.dd.add(120),rf.dd.add(123),rf.dd.add(126),rf.dd.add(127),rf.dd.add(130),rf.dd.add(140),rf.dd.add(159),rf.dd.add(160),rf.dd.add(165),rf.dd.add(166),rf.dd.add(167),rf.dd.add(169),rf.dd.add(189),rf.dd.add(223),rf.dd.add(214),rf.dd.add(228),rf.dd.add(233),rf.dd.add(247),rf.dd.add(504),rf.dd.add(511),rf.dd.add(512),rf.dd.add(525),rf.dd.add(533),rf.dd.add(537),rf.dd.add(542),rf.dd.add(544),rf.dd.add(548),rf.dd.add(550),rf.dd.add(551),rf.dd.add(552),rf.dd.add(554),
rf.dd.add(577),rf.dd.add(584),rf.dd.add(586),rf.dd.add(587),rf.dd.add(588),rf.dd.add(592),rf.dd.add(1009),rf.dd.add(612),rf.dd.add(1016),rf.dd.add(1017),rf.dd.add(1024),rf.dd.add(260),rf.dd.add(597),rf.dd.add(264),rf.dd.add(596),rf.dd.add(254),rf.dd.add(262),rf.dd.add(1030),rf.dd.add(1031),rf.dd.add(606),rf.dd.add(1045),rf.dd.add(1037),rf.dd.add(615),rf.dd.add(1046),rf.dd.add(1047),rf.dd.add(1048));return rf.dd}}rf.dd=null;Object(l.a)(rf,"MacroRecorderUnrecognizedEventList",null,[]);let kj=class{constructor(D,
ma,vb){ma=void 0===ma?new Vg(D):ma;vb=void 0===vb?new Nh:vb;this.PNb=null;this.QIj=(lc,Nc)=>{this.ZUg()&&this.cHd(Nc)};this.xdg=ma;this.wdg=vb;this.$=D;this.$.A2&&this.$.kFh(this.QIj)}init(D){this.$.A2&&(D?this.PNb=D:B.ULS.sendTraceTag(537155424,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))}cHd(D){if(this.ZUg())try{if(this.wdg.Imj(D)){var ma=this.wdg.C$k(D);for(const vb of ma)this.TBf(vb)}else this.TBf(D)}catch(vb){ma=`MacroRecorderEventHandler.FireMacroRecorderEvent: Error: ${Yi.a(D.operation)}, Exception: ${vb.stack}`;
B.ULS.sendTraceTag(537155423,0,10,ma);try{this.ZBi(D)}catch(lc){}}}TBf(D){var ma=this.xdg.LKf(D,!0);ma?(this.PNb(ma.eventId,cc.a.Nc(D.payload)),B.ULS.sendTraceTag(537155422,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${ma.eventId}`)):(ma=this.xdg.LKf(D,!1))?B.ULS.sendTraceTag(537155421,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${ma.eventId}, but failed to match filters`):rf.J5i().contains(D.operation)||(this.PNb(0,cc.a.Nc(D.operation)),D=`MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: ${Yi.a(D.operation)}`,
B.ULS.sendTraceTag(537155420,0,50,D))}ZBi(D){this.PNb(222,cc.a.Nc(D.operation))}ZUg(){return this.$.bva&&this.PNb&&this.$.oda?!0:!1}};kj=Object(u.__decorate)([Object(L.d)(K.MacroRecorderEventsHandlerService),Object(u.__param)(0,Object(K.EwaControlService)())],kj);Object(l.a)(kj,"MacroRecorderEventHandler",null,[320]);const Hi=Object(Ha.b)("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory"),lj=Object(Ha.c)(Hi);Object(L.b)(K.NewDocumentFromStreamOperationService,{we:"singleton"})(async D=>
{await L.a.resolve(K.NewAndOpenUXService,D);return Object(Ha.a)(lj)});var Ii=a(2);class Gj{}Object(l.a)(Gj,"Selection",null,[]);var Yg=a(1300),yi=a(41);class mj{}Object(l.a)(mj,"SmartLookupApplicationInterface",null,[]);class Hj{}Object(l.a)(Hj,"ApplicationProperties",null,[]);class Ji{}Object(l.a)(Ji,"EnterpriseUserInfo",null,[]);class zj{}Object(l.a)(zj,"FeatureGates",null,[]);class Oh{constructor(D,ma,vb){this.j6k=9E5;this.l6k=3E5;this.e4d=null;this.fcg="";this.b4d=0;this.gLb=Date.now;this.Xva=
D;this.Xnb=ma;(void 0===vb||vb)&&this.PJd()}h1i(){var D=void 0===D?!0:D;const ma=this.gLb();if(ma<this.b4d+this.j6k)return ma>this.b4d+this.l6k&&this.PJd(),this.fcg;D&&this.PJd();return""}PJd(){this.e4d=this.e4d||new Promise(D=>{this.i1i().then(ma=>{this.fcg=ma;this.b4d=this.gLb();this.e4d=null;D(ma)})})}i1i(){return this.Xnb&&this.Xnb.length?new Promise(D=>{this.Xva.ey("SmartLookup",this.Xnb).then(ma=>{ma.IsSuccess?ma.Token||(D(""),B.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):
(B.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+ma.ErrorCode+": "+ma.ErrorMessage),D(""));D(ma.Token)}).catch(ma=>{ma=Ic.c(ma);B.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+ma);D("")})}):(B.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))}}Object(l.a)(Oh,"SmartLookupAuthenticationManager",null,[359]);class nj{static WPi(){switch(Object(C.a)(String,
t.AFrameworkApplication.tc.AudienceGroup)||""){case "Dogfood":if(t.AFrameworkApplication.ea){let D=t.AFrameworkApplication.ea.Qa("UserPrincipalName");D=Cc.a.wm(D);const ma=t.AFrameworkApplication.ea.Dj("SmartLookupINTEnabledForSKITeam")?t.AFrameworkApplication.ea.Yk("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(ma,D)?"INT":"EDOG"}return"EDOG";default:return"PROD"}}static B0i(){switch(t.AFrameworkApplication.ea.ka("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":t.AFrameworkApplication.ea.ka("IntentSvcEnableProdSourceLocationOverride")?
"PROD":t.AFrameworkApplication.ea.ka("IntentSvcEnableIntSourceLocationOverride")?"INT":nj.WPi()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}}}Object(l.a)(nj,"Utils",null,[]);var Ki=a(78),qi=a(666);class P{constructor(D){B.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");
this.Pcg=t.AFrameworkApplication.ea.ka("IsTellMeUpSellEnterpriseEnabled");this.dIj=t.AFrameworkApplication.ea.Qa("SmartLookupApprovedOriginPattern");this.Xnb=t.AFrameworkApplication.ea.Qa("SmartLookupShredderServiceEndpoint");this.LIj=Ki.a.tQ(t.AFrameworkApplication.ea.Qa("AppCatalogUrl")||"");this.Wnb=new zj;this.Wnb.EnableAllTabV2=!0;this.Wnb.EnableIntentService=!0;this.Wnb.EnableInDocumentSearch=t.AFrameworkApplication.ea.ka("SmartLookupEnableInDocumentSearch");this.Wnb.EnableLocalSearch=t.AFrameworkApplication.ea.ka("SmartLookupEnableLocalSearch");
this.Wnb.IntentServiceEndpoint=nj.B0i();this.GIj=new Oh(D,this.Xnb)}get approvedOriginPattern(){return this.dIj}GJi(){return Promise.resolve(this.HJi())}HJi(){const D=new Hj;D.anid="";D.applicationVersion=t.AFrameworkApplication.buildVersion;D.appCorrelationId=mb.a.create().toString();D.themePlatform=P.$jl;D.lcid=t.AFrameworkApplication.lcid;D.launchUtcTime=(new Date).toUTCString();D.featureGates=this.Wnb;var ma=qi.a.kN(t.AFrameworkApplication.lcid);ma=ma?ma.name:null;D.market=this.qzc(ma);D.uiLanguage=
ma;D.sessionId=t.AFrameworkApplication.userSessionId;D.themeId=0;D.parentalControl=P.u$j;const vb=new Ji;vb.CountryCode=this.qzc(ma);vb.ServiceEndpoint=this.Xnb;vb.IsGoLocal=!1;vb.IsEnabled=this.Pcg;vb.IsEnterpriseEnabled=this.Pcg;vb.TenantRoot=this.LIj;D.enterpriseUserInfo=vb;D.accessToken=this.GIj.h1i();return D}qzc(D){D=D.split("-");return D[D.length-1]}}P.$jl="web";P.u$j="yes";Object(l.a)(P,"SmartLookupManager",null,[338]);var ua;let Xa=ua=class extends yi.a{constructor(D){super();this.$=D;this.isFirstLaunch=
!1}td(){return!1}gd(){return!1}Rc(D,ma){D=M.EwaSettings.Ra(127);return-983891024===ma.command&&D}executeCommand(D,ma){D=E.TaskExtensions.kl();-983891024===ma.command&&this.fBj();return D}fBj(){var D=new P(null);const ma={};var vb=w.f(this.$).Ob(null).originalText;vb=Object(Ii.a)(new Gj,{neighborhood:vb,mentionStart:0,mentionLength:vb?vb.length:0});const lc=Object(Ii.a)(new mj,{selection:vb,entryPoint:0});D.GJi().then(wd=>{wd.applicationName=ua.appName;wd.isFirstLaunch=this.isFirstLaunch;wd.themeId=
5;ma[ua.rZk]=JSON.stringify(lc);ma[ua.lJh]=JSON.stringify(wd);this.isFirstLaunch=!1});D=new Je.a("ExcelOnline","Web","en-Us");vb=new Wd.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");const Nc=new je.a;Nc.xe[Yg.a.Qm]=Jc.a.instance.ia(1810);Nc.xe[Yg.a.taskPaneWidth]=350;Nc.xe[Yg.a.sourceLocationOverrideResourceId]="WAC.PROD.URL";Nc.$q=ma;ad.a.instance.Jva(vb,"Taskpane","SmartLookupSDXTaskpane",D,Nc)}};Xa.lJh="AppProperties";Xa.appName="Excel";Xa.rZk="SmartLookupApplicationInterface";
Xa=ua=Object(u.__decorate)([Object(L.d)(K.SmartLookupCommandHandlerService),Object(u.__param)(0,Object(K.EwaControlService)()),Object(u.__param)(1,Object(I.a)())],Xa);Object(l.a)(Xa,"SmartLookupCommandHandler",yi.a,[29]);var Pb=a(1305),hc=a(1261),Qc=a(254),vd=a(437);class Nd{constructor(){this.$jh=new Qc.a}get Doc(){return this.$jh}NWi(D){B.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",D);const ma=new Qc.a;for(const vb of this.Doc)for(const lc of vb.MZb)lc.id===D&&ma.add(lc);return ma}j2e(D){this.Doc.add(D)}kqk(D){for(const ma of this.Doc)if(ma.V5e===
D.V5e){this.Doc.remove(ma);break}}static ahi(D,ma,vb){vb=void 0===vb?null:vb;D=Nd.pNi(D);0<D.length&&(Nd.zXc(D,!1),vb&&vb(ma,D))}static pNi(D){const ma=[];if(D&&D.MZb&&0<D.MZb.count)for(const vb of D.MZb)if(vb.controls&&0<vb.controls.count)for(const lc of vb.controls)if(lc.menuItems&&0<lc.menuItems.count)for(const Nc of lc.menuItems)Array.add(ma,Nc.id);return ma}static zXc(D,ma){if(D.length){var vb=[];for(const lc of D)vb.push(appChrome.actions.updateControlEnabledDisabledState(lc,ma));appChrome.api.dispatch(vb)}}}
Object(l.a)(Nd,"ContextMenuExtensibilityCache",null,[168,169]);var ke=a(1678),Be=a(1148),Ze=a(1052);class of{Lbb(D,ma){ma=void 0===ma?null:ma;if(D=Ze.a.EOb(D)){appChrome.addInApi.dispatchActionsToInstallAddIn(D,ma);for(const vb of D.tabs)if(vb.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(D,()=>{});break}}}jie(D){(D=Ze.a.EOb(D))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(D)}ERg(){}static ihi(D,ma,vb){vb=void 0===vb?null:vb;D=of.s_i(D);0<D.length&&(of.zXc(D,!1),vb&&vb(ma,
D))}static s_i(D){const ma=[];if(D&&(D=D.q3,D.px&&0<D.px.count))for(const vb of D.px)if(vb.groups&&0<vb.groups.length)for(const lc of vb.groups)if(lc.controls&&0<lc.controls.length)for(const Nc of lc.controls)Array.add(ma,Nc.id);return ma}static zXc(D){if(D.length){var ma=[];for(const vb of D)ma.push(appChrome.actions.updateControlEnabledDisabledState(vb,!0));appChrome.api.dispatch(ma)}}}Object(l.a)(of,"OneLineRibbonExtensibilityManager",null,[181]);var Xf=a(1196);class bg{constructor(){this.DHe=
this.n6c=null;this.AWf=(D,ma)=>{let vb=null;vb=()=>{D.getIsUpgrading()?window.setTimeout(vb,1E3):D.getUpgradingFailed()?of.zXc(ma,!0):t.AFrameworkApplication.ua.ax()};window.setTimeout(vb,1E3)}}get mmd(){return this.n6c||(this.n6c=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set mmd(D){this.n6c=D}get dNh(){return this.DHe||(this.DHe=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromSolutionIdRuntimeId(D,ma){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromSolutionIdRuntimeId(D,
ma)}kQd(D,ma,vb,lc,Nc,wd,Yd){wd=void 0===wd?null:wd;Yd=void 0===Yd?null:Yd;var ee;B.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",D);t.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:8642303_FixedTelemetryForAddinCommandsActionEnabled")&&(D={["solutionId"]:null===(ee=globalThis.Telemetry)||void 0===ee?void 0:ee.PrivacyRules.GetPrivacyCompliantId(Nc.ownerAddinInfo.solutionId,Nc.ownerAddinInfo.storeType,Nc.ownerAddinInfo.assetId,null,null,Nc.ownerAddinInfo.storeId)},uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.HandleAddinCommandsAction",
dataFields:lf.a.Eh(D)}));if((ma=ma.Qsa(Nc.ownerAddinInfo.storeType,Nc.ownerAddinInfo.solutionId))&&ma.pG&&!ma.pG.getIsUpgrading())if(ee=null,0<ma.pG.getNotificationParams().length&&(ee=this.xaf(ma.pG.getNotificationParams()[0]))&&2147758681===ee.errorCode&&(ma.isUpgraded=!0),2!==ma.pG.getStatus()&&(1!==ma.pG.getStatus()||ee&&2147758681===ee.errorCode))ee&&this.TVg(ma,ee,Yd);else try{vb.setOwnerAddinEToken(ma.pG.getEToken()),Nc.action(vb,lc.Jla),wd&&wd()}catch(ae){B.ULS.sendTraceTag(17425949,220,10,
String.format("HandleAddinCommandsAction error info : {0}.",t.AFrameworkApplication.ea.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?ae.stack:ae.message)),Xf.a.Ese(Object(Ba.a)("InternalError")+" "+Object(Ba.a)("InternalError_Directive"))}}TVg(D,ma,vb){vb=void 0===vb?null:vb;const lc=D.pG;if(1===lc.getNotificationParams().length||ma.dDc){const Nc=ma.fra,wd=ma.fsa;ma.fra=()=>{lc.removeFirstNotification();if(0<lc.getNotificationParams().length){const Yd=this.xaf(lc.getNotificationParams()[0]);
this.TVg(D,Yd)}2147758681===ma.errorCode&&(of.ihi(D.Hq,lc,this.AWf),Nd.ahi(D.MJb,lc,this.AWf));Nc&&Nc()};ma.fsa=()=>{wd&&wd();vb&&vb()};Xf.a.Fse(ma)}}xaf(D){const ma=new Be.a;ma.MYa=D.infoType;ma.id=D.id;ma.title=D.title;ma.description=D.description;ma.buttonText=D.buttonTxt;ma.fra=D.buttonCallback;ma.dDc=D.highPriority;ma.fsa=D.dismissCallback;ma.errorCode=D.errorCode;ma.xVf=D.iframeNotificationUrl;return ma}}Object(l.a)(bg,"AddinCommandsActionHandler",null,[173]);var Mg=a(182),Jg=a(936),F=a(7),
va=a(977),lb=a(932);class sc{constructor(D,ma){this.Ya=D;this.$2h=ma}nHi(D){if(void 0!==D&&null!==D&&D===F.a.hif)D="ContextMenuCell";else return null;const ma=this.Ya.uc();this.zGi(ma,D);return ma}zGi(D,ma){ma=this.$2h.NWi(ma);for(const vb of ma){ma=vb.controls;for(const lc of ma)this.iGi(D,lc)}}iGi(D,ma){var vb=ma.N0[va.a.id];const lc=ma.N0[va.a.l8a],Nc=ma.N0[va.a.p8a];let wd="Image16by16",Yd=ma.N0[va.a.m8a];lb.c(Nc)&&(wd="None");0<ma.menuItems.count?(vb=this.Ya.iu(vb,vb,lc,798637440),vb.e6b(wd,
Nc,null),this.lHi(vb.menu,ma),D.buttons.push(vb)):D.buttons.push(this.Ya.yUa(vb,lc,Yd,Nc,wd,null,!1))}lHi(D,ma){const vb=this.Ya.uc();for(const lc of ma.menuItems){ma=lc.awa[va.a.id];const Nc=lc.awa[va.a.l8a],wd=lc.awa[va.a.p8a];let Yd="Image16by16";const ee=lc.awa[va.a.m8a];lb.c(wd)&&(Yd="None");ma=this.Ya.yUa(ma,Nc,ee,wd,Yd,null,!1);vb.buttons.push(ma)}D.Zb.push(vb)}}Object(l.a)(sc,"AddInCommandsContextMenuExtensibilityHandler",null,[362]);var Yc=a(1061);class jd{constructor(){this.Yi=null;this.visible=
!1}}Object(l.a)(jd,"AddinStatusCommandValues",null,[]);class Ad{static shk(D){const ma=new jd;ma.Yi=D.SCa;ma.visible=ma.Yi?!0:!1;return ma}static rZc(D,ma,vb,lc,Nc){const wd=document.getElementById(vb);wd?Ad.TVk(D,ma,wd,lc,Nc):B.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",vb))}static TVk(D,ma,vb,lc,Nc){vb?D.SCa===Object(Ba.a)("ErrorLoadingAddInsTitle")?Xf.a.qUk(ma,vb,lc,Nc):D.SCa===Object(Ba.a)("InstallingCustomFunctionsErrorStatusBarMsg")&&Xf.a.$Vk(ma,vb,Object(Ba.a)("InstallingCustomFunctionsErrorStatusBarMsg"),
Object(Ba.a)("InstallingCustomFunctionsErrorCalloutMsg")):B.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}Object(l.a)(Ad,"AddinCommandsStatusHandler",null,[]);var Kd=a(258),ye=a(87);class Ne extends yi.a{constructor(D,ma){super();this.agaveCommandManager=this.statusBarManager=null;this.oj=!1;this.$ef=()=>{this.zG&&this.zG.Fef()};this.vQf=()=>{this.raiseEvent("LAC")};this.yd=(vb,lc)=>{!vb.yc&&Kd.b(lc)&&this.statusBarManager&&(this.statusBarManager.OI(this),
this.statusBarManager=null)};this.zG=ma;this.$=D;this.oj=z.a.oj(this.$);this.oj||(this.bve=D.Oc+"OfficeAddinLabel-Medium14");this.$.ra.Vc(29,vb=>{this.statusBarManager=vb;vb.FJ(this)});this.$.fa.Vk(this.yd);this.zG.BCh(this.vQf);this.$.ra.Vc(206,vb=>{this.agaveCommandManager=vb;vb.oEh(this.$ef)})}Js(D){this.addHandler("LAC",D)}vs(D){this.removeHandler("LAC",D)}vq(D,ma){if("QueryAddinLabel"!==D)return!1;D=!1;this.oj?(D=appChrome.selectors.getControlLabel(ye.a.e8d),D=!(!D&&!this.zG.SCa)&&D!==this.zG.SCa):
D=ma[Yc.a.LabelText]!==this.zG.SCa;D&&(D=Ad.shk(this.zG),ma[Yc.a.LabelText]=D.Yi,ma[Yc.a.Visible]=D.visible,window.setTimeout(()=>{this.rZc()},0));return!0}Wj(){return!0}rZc(){if(this.$){if(this.oj){const D=document.querySelector('button[data-unique-id="StatusBar-OfficeAddinLabel"]');D&&(this.bve=D.getElementsByClassName("ms-Button-label")[0].id)}this.bve&&Ad.rZc(this.zG,this.$.domElement,this.bve,Jc.a.instance.ia(333),Jc.a.instance.ia(334))}}dispose(){this.$.fa.Qk(this.yd);this.zG.Hrk(this.vQf);
this.agaveCommandManager&&(this.agaveCommandManager.itk(this.$ef),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.OI(this),this.statusBarManager=null);this.zG=this.$=null;super.dispose()}}Object(l.a)(Ne,"AddinCommandsStatusBarManager",yi.a,[360,217]);var hf=a(663);class sf{constructor(){this.Ver=1}}Object(l.a)(sf,"CacheItem",null,[]);class Gf{constructor(D){this.uBa=D}ti(D){const ma=this.uBa.getItem(D);if(ma){let vb=new sf;try{vb=Sys.Serialization.JavaScriptSerializer.deserialize(ma,
!0)}catch(lc){return this.uBa.removeItem(D),null}return vb.Data?vb.Data:vb.data}return null}asb(D){this.uBa.removeItem(D)}}Object(l.a)(Gf,"AppsDataCacheManager",null,[185]);class Yf{constructor(){new Gf(e.a.instance)}HPg(D,ma){D=Pa.a.IIf()+D;e.a.instance.setItem(D,ma.toString())}wYi(){var D=Pa.a.tMf();B.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",D);D=e.a.instance.getItem(D);return Ic.a(D)}ULk(D){const ma=Pa.a.tMf();B.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",ma);e.a.instance.setItem(ma,
Ic.c(D))}IPg(D){const ma=Pa.a.uMf();B.ULS.sendTraceTag(507364892,306,50,"get cache key:{0}",ma);e.a.instance.setItem(ma,Ic.c(Array.from(D)))}IJd(){var D=Pa.a.uMf();B.ULS.sendTraceTag(507364891,306,50,"get cache key:{0}",D);D=e.a.instance.getItem(D);D=Ic.a(D);return Array.isArray(D)?new Set(D):new Set}Usj(){return!!e.a.instance.localStorage}static get instance(){Yf.Wa||(Yf.Wa=new Yf);return Yf.Wa}}Yf.Wa=null;Object(l.a)(Yf,"AddInCommandsCacheManager",null,[157]);var Ng=a(104);class dh{constructor(D){this.ya=
D}get host(){var D;const ma=null===(D=this.ya)||void 0===D?void 0:D.Qa("Application");return"Word"===ma||"Excel"===ma||"PowerPoint"===ma?ma:""}get a3(){return!!this.ya&&this.ya.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MosForWXPEnabled",!1)}get VGh(){return!!this.ya&&this.ya.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutOpenCloseTelemetryEnabled",!1)}get p5e(){return!!this.ya&&this.ya.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinContextMenuShareButtonEnabled",
!1)}get K9j(){return this.ya?this.ya.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizableFRECategoryNames",""):""}get l5b(){return!!this.ya&&this.ya.isChangeGateEnabled("OfficeVSO:8668457_SeeMoreSeeLessEnabled")}get Raa(){return!!this.ya&&this.ya.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchBoxEnabled",!1)}get UGh(){return!!this.ya&&this.ya.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutNoSearchResultsV2Enabled",!1)}get L9j(){return this.ya?this.ya.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizableSearchQueryParameters",
""):""}get jli(){return!!this.ya&&this.ya.isChangeGateEnabled("embeddedCitationsV2Enabled")}get F$e(){return!!this.ya&&"Dev Box"===this.ya.Qa("StatusBarEnvironmentNameToUse")}get r5e(){return!!this.ya&&this.ya.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutCDNotificationUpdateEnabled",!1)}get K9b(){return!!this.ya&&this.ya.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TriggerBackstageUIFixEnabeld",!1)}get MHd(){return!!this.ya&&this.ya.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutSurveyEnabled",
!1)}get DDi(){return this.ya?this.ya.getIntFeatureGate("Microsoft.Office.SharedOnline.FlyoutTriggerSurveyTimeMs",25E3):25E3}get ADi(){return!!this.ya&&this.ya.getStringFeatureGate("Microsoft.Office.SharedOnline.FlyoutStoreFooterLabelString","")}get jOb(){return!!this.ya&&this.ya.getBooleanFeatureGate("Microsoft.Office.SharedOnline.flyoutStoreExpEnabled",!1)}get zDi(){return!!this.ya&&this.ya.getBooleanFeatureGate("Microsoft.Office.SharedOnline.flyoutStoreExpUseLabelsEnabled",!1)}get xDi(){return!!this.ya&&
this.ya.getBooleanFeatureGate("Microsoft.Office.SharedOnline.flyoutStoreExpSearchWithAppSourceEnabled",!1)}get yDi(){return!!this.ya&&this.ya.getBooleanFeatureGate("Microsoft.Office.SharedOnline.flyoutStoreExpUXRenderCheckerEnabled",!1)}get wDi(){return!!this.ya&&this.ya.getBooleanFeatureGate("Microsoft.Office.SharedOnline.flyoutStoreExpRetryIfNotReady",!1)}get qGd(){return!!this.ya&&this.ya.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FeedbackButtonForSearchEnabled",!1)}get vDi(){return!!this.ya&&
this.ya.getBooleanFeatureGate("Microsoft.Office.SharedOnline.flyoutStoreAdvancedUXEnabled",!1)}get tDi(){return!!this.ya&&this.ya.isChangeGateEnabled("OfficeVSO:8933655_FlyoutSearchDataLocaleFixEnabled")}}Object(l.a)(dh,"AppsFlyoutGeneratorContext",null,[]);var vg=a(1074);class zi{constructor(D){this.zP=D;this.L1d=new Set;this.XGe=[];this.opd=Yf.instance;this.zPc=()=>this.Emc=Ng.a("getTheme")?appChrome.api.getTheme():null;this.context=new dh(t.AFrameworkApplication.ea);this.Emc=Ng.a("getTheme")?appChrome.api.getTheme():
null;Ng.a("registerOnThemeChangeCallback")&&appChrome.api.registerOnThemeChangeCallback(this.zPc)}get sSa(){return this.XGe}set sSa(D){this.XGe=D}QJj(D){if(this.context.r5e&&this.sSa.includes(D)){this.L1d.add(D);var ma=this.opd.IJd();ma.has(D)&&(ma.delete(D),this.opd.IPg(ma))}}ZIi(D){const ma=this.zP.getUpgradedAddinsOfOmex(),vb=this.opd.IJd(),lc=D.filter(Nc=>vb.has(Nc)&&!this.L1d.has(Nc));D=D.filter(Nc=>ma.has(Nc)&&!this.L1d.has(Nc));return{IHh:lc,pgl:D}}addNotification(D){if(this.context.r5e){var {IHh:ma,
pgl:vb}=this.ZIi(D.map(lc=>lc.solutionId));this.sSa=[];Object(vg.f)(vb,this.Emc);this.sSa.push(...vb);Object(vg.e)(ma,this.Emc);this.sSa.push(...ma);0!==this.sSa.length&&(D={["Upgraded"]:vb.map(lc=>Object(vg.b)(this.zP.nQ(lc))),["AdminInstalled"]:ma.map(lc=>Object(vg.b)(this.zP.nQ(lc)))},this.Etb(D,"ShowNotificationAddins"))}}Etb(D,ma){uf.a.sendTelemetryEvent({name:`Office.Extensibility.Host.${ma}`,dataFields:lf.a.Eh(D)})}}Object(l.a)(zi,"AppsInFlyoutNotificationManager",null,[]);var Vh=a(1146),Ij=
a(1490),rk=a(131),Bj=a(686),hl=a(144);class Tj{constructor(){this.acb=null}setErrorMessageForAddin(D,ma){this.acb||(this.acb={});this.acb[D]=ma}cQi(D){return this.acb&&D in this.acb?this.acb[D]:null}}Object(l.a)(Tj,"AddinCommandsErrorManager",null,[]);var uj=a(112);class Oj{constructor(){this.sv=this.fxa=0;this.qpd=null;this.URc=this.t1c=0;this.uAa=this.zad=this.F6c=null}get Tlc(){this.F6c||(this.F6c=new Qc.a);return this.F6c}get NId(){this.zad||(this.zad=new Qc.a);return this.zad}get nUa(){this.uAa||
(this.uAa=new Qc.a);return this.uAa}}Object(l.a)(Oj,"AddinCommandsListLoaderContext",null,[]);class ik{constructor(D,ma){this.entitlement=D;this.metadata=ma}p9b(){var D=this.entitlement;const ma={};ma.solutionId=D.solutionId;ma.version=D.version;ma.storeType=D.storeType;ma.storeId=D.storeId;ma.assetId=D.assetId;ma.assetStoreId=D.assetStoreId;ma.targetType=D.targetType;ma.requireConsent=D.requireConsent||!1;ma.isAddinCommands=!0;ma.addinCommandsActionType=0;ma.targetType=this.targetType;return ma}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==
this.entitlement.targetType?this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}Object(l.a)(ik,"AddinEntitlementEx",null,[]);var jk=a(295),wh=a(386);class oj{}Object(l.a)(oj,"AppsForOfficeEntitlementQueryInfo",null,[]);class Bg{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(l.a)(Bg,"AddinAbstract",null,
[]);class T extends Sys.EventArgs{constructor(){super();this.Hq=this.km=null}}Object(l.a)(T,"InsertionParamEventArgs",Sys.EventArgs,[]);class gb{constructor(D,ma,vb,lc){this.BXa=Nc=>{let wd=!1,Yd=null;try{if(0<Nc.data.responseData.length){const ee=Object(C.a)(Object,Ic.a(Nc.data.responseData)),ae=ee?ee[this.appName]:null;ae&&(Yd=Object(C.a)(Object,Ic.a(ae.toString())))}wd=!0}catch(ee){this.Kta(null)}wd&&this.BAb&&this.BAb(Yd)};this.Kta=Nc=>{this.xAb&&this.xAb(Nc?Nc.data:null)};this.axa=Nc=>{this.NCb&&
this.NCb(Nc?Nc.data:null)};this.J4b=t.AFrameworkApplication.ea.Qa("RoamingServiceHandlerWebServiceBase");this.appName=D;this.BAb=ma;this.xAb=vb;this.NCb=void 0===lc?null:lc}JFd(D){this.ayi(D,this.BXa,this.Kta)}ayi(D,ma,vb){const lc=new Sys.StringBuilder(this.J4b);lc.append("RoamingServiceHandler.ashx?action=");lc.append("getAddinTeachingCalloutSettings");lc.append("&");lc.append(this.JNd(D));lc.append("&");lc.append(t.AFrameworkApplication.Uh);t.AFrameworkApplication.od.Wn(lc.toString(),1,null,null,
!0,2,ma,vb,null)}vwc(D){this.eyi(D)}eyi(D){var ma=new Sys.StringBuilder(this.J4b);ma.append("RoamingServiceHandler.ashx?action=");ma.append("saveAddinTeachingCalloutSettings");ma.append("&");ma.append(t.AFrameworkApplication.Uh);ma=ma.toString();D=Ic.c(D);t.AFrameworkApplication.od.Wn(ma,2,D,null,!0,4,null,this.axa,null)}JNd(D){const ma=new Sys.StringBuilder("requestedsettings=");for(let vb=0;vb<D.count;vb++)ma.append(D.pa(vb)),vb<D.count-1&&ma.append(";");return ma.toString()}}Object(l.a)(gb,"AddinTeachingUIRoamingRequestHandler",
null,[]);class Lb extends Sys.EventArgs{constructor(D){super();this.solutionId=D.solutionId;this.assetId=D.assetId;this.storeType=D.storeType;this.storeId=D.storeId;this.assetStoreId=D.assetStoreId;this.targetType=D.targetType;this.width=D.width;this.height=D.height;this.displayName=D.displayName;this.version=D.version}}Object(l.a)(Lb,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);class fd{constructor(D){this.dcb=this.km=null;this.DVc=!1;this.uAa=this.vbc=this.gma=this.Cf=this.J6c=
this.atb=null;this.X0j=()=>{const ma=new jk.ScriptSharpLegacyMap;this.dcb&&this.dcb.tabs&&!this.dcb.tabs[0].isOfficeTab&&ma.ga("SDX.FeatureFlags","NonOfficeTab");this.Dnb(fd.Mca(this.km),"ClickOnLaunch",ma);this.BLc();this.dcb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.dcb,()=>{const vb=new T;vb.km=this.km;this.ub.raiseEvent(Pa.a.I8f,vb)}):B.ULS.sendTraceTag(508625355,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")};this.TUj=()=>{this.Dnb(fd.Mca(this.km),
"ClickOnClose");this.BLc()};this.HWj=()=>{this.Dnb(fd.Mca(this.km),"ClickOnDismiss");this.BLc()};this.Ujg=ma=>{if(ma&&(ma=ma.detail)&&ma.id&&this.$mj(ma.id)){const vb=(ma.action||"").toLowerCase();if(ma.success&&"opened"===vb)this.Dnb(fd.Mca(this.km),"CampaignLaunched"),B.ULS.sendTraceTag(508625354,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.BLc(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",this.Ujg,!0);else{let lc;try{lc=JSON.stringify(ma),
B.ULS.sendTraceTag(508625353,220,15,"Campaign launch failure. Event:"+lc)}catch(Nc){lc="id : "+ma.id+" telemetryEventName: "+ma.telemetryEventName,B.ULS.sendTraceTag(508625352,220,50,"Error serializing campaign event. "+lc+" Error: "+(Nc?Nc.toString():""))}}}};this.BXa=ma=>{ma?this.eTk(ma)?(B.ULS.sendTraceTag(508625348,220,50,"should show teaching UI"),this.atb="AddinHasShown"in ma&&ma.AddinHasShown?ma.AddinHasShown.toString():null,this.phf()):(B.ULS.sendTraceTag(508625347,220,50,"Not Show TeachingUI this time"),
this.gma(this.RCa,null)):(B.ULS.sendTraceTag(508625349,220,50,"userSettings is null"),this.atb=null,this.phf())};this.Kta=ma=>{B.ULS.sendTraceTag(508625346,220,10,"GET data from Roaming Settings Service with status: {0}, fallback",ma?ma.httpStatus:-1);this.gma(this.RCa,null)};this.axa=ma=>{B.ULS.sendTraceTag(508625345,220,10,"failed to POST data to Roaming Settings Service with status: {0}",ma?ma.httpStatus:-1)};this.ub=D}get appName(){return t.AFrameworkApplication.ea.Qa("WebAppShortName")}get aGb(){this.J6c||
(this.J6c=new gb(this.appName,this.BXa,this.Kta,this.axa));return this.J6c}get RCa(){this.vbc||(this.vbc=new Qc.a);return this.vbc}set RCa(D){this.vbc=D}get nUa(){this.uAa||(this.uAa=new Qc.a);return this.uAa}set nUa(D){this.uAa=D}vzh(D,ma){window.addEventListener?(this.km=D,this.dcb=ma,window.addEventListener("LaunchAddinTaskpane",this.X0j,!0),window.addEventListener("DismissCallout",this.HWj,!0),window.addEventListener("CloseCallout",this.TUj,!0),window.addEventListener("FGWebSurfaceEvent",this.Ujg,
!0)):B.ULS.sendTraceTag(508625357,220,15,"AddEventListenerForTeachingCallout failed to get Window")}I1c(D,ma,vb,lc){this.Cf=D;this.RCa=ma;this.nUa=vb;this.gma=lc;B.ULS.sendTraceTag(508625356,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",ma?ma.count.toString():"null",vb?vb.count.toString():"null");0<this.RCa.count||0<this.nUa.count?(D=new Qc.a,D.add(this.appName),this.aGb.JFd(D)):this.gma(new Qc.a,null)}$mj(D){D=Cc.a.wm(D);return-1!==D.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||
-1!==D.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==D.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==D.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==D.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==D.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}XVc(D){if(this.appName){const ma={},vb={};vb.LastTeachingUIShowTime=(new Date).toUTCString();vb.AddinHasShown=D;ma[this.appName]=Ic.c(vb);this.aGb.vwc(ma);B.ULS.sendTraceTag(508625351,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else B.ULS.sendTraceTag(508625350,
220,10,"Fail to save roaming service since AppName is null")}BLc(){if(!this.DVc){const D=window.g_roamingAddinList;D&&(this.XVc(D),this.DVc=!0)}}phf(){const D=this.$fi();0===D.targetType?(D.solutionId?this.mhk(D):this.Dnb(null,"NoSolutionId"),this.H8g(D),this.gma(this.RCa,null)):this.gma(this.RCa,D);B.ULS.sendTraceTag(508625344,220,50,"Show teaching callout for: {0}",D.addinId)}mhk(D){const ma=new oj;ma.callbackFunc=vb=>{if(vb.errorCode){this.Dnb(D.solutionId,"FailToGetAppDetails");var lc=window.g_roamingAddinList;
lc&&this.XVc(lc)}else if(vb.value)for(lc of vb.value)if(vb=lc[1],vb===D.solutionId){const Nc={};Nc.solutionId=vb;Nc.assetId=lc[5];Nc.storeType=lc[12];Nc.storeId=lc[11];Nc.assetStoreId=lc[6];Nc.targetType=lc[3];Nc.width=lc[7];Nc.height=lc[8];Nc.displayName=lc[0];Nc.version=lc[4];B.ULS.sendTraceTag(508625315,220,50,"Raise a teaching callout event for content addin: {0}.",D.solutionId);lc=new Lb(Nc);this.ub.raiseEvent(Pa.a.YVg,lc);break}};ma.storeType=OSF.StoreTypeEnum.PrivateCatalog;ma.fromInsertDialog=
!1;ma.refresh=!1;this.Cf.queryEntitlementDetails(ma)}eTk(D){if("LastTeachingUIShowTime"in D){if(D=+new Date-+new Date(D.LastTeachingUIShowTime.toString()),D<t.AFrameworkApplication.ea.CK("AddinShowTeachingUIIntervalInMS",864E5))return B.ULS.sendTraceTag(508625314,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",D),!1}else B.ULS.sendTraceTag(508625313,220,50,"userSetting has no date key");return!0}$fi(){let D=new wh.a(new Bg,0),ma=new wh.a(new Bg,0),vb=0,lc=0,Nc=0;var wd=new Qc.a;
for(var Yd of this.RCa)wd.add(Yd);for(const ee of this.nUa)wd.add(ee);for(const ee of wd)if(!("excatalog"!==ee.storeType||lb.c(ee.installTimeInMS)||!ee.installTimeInMS||ee.installTimeInMS<=t.AFrameworkApplication.ea.CK("DateTimeInMSForNewAddin",16409952E5))){wd=fd.qFf(ee);if(this.atb&&(Yd=this.atb.split(","),0<Yd.length&&Array.contains(Yd,wd))){Nc++;B.ULS.sendTraceTag(508625312,220,50,"This addin has shown teaching UI before");continue}wd.startsWith("private_")?(D=fd.pKf(ee,D),lc++):(ma=fd.pKf(ee,
ma),vb++)}B.ULS.sendTraceTag(508625311,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",lc,vb,Nc);return 0<ma.value?ma.key:0<D.value?D.key:Object.assign(new Bg,{addinId:null,targetType:-1,solutionId:null})}Dnb(D,ma,vb){vb=void 0===vb?null:vb;D={["AppTeachingUICalloutAction"]:ma,["SDX.Id"]:D,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};if(vb)for(const lc of vb.keys)D[lc]=vb.pa(lc);uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:lf.a.Eh(D)})}H8g(D){D&&(window.g_roamingAddinList=this.atb?this.atb+","+D.addinId:D.addinId)}static Mca(D){return Telemetry.PrivacyRules.GetPrivacyCompliantId(D.solutionId,D.storeType,D.assetId,null,null,D.storeId)}static pKf(D,ma){return ma.value<D.installTimeInMS?new wh.a(Object.assign(new Bg,{addinId:fd.qFf(D),targetType:D.targetType,solutionId:D.solutionId}),D.installTimeInMS):ma}static qFf(D){return Telemetry.PrivacyRules.IsPrivateAddin(D.storeType,D.assetId,null,null,D.storeId)?"private_"+
D.installTimeInMS:D.solutionId}}Object(l.a)(fd,"PrivateCatalogTeachingCalloutHandler",null,[]);const Ld=()=>{const D=Ki.a.W1(window.location.href.toLowerCase(),"wdomexsrctype");return!!D&&"4"===D},ce=()=>Ki.a.W1(window.location.href.toLowerCase(),"wdtpl"),me=()=>{const D=Ki.a.W1(window.location.href.toLowerCase(),"wdomexsrctype");return!!D&&"1"===D};var Oe=a(1076);class Ye extends Sys.EventArgs{constructor(D){super();this.properties=D}}Object(l.a)(Ye,"AddinCommandsEntitlementsRetrievedEventArgs",
Sys.EventArgs,[]);class Ff{constructor(D,ma,vb){this.ub=new uj.a;this.context=new Oj;this.Fkd=null;this.E0j=(lc,Nc,wd,Yd)=>{lc?(lc=new ik(wd.targetData,Yd),Nc&&this.context.Tlc.add(lc),10===this.context.fxa&&(this.context.NId.add(lc),0===lc.targetType&&this.context.nUa.add(lc))):(Nc=wd.targetData,B.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Nc.solutionId,Nc.storeType,Nc.assetId,null,null,Nc.storeId),Nc.storeType));
this.x8d()};this.contextActivationMgr=D;this.SGh=ma;this.$bb=vb;this.appName=t.AFrameworkApplication.ea.Qa("WebAppShortName")}get Dvb(){this.Fkd||(this.Fkd=new fd(this.ub));return this.Fkd}zCh(D){this.ub.addHandler(Pa.a.n5e,D)}lGh(D){this.ub.addHandler(Pa.a.YVg,D)}T9k(D){null!==D&&(this.context.fxa=D[Pa.a.k6],this.context.sv=D[Pa.a.j0],this.context.t1c=this.context.URc=0,D=Pa.a.pSa in D?D[Pa.a.pSa]:0,-1!==this.context.fxa&&0!==this.context.sv&&(this.context.qpd=this.SGh.createAddinDataProvider(Oe.a(this.context.fxa),
this.contextActivationMgr),this.context.qpd?this.context.qpd.getEntitlementsAsync(this.contextActivationMgr.Jla,!0,D,ma=>{this.i1j(ma)}):B.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.fxa)))}i1j(D){if(D&&0<D.length){this.context.t1c=D.length;const vb=ce();for(let lc=0;lc<D.length;lc++){const Nc=D[lc];if(me()&&Nc&&Nc.storeType&&"omex"===Nc.storeType.toLowerCase()&&Nc.assetId&&vb&&Nc.assetId.toLowerCase()===vb.toLowerCase()){var ma={["SDX_AppInstallOrigin"]:"DeeplinkUser",
["SDX_Id"]:Ff.Mca(Nc)};uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppInstall",dataFields:lf.a.Eh(ma)})}!Nc||1!==Nc.targetType&&-1!==Nc.targetType?this.x8d():(ma={},t.AFrameworkApplication.ea.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(ma.solutionId=Nc.solutionId,ma.version=Nc.version):(ma.marketplaceId=Nc.solutionId,ma.marketplaceVersion=Nc.version),ma.storeType=Nc.storeType,ma.storeId=Nc.storeId,ma.targetData=Nc,this.contextActivationMgr.isAddinCommandsExAsync(ma,
this.E0j))}}else this.x8d()}x8d(){var D;(D=this.context).URc=D.URc+1;this.context.URc>=this.context.t1c&&(this.$bb.HPg(this.context.fxa,!1),0<this.context.t1c&&10===this.context.fxa&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(D=!1,Ld()&&(D=this.aFj(this.context.NId)),this.nEj(this.context.NId),D?this.gma(this.ohf(this.context.Tlc)):this.Dvb.I1c(this.contextActivationMgr,this.context.Tlc,this.context.nUa,(ma,vb)=>{const lc=new Qc.a;for(const Nc of ma)ma=Nc.p9b(),
vb&&vb.solutionId===Nc.solutionId&&(ma.showCallout=!0,this.Dvb.H8g(vb)),lc.add(ma);this.gma(lc)})):this.gma(this.ohf(this.context.Tlc)))}ohf(D){const ma=new Qc.a;if(D)for(const vb of D)ma.add(vb.p9b());return ma}gma(D){D&&D.count||Gc.a.vNa(Pa.a.ppd,"false",this.context.fxa);D={["ack2"]:D};D[Pa.a.k6]=this.context.fxa;D[Pa.a.j0]=this.context.sv;this.ub.raiseEvent(Pa.a.n5e,new Ye(D),this)}aFj(D){let ma=!1;if(D&&1>D.count)return ma;const vb=ce();if(!vb)return ma;for(const lc of D)if(lc.storeId&&lc.storeId.toLowerCase()===
vb.toLowerCase()||lc.assetId&&lc.assetId.toLowerCase()===vb.toLowerCase())D={["SDX_Id"]:Ff.sMf(lc),["SDX_TargetType"]:lb.c(lc.targetType)?"":lc.targetType.toString()},uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:lf.a.Eh(D)}),ma=!0;return ma}nEj(D){if(!(D&&1>D.count))if(this.$bb.Usj()){var ma=this.$bb.wYi();ma?(D=this.wHf(D,ma),B.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(D=this.wHf(D,null),B.ULS.sendTraceTag(527523847,
306,50,"no data from cache"));this.$bb.ULk(D)}else B.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}wHf(D,ma){const vb={};let lc=!1;const Nc=new Set;for(const wd of D)if(D=Ff.sMf(wd))!ma||D in ma||(Nc.add(wd.solutionId),this.Pz(wd,D),B.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===D.toLowerCase()?lc||(lc=!0,vb[D]=null):vb[D]=null;t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutCDNotificationUpdateEnabled",
!1)&&(ma=this.$bb.IJd(),this.$bb.IPg(new Set([...Nc,...ma])));return vb}Pz(D,ma){var vb=D.installTimeInMS?(new Date(D.installTimeInMS)).toISOString():"";vb={["SDX.Id"]:ma,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:lb.c(D.targetType)?"":D.targetType.toString(),["SDX.AdminDeploymentTime"]:vb};uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppInstall",dataFields:lf.a.Eh(vb)});1===D.targetType&&uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppPinning",dataFields:lf.a.Eh({["SDX.Id"]:ma,
["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"})})}static Mca(D){return Telemetry.PrivacyRules.GetPrivacyCompliantId(D.solutionId,D.storeType,D.assetId,null,null,D.storeId)}static sMf(D){return Telemetry.PrivacyRules.GetPrivacyCompliantId(D.solutionId,D.storeType,D.assetId,null,null,D.storeId)}}Object(l.a)(Ff,"AddInCommandsListLoader",null,[]);class ag{constructor(D){this.Frh=D}get Jla(){return this.Frh}insertOsfControl(D){return this.Jla.insertOsfControl(D)}getManifestInvaildErrorString(){return this.Jla.getManifestInvaildErrorString()}isAddinCommandsAsync(D,
ma){this.Jla.isAddinCommandsAsync(D,ma)}isAddinCommandsExAsync(D,ma){this.Jla.isAddinCommandsExAsync(D,ma)}ownerAddinControlRecreated(D,ma){this.Jla.ownerAddinControlRecreated(D,ma)}queryEntitlementDetails(D){this.Jla.queryEntitlementDetails(D)}}Object(l.a)(ag,"ContextActivationMgrWrapper",null,[170]);class ug{createAddinDataProvider(D,ma){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(D,ma.Jla)}static get instance(){ug.Wa||(ug.Wa=new ug);return ug.Wa}}ug.Wa=null;Object(l.a)(ug,
"OSFAddinDataProviderFactory",null,[159]);class Xg{constructor(D,ma,vb,lc,Nc,wd){this.sv=D;this.km=ma;this.I9=vb;this.displayName=Nc;this.G7f=wd}}Object(l.a)(Xg,"PostLaunchAddinCommandsParameters",null,[]);class rh{constructor(D){this.Udd=null;this.iOe=D}get j0a(){return this.Udd}Lbb(D,ma){this.iOe.Lbb(D,void 0===ma?null:ma);this.Udd=D}jie(D){this.iOe.jie(D)}ERg(D){this.Udd=D}}Object(l.a)(rh,"RibbonExtensibilityManagerWithChangeDetection",null,[181]);var Xh=a(1114),ck=a(113);class vi{static IJf(D){const ma=
new Qc.a;if(vi.$gf)for(var vb of vi.$gf)ma.add(vb);vb=null;switch(D){case "Workbook":vb=vi.Nkl;break;case "Document":vb=vi.bji;break;case "Presentation":vb=vi.Wek}if(vb)for(const lc of vb)ma.add(lc);return ma}}vi.$gf=["PrimaryCommandSurface","ContextMenu"];vi.Nkl=null;vi.bji=null;vi.Wek=null;Object(l.a)(vi,"ExtensionPointType",null,[]);class Mj{constructor(D){this.MTe=null;if(lb.c(D))throw B.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");
this.Eih=D}get MZb(){return this.MTe||(this.MTe=new Qc.a)}get V5e(){return this.Eih}}Object(l.a)(Mj,"ContextMenuExtensibility",null,[172]);class dk{constructor(D,ma,vb){ma=void 0===ma?null:ma;vb=void 0===vb?0:vb;if(lb.c(D))throw B.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.yrh=D;this.Puh=ma;this.nnh=vb}get q3(){return this.yrh}get startedNode(){return this.Puh}get mIi(){return this.nnh}}
Object(l.a)(dk,"RibbonExtensibility",null,[205]);class Nj{constructor(D){this.omh=D.entitlement}get entitlement(){return this.omh}createActionContext(D,ma){D={};D.ownerAddinInfo=this.entitlement;D.action=ma;return D}}Object(l.a)(Nj,"AddInCommandsContextProvider",null,[]);class Li{constructor(D,ma,vb){this.WGe=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=D;this.eventBuilder=ma;this.contextMenuBuilder=vb}get addinInfo(){return this.WGe}N6h(D){return new Nj(D)}createActionBuilder(D,
ma){return OfficeExt.DefaultControlActionBinder.createActionBuilder(D,ma.entitlement,ma.manifest)}startApplyAddin(D){this.WGe=D;const ma=this.N6h(D);this.actionBuilder=this.createActionBuilder(ma,D)}endApplyAddin(){}oJd(D,ma,vb){vb=void 0===vb?0:vb;return this.ribbonBuilder.px&&0<this.ribbonBuilder.px.count?new dk(this.BHi(D,ma),this.addinInfo.startedNode,vb):null}wEf(){var D=void 0===D?null:D;if(this.contextMenuBuilder.RLc&&0<this.contextMenuBuilder.RLc.count){D||(D=this.addinInfo.entitlement.solutionId);
D=new Mj(D);for(const ma of this.contextMenuBuilder.RLc)D.MZb.add(ma);return D}return null}BHi(D,ma){return this.ribbonBuilder.px&&0<this.ribbonBuilder.px.count?new Ze.a(this.ribbonBuilder.px,D,ma):null}}Object(l.a)(Li,"AddinCommandsBuilder",null,[]);class Aj{constructor(D,ma,vb,lc,Nc,wd,Yd){this.z6a=new ck.a;this.sv=D;this.Cf=ma;this.Pr=vb;this.ribbonManager=lc;this.qX=Nc;this.zG=wd;this.yqa=Yd;this.YV=t.AFrameworkApplication.ua.KE}mXb(D,ma,vb,lc,Nc,wd,Yd){const ee=(ae,he,De,Se)=>{Nc(ae,he,De,Se);
const qf=Xh.a[this.sv]+he.assetId;let kg;(()=>{let $f=this.z6a.Od(qf);({value:kg}=$f);return $f})().returnValue&&(kg.stop(),kg=null,this.z6a.remove(qf))};if(0!==this.sv&&D){B.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",D.count);4===this.sv&&(B.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",lc)),this.zYh(D,lc),wd());for(const ae of D)if(D=ae,B.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.Pr.kI,Telemetry.PrivacyRules.GetPrivacyCompliantId(D.solutionId,
D.ownerAddinStoreType||D.storeType,D.assetId,null,null,D.storeId))),this.L$g(D))if(Yd&&D.requireConsent)Yd(D,he=>{try{if(this.YV){const Se=Xh.a[this.sv]+he.solutionId,qf=this.YV.Uc("ComponentAttach",Se);this.z6a.ga(Se,qf)}const De=this.zG.Qsa(he.storeType,he.solutionId);6!==this.sv&&(De&&(this.Npc(De),De.pG.purge(!1)),this.Cf.insertOsfControl(this.C1b(he,ma,vb,ee)),De&&this.Cf.ownerAddinControlRecreated(he.solutionId,he.storeType))}catch(De){B.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",
this.Pr.kI,Telemetry.PrivacyRules.GetPrivacyCompliantId(he.solutionId,he.ownerAddinStoreType||he.storeType,he.assetId,null,null,he.storeId),he.version,he.storeType,he.storeId,De.message)),ee(!1,he,null,null)}});else try{if(this.YV){const De=Xh.a[this.sv]+D.solutionId,Se=this.YV.Uc("ComponentAttach",De);this.z6a.ga(De,Se)}const he=this.zG.Qsa(D.storeType,D.solutionId);3!==t.AFrameworkApplication.ua.Ab.gi&&1!==t.AFrameworkApplication.ua.Ab.gi&&2!==t.AFrameworkApplication.ua.Ab.gi||3!==this.sv||"excatalog"===
D.storeType||!he||he.isUpgraded?6!==this.sv&&(he&&(this.Npc(he),he.pG.purge(!1)),this.Cf.insertOsfControl(this.C1b(D,ma,vb,ee)),he&&this.Cf.ownerAddinControlRecreated(D.solutionId,D.storeType)):(this.ribbonManager.ERg(he.Hq),ee(!0,D,null,he.displayName))}catch(he){B.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.Pr.kI,Telemetry.PrivacyRules.GetPrivacyCompliantId(D.solutionId,D.ownerAddinStoreType||
D.storeType,D.assetId,null,null,D.storeId),D.version,D.storeType,D.storeId,he.message)),ee(!1,D,null,null)}else ee(!1,D,null,null)}}eBj(D,ma,vb,lc,Nc,wd){const Yd=(ee,ae,he,De)=>{wd(ee,ae,he,De);const Se=Xh.a[this.sv]+ae.solutionId;let qf;(()=>{let kg=this.z6a.Od(Se);({value:qf}=kg);return kg})().returnValue&&(qf.stop(),qf=null,this.z6a.remove(Se))};if(6===this.sv&&D)if(B.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.Pr.kI,Telemetry.PrivacyRules.GetPrivacyCompliantId(D.solutionId,
D.ownerAddinStoreType||D.storeType,D.assetId,null,null,D.storeId))),this.L$g(D))try{if(this.YV){const ae=Xh.a[this.sv]+D.solutionId,he=this.YV.Uc("ComponentAttach",ae);this.z6a.ga(ae,he)}const ee=this.zG.Qsa(D.storeType,D.solutionId);ee||Yd(!1,D,null,null);t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Ab.delayInstallAddInIsEnabled?this.eFf(D,ma,lc,Nc,vb,ae=>{Yd(ae,D,vb,ee.displayName)}):(this.eFf(D,ma,lc,Nc,vb),Yd(!0,D,vb,ee.displayName))}catch(ee){B.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",
this.Pr.kI,Telemetry.PrivacyRules.GetPrivacyCompliantId(D.solutionId,D.ownerAddinStoreType||D.storeType,D.assetId,null,null,D.storeId),D.version,D.storeType,D.storeId,ee.message)),Yd(!1,D,null,null)}else Yd(!1,D,null,null)}LSj(D,ma,vb,lc,Nc,wd){if(wd)if(wd._isAddinCommandsManifest(this.Pr.kI))try{t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Ab.delayInstallAddInIsEnabled?this.dFf(D,ma,vb,Nc,wd,Yd=>{lc(Yd,D,wd,wd.getDefaultDisplayName())}):(this.dFf(D,ma,vb,Nc,wd),lc(!0,D,wd,wd.getDefaultDisplayName()))}catch(Yd){B.ULS.sendTraceTag(17586257,
220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.Pr.kI,Telemetry.PrivacyRules.GetPrivacyCompliantId(D.solutionId,D.ownerAddinStoreType||D.storeType,D.assetId,null,null,D.storeId),D.version,D.storeType,D.storeId,Yd.message)),lc(!1,D,wd,wd.getDefaultDisplayName())}else B.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",
this.Pr.kI,Telemetry.PrivacyRules.GetPrivacyCompliantId(D.solutionId,D.ownerAddinStoreType||D.storeType,D.assetId,null,null,D.storeId),D.version,D.storeType,D.storeId)),lc(!1,D,null,null);else B.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.Pr.kI,Telemetry.PrivacyRules.GetPrivacyCompliantId(D.solutionId,D.ownerAddinStoreType||D.storeType,D.assetId,null,null,D.storeId),D.version,D.storeType,D.storeId)),
lc(!1,D,null,null)}C1b(D,ma,vb,lc){const Nc={},wd=document.createElement("div");wd.setAttribute("visible","false");Nc.div=wd;Nc.id=D.solutionId;Nc.solutionId=D.solutionId;Nc.version=D.version;Nc.storeType=D.storeType;Nc.storeId=D.storeId;Nc.assetId=D.assetId;Nc.assetStoreId=D.assetStoreId;Nc.isvirtualOsfControl=!0;Nc.virtualOsfControlActivationCallback=(Yd,ee)=>{const ae=this.zG.Qsa(D.storeType,D.solutionId);ae&&(ae.isUpgraded&&(D.isUpgraded=!0),this.Npc(ae));this.LSj(D,ma,vb,lc,Yd,ee)};Nc.reason=
3===this.sv?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return Nc}dFf(D,ma,vb,lc,Nc,wd){wd=void 0===wd?null:wd;const Yd={};Yd.solutionId=lc.getSolutionId();Yd.version=lc.getVersion();Yd.storeType=lc.getStoreType();Yd.storeId=lc.getStoreId();Yd.assetId=lc.getAssetId();Yd.assetStoreId=lc.getAssetStoreId();Yd.targetType=lc.getOsfControlType();let ee=null,ae=null;if(t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1))ee=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Pr.kI,this.Pr.formFactor)).parseExtensions(Yd,Nc,this.yqa),ae=vi.IJf(this.Pr.kI);else try{ee=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Pr.kI,this.Pr.formFactor)).parseExtensions(Yd,Nc,this.yqa),ae=vi.IJf(this.Pr.kI)}catch(De){throw B.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+De.message),De;}if(ae&&0<ae.count){if(t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1)){var he=ma(D);ma=vb(D);vb=!!t.AFrameworkApplication.ea&&t.AFrameworkApplication.ea.ka("AddinCommandsMultipleCustomTabsEnabled");he=new Li(he,null,ma);for(const De of ae)he.commandSurface=De,ee.apply(he,this.yqa,vb)}else try{const De=ma(D),Se=vb(D),qf=!!t.AFrameworkApplication.ea&&t.AFrameworkApplication.ea.ka("AddinCommandsMultipleCustomTabsEnabled");he=new Li(De,null,Se);for(const kg of ae)he.commandSurface=kg,ee.apply(he,this.yqa,qf)}catch(De){throw B.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+
De.message),De;}if(OSF.OUtil.checkFlight(14))try{const De=he.oJd(D.solutionId,Nc.getDefaultDisplayName()),Se=he.wEf();De&&this.ribbonManager.Lbb(De,wd);Se&&this.qX.j2e(Se);this.zG.R2e(lc,De,Se,Nc.getDefaultDisplayName());B.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",Nc.getDefaultDisplayName())}catch(De){throw OfficeExt.DevConsole.log(De),B.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+De.message),De;}else try{const De=he.oJd(D.solutionId,Nc.getDefaultDisplayName()),
Se=he.wEf();De&&this.ribbonManager.Lbb(De);Se&&this.qX.j2e(Se);this.zG.R2e(lc,De,Se,Nc.getDefaultDisplayName());B.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",Nc.getDefaultDisplayName())}catch(De){throw B.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+De.message),De;}}}eFf(D,ma,vb,lc,Nc,wd){wd=void 0===wd?null:wd;const Yd={};Yd.solutionId=D.solutionId;Yd.version=D.version;Yd.storeType=D.storeType;Yd.storeId=D.storeId;Yd.assetId=D.assetId;Yd.assetStoreId=
D.assetStoreId;Yd.targetType=D.targetType;const ee=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.Pr.kI,this.Pr.formFactor);try{const ae=ma.getManifest(),he=ee.parse(Yd,ae,Nc,this.yqa,ma.getSharedRuntimeId(),ma),De=vb(D),Se=lc(D),qf=new Li(De,null,Se);qf.commandSurface="PrimaryCommandSurface";he.apply(qf,this.yqa,!0);if(qf.ribbonBuilder.px&&0<qf.ribbonBuilder.px.count){const kg=qf.oJd(D.solutionId,ma.getManifest().getDefaultDisplayName(),1);t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",
!1)?this.ribbonManager.Lbb(kg,wd):kg&&this.ribbonManager.Lbb(kg,wd);this.zG.qAh(ma,kg,Nc,ma.getManifest().getDefaultDisplayName());B.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",ma.getManifest().getDefaultDisplayName())}}catch(ae){B.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",ma.getManifest().getDefaultDisplayName(),ae.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(ae)}}Npc(D){D.Hq&&this.ribbonManager.jie(D.Hq);
D.MJb&&this.qX.kqk(D.MJb);this.zG.Spk(D.pG.getStoreType(),D.pG.getSolutionId())}zYh(D,ma){ma=Oe.a(ma);for(const vb of this.zG.ykb){if(vb.pG.getStoreType()!==ma)continue;let lc=!0;for(const Nc of D){const wd=Nc;if(wd&&vb.s4f(wd.storeType,wd.solutionId)){lc=!1;break}}lc&&(this.Npc(vb),vb.pG.purge(!1))}}L$g(D){return!!D&&!!D.solutionId&&!!D.version&&!!D.storeType&&!!D.storeId}}Object(l.a)(Aj,"AddInCommandsIntegration",null,[]);class dj{constructor(D,ma,vb,lc,Nc,wd,Yd,ee){ee=void 0===ee?null:ee;this.xb=
new uj.a;this.H6c=D;this.Zkh=ma;this.xl=vb;this.o_e=lc;this.kab=Nc;this.rih=wd;this.wbc=Yd;this.prh=ee}ACh(D){this.xb.addHandler(Pa.a.o5e,D)}GEh(D){this.xb.addHandler(Pa.a.I8f,D)}kGh(D){this.xb.addHandler(Pa.a.ZVg,D)}GCh(D){this.xb.addHandler(Pa.a.Hrd,D)}DBj(D,ma,vb){const lc=vb[Pa.a.YFb],Nc=void 0===vb[Pa.a.j0]?0:vb[Pa.a.j0];if(lc&&0!==Nc)if(0>=lc.count&&4!==Nc)this.iyg(new Xg(Nc,null,null,ma,null,!0));else{var wd=lc.count,Yd=new rh(new of),ee=void 0===vb[Pa.a.k6]?-1:vb[Pa.a.k6],ae=new Aj(Nc,this.xl,
this.H6c,Yd,this.Zkh,this.kab,this.wbc),he=$f=>this.o_e.$Qh($f.solutionId,this.wbc,this.H6c,D),De=$f=>this.o_e.jQh($f.solutionId),Se=($f,Cg,sg)=>{wd--;sg=new Xg(Nc,Cg,Yd,ma,sg,0>=wd);if($f&&Cg)this.iyg(sg);else{if(3===Nc||Cg&&Cg.isUpgraded)$f="",Cg&&($f=Telemetry.PrivacyRules.GetPrivacyCompliantId(Cg.solutionId,Cg.ownerAddinStoreType||Cg.storeType,Cg.assetId,null,null,Cg.storeId)),uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppInstall",dataFields:lf.a.Eh({["SDX_AppInstallOrigin"]:"User",
["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:$f})});this.hyg(sg)}wd||t.AFrameworkApplication.ua.ax()},qf=($f,Cg,sg,ng)=>{Se($f,Cg,ng)},kg=()=>{this.M7d();0>=lc.count&&4===Nc&&this.kab.Woe()};6===Nc?(ee=vb[Pa.a.uVa],vb=vb[Pa.a.vVa],ae.eBj(lc.pa(0),ee,vb,he,De,($f,Cg,sg,ng)=>{Se($f,Cg,ng)})):ae.mXb(lc,he,De,ee,qf,kg,this.prh)}else uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppInstall",dataFields:lf.a.Eh({["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",
["SDX_Id"]:""})}),B.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.H6c.kI)),this.hyg(new Xg(Nc,null,null,ma,null,!0))}hyg(D){this.M7d(D);this.bXg(!1,D)}iyg(D){const ma=D.km;let vb=null;null!==ma&&(vb=ma.storeType,vb=vb.toLowerCase());if(D&&"omex"===vb&&(3===D.sv||ma.isUpgraded)){var lc={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(ma.solutionId,ma.ownerAddinStoreType||
ma.storeType,ma.assetId,null,null,ma.storeId)};uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppInstall",dataFields:lf.a.Eh(lc)})}this.M7d(D);lc=me()&&"omex"===vb&&!!D.I9&&!!ma.solutionId&&2===D.sv&&ma.solutionId.toLowerCase()===ce().toLowerCase();var Nc="excatalog"===vb&&3===D.sv;if("omex"===vb&&D.I9&&(3===D.sv&&"hardcodedpreinstall"!==vb||ma.isUpgraded)||lc||Nc)lc=new T,lc.km=ma,lc.Hq=D.I9.j0a,this.xb.raiseEvent(Pa.a.Hrd,lc);lc=Ld();Nc=ce();lc&&ma&&"excatalog"===ma.storeType&&D.I9&&5===
D.sv&&Nc&&(ma.storeId&&ma.storeId.toLowerCase()===Nc.toLowerCase()||ma.assetId&&ma.assetId.toLowerCase()===Nc.toLowerCase())&&(lc=new T,lc.km=ma,lc.Hq=D.I9.j0a,this.xb.raiseEvent(Pa.a.Hrd,lc),B.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event."));ma&&(Yf.instance.HPg(Oe.b(vb),!0),"uploadfiledevcatalog"===vb&&(lc=this.rih.createAddinDataProvider(vb,this.xl))&&lc.localCacheAddinCommands(this.xl.Jla,ma.solutionId,ma.version,ma.storeId),Gc.a.vNa(Pa.a.ppd,"true",Oe.b(vb)));
this.bXg(!0,D)}bXg(D,ma){D?ma.I9&&5===ma.sv&&ma.I9.j0a&&void 0!==ma.km.showCallout&&null!==ma.km.showCallout&&ma.km.showCallout?((new fd(this.xb)).vzh(ma.km,Ze.a.EOb(ma.I9.j0a)),D=new T,D.Hq=ma.I9.j0a,D.km=ma.km,this.xb.raiseEvent(Pa.a.ZVg,D)):3!==ma.sv?ma.G7f&&this.kab.Woe():ma.I9&&ma.I9.j0a&&"hardcodedpreinstall"!==ma.km.storeType&&Xf.a.sUk(ma.displayName,ma.I9.j0a,ma.km.isAutoLaunched):3===ma.sv?ma.km&&"uploadfiledevcatalog"===ma.km.storeType.toLowerCase()?(ma=this.wbc.cQi(ma.km.solutionId),Xf.a.Ese(ma?
ma:Object(Ba.a)("InternalError")+" "+Object(Ba.a)("InternalError_Directive"))):this.kab.QQg():ma.G7f&&this.kab.Woe()}M7d(D){var ma=(D=void 0===D?null:D)?D.km:null;const vb=new T;if(vb.km=ma){var lc=this.kab.Qsa(ma.storeType,ma.solutionId,6===D.sv?1:0);if(lc&&lc.Hq){vb.Hq=lc.Hq;var Nc=ce();Nc=me()&&!!ma.solutionId&&!!Nc&&ma.solutionId.toLowerCase()===Nc.toLowerCase()&&2===D.sv;if(3===D.sv&&"hardcodedpreinstall"!==ma.storeType||Nc)D="",lc.Hq.q3&&lc.Hq.q3.px&&(lc=lc.Hq.q3.px.pa(0))&&(D=lc.id),ma={["SDX_CommandPlacement"]:D,
["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(ma.solutionId,ma.ownerAddinStoreType||ma.storeType,ma.assetId,null,null,ma.storeId)},uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppPinning",dataFields:lf.a.Eh(ma)})}}this.xb.raiseEvent(Pa.a.o5e,vb)}}Object(l.a)(dj,"LaunchAddinCommandsHandler",null,[163]);class xh{}xh.l8a="Alt";xh.m8a="Command";xh.id="Id";xh.p8a="Image16by16";xh.cbc="LabelText";xh.r8a="Title";xh.GROUP=
"Group";xh.yEe="Groups";xh.Gxb="Controls";xh.button="Button";xh.qja="FlyoutAnchor";xh.LARGE="Large";xh.SMALL="Small";Object(l.a)(xh,"AddinDataNodeConstants",null,[]);var kk=a(285);a(677);var Fk=a(493);class Gk{constructor(D,ma){this.mQa=this.FJe=null;if(lb.c(D)||lb.c(ma))throw B.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");this.flh=ma;this._id=D;this.N0[xh.id]=this._id}get id(){return this._id||
""}get N0(){return this.FJe||(this.FJe={})}get controlType(){return this.flh||""}get menuItems(){return this.mQa||(this.mQa=new Qc.a)}}Object(l.a)(Gk,"ControlDefinition",null,[167]);class Hk{constructor(D){this.wSe=null;if(lb.c(D))throw B.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=D;this.awa[xh.id]=this._id}get awa(){return this.wSe||(this.wSe={})}get id(){return this._id||
""}}Object(l.a)(Hk,"MenuItemDefinition",null,[198]);class Ik{constructor(D){this.xAa=null;if(lb.c(D))throw B.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=D}get id(){return this._id}get controls(){return this.xAa||(this.xAa=new Qc.a)}}Object(l.a)(Ik,"OfficeMenuDefinition",null,[161]);var $g=a(26);class Hl{constructor(D,ma,vb){this.gP=this.e9a=null;this.Nfd=D;this.V8a=ma;this.v8a=
vb;this.Pqh=new Qc.a}get vMc(){return this.Nfd}get lJb(){return this.V8a}get lmd(){return this.v8a}addButton(D){B.ULS.sendTraceTag(17085952,220,50,"ContextMenu button actiontype: {0}.",D.actionType);this.gP=new Gk(this.wDa(D.id),xh.button);this.gP.N0[xh.cbc]=D.label;this.gP.N0[xh.l8a]=D.label;this.gP.N0[xh.p8a]=D.icon["16"];this.lHb(this.gP.N0[xh.id],D.action);this.cSa(this.gP.N0);this.e9a.controls.add(this.gP);this.gP=null}startBuildMenu(D){if(lb.c(this.e9a))this.e9a=new Ik(D.id);else{const ma=this.wDa(D.id);
this.gP=new Gk(ma,xh.qja);this.rdb(this.gP.N0,D);this.gP.N0[xh.p8a]=D.icon["16"];this.gP.N0[xh.m8a]=$g.a.alwaysEnabled}}addMenuItem(D){B.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",D.actionType);const ma=new Hk(this.wDa(D.id));this.rdb(ma.awa,D);D.icon&&(ma.awa[xh.p8a]=D.icon["16"]);this.lHb(ma.awa[xh.id],D.action);this.cSa(ma.awa);this.gP.menuItems.add(ma)}endBuildMenu(){lb.c(this.gP)?(this.RLc.add(this.e9a),this.e9a=null):(this.e9a.controls.add(this.gP),this.gP=null)}get RLc(){return this.Pqh}lHb(D,
ma){this.lmd.bindAction(D,ma)}cSa(D){this.lJb.cSa(D)}wDa(D){return this.vMc.$Wa(D)}rdb(D,ma){D[xh.cbc]=ma.label;D[xh.l8a]=ma.label}}Object(l.a)(Hl,"ContextMenuExtensibilityCreator",null,[184,179]);class Jk{constructor(D){this.iCb=D}get iZb(){return this.iCb}$Wa(D){return this.iZb+D}}Object(l.a)(Jk,"DefaultContextMenuNamingProvider",null,[183]);var sk=a(1512);class il{bindAction(D,ma){OfficeExt.DefaultControlActionBinder.bindAction(D,ma)}}Object(l.a)(il,"DefaultUIControlActionBinder",null,[182]);class jl{constructor(D){this.POa=
D}get command(){return this.POa}cSa(D){D[xh.m8a]=this.command}}Object(l.a)(jl,"DefaultUIControlCommandBinder",null,[180]);var Il=a(35);class tk{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(l.a)(tk,"AddInControl",null,[]);class uk{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}}Object(l.a)(uk,"AddInGroup",null,[]);class pj{constructor(){this.iconLocation=this.title=
this.id=null;this.enabled=!1;this.attributes=null}}Object(l.a)(pj,"AddInMenuItem",null,[]);class Kk{constructor(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(l.a)(Kk,"AddInTab",null,[]);class vk{constructor(D,ma,vb,lc,Nc,wd){this.tbc=new Qc.a;this.nzb=this.noa=this.f9a=null;this.Nfd=D;this.v8a=ma;this.V8a=vb;this.OB=lc;this.wbc=Nc;this.ILe=wd}get vMc(){return this.Nfd}get px(){return this.tbc}get lmd(){return this.v8a}get lJb(){return this.V8a}startBuildTab(D){const ma=
D.isOfficeTab?D.id:this.vMc.oOf(D.id),vb=D.isOfficeTab?null:D.label;this.f9a=Object.assign(new Kk,{id:ma,title:vb,isOfficeTab:D.isOfficeTab,visible:D.visible,groups:[],tabType:D.tabType,insertBefore:D.insertBefore,insertAfter:D.insertAfter,autoFocus:D.autoFocus})}startBuildGroup(D){const ma=this.wDa(D.id);this.noa=Object.assign(new uk,{id:ma,mlrId:D.mlrId,title:D.label,controls:[],groupType:0})}addNativeGroup(D){this.noa=Object.assign(new uk,{id:D.id,mlrId:D.mlrId,title:D.label,controls:[],groupType:1});
this.f9a.groups.push(this.noa)}addButton(D){const ma=this.wDa(D.id);ma&&(this.lHb(ma,D.action),B.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",D.actionType),D=Object.assign(new tk,{id:ma,title:D.label,iconLocation:this.bMd(D),enabled:D.enabled,controlType:0,attributes:this.rdb()}),this.ILe.V1e(new Il.a(ma,this.lJb.command.toString())),this.noa.controls.push(D))}addNativeControl(D){D.id&&(B.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",
D.actionType),D=Object.assign(new tk,{id:D.id,title:"",iconLocation:"",enabled:D.enabled,controlType:2,attributes:this.rdb()}),this.noa.controls.push(D))}startBuildMenu(D){const ma=this.wDa(D.id);ma&&(this.nzb=Object.assign(new tk,{id:ma,title:D.label,iconLocation:this.bMd(D),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(D){const ma=this.wDa(D.id);ma&&(this.lHb(ma,D.action),B.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",D.actionType),D=Object.assign(new pj,
{id:ma,title:D.label,iconLocation:this.bMd(D),enabled:D.enabled,attributes:this.rdb()}),this.ILe.V1e(new Il.a(ma,this.lJb.command.toString())),this.nzb.menuItems.push(D))}endBuildMenu(){lb.c(this.nzb.id)||this.noa.controls.push(this.nzb);this.nzb=null}endBuildGroup(){lb.c(this.noa.id)||this.f9a.groups.push(this.noa);this.noa=null}endBuildTab(){lb.c(this.f9a.id)||this.tbc.add(this.f9a);this.f9a=null}rdb(){const D={};this.cSa(D);return D}bMd(D){return D.icon["80"]?D.icon["80"]:D.icon["32"]}cSa(D){this.lJb.cSa(D)}wDa(D){return this.vMc.$Wa(D)}lHb(D,
ma){this.lmd.bindAction(D,ma)}}Object(l.a)(vk,"OneLineRibbonExtensibilityCreator",null,[178,179]);class Lk{constructor(D,ma){this.iCb=D;this.v8a=new il;this.V8a=new jl(ma)}jQh(D){D=new Jk(D);return new Hl(D,this.V8a,this.v8a)}$Qh(D,ma,vb,lc){vb=new sk.a(this.iCb,D,vb,!0);return new vk(vb,this.v8a,this.V8a,D,ma,lc)}}Object(l.a)(Lk,"UIExtensibilityFactory",null,[160]);var Mk=a(1147);class Mi{get jch(){return t.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:8500191_EnableHomeEntrywithFlyout")&&
t.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")}constructor(D){this.nSa=this.rSa=this.km=this.Hq=null;this.VFg=0;this.V0j=()=>{if(this.km&&this.nSa){const ma=new Lc.a($g.a.Laa,0,0,2,null);this.addinUICommandHandler.executeCommand(0,ma,{["SourceControlId"]:this.nSa},null);B.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.tUk=(ma,vb)=>{ma=null;if(vb)if(ma=vb,this.km=ma.km,(this.Hq=ma.Hq)&&this.Hq.q3&&this.Hq.q3.px&&
(this.rSa=this.Hq.q3.px.pa(0)),this.rSa&&this.rSa.id)if(t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CDTeachingCalloutEnhancementEnabled",!1)&&this.IRg(),this.rSa.isOfficeTab)if(t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CDTeachingCalloutEnhancementEnabled",!1)||this.IRg(),this.nSa)if(Wa.a.contains(this.rSa.id,F.a.rR,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Ze.a.EOb(this.Hq),()=>{this.NXg(this.KNd(this.nSa))});
else{if(vb=this.$.Ia)vb.gpd(this.vtg),B.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else B.ULS.sendTraceTag(537170694,220,10,"Failed to get button id for addin"),vb={["AppTeachingUICalloutAction"]:"NoEnabledButtonFound",["SDX.Id"]:Mi.GetPrivacyCompliantId(this.km),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:lf.a.Eh(vb)}),
this.Nda();else this.PXg(this.KNd(this.rSa.id),0);else B.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),vb={["AppTeachingUICalloutAction"]:"NoTabFound",["SDX.Id"]:Mi.GetPrivacyCompliantId(this.km),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:lf.a.Eh(vb)}),this.Nda();else this.Nda()};this.vtg=()=>{if(Wa.a.contains(this.rSa.id,
appChrome.selectors.getSelectedTabId(),!0)){var ma=this.$.Ia;ma&&ma.PHg(this.vtg);this.NXg(this.KNd(this.nSa))}};this.Y0j=()=>{var ma={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:Mi.n8a(this.OH),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:lf.a.Eh(ma)});this.Nda();const vb={};vb[$b.a.Bf]=this.OH;ma={};ma.solutionId=this.OH.solutionId;ma.assetId=this.OH.assetId;
ma.assetStoreId=this.OH.assetStoreId;ma.height=0!=this.OH.height?this.OH.height:600;ma.storeId=this.OH.storeId;ma.storeType=this.OH.storeType;ma.targetType=this.OH.targetType;ma.width=0!=this.OH.width?this.OH.width:600;ma.displayName=this.OH.displayName;ma.version=this.OH.version;ma.isAddinCommands=!1;vb[Pa.a.zqa]=ma;const lc=new Lc.a(-741808261,0,0,2,null);E.TaskExtensions.tb(kc.GetServiceTaskFactory.Ne(this.$.ra,374,375,1),Nc=>{Nc=Nc.result;null!=Nc&&Nc.insertAgave(vb,lc)},this.$.Aa,3)};this.UUj=
()=>{const ma={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:Mi.n8a(this.OH),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:lf.a.Eh(ma)});this.Nda()};this.IWj=()=>{const ma={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:Mi.n8a(this.OH),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:lf.a.Eh(ma)});this.Nda()};this.axa=ma=>{B.ULS.sendTraceTag(522981591,306,10,`failed to POST data to Roaming Settings Service with status: ${ma?ma.httpStatus:-1}`)};this.$=D.$;this.addinUICommandHandler=D;this.appName=t.AFrameworkApplication.ea.Qa("WebAppShortName")||"Excel";this.ZGh=t.AFrameworkApplication.ea.Rd("AddinMaxDOMElementDetectionTimesForTeachingUI",10)}static GetPrivacyCompliantId(D){return Telemetry.PrivacyRules.GetPrivacyCompliantId(D.solutionId,D.storeType,D.assetId,null,
null,D.storeId)}static n8a(D){return Telemetry.PrivacyRules.GetPrivacyCompliantId(D.solutionId,D.storeType,D.assetId,null,null,D.storeId)}epk(D){this.OH=D;window.addEventListener&&(window.addEventListener("LaunchContentAddin",this.Y0j,!0),window.addEventListener("DismissCallout",this.IWj,!0),window.addEventListener("CloseCallout",this.UUj,!0))}IRg(){var D=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();const ma=this.km.solutionId;ma in D?this.nSa=D[ma]:(D=Mi.GetPrivacyCompliantId(this.km),
B.ULS.sendTraceTag(537170695,220,15,`Failed to get button id from controlIdMap for add-in: ${D}`),this.nSa=this.YIi(this.Hq))}KNd(D){return"[id="+D+"]"}PXg(D,ma){ma>this.ZGh?(window.clearTimeout(this.VFg),this.OXg("[data-unique-id='pivotOverflowButton']"),B.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+D)?this.OXg(D):this.VFg=window.setTimeout(()=>{this.PXg(D,ma+1)},1E3)}NXg(D){var ma=document.querySelector("button[data-unique-id='RightPaddle']");
if(ma)D={["AppTeachingUICalloutAction"]:"RightPaddlePresent",["SDX.Id"]:Mi.GetPrivacyCompliantId(this.km),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:lf.a.Eh(D)});else if(ma=document.querySelector("button"+D),!ma||"none"===window.getComputedStyle(ma).display)if(ma=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!ma){ma={["AppTeachingUICalloutAction"]:"NoAnchor",
["SDX.Id"]:Mi.GetPrivacyCompliantId(this.km),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:lf.a.Eh(ma)});B.ULS.sendTraceTag(537170691,220,15,"ShowTeachingCallout failed to get an anchorElement");this.Nda();return}this.W3g(ma,"ShowTeachingUIForAddinButton")}OXg(D){D=document.querySelector("button"+D);if(!D&&(D=document.querySelector("button[data-unique-id='pivotOverflowButton']"),
!D)){D={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Mi.GetPrivacyCompliantId(this.km),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:lf.a.Eh(D)});B.ULS.sendTraceTag(537170690,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.Nda();return}this.W3g(D,"ShowTeachingUIForAddinTab")}W3g(D,ma){D.setAttribute("lpp-id","latestAddin");const vb=
Object(Ha.d)(hf.a);vb&&D?(vb.execute(lc=>{lc.logActivity(ma,null)}),D={["AppTeachingUICalloutAction"]:"Show",["SDX.Id"]:Mi.GetPrivacyCompliantId(this.km),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:lf.a.Eh(D)}),B.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(B.ULS.sendTraceTag(537170689,220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),
D={["AppTeachingUICalloutAction"]:"NoSifFutureObject",["SDX.Id"]:Mi.GetPrivacyCompliantId(this.km),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:lf.a.Eh(D)}),this.Nda())}YIi(D){if(D&&(D=D.q3,(null===D||void 0===D?0:D.px)&&0<D.px.count))for(const ma of D.px)if(ma.groups&&0<ma.groups.length)for(const vb of ma.groups)if(vb.controls&&0<vb.controls.length)for(const lc of vb.controls){if(lc.attributes&&
0===lc.controlType&&lc.enabled)return lc.id;if(lc.menuItems)for(const Nc of lc.menuItems)if(Nc.attributes&&Nc.enabled)return lc.id}}MXg(){var D="button[data-unique-id = 'Ribbon-InsertAppsForOffice']";M.EwaSettings.isChangeGateEnabled("OfficeVSO:8058447_FixCDTeachingCalloutAnchorAfterFlyoutEnabled")&&(D=this.jch?"button[data-unique-id = 'Ribbon-InsertAddInFlyout']":D);if((D=document.querySelector(D))&&"none"!==window.getComputedStyle(D).display)B.ULS.sendTraceTag(527286666,220,15,"Callout show on OfficeAddin Button");
else{D=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");if(null==D){D={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Mi.n8a(this.OH),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:lf.a.Eh(D)});B.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");this.Nda();return}B.ULS.sendTraceTag(527286667,
220,15,"Callout show on Overflow button")}const ma=Object(Ha.d)(hf.a);null==ma||null==D?(D={["AppTeachingUICalloutAction"]:"NoSifFutureObject",["SDX.Id"]:Mi.n8a(this.OH),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:lf.a.Eh(D)}),B.ULS.sendTraceTag(527286665,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"),this.Nda()):(ma.execute(vb=>{vb.logActivity("ShowTeachingUIForContentAddin",
null)}),D={["AppTeachingUICalloutAction"]:"Show",["SDX.Id"]:Mi.n8a(this.OH),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:lf.a.Eh(D)}),B.ULS.sendTraceTag(527286664,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))}XVc(D){const ma={},vb={};vb.LastTeachingUIShowTime=(new Date).toUTCString();vb.AddinHasShown=D;ma[this.appName]=Ic.c(vb);this.aGb=new gb(this.appName,
null,null,this.axa),this.aGb.vwc(ma),B.ULS.sendTraceTag(522981592,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}Nda(){if(!this.DVc){const D=window.g_roamingAddinList;D&&(this.XVc(D),this.DVc=!0)}}}Object(l.a)(Mi,"AddinTeachingCalloutHandler",null,[]);var Nk=a(1443),Zj=a(310),Pj=a(238),Ih=a(245);class ek extends Pj.a{constructor(D,ma,vb,lc){super();this.m5="calc(100% - 46px)";this.sga="15px";this.n5="0";this.Izb="WACDialogPanel";this.pJ=
695;this.Jzb=462;this.bH="80%";this.tyb=350;this.lAa="100%";this.A_=null;this.hc=5;this.uf="AddinInstallDialog";this.ijh=D;this.C5=ma;this.nwh=vb;this.vrh=lc}rB(){super.rB();this.fj.style.width=this.lAa;this.fj.style.height=this.m5;this.fj.style.marginTop=this.sga;this.fj.style.padding=this.n5;document.getElementById(this.qj("WACDialogButtonPanel")).style.display="none";this.pra.setAttribute("tabindex","0");$addHandler(this.pra,"keyup",Object(wf.a)(this,this.onKeyUp,"onKeyUp"));const D=document.createElement("iframe");
D.setAttribute("id","InstallAddinDialog");D.setAttribute("src","about:blank");D.setAttribute("width","100%");D.setAttribute("height","100%");D.setAttribute("marginHeight","0");D.setAttribute("marginWidth","0");D.setAttribute("frameBorder","0");D.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups");const ma=String.format("https://inclient.store.office.com/gyro/clientstore/flyoutdetails/{0}?client={1}&ui={2}&rs={2}",this.ijh,this.C5,this.nwh);D.setAttribute("src",
ma);this.A_=D;$addHandler(D,"load",Object(wf.a)(this,this.onLoad,"onLoad"));$addHandler(window,"message",Object(wf.a)(this,this.onMessage,"onMessage"));this.fj.appendChild(D);this.fj.appendChild(this.O7h())}O7h(){const D=document.createElement("div");D.setAttribute("tabindex","0");$addHandler(D,"focus",Object(wf.a)(this,this.s1j,"onLoopPivotFocus"));return D}onKeyUp(D){13!==D.keyCode&&32!==D.keyCode||this.hide()}s1j(){this.pra.focus()}onLoad(){this.A_.focus()}onMessage(D){D=D.rawEvent;if(D.source===
this.A_.contentWindow&&(D=(D=D.data)?D.split("|"):null)&&0<D.length&&("REFRESH_REQUIRED"===D[0]||"PRELOAD_MANIFEST"===D[0])){e.a.instance.setItem("refreshRequired","true");const ma={};ma.solutionId=D[1];ma.version=ek.dQj(D[3]);ma.storeType=D[4];ma.storeId=D[5];ma.assetId=D[6];ma.targetType=ek.Y$j(D[2]);ma.assetStoreId=D[7];ma.width=parseInt(D[8]);ma.height=parseInt(D[9]);this.vrh(ma)}}lxa(){this.fj.style.width=this.lAa;this.fj.style.height=this.m5;this.fj.style.marginTop=this.sga;this.fj.style.padding=
this.n5;this.pJ>Ih.a.f9?(this.Fb.style.width=String.format("{0}px",Ih.a.f9),this.Fb.style.overflowX="scroll",t.AFrameworkApplication.isRtl?this.Fb.style.right="0":this.Fb.style.left="0"):(this.Fb.style.width=String.format("{0}px",this.pJ),this.Fb.style.overflowX="hidden");this.Fb.offsetHeight>Ih.a.kZ||this.Jzb+50>Ih.a.kZ?(this.Fb.style.height=String.format("{0}px",Ih.a.kZ),this.Fb.style.overflowY="scroll",this.Fb.style.top="0",t.AFrameworkApplication.isRtl?this.Fb.style.right="0":this.Fb.style.left=
"0",this.fj.style.minHeight=String.format("{0}px",this.tyb)):(this.Fb.style.overflowY="hidden",this.Fb.style.top="10%",this.Fb.style.height=this.bH);this.eia()}eia(){if(this.Fb){var D=this.Fb.style.zIndex;this.Fb.style.zIndex="-9999";if(this.pJ>Ih.a.f9)t.AFrameworkApplication.isRtl?this.Fb.style.marginRight="0":this.Fb.style.marginLeft="0";else{const ma=String.format("{0}px",Math.floor(-this.Fb.offsetWidth/2));t.AFrameworkApplication.isRtl?this.Fb.style.marginRight=ma:this.Fb.style.marginLeft=ma;
t.AFrameworkApplication.isRtl?this.Fb.style.right="50%":this.Fb.style.left="50%"}this.Fb.style.zIndex=String(D)}else B.ULS.sendTraceTag(509871430,306,10,"_divMessageBox is null in CenterDialog()")}IO(){super.IO();const D=document.getElementById(this.qj(this.Izb));D.style.width=String.format("{0}px",this.pJ);D.style.height=this.bH}get Tia(){return this.fj}dispose(){super.dispose();$removeHandler(window,"message",Object(wf.a)(this,this.onMessage,"onMessage"))}static Y$j(D){switch(D){case "1":return 0;
case "2":return 1;default:return 0}}static dQj(D){const ma=D.split(".");for(let vb=0;vb<4-ma.length;vb++)D+=".0";return D}}Object(l.a)(ek,"AddinInstallDialog",Pj.a,[]);var ak=a(1291);class Uj{constructor(){this.addInDetails=this.title=null}}Object(l.a)(Uj,"AddInCategoryData",null,[]);class wk{constructor(){this.links=this.description=this.displayName=this.uniqueId=this.solutionId=null}}Object(l.a)(wk,"AddInDetailData",null,[]);class kl{constructor(){this.href=this.text=null}}Object(l.a)(kl,"AddInLinkData",
null,[]);var Jj=a(1073),bk;(function(D){D[D.cgh=0]="S_OK";D[D.jnl=-2147471590]="E_REQUEST_TIME_OUT";D[D.knl=-2147208619]="E_USER_NOT_SIGNED_IN";D[D.Wml=-2147471591]="E_CATALOG_ACCESS_DENIED";D[D.Yml=-2147471589]="E_CATALOG_REQUEST_FAILED";D[D.enl=-2147208640]="E_OEM_NO_NETWORK_CONNECTION";D[D.inl=-2147208617]="E_PROVIDER_NOT_REGISTERED";D[D.dnl=-2147208637]="E_OEM_CACHE_SHUTDOWN";D[D.fnl=-2147209421]="E_OEM_REMOVED_FAILED";D[D.Xml=-1]="E_CATALOG_NO_APPS";D[D.lnl=-2]="E_USER_NO_MAILBOX";D[D.anl=-1E3]=
"E_GENERIC_ERROR";D[D.ipl=10]="S_HIDE_PROVIDER"})(bk||(bk={}));Object(l.b)("InvokeResultCode",bk);class fk{constructor(D,ma){this.ya=ma;this.Qq=D}get UWk(){return this.ya?this.ya.isChangeGateEnabled("OfficeVSO:8511220_showPopularOnFailForGuests"):!1}vXg(D){return this.UWk?D.failure?-2147208619===D.failure.invokeResultCode:!1:!1}cKf(D,ma){return`invokeFailure/${3===D.errorCode&&D.failure?bk[D.failure.invokeResultCode]:""}/${3===ma.errorCode&&ma.failure?bk[ma.failure.invokeResultCode]:""}`}w$f(D,ma,
vb,lc){D={["Source"]:this.Qq,["MRUListNumber"]:D.toString(),["MyAddinsErrorCode"]:Jj.a[ma.errorCode],["MyAddInsResult"]:ma.Ym.length.toString(),["MyAddinsInvokeResultCode"]:ma.failure?ma.failure.invokeResultCode:"N/A",["AdminManagedErrorCode"]:Jj.a[vb.errorCode],["AdminManagedResult"]:vb.Ym.length.toString(),["AdminManageInvokeResultCode"]:vb.failure?vb.failure.invokeResultCode:"N/A",["PopularAddinsErrorCode"]:lc?Jj.a[lc.errorCode]:"N/A",["PopularAddinsResult"]:lc?lc.Ym.length.toString():"N/A",["PopularAddinsInvokeResultCode"]:lc&&
lc.failure?lc.failure.invokeResultCode:"N/A"};this.IRk&&(D.MyAddinsQueryStart=this.OAc(ma.failure),D.AdminManagedQueryStart=this.OAc(vb.failure),D.PopularQueryStart=this.OAc(lc.failure));uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddinEntryPointDisplayMetrics",dataFields:lf.a.Eh(D)})}v$f(D,ma,vb,lc,Nc){vb={["MyAddinsResult"]:this.Qsd(vb),["AdminManagedResult"]:this.Qsd(lc),["PopularResult"]:this.Qsd(Nc)};D={["Source"]:this.Qq,["Abnormals"]:ma.join("|"),["NumAddinsInMRU"]:D.toString(),
["DiagnosticDetails"]:JSON.stringify(vb)};uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddinEntryPointAceMetrics",dataFields:lf.a.Eh(D)})}Qsd(D){return{["Count"]:D.Ym.length.toString(),["QueryStart"]:this.OAc(D.failure),["ErrorCode"]:Jj.a[D.errorCode],["InvokeResultCode"]:D.failure?D.failure.invokeResultCode:"N/A"}}get B1g(){return!!this.ya&&this.ya.isChangeGateEnabled("OfficeVSO:8393563_FlyoutTelemetryOptimizationEnabled")}get r$f(){return!!this.ya&&this.ya.isChangeGateEnabled("OfficeVSO:8581842_LogAceMetricsEnabled")}OAc(D){let ma=
"N/A";D&&D.queryStart&&window.performance.timeOrigin&&(ma=(new Date(window.performance.timeOrigin+D.queryStart)).toISOString());return ma}get IRk(){return this.ya?this.ya.isChangeGateEnabled("OfficeVSO:8546535_LogQueryStartEnabled"):!1}}Object(l.a)(fk,"AddinEntryPointCommon",null,[]);class lk{constructor(D,ma,vb){this.dga=0;this.$Me=!1;this.RDb=[];this.vOa=void 0;this.ya=D;this.cga=ma;this.ghd=vb;B.ULS.sendTraceTag(508396508,220,50,"AddInCategoryManager Initialized")}J1a(D,ma){D&&ma&&this.URk(ma)&&
this.Exg()}URk(D){0===D.rF&&(this.dga|=1);1===D.rF&&(this.dga|=2);2===D.rF&&(this.dga|=4);return!!this.dga}Exg(){const D=[];let ma=null;const vb={},lc=this.Duj,Nc=this.dNj,wd=this.cga.oQ(0),Yd=this.cga.oQ(1),ee=this.cga.oQ(2);2!==wd.errorCode&&2!==ee.errorCode||Nc.length?3!==wd.errorCode||this.k0.vXg(wd)||3!==Yd.errorCode?4!==wd.errorCode||Nc.length?!this.q3f&&(!this.o8||0!==ee.errorCode&&5!==ee.errorCode)||ee.Ym.length||(B.ULS.sendTraceTag(508396506,220,50,"get popular add-ins for backstage error: empty category, Flag: {0} Popular error code: {1}",
this.dga,ee.errorCode),D.push("emptyCategory")):(ma={ariaDescription:Object(Ba.a)("AddinPickerServiceDisconnectedError"),iconName:"StoreDisabled",label:Object(Ba.a)("AddinPickerServiceDisconnectedError"),title:Object(Ba.a)("AddInBackstageErrorViewTitle")},D.push("serviceDisabled")):(ma={ariaDescription:Object(Ba.a)("AddinPickerGeneralError"),iconName:"Common",label:Object(Ba.a)("AddinPickerGeneralError"),title:Object(Ba.a)("AddInBackstageErrorViewTitle")},D.push(this.k0.cKf(wd,Yd))):(ma=this.ya&&
this.ya.isChangeGateEnabled("OfficeVSO:8668453_StoreDisabledErrorViewWithDocumentLink")?{ariaDescription:Object(Ba.a)("AddinPickerDisableError"),iconName:"StoreDisabled",label:Object(Ba.a)("AddinPickerDisableError"),title:Object(Ba.a)("AddInBackstageErrorViewTitle"),linkText:Object(Ba.a)("AddinPickerDisableErrorDocumentText"),linkUrl:String.format("https://learn.microsoft.com/{0}/microsoft-365/admin/manage/manage-addins-in-the-admin-center?view=o365-worldwide#manage-add-in-downloads-by-turning-onoff-the-office-store-across-all-apps-except-outlook",
t.AFrameworkApplication.uiCulture),onLinkClicked:()=>{B.ULS.sendTraceTag(507875924,220,15,"User has clicked link on add-in backstage error view")}}:{ariaDescription:Object(Ba.a)("AddinPickerDisableError"),iconName:"StoreDisabled",label:Object(Ba.a)("AddinPickerDisableError"),title:Object(Ba.a)("AddInBackstageErrorViewTitle")},D.push("storeDisabled"));this.K9b&&this.k0.w$f(Nc.length,wd,Yd,ee);const ae=!ma;!ae||lc||Nc.length?(ae?(vb.mruAddIns=Nc,lc&&(vb.categories=this.$bk)):vb.errorViewProps=ma,appChrome.api.dispatch(appChrome.actions.setFileMenuAddInsData(vb,
ae)),lc&&ae&&!this.$Me&&(this.$Me=!0,B.ULS.sendTraceTag(508396504,220,50,"Set Popular Add-ins List to Backstage Success. Flag: {0}",this.dga))):D.push("emptyPage");this.K9b&&(this.k0.B1g&&B.ULS.sendTraceTag(508047441,220,15,`${D.join("|")}`),this.k0.r$f&&this.k0.v$f(Nc.length,D,wd,Yd,ee))}get q3f(){return!!(this.dga&4)}get K9b(){return!!this.ya&&this.ya.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TriggerBackstageUIFixEnabeld",!1)}get Duj(){const D=this.cga.oQ(2);return(this.q3f||this.o8||
this.K9b)&&(0===D.errorCode||5===D.errorCode)&&!!D.Ym.length}get $bk(){var D=this.hOi();0<D.length&&(this.ghd=D);if(lb.c(this.ghd))return[];var ma=JSON.parse(this.ghd);D=[];for(var vb of ma)ma=Object.assign(new Uj,{title:vb.title,addInDetails:[]}),this.XPh(ma,vb.solutionIds),0<ma.addInDetails.length&&Array.add(D,ma);0<this.RDb.length&&(vb=this.cga.oQ(2),B.ULS.sendTraceTag(508396503,220,15,"{0} SolutionIds not found in mapping: {1}, collection length: {2}",this.RDb.length,this.RDb,vb.Ym.length),this.RDb=
[]);return D}get dNj(){var D=[],ma=this.cga.oQ(0);Array.addRange(D,ma.Ym);ma=this.cga.oQ(1);Array.addRange(D,ma.Ym);D.sort((vb,lc)=>{vb=xb.d(vb.displayName);lc=xb.d(lc.displayName);return Cc.a.localeCompare(vb,lc)});ma=[];for(const vb of D)D=Object.assign(new wk,{description:vb.description,displayName:vb.displayName,solutionId:vb.solutionId,uniqueId:this.FOb(vb)}),Array.add(ma,D);return ma}XPh(D,ma){const vb=this.eNj;let lc=0;for(const Nc of ma){if(4===lc)break;if(vb.contains(Nc))continue;ma=this.cga.nQ(Nc);
if(!ma){this.RDb.push(Nc);continue}const wd=Object.assign(new wk,{description:ma.description,displayName:ma.displayName,solutionId:ma.solutionId,uniqueId:this.FOb(ma)});wd.links=[Object.assign(new kl,{text:Object(Ba.a)("AddinOneLink"),href:"https://appsource.microsoft.com/en-us/product/office/"+ma.solutionId})];Array.add(D.addInDetails,wd);++lc}}get eNj(){const D=[];var ma=this.cga.oQ(0);Array.addRange(D,ma.Ym);ma=this.cga.oQ(1);Array.addRange(D,ma.Ym);ma=new Dd.a(jc.a.Ef());for(const vb of D)ma.add(vb.solutionId);
return ma}FOb(D){return this.o8?String.format("{0}#{1}",D.solutionId,D.storeId):D.solutionId}get o8(){return!!this.ya&&this.ya.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",!1)}hOi(){return this.ya?this.ya.getStringFeatureGate("Microsoft.Office.SharedOnline.BackstageCustomizablePopularAddins",""):""}get k0(){this.vOa||(this.vOa=new fk("Backstage",this.ya));return this.vOa}}Object(l.a)(lk,"AddInCategoryManager",null,[]);var Ok=a(1295),am=a(704);class Pk{constructor(D,
ma,vb){this.amountToShowWhenCollapsed=D;this.expandButton=ma;this.collapseButton=vb}}Object(l.a)(Pk,"GallerySectionCollapse",null,[]);class ll{constructor(){this.Collapse=this.InsertionPoint=this.GalleryButtons=this.Title=this.SectionId=null}}Object(l.a)(ll,"GallerySectionProps",null,[]);var ej=a(1493);class vj{constructor(){this.text=this.href=null}}Object(l.a)(vj,"LinkProps",null,[]);var Qk=a(1294),bm=a(1296),gk=a(284),Jl=a(239);class hk{constructor(D,ma,vb,lc){this.m7e="appsource";this.primaryKey=
"f45d712d6617b7e2b2f1fb0fc9757fa1eb384d7f03f6740a1a474b3ccf95b5d8";this.JEk="99b3e3778ca726c8bd5b4b1b6aa137358f0902d731079ca80e28f79a25d3870a";this.ya=D;this.k_=ma;this.fM=vb;this.G9c=void 0;this.wQe=lc;this.Tm=new dh(this.ya);this.BUe=this.vRh();this.St={};this.qnh=2E4}ene(D,ma,vb,lc,Nc){lc=void 0===lc?15:lc;Nc=void 0===Nc?!1:Nc;var wd=new gk.QueryStringBuilder("search"),Yd={"api-version":"2023-01-01-preview",gallery:"AppSourceApps",productTypes:"Office365",Market:"ALL",select:"UniqueProductId,DisplayName,LongSummary,SmallIconUri,Popularity"};
Yd.applicableProducts=this.fM;Yd.supportedProducts=this.fM+"_Online";Yd.Language=this.wQe;Yd.searchQuery=D;Yd.top=lc.toString();this.sqd("AppSource",Yd);for(const ae in Yd)wd.uj(ae,Yd[ae]);wd="https://catalogapi.azure.com/"+wd.toString();Yd={};Yd["X-API-Key"]=Nc?this.JEk:this.primaryKey;Yd["X-ms-app"]=this.m7e;const ee=window.performance.now();this.executeRequest(wd,1,Yd,ae=>{let he="Query Succeeded",De=!0,Se=0;const qf=[],kg=[];ae=ae.data.responseData;try{var $f=JSON.parse(ae);Se=$f.totalCount;const Cg=
$f.results;for($f=0;$f<Cg.length;$f++){const sg=Cg[$f],ng={};ng.solutionId=sg.uniqueProductId.toLowerCase();ng.displayName=sg.displayName;ng.description=sg.longSummary;ng.iconUrl=sg.smallIconUri;ng.assetId=ng.solutionId;ng.storeId="en-US";ng.storeType="omex";ng.assetStoreId="omex";qf.push(ng);this.St[ng.solutionId]=ng;kg.push(sg.popularity)}}catch(Cg){he="Exception thrown from Json parse for responseData: "+ae+". Exception: "+Cg,De=!1}this.iJa(0<D.length,vb,"AppSource",De,he,window.performance.now()-
ee,Se,qf,kg);ma(De,qf)},ae=>{const he=[];this.iJa(0<D.length,vb,"AppSource",!1,`Query Failed, httpStatus: ${ae.data.httpStatus}, responseData: ${ae.data.responseData}`,window.performance.now()-ee,0,he);Nc||ae.data.httpStatus!==Jl.a.uza?ma(!1,he):this.ene(D,ma,vb,lc,!0)})}vEk(D,ma){ma=void 0===ma?15:ma;return new Promise((vb,lc)=>{this.ene(D,(Nc,wd)=>{Nc?vb(wd):lc()},Date.now(),ma)})}h2i(D,ma){var vb=new gk.QueryStringBuilder("suggestions/products"),lc={"api-version":"2023-01-01-preview",gallery:"AppSourceApps",
productTypes:"Office365",Market:"ALL",select:"DisplayText,Id,IconUrl,ProductType"};lc.applicableProducts=this.fM;lc.Language=this.wQe;lc.suggestionTypes="WordSearch,Entity";lc.searchQuery=D;this.sqd("AppSource",lc);for(const wd in lc)vb.uj(wd,lc[wd]);vb="https://catalogapi.azure.com/"+vb.toString();lc={};lc["X-API-Key"]=this.primaryKey;lc["X-ms-app"]=this.m7e;const Nc=window.performance.now();this.executeRequest(vb,1,lc,wd=>{let Yd="Query Succeeded",ee=!0;wd=wd.data.responseData;let ae={};try{ae=
JSON.parse(wd)}catch(he){Yd="Exception thrown from Json parse for responseData: "+wd+". Exception: "+he,ee=!1}this.iJa(0<D.length,0,"AppSource/suggestions",ee,Yd,window.performance.now()-Nc,0,[]);ma(ee,ae)},wd=>{this.iJa(!1,0,"AppSource/suggestions",!1,`Query Failed, httpStatus: ${wd.data.httpStatus}, responseData: ${wd.data.responseData}`,window.performance.now()-Nc,0,[]);ma(!1,{})})}i2i(D){return new Promise((ma,vb)=>{this.h2i(D,(lc,Nc)=>{lc?ma(Nc):vb()})})}fne(D,ma,vb,lc,Nc){lc=void 0===lc?"":
lc;Nc=void 0===Nc?15:Nc;var wd,Yd;const ee=new gk.QueryStringBuilder("api/addins/search"),ae={apiversion:"1.0"};0<D.length&&(ae.qu=D);0<lc.length&&(ae.assetids=lc);ae.client="WAC_"+this.fM;ae.cv=t.AFrameworkApplication.buildVersion;this.Tm.tDi&&(ae.rs=this.dataLocale,ae.ad=null!==(wd=this.LZi(this.dataLocale))&&void 0!==wd?wd:"US",ae.ui=null!==(Yd=t.AFrameworkApplication.uiCulture)&&void 0!==Yd?Yd:"en-US");ae.top=Nc.toString();this.sqd("OMEX",ae);for(const De in ae)ee.uj(De,ae[De]);lc="https://api.addins.omex.office.net/"+
ee.toString();const he=window.performance.now();this.executeRequest(lc,1,null,De=>{let Se="Query Succeeded",qf=!0,kg=0;const $f=[];De=De.data.responseData;try{var Cg=JSON.parse(De);kg=Cg.TotalCount;const sg=Cg.Values;for(Cg=0;Cg<sg.length;Cg++){const ng=sg[Cg],eh={};eh.solutionId=ng.Id.toLowerCase();eh.displayName=ng.Title;eh.description=ng.ShortDescription;eh.iconUrl=ng.IconUrl;eh.assetId=eh.solutionId;eh.storeId="en-US";eh.storeType="omex";eh.assetStoreId="omex";eh.version=ng.Version;eh.targetType=
ng.Shape-1;eh.height=ng.Height;eh.width=ng.Width;$f.push(eh);this.St[eh.solutionId]=eh}}catch(sg){Se="Exception thrown from Json parse for responseData: "+De+". Exception: "+sg,qf=!1}this.iJa(0<D.length,vb,"OMEX",qf,Se,window.performance.now()-he,kg,$f);ma(qf,$f)},De=>{const Se=[];this.iJa(0<D.length,vb,"OMEX",!1,`Query Failed, httpStatus: ${De.data.httpStatus}, responseData: ${De.data.responseData}`,window.performance.now()-he,0,Se);ma(!1,Se)})}pOg(D,ma,vb){ma=void 0===ma?"":ma;vb=void 0===vb?15:
vb;return new Promise((lc,Nc)=>{this.fne(D,(wd,Yd)=>{wd?lc(Yd):Nc()},Date.now(),ma,vb)})}x_i(D,ma){var vb=new gk.QueryStringBuilder("api/addins/details");const lc={apiversion:"1.0"};lc.assetid=D;lc.client="WAC_"+this.fM;lc.cv=t.AFrameworkApplication.buildVersion;for(const wd in lc)vb.uj(wd,lc[wd]);vb="https://api.addins.omex.office.net/"+vb.toString();const Nc=window.performance.now();this.executeRequest(vb,1,null,wd=>{let Yd="Query Succeeded",ee=!0;wd=wd.data.responseData;const ae={};try{const he=
JSON.parse(wd).Value;ae.solutionId=D;ae.displayName=he.Title;ae.shortDescription=he.ShortDescription;ae.longDescription=he.LongDescription;ae.iconUrl=he.IconUrl;ae.videoUrl=he.VideoUrl;ae.screenshots=he.Screenshots.map(De=>De.FullSize)}catch(he){Yd="Exception thrown from Json parse for responseData: "+wd+". Exception: "+he,ee=!1}this.iJa(!1,0,"OMEX/details",ee,Yd,window.performance.now()-Nc,0,[]);ma(ee,ae)},wd=>{this.iJa(!1,0,"OMEX/details",!1,`Query Failed, httpStatus: ${wd.data.httpStatus}, responseData: ${wd.data.responseData}`,
window.performance.now()-Nc,0,[]);ma(!1,{})})}get dataLocale(){var D;this.G9c||(this.G9c=null!==(D=this.k_.getDataLocale())&&void 0!==D?D:"en-US");return this.G9c}LZi(D){if(D&&"x-none"!==D){if(D=D.split("-"),!(2>D.length))return D[D.length-1]}else B.ULS.sendTraceTag(507130763,220,15,"Invalid culture: {0}",D)}y_i(D){return new Promise((ma,vb)=>{this.x_i(D,(lc,Nc)=>{lc?ma(Nc):vb()})})}nQ(D){return this.St[D.toLowerCase()]?this.St[D.toLowerCase()]:null}executeRequest(D,ma,vb,lc,Nc){return t.AFrameworkApplication.od.Wn(D,
ma,null,void 0===vb?null:vb,!1,2,lc,Nc,null,null,!1,null,this.qnh)}iJa(D,ma,vb,lc,Nc,wd,Yd,ee,ae){D={["hasSearchValue"]:null===D||void 0===D?void 0:D.toString(),["searchStartTime"]:null===ma||void 0===ma?void 0:ma.toString(),["apiSource"]:vb,["responseSuccess"]:null===lc||void 0===lc?void 0:lc.toString(),["responseInfo"]:Nc,["timeElapsed"]:null===wd||void 0===wd?void 0:wd.toString(),["totalCount"]:null===Yd||void 0===Yd?void 0:Yd.toString(),["solutionIds"]:ee.map(he=>this.B3h(he)),["popularity"]:ae?
ae:[]};uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.SearchApiMetrics",dataFields:lf.a.Eh(D)})}B3h(D){return Telemetry.PrivacyRules.GetPrivacyCompliantId(D.solutionId,D.storeType,D.assetId,null,null,D.storeId)}vRh(){let D=this.Tm.L9j;if(1>=D.length)return{};B.ULS.sendTraceTag(507785891,220,50,"BuildSearchQueryParametersOverrides: overrideString: {0}.",D);const ma={};let vb=!0,lc="";D=D.trim();try{const Nc=D.split("$");for(let wd=0;wd<Nc.length&&vb;wd++){const Yd=Nc[wd].split(":");if(2!==
Yd.length){lc="Invalid override string format: "+Nc[wd];vb=!1;break}const ee=Yd[0].trim(),ae=[],he=Yd[1].split("|");for(let De=0;De<he.length&&vb;De++){const Se=he[De],qf=Se.split("\\");if(2<qf.length){lc="Invalid override string format: "+Se;vb=!1;break}const kg=qf[0].trim(),$f=2===qf.length?qf[1].trim():null;Array.add(ae,new wh.a(kg,$f))}ma[ee]=ae}}catch(Nc){lc="Failed in parsing the overrideString: "+D+". Exception: "+Nc.toString(),vb=!1}if(vb)return ma;B.ULS.sendTraceTag(507785890,220,10,"Build override failed: {0}.",
lc);return{}}sqd(D,ma){if(this.BUe[D]){D=this.BUe[D];for(let vb=0;vb<D.length;vb++){const lc=D[vb].key,Nc=D[vb].value;Nc?ma[lc]=Nc:delete ma[lc]}}}}Object(l.a)(hk,"AddinSearchApiManager",null,[]);var Rk=a(407);class Sk{constructor(){this.Jj=D=>{var ma;if(null===D||null===D.Ha)return!1;D=D.Ha.target;for(this.kHd=void 0;null!=D&&D.getAttribute;){void 0===this.kHd&&0<(null===(ma=D.id)||void 0===ma?void 0:ma.length)&&(this.kHd=D.id);if(null!=D.getAttribute("data-contextmenu-id"))break;D=D.parentNode}return!1}}get currentTarget(){return this.kHd}MCj(){Rk.a.instance.va(window.document.body,
this.Jj,null)}dispose(){Rk.a.instance.Ua(window.document.body,this.Jj)}}Object(l.a)(Sk,"AppFlyoutGeneratorContextMenuListener",null,[]);var kh=a(1075);const ml={["IPWAI"]:"wa200005502 wa200001011 wa200000368 wa200005107 wa200005287 wa104381714 wa200005444 wa200005826 wa200006000 wa200001361 wa200005313 wa200005312 wa200006001".split(" "),["WF"]:"wa200001011 wa104382081 wa200000368 wa104380122 wa200000199 wa200005983 wa104381727 wa200001361 wa200000011 wa200005106 wa200005817 wa200004216".split(" "),
["ER"]:"wa200004257 wa104381909 wa104380917 wa200002334 wa200001482 wa200002534 wa200002891 wa104380848".split(" "),["APID"]:"wa200000113 wa104380121 wa104051163 wa104379279 wa200002281 wa104178141 wa104380118 wa104379370 wa104379997 wa104381063 wa104381411 wa200001486".split(" ")},nl=Object.assign({},{["CE"]:ak.a},ml),Tk={["IPWAI"]:"wa200005502 wa200005271 wa200004935 wa200001584 wa200005669 wa200005281 wa200006009 wa200006007 wa200005333".split(" "),["APIC"]:"wa102957665 wa200004179 wa104051163 wa200000113 wa104380194 wa200004688 wa200004687 wa104221182 wa200003220 wa104379169 wa103147117".split(" "),
["DA"]:"wa200000169 wa200000018 wa200003784 wa104381841 wa200000025 wa200002503 wa104381807 wa104380711 wa200004632 wa200005782 wa200005817 wa200005777 wa200005960 wa200006017 wa200006008".split(" "),["FA"]:"wa104379220 wa200002311 wa104381695 wa200003692 wa104381859 wa104381717 wa104380978".split(" ")},ol=Object.assign({},{["CE"]:ak.a},Tk),Kl={["IPWAI"]:["wa200003964","wa200005669","wa200005107","wa200006000","wa200006067"],["APIC"]:"wa104221182 wa104178141 wa104381909 wa104380907 wa200000113 wa104380121 wa104381155 wa104379997 wa104381063 wa104379370 wa104380902 wa104381411 wa200003220 wa200003891 wa104380848 wa104381637 wa200001766".split(" "),
["CAIP"]:"wa104379261 wa200001661 wa200000094 wa200002908 wa104381682 wa104218073 wa104382064 wa200004709 wa200004643 wa200003676 wa200001313 wa200003706 wa104381448 wa104380667".split(" "),["DWT"]:"wa200001625 wa104380602 wa104380526 wa200002334 wa104380050 wa200003052 wa200006046 wa200003157 wa104380955 wa104380278 wa200001396 wa200001409".split(" ")},Ll=Object.assign({},{["CE"]:ak.a},Kl);class Ml{constructor(D,ma){this.Tm=D;this.k_=ma;if(D.jOb){D=this.Tm.K9j;try{const vb=D.split("|");for(D=0;D<
vb.length;D+=2);}catch(vb){}}}Q1i(){var D,ma;const vb={},lc=this.Tm.host;if("Word"===lc){var Nc=this.Tm.a3?nl:ml;for(const wd in Nc)vb[wd]=(null===(D=Nc[wd])||void 0===D?void 0:D.map(Yd=>this.k_.nQ(Yd)).filter(Yd=>!!Yd))||[]}else if("Excel"===lc){D=this.Tm.a3?ol:Tk;for(const wd in D)vb[wd]=(null===(Nc=D[wd])||void 0===Nc?void 0:Nc.map(Yd=>this.k_.nQ(Yd)).filter(Yd=>!!Yd))||[]}else if("PowerPoint"===lc){D=this.Tm.a3?Ll:Kl;for(const wd in D)vb[wd]=(null===(ma=D[wd])||void 0===ma?void 0:ma.map(Yd=>this.k_.nQ(Yd)).filter(Yd=>
!!Yd))||[]}return vb}JLi(D){return Object(kh.b)()[D]||Object(kh.b)().default}}Object(l.a)(Ml,"AppFlyoutCategories",null,[]);a(125);class pl{constructor(D,ma){this.mvh=D;this.nvh=ma;this.Tm=new dh(t.AFrameworkApplication.ea)}D1d(){null==e.a.instance.getItem("AddinEntryPointSurveyShowed")&&(this.Rsh=window.setTimeout(()=>{this.wZe=Object(Ha.d)(hf.a);null!=this.wZe&&this.wZe.execute(D=>{if(null==e.a.instance.getItem("AddinEntryPointSurveyShowed")){var ma=this.Ozc();this.kKi()||ma&&(!ma||"hidden"!==ma.visibility)||
(D.R5a(this.mvh,null),e.a.instance.setItem("AddinEntryPointSurveyShowed","1"))}})},this.nvh))}Z3a(){window.clearTimeout(this.Rsh)}Ozc(){let D=null;try{const ma=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");ma&&(D=rk.a.Ez(ma.parentNode.parentNode.parentNode))}catch(ma){B.ULS.sendTraceTag(508343957,220,10,"AddinFlyout get parent and parent get exception "+(ma?ma.toString():""))}return D}kKi(){let D=null;try{D=document.getElementById("BackstageGetAddIns")}catch(ma){B.ULS.sendTraceTag(508343956,
220,10,"Backstage get parent and parent get exception "+(ma?ma.toString():""))}return D}}Object(l.a)(pl,"FpsHelper",null,[]);var cm=a(1292);class xk{constructor(D){this.St=null;this.ya=D}nQ(D){return this.yef.find(ma=>ma.solutionId.toLowerCase()===D.toLowerCase())}get yef(){if(!this.St){const D=JSON.parse(xk.sih);xk.yGb(D);D.sort((ma,vb)=>ma.addinInfo.AUP<vb.addinInfo.AUP?1:-1);this.St=D}return this.St}static yGb(D){for(const ma of D)isNaN(ma.targetType)&&(ma.targetType=1),ma.assetId=ma.assetId||
ma.solutionId,ma.storeId=ma.storeId||"en-US",ma.storeType=ma.storeType||"omex",ma.assetStoreId=ma.assetStoreId||"omex",isNaN(ma.width)&&(ma.width=0),isNaN(ma.height)&&(ma.height=0)}}xk.sih='[{"displayName":"RefWorks Citation Manager","solutionId":"WA104380122","version":"2.1.0.1","description":"Access your reference collection when writing for quick formatting of citations and a bibliography.","iconUrl":"https://store-images.s-microsoft.com/image/apps.65260.65124d22-f776-49df-bc00-7feb775be86b.9c8232a6-57b5-45f6-9998-520f920cffe1.a28c4b83-5b94-4239-a8b2-1dc4fdf62abd.png","licenseUrl":"https://www.proquest.com/about/terms-and-conditions.html","privacyUrl":"https://www.proquest.com/about/privacy-home.html","addinInfo":{"priority":2,"AUP":29000}},{"displayName":"SmartCite for Papers","solutionId":"WA104380917","version":"1.0.1.0","description":"Cite references and generate bibliographies automatically from your ReadCube Papers library!","iconUrl":"https://store-images.s-microsoft.com/image/apps.37206.29ea90e8-6e48-40d7-a6f6-0e3c479febca.1a063694-e16a-4c0c-a2e9-08030cb75f3f.18a6c2f3-4683-4297-be90-d077e8cc1e08.png","licenseUrl":"https://www.papersapp.com/terms","privacyUrl":"https://www.papersapp.com/privacy","addinInfo":{"priority":2,"AUP":13000}},{"displayName":"EasyBib Add-In for Office 365","solutionId":"WA104381648","version":"1.0.0.2","description":"Easily create, save, and add citations to your paper with the EasyBib Add-in for Office 365.","iconUrl":"https://store-images.s-microsoft.com/image/apps.55159.b286607a-d729-4136-bfb1-21ebed7465be.89af5759-1891-4061-882b-18cffb725610.45a13c76-1e24-435f-8539-eebc4c0177fe.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.easybib.com/company/privacy","addinInfo":{"priority":2,"AUP":5000}},{"displayName":"Mendeley Cite","solutionId":"WA104382081","version":"1.55.1.0","description":"Cite as you write. Generate citations and bibliographies and change your citation style.","iconUrl":"https://store-images.s-microsoft.com/image/apps.43392.23c5ae3a-3551-42b6-9ba6-5a9ac6c8ade4.14de091f-6544-45e8-b3a6-4a222e2ca359.f3ef8ae0-fa4a-46f7-9f22-7cb0e2e90fcd.png","licenseUrl":"https://www.mendeley.com/terms","privacyUrl":"https://www.elsevier.com/legal/privacy-policy","addinInfo":{"priority":2,"AUP":600000}},{"displayName":"PERRLA","solutionId":"WA200000199","version":"8.2.0.0","description":"Create perfect APA & MLA papers. We\u2019ve helped students write perfectly formatted papers since 1998.","iconUrl":"https://store-images.s-microsoft.com/image/apps.7448.ce605f46-4369-4795-8a16-68d19f80e425.1917fc48-bfda-4ecf-9fb8-aa43ce0dbed9.a79b9edf-f0d2-477c-b0c4-ba812278c907.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.perrlacomplete.com/PrivacyPolicy/WordAddIn","addinInfo":{"priority":2,"AUP":18000}},{"displayName":"Ref-n-Write","solutionId":"WA200001700","version":"2.0.0.0","description":"Ref-n-Write is a cross referencing and paraphrasing tool for writing research papers and theses.","iconUrl":"https://store-images.s-microsoft.com/image/apps.9837.75e7cc1b-a7e7-4ace-8efe-d60f32b31b0d.ff80fa10-c38c-4f9e-b939-658cd2ac0416.039adb78-514a-43b9-816b-c68d3326b264.png","licenseUrl":"https://www.ref-n-write.com/trial/eula","privacyUrl":"https://www.ref-n-write.com/trial/privacy-policy-of-ref-n-write-office-sharepoint-addins","addinInfo":{"priority":2,"AUP":3000}},{"displayName":"Citavi Assistant Beta","solutionId":"WA200002513","version":"2021.3.29.10","description":"The Citavi Assistant automatically formats citations and bibliographies.","iconUrl":"https://store-images.s-microsoft.com/image/apps.49030.0475a4dd-1335-4b98-9dcd-0f5f45db9022.69f86a8e-4c8d-402c-b309-0ab570f7673b.a89c32cb-b0df-4ef6-aa5e-ad19ab74e42e.png","licenseUrl":"https://citavi.com/eula","privacyUrl":"https://citavi.com/privacy","addinInfo":{"priority":2,"AUP":2000}},{"displayName":"Sciwheel","solutionId":"WA200002534","version":"6.0.0.0","description":"Cite effortlessly and format your bibliography with 7000+ styles, all without leaving Word. ","iconUrl":"https://store-images.s-microsoft.com/image/apps.53370.9d5750e6-7257-4e5e-9f38-9d2986f4b795.5095e0db-395b-4d89-8298-0231f31340b2.f4c9aecf-00d0-422f-ba8a-40f9991fa55f.png","licenseUrl":"https://sciwheel.com/work/legal/sciwheel-word-365-add-in-download-installation-terms-and-conditions/software-license-agreement","privacyUrl":"https://sciwheel.com/work/legal/sciwheel-word-365-add-in-privacy-notice","addinInfo":{"priority":2,"AUP":4000}},{"displayName":"Citavi Assistant","solutionId":"WA200002891","version":"2021.3.29.10","description":"The Citavi Assistant automatically formats citations and bibliographies.","iconUrl":"https://store-images.s-microsoft.com/image/apps.41528.46a7367a-a31d-4175-9c32-fc8e30e8855a.21681137-d1cf-4b73-b8fb-15b7d87b6ef1.72153cd3-7603-49c4-b7d8-6895767a69a6.png","licenseUrl":"https://citavi.com/eula","privacyUrl":"https://citavi.com/privacy","addinInfo":{"priority":2,"AUP":13000}},{"displayName":"EndNote 21 Cite While You Write\u2122 for Word Online","solutionId":"WA200005983","version":"1.2.0","description":"Insert in-text citations while simultaneously creating a bibliography with Cite While You Write\u2122","iconUrl":"https://store-images.s-microsoft.com/image/apps.29751.ac5fb94c-9f9b-453b-a5ac-fecb20593f4e.7052bc0d-7631-4821-bc17-86df446ab06d.f9287209-4488-4e0f-9b23-3030ad68d0f0.png","licenseUrl":"https://endnote.com/license","privacyUrl":"https://endnote.com/privacy","addinInfo":{"priority":2,"AUP":8000}}]';
Object(l.a)(xk,"CitationAddinManager",null,[]);class Uk extends Pj.a{constructor(D,ma,vb,lc,Nc,wd,Yd,ee,ae){super(!1,!1,!0);this.hc=5;this.initializeAndShow("",()=>{this.hide()},{["id"]:"AddInStoreDialog",["bodyControls"]:{},["dataProvider"]:{["getAddinDetails"]:he=>{he=D.oQ(he);const De=he.Ym&&he.Ym instanceof Array?he.Ym.filter(Se=>Se.addinInfo&&-1!==Se.addinInfo.priority):[];De.sort((Se,qf)=>qf.addinInfo.AUP-Se.addinInfo.AUP);return{["errorCode"]:he.errorCode,["addinDetails"]:De,["failure"]:he.failure}},
["getAddinDetailById"]:D.nQ.bind(D)},["host"]:ma,["getCommonString"]:Ba.a,["hide"]:this.hide.bind(this),["appsFlyoutGeneratorContext"]:{["host"]:vb.host,["addinFlyoutSearchDebouncingDelay"]:kh.o,["addinFlyoutSearchRecommendedKeyword"]:kh.n,["flyoutStoreExpEnabled"]:vb.jOb,["flyoutStoreExpUseLabelsEnabled"]:vb.zDi,["flyoutStoreExpSearchWithAppSourceEnabled"]:vb.xDi,["flyoutStoreExpUXRenderCheckerEnabled"]:vb.yDi,["flyoutStoreExpRetryIfNotReady"]:vb.wDi,["flyoutStoreAdvancedUXEnabled"]:vb.vDi,["flyoutStoreFooterLabelString"]:vb.ADi,
["mosForWXPEnabled"]:vb.a3},["addinSearchApiManager"]:{["searchFromAppSource"]:lc.ene.bind(lc),["searchFromAppSourceAsync"]:lc.vEk.bind(lc),["searchFromOMEX"]:lc.fne.bind(lc),["searchFromOMEXAsync"]:lc.pOg.bind(lc),["getAddinDetailById"]:lc.nQ.bind(lc),["getRichAddinDetailFromOMEXAsync"]:lc.y_i.bind(lc),["getSuggestionsFromAppSourceAsync"]:lc.i2i.bind(lc)},["addinCommandsHandlerForStoreExp"]:{["handleInstallPopularAddInAndLaunchIt"]:Nc.zQd.bind(Nc),["handleInstallSearchAddInAndLaunchIt"]:Nc.x8i.bind(Nc),
["handleLaunchAppForOfficeDialog"]:Nc.E8i.bind(Nc)},["appFlyoutCategories"]:{["getStoreExpCategoryAddinsRecord"]:wd.Q1i.bind(wd),["getCategoryTitle"]:wd.JLi.bind(wd)},["telemetryForStoreExp"]:{["sendULSInfoTraceTag"]:Yd.OGk.bind(Yd),["sendULSWarningTraceTag"]:Yd.PGk.bind(Yd),["sendULSErrorTraceTag"]:Yd.NGk.bind(Yd),["sendOtelTelemetry"]:Yd.kGk.bind(Yd),["getPrivacyCompliantId"]:Yd.Mca.bind(Yd)},["onDialogOpen"]:ee,["onDialogClose"]:ae})}}Object(l.a)(Uk,"AddInStoreDialog",Pj.a,[]);class ql{constructor(){}OGk(D){B.ULS.sendTraceTag(507343232,
220,50,D)}PGk(D){B.ULS.sendTraceTag(507343203,220,15,D)}NGk(D){B.ULS.sendTraceTag(507343202,220,10,D)}kGk(D,ma){uf.a.sendTelemetryEvent({name:D,dataFields:lf.a.Eh(ma)})}Mca(D){return Telemetry.PrivacyRules.GetPrivacyCompliantId(D.solutionId,D.storeType,D.assetId,null,null,D.storeId)}}Object(l.a)(ql,"TelemetryForStoreExp",null,[]);var rl=a(1293);class sl{constructor(){this.v2Config=this.telemetryData=null}}Object(l.a)(sl,"UserFeedbackOptions",null,[]);class Nl{constructor(){this.scenarioConfig=this.contextDataFiles=
null;this.isHostManagedContextDataEnabled=this.isThankYouPageDisabled=this.isScreenRecordingEnabled=this.isScreenshotEnabled=this.isFileUploadEnabled=this.isEmailCollectionEnabled="NotSet";this.hostManagedContextDataExplanationUrl=null;this.isRetrieveFormDataEnabled="NotSet"}}Object(l.a)(Nl,"UserFeedbackV2Config",null,[]);class Qj{constructor(){this.isScenarioEnabled=!1;this.scenarioType=this.question=null}}Object(l.a)(Qj,"UserFeedbackScenarioConfig",null,[]);class tl{constructor(){this.questionUIType=
this.questionUiBehaviour=this.questionUiBehavior=this.questionOptions=this.questionInstruction=null}}Object(l.a)(tl,"UserFeedbackScenarioQuestionDetails",null,[]);class Vj{constructor(){this.displayedStringInEnglish=this.displayedString=null}}Object(l.a)(Vj,"UserFeedbackScenarioQuestionStringType",null,[]);class ul{constructor(){this.fileType=this.fileName=this.base64Data=null}}Object(l.a)(ul,"UserFeedbackContextDataFileInformation",null,[]);class Vk{constructor(D){this.Dwh=2;this.Ewh=0;this.s5=D}nNi(D,
ma){D=D||{};t.AFrameworkApplication.ea.Nkc(D);D=this.s5.getContext(D);D.initialFeedbackType=this.cNd(this.Dwh);D.uiType=this.dNd(this.Ewh);const vb=D.telemetryGroup;switch(D.Application){case "Word":vb.featureArea="Add-ins";break;case "PowerPoint":vb.featureArea="Add-ins";break;case "Excel":vb.featureArea="Addins"}const lc=this.o4i(ma);lc.v2Config.contextDataFiles&&(D.isShareContextDataEnabled=!0,D.getContextData=()=>Promise.all(tf.a.map(lc.v2Config.contextDataFiles,Nc=>window.fetch("data:application/octet-stream;base64,"+
Nc.base64Data).then(wd=>wd.blob()).then(wd=>new File([wd],Nc.fileName,{type:Nc.fileType})))));(ma=lc.v2Config.scenarioConfig)&&(D.scenarioConfig=this.bNd(ma));this.US(D,"showEmailAddress",lc.v2Config.isEmailCollectionEnabled);this.US(D,"isFileUploadEnabled",lc.v2Config.isFileUploadEnabled);this.US(D,"screenshot",lc.v2Config.isScreenshotEnabled);this.US(D,"isScreenRecordingEnabled",lc.v2Config.isScreenRecordingEnabled);this.US(D,"isThankYouPageDisabled",lc.v2Config.isThankYouPageDisabled);this.US(D,
"isHostManagedContextDataEnabled",lc.v2Config.isHostManagedContextDataEnabled);this.US(D,"isRetrieveFormDataEnabled",lc.v2Config.isRetrieveFormDataEnabled);return D}o4i(D){var ma=Object(vg.j)(Vj,{displayedString:Object(Ba.a)("AddInSearchFeedbackButtonQuestion"),displayedStringInEnglish:"How satisfied are you with the Add-in search feature?"});const vb=Object(vg.j)(Vj,{displayedString:Object(Ba.a)("AddInSearchFeedbackButtonQuestionOption1"),displayedStringInEnglish:"Satisfied"}),lc=Object(vg.j)(Vj,
{displayedString:Object(Ba.a)("AddInSearchFeedbackButtonQuestionOption2"),displayedStringInEnglish:"The add-in search results do not meet my requirements"}),Nc=Object(vg.j)(Vj,{displayedString:Object(Ba.a)("AddInSearchFeedbackButtonQuestionOption3"),displayedStringInEnglish:"Need suggestions for search add-ins"}),wd=Object(vg.j)(Vj,{displayedString:Object(Ba.a)("AddInSearchFeedbackButtonQuestionOption4"),displayedStringInEnglish:"Need more info about each add-in"}),Yd=Object(vg.j)(Vj,{displayedString:Object(Ba.a)("AddInSearchFeedbackButtonQuestionOption5"),
displayedStringInEnglish:"Not interested in add-ins"});ma=Object(vg.j)(tl,{questionInstruction:ma,questionOptions:[vb,lc,Nc,wd,Yd],questionUiBehaviour:["CommentNotRequired"],questionUIType:"SingleSelect"});ma=Object(vg.j)(Qj,{isScenarioEnabled:!0,question:ma,scenarioType:"Custom"});D=Object(vg.j)(ul,{base64Data:D,fileName:"searchKeywords.txt",fileType:"text/plain; charset=utf-8"});D=Object(vg.j)(Nl,{contextDataFiles:[D],scenarioConfig:ma,isEmailCollectionEnabled:"False",isFileUploadEnabled:"True",
isScreenshotEnabled:"True",isScreenRecordingEnabled:"True",isHostManagedContextDataEnabled:"True",isRetrieveFormDataEnabled:"True"});return Object(vg.j)(sl,{v2Config:D})}cNd(D){switch(D){case 0:return"Smile";case 1:return"Frown";case 2:return"Idea";case 3:return"Unclassified";default:return"Unclassified"}}dNd(D){switch(D){case 0:return"Modal";case 1:return"SidePane";default:return"Modal"}}bNd(D){const ma={};ma.isScenarioEnabled=D.isScenarioEnabled;ma.scenarioType=D.scenarioType;if(D=D.question){const vb=
{};vb.questionUiType=D.questionUIType;vb.questionUiBehavior=D.questionUiBehavior;vb.questionUiBehaviour=D.questionUiBehaviour;vb.questionInstruction=D.questionInstruction;vb.questionOptions=D.questionOptions;ma.questionDetails=vb}return ma}US(D,ma,vb){"True"===vb?D[ma]=!0:"False"===vb&&(D[ma]=!1)}}Object(l.a)(Vk,"AppsFeedbackConfigForSearch",null,[]);class vl{constructor(D,ma,vb,lc,Nc,wd,Yd,ee,ae,he){this.HJg=ae;this.Iad={};this.gec={};this.GMe=0;this.tAb=this.qcc=null;this.byb={};this.vOa=void 0;
this.EJe=this.OZe=this.VGe=this.cyb=null;this.hZe=0;this.B8c=null;this.cRa="";this.Zhc=null;this.bic=!1;this.vDb=[];this.m7c=this.s5=null;this.qad=new Map;this.J1a=(De,Se)=>{this.o8?this.hok(Se):(this.gok(Se),!this.Tm.K9b&&this.SGe&&this.SGe.J1a(De,Se));this.Tm.jli&&2===Se.rF&&this.lhe(this.mYh)};this.k_=ma;this.qcc=this.Zga=null;this.jqh=lc;this.Mth=Nc;this.SGe=void 0===Yd?null:Yd;this.ya=(void 0===wd?null:wd)||t.AFrameworkApplication.ea;this.Tm=new dh(this.ya);this.XNe=ee;this.hkh=new Ml(this.Tm,
ma);this.k_.sxa(this.J1a);(null===appChrome||void 0===appChrome?0:appChrome.addInApi)&&appChrome.addInApi.loadOfficeAddInIcons();this.Tm.VGh&&this.ghe("OpenCloseChangedTelemetry",(De,Se)=>{uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddInFlyoutOpenCloseChanged",dataFields:lf.a.Bge({["PerformanceNow"]:performance.now(),["DateNow"]:new Date,["IsOpened"]:De,["OpenDuration"]:Se})})});this.Tm.Raa&&this.$Eg();Object(vg.h)((De,Se)=>{this.qad.forEach(qf=>{qf(De,Se)})});if(this.Tm.Raa||this.Tm.jOb)this.cyb=
new hk(this.ya,this.k_,this.ya.Qa("Application"),"en");this.Tm.jOb&&(this.VGe=he,this.OZe=new ql);this.Tm.p5e&&(this.EJe=new Sk,this.EJe.MCj());this.Tm.MHd&&(this.tAb=new pl("AddinBackstageFeedbackSurvey",this.Tm.DDi))}get x3h(){return this.gec}get lYh(){this.B8c||(this.B8c=new xk(this.ya));return this.B8c}get mYh(){this.qcc||(this.qcc=this.lYh.yef);return this.qcc}get euj(){const D=document.querySelector('[data-unique-id="Overflow-InsertAddInFlyout"]');return D?"hidden"!==window.getComputedStyle(D).visibility:
!1}ghe(D,ma){this.qad.set(D,ma)}i6g(D){this.qad.delete(D)}gok(D){if(D.Ym)for(let ma=0;ma<D.Ym.length;ma++)appChrome.addInApi.registerAddinIcon(kh.q+D.Ym[ma].solutionId,D.Ym[ma].iconUrl);else 0===D.errorCode&&B.ULS.sendTraceTag(509687429,220,10,"addinDetails is null which will lead to no icons registered")}get o8(){return!!this.ya&&this.ya.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",!1)}DMd(D){const ma=this.Tm.l5b,vb=ma?"more"===D?"AddinFlyoutMoreButton":"AddinFlyoutLessButton":
"AddinFlyoutMoreButton",lc=ma?"more"===D?Object(Ba.a)("AddinsFlyoutSeeAllButtonText"):Object(Ba.a)("AddinsFlyoutSeeLessButtonText"):Object(Ba.a)("AddinsFlyoutSeeAllButtonText");D=ma?"more"===D?Object(Ba.a)("AddinsPickerGalleryButtonMoreArialText"):Object(Ba.a)("AddinsPickerGalleryButtonLessArialText"):Object(Ba.a)("AddinsPickerGalleryButtonMoreArialText");return Object.assign(new ej.a,{Id:vb,ExternalId:vb,Icon:"AllApps_16",Command:this.Mth,LabelText:lc,FullIconStyle:{root:{maxWidth:"16px",maxHeight:"16px",
minWidth:"16px",minHeight:"16px",border:"1px solid var(--border-color, #c8c8c8)",borderRadius:"6px",padding:"15px 15px 15px 15px",overflow:"hidden"}},Role:"menuitem",Alt:D})}SUi(D,ma){var vb=void 0===vb?t.AFrameworkApplication.isRtl:vb;vb={["root"]:{["width"]:"32px",["height"]:"32px",["border-radius"]:"6px",["overflow"]:"hidden",["padding"]:"7px",["border"]:"1px solid var(--border-color, #c8c8c8)",["direction"]:vb?"ltr":void 0}};return Object.assign(new ej.a,{Id:ma,ExternalId:ma,Icon:kh.q+D.solutionId,
Command:this.jqh,LabelText:D.displayName,Role:"menuitem",FullIconStyle:vb,Alt:D.description})}KKf(D,ma){D=this.JKf("MRUAddinsGalleryControl",D,ma);return Object.assign(new vd.a,{Id:"MRUAddinsSection",ControlsId:"MRUAddinsSection.Controls",ControlList:[D],Title:Object(Ba.a)("MyAddinSection")})}JKf(D,ma,vb,lc){lc=void 0===lc?this.Tm.l5b:lc;const Nc=Object(vg.j)(ll,{SectionId:D+"Section",GalleryButtons:ma.map(wd=>this.SUi(wd,this.URi(wd)))});lc&&ma.length>kh.s?Nc.Collapse=new Pk(2,this.DMd("more"),this.DMd("less")):
vb&&Nc.GalleryButtons.push(this.DMd("more"));return Object(vg.j)(am.a,{Id:D,ExternalId:D,GalleryStyle:{["galleryStack"]:{["root"]:{margin:"0px",marginLeft:"12px",width:"100%",maxWidth:"unset"},["inner"]:{margin:"-4px",marginLeft:"0px",maxWidth:"333px",minWidth:"333px"}},["galleryButtonInExpanded"]:{["root"]:{width:100,height:100,backgroundColor:"transparent"},["flexContainer"]:{flexDirection:"column"},["label"]:{marginTop:"4px",maxWidth:"86px",fontSize:"12px",textOverflow:"ellipsis"}}},Width:3,Type:4,
GallerySections:[Nc],GalleryContextMenu:this.Tm&&this.Tm.p5e?{["primaryMenuId"]:"AddInFlyoutMRUContextMenu"}:null})}cVi(){const D=Object(vg.j)(vd.a,{Id:"FooterSection",ControlsId:"FooterSection.Controls",ControlList:[Object(vg.j)(kk.a,{ExternalId:"InsertMoreAddInsFromFooter",AriaDescription:Object(Ba.a)("AddinsPickerFooterButtonMoreArialText")})]});appChrome.api.dispatch(appChrome.actions.setControlLabel("InsertMoreAddInsFromFooter",Object(Ba.a)("AddinPickerButtonMore")));return D}fVi(D,ma){var vb,
lc,Nc,wd,Yd;const ee=[],ae=[],he=this.k_.oQ(0);Array.addRange(ae,he.Ym);const De=this.k_.oQ(1);Array.addRange(ae,De.Ym);D||ae.sort((sg,ng)=>{sg=xb.d(sg.displayName);ng=xb.d(ng.displayName);return Cc.a.localeCompare(sg,ng)});null===(vb=this.XNe)||void 0===vb?void 0:vb.addNotification(ae);this.Ffk(ae);let Se=ae.length,qf=!1;!this.Tm.l5b&&Se>kh.s&&(Se=kh.s-1,qf=!0);let kg=[];vb=null;!this.o8&&(null===(Nc=null===(lc=this.Zga)||void 0===lc?void 0:lc.Ym)||void 0===Nc?0:Nc.length)?(vb=this.Zga,kg=this.Zga.Ym):
(vb=this.k_.oQ(2),this.Zga=Object.assign({},vb),this.Zga.Ym=null,0!==vb.errorCode&&5!==vb.errorCode||vb.Ym.forEach(sg=>{-1!==sg.addinInfo.priority&&kg.push(sg)}));B.ULS.sendTraceTag(509687428,220,15,"The MRU list number is {0}, myAddins: {1}|{2}, adminManaged: {3}|{4}, popularAddins: {5}|{6}",Se,Jj.a[he.errorCode],he.Ym.length,Jj.a[De.errorCode],De.Ym.length,Jj.a[vb.errorCode],kg.length);this.k0.w$f(Se,he,De,vb);this.Tm.MHd&&this.tAb&&this.tAb.D1d();Nc=[];const $f=[];D&&(Array.addRange(Nc,this.GAi(this.cRa,
ae)),Array.addRange($f,this.mBf(this.vDb,ae)));const Cg=Object.assign(new vd.a,{Id:"HeaderSection",ControlsId:"HeaderSection.Controls",ControlList:[]});lc=Object.assign(new Fk.a,{Id:"Ribbon.AddinPicker",MenuSectionList:[],MenuHeaderSection:this.Tm.Raa?Cg:void 0,MenuFooterSection:this.cVi(),UpdateDynamically:!0,IsFlexLayout:!0});if(2!==he.errorCode&&2!==vb.errorCode||ae.length)if(3!==he.errorCode||this.k0.vXg(he)||3!==De.errorCode)if(4!==he.errorCode||ae.length){const sg=0>=Nc.length&&0>=$f.length;
if(this.Tm.Raa){const ng=D?String.format(sg?null!==(wd=Object(Ba.a)("AddInSearchNoResultsAriaText"))&&void 0!==wd?wd:"":null!==(Yd=Object(Ba.a)("AddInSearchResultsAriaText"))&&void 0!==Yd?Yd:"",this.cRa):null;Array.add(Cg.ControlList,this.RHi(ng));this.Tm.qGd?D&&(wd=t.AFrameworkApplication.Gv,this.s5||(this.s5=Object(Ha.f)(rl.a)),uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.InitializeContainerForFeedbackButtonInSearch",dataFields:lf.a.Eh({["IsContainerInitialized"]:(!!this.s5).toString()})}),
this.s5&&wd&&(Object(vg.a)("feedbackButtonInSearchResultView"),wd=Object(Ba.a)("AddInSearchFeedbackButtonDescriptionWithResult"),sg&&(wd=Object(Ba.a)("AddInSearchFeedbackButtonDescriptionWithNoResult")),wd=this.yQi(wd),Array.add(Cg.ControlList,wd))):Object(vg.d)("normalView","")}if(D)sg&&this.z9h(lc),0<Nc.length&&this.W8h(lc,Nc),0<$f.length&&this.f9h(lc,$f),D={},D.MRUAddins=Nc.map(ng=>Object(vg.b)(ng)),D.MoreAddins=$f.map(ng=>Object(vg.b)(ng)),D.HasResults=!sg,uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.SearchingAddinsFromFlyout",
dataFields:lf.a.Eh(D)});else{if(this.Tm.jOb&&0===ae.length&&!ma&&!this.euj)return this.KXg(),Object.assign(new Fk.a,{Id:"Ribbon.AddinPicker",MenuSectionList:[this.KKf([])],UpdateDynamically:!0});0<Se&&(lc.MenuSectionList.push(this.KKf(ae.slice(0,Se),qf)),t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&(D={["solutionIds"]:De.Ym.map(ng=>Object(vg.b)(ng))},uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.ShowAdminAddinFromFlyout",
dataFields:lf.a.Eh(D)})));D=this.o8?this.r3i(kg,ae,kh.u):this.nKh(kg,ae);D&&0!==D.length||(ee.push("emptyPopularAddins"),B.ULS.sendTraceTag(507523101,220,15,"The popular addins list is empty"));D=D.filter(ng=>!!ng).slice(0,kh.u);D=this.$Xi(D);lc.MenuSectionList.push(D)}}else ee.push("serviceDisabled"),B.ULS.sendTraceTag(508598107,220,10,"dataProvider serviceDisabled error hit"),D=this.nyc({iconName:kh.p,wDc:Object(Ba.a)("AddinPickerServiceDisconnectedError")}),Array.add(lc.MenuSectionList,D);else ee.push(this.k0.cKf(he,
De)),B.ULS.sendTraceTag(509687426,220,10,"dataProvider invokeFailure error hit"),D=this.nyc({iconName:kh.i,wDc:Object(Ba.a)("AddinPickerGeneralError")}),Array.add(lc.MenuSectionList,D);else ee.push("storeDisabled"),B.ULS.sendTraceTag(509687427,220,10,"dataProvider storeDisabled error hit"),D=this.nyc({iconName:kh.p,wDc:Object(Ba.a)("AddinPickerDisableError")}),Array.add(lc.MenuSectionList,D);this.SXh();0===lc.MenuSectionList.length&&(lc.IsFlexLayout=!1,ee.push("emptyMenuSection"),B.ULS.sendTraceTag(508340124,
220,15,"The menu section list length is 0"));this.k0.B1g&&B.ULS.sendTraceTag(508047442,220,15,`${ee.join("|")}`);this.k0.r$f&&this.k0.v$f(ae.length,ee,he,De,vb);return lc}SXh(){window.setTimeout(()=>{var D=document.querySelector(`#${kh.c} > .ms-FocusZone > div[class^="root"] > div[class^="container"]`);D&&(D=D.scrollTop,0<D&&(this.Tm.MHd&&this.tAb&&this.tAb.Z3a(),uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.ScrollableListView",dataFields:lf.a.Eh({["scrollTopValue"]:D.toString()})})))},
6E4)}$Xi(D){const ma=Object(vg.j)(vd.a,{Id:"PopularAddinListSection",ControlsId:"PopularAddinListSection.Controls",ControlList:D.map((vb,lc)=>this.oFf("PopularAddInsListItem"+lc,vb)),Title:Object(Ba.a)("PopularAddins")});t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&(D={["solutionIds"]:D.map(vb=>Object(vg.b)(vb))},uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.ShowPopularAddinFromFlyout",dataFields:lf.a.Eh(D)}));return ma}oFf(D,
ma){const vb={default:kh.q+ma.solutionId},lc=this.FOb(ma),Nc=[];var wd=ma.solutionId.toLowerCase();wd=Object.assign(new vj,{text:Object(Ba.a)("AddinOneLink"),href:kh.v+wd});Array.add(Nc,wd);return Object.assign(new Qk.a,{Id:D,ExternalId:D,CommandId:D,CommandIdMapped:$g.a.oXb.toString(),iconSet:vb,SecondaryLabel:null,Details:[],Label:ma.displayName,ActionText:D.includes("PAIYO_CategoryAddinListItem")?Object(Ba.a)("AddinListOpen"):Object(Ba.a)("AddinListAdd"),Description:ma.description,Links:Nc,ActionId:D+
kh.f,ActionIdMapped:$g.a.ZSb.toString(),ActionCommandValueId:lc,CommandValueId:lc})}yQi(D){return Object.assign(new Qk.a,{Id:"feedbackButtonInSearchResultView",ExternalId:"feedbackButtonInSearchResultView",CommandIdMapped:$g.a.Qwc.toString(),iconSet:{default:"PersonFeedback_16"},Label:D,Description:Object(Ba.a)("AddInSearchFeedbackButtonToolTip"),IsFeedbackButton:!0})}FOb(D){return this.o8?String.format("{0}#{1}",D.solutionId,D.storeId):D.solutionId}bGa(D){if(!D)return null;var ma=D.split("#");if(1!==
ma.length&&2!==ma.length)return B.ULS.sendTraceTag(508912466,220,10,"GetAddinDetailByUniqueId: uniqueId's format is wrong"),null;D=ma[0].trim();ma=2===ma.length?ma[1].trim():t.AFrameworkApplication.uiCulture;return this.k_.nQ(D,ma)}g0i(D){return D?this.cyb.nQ(D):null}Ndf(D){return D&&D.hasOwnProperty("solutionId")&&D.hasOwnProperty("version")&&D.hasOwnProperty("storeType")&&D.hasOwnProperty("storeId")&&D.hasOwnProperty("assetId")&&D.hasOwnProperty("assetStoreId")&&D.hasOwnProperty("targetType")&&
D.hasOwnProperty("displayName")&&D.hasOwnProperty("width")&&D.hasOwnProperty("height")?!0:!1}mCf(D){return new Promise((ma,vb)=>{if(this.Ndf(D))return ma(D);const lc=(new Date).getTime();this.cyb.fne("",(Nc,wd)=>Nc?1!==wd.length||wd[0].solutionId.toLowerCase()!==D.solutionId.toLowerCase()?vb(Error("The search add-in and result add-in don't match.")):this.Ndf(wd[0])?ma(wd[0]):vb(Error("The result add-in details are still not ready for install.")):vb(Error("Failed to query add-in details for install.")),
lc,D.solutionId)})}URi(D){if(!(D.solutionId in this.Iad)){const ma=kh.e+this.GMe.toString();this.Iad[D.solutionId]=ma;D=this.FOb(D);this.gec[ma]=D;this.gec[ma+kh.f]=D;this.GMe++;return ma}return this.Iad[D.solutionId]}iPd(D){return D?this.gec[D]:null}nyc(D){var {iconName:ma,wDc:vb,sAl:lc=!1,dBl:Nc=Object(Ba.a)("AddinPickerTryAgain"),cBl:wd=kh.k,Irl:Yd=kh.k}=D;D=Object.assign(new vd.a,{Id:"ErrorSection",ControlsId:"ErrorSection.Controls",ControlList:[]});let ee=null;ee=vb===Object(Ba.a)("AddinPickerDisableError")&&
this.ya&&this.ya.isChangeGateEnabled("OfficeVSO:8668453_StoreDisabledErrorViewWithDocumentLink")?Object.assign(new Ok.a,{Id:"ErrorView",ExternalId:kh.k+kh.p,IconName:ma,Label:vb,RetryButtonTitle:lc?Object(Ba.a)("AddinPickerTryAgain"):"",OnRetryCommandId:kh.k,AriaDescription:ma===kh.p?vb:Object(Ba.a)("AddinPickerTryAgainAriaLabel"),LinkText:Object(Ba.a)("AddinPickerDisableErrorDocumentText"),LinkUrl:String.format("https://learn.microsoft.com/{0}/microsoft-365/admin/manage/manage-addins-in-the-admin-center?view=o365-worldwide#manage-add-in-downloads-by-turning-onoff-the-office-store-across-all-apps-except-outlook",
t.AFrameworkApplication.uiCulture),OnLinkClicked:()=>{B.ULS.sendTraceTag(507875925,220,15,"User has clicked link on add-in picker error view")}}):Object.assign(new Ok.a,{Id:"ErrorView",ExternalId:Yd,IconName:ma,Label:vb,RetryButtonTitle:lc?Nc:"",OnRetryCommandId:wd,AriaDescription:ma===kh.p?vb:Object(Ba.a)("AddinPickerTryAgainAriaLabel")});Array.add(D.ControlList,ee);return D}nKh(D,ma){var vb,lc;let Nc=[];if(null===(lc=null===(vb=this.Zga)||void 0===vb?void 0:vb.Ym)||void 0===lc||!lc.length){vb=new Qc.a;
for(lc=0;lc<D.length;lc++)vb.add(D[lc]);vb.count>kh.u&&(vb=Object(vg.i)(vb,(new Date).getDate()));this.Zga?this.Zga.Ym=vb.toArray():Nc=vb.toArray()}return this.mBf(this.Zga?this.Zga.Ym:Nc,ma)}mBf(D,ma){const vb=new Set(ma.map(lc=>lc.solutionId.toLowerCase()));return D.filter(lc=>!vb.has(lc.solutionId.toLowerCase()))}aYi(D,ma){var vb=(new Date).getDate();ma>D.length&&(ma=D.length);var lc=new cm.a(vb);for(vb=new Set;vb.size<ma;){const Nc=lc.next(D.length);vb.add(Nc)}for(ma=0;ma<D.length;ma++)lc=D[ma].addinInfo,
vb.has(ma)?lc.AUP*=20:lc.AUP=1===lc.priority?4*lc.AUP:2===lc.priority?2*lc.AUP:1*lc.AUP;D.sort((Nc,wd)=>Nc.addinInfo.AUP<wd.addinInfo.AUP?1:-1);return D}r3i(D,ma,vb){D=D.filter(lc=>!ma.some(Nc=>Nc.solutionId.toLowerCase()===lc.solutionId.toLowerCase()));return this.aYi(D,vb).slice(0,vb)}hok(D){if(0===D.errorCode||2===D.rF&&5===D.errorCode)D.Ym?this.lhe(D.Ym):B.ULS.sendTraceTag(509687429,220,10,`fail to register icons for addin collection: ${Vh.a[D.rF]}`)}lhe(D){return Promise.all(D.map(ma=>{var vb,
lc;if(ma&&ma.solutionId&&ma.iconUrl)return appChrome.addInApi.registerAddinIcon(kh.q+ma.solutionId,ma.iconUrl);B.ULS.sendTraceTag(508352214,220,10,"failed to register icon for addin: solutionId: {1}, iconUrl: {2}",null!==(vb=null===ma||void 0===ma?void 0:ma.solutionId)&&void 0!==vb?vb:"null",null!==(lc=null===ma||void 0===ma?void 0:ma.iconUrl)&&void 0!==lc?lc:"null");return Promise.resolve()}))}RHi(D){var ma;const vb=String.format(null!==(ma=Object(Ba.a)("AddInSearchBoxRecommendationPlaceholder"))&&
void 0!==ma?ma:"",kh.n);return Object.assign(new bm.a,{ExternalId:kh.m,Label:vb,ShowIcon:!0,Underlined:!0,Value:this.cRa,ResultAriaLiveText:D,OnChangeCommandId:kh.m})}W8h(D,ma){const vb=Object.assign(new vd.a,{Id:"MRUAddinsSearchResutlsSection",ControlsId:"MRUAddinsSearchResutlsSection.Controls",ControlList:[]});Array.add(D.MenuSectionList,vb);D=this.JKf("MRUAddinsSearchResutlsGalleryControl",ma,!1,!1);Array.add(vb.ControlList,D)}f9h(D,ma){const vb=Object.assign(new vd.a,{Id:"PopularAddinsListSearchResutlsSection",
ControlsId:"PopularAddinsSearchResutlsSection.Controls",ControlList:[],Title:Object(Ba.a)("AddInSearchResultsDivider")});for(let lc=0;lc<ma.length;lc++)vb.ControlList.push(this.oFf("PopularAddinsSearchResultsItem"+lc,ma[lc]));Array.add(D.MenuSectionList,vb)}z9h(D){if(this.Tm.UGh){var ma=Object(vg.g)(Object(Ba.a)("AddInSearchNoResultsLink1"),kh.t),vb=Object(vg.g)(Object(Ba.a)("AddInSearchNoResultsLink2"),kh.r);ma="Excel"===this.Tm.host?String.format(Object(Ba.a)("AddInSearchNoResultsDescription2"),
ma,vb):String.format(Object(Ba.a)("AddInSearchNoResultsDescription3"),vb);ma=Object(vg.j)(Ok.a,{Id:"ErrorView",ExternalId:kh.k,IconName:"NoSearchResultsV2",Title:Object(Ba.a)("AddInSearchNoResultsTitle"),IsNoResultView:!0,LinkText:`${Object(Ba.a)("AddInSearchNoResultsDescription1")} ${ma}`});vb=Object(vg.j)(vd.a,{Id:"ErrorViewSection",ControlsId:"ErrorViewSection.Controls",ControlList:[]});Array.add(vb.ControlList,ma);Array.add(D.MenuSectionList,vb)}else ma=this.nyc({iconName:kh.j,wDc:Object(Ba.a)("AddInSearchNoResultsHint")}),
Array.add(D.MenuSectionList,ma)}GAi(D,ma){const vb=D.toLocaleLowerCase();D=ma.filter(lc=>{this.byb[lc.solutionId]||(this.byb[lc.solutionId]=lc.displayName.toLocaleLowerCase());return this.byb[lc.solutionId].includes(vb)});D.sort((lc,Nc)=>this.byb[lc.solutionId].indexOf(vb)-this.byb[Nc.solutionId].indexOf(vb));return D}async iEk(D){this.vDb=await this.cyb.pOg(D);await this.lhe(this.vDb)}jEk(D){this.cRa=D;appChrome.api.dispatch(appChrome.actions.updateSearchBoxValue(kh.m,D));this.Zhc&&window.clearTimeout(this.Zhc);
this.Zhc=window.setTimeout(()=>{var ma;this.Zhc=null;D?this.iEk(D).catch(()=>{this.vDb=[];B.ULS.sendTraceTag(507577680,220,10,"Failed to call search addins API")}).finally(()=>{var vb;this.cRa===D&&(this.qhg=!0,null===(vb=this.HJg)||void 0===vb?void 0:vb.call(this))}):(this.qhg=!1,null===(ma=this.HJg)||void 0===ma?void 0:ma.call(this))},kh.o)}Z7k(D){if(!this.s5&&(this.s5=Object(Ha.f)(rl.a),!this.s5))return;this.m7c||(this.m7c=new Vk(this.s5));var ma=JSON.stringify({["searchKeywords"]:this.cRa});ma=
unescape(encodeURIComponent(ma));const vb=this.m7c.nNi(D,btoa(ma)),lc=wd=>{uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.SubmitFeedbackInSearch",dataFields:lf.a.Eh({["IsFeedbackSubmitted"]:wd.toString()})})},Nc=wd=>{B.ULS.sendTraceTag(507249046,220,10,"Feedback error: "+wd)};Oc.a.aNd().then(wd=>{wd.initializeFeedbackModal(vb,lc,Nc);return wd})}set qhg(D){this.Tm.Raa||(this.bic=!1);this.bic=D}get aci(){let D=!1;this.bic&&(this.bic=!1,D=this.Tm.Raa);D||(this.cRa="",this.vDb=[]);return D}$Eg(){this.ghe("SetFocusToSearchBox",
D=>{const ma=document.getElementById(kh.c)||document.getElementById(kh.d);ma&&D&&ma.addEventListener("focus",()=>{var vb;return null===(vb=document.getElementById(kh.m))||void 0===vb?void 0:vb.focus()},{once:!0})})}xck(D){if(D)try{D.MenuItems=this.fVi(this.aci,D.IsShadowMenuOpen)}catch(ma){B.ULS.sendTraceTag(509687425,220,10,`GetReactGalleryMenu hit exception ${ma.message}; stack: ${ma.stack}`)}else B.ULS.sendTraceTag(509687424,220,10,"PopulateMenu menuProps is null")}KXg(){this.i6g("SetFocusToSearchBox");
this.ghe("SetFocusToStoreDialog",D=>{D&&Object(vg.c)()});new Uk(this.k_,this.Tm.host,this.Tm,this.cyb,this.VGe,this.hkh,this.OZe,this.U5j.bind(this),this.T5j.bind(this))}U5j(D,ma){this.hZe=D;uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.LaunchAddInStoreDialog",dataFields:lf.a.Bge({["IsDataProviderReady"]:ma})})}T5j(D,ma,vb,lc){this.i6g("SetFocusToStoreDialog");this.Tm.Raa&&this.$Eg();uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.CloseAddInStoreDialog",dataFields:lf.a.Bge({["OpenDuration"]:D-
this.hZe,["IsDataProviderReady"]:ma,["IsDialogRenderReady"]:vb,["DialogRenderTime"]:lc})})}dispose(){}Ffk(D){var ma;const vb=null===(ma=this.XNe)||void 0===ma?void 0:ma.sSa;D.sort((lc,Nc)=>{lc=null===vb||void 0===vb?void 0:vb.includes(lc.solutionId);Nc=null===vb||void 0===vb?void 0:vb.includes(Nc.solutionId);return lc&&!Nc?-1:!lc&&Nc?1:0})}get k0(){this.vOa||(this.vOa=new fk("Flyout",this.ya));return this.vOa}}Object(l.a)(vl,"AppsFlyoutGenerator",null,[4]);var Th=a(88),Wk=a(166);class wl{constructor(D,
ma,vb,lc,Nc,wd,Yd,ee){Yd=void 0===Yd?null:Yd;this.Kv=ee;this.disposed=!1;this.Mkc=this.Wlc=null;this.XFb=0;this.insertTab="Insert";this.homeTab="Home";this.A0f=this.Gse=!1;this.pDi=1E3;this.BDi="AddinFlyoutFeedbackSurvey";this.CDi=15E3;this.gse=!0;this.W9e=!1;this.PSh=t.AFrameworkApplication.ea.ka("IsNewStringEnabled")?`[{"title":"${CommonUiStrings.AddInCategoryTitleAddingPicturesIconsAndCharts}","solutionIds":["wa102957665","wa104381973","wa104051163","wa104104476","wa104379279","wa200000113","wa104380662","wa200004688","wa104379169","wa103147117","wa200004179","wa104380194","wa200003220","wa200004687"]},{"title":"${CommonUiStrings.AddInCategoryTitleImprovingProductivityWithAI}","solutionIds":["wa200005271","wa200004935","wa200001584","wa200005281","wa200005333"]},{"title":"${CommonUiStrings.AddInCategoryTitleDataSyncAndAnalysis}","solutionIds":["wa104100404","wa104379220","wa104380662","wa104380050","wa104381859","wa200002503","wa104381717","wa200003692","wa200000018","wa200000169","wa200001306","wa104381841","wa104379190","wa104381695","wa104380711","wa104380978","wa200003784"]}]`:
`[{"title":"${CommonUIStrings.l_AddInCategoryTitleAddingPicturesIconsAndCharts}","solutionIds":["wa102957665","wa104381973","wa104051163","wa104104476","wa104379279","wa200000113","wa104380662","wa200004688","wa104379169","wa103147117","wa200004179","wa104380194","wa200003220","wa200004687"]},{"title":"${CommonUIStrings.l_AddInCategoryTitleImprovingProductivityWithAI}","solutionIds":["wa200005271","wa200004935","wa200001584","wa200005281","wa200005333"]},{"title":"${CommonUIStrings.l_AddInCategoryTitleDataSyncAndAnalysis}","solutionIds":["wa104100404","wa104379220","wa104380662","wa104380050","wa104381859","wa200002503","wa104381717","wa200003692","wa200000018","wa200000169","wa200001306","wa104381841","wa104379190","wa104381695","wa104380711","wa104380978","wa200003784"]}]`;
this.N6i=(ae,he,De,Se)=>{if(ae){if(ae=this.bGa(ae,Se))ae={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(ae.solutionId,ae.storeType,ae.assetId,ae.storeId)},ae.href=he,ae.UILocation=De,ae.ControlId=Se,uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddInListLinkClickedFromFlyout",dataFields:lf.a.Eh(ae)})}else B.ULS.sendTraceTag(509089754,220,10,"Unique id is null.")};this.Avk=()=>{this.Mkc?this.Mkc.Exg():B.ULS.sendTraceTag(507896192,220,10,"_addInCategoryManager is null")};this.w8i=
(ae,he,De)=>{(ae=this.bGa(ae,De))?this.DP.mCf(ae).then(Se=>{const qf={};qf.solutionId=Se.solutionId;qf.version=Se.version;qf.storeType=Se.storeType;qf.storeId=Se.storeId;qf.assetId=Se.assetId;qf.assetStoreId=Se.assetStoreId;qf.targetType=Se.targetType;qf.displayName=Se.displayName;qf.width=Se.width;qf.height=Se.height;this.AQd(he,De,qf)}).catch(Se=>{B.ULS.sendTraceTag(507631067,220,10,Se.message)}):B.ULS.sendTraceTag(507631068,220,10,"No search add-in details.")};this.zQd=(ae,he,De)=>{if(this.Raa&&
(null===De||void 0===De?0:De.startsWith("PopularAddinsSearchResultsItem")))this.w8i(ae,he,De);else{if(this.DP.o8){const Se=this.bGa(ae,De);if(!Se){B.ULS.sendTraceTag(508872144,220,10,"Fail to get a valid AddinDetail with provided unique id.");return}ae=Se.p9b();this.a3&&(ae.isMetaosInstall=!0,ae.titleId=Object(ak.b)(Se.solutionId))}else ae=this.YJf(ae,De);ae?this.AQd(he,De,ae):B.ULS.sendTraceTag(509362325,220,10,"Get add-in entitlement fails.")}};this.AQd=(ae,he,De)=>{const Se={[Pa.a.zqa]:De,[$b.a.Bf]:this.Gc.mEa(De)},
qf=new Lc.a(-741808261,0,this.$.xc,ae,"");this.$.Ia.Gb(qf,Se);this.Gc.f2a("installAddinFromFlyout",OSF.AgaveHostAction.ClickTrust,De);ae={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(De.solutionId,De.storeType,De.assetId,De.storeId),["UILocation"]:ae,["ControlId"]:he};uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.InstallPopularAddinFromFlyoutListView",dataFields:lf.a.Eh(ae)})};this.BQd=(ae,he,De)=>{De=void 0===De?null:De;if(ae)if(ae=this.bGa(ae,De)){var Se=this.Gc.Cf;Se=
Se?Se.getAppUILocale()||"en-US":"en-US";this.Wlc=new ek(ae.solutionId,"wac_excel",Se,qf=>{this.Gc.f2a("installAddinFromFlyout",OSF.AgaveHostAction.ClickTrust,qf);const kg=new Lc.a(-741808261,0,this.$.xc,he,null);this.$.Ia.Gb(kg,{[Pa.a.zqa]:qf,[$b.a.Bf]:this.Gc.mEa(qf)});this.Wlc&&this.Wlc.hide();M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PopularAddinInstalledTelemetryEnabled",!0)&&(qf={["SolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(qf.solutionId,qf.storeType,qf.assetId,
null,null,qf.storeId),["UILocation"]:he,["ControlId"]:De},uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.InstallPopularAddinFromFlyout",dataFields:lf.a.Eh(qf)}))});this.Wlc.initializeAndShow("",null,null)}else B.ULS.sendTraceTag(508872143,220,10,"Can not find a valid addinDetail with provided unique id.");else B.ULS.sendTraceTag(509362328,220,10,"Unique id is null.")};this.I8i=(ae,he,De)=>{var Se;if(ae){if(this.DP.o8){ae=this.bGa(ae);if(!ae){B.ULS.sendTraceTag(508872141,220,10,"Can not find a valid addinDetail with provided unique id");
return}ae=ae.p9b()}else if(ae=this.YJf(ae),!ae){B.ULS.sendTraceTag(509089755,220,10,"Get add-in entitlement fails.");return}var qf={[Pa.a.zqa]:ae,[$b.a.Bf]:this.Gc.mEa(ae)},kg=new Lc.a(-741808261,0,this.$.xc,he,"");this.$.Ia.Gb(kg,qf);null===(Se=this.KVf)||void 0===Se?void 0:Se.QJj(ae.solutionId);M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MRUAddinInstalledTelemetryEnabled",!0)&&(he={["SolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(ae.solutionId,ae.storeType,ae.assetId,
null,null,ae.storeId),["UILocation"]:he,["ControlId"]:De},uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.InstallMRUAddinFromFlyout",dataFields:lf.a.Eh(he)}))}else B.ULS.sendTraceTag(509362326,220,10,"UniqueId is null.")};this.bGa=(ae,he)=>this.Raa&&(null===he||void 0===he?0:he.startsWith("PopularAddinsSearchResultsItem"))?this.DP.g0i(ae):this.DP.o8?this.DP.bGa(ae):this.zP.nQ(ae);this.vRf=(ae,he)=>{if(ae){var De={};De.solutionId=ae.solutionId;De.version=ae.version;De.storeType=ae.storeType;
De.storeId=ae.storeId;De.assetId=ae.assetId;De.assetStoreId=ae.assetStoreId;De.targetType=ae.targetType;De.displayName=ae.displayName;De.width=ae.width;De.height=ae.height;this.a3&&(De.isMetaosInstall=!0,De.titleId=Object(ak.b)(ae.solutionId));this.AQd(0,"AddinDialogControl"+he,De);ae={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(De.solutionId,De.storeType,De.assetId,null,null,De.storeId),["source"]:he};uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.InstallAddinFromStoreExp",
dataFields:lf.a.Eh(ae)})}else B.ULS.sendTraceTag(507332238,220,10,"AddinDetail is null.")};this.y8i=(ae,he)=>{ae?this.DP.mCf(ae).then(De=>{this.vRf(De,he)}).catch(De=>{B.ULS.sendTraceTag(507332236,220,10,De.message)}):B.ULS.sendTraceTag(507332237,220,10,"AddinDetail is null.")};this.F8i=()=>{const ae=new Lc.a(1296389134,0,this.$.xc,2,null);this.$.Ia.Gb(ae,{[$b.a.MZk]:"InsertMoreAddInsFromStoreDialog"});uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.LaunchAppForOfficeDialogFromStoreExp"})};
this.Mre=ae=>t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.flyoutStoreExpEnabled",!1)&&"InsertMoreAddInsFromFooter"===(null===ae||void 0===ae?void 0:ae.SourceControlId)?!0:!1;this.G8i=()=>{this.bcb&&this.$.fa.Kh.get(27)&&(this.DP.KXg(),uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.LaunchFlyoutStoreDialogFromFooter"}))};this.qTj=(ae,he)=>{if(he)if(he)if(ae=he.km){if(me()||Ld()){const Se=this.$.fa.workbookContext.WebExtensions;if(Se){let qf=!1;for(var De of Se)if(De.PrimaryMarketplace.SolutionId.toLowerCase()===
ae.solutionId.toLowerCase()){qf=!0;break}if(!qf){B.ULS.sendTraceTag(512258444,220,15,"Not find add-in persisted in the template file.");return}}else{B.ULS.sendTraceTag(512258443,220,15,"Has no add-in persisted in the file.");return}}he=he.Hq;De=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(ae.solutionId in De)he=De[ae.solutionId];else if(he=this.qNi(he),void 0===he||null===he){B.ULS.sendTraceTag(528098434,220,15,"addinCommandControlId is NullOrUndefined");return}De=
new Lc.a($g.a.Laa,0,0,2,null);this.executeCommand(0,De,{["SourceControlId"]:he},null);ae.isAutoLaunched=!0}else B.ULS.sendTraceTag(528098435,220,15,"insertionParam is null");else B.ULS.sendTraceTag(528098436,220,15,"agaveParams is null");else B.ULS.sendTraceTag(528098437,220,15,"No args for OnAutoLaunchAddin event")};this.v5j=(ae,he)=>{null==he?uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:lf.a.Eh({["AppTeachingUICalloutAction"]:"InvalidEventArgs",["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"})}):M.EwaSettings.isChangeGateEnabled("OfficeVSO:8180233_AddNullCheck")&&isNullOrUndefined(this.$)||(this.Dvb=new Mi(this),this.Dvb.epk(he),ae=this.$.Ia,M.EwaSettings.isChangeGateEnabled("OfficeVSO:8058447_FixCDTeachingCalloutAnchorAfterFlyoutEnabled")&&this.bcb?this.aya?(he=appChrome.selectors.getSelectedTabId())&&xb.a(he,this.homeTab)?this.Dvb.MXg():null!==ae&&(ae.gpd(this.uae),B.ULS.sendTraceTag(508564945,220,50,"Register home tab switched event")):B.ULS.sendTraceTag(508564944,
802,50,"selector is not ready"):null!==ae&&(ae.gpd(this.uae),B.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))};this.uae=(ae,he)=>{ae=this.insertTab;M.EwaSettings.isChangeGateEnabled("OfficeVSO:8058447_FixCDTeachingCalloutAnchorAfterFlyoutEnabled")&&this.bcb&&(ae=this.homeTab);he.tabName===ae&&(he=this.$.Ia,null!=he&&(he.PHg(this.uae),B.ULS.sendTraceTag(527286662,220,50,"Remove insertTabSwitched handler")),this.Dvb.MXg())};this.W0j=(ae,he)=>{ae=null;he&&(ae=he);(null===ae||void 0===
ae?0:ae.Hq)&&this.lMk(ae.Hq);this.$.Sg();ae&&ae.km&&this.cNh(ae.km)};this.qbl=(ae,he)=>{he.rF===Vh.a.sOj&&(this.XFb|=1);he.rF===Vh.a.JHh&&(this.XFb|=2);!t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableExcelAddinFlyoutButton",!1)&&this.zUg()&&appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("InsertAddInFlyout",!1))};this.$=D;B.ULS.shipAssertTag(537170659,0,!(void 0===ma||null===ma),`AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: ${Wk.a.create()}`);
this.Gc=ma;this.gif=vb;this.Slc=lc;this.Eha=Nc;this.ZFb=wd;this.Pr=new Mk.a;this.yqa=new Tj;this.Hsa=Yd;Ij.a.Wjb=Ij.a.rzf;this.YAd=[];this.Vfb=[];this.bcb&&(this.Gse=t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowFlyoutSurveyOnExcelEnabled",!1),this.zP=this.Gc.zP,null!==this.zP?(this.Mkc=this.yMc?new lk(t.AFrameworkApplication.ea,this.zP,this.PSh):null,this.KVf=new zi(this.zP),this.DP=new vl(t.AFrameworkApplication.Kb,this.zP,$g.a.nXb.toString(),$g.a.nnb.toString(),
this.l5b?"-1777747317":"1296389134",t.AFrameworkApplication.ea,this.Mkc,this.KVf,()=>{var ae;return null===(ae=this.Kv)||void 0===ae?void 0:ae.call(this,"InsertAddInFlyout")},{zQd:this.vRf.bind(this),x8i:this.y8i.bind(this),E8i:this.F8i.bind(this)}),this.zP.sxa(this.qbl)):B.ULS.sendTraceTag(509362330,220,10,"addinDetailsProvider is null"))}get bcb(){return t.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:8500191_EnableHomeEntrywithFlyout")&&t.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")}get yMc(){return t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewBackstageEnabled",
!1)}get Raa(){return t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchBoxEnabled",!1)}get qGd(){return t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FeedbackButtonForSearchEnabled",!1)}get l5b(){return t.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:8668457_SeeMoreSeeLessEnabled")}get isBusinessUser(){return!!t.AFrameworkApplication.tc.IsBusinessUser}get isEduUser(){return!!t.AFrameworkApplication.tc.IsEduUser}get isAnonymousUser(){return t.AFrameworkApplication.ea.ka("IsAnonymousUser")}cSh(){return`IsBusinessUser: ${this.isBusinessUser}, IsEduUser: ${this.isEduUser}, IsAnonymousUser: ${this.isAnonymousUser}`}dispose(){void 0!==
this.ZFb&&null!==this.ZFb&&(this.ZFb.dispose(),this.ZFb=null);this.Gc=this.$=null;this.disposed=!0}eRk(D,ma){switch(D){case $g.a.Laa:D=this.NQk(ma);break;default:D=!1}return D}gd(D,ma){return"Dev Box"===t.AFrameworkApplication.ea.Qa("StatusBarEnvironmentNameToUse")?!1:619219938===ma?(M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TempTelemetryOfInsertAddInFlyout",!1)&&Object(Ng.a)("getRibbonSubComponentStatus")&&(D=appChrome.api.getRibbonSubComponentStatus("insertAddInFlyout"),
B.ULS.sendTraceTag(507909329,220,50,`insertAddInFlyout status=${D}`)),!this.zUg()):!1}executeCommand(D,ma,vb){D=E.TaskExtensions.kl();var lc=ma.command;ma=wd=>{let Yd=null;if(!wd)return Yd;(Yd=wd.CommandValueId)||(Yd=this.DP.iPd(wd.SourceControlId));Yd||B.ULS.sendTraceTag(508560270,220,10,"UniqueId is null.");return Yd};switch(lc){case 843847158:break;case $g.a.nXb:this.Z3a();var Nc=vb.UILocation;this.yMc?(vb=ma(vb),this.BQd(vb,Nc)):(vb=vb.SourceControlId)?this.BQd(this.DP.iPd(vb),Nc):B.ULS.sendTraceTag(509362329,
220,10,"Control id is null.");break;case $g.a.oXb:this.Z3a();ma=this.yMc?ma(vb):vb.CommandValueId;Nc=vb.UILocation;lc=vb.SourceControlId;"LinkClickedPayload"===vb.Type?this.N6i(ma,vb.Href,Nc,lc):this.BQd(ma,Nc,lc);break;case $g.a.bne:this.Raa&&this.DP.jEk(null!==(Nc=vb.SearchBoxNewValue)&&void 0!==Nc?Nc:"");break;case $g.a.Qwc:this.qGd&&this.DP.Z7k(vb);break;case $g.a.QMb:this.W9e||(this.zP.sxa(this.Avk),this.W9e=!0);break;case $g.a.ZSb:this.Z3a();this.zQd(vb.CommandValueId,vb.UILocation,vb.SourceControlId);
break;case $g.a.nnb:this.Z3a();Nc=vb.UILocation;lc=vb.SqmControlId;const wd=vb.SourceControlId;if(this.yMc)vb=ma(vb);else{if(!wd){B.ULS.sendTraceTag(508440995,220,10,"ControlId is null.");break}vb=this.DP.o8?this.DP.iPd(wd):this.DP.x3h[wd]}this.I8i(vb,Nc,null!==lc&&void 0!==lc?lc:wd);break;case -2025863019:Xf.a.Ese(vb[Pa.a.rpd].toString(),()=>{w.f(this.$).focus()});break;case -1777565636:Nk.a.showUILessDialog(vb[Pa.a.$Fb].toString());this.Gc.NUk(vb[Pa.a.$Fb].toString());break;case 1592314317:Nk.a.hideUILessDialog(vb[Pa.a.$Fb].toString());
this.Gc.$bj(vb[Pa.a.$Fb].toString());break;case $g.a.Laa:D=this.kQd(vb);break;case $g.a.lnb:this.mXb(vb);break;case $g.a.sB:this.ihk(vb);break;case $g.a.Ama:this.Ama(vb);break;case $g.a.i7b:this.ZFb.rZc();break;case $g.a.refreshAddinCommands:this.Mmk();break;case 1949669462:this.Eha.QQg(!0);break;case -1014260128:D=this.executeDynamicAddInCommandsAPI(vb);break;case 1296389134:t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.flyoutStoreExpEnabled",!1)&&this.G8i();break;
default:D=G.a(lc)}return D}Rc(D,ma,vb,lc){let Nc=!1;switch(ma.command){case $g.a.oXb:case $g.a.ZSb:case $g.a.nXb:case $g.a.nnb:case $g.a.bne:case $g.a.Qwc:case $g.a.QMb:Nc=!!vb;break;case 843847158:case -2025863019:case -1777565636:case 1592314317:case $g.a.sB:case $g.a.Ama:case $g.a.i7b:case $g.a.refreshAddinCommands:case 1949669462:case $g.a.lnb:case -1014260128:Nc=!0;break;case $g.a.Laa:Nc=t.AFrameworkApplication.ZW;break;case 1296389134:Nc=this.Mre(vb)&&1===D&&!!lc&&1===lc.DH}return Nc}zUg(){return!M.EwaSettings.isChangeGateEnabled("OfficeVSO:8162137_NullCheckForFlyoutControlEnabled")||
void 0!==this.$&&null!==this.$?t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableExcelAddinFlyoutButton",!1)?this.$.ZW&&!M.EwaSettings.Ra(174):0!==this.XFb&&this.$.ZW&&!M.EwaSettings.Ra(174):(B.ULS.sendTraceTag(508380621,220,15,"ewaControl is null"),!1)}td(D,ma,vb){switch(ma){case "PopulateAddInGallery":if(t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.shadowRenderMenuFixEnabled",!1)&&vb.IsShadowMenuOpen)return!0;M.EwaSettings.isChangeGateEnabled("OfficeVSO:7653071_PopulateAddInGalleryTelemetryEnabled")&&
uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.PopulateAddinGallery",dataFields:lf.a.Eh({})});M.EwaSettings.isChangeGateEnabled("OfficeVSO:8464891_ShowUserSegmentInformationEnabled")&&uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.UserSegmentInformation",dataFields:lf.a.Eh({["UserSegment"]:this.cSh()})});this.DP.xck(vb);this.Gse&&(this.Z3a(),this.D1d());return!0;default:return!1}}D1d(){e.a.instance.getItem("AddinFlyoutOnExcelSurveyShowed")&&(this.gse=!1);this.gse&&(window.setTimeout(()=>
{const D=this.Ozc();D&&"hidden"!==D.visibility&&(this.A0f=!0)},this.pDi),this.ZFg=window.setTimeout(()=>{this.J0g=Object(Ha.d)(hf.a);e.a.instance.setItem("removeFlyoutTaskTimeoutId",this.ZFg.toString());this.A0f&&this.J0g&&this.J0g.execute(D=>{const ma=this.Ozc();ma&&"hidden"===ma.visibility&&(D.R5a(this.BDi,null),this.gse=!1,e.a.instance.setItem("AddinFlyoutOnExcelSurveyShowed","1"))})},this.CDi))}Ozc(){let D=null;try{const ma=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");ma&&(D=rk.a.Ez(ma.parentNode.parentNode.parentNode))}catch(ma){B.ULS.sendTraceTag(508911886,
220,10,"AddinFlyout get parent and parent get exception "+(ma?ma.toString():""))}return D}Z3a(){this.Gse&&(window.clearTimeout(this.ZFg),e.a.instance.removeItem("removeFlyoutTaskTimeoutId"))}qNi(D){if(!D)return B.ULS.sendTraceTag(528098432,220,10,"Failed to get button id for addin"),null;if((D=D.q3)&&D.px&&0<D.px.count)for(const ma of D.px){if(ma.groups&&1===ma.groups.length){D=ma.groups[0];if(D.controls&&1===D.controls.length){const vb=D.controls[0];if(vb.attributes&&!vb.controlType&&vb.enabled)return vb.id}D.controls&&
B.ULS.sendTraceTag(528098403,220,15,"It has multiple buttons")}ma.groups&&B.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}return null}get eI(){return t.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&t.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}ihk(D){if(D&&Pa.a.k6 in D)if(this.Gc){var ma=D[Pa.a.k6];this.eI?Pa.a.Xlc in D&&(D=D[Pa.a.Xlc],this.Gc.Rrb(ma,D),1===D&&this.sB(ma,!0)):this.sB(ma,
!0)}else B.ULS.sendTraceTag(509686150,220,10,"QueryAddinDetails: abort because ddaFacadeService is null..");else B.ULS.sendTraceTag(509686151,220,10,"queryAddinDetailsWithActionData: invalid actionData.")}sB(D,ma){ma=void 0===ma?!1:ma;this.Gc?(B.ULS.sendTraceTag(509686149,220,50,"QueryAddinDetails: providerType: {0}, refreshRequired: {1}",D,ma),this.Gc.sB(D,ma)):B.ULS.sendTraceTag(508564227,220,50,"QueryAddinDetails: abort because ddaFacadeService is null.")}Mmk(){if(this.Eha.wKc()){this.Eha.Fef();
var D=this.UJd();if(D&&0<D.length)for(const ma of D)D={[Pa.a.k6]:ma,[Pa.a.j0]:4,[Pa.a.pSa]:(new Date).getTime()},this.Ama(D)}else t.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&(B.ULS.sendTraceTag(509686148,220,50,"refreshAllAddinCommands: LoadingCompleteForAllProviders() returns {0}",this.Eha.wKc()),this.sB(10,!0),this.sB(0,!0))}Ama(D){B.ULS.sendTraceTag(537170657,220,50,`Launch AddinCommands entitlements list, LaunchOperationType ${D[Pa.a.j0]}, DataProvider ${D[Pa.a.k6]}.`);
this.Eha.hIk();window.setTimeout(()=>{if(void 0===this.Gc||null===this.Gc)B.ULS.sendTraceTag(537170656,220,10,`AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: ${Wk.a.create()}`);else{const ma=new Ff(new ag(this.Gc.Cf),ug.instance,Yf.instance);ma.zCh((vb,lc)=>{t.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&this.sB(D[Pa.a.k6]);this.mXb(lc.properties)});ma.lGh(this.v5j);ma.T9k(D)}},
0)}mXb(D){if(!this.disposed){B.ULS.sendTraceTag(537170655,220,50,`LaunchOperationType ${D[Pa.a.j0]}.`);try{if(M.EwaSettings.Ra(174)){var ma=D[Pa.a.YFb];const Nc=ma?ma.toArray():void 0;if(Nc&&0<Nc.length){const wd=Nc.length;for(ma=wd-1;0<=ma;ma--)OSF.OsfControl.isFirstPartyStoreString(Nc[ma].storeType)||Nc.splice(ma,1);if(Nc.length<wd){const Yd=Object(Th.d)(L.a.resolve(K.BusinessBarManagerService,{xa:0}));E.TaskExtensions.tb(Yd,()=>{Yd.result.lh(36,null)},this.$.Aa,3)}if(!Nc.length)return}}if(void 0===
this.Gc||null===this.Gc)B.ULS.sendTraceTag(537170654,220,10,`LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: ${Wk.a.create()}`);else{var vb=null;vb=t.AFrameworkApplication.ea.ka("HostInstallAddInsIsEnabled")?new dj(this.Pr,this.gif,new ag(this.Gc.Cf),new Lk(this.$.Oc,$g.a.Laa),this.Eha,ug.instance,this.yqa,(Nc,wd)=>{const Yd={};Yd.InstanceId=Bj.a.create().toString();Yd.PrimaryMarketplace={};Yd.PrimaryMarketplace.SolutionId=Nc.solutionId;Yd.PrimaryMarketplace.SolutionVersion=
Nc.version;Yd.PrimaryMarketplace.MarketplaceType=Nc.storeType;Yd.PrimaryMarketplace.MarketplaceRef=Nc.storeId;Yd.WebExtensionType=1;this.Gc.DXk(Yd,()=>{wd(Nc)})}):new dj(this.Pr,this.gif,new ag(this.Gc.Cf),new Lk(this.$.Oc,$g.a.Laa),this.Eha,ug.instance,this.yqa);vb.GCh(this.qTj);vb.ACh(this.W0j);var lc=new Mi(this);vb.GEh(lc.V0j);vb.kGh(lc.tUk);this.$.ra.Tb(53).um&&hl.a.get_instance().Mg(5,null).continueWith(()=>{this.disposed||vb.DBj(this.Hsa,this.$.domElement,D)})}}catch(Nc){B.ULS.sendTraceTag(537170653,
220,10,`LaunchAddinCommands error message : ${Nc.message}.`)}}}kQd(D){const ma=E.TaskExtensions.kl();D=D[this.Pr.Gra];const vb=this.Slc.mmd(D),lc=new Nk.a(this.$,this.Gc,vb.ownerAddinInfo,ma);return this.uQf(ma,D,vb,lc)}uQf(D,ma,vb,lc){this.Slc.kQd(ma,this.Eha,lc,new ag(this.Gc.Cf),vb,()=>{D=lc.C2h()},()=>{w.f(this.$).focus()});return D}cNh(D){const ma=E.TaskExtensions.kl();var vb=this.Gc.UX(D.solutionId);if(vb){var lc=this.Gc.JT(vb);if(wb.HelperMethods.cB(lc)&&0!==lc.SharedRuntime.State)return}lc=
this.Slc.dNh;const Nc=D.solutionId in lc?lc[D.solutionId]:null;if(Nc){const wd=this.Slc.mmd(Nc),Yd=new Nk.a(this.$,this.Gc,wd.ownerAddinInfo,ma),ee=Telemetry.PrivacyRules.GetPrivacyCompliantId(D.solutionId,null!==wd.ownerAddinInfo?wd.ownerAddinInfo.storeType:D.storeType,D.assetId,null,null,D.storeId);lc=ae=>{if(ae){const he={};for(const De of ae)he[De[0]]=De[1];(ae=Pa.a.m5e in he?he[Pa.a.m5e]:null)&&"true"===ae.toLowerCase()&&(B.ULS.sendTraceTag(537170652,220,50,`Auto-Show AddinCommands TaskPane, StoreType ${D.storeType}, StoreId ${D.storeId}, SolutionId ${ee}.`),
this.uQf(ma,Nc,wd,Yd))}};B.ULS.sendTraceTag(537170651,220,50,`Check Auto-Show AddinCommands TaskPane, StoreType ${D.storeType}, StoreId ${D.storeId}, SolutionId ${ee}.`);if(vb)lc(this.Gc.JT(vb).OsfPropertyBag);else if(vb=this.$.fa.workbookContext.WebExtensions)for(const ae of vb)if((1===ae.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===D.targetType&&ae.PrimaryMarketplace.MarketplaceType.toLowerCase()===D.storeType.toLowerCase()&&ae.PrimaryMarketplace.MarketplaceRef.toLowerCase()===
D.storeId.toLowerCase()&&ae.PrimaryMarketplace.SolutionId.toLowerCase()===D.solutionId.toLowerCase()){lc(ae.OsfPropertyBag);break}}}fwe(D,ma,vb){if(D){void 0===vb||!vb||ma||this.YAd.includes(D)||this.YAd.push(D);if((vb=this.Vfb.includes(D))&&ma){const lc=this.Vfb.indexOf(D);-1<lc&&this.Vfb.splice(lc,1)}vb||ma||this.Vfb.push(D)}}lMk(D){if((D=D.q3)&&D.px)for(const ma of D.px)if(ma.groups)for(const vb of ma.groups)if(vb.controls)for(const lc of vb.controls)if(this.fwe(lc.id,lc.enabled,!0),1===lc.controlType&&
lc.menuItems)for(const Nc of lc.menuItems)this.fwe(Nc.id,Nc.enabled,!0)}UJd(){const D=[];M.EwaSettings.Ra(52)&&(this.$.fa.Kh.get(27)&&(D.push(0),D.push(16)),this.$.fa.Kh.get(33)&&D.push(1),D.push(8));return D}executeDynamicAddInCommandsAPI(D){let ma=!0;if(void 0===D||null===D||void 0===D[Pa.a.pMb]||null===D[Pa.a.pMb])return bd.Task.Va(!1);switch(D[Pa.a.pMb]){case 1:ma=this.kcl(D);break;case 2:ma=this.pMk(D);break;case 4:this.Vfb=[...this.YAd];break;case 3:ma=this.installContextualTab(D);break;default:ma=
!1}return bd.Task.Va(ma)}NQk(D){return D&&this.Pr.Gra in D?(D=D[this.Pr.Gra])?this.Vfb.includes(D):!1:!1}kcl(D){var ma=null;let vb=null,lc=null,Nc=!0;void 0!==D[Pa.a.$ba]&&null!==D[Pa.a.$ba]&&void 0!==D[this.Pr.Gra]&&null!==D[this.Pr.Gra]&&void 0!==D[Pa.a.Zba]&&null!==D[Pa.a.Zba]&&(ma=D[Pa.a.$ba],vb=D[Pa.a.Huc],lc=D[this.Pr.Gra],Nc=D[Pa.a.Zba]);if(!ma||!lc)return B.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),!1;D=(new sk.a(this.$.Oc,ma,this.Pr,
!0)).$Wa(lc);ma={DynamicAddinCommandsApiName:"UpdateControlEnableState"};ma.AssetId=vb;ma.MaskedTabId=D;ma.IsToEnable=Nc;B.ULS.sendTraceTag(537170648,220,50,cc.a.Nc(ma));this.fwe(D,Nc);Zj.a.Xv.ax();return!0}pMk(D){var ma,vb,lc=null,Nc=null;let wd=null;var Yd=null;let ee=!0;void 0!==D[Pa.a.PCd]&&null!==D[Pa.a.PCd]&&void 0!==D[Pa.a.$ba]&&null!==D[Pa.a.$ba]&&void 0!==D[this.Pr.Gra]&&null!==D[this.Pr.Gra]&&void 0!==D[Pa.a.Zba]&&null!==D[Pa.a.Zba]&&(lc=D[Pa.a.PCd],Nc=D[Pa.a.$ba],wd=D[Pa.a.Huc],Yd=D[this.Pr.Gra],
ee=D[Pa.a.Zba]);if(!lc||!Nc||!Yd)return B.ULS.sendTraceTag(537170647,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),!1;D=(new sk.a(this.$.Oc,Nc,this.Pr,!0)).oOf(Yd);Yd={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};Yd.StoreType=lc;Yd.AssetId=wd;Yd.MaskedTabId=D;Yd.IsToShow=ee;B.ULS.sendTraceTag(537170646,220,15,cc.a.Nc(Yd));lc=this.Eha.Qsa(lc,Nc,1);Nc=!1;if(null===(vb=null===(ma=null===lc||void 0===lc?void 0:lc.Hq)||void 0===ma?void 0:ma.q3)||void 0===vb?0:vb.px)for(const ae of lc.Hq.q3.px)if(ae.id===
D){Nc=!0;break}if(!Nc)return B.ULS.sendTraceTag(537170645,220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1;ma=[];ee?appChrome.selectors.getSelectedTabId()!==D&&ma.push(appChrome.actions.activateRibbonTab(D)):(appChrome.selectors.getSelectedTabId()===D&&ma.push(appChrome.actions.setCurrentTab(F.a.rR)),ma.push(appChrome.actions.deactivateRibbonTab(D)));appChrome.api.dispatch(ma);return!0}YJf(D,ma){if(this.zP){if(D=this.bGa(D,ma))return ma={},ma.solutionId=D.solutionId,ma.version=D.version,
ma.storeType=D.storeType,ma.storeId=D.storeId,ma.assetId=D.assetId,ma.assetStoreId=D.assetStoreId,ma.targetType=D.targetType,ma.displayName=D.displayName,ma.width=D.width,ma.height=D.height,this.a3&&(ma.titleId=Object(ak.b)(D.solutionId),ma.isMetaosInstall=!0),ma;B.ULS.sendTraceTag(509362324,0,10,"Get addinDetail fail.");return null}B.ULS.sendTraceTag(509362323,0,10,"No addinDetailManager instance.");return null}installContextualTab(D){let ma=null,vb=null,lc=null;var Nc=null;if(void 0!==D[Pa.a.$ba]&&
null!==D[Pa.a.$ba]&&void 0!==D[Pa.a.Zba]&&null!==D[Pa.a.Zba]){const wd=D[Pa.a.Zba];ma=D[Pa.a.$ba];void 0!==wd[Pa.a.uVa]&&null!==wd[Pa.a.uVa]&&void 0!==wd[Pa.a.vVa]&&null!==wd[Pa.a.vVa]&&(vb=wd[Pa.a.uVa],lc=wd[Pa.a.vVa],Nc=wd[Pa.a.QCd])}if(!(ma&&lc&&vb&&Nc))return B.ULS.sendTraceTag(537170644,220,15,"InstallContextualTab failed to invalid parameters"),!1;D=this.Eha.Qsa(Nc.PrimaryMarketplace.MarketplaceType,Nc.PrimaryMarketplace.SolutionId,1);if(null===D||void 0===D?0:D.Hq)return B.ULS.sendTraceTag(537170643,
220,15,"InstallContextualTab was called multiple times"),!1;D={};D.solutionId=Nc.PrimaryMarketplace.SolutionId;D.version=Nc.PrimaryMarketplace.SolutionVersion;D.storeType=Nc.PrimaryMarketplace.MarketplaceType;D.storeId=Nc.PrimaryMarketplace.MarketplaceRef;Nc.AssetMarketplace?(D.assetId=Nc.AssetMarketplace.SolutionId,D.assetStoreId=Nc.AssetMarketplace.MarketplaceRef):(D.assetId=null,D.assetStoreId=null);D.targetType=Nc.WebExtensionOsfControlType;D.width=Nc.TaskpaneWidth;D.height=0;D.isAddinCommands=
!0;Nc={};Nc[Pa.a.YFb]=new Qc.a([D]);Nc[Pa.a.j0]=6;Nc[Pa.a.uVa]=vb;Nc[Pa.a.vVa]=lc;this.mXb(Nc);return!0}get aya(){return!!window.appChrome&&!!appChrome.selectors}get a3(){return t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MosForWXPEnabled",!1)}}Object(l.a)(wl,"AddinUICommandHandler",null,[361,29,4]);var Cj=a(51);class mk{constructor(D,ma,vb,lc){this.bre=void 0===D?null:D;this.vmd=void 0===ma?null:ma;this.MAd=void 0===vb?null:vb;this.wNb=void 0===lc?0:lc}EMa(){return this.bre()}activate(){return this.vmd()}deactivate(){this.MAd()}dispose(){this.MAd=
this.vmd=this.bre=null}}Object(l.a)(mk,"FeatureActivator",null,[15,4]);var Xk=a(56),Rj=a(46);class xl extends Jg.a{constructor(D){super(D);this.handler=null;this.Lxh=()=>{B.ULS.sendTraceTag(38410434,0,50,`AddinUICommandHandlerFactory.ActivateFeature, isEditMode [${this.$.isEditMode}] ShowCommandUI [${!!(this.$.$d&16384)}]`);const ma=new Mg.a;this.$.ra.Vc(53,he=>{B.ULS.sendTraceTag(38410435,0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");ma.setResult(he)});
const vb=ma.task,lc=new Nd,Nc=ke.a.getInstance(),wd=new Ne(this.$,Nc),Yd=kc.GetServiceTaskFactory.create(this.$.ra,203,this.Aa,this.Cc),ee=this.ynk(lc),ae=Object(Th.d)(L.a.resolve(K.OAuthManagerWrapperService,{xa:this.Cc}));return E.TaskExtensions.tb(E.TaskExtensions.jl([vb,Yd,ee,ae],this.Aa),()=>{B.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");K.DdaFacadeService.Oa()?void L.a.resolve(K.DdaFacadeService,{xa:this.Cc}).then(he=>
{let De;if(t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchBoxEnabled",!1)){const Se=vb.result;De=qf=>{var kg,$f;return null===($f=null===(kg=null===Se||void 0===Se?void 0:Se.um)||void 0===kg?void 0:kg.Kv)||void 0===$f?void 0:$f.call(kg,qf)}}else De=()=>{};this.handler=new wl(this.$,he,lc,new bg,Nc,wd,Object(Ha.f)(hc.a),De);B.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");this.fn([this.handler]);
this.$.ra.zc(198,this.handler)}):E.TaskExtensions.tb(kc.GetServiceTaskFactory.create(this.$.ra,106,this.Aa,this.Cc),he=>{he=he.result;let De;if(t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchBoxEnabled",!1)){const Se=vb.result;De=qf=>{var kg,$f;return null===($f=null===(kg=null===Se||void 0===Se?void 0:Se.um)||void 0===kg?void 0:kg.Kv)||void 0===$f?void 0:$f.call(kg,qf)}}else De=()=>{};this.handler=new wl(this.$,he,lc,new bg,Nc,wd,Object(Ha.f)(hc.a),
De);B.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");this.fn([this.handler]);this.$.ra.zc(198,this.handler)},this.Aa,3)},this.Aa,3)};this.ddi=()=>{void 0!==this.handler&&null!==this.handler?(this.$.Ia.bsb(this.handler),this.$.ra.HEa(198),this.handler=null):B.ULS.sendTraceTag(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");this.$.ra.HEa(204);Rj.a(Xk.a,19,this.$.ra,
198)}}oq(){B.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");Cj.a(this.$).add(Object(Ii.a)(new mk,{bre:()=>{const D=this.$.fa.ug&&this.$.fa.yc&&!!(this.$.$d&16384)&&this.$.isEditMode;this.$.fa.yc&&B.ULS.sendTraceTag(38410433,0,50,`AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [${D}] IsSessionFullyLoaded [${this.$.fa.JN}] IsSessionActive [${this.$.fa.yc}] ShowCommandUI [${!!(this.$.$d&16384)}] IsEditMode [${this.$.isEditMode}] IsAppVisuallyReady [${this.$.fa.ug}]`);
return D},vmd:this.Lxh,MAd:this.ddi,wNb:128}))}ynk(D){const ma=Object(Th.d)(L.a.resolve(K.RibbonControlsService,{xa:this.Cc}));return E.TaskExtensions.tb(ma,()=>{B.ULS.sendTraceTag(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");this.$.ra.zc(204,new sc(ma.result,D))},this.Aa,3)}static Ea(D){Jg.a.cw(199,new xl(D))}}Object(l.a)(xl,"AddinUICommandHandlerFactory",Jg.a,[]);var nk=a(9),ok=a(430),Ol=a(1431),Yk=a(1433),Zk=a(942);class wj extends ok.a{constructor(D){super();
this.$=D;this.ri()}create(){let D;if(M.EwaSettings.Ra(355)){const ma=K.DdaFacadeService.Oa()?Object(Th.d)(L.a.resolve(K.DdaFacadeService,{xa:this.Cc})):kc.GetServiceTaskFactory.create(this.$.ra,106,this.$.Aa,this.Cc),vb=Object(Th.d)(L.a.resolve(K.IndexedDBService,{xa:this.Cc}));E.TaskExtensions.tb(bd.Task.VE(ma,vb),()=>{this.Uf(Object(Zk.a)(this.$.ra,278,()=>new Ol.CustomFunctionsInstaller(this.$,ma.result,vb.result)))},this.$.Aa,3)}else D=Object(Zk.a)(this.$.ra,278,()=>new Yk.CustomFunctionsLegacyInstaller(this.$)),
this.Uf(D)}static Ea(D){D.ra.zc(279,new wj(D))}}Object(l.a)(wj,"CustomFunctionsInstallerFactory",ok.a,[]);var Pl=a(257),Ql=a(1513),yl=a(64),Rl=a(1459),Sj=a(1298);class yk extends ok.a{constructor(D){super();this.rDg=this.ddaFacade=null;this.$=D;D.ra.zc(106,this);this.ri()}get Gc(){return this.ddaFacade||(this.ddaFacade=new Oa.DdaFacade(this.$,this.rDg,this.$e,null))}create(){B.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");t.AFrameworkApplication.disableWholeAppsForOfficeFeature?
B.ULS.sendTraceTag(537170506,0,50,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [${t.AFrameworkApplication.disableWholeAppsForOfficeFeature}]`):M.EwaSettings.Ra(359)?Object(Ha.d)(Pl.a).execute(D=>{const ma=Object(Ha.a)(Ql.a);Promise.all([D.isFeatureEnabled("mso_officeStore",!0),ma.OF("WACSideloadAddins")]).then(vb=>{var [lc,Nc]=vb;Oa.DdaFacade.PJb=lc;Oa.DdaFacade.LAe=Nc;this.Ekf();return null},vb=>{B.ULS.sendTraceTag(508073758,0,10,`Unsable to fetch office store or add-in sideload enabled flag from OCPS: ${vb}.`);
return null})}):this.Ekf()}Ekf(){const D=Object(Th.d)(L.a.resolve(K.AgaveOnSelectedReadoutHandlerService,{xa:this.Cc})),ma=yl.a.s2d(65,()=>!(void 0===window.OSF||null===window.OSF),this.$.ta.MaxRetriesForLoadingScript,this.$.Aa,this.Cc,106),vb=cf.a(this.Aa,this.Cc),lc=Object(Th.d)(L.a.resolve(K.FormatCellsActionService,{xa:this.Cc}));E.TaskExtensions.tb(E.TaskExtensions.jl([D,ma,vb,lc],this.$.Aa),()=>{"undefined"===typeof OfficeExt||"undefined"===typeof OSF?B.ULS.sendTraceTag(537170505,0,15,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: ${Wk.a.create()}`):
this.igj();B.ULS.sendTraceTag(537170504,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");this.rDg=D.result;this.$e=lc.result;this.Uf(this.Gc);B.ULS.sendTraceTag(537170503,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.Aa,3)}igj(){M.EwaSettings.Ra(63)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new Sj.a);this.$.Fe.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new Sj.a,new Rl.a(t.AFrameworkApplication.ea.appSettings.WebServiceBase),M.EwaSettings.Ra(70),
!0);OfficeExt.MosRequestHandler.init&&OfficeExt.MosRequestHandler.init(new Sj.a);t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MosForWXPEnabled",!1)&&OfficeExt.TMTRequestHandler.init&&OfficeExt.TMTRequestHandler.init(new Sj.a);OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new Sj.a)}dispose(){U.a.vb(this.ddaFacade);this.$=this.ddaFacade=null;super.dispose()}static Ea(D){new yk(D)}}Object(l.a)(yk,"DdaFacadeServiceFactory",
ok.a,[]);class zl extends Jg.a{constructor(D){super(D)}oq(){na.a(this.$,374,375,this.Cc,D=>{const ma=[];K.AgaveCommandHandlerService.Oa()||ma.push(new J(this.$,D));K.SmartLookupCommandHandlerService.Oa()||ma.push(new Xa(this.$,D));this.fn(ma)})}static Ea(D){Jg.a.cw(76,new zl(D))}}Object(l.a)(zl,"AgaveCommandHandlerFactory",Jg.a,[]);var Wj=a(1152),$k=a(1514),Xj=a(135);class qj{constructor(){this.Gc=null;this.trb=(D,ma,vb,lc,Nc)=>{if(2===vb){D=Nc?Nc:{};ma=D.callback;vb=D.refresh?D.refresh:!1;if(!ma)return 16;
t.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType")&&null!=D.storeType?this.Gc.QAg(ma,vb,D.storeType):this.Gc.bfe(ma,vb)}return 32};this.aTc=(D,ma,vb,lc,Nc)=>{if(2===vb){D=Nc?Nc:{};ma=D.Observer;if(!ma)return B.ULS.sendTraceTag(509686147,220,10,"registerAddinDetailObserver: invalid actionData: {0}",JSON.stringify(D)),16;if(!this.Gc||!this.Gc.zP)return B.ULS.sendTraceTag(509671006,220,10,"registerAddinDetailObserver: ddaFacadeService or its addinDetailsProvider is null, abort the operation, actionData: {0}",
JSON.stringify(D)),16;this.Gc.zP.sxa(ma)}return 32};this.Cok=(D,ma,vb,lc,Nc)=>{2===vb&&(D=Nc?Nc.callback:null)&&this.Gc.qDh(D);return 32};this.Fjj=(D,ma,vb,lc,Nc)=>{2===vb&&this.Gc.f2a(null,OSF.AgaveHostAction.InsertAgave,Nc);return 32}}initialize(D){qj.initialized||(this.Gc=D,this.wi(),qj.initialized=!0)}wi(){t.AFrameworkApplication.Kb.ef($g.a.trb,Xj.a.frame,this.trb,96);t.AFrameworkApplication.Kb.ef($g.a.aTc,Xj.a.frame,this.aTc,96);t.AFrameworkApplication.Kb.jc($g.a.mnk,Xj.a.frame,this.Cok);t.AFrameworkApplication.Kb.ef($g.a.wXf,
Xj.a.frame,this.Fjj,96)}static get instance(){qj.Wa||(qj.Wa=new qj);return qj.Wa}}qj.Wa=null;qj.initialized=!1;Object(l.a)(qj,"AgaveCommandActor",null,[]);var fj=a(1622),al=a(374),Sl=a(375);a(1195);var dm=a(1436),Al=a(399);class Bl{constructor(){this.wwe=this.A0c=null;this.vwe=!1;this.twe=null;this.cS=0;this.z0c=null}}Object(l.a)(Bl,"FirstPartyAddinTaskpaneOverrides",null,[]);class pk{constructor(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=null;this.columnIndex=this.columnCount=
this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=null}}Object(l.a)(pk,"IdeasSelectionContext",null,[]);class Tl extends pk{constructor(){super();this.hasTableHeaders=this.isPivotTable=this.isTable=!1;this.tableName=null;this.userSelectedPivotTable=!1}}Object(l.a)(Tl,"IdeasTableSelectionContext",pk,[]);class Ul{constructor(D,ma){this.selection=D;this.tables=ma}}Object(l.a)(Ul,"IdeasXLIMTableBoundaries",null,[]);var em=a(1153),Vl=a(1661),gi=a(1306),bl=a(150),Wl=a(429),cl=a(191),
fm=a(151);class Xl extends Pj.a{constructor(){super();this.m5="calc(100% - 46px)";this.sga="15px";this.n5="0";this.Izb="WACDialogPanel";this.pJ=695;this.Jzb=462;this.bH="80%";this.tyb=350;this.lAa="100%";this.hc=5;this.uf="AppsForOfficeInsertionDialog";this.s$c=!!t.AFrameworkApplication.ea&&t.AFrameworkApplication.ea.ka("OfficeAddinEnableInsertDialogAccessibilityFix")}rB(){var D;super.rB();this.fj.style.width=this.lAa;this.fj.style.height=this.m5;this.fj.style.marginTop=this.sga;this.fj.style.padding=
this.n5;if(null===(D=t.AFrameworkApplication.ea)||void 0===D?0:D.isChangeGateEnabled("AddInDialogBugFix"))this.s_.classList.add("AddInDialog"),this.fj.classList.add("AddInDialog")}lxa(){this.fj.style.width=this.lAa;this.fj.style.height=this.m5;this.fj.style.marginTop=this.sga;this.fj.style.padding=this.n5;this.pJ>Ih.a.f9?(this.Fb.style.width=String.format("{0}px",Ih.a.f9),this.Fb.style.overflowX="scroll",t.AFrameworkApplication.isRtl?this.Fb.style.right="0":this.Fb.style.left="0"):(this.Fb.style.width=
String.format("{0}px",this.pJ),this.Fb.style.overflowX="hidden");this.Fb.offsetHeight>Ih.a.kZ||this.Jzb+50>Ih.a.kZ?(this.Fb.style.height=String.format("{0}px",Ih.a.kZ),this.Fb.style.overflowY="scroll",this.Fb.style.top="0",t.AFrameworkApplication.isRtl?this.Fb.style.right="0":this.Fb.style.left="0",this.s$c||(this.Fb.style.marginTop="-48px"),this.fj.style.minHeight=String.format("{0}px",this.tyb)):(this.Fb.style.overflowY="hidden",this.Fb.style.top="10%",this.Fb.style.height=this.bH);this.eia()}eia(){if(this.Fb){var D=
this.Fb.style.zIndex;this.Fb.style.zIndex="-9999";if(this.pJ>Ih.a.f9)t.AFrameworkApplication.isRtl?this.Fb.style.marginRight="0":this.Fb.style.marginLeft="0";else{const ma=String.format("{0}px",Math.floor(-this.Fb.offsetWidth/2));t.AFrameworkApplication.isRtl?this.Fb.style.marginRight=ma:this.Fb.style.marginLeft=ma;t.AFrameworkApplication.isRtl?this.Fb.style.right="50%":this.Fb.style.left="50%"}this.Fb.style.zIndex=String(D)}else B.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}IO(){super.IO();
const D=document.getElementById(this.qj(this.Izb));D.style.width=String.format("{0}px",this.pJ);D.style.height=this.bH}get Tia(){return this.fj}}Object(l.a)(Xl,"AppsForOfficeInsertionDialog",Pj.a,[131]);class Yl extends Pj.a{constructor(D,ma,vb){D=void 0===D?!0:D;ma=void 0===ma?!0:ma;vb=void 0===vb?null:vb;super();this.m5="calc(100% - 46px)";this.sga="15px";this.n5="0";this.Izb="WACDialogPanel";this.pJ=695;this.Jzb=462;this.bH="80%";this.tyb=350;this.lAa="100%";this.GKe=this.yKe=this.Joa=null;this.SKe=
"auto";this.TKe="5px";this.UKe="auto";this.RKe="40px";this.ldc="100px";this.Kzb="200px";this.hc=5;this.uf="SDXDialog";this.dfc=D;this.BRb=ma;this.hdc=vb}rB(){super.rB();this.fj.style.width=this.lAa;this.fj.style.height=this.m5;this.fj.style.marginTop=this.sga;this.fj.style.padding=this.n5}lxa(){this.fj.style.width=this.lAa;this.fj.style.height=this.dfc?this.m5:"100%";this.fj.style.marginTop=this.dfc?this.sga:"0px";this.fj.style.padding=this.n5;if(this.dfc){this.ldc&&this.Kzb&&(this.pJ=parseInt(this.Kzb.substring(0,
this.Kzb.length-2)),this.bH=this.ldc);this.pJ>Ih.a.f9?(this.Fb.style.width=String.format("{0}px",Ih.a.f9),this.Fb.style.overflowX="scroll",t.AFrameworkApplication.isRtl?this.Fb.style.right="0":this.Fb.style.left="0"):(this.Fb.style.width=String.format("{0}px",this.pJ),this.Fb.style.overflowX="hidden");if(this.Fb.offsetHeight>Ih.a.kZ||this.Jzb+50>Ih.a.kZ)this.Fb.style.height=String.format("{0}px",Ih.a.kZ),this.Fb.style.overflowY="scroll",this.Fb.style.top="0",t.AFrameworkApplication.isRtl?this.Fb.style.right=
"0":this.Fb.style.left="0",this.fj.style.minHeight=String.format("{0}px",this.tyb);else{this.Fb.style.overflowY="hidden";const D="%"===this.bH.substring(this.bH.length-1,this.bH.length),ma=D?parseInt(this.bH.substring(0,this.bH.length-1)):parseInt(this.bH.substring(0,this.bH.length-2));this.Fb.style.top=D?(100-ma)/2+"%":100*(Ih.a.kZ-ma)/Ih.a.kZ/2+"%";this.Fb.style.height=this.bH}this.eia()}else this.Fb.style.left=this.SKe,this.Fb.style.right=this.TKe,this.Fb.style.top=this.UKe,this.Fb.style.bottom=
this.RKe,this.Fb.style.width=this.Kzb,this.Fb.style.height=this.ldc,this.Fb.style.overflowX="hidden",this.Fb.style.overflowY="hidden"}eia(){if(this.Fb){var D=this.Fb.style.zIndex;this.Fb.style.zIndex="-9999";if(this.pJ>Ih.a.f9)t.AFrameworkApplication.isRtl?this.Fb.style.marginRight="0":this.Fb.style.marginLeft="0";else{const ma=String.format("{0}px",Math.floor(-this.Fb.offsetWidth/2));t.AFrameworkApplication.isRtl?this.Fb.style.marginRight=ma:this.Fb.style.marginLeft=ma;t.AFrameworkApplication.isRtl?
this.Fb.style.right="50%":this.Fb.style.left="50%"}this.Fb.style.zIndex=String(D)}else B.ULS.sendTraceTag(524892188,306,10,"_divMessageBox is null in CenterDialog()")}IO(){super.IO();const D=document.getElementById(this.qj(this.Izb));D.style.width=String.format("{0}px",this.pJ);D.style.height=this.bH}get qda(){return this.dfc}get Tia(){return this.fj}get instanceId(){return this.Joa}set instanceId(D){this.Joa=D}get xtc(){return this.yKe}set xtc(D){this.yKe=D}get Etc(){return this.GKe}set Etc(D){this.GKe=
D}hJk(D,ma,vb,lc){this.SKe=D;this.TKe=ma;this.UKe=vb;this.RKe=lc}jJk(D,ma){this.ldc=D;this.Kzb=ma}}Object(l.a)(Yl,"SDXDialog",Pj.a,[]);var Cl=a(98),zk=a(212),Dl;(function(D){D[D.Valid=2]="Valid";D[D.Invalid=4]="Invalid";D[D.All=6]="All"})(Dl||(Dl={}));Object(l.b)("MetadataState",Dl);a(397);var dl=a(941),El=a(1154);class Ak{constructor(){this.counter=0}execute(D){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(D)}register(D){this.Ifa=setInterval(()=>D("Counter: "+this.counter++),
1E4)}unregister(){null!=this.Ifa&&clearInterval(this.Ifa)}}Object(l.a)(Ak,"SdxPrivateApiXLOTest",null,[125]);class yg extends yi.a{constructor(D,ma,vb,lc,Nc,wd,Yd){super();this.wMa={};this.$me={};this.sdxPrivateApi={};this.nHd={};this.LKa=this.sdxDialog=this.jka=null;this.pVg=!1;this.PZk=new Map([["InsertAddInsFromBackstage","Backstage"],["InsertAppsForOffice","Ribbon"],["LaunchAddinDialogFromTellMe","TellMe"],["TeachingCallout","TeachingCallout"],["AddinFlyoutMoreButton","AddinFlyoutSeeAll"],["InsertMoreAddInsFromFooter",
"InsertMoreAddInsFromFooter"],["InsertMoreAddInsFromBackstageFooter","InsertMoreAddInsFromBackstageFooter"],["LaunchMyAddInsFromBackstage","BackstageSeeAll"],["InsertMoreAddInsFromStoreDialog","InsertMoreAddInsFromStoreDialog"]]);this.nNc=()=>{this.LKa=null};this.JGk=async ee=>{await this.hj.submitCustomMessage(Object.assign(new em.a,{message:new Vl.a({authToken:ee})}),"Copilot")};this.H8i=(ee,ae,he,De,Se)=>{if(2!==he)return 32;this.dKc(Se);return 32};this.pXb=(ee,ae,he,De,Se)=>{2===he&&(this.Dkf(),
ee=Se.CommandValueId,ae=[],ae.push(Se.SourceControlId),ae.push(ee),ae.push(null),this.Gc.R8f(this.jka.Tia,ae));return 32};this.dKc=ee=>{var ae=ee.extId;ee=ee.OptionalProps;var he=ee.xe[Yg.a.Rof];const De=ee.xe[Yg.a.Wof],Se=ee.xe[Yg.a.dialogTitle],qf=ee.xe[Yg.a.dialogHeight],kg=ee.xe[Yg.a.dialogWidth],$f=ee.xe[Yg.a.dialogLeft],Cg=ee.xe[Yg.a.Vof],sg=ee.xe[Yg.a.dialogTop],ng=ee.xe[Yg.a.Lof];var eh=ee.xe.InstanceToken;eh=null!=eh?eh:(new Bj.a(mb.a.create(),1)).toString();this.sdxDialog=new Yl(he,De);
null!=$f&&null!=Cg&&null!=sg&&null!=ng&&this.sdxDialog.hJk($f,Cg,sg,ng);null!=qf&&null!=kg&&this.sdxDialog.jJk(qf,kg);this.sdxDialog.instanceId=eh;this.sdxDialog.xtc=ee.xe[Yg.a.xtc];this.sdxDialog.Etc=ee.xe[Yg.a.Etc];this.sdxDialog.initializeAndShow(Se,null,null);he={};he.div=this.sdxDialog.Tia;he.id=eh;he.solutionId=ae.getId();he.version=ae.BOa;he.storeType=ae.getStoreType();he.storeId=ae.getStoreId();he.assetId=null;he.assetStoreId=null;he.settings=null!=ee.$q?ee.$q:{};he.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;
he.osfControlType=OSF.OsfControlType.ContainerLevel;he.sourceLocationOverrideResourceId=ee.xe[Yg.a.sourceLocationOverrideResourceId];he.featureGates=t.AFrameworkApplication.ea.KIf(ae.getId());he.onExtensionLaunchCallback=ee.xe[Yg.a.onExtensionLaunchCallback];ee.xe[Yg.a.sdxPrivateApi]&&(he.sdxPrivateApi=ee.xe[Yg.a.sdxPrivateApi]);M.EwaSettings.isChangeGateEnabled("OfficeVSO:8961918_PrivateApiTestHookEnabled")||he.sdxPrivateApi||(he.sdxPrivateApi=new Ak);ae={};ae.InstanceId=he.id;ae.WebExtensionType=
2;ae.PrimaryMarketplace={};ae.PrimaryMarketplace.SolutionId=he.solutionId;ae.PrimaryMarketplace.MarketplaceType=he.storeType;ae.PrimaryMarketplace.MarketplaceRef=he.storeId;ae.PrimaryMarketplace.SolutionVersion=he.version;ae.SrcLocationOverrideResourceId=he.sourceLocationOverrideResourceId;ae.WebExtensionOsfControlType=6;ae.OnExtensionLaunchCallback=he.onExtensionLaunchCallback;ae.SdxPrivateApi=he.sdxPrivateApi;this.wMa[he.solutionId]=he.settings;const {WRc:yh,RNb:Ph}=this.TLc([],he.solutionId);ae.OsfPropertyBag=
yh;ae.HostPropertyBag=Ph;this.Gc.BUa(ae);this.Gc.Cf.insertOsfControl(he)};this.t$i=(ee,ae,he,De,Se)=>{if(2!==he)return 32;const qf=Se.extId;var kg=Se.ComponentId;const $f=Se.OptionalProps;if(null!=$f.xe[Yg.a.actionName])return this.VQf(ee,ae,he,De,Se);ee=new fj.a;ee.hEc=$f.xe.InstanceToken;ee.Qm=$f.xe[Yg.a.Qm];ee.aS=$f.xe[Yg.a.aS];Yg.a.taskPaneWidth in $f.xe&&(ee.taskPaneWidth=$f.xe[Yg.a.taskPaneWidth]);ee.sourceLocationOverrideResourceId=$f.xe[Yg.a.sourceLocationOverrideResourceId];ee.onTaskPaneClose=
$f.xe[Yg.a.onTaskPaneClose];ee.onExtensionLaunchCallback=$f.xe[Yg.a.onExtensionLaunchCallback];ee.showLoadingSpinner=$f.xe[Yg.a.showLoadingSpinner];ee.sdxPrivateApi=$f.xe[Yg.a.sdxPrivateApi];ee.ps=$f.$q;ee.mxd=kg;kg=new Lc.a(-859308420,0,2,0,"");ae=qf.getStoreType()===OSF.StoreType.Sdx;he=new gi.a;he.O7=$f.xe.HeaderCssClass||tb.a.fNb;he.Uvb=$f.xe.TitleCssClass;this.PZ(kg,qf.getId(),ee,ae,he);return 32};this.W9i=(ee,ae,he,De,Se)=>{if(2!==he)return 32;ee=Se.extId.getId();Se=Se.OptionalProps.xe[Yg.a.sourceLocationOverrideResourceId];
return ee?(this.Gc.Cf.refreshOsfControl(ee,Se),32):8};this.mdk=ee=>{ee=ee.Result;if(ee=null===ee?null:ee.SolutionId)this.Gc.m2e(ee),Od.a(this.$).XLa(3,ee)};this.gyg=(ee,ae)=>{var he;const De=(ee=ee.Result)?ee.AgaveData:null;if(De){var Se=Telemetry.PrivacyRules.GetPrivacyCompliantId(De.PrimaryMarketplace.SolutionId,De.PrimaryMarketplace.MarketplaceType,null===(he=null===De||void 0===De?void 0:De.AssetMarketplace)||void 0===he?void 0:he.SolutionId,null,null,De.PrimaryMarketplace.MarketplaceRef);B.ULS.shipAssertTag(537170434,
0,De.TaskpaneWidth===yg.Onf,`Taskpane width is ${De.TaskpaneWidth}, assetId is ${Se}.`);if(he=this.nHd[De.PrimaryMarketplace.SolutionId])he.A0c&&(De.TaskpaneTitle=he.A0c),he.wwe&&(De.TaskpaneTitleTag=he.wwe),he.vwe&&(De.ShowResizeChatButton=he.vwe),he.z0c&&(De.TaskpaneIconId=he.z0c),he.twe&&(De.TaskpaneButtonTooltip=he.twe),0<he.cS&&(De.TaskpaneWidth=he.cS);ae&&(De.FocusOnIframeWhenLoaded=ae.focusOnIframeWhenLoaded,ae.width&&(De.TaskpaneWidth=ae.width),De.TaskpaneIconCssClass=ae.gs,De.TaskpaneHeaderCssClass=
ae.O7,De.TaskpaneTitleCssClass=ae.Uvb,De.IsFirstPartyOptOutAppContextOptmization=ae.isFirstPartyOptOutAppContextOptmization,De.ShowLoadingSpinner=ae.showLoadingSpinner);if(this.wMa[De.PrimaryMarketplace.SolutionId]){const {WRc:qf,RNb:kg}=this.TLc(De.OsfPropertyBag,De.PrimaryMarketplace.SolutionId);De.OsfPropertyBag=qf;De.HostPropertyBag=kg}Af.a(De)||(De.WebExtensionOsfControlType=1);De.OnExtensionLaunchCallback=this.$me[De.PrimaryMarketplace.SolutionId];De.SdxPrivateApi=this.sdxPrivateApi[De.PrimaryMarketplace.SolutionId];
De&&(this.Gc.m2e(ee.SolutionId),this.Gc.BUa(De))}else B.ULS.sendTraceTag(593285650,220,50,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};this.VQf=(ee,ae,he,De,Se)=>{if(2!==he)return 32;if(Hc.a.Zg(Se))return 8;ee=Se.ComponentType;if(ee!==Ie.a.action&&ee!==Ie.a.taskpane)return 8;ae=Se.OptionalProps;return ae?(ee=(ee=this.kXi(Se))?this.Gc.UX(ee):null)?(Se=this.Gc.j5h(Se.ComponentId,ae.xe[Yg.a.kmd]),M.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&
(he=this.Gc.JT(ee),he.TaskpaneTitle!==ae.xe[Yg.a.Qm]&&(he.TaskpaneTitle=ae.xe[Yg.a.Qm],he.TaskpaneIconCssClass=ae.xe.IconCssClass,he.TaskpaneIconUrl=ae.xe.TaskPaneIconUrl,he.TaskpaneIconId=ae.xe.TaskPaneIconId,he.OnExtensionLaunchCallback=ae.xe[Yg.a.onExtensionLaunchCallback],he.SdxPrivateApi=ae.xe[Yg.a.sdxPrivateApi],M.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?(ae=this.Gc.Cf,ae.changeIframeTitle(ee,he.TaskpaneTitle),he=ae.getOsfControl(ee),ae.raiseOsfControlStatusChange(he)):
(ae=this.Gc.Cf.getOsfControl(ee),this.Gc.Cf.raiseOsfControlStatusChange(ae)))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(ee,Se,this.v5b),32):8:8};this.v5b=(ee,ae)=>{this.Gc.WBi(ee,ae)};this.$=D;this.viewBlockContainerHelpers=vb;this.Gc=ma;this.zh=Nc;this.SHh=wd;this.KRj=Yd;this.zh.jc($g.a.uWg,Xj.a.frame,this.t$i);this.zh.jc($g.a.QKg,Xj.a.frame,this.W9i);this.zh.jc($g.a.tzf,Xj.a.frame,this.VQf);this.zh.jc($g.a.dKc,Xj.a.frame,this.H8i);this.zh.jc($g.a.pXb,Xj.a.frame,this.pXb);
this.pVg=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Augloop.ShowChatPaneAfterSendToken",!1);this.$.fa.P3e(this.nNc)}oEh(D){this.addHandler(yg.abe,D)}itk(D){this.removeHandler(yg.abe,D)}dispose(){U.a.vb(this.jka);this.jka=null;super.dispose()}Wtd(){this.jka&&this.jka.hide()}O_k(D,ma){var vb;if(D){this.raiseEvent(yg.abe);const lc=D.split("|");this.VFj(D,ma,lc);this.Dkf();this.Gc.R8f(this.jka.Tia,lc);window[yg.WGh]=null!==(vb=this.PZk.get(D))&&void 0!==vb?vb:"Unknown"}}Dkf(){const D=
ma=>{0===ma&&(this.Gc.f2a("",OSF.AgaveHostAction.RefreshAddinCommands,{}),uf.a.sendTelemetryEvent({name:"Office.Extensibility.Host.RefreshAddinsAfterClosingDialog"}))};this.jka=new Xl;this.jka.initializeAndShow("",M.EwaSettings.isChangeGateEnabled("OfficeVSO:8619119_RefreshAddinsAfterClosingDialog")?D:null,null)}fCc(D,ma){var vb=E.TaskExtensions.kl();if(-515602470===ma.command||-167264441===ma.command||-336193495===ma.command||-1444574190===ma.command)vb=this.n8i(D,ma);418618014===ma.command&&(vb=
new fj.a,vb.Qm=Jc.a.instance.ia(1823),vb=this.PZ(ma,yg.Ibj,vb,!0));if((ma.tabName===this.$.Oc+F.a.yLg||ma.tabName===F.a.s9)&&2===ma.Re||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback Tutorials".split(" "),D[$b.a.Wc])||D[$b.a.Wc]===F.a.VF)return this.pRf(D,ma);if(7===ma.Re&&D.SourceControlId===this.$.Oc+F.a.Xta)return D.MenuItemId=F.a.DSc,this.pRf(D,ma);1221897806===ma.command&&(vb=this.Mse(ma,"Format"));if(1930653487===ma.command||1172793074===ma.command)vb=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSSnowballChartImprovement",
!1)?this.Mse(ma,"SnowballView"===ma.tabName?ma.tabName:"Data"):this.Mse(ma,"Data");-1753056834===ma.command&&(vb=this.RVk(ma));if(932597253===ma.command){B.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested");Cl.c(932597253,!0);vb=new fj.a;vb.Qm=Jc.a.instance.ia(2163);vb.sourceLocationOverrideResourceId=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",!1)?yg.xdk:yg.zdk;vb.focusOnIframeWhenLoaded=!0;vb.taskPaneWidth=yg.sVf;var lc={};lc.LaunchSource=
Object(C.a)(String,D.SourceControlId);lc.LaunchMode="Default";vb.ps=lc;vb=this.PZ(ma,yg.ydk,vb,!0)}301511274===ma.command&&(vb=this.gWk(ma));if(515196233===ma.command){vb=M.EwaSettings.isChangeGateEnabled("OfficeVSO:8093484_EnableCoauthCheckOnOptimize");if(lc=L.a.Cb(K.OptimizeWorkbookManagerService))lc.uHa(),vb&&lc.Zij();lc=new fj.a;lc.Qm=Jc.a.instance.ia(2237);const Nc={};Nc.SourceUILocation=al.a[ma.Re];Nc.TaskPaneVisualRefreshEnabled=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskPaneVisualRefreshEnabled",
!1);vb&&(Nc.SessionID=this.$.fa.sessionId,Nc.EnableCoauthCheckOnOptimize=vb);lc.ps=Nc;vb=new gi.a;vb.O7=tb.a.fNb;vb=this.PZ(ma,yg.P8j,lc,!0,vb,void 0,lc.Qm)}1723441034===ma.command&&(vb=new fj.a,vb.Qm=Jc.a.instance.ia(2249),vb.focusOnIframeWhenLoaded=!0,vb.taskPaneWidth=yg.Tgk,lc=new gi.a,lc.O7=tb.a.pvf,vb=this.PZ(ma,zk.f,vb,!0,lc));t.AFrameworkApplication.u8(zk.a)&&D.LoadDataFromPictureTaskpane&&(vb={},lc=new fj.a,lc.Qm=Jc.a.instance.ia(2276),vb.SessionID=D.SessionID,lc.ps=vb,lc.focusOnIframeWhenLoaded=
!0,vb=this.PZ(ma,D.DataFromPictureAssetId,lc,!0));762629271===ma.command&&(this.Zbj(),vb=E.TaskExtensions.kl());-1997160483!==ma.command&&1485761473!==ma.command||!z.a.CN()||(M.EwaSettings.isChangeGateEnabled("OfficeVSO:8777768_ColorFillEntryPointTrigger")&&"FillColor"===D.ParentMenuId&&(vb="ColorFill"+D.CommandValueId.replace(/(^\w|\s\w)/g,Nc=>Nc.toUpperCase()).replace(/\s+/g,""),Cl.b(vb)),vb=this.t7i(D,ma),z.a.zVd()&&this.SHh.addListener());M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LaunchNewFormTaskPane",
!1)&&-105284469===ma.command&&(vb=new fj.a,vb.ps.mode=D.mode,vb.ps.workbookUrl=D.workbookUrl,vb.ps.workbookFileName=D.workbookFileName,vb.ps.contentLocale=D.contentLocale,vb.ps.correlationId=D.correlationId,vb.ps.serverDocId=D.serverDocId,vb.ps.hostType=D.hostType,vb.sourceLocationOverrideResourceId=zk.d,vb.sharedRuntimeId=zk.d,vb=this.PZ(ma,zk.c,vb,!0));return vb}insertAgave(D,ma){var vb=E.TaskExtensions.kl();const lc=this.$;var Nc=D[Pa.a.zqa];const wd=D[$b.a.Bf];let Yd=null;gi.a.key in D&&(Yd=D[gi.a.key]);
this.jka&&this.jka.hide();if(!wd||!Nc)return B.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),vb;this.$.Ika&&F.a.wna in D&&(wd.EnabledInViewMode=D[F.a.wna]);D=this.EMi(ma.command);if(!wd.EnabledInViewMode&&!lc.Ss(null,!1,D))return vb;let ee=void 0===wd.IsToBePersisted||null===wd.IsToBePersisted||wd.IsToBePersisted?0:16;if(1===wd.TargetType)vb=this.dkj(wd,Nc,ma,Yd,ee);else{Nc=w.f(lc);vb=this.viewBlockContainerHelpers.X7a(Nc);const ae=lc.fa.isNamedObjectViewMode?
lc.la.sheetName:lc.la.name;let he,De,Se,qf;vb?(Nc=vb.nf,he=Nc.Fd.top,De=Nc.Fd.left,Se=vb.ZO.x,qf=vb.ZO.y):(he=De=1,vb=this.viewBlockContainerHelpers.VGa(Nc),Se=vb.x,qf=vb.y);const kg=this.$.ma.sa.mc();ee|=64;vb=Wl.a(this.$.userOperationManager,($f,Cg,sg)=>{var ng=lc.ma.sa,eh=he,yh=De,Ph=Se,Yj=qf;$f=Db.c($f,this.mdk);const Kj=ng.$a(9,kg);Kj.sharedInfo=wd;Kj.sheetName=ae;Kj.positionRow=eh;Kj.positionCol=yh;Kj.positionOffsetX=Ph;Kj.positionOffsetY=Yj;return Ub.h(ng,"InsertWebExtension",Kj,$f,Cg,sg,null,
0)},$f=>new Ob.a(534,0,$f,ee),ma)}return vb}x2h(){var D=Object(Ha.d)(rl.a),ma={};t.AFrameworkApplication.ea.Nkc(ma);D=D.instance.getContext(ma);ma={};"telemetryGroup"in D&&(ma=D.telemetryGroup);ma.processSessionId=D.sessionId;ma.officeBuild=D.build;D.telemetryGroup=ma;D.feedbackType=-1;D.userVoiceEnabled=!1;"disableIncludeScreenshot"in D||(D.disableIncludeScreenshot=!1);"screenshot"in D||(D.screenshot=!1);D.disableScreenshotPreview=!1;D.includeScreenshotSelectedDefault=!0;return D}Pyg(D){if(!this.LKa){var ma=
this.iAc();ma=this.qaf(ma);const vb=new gi.a;vb.gs=tb.a.hNb;vb.O7=tb.a.Svf;vb.Uvb=tb.a.EEd;this.LKa=this.lWc(ma,null,!1,null,vb);fm.b(this.$).Jd(bl.a.dek,{["Location"]:D?al.a[D.Re]:0,["InputMethod"]:D?Sl.a[D.method]:0},void 0,!0)}}RQg(D){const ma=this.$.fa.Kh.get(17);Object(Ha.d)(Pl.a).execute(vb=>{vb.isFeatureEnabled("mso_sendASmile",ma).then(lc=>{D.FeedbackEnabled=ma&&lc;return null})})}Yrj(){return this.Gc.x5f(this.Gc.vja(yg.DYa,this.iAc()))}onPaneClosed(D){var ma;switch(D){case yg.mrc:null===
(ma=this.hj)||void 0===ma?void 0:ma.unregister("Copilot")}}Mse(D,ma){const vb=w.f(this.$),lc=new fj.a;var Nc={};Nc.ActiveTab=ma;Nc.IsRTL=this.$.isChromeRtl;Nc.DatapaneFlighting=!0;Nc.MergeIvyBiDataSources=!0;Nc.ComboChartUIInXLO=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSComboChartUIInXLO",!1);Nc.ThemeColorsFlighting=!0;Nc.ChartTPNewFontAndColorTheme=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTPNewFontAndColorTheme",!1);Nc.DataPaneAddNewField=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataPaneAddNewField",
!1);Nc.LineFormatTaskPane=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSLineFormatTaskPane",!1);Nc.ChartTaskPaneNewTheme=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneNewTheme",!1);Nc.SnowballChartImprovement=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSSnowballChartImprovement",!1);Nc.NewTaskPaneEndUserFeedback=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NewTaskPaneEndUserFeedback",!1);Nc.TaskPaneSheetProtectionPhase1=
M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSTaskPaneSheetProtectionPhase1",!1);Nc.LoggableUserId=this.$.ta.DocumentHostInfo.LoggableUserId;Nc.TenantId=this.$.ta.DocumentHostInfo.TenantId;Nc.Browser=this.$.ta.BrowserNameAndVersion;Nc.Audience=t.AFrameworkApplication.tc.AudienceGroup;this.RQg(Nc);Nc.startTimeMs=Date.now();Nc.UserSessionId=this.$.ta.UserSessionId;(ma=vb.ha.ob.Qj)&&(Nc.SubSelection=ma);B.ULS.sendTraceTag(592524688,0,50,`Chart task pane launched. UserSessionId: ${Nc.UserSessionId}, UILocation: ${void 0===
D.Re||null===D.Re?"Null":al.a[D.Re]}, SubSelection: ${ma||"ChartRoot"}`);lc.ps=Nc;lc.Qm=Jc.a.instance.ia(984);Nc=new gi.a;Nc.O7=tb.a.fNb;return this.PZ(D,yg.iXh,lc,!0,Nc)}RVk(D){const ma=new fj.a;ma.ps={};ma.Qm=Jc.a.instance.ia(1809);ma.aS=yg.v9f;const vb=new gi.a;vb.O7=tb.a.fNb;return this.PZ(D,yg.v9f,ma,!0,vb,void 0,ma.Qm)}gWk(D){const ma=new fj.a;ma.ps={};ma.Qm=Jc.a.instance.ia(2187);const vb=new gi.a;vb.O7=tb.a.psi;vb.Uvb=tb.a.Uvf;const lc=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavPaneWebReadOnly",
!1);return this.PZ(D,yg.ePj,ma,!0,vb,lc)}pRf(D,ma){const vb=yg.Lbj;var lc=D[$b.a.Wc].toString();const Nc={},wd=new fj.a;wd.Qm=Jc.a.instance.ia(9);switch(lc){case "A0":Nc.query=(D[$b.a.Bf]||"").split("|").slice(2,Al.a.b5).join("|");break;case "A1":Nc.query=D.CommandValueId;break;case "Help":Nc.query="";wd.aS="HelpTaskPane";break;case F.a.DSc:wd.Qm=Jc.a.instance.ia(1775);wd.sourceLocationOverrideResourceId=yg.HPd;Nc.feedback=this.x2h();break;case "HelpArticle":Nc.query=D[$b.a.Bf];break;case "Tutorials":Nc.query=
D.CommandValueId;break;case "ContactSupport":Nc.query=lc;wd.sourceLocationOverrideResourceId=yg.D2h;wd.Qm=Jc.a.instance.ia(2389);wd.aS="ContactSupportTaskPane";break;case "ShowTraining":case "WhatsNew":Nc.query=lc;break;default:return bd.Task.Va(!0)}wd.ps=Nc;lc=new gi.a;lc.O7=tb.a.fNb;D=D[F.a.wna]||!1;return this.PZ(ma,vb,wd,M.EwaSettings.isChangeGateEnabled("OfficeVSO:8469439_UseSdxActivationFlow"),lc,D)}qaf(D){const ma={};ma.SolutionId=yg.DYa;ma.Version="0.0.0.0";ma.StoreType=OSF.StoreType.Sdx;
ma.StoreId=OSF.StoreType.Sdx;ma.AssetId=null;ma.AssetStoreId=null;ma.Height=0;ma.Width=0;ma.TargetType=OSF.OsfControlTarget.TaskPane;ma.IsToBePersisted=!1;ma.SourceLocationOverrideResourceId=D;ma.SharedRuntimeId=D;return ma}n8i(D,ma){const vb=new fj.a,lc=new gi.a,Nc={};this.LKa&&this.RQg(Nc);Nc.LaunchSource="";Nc.StartTimeMs=Date.now();Nc.CorrelationId=mb.a.create().toString();vb.ps=Nc;vb.focusOnIframeWhenLoaded=!0;vb.taskPaneWidth=yg.sVf;lc.O7=tb.a.Svf;lc.Uvb=tb.a.EEd;switch(ma.command){case -1444574190:let wd,
Yd,ee;Nc.LaunchMode="RecommendedPivotTables";Nc.SelectionContext="";Nc.LaunchSource="PivotTableHandRaise"===Object(C.a)(String,D.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";if(this.$&&M.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&D.SourceSelection){const ae=D.SourceSelection.split(",")[0],he=M.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?-1:0;if((()=>{let De=fb.kb(ae,this.$.qa);({sheetName:wd,uCg:Yd,range:ee}=De);return De})().returnValue&&
!w.f(this.$).Eb.tU(ee))D=this.$.qa.getItemByName(wd),Nc.SelectionContext=JSON.stringify(Object(Ii.a)(new pk,{address:Yd,addressWithSheet:wd+"!"+ee.Gz(!1),sheetId:Rb.d(D),sheetName:wd,isSheetEmpty:!1,columnCount:ee.width,rowCount:ee.height,columnIndex:ee.left+he,rowIndex:ee.top+he,selectionType:"Continuous"}));else if((D=this.$.wc.getItemByName(Object(C.a)(String,D.SourceSelection)))&&Rb.m(D)){ee=cl.a(D,!0);const De=this.$.qa.getItemByName(D.sheetName);Nc.SelectionContext=JSON.stringify(Object(Ii.a)(new Tl,
{tableName:D.name,hasTableHeaders:cl.d(D),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:ee.Gz(!1),addressWithSheet:De.name+"!"+ee.Gz(!1),sheetId:Rb.d(De),sheetName:De.name,isSheetEmpty:!1,columnCount:ee.width,rowCount:ee.height,columnIndex:ee.left+he,rowIndex:ee.top+he,selectionType:"Continuous"}))}}vb.Qm=Jc.a.instance.ia(1821);vb.aS=yg.zbk;vb.gs=tb.a.dyf;lc.gs=tb.a.dyf;break;case -336193495:Nc.LaunchMode="RecommendedCharts";vb.Qm=Jc.a.instance.ia(1820);vb.aS=yg.Glk;vb.gs=tb.a.eyf;
lc.gs=tb.a.eyf;break;case -167264441:Nc.LaunchMode="ExcelIntelligence";Nc.TableName=D.tableName;vb.Qm=Jc.a.instance.ia(2287);vb.aS=yg.B6e;vb.gs=tb.a.hNb;lc.gs=tb.a.hNb;break;default:Nc.LaunchMode="Default",vb.Qm=Jc.a.instance.ia(1822),vb.aS=yg.B6e,vb.gs=tb.a.hNb,lc.gs=tb.a.hNb}vb.sourceLocationOverrideResourceId=this.iAc();return this.LKa?this.LKa.jw(()=>this.yFk(Nc,vb)):this.Thj(ma,vb,lc,Nc)}Zbj(){const D=this.Gc.UX(yg.mrc);if(D){const ma=this.m3k(D);z.a.Fj()?void L.a.resolve(K.ReactTaskPaneManagerService,
{xa:0}).then(vb=>vb.hideTaskPane(ma)):void Oc.a.li().then(vb=>{vb.hideTaskPane(ma,2);return null})}}m3k(D){return yg.n3k+D.replace(/[{}]/g,"")}FLf(){const D=L.a.Cb(K.OfficeScriptsCommandManagerService),ma=Ng.c()&&appChrome.api.isCachedControlVisible(F.a.mxa);return void 0!==D?D.LVb:ma}kUi(){const D=new fj.a;D.Qm=appChrome.getCopilotString();let ma=!1;M.EwaSettings.isChangeGateEnabled("OfficeVSO:8583475_CheckAccountTypeForPreviewTag")&&(ma="msa"===t.AFrameworkApplication.ea.Qa("HostAuthType").toLowerCase());
(ma?M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.1D9AC0F2_NoPreviewTitleConsumer",!1):M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.1D9AC0F2_NoPreviewTitle",!1))||(D.q1g=appChrome.getPreviewTaskPaneHeaderTagString());M.EwaSettings.isChangeGateEnabled("OfficeVSO:7904707_SDXTaskPaneHeaderIconSupport")&&(D.aS=yg.D4h);D.focusOnIframeWhenLoaded=!0;D.taskPaneWidth=yg.Onf;return D}lUi(){const D={};D.AudienceGroup=t.AFrameworkApplication.tc.AudienceGroup;D.StartTimeMs=Date.now();
M.EwaSettings.isChangeGateEnabled("OfficeVSO:8873206_AddSessionLocationToCopilotSettings")&&(D.SessionLocation=JSON.parse(this.$.ta.SessionStartInfoJson).LocationCountry);D.HandoffMessageId=this.$.ta.HandoffMessageId;const ma=M.EwaSettings.getBooleanFeatureGate(dl.a.wia,!1),vb=M.EwaSettings.getBooleanFeatureGate(dl.a.eyd,!1);D.CopilotSaveAutomation=ma&&this.FLf();D.CopilotPAIntegration=vb&&this.FLf();M.EwaSettings.isChangeGateEnabled("OfficeVSO:8887811_InsightsEndpoint")&&(D.InsightsEndpoint=this.iAc());
return D}t7i(D,ma){const vb=this.kUi();var lc=this.lUi();if((M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.60DF7594-6F61-4C0E-983C-712E11F4F99A",!1)||z.a.a0f())&&D.MenuItemId){if(M.EwaSettings.WTb()){var Nc="CopilotContextMenu"+D.MenuItemId.replace(/(^\w|\s\w)/g,ae=>ae.toUpperCase()).replace(/\s+/g,"");Cl.b(Nc)}"Ask Copilot"!==D.MenuItemId&&(lc.CopilotStartQuery=JSON.stringify(D.MenuItemId))}D=El.a.tKf(this.$,!0,"Copilot",{});Nc={};Nc.devProperties=D.$q;Nc.optionalProperties=D.xe;lc.LaunchOfficeScriptsSDXOptionalProperties=
JSON.stringify(Nc);vb.ps=lc;const wd=new gi.a;wd.O7=tb.a.pvf;const Yd=ae=>{ae.register(ae.RT().NV("Copilot").LV(()=>{B.ULS.sendTraceTag(508347875,0,15,"Copilot AugLoop host received close message")}).activateAnnotation({annotationType:"FakeCopilotAnnotation",ls:!1,cqj:!0}).build())},ee=()=>this.pVg?Object(Th.d)(Object(dm.b)(this.KRj).then(this.JGk.bind(this)).catch(ae=>{B.ULS.sendTraceTag(507562076,0,10,`[Copilot Chat] Failed to get and send token. ${ae}`)}).then(()=>Object(Th.a)(this.PZ(ma,yg.mrc,
vb,!0,wd)))):this.PZ(ma,yg.mrc,vb,!0,wd);if(this.hj)return Yd(this.hj),ee();lc=L.a.resolve(K.AugmentationLoopManagerService,{xa:1});return Object(Th.d)(lc.then(ae=>{this.hj=ae;Yd(this.hj);B.ULS.sendTraceTag(508347904,0,15,"Copilot proxy created IAugmentationLoopManager manager");return Object(Th.a)(ee())}))}Thj(D,ma,vb,lc){this.LKa=this.lWc(this.qaf(ma.sourceLocationOverrideResourceId),ma,!1,D,vb,!1);lc.NoActionMsgOnFirstInstance=!0;this.wMa[yg.DYa]=lc;return this.LKa}yFk(D,ma){const vb=this.Gc.UX(this.Gc.vja(yg.DYa,
ma.sourceLocationOverrideResourceId));if(vb){this.wMa[yg.DYa]=D;const {WRc:lc,RNb:Nc}=this.TLc(this.Gc.JT(vb).OsfPropertyBag,yg.DYa);this.Gc.JT(vb).OsfPropertyBag=lc;this.Gc.JT(vb).HostPropertyBag=Nc}this.Jva(yg.DYa,Ie.a.taskpane,"LaunchIdeasAction",D,"1.0.0.0",ma);return bd.Task.Va(!0)}iAc(){switch(t.AFrameworkApplication.ea.Qa("SovereignEnvironmentName")){case "USGov":return"Insights.Https.GCC.Bundle";case "Pathfinder":return"Insights.Https.DOD.Bundle";case "Trailblazer":return"Insights.Https.GCCH.Bundle"}const D=
t.AFrameworkApplication.tc.AudienceGroup;if(M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPEApi",!1)){switch(D){case "Automation":case "Dogfood":case "Microsoft":return"Ideas.PPEApi.PPE"}return"Ideas.PPEApi"}switch(D){case "Automation":case "Dogfood":case "Microsoft":return"Insights.Https.PPE.Bundle"}return"Insights.Https.Bundle"}PZ(D,ma,vb,lc,Nc,wd,Yd){vb=void 0===vb?null:vb;lc=void 0===lc?!1:lc;Nc=void 0===Nc?null:Nc;wd=void 0===wd?!1:wd;Yd=void 0===Yd?null:Yd;E.TaskExtensions.kl();
vb||(vb=new fj.a);M.EwaSettings.isChangeGateEnabled("OfficeVSO:8961918_PrivateApiTestHookEnabled")||vb.sdxPrivateApi||(vb.sdxPrivateApi=new Ak);const ee={};ee.SolutionId=ma;ee.Version="0.0.0.0";ee.StoreType=lc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;ee.StoreId=lc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;ee.AssetId=null;ee.AssetStoreId=null;ee.Height=0;ee.Width=0;ee.TargetType=OSF.OsfControlTarget.TaskPane;ee.IsToBePersisted=!1;ee.SourceLocationOverrideResourceId=vb.sourceLocationOverrideResourceId;
M.EwaSettings.isChangeGateEnabled("OfficeVSO:8939415_InsertSharedRuntimeId")&&(ee.SharedRuntimeId=vb.sharedRuntimeId);if(vb.Qm||Yd)this.nHd[ma]=Object(Ii.a)(new Bl,{A0c:vb.Qm,wwe:vb.q1g,vwe:vb.showResizeChatButton,twe:Yd,z0c:vb.aS});vb.ps||(vb.ps={});vb.ps.ShowFeedback=this.$.isFeedbackEnabled;this.wMa[ma]=vb.ps;this.$me[ma]=vb.onExtensionLaunchCallback;this.sdxPrivateApi[ma]=vb.sdxPrivateApi;ma={};ma[$b.a.Bf]=ee;Yd={};Yd.solutionId=ee.SolutionId;Yd.version=ee.Version;Yd.storeType=ee.StoreType;Yd.storeId=
ee.StoreId;Yd.assetId=ee.AssetId;Yd.assetStoreId=ee.AssetStoreId;Yd.height=ee.Height;Yd.targetType=ee.TargetType;Yd.width=ee.Width;Yd.isAddinCommands=!lc;ma[Pa.a.zqa]=Yd;Nc||(Nc=new gi.a);Nc.focusOnIframeWhenLoaded=vb.focusOnIframeWhenLoaded;Nc.width=vb.taskPaneWidth;Nc.showLoadingSpinner=vb.showLoadingSpinner;ma[gi.a.key]=Nc;ma[F.a.wna]=wd;return this.insertAgave(ma,D)}dkj(D,ma,vb,lc,Nc){const wd=(he,De)=>{var Se=he.SolutionId;const qf=OSF.OsfControl.isFirstPartyStoreString(he.StoreType);qf&&he.SourceLocationOverrideResourceId&&
(Se=this.Gc.vja(Se,he.SourceLocationOverrideResourceId));var kg=this.Gc.Wdf(Se,null,he.SharedRuntimeId);if(qf){if(kg&&(Se=this.Gc.UX(Se))){const {WRc:$f,RNb:Cg}=this.TLc(this.Gc.JT(Se).OsfPropertyBag,he.SolutionId);if(Se=this.Gc.Cf.getOsfControl(Se))Se.setSettings($f),Se.setHostSettings(Cg)}he.SharedRuntimeId&&kg||this.Gc.Cf.refreshOsfControl(he.SolutionId,he.SourceLocationOverrideResourceId)}if(!kg){const $f=this.$.ma.sa.mc();let Cg=519;kg=(sg,ng,eh)=>{var yh=this.$.ma.sa;sg=Db.c(sg,this.gyg);const Ph=
yh.$a(9,$f);Ph.sharedInfo=he;return Ub.h(yh,"InsertAgaveTaskpane",Ph,sg,ng,eh,lc,0)};void 0===he.IsToBePersisted||null===he.IsToBePersisted||he.IsToBePersisted||(Cg=538,kg=(sg,ng,eh)=>{var yh=Telemetry.PrivacyRules.GetPrivacyCompliantId(he.SolutionId,he.StoreType,he.AssetId,null,null,he.StoreId);B.ULS.sendTraceTag(537170442,220,50,`Web Method ShowAgaveTaskpane is called, StoreType ${he.StoreType}, StoreId ${he.StoreId}, SolutionId ${yh}.`);yh=this.$.ma.sa;sg=Db.c(sg,this.gyg);const Ph=yh.$a(9,void 0===
$f?null:$f);Ph.sharedInfo=he;return Ub.h(yh,"ShowAgaveTaskpane",Ph,sg,ng,eh,lc,0)});Nc|=64;return Wl.a(this.$.userOperationManager,kg,sg=>new Ob.a(Cg,0,sg,Nc),De)}return E.TaskExtensions.E7()},Yd=he=>{var De=Telemetry.PrivacyRules.GetPrivacyCompliantId(he.solutionId,he.storeType,he.assetId,null,null,he.storeId);B.ULS.sendTraceTag(537170440,220,50,`Insert addincommands for ${De} from ${he.storeType}.`);De={};De[Pa.a.YFb]=new Qc.a([he]);De[Pa.a.j0]=3;he=new Lc.a($g.a.lnb,0,this.$.xc,0,null);return this.$.Ia.Gb(he,
De)};if(!M.EwaSettings.Ra(52)||D.StoreId===OSF.StoreType.FirstParty)return wd(D,vb,lc);if(ma.isAddinCommands)return Yd(ma);const ee=new Mg.a,ae={};ae.solutionId=D.SolutionId;ae.version=D.Version;ae.storeType=D.StoreType;ae.storeId=D.StoreId;ae.targetData=D;this.Gc.Cf.isAddinCommandsAsync(ae,(he,De,Se)=>{ee.setResult(De);he||(he=Se.targetData,De=Telemetry.PrivacyRules.GetPrivacyCompliantId(he.SolutionId,he.StoreType,he.AssetId,null,null,he.StoreId),B.ULS.sendTraceTag(537170438,220,10,`Judging AddinCommands failed for ${De} from ${he.StoreType} during addin inserting`))});
return E.TaskExtensions.ts(ee.task,he=>{var De;he=he.result;return t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MosForWXPEnabled",!1)&&ak.a.includes(null===(De=ma.solutionId)||void 0===De?void 0:De.toLowerCase())?null:he?Yd(ma):wd(D,vb,lc)},this.$.Aa)}TLc(D,ma){if(!this.wMa[ma])return{kzl:D,RNb:null};const vb={},lc={};if(D)for(var Nc of D){const [Yd,ee]=Nc;vb[Yd]=ee}D=this.wMa[ma];for(var wd of Object.keys(D))Nc=D[wd],wd===yg.Fzi?vb[wd]=lc[wd]=Sys.Serialization.JavaScriptSerializer.serialize(Nc):
(!M.EwaSettings.isChangeGateEnabled("OfficeVSO:8380805_LogsToInvestigateMergeFirstPartySettingsCrash_2")||null!==Nc&&void 0!==Nc||B.ULS.sendTraceTag(508072652,220,15,"AgaveCommandHandler.mergeFirstPartySettings: value is null or undefined. firstPartySolutionId: "+ma+". key: "+wd+". value is null: "+(null===Nc)),vb[wd]=lc[wd]=Sys.Serialization.JavaScriptSerializer.serialize(Nc.toString()));ma=Object.keys(vb).map(Yd=>[Yd,vb[Yd].toString()]);wd=Object.keys(lc).map(Yd=>[Yd,lc[Yd].toString()]);return{WRc:ma,
RNb:wd}}VFj(D,ma,vb){const lc=this.$.ta.UserSessionId,Nc=this.$.ta.UICultureTag,wd=this.$.ta.UICultureTagLcid,Yd=this.$.ta.WacHostId;let ee="",ae="";5<=vb.length&&(ee=vb[3],ae=vb[4]);this.WFj(ee,ae,D,ma,Nc,wd,lc,Yd)}WFj(D,ma,vb,lc,Nc,wd,Yd,ee){const ae={};ae.a=Yd;ae.b=vb;ae.c=lc;ae.d=D;ae.e=ma;ae.f=Nc;ae.g=wd;ae.h=ee;ze.logData(36,ae)}lWc(D,ma,vb,lc,Nc,wd){ma=void 0===ma?null:ma;vb=void 0===vb?!1:vb;lc=void 0===lc?null:lc;Nc=void 0===Nc?null:Nc;wd=void 0===wd?!0:wd;var Yd=D.SolutionId,ee=bd.Task.Va(!1);
D&&Yd&&D.SharedRuntimeId&&(lc=lc||new Lc.a(-859308420,0,2,0,""),Yd={},Yd.solutionId=D.SolutionId,Yd.version=D.Version,Yd.storeType=D.StoreType,Yd.storeId=D.StoreId,Yd.assetId=D.AssetId,Yd.assetStoreId=D.AssetStoreId,Yd.height=D.Height,Yd.targetType=D.TargetType,Yd.width=0,Yd.isAddinCommands=!1,Yd.sharedRuntimeId=D.SharedRuntimeId,D.Preload=wd,Nc=Nc?Nc:new gi.a,Nc.width=0,ma&&(wd=ma,Nc.focusOnIframeWhenLoaded=wd.focusOnIframeWhenLoaded,ee=new Bl,wd.Qm&&(ee.A0c=wd.Qm),0<wd.taskPaneWidth&&(ee.cS=wd.taskPaneWidth),
wd.aS&&(ee.z0c=wd.aS),M.EwaSettings.isChangeGateEnabled("OfficeVSO:7644290_MsFormsCorrelationId")&&wd.ps&&(this.wMa[D.SolutionId]=ma.ps),this.nHd[D.SolutionId]=ee,this.$me[D.SolutionId]=ma.onExtensionLaunchCallback,this.sdxPrivateApi[D.SolutionId]=ma.sdxPrivateApi),ma={},ma[$b.a.Bf]=D,ma[Pa.a.zqa]=Yd,ma[gi.a.key]=Nc,ma[F.a.wna]=vb,ee=this.insertAgave(ma,lc));return ee}Jva(D,ma,vb,lc,Nc,wd){wd=void 0===wd?null:wd;if(D&&vb){D=new Wd.a(D,OSF.StoreType.Sdx,OSF.StoreType.Sdx,Nc);Nc=new Je.a("ExcelOnline",
"Web",this.$.ta.UICultureTag);const Yd=new je.a;Yd.xe[Yg.a.kmd]=lc;wd&&(lc=wd,lc.sourceLocationOverrideResourceId&&(Yd.xe[Yg.a.sourceLocationOverrideResourceId]=lc.sourceLocationOverrideResourceId),lc.Qm&&(Yd.xe[Yg.a.Qm]=lc.Qm),lc.gs&&(Yd.xe.IconCssClass=lc.gs),lc.rwe&&(Yd.xe.TaskPaneIconUrl=lc.rwe),lc.aS&&(Yd.xe.TaskPaneIconId=lc.aS),lc.onExtensionLaunchCallback&&(Yd.xe[Yg.a.onExtensionLaunchCallback]=lc.onExtensionLaunchCallback),lc.sdxPrivateApi&&(Yd.xe[Yg.a.sdxPrivateApi]=lc.sdxPrivateApi));vb&&
(Yd.xe[Yg.a.actionName]=vb);ad.a.instance.Jva(D,ma,vb,Nc,Yd)}}kXi(D){if(!Hc.a.Zg(D)){var ma=D.extId;if(ma&&(ma=ma.getId(),D=D.OptionalProps,ma&&D))return this.vja(ma,D.xe[Yg.a.sourceLocationOverrideResourceId])}return null}vja(D,ma){ma=void 0===ma?null:ma;return D&&ma?`${D}.${ma}`:D}EMi(D){switch(D){case 1172793074:case 1221897806:case 1930653487:return 2;case -515602470:return 1;case 1723441034:return 1023;case -859308420:return 1023;case 515196233:return 1023;case 301511274:return 1023;default:return 1}}}
yg.abe="IDS";yg.Lbj="FA000000012";yg.DYa="FA000000005";yg.Ibj="HelloWorld";yg.iXh="FA000000014";yg.HPd="Help.GiveFeedback.Url";yg.D2h="Help.ContactSupport.Url";yg.Fzi="feedback";yg.v9f="FA000000066";yg.zdk="PowerBi.Url";yg.xdk="PowerBi.DevUrl";yg.ydk="FA000000054";yg.ePj="FA000000064";yg.P8j="FA000000075";yg.B6e="AnalyzeDataTaskPane";yg.Glk="RecommendedChartsTaskPane";yg.zbk="PivotTableTaskPane";yg.sVf=320;yg.Tgk=320;yg.D4h="CopilotSDXTaskpane";yg.mrc="FA000000124";yg.Onf=350;yg.n3k="AgaveTaskPane-";
yg.WGh="g_InstallOrigin";Object(l.a)(yg,"AgaveCommandManager",yi.a,[354,355]);class el extends ok.a{constructor(D){super();this.$=D;this.ri()}create(){const D=this.$.ra,ma=K.DdaFacadeService.Oa()?Object(Th.d)(L.a.resolve(K.DdaFacadeService,{xa:this.Cc})):kc.GetServiceTaskFactory.create(D,106,this.Aa,this.Cc),vb=kc.GetServiceTaskFactory.create(D,104,this.Aa,this.Cc),lc=Object(Th.d)(L.a.resolve(K.AgaveListenerHandlerService));E.TaskExtensions.tb(E.TaskExtensions.jl([vb,ma,lc],this.Aa),()=>{let Nc=null;
Nc=Object(Ha.d)(Wj.a).instance;qj.instance.initialize(ma.result);const wd=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PreloadRaceCondition6395242",!0)?Object(Zk.a)(this.$.ra,374,()=>new yg(this.$,ma.result,vb.result,Nc,t.AFrameworkApplication.Kb,lc.result,Object(Ha.d)(cd.b))):new yg(this.$,ma.result,vb.result,Nc,t.AFrameworkApplication.Kb,lc.result,Object(Ha.d)(cd.b));D.zc(206,wd);this.Uf(D.Tb(374)||D.zc(374,wd))},this.Aa,3);sa.a.instance.register($k.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").Lc().Qc(()=>
new $k.a(this.$.pT))}static Ea(D){D.ra.zc(375,new el(D))}}Object(l.a)(el,"AgaveCommandManagerFactory",ok.a,[]);class Bk extends Jg.a{constructor(D){super(D)}oq(){const D=K.DdaFacadeService.Oa()?Object(Th.d)(L.a.resolve(K.DdaFacadeService,{xa:this.Cc})):kc.GetServiceTaskFactory.create(this.$.ra,106,this.Aa,this.Cc),ma=Object(Th.d)(L.a.resolve(K.NewAndOpenUXService,{xa:this.Cc})),vb=cf.a(this.Aa,this.Cc),lc=Object(Th.d)(L.a.resolve(K.HtmlSanitizationHelperService,{xa:this.Cc})),Nc=K.ExternalLinksManagerService.Oa()?
Object(Th.d)(L.a.resolve(K.ExternalLinksManagerService,{xa:this.Cc})):bd.Task.Va(null);E.TaskExtensions.tb(E.TaskExtensions.jl([D,ma,vb,lc,Nc],this.Aa),()=>{const Yd=D.result,ee=Object(Ha.a)(lj);this.fn([new ra(this.$,Yd,ee,lc.result,Nc.result)])},this.Aa,3);const wd=sa.a.instance;K.HostMessengerService.Oa()?void L.a.resolve(K.HostMessengerService,{xa:this.Cc}).then(()=>{sa.a.instance.register(Kc,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").Lc().Qc(()=>new Kc)}):
E.TaskExtensions.tb(kc.GetServiceTaskFactory.create(this.$.ra,137,this.$.Aa,this.Cc),()=>{wd.register(Kc,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").Lc().Qc(()=>new Kc)},this.$.Aa)}static Ea(D){Jg.a.cw(82,new Bk(D))}}Object(l.a)(Bk,"DdaCommandHandlerFactory",Jg.a,[]);M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveRequireFromSlices",!1)||a(1143);(()=>{nk.a.wb(D=>{M.EwaSettings.Ra(52)&&xl.Ea(D)})})();(()=>{nk.a.wb(D=>{M.EwaSettings.Ra(114)&&wj.Ea(D)})})();
(()=>{nk.a.wb(D=>{K.DdaFacadeService.Oa()||yk.Ea(D)})})();(()=>{nk.a.wb(D=>{K.AgaveCommandHandlerService.Oa()&&K.SmartLookupCommandHandlerService.Oa()||zl.Ea(D);el.Ea(D)})})();(()=>{nk.a.wb(D=>{Bk.Ea(D)})})();String(f);String(k);String(x);String(Oa);String(d);String(h);String(n);String(m);String(Pb);window.___1717508060391_closurehack=f;window.___1717508060391_closurehack=k;window.___1717508060391_closurehack=x;window.___1717508060391_closurehack=Oa;window.___1717508060391_closurehack=d;window.___1717508060391_closurehack=
h;window.___1717508060391_closurehack=n;window.___1717508060391_closurehack=m;window.___1717508060391_closurehack=Pb},958:function(y,r,a){a.r(r);a.d(r,"DdaFacade",function(){return Qe});var c=a(0),b=a(19),f=a(257),k=a(1513),x=a(1150),d=a(2),h=a(15),n=a(1676),m=a(112);class u{constructor(Aa,Fb,Ta){this._id=Aa;this.vih=Fb;this.ykh=Ta;this.kYf=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get XGh(){return this.vih}get g0h(){return this.ykh}execute(Aa,Fb,Ta){Ta=Ta||{};Ta.commandMode=this.kYf;
Fb.invokeAppCommand(this.XGh,this.g0h,Ta,()=>{Aa.P1j(this.id)})}}Object(c.a)(u,"AddinNativeActionBase",null,[200]);class l extends u{constructor(Aa,Fb){super(1,Aa,Fb);this.kYf=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(c.a)(l,"AddinTakeSnapshotAction",u,[]);class t{o5h(Aa){return new u(3,Aa,this.WIi().getNativeActionName(3))}WIi(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}Object(c.a)(t,"AddinNativeActionManager",null,[186]);var e=a(238);class w{invokeAppCommand(Aa,Fb,
Ta,Eb){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(Aa,Fb,Ta,Eb)}static getInstance(){w.Wa||(w.Wa=new w);return w.Wa}}w.Wa=null;Object(c.a)(w,"OSFAddinCommandsRuntimeManager",null,[187]);var z=a(6),E=a(245);class M extends e.a{constructor(Aa,Fb,Ta){super();this.mha=null;this.bld="WACDialogTitleText";this.n5="0";this.sga="15px";this.Skh="0px";this.m5="calc(100% - 30px)";this.Rkh="100%";this.nWe=0;this.xb=new m.a;this.xih=new t;this.hc=5;this.uf=this.fPa=Ta;this.X9c=Aa;this.zKe=Fb;this.s$c=
!!z.AFrameworkApplication.ea&&z.AFrameworkApplication.ea.ka("OfficeAddinEnableInsertDialogAccessibilityFix")}dFh(Aa){this.xb.addHandler("OnDialogClosedEventKey",Aa)}hLk(){this.oQa=null}rB(){super.rB();this.fj.style.width="100%";this.fj.style.height=this.BRb?this.m5:this.Rkh;this.fj.style.marginTop=this.BRb?this.sga:this.Skh;this.fj.style.padding=this.n5}IO(){super.IO();this.Fb.style.width=String.format("{0}px",this.X9c*window.innerWidth/100);this.Fb.style.height=String.format("{0}px",this.zKe*window.innerHeight/
100);this.Fb.style.minWidth="0px";this.s$c&&z.AFrameworkApplication.isRtl&&100===this.X9c&&(this.Fb.style.right="0px",this.Fb.style.marginRight="0px");this.mha=document.getElementById(this.qj(this.bld));this.mha.style.position="absolute";this.mha.style.whiteSpace="nowrap";this.mha.style.textOverflow="ellipsis";z.AFrameworkApplication.isRtl?(this.mha.style.right="14px",this.mha.style.left="44px"):(this.mha.style.right="44px",this.mha.style.left="14px")}HG(Aa){super.HG(Aa);this.mha&&this.mha.setAttribute("title",
Aa)}get Tia(){return this.fj}Nke(){this.Fb.style.width=String.format("{0}px",this.X9c*window.innerWidth/100);this.Fb.style.height=String.format("{0}px",this.zKe*window.innerHeight/100);this.Fb.style.overflowY="hidden";this.Fb.style.overflowX="hidden";this.Fb.style.marginTop="";this.Fb.style.top="";this.Fb.style.left="";this.Fb.style.marginLeft=""}hide(){this.xih.o5h(this.fPa).execute(this,w.getInstance(),{});this.nWe=window.setTimeout(()=>{this.xb.raiseEvent("OnDialogClosedEventKey",this.fPa);E.a.prototype.hide.call(this)},
500)}P1j(Aa){3===Aa&&(window.clearTimeout(this.nWe),this.xb.raiseEvent("OnDialogClosedEventKey",this.fPa),super.hide())}}Object(c.a)(M,"AppsForOfficeDialog",e.a,[164,165]);class G{constructor(){this.dialog=this.uf=null}}Object(c.a)(G,"DialogInfo",null,[]);class A{constructor(){this.height=this.width=0;this.uf=this.controlId=this.pageUrl=null;this.fUf=this.Phi=!1}}Object(c.a)(A,"DisplayDialogParams",null,[]);class N extends Sys.EventArgs{constructor(Aa,Fb,Ta,Eb,oc){Ta=void 0===Ta?null:Ta;Eb=void 0===
Eb?"":Eb;oc=void 0===oc?"":oc;super();this.controlId=Aa;this.messageType=Fb;this.messageContent=Ta;this.messageOrigin=Eb;this.targetOrigin=oc}}Object(c.a)(N,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class K extends Sys.EventArgs{constructor(Aa,Fb,Ta,Eb,oc){Ta=void 0===Ta?null:Ta;Eb=void 0===Eb?"":Eb;oc=void 0===oc?"":oc;super();this.controlId=Aa;this.messageType=Fb;this.messageContent=Ta;this.messageOrigin=Eb;this.targetOrigin=oc}}Object(c.a)(K,"OnMessageParentEventArgs",Sys.EventArgs,[]);var I=
a(48),L=a(32),J=a(189),B=a(113),Y=a(24);class U{constructor(Aa){this.xb=new m.a;this.CWj=(Fb,Ta)=>{if(Fb=this.$Wa(Ta))this.xl.purgeDialogControl(Ta),U.ega.remove(Fb),this.xb.raiseEvent("OnMessageParentEventKey",new K(Fb,OSF.DialogMessageType.DialogClosed,null,null,"*"))};this.xl=Aa}nFh(Aa){this.xb.addHandler("OnMessageParentEventKey",Aa)}mFh(Aa){this.xb.addHandler("OnMessageDialogEventKey",Aa)}showDialog(Aa,Fb,Ta,Eb){if(U.ega.Bb(Fb))h.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),
Ta(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{const le=I.b(Aa),ge=le.url;if(this.xl.getOsfControl(Fb).checkAppDomains(ge)){var oc=new A;oc.width=le.width;oc.height=le.height;oc.pageUrl=ge;oc.Phi=le.displayInIframe;oc.fUf=le.hideTitle;oc.controlId=Fb;oc.uf=J.a.create().toString();var Lc=new G;Lc.uf=oc.uf;var Jd=this.xl.getOsfControl(oc.controlId).getManifest().getDefaultDisplayName(),Ab=this.xl.getOsfControl(oc.controlId).getStoreType().toLowerCase();Aa=null;Aa=(4===z.AFrameworkApplication.ua.Ab.gi&&
"hardcodedpreinstall"===Ab||"sdxcatalog"===Ab)&&oc.fUf?this.createAndShowAppsForOfficeDialog(oc.width,oc.height,oc.uf,!0,Jd):this.createAndShowAppsForOfficeDialog(oc.width,oc.height,oc.uf,!1,Jd);var Uc=this.xl.getOsfControl(oc.controlId),Od=Uc.getManifest();Fb={};Fb.id=oc.uf;Fb.solutionId=Uc.getSolutionId();Fb.version=Uc.getVersion();Fb.storeType=Ab;Fb.storeId=Uc.getStoreId();Fb.assetId=Uc.getAssetId();Fb.assetStoreId=Uc.getAssetStoreId();Fb.ownerAddinSolutionId=Uc.getOwnerAddinSolutionId();Fb.ownerAddinStoreType=
Uc.getOwnerAddinStoreType();Fb.appDomains=Od.getAppDomains();Fb.dialogUrl=ge;Fb.osfControlType=1;Fb.agaveName=Jd;Fb.div=Aa.Tia;h.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Fb.solutionId,Fb.ownerAddinStoreType||Fb.storeType,Fb.assetId,null,null,Fb.storeId),L.a.qz(oc.pageUrl));this.xl.insertDialogControl(Fb);Aa.dFh(this.CWj);Lc.dialog=Aa;U.ega.ga(oc.controlId,Lc);Eb&&Eb(Fb);Ta(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else h.ULS.sendTraceTag(19940611,
344,10,"ShowDialog: dialog url not in app domains list."),Ta(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(le){h.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",le.message),Ta(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}TLj(Aa,Fb,Ta,Eb){z.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",!1)||""===Eb&&(Eb=Ta);try{const oc=this.$Wa(Aa);oc&&this.xb.raiseEvent("OnMessageParentEventKey",
new K(oc,OSF.DialogMessageType.DialogMessageReceived,Fb,Ta,Eb))}catch(oc){return h.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",oc.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}VTa(Aa,Fb){if(U.ega.Bb(Aa))try{const Ta=U.ega.pa(Aa);Ta.dialog&&Ta.dialog.hide();this.xl.purgeDialogControl(Ta.uf);U.ega.remove(Aa);Fb(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(Ta){h.ULS.sendTraceTag(18371106,
344,10,"CloseDialog: action failed. Exception message: {0}",Ta.message),Fb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else h.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),Fb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}gGk(Aa,Fb,Ta,Eb){z.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",!1)||""===Eb&&(Eb=Ta);if(U.ega.Bb(Aa)&&(Aa=U.ega.pa(Aa),Aa.dialog))try{this.xb.raiseEvent("OnMessageDialogEventKey",
new N(Aa.uf,OSF.DialogMessageType.DialogParentMessageReceived,Fb,Ta,Eb))}catch(oc){h.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",oc.message)}}$Wa(Aa){let Fb=null;for(const Ta of U.ega)if(Ta.value.uf===Aa){Fb=Ta.key;break}return Fb}createAndShowAppsForOfficeDialog(Aa,Fb,Ta,Eb,oc){Aa=new M(Aa,Fb,Ta);oc=Eb?"":String.format(Object(Y.a)("ShowDialogApiInlineDialogTitle"),oc);Eb&&(Aa.BRb=!1,Aa.ov=!1);Aa.initializeAndShow(oc,null,null);Aa.hLk();return Aa}static s5i(){return U.ega}static getInstance(Aa){U.Wa||
(U.Wa=new U(Aa));return U.Wa}}U.Wa=null;U.ega=new B.a;Object(c.a)(U,"AppsForOfficeDialogManager",null,[152]);var O=a(1615),C=a(874),X=a(661),S=a(254),ea=a(436),Oa=a(1146);class Ha{constructor(){this.releaseDate=this.diffAUP=this.AUP=this.priority=0}}Object(c.a)(Ha,"AddinDetailInfo",null,[]);class Za{constructor(Aa,Fb){this.failure=null;this.G6=Aa;this.errorCode=void 0===Fb?0:Fb}}Object(c.a)(Za,"AddinQueryResult",null,[]);class fa extends Za{constructor(Aa,Fb){super(Aa,void 0===Fb?0:Fb);this.solutionIds=
null}}Object(c.a)(fa,"AddinCollection",Za,[]);var la;(function(Aa){Aa[Aa.stop=-1]="stop";Aa[Aa.skip=0]="skip";Aa[Aa.query=1]="query"})(la||(la={}));Object(c.b)("QueryStrategy",la);var ba=a(1073);class aa extends Sys.EventArgs{constructor(Aa,Fb,Ta,Eb){Eb=void 0===Eb?null:Eb;super();this.rF=Aa;this.errorCode=Fb;this.Ym=Ta;this.failure=Eb}}Object(c.a)(aa,"AddinDetailsRefreshedEventArgs",Sys.EventArgs,[]);class oa{constructor(Aa){this.errorCode=Aa;this.Ym=[];this.failure=null}}Object(c.a)(oa,"GetAddinDetailsResult",
null,[]);var Na=a(948),Ia=a(1057);class Sa{}Object(c.a)(Sa,"GetEntitlementDetailsParameters",null,[]);var Pa=a(66),za=a(230),wa=a(169);class db{constructor(Aa){this.lIe=432E5;Aa&&(this.lIe=36E5*Aa.getIntFeatureGate("Microsoft.Office.SharedOnline.FlyoutCacheExpiration",12))}P1i(Aa){const Fb=new Date;let Ta=new Date(-1);try{const Eb=db.H4g(`${Aa}_ExpirationTime`);Eb&&(Ta=new Date(parseInt(Eb,10)))}catch(Eb){h.ULS.sendTraceTag(508063829,220,50,`Failed to parse expiration time for add-in ${Aa}: ${Eb}`)}if(Fb.getTime()<
Ta.getTime()&&(Aa=db.H4g(`${Aa}_StoreDisabled`)))return"true"===Aa}$Mk(Aa,Fb){void 0!==Fb&&null!==Fb&&(db.b5g(Fb.toString(),`${Aa}_StoreDisabled`),db.b5g(((new Date).getTime()+this.lIe).toString(),`${Aa}_ExpirationTime`))}static H4g(Aa){let Fb=null;try{const Ta=db.g9b;if(void 0!==Ta&&Ta){const Eb=Na.a.gib("Flyout")+"_"+Aa;Fb=Ta.getItem(Eb)}else h.ULS.sendTraceTag(508063828,220,50,"tryGetCache: Storage.Local null")}catch(Ta){h.ULS.sendTraceTag(508063827,220,10,"tryGetCache: Failed to get data Cache {0} for suffix {1}.",
"Flyout",Aa)}return Fb}static b5g(Aa,Fb){try{const Ta=db.g9b;if(void 0!==Ta&&Ta){const Eb=Na.a.gib("Flyout")+"_"+Fb;Ta.setItem(Eb,Aa)}else h.ULS.sendTraceTag(508063826,220,50,"trySetCache: Storage.Local null")}catch(Ta){h.ULS.sendTraceTag(508063825,220,10,"trySetCache: Failed to set AddinCommands Cache {0} for suffix {1}.","Flyout",Fb)}}static get g9b(){if(!db.N7)return null;let Aa=null;try{Aa=localStorage}catch(Fb){db.N7=!1,Aa=null,h.ULS.sendTraceTag(508063824,220,50,`Failed to use localStorage: error name: ${Fb.name}; message: ${Fb.message}; stack: ${Fb.stack}`)}return Aa}}
db.N7=!0;Object(c.a)(db,"StoreDisabledCache",null,[]);var Ba=a(1291),Ka=a(1074);class da{constructor(Aa,Fb,Ta){Ta=void 0===Ta?null:Ta;var Eb;this.xb=new m.a;this.St=new C.a(X.a.Ef());this.As=new ea.a;this.p_=0;this.GS=new ea.a;this.hhd=null;this.Epb=(oc,Lc,Jd)=>{if(Jd)if(this.g3d(oc,Jd,window.performance.now()-Lc),0===Jd.errorCode){let Ab;if(Jd.value){let Uc=0;Ab=Array(Jd.value.length);Jd.value.forEach(Od=>{Ab[Uc++]=Od})}else Ab=[];this.mB(new Za(oc),Ab)}else-1===Jd.errorCode||10===Jd.errorCode?this.mB(new Za(oc),
[]):(oc=this.ftd(oc,Lc,Jd),this.mB(oc));else oc=da.gtd(oc,Lc),this.mB(oc)};this.J1a=(oc,Lc)=>{if(0!==Lc.errorCode)this.As.ga(Lc.rF,Object.assign(new fa(Lc.rF,Lc.errorCode),{failure:Lc.failure})),this.w9(Lc.rF,1);else{oc=Object.assign(new fa(Lc.rF),{solutionIds:new S.a});var Jd=Lc.Ym;for(const Ab of Jd)Jd=Ab.solutionId,this.St.Bb(Jd)?this.St.ga(Jd,this.C5d(this.St.pa(Jd),Lc.rF,Ab)):this.St.add(Jd,Ab),oc.solutionIds.add(Jd);this.As.ga(Lc.rF,oc);this.w9(oc.G6,1)}};this.Fpa=new za.a;this.Fpa.add(OSF.StoreTypeEnum.MarketPlace,
0);this.Fpa.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.ya=Aa;this.xl=Fb;this.hz=Ta;this.Rbd=da.cMd(Aa,"https://store-images.s-microsoft.com");this.tFb(this.J1a);this.iZe=null!==(Eb=Ta.StoreDisabledCache)&&void 0!==Eb?Eb:new db(Aa)}get a3(){return!!this.ya&&this.ya.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MosForWXPEnabled",!1)}get Mge(){return this.hz&&!0===this.hz.RefreshMyAddinsErrorCodeFixEnabled}get eI(){return!!this.ya&&this.ya.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}get i3d(){return!!this.ya&&
this.ya.isChangeGateEnabled("OfficeVSO:8366459_LogQueryCompletedV2Enabled")}get Rte(){return!!this.ya&&this.ya.isChangeGateEnabled("OfficeVSO:8350408_SingleStoreDisabledQueryEnabled")}get V0k(){return!!this.ya&&this.ya.isChangeGateEnabled("OfficeVSO:8352847_StoreDisabledCacheEnabled")}get isAnonymousUser(){return!!this.ya&&this.ya.ka("IsAnonymousUser")}get NHd(){return!!this.ya&&this.ya.isChangeGateEnabled("OfficeVSO:8335746_FlyoutUserNoMailboxFixEnabled")}get Ahb(){return!!this.ya&&this.ya.isChangeGateEnabled("OfficeVSO:8335748_FlyoutUserNotSignedInFixEnabled")}get sca(){return this.ya.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",
!1)}get Cf(){return this.xl.value}oQ(Aa){if(this.eI&&!this.Cua(Aa))return new oa(0);if(this.Mge){var Fb=this.KOb(Aa);0===Fb.errorCode&&0===Aa&&(Fb=this.KOb(2));if(0!==Fb.errorCode)return Fb}else{if(!this.Bua(Aa))return Aa=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:Oa.a[Aa]}),Object.assign(new oa(1),{failure:Aa});if(this.As.pa(Aa).failure)return Object.assign(new oa(this.As.pa(Aa).errorCode),{failure:this.As.pa(Aa).failure})}h.ULS.shipAssertTag(509870082,220,!!this.As.pa(Aa).solutionIds,
"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Aa);Fb=new oa(0);for(const Ta of this.As.pa(Aa).solutionIds)this.St.Bb(Ta)&&Array.add(Fb.Ym,this.St.pa(Ta));return Fb}KOb(Aa){return this.Bua(Aa)?this.As.pa(Aa).failure?Object.assign(new oa(this.As.pa(Aa).errorCode),{failure:this.As.pa(Aa).failure}):new oa(0):(Aa=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:Oa.a[Aa]}),Object.assign(new oa(1),{failure:Aa}))}getUpgradedAddinsOfOmex(){return this.Cf.getUpgradedAddinsOfOmex()}getDataLocale(){return this.Cf.getDataLocale()}nQ(Aa){return this.St.Bb(Aa)?
this.St.pa(Aa):null}sxa(Aa){if(Aa){this.tFb(Aa);for(const Fb of this.As.keys){if(this.eI&&!this.Cua(Fb))continue;if(!this.Bua(Fb)||this.As.pa(Fb).failure)continue;h.ULS.shipAssertTag(509870081,220,!!this.As.pa(Fb).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Fb);const Ta=[],Eb=this.As.pa(Fb);for(const oc of Eb.solutionIds)Array.add(Ta,this.St.pa(oc));Aa(null,new aa(Fb,Eb.errorCode,Ta,Eb.failure))}}}get name(){return"AddinDetailsManager1"}Rrb(Aa,
Fb){if(this.eI&&da.S_a(Aa)){var Ta=oc=>{this.mB(da.iTa(oc,4,"The connected service is disabled."));this.w9(oc,-1)},Eb=oc=>{this.mB(da.iTa(oc,0,"The user doesn't have any addin installed."),[]);this.w9(oc,0)};0===Aa?(this.JSb(0,Fb,Ta,Eb),this.JSb(2,Fb,Ta,()=>{this.s3a(this.Epb)})):10===Aa&&this.w9(1,1)}}sB(Aa,Fb){da.S_a(Aa)?this.$ee(Aa,this.Epb,void 0===Fb?!1:Fb):h.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",Ia.a[Aa])}tFb(Aa){this.xb.addHandler(Na.a.Vlc,Aa)}JSb(Aa,
Fb,Ta,Eb){this.Cua(Aa)||(3===Fb&&Ta?Ta(Aa):2===Fb&&Eb?Eb(Aa):this.w9(Aa,1))}Cua(Aa){return this.GS.Bb(Aa)}w9(Aa,Fb){if(this.eI){var Ta=this.Cua(Aa);if(!Ta||-1!==this.GS.pa(Aa)&&this.GS.pa(Aa)!==Fb)h.ULS.sendTraceTag(508610435,220,50,"RegisterCollectionType: collectionType: {0}, strategy: {1} -> {2}.",Oa.a[Aa],Ta?la[this.GS.pa(Aa)]:"undefined",la[Fb]),this.GS.ga(Aa,Fb)}}ftd(Aa,Fb,Ta){const Eb={};Eb.collectionType=Oa.a[Aa];Eb.invokeResultCode=Ta.errorCode;Eb["queryResult.Value"]=Ta.value?String.format("Length: {0}",
Ta.value.length):"null";Eb.queryStart=Fb;Eb.queryDuration=window.performance.now()-Fb;return Object.assign(new Za(Aa,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",Eb)})}$Rk(){return this.Bua(2)?this.ya.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?3===this.As.pa(2).errorCode:!1:!0}Cub(Aa){return this.eI&&this.GS.Bb(Aa)?1===this.GS.pa(Aa):!0}$ee(Aa,Fb,Ta){Ta=void 0===Ta?!1:Ta;h.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",
Aa);if(Aa!==OSF.StoreTypeEnum.MarketPlace&&Aa!==OSF.StoreTypeEnum.PrivateCatalog)h.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",Aa);else{var Eb=this.Fpa.pa(Aa);(!this.Rte||this.Ahb&&this.isAnonymousUser)&&Aa===OSF.StoreTypeEnum.MarketPlace&&this.Cub(2)&&this.s3a(Fb);this.Cub(Eb)&&(this.Ahb&&this.isAnonymousUser?(Aa=da.Rsd(Eb),this.mB(Aa)):this.afe(Aa,Fb,Ta))}}yCi(Aa,Fb){const Ta=new Map;Aa.forEach(Eb=>{Ta.set(Eb.solutionId.toLowerCase(),Eb)});for(const Eb of Fb)Ta.has(Eb.solutionId.toLowerCase())?
Ta.get(Eb.solutionId.toLowerCase()).addinInfo=Eb.addinInfo:h.ULS.sendTraceTag(507015644,220,50,"Addin Details Manager: fixUpAddinDetailsWithAdditionalAddinInfo: additionalAddinDetail '{0}' is not in addinDetailsMap",Object(Ka.b)(Eb))}afe(Aa,Fb,Ta){this.ZAg(Aa,(Eb,oc)=>{if(Eb===OSF.StoreTypeEnum.MarketPlace&&oc)oc=da.xDa(0),this.mB(oc),this.Rte&&this.mB(da.xDa(2));else if(Eb===OSF.StoreTypeEnum.PrivateCatalog&&oc)oc=da.xDa(1),this.mB(oc);else{if(this.Rte&&Eb===OSF.StoreTypeEnum.MarketPlace&&this.Cub(2))if(this.a3){const Jd=
window.performance.now(),Ab=this.vle();oc=Ab.value.map(Uc=>Uc.solutionId).concat(Ba.a);this.Cf.queryAppDetailsFromTMT(oc.map(Uc=>Object(Ba.b)(Uc)),!0,(Uc,Od)=>{this.Gxc(Od);this.yCi(Od,Ab.value);Fb(2,Jd,{errorCode:Uc,value:Od})})}else Fb(2,window.performance.now(),this.vle());var Lc=window.performance.now();this.Cf.getEntitlementDetails(Object.assign(new Sa,{storeType:Eb,refresh:Ta}),Jd=>{Fb(this.Fpa.pa(Eb),Lc,Jd)})}})}s3a(Aa){this.$Rk()&&this.ZAg(0,(Fb,Ta)=>{Ta?(Fb=da.xDa(2),this.mB(Fb)):(Fb=window.performance.now(),
Aa(2,Fb,this.vle()))})}mB(Aa,Fb){Fb=void 0===Fb?null:Fb;0!==Aa.errorCode?(h.ULS.shipAssertTag(509116673,220,!Fb,"The parameter addinDetails must be null for any failed queries"),h.ULS.shipAssertTag(509116672,220,!!Aa.failure,"The result.Failure must not be available for any failed queries"),this.Pre(Aa)?h.ULS.sendTraceTag(510253056,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","",Oa.a[Aa.G6],ba.a[Aa.errorCode],Aa.failure?Aa.failure.toString():
"null",JSON.stringify(Aa.failure)):h.ULS.sendTraceTag(508610434,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","(downgraded error)",Oa.a[Aa.G6],ba.a[Aa.errorCode],Aa.failure?Aa.failure.toString():"null",JSON.stringify(Aa.failure))):(h.ULS.shipAssertTag(509116643,220,!!Fb,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is null.",Oa.a[Aa.G6]),h.ULS.sendTraceTag(509116642,220,50,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails",
Oa.a[Aa.G6],Fb?Fb.length:-1));Aa=new aa(Aa.G6,Aa.errorCode,Fb,Aa.failure);this.xb.raiseEvent(Na.a.Vlc,Aa)}Pre(Aa){return 3===Aa.errorCode&&(this.Ahb&&-2147208619===da.UPb(Aa)||this.NHd&&-2===da.UPb(Aa))||4===Aa.errorCode?!1:2!==Aa.errorCode}Bua(Aa){return this.As.Bb(Aa)?!!this.St:!1}get $mc(){return this.hz?!this.hz.AreThirdPartyAddInsAllowed||this.hz.AppsForOfficeThirdPartyIsDisabled:!this.ya.ka("AreThirdPartyAddInsAllowed")||this.ya.ka("AppsForOfficeThirdPartyIsDisabled")}get VGc(){return this.hz?
!this.hz.AppsForOfficeAllowExternalMarketplace:!this.ya.ka("AppsForOfficeAllowExternalMarketplace")}get Oqb(){return this.hz?this.hz.PopularAddinDetailsJsonString:this.ya.Qa("PopularAddinDetailsJsonString")}queryStoreDisabled(Aa,Fb){if(this.$mc)Fb(Aa,!0);else if(Aa===OSF.StoreTypeEnum.MarketPlace&&this.VGc)Fb(Aa,!0);else{const Ta=da.f1c(Aa);if(Ta){const Eb=window.performance.now();this.Cf.queryStoreDisabled(Ta,oc=>{h.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",
Aa,oc,Eb,window.performance.now()-Eb);Fb(Aa,oc)})}else Fb(Aa,!1)}}ZAg(Aa,Fb){if(this.V0k)if(this.$mc)Fb(Aa,!0);else if(Aa===OSF.StoreTypeEnum.MarketPlace&&this.VGc)Fb(Aa,!0);else{const Ta=da.f1c(Aa),Eb=this.iZe.P1i(Aa);if(void 0===Eb)if(Ta){const oc=window.performance.now();this.Cf.queryStoreDisabled(Ta,Lc=>{this.iZe.$Mk(Aa,Lc);h.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",Aa,Lc,oc,window.performance.now()-oc);Fb(Aa,void 0!==
Lc?Lc:!0)})}else Fb(Aa,!1);else Fb(Aa,Eb)}else this.queryStoreDisabled(Aa,Fb)}C5d(Aa,Fb,Ta){return Aa?Ta?2===Fb?da.KYb(Ta,Aa):da.KYb(Aa,Ta):Aa:Ta}vle(){if(!this.hhd){const Aa=JSON.parse(this.Oqb);this.Gxc(Aa);this.hhd=Aa}return da.moc(0,this.hhd)}Gxc(Aa){da.yGb(Aa);this.Rmc(Aa);this.uHd(Aa)}Rmc(Aa){const Fb=this.ctd();for(var Ta=0;Ta<Aa.length&&0<Fb.count;Ta++){const Eb=Aa[Ta];if(Fb.Bb(Eb.solutionId)){let oc=String.format("Found an override, solutionId: {0}",Eb.solutionId);const Lc=Fb.pa(Eb.solutionId);
Lc&&(isNaN(Lc.addinInfo.priority)||(oc=String.format("{0}; AddinInfo.Priority: update {1} to {2}",oc,Eb.addinInfo.priority,Lc.addinInfo.priority),Eb.addinInfo.priority=Lc.addinInfo.priority),isNaN(Lc.addinInfo.AUP)||(oc=String.format("{0}; AddinInfo.AUP: update {1} to {2}",oc,Eb.addinInfo.AUP,Lc.addinInfo.AUP),Eb.addinInfo.AUP=Lc.addinInfo.AUP),Lc.displayName&&(oc=String.format("{0}; DisplayName: update {1} to {2}",oc,Eb.displayName,Lc.displayName),Eb.displayName=Lc.displayName),Lc.iconUrl&&(oc=String.format("{0}; IconUrl: update {1} to {2}",
oc,Eb.iconUrl,Lc.iconUrl),Eb.iconUrl=Lc.iconUrl),Lc.description&&(oc=String.format("{0}; Description: update {1} to {2}",oc,Eb.description,Lc.description),Eb.description=Lc.description));Fb.remove(Eb.solutionId);this.sca&&h.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",oc)}}for(const Eb of Fb.keys)Ta=Fb.pa(Eb),Ta.displayName&&Ta.iconUrl&&Ta.addinInfo&&(Aa.push(Ta),this.sca&&h.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",
JSON.stringify(Ta)))}ctd(){const Aa=new C.a(X.a.Ef());let Fb=this.ya.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!Fb)return Aa;Fb=Fb.trim();if(12>=Fb.length)return 0<Fb.length&&h.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",Fb),Aa;this.sca&&h.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",Fb);try{const Ta=[],Eb=Fb.split("|");for(let oc=Eb.length-1;0<=oc;oc--){const Lc=
Eb[oc],Jd=Lc.split("\\");if(2>Jd.length){Ta.push(Lc);continue}const Ab=da.Sbe(Jd);Ab?Aa.Bb(Ab.solutionId)||Aa.add(Ab.solutionId,Ab):Ta.push(Lc)}this.sca&&0<Ta.length&&h.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",Ta.join("|"));this.sca&&0<Aa.count&&h.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",Aa.count,JSON.stringify(wa.toArray(Aa.values)));return Aa}catch(Ta){h.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",
Fb,Ta.toString())}return Aa}uHd(Aa){for(let Fb=0;Fb<Aa.length;Fb++)Pa.c(Aa[Fb].iconUrl.toLowerCase(),"http",0)||this.a3&&Pa.c(Aa[Fb].iconUrl.toLowerCase(),"data:image/png;base64",0)||(Aa[Fb].iconUrl=String.format("{0}/image/apps.{1}",this.Rbd,Aa[Fb].iconUrl))}static S_a(Aa){return 0===Aa||10===Aa}static gtd(Aa,Fb){const Ta={};Ta.collectionType=Oa.a[Aa];Ta.queryResult="null";Ta.queryStart=Fb;Ta.queryDuration=window.performance.now()-Fb;return Object.assign(new Za(Aa,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",
Ta)})}static iTa(Aa,Fb,Ta){const Eb={};Eb.collectionType=Oa.a[Aa];Aa=new Za(Aa,Fb);0!==Fb&&(Aa.failure=Error.create(Ta,Eb));return Aa}static xDa(Aa){return da.iTa(Aa,2,"The store is disabled.")}static Rsd(Aa){const Fb={};Fb.collectionType=Oa.a[Aa];Fb.invokeResultCode=-2147208619;Fb.queryDuration=0;return Object.assign(new Za(Aa,3),{failure:Error.create("Anonymous users do not have installed add-ins.",Fb)})}static UPb(Aa){return Aa.failure?Aa.failure.invokeResultCode:-1E3}h3d(Aa,Fb,Ta){const Eb={};
Eb.AddinCollectionType=Oa.a[Aa];Eb.ErrorCode=Fb.errorCode;Eb.AddinCount=Fb.value?Fb.value.length:0;Aa=window.performance.now();Fb=Date.now()-z.AFrameworkApplication.PM;h.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; window: {1} ms; framework: {2} ms; fields: {3}",Ta,Aa,Fb,JSON.stringify(Eb))}g3d(Aa,Fb,Ta){this.i3d?(Ta={["AddinCollectionType"]:Oa.a[Aa],["ErrorCode"]:Fb.errorCode,["QueryDuration"]:Ta,["FlyoutDataReadySinceBoot"]:Date.now()-z.AFrameworkApplication.PM},
this.EWd(Aa)&&h.ULS.sendTraceTag(508069333,220,50,"{0}",JSON.stringify(Ta)),Ta.AddinCount=Fb.value?Fb.value.length:0,h.ULS.sendTraceTag(512231322,220,50,"logQueryCompletedResult: {0}",JSON.stringify(Ta))):this.h3d(Aa,Fb,Ta)}EWd(Aa){0===Aa?this.p_|=1:1===Aa&&(this.p_|=2);Aa=this.p_&131;if(Aa=1===Aa||2===Aa)this.p_=255;return Aa}static moc(Aa,Fb){const Ta={};Ta.errorCode=Aa;Ta.value=Fb;return Ta}static f1c(Aa){return Aa===OSF.StoreTypeEnum.MarketPlace?"omex":Aa===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":
null}static KYb(Aa,Fb){Fb.solutionId=Fb.solutionId||Aa.solutionId;Fb.version=Fb.version||Aa.version;Fb.storeType=Fb.storeType||Aa.storeType;Fb.storeId=Fb.storeId||Aa.storeId;Fb.assetId=Fb.assetId||Aa.assetId;Fb.assetStoreId=Fb.assetStoreId||Aa.assetStoreId;Fb.displayName=Fb.displayName||Aa.displayName;Fb.provider=Fb.provider||Aa.provider;Fb.description=Fb.description||Aa.description;Fb.iconUrl=Fb.iconUrl||Aa.iconUrl;Fb.webApplicationId=Fb.webApplicationId||Aa.webApplicationId;Fb.highResolutionIconUrl=
Fb.highResolutionIconUrl||Aa.highResolutionIconUrl;Fb.licenseUrl=Fb.licenseUrl||Aa.licenseUrl;Fb.privacyUrl=Fb.privacyUrl||Aa.privacyUrl;Fb.addinInfo=Fb.addinInfo||Aa.addinInfo;isNaN(Fb.targetType)&&(Fb.targetType=Aa.targetType);isNaN(Fb.height)&&(Fb.height=Aa.height);isNaN(Fb.width)&&(Fb.width=Aa.width);return Fb}static yGb(Aa){for(const Fb of Aa)Fb.addinInfo||(Fb.addinInfo=new Ha),isNaN(Fb.targetType)&&(Fb.targetType=1),Fb.assetId=Fb.assetId||Fb.solutionId,Fb.storeId=Fb.storeId||"en-US",Fb.storeType=
Fb.storeType||"omex",Fb.assetStoreId=Fb.assetStoreId||"omex",isNaN(Fb.width)&&(Fb.width=0),isNaN(Fb.height)&&(Fb.height=0)}static Sbe(Aa){const Fb={};let Ta=0;Ta<Aa.length&&0<Aa[Ta].trim().length&&Aa[Ta].trim().toLowerCase().startsWith("wa")&&(Fb.solutionId=Aa[Ta].trim(),Fb.addinInfo=Object.assign(new Ha,{priority:Number.NaN,AUP:Number.NaN}),++Ta<Aa.length&&0<Aa[Ta].trim().length&&(Fb.addinInfo.priority=parseInt(Aa[Ta].trim())),++Ta<Aa.length&&0<Aa[Ta].trim().length&&(Fb.addinInfo.AUP=parseInt(Aa[Ta].trim())),
++Ta<Aa.length&&0<Aa[Ta].trim().length&&(Fb.displayName=Aa[Ta].trim()),++Ta<Aa.length&&0<Aa[Ta].trim().length&&(Fb.iconUrl=Aa[Ta].trim()),++Ta<Aa.length&&0<Aa[Ta].trim().length&&(Fb.description=Aa[Ta].trim()));return Fb.solutionId?Fb:null}static cMd(Aa,Fb){Aa=Aa.Qa("AddinImageStoreServiceUrl");if(!Aa)return Fb;Aa=Aa.toLowerCase();return Aa.startsWith("http://")||Aa.startsWith("https://")?Aa:Fb}}Object(c.a)(da,"AddinDetailsManager1",null,[138,139]);class sa{constructor(Aa,Fb){this.description=this.provider=
this.displayName=this.assetStoreId=this.assetId=this.storeId=this.storeType=this.version=this.solutionId=this.addinInfo=null;this.width=this.height=this.targetType=0;this.privacyUrl=this.licenseUrl=this.highResolutionIconUrl=this.webApplicationId=this.iconUrl=null;this.solutionId=Aa.solutionId;this.version=Aa.version;this.storeType=Aa.storeType;this.storeId=Aa.storeId;this.assetId=Aa.assetId;this.assetStoreId=Aa.assetStoreId;this.displayName=Aa.displayName;this.provider=Aa.provider;this.description=
Aa.description;this.targetType=Aa.targetType;this.height=Aa.height;this.width=Aa.width;this.iconUrl=Aa.iconUrl;this.webApplicationId=Aa.webApplicationId;this.highResolutionIconUrl=Aa.highResolutionIconUrl;this.licenseUrl=Aa.licenseUrl;this.privacyUrl=Aa.privacyUrl;this.addinInfo=void 0===Fb?null:Fb}p9b(){const Aa={};Aa.solutionId=this.solutionId;Aa.version=this.version;Aa.storeType=this.storeType;Aa.storeId=this.storeId;Aa.assetId=this.assetId;Aa.assetStoreId=this.assetStoreId;Aa.targetType=this.targetType;
Aa.displayName=this.displayName;Aa.width=this.width;Aa.height=this.height;return Aa}}Object(c.a)(sa,"AddinDetail",null,[]);class mb{constructor(Aa,Fb,Ta,Eb,oc){this.Nic=null;this.ya=Aa;this.xl=Fb;this.IQa=Ta;this.wsh=Eb;this.kzb=oc}sB(Aa,Fb){this.Cf.queryAppDetails(this.wsh,this.kzb,this.solutionIds,Aa,(Ta,Eb)=>{let oc=null;if(Eb){oc=Array(Eb.length);for(let Lc=0;Lc<Eb.length;Lc++)oc[Lc]=new sa(Eb[Lc],this.ZHj(Eb[Lc].solutionId))}Fb(Ta,oc||[])})}get jrj(){return!!this.Cf.queryAppDetails}ZHj(Aa){return this.IQa.pa(Aa)}get solutionIds(){if(!this.Nic){this.Nic=
new S.a;for(const Aa of this.IQa.keys)this.Nic.add(Pa.d(Aa))}return this.Nic.toArray()}get Cf(){return this.xl.value}}Object(c.a)(mb,"AddinDetailsLoader",null,[]);class Ma{constructor(Aa,Fb){this.failure=null;this.G6=Aa;this.errorCode=void 0===Fb?0:Fb}}Object(c.a)(Ma,"AddinQueryResult",null,[]);class hb extends Ma{constructor(Aa,Fb){super(Aa,void 0===Fb?0:Fb);this.sve=this.solutionIds=null}}Object(c.a)(hb,"AddinCollection",Ma,[]);var $a=a(930);class Va extends $a.a{constructor(){super(X.a.Ef())}}
Object(c.a)(Va,"AddinDetailTable",$a.a,[]);var xa;(function(Aa){Aa[Aa.stop=-1]="stop";Aa[Aa.skip=0]="skip";Aa[Aa.query=1]="query"})(xa||(xa={}));Object(c.b)("QueryStrategy",xa);class ia{constructor(Aa,Fb,Ta){Ta=void 0===Ta?null:Ta;this.xb=new m.a;this.St=new C.a(X.a.Ef());this.As=new ea.a;this.p_=0;this.GS=new ea.a;this.IQa=this.W7c=null;this.Epb=(Eb,oc,Lc)=>{Lc?(this.g3d(Eb,Lc,window.performance.now()-oc),0===Lc.errorCode?(oc=Lc.value?ia.eJh(Lc.value):[],this.mB(new Ma(Eb),oc)):-1===Lc.errorCode||
10===Lc.errorCode?this.mB(new Ma(Eb),[]):(Eb=this.ftd(Eb,oc,Lc),this.mB(Eb))):(Eb=ia.gtd(Eb,oc),this.mB(Eb))};this.J1a=(Eb,oc)=>{if(0!==oc.errorCode&&5!==oc.errorCode)this.K6g(oc.rF,Object.assign(new hb(oc.rF,oc.errorCode),{failure:oc.failure}));else{Eb=Object.assign(new hb(oc.rF,oc.errorCode),{solutionIds:new S.a,sve:new S.a});var Lc=oc.Ym;for(const Ab of Lc){Lc=Ab.solutionId;const Uc=Ab.storeId;if(this.St.Bb(Lc)){var Jd=this.St.pa(Lc);Jd.Bb(Uc)?Jd.ga(Uc,this.C5d(Jd.pa(Uc),oc.rF,Ab)):Jd.add(Uc,Ab)}else Jd=
new Va,Jd.add(Uc,Ab),this.St.add(Lc,Jd);Eb.solutionIds.add(Lc);Eb.sve.add(Uc)}this.K6g(oc.rF,Eb)}};this.Fpa=new za.a;this.Fpa.add(OSF.StoreTypeEnum.MarketPlace,0);this.Fpa.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.ya=Aa;this.xl=Fb;this.hz=Ta;this.Rbd=ia.cMd(Aa,"https://store-images.s-microsoft.com");this.ihd=null;this.tFb(this.J1a)}get Mge(){return this.hz&&!0===this.hz.RefreshMyAddinsErrorCodeFixEnabled}get ooc(){this.W7c||(this.W7c=this.iGf());return this.W7c}iGf(){const Aa=JSON.parse(this.Oqb);
this.Gxc(Aa);return Aa.map(Fb=>new sa(Fb,Fb.addinInfo))}get eI(){return!!this.ya&&this.ya.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}get i3d(){return!!this.ya&&this.ya.isChangeGateEnabled("OfficeVSO:8366459_LogQueryCompletedV2Enabled")}get isAnonymousUser(){return!!this.ya&&this.ya.ka("IsAnonymousUser")}get NHd(){return!!this.ya&&this.ya.isChangeGateEnabled("OfficeVSO:8335746_FlyoutUserNoMailboxFixEnabled")}get Ahb(){return!!this.ya&&this.ya.isChangeGateEnabled("OfficeVSO:8335748_FlyoutUserNotSignedInFixEnabled")}get sca(){return this.ya.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",
!1)}get Cf(){return this.xl.value}get Nce(){this.ihd||(this.ihd=new mb(this.ya,this.xl,this.cck,0,this.Cf.getAppUILocale()));return this.ihd}oQ(Aa){if(this.eI&&!this.Cua(Aa))return new oa(0);if(this.Mge){var Fb=this.KOb(Aa);0===Fb.errorCode&&0===Aa&&(Fb=this.KOb(2));if(0!==Fb.errorCode)return Fb}else{if(!this.Bua(Aa))return Aa=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:Oa.a[Aa]}),Object.assign(new oa(1),{failure:Aa});Fb=this.As.pa(Aa);if(Fb.failure)return Object.assign(new oa(Fb.errorCode),
{failure:Fb.failure})}Fb=this.As.pa(Aa);h.ULS.shipAssertTag(509870082,220,!!Fb.solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Aa);const Ta=new oa(Fb.errorCode);for(let Eb=0;Eb<Fb.solutionIds.count;Eb++){const oc=Fb.solutionIds.pa(Eb),Lc=Fb.sve.pa(Eb);if(this.St.Bb(oc)){const Jd=this.St.pa(oc);Jd.Bb(Lc)?Array.add(Ta.Ym,Jd.pa(Lc)):h.ULS.sendTraceTag(508610437,220,15,"The addin with solutionId '{0}' in '{1}' must contain storeId '{2}' when the collection is ready.",
oc,Aa,Lc)}else h.ULS.sendTraceTag(508610436,220,15,"The addin with solutionId '{0}' in '{1}' must exist when the collection is ready.",oc,Aa)}return Ta}KOb(Aa){return this.Bua(Aa)?this.As.pa(Aa).failure?Object.assign(new oa(this.As.pa(Aa).errorCode),{failure:this.As.pa(Aa).failure}):new oa(0):(Aa=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:Oa.a[Aa]}),Object.assign(new oa(1),{failure:Aa}))}getUpgradedAddinsOfOmex(){return this.Cf.getUpgradedAddinsOfOmex()}getDataLocale(){return this.Cf.getDataLocale()}nQ(Aa,
Fb){Fb=void 0===Fb?null:Fb;if(Aa=this.TIi(Aa))if(Fb||(Fb=this.uiCulture),Aa.Bb(Fb))return Aa.pa(Fb);return null}TIi(Aa){return this.St.Bb(Aa)?this.St.pa(Aa):null}sxa(Aa){if(Aa){this.tFb(Aa);for(const Fb of this.As.keys){if(this.eI&&!this.Cua(Fb))continue;if(!this.Bua(Fb)||this.As.pa(Fb).failure)continue;h.ULS.shipAssertTag(509870081,220,!!this.As.pa(Fb).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Fb);const Ta=[],Eb=this.As.pa(Fb);for(const oc of Eb.solutionIds)Array.add(Ta,
this.St.pa(oc));Aa(null,new aa(Fb,Eb.errorCode,Ta,Eb.failure))}}}get name(){return"AddinDetailsManager2"}Rrb(Aa,Fb){if(this.eI&&ia.S_a(Aa)){var Ta=oc=>{this.mB(ia.iTa(oc,4,"The connected service is disabled."));this.w9(oc,-1)},Eb=oc=>{this.mB(ia.iTa(oc,0,"The user doesn't have any addin installed."),[]);this.w9(oc,0)};0===Aa?(this.JSb(0,Fb,Ta,Eb),this.JSb(2,Fb,Ta,()=>{this.s3a(this.Epb,this.ooc)})):10===Aa&&this.w9(1,1)}}sB(Aa,Fb){ia.S_a(Aa)?this.$ee(Aa,this.Epb,void 0===Fb?!1:Fb):h.ULS.sendTraceTag(509870080,
220,50,"QueryAddinDetails: skipping providerType: {0}.",Ia.a[Aa])}tFb(Aa){this.xb.addHandler(Na.a.Vlc,Aa)}JSb(Aa,Fb,Ta,Eb){this.Cua(Aa)||(3===Fb&&Ta?Ta(Aa):2===Fb&&Eb?Eb(Aa):this.w9(Aa,1))}Cua(Aa){return this.GS.Bb(Aa)}w9(Aa,Fb){if(this.eI){var Ta=this.Cua(Aa);if(!Ta||-1!==this.GS.pa(Aa)&&this.GS.pa(Aa)!==Fb)h.ULS.sendTraceTag(508610435,220,50,"RegisterCollectionType: collectionType: {0}, strategy: {1} -> {2}.",Oa.a[Aa],Ta?xa[this.GS.pa(Aa)]:"undefined",xa[Fb]),this.GS.ga(Aa,Fb)}}ftd(Aa,Fb,Ta){const Eb=
{};Eb.collectionType=Oa.a[Aa];Eb.invokeResultCode=Ta.errorCode;Eb["queryResult.Value"]=Ta.value?String.format("Length: {0}",Ta.value.length):"null";Eb.queryStart=Fb;Eb.queryDuration=window.performance.now()-Fb;return Object.assign(new Ma(Aa,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",Eb)})}aSk(Aa){if(Aa!==OSF.StoreTypeEnum.MarketPlace)return!1;if(this.Cub(2)){if(!this.Bua(2))return!0;if(this.ya.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins"))return 3===
this.As.pa(2).errorCode}return!1}Cub(Aa){return this.eI&&this.GS.Bb(Aa)?1===this.GS.pa(Aa):!0}$ee(Aa,Fb,Ta){Ta=void 0===Ta?!1:Ta;h.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",Aa);if(Aa!==OSF.StoreTypeEnum.MarketPlace&&Aa!==OSF.StoreTypeEnum.PrivateCatalog)h.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",Aa);else{var Eb=this.Fpa.pa(Aa);this.aSk(Aa)&&this.s3a(Fb,this.Jdk);this.Cub(Eb)&&(this.Ahb&&this.isAnonymousUser?(Aa=ia.Rsd(Eb),this.mB(Aa)):this.afe(Aa,
Fb,Ta))}}get Jdk(){return this.As.Bb(2)?null:this.ooc}afe(Aa,Fb,Ta){this.queryStoreDisabled(Aa,(Eb,oc)=>{if(Eb===OSF.StoreTypeEnum.MarketPlace&&oc)oc=ia.xDa(0),this.mB(oc);else if(Eb===OSF.StoreTypeEnum.PrivateCatalog&&oc)oc=ia.xDa(1),this.mB(oc);else{var Lc=window.performance.now();this.Cf.getEntitlementDetails(Object.assign(new Sa,{storeType:Eb,refresh:Ta}),Jd=>{Fb(this.Fpa.pa(Eb),Lc,Jd)})}})}s3a(Aa,Fb){Aa=void 0===Aa?null:Aa;Fb=void 0===Fb?null:Fb;null===Aa&&(Aa=this.Epb);this.queryStoreDisabled(0,
(Ta,Eb)=>{Eb?(Ta=ia.xDa(2),this.mB(Ta)):null!=Fb?this.mB(new Ma(2,5),Fb):this.whk(Aa)})}mB(Aa,Fb){Fb=void 0===Fb?null:Fb;0!==Aa.errorCode&&5!==Aa.errorCode?(h.ULS.shipAssertTag(509116673,220,!Fb,"The parameter addinDetails must be null for any failed queries"),h.ULS.shipAssertTag(509116672,220,!!Aa.failure,"The result.Failure must not be available for any failed queries"),this.Pre(Aa)?h.ULS.sendTraceTag(510253056,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}",
"",Oa.a[Aa.G6],ba.a[Aa.errorCode],Aa.failure?Aa.failure.toString():"null",JSON.stringify(Aa.failure)):h.ULS.sendTraceTag(508610434,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","(downgraded error)",Oa.a[Aa.G6],ba.a[Aa.errorCode],Aa.failure?Aa.failure.toString():"null",JSON.stringify(Aa.failure))):(h.ULS.shipAssertTag(509116643,220,!!Fb,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is null.",
Oa.a[Aa.G6]),h.ULS.sendTraceTag(509116642,220,50,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails, errorCode: {2}",Oa.a[Aa.G6],Fb?Fb.length:-1,ba.a[Aa.errorCode]));Aa=new aa(Aa.G6,Aa.errorCode,Fb,Aa.failure);this.xb.raiseEvent(Na.a.Vlc,Aa)}Pre(Aa){return 3===Aa.errorCode&&(this.Ahb&&-2147208619===ia.UPb(Aa)||this.NHd&&-2===ia.UPb(Aa))||4===Aa.errorCode?!1:2!==Aa.errorCode}K6g(Aa,Fb){this.As.ga(Aa,Fb);this.w9(Aa,1)}Bua(Aa){return this.As.Bb(Aa)?!!this.St:!1}get uiCulture(){return this.hz&&
this.hz.UICulture?this.hz.UICulture:z.AFrameworkApplication.uiCulture}get $mc(){return this.hz?!this.hz.AreThirdPartyAddInsAllowed||this.hz.AppsForOfficeThirdPartyIsDisabled:!this.ya.ka("AreThirdPartyAddInsAllowed")||this.ya.ka("AppsForOfficeThirdPartyIsDisabled")}get VGc(){return this.hz?!this.hz.AppsForOfficeAllowExternalMarketplace:!this.ya.ka("AppsForOfficeAllowExternalMarketplace")}get cck(){if(!this.IQa){this.IQa=new C.a(X.a.Ef());const Aa=JSON.parse(this.Oqb);for(const Fb of Aa)this.IQa.add(Fb.solutionId,
Fb.addinInfo)}return this.IQa}get Oqb(){return this.hz?this.hz.PopularAddinDetailsJsonString:this.ya.Qa("PopularAddinDetailsJsonString")}queryStoreDisabled(Aa,Fb){if(this.$mc)Fb(Aa,!0);else if(Aa===OSF.StoreTypeEnum.MarketPlace&&this.VGc)Fb(Aa,!0);else{const Ta=ia.f1c(Aa);if(Ta){const Eb=window.performance.now();this.Cf.queryStoreDisabled(Ta,oc=>{h.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",Aa,oc,Eb,window.performance.now()-
Eb);Fb(Aa,oc)})}else Fb(Aa,!1)}}C5d(Aa,Fb,Ta){return Aa?Ta?2===Fb?ia.KYb(Ta,Aa):ia.KYb(Aa,Ta):Aa:Ta}whk(Aa){const Fb=(Eb,oc,Lc)=>{Aa(2,Lc,ia.moc(Eb,oc))},Ta=window.performance.now();this.Nce&&this.Nce.jrj?this.Nce.sB(!1,(Eb,oc)=>{this.Rmc(oc);Aa(2,Ta,ia.moc(Eb,oc))}):Fb(0,this.iGf(),Ta)}Gxc(Aa){ia.yGb(Aa);this.Rmc(Aa);this.uHd(Aa)}Rmc(Aa){const Fb=this.ctd();for(var Ta=0;Ta<Aa.length&&0<Fb.count;Ta++){const Eb=Aa[Ta];if(Fb.Bb(Eb.solutionId)){let oc=String.format("Found an override, solutionId: {0}",
Eb.solutionId);const Lc=Fb.pa(Eb.solutionId);Lc&&(isNaN(Lc.addinInfo.priority)||(oc=String.format("{0}; AddinInfo.Priority: update {1} to {2}",oc,Eb.addinInfo.priority,Lc.addinInfo.priority),Eb.addinInfo.priority=Lc.addinInfo.priority),isNaN(Lc.addinInfo.AUP)||(oc=String.format("{0}; AddinInfo.AUP: update {1} to {2}",oc,Eb.addinInfo.AUP,Lc.addinInfo.AUP),Eb.addinInfo.AUP=Lc.addinInfo.AUP),Lc.displayName&&(oc=String.format("{0}; DisplayName: update {1} to {2}",oc,Eb.displayName,Lc.displayName),Eb.displayName=
Lc.displayName),Lc.iconUrl&&(oc=String.format("{0}; IconUrl: update {1} to {2}",oc,Eb.iconUrl,Lc.iconUrl),Eb.iconUrl=Lc.iconUrl),Lc.description&&(oc=String.format("{0}; Description: update {1} to {2}",oc,Eb.description,Lc.description),Eb.description=Lc.description));Fb.remove(Eb.solutionId);this.sca&&h.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",oc)}}for(const Eb of Fb.keys)Ta=Fb.pa(Eb),Ta.displayName&&Ta.iconUrl&&Ta.addinInfo&&(Aa.push(Ta),this.sca&&h.ULS.sendTraceTag(509379107,
220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(Ta)))}ctd(){const Aa=new C.a(X.a.Ef());let Fb=this.ya.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!Fb)return Aa;Fb=Fb.trim();if(12>=Fb.length)return 0<Fb.length&&h.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",Fb),Aa;this.sca&&h.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",
Fb);try{const Ta=[],Eb=Fb.split("|");for(let oc=Eb.length-1;0<=oc;oc--){const Lc=Eb[oc],Jd=Lc.split("\\");if(2>Jd.length){Ta.push(Lc);continue}const Ab=ia.Sbe(Jd);Ab?Aa.Bb(Ab.solutionId)||Aa.add(Ab.solutionId,Ab):Ta.push(Lc)}this.sca&&0<Ta.length&&h.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",Ta.join("|"));this.sca&&0<Aa.count&&h.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",Aa.count,JSON.stringify(wa.toArray(Aa.values)));
return Aa}catch(Ta){h.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",Fb,Ta.toString())}return Aa}uHd(Aa){for(let Fb=0;Fb<Aa.length;Fb++)Pa.c(Aa[Fb].iconUrl.toLowerCase(),"http",0)||(Aa[Fb].iconUrl=String.format("{0}/image/apps.{1}",this.Rbd,Aa[Fb].iconUrl))}static S_a(Aa){return 0===Aa||10===Aa}static gtd(Aa,Fb){const Ta={};Ta.collectionType=Oa.a[Aa];Ta.queryResult="null";Ta.queryStart=Fb;Ta.queryDuration=window.performance.now()-
Fb;return Object.assign(new Ma(Aa,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",Ta)})}static iTa(Aa,Fb,Ta){const Eb={};Eb.collectionType=Oa.a[Aa];Aa=new Ma(Aa,Fb);0!==Fb&&(Aa.failure=Error.create(Ta,Eb));return Aa}static xDa(Aa){return ia.iTa(Aa,2,"The store is disabled.")}static Rsd(Aa){const Fb={};Fb.collectionType=Oa.a[Aa];Fb.invokeResultCode=-2147208619;Fb.queryDuration=0;return Object.assign(new Ma(Aa,3),{failure:Error.create("Anonymous users do not have installed add-ins.",
Fb)})}static UPb(Aa){return Aa.failure?Aa.failure.invokeResultCode:-1E3}h3d(Aa,Fb,Ta){const Eb={};Eb.AddinCollectionType=Oa.a[Aa];Eb.ErrorCode=Fb.errorCode;Eb.AddinCount=Fb.value?Fb.value.length:0;Aa=window.performance.now();Fb=Date.now()-z.AFrameworkApplication.PM;h.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; window: {1} ms; framework: {2} ms; fields: {3}",Ta,Aa,Fb,JSON.stringify(Eb))}g3d(Aa,Fb,Ta){this.i3d?(Ta={["AddinCollectionType"]:Oa.a[Aa],
["ErrorCode"]:Fb.errorCode,["QueryDuration"]:Ta,["FlyoutDataReadySinceBoot"]:Date.now()-z.AFrameworkApplication.PM},this.EWd(Aa)&&h.ULS.sendTraceTag(508069333,220,50,"{0}",JSON.stringify(Ta)),Ta.AddinCount=Fb.value?Fb.value.length:0,h.ULS.sendTraceTag(512231322,220,50,"logQueryCompletedResult: {0}",JSON.stringify(Ta))):this.h3d(Aa,Fb,Ta)}EWd(Aa){0===Aa?this.p_|=1:1===Aa&&(this.p_|=2);Aa=this.p_&131;if(Aa=1===Aa||2===Aa)this.p_=255;return Aa}static moc(Aa,Fb){const Ta={};Ta.errorCode=Aa;Ta.value=Fb;
return Ta}static f1c(Aa){return Aa===OSF.StoreTypeEnum.MarketPlace?"omex":Aa===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static KYb(Aa,Fb){Fb.solutionId=Fb.solutionId||Aa.solutionId;Fb.version=Fb.version||Aa.version;Fb.storeType=Fb.storeType||Aa.storeType;Fb.storeId=Fb.storeId||Aa.storeId;Fb.assetId=Fb.assetId||Aa.assetId;Fb.assetStoreId=Fb.assetStoreId||Aa.assetStoreId;Fb.displayName=Fb.displayName||Aa.displayName;Fb.provider=Fb.provider||Aa.provider;Fb.description=Fb.description||Aa.description;
Fb.iconUrl=Fb.iconUrl||Aa.iconUrl;Fb.webApplicationId=Fb.webApplicationId||Aa.webApplicationId;Fb.highResolutionIconUrl=Fb.highResolutionIconUrl||Aa.highResolutionIconUrl;Fb.licenseUrl=Fb.licenseUrl||Aa.licenseUrl;Fb.privacyUrl=Fb.privacyUrl||Aa.privacyUrl;Fb.addinInfo=Fb.addinInfo||Aa.addinInfo;isNaN(Fb.targetType)&&(Fb.targetType=Aa.targetType);isNaN(Fb.height)&&(Fb.height=Aa.height);isNaN(Fb.width)&&(Fb.width=Aa.width);return Fb}static eJh(Aa){const Fb=Array(Aa.length);for(let Ta=0;Ta<Fb.length;Ta++)Fb[Ta]=
new sa(Aa[Ta],Aa[Ta].addinInfo);return Fb}static yGb(Aa){for(const Fb of Aa)isNaN(Fb.targetType)&&(Fb.targetType=1),Fb.assetId=Fb.assetId||Fb.solutionId,Fb.storeId=Fb.storeId||"en-US",Fb.storeType=Fb.storeType||"omex",Fb.assetStoreId=Fb.assetStoreId||"omex",isNaN(Fb.width)&&(Fb.width=0),isNaN(Fb.height)&&(Fb.height=0)}static Sbe(Aa){const Fb={};let Ta=0;Ta<Aa.length&&0<Aa[Ta].trim().length&&Aa[Ta].trim().toLowerCase().startsWith("wa")&&(Fb.solutionId=Aa[Ta].trim(),Fb.addinInfo=Object.assign(new Ha,
{priority:Number.NaN,AUP:Number.NaN}),++Ta<Aa.length&&0<Aa[Ta].trim().length&&(Fb.addinInfo.priority=parseInt(Aa[Ta].trim())),++Ta<Aa.length&&0<Aa[Ta].trim().length&&(Fb.addinInfo.AUP=parseInt(Aa[Ta].trim())),++Ta<Aa.length&&0<Aa[Ta].trim().length&&(Fb.displayName=Aa[Ta].trim()),++Ta<Aa.length&&0<Aa[Ta].trim().length&&(Fb.iconUrl=Aa[Ta].trim()),++Ta<Aa.length&&0<Aa[Ta].trim().length&&(Fb.description=Aa[Ta].trim()));return Fb.solutionId?Fb:null}static cMd(Aa,Fb){Aa=Aa.Qa("AddinImageStoreServiceUrl");
if(!Aa)return Fb;Aa=Aa.toLowerCase();return Aa.startsWith("http://")||Aa.startsWith("https://")?Aa:Fb}}Object(c.a)(ia,"AddinDetailsManager2",null,[137]);class Z{constructor(Aa,Fb){this.Pqb="popular";this.q5e="addinDetails";this.rbf="cache-lastUpdate";this.Laf="builtin-lastUpdate";this.Dxg=144E5;this.ya=this.eM=null;this.MSj=(Ta,Eb)=>{2===Eb.rF&&0===Eb.errorCode&&(this.ztd=Eb.Ym,this.Eoc=this.now,h.ULS.sendTraceTag(508352221,220,50,"AddinDetailsCacheManager.onAddinDetailsUpdated: cached popular addins were refreshed."))};
this.eM=Fb;this.ya=Aa;this.eM.sxa(this.MSj);this.Dxg=this.ya.getIntFeatureGate("Microsoft.Office.SharedOnline.PopularCacheExpirationTime",144E5)}get Cuj(){return this.Eoc?this.now.getTime()-this.Eoc.getTime()>=this.Dxg:!0}oQ(Aa){var Fb=this.eM.oQ(Aa);2===Aa&&this.Buj(Fb.errorCode)&&(Aa=this.ztd,null!=Aa?(this.Cuj&&this.eM.s3a(null,null),Fb=this.toDateString(this.now),Fb=this.toDateString(this.itd)===Fb?this.Psd(5,this.eM.ooc):this.Psd(0,Aa)):(Z.N7&&(Fb=this.Psd(5,this.eM.ooc)),this.itd=this.now,this.eM.s3a(null,
null)));return Fb}Psd(Aa,Fb){var Ta=void 0===Ta?null:Ta;return Object.assign(new oa(Aa),{Ym:Fb,failure:Ta})}toDateString(Aa){return Aa.toISOString().substring(2,16)}get itd(){const Aa=Z.o7a(this.Pqb,this.Laf);return null!==Aa?new Date(Aa):new Date(0)}set itd(Aa){Z.vNa(this.Pqb,Aa.toISOString(),this.Laf)}get Eoc(){const Aa=Z.o7a(this.Pqb,this.rbf);return null!==Aa?new Date(Aa):new Date(0)}set Eoc(Aa){Z.vNa(this.Pqb,Aa.toISOString(),this.rbf)}get ztd(){const Aa=Z.o7a(this.Pqb,this.q5e);let Fb=null;
Aa&&(Fb=JSON.parse(Aa));return Fb}set ztd(Aa){Aa=JSON.stringify(Aa);Z.vNa(this.Pqb,Aa,this.q5e)}get now(){return new Date}Buj(Aa){return 2!==Aa&&4!==Aa}nQ(Aa,Fb){return this.eM.nQ(Aa,void 0===Fb?null:Fb)}getUpgradedAddinsOfOmex(){return this.eM.getUpgradedAddinsOfOmex()}getDataLocale(){return this.eM.getDataLocale()}sxa(Aa){this.eM.sxa(Aa)}get name(){return"AddinDetailsCacheManager"}Rrb(Aa,Fb){this.eM.Rrb(Aa,Fb)}sB(Aa,Fb){this.eM.sB(Aa,void 0===Fb?!1:Fb)}static o7a(Aa,Fb){let Ta=null;try{const Eb=
Z.g9b;if(void 0!==Eb&&Eb){const oc=Na.a.gib(Aa)+"_"+Fb;Ta=Eb.getItem(oc)}else h.ULS.sendTraceTag(508352219,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(Eb){h.ULS.sendTraceTag(508352218,220,10,"Failed to get AddinCommands Cache {0} for suffix {1}.",Aa,Fb)}return Ta}static vNa(Aa,Fb,Ta){try{const Eb=Z.g9b;if(void 0!==Eb&&Eb){const oc=Na.a.gib(Aa)+"_"+Ta;Eb.setItem(oc,Fb)}else h.ULS.sendTraceTag(508352217,220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(Eb){h.ULS.sendTraceTag(508352216,
220,10,"Failed to set AddinCommands Cache {0} for suffix {1}.",Aa,Ta)}}static get g9b(){if(!Z.N7)return null;let Aa=null;try{Aa=localStorage}catch(Fb){Z.N7=!1,Aa=null,h.ULS.sendTraceTag(508352215,220,10,`Failed to use localStorage: error name: ${Fb.name}; message: ${Fb.message}; stack: ${Fb.stack}`)}return Aa}}Z.N7=!0;Object(c.a)(Z,"AddinDetailsCacheManager",null,[138]);class ta{static createInstance(Aa,Fb,Ta){Ta=void 0===Ta?null:Ta;Aa=ta.TGh(Aa)?new Z(Aa,new ia(Aa,Fb,Ta)):new da(Aa,Fb,Ta);h.ULS.sendTraceTag(508352212,
220,50,`AddinDetailsManagerFactory.CreateInstance: Creating an instance of ${Aa.name}`);return Aa}static TGh(Aa){return(Aa||z.AFrameworkApplication.ea).getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",!1)}}Object(c.a)(ta,"AddinDetailsManagerFactory",null,[]);var pa=a(1076),Ga=a(613),Ca=a(1512),kb=a(1660),eb=a(1196),Yb=a(39),Gb=a(179),Mb=a(1514),Rb=a(137),$b=a(178),cc=a(126),fb=a(91),Sb=a(666),kc=a(790),na=a(154),fc=a(363),Cc=a(141),tc=a(605),nb=a(182),tb=a(41),
La=a(1147),wb=a(1443),Wa=a(1149),Fa=a(93);class Da{constructor(){this.command=0;this.properties=null}}Object(c.a)(Da,"DdaRequestInfo",null,[]);var ja=a(964),Qa=a(70);class Ob extends Fa.a{constructor(Aa,Fb){super();this.requests=[];this.disposed=this.npc=!1;this.wg=()=>{if(!this.disposed){this.grid.Rb.gq(this.wg);this.npc=!1;const Ta=this.requests;this.requests=[];for(const Eb of Ta)this.ddaFacade.yQ(Eb.command,Eb.properties)}};this.ddaFacade=Aa;this.grid=Fb}sei(Aa,Fb){this.disposed||(this.npc||(this.grid.Rb.Uq(this.wg),
this.npc=!0),this.requests.push(Object(d.a)(new Da,{command:Aa,properties:Fb})))}dispose(){if(!this.disposed){this.disposed=!0;this.npc&&this.grid.Rb.gq(this.wg);var Aa=this.requests;this.requests=null;for(const Fb of Aa)(Aa=Fb.properties?Fb.properties[Qa.a.Qba]:null)&&this.ddaFacade.si(ja.a.kTb,Aa);this.ddaFacade=this.grid=null;super.dispose()}}static j0h(Aa,Fb){var Ta=!1;974713501===Aa&&(Fb=(Aa=Fb?Fb[Qa.a.Bf]:null)?Aa.DdaMethod:null)&&Fb.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&
(Ta=Aa.ArrayData,Ta=!!Ta&&64===(Ta[6]&64));return Ta}}Object(c.a)(Ob,"DdaCellEditDelayRequestHandler",Fa.a,[]);var Ub=a(1005);class Zb extends Ub.a{constructor(Aa,Fb,Ta,Eb,oc,Lc,Jd){super(Aa,Fb,Ta);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=Eb;this.messageContent=oc;this.messageOrigin=Lc;this.targetOrigin=Jd}}Object(c.a)(Zb,"DialogMessageReceivedEventArgs",Ub.a,[]);class uc extends Ub.a{constructor(Aa,Fb,Ta,Eb,oc,Lc,Jd){super(Aa,Fb,Ta);this.messageType=
0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=Eb;this.messageContent=oc;this.messageOrigin=Lc;this.targetOrigin=Jd}}Object(c.a)(uc,"DialogParentMessageReceivedEventArgs",Ub.a,[]);var Hc=a(1),Dd=a(25);class jc{constructor(Aa){this.Cf=this.wqd=null;this.D1j=(Fb,Ta)=>{this.handlers.Bb(Ta.controlId)&&(Fb=new Zb(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,Ta.controlId,null,Ta.messageType,Ta.messageContent,Ta.messageOrigin,Ta.targetOrigin),this.handlers.pa(Ta.controlId)(Fb),
Ta.messageType===OSF.DialogMessageType.DialogClosed&&this.handlers.remove(Ta.controlId))};this.C1j=(Fb,Ta)=>{this.VLc.Bb(Ta.controlId)&&(Fb=new uc(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,Ta.controlId,null,Ta.messageType,Ta.messageContent,Ta.messageOrigin,Ta.targetOrigin),this.VLc.pa(Ta.controlId)(Fb))};this.handlers=new B.a;this.VLc=new B.a;this.dda=Aa;this.Qfb.nFh(this.D1j);this.Qfb.mFh(this.C1j)}get Qfb(){this.wqd||(this.wqd=U.getInstance(this.contextActivationMgr));return this.wqd}get contextActivationMgr(){!this.Cf&&
this.dda&&(this.Cf=this.dda.Cf);return this.Cf}addHandler(Aa,Fb,Ta,Eb){h.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");const oc=Lc=>{Lc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(this.handlers.ga(Aa,Fb),this.dda.Bz(Ta)):(h.ULS.sendTraceTag(537170501,0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),this.dda.si(Lc,Ta))};this.handlers.Bb(Aa)?oc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(Aa,Eb,oc)}gAh(Aa,Fb,Ta){h.ULS.sendTraceTag(537170500,
0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!");this.VLc.ga(Aa,Fb);this.dda.Bz(Ta)}removeHandler(Aa,Fb){this.handlers.Bb(Aa)?(h.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.Qfb.VTa(Aa,Ta=>{this.handlers.remove(Aa);Ta===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.dda.Bz(Fb):(h.ULS.sendTraceTag(537170498,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),this.dda.si(Ta,Fb))})):this.dda.si(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
Fb)}Wqk(Aa,Fb){h.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!");this.VLc.remove(Aa);this.dda.Bz(Fb)}showDialog(Aa,Fb,Ta){try{Hc.EwaSettings.isChangeGateEnabled("OfficeVSO:6254758_ExitCellEditModeDialogAPI")&&Dd.f(this.dda.$).isEditing&&Dd.f(this.dda.$).Bu(!0),this.Qfb.showDialog(Fb,Aa,Ta,Eb=>{this.dda.EAh(this.dSh(Eb))})}catch(Eb){h.ULS.sendTraceTag(537170496,0,10,`DialogMessageReceivedEventManager: show dialog failed. Exception message: ${Eb.message}`),
Ta(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}dSh(Aa){const Fb={};Fb.InstanceId=Aa.id;Fb.WebExtensionType=Aa.osfControlType===OSF.OsfControlTarget.InContent?0:1;Fb.PrimaryMarketplace={};Fb.PrimaryMarketplace.SolutionId=Aa.solutionId;Fb.PrimaryMarketplace.SolutionVersion=Aa.version;Fb.PrimaryMarketplace.MarketplaceRef=Aa.storeId;Fb.PrimaryMarketplace.MarketplaceType=Aa.storeType;Fb.OwnerAddinSolutionId=Aa.ownerAddinSolutionId;Fb.OwnerAddinStoreType=Aa.ownerAddinStoreType;return Fb}static Ea(Aa){if(!Aa.$.ra.Tb(232)){const Fb=
new jc(Aa);Aa.$.ra.zc(232,Fb)}}}Object(c.a)(jc,"DialogMessageReceivedEventManager",null,[388]);class $c{constructor(Aa,Fb){this.HF=null;this.zoa=Aa;this.svh=Fb}zlc(Aa){Aa&&(this.HF||(this.HF=[]),this.HF.push(Aa))}fUc(Aa){this.HF&&Array.remove(this.HF,Aa)}get eventId(){return this.zoa}get targetId(){return this.svh}get Eaj(){return 0<this.HF.length}iKj(Aa){return this.eventId!==Aa.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?
this.targetId===Aa.ddaBinding.Name:!0}Soc(Aa){this.HF&&Array.forEach(this.HF,Fb=>{Fb(Aa)})}tLa(){this.HF=[]}}Object(c.a)($c,"DdaEventRegistration",null,[]);class ud{constructor(Aa){this.nK=null;this.AHa=!1;this.Nd=()=>{this.nK.forEach(Fb=>{Fb.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Fb.Soc(new Ub.a(Fb.eventId,"",null))})};this.dda=Aa}invokeDdaMethod(Aa,Fb){const Ta={};Ta[Qa.a.Bf]=Aa;Ta[Qa.a.Qba]=Fb;this.dda.yQ(974713501,Ta)}registerDdaEventAsync(Aa,Fb,Ta,Eb,oc){ud.nUb(Aa)?
(ud.LVd(Aa)&&this.cSd(),this.nK||(this.nK=[]),Fb=this.JNb(Aa,Ta),Fb||(Fb=new $c(Aa,Ta),this.nK.push(Fb)),Fb.zlc(Eb),this.dda.Bz(oc)):this.dda.si(-1,oc)}unregisterDdaEventAsync(Aa,Fb,Ta,Eb,oc){ud.nUb(Aa)?((Aa=this.JNb(Aa,Ta))&&Aa.fUc(Eb),this.dda.Bz(oc)):this.dda.si(-1,oc)}cSd(){this.AHa||(Dd.f(this.dda.$).ha.YS(this.Nd),this.AHa=!0)}JNb(Aa,Fb){if(!this.nK)return null;for(let Ta=0;Ta<this.nK.length;Ta++){const Eb=this.nK[Ta];if(Eb.eventId===Aa&&Eb.targetId===Fb)return Eb}return null}static nUb(Aa){return Aa===
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static LVd(Aa){return Aa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}}Object(c.a)(ud,"EmbeddingPage",null,[319]);var Ud=a(232);class ec extends Ub.a{constructor(Aa,Fb,Ta,Eb,oc,Lc,Jd,Ab){super(Aa,Fb,Ta);this.columnCount=this.rowCount=this.startColumn=this.startRow=0;this.startColumn=Lc-Eb.Reference.FirstColumn;this.columnCount=Ab;Aa=Math.max(oc,Eb.Reference.FirstRow);oc=Math.min(oc+Jd-1,Eb.Reference.LastRow);Aa>oc?this.startRow=
this.rowCount=void 0:(this.startRow=Aa-Eb.Reference.FirstRow,this.rowCount=oc-Aa+1)}getStartRow(){return this.startRow}getStartColumn(){return this.startColumn}getRowCount(){return this.rowCount}getColumnCount(){return this.columnCount}}Object(c.a)(ec,"DdaBindingSelectionEventArgs",Ub.a,[]);var Db=a(211),ic=a(27),Pc=a(44),Ed=a(1151),de=a(43),se=a(675),Fe=a(327),fe=a(64),Tc=a(83),ed=a(17),pd=a(12),Kb=a(99);class rb{}rb.Tvf="ewa-ptp-nov2-flex";rb.gti="ewa-wx-container-div";rb.hti="ewa-wx-disabled-div";
Object(c.a)(rb,"WebExtensionClassNames",null,[]);var rc=a(88),ld=a(65),Tb=a(5),Wc=a(368),Ac=a(213),nd=a(429);a(1143);const qd=rb.hti,Xd=rb.gti;class Hd extends Ud.a{constructor(Aa,Fb,Ta,Eb,oc){oc=void 0===oc?!1:oc;super();this.Gtb=0;this.nK=null;this.AHa=!1;this.HRc=null;this.e1=0;this.Isc=this.h9a=this.bKe=this.AHe=null;this.cfc=this.zPe=!1;this.sgd=this.Cma=this.jCe=null;this.Nd=()=>{this.enabled&&(this.xGk(),this.HRc=Pc.e(Dd.f(this.$).ha.oa.selectedRanges))};this.JQf=Lc=>{Lc.controlId===this.Vd.InstanceId&&
Array.forEach(this.nK,Jd=>{Jd.iKj(Lc)&&Jd.Soc(Lc)})};this.hjg=Lc=>{Lc=Object(na.a)(230,Lc);this.KWf(Lc)};this.onFloatingObjectControlAdded=(Lc,Jd)=>{3===Jd.control.floatingObject.type&&Jd.control.floatingObject.Bj.InstanceId===this.y$.WebExtensionId&&(this.Zaa=Object(na.a)(231,Jd.control),this.RXc(Jd.control.Zd.firstChild),Kb.a(this.$).YTc(this.onFloatingObjectControlAdded))};this.Qb=Aa.$;this.webExtensionView=Eb;this.dda=Aa;this.Vd=Ta;this.Vd.InstanceId=Ta.SrcLocationOverrideResourceId?Aa.vja(Ta.InstanceId,
Ta.SrcLocationOverrideResourceId):Ta.InstanceId;this.ki=Fb;this.y$={};this.y$.WebExtensionId=Ta.InstanceId;this.Bvg="osfControl_"+Ta.InstanceId;this.PBd="disabled_"+Ta.InstanceId;this.y$.BindingData=Ta.BindingData;this.Hkb=this.dda.Hkb(Ta.InstanceId);this.HEc=this.dda.HEc(Ta.InstanceId);this.tUe=Ta.WebExtensionOsfControlType;this.pzg=oc}get controlId(){return this.Vd.InstanceId}get G1f(){return this.cfc}Iij(Aa){this.Cma||(this.Cma=Aa)}wGg(){this.Cma&&(this.Cma.dispose(),this.Cma=null)}get controlType(){return this.Vd.WebExtensionType}get ownerAddinSolutionId(){return this.Vd.OwnerAddinSolutionId}get $(){return this.Qb}get enabled(){return!this.e1}get visible(){return this.Vd.TaskpaneVisible}get oB(){return this.sgd}get qT(){return this.Vd.SrcLocationOverrideResourceId?
this.dda.vja(this.Vd.PrimaryMarketplace.SolutionId,this.Vd.SrcLocationOverrideResourceId):this.Vd.PrimaryMarketplace.SolutionId}get sourceLocationOverrideResourceId(){return this.Vd.SrcLocationOverrideResourceId}get Bj(){return this.Vd}get Zaa(){return this.AHe}set Zaa(Aa){this.AHe=Aa}get osfControlType(){return this.tUe}get AEa(){return this.bKe}set AEa(Aa){this.bKe=Aa}get Hsc(){return this.h9a}set Hsc(Aa){this.h9a=Aa}get focusOnIframeWhenLoaded(){return this.Vd.FocusOnIframeWhenLoaded}get oHc(){return this.zPe}set oHc(Aa){this.zPe=
Aa}mTd(){if(!OSF.OsfControl.isFirstPartyStoreString(this.Vd.PrimaryMarketplace.MarketplaceType)&&Hc.EwaSettings.Ra(174)){const Fb=Object(rc.d)(ld.a.resolve(Tb.BusinessBarManagerService,{xa:0}));de.TaskExtensions.tb(Fb,()=>{Fb.result.lh(36,null)},this.Aa,3);return this}if(1===this.Vd.WebExtensionType)Tb.AgaveTaskPaneService.Oa()?void ld.a.resolve(Tb.AgaveTaskPaneService,{xa:1}).then(Fb=>this.KWf(Fb)):de.TaskExtensions.tb(Ed.a(this.$),Fb=>{Fb.result.C7h(this.$.ra,this.hjg)},this.Aa,3);else{var Aa=this.vBf();
const Fb=Kb.a(this.$);Aa||(Aa={Type:3},Aa.Id=this.y$.WebExtensionId,Aa.WebExtensionData=this.Vd,Aa.ContentHtml="<div/>",Aa.Version=0,Aa.AbsoluteLeft=0,Aa.AbsoluteTop=0,Aa.AbsoluteRight=0,Aa.AbsoluteBottom=0,Aa.Width=0,Aa.Height=0,Aa.ZOrder=0,Aa.OriginDeltaX=0,Aa.OriginDeltaY=0,Aa=new Db.a(Aa),Fb.zrc(Aa,null),Aa=Fb.fr(Aa.Fh()));Aa?(this.RXc(Aa.Zd.firstChild),this.Zaa=Object(na.a)(231,Aa)):Fb.olc(this.onFloatingObjectControlAdded)}return this}pWf(Aa){this.RXc(Aa);return this}FNc(){this.pzg||this.dda.Cf.purgeOsfControl(this.controlId,
!1);if(Hc.EwaSettings.isChangeGateEnabled("OfficeVSO:8490416_SkipCloseAgaveCallInViewMode")&&this.$.isEditMode||!Hc.EwaSettings.isChangeGateEnabled("OfficeVSO:8490416_SkipCloseAgaveCallInViewMode")){const Fb=this.$.ma.sa.mc();nd.a(this.$.userOperationManager,(Ta,Eb,oc)=>Wc.e(this.$.ma.sa,this.Vd.InstanceId,Ta,Eb,oc,Fb),Ta=>new Ac.a(606,0,Ta,64),null)}this.N5g(!0);const Aa=this.vBf();Aa&&Kb.a(this.$).deleteFloatingObject(Aa);this.dda.xi.Aqk(this.controlId);this.dda.xi.Osf(this.controlId,!0);this.sgd=
null}l$d(Aa){this.y$=Aa}invokeDdaMethod(Aa,Fb){if(Hc.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled){var Ta={};Ta[Qa.a.Bf]=Aa;Ta[Qa.a.Qba]=Fb;this.dda.yQ(974713501,Ta)}else this.dda.si(ja.a.kTb,Fb)}Ank(Aa,Fb,Ta,Eb){if(Hc.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled)if(!Hd.hji(Aa)||void 0!==Fb&&null!==Fb&&void 0!==this.rhb(Fb)&&null!==this.rhb(Fb))if(h.ULS.sendTraceTag(36444195,0,50,`eventId: ${Aa}, targetId: ${Fb}`),Hd.q_f(Aa)&&
this.Tcj(),Hd.LVd(Aa)&&this.cSd(),Hd.o_f(Aa))this.cfc=!0,this.dda.$.ra.Tb(232).addHandler(this.controlId,Ta,Eb,Fb);else if(Hd.p_f(Aa))this.cfc=!0,this.dda.$.ra.Tb(232).gAh(this.controlId,Ta,Eb);else{Hd.n_f(Aa)&&this.MQf(-1777565636,Eb);this.nK||(this.nK=[]);var oc=this.JNb(Aa,Fb);oc||(oc=new $c(Aa,Fb),this.nK.push(oc));oc.tLa();oc.zlc(Ta);this.dda.Bz(Eb);Aa===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.h9a&&(this.Isc=Ta)}else this.dda.si(3002,Eb);else this.dda.si(-1,Eb)}kal(Aa,Fb,Ta,Eb){Hd.o_f(Aa)?
(this.dda.$.ra.Tb(232).removeHandler(this.controlId,Eb),Hc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InlineDialogReset",!1)&&(this.cfc=!1)):Hd.p_f(Aa)?this.dda.$.ra.Tb(232).Wqk(this.controlId,Eb):(Hd.n_f(Aa)&&this.MQf(1592314317,Eb),Fb=this.JNb(Aa,Fb),this.enabled?(Fb&&(Fb.fUc(Ta),Fb.Eaj||Array.remove(this.nK,Fb),this.nK.length?Hd.q_f(Aa)&&this.O5g(!1):this.N5g(!1)),this.dda.Bz(Eb)):this.dda.si(-1,Eb))}Ea(Aa){ed.DOMElementExtensions.getElementById(Aa,this.Bvg)||Aa.appendChild(ed.DOMElementExtensions.vh(this.oB))}showHide(Aa){ed.DOMElementExtensions.setVisible(this.oB,
Aa)}resize(Aa,Fb){ed.DOMElementExtensions.SG(this.oB,Aa);ed.DOMElementExtensions.P4(this.oB,Fb)}ipf(Aa){if(!this.e1&&!ed.DOMElementExtensions.getElementById(this.oB,this.PBd)&&this.oB){const Fb=document.createElement("div");Fb.id=this.PBd;Fb.className=qd;Fb.style.backgroundImage="url("+fe.a.current.Lo(103)+")";Fb.style.opacity=Aa?"1":"0";Fb.style.backgroundRepeat="no-repeat";Fb.style.backgroundPosition="center";this.oB.insertBefore(Fb,this.oB.firstChild)}this.e1++}gmi(){0<this.e1&&this.e1--;this.e1||
(ed.DOMElementExtensions.vh(ed.DOMElementExtensions.getElementById(this.oB,this.PBd)),this.AHa&&!Pc.Y(this.HRc,Dd.f(this.$).ha.oa.selectedRanges)&&this.Nd(null,null))}rhb(Aa){if(!this.y$||!this.y$.BindingData)return null;for(let Fb=0;Fb<this.y$.BindingData.length;Fb++)if(this.y$.BindingData[Fb].Name===Aa)return this.y$.BindingData[Fb];return null}getDefaultIconUrl(){const Aa=this.QLf();return Aa?Aa.getDefaultIconUrl():null}getDefaultDisplayName(){if(this.Vd.TaskpaneTitle)return this.Vd.TaskpaneTitle;
const Aa=this.QLf();return Aa?Aa.getDefaultDisplayName():null}fAg(){if(this.h9a&&this.Isc){const Aa=new Ub.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.h9a);this.Isc(Aa);this.Isc=this.h9a=null}}dA(Aa){this.jCe&&this.jCe.dA(Aa)}KIk(){this.$.fa.isNamedObjectViewMode&&this.Yuj()&&(Tb.WebExtensionViewService.Oa()?this.webExtensionView.sQg(this.oB):Wa.a(this.$).sQg(this.oB),this.showHide(!1));if(this.dda.nkl){if(!this.pzg){const Aa={};Aa.div=this.oB;Aa.id=this.Vd.InstanceId;
Aa.solutionId=this.Vd.PrimaryMarketplace.SolutionId;Aa.version=this.Vd.PrimaryMarketplace.SolutionVersion;Aa.storeId=this.Vd.PrimaryMarketplace.MarketplaceRef;Aa.storeType=this.Vd.PrimaryMarketplace.MarketplaceType;Aa.ownerAddinSolutionId=this.Vd.OwnerAddinSolutionId;Aa.ownerAddinStoreType=this.Vd.OwnerAddinStoreType;this.Vd.AssetMarketplace?(Aa.assetId=this.Vd.AssetMarketplace.SolutionId,Aa.assetStoreId=this.Vd.AssetMarketplace.MarketplaceRef):(Aa.assetId=null,Aa.assetStoreId=null);Aa.settings=this.Vd.OsfPropertyBag;
Aa.hostSettings=this.Vd.HostPropertyBag;Hc.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?Aa.reason=this.Hkb?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.HEc?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.ControlActivation:Aa.reason=this.Hkb?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:Microsoft.Office.WebExtension.InitializationReason.Inserted;
Aa.osfControlType=0===this.Vd.WebExtensionType?OSF.OsfControlTarget.InContent:OSF.OsfControlTarget.TaskPane;Aa.isForUILessAction=4===this.Vd.WebExtensionOsfControlType;Aa.sourceLocationOverrideResourceId=this.Vd.SrcLocationOverrideResourceId;Aa.focusOnIframeWhenLoaded=this.Vd.FocusOnIframeWhenLoaded;se.a(this.Vd)&&(Aa.featureGates=z.AFrameworkApplication.ea.KIf(Aa.solutionId));Aa.hostInfoFlags=0;this.AEa&&(Aa.hostInfoFlags|=2);pd.HelperMethods.cB(this.Vd)&&(Aa.hostInfoFlags|=1);this.$.ZW||(h.ULS.sendTraceTag(537170466,
0,50,"Content web add-in disabled by doc IRM"),Aa.hostInfoFlags|=4);Hc.EwaSettings.Ra(553)&&(Aa.hostInfoFlags|=8);Aa.sharedRuntimeId=this.Vd.SharedRuntime?this.Vd.SharedRuntime.Resid:this.Vd.SharedRuntimeId;!pd.HelperMethods.cB(this.Vd)||this.Vd.Preload||se.a(this.Vd)||this.dda.Cf.getOsfControl(a(958).DdaFacade.getSolutionId(this.Vd,this.$))||(Hc.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?this.$.isEditMode&&this.dda.oug(this.Vd):this.dda.oug(this.Vd));Aa.onExtensionLaunchCallback=
this.Vd.OnExtensionLaunchCallback;Aa.sdxPrivateApi=this.Vd.SdxPrivateApi;Aa.initialDisplayMode=this.Vd.TaskpaneVisible?2:1;Hc.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&(Aa.titleOverride=this.Bj.TaskpaneTitle);this.dda.Cf.insertOsfControl(Aa)}this.e1=0}else this.ipf(!0)}N5g(Aa){this.O5g(Aa);this.S$k()}Tcj(){this.Gtb||this.ki.zlc(this.JQf);this.Gtb++}O5g(Aa){0<this.Gtb&&(Aa?this.Gtb=0:this.Gtb--,this.Gtb||this.ki.fUc(this.JQf))}cSd(){if(!this.AHa){const Aa=Dd.f(this.$).ha;
this.HRc=Pc.e(Dd.f(this.$).ha.oa.selectedRanges);Aa.YS(this.Nd);this.AHa=!0}}S$k(){this.AHa&&(Dd.f(this.$).ha.qV(this.Nd),this.AHa=!1)}mFk(Aa){var Fb=new ic.Range(Aa.Reference.FirstRow+1,Aa.Reference.FirstColumn+1,Aa.Reference.LastRow+1,Aa.Reference.LastColumn+1,!1,!1);1===Aa.BindingType&&(Aa.HasHeaders&&--Fb.top,Aa.HasTotals&&(Fb.bottom+=1));var Ta=Dd.f(this.$).ha.oa.selectedRanges;Aa=Fb.zkb(this.HRc);Ta=Fb.zkb(Ta);return(Fb=Fb.Xe(Dd.f(this.$).ha.oa.activeRange))&&(Fe.a(Aa)&&!Fe.a(Ta)||!Fe.a(Aa)&&
!Fe.a(Ta)&&!Pc.Y(Aa,Ta))?Fb:null}xGk(){Array.forEach(this.nK,Aa=>{if(Aa.eventId!==OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Aa.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||this.dda.xi.Zmc(this.controlId))if(Aa.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)Aa.Soc(new Ub.a(Aa.eventId,this.controlId,null));else if(Aa.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){const Fb=this.rhb(Aa.targetId);if((null===Fb||void 0===Fb?0:Fb.IsValidRef)&&
(this.$.fa.isNamedObjectViewMode?this.$.wc.la.sheetName:this.$.qa.la.name)===Fb.Reference.SheetName){const Ta=this.mFk(Fb);Ta&&Aa.Soc(new ec(Aa.eventId,this.controlId,this.dda.Jnc(Fb),Fb,Ta.top-1,Ta.left-1,Ta.height,Ta.width))}}})}JNb(Aa,Fb){if(!this.nK)return null;for(let Ta=0;Ta<this.nK.length;Ta++){const Eb=this.nK[Ta];if(Eb.eventId===Aa&&Eb.targetId===Fb)return Eb}return null}vBf(){const Aa=Kb.a(this.$).WX;for(let Fb=Aa.length-1;0<=Fb;--Fb){const Ta=Aa[Fb];if(3===Ta.floatingObject.type&&Ta.floatingObject.Bj.InstanceId===
this.y$.WebExtensionId)return Ta}return null}Yuj(){for(let Aa=0;Aa<this.$.wc.count;Aa++)if(this.$.wc.getItem(Aa).imageId===this.y$.WebExtensionId)return!0;return!1}KWf(Aa){if(Hc.EwaSettings.isChangeGateEnabled("OfficeVSO:8220021_ExcludingMisMatchingPaneAndData")&&null!=(null===Aa||void 0===Aa?void 0:Aa.th)&&(null===Aa||void 0===Aa?void 0:Aa.th.InstanceId)!==this.Vd.InstanceId)h.ULS.sendTraceTag(508302915,220,15,"InstanceIds mismatching for webExtensionPane and webExtensionData.");else if(Aa&&!Aa.v2())if(!this.Vd||
OSF.OsfControl.isFirstPartyStoreString(this.Vd.PrimaryMarketplace.MarketplaceType)||this.$.ZW){Aa.th=this.Vd;Aa.sn=this.dda;this.jCe=Aa;this.RXc(Aa.eGb);const Fb=Hc.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&pd.HelperMethods.cB(this.Vd)&&this.Vd.Preload&&!this.Vd.TaskpaneVisible;Fb?Aa.$9d():Hc.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?(Aa.$9d(),(this.Vd.SharedRuntime&&1===this.Vd.SharedRuntime.LifeTime||this.Vd.SharedRuntimeId)&&
!this.Vd.TaskpaneVisible&&Aa.dA(!1)):((this.Vd.SharedRuntime&&1===this.Vd.SharedRuntime.LifeTime||this.Vd.SharedRuntimeId)&&!this.Vd.TaskpaneVisible&&Aa.dA(!1),Aa.$9d());this.Hkb||Fb||Aa.PC();Tb.AgaveTaskPaneService.Oa()?this.Zaa=Aa:(this.$.ra.Tb(77).LGg(this.hjg),this.Zaa=Object(na.a)(231,Aa))}else h.ULS.sendTraceTag(537170464,0,50,"Taskpane web add-in disabled by doc IRM")}RXc(Aa){this.sgd=Aa;this.oB.id=this.Bvg;this.oB.className=Xd;this.oB.dir=this.$.isChromeRtl?"rtl":"ltr";this.KIk()}QLf(){if(!this.enabled)return null;
const Aa=se.a(this.Bj)?"":this.Bj.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.Bj.PrimaryMarketplace.SolutionId,Aa)}MQf(Aa,Fb){try{if(h.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),4!==this.tUe)this.dda.si(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,Fb);else{const Ta={};Ta[Na.a.$Fb]=this.controlId;const Eb=new Tc.a(Aa,0,this.$.isEditMode?2:1,0,null);this.$.Ia.Gb(Eb,Ta);this.dda.Bz(Fb)}}catch(Ta){h.ULS.sendTraceTag(537170461,
0,10,`HandleDialogNotificationShownInAddinEvent called. Error message: ${Ta.message}.`),this.dda.si(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,Fb)}}static hji(Aa){return Aa===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Aa===OSF.DDA.EventDispId.dispidBindingDataChangedEvent}static q_f(Aa){return Aa===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||Aa===OSF.DDA.EventDispId.dispidSettingsChangedEvent||Aa===OSF.DDA.EventDispId.dispidRichApiMessageEvent}static LVd(Aa){return Aa===
OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Aa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static o_f(Aa){return Aa===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent}static p_f(Aa){return Aa===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static n_f(Aa){return Aa===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent}}Object(c.a)(Hd,"OsfControl",Ud.a,[387]);class Zc{constructor(){this.ecb={}}add(Aa){this.ecb[Aa]=!0}remove(Aa){delete this.ecb[Aa]}clear(){for(const Aa of Object.keys(this.ecb))delete this.ecb[Aa]}lSf(){return 0<
Object.keys(this.ecb).length}VIi(){return Object.keys(this.ecb)}}Object(c.a)(Zc,"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,[]);var Jc=a(58);class gc{constructor(Aa,Fb,Ta){this.eFg=this.dFg=0;this.L6b=this.irb=null;this.nUj=()=>{var Eb=Dd.f(this.$).ha.ob.FF;if(this.gVd(Eb)&&(Eb=this.hPb(Eb))){var oc={};oc.chartId=Eb;oc.worksheetId=this.tta();oc=Jc.a.Nc(oc);this.Tsa(51,Eb,oc);this.Tsa(51,this.tta(),oc)}};this.oUj=()=>{if(this.irb){var Eb={};Eb.chartId=this.irb;Eb.worksheetId=this.L6b;
Eb=Jc.a.Nc(Eb);this.Tsa(52,this.irb,Eb);this.Tsa(52,this.L6b,Eb)}Eb=Dd.f(this.$).ha.ob.FF;this.gVd(Eb)?(this.irb=this.hPb(Eb),this.L6b=this.tta()):this.L6b=this.irb=null};this.$=Aa;this.xi=Fb;this.ki=Ta}XGb(Aa){51===Aa.messageType?this.dFg=this.USa(Aa.actionType,this.dFg,this.nUj):52===Aa.messageType&&(this.eFg=this.USa(Aa.actionType,this.eFg,this.oUj))}USa(Aa,Fb,Ta){if(1===Aa)Fb||Dd.f(this.$).ha.ob.pod(Ta),Fb++,this.JMk();else if(2===Aa){if(1>Fb)return Fb;1===Fb&&Dd.f(this.$).ha.ob.Aie(Ta);Fb--}return Fb}Tsa(Aa,
Fb,Ta){Fb&&this.xi.HQ(Aa,Fb)&&this.ki.vK(Aa,Fb,Ta)}hPb(Aa){return Aa&&Aa.floatingObject?(Aa=Aa.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&1===Aa.length?Aa[0]:null:null}tta(){const Aa=this.$.qa.la;return Aa&&0===Aa.CB?Aa.sheetId:null}JMk(){const Aa=Dd.f(this.$).ha.ob.FF;this.gVd(Aa)&&(this.irb=this.hPb(Aa),this.L6b=this.tta())}gVd(Aa){return!!Aa&&!!Aa.floatingObject&&0===Aa.floatingObject.type}}Object(c.a)(gc,"RichApiEventChartActivatedDeactivatedHandler",null,[]);
var dd=a(965),Bb=a(198),pc=a(750),wc=a(117),cd=a(67);class Vd extends Fa.a{constructor(Aa,Fb,Ta){super();this.e1=this.rLa=0;this.Nd=(Eb,oc)=>{if(this.enabled&&!(this.L1f()||null!==oc&&void 0!==oc&&oc.G5f)&&(Eb=Object(na.a)(wc.a,this.$.qa.la))&&0===Eb.CB){const Lc=Eb.sheetId,Jd=this.AHf();let Ab=null,Uc=null;this.xi.u5f()&&(Ab=this.grid.Eb.dg(this.grid.ha.oa.activeCell),Uc=Lc in this.xJc?this.xJc[Lc]:null);this.p8e(Lc,Jd)&&de.TaskExtensions.tb(cd.Task.Va(!0),()=>{this.W$i(Lc,Jd);this.F$i(Lc,Jd,Ab,
Uc)},this.Aa);this.qqf(Lc,Jd,Ab)}};this.$=Aa;this.xi=Fb;this.ki=Ta;this.grid=Dd.f(Aa);this.o0a={};this.xJc={}}get enabled(){return!this.e1&&0<this.rLa}tnc(Aa){1===Aa.actionType?(this.rLa||this.grid.ha.YS(this.Nd),this.rLa++):2!==Aa.actionType||1>this.rLa||(1===this.rLa&&this.grid.ha.qV(this.Nd),this.rLa--)}xXc(Aa){Aa?this.e1++:(0<this.e1&&this.e1--,this.e1||this.Nd(null,new pc.a(!1)))}AHf(){return this.grid.ha.oa.selectedRanges}p8e(Aa,Fb){return Hc.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?
(!!Aa&&Bb.e(this.o0a)||Aa in this.o0a)&&!Pc.Y(this.o0a[Aa],Fb):Aa in this.o0a&&!Pc.Y(this.o0a[Aa],Fb)}qqf(Aa,Fb,Ta){this.o0a[Aa]=Pc.e(Fb);this.xJc[Aa]=Ta}L1f(){return this.grid.isEditing||this.grid.nk}QBf(Aa,Fb){this.xi.HQ(14,Aa)&&this.ki.vK(14,Aa,Fb);this.xi.HQ(14,dd.a.GR)&&this.ki.vK(14,dd.a.GR,Fb)}W$i(Aa,Fb){const Ta={};Ta.worksheetId=Aa;Ta.address=this.ONd(Fb);Fb=Jc.a.Nc(Ta);this.QBf(Aa,Fb)}F$i(Aa,Fb,Ta,Eb){if(this.xi.u5f()){var oc="";let Lc="";Eb&&(oc=Eb.ll);Ta&&(Lc=Ta.ll);Eb?Ta?(Fb=Ta.usedRange.zkb(Fb),
oc!==Lc&&this.zxc(oc,"",Aa),this.zxc(Lc,this.ONd(Fb),Aa)):this.zxc(oc,"",Aa):Ta&&(oc=Ta.usedRange.zkb(Fb),this.zxc(Lc,this.ONd(oc),Aa))}}zxc(Aa,Fb,Ta){if(this.xi.HQ(100,Aa)){const Eb={};Eb.address=Fb;Eb.worksheetId=Ta;this.ki.vK(100,Aa,Jc.a.Nc(Eb))}}ONd(Aa){return Pc.k(Aa,",",this.$,!1)}dispose(){0<this.rLa&&this.grid.ha.qV(this.Nd);this.xJc=this.o0a=null;this.rLa=0;this.ki=this.xi=this.$=this.grid=null}}Object(c.a)(Vd,"RichApiEventSelectionChangedHandler",Fa.a,[]);var xb=a(397);class ub extends Vd{constructor(Aa,
Fb,Ta){super(Aa,Fb,Ta);this.T7f=this.U7f=null}AHf(){return xb.a.Vrc(this.grid.ha.rangePicker.jV)}p8e(Aa,Fb){return this.U7f!==Aa||!Pc.Y(this.T7f,Fb)}qqf(Aa,Fb){this.U7f=Aa;this.T7f=Pc.e(Fb)}L1f(){return!this.grid.isEditing&&!this.grid.nk}QBf(Aa,Fb){this.xi.HQ(2700,dd.a.GR)&&this.ki.vK(2700,dd.a.GR,Fb)}}Object(c.a)(ub,"RichApiEventPickedRangesChangedHandler",Vd,[]);class Fc{constructor(Aa,Fb,Ta){this.N3a=this.M3a=0;this.wTa=this.gra=null;this.Cmg=()=>{var Eb=Dd.f(this.$).ha.ob.FF;if(0<this.N3a&&this.gra&&
this.wTa){var oc={};oc.shapeId=this.gra;oc.worksheetId=this.wTa;oc=Jc.a.Nc(oc);this.fireEvent(2102,this.gra,oc)}this.Mwj(Eb)?(this.gra=this.r9k(Eb),this.wTa=this.tta(),this.gra&&this.wTa)?0<this.M3a&&(Eb={},Eb.shapeId=this.gra,Eb.worksheetId=this.wTa,Eb=Jc.a.Nc(Eb),this.fireEvent(2101,this.gra,Eb)):h.ULS.sendTraceTag(537170458,344,10,`Something goes wrong, we got invalid shape id: '${this.gra}', or worksheet id: '${this.wTa}' from a Floating object or gridview.`):this.wTa=this.gra=null};this.$=Aa;
this.xi=Fb;this.ki=Ta}XGb(Aa){const Fb=Dd.f(this.$).ha;1===Aa.actionType?(this.M3a||this.N3a||Fb.ob.pod(this.Cmg),2101===Aa.messageType?this.M3a++:2102===Aa.messageType&&this.N3a++):2===Aa.actionType&&(2101===Aa.messageType?this.M3a=0<this.M3a?this.M3a-1:0:2102===Aa.messageType&&(this.N3a=0<this.N3a?this.N3a-1:0),this.M3a||this.N3a||Fb.ob.Aie(this.Cmg))}Mwj(Aa){return!!Aa&&!!Aa.floatingObject&&(0===Aa.floatingObject.type||7===Aa.floatingObject.type||1===Aa.floatingObject.type||3===Aa.floatingObject.type||
5===Aa.floatingObject.type)}r9k(Aa){if(!Aa||!Aa.floatingObject)return null;Aa=Aa.floatingObject.id;var Fb=Aa.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));Fb=Fb&&1===Fb.length?Fb[0]:null;return Fb?Fb:(h.ULS.sendTraceTag(537170457,344,10,`Expect get the guid like shape id from the floating object id: '${Aa}', but we failed.`),null)}tta(){const Aa=this.$.qa.la;return Aa&&0===Aa.CB?Aa.sheetId:null}fireEvent(Aa,Fb,Ta){Fb&&this.xi.HQ(Aa,Fb)&&this.ki.vK(Aa,Fb,Ta)}}Object(c.a)(Fc,"RichApiEventShapeActivatedDeactivatedHandler",
null,[]);class xd{constructor(Aa,Fb,Ta){this.iFg=this.hFg=this.jFg=this.gFg=0;this.G7j=(Eb,oc)=>{Eb=Object(na.a)(wc.a,oc.la);this.Dmb(Eb)&&(oc={},oc.worksheetId=Eb.sheetId,oc=Jc.a.Nc(oc),this.Tsa(11,Eb.sheetId,oc))};this.J7j=(Eb,oc)=>{Eb=Object(na.a)(wc.a,oc.Vx);this.Dmb(Eb)&&(oc={},oc.worksheetId=Eb.sheetId,oc=Jc.a.Nc(oc),this.Tsa(12,Eb.sheetId,oc))};this.H7j=(Eb,oc)=>{Eb=Object(na.a)(wc.a,oc.la);this.Dmb(Eb)&&(oc={},oc.worksheetId=Eb.sheetId,Eb=Jc.a.Nc(oc),this.Tsa(11,null,Eb,!0))};this.I7j=(Eb,
oc)=>{Eb=Object(na.a)(wc.a,oc.Vx);this.Dmb(Eb)&&(oc={},oc.worksheetId=Eb.sheetId,Eb=Jc.a.Nc(oc),this.Tsa(12,null,Eb,!0))};this.$=Aa;this.xi=Fb;this.ki=Ta}XGb(Aa){11===Aa.messageType?Aa.targetId===dd.a.GR?this.YLh(Aa.actionType):this.XLh(Aa.actionType):12===Aa.messageType&&(Aa.targetId===dd.a.GR?this.ZLh(Aa.actionType):this.$Lh(Aa.actionType))}XLh(Aa){this.gFg=this.USa(Aa,this.gFg,this.G7j)}$Lh(Aa){this.jFg=this.USa(Aa,this.jFg,this.J7j)}YLh(Aa){this.hFg=this.USa(Aa,this.hFg,this.H7j)}ZLh(Aa){this.iFg=
this.USa(Aa,this.iFg,this.I7j)}USa(Aa,Fb,Ta){1===Aa?Fb=this.TSa(Fb,Ta):2===Aa&&(Fb=this.hVa(Fb,Ta));return Fb}TSa(Aa,Fb){Aa||this.$.qa.mh(Fb);Aa++;return Aa}hVa(Aa,Fb){if(1>Aa)return Aa;1===Aa&&this.$.qa.xh(Fb);Aa--;return Aa}Dmb(Aa){return!!Aa&&0===Aa.CB}Tsa(Aa,Fb,Ta,Eb){Fb=(void 0===Eb?0:Eb)?dd.a.GR:Fb;this.xi.HQ(Aa,Fb)&&this.ki.vK(Aa,Fb,Ta)}}Object(c.a)(xd,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var Ic=a(309),bd=a(16),yb=a(286);class Oc extends Sys.EventArgs{constructor(Aa,Fb,Ta,
Eb){super();this.sheet=Aa;this.cWh=Fb;this.offsetX=Ta;this.offsetY=Eb}}Object(c.a)(Oc,"ClickInActiveCellEventArgs",Sys.EventArgs,[]);class kd{constructor(Aa,Fb,Ta){this.cqc=null;this.l_d=!1;this.onPointerDown=Eb=>{if(3===Eb.Yb){const {leb:oc}=this.da.Uyc(Eb.clientPoint);this.l_d=!!oc&&this.da.ha.oa.Bqf(oc)}else this.l_d=!1;this.cqc=Eb.clientPoint;return!1};this.Hd=Eb=>{if(this.da.inRangePicker||this.da.nk||this.l_d||Eb.shiftKey||Eb.ctrlKey||Eb.Ha.button!==Sys.UI.MouseButton.leftButton||!this.cqc||
!Eb.clientPoint||Eb.clientPoint.x!==this.cqc.x||Eb.clientPoint.y!==this.cqc.y)return!1;let oc;var Lc=(()=>{let Ab=this.da.Uyc(Eb.clientPoint);({leb:oc}=Ab);return Ab})().returnValue;const Jd=Object(na.a)(wc.a,this.$.qa.la);if(Lc&&Jd&&0===Jd.CB){if(!this.da.ha.oa.u7.contains(oc))return!1;Lc=new Oc(Jd,oc,pd.HelperMethods.WQc(Lc.x),pd.HelperMethods.WQc(Lc.y));this.K7j(Lc)}return!1};this.$=Aa;this.da=Dd.f(Aa);this.xi=Fb;this.ki=Ta;this.gpk()}dispose(){this.Ial()}gpk(){for(const Aa of this.da.$p){const Fb=
Aa.domElement;Ic.a.instance.va(bd.a.Sd,Fb,this.onPointerDown);yb.a.instance.va(bd.a.click,Fb,this.Hd)}}Ial(){for(const Aa of this.da.$p){const Fb=Aa.domElement;Ic.a.instance.Ua(bd.a.Sd,Fb,this.onPointerDown);yb.a.instance.Ua(bd.a.click,Fb,this.Hd)}}K7j(Aa){var Fb=Aa.sheet;if(this.Dmb(Fb)){var Ta={};Ta.worksheetId=Fb.sheetId;Ta.address=Aa.cWh.toString();Ta.offsetX=Aa.offsetX;Ta.offsetY=Aa.offsetY;Aa=Fb.sheetId;this.xi.HQ(21,Aa)&&(Fb=Jc.a.Nc(Ta),this.ki.vK(21,Aa,Fb));Aa=dd.a.GR;this.xi.HQ(21,Aa)&&(Ta=
Jc.a.Nc(Ta),this.ki.vK(21,Aa,Ta))}}Dmb(Aa){return!!Aa&&0===Aa.CB}}Object(c.a)(kd,"RichApiEventSingleClickedHandler",null,[]);class Rc{constructor(Aa,Fb,Ta){this.R2b=0;this.Vqb=this.frb=null;this.Jug=()=>{const Eb=Dd.f(this.$).ha.ob.FF;if(Eb)if(this.t6f(Eb)){const oc=this.tta();this.eHd(oc);this.frb=Eb.floatingObject.id;this.Vqb=oc}else this.frb&&(this.eHd(this.Vqb),this.Vqb=this.frb=null);else this.frb&&(this.eHd(this.Vqb),this.Vqb=this.frb=null)};this.$=Aa;this.xi=Fb;this.ki=Ta}tnc(Aa){2E3===Aa.messageType&&
(1===Aa.actionType?(this.R2b||Dd.f(this.$).ha.ob.pod(this.Jug),this.R2b++,this.QIk()):2===Aa.actionType&&this.R2b&&(1===this.R2b&&Dd.f(this.$).ha.ob.Aie(this.Jug),this.R2b--))}eHd(Aa){var Fb;const Ta={};Ta.worksheetId=Aa;Ta.revisionLoad=!1;if(Hc.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")){const Eb=Dd.f(this.$).ha.ob.FF;(null===(Fb=null===Eb||void 0===Eb?void 0:Eb.floatingObject)||void 0===Fb?0:Fb.Zc)?Ta.selectedVisualId=Eb.floatingObject.Zc.VisualID:
Ta.selectedVisualId=null}Fb=Jc.a.Nc(Ta);Aa&&this.xi.HQ(2E3,Aa)&&this.ki.vK(2E3,Aa,Fb)}tta(){const Aa=this.$.qa.la;return Aa&&0===Aa.CB?Aa.sheetId:null}QIk(){const Aa=Dd.f(this.$).ha.ob.FF;this.t6f(Aa)&&(this.frb=Aa.floatingObject.id,this.Vqb=this.tta())}t6f(Aa){return!!Aa&&Aa.R_d()}}Object(c.a)(Rc,"RichApiEventVisualSelectionChangedHandler",null,[]);class Xb{constructor(Aa,Fb,Ta){this.S2b=0;this.kbh=!0;this.Oxc=0;this.XYd=!0;this.eef=()=>{const Eb=document.hasFocus();if(this.kbh!==Eb){if(Eb){const oc=
Jc.a.Nc({});this.ki.vK(2203,dd.a.GR,oc)}this.kbh=Eb}};this.fef=Eb=>{(0<Eb.timeRemaining()||Eb.didTimeout)&&this.eef();window.requestIdleCallback(this.fef)};this.$=Aa;this.xi=Fb;this.ki=Ta;window.requestIdleCallback||(this.XYd=!1)}WLh(Aa){1===Aa.actionType?(this.S2b||this.kMh(),this.S2b++):2!==Aa.actionType||1>this.S2b||(1===this.S2b&&this.Qfi(),this.S2b--)}kMh(){if(this.xi.HQ(2203,dd.a.GR))if(this.XYd){const Aa={};Aa.timeout=this.$.ta.CheckFocusTimeout;this.Oxc=window.requestIdleCallback(this.fef,
Aa)}else this.Oxc=window.setInterval(this.eef,this.$.ta.CheckFocusTimeInterval)}Qfi(){this.XYd?window.cancelIdleCallback(this.Oxc):window.clearInterval(this.Oxc)}}Object(c.a)(Xb,"RichApiEventWorkbookActivatedHandler",null,[]);var dc;(function(Aa){Aa[Aa.none=0]="none";Aa[Aa.registerEvent=1]="registerEvent";Aa[Aa.unregisterEvent=2]="unregisterEvent";Aa[Aa.customFunction=3]="customFunction";Aa[Aa.showCard=4]="showCard";Aa[Aa.createWorkbook=5]="createWorkbook";Aa[Aa.openWorkbook=6]="openWorkbook";Aa[Aa.enableEvents=
7]="enableEvents";Aa[Aa.closeWorkbook=8]="closeWorkbook";Aa[Aa.setCalculationMode=9]="setCalculationMode";Aa[Aa.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";Aa[Aa.workbookLinksRequestRefreshAll=11]="workbookLinksRequestRefreshAll";Aa[Aa.workbookLinksEnableContent=12]="workbookLinksEnableContent";Aa[Aa.workbookLinksFindNextLink=13]="workbookLinksFindNextLink";Aa[Aa.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";Aa[Aa.rangePicker=15]="rangePicker";Aa[Aa.enableRichApiRecording=
16]="enableRichApiRecording";Aa[Aa.recordAction=17]="recordAction";Aa[Aa.focus=18]="focus";Aa[Aa.businessBarShow=19]="businessBarShow";Aa[Aa.businessBarHide=20]="businessBarHide";Aa[Aa.augmentationLoopActivateAnnotation=21]="augmentationLoopActivateAnnotation";Aa[Aa.augmentationLoopSubmitSignal=22]="augmentationLoopSubmitSignal";Aa[Aa.showRangeValuesPreview=23]="showRangeValuesPreview";Aa[Aa.hideRangeValuesPreview=24]="hideRangeValuesPreview"})(dc||(dc={}));Object(c.b)("PostProcessActionType",dc);
var Vc=a(227);class yd{constructor(Aa,Fb,Ta,Eb){this.Cvg=null;this.cHd=(oc,Lc)=>{const Jd=dd.a.GR,Ab={};Ab.eventId=oc;Ab.payload=Lc;this.xi.HQ(2201,Jd)&&this.ki.vK(2201,Jd,Jc.a.Nc(Ab))};this.$=Aa;this.xi=Fb;this.ki=Ta;this.ddaFacade=Eb;this.dij()}VLh(Aa){1===Aa.actionType?(this.$.oda=!0,(Tb.DdaFacadeService.Oa()?this.ddaFacade:Object(na.a)(a(958).DdaFacade,Vc.a(this.$))).dHd(!0)):2===Aa.actionType&&(this.$.oda=!1);this.Cvg=Aa.controlId;h.ULS.sendTraceTag(537170456,0,50,`AttachOrDetachMacroRecorderEventHandler: actionType: ${dc[Aa.actionType]}; controlId: ${this.Cvg}; this.ewaControl.IsMacroRecorderListening: ${this.$.oda}.`)}Ini(Aa){(Tb.DdaFacadeService.Oa()?
this.ddaFacade:Object(na.a)(a(958).DdaFacade,Vc.a(this.$))).SBf(Aa,this.$.oda)}dij(){this.$.A2&&de.TaskExtensions.tb(Object(rc.d)(ld.a.resolve(Tb.MacroRecorderEventsHandlerService,{xa:1})),Aa=>{(Aa=Aa.result)&&Aa.init(this.cHd)},this.$.Aa,3)}}Object(c.a)(yd,"RichApiMacroRecorderEventHandler",null,[]);class Pd{}Object(c.a)(Pd,"StyleCacheItem",null,[]);class re{constructor(Aa,Fb,Ta){this.$=Aa;this.da=Fb;this.$e=Ta}Uqa(Aa){this.range=Aa;this.tqc=Array(Aa.width);this.M_c=Array.from({length:Aa.height},
()=>Array(Aa.width))}AIk(Aa,Fb,Ta,Eb){this.o4f(Aa,Fb)&&(this.M_c[Aa-this.range.top][Fb-this.range.left]||(this.M_c[Aa-this.range.top][Fb-this.range.left]={backgroundColor:Ta.backgroundColor}),Ta.backgroundColor=Eb)}CIk(Aa,Fb,Ta){if(this.o4f(Aa,Fb)){Aa=ic.Range.Hc(Aa,Fb);var Eb=this.da.Ob(Aa);Eb&&(this.tqc[Fb-this.range.left]||(this.tqc[Fb-this.range.left]=Eb.width),Fb=this.$e.ete(this.da,[Aa],Ta,!1),"Success"!==Fb.kind&&h.ULS.sendTraceTag(508303323,0,10,`InstantaneousGridContentRestorer.setColumnWidth: failed to set column width - ${Fb.reason}.`))}}restore(){this.range&&
(this.tqc.forEach((Aa,Fb)=>{Aa=this.$e.ete(this.da,[ic.Range.Hc(this.range.top,this.range.left+Fb)],Aa,!1);"Success"!==Aa.kind&&h.ULS.sendTraceTag(508303322,0,10,`InstantaneousGridContentRestorer.restore: failed to set column width - ${Aa.reason}`)}),this.M_c.forEach((Aa,Fb)=>{Aa.forEach((Ta,Eb)=>{Eb=ic.Range.Hc(this.range.top+Fb,this.range.left+Eb);if(Eb=this.da.Ob(Eb))Eb.cell.backgroundColor=Ta.backgroundColor})}),this.tqc=this.M_c=this.range=void 0)}o4f(Aa,Fb){if(!this.range)return h.ULS.sendTraceTag(508303321,
0,15,"InstantaneousGridContentRestorer.isRowColInRange: range not yet created - begin has not been called"),!1;(Aa=this.range.contains(ic.Range.Hc(Aa,Fb)))||h.ULS.sendTraceTag(508303320,0,10,"InstantaneousGridContentRestorer.isRowColInRange: row/column not in range");return Aa}}Object(c.a)(re,"InstantaneousGridContentRestorer",null,[]);var ue=a(210),He=a(153);class bf{constructor(Aa,Fb,Ta,Eb){this.gZi=oc=>{const Lc=oc.he.block;if(this.Ux.Xe(Lc.Fd)){this.Xxg([Lc.Fd]);const Jd=Dd.f(this.$).jS(Lc.Fd),
Ab=()=>this.Pxg([Lc.Fd]);setTimeout(()=>{Jd.skeletonMode?setTimeout(()=>{Jd.skeletonMode?h.ULS.sendTraceTag(508303319,0,10,"RichApiRangeValuesPreview.getRangeCallback: skeleton mode not dismissed within alloted time."):Ab()},bf.Reh):Ab()},bf.ggh)}return!0};this.hea=(oc,Lc)=>{0===Lc.Fq&&576!==Lc.jg.operation.operationName&&this.Qjb(!0)};this.N$d=oc=>{this.zZc&&(this.YBi(oc),this.wV())};this.$=Aa;this.xi=Fb;this.ki=Ta;this.da=Dd.f(this.$);this.jEc=new re(this.$,this.da,Eb)}v$i(Aa,Fb,Ta,Eb){this.y3f(Aa)?
(Fb=this.WTh(Fb,Ta))?this.Lw?h.ULS.sendTraceTag(509227293,0,15,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: preview already showing, exit"):(this.worksheetId=Aa,this.Ux=Fb,this.values=Ta,this.q4(Eb)):h.ULS.sendTraceTag(509384200,0,10,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: failed to calculate range"):h.ULS.sendTraceTag(509384201,0,50,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: not showing the preview, desired worksheet not supported for this operation")}j8i(Aa){this.y3f(Aa)?
this.Qjb(!1):h.ULS.sendTraceTag(509359639,0,50,"RichApiRangeValuesPreview.handleHideRangeValuesPreviewPostProcessAction: not hiding the preview, desired worksheet not supported for this operation")}q4(Aa){this.Xxg(this.bGf());Aa&&(h.ULS.sendTraceTag(509227290,0,50,`RichApiRangeValuesPreview.showPreview: options: ${JSON.stringify(Aa)}`),Aa.autoexpandTable&&this.aUh(),Aa.autofitColumns&&this.nTh());this.zZc=this.da.KI.q4(this.Ux,this.gZi).then(Fb=>{h.ULS.sendTraceTag(509384199,0,50,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: preview shown");
this.Lw=Fb;this.jEc.Uqa(this.Ux);this.Pxg(this.bGf());this.$.userOperationManager.Kp(this.hea);Fb.z4b.then(()=>this.N$d(!0),()=>this.N$d(!0));return Promise.resolve()},Fb=>{h.ULS.sendTraceTag(509384198,0,10,`RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: failed to show preview, rejectionString = ${Fb}`);this.wV();return Promise.resolve()})}Qjb(Aa){this.zZc&&(h.ULS.sendTraceTag(509359638,0,50,"RichApiRangeValuesPreview.hidePreview: showPromise exists, will hide preview"),
this.zZc.then(()=>{const Fb=this.Lw;this.N$d(Aa);Fb&&Fb.R7("RichApiRangeValuesPreview")},()=>{h.ULS.sendTraceTag(509383618,0,10,"RichApiRangeValuesPreview.hidePreview: unexpected rejection of this.showPromise")}))}WTh(Aa,Fb){Aa=Pc.kb(Aa,this.$.qa);if(Aa.returnValue)return new ic.Range(Aa.range.top,Aa.range.left,Aa.range.top+Fb.length-1,Aa.range.left+Fb[0].length-1,!0,!0)}y3f(Aa){const Fb=this.$.qa.la;return Fb&&Aa===Fb.sheetId}Xxg(Aa){this.dId(Aa,(Fb,Ta,Eb,oc)=>{oc.cell.pL=this.values[Fb][Ta];return!0})}Pxg(Aa){this.Eya&&
this.dId(Aa,(Fb,Ta,Eb,oc)=>{this.jEc.AIk(Eb.top,Eb.left,oc,this.IQi(Eb.top));return!0});if(this.Tcb){const Fb=this.Ux.zkb(Aa);0<Fb.length&&this.Tcb&&this.Tcb.forEach((Ta,Eb)=>{this.jEc.CIk(Fb[0].top,this.Ux.left+Eb,Ta)})}}dId(Aa,Fb){for(let Eb=0;Eb<this.values.length;++Eb)for(let oc=0;oc<this.values[Eb].length;++oc){const Lc=ic.Range.Hc(this.Ux.top+Eb,this.Ux.left+oc);if(!Aa||Aa.some(Jd=>Jd.contains(Lc))){var Ta=this.da.nv(Lc);if((!Ta||Lc.equals(Ta.topLeft))&&(Ta=this.da.Ob(Lc))&&!Fb(Eb,oc,Lc,Ta))return}}}bGf(){return this.da.za.lv().filter(Aa=>
Aa.la===this.$.la).map(Aa=>Aa.Fd)}YBi(Aa){this.xi.HQ(3400,this.worksheetId)&&(Aa=Jc.a.Nc({type:"RangeValuesPreviewDismissed",source:"Local",Jsl:Aa}),this.ki.vK(3400,this.worksheetId,Aa))}wV(){this.$.userOperationManager.kn(this.hea);this.Xzk();this.Eya=this.worksheetId=this.zZc=this.values=this.Ux=this.Lw=void 0}aUh(){if(this.Ux){var Aa=this.v2i(this.Ux);if(Aa){h.ULS.sendTraceTag(509227289,0,50,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: table directly above or to the left of the range - faking autoexpand table");
var Fb=(Lc,Jd)=>{var Ab;return null===(Ab=this.da.Ob(ic.Range.Hc(Lc,Jd)))||void 0===Ab?void 0:Ab.backgroundColor},Ta=Aa.usedRange.top;if(Aa.attributes&16){var Eb=Fb(Aa.usedRange.top,Aa.usedRange.left);++Ta}var oc=Fb(Ta,Aa.usedRange.left);Fb=Fb(Ta+1,Aa.usedRange.left);this.Eya={j3g:Aa.usedRange.top,CRd:Eb,D6k:oc,UOh:Fb}}else h.ULS.sendTraceTag(508303318,0,50,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: table autoexpand requested but no table found")}else h.ULS.sendTraceTag(509227291,
0,10,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: this should never be called with no preview range set")}nTh(){this.Tcb=Array(this.Ux.width);let Aa=!1;this.dId(void 0,(Fb,Ta,Eb,oc)=>{var Lc;if(this.da.nv(Eb))return Aa=!0,!1;Fb=oc.cell;Fb=Fb.$hf(Fb.pL);Fb>oc.width&&(this.Tcb[Ta]=Object(He.a)(null!==(Lc=this.Tcb[Ta])&&void 0!==Lc?Lc:0,Fb));return!0});Aa&&(this.Tcb=void 0)}Xzk(){this.jEc.restore();Pc.C(this.Ux,(Aa,Fb)=>{Aa=ic.Range.Hc(Aa,Fb);if(Aa=this.da.Ob(Aa))Aa.cell.pL=void 0})}IQi(Aa){return this.Eya.CRd&&
Aa===this.Eya.j3g?this.Eya.CRd:0===(Aa-this.Eya.j3g-(this.Eya.CRd?1:0))%2?this.Eya.D6k:this.Eya.UOh}v2i(Aa){const Fb=ue.b(this.da.$,Aa,!0);if(!(1<Fb.length)){var Ta=oc=>{var Lc;const Jd=null!==(Lc=this.da.Eb.u2i(oc))&&void 0!==Lc?Lc:this.da.Eb.w2i(oc);if(Jd)return Jd},Eb=Ta(Aa);if(Eb&&0===Fb.length)return Eb;if(0!==Fb.length&&(Aa=Pc.gb(Aa,Fb[0].usedRange),1===Aa.length))return Ta(Aa[0])}}}bf.ggh=20;bf.Reh=100;Object(c.a)(bf,"RichApiRangeValuesPreview",null,[]);class af{}Object(c.a)(af,"SessionRecreationInfo",
null,[]);class Pe{constructor(Aa,Fb,Ta){this.$=Aa;this.xi=Fb;this.runtimeCalculationMode=Ta}hPj(){return Hc.EwaSettings.Ra(234)?this.xi.Raj()||0!==this.runtimeCalculationMode:!1}qRh(){var Aa={};Aa.eventRegistrationInfos=this.xi.kQi();Aa.runtimeCalculationMode=this.runtimeCalculationMode;Aa=Object(d.a)(new af,{runtimeState:Aa});const Fb={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",RequestHeaders:null};Fb.RequestBody=JSON.stringify(Aa);Fb.RequestFlags=1;return Fb}}Object(c.a)(Pe,"RichApiRuntimeStateHandler",
null,[]);class wf{constructor(Aa,Fb,Ta,Eb,oc,Lc,Jd,Ab,Uc){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=this.ServerCorrelationId=null;this.IsDocumentHidden=!1;this.enqueueUtcTime=Aa;this.processUtcTime=Fb;this.dequeueUtcTime=Ta;this.inQueueDurationInMS=Eb;this.executionDurationInMS=oc;this.operationCount=Lc;this.ServerCorrelationId=Jd;this.UserOperationName=Ab;this.IsDocumentHidden=
Uc}}Object(c.a)(wf,"UserOperationQueueItemsStatisticsData",null,[]);var xf=a(1305),Cf=a(74),tf=a(258),Jf=a(514),dg=a(61),uf=a(81),lf=a(29),Pf=a(124),Rf=a(57),Mf=a(53),zf=a(197),df=a(129),Bf=a(51),Kf=a(33),Vf=a(36),sb=a(255),Gc=a(28),ad=a(13),Wd=a(266),je=a(959),Ie=a(59),Je=a(1148),$e=a(26),Ib=a(608);class Nb{constructor(Aa,Fb,Ta){this.gTc=0;this.f1e=new Set;this.U3f=!1;this.$=Aa;this.xi=Fb;this.ki=Ta}ULh(Aa){1===Aa.actionType?this.xi.HQ(65541,dd.a.GR)?this.gTc++:h.ULS.sendTraceTag(509649754,0,10,
"AugmentationLoop AnnotationAdded event is not registered"):2===Aa.actionType&&0<this.gTc&&this.gTc--}YSj(Aa,Fb){if(0===this.gTc)h.ULS.sendTraceTag(509649753,0,50,"No event listeners. Event not fired.");else if(Fb){Aa=Fb.annotation;var Ta=[];Ta.push({content:JSON.stringify(Fb.annotation),annotationType:Ib.a.getTypeNameFor(Aa),id:Aa.id});this.ki.vK(65541,dd.a.GR,JSON.stringify({annotationProperties:Ta}))}else h.ULS.sendTraceTag(509649752,0,10,"Event args are null")}async X6i(Aa){if(!this.xi.HQ(65541,
dd.a.GR))h.ULS.sendTraceTag(509649751,0,10,"Event is not registered");else if(!this.f1e.has(Aa.annotationType)){var Fb=await ld.a.resolve(Tb.AugmentationLoopManagerService,{xa:1});this.U3f||(Fb.register(Fb.RT().NV("RichApi").LV(()=>{}).build()),this.U3f=!0);Fb.Iea("RichApi",{annotationType:Aa.annotationType,ls:!1,dO:this.YSj.bind(this)});this.f1e.add(Aa.annotationType)}}async Y6i(Aa){(await ld.a.resolve(Tb.AugmentationLoopManagerService,{xa:1})).qvb(JSON.parse(Aa.content),"RichApi");h.ULS.sendTraceTag(509649750,
0,100,`Submit operation for type: ${Aa.signalType}`)}}Object(c.a)(Nb,"RichApiAugmentationLoopHandler",null,[]);var Bc=a(1077),Af=a(1459),gf=a(1298);Object(ld.b)(Tb.DdaFacadeService,{we:"singleton"})(async Aa=>{h.ULS.sendTraceTag(507581071,0,50,"DdaFacade created");if(z.AFrameworkApplication.disableWholeAppsForOfficeFeature)return h.ULS.sendTraceTag(507581070,0,50,`Not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [${z.AFrameworkApplication.disableWholeAppsForOfficeFeature}]`),null;
const Fb=await ld.a.resolve(Tb.EwaControlService,Aa),Ta=await ld.a.resolve(Tb.AgaveOnSelectedReadoutHandlerService,Aa),Eb=await ld.a.resolve(Tb.FormatCellsActionService,Aa),oc=await ld.a.resolve(Tb.WebExtensionViewService,Aa);await Object(rc.a)(fe.a.s2d(65,()=>!(void 0===window.OSF||null===window.OSF),Fb.ta.MaxRetriesForLoadingScript,Fb.Aa,Aa.xa));await Object(rc.a)(Bc.a(Fb.Aa,Aa.xa));if(Hc.EwaSettings.Ra(359)){Aa=await (await Object(rc.e)(Ga.a.oxe(Object(b.d)(f.a)))).isFeatureEnabled("mso_officeStore",
!0);const Lc=await Object(b.a)(k.a).OF("WACSideloadAddins");Qe.PJb=Aa;Qe.LAe=Lc}"undefined"!==typeof OfficeExt&&"undefined"!==typeof OSF&&(Hc.EwaSettings.Ra(63)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new gf.a),Fb.Fe.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new gf.a,new Af.a(z.AFrameworkApplication.ea.appSettings.WebServiceBase),Hc.EwaSettings.Ra(70),!0),OfficeExt.MosRequestHandler.init&&OfficeExt.MosRequestHandler.init(new gf.a),z.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MosForWXPEnabled",
!1)&&OfficeExt.TMTRequestHandler.init&&OfficeExt.TMTRequestHandler.init(new gf.a),OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new gf.a));return new Qe(Fb,Ta,Eb,oc)});class Qe extends tb.a{constructor(Aa,Fb,Ta,Eb){super();this.ki=this.xl=this.fa=null;this.Xf=[];this.BVa=null;this.disposed=this.initialized=this.Fac=this.rmf=!1;this.Oza=null;this.dQc=[];this.kmf=[];this.K2a=[];this.Bfb=null;this.rce=new kc.a(X.a.Ef());this.Rlc=new C.a(X.a.Ef());
this.W0b=[];this.Vwg=[];this.nLb=350;this.LIa=this.j5=null;this.Rld=!1;this.YWe=this.XWe=this.NWe=this.WWe=this.VWe=this.TWe=this.PWe=this.UWe=this.QWe=this.SWe=this.OWe=this.RWe=null;this.tih=3E3;this.I6c=!1;this.eM=this.wBb=null;this.Rjd=!1;this.Sfd=new C.a(X.a.Ef());this.ggd=new C.a(X.a.Ef());this.fg=()=>{this.gE?this.WV||(this.Oza=this.fa.el.WebExtensions):this.Oza=this.fa.el.WebExtensions;var oc=Ab=>Hc.EwaSettings.Ra(114)?!Ab.AEa:!0,Lc=Ab=>Hc.EwaSettings.isChangeGateEnabled("OfficeVSO:7116850_fixDialogApiOsfControlDeletedBySheetLocking")?
!Ab.G1f:!0;const Jd=Ab=>this.gE?"FA000000124"!==Ab.Bj.PrimaryMarketplace.SolutionId:!0;for(let Ab=this.Xf.length-1;0<=Ab;--Ab){const Uc=this.Xf[Ab];!this.PBi(Uc.controlId)&&oc(Uc)&&Lc(Uc)&&Jd(Uc)&&(Uc.FNc(),this.Xf.splice(Ab,1))}if(this.Oza)for(let Ab=0,Uc=this.Oza.length;Ab<Uc;Ab++)oc=this.Oza[Ab],(Lc=this.Rp(oc.WebExtensionId))&&Lc.l$d(oc)};this.OOc=oc=>{this.raiseEvent("csc",oc.getID())};this.f2a=(oc,Lc,Jd)=>{if(Lc===OSF.AgaveHostAction.KeyboardShortcuts){var Ab=Object(na.a)(Object,Jd);Lc={};Lc.keyCode=
Ab.keyCode;Lc.type="keydown";Lc.ctrlKey=Ab.ctrlKey;Lc.shiftKey=Ab.shiftKey;Lc.altKey=Ab.altKey;Lc.metaKey=Ab.metaKey;Ab=this.Rp(oc);oc=Ab.Zaa;Lc.srcElement=Object(fc.a)(230,oc)?oc.eGb:Dd.f(this.$).ud;oc=new Sys.UI.DomEvent(Lc);Ab=Qe.cGa(Ab.Bj,this.$);Lc={};Lc.focusedAddinId=Ab;Ab=new Tc.a(1461300262,1,this.$.xc,6,null);Dd.f(this.$).L4b(oc,Ab,Lc)}else if(Lc===OSF.AgaveHostAction.Select)this.wQf(!0);else if(Lc===OSF.AgaveHostAction.UnSelect)this.wQf(!1);else if(Lc===OSF.AgaveHostAction.CancelDialog)this.yQ(-684355545,
null);else if(Lc===OSF.AgaveHostAction.InsertAgave)oc={},Jd&&(this.wBb=Jd,oc[Na.a.zqa]=Jd,oc[Qa.a.Bf]=this.mEa(Jd),this.yQ(-741808261,oc));else if(Lc===OSF.AgaveHostAction.ClickTrust)this.Fpd&&Jd&&(this.wBb=Jd);else if(Lc===OSF.AgaveHostAction.OsfControlLoad)this.Fpd&&this.wBb&&Jd&&this.RKh(this.wBb,Jd)&&Jd.storeType&&(this.wBb=null,this.sB(pa.b(Jd.storeType)));else if(Lc===OSF.AgaveHostAction.InsertDevManifest)oc={},Jd&&(oc[Na.a.zqa]=Jd,oc[Qa.a.Bf]=this.mEa(Jd),this.yQ(-741808261,oc));else if(Lc===
OSF.AgaveHostAction.InsertDevManifestError)oc=Object(na.a)(Object,Jd),oc={[Na.a.rpd]:this.xl.getDevManifestInvalidUrlErrorString(oc.manifestUrl)},this.yQ(-2025863019,oc);else if(Lc===OSF.AgaveHostAction.NotifyHostError)oc={[Na.a.rpd]:this.xl.getManifestInvaildErrorString()},this.yQ(-2025863019,oc);else if(Lc===OSF.AgaveHostAction.RefreshAddinCommands)Hc.EwaSettings.Ra(52)&&this.yQ($e.a.refreshAddinCommands,null);else if(Lc===OSF.AgaveHostAction.CtrlF6Exit||Lc===OSF.AgaveHostAction.CtrlF6ExitShift){if(Ab=
ld.a.Cb(Tb.EwaAccessibilityManagerService)){(oc=this.Rp(oc).Zaa)&&oc.z_c();Yb.a.Yg&&document.activeElement.blur();var Uc={keyCode:117,type:"keydown",ctrlKey:!0};Uc.shiftKey=Lc===OSF.AgaveHostAction.CtrlF6ExitShift;Uc.srcElement=Object(fc.a)(230,oc)?oc.eGb:Dd.f(this.$).ud;oc=new Sys.UI.DomEvent(Uc);Ab.Dwa(oc)}}else if(Lc===OSF.AgaveHostAction.PageIsReady){if((oc=this.Rp(oc).Zaa)&&oc.mcb===OSF.OsfControlTarget.TaskPane&&(oc=null,(oc=lf.a.Fj()?ld.a.Cb(Tb.ReactTaskPaneManagerService):this.$.ra.Tb(183))&&
this.Xf))for(Ab of this.Xf)Qe.xZa(Ab.qT)&&oc.Nj(!0,!1)}else if(Lc===OSF.AgaveHostAction.TabExit){Lc=this.Rp(oc);const ge=Lc.Zaa;ge?ge.mcb===OSF.OsfControlTarget.InContent?ge.x7f():ge.mcb===OSF.OsfControlTarget.TaskPane&&(Yb.a.Yg&&document.activeElement.blur(),lf.a.Fj()?void ld.a.resolve(Tb.ReactTaskPaneManagerService,{xa:3}).then(ze=>{const Le=Object(fc.a)(230,ge)?ge:null;Le?Le.isResizable?ze.focusResizeHandle():ze.focusTabbedTaskPaneArea():ze.focusTabbedTaskPaneArea()}):Gb.a.li().then(ze=>{const Le=
Object(fc.a)(230,ge)?ge:null;Le?Le.isResizable?ze.focusResizeHandle():ze.focusTabbedTaskPaneArea():ze.focusTabbedTaskPaneArea();return null})):Lc&&4===Lc.osfControlType&&this.xl.notifyAgave(oc,OSF.AgaveHostAction.TabIn)}else if(Lc===OSF.AgaveHostAction.TabExitShift)(Lc=this.Rp(oc),Ab=Lc.Zaa)?Ab.mcb===OSF.OsfControlTarget.InContent?Ab.y7f():Ab.mcb===OSF.OsfControlTarget.TaskPane&&(oc=Object(fc.a)(230,Ab)?Ab:null)&&(Yb.a.Yg&&document.activeElement.blur(),oc.QJk()):Lc&&4===Lc.osfControlType&&this.xl.notifyAgave(oc,
OSF.AgaveHostAction.TabIn);else if(Lc===OSF.AgaveHostAction.EscExit||Lc===OSF.AgaveHostAction.ExitNoFocusable||Lc===OSF.AgaveHostAction.ExitNoFocusableShift)if(Ab=this.Rp(oc).Zaa)Ab.z_c();else{if(Lc===OSF.AgaveHostAction.EscExit){Lc=null;for(Uc of U.s5i())if(Uc.value.uf===oc){Uc.value.dialog.hide();Lc=Uc.key;break}Lc&&(oc=this.Rp(Lc))&&4!==oc.osfControlType&&this.Cf.notifyAgave(Lc,OSF.AgaveHostAction.TabIn)}}else if(Lc===OSF.AgaveHostAction.InstallCustomFunctions)if(Hc.EwaSettings.Ra(114)){Bf.a(this.$).lDf(()=>
!1);var Od=this.$.ra;de.TaskExtensions.tb(uf.GetServiceTaskFactory.Ne(Od,278,279,1),ge=>{ge=ge.result;Od.Tb(278)||Od.zc(278,ge);const ze=Jd.osfControl.getStoreType();ge.BXf(Jd.osfControl.getSolutionId(),ze,Qe.dOi(Jd.osfControl),Jd).Nxa()},this.Aa,3)}else h.ULS.sendTraceTag(537170577,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");else if(Lc===OSF.AgaveHostAction.UninstallCustomFunctions)if(Hc.EwaSettings.Ra(114)){Bf.a(this.$).lDf(()=>!1);var le=
this.$.ra;de.TaskExtensions.tb(uf.GetServiceTaskFactory.Ne(le,278,279,1),ge=>{ge=ge.result;le.Tb(278)||le.zc(278,ge);ge.P5g(Jd.solutionId,Jd.storeType).Nxa()},this.Aa,3)}else h.ULS.sendTraceTag(537170574,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");else Lc===OSF.AgaveHostAction.SendTelemetryEvent?$b.a.sendOtelEvent({otelEvent:Jd}):Lc===OSF.AgaveHostAction.SendCustomerContent?$b.a.sendOtelCustomerContent({otelEvent:Jd}):Lc===OSF.AgaveHostAction.LaunchExtensionComponent?
n.a.instance.hBj(Jd):Lc===OSF.AgaveHostAction.RefreshRibbonGallery?void ld.a.resolve(Tb.OfficeScriptsCommandManagerService,{xa:0}).then(ge=>{ge.LQd(Jd)}):Lc===OSF.AgaveHostAction.RemoveAppCommandsAddin?this.crk(Jd.solutionId):Lc===OSF.AgaveHostAction.GetOriginalControlId&&(oc=new Ca.a(this.$.Oc,Jd.ownerAddinSolutionId,new La.a,!0),Jd.originalControlId=oc?oc.Kmf(Jd.controlId):Jd.controlId)};this.nPg=(oc,Lc)=>{const Jd=Array(2);Jd[0]=Lc;Jd[1]=null;this.ki.bCi(oc,JSON.stringify(Jd))};this.Lug=()=>{this.$.la&&
Cf.n(this.$.la)&&(Tb.WebExtensionViewService.Oa()?this.webExtensionView.OSb():Wa.a(this.$).OSb())};this.de=()=>{this.I9f()};this.onBlockCacheItemChanged=(oc,Lc)=>{oc=Lc.he;(oc=(oc=oc.block.state&1?oc.block.oe:null)?oc.CustomFunctionsObjects:null)&&this.Jyd(oc)};this.eZ=(oc,Lc)=>{var Jd,Ab;1===Lc.Fq&&(oc=Lc.jg)&&(Lc=new wf(df.toTimestamp(oc.enqueueUtcTime),df.toTimestamp(oc.processUtcTime),df.toTimestamp(oc.dequeueUtcTime),df.getElapsedMilliseconds(oc.enqueueUtcTime,oc.processUtcTime),df.getElapsedMilliseconds(oc.processUtcTime,
oc.dequeueUtcTime),oc.operationCount,(null===(Ab=null===(Jd=oc.operation)||void 0===Jd?void 0:Jd.Ge)||void 0===Ab?0:Ab.ServerCorrelationId)?oc.operation.Ge.ServerCorrelationId:null,oc.operation?Enum.toString(Jf.a,oc.operation.operationName):null,je.a.pI(df.getElapsedMilliseconds(oc.enqueueUtcTime,Kf.a.zb.Jc))),Jd=Sys.Serialization.JavaScriptSerializer.serialize(Lc),h.ULS.sendTraceTag(50872916,0,50,Jd))};this.nNc=()=>{this.AFg()};this.yd=(oc,Lc)=>{!this.fa.yc&&tf.a(Lc)?this.AFg():(Lc.nI&&(h.ULS.sendTraceTag(537170516,
0,50,"Silent Reload require reset osf controls."),this.qKg()),this.tO(),Hc.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&(this.Fac=!1))};this.Ln=()=>{Hc.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(h.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),this.qKg());this.tO();Hc.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(this.Fac=
!1)};this.jyg=oc=>{oc=oc.Result;if(oc=null===oc||void 0===oc?void 0:oc.AgaveData){var Lc=oc.PrimaryMarketplace.SolutionId;Lc=oc.SrcLocationOverrideResourceId?this.vja(oc.PrimaryMarketplace.SolutionId,oc.SrcLocationOverrideResourceId):Lc;if(Lc=this.XGd(Lc))this.Sfd.ga(oc.InstanceId,Lc.controlId),this.ggd.ga(Lc.controlId,oc.InstanceId)}else h.ULS.sendTraceTag(507637772,0,10,"Silent Reload::postServerReloadSuccess: failed to return valid response.")};this.olg=oc=>{oc.FNc();this.raiseEvent("cd",oc.controlId)};
this.Qb=Aa;this.webExtensionView=Eb;this.Ipd=Fb;this.initialize(Ta);jc.Ea(this);this.FLg=0;(Aa=(Aa=!(Yb.a.ot||Yb.a.AY))&&!Yb.a.Yg)&&OfficeExt.ShortcutKeyDispatchManager.init();this.Ioh={}}get Fcb(){return this.j5||(this.j5=new Mb.a(this.$.pT))}iod(Aa){this.addHandler("cd",Aa)}rsk(Aa){this.removeHandler("cd",Aa)}sDh(Aa){this.addHandler("csc",Aa)}tsk(Aa){this.removeHandler("csc",Aa)}pDh(Aa){this.addHandler("ca",Aa)}qsk(Aa){this.removeHandler("ca",Aa)}qDh(Aa){this.addHandler("ci",Aa)}rDh(Aa){this.addHandler("ekros",
Aa)}ssk(Aa){this.removeHandler("ekros",Aa)}Ube(Aa,Fb){try{return JSON.parse(Aa)[Fb].toLowerCase()}catch(Ta){return""}}hQk(Aa){const Fb=this.Ube(Aa,"AudienceGroup"),Ta=this.Ube(Aa,"SessionOrigin");try{const Eb=parseInt(this.Ube(Aa,"Ring"),10);if("automation"!==Fb&&"bluechicken"!==Ta&&-2<=Eb)return!0}catch(Eb){if("automation"!==Fb&&"bluechicken"!==Ta)return!0}return!1}get Cf(){if(!this.xl){const Aa={},Fb=!(this.$.$d&1),Ta=fe.a.current.pO,Eb=this.$.workbookContext,oc=z.AFrameworkApplication.hJ?z.AFrameworkApplication.ea.Qa("StaticContentHostNonOverriden"):
Rb.a.MO,Lc=oc+Rb.a.zqc;Aa.pageBaseUrl=Ta.LayoutsContentUrlPrefix;Aa.appName=OSF.AppName.ExcelWebApp;Aa.appVersion="16";Aa.appSettings=this.OSi();Aa.singleSignOnSettings=O.a.m1i();Aa.clientMode=Fb?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;Aa.appUILocale=this.$.ta.UICultureTag;Aa.dataLocale=this.$.ta.DataCultureTag;Aa.docUrl=Eb.ClientUrl;Aa.hostControl=this;Aa.formFactor=OSF.FormFactor.Default;Aa.lcid=this.$.bJ.toString();Aa.localizedScriptsUrl=oc+Rb.a.bhf;Aa.localizedImagesUrl=Lc;Aa.localizedStylesUrl=
oc+Rb.a.Zgf;Aa.localizedResourcesUrl=Lc;Aa.osfOmexBaseUrl=Ta.OsfOmexBaseUrl;Aa.firstPartyManifestCDNUrl=Ta.FirstPartyAddInManifestCDN;Aa.sdxAssetsToPrefetchMapping=z.AFrameworkApplication.ea.Qa("SdxAssetsToPrefetchMapping");Aa.sdxCdnUrl=Ta.SdxCdnUrl;Aa.sdx1CdnUrl=Ta.Sdx1CdnUrl;Aa.forceUseSdx1Cdn=Ta.ForceUseSdx1Cdn;Aa.sdxDmsUrl=Ta.SdxDmsUrl;Aa.sovereignFederationDMSToken=Ta.SovereignFederationDMSToken;Aa.sovereignFederationDMSTokenSuffix=Ta.SovereignFederationDMSTokenSuffix;Aa.defaultManifestTokens=
z.AFrameworkApplication.defaultManifestTokens;Aa.devCatalogUrl=Ta.DevCatalogUrl;Aa.controlStatusChanged=this.OOc;Aa.notifyHost=this.f2a;Aa.allowExternalMarketplace=this.$.fa.Kh.get(27)&&Qe.PJb;Aa.enableAddinCommands=Hc.EwaSettings.Ra(52);Aa.enableBlackForestRedirect=Hc.EwaSettings.Ra(87);Aa.enableMyOrg=this.$.fa.Kh.get(33);Aa.enableMyApps=this.$.fa.Kh.get(34);Aa.enableDevCatalog=Hc.EwaSettings.Ra(43);Aa.enablePrivateCatalog=this.fRk();Aa.showSignOutFromPrivateCatalogMessage=this.$.fa.Kh.get(36);Aa.enableUploadFileDevCatalog=
Hc.EwaSettings.Ra(52)&&!Hc.EwaSettings.Ra(254)&&Qe.LAe;Aa.userNameHashCode=L.a.qz(z.AFrameworkApplication.userName);Aa.envCode=this.$.ta.OfficeAddinTelemetryDataSourceCode.toString();Aa.enableSingleSignOnForAddin=z.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;Aa.enableDisplayBlockedMinorError=Hc.EwaSettings.Ra(171);Aa.hideAppsExtensionUrl=z.AFrameworkApplication.hideAppsExtensionUrl;Aa.enableAnonymousUseLegacyCatalogService=Hc.EwaSettings.Ra(162);Aa.enableInsertDialogAccessibilityFix=
Hc.EwaSettings.Ra(169);Aa.disableAppsForOfficeThirdParty=Hc.EwaSettings.Ra(174);Aa.enableFirstPartySSO=Hc.EwaSettings.Ra(186);Aa.wacSessionId=this.$.ta.UserSessionId;Aa.disableLogging=!this.$.ta.AriaLoggingIsEnabled;Aa.enableFirstPartySDXErrorMessages=Hc.EwaSettings.Ra(198);Aa.isHostDocumentDomain=Hc.EwaSettings.Ra(209);Aa.loggableUserId=z.AFrameworkApplication.ea.Qa("LoggableUserId");Aa.sessionStartInfoJson=z.AFrameworkApplication.ea.Qa("SessionStartInfoJson");Aa.wopiHostOriginFromPostMessage=z.AFrameworkApplication.wopiHostOriginFromPostMessage;
Aa.wopiHostOriginFromWacPropBag=z.AFrameworkApplication.ea.Qa("PostMessageOrigin");Aa.wacIsEmbedded=z.AFrameworkApplication.ea.ka("IsEmbedded");Aa.accessibilityAllowFocusAddinTaskpane=z.AFrameworkApplication.ea.ka("AccessibilityAllowFocusAddinTaskpane");Aa.enableRemoveAppCommandsAddin=z.AFrameworkApplication.ea.ka("RemoveAppCommandsAddinIsEnabled");Aa.isHostFrameTrustCheckEnabledForAddIns=z.AFrameworkApplication.ea.ka("HostFrameTrustCheckIsEnabledForAddIns");Aa.isHostFrameTrusted=z.AFrameworkApplication.isHostFrameTrusted;
Aa.agaveAddinUploadEnabled=Hc.EwaSettings.Ra(45);Aa.hostAllowedOfficeStore=z.AFrameworkApplication.ea.ka("HostAllowedOfficeStore");Aa.hostAllowedSdxEmbedding=z.AFrameworkApplication.ea.ka("HostAllowedSdxEmbedding");Aa.hostInstallAddIns=z.AFrameworkApplication.ea.Qa("HostInstallAddIns");Aa.hostInstallAddInsIsEnabled=z.AFrameworkApplication.ea.ka("HostInstallAddInsIsEnabled");Aa.approvedAddIns=z.AFrameworkApplication.ea.Qa("ApprovedAddIns");Aa.addinEnforceHttpsIsEnabled=this.hQk(Aa.sessionStartInfoJson);
Aa.hostFeatureGateFlag=0;Aa.isUpnCheckEnabled=z.AFrameworkApplication.ea.ka("IsUpnCheckEnabled");Aa.wacUpn=z.AFrameworkApplication.ea.Qa("UserPrincipalName");Aa.isReactRibbonEnabled=lf.a.isReactRibbonEnabled();Aa.enableSetFocusOnTaskpaneOnUserAction=Hc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);Aa.isSafariWithIndexedDBDisabled=Hc.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&Yb.a.qva;Aa.isIndexedDBDisabled=
Hc.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&Yb.a.qva||Hc.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&Yb.a.Yg;Aa.enableCustomShortcuts=!0;Aa.changeGetModifierKeyStringOutputOrder=Hc.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");Aa.officeJsUrl=z.AFrameworkApplication.EE("OfficeJs/excel.js",5);Aa.enableOfficeJsUrlParam=Hc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableOfficeJsUrlParam",
!1);this.xl=new OSF.ContextActivationManager(Aa);this.xl.setIframeAttributeBag({["frameborder"]:0,["marginheight"]:0,["marginwidth"]:0});this.xl.setWSA(z.AFrameworkApplication.Qn);this.xl&&"undefined"!==typeof this.xl.hostCheckReadyHandler&&z.AFrameworkApplication.tEh(Object(Cc.a)(this.xl,this.xl.hostCheckReadyHandler,"hostCheckReadyHandler"));try{const Jd=Object(b.a)(x.a);this.xl.setOAuthManager(Jd)}catch(Jd){}}return this.xl}get nkl(){return this.Rld}get xi(){return this.RWe}get Kxa(){return this.OWe}get Jle(){return this.SWe}get Ile(){return this.QWe}get YAk(){return this.UWe}get WAk(){return this.PWe}get XAk(){return this.TWe}get ZAk(){return this.VWe}get $Ak(){return this.WWe}get Kle(){return this.XWe}get ELg(){return this.YWe}get n2(){return this.Ioh}get $(){return this.Qb}get Hle(){return this.NWe}Jnc(Aa){const Fb=
{};Fb.Name=Aa.Name;Fb.BindingType=Aa.BindingType;Fb.HasHeaders=Aa.HasHeaders;Aa.IsValidRef&&(Fb.ColCount=Aa.Reference.LastColumn-Aa.Reference.FirstColumn+1,Fb.RowCount=Aa.Reference.LastRow-Aa.Reference.FirstRow+1);return Fb}get bcb(){return z.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&z.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:8500191_EnableHomeEntrywithFlyout")}R8f(Aa,Fb){const Ta=this.qQh(Fb);let Eb=null;if(z.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:7073634_TellMeLaunchAddinDialogSetTabIdEnabled")&&
Hc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1)&&null!==Fb&&"LaunchAddinDialogFromTellMe"===Fb[0])null!==Ta.assetId&&"undefined"!==typeof Ta.assetId&&(Eb="{98143890-AC66-440E-A448-ED8771A02D52}");else if(this.bcb){const oc=this.$.fa.Kh.get(27);!oc||null===Fb||"InsertMoreAddInsFromFooter"!==Fb[0]&&"InsertMoreAddInsFromBackstageFooter"!==Fb[0]&&"InsertMoreAddInsFromStoreDialog"!==Fb[0]?!oc||null===Fb||"AddinFlyoutMoreButton"!==Fb[0]&&"LaunchMyAddInsFromBackstage"!==
Fb[0]||(Eb="0"):Eb="{98143890-AC66-440E-A448-ED8771A02D52}"}Hc.EwaSettings.isChangeGateEnabled("OfficeVSO:8253544_LogTelemetryForStoreDialog")&&$b.a.sendTelemetryEvent({name:"Office.Extensibility.Host.ShowStoreDialog",dataFields:cc.a.Eh({["controlId"]:null!==Fb?Fb[0]:"AllSources"})});this.xl.launchInsertDialog(Aa,Eb,Ta)}get WV(){return this.Rjd}get gE(){return Hc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload",!1)}get osj(){return Hc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InlineDialogReset",
!1)}Gta(Aa){return this.ggd.Bb(Aa)?this.ggd.pa(Aa):Aa}jY(Aa){return this.Sfd.Bb(Aa)?this.Sfd.pa(Aa):Aa}get zP(){return this.oSa}get oSa(){this.Fpd&&!this.eM&&(this.Nok&&this.Hni(this.tih),this.eM=ta.createInstance(z.AFrameworkApplication.ea,new tc.a(()=>this.xl),{["AppsForOfficeAllowExternalMarketplace"]:this.allowExternalMarketplace,["AppsForOfficeThirdPartyIsDisabled"]:this.g4k,["AreThirdPartyAddInsAllowed"]:this.$.ZW,["PopularAddinDetailsJsonString"]:this.F$e&&this.bck?Qe.ack:Qe.Oqb,["UICulture"]:z.AFrameworkApplication.uiCulture}));
return this.eM}get g4k(){return Hc.EwaSettings.Ra(174)}get allowExternalMarketplace(){return this.$.fa.Kh.get(27)}get Fpd(){return z.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")}static get Oqb(){return'[{"displayName":"Mini Calendar and Date Picker","solutionId":"wa102957665","version":"1.3.0.0","targetType":0,"width":240,"height":220,"description":"Add a mini monthly calendar to your spreadsheet and use it to insert dates or the current time.","iconUrl":"31013.352a833c-760b-49ee-b384-f9718a71d650.3966871d-bbca-4abd-996d-777127e5f717.aac00a7f-336d-4d49-9fbb-f41bc3db4515.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.vertex42.com/privacy.html","addinInfo":{"priority":1,"AUP":45662}},{"displayName":"Bubbles","solutionId":"wa103147117","version":"1.1.0.0","targetType":0,"width":500,"height":500,"description":"Visualize your data in a fun and interactive way using bubbles to quickly identify patterns.","iconUrl":"6406.490601bf-78b6-49e5-be4f-e671fe712516.9fc1cb98-b071-4854-918e-40a0d2c7a467.49ae5470-5b06-4fa6-8762-6977e397810a.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://roljs.azurewebsites.net/bubbles-privacy-statement","addinInfo":{"priority":1,"AUP":84}},{"displayName":"Geographic Heat Map","solutionId":"wa103304320","version":"1.1.0.0","targetType":0,"width":480,"height":350,"description":"This app will help you visualize data across geographic locations. It\'s simply formatting on a map.","iconUrl":"33870.9aae8635-7790-49e5-9809-7704d4347793.cf84e746-9ce3-4a9a-83c5-4efc8117bc45.2cdca20b-36a0-45d8-bc0e-859ce6e806da.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"","addinInfo":{"priority":-1,"AUP":0}},{"displayName":"QR4Office","solutionId":"wa104051163","version":"1.2.0.3","targetType":1,"width":0,"height":0,"description":"A first-of-its-kind QR-generator that integrates seamlessly into your Office documents.","iconUrl":"53638.20ce8aca-39c5-4b97-b87a-47d0f3e21e0d.0b60ea0f-7e02-4465-baeb-bb55c723d670.9147ef8e-cf16-47cf-af10-ef553e88804d.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://q.michaelzlat.com/","addinInfo":{"priority":1,"AUP":1759}},{"displayName":"Solver","solutionId":"wa104100404","version":"3.0.0.1","targetType":1,"width":0,"height":0,"description":"Solve optimization models in Excel Online and Excel on iPad, upward compatible from Solver in Excel.","iconUrl":"37315.adb6ef87-ef0f-4f99-b639-c08a45950b58.cb56fe0c-c385-43b5-8c1b-88701ddbb898.c5239aae-28c3-4dec-8338-e6c0ceef5b82.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683093/Asset_5ef7a7a3-cb57-4c16-8fe4-6032d115bc04/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":3,"AUP":6458}},{"displayName":"People Graph","solutionId":"wa104104476","version":"1.4.0.0","targetType":0,"width":580,"height":400,"description":"Transform cold data into a cool picture.","iconUrl":"49387.7b82fde0-3b87-471f-a121-86215bd4c0d4.5c5551ff-1f1c-4fdd-83a0-9a311307f989.b07f3a4e-26ca-4174-83e2-a8953ecb5eb6.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949674809/Asset_488b8377-7de8-40ce-82ca-0a2fd48220dd/PEOPLEGRAPHAPPFOROFFICELICENSE.docx","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":1,"AUP":13200}},{"displayName":"E2D3","solutionId":"wa104379169","version":"2.0.1.0","targetType":0,"width":800,"height":680,"description":"Create dynamic and interactive graphs on Excel","iconUrl":"1677.6b2891ac-505f-41cc-80f6-db53a4274b85.62a2ad24-69c3-41ae-9419-bd700be3f626.67a1d711-d2ca-4e12-94b8-49464dc829ec.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://e2d3.org/privacy","addinInfo":{"priority":1,"AUP":73}},{"displayName":"XLMiner Analysis ToolPak","solutionId":"wa104379190","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Statistical analysis in Excel Online, with functions matching the Analysis ToolPak in desktop Excel.","iconUrl":"2225.9cbf413e-e33f-4be9-90ef-2fdb353c52a1.6e475dbb-9ae3-4b89-ae41-004faa21a088.e9552e6b-53ec-4728-ba49-ba04757c6dd0.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-analysis-toolpak-app","addinInfo":{"priority":3,"AUP":10751}},{"displayName":"Stock Connector","solutionId":"wa104379220","version":"8.0.0.0","targetType":1,"width":0,"height":0,"description":"Link stocks, currency, & crypto prices to cells in Excel spreadsheets and update them in real time.","iconUrl":"35421.d104d786-d979-48bb-9827-1b28ac5178cf.c0696ae0-87b8-4c16-ab8c-171be18ca0a9.8dcfdc9c-2863-4fa9-905d-84ff8534af7a.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://michael-saunders.com/stocksapp/pages/privacy.html","addinInfo":{"priority":1,"AUP":3216}},{"displayName":"Symbols and Characters - Fast Symbol Lookup","solutionId":"wa104379279","version":"2.1.0.0","targetType":1,"width":0,"height":0,"description":"Symbols and characters | Fast symbol and emoticon search with convenient auto-lookup","iconUrl":"53409.631e9a68-2435-4716-b1b8-dc48b99d3f85.d2f9c29f-cf48-4dcc-8202-fcbc5e4d1482.0216011c-2369-4ee7-8351-ac51d77015c2.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tec-it.com/en/legalconditions/Default.aspx","addinInfo":{"priority":1,"AUP":872}},{"displayName":"Microsoft Dynamics Office Add-in","solutionId":"wa104379629","version":"1.3.0.0","targetType":1,"width":0,"height":0,"description":"The Microsoft Dynamics Office Add-in enables data connections to Microsoft Dynamics systems.","iconUrl":"2287.eac0bf67-c34b-4302-aaa9-a07c1e560721.16c405d8-e48b-42e1-ac8f-7c402b8ae0d1.5ce79e5f-d108-48a7-b34b-75c71b620973.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949677398/Asset_e3871df6-665b-4927-a7fe-cd9e228611cc/LCSTermsofUseFinalFebruary2016.pdf","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=271135","addinInfo":{"priority":3,"AUP":3973}},{"displayName":"officeatwork | Template Chooser for Office - M365","solutionId":"wa104380050","version":"3.7.0.0","targetType":1,"width":0,"height":0,"description":"Access your centrally shared templates in Office, Teams, SharePoint Online, and other Apps.","iconUrl":"33107.40f3490e-24f2-4502-9a44-28e543d36a75.71f00b00-2d16-4d33-9b7a-7b1cbdbbbf52.5eeb833f-109d-4a4b-8a7d-c5954dfd778e.png","licenseUrl":"https://links.officeatwork.com/officeatwork-licenseterms","privacyUrl":"https://links.officeatwork.com/officeatwork-privacypolicy","addinInfo":{"priority":1,"AUP":822}},{"displayName":"Lucidchart Diagrams for Excel","solutionId":"wa104380194","version":"1.1.2.0","targetType":1,"width":0,"height":0,"description":"The easiest way to draw and insert flowcharts, mockups, UML, mind maps and more in Office documents.","iconUrl":"21470.3fa72610-07ba-489f-b48f-1fcb5ca4253a.fc3d89ad-c9dc-445c-9baa-074b7b8f0cfb.9bc93e17-dd72-4215-b8b0-0cf81a3d9925.png","licenseUrl":"https://www.lucidchart.com/pages/tos","privacyUrl":"https://www.lucidchart.com/pages/privacy","addinInfo":{"priority":3,"AUP":1968}},{"displayName":"Adobe Acrobat for Microsoft Word, Excel, and PowerPoint","solutionId":"wa104380526","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Do more with enterprise PDF tools, built right into your favorite Microsoft 365 apps.","iconUrl":"832.4553b45a-c9b7-42b8-9c57-e33b57f5df4d.80d83ec3-4ec7-4f7d-b45f-36b1f0c05e78.3d5b10f9-0a9c-4ac1-84fc-b7439dfb4f35.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":1,"AUP":3473}},{"displayName":"Facebook Ads Manager for Excel","solutionId":"wa104380711","version":"1.0.0.2","targetType":1,"width":0,"height":0,"description":"The fastest way to view performance data for all of your Facebook ad accounts.","iconUrl":"47990.d08ffb67-b1f0-4ef6-ac6f-4b5379c5d285.a5cb5ec2-3726-4cf0-ae84-5d8ee7ee3439.3af0d784-7a14-4e39-897b-24e4e633fb76.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.facebook.com/about/privacy","addinInfo":{"priority":3,"AUP":346}},{"displayName":"Script Lab, a Microsoft Garage project","solutionId":"wa104380862","version":"1.5.0.0","targetType":1,"width":0,"height":0,"description":"Create, run, and share your Office Add-in code snippets from within Excel, Word, or PowerPoint.","iconUrl":"52703.9fd54003-f1a2-4196-a8a8-ea11bec509a8.9b4da1d4-cb1c-46e6-9463-8a258eb273e6.b5c7baa9-2a17-4db7-b0dd-ca9dea75bd27.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":2,"AUP":1332}},{"displayName":"Excel-to-Word Document Automation","solutionId":"wa104380955","version":"3.16.2.1","targetType":1,"width":0,"height":0,"description":"Update Word and PowerPoint documents from Excel data, calculations, text, tables, and charts.","iconUrl":"44742.554108a6-3275-4065-9a18-887d38776dca.31f4b432-c6cb-49c5-9fba-56c194301365.e534a91d-b3f5-445e-bdbd-1559dbb4b396.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://analysisplace.com/Privacy","addinInfo":{"priority":3,"AUP":533}},{"displayName":"Journal Entry Batch Creator for Financial Edge NXT","solutionId":"wa104380978","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Create new journal entry batches in Financial Edge NXT via Excel (for existing customers)","iconUrl":"10843.146167ad-49b2-41d3-aff7-76ed38a0ea33.da610372-55d7-45b3-9134-1aa080eaa154.adce15a7-2cb2-4d79-90f8-6888df00287e.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.blackbaud.com/privacy-shield","addinInfo":{"priority":3,"AUP":348}},{"displayName":"Mobile Data Collection - Scan-IT to Office","solutionId":"wa104381026","version":"1.2.0.0","targetType":1,"width":0,"height":0,"description":"Real-time mobile data collection and barcode scanning for Excel and Word ","iconUrl":"7989.6963e6f3-4ebf-4a63-82b7-734a5a002866.814dcb0f-f024-477c-9b9b-9407aef3d56a.a4027334-e000-4b89-bd22-18d0d906a688.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tec-it.com/en/website/legalconditions/Default.aspx#Privacy","addinInfo":{"priority":3,"AUP":1167}},{"displayName":"Functions Translator, a Microsoft Garage project","solutionId":"wa104381504","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Translate the Excel functions and formulas between different languages","iconUrl":"6460.beedf6f4-7724-4c03-8e90-d6cc7d58e77c.a85b2258-a967-4d48-898f-a8db56e4d9c6.1b6557bd-4e89-4bad-a3d7-0ad2f0f0ee55.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://go.microsoft.com/fwlink/p/?LinkId=123161","addinInfo":{"priority":2,"AUP":1755}},{"displayName":"Cryptosheets","solutionId":"wa104381695","version":"1.0.10.0","targetType":1,"width":0,"height":0,"description":"The easiest way to pull live, real-time, and historical cryptocurrency data directly into a sheet.","iconUrl":"44479.63cc4a83-c6d9-41b8-ab03-721c5071695c.9ab58e20-a9a3-4915-8ece-423d1fbe8e5f.af1fbf7c-11e4-4278-a726-d902df022e8c.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://cryptosheets.com/privacy","addinInfo":{"priority":3,"AUP":374}},{"displayName":"Microsoft Power Automate for Excel","solutionId":"wa104381701","version":"1.0.0.4","targetType":1,"width":0,"height":0,"description":"Automate repetitive tasks by integrating your favorite apps and services with Power Automate.","iconUrl":"24472.5327e164-9595-41b5-94b6-dc524c42d5f6.318749ea-0f55-45b9-aee5-b89aae584a0c.73475625-266a-4866-b041-d9536d4673bb.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":-1,"AUP":9563}},{"displayName":"Tiller Money Feeds","solutionId":"wa104381717","version":"1.0.3.0","targetType":1,"width":0,"height":0,"description":"Manage your money, your way with the most powerful automated personal finance service for Excel.","iconUrl":"57987.b83fa962-bb4f-4dd1-89e2-6b40f8b0a724.95198c12-4345-4728-b4c6-d3e76bb58555.affa1083-0e0c-4cf9-b006-636291dae421.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tillerhq.com/privacy","addinInfo":{"priority":1,"AUP":311}},{"displayName":"FYI for Office","solutionId":"wa104381841","version":"1.0.2.2","targetType":1,"width":0,"height":0,"description":"Standardise your output and enforce filing across your practice with FYI.","iconUrl":"55705.a91d847f-3878-41c0-90a2-1a25491d561e.6ece2a38-0dd7-4c23-abd0-2d418443543e.4218a512-bae0-420b-b293-2194a885c9aa.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848155/Product_42949682443/Asset_5cb37a96-0b6a-4b64-bbf2-fa24ee29cec5/eula.pdf","privacyUrl":"https://www.fyidocs.com/privacy","addinInfo":{"priority":2,"AUP":1247}},{"displayName":"VitalTax | Making Tax Digital (MTD) for VAT","solutionId":"wa104381859","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Submit your VAT return directly from Excel and digitally link your data to HMRC","iconUrl":"10434.1d05b34e-479a-4769-bf99-07b416b11cbc.482ef49e-8635-4bfe-bb8d-e5ce4a2a4e61.be642c2c-717a-424c-96d8-8cea91a28e75.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848420/Product_42949682533/Asset_28a3de04-adcc-4a88-8d42-b3493d67599a/ENDUSERLICENSEAGREEMENT.docx","privacyUrl":"https://vitaltax.uk/privacy-policy","addinInfo":{"priority":1,"AUP":444}},{"displayName":"Microsoft Visio Data Visualizer","solutionId":"wa104381973","version":"1.0.0.4","targetType":0,"width":732,"height":448,"description":"Quickly and easily visualize your data into polished Visio diagrams within Excel.","iconUrl":"28591.0bb30ee2-d030-40d4-ba7e-3cb028cacb85.45958ca1-0858-42f7-9002-36ecaceadb38.84405685-1ffe-4d1d-9782-069079dc8d28.png","licenseUrl":"https://visio.officeapps.live.com/va/resources/licenseterms.html","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":1,"AUP":54042}},{"displayName":"XL-Connector 365","solutionId":"wa104382023","version":"2.0.0.1","targetType":1,"width":0,"height":0,"description":"Salesforce connector for Microsoft Office Online and Microsoft Office for Mac","iconUrl":"22105.87e56e91-0218-41b6-baf7-cd6d66ed7064.2132bae0-8ca0-4c27-ba4c-949cf6364791.f1ed243e-17f7-41ff-b99a-341d95cc8088.gif","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.xappex.com/docs/xl-connector-365-docs/xl-connector-365-privacy-policy","addinInfo":{"priority":3,"AUP":699}},{"displayName":"Analytic Solver","solutionId":"wa200000018","version":"23.1.0.0","targetType":1,"width":0,"height":0,"description":"Analyze risk, find the best way to allocate resources using Monte Carlo Simulation and Optimization","iconUrl":"13898.dda126ef-5dd2-44ef-b6bc-a6cb0309f3a1.5b43104b-37e9-4650-8c16-71e032e6cb7d.e1dd0809-9020-4553-ba59-1479f07f4705.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683093/Asset_5ef7a7a3-cb57-4c16-8fe4-6032d115bc04/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":2,"AUP":1898}},{"displayName":"Analytic Solver Data Mining","solutionId":"wa200000019","version":"23.1.0.0","targetType":1,"width":0,"height":0,"description":"Forecast the future, train and deploy predictive models using Data/Text Mining and Machine Learning","iconUrl":"34090.1ece6668-5136-4cbf-8b60-e7747688efc8.cfabfded-2a53-4b39-9eda-001adba2da25.c6775c6d-8ebd-4525-90d6-1304a00887d8.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683094/Asset_8b514640-453a-4c63-9e63-d0c3f2b29f37/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":-1,"AUP":851}},{"displayName":"SAP Analytics Cloud for Office","solutionId":"wa200000169","version":"1.15.0.0","targetType":1,"width":0,"height":0,"description":"Use Microsoft Excel\'s strengths to get deeper insights into your SAP Analytics Cloud data.","iconUrl":"22967.ffbd93af-2e67-49da-bff8-62f9e5029e69.9930b4d4-9fd9-4eac-8578-8c77ca3d7e15.3a9c2449-9616-45b4-83e5-2f8360c19338.png","licenseUrl":"https://hcs.cloud.sap/office/eula.html","privacyUrl":"https://www.sap.com/about/legal/privacy.html","addinInfo":{"priority":3,"AUP":2986}},{"displayName":"OrbusInfinity Import Tool","solutionId":"wa200000421","version":"2.9.0.0","targetType":1,"width":0,"height":0,"description":"Import data from Excel Workbooks to your OrbusInfinity Repository","iconUrl":"58921.df1e5367-d9bc-46a7-8259-9b24225f294e.1638f80d-c1de-4a83-96d5-4dd2012058c9.0f1a47c7-5d54-427b-be34-d415727301cc.png","licenseUrl":"https://www.orbussoftware.com/orbus-store-app-terms","privacyUrl":"https://www.orbussoftware.com/privacy-policy","addinInfo":{"priority":3,"AUP":359}},{"displayName":"Jira Cloud for Excel","solutionId":"wa200000556","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Export Jira data to Excel - Combine the power of Jira with the flexibility of Excel","iconUrl":"56884.e2ba98e8-580f-430a-a0f6-2d54d53d7762.fb12baec-4bec-40e4-8dfc-21c060e87964.7ef37c2b-d095-4918-89f1-25637b11e385.png","licenseUrl":"https://www.microsoft.com/en-us/store/standard-application-license-terms","privacyUrl":"https://www.atlassian.com/legal/privacy-policy","addinInfo":{"priority":3,"AUP":144554}},{"displayName":"Workspace Lite Add-in","solutionId":"wa200000565","version":"1.0.0.75","targetType":1,"width":0,"height":0,"description":"Build your models in Excel using LSEG\u2019s unique content and analytics","iconUrl":"29750.a3a6e343-b9d7-46ab-aad8-c0fc34c7b498.965e10e4-deeb-43e1-b9e3-5801171d8464.baa9f23e-6f54-4889-9419-35de7fe21515.png","licenseUrl":"https://download.microsoft.com/download/F/D/8/FD8BA8F2-72AF-45D9-B39E-230B26CBD39D/StandardContractMarch2019.pdf","privacyUrl":"https://www.refinitiv.com/en/policies/privacy-statement","addinInfo":{"priority":-1,"AUP":516}},{"displayName":"AI-aided Formula Editor","solutionId":"wa200001584","version":"2.6.0.0","targetType":1,"width":0,"height":0,"description":"GPT-4-powered AI features like formula generation and explanation built-in a modern Formula Editor.","iconUrl":"65260.49589048-b9b0-4c4d-9166-9853dbc8d0d0.00f729b3-2b4d-4d96-a381-52c6e940cf4e.1e8d39fe-6248-4e13-b4cc-1e61e02c196d.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.10studio.tech/privacy","addinInfo":{"priority":1,"AUP":1938}},{"displayName":"Jasperactive for Office","solutionId":"wa200002334","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Web-based learning for Microsoft Word, Microsoft Excel and for Microsoft PowerPoint.","iconUrl":"24398.0a1bdc08-ac9f-4231-8e69-4eb02a692937.a4408ec1-bba8-4f97-961d-09257a62e38a.0013100a-0ba3-4b30-b729-14bf64da59dc.png","licenseUrl":"https://jasperactive.com/end-user-license-agreement","privacyUrl":"https://jasperactive.com/privacy-policy","addinInfo":{"priority":3,"AUP":1073}},{"displayName":"XLSTAT Cloud","solutionId":"wa200002503","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Statistics and data analysis add-in.","iconUrl":"49744.000d2e73-975d-42e3-8f0f-ca360dc2cc60.8a9d0e1f-183b-4ab0-b765-b64f7b230131.6ebabbd6-be54-4fd5-8e89-3e07680d70ba.png","licenseUrl":"https://xlstat365.s3.us-east-2.amazonaws.com/legal/CLUF.pdf","privacyUrl":"https://xlstat365.s3.us-east-2.amazonaws.com/legal/PRIVACY_POLICY.pdf","addinInfo":{"priority":1,"AUP":487}},{"displayName":"PitchBook for Excel","solutionId":"wa200002663","version":"1.6.0.0","targetType":1,"width":0,"height":0,"description":"Strengthen your analysis and build better financial models using PitchBook\'s data.","iconUrl":"50447.f729f52c-6484-4a27-9fd9-9a62d0ad734b.8b8a588c-46ce-4201-bddc-3d6086c7d7f2.3d88619d-29d6-49b5-a2ba-33bb2a724d32.png","licenseUrl":"https://pitchbook.com/terms-of-use","privacyUrl":"https://pitchbook.com/privacy-policy","addinInfo":{"priority":-1,"AUP":996}},{"displayName":"FRED Data","solutionId":"wa200003692","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"Download data from the Federal Reserve Bank of St. Louis Economic Data (FRED).","iconUrl":"51797.9b2b8182-033d-4060-9ca5-866292d44261.be4b3e57-cbb1-436a-98af-42040dca76d3.1d354664-b22f-4494-a818-f28e5304fc35.png","licenseUrl":"https://fred.stlouisfed.org/fred-addin/legal.html","privacyUrl":"https://research.stlouisfed.org/privacy.html","addinInfo":{"priority":1,"AUP":324}},{"displayName":"Excel Labs, a Microsoft Garage project","solutionId":"wa200003696","version":"1.3.0.0","targetType":1,"width":0,"height":0,"description":"Try experimental features from the Microsoft Excel team.","iconUrl":"56617.70ef3bb6-fd4c-4868-b560-ed816d7473dd.47eea830-aced-47db-900a-a37347c5fdff.edeaaad8-6367-401c-9a40-138c4200c0ec.png","licenseUrl":"https://support.office.com/client/61994a3b-2c87-41c4-a88d-a6455efa362d?omkt=en-US","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":3,"AUP":1616}},{"displayName":"Spreadsheet Sync","solutionId":"wa200003784","version":"1.2.0.1","targetType":1,"width":0,"height":0,"description":"It syncs your QBO Adv data directly with Excel, enabling businesses to build customized reports ","iconUrl":"19754.85145a97-15c6-4376-9196-8515ee6dfda2.17b17ce3-53d9-4050-b1a9-cd8f6d333853.43963bbc-6904-4da7-8514-7b2e0bb7b291.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.intuit.com/privacy","addinInfo":{"priority":3,"AUP":798}},{"displayName":"ArcGIS for Excel","solutionId":"wa200004179","version":"2022.3.6.0","targetType":1,"width":0,"height":0,"description":"Discover new patterns and bring Excel data to life with maps using ArcGIS.","iconUrl":"14874.7ac80e32-4af3-4961-b3a6-2e871982b721.910edbf9-9d95-4224-a14c-7935fbbf3263.64da2c2e-9f1d-4b19-9264-dfe092cbe3eb.png","licenseUrl":"https://www.esri.com/en-us/legal/terms/master-agreement-product","privacyUrl":"https://www.esri.com/en-us/privacy/privacy-statements/privacy-statement","addinInfo":{"priority":3,"AUP":1340}},{"displayName":"Cegid Expert Connector for Excel","solutionId":"wa200004571","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Application apportant des fonctions personnalis\u00e9es pour exporter des donn\u00e9es de Cegid Expert.","iconUrl":"10618.583afe98-a839-46f6-a732-dbbf9ac8ac05.b4296dcd-6aea-4fb5-9e1d-d2a88879c875.ee35bc13-726a-4c70-8c82-dd0e375097d6.png","licenseUrl":"https://www.cegid.com/fr/cgv","privacyUrl":"https://www.cegid.com/fr/privacy-policy","addinInfo":{"priority":-1,"AUP":955}},{"displayName":"QR Code Tracker","solutionId":"wa200004687","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"QR Code Tracker lets you easily generate/scan QR codes in a sheet.","iconUrl":"35614.d62fd4d2-7872-42e1-a0c2-405317558142.c8500959-825f-4100-b3e6-c21597165a0b.f5cfa5f9-1345-4020-805c-d8345f029ae2.png","licenseUrl":"https://www.formiraex.com/QR_Code_Tracker/license.html","privacyUrl":"https://www.formiraex.com/QR_Code_Tracker/privacy-policy.html","addinInfo":{"priority":3,"AUP":340}},{"displayName":"Zebra BI Charts for Office","solutionId":"wa200004688","version":"1.0.4.0","targetType":0,"width":1000,"height":500,"description":"The most powerful charting visual in Excel & PowerPoint with a complete set of advanced charts! ","iconUrl":"9365.95df6186-f63a-4f9b-8cd5-414e80da57c8.ef9390f9-280b-4847-b1c6-c6fa272d852c.33527d56-43f3-4e84-bfe0-2bb6d2c2594d.png","licenseUrl":"https://zebrabi.com/legal/?doc=eula","privacyUrl":"https://zebrabi.com/legal/?doc=privacy-policy-visuals","addinInfo":{"priority":1,"AUP":1297}},{"displayName":"Flow | Your instant translator for the enterprise","solutionId":"wa200004858","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Access on-brand translations with Flow all across the internet","iconUrl":"21223.73dc3f42-d93e-46d2-ac41-21e4e22f1e9d.9e6a4242-8ef5-4d96-8f3e-e8dd4eebf01b.ea39d408-2aa7-45a1-bab6-3adbaca33d44.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.lengoo.com/privacy-policy","addinInfo":{"priority":-1,"AUP":58}},{"displayName":"Formula Bot | AI Formula Generation and Data Automation","solutionId":"wa200004935","version":"6.0.0.0","targetType":1,"width":0,"height":0,"description":"Revolutionize your analytics workflow, from formula generation to data automation.","iconUrl":"55472.02bef729-7dee-4518-80a6-f1201acff812.93152da9-df92-4449-86fb-7b5555756176.fa00d9a4-0225-4c45-a649-c70f05461582.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://formulabot.com/privacy-policy","addinInfo":{"priority":1,"AUP":4975}},{"displayName":"Ghostwriter","solutionId":"wa200005107","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Use ChatGPT with the CoPilot experience right within your favorite office app.","iconUrl":"33851.9a73910f-bc07-461c-a5aa-da58e2ce898e.fe022fd3-f2d4-4057-bd68-fd8ef192180a.ac2e20fb-999e-43fc-b780-f35d91b9db91.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://creativedatastudios.com/privacypolicy.html","addinInfo":{"priority":-1,"AUP":402}},{"displayName":"Sage Reporting 365","solutionId":"wa200005246","iconUrl":"40546.f88bb9d8-63aa-45c5-9857-bba65a51e0dd.6bd00930-2608-40f8-b6b9-6b9b7660abf7.8c645fcb-d1e3-4b8d-82a5-cea0150a26a3.png","targetType":1,"width":0,"height":0,"description":"Sage Reporting 365 is a Business Intelligence software providing access to your management data","version":"1.0.0.3","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://blog.infineo.online/privacy","addinInfo":{"priority":3,"AUP":41}},{"displayName":"ChatGPT for Excel","solutionId":"wa200005271","version":"2.4.4.0","targetType":1,"width":0,"height":0,"description":"Unlock the Power of Excel with AI intelligence - Chat GPT for Excel ","iconUrl":"19817.86bed75f-2814-457c-b505-403f890ae109.370b210a-a3c6-4be9-a1b5-9cd2ccfd6dc5.ff278ee8-b733-429b-b34b-9fc3b08d5bea.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://chatgptforexcel.com/privacy-policy","addinInfo":{"priority":1,"AUP":9879}},{"displayName":"Numerous.ai - ChatGPT for Excel","solutionId":"wa200005281","iconUrl":"19340.b57a7be8-416b-490a-9c58-b5567322666d.bc5fbf37-4907-473d-826c-150e0ae698aa.35f4cdd6-af50-49e7-8607-efcddc63f117.png","targetType":1,"width":0,"height":0,"description":"Use AI to generate formulas, categorize items, format cells, and perform repetitive tasks.","version":"1.0.0.0","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://numerous.ai/privacy.html","addinInfo":{"priority":1,"AUP":555}},{"displayName":"FormulAI","solutionId":"wa200005333","version":"1.0.0.2","targetType":1,"width":0,"height":0,"description":"FormulAI is a powerful Microsoft Excel formula assistant using AI.","iconUrl":"18944.a414168a-5468-4d7d-905c-6a9ff954a4a8.ad819f3c-11ba-4124-975b-22d1d3b278cc.d82fb89a-dcbe-49d9-9013-de1b3221d003.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.formulai.xyz/privacy-policy","addinInfo":{"priority":1,"AUP":123}},{"displayName":"GPT for Excel Word","solutionId":"wa200005502","version":"1.0.0.11","targetType":1,"width":0,"height":0,"description":"Use GPT AI in Excel and Word to edit, translate, explain, ask, classify, extract, summarize.","iconUrl":"57573.f9f47c4a-38c2-4ed8-b7cc-a8815cd3dcd0.c5bed181-b36c-4c88-b989-056784b5402d.c22af8d2-689f-4982-b9e1-80b025140566.png","licenseUrl":"https://static.talarian.io/gpt-in-excel/GPT_in_Excel_TOS.pdf","privacyUrl":"https://talarian.io/privacy-policy","addinInfo":{"priority":1,"AUP":25712}},{"displayName":"Supermetrics","solutionId":"WA104381807","version":"1.0.0.5","targetType":1,"width":0,"height":0,"description":"Unlock the power of your marketing data in Excel with Supermetrics","iconUrl":"19350.bb8cdc30-0a91-4002-884a-b62395c980a4.49156328-1344-48b2-b77d-a29f2fddb106.210c5e26-f550-4bf3-825d-674d9f004172.png","licenseUrl":"https://supermetrics.com/terms-of-service","privacyUrl":"https://supermetrics.com/privacy-policy","addinInfo":{"priority":3,"AUP":359}},{"displayName":"Business Assist - Forecast","solutionId":"WA200005702","version":"1.0.0.4","targetType":1,"width":0,"height":0,"description":"Reduce your organization\'s helpdesk cost by using Business Assist Forecast.","iconUrl":"14472.f9e7cd0c-b0a1-46c9-8121-703e461934bb.9bb6db57-0f7e-4365-83e3-c71dfb411640.49c33548-12d6-4184-a39c-04b1918d113e.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":3,"AUP":78}},{"displayName":"Autopilot","solutionId":"WA200005669","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Free - Use ChatGPT within Microsoft Office with a Copilot experience.","iconUrl":"63616.36723807-bf6b-458b-85d4-c6c068296f33.f8d6629a-b2a5-468d-9d29-61660784380c.50af4801-c087-475b-af11-23b4531d0479.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://ghostwriter-ai.com/privacypolicy.html","addinInfo":{"priority":3,"AUP":586}},{"displayName":"Compare and Merge for Excel","solutionId":"WA200005782","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Compare Excel data within minutes. Find and resolve differences. Save hours of manual data review.","iconUrl":"30074.934ac94e-6eb5-42e9-bd61-d950303e2383.64b35664-874b-4eea-a5c5-22b9b1dfa6fd.d9552652-5a80-4f6b-b7dc-254b48fbb5ff.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.strivetech.com/apps/excelcompareandmergeprivacy","addinInfo":{"priority":3,"AUP":135}},{"displayName":"Array Assistant","solutionId":"WA200005565","version":"1.0.1.0","targetType":1,"width":0,"height":0,"description":"Your AI Excel Assistant, Helping You Work Smarter and Faster! Try your first two weeks for Free!","iconUrl":"19248.dfd99dce-ae19-48c0-89aa-3654a01080ce.5d15e809-f4e4-42e1-813f-8235aab23209.6bb22ab5-ef1d-4810-8ad3-b0ac5496fc4e.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://arrayassistant.ai/legal","addinInfo":{"priority":3,"AUP":100}},{"displayName":"Webex","solutionId":"WA200000068","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Bring Webex messaging and collaboration to your Microsoft files.","iconUrl":"39598.b4ad1d22-0361-475d-8552-534f8374babf.520bf26d-4b81-43fa-ac63-415826cb02fb.11a6abf0-7171-48ff-8c69-26b9e338033f.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848812/Product_42949683051/Asset_46d15f2a-cf03-461d-bd9f-9633d61422c9/universalcloudagreement.pdf","privacyUrl":"https://www.cisco.com/c/en/us/about/legal/privacy-full.html","addinInfo":{"priority":3,"AUP":192}},{"displayName":"draw.io Diagrams","solutionId":"WA200000113","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Easily embed draw.io diagrams from cloud storage","iconUrl":"14142.2ec57164-ba5b-42ee-8253-ade72ca74c8d.e8efbcc8-e27f-4682-9321-eb111eb3bc68.950e1c22-0dd9-4079-807b-145ecdb6df9c.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474849055/Product_42949683254/Asset_f99133a0-53c0-4c21-905f-757b27070c6a/drawioEULATermsofServicedrawio.pdf","privacyUrl":"https://desk.draw.io/support/solutions/articles/16000096192-privacy-policy-for-draw-io-add-in-for-microsoft-office","addinInfo":{"priority":1,"AUP":797}},{"displayName":"Personalised QR Code Generator","solutionId":"WA200003220","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Quickly generate personalised, branded QR codes.","iconUrl":"1053.89a21dfa-3fde-4c6f-89e4-3eae439d83e7.67539e4a-131a-406f-a541-73c85a95eb0f.7a449688-1bb3-4511-9f43-2cc1a09edc9b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://littleappy.co/office/qr-code-generator/privacy","addinInfo":{"priority":3,"AUP":156}},{"displayName":"Microsoft PowerApps Office Add-in","solutionId":"WA104380330","version":"1.3.0.1","targetType":1,"width":0,"height":0,"description":"The Microsoft PowerApps Office Add-in enables data connections to Microsoft PowerApps systems","iconUrl":"60124.e1dfe8b1-6892-4a07-bb52-91fc1006be11.a6787a94-2200-4943-9d6a-f9efb8369662.47ff6184-6b13-4120-955b-1c285e83cbc7.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949679879/Asset_661a2a7f-2764-43c5-aef4-25bc316a1b08/DynamicsAppforOfficeSLTEnglish.pdf","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=271135","addinInfo":{"priority":2,"AUP":1249}},{"displayName":"Wikipedia","solutionId":"WA104099688","version":"1.7.0.0","targetType":1,"width":0,"height":0,"description":"Find and quote related information from Wikipedia.","iconUrl":"7450.110c9a11-7db2-4228-b768-f1ad828e16be.9bd16ea2-22ff-455c-9f92-70de827e079a.aeef7210-898b-4a79-82b5-b648805129b9.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":3,"AUP":332}},{"displayName":"Bing Maps","solutionId":"WA102957661","version":"1.6.0.0","targetType":0,"width":600,"height":600,"description":"The Bing Maps add-in makes it easy to plot locations and visualize your data through Bing Maps in Excel","iconUrl":"45.d6c30518-91f7-4e79-b846-0813b56a1b2d.75cc16b5-7155-4a84-8094-a4ae7e997116.688fcadb-9dca-414b-91d4-2075b00c2772.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":3,"AUP":13556}},{"displayName":"ChartExpo\u2122 for Excel","solutionId":"WA104380662","version":"1.0.0.7","targetType":0,"width":655,"height":390,"description":"Select a chart, select your data, and create Insightful charts without hardwork!","iconUrl":"47793.590471af-7e3e-4855-8e7f-1438a654488b.5e466c13-5861-4e47-bf0e-d6a735f06208.7800aa4f-c6b6-43bb-8099-c14624743abc.png","licenseUrl":"https://www.chartexpo.com/Home/EULA","privacyUrl":"https://www.chartexpo.com/Home/OfficeAppPrivacy","addinInfo":{"priority":-1,"AUP":697}},{"displayName":"CSV Import+Export","solutionId":"WA200000025","version":"1.0.0","targetType":1,"width":0,"height":0,"description":"Import and export CSV files on Excel.","iconUrl":"58575.082549a1-a61c-4d6a-b397-1281a6b2818d.f4f41bd6-d825-4219-af6e-da610c4a7324.1b9d835d-23bf-45b0-818d-783bef621094.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.emeditor.com/about/privacy-policy","addinInfo":{"priority":3,"AUP":858}},{"displayName":"Money in Excel","solutionId":"WA200001306","version":"2.3.0.1","targetType":1,"width":0,"height":0,"description":"Seamlessly connect your financial accounts to Excel to view and manage your finances in one place.","iconUrl":"9427.a6eaa8f8-8441-4e98-b51b-7cdc68b3ad70.1e0bd518-ace3-4c76-a4e1-5bec9f355e89.eb2dcf06-11b7-4c0c-873b-df18bf95b4fa.png","licenseUrl":"https://officepreview.microsoft.com/en-us/office-store-standard-application-license-terms-HA102821243.asp","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":-1,"AUP":0}},{"displayName":"Isograd Learning Platform","solutionId":"WA200006017","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Isograd Learning Platform is an online courseware solution for Microsoft 2019 and Microsoft 365.","iconUrl":"6539.d4a08e78-43e8-4bd4-823f-8b9bb98f71c8.358fe9da-edf0-4bd2-8f23-eabe1b2de609.79a5fd12-e871-4f4b-ad2d-e3265cff3b2c.png","licenseUrl":"https://learning.isograd.com/eula","privacyUrl":"https://learning.isograd.com/privacypolicy","addinInfo":{"priority":3,"AUP":10}},{"displayName":"Bracket Builder","solutionId":"WA200006008","version":"1.2.0.0","targetType":1,"width":0,"height":0,"description":"Build double elimination tournament brackets compatible with Little League","iconUrl":"50028.22f4f90a-426f-475a-beba-d0189799b8bd.7f3ed4ca-2f1a-436c-9839-dd7764195b7f.db54fea0-fdaf-44f7-a816-41361b822660.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://addin.red.traynrex.com/help/Privacy.html","addinInfo":{"priority":3,"AUP":3}},{"displayName":"Excel Send to Trello","solutionId":"WA200005960","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"This Excel add-in makes it easy to bulk create cards in Trello from a table.","iconUrl":"8664.52ca8fd6-95d6-47e7-b679-b9f888571bc7.5efe9dcf-a87f-4171-ac66-cb9c30b5226e.5d8ecce4-7fc8-49dd-87fd-07095c48deac.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://kryl.com/?page=/privacy","addinInfo":{"priority":3,"AUP":3}},{"displayName":"XperienceED","solutionId":"WA200005817","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Web-based, hands-on learning for Microsoft 365 Apps and Microsoft 2019.","iconUrl":"6120.0e948c8b-c5cf-4b7a-b18f-3d59a7105ce2.fcdc57d0-ecf7-430c-94c1-9742dc8a097c.af83a49b-bd1c-43a3-bf7d-9c061ec545c8.png","licenseUrl":"https://ccilearning.com/wp-content/uploads/2023/03/XperienceED-EULA-August-14-2022_clear.docx","privacyUrl":"https://jasperactive.com/privacy-policy","addinInfo":{"priority":3,"AUP":7}},{"displayName":"Green Street Add-In","solutionId":"WA200005876","version":"1.0.4.24","targetType":1,"width":0,"height":0,"description":"Enhance your investment analyses with Green Street\'s industry leading commercial real estate data ","iconUrl":"49943.bc2d4344-5f24-4610-b662-91c4934d717d.590cce90-117c-42db-baa3-83d5d7daa95f.c83b6cf7-1070-4e11-896f-53331b434c3e.png","licenseUrl":"https://www.greenstreet.com/termsofuse","privacyUrl":"https://files.greenstreet.com/public_files/GlobalPrivacyPolicy.pdf","addinInfo":{"priority":-1,"AUP":0}},{"displayName":"R2 Copilot: Private Chat GPT for Excel","solutionId":"WA200006007","version":"1.0.4.0","targetType":1,"width":0,"height":0,"description":"R2 Copilot is a privacy-centric, GPT-powered AI assistant for your everyday business communications.","iconUrl":"56225.35fd77ec-1e64-4d91-b540-7e993a97b899.736533f6-6174-46c6-9736-9d0074bc04cb.93461044-7ae6-496e-abfb-17b484279f77.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://r2copilot.ai/policy","addinInfo":{"priority":2,"AUP":252}},{"displayName":"Spreadsheet AI","solutionId":"WA200006009","version":"1.0.1.6","targetType":1,"width":0,"height":0,"description":"AI chat copilot in Excel who understands your workbook and assists with countless spreadsheet tasks.","iconUrl":"14669.7db070f8-5e86-4224-b93c-0f0447636b16.132765a9-fdd4-41f1-9c90-aa6f0d6b82dc.45c767b9-81c9-4813-a7d1-462156cc844b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.10studio.tech/docs/privacy","addinInfo":{"priority":2,"AUP":76}},{"displayName":"Widata","solutionId":"WA200005777","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"WiData is a platform seamlessly integrated into Excel to assist you in accessing all financial data","iconUrl":"42486.cf83fc97-7cc4-4fc9-a442-27252297bd9d.a3b30b83-17e9-41ef-88f3-72c47dfaee63.4eb440c2-941b-4d85-bc6f-a0c115f258ab.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.widata.vn/en/ch%C3%ADnh-s%C3%A1ch-b%E1%BA%A3o-m%E1%BA%ADt","addinInfo":{"priority":3,"AUP":25}},{"displayName":"McGraw Hill","solutionId":"WA200002270","version":"3.0.0.0","targetType":1,"width":0,"height":0,"description":"McGraw Hill tool application aimed to assist students to learn and leverage Microsoft Excel.","iconUrl":"10994.a2611ae6-e1fb-468e-9a75-4292ffd45f92.3e087ea2-0e00-40c2-9e26-d5c264f97fae.ffc523c3-0e09-439c-9422-af52e0770aff.png","licenseUrl":"https://www.mheducation.com/terms-use.html?external_browser=2","privacyUrl":"https://www.mheducation.com/privacy.html?external_browser=2","addinInfo":{"priority":-1,"AUP":176861}},{"displayName":"Web Video Player","solutionId":"WA104221182","version":"3.3.0.0","targetType":0,"width":730,"height":411,"description":"Add YouTube videos to your PowerPoint presentations or Excel spreadsheets.","iconUrl":"21223.8fa8e2cf-70f0-4b35-ab45-a587c415721d.71d26e67-e3a5-4499-af2a-87e1ada53aca.91b974c8-435a-45c4-bbc7-167fa1d34ffb.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.michael-saunders.com/videoplayer/pages/privacy.html","addinInfo":{"priority":1,"AUP":294}},{"displayName":"AP Essentials Online Reports","solutionId":"WA200004805","version":"1.2.0.0","targetType":1,"width":0,"height":0,"description":"Easily generate Excel reports of your AP Essentials documents.","iconUrl":"46463.4f2ef016-20cb-4469-89c8-91b3ed852e94.bc9b4ced-e86a-461d-bf3e-ea85bc5923db.3fc71624-1087-40f3-bdbf-d437b17759cb.png","licenseUrl":"https://www.kofax.com/legal/terms-of-service","privacyUrl":"https://www.kofax.com/Legal/Privacy","addinInfo":{"priority":-1,"AUP":225}},{"displayName":"Velixo","solutionId":"WA200002311","version":"1.2023.8.64","targetType":1,"width":0,"height":0,"description":"Excel-based reporting for your ERP. Build your own reports in less than 5 minutes!","iconUrl":"56800.9a67df19-bebd-46e1-932f-c05f1da5d162.aded0159-fc94-4c0e-922c-a61decdb9403.0ad5536a-3258-403d-8f0a-adb854889d11.png","licenseUrl":"https://www.velixo.com/eula","privacyUrl":"https://www.velixo.com/privacy-policy","addinInfo":{"priority":2,"AUP":880}},{"displayName":"Mail Merge","solutionId":"WA200006466","version":"1.0.0.2","targetType":1,"width":0,"height":0,"description":"Send personalized emails with Excel, create email drafts or schedule emails for sending later.","iconUrl":"6987.7e407018-9102-4508-a2e9-e769a41b7735.b8d24346-5fb6-49bf-b22b-7baa15ddcad8.847e5579-8358-4333-a405-47191f54a8c1.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://digitalinspiration.com/privacy","addinInfo":{"priority":2,"AUP":18}},{"displayName":"NielsenIQ Discover","solutionId":"WA200004632","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"The new NielsenIQ Discover add-In makes generating robust Excel reports faster and easier than ever.","iconUrl":"31362.41c487ba-25d8-4918-a85c-916c87cf1a6d.f8335a3c-da4c-4faa-85ef-58d1bd876169.9204b71b-9802-4510-b8d0-81455582dd72.png","licenseUrl":"https://nielseniq.com/global/en/legal/terms-of-use","privacyUrl":"https://nielseniq.com/global/en/legal/privacy-policy","addinInfo":{"priority":-1,"AUP":180}}]'}static get ack(){return'[{"displayName":"Stock Connector","solutionId":"wa104379220","version":"8.0.0.0","targetType":1,"width":0,"height":0,"description":"Link stocks, currency, & crypto prices to cells in Excel spreadsheets and update them in real time.","iconUrl":"35421.d104d786-d979-48bb-9827-1b28ac5178cf.c0696ae0-87b8-4c16-ab8c-171be18ca0a9.8dcfdc9c-2863-4fa9-905d-84ff8534af7a.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://michael-saunders.com/stocksapp/pages/privacy.html","addinInfo":{"priority":1,"AUP":1710}},{"displayName":"ChatGPT for Excel","solutionId":"wa200005271","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Unlock the power of Excel with ChatGPT intelligence.","iconUrl":"55257.86bed75f-2814-457c-b505-403f890ae109.bd03c17e-334d-4b64-b573-33cf7a68a966.65bd7d1b-46c0-4876-a3a5-d2b84c95918d.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://chatgptforexcel.com/privacy-policy","addinInfo":{"priority":1,"AUP":1541}}]'}get a3(){return z.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MosForWXPEnabled",
!1)}get bck(){return z.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PopularAddinDetailsForTestEnabled",!1)}get hzh(){return z.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddDataLcidForInsertDialogEnabled",!1)}get F$e(){return"Dev Box"===z.AFrameworkApplication.ea.Qa("StatusBarEnvironmentNameToUse")}get Nok(){return z.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RegisterPopulateCommandRefactorEnabled",
!1)}Hni(Aa){window.setTimeout(()=>{this.fyi()},Aa)}fyi(){this.I6c?h.ULS.sendTraceTag(508826715,220,50,"The 1st attempt succeeded."):(h.ULS.sendTraceTag(508826716,220,15,"the 1st attempt was timeout, trigger another try."),this.sB(0,!0))}static S_a(Aa){return 0===Aa||10===Aa}Rrb(Aa,Fb){this.oSa&&this.oSa.Rrb(Aa,Fb)}sB(Aa,Fb){this.oSa&&(!this.I6c&&Qe.S_a(Aa)&&(this.I6c=!0),this.oSa.sB(Aa,Fb))}aTc(Aa){this.oSa&&this.oSa.sxa(Aa)}RKh(Aa,Fb){return X.a.Ef().equals(Aa.solutionId,Fb.solutionId)&&X.a.Ef().equals(Aa.storeType,
Fb.storeType)}bfe(Aa,Fb){if(z.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType"))this.QAg(Aa,Fb,OSF.StoreTypeEnum.MarketPlace);else{const Ta={};Ta.callbackFunc=Aa;Ta.storeType=OSF.StoreTypeEnum.MarketPlace;Ta.fromInsertDialog=!1;Ta.refresh=Fb;this.xl.queryEntitlementDetails(Ta)}}QAg(Aa,Fb,Ta){const Eb={};Eb.callbackFunc=Aa;Eb.storeType=Ta;Eb.fromInsertDialog=!1;Eb.refresh=Fb;this.xl.queryEntitlementDetails(Eb)}invokeDdaMethod(Aa,Fb){const Ta=this.Rp(Aa.DdaMethod.ControlId);
if(Ta){if(this.gE&&this.WV){const Eb=this.Gta(Aa.DdaMethod.ControlId);Aa.DdaMethod.ControlId=Eb}Ta.invokeDdaMethod(Aa,Fb)}else this.si(ja.a.internalError,Fb)}registerDdaEventAsync(Aa,Fb,Ta,Eb,oc){(Fb=this.Rp(Fb))?Qe.nUb(Aa)?Fb.Ank(Aa,Ta,Eb,oc):this.si(ja.a.hbe,oc):this.si(ja.a.internalError,oc)}unregisterDdaEventAsync(Aa,Fb,Ta,Eb,oc){(Fb=this.Rp(Fb))?Qe.nUb(Aa)?Fb.kal(Aa,Ta,Eb,oc):this.si(ja.a.hbe,oc):this.si(ja.a.internalError,oc)}dispose(){if(!this.disposed){this.$.tm(this.de);this.fa.Nrk(this.nNc);
this.fa.Qk(this.yd);this.fa.zL(this.Ln);this.fa.Bv(this.fg);this.Ipd.detach(this);this.$.userOperationManager.kn(this.eZ);const Aa=Dd.f(this.$);null===Aa||void 0===Aa?void 0:Aa.za.yu(this.onBlockCacheItemChanged);this.dQc=this.Xf=this.ki=this.Ipd=this.Qb=null;this.BVa&&(this.BVa.dispose(),this.BVa=null);fb.a.vb(this.Jle);fb.a.vb(this.Ile);this.Bfb&&(this.Bfb.dispose(),this.Bfb=null);super.dispose();this.disposed=!0;h.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed")}}PKd(Aa){return(Aa=this.Rp(Aa))?
Aa.getDefaultIconUrl():null}xXc(Aa){if(this.rmf!==Aa){this.rmf=Aa;for(let Fb=0,Ta=this.Xf.length;Fb<Ta;Fb++){const Eb=this.Xf[Fb];Aa?Eb.ipf(!1):Eb.gmi()}this.Jle.xXc(Aa);this.Ile.xXc(Aa)}}EOi(Aa){return(Aa=this.Rp(Aa))?Aa.getDefaultDisplayName():null}si(Aa,Fb,Ta){const Eb={};Eb[Qa.a.Bf]=Aa;Eb[Qa.a.Qba]=Fb;this.yQ(451041795,Eb,void 0===Ta?!0:Ta)}Bz(Aa){const Fb={};Fb[Qa.a.Qba]=Aa;this.yQ(1237877382,Fb)}yQ(Aa,Fb,Ta){Ta=void 0===Ta?!0:Ta;const Eb=new Tc.a(Aa,0,this.$.xc,0,null),oc=Fb?Fb[Qa.a.Qba]:null;
this.Bfb&&Dd.f(this.$).isEditing&&Ob.j0h(Aa,Fb)?this.Bfb.sei(Aa,Fb):(Aa=this.$.Ia.Gb(Eb,Fb),Ta&&de.TaskExtensions.tb(Aa,Lc=>{zf.a(Lc)?this.si(ja.a.internalError,oc,!1):Lc.result||(Dd.f(this.$).isEditing?this.si(ja.a.kTb,oc,!1):this.si(ja.a.internalError,oc,!1))},this.Aa,8))}J2h(Aa){return!!this.Ssa(Fb=>Qe.getSolutionId(Fb.Bj,this.$)===Qe.getSolutionId(Aa,this.$)&&Fb.Bj.PrimaryMarketplace.MarketplaceType===Aa.PrimaryMarketplace.MarketplaceType&&Fb.Bj.PrimaryMarketplace.MarketplaceRef===Aa.PrimaryMarketplace.MarketplaceRef&&
Fb.Bj.PrimaryMarketplace.SolutionVersion===Aa.PrimaryMarketplace.SolutionVersion)}Rp(Aa){return this.Ssa(Fb=>Fb.controlId.startsWith(Aa))}oWa(Aa){let Fb=Aa;this.WV&&(Fb=this.jY(Aa));return this.Rp(Fb)}DBi(Aa){return this.Ssa(Fb=>Fb.AEa===Aa)}xBf(Aa){return this.Ssa(Fb=>Fb.qT===Aa&&!!Fb.AEa)}KBf(Aa,Fb,Ta,Eb){return this.Ssa(oc=>oc.qT===Aa&&oc.Bj.PrimaryMarketplace.MarketplaceRef.toLowerCase()===Fb.toLowerCase()&&oc.Bj.PrimaryMarketplace.MarketplaceType.toLowerCase()===Ta.toLowerCase()&&!!oc.Bj.SharedRuntime&&
!!oc.Bj.SharedRuntime.Resid&&!!Eb&&!!Eb.Resid&&oc.Bj.SharedRuntime.Resid.toLowerCase()===Eb.Resid.toLowerCase())}CLh(Aa,Fb){if(Aa=this.Rp(Aa))Aa.Ea(Fb),Aa.showHide(!0)}vVk(Aa){(Aa=this.Rp(Aa))&&Aa.showHide(!1)}BUa(Aa){var Fb;if(1!==Aa.WebExtensionType||this.$.$d&8388608&&Aa.TaskpaneVisible||this.$.$d&8388608&&!Aa.TaskpaneVisible&&pd.HelperMethods.cB(Aa)){let Ta=null;pd.HelperMethods.cB(Aa)&&(Ta=Qe.cGa(Aa,this.$),Aa.TaskpaneWidth||(Aa.TaskpaneWidth=this.nLb));const Eb=(new Hd(this,this.ki,Aa,this.webExtensionView)).mTd();
h.ULS.sendTraceTag(51263011,0,50,`DdaFacade::CreateOsfControl: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Aa.PrimaryMarketplace.SolutionId,Aa.OwnerAddinStoreType||Aa.PrimaryMarketplace.MarketplaceType,null===(Fb=Aa.AssetMarketplace)||void 0===Fb?void 0:Fb.SolutionId,null,null,Aa.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${Aa.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${pd.HelperMethods.cB(Aa)}`);Ta&&(Eb.AEa=Ta);this.Xf.push(Eb);this.LIa=null;this.Hkb(Aa.InstanceId)||
(Aa=String.format("{0}|{1}|{2}|{3}|{4}",Aa.PrimaryMarketplace.SolutionId,Aa.PrimaryMarketplace.SolutionVersion,Aa.PrimaryMarketplace.MarketplaceRef,Aa.PrimaryMarketplace.MarketplaceType,Aa.WebExtensionType),this.raiseEvent("ci",Aa))}}DXk(Aa,Fb){Aa.TaskpaneWidth=this.nLb;Aa.TaskpaneVisible=!0;const Ta={};Ta.SolutionId=Aa.PrimaryMarketplace.SolutionId;Ta.TargetType=Aa.WebExtensionType;Ta.Version=Aa.PrimaryMarketplace.SolutionVersion;Ta.StoreType=Aa.PrimaryMarketplace.MarketplaceType;Ta.StoreId=Aa.PrimaryMarketplace.MarketplaceRef;
Aa.AssetMarketplace?(Ta.AssetId=Aa.AssetMarketplace.SolutionId,Ta.AssetStoreId=Aa.AssetMarketplace.MarketplaceRef):(Ta.AssetId=null,Ta.AssetStoreId=null);Ta.Width=Aa.TaskpaneWidth;const Eb=new Hd(this,this.ki,Aa,this.webExtensionView,!0);Eb.mTd();this.Xf.push(Eb);const oc=()=>{this.W3a(Eb.controlId);this.Cf.purgeOsfControl(Eb.controlId,!1);Fb()};let Lc=null;Lc=Rf.a.instance.fK(()=>{Eb.oB&&(fb.a.vb(Lc),Lc=null,this.Cf.insertBlankControlWithErrorUX(this.C1b(Eb,Ta),oc))},100,Mf.a.Zci)}Jyd(Aa){if(Aa&&
Aa.length){var Fb=[];Aa.forEach(Ta=>{if(Ta.ContainsCustomFunctions){const Eb=Qe.cGa(Ta,this.$);this.rce.contains(Eb)||(this.rce.add(Eb),this.Vwg.push(Ta));this.J2h(Ta)||Fb.push(Ta)}});Fb.length&&this.njf(Fb)}}wlf(Aa,Fb){this.Rp(Aa.InstanceId)||(Fb=Fb(),Aa=(new Hd(this,this.ki,Aa,this.webExtensionView)).pWf(Fb),this.Xf.push(Aa),this.LIa=null)}NUk(Aa){Qe.xfb.Bb(Aa)&&Qe.xfb.pa(Aa).initializeAndShowWithTitle()}$bj(Aa){Qe.xfb.Bb(Aa)&&Qe.xfb.pa(Aa).hide()}cXi(Aa){var Fb=null;let Ta=null;const Eb=Qe.wPd(Aa,
!0);if(!Eb)return h.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),cd.Task.Va(null);const oc=this.xl.getOsfControl(Qe.getSolutionId(Eb,this.$));oc&&(Fb=oc.getManifest())&&(Ta=Fb.getSharedRuntimeForCustomFunctions("Workbook"));if(Fb=Ta&&1===Ta.LifeTime?this.KBf(Eb.PrimaryMarketplace.SolutionId,Eb.PrimaryMarketplace.MarketplaceRef,Eb.PrimaryMarketplace.MarketplaceType,Ta):this.DBi(Aa))return cd.Task.Va(Fb.controlId);const Lc=new nb.a;pd.HelperMethods.SIc(Ta)&&
(Eb.SharedRuntime=Ta);Aa=oc?oc.getNotificationParams():[];if(!Aa.length)return this.Vjf(Eb);this.VVg(Aa,()=>{de.TaskExtensions.tb(Lc.task,()=>{this.Vjf(Eb)},this.Aa,3)},()=>{});return Lc.task}SIi(Aa){Aa=Qe.wPd(Aa,!1);if(!Aa)return h.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null;let Fb=null;var Ta=this.xl.getOsfControl(Qe.getSolutionId(Aa,this.$));Ta&&(Ta=Ta.getManifest())&&(Fb=Ta.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));return pd.HelperMethods.SIc(Fb)&&
(Aa=this.KBf(Aa.PrimaryMarketplace.SolutionId,Aa.PrimaryMarketplace.MarketplaceRef,Aa.PrimaryMarketplace.MarketplaceType,Fb))?Aa.controlId:null}n5h(Aa,Fb){var Ta=Qe.wPd(Aa,!1);if(Ta){var Eb=null,oc=this.xl.getOsfControl(Qe.getSolutionId(Ta,this.$));oc&&(oc=oc.getManifest())&&(Eb=oc.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));if(pd.HelperMethods.SIc(Eb)){Ta.SharedRuntime=Eb;var Lc=Ta.PrimaryMarketplace.SolutionId;oc=Ta.PrimaryMarketplace.SolutionVersion;var Jd=OSF.OsfManifestManager.getCachedManifest(Lc,
oc);if(Jd)if(this.Rlc.Bb(Aa))Eb=this.Rlc.pa(Aa),de.TaskExtensions.tb(Eb,Od=>{(Od=Od.result)&&OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Od,Fb,this.ki.v5b)},this.Aa,3);else{var Ab={};Ab.solutionId=Lc;Ab.version=oc;Ab.storeType=Ta.PrimaryMarketplace.MarketplaceType;Ab.storeId=Ta.PrimaryMarketplace.MarketplaceRef;Ta.AssetMarketplace?(Ab.assetId=Ta.AssetMarketplace.SolutionId,Ab.assetStoreId=Ta.AssetMarketplace.MarketplaceRef):(Ab.assetId=null,Ab.assetStoreId=null);Ab.targetType=
OSF.OsfControlTarget.TaskPane;var Uc=new nb.a;Ta=de.TaskExtensions.kl();Ta=new wb.a(this.$,this,Ab,Ta);Eb=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(Lc,Eb.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(Jd,Eb,oc);Ta.createUILessSandbox(Ab,Jd,(Od,le)=>{Od&&!le?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Od,Fb,this.ki.v5b),Uc.setResult(Od)):Uc.setResult(null);this.Rlc.remove(Aa)});this.Rlc.ga(Aa,Uc.task)}}}else h.ULS.sendTraceTag(537170568,
0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")}Tdf(Aa){(Aa=this.xBf(Aa))&&(Aa.Bj.SharedRuntime||this.a3b(Aa.controlId))}a3b(Aa){(Aa=this.xBf(Aa))&&this.W3a(Aa.controlId)}Hii(Aa,Fb){if(!this.Xf||!Aa||!Fb)return!1;if(Aa.toLowerCase()===Fb.toLowerCase())return!0;let Ta=null,Eb=null;for(let oc=0,Lc=this.Xf.length;oc<Lc;oc++){const Jd=this.Xf[oc];if(Jd.ownerAddinSolutionId&&(Jd.controlId===Aa&&(Ta=Jd.ownerAddinSolutionId.toLowerCase()),Jd.controlId===Fb&&(Eb=Jd.ownerAddinSolutionId.toLowerCase()),
Ta&&Eb))break}return Ta&&Ta===Eb?!0:!1}EAh(Aa){this.Rp(Aa.InstanceId)||(Aa=new Hd(this,this.ki,Aa,this.webExtensionView),this.Xf.push(Aa),this.LIa=null)}mGg(Aa){if(this.Xf&&0<=Aa&&Aa<this.Xf.length){const Fb=this.Xf[Aa],Ta=Fb.oB;this.Xf.splice(Aa,1);this.olg(Fb);ed.DOMElementExtensions.vh(Ta)}}W3a(Aa){if(this.Xf)for(let Fb=0,Ta=this.Xf.length;Fb<Ta;Fb++)if(this.Xf[Fb].controlId===Aa){this.mGg(Fb);break}}crk(Aa){if(this.Xf){Aa=Aa.toLowerCase();for(let Fb=0,Ta=this.Xf.length;Fb<Ta;Fb++)if(Aa===this.Xf[Fb].ownerAddinSolutionId.toLowerCase()){this.mGg(Fb);
break}}}jMh(Aa){Aa.Vp&&(this.Rp(Aa.floatingObject.Bj.InstanceId)||(this.HEc(Aa.floatingObject.Bj.InstanceId)||this.dQc.push(Aa.floatingObject.Bj.InstanceId),this.BUa(Aa.floatingObject.Bj)),this.fa.isNamedObjectViewMode&&this.CLh(Aa.floatingObject.Bj.InstanceId,Aa.Zd))}XGd(Aa){return null==this.Xf?null:this.Xf.find(Fb=>1===Fb.controlType&&Gc.a.equals(Fb.qT,Aa,!0))}UX(Aa){if(Hc.EwaSettings.isChangeGateEnabled("OfficeVSO:7645729_ConsolidateFindOsfControlFromSolutionId"))return Aa=this.XGd(Aa),null===
Aa||void 0===Aa?void 0:Aa.controlId;if(this.Xf)for(let Fb=0,Ta=this.Xf.length;Fb<Ta;Fb++)if(1===this.Xf[Fb].controlType&&Gc.a.equals(this.Xf[Fb].qT,Aa,!0))return this.Xf[Fb].controlId;return null}x5f(Aa){return(Aa=this.XGd(Aa))?Aa.visible:!1}fBi(Aa){const Fb=[];if(this.Xf)for(let Ta=0,Eb=this.Xf.length;Ta<Eb;Ta++)Gc.a.equals(this.Xf[Ta].qT,Aa,!0)&&Fb.push(this.Xf[Ta].controlId);return Fb}KBi(Aa,Fb){if(!Fb||!Aa)return null;if(this.Xf)for(let Ta=0,Eb=this.Xf.length;Ta<Eb;Ta++)if(1===this.Xf[Ta].controlType&&
Gc.a.equals(this.Xf[Ta].qT,Aa,!0)&&this.Xf[Ta].Bj.SharedRuntime&&Gc.a.equals(this.Xf[Ta].Bj.SharedRuntime.Resid,Fb.Resid,!0))return this.Xf[Ta].controlId;return null}vja(Aa,Fb){Fb=void 0===Fb?null:Fb;return Aa?Fb?`${Aa}.${Fb}`:Aa:""}Wdf(Aa,Fb,Ta){if(this.LIa===Aa)return!0;this.LIa=Aa;let Eb=null,oc=!1;if(!Eb&&this.Xf)for(let Lc=0,Jd=this.Xf.length;Lc<Jd;Lc++)if(1===this.Xf[Lc].controlType&&Gc.a.equals(this.Xf[Lc].qT,Aa,!0)){let Ab=!1,Uc=!1;Fb?(Ab=!0,Uc=!!this.Xf[Lc].Bj.SharedRuntime&&Gc.a.equals(this.Xf[Lc].Bj.SharedRuntime.Resid,
Fb.Resid,!0)):Ta&&(Ab=!0,Uc=Gc.a.equals(this.Xf[Lc].Bj.SharedRuntimeId,Ta,!0));if(!Ab||Uc){Uc&&this.Xf[Lc].dA(!0);Eb=this.Xf[Lc].controlId;oc=!0;this.LIa=null;break}}Eb&&this.raiseEvent("ca",Eb);return oc}setAppRuntimeState(Aa,Fb){var Ta;if(Aa){let Eb;if((Eb=this.oWa(Aa))&&pd.HelperMethods.cB(Eb.Bj))Eb.dA(Fb),Fb&&(this.raiseEvent("ca",Aa),(null===(Ta=Eb.oB)||void 0===Ta?0:Ta.firstChild)&&(Aa=Eb.oB.firstChild.title)&&0<Aa.length&&this.Fcb.jGk(Aa));else throw h.ULS.sendTraceTag(537170565,0,50,"SetAppRuntimeState: run on non-shared runtime app."),
Error.invalidOperation(ad.a.instance.ia(2250));}else throw h.ULS.sendTraceTag(537170564,0,15,"SetAppRuntimeState: Invalid controlId."),Error.invalidOperation(ad.a.instance.ia(2251));}getAppRuntimeState(Aa){if(Aa)if((Aa=this.oWa(Aa))&&pd.HelperMethods.cB(Aa.Bj))Aa=Aa.Bj.TaskpaneVisible;else throw h.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(ad.a.instance.ia(2250));else throw h.ULS.sendTraceTag(537170562,0,15,"GetAppRuntimeState: Invalid controlId."),
Error.invalidOperation(ad.a.instance.ia(2251));return Aa}rhb(Aa,Fb){return(Aa=this.Rp(Aa))?Aa.rhb(Fb):null}Hkb(Aa){return this.Ydf(this.dQc,Aa)}HEc(Aa){return this.Ydf(this.kmf,Aa)}m2e(Aa){this.kmf.push(Aa)}JT(Aa){return(Aa=this.Rp(Aa))?Aa.Bj:null}J7d(Aa){this.raiseEvent("ekros",Aa,this)}oug(Aa){if(Aa){var Fb=this.Rp(Aa.InstanceId);Fb&&(Aa.SharedRuntime||Aa.SharedRuntimeId||(this.W3a(Fb.controlId),this.Cf.purgeOsfControl(Fb.controlId,!1)),Fb={},Fb.SolutionId=Aa.PrimaryMarketplace.SolutionId,Fb.TargetType=
Aa.WebExtensionType,Fb.Version=Aa.PrimaryMarketplace.SolutionVersion,Fb.StoreType=Aa.PrimaryMarketplace.MarketplaceType,Fb.StoreId=Aa.PrimaryMarketplace.MarketplaceRef,Aa.AssetMarketplace?(Fb.AssetId=Aa.AssetMarketplace.SolutionId,Fb.AssetStoreId=Aa.AssetMarketplace.MarketplaceRef):(Fb.AssetId=null,Fb.AssetStoreId=null),Fb.Width=Aa.TaskpaneWidth,Fb.SharedRuntimeId=Aa.SharedRuntimeId,this.X3g(Fb))}}vsa(){this.ki.vsa()}vK(Aa,Fb,Ta){this.ki.vK(Aa,Fb,Ta)}SBf(Aa,Fb){Fb=Qe.O$h(Fb);Aa=this.JT(Aa);this.ki.yxc(Aa.InstanceId,
2202,dd.a.GR,Fb)}dHd(Aa){for(let Fb=0,Ta=this.Xf.length;Fb<Ta;Fb++)this.SBf(this.Xf[Fb].controlId,Aa)}XBi(Aa,Fb){Fb=Qe.U5h(Fb);this.ki.yxc(Aa,65539,"",Fb)}$Bi(Aa,Fb,Ta){this.ki.yxc(Aa,1,Fb,Ta)}WBi(Aa,Fb){this.ki.aCi(Aa,Fb)}j5h(Aa,Fb){return[[2,1E3,"",JSON.stringify([Aa,Fb]),0,!1]]}OEc(){return!!this.Kxa&&this.Kxa.lSf()}CYh(){this.Kxa&&this.Kxa.clear()}PBf(){if(this.Kxa&&this.Kxa.lSf()){var Aa=this.Kxa.VIi();for(const Fb of Aa){Aa=this.fBi(Fb);for(const Ta of Aa)this.ki.yxc(Ta,65540,"","{}")}}}snk(Aa){this.Kxa.add(Aa)}hal(Aa){this.Kxa.remove(Aa)}Ssa(Aa){if(!this.Xf)return null;
for(const Fb of this.Xf)if(Aa(Fb))return Fb;return null}Vjf(Aa){const Fb=new nb.a,Ta=Qe.cGa(Aa,this.$);if(pd.HelperMethods.cB(Aa))h.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),this.Swg(Aa,Eb=>{Eb?(Aa.InstanceId=Eb.InstanceId,Aa.WebExtensionOsfControlType=3,Aa.TaskpaneVisible=!1,this.BUa(Aa),Fb.setResult(Aa.InstanceId)):(h.ULS.sendTraceTag(537170530,0,10,`InsertAgaveTaskPane for customfunction: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Aa.PrimaryMarketplace.SolutionId,
Aa.PrimaryMarketplace.MarketplaceType,null,null,null,Aa.PrimaryMarketplace.MarketplaceRef)} failed`),Fb.setException(Error.create("Null insert data")))});else{Qe.xfb.ga(Aa.InstanceId,new kb.a);const Eb=Qe.xfb.pa(Aa.InstanceId).Tia;this.V6h(Aa,Eb,Ta);this.Swg(Aa,null);Fb.setResult(Aa.InstanceId)}return Fb.task}V6h(Aa,Fb,Ta){this.Rp(Aa.InstanceId)||(Aa=new Hd(this,this.ki,Aa,this.webExtensionView),Aa.AEa=Ta,Aa.pWf(Fb),this.Xf.push(Aa),this.LIa=null)}Swg(Aa,Fb){const Ta=Qe.cGa(Aa,this.$);if(!this.rce.contains(Ta))this.W0b.push(Aa),
1<=this.W0b.length&&this.Twg(Aa,Fb);else if(Fb)for(const Eb of this.Vwg)if(Qe.cGa(Eb,this.$)===Ta){Fb(Eb,0);break}}Twg(Aa,Fb){let Ta=null;const Eb={};Eb.SolutionId=Qe.getSolutionId(Aa,this.$);Eb.TargetType=Aa.WebExtensionType;Eb.Version=Aa.PrimaryMarketplace.SolutionVersion;Eb.StoreType=Aa.PrimaryMarketplace.MarketplaceType;Eb.StoreId=Aa.PrimaryMarketplace.MarketplaceRef;Aa.AssetMarketplace?(Eb.AssetId=Aa.AssetMarketplace.SolutionId,Eb.AssetStoreId=Aa.AssetMarketplace.MarketplaceRef):(Eb.AssetId=
null,Eb.AssetStoreId=null);Eb.Width=Aa.TaskpaneWidth;Eb.ContainsCustomFunctions=!0;pd.HelperMethods.cB(Aa)&&(Eb.SharedRuntimeId=Aa.SharedRuntime.Resid);const oc=this.$.ma.sa;Aa=this.$.ma.sa.mc();const Lc=oc.$a(9,Aa);Lc.sharedInfo=Eb;const Jd=Uc=>{Uc=Pf.a.te(Uc.data);h.ULS.sendTraceTag(537170528,0,10,`DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: ${Vf.a.pc(Uc)}`)},Ab=Uc=>{Uc&&!sb.a(Uc)||h.ULS.sendTraceTag(537170527,0,10,`InsertAgaveTaskPane for addin ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Eb.SolutionId,
Eb.StoreType,Eb.AssetId,null,null,Eb.StoreId)} finish with errors: ${Vf.a.pc(Uc.Errors)}`);this.W0b.shift();0<this.W0b.length&&this.Twg(this.W0b[0],Fb)};if(Fb){const Uc=Od=>{const le=Od.Result;(Ta=le?le.AgaveData:null)||Fb(null,Od.Errors?Od.Errors[0].ErrorCause:5001);Fb(Ta,0)};Aa=(Od,le,ge)=>dg.h(oc,"InsertAgaveTaskpane",Lc,Wd.c(Od,Ab,Uc),Wd.b(le,Jd),ge,null,0)}else Aa=(Uc,Od,le)=>dg.h(oc,"InsertAgaveTaskpane",Lc,Wd.c(Uc,Ab),Wd.b(Od,Jd),le,null,0);nd.a(this.$.userOperationManager,Aa,Uc=>new Ac.a(519,
0,Uc,64),null)}fRk(){return this.$.Fe.get(35)}irk(Aa){Aa=this.Rp(Aa);(null===Aa||void 0===Aa?0:Aa.Cma)&&Aa.wGg()}H7d(Aa){var Fb=this.Ssa(Ta=>Qe.xZa(Ta.qT));Fb&&(Fb=this.Cf.getOsfControl(Fb.controlId))&&Fb.notifyAgave(OSF.AgaveHostAction.SendMessage,Aa)}zZf(){return!!this.Ssa(Aa=>1===Aa.controlType&&Qe.xZa(Aa.qT))}yZf(){const Aa=this.Ssa(Fb=>Qe.xZa(Fb.qT));return Aa?Aa.oB?ed.DOMElementExtensions.isVisible(Aa.oB):!1:!1}aRg(){const Aa=this.Ssa(Fb=>Qe.xZa(Fb.qT));Aa&&(Aa.dA(!0),this.raiseEvent("ca",Aa.controlId))}initialize(Aa){var {DdaEventDispatch:Fb}=
a(1624);const Ta=void 0===this.$||null===this.$||Hc.EwaSettings.Ra(234);void 0!==this.$&&null!==this.$||h.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");Ta&&h.ULS.sendTraceTag(537170524,0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.initialized);this.initialized||(Tb.WebExtensionViewService.Oa()||xf.WebExtensionView.YGb(this.$),this.fa=this.$.fa,this.ki=new Fb(this.$,this),this.$.Ul(this.de),this.fa.P3e(this.nNc),this.fa.Vk(this.yd),this.fa.LJ(this.Ln),
this.fa.au(this.fg),this.$.userOperationManager.Kp(this.eZ),Fb=Dd.f(this.$),null===Fb||void 0===Fb?void 0:Fb.za.$t(this.onBlockCacheItemChanged),this.I9f(),this.l1j(),this.lhj(),Tb.WebExtensionViewService.Oa(),Tb.DdaFacadeService.Oa()||this.$.ra.zc(35,this),this.Ipd.Ea(this),Ta&&h.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.RWe=new dd.a,Ta&&h.ULS.sendTraceTag(537170521,0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.UWe=new xd(this.$,
this.xi,this.ki),new kd(this.$,this.xi,this.ki),this.SWe=new Vd(this.$,this.xi,this.ki),this.QWe=new ub(this.$,this.xi,this.ki),this.PWe=new gc(this.$,this.xi,this.ki),this.TWe=new Fc(this.$,this.xi,this.ki),this.VWe=new Rc(this.$,this.xi,this.ki),this.WWe=new Xb(this.$,this.xi,this.ki),this.$.A2&&(this.XWe=new yd(this.$,this.xi,this.ki,this)),this.YWe=new bf(this.$,this.xi,this.ki,Aa),this.Bfb=new Ob(this,Dd.f(this.$)),Hc.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&
(this.OWe=new Zc),this.NWe=new Nb(this.$,this.xi,this.ki),this.initialized=!0,h.ULS.sendTraceTag(537170520,0,50,"DdaFacade is initialized"))}PBi(Aa){if(!this.Oza)return null;for(let Fb=0,Ta=this.Oza.length;Fb<Ta;Fb++)if(Aa.startsWith(this.Oza[Fb].WebExtensionId))return this.Oza[Fb];return null}I9f(){var Aa,Fb=this.fa;if(Fb.yc&&!this.Fac){if(Fb.workbookContext){if(this.Rld=this.$.fa.Kh.get(22),null===(Aa=Fb.workbookContext.WebExtensions)||void 0===Aa?0:Aa.length){Aa=Fb.workbookContext.WebExtensions;
Fb=!1;for(let Ta=Aa.length-1;0<=Ta;Ta--){if(!this.fa.isNamedObjectViewMode){this.dQc.push(Aa[Ta].InstanceId);if(1!==Aa[Ta].WebExtensionType){Aa.splice(Ta,1);continue}if(pd.HelperMethods.cB(Aa[Ta])&&0!==Aa[Ta].SharedRuntime.State)1===Aa[Ta].SharedRuntime.State?Aa[Ta].TaskpaneVisible=!1:2===Aa[Ta].SharedRuntime.State?Aa[Ta].TaskpaneVisible=!0:h.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");else if(!Aa[Ta].ContainsCustomFunctions&&!Aa[Ta].TaskpaneVisible&&!se.a(Aa[Ta])){Aa.splice(Ta,
1);continue}}const Eb=OSF.OsfControl.isFirstPartyStoreString(Aa[Ta].PrimaryMarketplace.MarketplaceType);if(Hc.EwaSettings.Ra(174)&&!Eb&&(Aa.splice(Ta,1),!Fb)){Fb=!0;const oc=Object(rc.d)(ld.a.resolve(Tb.BusinessBarManagerService,{xa:3}));de.TaskExtensions.tb(oc,()=>{oc.result.lh(36,null)},this.Aa,3)}Hc.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&Aa[Ta].PrimaryMarketplace&&Qe.xZa(Aa[Ta].PrimaryMarketplace.SolutionId)&&(h.ULS.sendTraceTag(537170518,0,
50,"chart task pane info stored in workbook context webextensions"),Aa.splice(Ta,1))}this.njf(Aa)}}else this.Rld=!1;this.Fac=!0}}wQf(Aa){const Fb=Dd.f(this.$),Ta=Fb.ha.ob.Wb;if(Ta&&Aa){Aa=!1;if(this.Xf)for(const Eb of this.Xf)if(Qe.xZa(Eb.qT)||Qe.Zrj(Eb.qT)||Qe.Ftj(Eb.qT)){Aa=!0;break}Aa||Fb.ha.ob.WH(Ta)}}l1j(){this.Cf&&this.fa.isNamedObjectViewMode&&this.$.la&&Cf.n(this.$.la)&&(Tb.WebExtensionViewService.Oa()?this.webExtensionView.xY?this.webExtensionView.OSb():this.webExtensionView.aw(this.Lug):
Wa.a(this.$).xY?Wa.a(this.$).OSb():Wa.a(this.$).aw(this.Lug))}njf(Aa){let Fb=null;Fb=Ta=>{const Eb=Ta.WebExtensionData,oc=Ta.IsTaskPane,Lc=Ta.RecordHandler,Jd=()=>{this.K2a.shift();0<this.K2a.length&&Fb(this.K2a[0])};if(this.UX(Eb.PrimaryMarketplace.SolutionId))Jd();else{oc&&(Eb.WebExtensionOsfControlType=1);var Ab=se.a(Eb);if(!oc||Eb.TaskpaneVisible||Ab||Eb.SharedRuntime&&0!==Eb.SharedRuntime.State||Eb.ContainsCustomFunctions){var Uc=new Hd(this,this.ki,Eb,this.webExtensionView,!oc);h.ULS.sendTraceTag(537170517,
0,50,`DdaFacade::CreateAllOsfControls: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Eb.PrimaryMarketplace.SolutionId,Eb.PrimaryMarketplace.MarketplaceType,null,null,null,Eb.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${Eb.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${pd.HelperMethods.cB(Eb)}`);Uc.mTd();pd.HelperMethods.cB(Eb)&&(Uc.AEa=Qe.cGa(Eb,this.$),Eb.TaskpaneWidth=this.nLb);Ab&&(Eb.WebExtensionToolTip="");!Hc.EwaSettings.isChangeGateEnabled("OfficeVSO:7610902_EnforceDefaultTaskpaneWidth")&&
oc&&Eb.TaskpaneVisible&&!Ab&&(Eb.TaskpaneWidth=this.nLb);this.Xf.push(Uc);var Od=this.LIa=null;Od=Rf.a.instance.fK(()=>{Uc.oB&&(fb.a.vb(Od),Od=null,Lc&&Lc(Ta,Uc),Jd())},100,Mf.a.Yci)}else Jd()}};for(let Ta=0;Ta<Aa.length;Ta++){if(Hc.EwaSettings.isChangeGateEnabled("OfficeVSO:7610902_EnforceDefaultTaskpaneWidth")){const Eb=Aa[Ta].WebExtensionType===OSF.OsfControlTarget.TaskPane,oc=se.a(Aa[Ta]);Eb&&!oc&&(Aa[Ta].TaskpaneWidth=this.nLb)}if(!this.Rp(Aa[Ta].InstanceId))if(1!==Aa[Ta].WebExtensionType)this.BUa(Aa[Ta]);
else if(!Hc.EwaSettings.Ra(52))this.IEb(Aa[Ta],Fb);else if(this.$.$d&8388608||Aa[Ta].TaskpaneVisible){const Eb={};Eb.solutionId=Aa[Ta].PrimaryMarketplace.SolutionId;Eb.version=Aa[Ta].PrimaryMarketplace.SolutionVersion;Eb.storeType=Aa[Ta].PrimaryMarketplace.MarketplaceType;Eb.storeId=Aa[Ta].PrimaryMarketplace.MarketplaceRef;Eb.targetData=Aa[Ta];this.Cf.isAddinCommandsAsync(Eb,(oc,Lc,Jd)=>{if(oc){var Ab=Jd.targetData;if(Lc)if(Eb.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())oc=Eb.storeType.toLowerCase()===
OSF.StoreType.UploadFileDevCatalog.toLowerCase(),Lc=Eb.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase(),(oc||Lc)&&pd.HelperMethods.cB(Ab)&&this.IEb(Ab,Fb);else if(Hc.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))this.c9i(Jd,Fb);else{let Uc=!1;this.bfe(Od=>{if(!Od.errorCode){if(Od.value)for(const le of Od.value){if(Uc)break;Uc=Pa.e(le[1])===Pa.e(Ab.PrimaryMarketplace.SolutionId)}Uc?pd.HelperMethods.cB(Ab)&&this.IEb(Ab,Fb):(Od={},
Od.SolutionId=Jd.solutionId,Od.Version=Jd.version,Od.StoreType=Ab.PrimaryMarketplace.MarketplaceType,Od.StoreId=Jd.storeId,Od.AssetId=null,Od.AssetStoreId=null,Od.Width=Ab.TaskpaneWidth,Od.TargetType=Ab.WebExtensionType,Ab.TaskpaneVisible=!0,this.Y0e(Od,Ab,Fb))}},!0)}else this.IEb(Ab,Fb)}else oc=Jd.targetData,h.ULS.sendTraceTag(542185164,220,15,`Judging AddinCommands failed for ${Telemetry.PrivacyRules.GetPrivacyCompliantId(oc.PrimaryMarketplace.SolutionId,oc.PrimaryMarketplace.MarketplaceType,null,
null,null,oc.PrimaryMarketplace.MarketplaceRef)} from ${oc.PrimaryMarketplace.MarketplaceType} during document loading`)})}}}c9i(Aa,Fb){let Ta=!1;this.bfe(Eb=>{const oc=Aa.targetData;if(!Eb.errorCode){if(Eb.value)for(const Lc of Eb.value){if(Ta)break;Ta=Pa.e(Lc[1])===Pa.e(oc.PrimaryMarketplace.SolutionId)}Ta?pd.HelperMethods.cB(oc)&&this.IEb(oc,Fb):(Eb={},Eb.SolutionId=Aa.solutionId,Eb.Version=Aa.version,Eb.StoreType=oc.PrimaryMarketplace.MarketplaceType,Eb.StoreId=Aa.storeId,Eb.AssetId=null,Eb.AssetStoreId=
null,Eb.TargetType=oc.WebExtensionType,Eb.Width=oc.TaskpaneWidth,oc.TaskpaneVisible=!0,this.Y0e(Eb,oc,Fb))}},!0)}IEb(Aa,Fb){const Ta={};Ta.WebExtensionData=Aa;Ta.IsTaskPane=!0;this.K2a.push(Ta);1===this.K2a.length&&Fb(Ta)}Y0e(Aa,Fb,Ta){const Eb={};Eb.ActivationInfo=Aa;Eb.WebExtensionData=Fb;Eb.IsTaskPane=!1;Eb.RecordHandler=(oc,Lc)=>{const Jd=oc.ActivationInfo;this.Cf.insertBlankControlWithErrorUX(this.C1b(Lc,Jd),()=>{this.W3a(Lc.controlId);this.Cf.purgeOsfControl(Lc.controlId,!1);this.X3g(Jd)})};
this.K2a.push(Eb);1===this.K2a.length&&Ta(Eb)}X3g(Aa){var Fb={};Fb.solutionId=Aa.SolutionId;Fb.version=Aa.Version;Fb.storeType=Aa.StoreType;Fb.storeId=Aa.StoreId;Fb.assetId=Aa.AssetId;Fb.assetStoreId=Aa.AssetStoreId;Fb.targetType=Aa.TargetType;Fb.sharedRuntimeId=Aa.SharedRuntimeId;Aa={};Aa[Na.a.YFb]=new S.a([Fb]);Aa[Na.a.j0]=3;Fb=new Tc.a($e.a.lnb,0,this.$.xc,0,null);this.$.Ia.Gb(Fb,Aa)}C1b(Aa,Fb){const Ta={};Ta.div=Aa.oB;Ta.id=Aa.controlId;Ta.solutionId=Fb.SolutionId;Ta.version=Fb.Version;Ta.storeId=
Fb.StoreId;Ta.storeType=Fb.StoreType;Ta.osfControlType=OSF.OsfControlTarget.TaskPane;return Ta}AFg(){this.Xf.forEach(this.olg);this.Xf.length=0;this.Fac=!1}xJi(Aa){const Fb=Aa.PrimaryMarketplace.MarketplaceType,Ta=Qe.getSolutionId(Aa,this.$);return Fb===OSF.StoreType.InMemory&&Ta.toLowerCase().startsWith("wa")?{solutionId:Ta,n_g:OSF.StoreType.OMEX}:{solutionId:Aa.PrimaryMarketplace.SolutionId,n_g:Fb}}Mca(Aa){var Fb;const Ta=this.xJi(Aa);return Telemetry.PrivacyRules.GetPrivacyCompliantId(Ta.solutionId,
Ta.n_g,null===(Fb=Aa.AssetMarketplace)||void 0===Fb?void 0:Fb.SolutionId,null,null,Aa.PrimaryMarketplace.MarketplaceRef)}bUk(Aa){var Fb,Ta;const Eb=Aa.Bj,oc={AssetId:null===(Fb=Eb.AssetMarketplace)||void 0===Fb?void 0:Fb.SolutionId,AssetStoreId:null===(Ta=Eb.AssetMarketplace)||void 0===Ta?void 0:Ta.MarketplaceRef,EnabledInViewMode:!0,Height:0,IsToBePersisted:!1,SolutionId:Eb.PrimaryMarketplace.SolutionId,SourceLocationOverrideResourceId:Eb.SrcLocationOverrideResourceId,StoreId:Eb.PrimaryMarketplace.MarketplaceRef,
StoreType:Eb.PrimaryMarketplace.MarketplaceType,TargetType:Eb.WebExtensionType,Version:Eb.PrimaryMarketplace.SolutionVersion,Width:Eb.TaskpaneWidth},Lc={width:Eb.TaskpaneWidth,gs:Eb.TaskpaneIconCssClass,showLoadingSpinner:Eb.ShowLoadingSpinner,focusOnIframeWhenLoaded:Eb.FocusOnIframeWhenLoaded};let Jd=oc.IsToBePersisted?0:16;const Ab=this.$.ma.sa.mc();Jd|=64;this.Rjd=!0;nd.a(this.$.userOperationManager,(Uc,Od,le)=>{var ge=this.Mca(Eb);h.ULS.sendTraceTag(507637774,0,50,`Silent Reload::showAgaveTaskpaneReload:Web Method ShowAgaveTaskpane is called, StoreType ${oc.StoreType}, StoreId ${oc.StoreId}, SolutionId ${ge}.`);
ge=this.$.ma.sa;Uc=Wd.c(Uc,this.jyg);const ze=ge.$a(9,void 0===Ab?null:Ab);ze.sharedInfo=oc;return dg.h(ge,"ShowAgaveTaskpane",ze,Uc,Od,le,Lc,0)},Uc=>new Ac.a(538,0,Uc,Jd),null)}Gjj(Aa){const Fb=Aa.Bj,Ta={AssetId:Fb.PrimaryMarketplace.SolutionId,AssetStoreId:Fb.PrimaryMarketplace.MarketplaceRef,OwnerAddinSolutionId:Fb.OwnerAddinSolutionId,OwnerAddinStoreType:Fb.OwnerAddinStoreType,Preload:Fb.Preload,SharedRuntimeId:Fb.SharedRuntimeId,SolutionId:Fb.PrimaryMarketplace.SolutionId,StoreId:Fb.PrimaryMarketplace.MarketplaceRef,
StoreType:Fb.PrimaryMarketplace.MarketplaceType,TargetType:Fb.WebExtensionType,Version:Fb.PrimaryMarketplace.SolutionVersion,Width:Fb.TaskpaneWidth},Eb=this.$.ma.sa,oc=Eb.$a(9);oc.sharedInfo=Ta;this.Rjd=!0;nd.a(this.$.userOperationManager,(Lc,Jd,Ab)=>{const Uc=this.Mca(Fb);h.ULS.sendTraceTag(507637771,0,50,`Silent Reload::insertAgaveSandboxReload:Web Method InsertAgaveTaskpane is called, StoreType ${Ta.StoreType}, StoreId ${Ta.StoreId}, SolutionId ${Uc}.`);return dg.h(Eb,"InsertAgaveTaskpane",oc,
Wd.c(Lc,this.jyg),Wd.b(Jd,Jd),Ab,null,0)},Lc=>new Ac.a(500,0,Lc,64),null)}qKg(){const Aa=[];var Fb=this.Xf.length;for(var Ta=0;Ta<Fb;Ta++){var Eb=this.Xf[Ta];if(this.gE){if(Eb.G1f&&this.osj){Aa.push(Eb);continue}const oc=se.a(Eb.Bj),Lc=3===Eb.osfControlType,Jd=0===Eb.osfControlType||4===Eb.osfControlType;oc||Lc?Eb.Bj.PrimaryMarketplace?"FA000000112"===Eb.Bj.PrimaryMarketplace.SolutionId?Aa.push(Eb):oc?this.bUk(Eb):this.Gjj(Eb):(h.ULS.sendTraceTag(507642883,0,10,"Silent Reload::ResetOsfControlAfterServerReload: PrimaryMarketplace is null."),
Aa.push(Eb)):Jd&&Aa.push(Eb)}else 0!==Eb.osfControlType&&3!==Eb.osfControlType&&4!==Eb.osfControlType||Aa.push(Eb)}Fb=!1;for(Ta=0;Ta<Aa.length;Ta++)Eb=Aa[Ta],this.W3a(Eb.controlId),!Fb&&Eb&&Eb.Bj&&(Fb=pd.HelperMethods.cB(Eb.Bj));Fb&&this.yQ(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:4});Hc.EwaSettings.Ra(355)&&de.TaskExtensions.tb(uf.GetServiceTaskFactory.Ne(this.$.ra,278,279,3),oc=>{oc&&(oc=oc.result)&&(this.$.ra.Tb(278)||this.$.ra.zc(278,oc),oc.DXf().Nxa())},this.Aa,3)}tO(){var Aa=new Pe(this.$,
this.xi,this.FLg);void 0===this.$||null===this.$?h.ULS.sendTraceTag(537170514,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):Hc.EwaSettings.Ra(234)&&h.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+(void 0===this.xi||null===this.xi));if(Aa.hPj()){const Fb=()=>{},Ta=oc=>{oc=Pf.a.te(oc.data);h.ULS.sendTraceTag(537170511,0,10,`ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: ${Vf.a.pc(oc)}.`)},
Eb=Aa.qRh();Aa=Qe.iNd(Eb);Aa|=64;this.$.userOperationManager.rK(new Ac.a(507,0,(oc,Lc,Jd)=>dg.h(this.$.ma.sa,"ExecuteRichApiRequest",this.sRh(Eb),Wd.c(oc,Fb),Wd.b(Lc,Ta),Jd,null,0),Aa))}}sRh(Aa){const Fb=this.$.ma.sa.$a(1);Fb.request=Aa;return Fb}Ydf(Aa,Fb){if(Aa)for(let Ta=0;Ta<Aa.length;Ta++)if(Gc.a.equals(Aa[Ta],Fb,!0))return!0;return!1}qQh(Aa){var Fb;const Ta={};Ta.navigationMode=OSF.OsfNavigationMode.DefaultMode;Ta.assetId=null;Ta.category=null;Ta.dataLcid=null;if(this.hzh){const Eb=null===(Fb=
this.xl)||void 0===Fb?void 0:Fb.getDataLocale();Fb=Eb?Sb.a.kN(Eb):null;null!=Fb&&(Ta.dataLcid=Fb.LCID.toString(),h.ULS.sendTraceTag(507258453,344,50,"LaunchInsertionDialog with dataLcid: {0}",Ta.dataLcid))}if(!Aa||3>Aa.length)return Ta;Aa[0]&&(Fb=parseInt(Aa[0],10),isNaN(parseInt(Fb,10))||(Ta.navigationMode=Fb));Aa[1]&&(Ta.assetId=Aa[1]);Aa[2]&&(Ta.category=Aa[2]);return Ta}lhj(){var Aa=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(Aa&&"*"!==Aa.trim()){this.BVa=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new ud(this),
Aa,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.Fe.get(2));try{this.BVa.init()}catch(Fb){try{this.BVa.dispose()}catch(Ta){}this.BVa=null;h.ULS.sendTraceTag(537170510,0,10,"EmbeddingEnpoint failed to initialize. Error message: "+Fb.message)}Aa={};Aa.a=this.$.ta.UserSessionId;Ie.logData(39,Aa)}}VVg(Aa,Fb,Ta){const Eb=Qe.CPh(Aa[0]),oc=Eb.fra,Lc=Eb.fsa;Eb.fra=()=>{oc&&oc();const Jd=Eb.MYa!==OSF.InfoType.Error?Fb:null;Aa.shift();Aa.length?this.VVg(Aa,Jd,Ta):Jd&&Jd()};Eb.fsa=
()=>{Lc&&Lc();Ta&&Eb.MYa!==OSF.InfoType.Error&&Ta()};eb.a.Fse(Eb)}OSi(){const Aa={};Aa.Application=z.AFrameworkApplication.ea.Qa("Application");Aa.UICulture=z.AFrameworkApplication.ea.Qa("UICulture");Aa.AddinRibbonControlsOverriddenByApi=Hc.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();Aa.AddinActionDefinitionHybridMode=Hc.EwaSettings.Ra(556).toString();Aa.UseActionIdForUILessCommand=Hc.EwaSettings.Ra(559).toString();Aa.AllowStorageAccessByUserActivationOnIFrame=
Hc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();Aa.RequirementSetRibbonApiOnePointTwo=Hc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();Aa.flightingTreatmentVariables=z.AFrameworkApplication.ea.WNb;Aa.ShortcutInfoArrayInUserPreferenceData=Hc.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();Aa.DisabledChangeGates=
z.AFrameworkApplication.ea.Qa("DisabledChangeGates");Aa.SdxIsEnabled=z.AFrameworkApplication.ea.ka("SdxIsEnabled");Aa.DmsSdxListWorkbook=z.AFrameworkApplication.fqf;Aa.AddinDevicePermissionAllowList=z.AFrameworkApplication.ea.Qa("AddinDevicePermissionAllowList");return Aa}static get PJb(){return Qe.GJe}static set PJb(Aa){Qe.GJe=Aa}static getSolutionId(Aa){let Fb=Aa.PrimaryMarketplace.SolutionId;Hc.EwaSettings.Ra(261)&&Aa.OwnerAddinSolutionId&&(Fb=Aa.OwnerAddinSolutionId);return Fb}static iNd(Aa){return Aa.RequestFlags&
1&&256!==(Aa.RequestFlags&256)?0:16}static cGa(Aa,Fb){Fb=Qe.getSolutionId(Aa,Fb);return Qe.DHf(Fb,Aa.PrimaryMarketplace.SolutionVersion,Aa.PrimaryMarketplace.MarketplaceType,Aa.PrimaryMarketplace.MarketplaceRef)}static O$h(Aa){return JSON.stringify({["recording"]:Aa})}static U5h(Aa){const Fb={};Fb.visibility=Aa?"Visible":"Hidden";return JSON.stringify(Fb)}static dOi(Aa){const Fb=Aa.getSolutionId(),Ta=Aa.getVersion(),Eb=Aa.getStoreType();Aa=Aa.getStoreId();return Qe.DHf(Fb,Ta,Eb,Aa)}static DHf(Aa,
Fb,Ta,Eb){return String.format("{0}|{1}|{2}|{3}|{4}|||","2",Aa,Fb,Qe.R1i(Ta).toString(),Eb)}static wPd(Aa,Fb){var Ta=Aa.split("|");if(7>Ta.length)return h.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==Ta[0])return h.ULS.sendTraceTag(537170508,0,10,`DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='${Ta[0]}'.`),null;let Eb=Ta[1];const oc=Ta[2],Lc=Qe.S1i(Ta[3]),Jd=Ta[4];Ta=Ta[5];Eb&&Eb.length||(Eb=
Ta);Ta={};Ta.InstanceId=String.format("{{{0}}}",J.a.create().toString());Ta.WebExtensionOsfControlType=4;Ta.WebExtensionType=1;Ta.PrimaryMarketplace={};Ta.PrimaryMarketplace.SolutionId=Eb;Ta.PrimaryMarketplace.SolutionVersion=oc;Ta.PrimaryMarketplace.MarketplaceRef=Jd;Ta.PrimaryMarketplace.MarketplaceType=Lc;Ta.ContainsCustomFunctions=Fb?!0:!1;Fb&&(Ta.OsfPropertyBag=[["customFunctionAddinId",Aa]]);return Ta}static S1i(Aa){Aa=parseInt(Aa,10);return Aa===OSF.StoreTypeEnum.MarketPlace?OSF.StoreType.OMEX:
Aa===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:Aa===OSF.StoreTypeEnum.SPApp?OSF.StoreType.SPApp:Aa===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:Aa===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:Aa===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:Aa===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:Aa===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:Aa===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:Aa===OSF.StoreTypeEnum.UploadFileDevCatalog?
OSF.StoreType.UploadFileDevCatalog:Aa===OSF.StoreTypeEnum.WopiCatalog?OSF.StoreType.WopiCatalog:null}static R1i(Aa){return Aa===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:Aa===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:Aa===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:Aa===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:Aa===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:Aa===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:Aa===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:
Aa===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:Aa===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:Aa===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:Aa===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1}mEa(Aa){const Fb={};Fb.Version=Aa.version;Fb.AssetId=Aa.assetId;Fb.AssetStoreId=Aa.assetStoreId;Fb.StoreType=Aa.storeType;Fb.Height=Aa.height;Fb.SolutionId=Aa.solutionId;Fb.StoreId=Aa.storeId;Fb.TargetType=Aa.targetType;Fb.Width=
1===Fb.TargetType?0:Aa.width;Fb.SharedRuntimeId=Aa.sharedRuntimeId;this.a3&&Aa.titleId&&(Fb.titleId=Aa.titleId,Fb.isMetaosInstall=!0);return Fb}static nUb(Aa){return Aa===OSF.DDA.EventDispId.dispidSettingsChangedEvent||Aa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||Aa===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Aa===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||Aa===OSF.DDA.EventDispId.dispidRichApiMessageEvent||Aa===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||
Aa===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||Aa===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static CPh(Aa){return Object(d.a)(new Je.a,{MYa:Aa.infoType,id:Aa.id,title:Aa.title,description:Aa.description,buttonText:Aa.buttonTxt,fra:Aa.buttonCallback,dDc:Aa.highPriority,fsa:Aa.dismissCallback,errorCode:Aa.errorCode,xVf:Aa.iframeNotificationUrl})}static xZa(Aa){let Fb="FA000000014"===Aa;Fb||(Fb="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===Aa);return Fb}static Zrj(Aa){return"FA000000005"===
Aa}static Ftj(Aa){return"FA000000064"===Aa}}Qe.xfb=new B.a;Qe.GJe=!0;Qe.LAe=!0;Object(c.a)(Qe,"DdaFacade",tb.a,[214,317,315,318,319,4])},964:function(y,r,a){a.d(r,"a",function(){return b});y=a(0);var c=a(42);class b{static get RLj(){return b.DSe||(b.DSe={["-2002156328"]:b.igf,["-1954750170"]:b.zNf,["317650254"]:b.z_h,["-1005263101"]:b.Lkj,["1353664579"]:b.tFk,["159671765"]:b.Mkj,["1446690022"]:b.GHf,["1150069548"]:b.m2c,["-1409306331"]:b.Qcf,["338507772"]:b.Qmf,["-457159301"]:b.P9j,["-1037701970"]:b.yci,
["-1893322318"]:b.Qkj,["965579896"]:b.Aci,["93287890"]:b.zci,["358088857"]:b.YIk,["-1223650923"]:b.Qmf,["2007306190"]:b.fWh,["1549955423"]:b.n$e,["-1275974171"]:b.Pkj,["382101082"]:b.H8j,["-898776235"]:b.wOj,["335464256"]:b.oOj,["1677378049"]:b.Okj,["-261992848"]:b.Z$k,["-980820954"]:b.n$e,["-931375837"]:b.G8j,["929186550"]:b.Mki,["-982144310"]:b.Sgk,["-785741187"]:b.Jkj,["2125217573"]:b.Skj,["299124955"]:b.Kkj,["1669853884"]:b.oBk,["-1515932330"]:b.A_h,["314621024"]:b.rEi,["-300049690"]:b.jWh,["14766835"]:b.wOk,
["-1251992761"]:b.yqf,["-2087635043"]:b.invalidOrTimedOutSession,["2100961153"]:b.invalidOrTimedOutSession,["-1218744139"]:b.invalidSheetName,["-1468309555"]:5006,["-315732528"]:b.invalidOrTimedOutSession,["611268539"]:b.invalidOrTimedOutSession,["1531005923"]:5006,["1593924569"]:5006,["299476328"]:b.ZRa,["49173765"]:b.ZRa,["-907155566"]:b.ZRa,["-1201603824"]:b.ZRa,["1541165282"]:b.ZRa,["-1347753427"]:b.ZRa,["134912532"]:b.ZRa,["1780971550"]:b.responsePayloadSizeLimitExceeded})}static XDf(f){return c.a.Mq(b.RLj,
f.toString(),b.internalError)}}b.success=0;b.igf=1E3;b.zNf=1001;b.z_h=1002;b.Lkj=1003;b.tFk=1004;b.Mkj=1005;b.GHf=1008;b.bBf=1009;b.invalidSheetName=1014;b.m2c=2E3;b.Qcf=2001;b.Qmf=2002;b.P9j=2003;b.yci=2004;b.Qkj=2005;b.Aci=2007;b.zci=2008;b.YIk=2009;b.fWh=2014;b.lFk=3E3;b.n$e=3002;b.Pkj=3004;b.H8j=3005;b.wOj=3006;b.oOj=3007;b.Okj=3008;b.Z$k=3009;b.G8j=3010;b.wOk=4002;b.hbe=5E3;b.internalError=5001;b.yqf=5002;b.kTb=5004;b.hbl=5007;b.Wej=5008;b.AJg=5011;b.invalidOrTimedOutSession=5012;b.L4c=5016;
b.ZRa=5102;b.Oxk=5103;b.responsePayloadSizeLimitExceeded=5104;b.AVh=7001;b.cZg=7002;b.Mki=8E3;b.Sgk=8001;b.Jkj=8010;b.Skj=8011;b.Kkj=8012;b.oBk=8020;b.A_h=8021;b.rEi=8022;b.jWh=8023;b.wLj=11E3;b.mPj=11001;b.Rkj=11002;b.DSe=null;Object(y.a)(b,"DdaErrorIds",null,[])},965:function(y,r,a){a.d(r,"a",function(){return f});y=a(0);var c=a(15),b=a(90);class f{constructor(){this.Ahe=0;this.P3={};this.bEa={}}lXi(k,x){return this.P3[f.Wsd(k,x)]}Osf(k,x){x||void 0!==this.bEa[k]&&null!==this.bEa[k]?x&&void 0!==
this.bEa[k]&&null!==this.bEa[k]&&delete this.bEa[k]:this.bEa[k]=1}Zmc(k){return void 0===this.bEa[k]||null===this.bEa[k]}UQf(k){const x=f.Wsd(k.messageType,k.targetId);1===k.actionType?this.O9i(k.controlId,k.messageType,x):2===k.actionType&&this.P$i(k.controlId,k.messageType,x)}Aqk(k){if(k){var x=Object.keys(this.P3);if(!(void 0===x||null===x||0>=x.length))for(const d of x)x=this.P3[d],x[k]&&(delete x[k],Object.keys(x).length||delete this.P3[d])}}HQ(k,x){k=f.Wsd(k,x);k=this.P3[k];return!!k&&0<Object.keys(k).length}Raj(){return!b.a.isEmpty(this.P3)}u5f(){return 0<
this.Ahe}kQi(){const k=[],x=this.P3;for(const n in x){var d=n,h=x[n];for(const m in h){h=m;const u={};u.eventType=parseInt(d.split("#")[0],10);u.targetId=d.split("#")[1];u.addinId=h;k.push(u)}}return k}O9i(k,x,d){if(this.P3[d])d=this.P3[d],d[k]=d[k]?d[k]+1:1;else{const h={};h[k]=1;this.P3[d]=h}100===x&&this.Ahe++}P$i(k,x,d){if(this.P3[d]){const h=this.P3[d];if(k){const n=h[k];1===n?(delete h[k],Object.keys(h).length||delete this.P3[d]):h[k]=n-1;100===x&&this.Ahe--}else c.ULS.sendTraceTag(537170459,
0,50,`The OsfControl[${k}] doesn't register event with key[${d}].`)}else c.ULS.sendTraceTag(537170460,0,50,`The event with key[${d}] that will be unregistered doesn't exist.`)}static Wsd(k,x){return String.format("{0}#{1}",k,x)}}f.GR="Workbook";Object(y.a)(f,"RichApiEventRegistration",null,[])},966:function(y,r,a){a.d(r,"a",function(){return c});y=a(0);class c{}c.generalException="GeneralException";c.invalidArgument="InvalidArgument";c.notImplemented="NotImplemented";c.accessDenied="AccessDenied";
c.J6f="ItemNotFound";c.notSupported="NotSupported";c.xmc="ApiNotAvailable";c.Chg="NotAllowed";c.ebe="OperationCancelled";c.S$b="UserNotSignedIn";c.Zwb="UserAborted";c.kbl="UnsupportedUserIdentity";c.Bkb="InvalidResourceUrl";c.Akb="InvalidGrant";c.YGh="AddinIsAlreadyRequestingToken";c.yzk="ResourceNotAllowed";c.bqc="ClientError";c.serverError="ServerError";c.y3h="ControlIdNotFound";c.yAk="RibbonApiNotAvailable";c.hostRestartNeeded="HostRestartNeeded";c.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";
Object(y.a)(c,"ErrorCodes",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.agave.js.map/b6a64cd3f185b186e4e6a13444bc473a/EwaTS.agave.js.map