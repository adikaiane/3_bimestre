'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1578:function(y,r,a){r=a(490);a=a(1579);a=a.Di?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);r(a,{insert:"head",Oj:!1});y.exports=a.Fk||{}},1579:function(y,r,a){r=a(489)(!1);r.push([y.i,".ewa-insertpt-dlg-input{position:relative;width:50%;padding-left:3px}.ewa-insertpt-dlg-label{margin-left:50px;margin-right:5px}.ewa-insertpt-label{vertical-align:text-top}.ewa-insertpt-dlg-sourceRange{white-space:nowrap}",
""]);y.exports=r},1580:function(y,r,a){r=a(490);a=a(1581);a=a.Di?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);r(a,{insert:"head",Oj:!1});y.exports=a.Fk||{}},1581:function(y,r,a){r=a(489)(!1);r.push([y.i,'.ewa-ptsp-pane{background:#edebe9;height:100%;display:flex;flex-direction:column;overflow:hidden}.ewa-ptsp-header{position:relative;overflow:hidden;padding:16px;background:#edebe9}.ewa-ptsp-title{position:relative;display:inline-block;text-overflow:ellipsis;overflow:hidden;height:22px;font-weight:400;font-size:16px;color:#252423;font-family:"Segoe UI Semibold","Segoe UI Web Semibold","Arial Semibold","Verdana Semibold","sans-serif Semibold";background:#edebe9}.ewa-ptsp-body{background:#edebe9;padding:0 16px;height:100%;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;overflow-y:auto;overflow-x:hidden}.ewa-ptsp-close-button{display:inline-block;padding:1px;font-size:16px}.ewa-filterconnections-dlg-hr{margin:8px -14px 0 -14px;border:none;height:1.5px;background-color:#e1e1e1}.ewa-filterconnections-dlg-table{border-spacing:1px}.ewa-filterconnections-dlg-table thead tr{display:block;cursor:default;pointer-events:none}.ewa-filterconnections-dlg-table tbody{border:1px solid #e1e1e1;display:block;max-height:120px;overflow-y:auto}.ewa-filterconnections-dlg-table td{text-align:left;width:100px}.ewa-filterconnections-dlg-table tbody tr{display:block}.ewa-filterconnections-dlg-level{width:20px}.ewa-filterconnections-dlg-column{width:100px}',
""]);y.exports=r},1582:function(y,r,a){r=a(490);a=a(1583);a=a.Di?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);r(a,{insert:"head",Oj:!1});y.exports=a.Fk||{}},1583:function(y,r,a){r=a(489)(!1);r.push([y.i,'.ewa-pqtp-pane{height:100%;display:flex;flex-direction:column;overflow:hidden;background-color:#f5f5f5}.ewa-pqtp-header{position:relative;overflow:hidden;padding:16px}.ewa-pqtp-title{height:22px;display:inline-block;color:#252423;font-size:16px;font-family:"Segoe UI Semibold","Segoe UI Web",Arial,Verdana,sans-serif}.ewa-pqtp-body{height:100%;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;overflow-x:hidden;overflow-y:auto}.ewa-pqtp-close-button{height:22px;width:22px;color:#252423;display:inline-block}.ewa-pqtp-close-button .clip16x16{top:2px;left:2px}',
""]);y.exports=r},229:function(y,r,a){a.r(r);var c={};a.r(c);a.d(c,"BIExploreCommandHandler",function(){return K});var b={};a.r(b);a.d(b,"BIExploreManager",function(){return nb});var f={};a.r(f);a.d(f,"DataRefreshCommandHandler",function(){return wb});var k={};a.r(k);a.d(k,"DataRefreshManager",function(){return fe});var x={};a.r(x);a.d(x,"DeletePivotTableWebMethodActivity",function(){return Kb});var d={};a.r(d);a.d(d,"FieldListCommandHandler",function(){return qd});var h={};a.r(h);a.d(h,"FieldListRequestStateManager",
function(){return Hd});var n={};a.r(n);a.d(n,"FieldManagerPane",function(){return Rc});var m={};a.r(m);a.d(m,"InsertPivotTableCommandHandler",function(){return Kf});var u={};a.r(u);a.d(u,"InsertSlicerCommandHandler",function(){return ad});var l={};a.r(l);a.d(l,"OfferPowerBiTrialActivity",function(){return Ib});var t={};a.r(t);a.d(t,"PivotCommandHandler",function(){return Lc});var e={};a.r(e);a.d(e,"PivotTableSettingsPaneManager",function(){return Uc});var w={};a.r(w);a.d(w,"PowerQueryPaneCommandHandler",
function(){return Dc});var z={};a.r(z);a.d(z,"PowerQueryManager",function(){return Sd});var E={};a.r(E);a.d(E,"PowerQueryUIFlowManager",function(){return Cb});var M=a(0),G=a(65),A=a(5),N=a(67);Object(G.b)(A.BIExploreCommandHandlerService)(async qa=>{qa=await G.a.resolve(A.BIExploreManagerService,qa);await qa.j1k;return new K(qa)});class K{constructor(qa){this.jHb=qa}gd(qa,qb){if(1529658657===qb&&(8===qa||!this.jHb.Awj))return!0;1247109494!==qb&&-498523270!==qb||this.jHb.Dy();return!1}executeCommand(qa,
qb){this.jHb.rSk?this.jHb.$Dk(3===qb.method):this.jHb.Dy();return N.Task.Va(!0)}Rc(qa,qb){return 1529658657===qb.command}td(){return!1}}Object(M.a)(K,"BIExploreCommandHandler",null,[29]);var I=a(133),L=a(15),J=a(599),B=a(91),Y=a(154),U=a(93),O=a(49),C=a(306),X=a(309),S=a(16),ea=a(1002),Oa=a(60);class Ha{}Ha.zpi="ewa-bix-ltr";Ha.Api="ewa-bix-rtl";Ha.Dpi="ewa-bix-titlebar";Ha.Bpi="ewa-bix-subtitle";Ha.Cpi="ewa-bix-title";Ha.Puf="ewa-bix-close";Ha.H0="clip16x16";Ha.spi="ewa-bix-body";Ha.xpi="ewa-bix-drilldetails";
Ha.upi="ewa-bix-DrillButton";Ha.ypi="ewa-bix-hover";Ha.vpi="ewa-bix-DrillLabel1";Ha.wpi="ewa-bix-DrillLabel2";Ha.Epi="ewa-bixfl";Ha.Quf="ewa-bixfl-NoFocus";Ha.Hpi="ewa-bixfl-ItemSelected";Ha.Fpi="ewa-bixfl-Icon";Ha.Gpi="ewa-bixfl-Item";Ha.tpi="ewa-bix-calloutBackground";Ha.uFa="ewa-ipad";Object(M.a)(Ha,"CssClassNames",null,[]);var Za=a(20),fa=a(7),la=a(61),ba=a(32),aa=a(267),oa=a(17),Na=a(71),Ia=a(13),Sa=a(25),Pa=a(217);class za extends aa.a{constructor(qa,qb,bc,R,cb,zb){super(qb);this.KCd=["bix-drill-action-down",
"bix-drill-action-up","bix-drill-action-to"];this.osc=-1;this.QFa=this.mMb=this.lMb=this.nMb=null;this.Hd=V=>{const Ea=this.domElement;let pb=V.target;for(;pb!==Ea;){if(pb.id.startsWith("bix-drill-action")){this.drillTo(this.osc,pb.id);Na.g(V);break}pb=pb.parentNode}};this.Asg=(V,Ea)=>{V=-1===this.osc;const pb=Ea.Bcj;this.osc=pb;let Jb=null;pb===this.o$e.HierarchyId?(this.IQg(!1),this.drillUp||this.drillDown?(this.JQg(!0),oa.DOMElementExtensions.setVisible(this.domElement,!0),Jb=this.lMb||this.nMb):
oa.DOMElementExtensions.setVisible(this.domElement,!1)):(this.JQg(!1),Jb=this.mMb,za.kJk(Jb,Ea.caption,Ia.a.instance.ia(1195)),this.IQg(!0),oa.DOMElementExtensions.setVisible(this.domElement,!0));V||this.$Qg(Jb)};this.$=qa;this.aD=bc;this.o$e=R.Context;qa=R.DrillContext;this.drillUp=qa.DrillUp;this.drillDown=qa.DrillDown;this.XRd=cb;this.vP=zb;cb.tFh(this.Asg);this.o7h()}dispose(){this.XRd&&this.XRd.$tk(this.Asg);this.KCd=this.nMb=this.lMb=this.mMb=this.QFa=this.vP=this.drillUp=this.drillDown=this.o$e=
this.aD=this.vP=this.XRd=this.$=null;super.dispose()}focus(){this.setFocus(!0)}hasFocus(){var qa=oa.DOMElementExtensions.kv(this.domElement);if(!qa)return!1;qa=qa.id;return!!qa&&qa.startsWith("bix-drill-action")}onKeyDown(qa){const qb=qa.keyCode;qa=qa.shiftKey;if(this.hasFocus()){let bc=!1;13===qb?(this.drillTo(this.osc,this.QFa.id),bc=!0):9===qb&&((bc=this.moveFocus(!qa))||this.Xnf());return bc}return 9===qb?this.setInitialFocus(!qa):!1}setFocus(qa){return this.hasFocus()?this.moveFocus(qa):this.setInitialFocus(qa)}o7h(){oa.DOMElementExtensions.FG(this.domElement,
fa.a.fnc,null,null);let qa;let qb;if(this.drillDown){qa=Ia.a.instance.ia(1197);var bc=this.drillDown.Caption;qb=String.format("{0} ({1})",qa,bc?ba.a.bkb(bc):"");bc=bc?ba.a.$l(bc):"";this.domElement.appendChild(this.Cyd("bix-drill-action-down",qb,"bixdddl_1",qa,"bixdddl_2",bc))}this.drillUp&&(qa=Ia.a.instance.ia(1196),bc=this.drillUp.Caption,qb=String.format("{0} ({1})",qa,bc?ba.a.bkb(bc):""),bc=bc?ba.a.$l(bc):"",this.domElement.appendChild(this.Cyd("bix-drill-action-up",qb,"bixddul_1",qa,"bixddul_2",
bc)));this.domElement.appendChild(this.Cyd("bix-drill-action-to","","bixddtl_1",Ia.a.instance.ia(1195),"bixddtl_2",""));this.nMb=this.getElementById("bix-drill-action-up");this.lMb=this.getElementById("bix-drill-action-down");this.mMb=this.getElementById("bix-drill-action-to");this.Dd.Ea("click",this.Hd);this.domElement.setAttribute(fa.a.Xaa,"");oa.DOMElementExtensions.setVisible(this.domElement,!1)}Cyd(qa,qb,bc,R,cb,zb){const V=document.createElement("button");V.id=qa;V.classList.add(Ha.upi);V.tabIndex=
-1;V.title=qb;V.style.display=Pa.a.none;V.onkeyup=()=>!1;V.onkeypress=()=>!1;V.setAttribute(fa.a.Ae,fa.a.Qqd);V.setAttribute(fa.a.EP,bc+" "+cb);qa=document.createElement("div");qa.id=bc;qa.classList.add(Ha.vpi);qa.textContent=R;bc=document.createElement("div");bc.id=cb;bc.classList.add(Ha.wpi);bc.textContent=zb;V.appendChild(qa);V.appendChild(bc);return V}drillTo(qa,qb){let bc;switch(qb){case "bix-drill-action-up":bc=this.drillUp.Id;break;case "bix-drill-action-down":bc=this.drillDown.Id;break;case "bix-drill-action-to":bc=
1;break;default:return}Sa.f(this.$).Bu(!0);this.vP.H0h((R,cb,zb)=>{var V=this.aD,Ea=this.$.ma.sa,pb=V.confirmationRequiredForDataOps,Jb=bc;V=la.M(Ea,V.Rw,V.externalSourceIndex,this.aD.mZ);V.requiresConfirmation=pb;V.hierarchyId=qa;V.levelId=Jb;return la.h(Ea,"BixDrill",V,R,cb,zb,null,0)})}moveFocus(qa){let qb=0;if(this.QFa)switch(this.QFa.id){case "bix-drill-action-down":qb=0;break;case "bix-drill-action-up":qb=1;break;case "bix-drill-action-to":qb=2}return this.TRg(qa?qb+1:qb-1,qa)}Xnf(){const qa=
this.QFa;qa&&(qa.blur(),this.domElement.setAttribute(fa.a.Xaa,""));this.QFa=null}IQg(qa){this.mMb&&oa.DOMElementExtensions.setVisible(this.mMb,qa)}JQg(qa){this.nMb&&oa.DOMElementExtensions.setVisible(this.nMb,qa);this.lMb&&oa.DOMElementExtensions.setVisible(this.lMb,qa)}$Qg(qa){qa!==this.QFa&&this.Xnf();if(!qa)return!1;qa.tabIndex=0;oa.DOMElementExtensions.setFocus(qa);this.domElement.setAttribute(fa.a.Xaa,qa.id);this.QFa=qa;return!0}setInitialFocus(qa){return this.TRg(qa?0:this.KCd.length-1,qa)}TRg(qa,
qb){const bc=this.KCd;for(;0<=qa&&qa<bc.length;){const R=oa.DOMElementExtensions.getElementById(this.domElement,bc[qa]);if(R&&oa.DOMElementExtensions.isVisible(R))return this.$Qg(R);qa=qb?qa+1:qa-1}return!1}static kJk(qa,qb,bc){bc=String.format("{0} ({1})",bc,qb);qa.setAttribute("title",bc);qa.lastChild.innerText=qb}}Object(M.a)(za,"BixDrillDetails",aa.a,[]);var wa=a(286),db=a(39),Ba=a(42),Ka=a(241),da=a(64),sa=a(195);const mb=Ha.Gpi,Ma=Ha.Hpi;class hb{constructor(qa,qb,bc,R,cb){this._element=null;
this.E5=this.visible=!0;this.fieldListSelector=qa;this.r8c=qb.Name||"";this.clientId=qb.ClientId;this.UPa=qb.IsCollapsible;this.parentId=qb.ClientParentId;this.csh=qb.PivotCacheIndex;this.type=qb.TypeTag;this.S9g=qb.UserRank;this.qdj=bc;this.gmf=R;this.Sbi=cb;this.fieldListSelector.WBh(this.clientId,this);this.children=[];qb.Children.forEach(zb=>{this.children.push(new hb(qa,zb,bc,R,cb))})}get caption(){return this.r8c}get element(){return this._element||(this._element=this.fieldListSelector.getElementById(hb.Xqb+
this.clientId))}get Jaj(){return-1!==this.parentId}get isCollapsed(){return this.E5}get isCollapsible(){return this.UPa}get isVisible(){return this.visible}get bxg(){return this.csh}dispose(){this.children&&(B.a.xd(this.children),this.children=null);this._element=null}jgf(){for(const qa of this.children)qa.visible=!1,qa.UPa&&(qa.E5=!0,qa.ZSg(),0<qa.children.length&&qa.jgf())}E7e(qa,qb){this.visible=!qa;var bc=11*qa,R=document.createElement("div");if(this.UPa){this.E5=!0;R.id=this.pGa(hb.Myg);R.classList.add(Ha.Fpi);
R.setAttribute(sa.a.style,this.SJf(bc+4));bc=document.createElement("div");bc.classList.add(Za.a.H0);var cb=document.createElement("img");cb.id=this.pGa(hb.pde);cb.classList.add(this.gmf);cb.setAttribute(fa.a.Ae,fa.a.cu);cb.src=da.a.Lh(9);bc.appendChild(cb);R.appendChild(bc)}else R.setAttribute(sa.a.style,this.SJf(bc+23));bc=document.createElement("span");bc.id=this.pGa(hb.Oyg);bc.textContent=this.r8c;cb=document.createElement("div");cb.id=this.pGa(hb.Xqb);cb.classList.add(mb);cb.tabIndex=-1;cb.title=
this.r8c;cb.setAttribute(fa.a.Ae,fa.a.Vqd);cb.setAttribute(fa.a.GP,this.pGa(hb.Oyg));cb.setAttribute(fa.a.Nha,"false");cb.setAttribute(fa.a.x8e,qa+1);this.UPa&&(cb.setAttribute(fa.a.Mha,"false"),cb.setAttribute(fa.a.hnc,this.pGa(hb.Nyg)));const zb=document.createElement("table");zb.setAttribute(sa.a.cellSpacing,0);zb.setAttribute(sa.a.cellPadding,0);zb.setAttribute(fa.a.Ae,fa.a.cu);const V=document.createElement("tr"),Ea=document.createElement("td");Ea.setAttribute(sa.a.style,"width: 8px");Ea.appendChild(R);
R=document.createElement("td");R.appendChild(bc);V.appendChild(Ea);V.appendChild(R);zb.appendChild(V);cb.appendChild(zb);qb.appendChild(cb);if(this.UPa){++qa;const pb=document.createElement("div");pb.id=this.pGa(hb.Nyg);pb.setAttribute(fa.a.Ae,fa.a.QSa);pb.style.display=fa.a.GMc;this.children.forEach(Jb=>{Jb.E7e(qa,pb)});qb.appendChild(pb)}}gtc(){this.element.blur();this.element.tabIndex=-1}tyi(){this.children.forEach(qa=>{qa.visible=!0})}LHf(qa,qb){const bc=this.children;for(const R of bc)if(!R.UPa&&
5===R.type&&R.S9g>qb&&(qa=R,qb=R.S9g,3===qb))return{returnValue:qa,q5d:qb};for(const R of bc)if(R.UPa&&({q5d:qb,returnValue:qa}=R.LHf(qa,qb),3===qb))break;return{returnValue:qa,q5d:qb}}E_i(){let qa=this;for(;-1!==qa.parentId;)qa=this.fieldListSelector.oMd(qa.parentId);return qa}sFc(qa){let qb=this;for(;-1!==qb.parentId;){if(qa.clientId===qb.parentId)return!0;qb=this.fieldListSelector.oMd(qb.parentId)}return!1}setFocus(){this.element.tabIndex=0;oa.DOMElementExtensions.setFocus(this.element)}ZSg(){const qa=
oa.DOMElementExtensions.getElementById(this.element,this.pGa(hb.pde));if(qa){var qb=this.element.nextSibling;oa.DOMElementExtensions.$ya(qa,this.E5,this.gmf,this.Sbi);this.element.setAttribute(fa.a.Mha,this.E5?fa.a.rx:fa.a.Vl);oa.DOMElementExtensions.setVisible(qb,!this.E5)}}DNk(){const qa=this.fieldListSelector.domElement.querySelectorAll(`.${Ma}`);for(let qb=0;qb<qa.length;qb++){const bc=qa[qb];bc.classList.remove(Ma);bc.setAttribute(fa.a.Nha,"false")}this.element.classList.add(Ma);this._element.setAttribute(fa.a.Nha,
"true")}t9b(){(this.E5=!this.E5)?this.jgf():this.tyi();this.ZSg()}pGa(qa){return qa+this.clientId}SJf(qa){return String.format(this.qdj,qa.toString())}}hb.Myg="bixflec_";hb.pde="bixfleci_";hb.Xqb="bixfli_";hb.Oyg="bixflil_";hb.Nyg="bixflg_";Object(M.a)(hb,"BixFieldListItem",null,[4]);class $a extends Sys.EventArgs{constructor(qa,qb){super();this.Bcj=qa;this.caption=qb}}Object(M.a)($a,"BixHierarchySelectionChangedEventArgs",Sys.EventArgs,[]);var Va=a(12);class xa extends aa.a{constructor(qa,qb,bc,
R,cb){super(qb);this.uwd=0;this.xJa=new Ba.a(!1);this.HWc=-1;this.UO=this.NT=this.AOg=null;this.Hd=V=>{V.sc&&this.TRc(V.sc);return!0};this.iL=V=>{V.button===Sys.UI.MouseButton.leftButton&&V.target&&(this.TRc(V.target),Na.g(V))};this.onDoubleClick=V=>{if(V.button===Sys.UI.MouseButton.leftButton&&V.target){var Ea;0!==({Ujc:Ea}=this.OBf(V.target)).returnValue&&(Na.g(V),(V=this.eKf(Ea))&&V.isCollapsible&&this.t9b(V))}};(this.touchMode=cb)?wa.a.instance.va(S.a.click,this.domElement,this.Hd):(this.Dd.Ea("mousedown",
this.iL),this.Dd.Ea("dblclick",this.onDoubleClick));this.kYg=!db.a.kwj&&!cb;let zb;qa.isChromeRtl?(zb="padding-right:{0}px;",this.uwd=39):(zb="padding-left:{0}px;",this.uwd=37);cb=new Ka.a(R.ExcludeHierarchies);cb.Oha.sort((V,Ea)=>V-Ea);qa=-1;qb=null;if(bc=({hXb:qa,xg:qb}=this.sWf(bc.FieldListItems,cb,qa,qb,R.Context)).returnValue)1===bc.length&&(bc=[...bc[0].Children],bc.forEach(V=>{V.ClientParentId=-1})),bc.length&&(this.fieldListItems=[],bc.forEach(V=>{this.fieldListItems.push(new hb(this,V,zb,
Za.a.Bti,Za.a.Cti))}),qb||(qb=xa.jBi(bc,R.Context.DimensionCaption)||bc[0]),this.xg=this.oMd(qb.ClientId),this.n8h())}tFh(qa){this.get_events().addHandler("SelectionChanged",qa)}$tk(qa){this.get_events().removeHandler("SelectionChanged",qa)}get Bwj(){return!!this.fieldListItems}dispose(){this.touchMode&&(wa.a.instance.Ua(S.a.click,this.domElement,this.Hd),this.touchMode=!1);this.UO=null;this.fieldListItems&&(B.a.xd(this.fieldListItems),this.fieldListItems=null);this.xJa=null;super.dispose()}focus(){this.setFocus(!0)}WBh(qa,
qb){this.xJa.add(qa.toString(),qb)}oMd(qa){qa=qa.toString();return this.xJa.Bb(qa)?this.xJa.getItem(qa):null}hasFocus(){var qa=oa.DOMElementExtensions.kv(this.UO);return qa?(qa=qa.id)&&qa.startsWith(hb.Xqb)&&this.NT?!0:!1:!1}onKeyDown(qa){qa=qa.keyCode;if(this.hasFocus()){var qb=!1;38===qa||40===qa?(this.moveFocus(40===qa),qb=!0):37===qa||39===qa?(qa=qa===this.uwd,qb=this.NT,qb.isCollapsible&&qb.isCollapsed!==qa?this.t9b(qb):qa&&qb.Jaj&&this.moveFocus(!1),qb=!0):13===qa||32===qa?((qa=this.NT)&&this.select(qa),
qb=!0):9===qa&&this.Ynf(!0);return qb}return 9===qa?this.NT?this.r6b(this.NT):this.setInitialFocus(!0):!1}bIk(){this.UO.setAttribute(fa.a.u8e,"bix-drilldetails")}setFocus(qa){return this.UO.firstChild?this.hasFocus()?this.moveFocus(qa):this.NT?this.r6b(this.NT):this.setInitialFocus(qa):!1}start(){this.xg&&(this.select(this.xg.E_i()),this.NT&&this.scroll(this.NT,!0))}n8h(){this.UO=this.domElement;this.fieldListItems.forEach(qa=>{qa.E7e(0,this.UO)});oa.DOMElementExtensions.FG(this.UO,fa.a.Wqd,null,
null,null);this.UO.setAttribute(fa.a.oy,Ia.a.instance.ia(1198));this.UO.classList.add(Za.a.YD);this.UO.style.position="relative"}LTi(qa){for(;qa&&qa!==this.UO;){const qb=qa.id;if(qb&&qb.startsWith(hb.Xqb))return qa;qa=qa.parentNode}return null}sWf(qa,qb,bc,R,cb){const zb=bc;if(!qa||!qa.length)return{returnValue:null,hXb:bc,xg:R};let V=0;for(let Ea=0,pb=qa.length;Ea<pb;Ea++){const Jb=qa[Ea];if(xa.Bsj(qb,Jb))qa[Ea]=null,++V;else{Jb.ClientParentId=zb;Jb.ClientId=++bc;if(Jb.IsCollapsible&&(Jb.Children=
({hXb:bc,xg:R}=this.sWf(Jb.Children,qb,bc,R,cb)).returnValue,!Jb.Children)){qa[Ea]=null;++V;continue}5!==Jb.TypeTag&&3!==Jb.TypeTag||Jb.PivotCacheIndex!==cb.HierarchyId||(Jb.UserRank=3,R=Jb)}}return V?V===qa.length?{returnValue:null,hXb:bc,xg:R}:{returnValue:xa.Zqk(qa),hXb:bc,xg:R}:{returnValue:qa,hXb:bc,xg:R}}Ynf(qa){const qb=this.NT;qb&&(qb.gtc(),this.UO.setAttribute(fa.a.Xaa,""));this.gtc();qa||(this.NT=null)}gtc(){this.kYg&&this.UO.classList.add(Ha.Quf)}moveFocus(qa){let qb=this.NT;if(!qb)return this.setInitialFocus(qa);
const bc=this.xJa.values,R=bc.length;let cb=Array.indexOf(bc,qb);for(cb=qa?++cb:--cb;0<=cb&&cb<R;){qb=bc[cb];if(qb.isVisible)return this.r6b(qb),this.scroll(qb,qa),!0;cb=qa?++cb:--cb}return!1}scroll(qa,qb){var bc=qa.element;qa=bc.offsetHeight;bc=bc.offsetTop;const R=this.UO,cb=R.scrollTop,zb=(Math.floor(R.clientHeight/qa)-3)*qa;let V=R.scrollTop;qb?bc>cb+qa+zb&&(V=bc-(qa+zb)):bc<cb+qa&&(V=bc-qa);R.scrollTop=V}setInitialFocus(qa){const qb=this.xJa.count;let bc=qa?0:qb-1;for(;0<=bc&&bc<qb;){const R=
this.xJa.Mh(bc);if(R.isVisible)return this.r6b(R),this.scroll(R,!0),!0;bc=qa?++bc:--bc}return!1}r6b(qa){this.NT&&qa!==this.NT&&this.Ynf(!1);if(!qa)return!1;this.UO.setAttribute(fa.a.Xaa,qa.element.id);this.NT=qa;-1!==this.HWc&&(qa.setFocus(),this.kYg&&this.UO.classList.remove(Ha.Quf));return!0}OBf(qa){for(;qa&&qa!==this.UO;){const qb=qa.id;if(qb.startsWith(hb.Xqb))return{returnValue:1,Ujc:qa};if(qb.startsWith(hb.Myg)||qb.startsWith(hb.pde))return{returnValue:2,Ujc:qa};qa=qa.parentNode}return{returnValue:0,
Ujc:null}}eKf(qa){if(!qa.id||!qa.id.startsWith(hb.Xqb)&&(qa=this.LTi(qa),!qa))return null;qa=qa.id.split("_")[1];return Ba.a.Od(this.xJa.Dw,qa)}TRc(qa){var qb;qa=({Ujc:qb}=this.OBf(qa)).returnValue;if(0!==qa&&(qb=this.eKf(qb)))switch(qa){case 2:this.t9b(qb);break;case 1:this.select(qb)}}select(qa){if(qa){qa.DNk();this.r6b(qa);if(qa.isCollapsible){let qb=-1;({q5d:qb,returnValue:qa}=qa.LHf(null,qb));if(!qa)return}this.xg=qa;this.HWc!==qa.bxg&&(this.HWc=qa.bxg,this.AOg=qa.caption,this.raiseEvent("SelectionChanged",
new $a(this.HWc,this.AOg)),this.hasFocus()||this.gtc())}}t9b(qa){qa.t9b();qa.isCollapsed&&this.xg&&this.xg.sFc(qa)&&this.select(qa);this.scroll(qa,!qa.isCollapsed)}static jBi(qa,qb){for(const bc of qa)if(11===bc.TypeTag&&bc.Name===qb)return bc;return null}static Bsj(qa,qb){switch(qb.TypeTag){case 5:case 3:break;default:return!1}return 0<=Va.HelperMethods.tF(qa,0,qa.DGa(),qb.PivotCacheIndex,(bc,R)=>bc-R)}static Zqk(qa){let qb=null;for(let bc=0;bc<qa.length;bc++)qa[bc]&&(qb||(qb=[]),qb.push(qa[bc]));
return qb}}Object(M.a)(xa,"BixFieldListSelector",aa.a,[403]);var ia=a(43),Z=a(244),ta=a(57),pa=a(53),Ga=a(255),Ca=a(266),kb=a(79),eb=a(92),Yb=a(88);class Gb extends ea.a{constructor(qa,qb,bc,R){super(qa,Ia.a.instance.ia(1192),!0,4);this.fieldListSelector=this.u0=this.F0a=this.yH=this.b9c=this.$ia=null;this.FOe=!1;this.jZj=(zb,V)=>{if(this.domElement&&(this.F0a.x6a(),!Ga.a(zb))){const Ea=zb.Result;Ea&&this.m0k(Ea,V);super.a9(zb,null,"")}};this.hWk=()=>{this.nHb.textContent=Ia.a.instance.ia(1194);const zb=
this.Ana.querySelector("."+Ha.Puf);zb.tabIndex=-1;oa.DOMElementExtensions.setFocus(zb)};this.dpb=()=>{this.close(1);return!0};this.domElement.id=qa.domElement.id+"_BIExploreCallout";this.aD=qb;this.targetElement=bc;this.MKg=!1;this.domElement.classList.remove(this.rtl?Oa.a.cNb:Oa.a.bNb);this.domElement.classList.remove(Za.a.XD);this.domElement.classList.add(this.rtl?Ha.Api:Ha.zpi);(this.touchMode=R)||this.domElement.classList.add(Ha.ypi);this.Ana.className=Ha.Dpi;this.Ana.style.backgroundImage="";
this.Xya.className=Ha.Cpi;this.MD.parentNode.className=Ha.Puf;qa=this.Ld;qa.className="";qb=document.createElement("div");qb.id="bix-subtitle";qb.classList.add(Ha.Bpi);qb.textContent=eb.a.Dg(this.aD.pdj);bc=document.createElement("div");bc.classList.add(Ha.spi);R=document.createElement("div");R.id="bix-fieldlistselector";R.classList.add(Ha.Epi);const cb=document.createElement("div");cb.id="bix-drilldetails";cb.classList.add(Ha.xpi);bc.appendChild(R);bc.appendChild(cb);qa.appendChild(qb);qa.appendChild(bc);
this.nHb=qa.lastChild;this.JRd()}get Tc(){return"BIExploreCallout"}get Jmj(){return this.FOe}get Eeb(){return 6}get kD(){return 561}stj(qa){qa=document.getElementById(qa);return oa.DOMElementExtensions.isVisible(qa)?(this.$ia.setFocus(!0),!0):!1}H0h(qa){this.b9c=qa;Sa.f(this.$).Bu(!0);this.FOe=!0;this.close(2)}dispose(){B.a.xd([this.yH,this.F0a,this.$ia,this.fieldListSelector]);this.aD=this.$ia=this.fieldListSelector=this.F0a=this.yH=null;this.uTc();this.b9c=this.targetElement=this.nHb=null;super.dispose()}f3k(){this.setFocus()}close(qa){this.uTc();
super.close(qa)}Om(qa=!1){const qb=Object(Yb.d)(G.a.resolve(A.SharedUIControlsFactoryService,{xa:0}));ia.TaskExtensions.tb(qb,bc=>{this.MKg||(this.F0a=bc.result.BKb(this.Ld,500,null,null,736),this.F0a.o6a())},this.$.Aa);return ia.TaskExtensions.ts(ia.TaskExtensions.tb(Object(Yb.d)(G.a.resolve(A.CalloutDialogBehaviorService,{xa:0})),bc=>{this.yH=bc.result;this.yH.init(this.domElement,this.targetElement,document.body,this.$.la.displayRtl);this.yH.Fxd=8;this.yH.Vpd=!0;this.yH.Tqb=Gb.F5i();this.ond();
this.yH.cA()},this.Aa,3),()=>Z.a.prototype.Om.call(this,qa),this.Aa,3,kb.a.current)}QJ(){return this.b9c}udb(){return(qa,qb,bc)=>{var R=this.$.ma.sa;qa=this.pib(qa);qb=this.TWa(qb);const cb=la.M(R,this.aD.Rw,this.aD.externalSourceIndex,this.aD.mZ);return la.h(R,"GetBixAnalysis",cb,qa,qb,bc,null,4)}}onShow(){this.yH.gme();super.onShow()}a9(qa){const qb=qa.Result;if(qa.Errors&&!qa.Errors.length&&qb&&-1===qb.Context.HierarchyId)this.MKg=!0,this.F0a&&this.F0a.x6a(),ta.a.instance.create(this.hWk,1,pa.a.XNh,
!0,!0),super.a9(qa,null,"");else{var bc=R=>{R.Tw=0;this.$Ya(169,(cb,zb,V)=>{var Ea=this.$.ma.sa,pb=R.fN,Jb=R.P3a,zc=R.Tw;cb=Ca.c(cb,this.jZj);const Mc=la.M(Ea,R.Rw,R.externalSourceIndex,R.K9h());Mc.type=4;Mc.version=pb;Mc.relatedGroup=Jb;Mc.selectedTab=zc;return la.h(Ea,"GetPivotFieldListData",Mc,cb,zb,V,qb,4)},16)};void G.a.resolve(A.FieldListRequestStateManagerService,{xa:0}).then(R=>{R=R.create();bc(R)})}}onKeyDown(qa){let qb=this.MFf();if(qa.altKey&&85===qa.keyCode)this.close(1),Na.g(qa);else if(117===
qa.keyCode&&qa.ctrlKey)this.close(1),Na.g(qa);else if(0===qb)if(13===qa.keyCode)this.close(1);else super.onKeyDown(qa);else{let bc=!1;for(let R=0;3>R&&!bc;R++)2===qb?(bc=this.fieldListSelector.onKeyDown(qa))||(qb=1):1===qb&&((bc=this.$ia.onKeyDown(qa))||(qb=2));if(bc)Na.g(qa);else super.onKeyDown(qa)}}setFocus(){(this.$ia||this.fieldListSelector)&&this.nLh(this.MFf())}nLh(qa){let qb=!1;for(let bc=0;2>bc&&!qb;bc++)1===qa&&this.$ia?(qb=this.$ia.setFocus(!0))||(qa=2):2===qa&&this.fieldListSelector&&
((qb=this.fieldListSelector.setFocus(!0))||(qa=1))}MFf(){if(!this.fieldListSelector||!this.$ia)return 0;const qa=this.fieldListSelector.hasFocus(),qb=this.$ia.hasFocus();return!qa&&!qb||qb?1:2}m0k(qa,qb){let bc=this.getElementById("bix-fieldlistselector");this.fieldListSelector=new xa(this.$,bc,qa,qb,this.touchMode);this.fieldListSelector.Bwj?(this.nHb.setAttribute(fa.a.Ecb,"true"),bc=this.getElementById("bix-drilldetails"),this.$ia=new za(this.$,bc,this.aD,qb,this.fieldListSelector,this),this.fieldListSelector.bIk(),
this.fieldListSelector.start(),this.setFocus(),this.nHb.setAttribute(fa.a.Ecb,"false")):(this.fieldListSelector.dispose(),this.fieldListSelector=null,this.nHb.textContent=Ia.a.instance.ia(1194))}ond(){const qa=this.u0=document.createElement("div");qa.classList.add(Ha.tpi);X.a.instance.va(S.a.Sd,qa,this.dpb);this.domElement.ownerDocument.body.appendChild(qa)}uTc(){this.u0&&(X.a.instance.Ua(S.a.Sd,this.u0,this.dpb),oa.DOMElementExtensions.vh(this.u0),this.u0=null)}static F5i(){return Gb.Tqb||(Gb.Tqb=
[0,1,4,5])}}Gb.Tqb=null;Object(M.a)(Gb,"BIExploreCallout",ea.a,[384,219]);var Mb=a(943);class Rb extends U.a{constructor(qa,qb,bc,R){super();this.$=qa;this.svgIconProvider=R;this.Tqa=bc.pKb(qa,R,qb,Za.a.Ovc,da.a.Lh(9),Ia.a.instance.ia(1193),"BIXPointerDown");this.Dua=!1}get Kz(){return this.Tqa.Kz}get uIb(){return this.Tqa.uIb}get Uwj(){return this.Dua}dispose(){this.Tqa.dispose();this.$=null;this.Dua=!1;super.dispose()}getButton(qa){return this.Tqa.getButton(qa)}lWk(qa,qb,bc,R){this.Xo(qa+this.uIb,
qb+this.uIb,bc,R,"Chart")}mWk(){var qa=Sa.f(this.$).ha.oa.activeCell;const qb=Sa.f(this.$).rb.Yh(qa);(qa=Sa.f(this.$).Wg(qa,qb))&&0<=qa.x&&0<=qa.y?this.Xo(qa.bottomRight.x+this.Kz,qa.bottomRight.y+this.Kz,Sa.f(this.$).rtl,qb,"Grid"):this.hide()}Xo(qa,qb,bc,R,cb){L.ULS.sendTraceTag(507834647,0,20,`BIExplorer lunch button shown on ${cb}`);this.Tqa.Xo(qa,qb,bc,R);this.Dua=!0;this.Tqa.Y2c(Mb.a.kbk,Ia.a.instance.ia(1193),1)}hide(){this.Tqa.hide();this.Dua=!1}domElement(qa){return this.Tqa.domElement(qa)}Ggb(qa){this.Tqa.Ggb(qa);
this.Dua=!0}}Object(M.a)(Rb,"BIExploreLaunchButton",U.a,[]);var $b=a(44);class cc{constructor(qa){this.ycc=!1;this.A9a=0;this.fRa=this.gVe=this.Ygd=this.Cbd=null;this.$=qa;this.reset()}get confirmationRequiredForDataOps(){return this.ycc}get externalSourceIndex(){return this.A9a}get pdj(){return this.Cbd}get X7(){return!!this.mZ}get MVd(){return!!this.Rw}get mZ(){return this.Ygd}get pivotTableName(){return this.gVe}get Rw(){return this.fRa}reset(){this.Cbd="";this.fRa=this.gVe=this.Ygd=null}vIk(qa,
qb,bc){this.reset();this.A9a=qb.ExternalSourceIndex;this.ycc=!!(qb.Attributes&64);this.Cbd=ba.a.$l(bc.ValueString);this.Ygd={};this.mZ.ChartId=qa;this.mZ.AnchorValue2=-1;switch(bc.Type){case 1:case 2:0<=bc.CategoryIndex?(this.mZ.AnchorType=2,this.mZ.AnchorValue1=bc.CategoryIndex):(this.mZ.AnchorType=1,this.mZ.AnchorValue1=bc.SeriesIndex);break;default:0>bc.CategoryIndex&&0<=bc.SeriesIndex?(this.mZ.AnchorType=1,this.mZ.AnchorValue1=bc.SeriesIndex):(this.mZ.AnchorType=3,this.mZ.AnchorValue1=bc.SeriesIndex,
this.mZ.AnchorValue2=bc.CategoryIndex)}this.fRa={};this.$.Zk(this.Rw);this.Rw.FirstRow=-1;this.Rw.FirstColumn=-1}}Object(M.a)(cc,"BixSelectionContext",null,[]);var fb=a(739),Sb=a(74),kc=a(282),na=a(944),fc=a(610),Cc=a(684),tc=a(186);let nb=class extends U.a{constructor(qa,qb,bc,R,cb){super();this.iLb=this.callout=this.da=null;this.aWj=zb=>{zb.isLoaded?(this.state=1,zb=this.$,this.gMh(),zb.Sj(this.jd),zb.DD(this.qk),this.da.aw(this.nB),fc.a(zb).aw(this.c_b),zb.userOperationManager.Kp(this.tug),this.Dgk()):
this.dispose()};this.kL=(zb,V)=>{this.Dy();this.iLb(zb,V)};this.iae=(zb,V)=>{this.allow&&0===V.P7&&(zb=this.da.ha.gf,1===zb?(this.ewd(),this.QZ()):2!==zb||this.aD.X7||(this.aD.reset(),this.Dy()))};this.Nh=()=>{this.Dy()};this.jd=()=>{this.Dy()};this.Hd=(zb,V)=>{this.callout||this.showCallout(3===zb.Yb,V)};this.Q8d=()=>{this.callout.vLa(this.Q8d);this.callout=null;this.fl.hide()};this.qk=()=>{this.callout?this.Dy():this.Mlb()&&this.fl.hide()};this.c_b=()=>{3===this.state&&(this.state=1)};this.nB=()=>
{3===this.state&&this.Dsf()};this.tug=(zb,V)=>{(zb=V.jg?V.jg.operation:null)&&zb.flags&4&&(this.allow&&0===V.Fq?(this.state=3,this.Dy()):3===this.state&&1===V.Fq&&(V=zb.Ge?zb.Ge.Errors:null)&&0<V.length&&this.Dsf())};this.Dsf=()=>{this.state=1;this.QZ()};this.$=qa;this.da=qb;this.state=2;this.UH=R;this.aD=new cc(qa);this.fl=new Rb(qa,this.Hd,bc,cb);C.a(this.$).hl(this);J.a.IVf(qa.domElement.ownerDocument,da.a.current.Lo(96),this.aWj);this.dvh=new Promise(zb=>this.Dgk=zb);this.iLb=tc.a(this.iae,100)}dispose(){this.da&&
(this.da.Ub.osb(this.kL),this.da.Rb&&this.da.Rb.zp(this.Nh));if(this.$){const qa=this.$;qa.userOperationManager.kn(this.tug);qa.ro(this.jd);qa.vG(this.qk);Sa.f(qa).Zz(this.nB);fc.a(qa).Zz(this.c_b)}B.a.vb(this.fl);this.aD=this.$=this.da=this.callout=this.fl=null;super.dispose()}get j1k(){return this.dvh}get ud(){return this.callout?this.callout.domElement:null}get ij(){return!!this.callout}get rSk(){return!this.callout}get tf(){return kc.a.gsd}get Nsj(){var qa;return!(null===(qa=this.fl)||void 0===
qa||!qa.Uwj)}get sKf(){L.ULS.shipAssertTag(537170304,8,!Sa.f(this.$).rb.mj,"GetLaunchMonocleButton is not supported in freeze pane");return Object(Y.a)(Sys.UI.Control,this.fl.getButton(1))}get ZKf(){return this.callout}get Awj(){return this.aD.MVd}get allow(){return this.$.Fe.get(6)&&1===this.state&&this.$.$b.Uaa(135200)}pff(){this.showCallout(!1)}gd(qa,qb){if(1529658657===qb&&(8===qa||!this.aD.MVd))return!0;1247109494!==qb&&-498523270!==qb||this.Dy();return!1}executeCommand(qa,qb){this.callout?this.Dy():
(this.scrollIntoView(),this.showCallout(3===qb.method));return N.Task.Va(!0)}Rc(qa,qb){return 1529658657===qb.command}td(){return!1}Dy(){this.ewd();this.Nsj&&this.fl.hide()}$Dk(qa){this.scrollIntoView();this.showCallout(qa,1)}Nj(qa,qb){this.callout&&!qb&&this.callout.f3k();return!qb}zk(qa){return oa.DOMElementExtensions.Ki(this.ud,qa)}Hm(){}fo(){}Uzg(qa,qb,bc,R,cb){this.aD.reset();if(this.allow&&!Sb.e(this.$.la))if(bc&&bc.Attributes&512&&R&&qb){const zb=this.$.PS;this.ewd();this.aD.vIk(qb,bc,R);this.Mlb()?
(Va.HelperMethods.isStandardZoomCssSupportedByBrowser&&L.ULS.sendTraceTag(507094673,8,50,"BIExploreManager.processChartElementClick: NOV chart detected"),qb=fc.a(this.$).domElement,bc=oa.DOMElementExtensions.getLocation({element:qb}),R=Math.abs(qb.scrollLeft),this.$.isChromeRtl&&(Sys.Browser.agent===Sys.Browser.Safari&&(R=qb.scrollWidth-qb.offsetWidth-R),R*=-1),qa=new O.a(qa.x-bc.x+R,qa.y-bc.y+qb.scrollTop),zb&&(qa.x=qb.offsetWidth-qa.x)):(qb=this.da.pg(cb).view.Ci,qa=na.a.hA(qb,this.da.pg(cb).domElement,
new Sys.UI.Point(Math.round(qa.x),Math.round(qa.y)),zb));this.fl.lWk(qa.x,qa.y,zb,cb)}else this.Dy()}QZ(){this.JSk()?this.fl.mWk():this.fl.hide()}showCallout(qa,qb=1){const bc=R=>{R&&this.aD.MVd&&(this.callout=new Gb(this.$,this.aD,this.fl.domElement(qb),qa),this.callout.initialize(),this.fl.Ggb(qb),this.callout.Paa(this.Q8d),this.callout.Om());this.fl.getButton(1).m4b()};void G.a.resolve(A.DataRefreshManagerService,{xa:1}).then(R=>{R.KH(this.aD.confirmationRequiredForDataOps,bc)})}scrollIntoView(){var qa=
this.da.ha;if(1===qa.gf){qa=qa.oa.activeCell;const qb=this.da.view.visibleArea,bc=this.da.Wg(qa);qb&&bc&&!qb.contains(bc)&&this.da.Ix(qa,3,"BIExploreManager.ScrollIntoView")}}gMh(){this.da&&(this.da.Ub.Xbb(this.kL),this.da.Rb.Jp(this.Nh))}JSk(){this.aD.reset();if(!this.allow||this.da.ha.ob.Wb)return!1;const qa=this.UH.wQb();return fb.a(this.da,qa)}ewd(){this.fl.getButton(1).m4b();this.callout&&!this.callout.Jmj&&(this.callout.vLa(this.Q8d),this.callout.zF(),this.callout=null)}Mlb(){return this.$.fa.isNamedObjectViewMode&&
Sb.f(this.$.la)}};nb=Object(I.__decorate)([Object(G.d)(A.BIExploreManagerService),Object(I.__param)(0,Object(A.EwaControlService)()),Object(I.__param)(1,Object(A.GridViewService)()),Object(I.__param)(2,Object(A.SharedUIControlsFactoryService)()),Object(I.__param)(3,Object(A.DataRefreshManagerService)()),Object(I.__param)(4,Object(Cc.h)())],nb);Object(M.a)(nb,"BIExploreManager",U.a,[29,329,24,4]);var tb=a(209),La=a(1);let wb=class{constructor(qa,qb){this.UH=qa;this.ig=qb}gd(){return!1}executeCommand(qa,
qb,bc,R){switch(qb.command){case -1193102612:this.UH.Fge(!1,!1,qb,"m_excelWebRenderer_ewaCtl_DataSourceDirtinessButton"===bc.SourceControlId);this.ig.Pmk();break;case 2054778433:this.UH.refreshSelected(qb,R);break;case -1995709983:this.ig.Qmk();this.UH.Fge(!1,!0,qb,!1);break;default:return tb.a(qb.command)}return ia.TaskExtensions.kl()}Rc(qa,qb){switch(qb.command){case 2054778433:case -1193102612:return!0;case -1995709983:return La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableContentRefreshOnOpen",
!1)}return!1}td(){return!1}};wb=Object(I.__decorate)([Object(G.d)(A.DataRefreshCommandHandlerService),Object(I.__param)(0,Object(A.DataRefreshManagerService)()),Object(I.__param)(1,Object(A.PowerQueryManagerService)())],wb);Object(M.a)(wb,"DataRefreshCommandHandler",null,[29]);var Wa=a(6),Fa=a(791),Da=a(363),ja=a(41),Qa=a(1369),Ob=a(438),Ub=a(231),Zb=a(492);class uc{constructor(qa,qb){this.pivotTableName=this.pivotTableId=null;this.pivotTableId=qa;this.pivotTableName=qb}}Object(M.a)(uc,"MacroRecorderPivotTableRefreshedPayload",
null,[67]);var Hc=a(463);class Dd extends Hc.a{constructor(qa,qb,bc,R,cb=Hc.a.dBd,zb=null){super(qa,qb,bc,R,cb,zb)}get xKa(){return 4}get S4b(){return!!(this.flags&64)}}Object(M.a)(Dd,"DepartableRefreshWebMethodOperation",Hc.a,[]);var jc=a(81),$c=a(124);const ud=(qa,qb,bc,R,cb,zb,V,Ea,pb,Jb)=>{const zc=pb?"RefreshAllDirtyDataSources":La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableContentRefreshOnOpen",!1)?"RefreshAllNew":"RefreshAll";Jb=qa.$a(1,Jb);const Mc=Jb.context;Mc.RequestId=
R;Mc.CompleteResponseTimeout=cb;Jb.periodic=qb;"RefreshAllNew"===zc&&(Jb.refreshOnOpen=bc);return la.h(qa,zc,Jb,zb,V,Ea,pb,qb?8:0)};var Ud=a(369),ec=a(36),Db=a(45),ic=a(368),Pc=a(213),Ed=a(429),de=a(609),se;const Fe=de.a.Jra.Application;let fe=se=class extends U.a{constructor(qa,qb){super();this.MQc=null;this.USc=!1;this.dLa=null;this.Sge=!1;this.ub=new ja.a;this.zH=null;this.Nsh=new Map;this.P2a=new Map;this.Ahc=[];this.Tz=(R,cb)=>{2===cb.Fq?this.P2a.clear():1===cb.Fq&&this.P2a&&this.P2a.forEach((zb,
V)=>{cb.jg==zb&&this.P2a.delete(V)})};this.hyi=async R=>{try{const cb=await this.JXi();R(cb)}catch(cb){L.ULS.sendTraceTag(508913882,0,10,`DataRefreshManager.RefreshConnection: failed to get PFT token ${cb}`)}};this.JXi=async()=>{try{const R=await this.LRj.ey("Core",Fe);if(R.IsSuccess)return L.ULS.sendTraceTag(508913881,0,20,"DataRefreshManager.getPftTokenAsync: successfully fetch token."),R.Token;L.ULS.sendTraceTag(508913880,0,15,`DataRefreshManager.getPftTokenAsync: failed to get token. Error code: ${R.ErrorCode}, Error message : ${R.ErrorMessage}`)}catch(R){L.ULS.sendTraceTag(508913879,
0,15,"DataRefreshManager.getPftTokenAsync: got rejected promise, use fallback value")}return null};this.sUh=()=>{this.ype(0);this.Fge(!0,!1,null,!1)};this.Q2j=R=>{R.RequestId||(this.Fqb=null,this.$.fa.ur(R.Errors))};this.R2j=R=>{this.Fqb=null;R=$c.a.te(R.data);this.$.fa.ur(R)};this.prg=R=>{this.rrg(R);(R.DepartableWebMethodOperationCompleted||R.Errors&&0<R.Errors.length)&&this.ub.raiseEvent("refreshAllCompleted",R,this)};this.i_j=R=>{R&&!Ga.a(R)&&(!(R=R.Result)||1>R.length||(this.zH&&this.zH.cancel(),
this.zH=new Fa.a,this.s4g(R,0,this.zH.token)))};this.h_j=R=>{L.ULS.sendTraceTag(537163298,306,50,"DataRefreshManager::OnGetSensitivityLabelsFailedCallback");R=$c.a.te(R.data);this.$.fa.ur(R)};this.Nd=()=>{this.jUd()};this.onActiveItemPanesChanged=()=>{La.EwaSettings.isChangeGateEnabled("OfficeVSO:6013906_MarkRefreshRangeInvalidWhenCurrentSheetIsChanged")&&this.jUd()};this.$Zb=(R,cb)=>{const zb=cb.he.block;var V=zb.oe.PeriodicRefreshExpiryInSeconds;void 0!==V&&this.jSg(V);V=Sa.f(this.$);5===zb.state&&
R===V.za&&((R=(R=V.fJ(cb.he.hash))?R.Fd:null)&&!R.ld(V.ha.oa.activeCell)||this.jUd())};this.yd=()=>{this.$.fa.yc||this.clear()};this.$=qa;this.qce=-1;this.Fqb=null;qa=Sa.f(this.$);const bc=qa.ha;bc.YS(this.Nd);bc.JCa(this.Nd);qa.za.qqa(this.$Zb);this.$.qa.KCa(this.onActiveItemPanesChanged);this.$.wc.KCa(this.onActiveItemPanesChanged);this.$.userOperationManager.Kp(this.Tz);this.c9e(qa.za);this.c9e(fc.a(this.$).za);this.$.fa.Vk(this.yd);this.LRj=qb;qb=this.$.ta.StartupDelayMultiplierForLabelsOnRefreshOnOpen*
this.$.ta.TimeToWaitForApplyingSensitivityLabels;L.ULS.sendTraceTag(537163332,306,50,`DataRefreshManager async call to UpdateSensitivityLabels after ${qb} ms.`);ta.a.instance.create(()=>{this.vAe()},qb,pa.a.Eci,!0,!0)}LCh(qa){this.ub.addHandler("beforeSingleRefreshStarted",qa)}Qrk(qa){this.ub.removeHandler("beforeSingleRefreshStarted",qa)}c5e(qa){this.ub.addHandler("singleRefreshCompleted",qa)}MHg(qa){this.ub.removeHandler("singleRefreshCompleted",qa)}get Xge(){return this.Ahc}get hEg(){return this.Nsh}get confirmationRequired(){return this.$.$b.refreshConfirmationRequired}dispose(){if(this.$){const qa=
Sa.f(this.$),qb=qa.ha;qb.qV(this.Nd);qb.wxa(this.Nd);this.$.wc.uLa(this.onActiveItemPanesChanged);this.$.qa.uLa(this.onActiveItemPanesChanged);this.$.userOperationManager.kn(this.Tz);qa.za.yu(this.$Zb);qa.za.esb(this.$Zb);fc.a(this.$).za.yu(this.$Zb);this.$.fa&&this.$.fa.Qk(this.yd)}this.clear();B.a.xd([this.MQc,this.ub]);this.$=this.ub=null;super.dispose()}K9k(qa,qb,bc,R){this.$.fa.yc&&this.$.userOperationManager.enqueueOperation(new Pc.a(604,0,(cb,zb,V)=>ic.g(this.$.ma.sa,qa,qb,bc,Ca.c(cb,Ea=>{Ea=
Ea.Result;null===Ea||""===Ea.DataConnectionName||-1===Ea.ExternalSourceIndex?this.lte():this.VSc(Ea.DataConnectionName,Ea.ExternalSourceIndex,R)}),Ca.b(zb,Ea=>{L.ULS.sendTraceTag(509696077,306,15,"DataRefreshManager::onGetConnectionNameFailure");this.lte();Ea=$c.a.te(Ea.data);this.$.fa.ur(Ea)}),V,null,null),80,()=>new Zb.a),null)}VSc(qa,qb,bc){if(this.$.fa.yc){var R=cb=>{var zb=null;if(this.dLa&&Object(Da.a)(Ub.PivotTableRange,this.dLa)){const V=this.dLa;zb=()=>new uc(V.Vla,V.pivotTableName)}zb=this.$.userOperationManager.enqueueOperation(new Dd(50,
0,(V,Ea,pb,Jb)=>{var zc=this.$.ma.sa.mc();zc.FlightHolder=this.$.ta.FlightHolder;null==V&&this.hEg.set(qa,zc.ClientRequestId);var Mc=this.$.ma.sa;Ea=Ca.c(this.JZi(qa),Ea);zc=Mc.$a(1,zc);const od=zc.context;od.RequestId=V;od.CompleteResponseTimeout=2E3;zc.connectionName=qa;zc.externalSourceIndex=qb;zc.userAadToken=cb;return la.h(Mc,"Refresh",zc,Ea,pb,Jb,null,0)},68,250,zb),bc);this.P2a.set(qa,zb);this.B5j(qa)};this.yTj(qa);La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",
!1)||La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefreshPFTAsDefault",!1)?void this.hyi(R):R(null)}}EAg(qa=null){La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConfirmActiveContent",!1)?this.pSg(!0,qa):(this.$.$b.refreshConfirmationRequired=!1,this.USc=!0)}KH(qa,qb){var bc=null;if(this.confirmationRequired&&qa)if(this.USc)qb(!0);else{bc=bc||se.GJj;qa=ec.a.Cd(12,1,0,0,0,1243883867,"ConfirmDataRefresh");qa.Caption=Ia.a.instance.La(7);qa.Description=
bc;qa.HelpDescription=Ia.a.instance.ia(1319);qa.HelpTopicId=Qa.a.Fhf;const R=new Ud.a(this.$,qa);R.Paa(()=>{this.pSg(2===R.returnValue,qb)})}else qb(!0)}wQb(){if(!this.Sge){const qa=Sa.f(this.$).Eb.EMf();qa&&(this.dLa=qa);this.Sge=!0}return this.dLa}vAe(){var qa=this.$.ma.sa.mc(),qb=this.$.ma.sa,bc=this.i_j,R=this.h_j;qa=qb.$a(1,qa);la.h(qb,"GetSensitivityLabelsForPowerBIDatasets",qa,bc,R,null,null,4)}a9k(qa){return this.P2a.has(qa)?(this.$.userOperationManager.Sia(this.P2a.get(qa)),!0):!1}qSg(){this.$.$b.refreshConfirmationRequired=
!1;this.USc=!0;this.HFg()}pSg(qa,qb=null){if(qa){var bc=[],R=this.$.ma.sa.mc(),cb=zb=>{zb.Errors&&0<zb.Errors.length||(qb&&qb(!0),this.qSg())};Ed.a(this.$.userOperationManager,(zb,V,Ea)=>la.G(this.$.ma.sa,bc,!0,1243883867,!0,Ca.c(zb,cb),V,Ea,null,R),zb=>new Pc.a(1005,0,zb),null)}}static N2h(qa){if(La.EwaSettings.Ra(123)){var qb=qa.$b;if(!qb||qb.inEmbedView||qb.inWebPart||qb.inViewerFromWebPart)return!1;qa=Sa.f(qa);qb=qa.ha.oa.selectedRanges;for(let bc=0;bc<qb.length;bc++)if(qa.Eb.JHc(qb[bc]))return!0}return!1}lte(){const qa=
ec.a.Cd(1,0,0,1503,0,-853845742,"ErrorConnectingToDataSource");Db.a(this.$).Zx([qa])}Fge(qa,qb,bc,R){if(this.$.fa.yc){this.HFg();if(0<this.$.workbookContext.LegacyConnections.length){const cb=ec.a.Cd(32,2,1649,1662,0,-73730134,"BB_LegacyConnectionsWarning");cb.HelpDescription=Ia.a.instance.ia(1644);cb.HelpTopicId=Ob.a.dCj;if(La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",!1))void G.a.resolve(A.BusinessBarManagerService,{xa:0}).then(zb=>{zb&&zb.lh(33,cb)});
else{const zb=Object(Yb.d)(G.a.resolve(A.BusinessBarManagerService,{xa:0}));ia.TaskExtensions.tb(zb,()=>{const V=zb.result;V&&V.lh(33,cb)},this.$.Aa,3)}}qa?(qa=this.$.ma.sa.mc(),this.Fqb=ud(this.$.ma.sa,!0,!1,null,0,Ca.c(this.Q2j,this.prg),this.R2j,null,null,qa)):this.$.userOperationManager.enqueueOperation(new Dd(51,0,(cb,zb,V,Ea)=>{const pb=this.$.ma.sa.mc();pb.FlightHolder=this.$.ta.FlightHolder;let Jb=null;R&&(Jb={});return ud(this.$.ma.sa,!1,qb,cb,2E3,Ca.c(this.prg,zb),V,Ea,Jb,pb)},68,250,()=>
new Zb.a),bc)}}refreshSelected(qa,qb){if(this.$.fa.yc&&Sb.i(this.$.la)&&!this.LTb()){var bc=this.wQb();if(!se.N2h(this.$)||bc&&Object(Da.a)(Ub.PivotTableRange,bc))bc?this.VSc(this.dLa.connectionName,this.dLa.externalSourceIndex,qa):Sa.f(this.$).ha.oa.sUd()?this.K9k(this.$.qa.la.sheetName,this.$.qa.la.activeCell.top-1,this.$.qa.la.activeCell.left-1,qa):this.lte();else{let R;qa=Object(Yb.d)(G.a.resolve(A.ConvertToLinkedEntityManagerService,{xa:qb.Oca()}));ia.TaskExtensions.tb(qa,cb=>{(R=cb.result)&&
R.refreshLinkedEntitiesInRange()},this.$.Aa,3)}}}clear(){this.ype(0);this.USc=!1;this.qce=-1;se.cfd=null;this.Fqb&&(Wa.AFrameworkApplication.od.dy(this.Fqb.sx),this.Fqb=null)}LTb(){return 2===Sa.f(this.$).ha.gf}jUd(){this.Sge=!1;this.dLa=null}ype(qa){let qb=0<qa;!qb||this.$.fa.yc&&this.$.$b.allowPeriodicDataRefresh||(qb=!1);B.a.vb(this.MQc);this.MQc=null;qb&&(this.MQc=ta.a.instance.fK(this.sUh,qa,pa.a.Cci))}rrg(qa){qa.RequestId||(this.ub.raiseEvent("refreshCompleted",qa,this),this.vAe())}JZi(qa){return qb=>
{var bc;this.rrg(qb);qb&&(qb.DepartableWebMethodOperationCompleted||qb.Errors&&0<qb.Errors.length)&&(Array.remove(this.Ahc,qa),qb.Result=null!==(bc=qb.Result)&&void 0!==bc?bc:{},qb.Result.ConnectionName=qa,this.ub.raiseEvent("singleRefreshCompleted",qb,this))}}yTj(qa){this.ub.raiseEvent("beforeSingleRefreshStarted",qa,this)}B5j(qa){this.Ahc.includes(qa)||this.Ahc.push(qa);this.ub.raiseEvent("singleRefreshStarted",qa,this)}s4g(qa,qb,bc){const R=jc.GetServiceTaskFactory.Ne(this.$.ra,274,275,0);let cb=
!1;bc.oI?L.ULS.sendTraceTag(537163297,306,50,"DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: Task was cancelled."):ia.TaskExtensions.tb(R,()=>{if(({glb:cb}=R.result.yrd(qa,cb)).returnValue)L.ULS.sendTraceTag(537163293,306,50,`DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: Completed successfully on the ${qb} attempt.`);else if(cb&&3>qb)if(bc.oI)L.ULS.sendTraceTag(537163296,306,50,"DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: Task was cancelled before waiting.");else{var zb=
this.$.ta.TimeToWaitForApplyingSensitivityLabels;L.ULS.sendTraceTag(537163295,306,100,`DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: retry async call to AutoApplyOrRecommendPowerBILabel after ${zb} ms on the ${zb} attempt.`);ta.a.instance.create(()=>{this.s4g(qa,qb+1,bc)},zb,pa.a.Dci,!0,!0)}else L.ULS.sendTraceTag(537163294,306,50,`DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: No Sensitivity Labels applied on the ${qb} attempt.  Not scheduling anymore retries.`)},bc,3)}c9e(qa){qa.$t(this.$Zb);
qa=qa.Wak;0<qa&&this.jSg(qa)}jSg(qa){const qb=this.$.fa.Je;qb>this.qce&&(this.qce=qb,this.ype(1E3*qa))}HFg(){if(La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",!1))void G.a.resolve(A.BusinessBarManagerService,{xa:0}).then(qa=>{qa&&qa.w2(58)&&qa.removeEntry(58);qa&&qa.w2(74)&&qa.removeEntry(74)});else{const qa=Object(Yb.d)(G.a.resolve(A.BusinessBarManagerService,{xa:0}));ia.TaskExtensions.tb(qa,()=>{const qb=qa.result;qb&&qb.w2(58)&&qb.removeEntry(58);qb&&qb.w2(74)&&
qb.removeEntry(74)},this.$.Aa,3)}}static get GJj(){return se.cfd||(se.cfd=Ia.a.instance.La(8)+"<br /><br />"+Ia.a.instance.La(10))}};fe.cfd=null;fe=se=Object(I.__decorate)([Object(G.d)(A.DataRefreshManagerService),Object(I.__param)(0,Object(A.EwaControlService)()),Object(I.__param)(1,Object(A.OAuthManagerWrapperService)())],fe);Object(M.a)(fe,"DataRefreshManager",U.a,[324]);var Tc=a(8),ed=a(384),pd=a(27);let Kb=class extends ed.a{constructor(){super(Tc.a.pivotTableCantDelete,Tc.a.idle,Tc.a.Wcb);this.wWj=
()=>{this.mr()}}initialize(qa){super.initialize(qa)}execute(qa){const qb=Object(Y.a)(190,qa.ff);L.ULS.sendTraceTag(508359449,0,50,"DeletePivotTableWebMethodActivity.Execute: flushing operations queue.");var bc=qb.userOperationManager.operationCount;0<bc&&L.ULS.sendTraceTag(508359448,0,15,`DeletePivotTableWebMethodActivity.onDeletePivotTableComplete: there are still operations in queue. operations count is [${bc}]`);qb.userOperationManager.s7("DeletePivotTableWebMethodActivity.Execute");bc=Sa.f(qb).Eb.eo(Sa.f(qb).ha.oa.activeRange);
const R=$b.r(pd.Range.Hc(bc.top,bc.left),qb);this.sna(qa,this.wWj,(cb,zb,V)=>la.g(qb.ma.sa,"PerformPivotTableOperation",R,19,cb,zb,V,qa,qb.ma.sa.mc()),qb.ma.sa);return super.execute(qa)}};Kb=Object(I.__decorate)([Object(G.d)(A.DeletePivotTableWebMethodActivityService)],Kb);Object(M.a)(Kb,"DeletePivotTableWebMethodActivity",ed.a,[]);var rb=a(100),rc=a(709),ld=a(134),Tb=a(33),Wc=a(29),Ac=a(491),nd=a(119);let qd=class{constructor(qa,qb){qb||L.ULS.sendTraceTag(537162718,0,15,"FieldManagerPane is null on FieldListCommandHandler creation");
this.$=qa;this.fieldManagerPane=qb;this.Uxh=qa.qa}gd(qa,qb){return(2140436015===qb||-1006032470===qb)&&!(new ld.SheetProtection(this.Uxh)).ie(8192)}executeCommand(qa,qb,bc,R){bc=qb.command;R=R.Oca();switch(bc){case 2140436015:case -1006032470:this.fieldManagerPane&&(this.fieldManagerPane.pZc(!rb.g(this.$.Pf),qb,!1),Wc.a.nva()&&2===qa&&19===qb.Re?(qa=Sa.f(this.$).ha.ob.Wb,R=Sa.f(this.$).ha.ob.Qj?Sa.f(this.$).ha.ob.Qj:"Null",bc=Ac.a(qb.command),qa?(qb=qa.floatingObject,L.ULS.sendTraceTag(537162717,
0,50,"FieldListCommandHandler.ExecuteCommand:ID:{0}, ElementID:{1}, RibbonCommand:{2}, isSVGChart:{3}, isPivotChart:{4}, entryPoint:{5}",qa.floatingObject.Ec,R,bc,!!nd.a.y8(qb),!!(qb.Zc.Attributes&4),"ContextMenu")):L.ULS.sendTraceTag(507351961,6,50,"FieldListCommandHandler.ExecuteCommand: Invalid Floating Object Control. ElementId:{0}, Command:{1}, EntryPoint:{2}",R,bc,"ContextMenu")):L.ULS.sendTraceTag(507352663,0,50,`${2140436015===bc?"Show":"Hide"} Field List`));break;case 589118293:case -1687560254:return this.kuc(!0,
!1,R);case 1176256599:return this.kuc(!1,!1,R);case -1751201991:return this.kuc(!0,!0,R);case -232434744:return this.kuc(!1,!0,R);default:return tb.a(bc)}return N.Task.Va(!0)}Rc(qa,qb){qa=!1;switch(qb.command){case 2140436015:case -1006032470:qa=!0;break;case 589118293:case -1687560254:case 1176256599:case -1751201991:case -232434744:qa=!0}return qa}td(){return!1}kuc(qa,qb,bc){const R=Tb.a.zb.Jc,cb=Sa.f(this.$).ha.oa.activeCell;bc=Object(Yb.d)(G.a.resolve(A.SharedUIControlsFactoryService,{xa:bc}));
return ia.TaskExtensions.tb(bc,()=>{const zb=V=>{if(V){Sa.f(this.$).Bu(!0);const Ea=$b.r(cb,this.$);this.$.enqueueOperation(-867563466,(pb,Jb,zc)=>la.K(this.$.ma.sa,Ea,0,!1,!1,!1,qa,qb,pb,Jb,zc,null,null),R,0,6,161,()=>new rc.a(Ea,qb))}};void G.a.resolve(A.DataRefreshManagerService,{xa:1}).then(V=>{V.KH(!1,zb)})},this.$.Aa,3)}static zKb(qa,qb,bc){const R={};qa.Zk(R);R.FirstRow=qb;R.FirstColumn=bc;return R}};qd=Object(I.__decorate)([Object(G.d)(A.FieldListCommandHandlerService),Object(I.__param)(0,
Object(A.EwaControlService)()),Object(I.__param)(1,Object(A.FieldManagerPaneService)({optional:!0}))],qd);Object(M.a)(qd,"FieldListCommandHandler",null,[29]);class Xd{constructor(qa,qb,bc){this.eva=this.pYd=this.dva=this.uHc=!1;this.anchorType=-1;this.confirmationRequiredForDataOps=!1;this.chartId=this.pivotTableName=null;this.mWe=-1;this.LXe=1;this.A9a=this.VLe=this.ULe=-1;this.fRa=null;if(qa&&(this.Tw=qb,this.dva=this.uHc=!1,qa.la)){var R=Sa.f(qa),cb=qb=null;if(Sb.f(qa.la))bc=fc.a(qa),bc.Zc&&bc.Zc.Attributes&
4&&(this.chartId=bc.chartId,qb=bc.Zc);else if(Sb.i(qa.la)){const zb=R.ha.ob.Wb;zb?(bc=zb.floatingObject)&&0===bc.type&&bc.Zc&&bc.Zc.Attributes&4&&(this.chartId=zb.floatingObject.id,qb=bc.Zc):R.ha.oa.activeCell&&(bc=bc.wQb(),Object(Da.a)(Ub.PivotTableRange,bc)&&(cb=bc))}qb?(this.dva=!0,this.pYd=!!(qb.Attributes&256),this.anchorType=7,this.eva=!!(qb.Attributes&128),this.confirmationRequiredForDataOps=!!(qb.Attributes&64),this.A9a=qb.ExternalSourceIndex,this.fN=qb.FieldListVersion,this.BT=qb.FieldWellVersion,
qb=this.fRa={},qa.Zk(qb),qb.FirstColumn=qb.FirstRow=-1):cb&&(this.uHc=!0,this.pYd=cb.isActionable,this.anchorType=0,this.eva=cb.isOlap,this.confirmationRequiredForDataOps=cb.confirmationRequiredForDataOps,this.A9a=cb.externalSourceIndex,this.fN=cb.Mzi,this.BT=cb.Rzi,this.pivotTableName=cb.pivotTableName,this.fRa=$b.r(cb,qa))}}get P3a(){return this.mWe}set P3a(qa){this.mWe=qa}get Tw(){return this.LXe}set Tw(qa){this.LXe=qa}get fN(){return this.ULe}set fN(qa){this.ULe=qa}get BT(){return this.VLe}set BT(qa){this.VLe=
qa}get fva(){return this.dva||this.uHc}get zuj(){return this.fva&&!this.pYd}get externalSourceIndex(){return this.A9a}get Rw(){return this.fRa}get sheetName(){return this.Rw?this.Rw.SheetName:null}get eLb(){return this.chartId+"_"+this.pivotTableName+"_"+this.fN+"_"+this.BT}K9h(){const qa={};qa.AnchorType=this.anchorType;7===this.anchorType&&(qa.ChartId=this.chartId);qa.AnchorValue1=qa.AnchorValue2=-1;return qa}static Jrc(){return new Xd(null,-1,null)}static create(qa,qb,bc){return new Xd(qa,qb,bc)}static yIc(qa,
qb){return qa.fva!==qb.fva||qa.anchorType!==qb.anchorType||qa.chartId!==qb.chartId||qa.pivotTableName!==qb.pivotTableName||!!qa.Rw&&!!qb.Rw&&qa.Rw.SheetName!==qb.Rw.SheetName}static Z5f(qa,qb){return Xd.yIc(qa,qb)||qa.P3a!==qb.P3a||qa.Tw!==qb.Tw}}Object(M.a)(Xd,"FieldListRequestState",null,[]);let Hd=class{constructor(qa,qb){this.$=qa;this.UH=qb}create(qa=-1){return new Xd(this.$,qa,this.UH)}Jrc(){return new Xd(null,-1,null)}yIc(qa,qb){return qa.fva!==qb.fva||qa.anchorType!==qb.anchorType||qa.chartId!==
qb.chartId||qa.pivotTableName!==qb.pivotTableName||!!qa.Rw&&!!qb.Rw&&qa.Rw.SheetName!==qb.Rw.SheetName}Z5f(qa,qb){return this.yIc(qa,qb)||qa.P3a!==qb.P3a||qa.Tw!==qb.Tw}};Hd=Object(I.__decorate)([Object(G.d)(A.FieldListRequestStateManagerService),Object(I.__param)(0,Object(A.EwaControlService)()),Object(I.__param)(1,Object(A.DataRefreshManagerService)())],Hd);Object(M.a)(Hd,"FieldListRequestStateManager",null,[]);var Zc=a(155);class Jc{constructor(){this.qD=0;this.request=null;this.sq=!0}get correlationId(){return this.qD}Zgg(){return this.qD=
this.correlationId+1}}Object(M.a)(Jc,"DataRequestInfo",null,[]);var gc=a(692);class dd{}Object(M.a)(dd,"CssClassNames",null,[]);var Bb=a(28);const pc=(qa,qb,bc)=>{if(qa)for(let R=0,cb=qa.length;R<cb;R++){const zb=qa[R];zb.ClientId=bc++;zb.ClientParentId=qb;bc=pc(zb.Children,zb.ClientId,bc)}return bc},wc=(qa,qb,bc,R)=>{for(const cb of qa){if(cb.PivotCacheIndex===qb&&(cb.TypeTag===bc||0===bc))return cb;if(R&&(qa=wc(cb.Children,qb,bc,R)))return qa}return null},cd=(qa,qb,bc)=>{if(qa)for(let cb=0,zb=qa.length;cb<
zb;cb++){var R=qa[cb];if(R.ClientId===qb||bc&&(R=cd(R.Children,qb,bc)))return R}return null};var Vd=a(2),xb=a(179),ub=a(1483);class Fc{constructor(qa,qb){this.$=qa;this.fieldManagerPane=qb}HO(qa){Wc.a.Fj()?void G.a.resolve(A.ReactTaskPaneManagerService,{xa:0}).then(qb=>qb.PC("FieldListTaskPane",this.yl(qa,-1,null,null,!1,-1,!1,0,-1,!1,null))):xb.a.li().then(qb=>{qb.showTaskPane("FieldListTaskPane",this.yl(qa,-1,null,null,!1,-1,!1,0,-1,!1,null));return null})}QE(qa,qb,bc,R,cb,zb,V,Ea,pb,Jb,zc){Wc.a.Fj()?
void G.a.resolve(A.ReactTaskPaneManagerService,{xa:0}).then(Mc=>Mc.updateTaskPane("FieldListTaskPane",this.yl(qa,qb,bc,R,cb,zb,V,Ea,pb,Jb,zc))):xb.a.li().then(Mc=>{Mc.updateTaskPane("FieldListTaskPane",this.yl(qa,qb,bc,R,cb,zb,V,Ea,pb,Jb,zc));return null})}YLa(){Wc.a.Fj()?void G.a.resolve(A.ReactTaskPaneManagerService,{xa:0}).then(qa=>qa.setSelectedTaskPane("FieldListTaskPane")):xb.a.li().then(qa=>{qa.setSelectedTaskPane("FieldListTaskPane");return null})}AQ(){Wc.a.Fj()?void G.a.resolve(A.ReactTaskPaneManagerService,
{xa:0}).then(qa=>qa.hideTaskPane("FieldListTaskPane")):xb.a.li().then(qa=>{qa.hideTaskPane("FieldListTaskPane",2);return null})}yl(qa,qb,bc,R,cb,zb,V,Ea,pb,Jb,zc){qa={type:"FieldListTaskPaneProps",fieldListItems:bc,fieldWellsItems:R,dataUpdateType:qb,isDataModel:cb,selectedTab:zb,isSortAscending:V,focusResetType:Ea,focusResetId:pb,isRichPivotFieldList:Jb,fieldListSearchInfo:zc,isOlap:this.fieldManagerPane.eva,isPivotChart:this.fieldManagerPane.dva,fieldListSizePercentage:this.fieldManagerPane.kkk,
onFieldExpandCollapse:this.fieldManagerPane.hkk,onExpandCollapseAll:this.fieldManagerPane.gkk,onFieldCheckedChanged:this.fieldManagerPane.pkk,onFieldListItemMenuClickV2:this.fieldManagerPane.ikk,onSortOrderChanged:this.fieldManagerPane.bkk,onSaveFieldListSizePercentage:this.fieldManagerPane.Akk,onSearchInputChanged:this.fieldManagerPane.jkk,onSelectedTabChanged:Mc=>{this.fieldManagerPane.ckk(Mc)},onFieldMove:(Mc,od,Td,Zd)=>{this.fieldManagerPane.skk(Mc,od,Td,Zd)},onFieldWellItemMenuClickV2:(Mc,od,
Td,Zd)=>{this.fieldManagerPane.lkk(Mc,od,Td,Zd)}};return Object(Vd.a)(new ub.a,{contentProps:qa,onOpen:()=>{this.fieldManagerPane.s3j()},onClose:()=>{this.fieldManagerPane.q3j()},onManualClose:()=>{this.fieldManagerPane.r3j()},title:this.fieldManagerPane.dva?Ia.a.instance.ia(1183):Ia.a.instance.ia(1182),width:400,enableResize:!0,minResizeWidth:400,maxResizeWidth:950})}}Object(M.a)(Fc,"FieldListReactTaskPane",null,[340]);class xd{constructor(qa,qb,bc){this.cachedItemIndex=this.cachedSourceAxis=0;this.cachedItemName=
null;this.cachedSourceAxis=qa;this.cachedItemIndex=qb;this.cachedItemName=bc}}Object(M.a)(xd,"MacroRecorderPivotTablePivotedAdditionalInformation",null,[]);class Ic{constructor(qa,qb,bc,R){this.activeCell=this.additionalInformation=this.pivotData=this.pivotName=null;this.pivotName=qa;this.pivotData=qb;this.additionalInformation=bc;this.activeCell=R}getActiveCell(){return this.activeCell}}Object(M.a)(Ic,"MacroRecorderPivotTablePivotedPayload",null,[67]);var bd=a(197),yb=a(83),Oc=a(99),kd=a(76);Object(G.b)(A.FieldManagerPaneService,
{we:"singleton"})(async qa=>{const qb=await G.a.resolve(A.EwaControlService,qa),[bc,R,cb]=await Promise.all([G.a.resolve(A.ReactTaskPaneManagerService,qa),G.a.resolve(A.DataRefreshManagerService,qa),G.a.resolve(A.FieldListRequestStateManagerService,qa)]);qa=Rc.HLh(qb,bc,R,cb);null===qa||void 0===qa?void 0:qa.I2j();return qa});class Rc extends aa.a{constructor(qa,qb,bc,R,cb){var zb;super(qa);this.TAf=300;this.RX=new Jc;this.TX=new Jc;this.IBd={};this.EFa=this.Cl=this.Al=null;this.JHb=this.qoc=this.Rxc=
!1;this.tHb=this.HSa=null;this.Mka=0;this.$oe=this.nXd=!1;this.DFa=null;this.a3f=this.hk=!1;this.YZh=this.QCg=this.Rfe=null;this.t2b=-1;this.K3=[];this.r2b=!1;this.w3a=null;this.q2b=this.OCg=this.Sfe=!1;this.p2b="";this.v3a=null;this.Cea=0;this.Bea="";this.Pfe=!1;this.MCg=null;this.Rk=!1;this.cS=0;this.pkk=(V,Ea)=>{this.Cl&&this.jva&&(V=cd(this.Cl.FieldListItems,V,!0))&&(L.ULS.sendTraceTag(554317778,0,50,"React Field List: check/uncheck a field."),this.pzj(V,Ea))};this.hkk=V=>{this.Cl&&(V=cd(this.Cl.FieldListItems,
V,!0))&&V.IsCollapsible&&(5===V.TypeTag&&V.IsCollapsed&&!V.Children.length?(this.K3.length=0,this.K3.push(V),this.SFd()):(V.IsCollapsed=!V.IsCollapsed,this.hk&&this.lyc(0,-1,!1,!1,!1,!1)))};this.gkk=V=>{this.Cl&&(L.ULS.sendTraceTag(554317777,0,50,"React Field List: expand/collapse all fields."),0<this.K3.length&&(this.K3.length=0),this.JCg(this.Cl.FieldListItems,V)?this.SFd():this.hk&&this.lyc(0,-1,!1,!1,!1,!1))};this.ikk=(V,Ea,pb)=>{if(this.Cl){var Jb=document.getElementById(Ea);if(Jb){var zc=cd(this.Cl.FieldListItems,
V,!0);if(zc){V={};V.domElement=Jb;V.fieldItem=zc;V.versionkey=this.eLb;V.isChart=!!this.chartId;V.isPpm=this.Cl.IsPpm;V.isOlap=this.currentState.eva;V.supportsImplicitMeasures=this.Cl.SupportsImplicitMeasures;V.isKeyboardInput=pb;this.w3a=Ea;Ea=new yb.a(330754562,0,this.$.xc,30,null);var Mc;this.r2b=!bd.a(Mc=this.$.Ia.Gb(Ea,V))&&(6!==Mc.status||Mc.result)}}}};this.bkk=V=>{L.ULS.sendTraceTag(554317775,0,50,"React Field List: change field list sort order.");const Ea=Rc.vKb(this.currentState);this.$.userOperationManager.enqueueOperation(new Pc.a(251,
0,(pb,Jb,zc)=>{var Mc=this.$.ma.sa;const od=la.M(Mc,this.currentState.Rw,this.currentState.externalSourceIndex,Ea);od.isAscending=V;return la.h(Mc,"ChangePivotFieldListSortOrder",od,pb,Jb,zc,null,0)}),null)};this.Akk=V=>{this.YVe=V};this.jkk=V=>{V!==this.Bea&&(L.ULS.sendTraceTag(537162715,0,50,"React Field List: change search input."),this.Bea=V,this.lyc(0,-1,!1,!0,!1,!1))};this.crg=()=>{if(this.r2b&&this.w3a){const V=document.getElementById(this.w3a);V&&V.classList.add("fieldItemMenuOpen")}};this.brg=
()=>{if(this.r2b&&this.w3a){const V=document.getElementById(this.w3a);V&&(V.classList.remove("fieldItemMenuOpen"),V.classList.contains("fieldItemOnHover")||V.classList.contains("fieldItemOnFocus")||(V.style.visibility="hidden"))}this.r2b=!1;this.w3a=null};this.uwa=()=>{this.Xoe(!0,null);this.hideTaskPane();return!0};this.Sha=()=>{if(this.$)if(kd.a(this.$).mZa&&this.isVisible&&this.currentState.fva&&this.$.fa.yc){if(this.RX.sq&&!this.RX.request){var V=this.RX;var Ea=this.$.ma.sa;var pb=this.currentState.fN,
Jb=this.currentState.P3a,zc=this.currentState.Tw,Mc=this.hZj,od=this.iZj,Td=this.RX.Zgg();const Zd=la.M(Ea,this.currentState.Rw,this.currentState.externalSourceIndex,Rc.vKb(this.currentState));Zd.type=1;Zd.version=pb;Zd.relatedGroup=Jb;Zd.selectedTab=zc;Ea=la.h(Ea,"GetPivotFieldListData",Zd,Mc,od,null,Td,4);V.request=Ea}this.TX.sq&&!this.TX.request&&(V=this.TX,Ea=this.$.ma.sa,pb=this.currentState.BT,Jb=this.kZj,zc=this.lZj,Mc=this.TX.Zgg(),od=la.M(Ea,this.currentState.Rw,this.currentState.externalSourceIndex,
Rc.vKb(this.currentState)),od.type=1,od.version=pb,Ea=la.h(Ea,"GetPivotFieldManagerData",od,Jb,zc,null,Mc,4),V.request=Ea)}else Rc.x6(this.RX),Rc.x6(this.TX)};this.hZj=(V,Ea)=>{this.Wyg(V,Ea,this.RX)&&(V=V.Result)&&(this.currentState.fN=V.FieldListVersion,this.RX.sq=!1,this.J7g(V));this.UH.vAe();this.refresh()};this.iZj=V=>{this.nlg(V,this.RX)};this.kZj=(V,Ea)=>{this.Wyg(V,Ea,this.TX)&&(V=V.Result)&&(this.currentState.BT=V.FieldWellVersion,this.TX.sq=!1,this.v7g(V));this.refresh()};this.lZj=V=>{this.nlg(V,
this.TX)};this.gTj=V=>{if(ec.a.zf(V.Errors)){this.JHb=!1;this.HSa=null;for(let pb=0,Jb=V.Errors.length;pb<Jb;++pb)if(1244452614===V.Errors[pb].MessageId){if(La.EwaSettings.isChangeGateEnabled("OfficeVSO:4354463_UpdateSelectionAfterApplyPivot")){V=Sa.f(this.$);var Ea=V.Eb.eo(V.ha.oa.activeCell);Ea&&(Ea=pd.Range.Hc(Ea.$Lg+1,Ea.left),Ea=$b.y(Ea,this.$),V.lj(Ea,null,null,null,3,"FieldManagerPane.OnApplyPivotSuccess"))}this.currentState.fN=-1;this.currentState.BT=-1;this.refresh();break}}this.Rxc=!0};
this.wXj=V=>{this.qoc=!1;if(!ec.a.zf(V.Errors)){if(0<this.K3.length)for(V=0;V<this.K3.length;++V)this.K3[V].IsCollapsed=!1;this.currentState.fN=-1;this.refresh()}};this.swa=()=>{const V=Sa.f(this.$).ha;V.ob.LXd&&V.gf&470||Sa.f(this.$).inRangePicker||Sa.f(this.$).nk||this.C2b(!0,!0)};this.fg=()=>{this.refresh();this.$.fa.el.FieldListForceOnTop&&this.pZc(!1,null,!0)};this.VNc=()=>{this.C2b(!0,!0)};this.de=()=>{this.C2b(!0,!1)};this.Gj=(V,Ea)=>{V=Sb.e(Ea.Vx)||Sb.e(Ea.la);this.C2b(!0,V)};this.Px=(V,Ea)=>
{for(const pb of Ea.lgl)this.K7g(pb);this.nXd&&(this.nXd=!1);this.C2b(!1,!0)};this.yng=(V,Ea)=>{Sa.f(this.$).Au||this.K7g(Ea.he.hash)};this.fkg=()=>{this.refresh()};this.yd=()=>{this.tO()};this.Ln=()=>{this.tO()};this.Atg=()=>{this.refresh()};this.Sug=()=>{this.Sha()};this.currentState=cb.Jrc();this.UH=R;this.$=qb;this.Pf=qb.Pf;this.taskPaneManager=bc;this.mhb=cb;this.xqa(this.Atg);this.Vvj=La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotFieldList",
!1);this.YVe=.5;this.DFa=new Fc(this.$,this);this.$.Ia.REh(this.crg);this.$.Ia.GFb(this.brg);this.TAf=400;Bb.a.equals("rtl",qa.dir,!0)&&(this.Rk=!0);this.Qzi=[4,2,1,8];this.$.Ul(this.de);qa=Sa.f(this.$);qa.za.$t(this.yng);qa.h6(this.Px);fc.a(this.$).za.$t(this.fkg);qa.ha.add_activeCellChanged(this.swa);qa.KJ(this.swa);qa.ha.ob.SDh(this.VNc);null===(zb=Oc.a(this.$))||void 0===zb?void 0:zb.Yod(this.VNc);this.$.qa.mh(this.Gj);this.$.fa.au(this.fg);this.$.fa.Vk(this.yd);this.$.fa.LJ(this.Ln);kd.a(this.$).jod(this.Sug);
C.a(this.$).hl(this);this.refresh()}xqa(qa){this.addHandler(Rc.$wc,qa)}Bxa(qa){this.removeHandler(Rc.$wc,qa)}QDh(qa){this.addHandler(Rc.SAf,qa)}Lsk(qa){this.removeHandler(Rc.SAf,qa)}PDh(qa){this.addHandler(Rc.RAf,qa)}Ksk(qa){this.removeHandler(Rc.RAf,qa)}get pivotName(){return this.currentState.pivotTableName}get chartId(){return this.currentState.chartId}get Rw(){return this.currentState.Rw}get eva(){return this.currentState.eva}get dva(){return this.currentState.dva}get confirmationRequiredForDataOps(){return this.currentState.confirmationRequiredForDataOps}get externalSourceIndex(){return this.currentState.externalSourceIndex}get fN(){return this.currentState.fN}get BT(){return this.currentState.BT}get eLb(){return this.currentState.eLb}get isRtl(){return this.Rk}get zre(){return this.jGb}get jva(){return!(!this.isVisible||
this.RX.sq||this.TX.sq||this.qoc||this.JHb)}get parentElement(){return this.$.domElement}get ud(){return this.domElement}get isVisible(){return super.isVisible}set isVisible(qa){qa=this.qmc&&qa;!qa||this.tHb||this.a3f||this.Sgj();qa!==super.isVisible&&(super.isVisible=qa,this.raiseEvent(Rc.$wc));this.sEg(null,qa)}get ij(){return this.isVisible}get tf(){return kc.a.Ozi}get Q6a(){return 1}get gs(){return Za.a.Cui}get cL(){return this.TAf}get isResizable(){return!0}get titleText(){return Ia.a.instance.ia(1182)}get kkk(){return this.YVe}get OG(){return this.taskPaneManager.dib(this.ud,
this.titleText,this.cL,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.cL)}get jGb(){return this.$.$b.Uaa(36896)&&this.qmc}get qmc(){const qa=new ld.SheetProtection(this.$.qa);return this.$.isEditMode&&qa.ie(8192)||!qa.Ih}get wci(){return(this.pivotName||"")+(this.chartId||"")}dA(){}GQ(){return this.jGb&&!rb.g(this.Pf)}v2(){const qa=this.mhb.create(this.t2b);return qa.fva&&!qa.zuj&&!rb.g(this.Pf)}y3e(qa,qb){(qa=wc(this.Cl.FieldListItems,
qa,this.currentState.eva?5:17,!0))&&qa.CanDrag&&this.$P(qa,qb,0,null,null)}$P(qa,qb,bc,R,cb){let zb;if(R&&!Bb.a.equals(R,this.eLb,!1))alert(Ia.a.instance.La(18));else{R=this.TFf(qa.PivotCacheIndex,qa.PivotTableIndex);var V=R.axis,{pos:Ea,ixg:pb}=R;-1!==qa.PivotTableIndex?zb=V:(Ea=zb=0,pb=qa.PivotCacheIndex);if(0===zb){if(7===qa.TypeTag&&(qa=0<=qa.ClientParentId?cd(this.Cl.FieldListItems,qa.ClientParentId,!0):null,!qa))return;Ea=0;pb=qa.PivotCacheIndex}if(zb!==qb||0===qb||Ea!==bc&&Ea!==bc-1){var Jb=
new xd(V,qa.PivotCacheIndex,qa.Name);this.UH.KH(this.currentState.confirmationRequiredForDataOps,zc=>{zc&&this.applyPivot(this.currentState,zb,Ea,qa.TypeTag,pb,qb,bc,cb,Sa.f(this.$),Jb,qa)})}}}skk(qa,qb,bc,R){if(this.Cl&&this.Al){var cb=null;switch(qb){case 0:cb=cd(this.Cl.FieldListItems,qa,!0);break;case 1:cb=cd(this.Al.RowAxis,qa,!1);break;case 2:cb=cd(this.Al.ColumnAxis,qa,!1);break;case 4:cb=cd(this.Al.FilterAxis,qa,!1);break;case 8:cb=cd(this.Al.DataAxis,qa,!1)}cb&&(L.ULS.sendTraceTag(554317779,
0,50,"React Field List: drag and drop a field."),this.$P(cb,bc,R,null,null))}}JCg(qa,qb){let bc;bc=!1;for(let R=0;R<qa.length;R++){const cb=qa[R];qb&&cb.IsCollapsible&&5===cb.TypeTag&&cb.IsCollapsed&&!cb.Children.length?(this.K3.push(cb),bc=!0):qb&&cb.IsCollapsible&&cb.IsCollapsed?cb.IsCollapsed=!1:qb||!cb.IsCollapsible||cb.IsCollapsed||(cb.IsCollapsed=!0);cb.IsCollapsible&&cb.Children&&0<cb.Children.length&&this.JCg(cb.Children,qb)&&(bc=!0)}return bc}lyc(qa,qb,bc,R,cb,zb){if(this.Cl){var V=!1,Ea=
!1,pb=!1,Jb=null;Ea=null;var zc=qa;R&&0<this.K3.length&&(this.K3.length=0);({zRb:Ea,GEa:pb,isRichPivotFieldList:V,returnValue:Jb}=this.nJd(this.Cl.FieldListItems,R,!1));pb?this.qoc||this.SFd():(Ea={needSearchReset:zb,needSearchRestore:!zb&&cb,searchRestoreValue:!zb&&cb?this.Bea:"",searchWithNoMatch:""!==this.Bea&&!Ea},Ea.searchWithNoMatch&&R&&ia.TaskExtensions.tb(La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)?Object(Yb.d)(G.a.resolve(A.AriaLiveNotifierService,
{xa:0})):jc.GetServiceTaskFactory.Ne(this.$.ra,211,212,0),Mc=>{Mc.result.readText(Ia.a.instance.ia(778))},this.$.Aa,3),""!==this.Bea&&2===qa&&(Ea.searchWithNoMatch?zc=1:bc&&Jb&&0<Jb.length&&(qb=Jb[0].id)),this.DFa.QE(this.tHb,0,Jb,null,this.Cl.IsPpm,this.Cl.SelectedTab,this.Cl.IsSortAscending,zc,qb,V,Ea))}}ckk(qa){L.ULS.sendTraceTag(554317776,0,50,"React Field List: change All/Active tab.");this.t2b=qa;this.J2k()}lkk(qa,qb,bc,R){if(this.Al){var cb=document.getElementById(bc);if(cb){var zb=null,V=
-1;switch(qb){case 4:zb=cd(this.Al.FilterAxis,qa,!1);V=this.Al.FilterAxis.length;break;case 2:zb=cd(this.Al.ColumnAxis,qa,!1);V=this.Al.ColumnAxis.length;break;case 1:zb=cd(this.Al.RowAxis,qa,!1);V=this.Al.RowAxis.length;break;case 8:zb=cd(this.Al.DataAxis,qa,!1),V=this.Al.DataAxis.length}if(zb){var Ea={};this.currentState.dva?(Ea.AnchorType=8,Ea.ChartId=this.currentState.chartId):Ea.AnchorType=9;Ea.AnchorValue1=zb.PivotTableIndex;Ea.AnchorValue2=zb.PivotCacheIndex;var {axis:pb,pos:Jb}=this.TFf(zb.PivotCacheIndex,
zb.PivotTableIndex);qa=new yb.a(-1453503574,0,this.$.xc,30,null);qb={};qb.domElement=cb;qb.fieldItem=zb;qb.zoneCount=V;qb.sourceAxis=pb;qb.sourceAxisPos=Jb;qb.optionalPivotMenuAnchorParameter=Ea;qb.isOlap=this.currentState.eva;qb.isPpm=this.Cl.IsPpm;qb.versionkey=this.eLb;qb.isKeyboardInput=R;qb.cell=this.currentState.Rw;qb.externalSourceIndex=this.externalSourceIndex;R=!1;La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&this.currentState.eva&&!this.Cl.IsPpm&&
this.Cl.SupportsImplicitMeasures&&(zb=wc(this.Cl.FieldListItems,zb.PivotCacheIndex,5,!0),R=!!zb&&!zb.IsCollapsible);qb.fieldItemsupportsImplicitMeasures=R;this.w3a=bc;var zc;this.r2b=!bd.a(zc=this.$.Ia.Gb(qa,qb))&&(6!==zc.status||zc.result)}}}}KCg(qa,qb){qa&&ia.TaskExtensions.tb(jc.GetServiceTaskFactory.Ne(this.$.ra,103,104,0),bc=>{var R=bc.result;const cb=Sa.f(this.$),zb=$b.y(pd.Range.Hc(1,1),this.$).SheetName;bc=R.X7a(cb);let V,Ea,pb,Jb;bc?(R=bc.nf,V=R.Fd.top,Ea=R.Fd.left,pb=bc.ZO.x,Jb=bc.ZO.y):
(V=Ea=1,bc=R.VGa(cb),pb=bc.x,Jb=bc.y);this.$.userOperationManager.enqueueOperation(new Pc.a(203,0,(zc,Mc,od)=>ic.y(this.$.ma.sa,zb,this.pivotName,qa.PivotCacheIndex,qb,V,Ea,pb,Jb,zc,Mc,od,null),void 0,()=>new gc.a(zb,this.pivotName,qa.PivotCacheIndex,qb)),null)},this.$.Aa,8)}dispose(){var qa;if(this.$){this.$.tm(this.de);this.$.Ia.Itk(this.crg);this.$.Ia.x3b(this.brg);this.K3.length=0;const qb=Sa.f(this.$);qb&&(qb.yZ(this.Px),qb.xL(this.swa),qb.ha&&(qb.ha.remove_activeCellChanged(this.swa),qb.ha.ob.Nsk(this.VNc)),
qb.za&&qb.za.yu(this.yng));null===(qa=Oc.a(this.$))||void 0===qa?void 0:qa.aje(this.VNc);qa=fc.a(this.$);(null===qa||void 0===qa?0:qa.za)&&qa.za.yu(this.fkg);this.$.qa&&this.$.qa.xh(this.Gj);if(qa=this.$.fa)qa.Bv(this.fg),qa.Qk(this.yd),qa.zL(this.Ln);kd.a(this.$)&&kd.a(this.$).VTc(this.Sug)}this.taskPaneManager&&this.Bxa(this.Atg);this.Rfe&&(wa.a.instance.Ua(S.a.click,this.Rfe,this.uwa),Zc.a.instance.$Z(this.Rfe,this.YZh));this.hideTaskPane();this.taskPaneManager=this.$=this.DFa=null;super.dispose()}Nj(qa,
qb){if(!qb){qa=oa.DOMElementExtensions.Fz(this.domElement.querySelectorAll(oa.DOMElementExtensions.$D));if(!qa)return!1;oa.DOMElementExtensions.setFocus(qa)}return!qb}zk(qa){return oa.DOMElementExtensions.Ki(this.ud,qa)}Hm(){}fo(){}J2k(){this.refresh()}pzj(qa,qb){qa&&qa.CanDrag&&this.$P(qa,qb?-1:0,-1,null,null)}I2j(){this.GQ()&&this.v2()&&(this.isVisible=!0)}s3j(){this.Sfe=!0;this.refresh()}q3j(){this.hideTaskPane()}r3j(){this.Xoe(!0,null);this.hideTaskPane()}Sgj(){this.a3f=this.hk=!0;this.DFa.HO(this.tHb)}showTaskPane(){this.isVisible=
!0;""!==this.Bea&&(this.Pfe=!0);this.hk?this.DFa.YLa():(this.hk=!0,this.DFa.HO(this.tHb))}hideTaskPane(){this.isVisible=this.Sfe=this.hk=!1;this.DFa.AQ()}pZc(qa,qb,bc){this.Xoe(qa,qb);this.nXd=bc;this.$oe=!qa&&!!qb||bc;qa?this.hideTaskPane():this.showTaskPane()}SFd(){this.UH.KH(this.currentState.confirmationRequiredForDataOps,qa=>{qa&&this.expandPivotFieldListLevels(this.currentState)})}J7g(qa){if(this.Cl=qa)this.currentState.fN=this.Cl.FieldListVersion,this.Mka=pc(this.Cl.FieldListItems,-1,this.Mka);
if(this.Cl)if(this.hk){this.t2b=this.currentState.Tw=this.Cl.SelectedTab;this.wDj();qa=-1;var qb=0,bc=!1;this.$oe?(this.Cl.FieldListItems&&0<this.Cl.FieldListItems.length&&(qa=this.Cl.FieldListItems[0].ClientId,qb=2,bc=!0),this.$oe=!1):this.Rxc&&0===this.Cea&&(this.v3a||this.q2b?this.Cl.FieldListItems&&0<this.Cl.FieldListItems.length&&(qa=this.q2b?this.Cl.FieldListItems[0].ClientId:this.v3a.ClientId,qb=2,bc=this.q2b):this.OCg&&(qa=this.Cl.FieldListItems[0].ClientId,qb=1),this.Ppc());var R=!1;this.MCg!==
this.Cl.PivotXluid&&(this.MCg=this.Cl.PivotXluid,R=!0,this.Bea="");this.lyc(qb,qa,bc,!1,!R&&this.Pfe&&""!==this.Bea,R);this.Pfe=!1}else this.Ppc()}Ppc(){this.Cea=0;this.v3a=null;this.p2b="";this.Rxc=this.q2b=this.OCg=!1}$Sk(qa){return 7===qa.TypeTag?!1:qa.ShowFilterArrow||qa.ShowCheckBox}rzj(qa){return qa.IsCollapsible&&(!qa.IsCollapsed||2===qa.Image)&&!!qa.Children&&0<qa.Children.length}zRb(qa,qb){const bc=qb.length;return 2<bc&&'"'===qb.charAt(0)&&'"'===qb.charAt(bc-1)?Bb.a.contains(qa,qb.substring(1,
bc-1),!0):Bb.a.Oeb(qb,"*")||Bb.a.Oeb(qb,"?")?(qb=qb.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&"),qb="^"+Bb.a.wsb(Bb.a.wsb(qb,"\\\\?",".",!0),"\\\\*",".*",!0)+"$",0<=qa.search(new RegExp(qb,"i"))):Bb.a.contains(qa,qb,!0)}nJd(qa,qb,bc){let R,cb,zb,V;R=V=zb=cb=!1;const Ea=[];for(let Jb=0;Jb<qa.length;Jb++){const zc=qa[Jb];let Mc=!1,od=!1,Td=!1,Zd,xe=[];if(""===this.Bea){if(this.rzj(zc)){var pb=void 0;({zRb:od,GEa:Zd,fTf:pb,isRichPivotFieldList:Mc,returnValue:xe}=this.nJd(zc.Children,qb,!1));
zc.ShowCheckBox||(zc.IsChecked=pb)}}else 2!==zc.Image&&this.zRb(zc.Name,this.Bea)&&(R=Td=!0,qb&&zc.IsCollapsible&&zc.IsCollapsed&&(5!==zc.TypeTag||zc.Children.length?zc.IsCollapsed=!1:(this.K3.push(zc),cb=!0))),qb&&bc&&zc.IsCollapsible&&zc.IsCollapsed&&(5!==zc.TypeTag||zc.Children.length?zc.IsCollapsed=!1:(this.K3.push(zc),cb=!0)),zc.IsCollapsible&&zc.Children&&0<zc.Children.length&&({zRb:od,GEa:Zd,fTf:pb,isRichPivotFieldList:Mc,returnValue:xe}=this.nJd(zc.Children,qb,Td||bc),zc.ShowCheckBox||(zc.IsChecked=
pb),od&&(R=!0,qb&&(zc.IsCollapsed=!1)),Zd&&(cb=!0));this.Vvj&&(Mc||66===zc.TypeTag)&&(V=!0);zc.IsChecked&&(zb=!0);(""===this.Bea||Td||od||bc)&&Ea.push({id:zc.ClientId,name:zc.Name,type:zc.TypeTag,isCollapsible:zc.IsCollapsible,showCheckBox:zc.ShowCheckBox,isMoreFields:2===zc.Image,canDrag:zc.CanDrag&&7!==zc.TypeTag,showSeparator:zc.ShowSeparator,showMenu:this.$Sk(zc),isCollapsed:zc.IsCollapsed,isChecked:zc.IsChecked,isBolded:zc.IsBolded,children:xe})}return{returnValue:Ea,zRb:R,GEa:cb,fTf:zb,isRichPivotFieldList:V}}ryc(qa){const qb=
Array(qa.length);for(let bc=0;bc<qa.length;bc++){const R=qa[bc];qb[bc]={id:R.ClientId,name:R.Name}}return qb}DCk(){this.hNg(this.Cl.FieldListItems,"")}wDj(){this.R9f(this.Cl.FieldListItems,"")}Zwc(qa,qb){return qa.Name+"_"+qa.UniqueName+"_"+qa.TypeTag+"_"+(qb||this.wci)}hNg(qa,qb){if(qa)for(let bc=0,R=qa.length;bc<R;bc++){const cb=qa[bc];let zb="";if(cb.IsCollapsible||cb.Children)zb=this.Zwc(cb,qb),cb.IsCollapsible&&(this.IBd[zb]=!!cb.IsCollapsed),cb.Children&&this.hNg(cb.Children,zb);this.v3a&&cb.ClientId===
this.v3a.ClientId&&(this.p2b=zb||this.Zwc(cb,qb))}}R9f(qa,qb){if(qa)for(let bc=0,R=qa.length;bc<R;bc++){const cb=qa[bc];let zb="";if(cb.IsCollapsible||cb.Children)zb=this.Zwc(cb,qb),cb.IsCollapsible&&zb in this.IBd&&(cb.IsCollapsed=Ba.a.rh(this.IBd,zb)),cb.Children&&this.R9f(cb.Children,zb);this.p2b&&Bb.a.equals(this.p2b,zb||this.Zwc(cb,qb),!1)&&(this.v3a=cb,this.p2b="")}}v7g(qa){if(this.Al=qa)this.currentState.BT=this.Al.FieldWellVersion,this.Mka=pc(this.Al.FilterAxis,-1,this.Mka),this.Mka=pc(this.Al.ColumnAxis,
-1,this.Mka),this.Mka=pc(this.Al.RowAxis,-1,this.Mka),this.Mka=pc(this.Al.DataAxis,-1,this.Mka);this.EFa?this.EFa.length=0:this.EFa=[];if(this.Al)if(this.EFa.push(this.Al.FilterAxis),this.EFa.push(this.Al.ColumnAxis),this.EFa.push(this.Al.RowAxis),this.EFa.push(this.Al.DataAxis),this.hk){qa=-1;var qb=0;if(this.Rxc&&0!==this.Cea){switch(this.Cea){case 1:0<this.Al.RowAxis.length&&(qa=this.Al.RowAxis[0].ClientId,qb=3);break;case 2:0<this.Al.ColumnAxis.length&&(qa=this.Al.ColumnAxis[0].ClientId,qb=3);
break;case 4:0<this.Al.FilterAxis.length&&(qa=this.Al.FilterAxis[0].ClientId,qb=3);break;case 8:0<this.Al.DataAxis.length&&(qa=this.Al.DataAxis[0].ClientId,qb=3)}this.Ppc()}var bc={filtersWellItems:this.ryc(this.Al.FilterAxis),columnsWellItems:this.ryc(this.Al.ColumnAxis),rowsWellItems:this.ryc(this.Al.RowAxis),valuesWellItems:this.ryc(this.Al.DataAxis)};this.DFa.QE(this.tHb,1,null,bc,!1,-1,!1,qb,qa,!1,null)}else this.Ppc()}Dcl(){this.QCg&&(this.QCg.innerText=this.currentState.dva?Ia.a.instance.ia(1183):
this.titleText)}refresh(){if(this.Sfe){var qa=this.mhb.create(this.t2b);this.sEg(qa)}}sEg(qa,qb=!1){if(this.isVisible){qa=qa||this.mhb.create(this.t2b);const bc=this.currentState;this.Cl&&this.DCk();this.currentState=qa;if(this.mhb.Z5f(bc,qa)||qb){if(this.JHb=!1,this.RX.sq=qa.fva,Rc.x6(this.RX),this.mhb.yIc(bc,qa)||qb)this.TX.sq=qa.fva,Rc.x6(this.TX),this.J7g(null),this.v7g(null),this.Dcl()}else bc.fN<qa.fN?(this.RX.sq=!0,Rc.x6(this.RX)):this.currentState.fN=bc.fN,bc.BT<qa.BT?(this.JHb=!1,this.TX.sq=
!0,Rc.x6(this.TX)):this.currentState.BT=bc.BT}ta.a.instance.create(this.Sha,0,pa.a.Nzi,!0,!0)}Xoe(qa,qb){this.applyPivotFieldManagerHiddenState(qa,qb);this.Pf=Va.HelperMethods.OV(qa,this.Pf,4);this.refresh();this.raiseEvent(Rc.$wc);this.$.Sg()}applyPivotFieldManagerHiddenState(qa,qb){this.$.userOperationManager.enqueueOperation(new Pc.a(144,0,(bc,R,cb)=>{const zb=$b.r(Sa.f(this.$).ha.oa.activeCell,this.$);var V=this.$.ma.sa;const Ea=V.$a(9);Ea.hidden=qa;Ea.activeCell=zb;return la.h(V,"ApplyPivotFieldManagerHiddenStateV2",
Ea,bc,R,cb,null,0)},16),qb)}Wyg(qa,qb,bc){bc.sq=!1;if(!bc.request||qb!==bc.correlationId)return!1;bc.request=null;return ec.a.zf(qa.Errors)?(this.$.fa.ur(qa.Errors),!1):!0}nlg(qa,qb){const bc=$c.a.te(qa.data);this.$.fa.ur(bc);qb.request=null;10!==qa.data.status&&(qb.sq=!1);this.Sha()}applyPivot(qa,qb,bc,R,cb,zb,V,Ea,pb,Jb,zc){0<pb.getRangeInformation(pb.ha.oa.activeCell).length?this.JHb=!0:(this.RX.sq=!0,this.TX.sq=!0);qa.uHc&&(this.HSa=qa.pivotTableName);const Mc=Rc.vKb(qa),od={FieldListType:1};
od.FieldListVersion=qa.fN;od.FieldWellVersion=qa.BT;od.SourceAxis=qb;od.SourceAxisPosition=bc;od.ItemType=R;od.ItemIndex=cb;od.DestinationAxis=zb;od.DestinationAxisPosition=V;this.Yel(zc,qb,zb);qb=new Pc.a(145,0,(Td,Zd,xe)=>{var pe=this.$.ma.sa;Td=Ca.c(Td,this.gTj);const Re=la.M(pe,qa.Rw,qa.externalSourceIndex,Mc);Re.pivotFieldApplyData=od;return la.h(pe,"ApplyPivot",Re,Td,Zd,xe,null,0)},4,()=>new Ic(this.pivotName,od,Jb,qa.Rw));this.$.userOperationManager.enqueueOperation(qb,Ea)}Yel(qa,qb,bc){if(this.Cl&&
this.Al)if(0===qb)this.Cea=0,this.v3a=qa;else if(0!==bc)this.Cea=bc;else switch(this.Cea=0,this.q2b=!0,qb){case 1:1<this.Al.RowAxis.length&&(this.Cea=1);break;case 2:1<this.Al.ColumnAxis.length&&(this.Cea=2);break;case 4:1<this.Al.FilterAxis.length&&(this.Cea=4);break;case 8:1<this.Al.DataAxis.length&&(this.Cea=8)}}expandPivotFieldListLevels(qa){const qb=Rc.vKb(qa);this.qoc=!0;this.$.userOperationManager.enqueueOperation(new Pc.a(146,0,(bc,R,cb)=>{var zb=this.$.ma.sa;bc=Ca.c(bc,this.wXj);const V=
la.M(zb,qa.Rw,qa.externalSourceIndex,qb);V.type=1;return la.h(zb,"ExpandPivotFieldListLevels",V,bc,R,cb,null,0)}),null)}TFf(qa,qb){var bc;for(let cb=Rc.xbh;cb<=Rc.ybh;cb++){const zb=this.EFa[cb];for(bc=zb.length-1;0<=bc;bc--){var R=zb[bc];if(R.PivotCacheIndex===qa&&(-1===qb||R.PivotTableIndex===qb))return qa=this.MXi(cb),R=R.PivotTableIndex,{returnValue:!0,axis:qa,pos:bc,ixg:R}}}return{returnValue:!1,axis:0,pos:-1,ixg:-1}}Yyj(qa){return qa>=Rc.xbh&&qa<=Rc.ybh}clear(){this.currentState=this.mhb.Jrc();
this.refresh()}MXi(qa){return this.Yyj(qa)?this.Qzi[qa]:0}C2b(qa,qb){qa&&(this.HSa=null);this.refresh();qb&&(!this.hk&&this.v2()&&this.GQ()?this.showTaskPane():!this.hk||this.GQ()&&this.v2()||this.hideTaskPane())}IIi(){var qa=Sa.f(this.$);let qb=null;qa=qa.getRangeInformation(qa.ha.oa.activeCell);for(let bc=0,R=qa.length;bc<R;++bc){const cb=qa[bc];if(Object(Da.a)(Ub.PivotTableRange,cb)){qb=cb.pivotTableName;break}}return qb}K7g(qa){const qb=Sa.f(this.$);var bc=qb.za.ti(qa);if(bc){if(this.HSa){qa=
bc.ranges;if(!qa)return;for(bc=qa.length-1;0<=bc;--bc){var R=qa[bc];if(Object(Da.a)(Ub.PivotTableRange,R)&&Bb.a.equals(R.pivotTableName,this.HSa,!1)){qa=this.IIi();qa&&Bb.a.equals(qa,this.HSa,!1)||(qa=$b.y(R.topLeft,this.$),qb.lj(qa,null,null,null,0,"FieldManagerPane.UpdateFieldsPaneStatus"));this.HSa=null;break}}}Sa.f(this.$).Au||this.refresh()}else L.ULS.sendTraceTag(537162690,0,15,`Block ${qa} was removd from BlockManager`)}tO(){this.clear()}static HLh(qa,qb,bc,R){const cb=document.getElementById(qa.Oc+
fa.a.Pzi);return cb?new Rc(cb,qa,qb,bc,R):(L.ULS.sendTraceTag(537162688,0,15,"FieldManagerPane creation fails: FieldManagerPaneDiv is null."),null)}static vKb(qa){const qb={};qb.AnchorType=qa.anchorType;7===qa.anchorType&&(qb.ChartId=qa.chartId,qb.AnchorValue1=qb.AnchorValue2=-1);return qb}static x6(qa){qa.request&&(Wa.AFrameworkApplication.od.dy(qa.request.sx),qa.request=null)}}Rc.$wc="fieldListPaneVisibilityChanged";Rc.SAf="FieldListPaneChanging";Rc.RAf="FieldListPaneChanged";Rc.xbh=0;Rc.ybh=3;
Object(M.a)(Rc,"FieldManagerPane",aa.a,[323,4,229,24]);var Xb=a(19),dc=a(257),Vc=a(182);class yd{constructor(){this.qtc=this.sourceRange=this.hna=null}}Object(M.a)(yd,"SelectedRangeForPivot",null,[]);var Pd=a(875),re=a(432),ue=a(238),He=a(130);class bf{static get wj(){return ue.a.qw(bf.akj,He.a.ia(66),He.a.ia(67),He.a.ia(68),He.a.ia(69),He.a.ia(70),He.a.ia(71),He.a.ia(72))}}bf.akj="<div class='DataSourceDiv' id='DataSourceDiv'> <div class='WACDialogRow' id='dataAnalyzeTitle'> <label id='dataChoice' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='sourceRadio'> <label id='sourceSelectLabel' class='WACDialogLabel' >{1}</label> </div> <div class='ewa-insertpt-dlg-sourceRange WACDialogRowNoBreak' id='sourceRangeText'> <label id='tableOrRange' class='ewa-insertpt-dlg-label' for='SourceRange' >{2}</label> <input type='text' id='sourceRange' class='WACDialogInput ewa-insertpt-dlg-input' aria-describedby=\"dataChoice . sourceSelectLabel\" maxlength=\"1024\" spellcheck=\"false\" autocomplete=\"off\" autocomplete=\"off\"/> </div> </div> <div class='PivotDestinationDiv' id='PivotDestinationDiv'> <div class='WACDialogRow' id='destinationTitle'> <label id='destinationLabel' class='WACDialogLabel' >{3}</label> </div> <div class='WACDialogRowNoBreak' id='destinationPickNewWorksheet'> <input type='radio' id='newWorksheet' name='destinationRadio' class='WACDialogRadio ewa-insertpt-label' alt='{4}' aria-describedby=destinationLabel title='{4}'></input> <label id='newWorksheetLabel' class='WACDialogLabel' for='newWorksheet' >{4}</label> </div> <div class='WACDialogRowNoBreak' id='destinationPickExistingWorksheet'> <input type='radio' id='existingWorksheet' name='destinationRadio' class='WACDialogRadio ewa-insertpt-label' alt='{5}' aria-describedby=destinationLabel title='{5}'></input> <label id='existingWorksheetLabel' class='WACDialogLabel' for='existingWorksheet' >{5}</label> <div class='WACDialogRowNoBreak' id='destinationRangeText'> <label id='Location' class='ewa-insertpt-dlg-label' for='DestinationRange' >{6}</label> <input type='text' id='destinationRange' class='WACDialogInput ewa-insertpt-dlg-input' maxlength=\"1024\" spellcheck=\"false\" autocomplete=\"off\" autocomplete=\"off\"/> </div> </div>";
Object(M.a)(bf,"InsertPivotTableDialogHtml",null,[]);var af=a(177);class Pe{constructor(qa,qb){this.hjc=qa;this.Esh=qb;this.hSc=null}get Za(){return this.hjc}get vrb(){return this.Esh}bindAction(qa){this.vrb&&qa&&(this.hSc=qa,this.vrb.dDh(this.hSc))}D$k(){this.vrb&&this.hSc&&this.vrb.esk(this.hSc)}isValid(){return!!this.vrb&&!!this.Za}}Object(M.a)(Pe,"TextBoxRadioButtonPair",null,[363]);var wf=a(1168),xf=a(333);class Cf{constructor(qa,qb){this.title=qa;this.wj=qb}}Object(M.a)(Cf,"DialogData",null,
[]);const tf=(qa,qb,bc,R,cb,zb,V,Ea=null)=>{Ea=qa.$a(41,Ea);Ea.sheetRange=qb;Ea.destinationRange=bc;return la.h(qa,"InsertPivotTable",Ea,R,cb,zb,V,0)},Jf=(qa,qb,bc,R,cb,zb,V,Ea=null)=>{Ea=qa.$a(1,Ea);Ea.sheetRange=qb;Ea.activeCell=bc;return la.h(qa,"GetExpandedRangeForPivotTable",Ea,R,cb,zb,V,0)},dg=(qa,qb,bc,R,cb,zb,V,Ea,pb=null)=>{pb=qa.$a(41,pb);pb.activeCell=qb;pb.newRange=bc;pb.isDataSource=R;return la.h(qa,"ChangePivotLocation",pb,cb,zb,V,Ea,0)},uf=(qa,qb,bc,R,cb,zb,V=null)=>{V=qa.$a(1,V);V.activeCell=
qb;return la.h(qa,"GetDataSourceRangeForPivotTable",V,bc,R,cb,zb,0)};class lf{constructor(qa,qb){this.destinationRange=this.sourceRange=null;this.sourceRange=qa;this.destinationRange=qb}}Object(M.a)(lf,"MacroRecorderPivotTableCreatedPayload",null,[67]);var Pf=a(447),Rf=a(191),Mf=a(271);class zf extends Pf.a{constructor(qa){super(qa)}bjb(qa){let qb,bc=({xIc:qb}=super.bjb(qa)).returnValue;if(!bc){const R=Object(Y.a)(Mf.a,this.$.wc);R&&R.Bl(qa)&&(bc=(qa=R.getItemByName(qa))&&1!==qa.type?2===qa.type?
Rf.a(qa):qa.usedRange:null,qb=2===qa.type)}return{returnValue:bc,xIc:qb}}}Object(M.a)(zf,"PivotTableRangeHighlightPolicy",Pf.a,[]);class df extends re.a{constructor(qa,qb){super(qa,new zf(qa));this.Lwe=this.destinationRange=this.gja=this.KJa=this.l6a=null;this.WMa=!1;this.vz=0;this.vof="";this.xXf=(bc,R)=>{this.hide();if(1===bc){let cb=bc="";2!==this.vz&&(bc=df.Obe(R[df.$Zc],this.$.qa),this.NZk(bc,this.$)&&L.ULS.sendTraceTag(537155781,0,50,"InsertPivotTableDialog.InsertPivotTableDialogHandler - Source does not have enough entries"));
1!==this.vz&&R[df.OFd]&&(cb=df.Obe(R[df.ptc],this.$.qa));2===this.vz&&cb===this.vof||this.njj(bc,cb)}else this.r7b(!0),L.ULS.sendTraceTag(537155780,0,50,"InsertPivotTableDialog.InsertPivotTableDialogHandler - cancel was clicked.")};this.wu=()=>{this.$9b()};this.GNc=()=>{this.destinationRange.disabled=!this.gja.checked;this.$9b();return!1};this.slg=()=>{this.$9b();return!1};this.ltg=()=>{this.$9b();return!1};this.a$d=bc=>{if(Ga.a(bc))this.r7b(!0),L.ULS.sendTraceTag(537155742,0,50,"InsertPivotTableDialog.OnInsertPivotTableDone - failed.");
else{L.ULS.sendTraceTag(537155743,0,50,"InsertPivotTableDialog.OnInsertPivotTableDone - success.");const R=bc.Result;if(R){if(bc=this.$.qa.getItemByName(R.SheetName))bc.activate({scenario:"pivotTable"}),this.da.lj(R,null,null,null,3,"InsertPivotTableDialog.OnInsertPivotTableDone"),this.r7b(!0),0===this.vz&&this.HJk(),bc=fa.a.ySc,bc!==af.a(this.$).um.Tw&&(af.a(this.$).u3a(2),af.a(this.$).um.activateRibbonTab(bc))}else this.r7b(!0)}};this.da=Sa.f(this.$);this.uY=Pd.a.instance;this.uD=!1;-1128516639===
qb?(this.vz=1,L.ULS.sendTraceTag(537155785,0,50,"InsertPivotTableDialog.InsertPivotTableDialog - for PivotTable Operation Change data Source")):-63037693===qb?(this.vz=2,L.ULS.sendTraceTag(537155784,0,50,"InsertPivotTableDialog.InsertPivotTableDialog - for PivotTable Operation Move PivotTable")):L.ULS.sendTraceTag(537155783,0,50,"InsertPivotTableDialog.InsertPivotTableDialog")}dispose(){L.ULS.sendTraceTag(537155782,0,50,"InsertPivotTableDialog.Dispose");this.k2c();super.dispose()}get Tc(){return"InsertPivotTableDialog"}get pIb(){return!0}get ndf(){return!0}get ldf(){return!0}SWa(){return[df.$Zc,
df.ptc]}Xfi(){let qa=!1;2!==this.vz&&(qa=df.Zfi(this.l6a.value));qa||1===this.vz||(qa=df.Yfi(this.gja.checked,this.destinationRange.value));return qa}get hR(){return()=>{let qa=this.destinationRange.value;1!==this.vz&&this.destinationRange.disabled&&(qa="");this.xXf(1,df.UJf(this.l6a.value,qa))}}MDc(qa){L.ULS.sendTraceTag(537155779,0,50,"InsertPivotTableDialog.InitAndShow");const qb=this.SKd();this.wj=qb.wj;var bc="";2!==this.vz&&(bc=df.Obe(qa.hna,this.$.qa));bc=df.UJf(bc,qa.qtc);1!==this.vz&&2===
this.vz&&(this.vof=qa.qtc);this.r7b(!1);this.initializeAndShow(qb.title,this.xXf,bc);this.Bve();this.SJk();this.$9b();L.ULS.sendTraceTag(537155778,0,50,"InsertPivotTableDialog.InitAndShow completed.")}NZk(qa,qb){let bc=!1;qa=({xIc:bc}=(new zf(qb)).bjb(qa)).returnValue;return!!qa&&qa.w8&&!bc}$9b(){this.pdb.disabled=this.Xfi()}Bve(){this.uY.va(S.a.change,this.KJa,this.GNc);this.uY.va(S.a.change,this.gja,this.GNc);this.uY.va(S.a.Ye,this.l6a,this.ltg);this.uY.va(S.a.Ye,this.destinationRange,this.slg);
this.aDh(this.wu);this.WMa=!0}k2c(){this.WMa&&(this.uY.Ua(S.a.change,this.KJa,this.GNc),this.uY.Ua(S.a.change,this.gja,this.GNc),this.uY.Ua(S.a.Ye,this.l6a,this.ltg),this.uY.Ua(S.a.Ye,this.destinationRange,this.slg),this.csk(this.wu),this.WMa=!1)}SJk(){2===this.vz?this.destinationRange.focus():this.l6a.focus()}P_g(){const qa=new xf.a(this.destinationRange),qb=new wf.a(this.gja,!1);this.Lwe=new Pe(qa,qb);this.Dve(this.Lwe)}C6g(){this.tze(this.Lwe)}cE(){super.cE();L.ULS.sendTraceTag(537155777,0,50,
"InsertPivotTableDialog.InitializeDialogElements");this.l6a=document.getElementById(df.$Zc);this.KJa=document.getElementById(df.ihg);this.gja=document.getElementById(df.OFd);this.destinationRange=document.getElementById(df.ptc);switch(this.vz){case 0:case 2:this.destinationRange.value?df.JSg(this.gja,this.KJa):(this.destinationRange.disabled=!0,df.JSg(this.KJa,this.gja));rb.l(this.$.Pf)&&(this.KJa.checked=!1,this.KJa.disabled=!0,this.destinationRange.value="",this.gja.checked=!0);if(2===this.vz){this.l6a.disabled=
!0;var qa=document.getElementById(df.Fci);qa.style.visibility="hidden";qa.style.display="none"}break;case 1:this.destinationRange.disabled=!0,this.KJa.disabled=!0,this.gja.disabled=!0,qa=document.getElementById(df.jbk),qa.style.visibility="hidden",qa.style.display="none"}}njj(qa,qb){L.ULS.sendTraceTag(537155744,0,50,"InsertPivotTableDialog.InitiateInsertPivotTableOperation");const bc=this.$.ma.sa;let R=1;const cb=bc.mc(),zb=$b.r(Sa.f(this.$).ha.oa.activeCell,this.$);let V=null,Ea=null;switch(this.vz){case 0:R=
132;V=(pb,Jb,zc)=>tf(bc,qa,qb,Ca.c(pb,this.a$d),Jb,zc,null,cb);Ea=()=>new lf(qa,qb);break;case 2:R=219;V=(pb,Jb,zc)=>dg(bc,zb,qb,!1,Ca.c(pb,this.a$d),Jb,zc,null,cb);break;case 1:R=219,V=(pb,Jb,zc)=>dg(bc,zb,qa,!0,Ca.c(pb,this.a$d),Jb,zc,null,cb)}Ed.a(this.$.userOperationManager,V,pb=>new Pc.a(R,0,pb,void 0,Ea),null)}SKd(){let qa=0;switch(this.vz){case 0:qa=65;break;case 1:qa=2157;break;case 2:qa=2153}return new Cf(Ia.a.instance.ia(qa),bf.wj)}HJk(){const qa=G.a.Cb(A.FieldManagerPaneService);qa&&qa.pZc(!1,
null,!0)}r7b(qa){Wc.a.Fj()?G.a.Cb(A.ReactTaskPaneManagerService):this.$.ra.Tb(183);qa&&this.da.$h&&this.da.$h.Jt(fa.a.I7)}set pIb(qa){super.pIb=qa}set hR(qa){super.hR=qa}static UJf(qa,qb){const bc=!qb;return{[df.$Zc]:qa,[df.ptc]:qb,[df.ihg]:bc,[df.OFd]:!bc}}static JSg(qa,qb){qa.tabIndex=df.VDi;qb.tabIndex=df.$Pj}static Obe(qa,qb){let bc,R;qa=qa.startsWith("=")?qa.substring(1,qa.length):qa;({sheetName:bc,range:R}=$b.kb(qa,qb)).returnValue&&R&&(bc||(bc=qb.la.name),qa=$b.A(R,bc,!1,!0));return qa}static Zfi(qa){return Bb.a.uu(qa)}static Yfi(qa,
qb){return qa&&Bb.a.uu(qb)}}df.Csf="";df.VDi=0;df.$Pj=-1;df.$Zc="sourceRange";df.ptc="destinationRange";df.ihg="newWorksheet";df.OFd="existingWorksheet";df.Fci="DataSourceDiv";df.jbk="PivotDestinationDiv";Object(M.a)(df,"InsertPivotTableDialog",re.a,[]);var Bf;let Kf=Bf=class{constructor(qa){this.BSd=!1;this.wcb=null;this.$=qa;this.da=Sa.f(qa);Object(Xb.d)(dc.a).execute(qb=>{this.wcb=qb;qb.isFeatureEnabled(Bf.rVf,!1).then(bc=>this.BSd=bc);qb.oLa(Bf.rVf,bc=>{this.BSd=bc.isEnabled})})}gd(){return!1}executeCommand(qa,
qb,bc){var R;qa=ia.TaskExtensions.kl();const cb=qb.command;let zb;const V=new Vc.a;qb=this.da.ha.oa;switch(cb){case 2137617149:qa=null!==(R=bc.tpl)&&void 0!==R?R:qb.selectedRanges;this.lZi(qa,V);if(Wc.a.v1f(this.$)&&this.BSd){const Jb=new Vc.a;V.task.jw(zc=>{bc.SourceSelection=bd.b(zc)&&zc.result&&zc.result.hna?zc.result.hna:"";return this.$.Dc(-1444574190,0,0,bc).continueWith(Mc=>{bd.b(Mc)&&Mc.result||(zb=new df(this.$,cb),zb.MDc(zc.result));Jb.setResult(!0)})});qa=Jb.task}else zb=new df(this.$,
cb),qa=V.task.continueWith(()=>{zb.MDc(V.task.result)});break;case -1128516639:const Ea=this.$.ma.sa.mc(),pb=$b.r(qb.activeCell,this.$);R=new Pc.a(554,0,(Jb,zc,Mc)=>uf(this.$.ma.sa,pb,Ca.c(Jb,od=>{this.eng(od,V,!1)}),Ca.b(zc,()=>{Bf.dng(V,this.$)}),Mc,null,Ea),88);R.sMa(()=>!0);this.$.userOperationManager.enqueueOperation(R,null);zb=new df(this.$,cb);qa=V.task.continueWith(()=>{zb.MDc(V.task.result)});break;case -63037693:R=new yd;if(qb=this.da.Eb.eo(qb.activeCell))qb=pd.Range.Hc(qb.$Lg+1,qb.left),
R.qtc=$b.j(qb,this.$,!0,void 0,!0);V.setResult(R);zb=new df(this.$,cb);qa=V.task.continueWith(()=>{zb.MDc(V.task.result)})}return qa}eng(qa,qb,bc){const R=qa.Result,cb=new yd;if(bc||R){const zb=this.da.ha.oa.vi;Ga.a(qa)?zb&&(cb.hna=this.da.ha.wNf(!0)):(cb.hna=R,zb&&bc&&this.ami()&&!this.da.Eb.dg(this.da.ha.oa.Ed)&&(cb.qtc=this.da.ha.xyc(!0,!0)))}else if(qa=this.da.Eb.eo(this.da.ha.oa.activeCell))cb.hna=qa.dataSource;qb.setResult(cb)}ami(){var qa=this.da.ha.oa.activeCell;qa=new pd.Range(qa.top,qa.left,
qa.top+1,qa.left+1,!1,!1);qa=this.da.Np("InsertPivotTableCommandHandler.EmptySquareAdjToActiveCell",qa);try{for(qa.$$rst();qa.$$mn();)if(qa.$$cu().text)return!1}finally{qa&&qa.dispose()}return!0}lZi(qa,qb){if(1!==qa.length)qb.setResult(Object(Vd.a)(new yd,{hna:""}));else{qa=qa[0];const bc=this.da.Eb.dg(qa);if(bc)qb.setResult(Object(Vd.a)(new yd,{hna:bc.name,sourceRange:bc.usedRange}));else{const R=this.$.ma.sa.mc(),cb=$b.r(qa,this.$),zb=$b.y(qa,this.$);qa=new Pc.a(511,0,(V,Ea,pb)=>Jf(this.$.ma.sa,
zb,cb,Ca.c(V,Jb=>{this.eng(Jb,qb,!0)}),Ca.b(Ea,()=>{Bf.dng(qb,this.$)}),pb,null,R),88);qa.sMa(()=>!0);this.$.userOperationManager.enqueueOperation(qa,null)}}}Rc(qa,qb){qa=!1;switch(qb.command){case -1128516639:case -63037693:case 2137617149:qa=!0}return qa}td(){return!1}static dng(qa,qb){L.ULS.sendTraceTag(537155786,0,50,"OnGetExpandedRangeForPivotTableFailedCallback: Failure. failing over to the selected range.");Sa.f(qb).ha.oa.vi?qa.setResult(Object(Vd.a)(new yd,{hna:Sa.f(qb).ha.Xra})):qa.setResult(Object(Vd.a)(new yd,
{hna:""}))}};Kf.rVf="ExcelIdeas";Kf=Bf=Object(I.__decorate)([Object(G.d)(A.InsertPivotTableCommandHandlerService),Object(I.__param)(0,Object(A.EwaControlService)()),Object(I.__param)(1,Object(A.SheetOpsHelperService)())],Kf);Object(M.a)(Kf,"InsertPivotTableCommandHandler",null,[29]);var Vf=a(431);class sb extends Vf.a{constructor(qa,qb,bc){super(qa);this.b6a=null;this.isPivot=!1;this.XTd=(R,cb)=>{1===R?(R=cb.indices,L.ULS.sendTraceTag(537155741,0,50,`InsertSlicerDialog.ClickedOK: User clicked OK, inserting ${R.length} Slicers`),
0<R.length&&this.zBd(R,0)):L.ULS.sendTraceTag(537155740,0,50,"InsertSlicerDialog.Dismissed: User dismissed the dialog")};this.mng=R=>{this.b6a=R.Result;R={["id"]:this.Tc,["singleDimFields"]:this.b6a};this.initializeAndShow(Ia.a.instance.ia(2154),this.XTd,R)};this.da=Sa.f(qa);this.oa=this.da.ha.oa;this.ha=Sa.f(qa).ha;this.tableName=qb;this.sheetName=bc;this.isPivot=Sa.f(qa).Eb.eo(this.ha.oa.activeCell)?!0:!1;L.ULS.sendTraceTag(543511326,0,50,"InsertSlicerDialog.Constructor: User Opened Insert Slicer Dialog");
this.ojj()}get Tc(){return"InsertSlicerDialog"}zBd(qa,qb){ia.TaskExtensions.tb(jc.GetServiceTaskFactory.Ne(this.$.ra,103,104,0),bc=>{var R=bc.result,cb=Sa.f(this.$),zb=R.X7a(cb);if(zb){var V=zb.nf;bc=V.Fd.top;V=V.Fd.left;R=zb.ZO.x;zb=zb.ZO.y}else bc=V=1,zb=R.VGa(cb),R=zb.x,zb=zb.y;cb=0;for(const Ea of qa)this.bkj(parseInt(Ea,10),qb,bc,V,R+cb,zb+cb),cb+=22},this.$.Aa,8)}bkj(qa,qb,bc,R,cb,zb){const V=new Pc.a(203,0,(Ea,pb,Jb)=>{const zc=this.$.ma.sa.mc();return this.isPivot?ic.y(this.$.ma.sa,this.sheetName,
this.tableName,qa,qb,bc,R,cb,zb,Ea,pb,Jb,zc):ic.z(this.$.ma.sa,this.sheetName,this.tableName,qa,qb,bc,R,cb,zb,Ea,pb,Jb,zc)},void 0,()=>new gc.a(this.sheetName,this.tableName,qa,qb));this.$.userOperationManager.enqueueOperation(V,null)}ojj(){const qa=new Pc.a(596,0,(qb,bc,R)=>{const cb=this.$.ma.sa.mc();return this.isPivot?ic.l(this.$.ma.sa,this.tableName,this.sheetName,Ca.c(qb,this.mng),bc,R,cb):ic.m(this.$.ma.sa,this.tableName,this.sheetName,Ca.c(qb,this.mng),bc,R,cb)},16);this.$.userOperationManager.enqueueOperation(qa,
null)}}Object(M.a)(sb,"InsertSlicerDialog",Vf.a,[]);class Gc extends Vf.a{constructor(qa,qb,bc){super(qa);this.b6a=null;this.XTd=(R,cb)=>{1===R?(R=cb.indices,L.ULS.sendTraceTag(507650643,0,50,`InsertTimeSlicerDialog.ClickedOK: User clicked OK, inserting ${R.length} TimeSlicers`),0<R.length&&this.zBd(R,1)):L.ULS.sendTraceTag(507650642,0,50,"InsertTimeSlicerDialog.Dismissed: User dismissed the dialog")};this.xZj=R=>{(this.b6a=R.Result)&&0<this.b6a.length?(R={["id"]:this.Tc,["singleDimFields"]:this.b6a},
this.initializeAndShow(Ia.a.instance.ia(2463),this.XTd,R)):this.dispose()};this.pivotTableName=qb;this.sheetName=bc;L.ULS.sendTraceTag(0,0,50,"InsertTimeSlicerDialog.Constructor: User Opened Insert Timeline Slicer Dialog");this.pjj()}get Tc(){return"InsertTimeSlicerDialog"}zBd(qa,qb){ia.TaskExtensions.tb(jc.GetServiceTaskFactory.Ne(this.$.ra,103,104,0),bc=>{var R=bc.result,cb=Sa.f(this.$),zb=R.X7a(cb);if(zb){var V=zb.nf;bc=V.Fd.top;V=V.Fd.left;R=zb.ZO.x;zb=zb.ZO.y}else bc=V=1,zb=R.VGa(cb),R=zb.x,
zb=zb.y;cb=0;for(const Ea of qa)this.fkj(parseInt(Ea,10),qb,bc,V,R+cb,zb+cb),cb+=22},this.$.Aa,8)}fkj(qa,qb,bc,R,cb,zb){const V=new Pc.a(203,0,(Ea,pb,Jb)=>{const zc=this.$.ma.sa.mc();return ic.y(this.$.ma.sa,this.sheetName,this.pivotTableName,qa,qb,bc,R,cb,zb,Ea,pb,Jb,zc)},void 0,()=>new gc.a(this.sheetName,this.pivotTableName,qa,qb));this.$.userOperationManager.enqueueOperation(V,null)}pjj(){const qa=new Pc.a(596,0,(qb,bc,R)=>{const cb=this.$.ma.sa.mc();return ic.n(this.$.ma.sa,this.pivotTableName,
this.sheetName,Ca.c(qb,this.xZj),bc,R,cb)},16);this.$.userOperationManager.enqueueOperation(qa,null)}}Object(M.a)(Gc,"InsertTimeSlicerDialog",Vf.a,[]);let ad=class{constructor(qa){this.activeCell=this.kc=null;this.$=qa;this.ha=Sa.f(this.$).ha}gd(){return!1}executeCommand(qa,qb){qa=ia.TaskExtensions.kl();qb=qb.command;this.activeCell=this.ha.oa.activeCell;switch(qb){case -100176241:case -1924368815:this.kc=Sa.f(this.$).Eb.eo(this.activeCell);var bc=Sa.f(this.$).Eb.dg(this.activeCell,!1);if(null!=bc&&
La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableSlicerInsertion",!1)){if(!(this.kc&&this.kc.isOlap||!this.kc&&!Sa.f(this.$).ha.oa.fE())){qb=this.kc?this.kc.pivotTableName:null;var R=this.$.qa.la.sheetName;bc=bc?bc.name:null;null==qb?new sb(this.$,bc,R):new sb(this.$,qb,R)}}else this.kc&&!this.kc.isOlap&&new sb(this.$,this.kc.pivotTableName,this.$.qa.la.sheetName);break;case -817408114:this.kc=Sa.f(this.$).Eb.eo(this.activeCell);if(!this.kc||this.kc.isOlap||!La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TimelineSlicers",
!1))break;new Gc(this.$,this.kc.pivotTableName,this.$.qa.la.sheetName);break;case -1949853173:qb=Sa.f(this.$).Eb.dg(this.activeCell,!1),null!=qb&&La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableSlicerInsertion",!1)&&new sb(this.$,qb?qb.name:null,this.$.qa.la.sheetName)}return qa}Rc(qa,qb){qa=!1;switch(qb.command){case -100176241:qa=!0;break;case -1924368815:qa=!0;break;case -817408114:qa=!0;break;case -1949853173:qa=!0}return qa}td(){return!1}};ad=Object(I.__decorate)([Object(G.d)(A.InsertSlicerCommandHandlerService),
Object(I.__param)(0,Object(A.EwaControlService)())],ad);Object(M.a)(ad,"InsertSlicerCommandHandler",null,[29]);var Wd=a(127),je=a(1370),Ie=a(240),Je=a(89),$e;let Ib=$e=class extends Wd.a{constructor(qa=Tc.a.Lue,qb=Tc.a.U8){super(qa,qb)}execute(qa){const qb=Object(Y.a)(190,qa.ff),bc=da.a.current.pO;qa.activityState[Je.a.QS]=Je.a.Fob;qa.activityState[Je.a.Haa]=$e.r7h(qb,bc.OfferPowerBiTrialUrl,bc.OfferPowerBiTrialCompleteSignUpParameter);qa.activityState[Je.a.$md]=!0;qb.Nm.BD("PowerBiTrial");return 3}static r7h(qa,
qb,bc){qa=new Sys.StringBuilder(qa.isEditMode?qa.workbookContext.FullDocumentInfo.HostEditUrl:qa.workbookContext.FullDocumentInfo.HostViewUrl);Ie.a.ol(qa,je.a.Bhk,"1");qa=encodeURIComponent(qa.toString());return`${qb}&${"ru"}=${bc}${encodeURIComponent(`?${"returnUrl"}=${qa}`)}`}};Ib=$e=Object(I.__decorate)([Object(G.d)(A.OfferPowerBiTrialService)],Ib);Object(M.a)(Ib,"OfferPowerBiTrialActivity",Wd.a,[]);var Nb=a(663),Bc=a(1458),Af=a(1267),gf=a(70),Qe=a(58),Aa=a(713);const Fb=(qa,qb,bc,R,cb,zb,V,Ea=
null)=>{Ea=qa.$a(41,Ea);Ea.activeCell=qb;Ea.showDrillInIndicator=bc;return la.h(qa,"PivotTableShowExpandButton",Ea,R,cb,zb,V,0)},Ta=(qa,qb,bc,R,cb,zb,V=null)=>{V=qa.$a(41,V);V.activeCell=qb;return la.h(qa,"PivotTableShowDetails",V,bc,R,cb,zb,0)},Eb=(qa,qb,bc,R,cb,zb,V,Ea,pb,Jb=null)=>{Jb=qa.$a(41,Jb);Jb.activeCell=qb;Jb.option=bc;Jb.userInputText=R;Jb.userInputInt=cb;return la.h(qa,"PivotTableSettingsPaneOperations",Jb,zb,V,Ea,pb,0)};class oc{constructor(qa,qb,bc,R,cb){this.pivotTableName=this.activeCell=
null;this.opType=0;this.userInputText=null;this.userInputInt=0;this.activeCell=qa;this.pivotTableName=qb;this.opType=bc;this.userInputText=R;this.userInputInt=cb}getActiveCell(){return this.activeCell}}Object(M.a)(oc,"MacroRecorderPivotTableSettingsPaneOperationsPayload",null,[67]);let Lc=class{constructor(qa){this.activeCell=this.kc=null;this.s5j=qb=>{Ga.a(qb)||(qb=this.$.qa.getItemByName(qb.Result.toString()),(null===qb||void 0===qb?0:qb.name)&&qb.activate({scenario:"pivotTable"}),qb=document.querySelector(".ewa-stb-tabs .tab-active"),
this.z8k(qb))};this.TZj=qb=>{qb&&!ec.a.zf(qb.Errors)&&this.I1d(qb.Result)};this.SZj=()=>{};this.VZj=qb=>{qb&&!ec.a.zf(qb.Errors)&&this.J1d(qb.Result)};this.UZj=()=>{};this.RZj=(qb,bc)=>{qb&&!ec.a.zf(qb.Errors)&&this.E1d(qb.Result,bc)};this.QZj=()=>{};this.$=qa;this.ha=Sa.f(this.$).ha}gd(){return!1}executeCommand(qa,qb,bc){qa=ia.TaskExtensions.kl();const R=qb.command,cb=this.$.ma.sa;let zb=null,V=1;const Ea=this.$.ma.sa.mc();this.activeCell=$b.r(this.ha.oa.activeCell,this.$);this.kc=Sa.f(this.$).Eb.eo(this.ha.oa.activeCell);
switch(R){case 498319061:L.ULS.sendTraceTag(537154699,0,50,"PivotCommand.ExecuteCommand: PivotTableShowExpandButton is triggered");if(!this.kc)return qa;zb=(pb,Jb,zc)=>Fb(cb,this.activeCell,!this.kc.showDrillIndicators,pb,Jb,zc,null,Ea);V=218;break;case 1529441790:ia.TaskExtensions.tb(Object(Yb.d)(G.a.resolve(A.PivotTableSettingsPaneManagerService,{xa:0})),pb=>{(pb=pb.result)&&pb.yVk()},this.$.Aa,3);break;case -1556797033:this.kc&&this.xNd(this.TZj,this.SZj);break;case -1611233597:this.kc&&this.xNd(this.VZj,
this.UZj);break;case 786260386:this.kc&&(bc=Number.parseInvariant(bc.MenuItemId),this.xNd(this.RZj,this.QZj,bc));break;case 1771091375:this.showDetails();break;case 1359615388:this.O5k();break;case 1143507712:this.Del(bc.Text);break;default:qa=tb.a(R)}zb&&(qa=Ed.a(this.$.userOperationManager,zb,pb=>new Pc.a(V,0,pb,void 0,null),qb));return qa}Rc(qa,qb){qa=!1;switch(qb.command){case 498319061:case 1529441790:case -1556797033:case 786260386:case -1611233597:qa=!0;break;case 1771091375:qa=!0;break;case 1359615388:qa=
!0;break;case 1143507712:qa=!0}return qa}td(){return!1}dispose(){this.$=null}Del(qa){this.$.userOperationManager.enqueueOperation(new Pc.a(225,0,(qb,bc,R)=>Eb(this.$.ma.sa,this.activeCell,1,qa,0,qb,bc,R,null),64,()=>new oc(this.activeCell,this.kc.pivotTableName,1,qa,0)),null)}O5k(){const qa=this.kc.autoRefresh?0:1;this.$.userOperationManager.enqueueOperation(new Pc.a(225,0,(qb,bc,R)=>Eb(this.$.ma.sa,this.activeCell,22,"",qa,qb,bc,R,null),64,()=>new oc(this.activeCell,this.kc.pivotTableName,22,"",
qa)),null)}showDetails(){Ed.a(this.$.userOperationManager,(qa,qb,bc)=>Ta(this.$.ma.sa,this.activeCell,Ca.c(qa,this.s5j),qb,bc,null),qa=>new Pc.a(262,0,qa,void 0,null),null)}z8k(qa){const qb=Object(Xb.d)(Nb.a);qb&&qa?(qb.execute(bc=>{bc.logActivity("TeachingUIForShowDetails",null)}),L.ULS.sendTraceTag(523613786,0,50,"TeachingUIForShowDetails triggered an LPP activity")):L.ULS.sendTraceTag(523613787,0,15,"TeachingUIForShowDetails failed to get a sifFuture")}xNd(qa,qb,bc=0){this.$.userOperationManager.enqueueOperation(new Pc.a(1016,
0,(R,cb,zb)=>la.r(this.$.ma.sa,this.activeCell,this.kc.externalSourceIndex,this.kc.pivotTableName,this.$.domElement.id,this.$.isChromeRtl,this.$.workbookContext.NovMode,Ca.c(R,qa),Ca.b(cb,qb),zb,0!==bc?bc:null,null,!0),16),null)}I1d(qa){if(this.E_d(qa))if(this.F_d(qa)){var qb=qa.PivotFields[0];if(this.z_d(qb)){var bc={};bc.FieldId=qb.IdString;bc.Location=this.activeCell;bc.DataSourceIndex=this.kc.externalSourceIndex;bc.SelectedFieldIndex=qb.SortByValueIndex;var R=qb.DisplayString;R.length>Bc.i&&(R=
R.substring(0,Bc.i)+"...");bc.ColumnName=ba.a.$l(R);bc.SortAscend=qb.IsSortedAscending&&qb.IsSortedByValue;qa=Object(Vd.a)(new Aa.a,{pivotName:this.kc.pivotTableName,Y7b:bc,CEa:this.uta(qa.PivotDataItems,!1),DEa:this.uta(qa.PivotDataItems,!0)});this.$.Dc(-1681601147,gf.a.Hb,0,{["launchSortByValueDialogCommandData"]:qa})}else this.Wi(154,"AutoFilterSortByValueIncorrectSelection")}else this.Wi(750,"SortByValueNoDataFields")}J1d(qa){if(this.E_d(qa))if(this.F_d(qa)){var qb=qa.PivotFields[0];if(this.z_d(qb)){var bc=
{};bc.FilterType=Bc.e;bc.AdvancedFilter=qa.AdvancedFiltering;bc.Location=this.activeCell;bc.DataSourceIndex=this.kc.externalSourceIndex;bc.MaxCount=Bc.a;bc.Title=qb.DisplayString;bc.IsPivotFilter=!0;bc.FieldId=qb.IdString;bc.AnchorType=0;(qb=qb.FilterParameter)?(bc.Count=0<qb.FilterValue?qb.FilterValue.toString():"",bc.Top=qb.IsTopFilter,bc.Type=qb.FilterType,bc.SelectedFieldIndex=Bc.g(qa.PivotDataFields,qb.DataFieldId)):(bc.Count=Bc.b,bc.Top=!0,bc.Type=1,bc.SelectedFieldIndex=Bc.j);qb=new yb.a(856841605,
gf.a.Hb,this.$.xc,0,null);var R={};R.Top10FilterParameters=bc;R.PivotName=this.kc.pivotTableName;R.DataFieldIds=this.uta(qa.PivotDataFields,!1);R.DataFieldNames=this.uta(qa.PivotDataFields,!0);qa={};qa[gf.a.Bf]=Qe.a.Nc(R);this.$.Ia.Gb(qb,qa)}}else this.Wi(246,"ValueFilterNoDataFields")}E_d(qa){return 1===qa.PivotFields.length}F_d(qa){return 0<qa.PivotDataFields.length&&0<qa.PivotDataItems.length}z_d(qa){return!qa.IsDataField&&!qa.IsFieldInPageFilterArea}E1d(qa,qb){if(this.E_d(qa))if(Af.e(qb)&&!this.F_d(qa))this.Wi(246,
"ValueFilterNoDataFields");else{var bc=qa.PivotFields[0];if(this.z_d(bc)){var R=this.mBi(bc.PivotFilterParameters,qb),cb={};cb.ActiveCompareType=this.mci(qb);cb.ShowDataFields=Af.e(qb);cb.FilterType=this.RQi(qb);cb.ValueTypeText=Af.b(qb);cb.Location=this.activeCell;cb.ColumnName=bc.DisplayString;cb.IsPivotFilter=!0;cb.IsTimeSlicer=!1;cb.NonNumericCaptionFilteringEnabled=bc.IsNonnumericCaptionFilteringEnabled;cb.FieldId=bc.IdString;cb.AnchorType=0;cb.ControlGroupOrder=Bc.h();cb.ShowWholeDays=bc.IsDateField&&
!Af.e(qb);cb.EnabledWholeDays=bc.IsEnabledWholeDays;cb.WholeDays=bc.IsWholeDays;cb.MemberProperties=!1;cb.SelectedFieldIndex=Bc.j;R&&(Af.e(qb)||bc.IsDataField?(cb.Value1=R.FilterValue1.toString(),cb.Value2=R.FilterValue2.toString(),Af.e(qb)&&(cb.SelectedFieldIndex=Bc.g(qa.PivotDataFields,R.DataFieldId))):(cb.Value1=R.FilterString1,cb.Value2=R.FilterString2));qb=new yb.a(-2042011094,gf.a.Hb,this.$.xc,0,null);R={};R.CustomFilterParameters=cb;R.FieldId=bc.IdString;R.PivotName=this.kc.pivotTableName;
R.DataFieldIds=this.uta(qa.PivotDataFields,!1);R.DataFieldNames=this.uta(qa.PivotDataFields,!0);qa={};qa[gf.a.Bf]=Qe.a.Nc(R);this.$.Ia.Gb(qb,qa)}}}uta(qa,qb){const bc=[];for(let R=0;R<qa.length;++R)qb?bc.push(qa[R].DisplayString):bc.push(qa[R].IdString);return bc}mci(qa){switch(qa){case 4:case 18:case 26:return 0;case 5:case 19:case 62:return 1;case 6:return 2;case 7:return 3;case 8:return 4;case 9:return 5;case 10:return 6;case 11:return 7;case 12:case 20:case 28:return 8;case 13:case 21:case 64:return 9;
case 14:case 22:case 27:return 10;case 15:case 23:case 63:return 11;case 16:case 24:case 29:return 12;case 17:case 25:case 65:return 13}return 14}RQi(qa){return Af.b(qa)?Bc.c:Af.e(qa)?Bc.f:Af.c(qa)?Bc.d:""}mBi(qa,qb){for(let bc=0;bc<qa.length;++bc)if(qa[bc].FilterType===qb)return qa[bc];return null}Wi(qa,qb){qa=ec.a.Cd(1,0,0,qa,0,0,qb);Db.a(this.$).Wi(qa)}};Lc=Object(I.__decorate)([Object(G.d)(A.PivotCommandHandlerService),Object(I.__param)(0,Object(A.EwaControlService)()),Object(I.__param)(1,Object(A.SheetOpsHelperService)()),
Object(I.__param)(2,Object(A.ReactEnvironmentManagerService)())],Lc);Object(M.a)(Lc,"PivotCommandHandler",null,[29,4]);class Jd{constructor(){this.jxg=0;this.kxg=null}}Object(M.a)(Jd,"PivotTableSettingsPaneOperationsUserContext",null,[]);class Ab{constructor(qa,qb){this.$=qa;this.Jqb=qb}HO(){Wc.a.Fj()?void G.a.resolve(A.ReactTaskPaneManagerService,{xa:0}).then(qa=>qa.PC("PivotTableSettingsTaskPane",this.yl(null,!1,!1,!1,null,!1,!1))):xb.a.li().then(qa=>{qa.showTaskPane("PivotTableSettingsTaskPane",
this.yl(null,!1,!1,!1,null,!1,!1));return null})}QE(qa,qb,bc,R,cb,zb,V){Wc.a.Fj()?void G.a.resolve(A.ReactTaskPaneManagerService,{xa:0}).then(Ea=>Ea.updateTaskPane("PivotTableSettingsTaskPane",this.yl(qa,qb,bc,R,cb,zb,V))):xb.a.li().then(Ea=>{Ea.updateTaskPane("PivotTableSettingsTaskPane",this.yl(qa,qb,bc,R,cb,zb,V));return null})}AQ(){Wc.a.Fj()?void G.a.resolve(A.ReactTaskPaneManagerService,{xa:0}).then(qa=>qa.hideTaskPane("PivotTableSettingsTaskPane")):xb.a.li().then(qa=>{qa.hideTaskPane("PivotTableSettingsTaskPane",
2);return null})}yl(qa,qb,bc,R,cb,zb,V){qa={type:"PivotTableSettingsTaskPaneProps",settingsInfo:qa,isRangeChanged:qb,isNativePivotTable:bc,expandAllByDefault:!0,hasLessThanTwoRowFields:R,sectionCollapseStates:this.Jqb.sectionCollapseStates,needFocusOnFirstElement:zb,supportsAutoRefresh:V,onSaveSectionCollapseState:(Ea,pb)=>{this.Jqb.onSaveSectionCollapseState(Ea,pb)},onSettingChange:(Ea,pb,Jb)=>{this.Jqb.V2j(Ea,pb,Jb,cb)}};return Object(Vd.a)(new ub.a,{contentProps:qa,onOpen:()=>{this.Jqb.l3()},onClose:()=>
{this.Jqb.zt()},onManualClose:()=>{this.Jqb.E$d()},title:Ia.a.instance.ia(1078),width:320,enableResize:!0,minResizeWidth:320,maxResizeWidth:900})}}Object(M.a)(Ab,"PivotTableSettingsReactTaskPane",null,[339]);let Uc=class{constructor(qa){this.f1b=null;this.hk=!1;this.bma="";this.OKa=!1;this.nzg=0;this.HUa=this.NKa=this.dsc=this.mzg=null;this.cN=this.u1a=!1;this.W2j=(qb,bc)=>{if(Ga.a(qb)){const R=qb.Errors[0].Description;qb=qb.Errors[0].MessageId;const cb=bc.jxg;bc=bc.kxg;let zb=this.wXa();if(!zb||
bc!==zb.Vla)if(this.NKa&&bc===this.NKa.Vla)zb=this.NKa;else{L.ULS.sendTraceTag(537154689,0,50,`OnPivotTableSettingsChanged Cannot Find PivotTable for opType: ${cb}`);return}switch(cb){case 1:zb.pivotTableName=this.bma;break;case 2:zb.rwGrandTotalOn=this.OKa;break;case 3:zb.colGrandTotalOn=this.OKa;break;case 12:zb.errorString=this.bma;break;case 13:zb.nullString=this.bma;break;case 14:zb.saveSourceDataWithFile=this.OKa;break;case 15:zb.refreshOnLoad=this.OKa;break;case 16:zb.altText=this.bma;break;
case 17:zb.altTextSummary=this.bma;break;case 20:zb.indentIncrement=this.nzg}L.ULS.sendTraceTag(537154688,0,50,`OnPivotTableSettingsChangedSuccessCallback encounters error ${qb} ${R} for opType: ${cb}`);this.updateTaskPane(this.wXa())}};this.swa=()=>{const qb=this.da.inRangePicker||this.da.nk||!!(this.ha.gf&470);this.GQ()&&!qb&&this.$bl();this.Wwb()};this.Px=()=>{this.GQ()&&(this.HUa=this.wXa());this.Wwb()};this.vv=()=>{La.EwaSettings.isChangeGateEnabled("OfficeVSO:8334012_HideSettingsPaneinViewing")&&
this.Wwb()};this.$=qa;this.da=Sa.f(this.$);this.sij(qa);this.ha=this.da.ha;this.ha.add_activeCellChanged(this.swa);this.da.KJ(this.swa);this.da.h6(this.Px);this.IS=Array(6);for(qa=0;qa<this.IS.length;qa++)this.IS[qa]=!1;this.$.fa.CD(this.vv)}get sectionCollapseStates(){return this.IS}get jGb(){return this.$.$b.Uaa(4128)&&this.qmc}get qmc(){const qa=new ld.SheetProtection(this.$.qa);return this.$.isEditMode&&qa.ie(8192)||!qa.Ih}yVk(){this.hk?(this.cN=!1,this.hideTaskPane(!0)):(this.cN=!0,this.showTaskPane(!0));
this.$.Sg()}onSaveSectionCollapseState(qa,qb){this.IS&&0<=qa&&qa<this.IS.length&&(this.IS[qa]=qb)}V2j(qa,qb,bc,R){let cb=this.dsc,zb=this.HUa;if(!zb||R!==zb.Vla)if(this.NKa&&R===this.NKa.Vla)zb=this.NKa,cb=this.mzg;else{L.ULS.sendTraceTag(537154690,0,50,`OnPivotTableSettingsChanged Cannot Find PivotTable for opType: ${qa}`);return}switch(qa){case 1:this.bma=zb.pivotTableName;qb=255<qb.length?qb.substring(0,255):qb;zb.pivotTableName=qb;break;case 2:this.OKa=zb.rwGrandTotalOn;zb.rwGrandTotalOn=!!bc;
break;case 3:this.OKa=zb.colGrandTotalOn;zb.colGrandTotalOn=!!bc;break;case 6:zb.autoFormatOnUpdate=!!bc;break;case 7:zb.showDrillIndicators=!!bc;break;case 8:zb.showItemsWithNoDataOnRw=!!bc;break;case 9:zb.showItemsWithNoDataOnCol=!!bc;break;case 10:zb.displayErrorString=!!bc;break;case 11:zb.displayNullString=!!bc;break;case 12:this.bma=zb.errorString;zb.errorString=qb;break;case 13:this.bma=zb.nullString;zb.nullString=qb;break;case 14:this.OKa=zb.saveSourceDataWithFile;zb.saveSourceDataWithFile=
!!bc;break;case 15:this.OKa=zb.refreshOnLoad;zb.refreshOnLoad=!!bc;break;case 16:this.bma=zb.altText;zb.altText=qb;break;case 17:this.bma=zb.altTextSummary;zb.altTextSummary=qb;break;case 20:this.nzg=zb.indentIncrement,zb.indentIncrement=bc}L.ULS.sendTraceTag(595125196,0,50,`OnPivotTableSettingsChanged for opType: ${qa}`);this.$.userOperationManager.enqueueOperation(new Pc.a(225,0,(V,Ea,pb)=>{const Jb=new Jd;Jb.jxg=qa;Jb.kxg=R;return Eb(this.$.ma.sa,cb,qa,qb,bc,Ca.c(V,this.W2j),Ea,pb,Jb)},64,()=>
new oc(cb,zb.pivotTableName,qa,qb,bc)),null)}sij(qa){this.f1b=new Ab(qa,this)}dispose(){this.ha.remove_activeCellChanged(this.swa);this.da.xL(this.swa);this.da.yZ(this.Px);this.da=this.ha=null;this.$.fa.xB(this.vv);this.$=null;this.hideTaskPane();this.IS=this.f1b=null}l3(){this.dsc=$b.r(this.ha.oa.activeCell,this.$);this.HUa=this.wXa();this.updateTaskPane(this.wXa())}zt(){this.hideTaskPane()}E$d(){this.cN=!1;this.hideTaskPane(!0);this.$.Sg()}GQ(){return La.EwaSettings.isChangeGateEnabled("OfficeVSO:8334012_HideSettingsPaneinViewing")?
this.jGb&&this.cN&&this.$.isEditMode:this.jGb&&this.cN}v2(){const qa=Sa.f(this.$).Eb.eo(this.ha.oa.activeCell);return!(this.ha.gf&470)&&!!qa&&!qa.Amb(!0)&&this.cN}showTaskPane(qa=!1){qa&&(this.u1a=!0,L.ULS.sendTraceTag(537154659,0,50,"PivotTable settings pane is opened by the user."));this.hk=!0;this.f1b.HO()}updateTaskPane(qa,qb=!1){if(this.hk&&qa&&!qa.Amb(!0)){var bc={pivotTableName:qa.Bfe,colGrandTotalOn:qa.colGrandTotalOn,rwGrandTotalOn:qa.rwGrandTotalOn,indentIncrement:qa.indentIncrement,autoFormatOnUpdate:qa.autoFormatOnUpdate,
showDrillIndicators:qa.showDrillIndicators,showItemsWithNoDataOnRw:qa.showItemsWithNoDataOnRw,showItemsWithNoDataOnCol:qa.showItemsWithNoDataOnCol,displayErrorString:qa.displayErrorString,errorString:qa.errorString,displayNullString:qa.displayNullString,nullString:qa.nullString,saveSourceDataWithFile:qa.saveSourceDataWithFile,refreshOnLoad:qa.refreshOnLoad,autoRefresh:qa.autoRefresh,altText:qa.altText,altTextSummary:qa.altTextSummary,slicerConnections:this.SYk(qa.slicerConnections)};this.f1b.QE(bc,
qb,!qa.isOlap,!qa.BG||2>qa.BG.length,qa.Vla,this.u1a,qa.supportsAutoRefresh);this.u1a=!1}}hideTaskPane(qa=!1){this.hk=!1;this.f1b.AQ();qa&&L.ULS.sendTraceTag(537154658,0,50,"PivotTable settings pane is closed by the user.")}SYk(qa){const qb=[];if(qa)for(let bc=0;bc<qa.length;bc++){const R=qa[bc];qb.push({enabled:R.Enabled||!1,name:R.Name,caption:R.Caption,sheet:R.WorksheetName})}return qb}wXa(){return this.da.Eb.eo(this.ha.oa.activeCell)}Wwb(){this.GQ()&&this.v2()?this.hk?this.HUa!==this.NKa&&this.HUa&&
this.updateTaskPane(this.wXa(),!0):this.showTaskPane():this.hk&&this.hideTaskPane()}$bl(){this.mzg=this.dsc;this.NKa=this.HUa;this.dsc=$b.r(this.ha.oa.activeCell,this.$);this.HUa=this.wXa()}};Uc=Object(I.__decorate)([Object(G.d)(A.PivotTableSettingsPaneManagerService),Object(I.__param)(0,Object(A.EwaControlService)())],Uc);Object(M.a)(Uc,"PivotTableSettingsPaneManager",null,[321,4]);var Od=a(190);const le=(qa,qb,bc,R,cb,zb,V,Ea=null)=>{Ea=qa.$a(1,Ea);Ea.groupOperation=qb;Ea.groupOperationPayload=
bc;return la.h(qa,"EditPowerQueryGroup",Ea,R,cb,zb,V,0)},ge=(qa,qb,bc,R,cb,zb,V,Ea=null)=>{Ea=qa.$a(1,Ea);Ea.queryAction=qb;Ea.queryActionPayload=bc;return la.h(qa,"PowerQueryQueryAction",Ea,R,cb,zb,V,0)},ze=(qa,qb,bc,R,cb,zb=null)=>{zb=qa.$a(1,zb);return la.h(qa,"ReadPowerQueryRoaming",zb,qb,bc,R,cb,4)},Le=(qa,qb,bc,R,cb,zb,V,Ea=null)=>{Ea=qa.$a(1,Ea);Ea.powerQueryDataSourceConnections=qb;Ea.operationType=bc;return la.h(qa,"WritePowerQueryRoaming",Ea,R,cb,zb,V,4)},nf=(qa,qb,bc,R,cb,zb,V=null)=>{V=
qa.$a(33,V);V.queryName=qb;return la.h(qa,"PowerQueryDuplicateQuery",V,bc,R,cb,zb,0)},cf=(qa,qb,bc,R,cb,zb,V=null)=>{V=qa.$a(33,V);V.setQueryPropertiesPayload=qb;return la.h(qa,"PowerQuerySetQueryProperties",V,bc,R,cb,zb,0)},Te=(qa,qb,bc,R,cb,zb,V=null)=>{V=qa.$a(33,V);V.pastePayload=qb;return la.h(qa,"PowerQueryPaste",V,bc,R,cb,zb,0)},Wf=(qa,qb,bc,R,cb,zb,V=null)=>{V=qa.$a(33,V);V.editingSessionDiff=qb;return la.h(qa,"PowerQueryImport",V,bc,R,cb,zb,0)},Hf=(qa,qb,bc,R,cb,zb,V=null)=>{V=qa.$a(1,V);
V.mashup=qb;return la.h(qa,"GetPowerQueryDocumentInspection",V,bc,R,cb,zb,0)},ib=(qa,qb,bc,R,cb,zb=null)=>{zb=qa.$a(33,zb);return la.h(qa,"powerQueryGetPendingEvaluations",zb,qb,bc,R,cb,0)},xc=(qa,qb,bc,R,cb,zb,V,Ea=null)=>{Ea=qa.$a(33,Ea);Ea.evaluationID=qb;Ea.userAadToken=bc;return la.h(qa,"powerQueryCustomEvaluation",Ea,R,cb,zb,V,0)};var Kc=a(689);class ra{}Object(M.a)(ra,"PowerQueryRoamingDataSourceConnection",null,[]);class jb{static G3h(qa){return{kind:qa.K,path:qa.P,authenticationKind:jb.Yli,
connectionName:qa.ID,provider:jb.provider,privacyGroup:null}}static uif(qa){return qa?qa.map(jb.G3h):[]}static Dif(qa){const qb=new ra;qb.K=qa.kind;qb.P=qa.path;qb.ID=qa.connectionName;qb.V=null;return qb}static X3h(qa){return qa.map(jb.Dif)}static yif(qa){return qa.map(jb.M3h)}static Eif(qa){return qa.map(jb.Y3h)}static c4h(qa){return qa.map(qb=>jb.Fif(qb,void 0))}static Z3h(qa){const qb=[];null===qa||void 0===qa?void 0:qa.forEach(bc=>qb.push(jb.$3h(bc)));return qb}static Fif(qa,qb){var bc;const R=
{name:qa.Name,rowsLoaded:qa.RowsLoaded,lastRefresh:qa.LastRefresh,fillObjectType:qa.FillObjectType,loadedToDataModel:qa.LoadedToDataModel,queryError:qa.QueryError,nestingDepth:0,rowsWithError:qa.RowsWithError,groupKey:qa.GroupID,currentRunningOperation:null!==(bc=qa.CurrentRunningOperation)&&void 0!==bc?bc:-1,inRefresh:!1,refreshEnabled:!1,runTimeId:null,formula:qa.Formula};R.description=qa.Description;R.propertiesControls=jb.w$h(qa,qb);return R}static $3h(qa){const qb={};qb.Name=qa.name;qb.Description=
qa.description;qb.FillObjectType=qa.fillObjectType;qb.LoadedToDataModel=qa.loadedToDataModel;qb.GroupID=qa.groupKey;qb.Formula=qa.formula;return qb}static w$h(qa,qb){const bc={isRefreshOnRefreshAllEnabled:void 0,isRefreshOnOpenEnabled:void 0,intervalInMinutes:void 0,isBackgroundRefreshEnabled:void 0,isFastDataLoadEnabled:void 0,isIntervalRefreshEnabled:void 0,isRemoveDataEnabled:void 0,shouldDisableBackgroundRefreshCheckbox:void 0,shouldDisableRemoveDataCheckbox:void 0,shouldDisableRefreshOnOpenCheckbox:!0,
shouldDisableRefreshOnRefreshAllCheckbox:!0};if(1!==qa.FillObjectType||qa.LoadedToDataModel)if(bc.shouldDisableRefreshOnOpenCheckbox=!1,bc.shouldDisableRefreshOnRefreshAllCheckbox=!1,qb=null===qb||void 0===qb?void 0:qb.values.find(R=>R.QueryName===qa.Name))bc.isRefreshOnRefreshAllEnabled=qb.AllowRefreshAll,bc.isRefreshOnOpenEnabled=qb.RefreshOnOpen;return bc}static M3h(qa){return{key:qa.Id,name:qa.Name,order:qa.Order,parentKey:qa.ParentId,data:qa.Description,count:0,startIndex:0,children:null,level:0,
isDeleting:!1}}static Y3h(qa){return{Id:qa.key,Name:qa.name,Order:qa.order,ParentId:qa.parentKey,Description:qa.data,IsDeleting:!1,HasParent:qa.parentKey!==jb.Yji}}}jb.provider="DmtsPowerBi";jb.Yli="";jb.Yji="{00000000-0000-0000-0000-000000000000}";Object(M.a)(jb,"PowerQueryObjectsConverterUtil",null,[]);var vc;(function(qa){qa[qa.null=-1]="null";qa[qa.table=0]="table";qa[qa.connectionOnly=1]="connectionOnly";qa[qa.pivotTable=2]="pivotTable";qa[qa.pivotChart=3]="pivotChart"})(vc||(vc={}));Object(M.b)("FillObjectType",
vc);var md=a(242);class Qd{constructor(qa,qb,bc){this.U1d=this.jQd=this.ZKa=null;this.jEg=0;this.onCancelQueryRefresh=R=>{this.ig.Hcf(R)&&this.C_c([R])};this.handleQueryGroupOperation=(R,cb)=>{const zb={};zb.Id=cb.id;zb.Name=cb.name;zb.Description=cb.description;zb.ParentId=cb.parentId;const V=this.FVi(R,cb);V?(R=ec.a.Cd(1,0,751,0,0,698690962,"PowerQueryMoveToTopLevelFailedWithNameConflict"),R.Description=String.format(Ia.a.instance.Ib(219),cb.name,V),new Ud.a(this.$,R)):this.ig.handleQueryGroupOperation(R,
zb)};this.onEditQuery=R=>{this.$.Ia.Gb(new yb.a(-2080757377,0,this.$.xc,8,null),{["queryName"]:R})};this.onPowerQueryPaste=(R,cb,zb)=>{R=this.hYi(R,cb,zb);this.ig.o9i(R)};this.showClipboardAccessPermissionDialog=()=>{const R=ec.a.Cd(1,2,2490,2491,0,0,"AllowClipboardAccessPermission");new Ud.a(this.$,R)};this.handleQueryAction=(R,cb)=>{const zb={};zb.Name=cb.name;zb.ExtraData=cb.extraData;zb.Formulas=this.ig.formulas;this.ig.handleQueryAction(R,zb)};this.FVi=(R,cb)=>{var zb;let V=void 0;La.EwaSettings.isChangeGateEnabled("OfficeVSO:8950865_PowerQueryMoveToTopLevelErrorDialog")&&
4===R&&null===cb.parentId&&(V=null===(zb=this.jQd.find(Ea=>"{00000000-0000-0000-0000-000000000000}"===Ea.parentKey&&Ea.name.toLowerCase()===cb.name.toLowerCase()))||void 0===zb?void 0:zb.name);return V};this.hYi=(R,cb,zb)=>{const V={};V.PasteParentGroupKey=R;V.Queries=jb.Z3h(cb);V.QueryGroups=jb.Eif(zb);return V};this.$=qa;this.ide=bc;this.isVisible=!1;this.$Sc=new Ba.a(!0);this.Wge={};this.ig=qb}YLa(){Wc.a.Fj()?void G.a.resolve(A.ReactTaskPaneManagerService,{xa:0}).then(qa=>qa.setSelectedTaskPane("PowerQueryTaskPane")):
xb.a.li().then(qa=>{qa.setSelectedTaskPane("PowerQueryTaskPane");return null})}HO(){this.isVisible=!0;Wc.a.Fj()?void G.a.resolve(A.ReactTaskPaneManagerService,{xa:0}).then(qa=>qa.PC("PowerQueryTaskPane",this.cKb())):xb.a.li().then(qa=>{qa.showTaskPane("PowerQueryTaskPane",this.cKb());return null})}QE(qa,qb=null,bc,R=null,cb=null){if(this.isVisible){var zb=this.cKb(qa,qb,bc,R,cb);Wc.a.Fj()?void G.a.resolve(A.ReactTaskPaneManagerService,{xa:0}).then(V=>V.updateTaskPane("PowerQueryTaskPane",zb||this.cKb(qa,
qb,bc,R,cb))):xb.a.li().then(V=>{V.updateTaskPane("PowerQueryTaskPane",zb||this.cKb(qa,qb,bc,R,cb));return null})}else this.b9g(qa,qb,bc,R)}AQ(){this.isVisible=!1;Wc.a.Fj()?void G.a.resolve(A.ReactTaskPaneManagerService,{xa:0}).then(qa=>qa.hideTaskPane("PowerQueryTaskPane")):xb.a.li().then(qa=>{qa.hideTaskPane("PowerQueryTaskPane",2);return null})}Tue(qa){if(!md.a.Zg(qa)){for(const qb of this.ZKa)qa.includes(qb.name)&&(this.$Sc.add(qb.name,qb),this.Wge[qb.name]=++this.jEg,L.ULS.sendTraceTag(537154401,
0,50,`Refresh started for query #: ${this.jEg}`));this.QE(this.ig.queries,this.ig.groups,this.ig.VC,this.ig.aJa)}}C_c(qa){if(!md.a.Zg(qa)){for(const qb of this.ZKa)qa.includes(qb.name)&&(qb.name in this.Wge&&L.ULS.sendTraceTag(537154400,0,50,`Refresh stoped for query #: ${this.Wge[qb.name]}`),this.$Sc.remove(qb.name));this.QE(this.ig.queries,this.ig.groups,this.ig.VC,this.ig.aJa)}}b9g(qa=null,qb=null,bc=null,R=null){qa&&(this.ZKa=[],null===qa||void 0===qa?void 0:qa.forEach(cb=>this.ZKa.push(jb.Fif(cb,
bc))));R&&(this.U1d=[],null===R||void 0===R?void 0:R.forEach(cb=>this.U1d.push(this.F6h(cb))));qb&&(this.jQd=jb.yif(qb));this.Eek()}cKb(qa=null,qb=null,bc=null,R=null,cb=null){this.b9g(qa,qb,bc,R);qa={onQuerySelected:this.ide.onQuerySelected,onQueryRefresh:this.ig.YSc,onCancelQueryRefresh:this.onCancelQueryRefresh,handleQueryGroupOperation:this.handleQueryGroupOperation,handleQueryAction:this.handleQueryAction,onSetQueryProperties:this.ig.setQueryProperties,onClearAllCredentials:this.ig.yYh,onEditQuery:this.onEditQuery,
onPowerQueryPaste:this.onPowerQueryPaste,showClipboardAccessPermissionDialog:this.showClipboardAccessPermissionDialog,getAllReferencedQueriesAsync:V=>this.ig.pJi(V)};const zb={"Microsoft.Office.Excel.PowerQueryTaskPaneRenameQuery":!0,"Microsoft.Office.Excel.PowerQueryTaskPaneDeleteQuery":!0,"Microsoft.Office.Excel.PowerQueryTaskPaneDuplicateQuery":La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryTaskPaneDuplicateQuery",!1),"Microsoft.Office.Excel.PowerQueryClearAllCredentialTaskPane":La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryClearAllCredentialTaskPane",
!1),"Microsoft.Office.Excel.PowerQueryAuthenticateRefresh":La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1),"Microsoft.Office.Excel.PowerQueryCopyPaste":La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryCopyPaste",!1),"Microsoft.Office.Excel.PowerQueryDeleteQueryGroup":!0,"Microsoft.Office.Excel.PowerQueryTaskPaneQueryProperties":La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryTaskPaneQueryProperties",!1),"Microsoft.Office.Excel.PowerQueryImport":La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryImport",
!1),"Microsoft.Office.Excel.PowerQueryCopy":La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryCopy",!1),"Microsoft.Office.Excel.PowerQueryPaste":La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryPaste",!1),isAADDocumentHost:!!this.$.ta.DocumentHostInfo.AADUserObjectId||!Bb.a.compare(this.$.ta.DocumentHostInfo.HostTier,"TestHost",!0),isPowerQueryEditEnabled:this.ig.Fuj,isPowerQueryTaskPaneConnectionActionsEnabled:!1,isDocumentStructureLocked:rb.l(this.$.Pf),
isTooltipEnabled:!0};cb={type:"PowerQueryTaskPaneProps",callbacks:qa,queries:this.ZKa,groups:this.jQd,connections:this.U1d,selectedQueryKey:cb,getBooleanProperty:V=>{var Ea;return null!==(Ea=zb[null!==V&&void 0!==V?V:""])&&void 0!==Ea?Ea:!1}};return Object(Vd.a)(new ub.a,{contentProps:cb,onOpen:()=>{this.ide.l3()},onClose:()=>{this.ide.zt()},width:320,title:Ia.a.instance.ia(2288)})}Eek(){if(this.ZKa)for(let qb=0;qb<this.ZKa.length;qb++){var qa=!1;const bc=this.ZKa[qb],R=this.$Sc.getItem(bc.name);
null!=R&&(qa=new Date(bc.lastRefresh),(qa=(new Date(R.lastRefresh)).getTime()===qa.getTime())||this.$Sc.remove(R.name));bc.inRefresh=qa;bc.refreshEnabled=this.ig.VC.Bb(bc.name)}}F6h(qa){return{name:qa.Name,description:qa.Description,fillObjectType:qa.FillObjectType,loadedToDataModel:qa.LoadedToDataModel,inRefresh:qa.InRefresh,refreshEnabled:qa.RefreshEnabled}}}Object(M.a)(Qd,"PowerQueryReactTaskPane",null,[357]);class v{constructor(qa,qb){this.j9=this.x0c=null;this.qQc=this.hk=!1;this.ekc=null;this.onQuerySelected=
bc=>{for(var R of this.ig.queries)if(R.FillObjectName&&R.Name===bc){3!==R.FillObjectType&&2!==R.FillObjectType||Bb.a.contains(R.FillObjectName,"!",!0)||L.ULS.sendTraceTag(537154438,0,15,`PowerQueryPaneManager.OnQuerySelected: Selection Query of type : ${vc[R.FillObjectType]} and no ! on FillObjectName`);3===R.FillObjectType?(bc=R.PivotChartSheetRange,bc.SheetName=R.FillObjectName.split("!")[0],R=R.FillObjectName.split("!")[1],Sa.f(this.$).ha.ob.FDa(bc,R,0).continueWith(cb=>{cb.result||L.ULS.sendTraceTag(537154437,
0,15,"PowerQueryPaneManager.OnQuerySelected: Selection of PivotChart Failed")})):(R=2===R.FillObjectType?R.FillObjectName.split("!")[1]:R.FillObjectName,(R=this.$.wc.getItemByName(R))&&R.activate({disableAutoFocusOnGrid:!0,scenario:"powerQuery"}));break}};this.onCancelQueryRefresh=bc=>{this.ig.Hcf(bc)&&this.j9.C_c([bc])};this.onQueryRefresh=bc=>{this.ig.YSc(bc)};this.R3f=bc=>this.ig.VC.Bb(bc);this.sng=()=>{this.d_j()};this.ong=()=>{this.AZj()};this.onActiveItemChanged=(bc,R)=>{R.la&&2===R.la.type&&
this.kwe.Bb(R.la.name)&&this.updateTaskPane(this.kwe.getItem(R.la.name))};this.xrg=(bc,R)=>{bc=[];for(const cb of this.ig.VC.values)if(R===cb.ConnectionName){const zb=cb.QueryName;if(this.ig.zVb(zb)){bc.push(zb);break}}this.j9.Tue(bc)};this.Yqg=(bc,R)=>{this.j9.Tue(R)};this.wrg=(bc,R)=>{if(R&&R.Result){bc=R.Result.ConnectionName;R=[];for(const cb of this.ig.VC.values)if(bc===cb.ConnectionName){const zb=cb.QueryName;if(this.ig.zVb(zb)){R.push(zb);break}}this.j9.C_c(R)}};this.Xqg=(bc,R)=>{this.j9.C_c(R)};
this.$=qa;this.ig=qb;this.kwe=new Ba.a(!0);this.T2k=new Ba.a(!0);this.uij(qa);void G.a.resolve(A.DataRefreshManagerService,{xa:1}).then(bc=>{bc.c5e(this.wrg);bc.LCh(this.xrg)});this.ig.AGh(this.sng);this.ig.DGh(this.ong);La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryInteractiveSignIn",!1)&&(this.ig.pFh(this.Yqg),this.ig.oFh(this.Xqg));L.ULS.sendTraceTag(542228699,0,15,"PowerQueryPaneManager.ShowPowerQueryTaskPane()")}FWk(qa){this.ekc=qa;this.showTaskPane()}uij(qa){this.j9=
new Qd(qa,this.ig,this)}dispose(){void G.a.resolve(A.DataRefreshManagerService,{xa:1}).then(qa=>{qa.MHg(this.wrg);qa.Qrk(this.xrg)});this.ig.ivk(this.sng);this.ig.jvk(this.ong);La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryInteractiveSignIn",!1)&&(this.ig.Xtk(this.Yqg),this.ig.Wtk(this.Xqg));this.$=null;this.hideTaskPane();this.j9=null}l3(){this.ig.zT();this.ig.uGd();this.$.wc.mh(this.onActiveItemChanged)}zt(){this.hk=!1}handleQueryGroupOperation(qa,qb){Ed.a(this.$.userOperationManager,
(bc,R,cb)=>le(this.$.ma.sa,qa,qb,bc,R,cb,null),bc=>new Pc.a(1021,0,bc),null)}showTaskPane(){this.hk?this.j9.YLa():(this.x0c=this.$.Vb.Uc("UserAction","PowerQueryTaskPaneInitialLoadTime"),this.hk=!0,this.j9.HO())}updateTaskPane(qa){let qb=qa;this.ekc&&this.ig.queries.find(R=>{R.Name===this.ekc&&(qb=R.Name,this.ekc=null)});this.j9.QE(this.ig.queries,this.ig.groups,this.ig.VC,this.ig.aJa,qb);this.x0c&&(this.x0c.stop(),this.x0c=null);for(qa=0;qa<this.ig.queries.length;qa++){var bc=this.ig.queries[qa];
0===bc.FillObjectType&&this.kwe.add(bc.FillObjectName,bc.Name);bc.LastRefresh||L.ULS.sendTraceTag(537154436,0,15,"PowerQueryPaneManager.UpdateTaskPane: Invalid date for last refreshed.")}qa=this.ig.aJa;for(bc=0;bc<qa.length;bc++){const R=qa[bc];0===R.FillObjectType&&this.T2k.add(R.FillObjectName,R.Name)}}hideTaskPane(){this.hk=!1;this.j9.AQ()}d_j(){this.updateTaskPane(null);this.qQc||(void G.a.resolve(A.DataRefreshManagerService,{xa:1}).then(qa=>{this.Npg(qa.Xge)}),this.qQc=!0)}AZj(){this.updateTaskPane(null);
this.qQc||(void G.a.resolve(A.DataRefreshManagerService,{xa:1}).then(qa=>{this.Npg(qa.Xge)}),this.qQc=!0)}Npg(qa){const qb=[];for(const bc of qa)for(const R of this.ig.VC.values)if(bc===R.ConnectionName&&(qa=R.QueryName,this.ig.zVb(qa))){qb.push(qa);break}this.j9.Tue(qb)}}Object(M.a)(v,"PowerQueryPaneManager",null,[337]);var Qb;let Dc=Qb=class{constructor(qa,qb){this.oRc=null;this.$=qa;this.Bdk=qb}td(){return!1}gd(){return!1}executeCommand(qa,qb,bc){this.oRc||(this.oRc=new v(this.$,this.Bdk));qa=
ia.TaskExtensions.kl();return 1156885807===qb.command?(this.oRc.FWk(null===bc||void 0===bc?void 0:bc[Qb.selectedQueryKey]),qa):tb.a(qb.command)}dispose(){this.$=this.oRc=null}Rc(qa,qb){return 1156885807===qb.command}};Dc.selectedQueryKey="selectedQuery";Dc=Qb=Object(I.__decorate)([Object(G.d)(A.PowerQueryPaneCommandHandlerService),Object(I.__param)(0,Object(A.EwaControlService)()),Object(I.__param)(1,Object(A.PowerQueryManagerService)())],Dc);Object(M.a)(Dc,"PowerQueryPaneCommandHandler",null,[29,
4]);const id=de.a.Jra.Application;var Md;(function(qa){qa[qa.none=0]="none";qa[qa.teamsDisallowedApp=1]="teamsDisallowedApp";qa[qa.thirdPartyCookiesDisabled=2]="thirdPartyCookiesDisabled";qa[qa.hostNotSupported=3]="hostNotSupported"})(Md||(Md={}));Object(M.b)("powerQueryOAuthErrorType",Md);let Sd=class{constructor(qa,qb,bc){this.stateId=0;this.QEa=void 0;this.Pqc=this.svc=0;this.Zdg=this.bLb=!1;this.RMe=null;this.hdd=!1;this.yad=null;this.zIc=this.EIc=!1;this.reg=50;this.xeg=80;this.uhk=RegExp("(.*?)\\s?\\((\\d+)\\)$");
this.YSc=(R,cb)=>{const zb=La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryInteractiveSignIn",!1);zb&&this.ub.raiseEvent("onRefreshStartedKey",[R]);void this.FUd(!0,!1).then(V=>{V?this.qEg(R,cb):zb&&this.ub.raiseEvent("onRefreshCompletedKey",[R])},()=>{zb&&this.ub.raiseEvent("onRefreshCompletedKey",[R])})};this.qEg=(R,cb)=>{(cb||this.zVb(R))&&this.$Uh(R)&&this.VC.Bb(R)&&(cb=this.VC.getItem(R),this.UH.VSc(cb.ConnectionName,cb.ExternalSourceIndex,null),La.EwaSettings.isChangeGateEnabled("OfficeVSO:8882697_KeepIsPendingRefreshValue")&&
(this.rQb(R).IsPendingRefresh=!1))};this.yYh=()=>{L.ULS.sendTraceTag(508826700,0,20,"PowerQueryManager:ClearAllCredentials started");ze(this.$.ma.sa,R=>{this.AUk(R.Result)},()=>{L.ULS.sendTraceTag(508826699,0,10,"PowerQueryManager:ClearAllCredentials read roaming Failed")},null,null)};this.AUk=R=>{L.ULS.sendTraceTag(508826698,0,50,`PowerQueryManager:showClearAllCredentialsConfirmationDialog connections: ${null===R||void 0===R?void 0:R.length}`);R&&0!==R.length?this.BUk(R):this.CUk()};this.CUk=()=>
{const R=new Od.a;R.hc=0;R.Ni(Ia.a.instance.ia(2337),Ia.a.instance.ia(2338),3)};this.BUk=R=>{const cb=[],zb=[];for(let V=0;V<R.length;V++){if(4===V){zb.push(Ia.a.instance.ia(2340));break}const Ea=R[V];zb.push(`${Ea.K} - ${Ea.P.length>this.reg?`${Ea.P.substring(0,this.reg-1)}...`:Ea.P}`)}cb.push(zb);R=new Od.a;R.hc=11;R.Ic(1,Ia.a.instance.ia(2290));R.Ic(2,Ia.a.instance.ia(5));R.gqa(cb,null);R.Ni(Ia.a.instance.ia(2337),Ia.a.instance.ia(2339),1,V=>{1===V&&this.xYh()})};this.xYh=()=>{Le(this.$.ma.sa,
[],0,()=>{L.ULS.sendTraceTag(508826697,0,50,"PowerQueryManager:clearAllCredentialFromRoaming succeeded")},()=>{L.ULS.sendTraceTag(508826696,0,10,"PowerQueryManager:clearAllCredentialFromRoaming Failed")},null,null)};this.handleQueryGroupOperation=(R,cb)=>{const zb=this.groups.find(V=>V.Id===cb.Id);2===R?this.y7i(cb,zb):(this.muf(R,cb,zb,null),this.tZg(R,cb))};this.nJf=R=>{const cb=[];this.queries.forEach(zb=>{zb.GroupID===R.Id&&cb.push(zb)});this.groups.forEach(zb=>{zb.ParentId===R.Id&&cb.push(...this.nJf(zb))});
return cb};this.y7i=(R,cb)=>{const zb=this.nJf(cb);if(this.yil(zb)){var V=()=>{this.muf(2,R,cb,zb);this.tZg(2,R)};0===zb.length?V():this.cPf(Ia.a.instance.ia(2385),Ia.a.instance.ia(2384),V)}};this.yil=R=>{R=R.filter(cb=>cb.LoadedToDataModel);if(0<R.length){const cb=R.map(zb=>`"${zb.Name}"`).join(", ");this.PUk(String.format(Ia.a.instance.Ib(1===R.length?225:226),cb));return!1}return!0};this.PUk=R=>{const cb=new Od.a;cb.hc=0;cb.Ni(Ia.a.instance.ia(2385),R,1)};this.tZg=(R,cb)=>{this.$.userOperationManager.enqueueOperation(new Pc.a(1023,
0,(zb,V,Ea)=>le(this.$.ma.sa,R,cb,Ca.c(pb=>{0<pb.Errors.length&&this.zT()},zb),Ca.b(()=>{this.zT()},V),Ea,null),4),null)};this.NUh=R=>{const cb=R.Queries.map(zb=>zb.Name).filter(zb=>this.queries.some(V=>V.Name===zb));if(0<cb.length){R=R.Queries.map(zb=>zb.Formula);for(const zb of cb)if(R.some(V=>-1!==V.indexOf(zb)))return!1}return!0};this.zWk=()=>{const R=ec.a.Cd(1,1,2442,2443,0,-4784504,"powerQueryPasteReferencedQueriesRenamedFailed");new Ud.a(this.$,R)};this.uWf=R=>{const cb=La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryInteractiveSignIn",
!1)&&R?Db.a(this.$).hg.tha(7):null;void appChrome.initPowerQueryMashupClientDiv(this.VOb,this.eze,this.$.ta.UICultureTag,this.$.ta.UserSessionId,this.$.ta.PowerQueryHostContextType,this.$.ta.PowerQueryEndpointUrl,this.showFeedbackDialogCallback).then(()=>{this.Zdg=!0;null===cb||void 0===cb?void 0:cb.dispose();this.$.Sg()},()=>null===cb||void 0===cb?void 0:cb.dispose())};this.rQb=R=>this.queries.find(cb=>cb.Name===R);this.aPc=R=>{R=this.rQb(R);this.ALc(R,-1)};this.ALc=(R,cb)=>{R&&(R.CurrentRunningOperation=
cb)};this.setQueryProperties=R=>{this.Goi(R);this.$.userOperationManager.enqueueOperation(new Pc.a(1038,0,(cb,zb,V)=>cf(this.$.ma.sa,R,Ca.c(Ea=>{Ea.Errors&&0<Ea.Errors.length?L.ULS.sendTraceTag(507511826,0,10,"PowerQueryManager.setQueryProperties: SetQueryProperties operation failed"):L.ULS.sendTraceTag(507511825,0,50,"PowerQueryManager.setQueryProperties: SetQueryProperties operation succeeded");this.aPc(R.NewName)},cb),Ca.b(()=>{L.ULS.sendTraceTag(507511824,0,10,"PowerQueryManager.setQueryProperties: SetQueryProperties operation failed");
this.aPc(R.NewName)},zb),V,null),4),null)};this.eze=R=>{const cb=jb.Dif(R);Le(this.$.ma.sa,[cb],1,zb=>{!zb||0<zb.Errors.length?L.ULS.sendTraceTag(508130690,0,10,`PowerQueryMnanager:unlinkEvaluationConnection: success callback failure: ${zb.Result}`):L.ULS.sendTraceTag(508130689,0,10,`PowerQueryMnanager:unlinkEvaluationConnection: Successfully removed connection with Kind: ${cb.K}`)},()=>{L.ULS.sendTraceTag(508130688,0,10,`PowerQueryMnanager:unlinkEvaluationConnection: Remove Connection failed,
        Kind: ${cb.K}`)},null,null)};this.PAi=R=>{var cb;return(null===(cb=this.VC.getItem(R.Name))||void 0===cb?void 0:cb.AllowRefreshAll)&&(!La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryInteractiveSignIn",!1)||this.zVb(R.Name))};this.QAi=R=>{R=this.VC.getItem(R.Name);return null===R||void 0===R?void 0:R.RefreshOnOpen};this.fg=()=>{const R=this.$.fa.el.PowerQueryStateId,cb=this.$.fa.el.PowerQueryEvaluationStateId,zb=this.$.fa.el.ConnectionsStateId;L.ULS.sendTraceTag(537154444,
0,50,`PowerQueryManager.OnWorkbookMetadataChanged: powerQueryStateId: ${R}, this.stateId: ${this.stateId}. powerQueryEvaluationStateId: ${cb}, this.EvaluationStateId: ${this.svc}. connectionsStateId: ${zb}, this.connectionsStateId: ${this.Pqc}`);if(R>this.stateId){const V=this.formulas;this.zT().continueWith(Ea=>{Ea.result?(this.stateId=R,La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryDocumentInspection",!1)&&(V!==this.formulas?this.Uwc(this.stateId):this.QEa=this.stateId)):
L.ULS.sendTraceTag(537154443,0,15,"PowerQueryManager.OnWorkbookMetadataChanged failed to update the local state")})}zb>this.Pqc&&this.uGd().continueWith(V=>{V.result?this.Pqc=zb:L.ULS.sendTraceTag(509371268,0,15,"PowerQueryManager.OnWorkbookMetadataChanged failed to update the local legacy connections state")});La.EwaSettings.isChangeGateEnabled("OfficeVSO:8732625_PowerQueryManagerAddEvaluationStateIdFlag")&&cb>this.svc&&void this.Hzi().then(V=>{V||L.ULS.sendTraceTag(507511823,0,10,"PowerQueryManager.OnWorkbookMetadataChanged failed to update the Evaluation local state");
this.svc=cb})};this.Ln=()=>{this.zT();this.uGd()};this.l8g=R=>{if(R&&!Ga.a(R)){const zb=R.Result;if(zb.Queries){var cb=this.queries.filter(Ea=>-1!==Ea.CurrentRunningOperation);let V=[];La.EwaSettings.isChangeGateEnabled("OfficeVSO:8882697_KeepIsPendingRefreshValue")&&(V=this.queries.filter(Ea=>Ea.IsPendingRefresh));this.urb.clear();for(const Ea of zb.Queries)try{const pb=cb.find(Jb=>Jb.Name===Ea.Name);pb&&(Ea.CurrentRunningOperation=pb.CurrentRunningOperation);if(La.EwaSettings.isChangeGateEnabled("OfficeVSO:8882697_KeepIsPendingRefreshValue")){const Jb=
V.find(zc=>zc.Name===Ea.Name);Jb&&(Ea.IsPendingRefresh=Jb.IsPendingRefresh)}this.urb.add(Ea.Name,Ea)}catch(pb){L.ULS.sendTraceTag(523534750,0,10,"PowerQueryManager.OnGetQueriesSuccess: more than one query with the same name in queryInfo.")}}this.RMe=zb.QueryGroups;L.ULS.sendTraceTag(537154441,0,50,`PowerQueryManager.OnGetQueriesSuccess: no. queries: ${this.queries?this.queries.length.toString():"null"}`);if(zb.PowerQueryConnectionsInfo){this.VC.clear();cb=[];for(const V of zb.PowerQueryConnectionsInfo)try{this.VC.add(V.QueryName,
V)}catch(Ea){L.ULS.sendTraceTag(523534749,0,10,"PowerQueryManager.OnGetQueriesSuccess: same query with more than one connection."),cb.push(V.QueryName)}cb.forEach(V=>{this.VC.remove(V)})}this.yad=zb.Formulas;this.bLb||(this.bLb=!0,this.ub.raiseEvent("onDataFirstLoadedKey",R))}};this.i8g=R=>{if(R&&!Ga.a(R)){R=R.Result;if(R.LegacyConnections){this.T1d.clear();for(const cb of R.LegacyConnections)try{this.T1d.add(cb.Name,cb)}catch(zb){L.ULS.sendTraceTag(509696094,0,10,"PowerQueryManager.OnGetLegacyConnectionsSuccess: more than one legacy connection with the same name in LegacyConnections.")}}L.ULS.sendTraceTag(509696093,
0,50,`PowerQueryManager.OnGetLegacyConnectionsSuccess: Legacy connections: ${this.aJa?this.aJa.length.toString():"null"}`)}};this.bOc=()=>{L.ULS.sendTraceTag(537154439,0,15,"PowerQueryManager.OnGetQueriesFailure")};this.nng=()=>{L.ULS.sendTraceTag(509696092,0,15,"PowerQueryManager.OnGetLegacyConnectionsFailure")};this.r2a=R=>{this.ub.raiseEvent("OnUpdatePowerQueryDataKeySucceeded",R);this.Hge(this.queries,cb=>cb.IsPendingRefresh)};this.kug=R=>{this.ub.raiseEvent("OnUpdatePowerQueryDataFailed",R)};
this.mug=R=>{this.ub.raiseEvent("OnUpdatePowerQueryLegacyConnectionsSucceeded",R)};this.lug=R=>{this.ub.raiseEvent("OnUpdatePowerQueryLegacyConnectionsFailed",R)};this.srg=(R,cb)=>{if(cb&&cb.Result&&!(cb.Errors&&0<cb.Errors.length)&&cb.Result.PowerQueryRefreshChallengeResult){if(!cb.Result.ConnectionName)throw Error.argumentNull;this.$.Ia.Gb(new yb.a(-1496653501,0,this.$.xc,8,null),{["kind"]:cb.Result.PowerQueryRefreshChallengeResult.Kind,["path"]:cb.Result.PowerQueryRefreshChallengeResult.Path,["queryName"]:this.aZi(cb.Result.ConnectionName)})}};
this.showFeedbackDialogCallback=()=>{L.ULS.sendTraceTag(507790038,0,20,"PowerQuery.showFeedbackDialogCallback: opening send feedback dialog callback.");this.$.Dc(802602464,0,8,{[fa.a.MF]:"PowerQueryFlow"})};this.PFf=(R,cb,zb)=>{L.ULS.sendTraceTag(520734801,0,50,`PowerQueryManager:GetToken: Token requested for PQO service, ignoreTelemetry ${zb}`);try{return this.xla.ey(R,null!==cb&&void 0!==cb?cb:this.$.ta.PowerQueryAudienceUri).then(V=>{if(V.IsSuccess)return L.ULS.sendTraceTag(520734800,0,20,`PowerQueryManager.getAuthToken: ignoreTelemetry ${zb}, successfully fetched token.`),
V.Token;L.ULS.sendTraceTag(520734799,0,15,`PowerQueryManager.getAuthToken: failed to get token. ignoreTelemetry: ${zb}, Error code: ${V.ErrorCode}, Error message: ${V.ErrorMessage}`);this.EIc="Cookies Disabled"===V.ErrorCode;this.zIc="TeamsDisallowedApp"===V.ErrorCode;return Promise.resolve(null)},()=>{L.ULS.sendTraceTag(520734798,0,15,`PowerQueryManager.getAuthToken: got rejected promise, use fallback value, ignoreTelemetry: ${zb}`);return Promise.resolve(null)})}catch(V){return L.ULS.sendTraceTag(520734797,
0,10,`PowerQueryManager.getAuthToken: Exception thrown when fetching token, Exception: ${V}, ignoreTelemetry: ${zb}`),Promise.resolve(null)}};this.VOb=(R,cb)=>this.PFf("PowerQueryWeb",R,cb);this.cKi=(R,cb)=>{try{return this.xla.qza("Core",R,Ia.a.instance.ia(2569)).then(zb=>{if(zb.IsSuccess)return L.ULS.sendTraceTag(507347806,0,20,"PowerQueryManager.getAuthTokenAsyncWithPopup: successfully fetched token."),this.zIc=this.EIc=!1,this.wYd()||this.uWf(cb),zb.Token;L.ULS.sendTraceTag(507347805,0,15,`PowerQueryManager.getAuthTokenAsyncWithPopup: failed to get token, Error code: ${zb.ErrorCode}, Error message: ${zb.ErrorMessage}`);
"UserCancelled"!==zb.ErrorCode&&(this.EIc="Cookies Disabled"===zb.ErrorCode,this.zIc="TeamsDisallowedApp"===zb.ErrorCode);return Promise.resolve(null)},()=>{L.ULS.sendTraceTag(507347804,0,15,"PowerQueryManager.getAuthTokenAsyncWithPopup: got rejected promise, use fallback value");return Promise.resolve(null)})}catch(zb){return L.ULS.sendTraceTag(507347803,0,10,`PowerQueryManager.getAuthTokenAsyncWithPopup: Exception thrown when fetching token, Exception: ${zb}`),Promise.resolve(null)}};this.kWk=()=>
{const R=new Od.a;R.hc=11;R.Ic(1,Ia.a.instance.ia(2325));R.Ic(2,Ia.a.instance.ia(4));R.Ni(Ia.a.instance.ia(2329),Ia.a.instance.ia(2331),1,cb=>{1===cb&&this.$.Ia.Gb(new yb.a(-1698025133,0,this.$.xc,8,null))})};this.wXk=()=>{const R=ec.a.Cd(1,1,2330,2332,0,0,"powerQueryRefreshHostNotSupported");R.HelpDescription=Ia.a.instance.ia(1319);R.HelpTopicId=Ob.a.nyg;new Ud.a(this.$,R)};this.tXk=()=>{void G.a.resolve(A.BusinessBarManagerService,{xa:0}).then(R=>{R.lh(72,null)})};this.JUk=()=>{void G.a.resolve(A.BusinessBarManagerService,
{xa:0}).then(R=>{R.lh(73,null)})};this.$=qa;this.xla=qb;this.UH=bc;this.urb=new Ba.a(!1);this.OQa=new Map;this.T1d=new Ba.a(!1);this.RVe=new Ba.a(!1);this.ub=new ja.a;this.$.fa.au(this.fg);this.$.fa.LJ(this.Ln);this.$.fa.el&&(this.stateId=this.$.fa.el.PowerQueryStateId,this.svc=this.$.fa.el.PowerQueryEvaluationStateId,this.Pqc=this.$.fa.el.ConnectionsStateId);La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)?(this.UH.c5e(this.srg),La.EwaSettings.isChangeGateEnabled("OfficeVSO:8884468_PowerQueryFetchDataOauthNotSupported")&&
this.zT().continueWith(R=>{La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryDocumentInspection",!1)&&R.result&&this.Uwc(this.stateId)}),void this.WYf().then(R=>{La.EwaSettings.isChangeGateEnabled("OfficeVSO:8884468_PowerQueryFetchDataOauthNotSupported")||this.zT().continueWith(cb=>{La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryDocumentInspection",!1)&&cb.result&&this.Uwc(this.stateId)});R&&this.$.kY(cb=>{void cb.O1(1).then(this.uWf)})})):(La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefreshPFTAsDefault",
!1)&&void this.WYf(),this.zT().continueWith(R=>{La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryDocumentInspection",!1)&&R.result&&this.Uwc(this.stateId)}));Object(Xb.d)(dc.a).execute(R=>{R.isFeatureEnabled("ExcelPowerQuery",!1).then(cb=>{this.hdd=cb;return null})})}get Fuj(){return this.hdd}get Guj(){return this.hdd&&this.bLb&&!rb.l(this.$.Pf)&&!this.queries.find(qa=>-1!==qa.CurrentRunningOperation)&&(La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryInteractiveSignIn",
!1)||this.Zac(!0)===Md.none&&this.wYd())}get Huj(){return La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryInteractiveSignIn",!1)||this.Zac(!0)===Md.none&&this.wYd()}get queries(){const qa=this.urb.values;return La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryDeleteQueryGroup",!1)?null===qa||void 0===qa?void 0:qa.filter(qb=>1!==qb.CurrentRunningOperation):qa}get groups(){return this.RMe}get aJa(){return this.T1d.values}get formulas(){return this.yad}get VC(){return this.RVe}get hnk(){const qa=
[];this.RVe.forEach(qb=>{this.UH.Xge.includes(qb.value.ConnectionName)&&qa.push(qb.key)});return qa}get rhk(){return this.QEa===this.stateId?Promise.resolve(this.OQa):Promise.race([new Promise((qa,qb)=>{const bc=()=>{qa(this.OQa);this.THg(bc);this.SHg(R)},R=(cb,zb)=>{qb(zb);this.THg(bc);this.SHg(R)};this.CGh(bc);this.BGh(R)}),new Promise((qa,qb)=>{setTimeout(()=>{qb(Error("Timed out after 5000 milliseconds"))},5E3)})])}AGh(qa){this.ub.addHandler("OnUpdatePowerQueryDataKeySucceeded",qa)}ivk(qa){this.ub.removeHandler("OnUpdatePowerQueryDataKeySucceeded",
qa)}DGh(qa){this.ub.addHandler("OnUpdatePowerQueryLegacyConnectionsSucceeded",qa)}jvk(qa){this.ub.removeHandler("OnUpdatePowerQueryLegacyConnectionsSucceeded",qa)}pFh(qa){this.ub.addHandler("onRefreshStartedKey",qa)}Xtk(qa){this.ub.removeHandler("onRefreshStartedKey",qa)}oFh(qa){this.ub.addHandler("onRefreshCompletedKey",qa)}Wtk(qa){this.ub.removeHandler("onRefreshCompletedKey",qa)}CGh(qa){this.ub.addHandler("OnUpdatePowerQueryDocumentInspectionSucceeded",qa)}THg(qa){this.ub.removeHandler("OnUpdatePowerQueryDocumentInspectionSucceeded",
qa)}BGh(qa){this.ub.addHandler("OnUpdatePowerQueryDocumentInspectionFailed",qa)}SHg(qa){this.ub.removeHandler("OnUpdatePowerQueryDocumentInspectionFailed",qa)}zVb(qa){if(this.urb.Bb(qa)){const qb=this.urb.getItem(qa);if(!this.VC.Bb(qa)||qb.LoadedToDataModel)return!1;if(qb.IsPendingRefresh||1!==qb.FillObjectType)return!0}else L.ULS.sendTraceTag(537154446,0,10,"Query not present in the queryNameToQueryInfo dictionary");return!1}Uwc(qa){null===this.formulas||void 0===this.formulas||""===this.formulas?
(this.OQa.clear(),this.QEa=qa,this.ub.raiseEvent("OnUpdatePowerQueryDocumentInspectionSucceeded",this.OQa)):this.$.userOperationManager.enqueueOperation(new Pc.a(1042,0,(qb,bc,R)=>Hf(this.$.ma.sa,this.yad,Ca.c(cb=>{cb&&cb.Result&&(void 0===this.QEa||this.QEa<qa)&&(cb=cb.Result,this.OQa.clear(),cb.forEach(zb=>{this.OQa.set(zb.QueryName,zb)}),this.QEa=qa,this.ub.raiseEvent("OnUpdatePowerQueryDocumentInspectionSucceeded",this.OQa))},qb),Ca.b(cb=>{L.ULS.sendTraceTag(507511817,0,10,"PowerQueryManager.fetchAndUpdatePowerQueryDocumentInspection: powerQueryDocumentInspect operation failed");
this.QEa<qa&&(this.QEa=qa);this.ub.raiseEvent("OnUpdatePowerQueryDocumentInspectionFailed",cb.data)},bc),R,null),16),null)}async g9i(qa){if(0!==qa.length){var qb=await this.iYi();for(const bc of qa)this.$.userOperationManager.enqueueOperation(new Pc.a(1046,0,(R,cb,zb)=>xc(this.$.ma.sa,bc,qb,Ca.c(V=>{V.Errors&&0<V.Errors.length?L.ULS.sendTraceTag(507844416,0,10,`PowerQueryManager.powerQueryCustomEvaluation: powerQueryCustomEvaluation operation failed ${V.Errors}`):L.ULS.sendTraceTag(507844387,0,50,
"PowerQueryManager.powerQueryCustomEvaluation: powerQueryCustomEvaluation operation succeeded")},R),Ca.b(()=>{L.ULS.sendTraceTag(507844386,0,10,"PowerQueryManager.powerQueryCustomEvaluation: powerQueryCustomEvaluation operation failed")},cb),zb,null),80),null)}}Hzi(){return new Promise(qa=>{this.$.userOperationManager.enqueueOperation(new Pc.a(1043,0,(qb,bc,R)=>ib(this.$.ma.sa,Ca.c(cb=>{cb.Errors&&0!==cb.Errors.length?L.ULS.sendTraceTag(507274311,0,10,`PowerQueryManager.fetchAndUpdatePowerQueryPendingEvaluationStateAsync: fetchAndUpdatePowerQueryPendingEvaluationStateAsync operation failed ${cb.Errors}`):
void this.g9i(cb.Result)},()=>{qa(!0)},qb),Ca.b(()=>{qa(!1)},bc),R,null),80),null)})}zT(){const qa=new Vc.a;La.EwaSettings.isChangeGateEnabled("OfficeVSO:7597823_PowerQueryManagerSendProxyRequests")?Kc.d(this.$.ma.sa,Ca.c(this.l8g,this.r2a,()=>{qa.setResult(!0)}),Ca.b(this.bOc,this.kug,()=>{qa.setResult(!0)}),null,null):this.$.userOperationManager.enqueueOperation(new Pc.a(587,0,(qb,bc,R)=>Kc.d(this.$.ma.sa,Ca.c(qb,this.l8g,this.r2a,()=>{qa.setResult(!0)}),Ca.b(bc,this.bOc,this.kug,()=>{qa.setResult(!0)}),
R,null),80,()=>new Zb.a),null);return qa.task}uGd(){const qa=new Vc.a;La.EwaSettings.isChangeGateEnabled("OfficeVSO:7597823_PowerQueryManagerSendProxyRequests")?Kc.b(this.$.ma.sa,Ca.c(this.i8g,this.mug,()=>{qa.setResult(!0)}),Ca.b(this.nng,this.lug,()=>{qa.setResult(!0)}),null,null):this.$.userOperationManager.enqueueOperation(new Pc.a(603,0,(qb,bc,R)=>Kc.b(this.$.ma.sa,Ca.c(qb,this.i8g,this.mug,()=>{qa.setResult(!0)}),Ca.b(bc,this.nng,this.lug,()=>{qa.setResult(!0)}),R,null),80,()=>new Zb.a),null);
return qa.task}Hcf(qa){if(this.VC.Bb(qa)){qa=this.VC.getItem(qa).ConnectionName;const qb=this.UH.hEg;if(qb&&qb.has(qa))L.ULS.sendTraceTag(525342226,0,50,"PowerQueryManager.cancelRefreshQuery: sending cancellation request"),qa=qb.get(qa),la.i(this.$.ma.sa,qa,null,null,null);else if(!this.UH.a9k(qa))return L.ULS.sendTraceTag(525342225,0,15,"PowerQueryManager.cancelRefreshQuery: cannot find canceled connection on running requests map"),!1}return!0}pJi(qa){return new Promise((qb,bc)=>{let R=[];this.rhk.then(cb=>
{qa.forEach(zb=>{cb.has(zb)?R=R.concat(cb.get(zb).AllReferencedQueryNames):L.ULS.sendTraceTag(507094092,0,10,"Query not in the current query inspection")});qb(R)}).catch(cb=>{L.ULS.sendTraceTag(507094091,0,10,"Cannot resolve query inspections. Error: "+cb);bc(cb)})})}wYd(){return La.EwaSettings.isChangeGateEnabled("OfficeVSO:8570095_PowerQueryDisableRibbonCommandOnClientLoading")?this.Zdg:!0}D7i(qa){this.$.userOperationManager.enqueueOperation(new Pc.a(1034,0,(qb,bc,R)=>nf(this.$.ma.sa,qa,Ca.c(cb=>
{cb.Errors&&0<cb.Errors.length&&this.zT();cb&&cb.Result&&this.zmd(cb.Result)},qb),Ca.b(()=>{this.zT()},bc),R,null),4),null)}o9i(qa){this.NUh(qa)?(this.Coi(qa),this.$.userOperationManager.enqueueOperation(new Pc.a(1040,0,(qb,bc,R)=>Te(this.$.ma.sa,qa,Ca.c(cb=>{cb.Errors&&0<cb.Errors.length&&(L.ULS.sendTraceTag(507013019,0,10,"PowerQueryManager.handlePowerQueryPaste: handlePowerQueryPaste operation failed"),this.zT())},qb),Ca.b(()=>{this.zT()},bc),R,null),4),null)):(L.ULS.sendTraceTag(507806221,0,15,
"PowerQueryManager.handlePowerQueryPaste: conflict queries has formula referenced to it."),this.zWk())}muf(qa,qb,bc,R){if(bc||0===qa){switch(qa){case 3:this.Eoi(qb,bc);break;case 2:this.yoi(qb,R);break;case 4:this.Boi(qb,bc);break;case 0:La.EwaSettings.isChangeGateEnabled("OfficeVSO:8990144_FixPowerQueryGroupCreateClientSideEstimation")&&this.luf(qb);break;default:return}this.r2a(void 0,void 0,void 0)}else L.ULS.sendTraceTag(509752481,0,10,"PowerQueryManager.estimateGroupOperation: Group not found")}Eoi(qa,
qb){qb.Name=qa.Name}yoi(qa,qb){null===qb||void 0===qb?void 0:qb.forEach(bc=>{this.ALc(bc,1)});qb=this.groups.findIndex(bc=>bc.Id===qa.Id);-1===qb?L.ULS.sendTraceTag(509752480,0,10,"PowerQueryManager.estimateDeleteGroup: Group index not found"):this.groups.splice(qb,1)}Boi(qa,qb){const bc=qa.ParentId?qa.ParentId:"{00000000-0000-0000-0000-000000000000}";let R=-1;this.groups.forEach(cb=>{cb.ParentId===bc&&cb.Order>R&&(R=cb.Order)});qb.ParentId=bc;qb.Order=R+1}luf(qa){const qb={},bc=this.groups.filter(R=>
R.ParentId===qa.ParentId).map(R=>R.Name);qb.Name=this.oSi(qa.Name,bc);qb.Id=qa.Id;qb.Description=qa.Description;qb.ParentId=qa.ParentId?qa.ParentId:"{00000000-0000-0000-0000-000000000000}";qb.Order=this.groups.length;this.groups.push(qb)}oSi(qa,qb){let bc=qa,R=2;for(;qb.includes(bc);)bc=`${qa} (${R})`,R++;return bc}handleQueryAction(qa,qb){var bc=()=>{this.Doi(qa,qb);this.d0k(qa,qb)};4===qa?(this.zoi(qb.Name),bc=G.a.resolve(A.SheetOpsHelperService,{xa:1}),void bc.then(()=>{this.D7i(qb.Name)})):1===
qa?this.cPf(Ia.a.instance.ia(2289),String.format(Ia.a.instance.Ib(215),qb.Name),bc):bc()}Goi(qa){const qb=this.rQb(qa.OldName);this.ALc(qb,5);qa.OldName!==qa.NewName&&this.ouf(qb,qa.NewName);qb.Description=qa.Description;this.r2a(void 0,void 0,void 0)}cPf(qa,qb,bc){const R=new Od.a;R.hc=11;R.Ic(1,Ia.a.instance.ia(2290));R.Ic(2,Ia.a.instance.ia(5));R.Ni(qa,qb,1,cb=>{1===cb&&bc()})}d0k(qa,qb){this.$.userOperationManager.enqueueOperation(new Pc.a(1023,0,(bc,R,cb)=>ge(this.$.ma.sa,qa,qb,Ca.c(zb=>{4===
qa&&zb&&zb.Result&&this.zmd(zb.Result);this.aPc(2===qa?qb.ExtraData:qb.Name);0<zb.Errors.length&&this.zT()},bc),Ca.b(()=>{this.aPc(2===qa?qb.ExtraData:qb.Name);this.zT()},R),cb,null),68),null)}Doi(qa,qb){const bc=this.rQb(qb.Name);this.ALc(bc,qa);2===qa&&this.ouf(bc,qb.ExtraData);this.r2a(void 0,void 0,void 0)}ouf(qa,qb){if(!qa.LoadedToDataModel){const bc=this.VC.getItem(qa.Name);bc?(bc.ConnectionName="Query - "+qb,bc.QueryName=qb,this.VC.remove(qa.Name),this.VC.add(qb,bc),qa.Name=qb):L.ULS.sendTraceTag(512492568,
0,10,"PowerQueryManager.estimateRenameQuery: Connection info not found")}}Coi(qa){qa.Queries.forEach(qb=>{""===qb.GroupID&&(qb.GroupID=qa.PasteParentGroupKey)});qa.QueryGroups.forEach(qb=>{""===qb.ParentId&&(qb.ParentId=qa.PasteParentGroupKey)});qa.Queries.forEach(qb=>{this.kuf(qb)});qa.QueryGroups.forEach(qb=>{this.luf(qb)});this.r2a(void 0,void 0,void 0)}zoi(qa){qa=this.rQb(qa);this.kuf(qa);this.r2a(void 0,void 0,void 0)}kuf(qa){this.vHi(qa.Name);this.queries.push(qa)}vHi(qa){for(var qb=qa.slice(0,
this.xeg).trim();!this.dvj(qb);){let bc=2;qa=qb;const R=qb.match(this.uhk);R&&0<=R.length&&(qa=R[1],bc=parseInt(R[2],10)+1);isNaN(bc)||bc===Number.MAX_SAFE_INTEGER||(qb="("+bc.toString()+")",qb=qa.slice(0,this.xeg-qb.length)+" "+qb)}}dvj(qa){return this.queries.every(qb=>qb.Name!==qa)}zmd(qa){(qa=this.$.qa.getItemByName(qa))?qa.activate({scenario:"powerQuery"}):L.ULS.sendTraceTag(508630468,0,15,"PowerQueryManager.activateLoadedQuerySheet: Cannot find new loaded to query sheet.")}td(){return!1}gd(){return!1}dispose(){B.a.xd([this.ub]);
La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)&&this.UH.MHg(this.srg);this.$.fa.Bv(this.fg);this.$.fa.zL(this.Ln);this.$=null}async gVh(){return this.FUd(!1,!0)}Zac(qa){return this.TSk()?Md.hostNotSupported:!qa&&this.zIc?Md.teamsDisallowedApp:this.EIc?Md.thirdPartyCookiesDisabled:Md.none}$Bk(qa){if(this.bLb)qa();else{const qb=()=>{qa();this.wsk(qb)};this.xDh(qb)}}xDh(qa){this.ub.addHandler("onDataFirstLoadedKey",qa)}wsk(qa){this.ub.removeHandler("onDataFirstLoadedKey",
qa)}async WYf(){if(!La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)&&!La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefreshPFTAsDefault",!1))return!0;const qa=await this.VOb(void 0,!0),qb=this.Zac(!1);qb!==Md.none&&L.ULS.sendTraceTag(508834757,0,15,`PowerQueryManager.isAuthenticatedPowerQuerySupportedBB, oAuthErrorType: ${qb}}`);if(La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryInteractiveSignIn",
!1))return qb===Md.none&&!!qa;switch(qb){case Md.hostNotSupported:return!1;case Md.thirdPartyCookiesDisabled:return this.JUk(),!1;case Md.teamsDisallowedApp:return this.tXk(),!1;case Md.none:return!0;default:return L.ULS.sendTraceTag(508839681,0,10,`PowerQueryManager.isAuthenticatedPowerQuerySupportedBB, unexpected error type: oAuthErrorType ${qb}}`),!1}}async FUd(qa,qb){if(!La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)&&!La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefreshPFTAsDefault",
!1))return!0;const bc=La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryInteractiveSignIn",!1);let R=null;bc&&(R=await this.cKi(id,qb));qb=this.Zac(qa);qb!==Md.none&&L.ULS.sendTraceTag(508834756,0,15,`PowerQueryManager.isAuthenticatedPowerQuerySupportedDialog, oAuthErrorType: ${qb}, isTeamsSupported: ${qa}`);switch(qb){case Md.hostNotSupported:return this.Vse(1580811823),!1;case Md.thirdPartyCookiesDisabled:return this.wXk(),!1;case Md.teamsDisallowedApp:return this.kWk(),!1;
case Md.none:return bc&&!R&&this.Vse(1580811823),!bc||!!R;default:return L.ULS.sendTraceTag(508839680,0,10,`PowerQueryManager.isAuthenticatedPowerQuerySupported, unexpected error type: oAuthErrorType ${qb}, isTeamsSupported ${qa}`),!1}}TSk(){return!this.$.ta.DocumentHostInfo.AADUserObjectId&&0!==Bb.a.compare(this.$.ta.DocumentHostInfo.HostTier,"TestHost",!0)}Vse(qa,qb){switch(qa){case -1543585732:qa=this.MDe(qa,"PowerQueryRefreshProtectedSheetFailed");qa.Description=String.format(Ia.a.instance.La(709),
qb,Ia.a.instance.ia(2212));break;case 165156185:qa=this.MDe(qa,"PowerQueryRefreshSheetViewFailed");qa.Description=String.format(Ia.a.instance.La(709),qb,Ia.a.instance.ia(2213));break;case 1580811823:qa=ec.a.Cd(1,1,2211,2216,0,qa,"PowerQueryRefreshHostNotSupported");qa.HelpDescription=Ia.a.instance.ia(1319);qa.HelpTopicId=Ob.a.cnk;break;default:L.ULS.sendTraceTag(529069344,0,10,`PowerQueryManager.showEwaErrorDialog: unhandled error id ${qa}`);return}new Ud.a(this.$,qa)}MDe(qa,qb){return ec.a.Cd(1,
2,2211,0,0,qa,qb)}$Uh(qa){var qb=this.urb.getItem(qa);return qb?(qb=this.eQi(qb))?(this.Vse(qb,qa),!1):!0:(L.ULS.sendTraceTag(529069343,0,10,"PowerQueryManager.getErrorMessageIdForQueryRefresh: Query not in the queryNameToQueryInfo dictionary"),!1)}eQi(qa){if((qa=this.U0i(qa))&&qa.Ih)return-1543585732;if(qa&&qa.ue.Bq)return 165156185}U0i(qa){let qb=void 0,bc=void 0;if(3===qa.FillObjectType||2===qa.FillObjectType)qb=qa.FillObjectName.split("!")[0];else if(0==qa.FillObjectType){if(!qa.FillObjectName)return L.ULS.sendTraceTag(523534751,
0,15,"PowerQueryManager.getSheetFromLoadDestination: FillObjectName is undefined for Query loaded to table."),bc;(qa=this.$.wc.getItemByName(qa.FillObjectName))?qb=qa.sheetName:L.ULS.sendTraceTag(527743194,0,15,"PowerQueryManager.getSheetFromLoadDestination: cannot find namedObject for query")}qb&&(bc=this.$.qa.getItemByName(qb));return bc}Pmk(){this.LAf(this.PAi)}Qmk(){this.LAf(this.QAi)}LAf(qa){this.bLb?this.Hge(this.queries,qa):this.zT().continueWith(qb=>{qb.result?this.Hge(this.queries,qa):L.ULS.sendTraceTag(537154445,
0,10,"PowerQueryManager.RefreshAllQueries failed to fetch queries")})}Hge(qa,qb){const bc=qa.filter(qb),R=bc.map(zb=>zb.Name),cb=La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryInteractiveSignIn",!1);cb&&this.ub.raiseEvent("onRefreshStartedKey",R);0<bc.length&&void this.FUd(!0,!1).then(zb=>{zb?bc.forEach(V=>this.qEg(V.Name)):cb&&this.ub.raiseEvent("onRefreshCompletedKey",R)},()=>{cb&&this.ub.raiseEvent("onRefreshCompletedKey",R)})}aZi(qa){var qb;for(const bc of this.queries)if((null===
(qb=this.VC.getItem(bc.Name))||void 0===qb?void 0:qb.ConnectionName)===qa)return bc.Name;return null}iYi(){return this.PFf("Core",id,!1)}F7i(qa){const qb=bc=>{if(bc.Errors&&0<bc.Errors.length)L.ULS.sendTraceTag(507307087,0,10,`PowerQueryManager.handleEditSessionOperation: handleEditSessionOperation operation failed ${bc.Errors}`);else if(qa&&qa.AddedQueries&&0<qa.AddedQueries.length){var R=new yb.a(1156885807,gf.a.Hb,this.$.xc,0,fa.a.Drb);bc&&bc.Result&&(this.$.Ia.Gb(R,{[Dc.selectedQueryKey]:bc.Result.LoadedQueryName}),
R=G.a.resolve(A.SheetOpsHelperService,{xa:1}),void R.then(()=>{this.zmd(bc.Result.LoadedToSheetName)}))}};this.$.userOperationManager.enqueueOperation(new Pc.a(1041,0,(bc,R,cb)=>Wf(this.$.ma.sa,qa,Ca.c(bc,qb),R,cb,null),4),null)}};Sd=Object(I.__decorate)([Object(G.d)(A.PowerQueryManagerService),Object(I.__param)(0,Object(A.EwaControlService)()),Object(I.__param)(1,Object(A.OAuthManagerWrapperService)()),Object(I.__param)(2,Object(A.DataRefreshManagerService)())],Sd);Object(M.a)(Sd,"PowerQueryManager",
null,[322,4]);var ne=a(780);class Ce{constructor(qa,qb,bc,R,cb,zb,V){this.$=qa;this.Dmg=qb;this.authTokenAsyncCallback=bc;this.showFeedbackDialogCallback=R;this.dug=cb;this.oVj=zb;this.aUj=V}get vEe(){return this.flowId}get Z8(){return qa=>{var qb;null===(qb=this.aUj)||void 0===qb?void 0:qb.call(this,qa);this.Dmg()}}Zse(){this.$.kY(qa=>{void qa.O1(1).then(()=>{void appChrome.startPowerQueryFlow(this.QNd(),this.authTokenAsyncCallback,this.dug,this.p_i(this.flowId),this.showFeedbackDialogCallback)})})}dispose(){this.authTokenAsyncCallback=
this.$=null}ENd(){return{isModal:!0,locale:this.$.ta.UICultureTag,sessionId:this.$.ta.UserSessionId,hostContextType:this.$.ta.PowerQueryHostContextType,powerQueryEndpointUrl:this.$.ta.PowerQueryEndpointUrl,authTokenAsyncCallback:this.authTokenAsyncCallback,onUnlinkConnection:this.dug}}p_i(qa){return(qb,bc)=>{var R;switch(qb){case 0:this.Z8();break;case 1:null===(R=this.oVj)||void 0===R?void 0:R.call(this,bc);break;case 2:this.Dmg()}L.ULS.sendTraceTag(508171527,0,20,`PowerQueryReactFlowDialogBuilder.resultHandler committed with action button: ${ne.a[qb]}, flowId: ${qa}`)}}}
Ce.q3a="queryName";Object(M.a)(Ce,"PowerQueryReactFlowDialogBuilderBase",null,[]);class Ge extends Ce{constructor(qa,qb,bc,R,cb,zb,V){super(qa,qb,bc,R,void 0,cb,void 0);this.lzk={["height"]:500,["width"]:580,["unit"]:"px"};this.flowId=0;this.kind=zb;this.path=V}QNd(){const qa=this.ENd();qa.bodyProps=this.lzk;qa.flowProps={flowId:this.flowId,resourceKind:this.kind,resourcePath:this.path};return qa}}Ge.Dva="kind";Ge.BQc="path";Ge.n2h="connectionName";Object(M.a)(Ge,"PowerQueryResolveChallengeReactFlowDialogBuilder",
Ce,[]);class Ee extends Ce{constructor(qa,qb,bc,R,cb,zb){super(qa,qb,bc,R,cb);this.qJj={["height"]:50,["width"]:50,["unit"]:"%"};this.flowId=1;this.connectionOverrides=zb}QNd(){const qa=this.ENd();qa.bodyProps=this.qJj;qa.flowProps={flowId:this.flowId,connectionOverrides:this.connectionOverrides};return qa}}Object(M.a)(Ee,"PowerQueryManageConnectionsReactFlowDialogBuilder",Ce,[]);var Ue=a(189);class We{static createSession(qa,qb,bc,R,cb,zb){qa=We.A$h(qa,zb,R);return new We(qa.queries,jb.yif(qb),jb.uif(cb),
bc,qa.activeQueryId)}get Queries(){return this.queries}get Groups(){return this.groups}get hdh(){return this.p2h}get $eh(){return this.mashupDocument}get gch(){return this.activeQueryId}LPi(qa,qb,bc,R){const cb=[],zb=[],V=[],Ea=[];this.queries.forEach(Jb=>{const zc=qa.find(Mc=>Mc.runTimeId===Jb.runTimeId);zc?(zc.name!==Jb.name&&zb.push({OldQueryName:Jb.name,NewQueryName:zc.name}),zc.groupKey!==Jb.groupKey&&V.push({QueryName:zc.name,NewGroupId:""===zc.groupKey?"Other Queries":zc.groupKey})):cb.push(Jb.name)});
qa.forEach(Jb=>{this.queries.find(zc=>zc.runTimeId===Jb.runTimeId)||Ea.push({QueryName:Jb.name,NewGroupId:Jb.groupKey})});const pb={};pb.DeletedQueries=cb;pb.AddedQueries=Ea;pb.RenamedQueries=zb;pb.GroupChangedQueries=V;pb.Groups=jb.Eif(qb);pb.Connections=jb.X3h(R);pb.Mashup=bc;return pb}constructor(qa,qb,bc,R,cb){this.queries=qa;this.groups=qb;this.p2h=bc;this.mashupDocument=R;this.activeQueryId=cb}static A$h(qa,qb,bc){qa=jb.c4h(qa);let R=void 0;qa.forEach(cb=>{cb.runTimeId=Ue.a.create().toString();
cb.inRefresh=bc.includes(cb.name);cb.name===qb&&(R=cb.runTimeId)});return{queries:qa,activeQueryId:R}}}Object(M.a)(We,"PowerQueryEditSession",null,[]);class ya extends Ce{constructor(qa,qb,bc,R,cb,zb,V,Ea,pb,Jb,zc,Mc,od){super(qb,bc,R,cb,zb,V,Ea);this.yki={["height"]:90,["width"]:90,["unit"]:"%"};this.Amf="CurrentWorkbook";this.YIh="Anonymous";this.Kfk="Private";this.Izk="XLO_RestUrl";this.Wkl="XLO_WorkbookSessionId";this.s_h="XLO_ClusterId";this.COj="XLO_NamedRangeEnabled";this.sessionKey="session";
this.t$k="usid";this.r_h="cluster";this.LJk(qa);this.queries=pb;this.groups=Jb;this.mashupDocument=zc;this.activeQueryId=od;this.connectionOverrides=Mc}QNd(){const qa=this.ENd();qa.bodyProps=this.yki;qa.flowProps=2===this.flowId?this.JPi():this.$Ri();return qa}JPi(){return{flowId:this.vEe,editingSessionMetadata:this.gIf(),activeQueryId:this.activeQueryId}}$Ri(){return{flowId:this.vEe,editingSessionMetadata:this.gIf()}}gIf(){return{queries:this.queries,queryGroups:this.groups,mashupDocument:this.mashupDocument,
connectionOverrides:this.hQi()}}hQi(){this.connectionOverrides.push(this.U6h());return this.connectionOverrides}U6h(){const qa={kind:this.Amf,path:this.Amf,authenticationKind:this.YIh,privacyGroup:this.Kfk,credentialDetails:new Map};qa.credentialDetails.set(this.Izk,this.$.ta.RestActionUrl);qa.credentialDetails.set(this.Wkl,this.k5i());qa.credentialDetails.set(this.s_h,this.$.ta.MachineCluster);qa.credentialDetails.set(this.COj,La.EwaSettings.isChangeGateEnabled("OfficeVSO:8642573_PowerQueryCurrentWorkbookNamedRange").toString());
return qa}k5i(){const qa=new URLSearchParams;qa.append(this.r_h,this.$.ta.MachineCluster);qa.append(this.sessionKey,this.$.fa.sessionId);qa.append(this.t$k,Ue.a.create().toString());return qa.toString()}LJk(qa){switch(qa){case -2080757377:this.flowId=2;break;case -1771748809:this.flowId=3;break;default:throw Error("PowerQueryGetAndTransformReactFlowDialogBuilder.setFlowId - Invalid ribbon command");}}}Object(M.a)(ya,"PowerQueryGetAndTransformReactFlowDialogBuilder",Ce,[]);let Cb=class{constructor(qa,
qb){this.AHd=()=>{this.aGc=!1;this.Kue()};this.g0k=bc=>{bc&&(L.ULS.sendTraceTag(509613448,0,50,`PowerQueryUIFlowManager:ResolveChallenge: starting resolve challenge flow.
         Kind: ${bc[Ge.Dva]}`),(new Ge(this.$,this.AHd,this.ig.VOb,this.ig.showFeedbackDialogCallback,this.PMi(bc[Ge.q3a]),bc[Ge.Dva],bc[Ge.BQc])).Zse())};this.R_k=()=>{L.ULS.sendTraceTag(508601607,0,50,"PowerQueryUIFlowManager:ManageConnections: starting manage connections flow.");ze(this.$.ma.sa,this.XVk,()=>{L.ULS.sendTraceTag(508429978,0,10,"PowerQueryUIFlowManager:getDataSourceConnectionsFromRoaming manage connection read roaming Failed")},null,null)};this.J_k=(bc,R)=>{L.ULS.sendTraceTag(508421188,
0,50,`PowerQueryUIFlowManager:GetAndTransform: starting GetAndTransform query flow: ${R}.`);ze(this.$.ma.sa,this.f1i(bc,R),()=>{L.ULS.sendTraceTag(508421187,0,10,`PowerQueryUIFlowManager:getDataSourceConnectionsFromRoaming GetAndTransform flow: ${R} ,read roaming Failed`)},null,null)};this.XVk=bc=>{L.ULS.sendTraceTag(508429977,0,50,"PowerQueryUIFlowManager:ManageConnections: Read roaming succeeded.");bc=jb.uif(bc.Result);(new Ee(this.$,this.AHd,this.ig.VOb,this.ig.showFeedbackDialogCallback,this.ig.eze,
bc)).Zse()};this.zJi=bc=>{bc?(bc=this.Yla.LPi(bc.queries,bc.queryGroups,bc.mashupDocument,bc.connectionOverrides),this.Yla=null,this.ig.F7i(bc)):L.ULS.sendTraceTag(507605655,0,10,"getAndTransformFlowCommitCallback: props is null or undefined")};this.yJi=()=>{this.Yla=null};this.$=qa;this.ig=qb;this.pja=[];this.aGc=!1;this.t4b=new Ba.a(!1);this.Yla=null}td(){return!1}gd(){return!1}executeCommand(qa,qb,bc){L.ULS.sendTraceTag(508162324,0,20,`PowerQueryUIFlowManager: handling ribbon command: ${qb.command}}`);
return Yb.d(this.ig.gVh().then(R=>{if(R)switch(qb.command){case -1496653501:this.t4g(bc)||(Array.enqueue(this.pja,{Ti:qb.command,props:bc}),this.Kue());break;case 1452434397:case -2080757377:case -1771748809:Array.enqueue(this.pja,{Ti:qb.command,props:bc}),this.Kue()}}))}dispose(){this.Yla=this.t4b=this.pja=this.$=this.ig=null}Rc(qa,qb){switch(qb.command){case -1496653501:case 1452434397:case -2080757377:case -1771748809:return-1496653501===qb.command?!0:void 0===this.pja.find(bc=>bc.Ti===qb.command);
default:return!1}}Kue(){const qa=this.o9k();if(qa)switch(L.ULS.sendTraceTag(508121948,0,50,`PowerQueryUIFlowManager:startFlow: starting flow.
         flowId: ${qa.Ti}`),qa.Ti){case -1496653501:this.g0k(qa.props);break;case 1452434397:this.R_k();break;case -2080757377:case -1771748809:this.J_k(qa.props,qa.Ti);break;default:L.ULS.sendTraceTag(508121947,0,10,`PowerQueryUIFlowManager:startFlow unexpected ribbonCommand: ${qa.Ti}`)}}o9k(){return!this.aGc&&0<this.pja.length?(this.aGc=!0,Array.dequeue(this.pja)):null}f1i(qa,qb){return bc=>{L.ULS.sendTraceTag(508421186,0,50,`PowerQueryUIFlowManager:GetAndTransform flow: ${qb}, Read roaming succeeded.`);
this.ig.$Bk(()=>{this.Yla=We.createSession(this.ig.queries,this.ig.groups,this.ig.formulas,this.ig.hnk,bc.Result,qa[ya.q3a]);(new ya(qb,this.$,this.AHd,this.ig.VOb,this.ig.showFeedbackDialogCallback,this.ig.eze,this.zJi,this.yJi,this.Yla.Queries,this.Yla.Groups,this.Yla.$eh,this.Yla.hdh,this.Yla.gch)).Zse()})}}X8k(){for(let qa=this.pja.length-1;0<=qa;qa--){const qb=this.pja[qa];-1496653501===qb.Ti&&this.t4g(qb.props)&&L.ULS.sendTraceTag(508121946,0,50,`PowerQueryUIFlowManager:ResolveChallenge: auto resolve challenge succeeded.
           Kind: ${qb.props[Ge.Dva]}`)}}t4g(qa){var qb=this.iwg(qa);qb=this.t4b.getItem(qb);if(!qb||Array.contains(qb,qa[Ge.q3a]))return L.ULS.sendTraceTag(508121945,0,50,`PowerQueryUIFlowManager:ResolveChallenge: try auto resolve challenge failed.
         isCached: ${!!qb},
         prevResolved: ${Array.contains(qb,qa[Ge.q3a])}`),!1;const bc=this.pja.findIndex(R=>-1496653501===R.Ti&&R.props===qa);Array.removeAt(this.pja,bc);this.aGc=!1;Array.add(qb,qa[Ge.q3a]);this.ig.YSc(qa[Ge.q3a]);return!0}bfl(qa){var qb=this.iwg(qa);const bc=qa[Ge.q3a];this.t4b.Bb(qb)?(qb=this.t4b.getItem(qb),qb.includes(bc)||Array.add(qb,bc)):this.t4b.add(qb,[bc]);L.ULS.sendTraceTag(509613446,0,50,`PowerQueryUIFlowManager:ResolveChallenge: Cache updated with Kind: ${qa[Ge.Dva]}`)}iwg(qa){return qa[Ge.Dva].concat("_",
qa[Ge.BQc])}PMi(qa){return async qb=>{if(qb){var bc=[];qb.forEach(R=>{bc.push({K:R[Ge.Dva],P:R[Ge.BQc],ID:R[Ge.n2h],V:null})});Le(this.$.ma.sa,bc,2,R=>{!R||0<R.Errors.length?L.ULS.sendTraceTag(509743360,0,10,`PowerQueryUIFlowManager:ResolveChallenge: success callback failure: ${R.Result}`):(1<qb.length&&L.ULS.sendTraceTag(509649952,0,10,"PowerQueryUIFlowManager:ResolveChallenge: commit result array contains more than one result"),this.ig.YSc(qa,!0),L.ULS.sendTraceTag(509613445,0,20,`PowerQueryUIFlowManager:ResolveChallenge: Write Roaming succeeded, challenge resolved.
          Kind: ${qb[0][Ge.Dva]}`),this.bfl({kind:qb[0][Ge.Dva],path:qb[0][Ge.BQc],queryName:qa}),this.X8k())},()=>{L.ULS.sendTraceTag(509743330,0,10,`PowerQueryUIFlowManager:ResolveChallenge: Write Roaming failed,
          Kind: ${qb[0][Ge.Dva]}`)},null,null)}else L.ULS.sendTraceTag(509691530,0,10,"PowerQueryUIFlowManager:ResolveChallenge: commit result null")}}};Cb=Object(I.__decorate)([Object(G.d)(A.PowerQueryUIFlowManagerService),Object(I.__param)(0,Object(A.EwaControlService)()),Object(I.__param)(1,Object(A.PowerQueryManagerService)())],Cb);Object(M.a)(Cb,"PowerQueryUIFlowManager",null,[29,4]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.InsertPivotTable");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PivotCommand");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PowerQuery");Type.registerNamespace("_Ewa");a(1578);a(1580);a(1582);String(c);String(b);String(f);String(k);String(x);String(d);String(h);String(n);String(m);String(u);String(l);String(t);String(e);String(z);String(w);String(E);window.___1717508060400_closurehack=c;window.___1717508060400_closurehack=b;window.___1717508060400_closurehack=f;window.___1717508060400_closurehack=k;window.___1717508060400_closurehack=x;window.___1717508060400_closurehack=
d;window.___1717508060400_closurehack=h;window.___1717508060400_closurehack=n;window.___1717508060400_closurehack=m;window.___1717508060400_closurehack=u;window.___1717508060400_closurehack=l;window.___1717508060400_closurehack=t;window.___1717508060400_closurehack=e;window.___1717508060400_closurehack=z;window.___1717508060400_closurehack=w;window.___1717508060400_closurehack=E}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.bi.js.map/8ccc469d5fbd053be8457c87e6798151/EwaTS.bi.js.map