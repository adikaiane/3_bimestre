'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[3],{1029:function(y,r,a){function c(Oa,Ha,Za,fa,la,ba){ba=void 0===ba?null:ba;e.b(Oa).Jd(C.a.dTj,k(),void 0,!0);const aa=Pa=>{if(w.a.X9(Pa)){const za=w.a.v7(Pa);ea?w.a.Kl(z.a.filterByColorOrIcon,za.MessageIdName,E.a.bba,!0,w.a.BIa(za.MessageId)):t.ULS.sendTraceTag(508372234,0,10,"ContextMenuFilterHelper::applyFilterByColorOrIcon failed with AutoFilterException -{0}",za.MessageIdName)}M.a(Pa)||(t.ULS.sendTraceTag(508372233,
0,50,"ContextMenuFilterHelper::applyFilterByColorOrIcon service call succeeded"),e.b(Oa).Jd(C.a.MYj,k(),void 0,!0),null!==Za&&b(Oa,Za),S.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowFilteredResultsInStatusBar",!1)&&(null===ba||void 0===ba?void 0:ba.zya(Pa.Result,"Table"===Ha.AutoFilterType,Ha.Id)))},oa=d(Oa,Ha),Na=new A.a(266,0,(Pa,za,wa)=>U.a(Oa.ma.sa,oa,Ha,G.c(Pa,aa),za,wa,null,null),6),Ia=()=>{Oa.userOperationManager.enqueueOperation(Na,null)},Sa=Oa.fa.$b.allowViewCollab;la||Sa?
fa.EKa(Ia,19,"ContextMenuFilterHelper::applyFilterByColorOrIcon"):f(Ia)}function b(Oa,Ha){J.a.oIa(Oa)&&(S.EwaSettings.FN()||L.TaskExtensions.tb(I.GetServiceTaskFactory.Ne(Oa.ra,430,431,1),Za=>{Za.result.tNa(Ha);t.ULS.sendTraceTag(508372231,306,50,"AutoFilterContextMenu:TriggerPivotTableHandRaise Trigger hand raise from filter context menu.")},Oa.Aa,3))}function f(Oa){void N.a.resolve(K.NamedSheetViewPublicService,{xa:3}).then(Ha=>{Ha.M5a().continueWith(Za=>{Za.result&&Oa()})})}function k(){return{["Location"]:"contextMenu"}}
function x(Oa){let Ha=0;var Za=Oa.ha.oa.activeCell;Oa=N.a.Cb(K.TableManagerService);var fa=Oa.Vs;const la=Oa.WOb(Za);fa?(Oa="Table",Ha=fa.objectId):la?(Oa="Table",Ha=la.id):Oa="Sheet";Za=Za.left;fa={};fa.AutoFilterType=Oa;fa.Column=Za;fa.Id=Ha;fa.ItemListOptions=null;return fa}function d(Oa,Ha){const Za={};Oa.Zk(Za);Za.FirstRow=0;Za.FirstColumn=Ha.Column;Oa=Oa.fa.isNamedObjectViewMode;Ha.NamedObjectView=Oa;Ha.SheetName=Oa?Za.NamedObjectName:Za.SheetName;Oa={};Oa.Location=Za;Oa.FieldId=Ha.Id.toString();
Oa.DataSourceIndex=-1;Oa.FilterType=Ha.AutoFilterType;Oa.AnchorType=0;Oa.ChartId=null;Oa.AnchorValue1=-1;Oa.AnchorValue2=-1;Oa.Property=Ha.RichProperty;return Oa}function h(Oa,Ha){const Za=Ha.Ob(Ha.ha.oa.activeCell);Ha={FilterColor:0,FilterIcon:-1,FilterIconSet:-1};switch(Oa){case 486423932:Za.gYa&&(Oa=Y.a.np(Za.backgroundColor),Ha.FilterColor=Oa.fS(!0));Ha.FilterType=Enum.toString(X.b,X.b.FilterOnCellColor);break;case -652157481:0!==Za.hJb&&(Ha.FilterColor=Y.a.fsd(Za.hJb));Ha.FilterType=Enum.toString(X.b,
X.b.FilterOnFontColor);break;case -1656122924:Za.Ejb&&(Ha.FilterIcon=Za.cell.NWb,Ha.FilterIconSet=Za.OWb);Ha.FilterType=Enum.toString(X.b,X.b.FilterOnIcon);break;default:t.ULS.debugAssertTag(508372232,0,!1,"ContextMenuFilterHelper.createFilterColorOrIconOptionsForGridContextMenu: ribbon command didn't match any of the case statements")}return Ha}function n(Oa){const Ha={};Ha.FilterType=Enum.toString(X.b,Oa.type);Ha.FilterColor=Oa.color;Ha.FilterIcon=Oa.icon.Icon;Ha.FilterIconSet=Oa.icon.IconSet;return Ha}
function m(Oa,Ha,Za){const fa={};fa.FirstRow=u(Oa,Ha);fa.FirstColumn=Za;return-1!==fa.FirstRow?O.H(fa):null}function u(Oa,Ha){Oa=Oa.ha.oa.activeCell;var Za=N.a.Cb(K.TableManagerService);const fa=Za.Vs;Za=Za.WOb(Oa);if(fa)return fa.usedRange.top;if(null!=Za)return Za.top;Ha=Ha.qa.getItemByName(Ha.la.sheetName);return(Ha=O.I(Ha.bD))&&Ha.contains(Oa)?Ha.top:-1}function l(Oa,Ha){const Za=B.f(Oa).ha.oa.activeCell,fa=Ha.Eb.dg(Za);if(fa)return fa.hasAutoFilter;Oa=O.y(Za,Oa);return Ha.Eb.FYd(Oa)}a.d(r,"a",
function(){return c});a.d(r,"k",function(){return b});a.d(r,"j",function(){return f});a.d(r,"g",function(){return k});a.d(r,"e",function(){return x});a.d(r,"b",function(){return d});a.d(r,"d",function(){return h});a.d(r,"c",function(){return n});a.d(r,"h",function(){return m});a.d(r,"f",function(){return u});a.d(r,"i",function(){return l});var t=a(15),e=a(151),w=a(962),z=a(988),E=a(142),M=a(255),G=a(266),A=a(213),N=a(65),K=a(5),I=a(81),L=a(43),J=a(29),B=a(25),Y=a(172),U=a(1125),O=a(44),C=a(150),X=
a(1656),S=a(1);const ea=w.a.Lkb()},1125:function(y,r,a){a.d(r,"c",function(){return b});a.d(r,"b",function(){return f});a.d(r,"d",function(){return k});a.d(r,"a",function(){return x});var c=a(61);const b=(d,h,n,m,u,l,t,e)=>{h=c.M(d,h,n,e);return c.h(d,"GetPivotValueFieldSettingsInitial",h,m,u,l,t,4)},f=(d,h,n,m,u,l,t,e,w)=>{h=c.M(d,h,n,w);h.pivotValueFieldSettingsApplyData=m;return c.h(d,"ApplyPivotValueFieldSettings",h,u,l,t,e,0)},k=(d,h,n,m,u,l,t,e,w)=>{h=c.M(d,h,n,w);h.selectedBaseField=m;return c.h(d,
"GetPivotValueFieldSettingsShowValueAsBaseItems",h,u,l,t,e,4)},x=(d,h,n,m,u,l,t,e)=>{e=d.$a(41,e);e.parameters=h;e.autoFilterOptions=n;return c.h(d,"ApplyColorOrIconFilter",e,m,u,l,t,64)}},1199:function(y,r,a){a.r(r);a.d(r,"GridContextMenu",function(){return Va});y=a(133);r=a(0);var c=a(15),b=a(393),f=a(107),k=a(178),x=a(55),d=a(242),h=a(656),n=a(6),m=a(154),u=a(363),l=a(946),t=a(10),e=a(31),w=a(20),z=a(72),E=a(7),M=a(1266),G=a(1001),A=a(256),N=a(13),K=a(1),I=a(963),L=a(29),J=a(98);class B{constructor(xa,
ia,Z,ta,pa,Ga,Ca,kb){this.$=ia;this.Ya=Z;this.Wo=ta;this.selectedRanges=pa;this.grid=Ga;this.cD=kb;this.ika=Ca;this.XCa=d.a.all(pa,eb=>eb.isRow);this.WCa=d.a.all(pa,eb=>eb.Oe);this.y1a=d.a.all(pa,eb=>!eb.isRow&&!eb.Oe);ia=Ga.Eb.KOd(pa);this.cfb=!!ia;this.GIg=!!ia&&ia.hasActiveFilter;this.menuSection=Z.uc();xa.Zb.push(this.menuSection);this.m2=this.XCa||this.WCa?this.menuSection:Z.uc();this.Ria=this.XCa||this.WCa?this.menuSection:Z.uc()}$Id(){if(L.a.oUb()&&L.a.CN()&&(K.EwaSettings.WTb()&&this.cfb&&
A.a.UN("XLS-CopilotContextMenu-Treatment;XLS-CopilotContextMenu-Control"),L.a.a0f()))if(K.EwaSettings.WTb()&&J.b("CopilotContextMenuVisible"),this.cfb)this.jGi();else if(K.EwaSettings.isChangeGateEnabled("OfficeVSO:8989265_CopilotNonTableContextMenu")){var xa=this.Ya.yb(386);this.menuSection.buttons.push(xa)}this.VGi();this.sGi();xa=this.cD.H_a(this.selectedRanges,this.grid);this.menuSection.buttons.push(this.Ya.yb(xa?149:148))}$Gi(xa){var ia=0,Z=0,ta=null;let pa=null;const Ga=I.i(this.selectedRanges),
Ca=1<Ga?N.a.instance.ia(430):N.a.instance.ia(2539),kb=1<Ga?N.a.instance.ia(2526):N.a.instance.ia(2540),eb=this.cD.jr(this.Wo,-1113896058,this.selectedRanges,this.grid),Yb=this.cD.jr(this.Wo,942362098,this.selectedRanges,this.grid),Gb=K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)&&this.cD.jr(this.Wo,75170472,this.selectedRanges,this.grid);this.cfb?this.ika.jr(942362098)?(ia=Yb?161:169,ta=Ga+" "+N.a.instance.ia(1969)+" "+Ca):this.GIg&&(ia=this.cD.jr(this.Wo,
-1113896058,this.selectedRanges,this.grid)?177:181,Z=Gb?363:364,ta=Ga+" "+Ca,pa=Ga+" "+kb):this.ika.jr(-1113896058)&&(this.XCa?(ia=eb?49:116,Z=Gb?365:366,ta=N.a.instance.ia(514)+" "+Ga+" "+Ca,pa=N.a.instance.ia(514)+" "+Ga+" "+kb):(ia=eb?177:181,Z=Gb?363:364,ta=Ga+" "+Ca,pa=Ga+" "+kb));0!==ia&&(ia=this.Ya.yb(ia),K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?(ta&&(ia.label=ta,ia.Ap(ta)),xa?(ta=this.Ya.uc(),ta.buttons.push(ia),0!==Z&&(Z=this.Ya.yb(Z),
pa&&(Z.label=pa,Z.Ap(pa)),ta.buttons.push(Z)),xa.menu.Zb.push(ta)):(this.m2.buttons.push(ia),0!==Z&&(xa=this.Ya.yb(Z),pa&&(xa.label=pa,xa.Ap(pa)),this.m2.buttons.push(xa)))):this.m2.buttons.push(ia))}WGi(xa){var ia=0,Z=0;let ta=null,pa=null;var Ga=I.g(this.selectedRanges);const Ca=1<Ga?N.a.instance.ia(2543):N.a.instance.ia(2545),kb=1<Ga?N.a.instance.ia(2544):N.a.instance.ia(2546),eb=this.cD.jr(this.Wo,622604322,this.selectedRanges,this.grid);var Yb=this.cD.jr(this.Wo,1415868706,this.selectedRanges,
this.grid);const Gb=this.cD.jr(this.Wo,-612877076,this.selectedRanges,this.grid);this.cfb?this.ika.jr(622604322)&&(this.grid.rtl?(ia=eb?191:192,ta=Ga+" "+N.a.instance.ia(1969)+" "+kb):(ia=eb?162:170,ta=Ga+" "+N.a.instance.ia(1969)+" "+Ca)):this.ika.jr(1415868706)&&(this.WCa?K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?this.grid.rtl?(ia=Yb?288:289,Z=Gb?369:370,ta=N.a.instance.ia(514)+" "+Ga+" "+kb,pa=N.a.instance.ia(514)+" "+Ga+" "+Ca):(ia=Yb?336:
337,Z=Gb?367:368,ta=N.a.instance.ia(514)+" "+Ga+" "+Ca,pa=N.a.instance.ia(514)+" "+Ga+" "+kb):(ia=K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StringChangesForInsertOperation",!1)?this.grid.rtl?288:336:50,Ga=K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StringChangesForInsertOperation",!1)?this.grid.rtl?289:337:117,ia=Yb?ia:Ga):K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?this.grid.rtl?(ia=Yb?290:291,Z=Gb?371:372,ta=
Ga+" "+kb,pa=Ga+" "+Ca):(ia=Yb?334:335,Z=Gb?373:374,ta=Ga+" "+Ca,pa=Ga+" "+kb):(ia=K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StringChangesForInsertOperation",!1)?this.grid.rtl?290:334:178,Ga=K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StringChangesForInsertOperation",!1)?this.grid.rtl?291:335:182,ia=Yb?ia:Ga));0!==ia&&(ia=this.Ya.yb(ia),K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?(Yb=this.Ya.uc(),ta&&(ia.label=
ta,ia.Ap(ta)),xa?(Yb.buttons.push(ia),0!==Z&&(Z=this.Ya.yb(Z),pa&&(Z.label=pa,Z.Ap(pa)),Yb.buttons.push(Z)),xa.menu.Zb.push(Yb)):(this.m2.buttons.push(ia),0!==Z&&(xa=this.Ya.yb(Z),pa&&(xa.label=pa,xa.Ap(pa)),this.m2.buttons.push(xa)))):this.m2.buttons.push(ia))}UGi(xa){const ia=this.Ya.uc();if(this.ika.jr(1035996630))if(this.cD.jr(this.Wo,1035996630,this.selectedRanges,this.grid)){var Z=this.Ya.yb(this.grid.rtl?187:165);const ta=this.Ya.yb(166);K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)?(ia.buttons.push(Z),ia.buttons.push(ta),xa.menu.Zb.push(ia)):(this.m2.buttons.push(Z),this.m2.buttons.push(ta))}else Z=this.Ya.yb(this.grid.rtl?188:173),xa&&K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?(ia.buttons.push(Z),ia.buttons.push(this.Ya.yb(174)),xa.menu.Zb.push(ia)):(this.m2.buttons.push(Z),this.m2.buttons.push(this.Ya.yb(174)))}jGi(){const xa=this.Ya.P0("ContextMenu.Copilot",void 0,"Copilot",-2047041477,1,null,"M365Excel_20");var ia=
this.Ya.yb(383);ia.Ap(appChrome.getCopilotShowDataInsightsPromptString());ia.label=appChrome.getCopilotShowDataInsightsPromptString();var Z=this.Ya.yb(384);Z.Ap(appChrome.getCopilotSuggestFormulaColumnPromptString());Z.label=appChrome.getCopilotSuggestFormulaColumnPromptString();const ta=this.Ya.uc();ta.buttons.push(ia);ta.buttons.push(Z);xa.menu.Zb.push(ta);ia=this.Ya.yb(385);Z=this.Ya.uc();Z.buttons.push(ia);xa.menu.Zb.push(Z);this.menuSection.buttons.push(xa)}VGi(){const {GridContextMenu:xa}=a(1199);
let ia=null;this.y1a&&(ia=K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?ia=this.Ya.P0("ContextMenu.InsertCells",null,N.a.instance.ia(345),1896159024,8,w.a.bwc):this.Ya.iu("ContextMenu.InsertCells",null,N.a.instance.ia(345),1896159024),K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)||ia.menu.Zb.push(this.m2));const Z=this.Ya.uc();xa.XGi(K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)&&this.y1a?Z:this.m2,this.Ya,this.$);K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)&&this.y1a&&Z.buttons.length&&ia.menu.Zb.push(Z);this.$Gi(ia);this.WGi(ia);this.UGi(ia);(K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)&&ia&&0<ia.menu.Zb.length||ia&&0<this.m2.buttons.length)&&this.menuSection.buttons.push(ia)}vGi(xa){var ia=0;let Z=null;var ta=I.i(this.selectedRanges);const pa=I.j(this.selectedRanges);
ta=1<ta?N.a.instance.ia(429):N.a.instance.ia(2541);this.cfb?this.ika.jr(1405456548)?(ia=this.cD.jr(this.Wo,1405456548,this.selectedRanges,this.grid)?163:171,Z=N.a.instance.ia(1969)+" "+ta+" "+pa):this.GIg&&(ia=this.cD.jr(this.Wo,1554436520,this.selectedRanges,this.grid)?179:183,Z=ta+" "+pa):this.ika.jr(1554436520)&&(this.XCa?(ia=this.cD.jr(this.Wo,1554436520,this.selectedRanges,this.grid)?51:118,Z=N.a.instance.ia(409)+" "+ta+" "+pa):(ia=this.cD.jr(this.Wo,1554436520,this.selectedRanges,this.grid)?
179:183,Z=ta+" "+pa));0!==ia&&(ia=this.Ya.yb(ia),K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?(Z&&(ia.label=Z,ia.Ap(Z)),xa?xa.buttons.push(ia):this.Ria.buttons.push(ia)):this.Ria.buttons.push(ia))}tGi(xa){var ia=0;let Z=null;var ta=I.g(this.selectedRanges);const pa=I.f(this.selectedRanges);ta=1<ta?N.a.instance.ia(426):N.a.instance.ia(2542);this.cfb?this.ika.jr(284490184)&&(ia=this.cD.jr(this.Wo,284490184,this.selectedRanges,this.grid)?164:172,
Z=N.a.instance.ia(1969)+" "+ta+" "+pa):this.ika.jr(674605324)&&(this.WCa?(ia=this.cD.jr(this.Wo,674605324,this.selectedRanges,this.grid)?52:119,Z=N.a.instance.ia(409)+" "+ta+" "+pa):(ia=this.cD.jr(this.Wo,674605324,this.selectedRanges,this.grid)?180:184,Z=ta+" "+pa));0!==ia&&(ia=this.Ya.yb(ia),K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?(Z&&(ia.label=Z,ia.Ap(Z)),xa?xa.buttons.push(ia):this.Ria.buttons.push(ia)):this.Ria.buttons.push(ia))}rGi(xa){const ia=
this.Ya.uc();if(this.ika.jr(1035996630))if(this.cD.jr(this.Wo,1035996630,this.selectedRanges,this.grid)){var Z=this.Ya.yb(this.grid.rtl?189:167),ta=this.Ya.yb(168);K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?(ta.label="Shift cells up",ta.Ap("Shift cells up"),ia.buttons.push(Z),ia.buttons.push(ta),xa.menu.Zb.push(ia)):(this.Ria.buttons.push(Z),this.Ria.buttons.push(ta))}else Z=this.Ya.yb(this.grid.rtl?190:175),ta=this.Ya.yb(176),xa&&K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)?(ia.buttons.push(Z),ia.buttons.push(ta),xa.menu.Zb.push(ia)):(this.Ria.buttons.push(Z),this.Ria.buttons.push(ta))}sGi(){let xa=null,ia=null;this.y1a&&(xa=K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?this.Ya.P0("ContextMenu.DeleteCells",null,N.a.instance.ia(409),-1554384558,1,null,"DeleteCells_20"):this.Ya.iu("ContextMenu.DeleteCells",null,N.a.instance.ia(409),-1554384558),K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)||xa.menu.Zb.push(this.Ria),ia=this.Ya.uc());this.vGi(ia);this.tGi(ia);xa&&ia&&0<ia.buttons.length&&xa.menu.Zb.push(ia);this.rGi(xa);(K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)&&xa&&0<xa.menu.Zb.length||xa&&0<this.Ria.buttons.length)&&this.menuSection.buttons.push(xa)}}Object(r.a)(B,"CellsContextMenuGenerator",null,[]);class Y{constructor(xa){this.ranges=null;this.ranges=xa}}Object(r.a)(Y,"MacroRecorderRangeHyperlinkRemovedPayload",null,[67]);
var U=a(628),O=a(27),C=a(100),X=a(70),S=a(86),ea=a(44),Oa=a(213),Ha=a(61),Za=a(747),fa=a(134),la=a(43),ba=a(209),aa=a(25),oa=a(433),Na=a(210),Ia=a(28),Sa=a(1264),Pa=a(88),za=a(65),wa=a(5),db=a(368);class Ba{constructor(xa,ia){this.activeCell=this.selection=null;this.selection=xa;this.activeCell=ia}getSelection(){return this.selection}getActiveCell(){return this.activeCell}}Object(r.a)(Ba,"MacroRecorderToggleInCellControlCheckboxPayload",null,[67]);var Ka=a(1029),da=a(557),sa=a(932),mb=a(1265),Ma=
a(17),hb=a(12),$a;let Va=$a=class extends l.a{constructor(xa,ia,Z,ta,pa,Ga){super(xa,"PopulateGridContextMenu",1247109494,-2064931494,$a.w6i,!0,!1,$a.B4a,Ga,ia,!0,Z,ta);this.GIc=this.expandCollapse=this.refresh=this.MX=this.Uja=this.tfa=!1;this.Nkf=!0;this.O6d=!1;this.t_d=K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnhideRowColumnUXImprovementsSlice1",!1);this.SAe=K.EwaSettings.isChangeGateEnabled("OfficeVSO:8856831_GridContextMenuMemoization");this.Pjg=()=>{appChrome.api.dispatch([appChrome.actions.setButtonSecondaryText("ContextMenu.InsertHyperlink_Enabled",
this.Ya.JAc.vQ(156)),appChrome.actions.setButtonSecondaryText("ContextMenu.InsertHyperlink_Disabled",this.Ya.JAc.vQ(156)),appChrome.actions.setButtonSecondaryText("ContextMenu.FormatCells_Enabled",this.Ya.JAc.vQ(406)),appChrome.actions.setButtonSecondaryText("ContextMenu.FormatCells_Disabled",this.Ya.JAc.vQ(406))])};this.grid=aa.f(xa);this.zoom=ta;this.MLc=!0;this.YTb=K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateReferenceFloatingInCellImages",!1);this.X3f=K.EwaSettings.isChangeGateEnabled("OfficeVSO:8055712_RelocatePictureInCellMenu");
this.iWb=K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TransitionFloatingInCellImages",!1);this.IZd=K.EwaSettings.isChangeGateEnabled("OfficeVSO:8258028_FSingleTableCheck");if(!wa.GridContextMenuFilterService.Oa())if(K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",!1))ia=za.a.resolve(wa.NamedSheetViewPublicService,{xa:3}),Z=za.a.resolve(wa.FormatCellsActionService,{xa:3}),ta=za.a.resolve(wa.InstantaneousSupportInformationManagerService,{xa:3}),
Ga=za.a.resolve(wa.SortFilterManagerService,{xa:3}),void Promise.all([ia,Z,ta,Ga]).then(Ca=>{var [kb,eb,Yb,Gb]=Ca;this.XXa=new Sa.GridContextMenuFilter(xa,kb,eb,Yb,Gb,pa)});else{const Ca=Object(Pa.d)(za.a.resolve(wa.NamedSheetViewPublicService,{xa:3})),kb=Object(Pa.d)(za.a.resolve(wa.FormatCellsActionService,{xa:3})),eb=Object(Pa.d)(za.a.resolve(wa.SortFilterManagerService,{xa:3})),Yb=Object(Pa.d)(za.a.resolve(wa.InstantaneousSupportInformationManagerService,{xa:3}));la.TaskExtensions.tb(la.TaskExtensions.jl([Ca,
kb,Yb,eb],this.Aa),()=>{this.XXa=new Sa.GridContextMenuFilter(xa,Ca.result,kb.result,Yb.result,eb.result,pa)},this.Aa,3)}}get Sx(){return"PopulateGridContextMenu"}get tB(){return E.a.PCg}dispose(){super.dispose();this.$.shortcutKeyManager.Vrk(this.Pjg);this.grid=null}gd(xa,ia){xa=!this.$Yd(xa,ia);if(!xa)switch(ia){case -1977666927:xa=this.tUg();break;case 1549396389:xa=!this.tZf();break;case -81713080:xa=!this.mnj()}return xa}$Yd(xa,ia){const Z=this.grid.ha.oa.selectedRanges;return(new fa.SheetProtection(this.$.qa)).jr(xa,
ia,Z,this.grid)}executeCommand(xa,ia,Z){var ta=ia.command;xa=null;switch(ta){case -1396319072:if(Z=this.grid.Ob(null))b.a.instance.Xtd(!0),f.EventHandlerManager.instance.hId(),$a.Z7j(Z);break;case -397772485:if(!K.EwaSettings.MQ())break;this.toggleInCellControlCheckbox(ia);break;case -81713080:if(!K.EwaSettings.MQ())break;Z=this.grid.Ob(null);ta=aa.f(this.$).ha.ob.Wb;if(null!==ta){ta.showE1ODialog();break}Z&&Z.inCellControlOptions&&1===Z.inCellControlOptions.Type&&this.toggleInCellControlCheckbox(ia);
break;case -1253126584:this.removeHyperlinksFromRange(this.grid.ha.oa.selectedRanges,ia);break;case 324156914:xa=this.grid.startEdit(!1,1);break;case 1441131127:this.showGridContextMenu(Z);break;case -1977666927:wa.GridContextMenuFilterService.Oa()?xa=Object(Pa.d)(za.a.resolve(wa.GridContextMenuFilterService).then(pa=>pa.iqf())):null!=this.XXa?xa=this.XXa.iqf():this.S2d();break;case 1549396389:wa.GridContextMenuFilterService.Oa()?xa=Object(Pa.d)(za.a.resolve(wa.GridContextMenuFilterService).then(pa=>
pa.rqf())):null!=this.XXa?xa=this.XXa.rqf():this.S2d();break;case 1803952894:case 486423932:case -652157481:case -1656122924:wa.GridContextMenuFilterService.Oa()?xa=Object(Pa.d)(za.a.resolve(wa.GridContextMenuFilterService).then(pa=>pa.mqf(ia))):null!=this.XXa?xa=this.XXa.mqf(ia):this.S2d();break;case -1027730316:K.EwaSettings.WTb()&&"ContextMenu.Copilot"===Z.launcherId&&(Z=this.$?this.$.ta.UICultureTag:"",k.a.sendOtelEvent(Object(mb.b)("CopilotChat",Z)),k.a.sendOtelEvent(Object(mb.b)("AnalyzeData",
Z)),k.a.sendOtelEvent(Object(mb.b)("CalculatedColumns",Z)));break;default:xa=ba.a(ta)}return xa||la.TaskExtensions.E7()}Rc(xa,ia,Z){xa=!1;switch(ia.command){case -1396319072:case -1253126584:case 324156914:case -1977666927:case 1549396389:case 1803952894:case 486423932:case -652157481:case -1656122924:xa=!0;break;case -397772485:case -81713080:xa=K.EwaSettings.MQ();break;case 1441131127:xa=!!Z;break;case -1027730316:xa=K.EwaSettings.WTb()}return xa}S2d(){c.ULS.sendTraceTag(509645913,0,10,"GridContextMenu:ExecuteCommand() - GridContextMenuFilter is null")}sX(xa){xa=
void 0===xa?!1:xa;var ia;let Z=!1,ta=!1,pa=0;K.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(pa=x.a.Td());const Ga=this.Ya.pq(this.menuId);var Ca=this.grid.ha.oa;const kb=Ca.vi,eb=kb&&Ca.Ed.Oe,Yb=kb&&Ca.Ed.isRow;Ca=Ca.selectedRanges;const Gb=d.a.all(Ca,kc=>kc.Oe),Mb=d.a.all(Ca,kc=>kc.isRow),Rb=ea.W(Ca),$b=ea.X(Ca),cc=this.IZd&&aa.f(this.$).ha.oa.fE();let fb=!1,Sb=!1;if(this.t_d){const kc=this.grid.hd;for(const na of Ca)if(fb=na.isRow&&kc.pva(na),Sb=
na.Oe&&kc.yZa(na),fb||Sb)break}this.n3f(eb,Yb)?(Z=!0,this.EHi(Ga)):this.$.isEditMode?oa.a(this.$)?this.FHi(Ga,Gb,eb,Yb):(this.wGi(Ga,!(Yb||eb||!this.GIc)),this.X3f&&this.QEf(Ga),this.grid.ha.oa.sUd()&&this.IHi(Ga),this.YGi(Ga,Ca,xa),this.EEf(Ga,Gb,Mb,Rb,$b,fb,Sb),this.$Ef(Ga,Gb,kb,eb,Yb,cc),!K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)&&K.EwaSettings.isChangeGateEnabled("OfficeVSO:8501332_ShareExcelNamedSheetView")&&(xa=this.$.qa.la,(null===(ia=
null===xa||void 0===xa?void 0:xa.ue)||void 0===ia?0:ia.Bq)&&this.tHi(Ga)),this.ZHi(Ga),K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?(this.NEf(Ga,kb,eb,Yb,Ca,cc),this.dJd(Ga,eb,Yb)):(this.dJd(Ga,eb,Yb),this.NEf(Ga,kb,eb,Yb,Ca,cc)),this.AGi(Ga),this.yGi(Ga,Ca),this.eHi(Ga),this.X3f||this.QEf(Ga),this.THi(Ga,Mb,Gb,kb,Ca,cc)):(ta=!0,oa.a(this.$)?this.SEf(Ga,Gb):(this.oIi(Ga,Gb,kb,eb,Yb,Ca,cc),this.$.$b.allowViewCollab&&this.EEf(Ga,Gb,Mb,Rb,$b,fb,Sb)));
Ga&&0<Ga.Zb.length&&this.O6d&&this.$.shortcutKeyManager.QCh(this.Pjg);K.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(ia=x.a.Td()-pa,c.ULS.sendTraceTag(537167046,0,50,`GridContextMenu::CreateMenuModel, ExecutionTimeTotal: ${ia}, isPivotMenu: ${Z}, isViewMenu: ${ta}, firstTimeEntry: ${this.Nkf}`));this.Nkf=!1;return Ga}gXa(xa,ia){const Z=[];if(oa.a(this.$))return Z;var ta=this.grid.ha.oa,pa=ta.activeRange.isSingle,Ga=aa.f(this.$),Ca=Na.c(Ga);const kb=
(Ga=ta.vi)&&ta.Ed.Oe,eb=Ga&&ta.Ed.isRow;if(3===xa){Ca=ia=pa=!1;xa=K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInEditMode",!1)&&this.$.isMobileMode&&this.$.isEditMode;this.$.isMobileMode&&(ia=ta.selectedRanges,pa=ea.W(ia),ia=ea.X(ia));if(Ga){const Yb=aa.d(this.grid);Yb&&Yb.range.contains(ta.Ed)&&this.x2(Yb)&&(Ca=!0)}this.$.isEditMode?this.n3f(kb,eb)?Z.push(...[G.a.zce,G.a.Ace]):kb||eb?(Z.push(G.a.clipboard),eb?xa?Z.push(G.a.uMj):Z.push(G.a.qBk):kb&&(xa?Z.push(G.a.tMj):Z.push(G.a.X_h))):
(Z.push(...[G.a.edit,G.a.clipboard]),xa?Z.push(G.a.sMj):Ca?Z.push(G.a.hyperlink):Z.push(G.a.color),Ga&&!xa&&Z.push(G.a.SMh)):(Z.push(G.a.copy),Ca&&Z.push(G.a.openHyperlink),!eb||this.$.isMobileMode&&ia?!kb||this.$.isMobileMode&&pa||Z.push(G.a.Djl):Z.push(G.a.Ejl));xa||Z.push(G.a.m6i)}else 2===xa&&(K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ProactiveColumnControls",!1)&&ia&&kb?(Z.push(G.a.qgf),Z.push(G.a.fQf)):K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9FloatieEnabled",
!1)&&K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?(ta=d.a.all(this.grid.ha.oa.selectedRanges,Yb=>Yb.Oe),Ga=d.a.all(this.grid.ha.oa.selectedRanges,Yb=>Yb.isRow),pa||Ca||Ga||ta?Ca||!ta&&!Ga?Ca&&!pa?Z.push(G.a.uWh):Z.push(G.a.Cud):Z.push(G.a.mBk):Z.push(G.a.tWh)):Z.push(G.a.Cud));return Z}n3f(xa,ia){return(this.tfa||this.Uja||this.MX||this.refresh||this.expandCollapse)&&!(xa||ia)}showGridContextMenu(xa){var ia;this.expandCollapse=this.refresh=this.MX=
this.Uja=this.tfa=!1;var Z=this.$,ta=null;za.a.Cb(wa.DataRefreshManagerService)?ta=null===(ia=za.a.Cb(wa.DataRefreshManagerService))||void 0===ia?void 0:ia.wQb():void za.a.resolve(wa.DataRefreshManagerService,{xa:0});var pa=this.grid.ha.oa;const Ga=pa.vi;ia=Ga&&pa.Ed.Oe;pa=Ga&&pa.Ed.isRow;if(ta&&!ia&&!pa){ia=za.a.Cb(wa.FieldManagerPaneService);if(null===ia||void 0===ia?0:ia.zre)this.tfa=ia=C.g(Z.Pf),this.Uja=!ia;Z=Z.$b;this.MX=ta.supportsBIExplore&&Z.Uaa(32768);Z.allowInteractivity&&(ta=this.grid.Ob(null),
(null===ta||void 0===ta?0:ta.cell)&&(ta.cell.Ptd||ta.cell.rVg)&&(this.expandCollapse=!0),Z.allowManualDataRefresh&&(this.refresh=!0))}ta=null;Z=1;ia=Object(m.a)(h.a,xa.eventArgs);xa=Object(m.a)(M.a,xa.creationParams);pa=this.oNi();xa?(ta=xa.clientPoint,Z=xa.inputMethod):ia&&1!==ia.Yb?(ta=new Sys.UI.Point(ia.clientPoint.x,ia.clientPoint.y),Z=ia.Yb):pa&&(ta=new Sys.UI.Point(pa.x+(this.$.isChromeRtl?0:pa.width),pa.y+pa.height));X.a.Hb=Z;this.GIc=3===Z;xa=e.a.hwc;this.Xo(ta,!ia||ia.Ha.target.className!==
xa,Z,ia&&ia.Ha.button===Sys.UI.MouseButton.leftButton?!0:!1)}removeHyperlinksFromRange(xa,ia){if(!K.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.Ss(xa,!0)){var Z=ea.u(xa,this.$),ta=this.$.ma.sa.mc();this.$.userOperationManager.enqueueOperation(new Oa.a(125,0,(pa,Ga,Ca)=>{this.$.Qw();return Ha.b(this.$.ma.sa,Z,"","",!0,!1,127,pa,Ga,Ca,null,ta)},void 0,()=>new Y(Z)),ia);this.grid.$h.LP(!1)}}toggleInCellControlCheckbox(xa){const ia=
this.$.ma.sa.mc(),Z={};this.$.Zk(Z);Z.FirstRow=this.grid.ha.oa.activeCell.top;Z.FirstColumn=this.grid.ha.oa.activeCell.left;this.$.userOperationManager.enqueueOperation(new Oa.a(607,0,(ta,pa,Ga)=>db.I(this.$.ma.sa,ea.u(this.grid.ha.oa.selectedRanges,this.$),Z,2===xa.method,ta,pa,Ga,null,ia),64,()=>new Ba(ea.u(aa.f(this.$).ha.oa.selectedRanges,this.$),Z)),xa)}oNi(){var xa=this.grid.Ob(null);if((null===xa||void 0===xa?0:xa.cell.Ak)&&this.k2f(xa))return this.grid.getCellBounds(xa.cell);xa=this.grid.ha.oa.activeCell;
return(xa=this.pxc(new O.Range(xa.top,xa.left,t.a.sf,xa.left,!1,!1),2,!0)||this.pxc(new O.Range(1,xa.left,xa.top,xa.left,!1,!1),2,!1)||this.pxc(new O.Range(xa.top,xa.right,xa.top,t.a.rf,!1,!1),1,!0)||this.pxc(new O.Range(xa.top,1,xa.top,xa.right,!1,!1),1,!1)||null)&&xa.Ak?this.grid.getCellBounds(xa):hb.HelperMethods.isStandardZoomCssSupportedByBrowser?Ma.DOMElementExtensions.getBounds({element:this.grid.ZT.ud,di:!0}):Sys.UI.DomElement.getBounds(this.grid.ZT.ud)}k2f(xa){var ia=this.grid.rtl,Z=this.$.isChromeRtl;
xa=xa.cell;var ta=aa.f(this.$).qQ(xa);return ta?(ta=ta.topLeft,ia=ta.x+=ia===Z?xa.offsetWidth:0,Z=ta.y+=xa.offsetHeight,this.grid.view.visibleArea.contains(new z.a(ia,Z,0,0))):!1}pxc(xa,ia,Z){xa=this.grid.Np("GridContextMenu.FindFirstCellInViewportArea",xa,ia,Z);try{for(xa.$$rst();xa.$$mn();){const ta=xa.$$cu();if(ta&&this.k2f(ta))return ta.cell}}finally{xa&&xa.dispose()}return null}EHi(xa){const ia=this.Ya,Z=ia.uc();this.refresh&&Z.buttons.push(ia.yb(100));this.MX&&Z.buttons.push(ia.yb(99));this.tfa?
Z.buttons.push(ia.yb(59)):this.Uja&&Z.buttons.push(ia.yb(58));if(this.expandCollapse){let ta;ta=ia.iu("ContextMenu.PivotExpandCollapse",null,N.a.instance.ia(1167),589118293);const pa=ia.uc();pa.buttons.push(ia.yb(243));pa.buttons.push(ia.yb(244));pa.buttons.push(ia.yb(245));pa.buttons.push(ia.yb(246));ta.menu.Zb.push(pa);ta&&0<pa.buttons.length&&Z.buttons.push(ta)}xa.Zb.push(Z)}$Ef(xa,ia,Z,ta,pa,Ga){!Z||ta||pa||(Z=this.Ya.uc(),this.$.TK||this.hJd(Z),this.qJd(Z,ia),this.cIi(Z,Ga),xa.Zb.push(Z))}qJd(xa,
ia){var Z,ta;const pa=K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?this.Ya.P0("ContextMenu.sort",null,N.a.instance.ia(227),-864298118,3,null,"SortUp_20"):this.Ya.iu("ContextMenu.sort",null,N.a.instance.ia(227),-864298118);if(this.$.$b.allowSorting&&(!this.$.isMobileMode||(new fa.SheetProtection(this.$.qa)).ie(2048))){var Ga=this.Ya.uc(),Ca=this.Ya.uc(),kb=this.Ya.uc(),eb=this.Ya.uc(),Yb=this.Ya.yb(223),Gb=this.Ya.yb(224);if(K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)){var Mb=null===(ta=null===(Z=aa.f(this.$).Ob(null))||void 0===Z?void 0:Z.cell)||void 0===ta?void 0:ta.text;Z=(null===Mb||void 0===Mb?void 0:Mb.toLowerCase())===(null===Mb||void 0===Mb?void 0:Mb.toUpperCase())?N.a.instance.ia(2529):N.a.instance.ia(2527);Mb=(null===Mb||void 0===Mb?void 0:Mb.toLowerCase())===(null===Mb||void 0===Mb?void 0:Mb.toUpperCase())?N.a.instance.ia(2530):N.a.instance.ia(2528);Yb.label=Z;Yb.Ap(Z);Gb.label=Mb;Gb.Ap(Mb);Ca.buttons.push(Yb);Ca.buttons.push(Gb);if(ia){pa.menu.Zb.push(Ca);
xa.buttons.push(pa);return}}else Ga.buttons.push(Yb),Ga.buttons.push(Gb);ia=this.Ya.yb(292);Yb=this.Ya.yb(293);Gb=this.Ya.yb(294);K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?(kb.buttons.push(ia),kb.buttons.push(Yb),kb.buttons.push(Gb)):(Ga.buttons.push(ia),Ga.buttons.push(Yb),Ga.buttons.push(Gb));ia=this.Ya.yb(225);this.$.isMobileMode||(K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?eb.buttons.push(ia):
Ga.buttons.push(ia));K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?(pa.menu.Zb.push(Ca),pa.menu.Zb.push(kb),pa.menu.Zb.push(eb)):pa.menu.Zb.push(Ga);xa.buttons.push(pa)}}hJd(xa){var ia,Z,ta,pa,Ga,Ca;const kb=K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?this.Ya.P0("ContextMenu.filter",null,N.a.instance.ia(1970),2045563128,3,null,"Filter_20"):this.Ya.iu("ContextMenu.filter",null,N.a.instance.ia(1970),
2045563128),eb=this.Ya.uc();if(!K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)||K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)&&(!this.tUg()||this.tZf())){var Yb=this.BSi(),Gb=this.Ya.yb(234);Gb.label=Yb;Gb.Ap(Yb);eb.buttons.push(Gb);eb.buttons.push(this.Ya.yb(235))}Yb=this.Ya.uc();Gb=this.Ya.yb(233);const Mb=K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)?N.a.instance.ia(2522)+" "+(Object(sa.b)(null===(Z=null===(ia=aa.f(this.$).Ob(null))||void 0===ia?void 0:ia.cell)||void 0===Z?void 0:Z.text)?"Blank":'"'+(null===(pa=null===(ta=aa.f(this.$).Ob(null))||void 0===ta?void 0:ta.cell)||void 0===pa?void 0:pa.text)+'"'):N.a.instance.ia(222)+" "+(null===(Ca=null===(Ga=aa.f(this.$).Ob(null))||void 0===Ga?void 0:Ga.cell)||void 0===Ca?void 0:Ca.text);Gb.label=Mb;Gb.Ap(Mb);Yb.buttons.push(Gb);Yb.buttons.push(this.Ya.yb(313));Yb.buttons.push(this.Ya.yb(314));
Yb.buttons.push(this.Ya.yb(315));(!K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)||0<eb.buttons.length)&&kb.menu.Zb.push(eb);kb.menu.Zb.push(Yb);xa.buttons.push(kb)}cIi(xa,ia){if(ia||!this.IZd&&aa.f(this.$).ha.oa.fE()){ia=this.Ya.uc();ia.buttons.push(this.Ya.yb(232));ia.buttons.push(this.Ya.yb(285));ia.buttons.push(this.Ya.yb(286));const Z=K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?this.Ya.P0("ContextMenu.table",
null,N.a.instance.ia(1969),-697806646,3,null,"Table_20"):this.Ya.iu("ContextMenu.table",null,N.a.instance.ia(1969),-697806646);Z.menu.Zb.push(ia);xa.buttons.push(Z)}}HEf(xa,ia,Z,ta,pa,Ga){if(ia){var Ca=ea.S(pa),kb=aa.d(this.grid);if(kb&&!Z&&!ta){Z=new fa.SheetProtection(this.$.qa);if(kb.range.contains(Ca)&&this.x2(kb)){Ca=!kb.kda&&!Z.Ih;K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HyperlinkImprovementSlice1",!1)?this.QGi(xa,kb.L7,Ca):(Ca&&this.$.isEditMode&&xa.buttons.push(this.Ya.yb(45)),
kb.L7&&xa.buttons.push(this.Ya.yb(53)),Ca&&this.$.isEditMode&&xa.buttons.push(this.Ya.yb(47)));!K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)&&K.EwaSettings.isChangeGateEnabled("OfficeVSO:8575759_CopyLinkContextMenu")&&(K.EwaSettings.isChangeGateEnabled("OfficeVSO:8218038_moveCanShareExcelSectionToHelper")&&da.a(this.$)||this.eIb())&&this.eJd(xa,ia,pa,Ga);return}!kb.kda&&this.$.isEditMode&&(kb=Z.ie(128),xa.buttons.push(this.Ya.yb(kb?46:121)),this.O6d=
!0)}}this.Qjk(pa)&&xa.buttons.push(this.Ya.yb(48));if(K.EwaSettings.isChangeGateEnabled("OfficeVSO:8218038_moveCanShareExcelSectionToHelper")&&da.a(this.$)||this.eIb())K.EwaSettings.isChangeGateEnabled("OfficeVSO:8575759_CopyLinkContextMenu")?K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)||this.eJd(xa,ia,pa,Ga):ia&&(ia=ea.S(pa),this.Pjk(ia,Ga)?xa.buttons.push(this.Ya.yb(276)):ia.Oe||ia.isRow||xa.buttons.push(this.Ya.yb(275)))}QGi(xa,ia,Z){const ta=
this.Ya.uc();Z&&this.$.isEditMode&&ta.buttons.push(this.Ya.yb(45));ia&&ta.buttons.push(this.Ya.yb(53));Z&&this.$.isEditMode&&ta.buttons.push(this.Ya.yb(47));ta.buttons.push(this.Ya.yb(330));ta.buttons.push(this.Ya.yb(331));ia=K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?this.Ya.P0("ContextMenu.Hyperlink",void 0,N.a.instance.ia(2537),798637440,8,w.a.Zvc):this.Ya.iu("ContextMenu.Hyperlink",void 0,N.a.instance.ia(404),798637440);ia.menu.Zb.push(ta);
xa.buttons.push(ia)}eJd(xa,ia,Z,ta){const pa=this.Ya.uc();ia&&(ia=ea.S(Z),ia.Oe||ia.isRow||pa.buttons.push(this.Ya.yb(310)),(ta||1===Na.b(this.$,ia).length)&&pa.buttons.push(this.Ya.yb(311)));pa.buttons.push(this.Ya.yb(309));ta=this.Ya.P0("ContextMenu.CopyLink",void 0,N.a.instance.ia(2354),709515373,1,null,L.a.isFluentIconsEnabled()?"LinkToSection_20":"ShareSectionEntry_20");ta.menu.Zb.push(pa);xa.buttons.push(ta)}Qjk(xa){for(const ia of xa){xa=this.grid.getRangeInformation(ia);for(let Z=0;Z<xa.length;Z++)if(Object(u.a)(U.HyperlinkRange,
xa[Z])){const ta=this.grid.Ob(xa[Z]);if(ta&&this.x2(ta)&&!ta.kda)return!0}}return!1}Pjk(xa,ia){return(ia||!this.IZd&&aa.f(this.$).ha.oa.fE())&&(ia=aa.f(this.$).Eb.dg(xa))&&ia.usedRange.equals(xa)?!0:!1}tHi(xa){const ia=this.Ya.uc();da.a(this.$,!0)&&ia.buttons.push(this.Ya.yb(317));xa.Zb.push(ia)}eIb(xa){var ia=this.$.qa.la;return ia&&ia.ue&&(ia=ia.ue.Bq||ia.ue.vI,!this.$.TK&&K.EwaSettings.isChangeGateEnabled("OfficeVSO:8096934_ShareExcelSection")&&da.b(this.$)&&!this.$.fa.isNamedObjectViewMode&&!this.$.isMobileMode&&
(K.EwaSettings.isChangeGateEnabled("OfficeVSO:8501332_ShareExcelNamedSheetView")&&xa||!ia))?!0:!1}dJd(xa,ia,Z){var ta,pa;if(1===aa.f(this.$).ha.gf&&!ia&&!Z){ia=this.Ya.iu("ContextMenu.CommentCells",null,N.a.instance.ia(2521),-488619629);Z=this.Ya.iu("ContextMenu.NoteCells",null,N.a.instance.ia(2176),-1672124962);var Ga=oa.a(this.$),Ca=this.Ya,kb=Ca.uc(),eb=Ca.uc(),Yb=Ca.uc(),Gb=za.a.Cb(wa.ExcelCommentManagerService);(null===(ta=null===Gb||void 0===Gb?void 0:Gb.om)||void 0===ta?0:ta.UF)&&!Ga&&(kb.buttons.push(Ca.yb(227)),
Yb.buttons.push(Ca.yb(227)));Gb&&Gb.isCommentOperationEnabled(3)&&(kb.buttons.push(Ca.yb(221)),eb.buttons.push(Ca.yb(221)));(null===(pa=null===Gb||void 0===Gb?void 0:Gb.om)||void 0===pa?0:pa.ECc)&&!Ga&&(kb.buttons.push(Ca.yb(228)),Yb.buttons.push(Ca.yb(228)));(null===Gb||void 0===Gb?0:Gb.hasCommentAtActiveCell)?Gb.AF.isResolved||(kb.buttons.push(Ca.yb(159)),eb.buttons.push(Ca.yb(159))):Gb&&Gb.hasCommentAtActiveCell||(Gb&&Gb.om&&Gb.om.UF?Ga||(kb.buttons.push(Ca.yb(229)),kb.buttons.push(Ca.yb(230)),
Yb.buttons.push(Ca.yb(229)),Yb.buttons.push(Ca.yb(230))):(kb.buttons.push(Ca.yb(160)),Ga||kb.buttons.push(Ca.yb(226))));K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)&&(eb.buttons.length||Yb.buttons.length)?(ta=Ca.uc(),eb.buttons.length&&(ia.menu.Zb.push(eb),ta.buttons.push(ia)),Yb.buttons.length&&(Z.menu.Zb.push(Yb),ta.buttons.push(Z)),xa.Zb.push(ta)):xa.Zb.push(kb)}}ZHi(xa){if(K.EwaSettings.Ra(127)){const ia=this.Ya,Z=ia.uc();Z.buttons.push(ia.yb(250));
xa.Zb.push(Z)}}YGi(xa,ia,Z){if(!Z){Z=this.$.Ia.lN();var ta=new fa.SheetProtection(this.$.qa),pa=new Za.a(Z,ia,this.grid);(new B(xa,this.$,this.Ya,Z,ia,this.grid,pa,ta)).$Id()}}IHi(xa){const ia=this.Ya.uc();ia.buttons.push(this.Ya.yb(100));xa.Zb.push(ia)}EEf(xa,ia,Z,ta,pa,Ga,Ca){const kb=(new fa.SheetProtection(this.$.qa)).ie(8),eb=this.Ya,Yb=eb.uc();var Gb=this.grid.ha.oa.selectedRanges,Mb=I.i(Gb),Rb=I.g(Gb);Mb=1<Mb?N.a.instance.ia(429):N.a.instance.ia(2541);var $b=1<Rb?N.a.instance.ia(426):N.a.instance.ia(2542);
Rb=N.a.instance.ia(519)+" "+Mb;Mb=N.a.instance.ia(536)+" "+Mb;var cc=N.a.instance.ia(519)+" "+$b;$b=N.a.instance.ia(536)+" "+$b;K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)||(ia&&Yb.buttons.push(eb.yb(kb?152:153)),Z&&Yb.buttons.push(eb.yb(kb?150:151)));ia&&(ta||(ta=eb.yb(kb?109:155),cc=K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?cc+" "+I.f(Gb):N.a.instance.ia(438),ta.label=cc,ta.Ap(cc),Yb.buttons.push(ta)),
!this.t_d||Ca)&&(Ca=eb.yb(kb?111:157),ta=K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?$b:N.a.instance.ia(440),Ca.label=ta,Ca.Ap(ta),Yb.buttons.push(Ca));Z&&(pa||(pa=eb.yb(kb?108:154),Gb=K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?Rb+" "+I.j(Gb):N.a.instance.ia(432),pa.label=Gb,pa.Ap(Gb),Yb.buttons.push(pa)),!this.t_d||Ga)&&(Ga=eb.yb(kb?110:156),Gb=K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)?Mb:N.a.instance.ia(439),Ga.label=Gb,Ga.Ap(Gb),Yb.buttons.push(Ga));xa.Zb.push(Yb);K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)&&(ia&&(xa=this.Ya.uc(),ia=this.Ya.P0("ContextMenu.ColumnWidth",void 0,N.a.instance.ia(479),798637440,8,w.a.bFd),Ga=eb.yb(kb?377:378),Ga.label="AutoFit",Ga.Ap("AutoFit"),xa.buttons.push(Ga),xa.buttons.push(eb.yb(kb?152:153)),ia.menu.Zb.push(xa),Yb.buttons.push(ia)),Z&&(Z=this.Ya.uc(),xa=this.Ya.P0("ContextMenu.RowHeight",
void 0,N.a.instance.ia(478),798637440,8,w.a.gFd),ia=eb.yb(kb?379:380),ia.label="AutoFit",ia.Ap("AutoFit"),Z.buttons.push(ia),Z.buttons.push(eb.yb(kb?150:151)),xa.menu.Zb.push(Z),Yb.buttons.push(xa)))}wGi(xa,ia){const Z=this.Ya,ta=Z.uc();xa.Zb.push(ta);ia&&ta.buttons.push(Z.yb(102));ta.buttons.push(Z.yb(42));ta.buttons.push(Z.yb(43));ta.buttons.push(Z.yb(44));xa=Z.iu("ContextMenu.pasteSpecial",null,N.a.instance.ia(2462),237279923);ia=Z.uc();ia.buttons.push(Z.yb(354));ia.buttons.push(Z.yb(355));ia.buttons.push(Z.yb(356));
ia.buttons.push(Z.yb(357));ia.buttons.push(Z.yb(358));ia.buttons.push(Z.yb(359));xa.menu.Zb.push(ia);xa&&0<ia.buttons.length&&ta.buttons.push(xa)}oIi(xa,ia,Z,ta,pa,Ga,Ca){var kb;const eb=this.Ya;var Yb=eb.uc();Yb.buttons.push(eb.yb(43));xa.Zb.push(Yb);!this.$.TK&&Ka.i(this.$,this.grid)&&(Yb=this.Ya.uc(),this.hJd(Yb),xa.Zb.push(Yb));K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInReadOnlyEditMode",!1)&&this.$.fa.$b.isMobileMode&&this.$.fa.$b.isReadOnlyEditMode&&!this.$.ta.IsMeetingLiveSession||
(Yb=this.Ya.uc(),this.qJd(Yb,ia),xa.Zb.push(Yb),c.ULS.sendTraceTag(537167045,0,50,"GridContextMenu::GenerateViewMenuSection, Remove the sort options from right contextual menu in mobile, readonlyeditmode and non-meeting scenario"));ia=za.a.Cb(wa.ExcelCommentManagerService);if(null===(kb=null===ia||void 0===ia?void 0:ia.om)||void 0===kb?0:kb.UF)kb=this.Ya.uc(),kb.buttons.push(eb.yb(229)),xa.Zb.push(kb);kb=this.Ya.uc();this.HEf(kb,Z,ta,pa,Ga,Ca);0<kb.buttons.length&&xa.Zb.push(kb);n.AFrameworkApplication.isMobileMode&&
!S.a(this.$.ta,29)&&(Z=eb.uc(),Z.buttons.push(eb.yb(272)),xa.Zb.push(Z))}NEf(xa,ia,Z,ta,pa,Ga){const Ca=this.Ya.uc();L.a.olb()?this.JGi(Ca):this.wHi(Ca);this.HEf(Ca,ia,Z,ta,pa,Ga);0<Ca.buttons.length&&xa.Zb.push(Ca)}wHi(xa){xa.buttons.push(this.Ya.yb(135))}JGi(xa){var ia,Z;300;if(K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)){let ta=null===(Z=null===(ia=aa.f(this.$).Ob(null))||void 0===ia?void 0:ia.cell)||void 0===Z?void 0:Z.text;ta=K.EwaSettings.isChangeGateEnabled("OfficeVSO:8845182_cellValueCrash")?
ta||"":ta;ia=(null===ta||void 0===ta?void 0:ta.toLowerCase())===(null===ta||void 0===ta?void 0:ta.toUpperCase())?this.Ya.yb(361):this.Ya.yb(362);xa.buttons.push(ia)}else xa.buttons.push(this.Ya.yb(300));this.O6d=!0}THi(xa,ia,Z,ta,pa,Ga){var Ca;if(K.EwaSettings.Ra(418)&&ta){var kb=this.Ya.uc();!K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)||ia||Z||(this.eJd(kb,ta,pa,Ga),K.EwaSettings.isChangeGateEnabled("OfficeVSO:8501332_ShareExcelNamedSheetView")&&
(ia=this.$.qa.la,(null===(Ca=null===ia||void 0===ia?void 0:ia.ue)||void 0===Ca?0:Ca.Bq)&&da.a(this.$,!0)&&kb.buttons.push(this.Ya.yb(317))));kb.buttons.push(this.Ya.yb(262));xa.Zb.push(kb)}}QEf(xa){if(this.iWb&&this.YTb){var ia=!1;if(this.grid.Eb.HTb(this.$.la.activeCell)){var Z=this.grid.ha.oa.selectedRanges;if(Z&&Z.length){var ta=this.Ya,pa=ta.uc(),Ga=ta.uc();for(var Ca=0;Ca<Z.length&&!ia;Ca++)!ia&&this.grid.Eb.HTb(Z[Ca])&&(ia=!0);ia&&(Ga.buttons.push(ta.yb(304)),Ga.buttons.push(ta.yb(217)));0<
Ga.buttons.length&&(Ca=ta.iu("ContexMenu.PictureInCellFlyOut_EnabledContents",null,N.a.instance.ia(2303),798637440),Ca.menu.Zb.push(Ga),pa.buttons.push(Ca));ia&&!this.grid.Eb.$Ud(Z[0])&&pa.buttons.push(ta.yb(302));0<pa.buttons.length&&xa.Zb.push(pa)}}}}eHi(xa){var ia=this.grid.ha.oa.selectedRanges;if(ia&&ia.length){var Z=!1;for(var ta=0;ta<ia.length;ta++)if(this.grid.Eb.xIa(ia[ta])){Z=!0;break}if(Z){Z=!1;for(ta=0;ta<ia.length;ta++){var pa=this.grid.Eb.RXi(ia[ta]);if(null!=pa&&null!=pa[0]){for(var Ga=
0;Ga<pa.length;Ga++)if(this.grid.Eb.xIa(pa[Ga])){Z=!0;break}if(Z)break}}Ga=this.Ya;ta=Ga.uc();pa=Ga.uc();var Ca=1===ia.length&&(ia[0].isSingle||this.grid.Eb.mmb(ia[0])),kb=!1,eb=!1,Yb=!1,Gb=!1;for(let Mb=0;Mb<ia.length&&!(kb&&Yb&&eb&&Gb);Mb++)!kb&&this.grid.Eb.Mtj(ia[Mb])&&(kb=!0),!Yb&&this.grid.Eb.Z1f(ia[Mb],!1)&&(Yb=!0),!eb&&this.grid.Eb.JHc(ia[Mb])&&(eb=!0),!Gb&&this.grid.Eb.HTb(ia[Mb])&&(Gb=!0);this.iWb&&this.YTb||(Ca&&!this.grid.Eb.wTb(ia[0])&&(Gb?ta.buttons.push(Ga.yb(217)):ta.buttons.push(Ga.yb(216))),
Gb&&!this.grid.Eb.$Ud(ia[0])&&ta.buttons.push(Ga.yb(302)));Gb=kb;Gb=!(new fa.SheetProtection(this.$.qa)).Ih&&Gb;Yb&&!Z&&(K.EwaSettings.Ra(123)&&C.m(this.$.Pf)&&(pa.buttons.push(Ga.yb(220)),eb&&pa.buttons.push(Ga.yb(Gb?218:269)),Ca&&(this.grid.Eb.JHc(ia[0])||this.grid.Eb.wTb(ia[0]))&&pa.buttons.push(Ga.yb(Gb?219:270))),pa.buttons.push(Ga.yb(Gb?215:268)));0<pa.buttons.length&&(ia=Ga.iu(kb?"ContexMenu.LinkedEntitiesFlyOut_EnabledContents":"ContexMenu.LinkedEntitiesFlyOut_DisabledContents",null,N.a.instance.ia(1783),
798637440),ia.menu.Zb.push(pa),ta.buttons.push(ia));0<ta.buttons.length&&xa.Zb.push(ta)}}}yGi(xa,ia){this.grid.Eb.U_f(ia)&&(ia=this.Ya.uc(),this.grid.ha.oa.rva()?(ia.buttons.push(this.Ya.yb(241)),ia.buttons.push(this.Ya.yb(239))):ia.buttons.push(this.Ya.yb(240)),xa.Zb.push(ia))}x2(xa){return xa.cell.hasHyperlink}SEf(xa,ia){this.GHi(xa);const Z=this.Ya.uc();this.qJd(Z,ia);xa.Zb.push(Z);Ka.i(this.$,this.grid)&&(ia=this.Ya.uc(),this.hJd(ia),xa.Zb.push(ia))}FHi(xa,ia,Z,ta){this.SEf(xa,ia);this.dJd(xa,
Z,ta)}GHi(xa){if(this.grid.ha.oa.vi&&!this.grid.rb.mj){var ia=this.Ya,Z=ia.uc();this.zoomManager.lse()?Z.buttons.push(ia.yb(265)):Z.buttons.push(ia.yb(264));xa.Zb.push(Z)}}static Z7j(xa){xa.invoke($a.xdj,null)}static XGi(xa,ia,Z){(Z=Z.ra.Tb(254))?(Z.NUb()&&Z.h8f()&&Z.SVb()&&xa.buttons.push(ia.yb(212)),Z.NUb()&&Z.GJc()&&Z.SVb()&&xa.buttons.push(ia.yb(213))):c.ULS.sendTraceTag(537167044,0,50,"GridContextMenu::GenerateInsertCopiedCutCellsConextMenu, CopyPasteInfrastructure is not ready.")}tUg(){var xa=
za.a.Cb(wa.TableManagerService);xa=null===xa||void 0===xa?void 0:xa.Vs;const ia=this.grid.ha.oa.activeCell;return null!=xa&&!xa.hasActiveFilter||Na.d(this.$,ia)||!this.nnj(ia)}nnj(xa){const ia=xa.left;var Z=this.LOd();if(null!=Z&&null!=Z.gxc&&Z.gxc.includes(ia-1))return!0;Z=this.qOd();return null!=Z&&ea.I(Z).contains(xa)&&null!=Z.FilteredColumns&&Z.FilteredColumns.includes(ia-1)?!0:!1}tZf(){var xa=za.a.Cb(wa.TableManagerService);xa=null===xa||void 0===xa?void 0:xa.Vs;if(null!=xa)return xa.hasAutoFilter&&
xa.hasActiveFilter;xa=this.LOd();if(null!=xa)return null!=xa.gxc&&0<xa.gxc.length;xa=this.qOd();return null!=xa&&ea.I(xa).contains(this.grid.ha.oa.activeCell)&&null!=xa.FilteredColumns&&0<xa.FilteredColumns.length}mnj(){if(!K.EwaSettings.MQ())return!1;const xa=this.grid.Ob(null);return null!==aa.f(this.$).ha.ob.Wb||xa&&xa.inCellControlOptions&&1===xa.inCellControlOptions.Type?!0:!1}LOd(){const xa=za.a.Cb(wa.TableManagerService);if(!xa)return c.ULS.sendTraceTag(508680020,0,50,"GridContextMenu:getTableFilterRangeFromActiveCell - tableManager is null"),
null;const ia=xa.jt(this.grid.ha.oa.activeCell);return ia?xa.WOb(ia):null}qOd(){const xa=this.$.qa.getItemByName(this.$.la.sheetName);return xa?xa.bD:null}BSi(){var xa=this.grid.ha.oa.activeCell,ia=0,Z=!1,ta=za.a.Cb(wa.TableManagerService),pa=this.LOd();ta=null===ta||void 0===ta?void 0:ta.Vs;null!=ta?(ia=ta.usedRange.top,Z=!0):null!=pa?(ia=pa.top,Z=!0):(pa=this.qOd(),null!=pa&&ea.I(pa).contains(xa)&&(ia=pa.FirstRow+1,Z=!0));return Z?(xa=xa.left,ia=O.Range.Hc(ia,xa),ia=this.grid.Ob(ia),Z="",null!=
ia&&(Z=ia.text),this.bQh(Z,xa)):N.a.instance.ia(220)}bQh(xa,ia){return null==xa||Ia.a.Zg(xa.trim())?String.format(N.a.instance.Ib(157),O.Range.dK(ia)):xa.length>$a.LEe?String.format(N.a.instance.Ib(155),xa.substring(0,$a.LEe)):String.format(N.a.instance.Ib(156),xa)}};Va.B4a="GridContextMenuRootName";Va.w6i=E.a.hif;Va.xdj=192;Va.LEe=26;Va=$a=Object(y.__decorate)([Object(za.d)(wa.GridContextMenuService),Object(y.__param)(0,Object(wa.EwaControlService)()),Object(y.__param)(1,Object(wa.RibbonControlsService)()),
Object(y.__param)(2,Object(wa.ContextMenuControllerService)()),Object(y.__param)(3,Object(wa.ZoomService)()),Object(y.__param)(4,Object(wa.FilteredResultsStatusBarManagerService)())],Va);Object(r.a)(Va,"GridContextMenu",l.a,[])},1264:function(y,r,a){a.r(r);a.d(r,"GridContextMenuFilter",function(){return Oa});y=a(133);r=a(0);var c=a(15),b=a(32),f=a(1253),k=a(27),x=a(1030),d=a(150),h=a(44),n=a(429),m=a(213),u=a(368),l=a(61),t=a(191),e=a(369),w=a(83),z=a(36),E=a(255),M=a(1),G=a(28),A=a(266),N=a(25),
K=a(151),I=a(962),L=a(988),J=a(142),B=a(48),Y=a(67),U=a(10),O=a(5),C=a(65),X=a(1029),S=a(963),ea;(function(Ha){Ha[Ha.none=0]="none";Ha[Ha.once=1]="once";Ha[Ha.twice=2]="twice"})(ea||(ea={}));Object(r.b)("ToggleState",ea);let Oa=class{constructor(Ha,Za,fa,la,ba,aa){aa=void 0===aa?null:aa;this.pU=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NsvEntryOptimizationApplyForEveryone",!1);this.bT=this.Wvb=this.Yvb=0;this.Qp=null;this.$=Ha;this.da=N.f(this.$);this.Ox=Za;this.$e=fa;this.cz=ba;
this.instantaneousSupportInformationManager=la;this.tl=I.a.Lkb();this.Qp=aa}iqf(){var Ha=X.e(this.da);Ha={["CommandValueId"]:B.c(Ha)};const Za=new w.a(-2058042992,2,this.$.xc,19,null);c.ULS.sendTraceTag(527500302,0,50,"GridContextMenuFilter::DoClearFilter GridContextMenu ClearFilter command executed");return this.$.Ia.Gb(Za,Ha)}rqf(){const Ha=new w.a(644342024,2,this.$.xc,19,null);c.ULS.sendTraceTag(527500301,0,50,"GridContextMenuFilter::DoReapplyFilter GridContextMenu ReapplyFilter command executed");
return this.$.Ia.Gb(Ha)}mqf(Ha){const Za=this.da.ha.oa.activeCell;var fa=C.a.Cb(O.TableManagerService);const la=fa.Vs;fa=fa.WOb(Za);return la||fa?this.Mii(la,fa,Za,Ha.command):this.Lii(Za,Ha.command)}Mii(Ha,Za,fa,la){if(this.oXh(Ha,Za,fa))return c.ULS.sendTraceTag(527500300,0,50,"GridContextMenuFilter::doFilterForTable Header/Total error dialog raised for FilterByValue in Table"),Y.Task.Va(!1);if(null!=Ha&&Ha.hasAutoFilter||null!=Za&&Za.tSh.every(ba=>0!=ba.length))return this.Yvb=ea.none,this.applyFilter(la);
this.Yvb=ea.once;return this.ouc(ea.once,la)}Lii(Ha,Za){var fa=h.y(this.da.ha.oa.Ed,this.$);fa=this.da.$.qa.getItemByName(fa.SheetName);const la=h.I(fa.bD);if(this.nXh(la,Ha))return c.ULS.sendTraceTag(527500299,0,50,"GridContextMenuFilter::DoFilterByValue Header/EmptyRange error dialog raised for FilterByValue in Sheet"),Y.Task.Va(!1);if(fa.hasAutoFilter){if(la&&la.contains(this.da.ha.oa.activeCell))return this.Yvb=ea.none,this.applyFilter(Za);this.Yvb=ea.twice;return this.ouc(ea.twice,Za)}this.Yvb=
ea.once;return this.ouc(ea.once,Za)}ouc(Ha,Za){const fa=h.y(this.da.ha.oa.Ed,this.$);if(!fa)return Y.Task.Va(!1);this.Wvb||(this.Wvb=Date.now());const la=new w.a(368460465,2,this.$.xc,19,null),ba=this.$.ma.sa.mc(),aa=()=>new f.a(fa),oa=Na=>{E.a(Na)?c.ULS.sendTraceTag(527500297,0,50,"GridContextMenuFilter::doToggleAndFilter service call failed with errors : {}"):(c.ULS.sendTraceTag(527500298,0,50,"GridContextMenuFilter::ToggleFilter service call succeeded"),Ha===ea.twice?this.ouc(ea.once,Za):this.applyFilter(Za))};
return n.a(this.$.userOperationManager,(Na,Ia,Sa)=>u.H(this.$.ma.sa,fa,A.c(Na,oa),Ia,Sa,null,ba),Na=>new m.a(516,0,Na,64,aa),la)}oXh(Ha,Za,fa){return null!=Ha&&t.d(Ha)&&fa.top===Ha.usedRange.top||null!=Za&&Za.eua&&fa.top===Za.top?(this.lSc(this.$,223),!0):null!=Ha&&t.g(Ha)&&fa.top===Ha.usedRange.bottom?(this.lSc(this.$,224),!0):!1}nXh(Ha,Za){if(Ha&&Ha.contains(Za)&&Za.top===Ha.top||!Ha&&this.dWh(Za.top,Za.left))return this.lSc(this.$,225),!0;if(Ha&&Ha.contains(Za))return!1;Ha=new k.Range(1<Za.top?
Za.top-1:Za.top,1<Za.left?Za.left-1:Za.left,Za.top<U.a.sf?Za.top+1:Za.top,Za.left<U.a.rf?Za.left+1:Za.left,!1,!1);return this.da.Eb.rIa(Ha)?(this.lSc(this.$,226),!0):!1}lSc(Ha,Za){Za=z.a.Cd(1,1,751,Za,0,158204905,"ContextMenuFilterUnsupported");new e.a(Ha,Za)}applyFilter(Ha){switch(Ha){case 1803952894:return this.aKh();case 486423932:case -652157481:case -1656122924:return this.Omc(Ha);default:return Y.Task.Va(!1)}}aKh(){this.bT=Date.now();const Ha=this.H4i();if(!Ha)return c.ULS.sendTraceTag(527500296,
0,50,"GridContextMenuFilter::ApplyFilterByValue . CellValue returned is null"),Y.Task.Va(!1);const Za=X.e(this.da),fa=X.b(this.$,Za),la={};la.FirstRow=X.f(this.da,this.$);la.FirstColumn=Za.Column;const ba=Ia=>{var Sa,Pa={["ToggleFilterOperationCount"]:this.Yvb,["ApplyFilterTime"]:this.bT?Date.now()-this.bT:-1,["ToggleAndApplyFilterTime"]:this.Wvb?Date.now()-this.Wvb:-1,["FilterByValueType"]:Za.AutoFilterType};c.ULS.sendTraceTag(527500295,0,50,`GridContextMenuFilter::ApplyFilterByValue Perf Telemetry : ${JSON.stringify(Pa)}`);
this.Wvb&&(this.Wvb=0);I.a.X9(Ia)&&(Pa=I.a.v7(Ia),this.tl?I.a.Kl(L.a.filterByCellValue,Pa.MessageIdName,J.a.bba,!0,I.a.BIa(Pa.MessageId)):c.ULS.sendTraceTag(527500294,0,10,`GridContextMenuFilter::ApplyFilterByValue failed with FilterException -${Pa.MessageIdName}`));E.a(Ia)?(Ia=z.a.pc(Ia.Errors),c.ULS.sendTraceTag(527500292,0,50,`GridContextMenuFilter::ApplyFilterByValue service call failed with errors : ${Ia}`)):(c.ULS.sendTraceTag(527500293,0,50,"GridContextMenuFilter::ApplyFilterByValue service call succeeded"),
K.b(this.$).Jd(d.a.YNc,X.g(),void 0,!0),-1!==la.FirstRow&&(Pa=h.H(la),X.k(this.$,Pa)),M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowFilteredResultsInStatusBar",!1)&&(null===(Sa=this.Qp)||void 0===Sa?void 0:Sa.zya(Ia.Result,"Table"===Za.AutoFilterType,Za.Id)))};var aa=la&&-1!==la.FirstRow?k.Range.Hc(la.FirstRow,la.FirstColumn):null;aa=6|(Object(S.p)(this.$,aa)?128:0);const oa=new m.a(208,0,(Ia,Sa,Pa)=>l.a(this.$.ma.sa,fa,Ha,A.c(Ia,ba),Sa,Pa,null,null),aa,()=>new x.a(Ha,fa)),Na=()=>
{this.$.userOperationManager.enqueueOperation(oa,null)};aa=this.$.fa.$b.allowViewCollab;this.pU||aa?this.cz.EKa(Na,19,"GridContextMenuFilter::ApplyFilterByValue"):this.Ox?this.Ox.M5a().continueWith(Ia=>{Ia.result&&Na()}):Na();return Y.Task.Va(!0)}Omc(Ha){const Za=X.e(this.da);Za.ColorOrIconOptions=X.d(Ha,this.da);Ha=X.h(this.da,this.$,Za.Column);X.a(this.$,Za,Ha,this.cz,this.pU,this.Qp);return Y.Task.Va(!0)}dWh(Ha,Za){Ha=k.Range.Hc(Ha,Za);return this.da.za.rDa(Ha,this.$.la.name)&&(Ha=this.da.za.GGa(Ha))&&
Ha.autoFilterMenu?!0:!1}H4i(){var Ha=null;const Za=this.da.Ob(this.da.ha.oa.activeCell);if(!Za)return null;const fa=Za.cell.i_c,{category:la}=this.instantaneousSupportInformationManager.Fna(fa,!1);if(1===Za.Qh.type)if(3===la){if(!Za.cell.numFmt)return c.ULS.sendTraceTag(527500290,0,15,`GridContextMenuFilter::GetValueForFilter() for category : ${la}. NumFmt is null. `),null;Ha=(Za.cell.numFmt.Start+Za.cell.numFmt.End).trim()}else if(!la&&(G.a.Oeb(Za.Qh.value,"E")||G.a.Oeb(Za.originalText,"E"))){Ha=
this.$e.qId(Za.Qh.value,fa,1,Number.POSITIVE_INFINITY,Za.cell.S0);if(!Ha.success)return c.ULS.sendTraceTag(527500289,0,50,`GridContextMenuFilter::GetValueForFilter() for category : ${la}. Failed to acquire formatted value`),null;Ha=Ha.fI}Ha||(Ha=Za.originalText);return b.a.hia(Ha)?["[Blanks]"]:["i"+Ha.trim()]}};Oa=Object(y.__decorate)([Object(C.d)(O.GridContextMenuFilterService),Object(y.__param)(0,Object(O.EwaControlService)()),Object(y.__param)(1,Object(O.NamedSheetViewPublicService)()),Object(y.__param)(2,
Object(O.FormatCellsActionService)()),Object(y.__param)(3,Object(O.InstantaneousSupportInformationManagerService)()),Object(y.__param)(4,Object(O.SortFilterManagerService)()),Object(y.__param)(5,Object(O.FilteredResultsStatusBarManagerService)())],Oa);Object(r.a)(Oa,"GridContextMenuFilter",null,[])},1498:function(y,r,a){r=a(490);a=a(1499);a=a.Di?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);r(a,{insert:"head",Oj:!1});y.exports=a.Fk||{}},1499:function(y,r,a){r=a(489);a=a(1260);r=r(!1);r.i(a);r.push([y.i,
"div#valueFieldSettingTabs .TabTitlesContainer{border-bottom:solid 1px #c3cbd0}div#valueFieldSettingTabs .TabTitle{text-align:center;cursor:default}div#valueFieldSettingTabs .TabTitleText{display:inline-block}div#valueFieldSettingTabs .TabTitleActive{color:#217346;font-weight:700}div#valueFieldSettingTabs .TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}div#dataFieldCustomLabel,div#dataFieldSourceLabel{font-weight:600;padding-left:10px}div#summarizeValuesByControlBody{background-color:#fff;padding:10px}.valueFielsSettingsControlTitle{font-weight:700;border-bottom:1px solid #a2a6ab}div#summarizeValuesByControlBody>.summarizeValuesByControlDescription{font-weight:600}div#summarizeValuesByControlBody>select{width:100%}div#showValueAsControlBody{background-color:#fff;padding:10px}select#showValueAsSelect{width:100%;margin-bottom:5px}select#showValueAsBaseFieldSelect{width:100%}select#showValueAsBaseItemSelect{width:100%;overflow:hidden}div#showValueAsControlBody>.showValueAsControlSelectRegion{width:48%;display:inline-block;position:relative}div#showValueAsControlBody>.showValueAsControlSelectRegionSeparator{width:4%;display:inline-block}.showValueAsControlSelectRegion>div{width:100%}input#valueFieldsSettingsFieldName{width:273px}div#valueFieldSettingTabs{width:380px}",
""]);y.exports=r},185:function(y,r,a){function c(R,cb,zb,V,Ea){R=void 0===R?null:R;cb=void 0===cb?Oa.NotSelected:cb;zb=void 0===zb?null:zb;V=void 0===V?!1:V;Ea=void 0===Ea?null:Ea;return{displayText:R?La.a.Dg(R):R,state:cb,key:zb,parent:null,children:Ea,indentationLevel:0,expanded:V}}function b(R,cb,zb,V,Ea){const pb={};pb.Location=R;pb.IsPivotFilter=!0;pb.FieldId=cb;pb.DataSourceIndex=zb;pb.AnchorType=V.AnchorType;pb.ChartId=V.ChartId;pb.AnchorValue1=V.AnchorValue1;pb.AnchorValue2=V.AnchorValue2;
pb.HierarchyLevel=Ea;return pb}function f(R){const cb=[];if(!R)return cb;let zb=0;for(const Ea of R){R=zb++;var V=Ea.DisplayString;let pb=Oa.NotSelected;switch(Ea.State){case 0:pb=Oa.Selected;break;case 1:pb=Oa.NotSelected;break;case 2:pb=Oa.PartiallySelected}cb[R]=c(V,pb,zb.toString())}return cb}a.r(r);var k={};a.r(k);a.d(k,"AutoFilterContextMenu",function(){return Da});var x={};a.r(x);a.d(x,"AutoFilterFieldListContextMenu",function(){return Ud});var d={};a.r(d);a.d(d,"FloatingObjectContextMenu",
function(){return fe});var h={};a.r(h);a.d(h,"ChartContextMenu",function(){return rc});var n={};a.r(n);a.d(n,"ReactContextMenuController",function(){return Ac});var m={};a.r(m);a.d(m,"ContextMenuManager",function(){return pc});var u={};a.r(u);a.d(u,"FieldListContextMenu",function(){return cd});var l={};a.r(l);a.d(l,"FieldListPivotContextMenu",function(){return kd});var t={};a.r(t);a.d(t,"FieldWellContextMenu",function(){return je});var e={};a.r(e);a.d(e,"PivotDropDownContextMenu",function(){return Af});
var w={};a.r(w);a.d(w,"PivotFilterContextMenu",function(){return Qe});var z={};a.r(z);a.d(z,"PivotPageFilterContextMenu",function(){return Ta});var E={};a.r(E);a.d(E,"PivotTableContextMenu",function(){return cf});var M={};a.r(M);a.d(M,"PulloutFieldListContextMenu",function(){return ib});var G={};a.r(G);a.d(G,"RichTextContextMenu",function(){return Kc});var A={};a.r(A);a.d(A,"SheetOpsContextMenu",function(){return Qb});var N={};a.r(N);a.d(N,"SlicerContextMenu",function(){return id});var K={};a.r(K);
a.d(K,"TimeSlicerContextMenu",function(){return Sd});var I={};a.r(I);a.d(I,"TimeSlicerLevelMenu",function(){return Ge});var L=a(133),J=a(0),B=a(19),Y=a(1261),U=a(2),O=a(15),C=a(189),X=a(6),S=a(182),ea=a(263),Oa;(function(R){R[R.NotSelected=0]="NotSelected";R[R.Selected=1]="Selected";R[R.PartiallySelected=2]="PartiallySelected"})(Oa||(Oa={}));var Ha=a(946),Za=a(7),fa=a(491),la=a(669),ba=a(70),aa=a(58),oa=a(1030),Na=a(150),Ia=a(44),Sa=a(213),Pa=a(61),za=a(969),wa=a(134),db=a(43),Ba=a(124),Ka=a(226),
da=a(83),sa=a(71),mb=a(42),Ma=a(36),hb=a(255),$a=a(1),Va=a(209),xa=a(13),ia=a(75),Z=a(266),ta=a(25),pa=a(151),Ga=a(962),Ca=a(988),kb=a(143),eb=a(142);class Yb{constructor(){this.Sections=this.Id=null}}Object(J.a)(Yb,"AutoFilterMenu",null,[]);class Gb{constructor(){this.Disabled=!1;this.RibbonCommand=this.Identifier=this.Type=0;this.SubMenu=this.Label=this.CommandData=null;this.IsChecked=!1;this.TooltipText=this.Id=this.IconName=null}}Object(J.a)(Gb,"MenuItem",null,[]);class Mb{constructor(){this.Title=
this.MenuItems=this.Id=null;this.DisplayType=0}}Object(J.a)(Mb,"MenuSection",null,[]);var Rb=a(1656),$b=a(67),cc=a(149),fb=a(259),Sb=a(10),kc=a(65),na=a(5),fc=a(1029),Cc=a(88),tc=a(325),nb=a(1254),tb=a(544),La=a(92),wb=a(963),Wa;const Fa=Za.a.Z2h;let Da=Wa=class extends Ha.a{constructor(R,cb,zb,V,Ea,pb,Jb,zc){pb=void 0===pb?null:pb;super(R,"PopulateAutoFilterContextMenu",1675506831,1651433993,Fa,!0,!1,"AutoFilterContextMenuRoot",zc,cb,!1,zb,V);this.Pmc=this.ME=this.Ura=null;this.fJa=!1;this.IKb=this.DKa=
this.smf=this.Twa=this.CAc=this.KX=this.evb=this.E3=null;this.pU=$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NsvEntryOptimizationApplyForEveryone",!1);this.Qmc=this.ENb=this.ohb=this.lm=this.Qp=null;this.gyj=$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8836786_AutoFilterAsyncUiMeasurement");this.P5f=$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8836799_AutoFilterItemsAsyncUiMeasurement");this.Ivj=$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8963140_RequestingAutoFilterItemsWithoutQueue");
this.ZNa=!1;this.bT=0;this.Hj=()=>{this.h6a();this.$.fa.Av(this.Hj)};this.XU=Mc=>{var od={};this.$.Zk(od);var Td=this.$.fa.isNamedObjectViewMode;const Zd=aa.a.Xj(this.Pmc);Zd.SheetName=Td?od.NamedObjectName:od.SheetName;Zd.NamedObjectView=Td;od=!!Mc.searchText;Td=586;od&&(Zd.ItemListOptions=this.a6h(Mc.searchText),Td=597);pa.b(this.$).Jd(Na.a.mZj,{["UserOperation"]:Td.toString()},void 0,!0);const xe=this.$1a(od),pe=this.t_b(),Re=this.$.ma.sa.mc();this.Ivj&&0===this.$.userOperationManager.operationCount?
this.Fxk(Zd,xe,pe,Re):(this.smf=$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8793440_UsingCLientRequestId")?Re.ClientRequestId:Re.RequestId,this.CAc&&!this.CAc.dequeueUtcTime&&(this.$.userOperationManager.Sia(this.CAc),this.xcf()),Mc=new Sa.a(Td,0,(pf,vf,Qf)=>this.IKb=Pa.n(this.$.ma.sa,Zd,Z.c(pf,xe),Z.b(vf,pe),Qf,null,Re),80),this.CAc=this.$.userOperationManager.enqueueOperation(Mc,null),this.DKa=this.IKb,this.Twa=this.smf)};this.onMenuItemClick=(Mc,od,Td)=>{pa.b(this.$).Jd(Na.a.v3j,fc.g(),void 0,
!0);od={["CommandValueId"]:od,["MenuItemId"]:od,["InputMethod"]:Td,["TopCellAddress"]:this.ME};const Zd=new da.a(Mc,Td,this.$.isEditMode?2:1,19,null);this.$.Ia.Gb(Zd,od);O.ULS.sendTraceTag(537167131,0,50,`AutoFilterContextMenu::OnMenuItemClick ${Mc}, ${Td}`)};this.focusShiftOnMenuDismiss=()=>{ta.f(this.$).focus()};this.cpb=Mc=>{this.bT=Date.now();if(Mc.checkedItems&&Mc.checkedItems.length){pa.b(this.$).Jd(Na.a.E8d,fc.g(),void 0,!0);var od=aa.a.Xj(this.Pmc),Td=fc.b(this.$,od),Zd={Wnc:0,Tnc:0,zhg:0,
range:0,n0c:!1},xe=!1;$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8634169_fix6bgr7taghighcount")&&(xe=Object(nb.b)(this.ME,ta.f(this.$)));$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8494257_FilterAndSortTelemetry")&&(Zd=Object(nb.a)(ta.f(this.$),this.ME,od.AutoFilterType));var pe=yf=>{var Df=this.bT?Date.now()-this.bT:-1;O.ULS.sendTraceTag(508372235,0,50,`GridContextMenuFilter::ApplyFilterByValue Perf Telemetry : ${JSON.stringify({["ToggleFilterOperationCount"]:0,["ApplyFilterTime"]:Df,["ToggleAndApplyFilterTime"]:0,
["FilterByValueType"]:od.AutoFilterType})}`);var pg=void 0;$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8494257_FilterAndSortTelemetry")&&(pg={["blocksWithTableInViewport"]:Zd.Wnc,["blockWithTableNotInViewport"]:Zd.Tnc,["nonEmptyCellsCount"]:Zd.zhg,["isFilterAppliedBefore"]:xe,["filterDataType"]:this.ohb,["range"]:Zd.range,["ApplyFilterTime"]:Df,["FilterByValueType"]:od.AutoFilterType},$a.EwaSettings.gVb()&&pg&&this.$&&this.ME&&(pg.IsScheduledGetRange=Object(wb.p)(this.$,this.ME),pg.OldLoadedRange=
ta.f(this.$).Ek),$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8665655_AdditionalFilterAndSortTelemetry")&&(pg=Object.assign({},pg,{["tableExistsInClient"]:Zd.n0c,["filterItemCount"]:this.ENb})),pg=JSON.stringify(pg),O.ULS.sendTraceTag(507901277,0,20,`AutoFilterContextMenuFilter::ApplyFilterByValue Data Telemetry : ${pg}`));Ga.a.X9(yf)&&(Df=Ga.a.v7(yf),this.tl?Ga.a.Kl(Ca.a.applyItemFilter,Df.MessageIdName,eb.a.bba,!0,Ga.a.BIa(Df.MessageId)):O.ULS.sendTraceTag(537167129,0,10,`AutoFilterContextMenu::OnApplyFilterByValue failed with AutoFilterException -${Df.MessageIdName}`));
hb.a(yf)||(O.ULS.sendTraceTag(537167128,0,50,"AutoFilterContextMenu::OnApplyFilterByValue service call succeeded"),pa.b(this.$).Jd(Na.a.YNc,fc.g(),void 0,!0),this.evb.onApplyFilterByValueFinish({isSuccess:!0}),fc.k(this.$,this.ME),$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowFilteredResultsInStatusBar",!1)&&this.Qp.zya(yf.Result,"Table"===od.AutoFilterType,od.Id));this.FTb&&(Df=!!yf&&!!yf.RequestTelemetryData,ta.f(this.$).Ce.UY(this.Qmc,yf.StateId,Df?yf.RequestTelemetryData.EcsOperationDuration:
0,Df?yf.RequestTelemetryData.EcsRequestDuration:0,Df?yf.RequestTelemetryData.WfeRequestDuration:0),yf=new tb.a,yf.Hmc(pg),ta.f(this.$).Ce.Zxe(this.Qmc,yf))},Re=null;$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8494257_FilterAndSortTelemetry")&&(Re=new da.a("Table"===od.AutoFilterType?-586911747:-485891668,null,this.$.isEditMode?2:1,19,null));this.FTb&&(this.Qmc=C.a.create().toString(),ta.f(this.$).Ce.ML(21,this.Qmc,fa.a(Re.command)));var pf=6|(Object(wb.p)(this.$,this.ME)?128:0),vf=new Sa.a(208,
0,(yf,Df,pg)=>Pa.a(this.$.ma.sa,Td,Mc.checkedItems,Z.c(yf,pe),Df,pg,null,null),pf,()=>new oa.a(Mc.checkedItems,Td));pf=()=>{$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8494257_FilterAndSortTelemetry")?this.$.userOperationManager.enqueueOperation(vf,Re):this.$.userOperationManager.enqueueOperation(vf,null)};var Qf=this.$.fa.$b.allowViewCollab;this.pU||Qf?this.cz.EKa(pf,19,"AutoFilterContextMenu::onApplyFilterByValue"):fc.j(pf)}else O.ULS.sendTraceTag(537167130,0,15,"AutoFilterContextMenu::OnApplyFilterByValue Received Zero checked items to apply filter on")};
this.c8e=Mc=>{const od=Ia.r(this.ME,this.$),Td=Ia.y(this.ME,this.$),Zd={};Zd.SortOptions={OperationType:Rb.d.CustomSort,ActiveCell:od,SelectedRange:Td,SortConditions:[{SortConditionType:Mc.type,RowColOffset:od.FirstColumn-Td.FirstColumn,SortColor:Mc.color,SortIconSet:Mc.icon.IconSet,SortIcon:Mc.icon.Icon,IsAscending:!0}],SortTopToBottom:!0,GuessHeader:!0,IsCaseSensitive:!1,HasHeader:!1};Zd.SelectedRange=Td;Zd.OriginalActiveCell=od;Zd.ShouldRestoreSelection=!1;Zd.ShouldPromptNamedSheetViewTeachingDialog=
!0;O.ULS.sendTraceTag(537167119,0,50,`AutoFilterContextMenu.ApplySortByColorOrIcon: Aplying Sort, type: ${Mc.type}`);this.$.Dc(-1089513346,ba.a.Hb,19,{["CustomSortCommandData"]:Zd})};this.Omc=Mc=>{if(Mc.color||Mc.icon){var od=aa.a.Xj(this.Pmc);od.ColorOrIconOptions=fc.c(Mc);fc.a(this.$,od,this.ME,this.cz,this.pU,this.Qp)}else O.ULS.sendTraceTag(512258703,0,15,"AutoFilterContextMenu::applyFilterByColorOrIcon Received Zero params to apply filter on")};this.SJd=()=>this.cz.SJd();this.onApplyForEveryoneClick=
Mc=>{O.ULS.sendTraceTag(508343893,0,50,`AutoFilterContextMenu::onApplyForEveryoneClick: Apply for everyone value updated to ${Mc}`);this.cz.g6k()};this.tl=Ga.a.Lkb();this.zoom=V;this.Qp=pb;this.lm=Ea;this.FTb=$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8653981_captureApplyFilterAndSortIndag5e")}get Sx(){return"PopulateAutoFilterContextMenu"}get tB(){return Za.a.DCg}executeCommand(R,cb,zb){R=cb.command;switch(R){case 1701016594:return Ha.a.HFd(zb),$b.Task.Va(!0);case 966232027:const V=new S.a,Ea=
Object(Cc.d)(kc.a.resolve(na.SortFilterManagerService,{xa:3})),pb=Object(Cc.d)(kc.a.resolve(na.ContextMenuManagerService,{xa:0}));db.TaskExtensions.tb(ea.a.VE(...[Ea,pb]),()=>{var Jb;this.cz=null!==(Jb=this.cz)&&void 0!==Jb?Jb:Ea.result;this.r$i(zb,pb.result);V.setResult(!0)},this.Aa,3).continueWith(()=>{V.setResult(!1)},5,this.Aa,fb.a.instance);return V.task;default:return Va.a(R)}}r$i(R,cb){const zb=R.domEvent;if(sa.e(zb.rawEvent)&&(sa.g(zb),zb.target)){var V=new wa.SheetProtection(this.$.qa);if(V.ie(4096)||
V.ie(2048)){var Ea=aa.a.Xj(R[ba.a.Bf]);na.SortFilterService.Oa()?this.$re(Ea)&&(this.ZNa||this.dXf(),this.R3b(zb,Ea,cb)):this.$re(Ea)&&(this.fJa?this.R3b(zb,Ea,cb):(this.E3=()=>{this.$re(Ea)&&(this.dXf(),this.R3b(zb,Ea,cb),this.fJa=!0)},this.h6a()))}}}Rc(R,cb,zb){switch(cb.command){case 1701016594:case 966232027:return!!zb;default:return!1}}l1b(R){R.MenuSectionList.push(...this.Ura)}dXf(){$a.EwaSettings.isChangeGateEnabled("OfficeVSO:7271429_FocusShiftOnMenuDismiss_ViewportRegressionFix")?this.evb=
sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController({getFilterByValueItemsRequest:this.XU,applyFilterByValueRequest:this.cpb,onMenuItemClick:this.onMenuItemClick,focusShiftOnMenuDismiss:this.focusShiftOnMenuDismiss,autoFilterMenuWidth:Wa.Drd,applySortByColorOrIconRequest:this.c8e,applyFilterByColorOrIconRequest:this.Omc,onApplyForEveryoneClick:this.onApplyForEveryoneClick}):this.evb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController({getFilterByValueItemsRequest:this.XU,
applyFilterByValueRequest:this.cpb,onMenuItemClick:this.onMenuItemClick,autoFilterMenuWidth:Wa.Drd,applySortByColorOrIconRequest:this.c8e,applyFilterByColorOrIconRequest:this.Omc,onApplyForEveryoneClick:this.onApplyForEveryoneClick});this.KX=Object(B.f)(Y.a)||new la.a(this.$.Oc,this.$);this.ZNa=!0}R3b(R,cb,zb){pa.b(this.$).Jd(Na.a.R3b,fc.g(),void 0,!0);if(cb){zb=this.hKi(cb,zb);cb.Cell||O.ULS.sendTraceTag(509220166,0,10,"AutoFilterContextMenu.renderReactAutoFilterMenu:\u00a0autoFilterData.Cell is undefined.");
var V=-1===cb.Cell.FirstRow;cb=Ha.a.dPb(this.$,cb.Cell,V);Ha.a.UTb(cb,V)&&((cb=Ha.a.oPb(this.$,cb,!0,V))?(V=cb.x,cb=cb.y,V=ta.f(this.$).rtl?new Sys.UI.Point(V-this.zoomManager.Aqa(Wa.Drd),cb):new Sys.UI.Point(V,cb),V=this.zoomManager.B7(V),zb={targetPoint:{left:V.x,top:V.y},autoFilterMenu:zb,applyForEveryoneState:this.SJd()},this.gyj&&void this.a7k(R),this.evb.showSortFilterMenu(zb,this.P5f?Ea=>{this.lm.kq(Ea,"context_menu_auto_filter_apply_sync",null,["context-menu-auto-filter-items"])}:void 0),
this.$.Dc(-544117314,-1,0,null)):O.ULS.sendTraceTag(509220165,0,10,`AutoFilterContextMenu.renderReactAutoFilterMenu:\u00a0failed to get the context menu coordinates. isHeaderCommandData=${V}`))}else O.ULS.shipAssertTag(537167135,0,!!cb,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.")}async a7k(R){this.P5f?this.lm.kq(R.rawEvent,"context_menu_auto_filter_sync",null,["context-menu-auto-filter","context-menu-auto-filter-items"]):(await kc.a.resolve(na.InteractivityTrackerServiceIdentifier)).kq(R.rawEvent,
"context_menu_auto_filter_sync",null,["context-menu-auto-filter"])}$re(R){return(null===R||void 0===R?0:R.Cell.SheetName)?!$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8756256_FilterButtonInNovMode")&&ta.f(this.$).tda?R.Cell.SheetName===this.$.la.name:R.Cell.SheetName===this.$.la.sheetName:na.SortFilterService.Oa()?this.$.fa.ug:!0}hKi(R,cb){return(R=this.iKi(R,cb))?this.Rzg(R):null}Rzg(R){const cb=[];for(const zb of R.Sections){if(Object(cc.e)(this.$)&&$a.EwaSettings.isChangeGateEnabled("OfficeVSO:6122433_NSVTitleEnabled")&&
zb.Title===xa.a.instance.ia(1951))continue;const V=this.Pfk(zb);cb.push(V)}return Object(U.a)(new Yb,{Id:R.Id,Sections:cb})}Pfk(R){const cb=[];for(const zb of R.MenuItems)if(2===zb.Identifier)this.Pmc=zb.CommandData;else switch(zb.Type){case 3:case 2:cb.push(this.Nfk(zb,2===zb.Type));break;case 1:cb.push(this.Ofk(zb))}return Object(U.a)(new Mb,{MenuItems:cb,DisplayType:R.DisplayType,Id:this.KEf(R)})}Ofk(R){const {label:cb,mua:zb}=this.lJd(R),V=this.Rzg(R.SubMenu),Ea=this.iJd(R);let pb="MissingIcon_20";
zb&&(pb=this.KX.Eib(zb));const Jb=cb||R.Label;return Object(U.a)(new Gb,{Disabled:R.Disabled,Type:R.Type,Identifier:R.Identifier,Id:Ea,CommandData:R.CommandData,Label:Jb,SubMenu:V,IsChecked:R.IsChecked,IconName:"MissingIcon_20"===pb?null:pb})}Nfk(R,cb){const {label:zb,mua:V,Ti:Ea}=this.LOb(R,cb&&R.IsChecked);cb=this.qyc(R,zb);let pb="MissingIcon_20";V&&(pb=this.KX.Eib(V));switch(R.RibbonCommand){case 1948650742:var Jb=this.$.qa.la;Jb=!this.$.fa.W8||0!==Jb.CB||Jb.ue.vI||cc.e(this.$)||this.$.fa.$b.allowViewCollab;
R.Disabled=Jb;break;case 1385699053:case 1933713114:case -87741481:Jb=this.$.qa.la,Jb=!this.$.fa.W8||!Jb.ue.KL.length||cc.e(this.$),R.Disabled=Jb}return Object(U.a)(new Gb,{Disabled:R.Disabled,Type:R.Type,Identifier:R.Identifier,Id:cb,RibbonCommand:Ea,CommandData:R.CommandData,Label:zb||R.Label,SubMenu:null,IsChecked:R.IsChecked,IconName:"MissingIcon_20"===pb?null:pb})}iKi(R,cb){var zb;this.ME=zb=Ia.H(R.Cell);$a.EwaSettings.PQ()||(cb=cb||kc.a.Cb(na.ContextMenuManagerService));if(-1===R.Cell.FirstRow)zb=
cb.fxc.ESi(zb);else{cb=ta.f(this.$).za.GGa(zb);if(!cb)return this.tl?Ga.a.Kl(Ca.a.FCg,kb.a.y6i,eb.a.Scb,!0,!1):(R=ta.f(this.$).view.visibleArea,O.ULS.sendTraceTag(537167134,0,10,`AutoFilterContextMenu.GetAutoFilterMenuProps: gridModelCellProxy that is supposed to hold model is null. Range requested ${zb}, visible range: ${R}`)),null;zb=cb.autoFilterMenu}if(!zb)return this.tl?Ga.a.Kl(Ca.a.FCg,kb.a.zLj,eb.a.Scb,!0,!1):O.ULS.sendTraceTag(537167133,0,10,"AutoFilterContextMenu.GetMenuPropsFromCachedBlock: a cell that's supposed to have an autofilter menu returned a null menu."),
null;this.QLb=R.Cell.FirstRow+"_"+R.Cell.FirstColumn;return zb}h6a(){this.$.fa.ug?Object(tc.loadChunkWithDynamicScriptLoader)("sortFilter",{xa:1}).then(()=>{this.E3()},R=>{this.tl&&(ia.a.yi(R,"AutoFilterContextMenu.SortFilterScriptLoad"),Ga.a.Kl(Ca.a.h6a,kb.a.pue,eb.a.Scb,!1,!1))}):this.$.fa.Nr(this.Hj)}Fxk(R,cb,zb,V){(this.Twa||this.DKa)&&this.xcf();this.IKb=Pa.n(this.$.ma.sa,R,cb,zb,null,null,V);this.Twa=V.ClientRequestId;this.DKa=this.IKb}a6h(R){const cb={};cb.SearchText=R;cb.Page=1;cb.DateNodeType=
-1;return cb}xcf(){this.Twa&&(O.ULS.sendTraceTag(537167132,0,15,`AutoFilterContextMenu.CancelGetAutoFilterItemListWebRequest Cancelling pending getAutoFilterItemList request with ID=${this.Twa}`),Pa.i(this.$.ma.sa,this.Twa,null,null,null),this.Twa=null);this.DKa&&(X.AFrameworkApplication.od.dy(this.DKa.sx),this.DKa=null)}$1a(R){return cb=>{this.DKa=this.Twa=null;if(Ga.a.X9(cb)){var zb=Ga.a.v7(cb);this.tl?Ga.a.Kl(R?Ca.a.searchAutoFilterItemList:Ca.a.getAutoFilterItemList,zb.MessageIdName,eb.a.Scb,
!0,!0):O.ULS.sendTraceTag(537167127,0,10,`AutoFilterContextMenu::OnGetFilterByValueItemsSuccessCallback failed with AutoFilterException -${zb.MessageIdName}`)}if(!hb.a(cb)){O.ULS.sendTraceTag(537167126,0,50,"AutoFilterContextMenu::OnGetFilterByValueItems service call succeeded");zb=cb.Result;cb=new mb.a(!0);var V=zb.AutoFilterItems?!0:!1;const Ea=zb.AutoFilterDateNodes?!0:!1;this.ohb="";$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8494257_FilterAndSortTelemetry")&&V&&0<zb.AutoFilterItems.length&&
(this.ohb="text");$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8494257_FilterAndSortTelemetry")&&Ea&&0<zb.AutoFilterDateNodes.length&&(this.ohb="text"===this.ohb?this.ohb+"|date":"date");this.ENb=0;$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8665655_AdditionalFilterAndSortTelemetry")&&(V&&(this.ENb=zb.AutoFilterItems.length),Ea&&(this.ENb+=zb.AutoFilterDateNodes.length));V&&cb.add("AutoFilterItemsCount",zb.AutoFilterItems.length);Ea&&cb.add("AutoFilterDateItemsCount",zb.AutoFilterDateNodes.length);
cb.add("Location","contextMenu");V={filterByValueItems:this.eEa(zb),hasMoreRecords:zb.ItemListMaxExceeded,searchText:zb.SearchText};this.evb.onGetFilterByValueItemsFinish(V);R||(O.ULS.shipAssertTag(529063959,0,null!==zb.FontColors&&null!==zb.CellColors&&null!==zb.Icons&&null!==zb.SelectedSortFontColors&&null!==zb.SelectedSortCellColors&&null!==zb.SelectedSortIcons,"AutoFilterContextMenu.onGetFilterByValueItemsSuccessCallback: SortByColor items should not be null"),V={fontColors:zb.FontColors,cellColors:zb.CellColors,
icons:zb.Icons,getColorName:this.getColorName,selectedSortFontColor:0<zb.SelectedSortFontColors.length?zb.SelectedSortFontColors[0]:null,selectedSortCellColor:0<zb.SelectedSortCellColors.length?zb.SelectedSortCellColors[0]:null,selectedSortIcon:0<zb.SelectedSortIcons.length?zb.SelectedSortIcons[0]:null,selectedFilterCellColor:-1!==zb.SelectedFilterCellColor?zb.SelectedFilterCellColor:null,selectedFilterFontColor:-1!==zb.SelectedFilterFontColor?zb.SelectedFilterFontColor:null,selectedFilterIcon:null!==
zb.SelectedFilterIcon?zb.SelectedFilterIcon:null},$a.EwaSettings.isChangeGateEnabled("OfficeVSO:7573807_IsColorOrIconPresent")&&(zb=1<zb.FontColors.length||1<zb.CellColors.length||1<zb.Icons.length)&&cb.add("AutoFilterColorOrIconPresent",zb),pa.b(this.$).Jd(Na.a.$1a,cb.Dw,void 0,!0),this.evb.onGetColorsAndIconsFinish(V))}}}t_b(){return R=>{this.DKa=this.Twa=null;R=Ba.a.te(R.data);R=Ma.a.pc(R);O.ULS.sendTraceTag(537167125,0,10,`AutoFilterContextMenu.OnGetFilterByValueItemsFailureCallback Errors: [${R}].`)}}eEa(R){const cb=
this.D3h(R),zb=this.K3h(R.AutoFilterItems),V=[],Ea=[];let pb=0,Jb=0;R.HasBlanks&&(R=c(xa.a.instance.ia(782),R.IsBlanksSelected?Oa.Selected:Oa.NotSelected,Za.a.xnc),V[pb++]=R);for(const zc of cb)V[pb++]=zc;if($a.EwaSettings.isChangeGateEnabled("OfficeVSO:6892133_ErrorsOnTop_FilterMenu_Fix"))for(const zc of zb)-1!==Array.indexOf(Sb.a.Mgb,zc.displayText)?Ea[Jb++]=zc:V[pb++]=zc;else for(const zc of zb)V[pb++]=zc;return Array.prototype.concat(Ea,V)}D3h(R){const cb=[];if(!R.AutoFilterDateNodes||!R.AutoFilterDateNodes.length)return cb;
const zb=[this.Mib(R.YearKeys,R.YearValues),this.Mib(R.MonthKeys,R.MonthValues),this.Mib(R.DayKeys,R.DayValues),this.Mib(R.HourKeys,R.HourValues),this.Mib(R.MinuteKeys,R.MinuteValues),this.Mib(R.SecondKeys,R.SecondValues)];let V=!1,Ea=!1,pb=0;var Jb=null;const zc=Array(6);var Mc=null;for(const od of R.AutoFilterDateNodes){zc[0]&&(Mc.Year!==od.Year?(V=!0,pb=0,Jb=null):Mc.Month!==od.Month?(Ea=!0,pb=1,Jb=zc[0]):Mc.Day!==od.Day?(pb=2,Jb=zc[1]):R.ShowTime&&(Mc.Hour!==od.Hour?(pb=3,Jb=zc[2]):Mc.Minute!==
od.Minute?(pb=4,Jb=zc[3]):(pb=5,Jb=zc[4])));for(;6>pb;){let Td;switch(pb){case 0:Td=od.Year;Mc=zb[0].getItem(Td.toString());break;case 1:Td=od.Month;Mc=zb[1].getItem(Td.toString());break;case 2:Td=od.Day;Mc=zb[2].getItem(Td.toString());break;case 3:Td=od.Hour;Mc=zb[3].getItem(Td.toString());break;case 4:Td=od.Minute;Mc=zb[4].getItem(Td.toString());break;case 5:Td=od.Second;Mc=zb[5].getItem(Td.toString());break;default:throw Error.invalidOperation("Unknown AutoFilterDateNodeType.");}Mc=c(Mc,-1!==od.NodeType&&
pb>=od.NodeType?Oa.Selected:Oa.NotSelected,Jb?Jb.key+";"+Td:Za.a.Erd+Td,!1,[]);Jb=Jb?Jb.children:cb;Jb=Jb[Jb.length]=Mc;zc[pb]=Mc;switch(pb){case 5:pb=6;break;case 2:pb=R.ShowTime?pb+1:6;break;default:pb++}}Mc=od}V||(zc[0].expanded=!0,Ea||(zc[1].expanded=!0));return cb}K3h(R){const cb=[];if(!R)return cb;let zb=0;for(const V of R)cb[zb++]=c(V.DisplayString,V.Selected?Oa.Selected:Oa.NotSelected,Za.a.Frd+V.DisplayString);return cb}Mib(R,cb){const zb=new mb.a(!0);if(!R||!cb)return zb;const V=R.length<
cb.length?R.length:cb.length;for(let Ea=0;Ea<V;Ea++)zb.add(R[Ea].toString(),cb[Ea]);return zb}getColorName(R){return za.a.EGa(Ka.a.gI(R))}};Da.Drd=268;Da=Wa=Object(L.__decorate)([Object(kc.d)(na.AutoFilterContextMenuService),Object(L.__param)(0,Object(na.EwaControlService)()),Object(L.__param)(1,Object(na.RibbonControlsService)()),Object(L.__param)(2,Object(na.ContextMenuControllerService)()),Object(L.__param)(3,Object(na.ZoomService)()),Object(L.__param)(4,Object(na.InteractivityTrackerServiceIdentifier)()),
Object(L.__param)(5,Object(na.FilteredResultsStatusBarManagerService)()),Object(L.__param)(6,Object(na.SortFilterService)())],Da);Object(J.a)(Da,"AutoFilterContextMenu",Ha.a,[]);var ja=a(945),Qa=a(154),Ob=a(85),Ub=a(20);class Zb{}Zb.gBf=26;Zb.FGd=[228,229,0,98,0,94,93];Object(J.a)(Zb,"Constants",null,[]);class uc{constructor(R,cb,zb,V){this.Sqh=R;this.klh=cb;this.plh=zb;this.gvh=V}get gtj(){return 3===this.$rc}get uxj(){return 4===this.$rc&&!!this.subMenu}get subMenu(){return this.gvh}get afg(){return this.Sqh}get $rc(){return this.klh}get kAd(){return this.plh}}
Object(J.a)(uc,"FiltersMenuData",null,[]);class Hc extends uc{constructor(R,cb){super(R,2,0,null);this.H9e=cb}}Object(J.a)(Hc,"AutoFilterFiltersMenuData",uc,[]);class Dd{}Dd.L3k=[new uc(99,2,0,null),new uc(100,2,1,null),new uc(0,3,0,null),new uc(170,2,2,null),new uc(172,2,4,null),new uc(0,3,0,null),new uc(174,2,6,null),new uc(175,2,7,null),new uc(0,3,0,null),new uc(107,0,0,null)];Dd.lRj=[new uc(99,2,0,null),new uc(100,2,1,null),new uc(0,3,0,null),new uc(101,2,8,null),new uc(102,2,10,null),new uc(103,
2,12,null),new uc(0,3,0,null),new uc(104,1,0,null),new Hc(105,1),new Hc(106,2),new uc(0,3,0,null),new uc(107,0,0,null)];Dd.Pci=[new uc(99,2,0,null),new uc(0,3,0,null),new uc(111,2,10,null),new uc(112,2,8,null),new uc(103,2,12,null),new uc(0,3,0,null),new Hc(109,8),new Hc(108,9),new Hc(110,10),new uc(0,3,0,null),new Hc(114,11),new Hc(113,12),new Hc(115,13),new uc(0,3,0,null),new Hc(116,14),new Hc(117,15),new Hc(118,16),new uc(0,3,0,null),new Hc(119,17),new Hc(120,18),new Hc(121,19),new uc(0,3,0,null),
new Hc(122,20),new Hc(123,21),new Hc(124,22),new uc(0,3,0,null),new Hc(125,23),new uc(126,2,12,[new Hc(127,24),new Hc(128,25),new Hc(129,26),new Hc(130,27),new uc(0,3,0,null),new Hc(131,28),new Hc(132,29),new Hc(133,30),new Hc(134,31),new Hc(135,32),new Hc(136,33),new Hc(137,34),new Hc(138,35),new Hc(139,36),new Hc(140,37),new Hc(141,38),new Hc(142,39)]),new uc(0,3,0,null),new uc(107,0,0,null)];Object(J.a)(Dd,"Constants",null,[]);var jc=a(662),$c=a(28),ud;let Ud=ud=class extends Ha.a{constructor(R,
cb,zb,V,Ea){super(R,"PopulateAutoFilterFieldListContextMenu",474690375,216058793,ud.Lzi,!0,!1,ud.B4a,Ea,cb,!1,zb,V);this.Jo=null}get Sx(){return"PopulateAutoFilterFieldListContextMenu"}get tB(){return Za.a.ECg}executeCommand(R,cb,zb){R=cb.command;switch(R){case -699941697:this.applyAutoFilterFieldList(cb,zb);break;case 216058793:break;case -1494291901:break;default:return Va.a(R)}return $b.Task.Va(!0)}uKd(R,cb){return!R||R.length<=cb?(O.ULS.sendTraceTag(537167117,0,10,"AutoFilterFieldListContextMenu:GetCommandId - incomplete id list"),
-1):parseInt(R[cb],10)}uee(R,cb,zb,V,Ea,pb){const Jb=this.uKd(Ea,pb);0>Jb&&O.ULS.sendTraceTag(537167116,0,10,"AutoFilterFieldListContextMenu:ProcessCommand - command id not found");switch(Zb.FGd[Jb]){case 98:R=new da.a(-2058042992,cb.method,cb.mode,cb.Re,cb.tabName);this.Jo.MM.qNb(this.$,V,0,R);break;case 228:R=new da.a(504133448,cb.method,cb.mode,cb.Re,cb.tabName);this.Jo.MM.qNb(this.$,V,0,R);break;case 229:R=new da.a(-798968736,cb.method,cb.mode,cb.Re,cb.tabName);this.Jo.MM.qNb(this.$,V,0,R);break;
case 233:R=new da.a(-1677817820,cb.method,cb.mode,cb.Re,cb.tabName);this.Jo.MM.qNb(this.$,V,0,R);break;case 94:this.jAg(R,cb,V,zb,Ea,pb+1);break;case 93:this.Jo.MM.kBj(this.$,V)}}jAg(R,cb,zb,V,Ea,pb){const Jb=this.uKd(Ea,pb);0>Jb&&O.ULS.sendTraceTag(537167115,0,10,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand - command id not found");if(!V||Jb>=V.length)O.ULS.sendTraceTag(537167114,0,15,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand() - no menuData.");else switch(V=V[Jb],V.$rc){case 1:this.Jo.MM.JBj(this.$,
zb);break;case 2:(Ea=Object(Qa.a)(Hc,V))?(R=new da.a(-2058042992,cb.method,cb.mode,cb.Re,cb.tabName),this.Jo.MM.qNb(this.$,zb,Ea.H9e,R)):this.Jo.MM.J8f(this.$,R,zb,V.kAd);break;case 0:this.Jo.MM.J8f(this.$,R,zb,V.kAd);break;case 4:this.jAg(R,cb,zb,V.subMenu,Ea,pb+1)}}applyAutoFilterFieldList(R,cb){var zb=cb[ja.a.fA];if(zb)if(zb=zb.split(Ob.a.$Lb),3>zb.length)O.ULS.sendTraceTag(537167112,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - unexpected SourceIdControl string.");else{var V=
this.uKd(zb,1),Ea=this.getFieldName(V),pb=this.Weg(V).returnValue;pb?this.uee(cb,R,pb,Ea,zb,2):O.ULS.sendTraceTag(537167111,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - menu data not found for index "+V.toString()+Ob.a.$Lb)}else O.ULS.sendTraceTag(537167113,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - SourceIdControl string is null.")}Rc(R,cb){if(R=this.$.isEditMode)switch(cb.command){case 216058793:break;case -699941697:break;case -1494291901:R=!0;break;
default:R=!1}return R}sfa(R,cb,zb){this.$.isEditMode&&((this.Jo=Object(Qa.a)(578,zb))||O.ULS.sendTraceTag(537167110,0,10,"AutoFilterFieldListContextMenu:ShowDropDown() - filterInfoManager not found."),super.sfa(R,cb,null,null,!0))}Iyd(){if(!this.Jo||!this.Jo.Yr||1!==this.Jo.Yr.length)return O.ULS.sendTraceTag(537167109,0,15,"AutoFilterFieldListContextMenu:CreateContextMenuItemList() - incorrect fields list."),null;const R=this.Jo.Yr[0];return[xa.a.instance.ia(249)].concat(R.FieldInfoDataList.map(cb=>
cb.Name)).sort((cb,zb)=>$c.a.compare(cb,zb,!0))}fieldIndex(R){if(!this.Jo||!this.Jo.Yr||1!==this.Jo.Yr.length||!this.Jo.Yr[0].FieldInfoDataList)return-1;for(let cb=0;cb<this.Jo.Yr[0].FieldInfoDataList.length;++cb)if(this.Jo.Yr[0].FieldInfoDataList[cb].Name===R)return cb;return-1}getFieldName(R){return 0>R||!this.Jo||!this.Jo.Yr||1!==this.Jo.Yr.length||!this.Jo.Yr[0].FieldInfoDataList||this.Jo.Yr[0].FieldInfoDataList.length<R?null:this.Jo.Yr[0].FieldInfoDataList[R].Name}sX(){var R=this.Iyd();if(!R||
!R.length)return null;const cb=this.Ya,zb=cb.uc();for(let pb=0;pb<R.length;++pb){const Jb=R[pb],zc=0<pb?this.fieldIndex(Jb):-1,Mc=ud.WYg+zc.toString()+Ob.a.$Lb;let od=null;const Td=this.Jo.MM.uaj(0<pb?Jb:null),Zd=this.Syd(cb,Td,ud.WYg+zc.toString(),Jb);for(let xe=0;xe<Zb.FGd.length;++xe){var V=Zb.FGd[xe],Ea=Mc+xe.toString();od||(od=cb.uc());switch(V){case 228:od.buttons.push(cb.nc(223,Ea,-699941697,this.Jo.MM.cxj(0<pb?Jb:null)?Ub.a.$vc:Ub.a.RVa,8,228,!1,null));break;case 229:od.buttons.push(cb.nc(224,
Ea,-699941697,this.Jo.MM.dxj(0<pb?Jb:null)?Ub.a.awc:Ub.a.SVa,8,229,!1,null));break;case 233:od.buttons.push(cb.nc(225,Ea,-699941697,Ub.a.Wvc,1,233,!1,null));break;case 98:V=this.kRh(Jb);Ea=cb.yUa(Ea+(Td?".enabled":".disabled"),V,-699941697,null,"None",null,!Td,void 0,!0);Ea.NZ("Image16by16",8,Ub.a.Ygb);od.buttons.push(Ea);break;case 94:let pe,Re;const pf=(()=>{let vf=this.Weg(zc);({qBf:pe,isChecked:Re}=vf);return vf})().returnValue;if(!pf)return null;V=this.Syd(cb,Re&&Td,Ea,pe);Ea=this.aFf(V.menu,
cb,Ea+Ob.a.$Lb,pf,Re&&Td);V.menu.Zb.push(Ea);od.buttons.push(V);break;case 0:od&&(Zd.menu.Zb.push(od),od=null);break;default:Ea=cb.yUa(Ea,xa.a.instance.ia(V),-699941697,null,"None",null,!1,void 0,!0),this.gQg(Ea,Td&&93===V&&this.Jo.MM.filter(),xa.a.instance.ia(V)),od.buttons.push(Ea)}}Zd.menu.Zb.push(od);zb.buttons.push(Zd)}R=cb.pq(this.menuId);R.Zb.push(zb);return R}aFf(R,cb,zb,V,Ea){let pb=null;for(let Td=0;Td<V.length;++Td){var Jb=V[Td],zc=zb+Td.toString(),Mc=!1;switch(Jb.$rc){case 1:Mc=Ea&&this.Jo.MM.ii.IsTop10;
break;case 2:Mc=Object(Qa.a)(Hc,Jb);Mc=Ea&&this.Jo.MM.ooj(Mc?Mc.H9e:0,Jb.kAd);break;case 0:Mc=Ea&&this.Jo.MM.ii.IsCustomSupportedAndNotPresent}pb||(pb=cb.uc());if(Jb.gtj)pb&&(R.Zb.push(pb),pb=null);else if(Jb.uxj){var od=xa.a.instance.ia(Jb.afg);od=this.Syd(cb,Mc,zc,od);od.menu.Zb.push(this.aFf(od.menu,cb,zc+Ob.a.$Lb,Jb.subMenu,Mc));pb.buttons.push(od)}else Jb=xa.a.instance.ia(Jb.afg),zc=cb.yUa(zc,Jb,-699941697,null,"None",null,!1,void 0,!0),this.gQg(zc,Mc,Jb),pb.buttons.push(zc)}return pb}gQg(R,
cb,zb){cb?R.NZ("Image16by16",8,Ub.a.wFa):R.NZ("None",0,null);R.Ap(zb);R.label=zb}Syd(R,cb,zb,V){return cb?R.P0(zb,this.menuId,V,798637440,8,Ub.a.wFa):R.iu(zb,this.menuId,V,798637440)}Zg(R){return!R||!R.length}Weg(R){var cb=0>R?jc.MajorityDataType.Text:this.Jo.Yr[0].FieldInfoDataList[R].MajorityDataTypeForField;var zb=null;R=this.Jo.MM.taj(cb);switch(cb){case jc.MajorityDataType.Text:zb=95;cb=Dd.L3k;break;case jc.MajorityDataType.Number:zb=94;cb=Dd.lRj;break;case jc.MajorityDataType.Date:zb=96;cb=
Dd.Pci;break;default:return O.ULS.sendTraceTag(537167108,0,10,"AutoFilterFieldListContextMenu:MenuDataForDataType() - unknown data type."),{returnValue:null,qBf:zb,isChecked:R}}zb=xa.a.instance.ia(zb);return{returnValue:cb,qBf:zb,isChecked:R}}kRh(R){return!R||this.Zg(R.trim())?xa.a.instance.ia(97):R.length>Zb.gBf?String.format(xa.a.instance.Ib(155),R.substring(0,Zb.gBf)):String.format(xa.a.instance.Ib(156),R)}};Ud.Lzi=Za.a.Y2h;Ud.B4a="AutoFilterFieldListContextMenuRoot";Ud.WYg="ApplyAutoFilterFieldList.";
Ud=ud=Object(L.__decorate)([Object(kc.d)(na.AutoFilterFieldListContextMenuService),Object(L.__param)(0,Object(na.EwaControlService)()),Object(L.__param)(1,Object(na.RibbonControlsService)()),Object(L.__param)(2,Object(na.ContextMenuControllerService)()),Object(L.__param)(3,Object(na.ZoomService)())],Ud);Object(J.a)(Ud,"AutoFilterFieldListContextMenu",Ha.a,[]);var ec=a(656),Db=a(1001),ic=a(12),Pc=a(119),Ed=a(433),de=a(29),se=a(173),Fe=a(17);let fe=class extends Ha.a{constructor(R,cb,zb,V,Ea,pb,Jb,
zc,Mc,od,Td){Mc=void 0===Mc?Za.a.f3h:Mc;super(R,void 0===pb?"PopulateFloatingObjectContextMenu":pb,void 0===Jb?-2017893763:Jb,void 0===zc?1350204367:zc,Mc,void 0===od?!0:od,void 0===Td?!1:Td,Mc,Ea,cb,!0,zb,V);this.floatingObject=null;this.Yb=0;this.MLc=!0;this.zoom=V}get Sx(){return"PopulateFloatingObjectContextMenu"}get tB(){return Za.a.NCg}executeCommand(R,cb,zb){R=Object(Qa.a)(ec.a,zb.eventArgs);switch(cb.command){case -1372040782:zb=ta.f(this.$).ha.ob.Wb;O.ULS.shipAssertTag(537167048,0,!!zb);
zb&&(se.b(this.$).kq(R.Ha.rawEvent,"context_menu_floating_object",null,["context-menu"]),this.floatingObject=zb.floatingObject,this.Yb=cb.method,cb=this.ZWa(R),this.Xo(cb,!0,R.Yb));break;case 848910589:R&&(cb=[Db.a.ATg],R=new Sys.UI.Point(R.Ha.clientX,R.Ha.clientY),this.showFloatie(cb,new Sys.UI.Bounds(R.x,R.y,0,0),2))}return $b.Task.Va(!0)}Rc(R,cb,zb){switch(cb.command){case -1372040782:return!!zb&&this.n5f(R);case 848910589:return R=ta.f(this.$).ha.ob.Wb,!!zb&&!!R&&R.isEditing;default:return!1}}n5f(R){switch(R){case 8:case 2:case 64:case 4:case 256:return!0;
default:return!1}}Dkc(R,cb,zb){Ed.a(this.$)?ta.f(this.$).rb.mj||(this.zoomManager.lse()?zb.buttons.push(R.yb(265)):zb.buttons.push(R.yb(264))):(this.$.isEditMode&&3===this.Yb&&!this.$Nb()&&zb.buttons.push(R.yb(101)),5!==this.floatingObject.type||Pc.a.BN(this.floatingObject.Sb)||this.floatingObject.Sb.IsGroup||(this.iIc()?zb.buttons.push(R.yb(186)):zb.buttons.push(R.yb(147))),$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TransitionFloatingInCellImages",!1)&&1===this.floatingObject.type&&
($a.EwaSettings.isChangeGateEnabled("OfficeVSO:8478103_DisablePlaceInCellCtxMenuOnProtectedSheet")?this.iIc()||zb.buttons.push(R.yb(303)):zb.buttons.push(R.yb(303))),this.$Nb()||this.iIc()||zb.buttons.push(R.yb(146)),$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)||(this.aJd(zb),this.pJd(zb)),$a.EwaSettings.Ra(155)&&0===this.floatingObject.type&&zb.buttons.push(R.yb(287)),$a.EwaSettings.Ra(155)&&0===this.floatingObject.type&&zb.buttons.push(R.yb(249)),
5===this.floatingObject.type&&ta.f(this.$).ha.ob.Wb.xda()&&this.$.bva&&this.$.ZW&&zb.buttons.push(R.yb(273)))}gXa(R){const cb=[];if(Ed.a(this.$))return cb;if(3===R){var zb=!!this.$.Fe.get(5)&&this.floatingObject.Mve();R=$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInEditMode",!1)&&this.$.isMobileMode&&this.$.isEditMode;const V=ta.f(this.$).ha.ob.Wb,Ea=V&&0===V.floatingObject.type;if(!this.$Nb())this.$.isEditMode?(zb&&cb.push(Db.a.MCi),R||5===ta.f(this.$).ha.ob.FF.floatingObject.type&&
cb.push(Db.a.LOk)):zb&&cb.push(Db.a.copy);else if(de.a.LK()&&Ea&&(zb=V.FQb(3),$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8954473_AddFloatieGroupIdNullCheck")?null!==zb&&void 0!==zb:1))for(const pb of zb)cb.push(pb);de.a.LK()&&Ea?cb.push(Db.a.XWh):R||cb.push(Db.a.NCi)}else 2===R&&ta.f(this.$).ha.ob.Wb&&this.DVi(ta.f(this.$).ha.ob.Wb,cb);return cb}sX(){var R=this.Ya;const cb=R.pq(this.menuId),zb=Ed.a(this.$);let V=null,Ea=null;!this.$.isEditMode||$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInEditMode",
!1)&&this.$.isMobileMode||(V=R.uc(),this.Dkc(R,cb,V));this.$.Fe.get(5)&&this.floatingObject.Mve()&&!this.$Nb()&&!zb&&(Ea=R.uc(),this.czh(R,Ea));$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?(Ea&&cb.Zb.push(Ea),V&&(cb.Zb.push(V),R=R.uc(),this.aJd(R),this.pJd(R),cb.Zb.push(R))):(V&&cb.Zb.push(V),Ea&&cb.Zb.push(Ea));return cb}ZWa(R){var cb=ta.f(this.$).ha.ob.Wb;R=R&&1!==R.Yb&&R.clientPoint?R.clientPoint:ic.HelperMethods.isStandardZoomCssSupportedByBrowser?
Fe.DOMElementExtensions.getLocation({element:cb.domElement,di:!0}):Sys.UI.DomElement.getLocation(cb.domElement);const zb=this.$.domElement,V=ta.f(this.$).rtl;(cb=ic.HelperMethods.aE(cb.Ug.domElement,zb,V))?(R.y=Math.max(R.y,cb.y),R.x=Math.max(R.x,cb.x)):O.ULS.sendTraceTag(537167047,5,15,`FloatingObjectContextMenu.GetContextMenuClientPoint sheetContentDivLocation is null if the offset parent is null. IsShuttingdown : ${X.AFrameworkApplication.Sf}`);return R}iIc(){const R=ta.f(this.$).ha.ob.Wb;return!!R&&
R.isEditing}czh(R,cb){if(this.$.isEditMode){cb.buttons.push(R.yb(42));cb.buttons.push(R.yb(43));const zb=this.$.ra.Tb(254,!0);(zb&&2===zb.XIa()||this.iIc())&&cb.buttons.push(R.yb(44))}else cb.buttons.push(R.yb(43))}$Nb(){return $a.EwaSettings.Ra(407)&&!!ta.f(this.$).ha.ob.Qj}DVi(R,cb){if(5===R.floatingObject.type)R.isEditing?cb.push(Db.a.ATg):cb.push(Db.a.zTg);else if(de.a.LK()&&Pc.a.y8(R.floatingObject)){if(R=R.FQb(2),$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8954473_AddFloatieGroupIdNullCheck")?
null!==R&&void 0!==R:1)for(const zb of R)cb.push(zb)}else cb.push(Ha.a.vCf)}aJd(R){const cb=this.Ya.uc();cb.buttons.push(this.Ya.yb(282));cb.buttons.push(this.Ya.yb(281));const zb=this.Ya.iu("BringToFront","BringToFrontMenuId",xa.a.instance.ia(822),-1777747317);zb.menu.Zb.push(cb);R.buttons.push(zb)}pJd(R){const cb=this.Ya.uc();cb.buttons.push(this.Ya.yb(284));cb.buttons.push(this.Ya.yb(283));const zb=this.Ya.iu("SendToBack","SendToBackMenuId",xa.a.instance.ia(823),-1777747317);zb.menu.Zb.push(cb);
R.buttons.push(zb)}};fe=Object(L.__decorate)([Object(kc.d)(na.FloatingObjectContextMenuService),Object(L.__param)(0,Object(na.EwaControlService)()),Object(L.__param)(1,Object(na.RibbonControlsService)()),Object(L.__param)(2,Object(na.ContextMenuControllerService)()),Object(L.__param)(3,Object(na.ZoomService)())],fe);Object(J.a)(fe,"FloatingObjectContextMenu",Ha.a,[]);var Tc=a(100),ed=a(610),pd;(function(R){R[R.dataLabelsNoneColumn=0]="dataLabelsNoneColumn";R[R.dataLabelsNoneLine=1]="dataLabelsNoneLine";
R[R.dataLabelsNonePie=2]="dataLabelsNonePie";R[R.dataLabelsShowColumn=3]="dataLabelsShowColumn";R[R.dataLabelsCenterColumn=4]="dataLabelsCenterColumn";R[R.dataLabelsCenterLine=5]="dataLabelsCenterLine";R[R.dataLabelsCenterPie=6]="dataLabelsCenterPie";R[R.dataLabelsInsideEndColumn=7]="dataLabelsInsideEndColumn";R[R.dataLabelsInsideEndPie=8]="dataLabelsInsideEndPie";R[R.dataLabelsInsideBaseColumn=9]="dataLabelsInsideBaseColumn";R[R.dataLabelsOutsideEndColumn=10]="dataLabelsOutsideEndColumn";R[R.dataLabelsOutsideEndPie=
11]="dataLabelsOutsideEndPie";R[R.dataLabelsLeftLine=12]="dataLabelsLeftLine";R[R.dataLabelsRightLine=13]="dataLabelsRightLine";R[R.dataLabelsAboveLine=14]="dataLabelsAboveLine";R[R.dataLabelsBelowLine=15]="dataLabelsBelowLine";R[R.dataLabelsBestFitPie=16]="dataLabelsBestFitPie";R[R.axesHorizontalNone=17]="axesHorizontalNone";R[R.axesHorizontalShowLtr=18]="axesHorizontalShowLtr";R[R.axesHoriztonalNoLabels=19]="axesHoriztonalNoLabels";R[R.axesHorizontalShowRtl=20]="axesHorizontalShowRtl";R[R.axesHorizontalDefault=
21]="axesHorizontalDefault";R[R.axesHorizontalThousands=22]="axesHorizontalThousands";R[R.axesHorizontalMillions=23]="axesHorizontalMillions";R[R.axesHorizontalBillions=24]="axesHorizontalBillions";R[R.axesHorizontalLogScale=25]="axesHorizontalLogScale";R[R.axesVerticalNone=26]="axesVerticalNone";R[R.axesVerticalDefault=27]="axesVerticalDefault";R[R.axesVerticalThousands=28]="axesVerticalThousands";R[R.axesVerticalMillions=29]="axesVerticalMillions";R[R.axesVerticalBillions=30]="axesVerticalBillions";
R[R.axesVerticalLogScale=31]="axesVerticalLogScale";R[R.axesVerticalNoLabels=32]="axesVerticalNoLabels";R[R.axesVerticalShowRtl=33]="axesVerticalShowRtl";R[R.gridlinesHorizontalNone=34]="gridlinesHorizontalNone";R[R.gridlinesHorizontalMajor=35]="gridlinesHorizontalMajor";R[R.gridlinesHorizontalMinor=36]="gridlinesHorizontalMinor";R[R.gridlinesHorizontalMajorMinor=37]="gridlinesHorizontalMajorMinor";R[R.gridlinesVerticalNone=38]="gridlinesVerticalNone";R[R.gridlinesVerticalMajor=39]="gridlinesVerticalMajor";
R[R.gridlinesVerticalMinor=40]="gridlinesVerticalMinor";R[R.gridlinesVerticalMajorMinor=41]="gridlinesVerticalMajorMinor";R[R.contextMenuCut=42]="contextMenuCut";R[R.contextMenuCopy=43]="contextMenuCopy";R[R.contextMenuPaste=44]="contextMenuPaste";R[R.contextMenuHyperlink=45]="contextMenuHyperlink";R[R.contextMenuHyperlinks=46]="contextMenuHyperlinks";R[R.contextMenuRemoveHyperlink=47]="contextMenuRemoveHyperlink";R[R.contextMenuRemoveHyperlinks=48]="contextMenuRemoveHyperlinks";R[R.contextMenuInsertRows=
49]="contextMenuInsertRows";R[R.contextMenuInsertColumns=50]="contextMenuInsertColumns";R[R.contextMenuDeleteRows=51]="contextMenuDeleteRows";R[R.contextMenuDeleteColumns=52]="contextMenuDeleteColumns";R[R.contextMenuOpenHyperlink=53]="contextMenuOpenHyperlink";R[R.contextMenuInsertSheet=54]="contextMenuInsertSheet";R[R.contextMenuRenameSheet=55]="contextMenuRenameSheet";R[R.contextMenuDeleteSheet=56]="contextMenuDeleteSheet";R[R.contextMenuPasteDisabled=57]="contextMenuPasteDisabled";R[R.contextMenuPivotFieldListHide=
58]="contextMenuPivotFieldListHide";R[R.contextMenuPivotFieldListShow=59]="contextMenuPivotFieldListShow";R[R.contextMenuFieldWellMoveUp=60]="contextMenuFieldWellMoveUp";R[R.contextMenuFieldWellMoveDown=61]="contextMenuFieldWellMoveDown";R[R.contextMenuFieldWellMoveToBeginning=62]="contextMenuFieldWellMoveToBeginning";R[R.contextMenuFieldWellMoveToEnd=63]="contextMenuFieldWellMoveToEnd";R[R.contextMenuFieldWellMoveUpDisabled=64]="contextMenuFieldWellMoveUpDisabled";R[R.contextMenuFieldWellMoveDownDisabled=
65]="contextMenuFieldWellMoveDownDisabled";R[R.contextMenuFieldWellMoveToBeginningDisabled=66]="contextMenuFieldWellMoveToBeginningDisabled";R[R.contextMenuFieldWellMoveToEndDisabled=67]="contextMenuFieldWellMoveToEndDisabled";R[R.contextMenuFieldWellMoveToReportFilter=68]="contextMenuFieldWellMoveToReportFilter";R[R.contextMenuFieldWellMoveToRowLabels=69]="contextMenuFieldWellMoveToRowLabels";R[R.contextMenuFieldWellMoveToColumnLabels=70]="contextMenuFieldWellMoveToColumnLabels";R[R.contextMenuFieldWellMoveToValues=
71]="contextMenuFieldWellMoveToValues";R[R.contextMenuFieldWellMoveToReportFilterDisabled=72]="contextMenuFieldWellMoveToReportFilterDisabled";R[R.contextMenuFieldWellMoveToRowLabelsDisabled=73]="contextMenuFieldWellMoveToRowLabelsDisabled";R[R.contextMenuFieldWellMoveToColumnLabelsDisabled=74]="contextMenuFieldWellMoveToColumnLabelsDisabled";R[R.contextMenuFieldWellMoveToValuesDisabled=75]="contextMenuFieldWellMoveToValuesDisabled";R[R.contextMenuFieldWellRemoveField=76]="contextMenuFieldWellRemoveField";
R[R.contextMenuFieldWellValueFieldSettings=77]="contextMenuFieldWellValueFieldSettings";R[R.contextMenuFieldListAddAsSlicer=78]="contextMenuFieldListAddAsSlicer";R[R.contextMenuFieldListMoveToReportFilter=79]="contextMenuFieldListMoveToReportFilter";R[R.contextMenuFieldListMoveToRowLabels=80]="contextMenuFieldListMoveToRowLabels";R[R.contextMenuFieldListMoveToColumnsLabels=81]="contextMenuFieldListMoveToColumnsLabels";R[R.contextMenuFieldListMoveToValues=82]="contextMenuFieldListMoveToValues";R[R.contextMenuFieldListMoveToReportFilterDisabled=
83]="contextMenuFieldListMoveToReportFilterDisabled";R[R.contextMenuFieldListMoveToRowLabelsDisabled=84]="contextMenuFieldListMoveToRowLabelsDisabled";R[R.contextMenuFieldListMoveToColumnsLabelsDisabled=85]="contextMenuFieldListMoveToColumnsLabelsDisabled";R[R.contextMenuFieldListMoveToValuesDisabled=86]="contextMenuFieldListMoveToValuesDisabled";R[R.timeSlicerLevelYear=87]="timeSlicerLevelYear";R[R.timeSlicerLevelQuarter=88]="timeSlicerLevelQuarter";R[R.timeSlicerLevelMonth=89]="timeSlicerLevelMonth";
R[R.timeSlicerLevelDay=90]="timeSlicerLevelDay";R[R.contextMenuFieldListMoveToRowChartLabels=91]="contextMenuFieldListMoveToRowChartLabels";R[R.contextMenuFieldListMoveToColumnsChartLabels=92]="contextMenuFieldListMoveToColumnsChartLabels";R[R.contextMenuFieldListMoveToRowChartLabelsDisabled=93]="contextMenuFieldListMoveToRowChartLabelsDisabled";R[R.contextMenuFieldListMoveToColumnsChartLabelsDisabled=94]="contextMenuFieldListMoveToColumnsChartLabelsDisabled";R[R.contextMenuFieldWellMoveToRowChartLabels=
95]="contextMenuFieldWellMoveToRowChartLabels";R[R.contextMenuFieldWellMoveToColumnChartLabels=96]="contextMenuFieldWellMoveToColumnChartLabels";R[R.contextMenuFieldWellMoveToRowChartLabelsDisabled=97]="contextMenuFieldWellMoveToRowChartLabelsDisabled";R[R.contextMenuFieldWellMoveToColumnChartLabelsDisabled=98]="contextMenuFieldWellMoveToColumnChartLabelsDisabled";R[R.contextMenuBIExploreShowCallout=99]="contextMenuBIExploreShowCallout";R[R.contextMenuRefresh=100]="contextMenuRefresh";R[R.contextMenuDeleteChart=
101]="contextMenuDeleteChart";R[R.contextMenuEditCell=102]="contextMenuEditCell";R[R.insertForm=103]="insertForm";R[R.editForm=104]="editForm";R[R.deleteForm=105]="deleteForm";R[R.shareForm=106]="shareForm";R[R.viewForm=107]="viewForm";R[R.contextMenuHideRows=108]="contextMenuHideRows";R[R.contextMenuHideColumns=109]="contextMenuHideColumns";R[R.contextMenuUnhideRows=110]="contextMenuUnhideRows";R[R.contextMenuUnhideColumns=111]="contextMenuUnhideColumns";R[R.contextMenuHideSheet=112]="contextMenuHideSheet";
R[R.contextMenuUnhideSheet=113]="contextMenuUnhideSheet";R[R.contextMenuHideSheetDisabled=114]="contextMenuHideSheetDisabled";R[R.contextMenuUnhideSheetDisabled=115]="contextMenuUnhideSheetDisabled";R[R.contextMenuInsertRowsDisabled=116]="contextMenuInsertRowsDisabled";R[R.contextMenuInsertColumnsDisabled=117]="contextMenuInsertColumnsDisabled";R[R.contextMenuDeleteRowsDisabled=118]="contextMenuDeleteRowsDisabled";R[R.contextMenuDeleteColumnsDisabled=119]="contextMenuDeleteColumnsDisabled";R[R.contextMenuHyperlinkDisabled=
120]="contextMenuHyperlinkDisabled";R[R.contextMenuHyperlinksDisabled=121]="contextMenuHyperlinksDisabled";R[R.contextMenuRemoveHyperlinkDisabled=122]="contextMenuRemoveHyperlinkDisabled";R[R.contextMenuRemoveHyperlinksDisabled=123]="contextMenuRemoveHyperlinksDisabled";R[R.contextMenuOpenHyperlinkDisabled=124]="contextMenuOpenHyperlinkDisabled";R[R.contextMenuReorderSheet=125]="contextMenuReorderSheet";R[R.contextMenuReorderSheetDisabled=126]="contextMenuReorderSheetDisabled";R[R.contextMenuDeleteSheetDisabled=
127]="contextMenuDeleteSheetDisabled";R[R.chartOutlineWeight1pt=128]="chartOutlineWeight1pt";R[R.chartOutlineWeight2pt=129]="chartOutlineWeight2pt";R[R.chartOutlineWeight3pt=130]="chartOutlineWeight3pt";R[R.chartOutlineWeight4pt=131]="chartOutlineWeight4pt";R[R.chartOutlineDashesSolid=132]="chartOutlineDashesSolid";R[R.chartOutlineDashesSquareDot=133]="chartOutlineDashesSquareDot";R[R.chartOutlineDashesDash=134]="chartOutlineDashesDash";R[R.contextMenuNumberFormating=135]="contextMenuNumberFormating";
R[R.pivotTableValueFieldContextMenuNumberFormating=136]="pivotTableValueFieldContextMenuNumberFormating";R[R.accountingFormat=137]="accountingFormat";R[R.dataLabelsAboveBoxWhisker=138]="dataLabelsAboveBoxWhisker";R[R.dataLabelsBelowBoxWhisker=139]="dataLabelsBelowBoxWhisker";R[R.dataLabelsLeftBoxWhisker=140]="dataLabelsLeftBoxWhisker";R[R.dataLabelsNoneBoxWhisker=141]="dataLabelsNoneBoxWhisker";R[R.dataLabelsRightBoxWhisker=142]="dataLabelsRightBoxWhisker";R[R.dataLabelsShowFunnel=143]="dataLabelsShowFunnel";
R[R.dataLabelsShowTreemap=144]="dataLabelsShowTreemap";R[R.dataLabelsShowSunburst=145]="dataLabelsShowSunburst";R[R.contextMenuEditAltText=146]="contextMenuEditAltText";R[R.contextMenuEditText=147]="contextMenuEditText";R[R.contextMenuClearContent=148]="contextMenuClearContent";R[R.contextMenuClearContentDisabled=149]="contextMenuClearContentDisabled";R[R.contextMenuRowHeight=150]="contextMenuRowHeight";R[R.contextMenuRowHeightDisabled=151]="contextMenuRowHeightDisabled";R[R.contextMenuColumnWidth=
152]="contextMenuColumnWidth";R[R.contextMenuColumnWidthDisabled=153]="contextMenuColumnWidthDisabled";R[R.contextMenuHideRowsDisabled=154]="contextMenuHideRowsDisabled";R[R.contextMenuHideColumnsDisabled=155]="contextMenuHideColumnsDisabled";R[R.contextMenuUnhideRowsDisabled=156]="contextMenuUnhideRowsDisabled";R[R.contextMenuUnhideColumnsDisabled=157]="contextMenuUnhideColumnsDisabled";R[R.contextMenuDuplicateSheet=158]="contextMenuDuplicateSheet";R[R.contextMenuInsertReply=159]="contextMenuInsertReply";
R[R.contextMenuInsertThreadedComment=160]="contextMenuInsertThreadedComment";R[R.contextMenuInsertRowsTable=161]="contextMenuInsertRowsTable";R[R.contextMenuInsertColumnsTable=162]="contextMenuInsertColumnsTable";R[R.contextMenuDeleteRowsTable=163]="contextMenuDeleteRowsTable";R[R.contextMenuDeleteColumnsTable=164]="contextMenuDeleteColumnsTable";R[R.contextMenuInsertCellsShiftRight=165]="contextMenuInsertCellsShiftRight";R[R.contextMenuInsertCellsShiftDown=166]="contextMenuInsertCellsShiftDown";
R[R.contextMenuDeleteCellsShiftLeft=167]="contextMenuDeleteCellsShiftLeft";R[R.contextMenuDeleteCellsShiftUp=168]="contextMenuDeleteCellsShiftUp";R[R.contextMenuInsertRowsTableDisabled=169]="contextMenuInsertRowsTableDisabled";R[R.contextMenuInsertColumnsTableDisabled=170]="contextMenuInsertColumnsTableDisabled";R[R.contextMenuDeleteRowsTableDisabled=171]="contextMenuDeleteRowsTableDisabled";R[R.contextMenuDeleteColumnsTableDisabled=172]="contextMenuDeleteColumnsTableDisabled";R[R.contextMenuInsertCellsShiftRightDisabled=
173]="contextMenuInsertCellsShiftRightDisabled";R[R.contextMenuInsertCellsShiftDownDisabled=174]="contextMenuInsertCellsShiftDownDisabled";R[R.contextMenuDeleteCellsShiftLeftDisabled=175]="contextMenuDeleteCellsShiftLeftDisabled";R[R.contextMenuDeleteCellsShiftUpDisabled=176]="contextMenuDeleteCellsShiftUpDisabled";R[R.contextMenuInsertRowsSheet=177]="contextMenuInsertRowsSheet";R[R.contextMenuInsertColumnsSheet=178]="contextMenuInsertColumnsSheet";R[R.contextMenuDeleteRowsSheet=179]="contextMenuDeleteRowsSheet";
R[R.contextMenuDeleteColumnsSheet=180]="contextMenuDeleteColumnsSheet";R[R.contextMenuInsertRowsSheetDisabled=181]="contextMenuInsertRowsSheetDisabled";R[R.contextMenuInsertColumnsSheetDisabled=182]="contextMenuInsertColumnsSheetDisabled";R[R.contextMenuDeleteRowsSheetDisabled=183]="contextMenuDeleteRowsSheetDisabled";R[R.contextMenuDeleteColumnsSheetDisabled=184]="contextMenuDeleteColumnsSheetDisabled";R[R.contextMenuOpenImmersiveReader=185]="contextMenuOpenImmersiveReader";R[R.contextMenuExitEditText=
186]="contextMenuExitEditText";R[R.contextMenuInsertCellsShiftLeft=187]="contextMenuInsertCellsShiftLeft";R[R.contextMenuInsertCellsShiftLeftDisabled=188]="contextMenuInsertCellsShiftLeftDisabled";R[R.contextMenuDeleteCellsShiftRight=189]="contextMenuDeleteCellsShiftRight";R[R.contextMenuDeleteCellsShiftRightDisabled=190]="contextMenuDeleteCellsShiftRightDisabled";R[R.contextMenuInsertColumnsTableToTheRight=191]="contextMenuInsertColumnsTableToTheRight";R[R.contextMenuInsertColumnsTableToTheRightDisabled=
192]="contextMenuInsertColumnsTableToTheRightDisabled";R[R.shapeOutlineWeightQuarterPt=193]="shapeOutlineWeightQuarterPt";R[R.shapeOutlineWeightHalfPt=194]="shapeOutlineWeightHalfPt";R[R.shapeOutlineWeightThreeQuartersPt=195]="shapeOutlineWeightThreeQuartersPt";R[R.shapeOutlineWeight1pt=196]="shapeOutlineWeight1pt";R[R.shapeOutlineWeight1AndHalfPt=197]="shapeOutlineWeight1AndHalfPt";R[R.shapeOutlineWeight2pt=198]="shapeOutlineWeight2pt";R[R.shapeOutlineWeight2AndQuarterPt=199]="shapeOutlineWeight2AndQuarterPt";
R[R.shapeOutlineWeight3pt=200]="shapeOutlineWeight3pt";R[R.shapeOutlineWeight4pt=201]="shapeOutlineWeight4pt";R[R.shapeOutlineWeight4AndHalfpt=202]="shapeOutlineWeight4AndHalfpt";R[R.shapeOutlineWeight6pt=203]="shapeOutlineWeight6pt";R[R.shapeOutlineDashesSolid=204]="shapeOutlineDashesSolid";R[R.shapeOutlineDashesRoundedDot=205]="shapeOutlineDashesRoundedDot";R[R.shapeOutlineDashesSquareDot=206]="shapeOutlineDashesSquareDot";R[R.shapeOutlineDashesDash=207]="shapeOutlineDashesDash";R[R.shapeOutlineDashesDashDot=
208]="shapeOutlineDashesDashDot";R[R.shapeOutlineDashesLongDash=209]="shapeOutlineDashesLongDash";R[R.shapeOutlineDashesLongDashDot=210]="shapeOutlineDashesLongDashDot";R[R.shapeOutlineDashesLongDashDotDot=211]="shapeOutlineDashesLongDashDotDot";R[R.contextMenuInsertCopiedCells=212]="contextMenuInsertCopiedCells";R[R.contextMenuInsertCutCells=213]="contextMenuInsertCutCells";R[R.convertToLinkedEntity=214]="convertToLinkedEntity";R[R.contextMenuConvertLinkedEntityToText=215]="contextMenuConvertLinkedEntityToText";
R[R.contextMenuShowCard=216]="contextMenuShowCard";R[R.contextMenuShowImageDetails=217]="contextMenuShowImageDetails";R[R.contextMenuRefreshLinkedEntities=218]="contextMenuRefreshLinkedEntities";R[R.contextMenuLinkedEntityChangeObject=219]="contextMenuLinkedEntityChangeObject";R[R.contextMenuShowLinkedEntityRefreshPane=220]="contextMenuShowLinkedEntityRefreshPane";R[R.contextMenuDeleteThreadedComment=221]="contextMenuDeleteThreadedComment";R[R.nameBox=222]="nameBox";R[R.contextMenuSortAscending=223]=
"contextMenuSortAscending";R[R.contextMenuSortDescending=224]="contextMenuSortDescending";R[R.contextMenuSortCustom=225]="contextMenuSortCustom";R[R.contextMenuNewNote=226]="contextMenuNewNote";R[R.contextMenuEditNote=227]="contextMenuEditNote";R[R.contextMenuDeleteNote=228]="contextMenuDeleteNote";R[R.contextMenuShowOrHideNote=229]="contextMenuShowOrHideNote";R[R.contextMenuConvertNote=230]="contextMenuConvertNote";R[R.namedSheetView=231]="namedSheetView";R[R.contextMenuConvertToRange=232]="contextMenuConvertToRange";
R[R.contextMenuFilterByCellValue=233]="contextMenuFilterByCellValue";R[R.contextMenuFilterClear=234]="contextMenuFilterClear";R[R.contextMenuFilterReapply=235]="contextMenuFilterReapply";R[R.contextMenuIdeasAskAndAnalyze=236]="contextMenuIdeasAskAndAnalyze";R[R.contextMenuIdeasAskMyData=237]="contextMenuIdeasAskMyData";R[R.contextMenuIdeasAnalyzeData=238]="contextMenuIdeasAnalyzeData";R[R.contextMenuIgnoreError=239]="contextMenuIgnoreError";R[R.contextMenuIgnoreErrors=240]="contextMenuIgnoreErrors";
R[R.contextMenuShowError=241]="contextMenuShowError";R[R.contextMenuPivotExpandCollapse=242]="contextMenuPivotExpandCollapse";R[R.contextMenuPivotExpand=243]="contextMenuPivotExpand";R[R.contextMenuPivotCollapse=244]="contextMenuPivotCollapse";R[R.contextMenuPivotExpandEntireField=245]="contextMenuPivotExpandEntireField";R[R.contextMenuPivotCollapseEntireField=246]="contextMenuPivotCollapseEntireField";R[R.contextMenuPivotShowDetails=247]="contextMenuPivotShowDetails";R[R.contextMenuPasteAdvancedOptionsGallery=
248]="contextMenuPasteAdvancedOptionsGallery";R[R.chartTaskPane=249]="chartTaskPane";R[R.contextMenuSmartLookup=250]="contextMenuSmartLookup";R[R.contextMenuSlicerRefresh=251]="contextMenuSlicerRefresh";R[R.contextMenuSlicerClearFilter=252]="contextMenuSlicerClearFilter";R[R.contextMenuSlicerMultiSelect=253]="contextMenuSlicerMultiSelect";R[R.contextMenuSlicerDelete=254]="contextMenuSlicerDelete";R[R.contextMenuSlicerSortAscending=255]="contextMenuSlicerSortAscending";R[R.contextMenuSlicerSortDescending=
256]="contextMenuSlicerSortDescending";R[R.contextMenuPivotSettingsPaneHide=257]="contextMenuPivotSettingsPaneHide";R[R.contextMenuPivotSettingsPaneShow=258]="contextMenuPivotSettingsPaneShow";R[R.contextMenuPivotNoSubtotal=259]="contextMenuPivotNoSubtotal";R[R.contextMenuPivotSubtotalOnTop=260]="contextMenuPivotSubtotalOnTop";R[R.contextMenuPivotSubtotalOnBottom=261]="contextMenuPivotSubtotalOnBottom";R[R.gridContextMenuShowChanges=262]="gridContextMenuShowChanges";R[R.sheetOpsContextMenuShowChanges=
263]="sheetOpsContextMenuShowChanges";R[R.zoomFitToScreen=264]="zoomFitToScreen";R[R.zoomFitToScreenUndo=265]="zoomFitToScreenUndo";R[R.contextMenuSlicerSettingsPaneHide=266]="contextMenuSlicerSettingsPaneHide";R[R.contextMenuSlicerSettingsPaneShow=267]="contextMenuSlicerSettingsPaneShow";R[R.contextMenuConvertLinkedEntityToTextDisabled=268]="contextMenuConvertLinkedEntityToTextDisabled";R[R.contextMenuRefreshLinkedEntitiesDisabled=269]="contextMenuRefreshLinkedEntitiesDisabled";R[R.contextMenuLinkedEntityChangeObjectDisabled=
270]="contextMenuLinkedEntityChangeObjectDisabled";R[R.contextMenuShowLinkedEntityRefreshPaneDisabled=271]="contextMenuShowLinkedEntityRefreshPaneDisabled";R[R.contextMenuShowOpenInAppDialogOnMobile=272]="contextMenuShowOpenInAppDialogOnMobile";R[R.contextMenuViewScript=273]="contextMenuViewScript";R[R.contextMenuShareChart=274]="contextMenuShareChart";R[R.contextMenuShareRange=275]="contextMenuShareRange";R[R.contextMenuShareTable=276]="contextMenuShareTable";R[R.contextMenuManageProtection=277]=
"contextMenuManageProtection";R[R.contextMenuPauseProtection=278]="contextMenuPauseProtection";R[R.contextMenuResumeProtection=279]="contextMenuResumeProtection";R[R.functionMenu=280]="functionMenu";R[R.contextMenuBringForward=281]="contextMenuBringForward";R[R.contextMenuBringToFront=282]="contextMenuBringToFront";R[R.contextMenuSendBackWard=283]="contextMenuSendBackWard";R[R.contextMenuSendToBack=284]="contextMenuSendToBack";R[R.contextMenuToggleTotalRow=285]="contextMenuToggleTotalRow";R[R.contextMenuTableAltText=
286]="contextMenuTableAltText";R[R.chartTaskPaneData=287]="chartTaskPaneData";R[R.contextMenuInsertColumnsToTheRight=288]="contextMenuInsertColumnsToTheRight";R[R.contextMenuInsertColumnsToTheRightDisabled=289]="contextMenuInsertColumnsToTheRightDisabled";R[R.contextMenuInsertColumnsSheetToTheRight=290]="contextMenuInsertColumnsSheetToTheRight";R[R.contextMenuInsertColumnsSheetToTheRightDisabled=291]="contextMenuInsertColumnsSheetToTheRightDisabled";R[R.contextMenuPutSelectedCellColorOnTop=292]="contextMenuPutSelectedCellColorOnTop";
R[R.contextMenuPutSelectedFontColorOnTop=293]="contextMenuPutSelectedFontColorOnTop";R[R.contextMenuPutSelectedFormattingIconOnTop=294]="contextMenuPutSelectedFormattingIconOnTop";R[R.contextMenuShareSheet=299]="contextMenuShareSheet";R[R.contextMenuFormatCells=300]="contextMenuFormatCells";R[R.contextMenuPivotTableDelete=301]="contextMenuPivotTableDelete";R[R.contextMenuEditCellImageAltText=302]="contextMenuEditCellImageAltText";R[R.contextMenuPlaceInCell=303]="contextMenuPlaceInCell";R[R.contextMenuPlaceOverCell=
304]="contextMenuPlaceOverCell";R[R.contextMenuCreateReference=305]="contextMenuCreateReference";R[R.contextMenuPivotTableManualUngroup=306]="contextMenuPivotTableManualUngroup";R[R.contextMenuPivotTableManualGroup=307]="contextMenuPivotTableManualGroup";R[R.contextMenuDeleteChartElement=308]="contextMenuDeleteChartElement";R[R.gridContextMenuShareSheet=309]="gridContextMenuShareSheet";R[R.gridContextMenuShareRange=310]="gridContextMenuShareRange";R[R.gridContextMenuShareTable=311]="gridContextMenuShareTable";
R[R.contextMenuCopyLinkToSheet=312]="contextMenuCopyLinkToSheet";R[R.contextMenuFilterByCellColor=313]="contextMenuFilterByCellColor";R[R.contextMenuFilterByCellFontColor=314]="contextMenuFilterByCellFontColor";R[R.contextMenuFilterByCellIcon=315]="contextMenuFilterByCellIcon";R[R.contextMenuNamedSheetView=316]="contextMenuNamedSheetView";R[R.contextMenuShareNamedSheetView=317]="contextMenuShareNamedSheetView";R[R.contextMenuShareNamedSheetViewDisabled=318]="contextMenuShareNamedSheetViewDisabled";
R[R.contextMenuExitNamedSheetView=319]="contextMenuExitNamedSheetView";R[R.contextMenuSaveNamedSheetView=320]="contextMenuSaveNamedSheetView";R[R.contextMenuAddDataLabels=321]="contextMenuAddDataLabels";R[R.contextMenuAddTrendline=322]="contextMenuAddTrendline";R[R.contextMenuAddTrendlineTitle=323]="contextMenuAddTrendlineTitle";R[R.contextMenuAddAxisTitle=324]="contextMenuAddAxisTitle";R[R.contextMenuAddMajorGridlines=325]="contextMenuAddMajorGridlines";R[R.contextMenuAddMinorGridlines=326]="contextMenuAddMinorGridlines";
R[R.contextMenuCopyHyperlink=330]="contextMenuCopyHyperlink";R[R.contextMenuShowLinkPreview=331]="contextMenuShowLinkPreview";R[R.contextMenuFieldListAddAsTimeline=332]="contextMenuFieldListAddAsTimeline";R[R.contextMenuFieldListAddAsTimelineDisabled=333]="contextMenuFieldListAddAsTimelineDisabled";R[R.contextMenuInsertColumnsSheetToTheLeft=334]="contextMenuInsertColumnsSheetToTheLeft";R[R.contextMenuInsertColumnsSheetToTheLeftDisabled=335]="contextMenuInsertColumnsSheetToTheLeftDisabled";R[R.contextMenuInsertColumnsToTheLeft=
336]="contextMenuInsertColumnsToTheLeft";R[R.contextMenuInsertColumnsToTheLeftDisabled=337]="contextMenuInsertColumnsToTheLeftDisabled";R[R.contextMenuFullSheetCopy=338]="contextMenuFullSheetCopy";R[R.contextMenuFullSheetCopyDisabled=339]="contextMenuFullSheetCopyDisabled";R[R.contextMenuFullSheetPaste=340]="contextMenuFullSheetPaste";R[R.contextMenuFullSheetPasteDisabled=341]="contextMenuFullSheetPasteDisabled";R[R.contextMenuEditTextChartTitle=342]="contextMenuEditTextChartTitle";R[R.contextMenuEditTextAxisTitleHorizontal=
343]="contextMenuEditTextAxisTitleHorizontal";R[R.contextMenuEditTextAxisTitleVertical=344]="contextMenuEditTextAxisTitleVertical";R[R.contextMenuTimeSlicerClearFilter=345]="contextMenuTimeSlicerClearFilter";R[R.contextMenuAddErrorBarX=350]="contextMenuAddErrorBarX";R[R.contextMenuAddErrorBarY=351]="contextMenuAddErrorBarY";R[R.contextMenuAddErrorBarHz=352]="contextMenuAddErrorBarHz";R[R.contextMenuAddErrorBarVt=353]="contextMenuAddErrorBarVt";R[R.contextMenuPasteValues=354]="contextMenuPasteValues";
R[R.contextMenuPasteFormulas=355]="contextMenuPasteFormulas";R[R.contextMenuPasteFormatting=356]="contextMenuPasteFormatting";R[R.contextMenuPasteLink=357]="contextMenuPasteLink";R[R.contextMenuPasteWithColumnWidths=358]="contextMenuPasteWithColumnWidths";R[R.contextMenuPasteTranspose=359]="contextMenuPasteTranspose";R[R.contextMenuAppendSheet=360]="contextMenuAppendSheet";R[R.contextMenuOpenFormatCellsNumberFormatTaskPane=361]="contextMenuOpenFormatCellsNumberFormatTaskPane";R[R.contextMenuOpenFormatCellsFontTaskPane=
362]="contextMenuOpenFormatCellsFontTaskPane";R[R.contextMenuInsertRowsAfterSheet=363]="contextMenuInsertRowsAfterSheet";R[R.contextMenuInsertRowsAfterSheetDisabled=364]="contextMenuInsertRowsAfterSheetDisabled";R[R.contextMenuInsertRowsAfter=365]="contextMenuInsertRowsAfter";R[R.contextMenuInsertRowsAfterDisabled=366]="contextMenuInsertRowsAfterDisabled";R[R.contextMenuInsertColumnsAfterToTheRight=367]="contextMenuInsertColumnsAfterToTheRight";R[R.contextMenuInsertColumnsAfterToTheRightDisabled=
368]="contextMenuInsertColumnsAfterToTheRightDisabled";R[R.contextMenuInsertColumnsAfterToTheLeft=369]="contextMenuInsertColumnsAfterToTheLeft";R[R.contextMenuInsertColumnsAfterToTheLeftDisabled=370]="contextMenuInsertColumnsAfterToTheLeftDisabled";R[R.contextMenuInsertColumnsAfterSheetToTheLeft=371]="contextMenuInsertColumnsAfterSheetToTheLeft";R[R.contextMenuInsertColumnsAfterSheetToTheLeftDisabled=372]="contextMenuInsertColumnsAfterSheetToTheLeftDisabled";R[R.contextMenuInsertColumnsAfterSheetToTheRight=
373]="contextMenuInsertColumnsAfterSheetToTheRight";R[R.contextMenuInsertColumnsAfterSheetToTheRightDisabled=374]="contextMenuInsertColumnsAfterSheetToTheRightDisabled";R[R.contextMenuAutoToggleFilter=375]="contextMenuAutoToggleFilter";R[R.contextMenuRemoveAutoToggleFilter=376]="contextMenuRemoveAutoToggleFilter";R[R.contextMenuAutoFitColumnWidth=377]="contextMenuAutoFitColumnWidth";R[R.contextMenuAutoFitColumnWidthDisabled=378]="contextMenuAutoFitColumnWidthDisabled";R[R.contextMenuAutoFitRowHeight=
379]="contextMenuAutoFitRowHeight";R[R.contextMenuAutoFitRowHeightDisabled=380]="contextMenuAutoFitRowHeightDisabled";R[R.contextMenuPreviewChartHelp=381]="contextMenuPreviewChartHelp";R[R.contextMenuMoveChart=382]="contextMenuMoveChart";R[R.contextMenuCopilotShowDataInsights=383]="contextMenuCopilotShowDataInsights";R[R.contextMenuCopilotSuggestFormulaColumn=384]="contextMenuCopilotSuggestFormulaColumn";R[R.contextMenuAskCopilot=385]="contextMenuAskCopilot";R[R.contextMenuCopilotNonTable=386]="contextMenuCopilotNonTable"})(pd||
(pd={}));Object(J.b)("RibbonButtonType",pd);var Kb;const rb=Za.a.a3h;let rc=Kb=class extends fe{constructor(R,cb,zb,V,Ea){super(R,cb,zb,V,Ea,"PopulateChartContextMenu",-498523270,1640762262,rb);this.isPivotChart=this.refresh=this.MX=this.Uja=this.tfa=!1}get Sx(){return"PopulateChartContextMenu"}get tB(){return Za.a.GCg}executeCommand(R,cb,zb){var V=this.$;this.Yb=cb.method;cb=zb[Kb.xpc];if(!(R&68)){if(!cb){if(8===R)cb=ed.a(V).Zc;else{var Ea=ta.f(V).ha.ob.Wb;if(null===Ea||void 0===Ea?0:Ea.floatingObject)cb=
Ea.floatingObject.Zc}if(!cb)return $b.Task.Va(!0)}this.isPivotChart=!!(cb.Attributes&4)}if(this.isPivotChart||V.isEditMode)if(this.refresh=this.MX=this.Uja=this.tfa=!1,Ea=ta.f(this.$).ha.ob.Wb,O.ULS.shipAssertTag(537167107,0,!!Ea),Ea){this.floatingObject=Ea.floatingObject;Ea=kc.a.Cb(na.FieldManagerPaneService);if(null===Ea||void 0===Ea?0:Ea.zre)this.tfa=Ea=Tc.g(V.Pf),this.Uja=!Ea;V=V.$b;this.MX=!!cb&&!!(cb.Attributes&512)&&!(R&8)&&V.Uaa(32768);V.allowManualDataRefresh&&V.allowInteractivity&&(this.refresh=
!0);if(de.a.LK()){R=Object(Qa.a)(ec.a,zb.eventArgs);zb=this.ZWa(R);this.Xo(zb,!0,R.Yb);R=ta.f(this.$).ha.ob.Qj?ta.f(this.$).ha.ob.Qj:"Null";zb="None";if(this.tfa||this.Uja)zb=this.tfa?"Show":"Hide";O.ULS.sendTraceTag(507311296,6,50,"ChartContextMenu.ExecuteCommand: ShowChartContextMenu - ID:{0}, elementID:{1}, isPivotChart:{2}, fieldListOption:{3}, refresh:{4}, explore:{5}",this.floatingObject.Ec,R,this.isPivotChart,zb,this.refresh,this.MX)}else R=this.ZWa(Object(Qa.a)(ec.a,zb.eventArgs)),this.Xo(R,
!0)}return $b.Task.Va(!0)}Rc(R,cb,zb){return-149612405===cb.command&&!!zb&&this.n5f(R)}Dkc(R,cb,zb){var V;if(de.a.nva())if(this.$Nb())this.KGi(R,cb),this.aGi(R,cb);else{let Ea=null;$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8435566_TurnOnObserverInfo")&&Pc.a.isObserverChart(null===(V=ta.f(this.$).ha.ob.Wb)||void 0===V?void 0:V.floatingObject)&&(Ea=R.uc(),Ea.buttons.push(R.yb(381)),$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)&&cb.Zb.push(Ea));
V=R.uc();this.bzh(R,V);$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)&&cb.Zb.push(V);$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8869209_remove3dChartFormatDataButtons")?this.Izh(R,zb):($a.EwaSettings.Ra(155)&&!this.isPivotChart&&zb.buttons.push(R.yb(287)),$a.EwaSettings.Ra(155)&&zb.buttons.push(R.yb(249)));$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)&&zb.buttons.push(R.yb(146));cb.Zb.push(zb);
this.isPivotChart&&this.NAh(R,cb);$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)||(Ea&&cb.Zb.push(Ea),cb.Zb.push(V));zb=R.uc();$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)||zb.buttons.push(R.yb(146));this.aJd(zb);this.pJd(zb);cb.Zb.push(zb)}else this.isPivotChart&&(this.refresh&&zb.buttons.push(R.yb(100)),this.MX&&zb.buttons.push(R.yb(99)),this.tfa?zb.buttons.push(R.yb(59)):this.Uja&&zb.buttons.push(R.yb(58))),
super.Dkc(R,cb,zb)}static get xpc(){return"chartMetaData"}sX(R){R=void 0===R?!1:R;if(de.a.nva()){R=this.Ya;const cb=R.pq(this.menuId);if(this.$.isEditMode){const zb=R.uc();this.Dkc(R,cb,zb)}return cb}return super.sX(R)}bzh(R,cb){var zb;this.$.isEditMode&&(cb.buttons.push(R.yb(42)),cb.buttons.push(R.yb(43)),$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8435566_TurnOnObserverChartMove")&&Pc.a.isObserverChart(null===(zb=ta.f(this.$).ha.ob.Wb)||void 0===zb?void 0:zb.floatingObject)&&cb.buttons.push(R.yb(382)))}NAh(R,
cb){const zb=R.uc();this.refresh&&zb.buttons.push(R.yb(100));this.MX&&zb.buttons.push(R.yb(99));this.tfa?zb.buttons.push(R.yb(59)):this.Uja&&zb.buttons.push(R.yb(58));cb.Zb.push(zb)}xGi(R){const cb=this.Ya.uc();cb.buttons.push(this.Ya.yb(352));cb.buttons.push(this.Ya.yb(353));const zb=this.Ya.iu("ErrorBars","ErrorBarsMenuId",xa.a.instance.ia(2367),-1777747317);zb.menu.Zb.push(cb);R.buttons.push(zb)}KGi(R,cb){const zb=R.uc();zb.buttons.push(R.yb(249));ta.f(this.$).ha.ob.Wb.u5b()&&zb.buttons.push(R.yb(308));
cb.Zb.push(zb)}aGi(R,cb){var zb=ta.f(this.$).ha.ob.Wb;const V=R.uc();if(zb){zb=zb.getContextMenuButtonList();let Ea=null;if(zb){for(const pb of zb)if(pd["contextMenu"+pb])if("AddErrorBarX"===pb)Ea=pb;else{if(Ea)if("AddErrorBarY"===pb){this.xGi(V);Ea=null;continue}else V.buttons.push(R.yb(pd["contextMenu"+Ea])),Ea=null;V.buttons.push(R.yb(pd["contextMenu"+pb]))}"AddErrorBarX"===Ea&&V.buttons.push(R.yb(pd["contextMenu"+Ea]))}cb.Zb.push(V)}}Izh(R,cb){const zb=ta.f(this.$).ha.ob.Wb;if(null===zb||void 0===
zb?0:zb.floatingObject){switch(zb.floatingObject.Zc.ChartCategory){case 4:case 6:case 8:case 14:case 10:return}$a.EwaSettings.Ra(155)&&!this.isPivotChart&&cb.buttons.push(R.yb(287));$a.EwaSettings.Ra(155)&&cb.buttons.push(R.yb(249))}}};rc=Kb=Object(L.__decorate)([Object(kc.d)(na.ChartContextMenuService),Object(L.__param)(0,Object(na.EwaControlService)()),Object(L.__param)(1,Object(na.RibbonControlsService)()),Object(L.__param)(2,Object(na.ContextMenuControllerService)()),Object(L.__param)(3,Object(na.ZoomService)())],
rc);Object(J.a)(rc,"ChartContextMenu",fe,[]);var ld=a(1658),Tb=a(107),Wc=a(114);let Ac=class{constructor(R,cb){this.Reb=cb;this.$=R}dispose(){}Via(){this.Reb.Wia()}mlb(){return this.Reb.mlb}jC(){this.Reb.jC()}Sse(R,cb,zb){wb.m(this.$,wb.b);this.Reb.showContextMenu(Object(U.a)(new ld.a,{x:cb.x,y:cb.y}),zb,R);Tb.EventHandlerManager.instance.hId()}Qub(R,cb,zb){wb.m(this.$,wb.b);this.Reb.showFloatie(Object(U.a)(new ld.a,{x:cb.x,y:cb.y}),R,zb);Wc.d(()=>{Tb.EventHandlerManager.instance.hId()},this.$.Aa)}Rse(R,
cb,zb,V){wb.m(this.$,wb.b);this.Reb.Rse(Object(U.a)(new ld.a,{x:cb.x,y:cb.y}),R,zb,V)}};Ac=Object(L.__decorate)([Object(kc.d)(na.ContextMenuControllerService),Object(L.__param)(0,Object(na.EwaControlService)()),Object(L.__param)(1,Object(na.ReactContextUILauncherService)())],Ac);Object(J.a)(Ac,"ReactContextMenuController",null,[701,4]);var nd=a(194);class qd{constructor(){this.XP=this.fc=null}}Object(J.a)(qd,"RibbonCommandParams",null,[]);class Xd{constructor(){this.menuModel=null;this.Obi=0}}Object(J.a)(Xd,
"HeaderSnappedAutoFilterMenuCacheEntry",null,[]);class Hd{constructor(){this.DRd={}}sLi(R){return(R=this.DRd[R.toString()])?R.menuModel:null}XSh(R,cb){this.DRd[cb.toString()]=Object(U.a)(new Xd,{menuModel:R,Obi:ic.HelperMethods.Lb()})}Euc(R){this.DRd[R.toString()]=null}}Object(J.a)(Hd,"FilterMenuCache",null,[]);class Zc{constructor(){this.IYb=new Hd}dispose(){}ESi(R){return this.IYb.sLi(R.left)}U_j(R,cb,zb){this.IYb&&this.IYb.XSh(R.I9e[cb].Menu,zb)}V_j(R){this.IYb&&this.IYb.Euc(R)}}Object(J.a)(Zc,
"FilterMenuManager",null,[732]);var Jc=a(81),gc=a(167),dd=a(152),Bb=a(45);Object(kc.b)(na.ContextMenuManagerService,{we:"singleton"})(async R=>{const cb=await kc.a.resolve(na.EwaControlService,{xa:R.xa});var zb=cb.$b;if(zb.allowSelection||zb.allowEdits||zb.allowFiltering||zb.allowSorting||zb.allowPivotSpecificOperations){zb=await kc.a.resolve(na.ContextMenuControllerService,{xa:R.xa});if($a.EwaSettings.iFc()){var V=[na.AutoFilterContextMenuService,na.ChartContextMenuService,na.FieldListContextMenuService,
na.FieldListPivotContextMenuService,na.FieldWellContextMenuService,na.FloatingObjectContextMenuService,na.GridContextMenuService,na.PivotFilterContextMenuService,na.SheetOpsContextMenuService,na.TimeSlicerLevelMenuService,na.TimeSlicerContextMenuService,na.PulloutFieldListContextMenuService,na.AutoFilterFieldListContextMenuService,na.PivotTableContextMenuService,na.SlicerContextMenuService,na.RichTextContextMenuService];$a.EwaSettings.oVb()&&V.push(na.PivotPageFilterContextMenuService);$a.EwaSettings.nVb()&&
V.push(na.PivotDropDownContextMenuService);V=await Promise.all(V.map(Ea=>kc.a.resolve(Ea,R)));V.forEach(Ea=>{cb.Ia.Bc.Srb(cb,Ea)})}else V=await Object(Cc.e)(Jc.GetServiceTaskFactory.create(cb.ra,10,cb.Aa,R.xa));return new pc(cb,V,zb)}O.ULS.sendTraceTag(507601880,0,15,"No client permissions to allow creating ConetxtMenuManager. Returning null.");return null});class pc{constructor(R,cb,zb){this.T7b={};this.Xd=!1;this.Jj=(V,Ea)=>{this.showContextMenu(void 0===Ea?null:Ea)};this.clg=(V,Ea)=>{Ea.ELj===
pc.n6i&&ta.f(this.$).focus()};this.hO=(V,Ea)=>{V=this.$.Ia.Aca(Ea.fc.command);(null===V||void 0===V?0:V.dismissesContextualUI)&&this.Wia()};this.vv=()=>{kc.a.remove(na.ContextMenuControllerService);$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",!1)?void kc.a.resolve(na.ContextMenuControllerService,{xa:3}).then(V=>{for(const Ea of this.T7b)Ea.ahe(V)}):db.TaskExtensions.tb(Object(Cc.d)(kc.a.resolve(na.ContextMenuControllerService,{xa:3})),V=>{V=V.result;for(const Ea of this.T7b)Ea.ahe(V)},
this.$.Aa)};this.$=R;this.DF=zb;this.ZLe=new Zc;for(zb=0;zb<cb.length;zb++)this.T7b[pc.p3h[zb]]=cb[zb];this.ha=ta.f(R).ha;this.ha.AFb(this.Jj);this.$.Ia.GFb(this.clg);nd.a.instance.PMk();$a.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ia.Qbb(this.hO);$a.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.fa.CD(this.vv)}get fxc(){return this.ZLe}CKd(R){return mb.a.Od(this.T7b,R)}dispose(){this.Xd?
O.ULS.sendTraceTag(537167062,1,50,"ContextMenuManager.Dispose: Dispose has been called more than once"):(this.Xd=!0,this.$&&(kc.a.remove(na.ContextMenuManagerService),this.ha&&this.ha.s3b(this.Jj),this.$.Ia.x3b(this.clg),this.$.Ia&&this.$.Ia.b4a(this.hO),$a.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.fa.xB(this.vv)),this.$=this.ha=null,this.fxc.dispose(),this.T7b=this.ZLe=null)}showContextMenu(R,cb,zb){cb=void 0===cb?null:cb;zb=void 0===zb?null:
zb;this.LSk(R)&&($a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)&&$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9DispatchOptimizationEnabled",!1)&&(null===R||void 0===R?void 0:R.Ha.preventDefault()),$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8690935_CMServiceInitMarkerEnabled")&&R&&performance.mark(wb.d,{startTime:R.Ha.rawEvent.timeStamp}),wb.m(this.$,wb.n),cb=this.M6h(R,cb,zb),R&&R.l$&&(zb=[],R.l$.showFloatie&&zb.push("floatie"),
1441131127===cb.fc.command&&(zb.push("context-menu"),void 0===R.l$.eventName&&(R.l$.eventName="grid_context_menu")),671488277===cb.fc.command&&(zb.push("context-menu"),R.l$.eventName="context_menu_pivot_table"),0<zb.length&&se.b(this.$).kq(R.l$.event,R.l$.eventName,null,zb)),this.$.Ia.Gb(cb.fc,cb.XP))}Wia(){this.DF?this.DF.Via():O.ULS.sendTraceTag(537167061,1,10,"ContextMenuManager.DismissContextualUI: Context menu controller is null.")}LSk(R){return Bb.a(this.$).ks()?(O.ULS.sendTraceTag(537167060,
1,50,"ContextMenuManager.OnContextMenu: Ignoring ContextMenu event because it is not allowed in partial interactivity mode"),Bb.a(this.$).NI(dd.a.grid,gc.a.showContextMenu),!1):!this.$.Ia.oyi&&(!R||R.sc!==ta.f(this.$).domElement&&!$c.a.equals(R.sc.tagName,"INPUT",!0))}M6h(R,cb,zb){cb=void 0===cb?null:cb;zb={["eventArgs"]:R,["creationParams"]:void 0===zb?null:zb};R=R?R.Yb:-1;const V=this.ha.ob.Wb;let Ea=1441131127;V?(cb=V.floatingObject,O.ULS.shipAssertTag(537167059,0,!!cb,"floatingObj shouldn't be null."),
de.a.nva()?(Ea=pc.gRi(cb),-149612405===Ea&&(zb[rc.xpc]=cb?cb.Zc:null)):pc.YVb(cb)?Ea=cb.u4.IsTimeline?205863562:1312363469:pc.isPivotChart(cb)?(zb[rc.xpc]=cb?cb.Zc:null,Ea=-149612405):Ea=-1372040782):pc.j3f(cb)?(zb[rc.xpc]=cb,Ea=-149612405):!wb.l(this.$)&&wb.k(ta.f(this.$))&&(Ea=671488277);cb=new da.a(Ea,R,this.$.xc,30,null);return Object(U.a)(new qd,{fc:cb,XP:zb})}static isPivotChart(R){return!!R&&0===R.type&&pc.j3f(R.Zc)}static znj(R){return $a.EwaSettings.isChangeGateEnabled("OfficeVSO:8877832_ChartContextMenuError")?
R&&0===R.type&&null!==R.Zc:!!R&&0===R.type&&pc.xnj(R.Zc)}static YVb(R){return!!R&&2===R.type}static j3f(R){return!!R&&!!(R.Attributes&4)}static xnj(R){return!!R&&!!R.Attributes}static gRi(R){return pc.YVb(R)?R.u4.IsTimeline?205863562:1312363469:pc.znj(R)?-149612405:-1372040782}}pc.p3h="autoFilter chart fieldList fieldListPivotFilter fieldWell floatingObject grid pivotFilter sheetOps timeSlicerLevel timeSlicer tableFieldList autoFilterRichFieldList slicer richText".split(" ");pc.n6i="GridContextMenu";
Object(J.a)(pc,"ContextMenuManager",null,[713,4]);const wc=Za.a.d3h;let cd=class extends Ha.a{constructor(R,cb,zb,V,Ea){super(R,"PopulateFieldListContextMenu",-1045020714,-170383950,wc,!0,!1,wc,Ea,cb,!1,zb,V);this.iS=this.Pp=null;this.Ove=this.isOlap=this.B2=this.X7=!1}get Sx(){return"PopulateFieldListContextMenu"}get tB(){return Za.a.Nfe}executeCommand(R,cb,zb){R=cb.command;const V=kc.a.Cb(na.FieldManagerPaneService);switch(R){case 330754562:cb=zb.domElement;this.isOlap=zb.isOlap;this.iS=zb.versionkey;
this.Pp=zb.fieldItem;this.X7=zb.isChart;this.B2=zb.isPpm;this.Ove="supportsImplicitMeasures"in zb?zb.supportsImplicitMeasures:!1;ta.f(this.$).Bu(!0);cb=Fe.DOMElementExtensions.getBounds({element:cb});cb=new Sys.UI.Point(cb.x+cb.width,cb.y+cb.height/2);"isKeyboardInput"in zb&&zb.isKeyboardInput?this.Xo(cb,!1,1):this.Xo(cb,!1);break;case 926905850:this.Ove&&this.Pp&&5===this.Pp.TypeTag&&!this.Pp.IsCollapsible&&O.ULS.sendTraceTag(537167057,0,50,"Add implicit measurement from field list.");V.$P(this.Pp,
8,-1,this.iS,cb);break;case -67292059:V.$P(this.Pp,1,-1,this.iS,cb);break;case 745182485:V.$P(this.Pp,2,-1,this.iS,cb);break;case 359279088:V.$P(this.Pp,4,-1,this.iS,cb);break;case 547535945:V.KCg(this.Pp,0);break;case -2108836646:V.KCg(this.Pp,1);break;default:return Va.a(R)}return $b.Task.Va(!0)}Rc(R,cb,zb){R=!1;switch(cb.command){case 330754562:R=!!zb;break;case 926905850:case -67292059:case 745182485:case 359279088:case 547535945:case -2108836646:R=!0}return R}sX(){const R=this.Ya.pq(this.menuId);
this.Lck(R);this.X7||this.isOlap||this.Kck(R);return R}Lck(R){const cb=this.Ya,zb=cb.uc();let V=!1;$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&(V=this.isOlap&&!this.B2&&this.Ove&&5===this.Pp.TypeTag&&!this.Pp.IsCollapsible);3!==this.Pp.TypeTag&&37!==this.Pp.TypeTag||this.Pp.IsSet?17===this.Pp.TypeTag||this.B2?(zb.buttons.push(cb.yb(79)),zb.buttons.push(cb.yb(this.X7?91:80)),zb.buttons.push(cb.yb(this.X7?92:81)),zb.buttons.push(cb.yb(82))):13===this.Pp.TypeTag||
this.Pp.IsSet?(zb.buttons.push(cb.yb(83)),zb.buttons.push(cb.yb(this.X7?91:80)),zb.buttons.push(cb.yb(this.X7?92:81)),zb.buttons.push(cb.yb(86))):(zb.buttons.push(cb.yb(79)),zb.buttons.push(cb.yb(this.X7?91:80)),zb.buttons.push(cb.yb(this.X7?92:81)),zb.buttons.push(cb.yb(V?82:86))):(zb.buttons.push(cb.yb(83)),zb.buttons.push(cb.yb(this.X7?93:84)),zb.buttons.push(cb.yb(this.X7?94:85)),zb.buttons.push(cb.yb(82)));R.Zb.push(zb)}Kck(R){const cb=this.Ya.uc();cb.buttons.push(this.Ya.yb(78));$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TimelineSlicers",
!1)&&cb.buttons.push(this.Ya.yb(this.Pp.AllowTimelines?332:333));R.Zb.push(cb)}};cd=Object(L.__decorate)([Object(kc.d)(na.FieldListContextMenuService),Object(L.__param)(0,Object(na.EwaControlService)()),Object(L.__param)(1,Object(na.RibbonControlsService)()),Object(L.__param)(2,Object(na.ContextMenuControllerService)()),Object(L.__param)(3,Object(na.ZoomService)())],cd);Object(J.a)(cd,"FieldListContextMenu",Ha.a,[]);var Vd=a(363),xb=a(74);class ub{constructor(R){this.$=R;this.LU={}}get(R,cb,zb){const V=
this.I4g(R,"PivotFilterContextMenuCache.Get");return V&&this.LU[V]?this.LU[V][ub.FMd(cb,this.$,R,zb)]:null}set(R,cb,zb,V){const Ea=this.I4g(R,"PivotFilterContextMenuCache.Set");Ea&&(this.LU[Ea]||(this.LU[Ea]={}),this.LU[Ea][ub.FMd(cb,this.$,R,V)]=zb)}Euc(R){R in this.LU&&this.LU[R]&&(this.LU[R]=null)}I4g(R,cb){return xb.f(this.$.la)?this.$.activeItemName:(R=this.l9k(R,cb))?R.Yc:null}l9k(R,cb){R=Ia.H(R);R=ta.f(this.$).za.Ata(R,this.$.activeItemName);O.ULS.shipAssertTag(537167008,0,!!R,`PivotFilterContextMenuBase.TryGetBlockModelProxyFromCell: Can't query the menuCache as block wasn't found in the BlockManager (returned null). Called from: ${cb}`);
return R}static FMd(R,cb,zb,V){return 0===V?cb.la.index+"_"+R.id+"_"+zb.FirstRow.toString()+"_"+zb.FirstColumn.toString():cb.la.index+"_"+R.id}}Object(J.a)(ub,"PivotFilterContextMenuCache",null,[]);class Fc{constructor(){this.cell=null;this.dataSourceIndex=0;this.Oi=this.pivotName=null}}Object(J.a)(Fc,"ShowPivotFilterData",null,[]);var xd=a(1126),Ic=a(64);const bd=Za.a.iif;class yb extends Ha.a{constructor(R,cb,zb,V,Ea,pb,Jb,zc,Mc,od){od=void 0===od?bd:od;super(R,cb,zb,V,od,!0,!1,"PivotFilterMenuRootName",
Ea,pb,!1,Jb,zc);this.YMc=this.b8d=this.pivotData=this.AEb=this.lastEvent=this.jsc=null;this.m6=this.upc=this.KZb=0;this.pivotFilterCache=this.Ura=null;this.HZj=(Td,Zd)=>{if(Zd)if(hb.a(Td))this.Y4d(Zd,!1);else if(Td=Td.Result){this.QLb=ub.FMd(Zd,this.$,this.pivotData.cell,this.m6);var xe=this.Xeg(Td.MenuModel.Sections);this.Ura=xe;yb.LU.set(this.pivotData.cell,Zd,xe,this.m6);na.PivotFilterCacheService.Oa()?this.pivotFilterCache.J_c(Td):xd.a(this.$).J_c(Td);this.Y4d(Zd,!0)}};this.GZj=(Td,Zd)=>{this.Y4d(Zd,
!1)};this.onBlockCacheItemChanged=(Td,Zd)=>{yb.LU.Euc(Zd.he.hash)};this.qr=(Td,Zd)=>{yb.LU.Euc(Zd.he.hash)};this.iLa=null;this.Hdf=this.upc=this.c8d=this.KZb=-1;this.H6e=this.m6=0;this.pivotFilterCache=Mc;yb.LU||(yb.LU=new ub(this.$),ta.f(this.$).za.$t(this.onBlockCacheItemChanged),ta.f(this.$).za.xP(this.qr),ta.f(this.$).za.qqa(this.onBlockCacheItemChanged))}LFd(R,cb){const zb=R.rawEvent,V=R.cell,Ea=R.requiresConfirmation,pb=Jb=>{if(Jb){Jb=zb?new Sys.UI.DomEvent(zb):null;this.pivotData=new Fc;this.pivotData.pivotName=
R.pivotName;this.pivotData.dataSourceIndex=R.dataSourceIndex;this.pivotData.cell=V;this.pivotData.Oi=R.optionalPivotMenuAnchorParameter;if(this.pivotData.Oi&&0<this.pivotData.Oi.AnchorType){this.YMc=R.objectId;this.KZb=R.objectVersion;const zc=this.pivotData.Oi.AnchorType;if(4===zc||5===zc||6===zc||11===zc||9===zc||10===zc||8===zc)this.AEb=R.location}else this.b8d=this.YMc=null,this.c8d=this.KZb=-1;ta.f(this.$).Bu(!0);this.$.Zk(V);this.sfa(Jb,Jb?Jb.target:R.domElement,this.pivotData,cb,this.Ukb())}};
void kc.a.resolve(na.DataRefreshManagerService,{xa:1}).then(Jb=>{Jb.KH(Ea,pb)});return!0}sfa(R,cb,zb,V){$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8652188_ContextMenuPerfLogging")&&null!=R&&se.b(this.$).kq(R.rawEvent,"showDropDown",null,["dropdown-menu"]);if(Object(Vd.a)(Fc,zb)){this.pivotData=zb;this.jsc=cb;this.lastEvent=R;this.upc=this.pivotData.Oi?this.pivotData.Oi.AnchorValue1:-1;this.m6=this.pivotData.Oi?this.pivotData.Oi.AnchorType:0;R=!1;zb=null;zb=yb.LU.get(this.pivotData.cell,cb,this.m6);
R=!!zb;var Ea=!0;switch(this.m6){case 4:case 5:case 6:this.iLa=new Sys.UI.Point(this.AEb.x/(ic.HelperMethods.isStandardZoomCssSupportedByBrowser?this.zoomManager.zoom:Sb.a.IC),this.AEb.y/(ic.HelperMethods.isStandardZoomCssSupportedByBrowser?this.zoomManager.zoom:Sb.a.IC));Ea=!1;break;case 7:var pb=ic.HelperMethods.isStandardZoomCssSupportedByBrowser?Fe.DOMElementExtensions.getBounds({element:cb,di:!0}):Sys.UI.DomElement.getBounds(cb);Ea=pb.x+(0<=pb.x?0:pb.width);pb=pb.y+(0<=pb.y?0:pb.height);this.iLa=
new Sys.UI.Point(0<=Ea?Ea:0,0<=pb?pb:0);Ea=!1;break;case 8:case 10:case 9:case 11:this.iLa=new Sys.UI.Point(this.AEb.x/(ic.HelperMethods.isStandardZoomCssSupportedByBrowser?this.zoomManager.zoom:1),this.AEb.y/(ic.HelperMethods.isStandardZoomCssSupportedByBrowser?this.zoomManager.zoom:1));break;default:this.iLa=null}R&&this.YMc===this.b8d&&this.KZb===this.c8d&&this.upc===this.Hdf&&this.m6===this.H6e?(O.ULS.sendTraceTag(537167042,0,50,"PivotFilterContextMenuBase.ShowDropDown: rendering pivot filter context menu from menu cache"),
this.Ura=zb,this.iLa?this.Xo(this.iLa,this.Ukb()):(V=Ha.a.dPb(this.$,this.pivotData.cell),Ha.a.UTb(V)&&this.Xo(Ha.a.oPb(this.$,V,!1),this.Ukb()))):1!==yb.BQi(cb)&&(Ea&&(cb.parentNode.menuFetchStates=1,this.PIk(cb),this.RPg(!0)),this.$.userOperationManager.enqueueOperation(new Sa.a(126,0,(Jb,zc,Mc)=>{const od=this.$;return Pa.q(od.ma.sa,this.pivotData.cell,this.pivotData.dataSourceIndex,this.pivotData.pivotName,od.domElement.id,od.isChromeRtl,od.workbookContext.NovMode,Z.c(Jb,this.HZj),Z.b(zc,this.GZj),
Mc,cb,this.pivotData.Oi)},16),V))}}l1b(R){R.MenuSectionList.push(...this.Ura)}Y4d(R,cb){R.parentNode.menuFetchStates=2;this.RPg(!1);if(cb){if(this.jsc!==R||this.BLj())this.Xo(this.iLa,this.Ukb());else if(this.iLa)super.sfa(this.lastEvent,R,null,null,this.Ukb());else{R=Ha.a.dPb(this.$,this.pivotData.cell);if(!Ha.a.UTb(R))return;this.Xo(Ha.a.oPb(this.$,R,!1),this.Ukb())}this.b8d=this.YMc;this.c8d=this.KZb;this.H6e=this.m6;this.Hdf=this.upc}}Ukb(){return 8!==this.m6&&9!==this.m6&&10!==this.m6&&11!==
this.m6}BLj(){switch(this.pivotData.Oi?this.pivotData.Oi.AnchorType:0){case 1:case 2:case 3:case 4:case 5:case 6:case 7:return!0;default:return!1}}RPg(R){const cb=this.jsc;if(cb){if($a.EwaSettings.isChangeGateEnabled("OfficeVSO:5041973_FixDropdownImageDisappearing")){var zb=Fe.DOMElementExtensions.zca(cb,"ewaprevsrc","");zb=!!zb&&"null"!==zb}else zb=!!Fe.DOMElementExtensions.zca(cb,"ewaprevsrc","");R&&zb||!R&&!zb||(R?(cb.setAttribute("ewaprevsrc",cb.src),cb.src=Ic.a.current.Lo(99)):(R=Fe.DOMElementExtensions.zca(cb,
"ewaprevsrc",""),cb.src=R,cb.setAttribute("ewaprevsrc",null)))}}PIk(R){this.jsc=R}static BQi(R){const cb=R.parentNode.menuFetchStates;void 0===cb&&(R.parentNode.menuFetchStates=0);return cb}}yb.LU=null;Object(J.a)(yb,"PivotFilterContextMenuBase",Ha.a,[]);const Oc="FieldList"+Za.a.iif;let kd=class extends yb{constructor(R,cb,zb,V,Ea,pb){super(R,"PopulateFieldListPivotMenu",-1793121409,1378457149,pb,cb,zb,V,Ea,Oc)}get Sx(){return"PopulateFieldListPivotMenu"}get tB(){return Za.a.LCg}executeCommand(R,
cb,zb){return this.LFd(zb,cb)?$b.Task.Va(!0):Va.a(cb.command)}Rc(R,cb,zb){return-1065117584===cb.command&&!!zb}};kd=Object(L.__decorate)([Object(kc.d)(na.FieldListPivotContextMenuService),Object(L.__param)(0,Object(na.EwaControlService)()),Object(L.__param)(1,Object(na.RibbonControlsService)()),Object(L.__param)(2,Object(na.ContextMenuControllerService)()),Object(L.__param)(3,Object(na.ZoomService)()),Object(L.__param)(4,Object(na.PivotFilterCacheService)())],kd);Object(J.a)(kd,"FieldListPivotContextMenu",
yb,[]);var Rc=a(242),Xb=a(32),dc=a(91),Vc=a(254),yd=a(1002);class Pd{}Object(J.a)(Pd,"PivotValueFieldSettingsApplyData",null,[]);class re{}re.vci="dataFieldCustomLabel";re.Nmf="dataFieldSourceLabel";re.Gte="showValueAsBaseFieldSelect";re.Hte="showValueAsBaseItemSelect";re.Ite="showValueAsSelect";re.A$g="valueFieldSettingTabs";re.tBe="valueFieldsSettingsFieldName";Object(J.a)(re,"ValueFieldSettingsClassNames",null,[]);var ue=a(147),He=a(1125);class bf{constructor(R,cb,zb){this.baseItemIndex=this.baseFieldIndex=
this.dataFormat=0;this.dataFormat=R;this.baseFieldIndex=cb;this.baseItemIndex=zb}}Object(J.a)(bf,"MacroRecorderPivotFieldShowValueAsParameters",null,[]);class af{constructor(R,cb,zb,V,Ea){this.externalSourceIndex=0;this.pivotFieldTitle=this.activeCell=null;this.summarizeBy=0;this.showAsValueParameters=null;this.externalSourceIndex=R;this.activeCell=cb;this.pivotFieldTitle=zb;this.summarizeBy=V;this.showAsValueParameters=Ea}getActiveCell(){return this.activeCell}}Object(J.a)(af,"MacroRecorderPivotValueFieldSettingAppliedPayload",
null,[67]);var Pe=a(267);class wf{}Object(J.a)(wf,"PivotValueFieldShowValueAsApplyData",null,[]);var xf=a(970);const Cf=`<div id='showValueAsControlBody'><label for='${re.Ite}' class='${ue.a.LF} valueFielsSettingsControlTitle'>{0}</label><div><select size=1 id='${re.Ite}' class='${ue.a.JX}'></select></div><div class='showValueAsControlSelectRegion'><label for='${re.Gte}'>{1}</label><div><select size=6 id='${re.Gte}' class='${ue.a.JX}'></select></div></div><div class='showValueAsControlSelectRegionSeparator'></div><div class='showValueAsControlSelectRegion'><label for='${re.Hte}'>{2}</label><div><select size=6 id='${re.Hte}' class='${ue.a.JX}'></select></div></div></div>`;
class tf extends Pe.a{constructor(R,cb,zb,V,Ea,pb,Jb,zc,Mc){super(R);this.Mc=this.eKe=this.MHe=this.LHe=this.Fnc=this.Msc=this.zI=null;this.mlg=()=>{var od=parseInt(this.Oia.xg.value,10);this.dVh(od)?(this.$W.vm.disabled=!0,this.aX.vm.disabled=!0,this.aX.clear(),tf.dZf(od)?(this.$W.vm.disabled=!1,this.a$b(!1)):tf.eZf(od)?(this.$W.vm.disabled=!1,this.aX.vm.disabled=!1,this.a$b(!0),this.E9f()):this.a$b(!1)):(od=Ma.a.Cd(1,0,0,1131,0,7896227,"FormatRequiresBaseFieldsOrBaseItems"),Bb.a(this.$).Zx([od]),
this.Oia.YKg())};this.uTj=()=>{0>this.$W.selectedIndex||this.aX.vm.disabled||(this.a$b(!0),this.E9f())};this.G_j=od=>{this.zI.x6a();this.aX.vm.style.overflowY="scroll";if(od&&!hb.a(od)){od=od.Result;this.aX.clear();for(const Td of od.BaseItems)this.aX.Naa(Td.DisplayString,Td.Id.toString(),Td.Id===od.SelectedBaseItem);this.a$b(!1)}};this.get_visible=this.SQb;this.set_visible=this.G6b;this.$=cb;this.cell=zb;this.Oi=V;this.externalSourceIndex=Ea;this.fc=pb;this.cEa=Jb;this.Ctj=zc;this.Mc=Mc;this.PSb()}SQb(){return this.isVisible}G6b(R){return this.isVisible=
R}get title(){return xa.a.instance.ia(1119)}get nQb(){const R=this.Oia.xg?parseInt(this.Oia.xg.value,10):-1,cb=this.$W.xg?parseInt(this.$W.xg.value,10):-1,zb=this.aX.xg?parseInt(this.aX.xg.value,10):-1;return Object(U.a)(new wf,{SelectedDataFormat:0<=R?R:-1,SelectedBaseField:cb,SelectedBaseItem:zb})}get $W(){return this.LHe}get aX(){return this.MHe}get Oia(){return this.eKe}setFocus(){Fe.DOMElementExtensions.setFocus(this.Oia.vm)}render(R){R.appendChild(this.domElement)}dispose(){dc.a.xd([this.Oia,
this.$W,this.aX,this.Msc,this.Fnc]);super.dispose()}LLk(R){dc.a.xd([this.Msc,this.Fnc]);this.Oia.clear();for(const cb of R.DataFormatTypes)this.Oia.Naa(tf.mOi(cb),cb.toString(),cb===R.SelectedDataFormat);this.Msc=this.Df.pf(this.Oia.domElement);this.Msc.Ea("change",this.mlg);this.$W.clear();for(const cb of R.BaseFieldList)this.$W.Naa(cb.DisplayString,cb.Id.toString(),cb.Id===R.SelectedBaseField);this.Fnc=this.Df.pf(this.$W.domElement);this.Fnc.Ea("change",this.uTj);this.zI=this.cEa.BKb(this.aX.vm.parentNode,
1E3,null,"",736);this.zI.x6a();this.mlg(null)}l2(R){this.Oia.l2(R);this.$W.l2(R);this.aX.l2(R)}PSb(){this.Mc.vl(this.domElement,String.format(Cf,xa.a.instance.ia(1120),xa.a.instance.ia(1121),xa.a.instance.ia(1122)));this.eKe=new xf.a(Fe.DOMElementExtensions.getElementById(this.domElement,re.Ite),!1);this.LHe=new xf.a(Fe.DOMElementExtensions.getElementById(this.domElement,re.Gte),!1);this.MHe=new xf.a(Fe.DOMElementExtensions.getElementById(this.domElement,re.Hte),!1)}dVh(R){return this.Ctj||!tf.dZf(R)&&
!tf.eZf(R)?!0:!!this.$W.count}getValueFieldSettingsShowValueAsBaseItemsInfo(){this.$.userOperationManager.enqueueOperation(new Sa.a(108,0,(R,cb,zb)=>He.d(this.$.ma.sa,this.cell,this.externalSourceIndex,parseInt(this.$W.xg.value,10),Z.c.call(null,R,this.G_j),cb,zb,null,this.Oi),16),this.fc)}E9f(){this.aX.clear();this.$W.xg&&(this.zI.o6a(),this.aX.vm.style.overflowY="hidden",this.getValueFieldSettingsShowValueAsBaseItemsInfo())}a$b(R){const cb=document.getElementById("WACDialogActionButton");cb&&(cb.disabled=
R)}static mOi(R){switch(R){case 0:return xa.a.instance.ia(1123);case 1:return xa.a.instance.ia(1124);case 2:return xa.a.instance.ia(1125);case 3:return xa.a.instance.ia(1126);case 4:return xa.a.instance.ia(1127);case 5:return xa.a.instance.ia(1128);case 6:return xa.a.instance.ia(1129);case 7:return xa.a.instance.ia(1130);case 8:return xa.a.instance.ia(1132);case 9:return xa.a.instance.ia(1133);case 10:return xa.a.instance.ia(1134);case 11:return xa.a.instance.ia(1135);case 12:return xa.a.instance.ia(1136);
case 13:return xa.a.instance.ia(1137);case 14:return xa.a.instance.ia(1138);default:return""}}static dZf(R){return 11===R||12===R||14===R||13===R||4===R}static eZf(R){return 1===R||3===R||2===R}}Object(J.a)(tf,"ShowValueAsControl",Pe.a,[726,4]);class Jf{}Object(J.a)(Jf,"PivotValueFieldSummarizeValueByApplyData",null,[]);const dg="<div id='summarizeValuesByControlBody'>"+`<label class='${ue.a.LF} valueFielsSettingsControlTitle' for='${"pivotDataFieldSelect"}'>{0}</label>`+`<div id='${"pivotDataFieldSelectDescription"}' class='${ue.a.LF} summarizeValuesByControlDescription'>{1}</div>`+
`<div><select class='${ue.a.JX}' size=6 id='${"pivotDataFieldSelect"}' style='width: 100%' ${Za.a.EP}='${"pivotDataFieldSelectDescription"}'></select></div>`+"</div>";class uf extends Pe.a{constructor(R,cb){super(R);this.Mc=this.eVe=null;this.get_visible=this.SQb;this.set_visible=this.G6b;this.Mc=cb;this.PSb()}get nQb(){const R=this.hn.xg?parseInt(this.hn.xg.value,10):-1;return Object(U.a)(new Jf,{Aggregation:0<=R?R:-1})}SQb(){return this.isVisible}G6b(R){return this.isVisible=R}get title(){return xa.a.instance.ia(1118)}get enabled(){return!this.hn.vm.disabled}set enabled(R){this.hn.vm.disabled=
!R}get hn(){return this.eVe}setFocus(){Fe.DOMElementExtensions.setFocus(this.hn.vm)}render(R){R.appendChild(this.domElement)}dispose(){dc.a.vb(this.hn);super.dispose()}focus(){Fe.DOMElementExtensions.setFocus(this.hn.vm)}KLk(R){this.hn.l_c();for(const cb of R.AggregationTypes){const zb=cb===R.SelectedAggregation;this.hn.ykc(uf.hJi(cb),cb.toString(),zb,"")}this.hn.Zuc();this.hn.vm.disabled=R.AggregationsDisabled}Uzk(){this.hn.WKg()}PSb(){this.Mc.vl(this.domElement,String.format(dg,xa.a.instance.ia(1103),
xa.a.instance.ia(1104)));this.eVe=new xf.a(Fe.DOMElementExtensions.getElementById(this.domElement,uf.cxg),!1)}static hJi(R){switch(R){case 0:return xa.a.instance.ia(1106);case 1:return xa.a.instance.ia(1107);case 2:return xa.a.instance.ia(1108);case 3:return xa.a.instance.ia(1109);case 12:return xa.a.instance.ia(2426);case 4:return xa.a.instance.ia(1110);case 5:return xa.a.instance.ia(1111);case 6:return xa.a.instance.ia(1112);case 7:return xa.a.instance.ia(1113);case 8:return xa.a.instance.ia(1114);
case 9:return xa.a.instance.ia(1115);case 10:return xa.a.instance.ia(1116);case 11:return xa.a.instance.ia(1117);default:return""}}}uf.cxg="pivotDataFieldSelect";Object(J.a)(uf,"SummarizeValuesByControl",Pe.a,[726,4]);var lf=a(244),Pf=a(553);class Rf{t2k(R,cb){R.set_visible(!1);cb.set_visible(!0)}}Object(J.a)(Rf,"DefaultTabSwitchBehaviour",null,[767]);class Mf{}Mf.c3k="TabsContainer";Mf.N2k="TabTitlesContainer";Mf.L2k="TabTitle";Mf.M2k="TabTitleText";Mf.jwe="TabTitleActive";Object(J.a)(Mf,"MultitabControlStyles",
null,[]);var zf=a(52),df=a(94),Bf=a(488),Kf=a(69);class Vf{constructor(R,cb,zb){this.Lpb=V=>{V.keyCode!==df.a.vo&&V.keyCode!==df.a.Hza||this.E8c(V)};this.Vm=R;this.Gs=cb;this.E8c=zb;this.Ioa=document.createElement("a");Kf.a.yXc(this.Ioa,this.Gs);Sys.UI.DomElement.addCssClass(this.Ioa,Mf.M2k);Sys.UI.DomElement.addCssClass(this.Vm,Mf.L2k);this.Vm.appendChild(this.Ioa);this.Ioa.tabIndex=0;this.v2c();zf.a.addHandler(this.Vm,"click",this.E8c);zf.a.addHandler(this.Vm,"keyup",this.Lpb)}get ud(){return this.Vm}get title(){return this.Gs}get isActive(){return Sys.UI.DomElement.containsCssClass(this.Vm,
Mf.jwe)}set isActive(R){this.setActive(R)}dispose(){zf.a.removeHandler(this.Vm,"keyup",this.Lpb);zf.a.removeHandler(this.Vm,"click",this.E8c);this.Vm=this.Ioa=null}setActive(R){R?Sys.UI.DomElement.addCssClass(this.Vm,Mf.jwe):Sys.UI.DomElement.removeCssClass(this.Vm,Mf.jwe);this.Ioa&&this.Ioa.setAttribute(Bf.a.Nha,R)}v2c(){this.Vm.setAttribute(Bf.a.Ae,Bf.a.cu);this.Ioa.setAttribute(Bf.a.oy,this.Gs);this.Ioa.setAttribute(Bf.a.Ae,Bf.a.MGb)}}Object(J.a)(Vf,"TabTitleControl",null,[4]);var sb=a(55);class Gc{constructor(R,
cb,zb){zb=void 0===zb?null:zb;this.aEb=this.iEb=null;this.D$=-1;this.Vm=R;this.Ipa=(void 0===cb?null:cb)||new Vc.a;this.ovh=zb||new Rf;this.uRa=new Vc.a;R=0;for(const V of this.Ipa)this.K_d(this.D$)||(this.D$=R),cb=R++,this.uRa.add(new Vf(document.createElement("li"),V.title,this.x7h(cb)))}get l0c(){return this.Ipa.count}get activeTab(){return this.D$}set activeTab(R){this.E0g(R)}get ud(){return this.Vm}get visible(){return sb.a.isVisible(this.Vm)}set visible(R){this.Vm.style.visibility=R?"visible":
"hidden"}Cvk(){this.iEb=document.createElement("ul");this.iEb.className=Mf.N2k;this.aEb=document.createElement("div");this.aEb.className=Mf.c3k;for(let R=0;R<this.l0c;++R){const cb=this.Ipa.pa(R),zb=this.uRa.pa(R);cb.set_visible(!1);zb.isActive=!1;const V=document.createElement("div");cb.render(V);this.aEb.appendChild(V);this.iEb.appendChild(zb.ud)}this.ud.appendChild(this.iEb);this.ud.appendChild(this.aEb);this.K_d(this.D$)&&(this.uRa.pa(this.D$).isActive=!0,this.Ipa.pa(this.D$).set_visible(!0))}dispose(){for(let R=
0;R<this.l0c;++R)this.Ipa.pa(R).dispose(),this.uRa.pa(R).dispose();this.uRa=this.Ipa=this.Vm=this.aEb=this.iEb=null}setFocus(){this.Ipa.pa(this.D$).setFocus()}K_d(R){return 0<=R&&R<this.l0c}E0g(R){this.D$!==R&&this.K_d(R)&&(this.ovh.t2k(this.Ipa.pa(this.D$),this.Ipa.pa(R)),this.uRa.pa(this.D$).isActive=!1,this.uRa.pa(R).isActive=!0,this.D$=R,this.setFocus())}x7h(R){return()=>{this.E0g(R)}}}Object(J.a)(Gc,"MultitabControl",null,[746,4]);class ad extends yd.a{constructor(R,cb,zb,V,Ea,pb,Jb,zc,Mc,od){super(Ea,
xa.a.instance.Ib(61),!0,2,!0);this.RVg=!0;this.Mc=this.qkd=this.BAd=this.aLb=this.EBa=this.S5a=this.X_e=null;this.hTj=Td=>{Rc.a.any(Td.Errors,Zd=>-103190598===Zd.MessageId)&&this.D6a.Uzk()};this.F_j=Td=>{Td&&!hb.a(Td)&&(Td=Td.Result,this.Mc.LQg(this.BAd,xa.a.instance.ia(1101)+Xb.a.$l(Td.ValueFieldSourceName)),this.isOlap&&!this.B2?(this.D6a.enabled=!1,this.EBa.activeTab=this.EBa.l0c-1):(this.D6a.enabled=!0,this.EBa.activeTab=0),this.D6a.KLk(Td.PivotValueFieldSettingsSummarizeValueByInfo),this.S5a.LLk(Td.PivotValueFieldShowValueAsInitialInfo),
this.Om())};this.cell=R;this.Oi=cb;this.externalSourceIndex=zb;this.z$g=V;this.fc=pb;this.cEa=Jb;this.isOlap=zc;this.B2=Mc;this.Mc=od}get Tc(){return"ValueFieldSettingsDialog"}get TNa(){return this.X_e}get D6a(){return this.qkd}get kD(){return 560}dispose(){this.BAd=this.aLb=this.S5a=this.qkd=null;dc.a.vb(this.EBa);this.EBa=null;super.dispose()}initialize(){let R="<div id='"+re.Nmf+"' class='"+ue.a.LF+"'></div><div id='"+re.vci+"' class='"+ue.a.LF+"'><label for='"+re.tBe+"'>{0}</label><input type='text' id='"+
re.tBe+"' value='{1}' class='"+ue.a.JX+" UIFont' /></div><div id='"+re.A$g+"'></div>";R=String.format(R,xa.a.instance.ia(1102),Xb.a.$l(this.z$g));this.Mc.vl(this.Ld,R);this.xj||(this.hSa(),this.cE());this.X_e=[-103190598];this.G4i();super.initialize()}close(R){1===R&&(this.RVg=!1);super.close(R)}jpf(R){this.isDisabled=R;this.domElement.disabled=R;const cb=["input","option","select"];for(let zb=0,V=cb.length;zb<V;++zb){const Ea=this.domElement.getElementsByTagName(cb[zb]);for(let pb=0;pb<Ea.length;++pb)Ea[pb].disabled=
R}}cE(){this.aLb=document.getElementById(re.tBe);this.BAd=Fe.DOMElementExtensions.getElementById(this.Ld,re.Nmf);const R=Fe.DOMElementExtensions.getElementById(this.Ld,re.A$g);this.qkd=new uf(document.createElement("div"),this.Mc);this.S5a=new tf(document.createElement("div"),this.$,this.cell,this.Oi,this.externalSourceIndex,this.fc,this.cEa,!this.isOlap,this.Mc);this.EBa=new Gc(R,new Vc.a([this.D6a,this.S5a]));this.EBa.Cvk()}ade(){const R=new ad(this.cell,this.Oi,this.externalSourceIndex,this.z$g,
this.$,this.fc,this.cEa,this.isOlap,this.B2,this.Mc);R.initialize();R.Om()}Y3c(){const R=new Pf.a;if(!this.RVg)return R.isValid=!0,R;this.aLb.value.length?R.isValid=!0:(this.jpf(!0),R.error=Ma.a.Cd(1,0,751,766,0,1783218700,"PivotTableValueFieldNoBlank"),this.isDisabled=!0,this.xj||(this.MD.disabled=!0),R.isValid=!1);return R}SQf(){this.isDisabled=!1;this.xj||(this.MD.disabled=!1);this.jpf(!1)}llg(R){const cb=new da.a(2105621672,0,this.$.xc,30,null);this.$.Ia.Gb(cb);this.tV(5,R.Yb,"Number Format");
return!0}cA(){this.nNa=String.format(xa.a.instance.Ib(61),null);super.cA()}setFocus(){if(this.xj){const R=Fe.DOMElementExtensions.getElementById(this.Ld,uf.cxg);lf.a.d5g(R)}else this.EBa.setFocus()}Bn(){const R=this.S5a.nQb,cb=new bf(R.SelectedDataFormat,R.SelectedBaseField,R.SelectedBaseItem);return()=>new af(this.externalSourceIndex,this.cell,this.aLb.value,this.D6a.nQb.Aggregation,cb)}QJ(){const R=Object(U.a)(new Pd,{PivotValueFieldSummarizeValueByApplyData:this.D6a.nQb,PivotValueFieldShowValueAsApplyData:this.S5a.nQb,
PivotValueFieldTitle:this.aLb.value});return(cb,zb,V)=>He.b(this.$.ma.sa,this.cell,this.externalSourceIndex,R,Z.c(cb,this.hTj),zb,V,null,this.Oi)}l2(R){this.$.ra.Vc(40,()=>{this.S5a.l2(R)})}G4i(){this.$.userOperationManager.enqueueOperation(new Sa.a(123,0,(R,cb,zb)=>He.c(this.$.ma.sa,this.cell,this.externalSourceIndex,Z.c.call(null,R,this.F_j),cb,zb,null,this.Oi),16),this.fc)}}Object(J.a)(ad,"ValueFieldSettingsDialog",yd.a,[]);const Wd=Za.a.e3h;let je=class extends Ha.a{constructor(R,cb,zb,V,Ea){super(R,
"PopulateFieldWellContextMenu",1374696078,495005930,Wd,!0,!1,Wd,Ea,cb,!1,zb,V);this.Oi=this.Pp=this.cell=null;this.LCe=this.externalSourceIndex=-1;this.j6a=0;this.ZZc=-1;this.iS=null;this.lhb=this.B2=this.isOlap=!1}get Sx(){return"PopulateFieldWellContextMenu"}get tB(){return Za.a.Ofe}executeCommand(R,cb,zb,V){R=cb.command;const Ea=kc.a.Cb(na.FieldManagerPaneService);switch(R){case -1453503574:V=zb.domElement;this.Pp=zb.fieldItem;this.LCe=zb.zoneCount;this.j6a=zb.sourceAxis;this.ZZc=zb.sourceAxisPos;
this.Oi=zb.optionalPivotMenuAnchorParameter;this.iS=zb.versionkey;this.isOlap=zb.isOlap;this.B2=zb.isPpm;this.lhb="fieldItemsupportsImplicitMeasures"in zb?zb.fieldItemsupportsImplicitMeasures:!1;this.cell=zb.cell;this.externalSourceIndex=zb.externalSourceIndex;ta.f(this.$).Bu(!0);V=Fe.DOMElementExtensions.getBounds({element:V});R=new Sys.UI.Point(V.x,V.y+V.height);this.$.isChromeRtl&&(R.x+=V.width);"isKeyboardInput"in zb&&zb.isKeyboardInput?this.Xo(R,!1,1):this.Xo(R,!1);break;case 495005930:break;
case -1170196828:Ea.$P(this.Pp,this.j6a,this.ZZc-1,this.iS,cb);break;case -889576107:Ea.$P(this.Pp,this.j6a,this.ZZc+2,this.iS,cb);break;case 2033235475:Ea.$P(this.Pp,this.j6a,this.LCe,this.iS,cb);break;case 389774337:Ea.$P(this.Pp,this.j6a,0,this.iS,cb);break;case -96230454:Ea.$P(this.Pp,4,-1,this.iS,cb);break;case 74086617:Ea.$P(this.Pp,1,-1,this.iS,cb);break;case 1529312473:Ea.$P(this.Pp,2,-1,this.iS,cb);break;case 563292088:this.lhb&&O.ULS.sendTraceTag(537167056,0,50,"Move a field into values area as implicit measurement.");
Ea.$P(this.Pp,8,-1,this.iS,cb);break;case -1092351914:Ea.$P(this.Pp,0,-1,this.iS,cb);break;case -2141589616:const pb=Object(Cc.d)(kc.a.resolve(na.SharedUIControlsFactoryService,{xa:V.Oca()})),Jb=Object(Cc.d)(kc.a.resolve(na.HtmlSanitizationHelperService,{xa:V.Oca()}));return db.TaskExtensions.tb(db.TaskExtensions.jl([pb,Jb],this.$.Aa),()=>{(new ad(this.cell,this.Oi,this.externalSourceIndex,this.Pp.Name,this.$,cb,pb.result,this.isOlap,this.B2,Jb.result)).initialize()},this.Aa);default:return Va.a(R)}return $b.Task.Va(!0)}Rc(R,
cb,zb){R=!1;switch(cb.command){case -1453503574:R=!!zb;break;case 495005930:case -1170196828:case -889576107:case 2033235475:case 389774337:case -96230454:case 74086617:case 1529312473:case 563292088:case -1092351914:case -2141589616:R=!0}return R}sX(){const R=this.Ya.pq(this.menuId);this.Tck(R,this.ZZc,this.LCe);this.Uck(R,this.j6a);this.Vck(R);8===this.j6a&&this.Rck(R);return R}Tck(R,cb,zb){const V=this.Ya,Ea=V.uc();cb||cb!==zb-1?!cb&&cb<zb-1?(Ea.buttons.push(V.yb(64)),Ea.buttons.push(V.yb(61)),
Ea.buttons.push(V.yb(66)),Ea.buttons.push(V.yb(63))):0<cb&&cb<zb-1?(Ea.buttons.push(V.yb(60)),Ea.buttons.push(V.yb(61)),Ea.buttons.push(V.yb(62)),Ea.buttons.push(V.yb(63))):0<cb&&cb===zb-1&&(Ea.buttons.push(V.yb(60)),Ea.buttons.push(V.yb(65)),Ea.buttons.push(V.yb(62)),Ea.buttons.push(V.yb(67))):(Ea.buttons.push(V.yb(64)),Ea.buttons.push(V.yb(65)),Ea.buttons.push(V.yb(66)),Ea.buttons.push(V.yb(67)));R.Zb.push(Ea)}Uck(R,cb){const zb=this.Ya,V=zb.uc(),Ea=1!==cb&&(!this.isOlap||this.B2||8!==cb||this.lhb),
pb=2!==cb&&(!this.isOlap||this.B2||8!==cb||this.lhb),Jb=8!==cb&&-2!==this.Pp.PivotTableIndex&&(!this.isOlap||this.B2||this.lhb);V.buttons.push(zb.yb(4===cb||this.Pp.IsSet||-2===this.Pp.PivotTableIndex||this.isOlap&&!this.B2&&8===cb&&!this.lhb?72:68));8===this.Oi.AnchorType||10===this.Oi.AnchorType?(V.buttons.push(zb.yb(Ea?95:97)),V.buttons.push(zb.yb(pb?96:98))):(V.buttons.push(zb.yb(Ea?69:73)),V.buttons.push(zb.yb(pb?70:74)));V.buttons.push(zb.yb(Jb?71:75));R.Zb.push(V)}Vck(R){const cb=this.Ya.uc();
cb.buttons.push(this.Ya.yb(76));R.Zb.push(cb)}Rck(R){const cb=this.Ya.uc();cb.buttons.push(this.Ya.yb(77));R.Zb.push(cb)}};je=Object(L.__decorate)([Object(kc.d)(na.FieldWellContextMenuService),Object(L.__param)(0,Object(na.EwaControlService)()),Object(L.__param)(1,Object(na.RibbonControlsService)()),Object(L.__param)(2,Object(na.ContextMenuControllerService)()),Object(L.__param)(3,Object(na.ZoomService)())],je);Object(J.a)(je,"FieldWellContextMenu",Ha.a,[]);var Ie=a(1264),Je=a(1199),$e=a(27);class Ib{}
Ib.applyItemFilter="ApplyItemFilter";Ib.lRb="HandleShowPivotPageFilterMenu";Ib.qCc="HandleShowPivotDropDownMenu";Ib.clearFilter="ClearFilter";Ib.Brb="ReactFilterMenuOpen";Ib.h6a="SortFilterScriptLoad";Ib.R2g="ToggleFilter";Ib.getPivotFilterData="GetPivotFilterData";Ib.searchPivotFilter="SearchPivotFilter";Ib.XU="OnGetFilterByValueItems";Ib.getPivotFilterMenuAndFilterData="GetPivotFilterMenuAndFilterData";Object(J.a)(Ib,"PivotFilterMenuOperations",null,[]);var Nb;const Bc=Za.a.i3h;let Af=Nb=class extends Ha.a{constructor(R,
cb,zb,V,Ea,pb,Jb,zc){super(R,"PopulatePivotDropDownContextMenu",null,null,Bc,!0,!1,"PivotDropDownContextMenuRoot",zc,cb,!1,zb,V);this.ME=this.KX=this.Ura=null;this.fJa=!1;this.hAd=this.rG=this.MKb=this.RC=this.Nta=this.m7=this.E3=null;this.e2=0;this.pivotFilterCache=this.target=null;this.ZNa=this.rmc=!1;this.lm=null;this.gWb=$a.EwaSettings.nYd();this.aye=null;this.bT=0;this.cell=this.Oi=this.Iqb=null;this.dataSourceIndex=0;this.fieldId=this.pivotTableName=null;this.DCc=!1;this.PZj=(Mc,od)=>{if(Ga.a.X9(Mc)){const Td=
Ga.a.v7(Mc);this.tl?Ga.a.Kl(Ib.getPivotFilterMenuAndFilterData,Td.MessageIdName,eb.a.MGa,!0,!0):O.ULS.sendTraceTag(507385541,0,10,`PivotDropDownContextMenu::onGetPivotMenuAndFilterDataSucceeded failed with Exception -${Td.MessageIdName}`)}od?hb.a(Mc)?this.tl?Ga.a.Kl(Ib.getPivotFilterMenuAndFilterData,kb.a.dMf,eb.a.MGa,!0,!1):O.ULS.sendTraceTag(507379731,0,10,"PivotDropDownContextMenu::onGetPivotMenuAndFilterDataSucceeded: : getPivotFilterMenuAndFilterData service call failed."):(O.ULS.sendTraceTag(507385539,
0,50,"PivotDropDownContextMenu::onGetPivotMenuAndFilterDataSucceeded: getPivotFilterMenuAndFilterData service call succeeded."),(od=Mc.Result)?od.PivotFilterMenu?od.PivotFilterMenu.MenuModel?od.PivotFields?(this.fieldId||(1===od.PivotFields.length?this.fieldId=od.PivotFields[0].IdString:(this.DCc=!0,this.Iqb=od.PivotFields)),this.rmc=od.PivotFilterData?!0:!1,this.WZj(od.PivotFilterMenu),na.PivotFilterCacheService.Oa()?(this.pivotFilterCache.clearCache(),this.pivotFilterCache.J_c(od.PivotFilterMenu)):
(xd.a(this.$).clearCache(),xd.a(this.$).J_c(od.PivotFilterMenu)),this.rmc&&(this.NZj(od.PivotFilterData),this.rmc=!1)):this.tl?Ga.a.Kl(Ib.getPivotFilterMenuAndFilterData,kb.a.lbk,eb.a.MGa,!0,!1):O.ULS.sendTraceTag(507379727,0,10,`PivotDropDownContextMenu.onGetPivotMenuAndFilterDataSucceeded: No PivotFilterMenuAndFilterData.PivotFields in the result '${Mc}'`):this.tl?Ga.a.Kl(Ib.getPivotFilterMenuAndFilterData,kb.a.ALj,eb.a.MGa,!0,!1):O.ULS.sendTraceTag(507379728,0,10,"PivotDropDownContextMenu.onGetPivotMenuAndFilterDataSucceeded: No PivotFilterMenu.MenuModel in the result"):
this.tl?Ga.a.Kl(Ib.getPivotFilterMenuAndFilterData,kb.a.pbk,eb.a.MGa,!0,!1):O.ULS.sendTraceTag(507379729,0,10,"PivotDropDownContextMenu.onGetPivotMenuAndFilterDataSucceeded: No PivotFilterMenu in the result"):this.tl?Ga.a.Kl(Ib.getPivotFilterMenuAndFilterData,kb.a.obk,eb.a.MGa,!0,!1):O.ULS.sendTraceTag(507379730,0,10,"PivotDropDownContextMenu.onGetPivotMenuAndFilterDataSucceeded: No PivotFilterMenuAndFilterData in the result")):this.tl?Ga.a.Kl(Ib.getPivotFilterMenuAndFilterData,kb.a.Zgl,eb.a.MGa,
!0,!1):O.ULS.sendTraceTag(507379732,0,10,"PivotDropDownContextMenu::onGetPivotMenuAndFilterDataSucceeded: The userContext object is null or undefined and is supposed to be a DOM element.")};this.qm=()=>{this.iWa();this.$.fa.tie(this.qm)};this.Hj=()=>{this.iWa();this.$.fa.Av(this.Hj)};this.XU=Mc=>{if(!this.rmc){if(this.DCc&&this.Iqb){var od=Mc.parentLabel?Mc.parentLabel:null;if(od)for(var Td of this.Iqb)if(Td.DisplayString===od){this.fieldId=Td.IdString;break}}this.fieldId?(Td=!!Mc.searchText,od=this.$.ma.sa.mc(),
Td?(Td=168,Mc=this.GHb(null,Mc.searchText)):(Td=167,Mc=this.btd(Nb.rla,!1,null)),this.MKb=od.RequestId,this.Nta&&!this.Nta.dequeueUtcTime&&(this.$.userOperationManager.Sia(this.Nta),this.cud()),Mc=new Sa.a(Td,0,Mc,80),this.Nta=this.$.userOperationManager.enqueueOperation(Mc,null),this.rG=this.hAd,this.RC=this.MKb):this.tl?Ga.a.Kl(Ib.XU,kb.a.QAf,eb.a.V2a,!1,!0):O.ULS.sendTraceTag(507331874,0,10,"PivotDropDownContextMenu.onGetFilterByValueItems:fieldId is undefined.")}};this.onMenuItemClick=(Mc,od,
Td)=>{pa.b(this.$).Jd(Na.a.t3j,fc.g(),void 0,!0);od={["CommandValueId"]:od,["MenuItemId"]:od,["InputMethod"]:Td,["TopCellAddress"]:this.ME};const Zd=new da.a(Mc,Td,this.$.isEditMode?2:1,19,null);this.$.Ia.Gb(Zd,od);O.ULS.sendTraceTag(507565782,0,50,`PivotDropDownContextMenu::OnMenuItemClick ${Mc}, ${Td}`)};this.focusShiftOnMenuDismiss=()=>{ta.f(this.$).focus()};this.cpb=Mc=>{this.bT=Date.now();if(Mc.checkedItems&&Mc.checkedItems.length){pa.b(this.$).Jd(Na.a.E8d,fc.g(),void 0,!0);1===Mc.checkedItems.length&&
"[AllSearchResultsAndAddCurrentSelection]"===Mc.checkedItems[0]&&(Mc.checkedItems[0]="[AllSearchResults]",Mc.checkedItems.push("[AddCurrentSelection]"));var od=b(this.cell,this.fieldId,this.dataSourceIndex,this.Oi,this.e2),Td=xe=>{var pe={["ToggleFilterOperationCount"]:0,["ApplyFilterTime"]:this.bT?Date.now()-this.bT:-1,["ToggleAndApplyFilterTime"]:0};O.ULS.sendTraceTag(507565780,0,50,`PivotDropDownContextMenu::ApplyFilterByValue Perf Telemetry : ${JSON.stringify(pe)}`);Ga.a.X9(xe)&&(pe=Ga.a.v7(xe),
this.tl?Ga.a.Kl(Ib.applyItemFilter,pe.MessageIdName,eb.a.dxg,!0,Ga.a.BIa(pe.MessageId)):O.ULS.sendTraceTag(507565773,0,10,`PivotDropDownContextMenu::OnApplyFilterByValue failed with Exception -${pe.MessageIdName}`));hb.a(xe)||(O.ULS.sendTraceTag(507565779,0,50,"PivotDropDownContextMenu::OnApplyFilterByValue service call succeeded"),pa.b(this.$).Jd(Na.a.YNc,fc.g(),void 0,!0),this.m7.onApplyFilterByValueFinish({isSuccess:!0}),fc.k(this.$,this.ME))},Zd=new Sa.a(208,0,(xe,pe,Re)=>Pa.a(this.$.ma.sa,od,
Mc.checkedItems,Z.c(xe,Td),Z.b(pe,this.F8d()),Re,null,null),6|($a.EwaSettings.isChangeGateEnabled("OfficeVSO:8801768_pivotScheduleGetRange")&&Object(wb.p)(this.$,$e.Range.Hc(this.cell.FirstRow,this.cell.FirstColumn))?128:0),()=>new oa.a(Mc.checkedItems,od));(()=>{this.$.userOperationManager.enqueueOperation(Zd,null)})()}else O.ULS.sendTraceTag(507565781,0,15,"PivotDropDownContextMenu::OnApplyFilterByValue Received Zero checked items to apply filter on")};this.zoom=V;this.tl=Ga.a.Lkb();this.pivotFilterCache=
pb;this.lm=Ea}get Sx(){return"PopulatePivotDropDownContextMenu"}get tB(){return Za.a.wkk}executeCommand(R,cb,zb){R=cb.command;switch(R){case 1701016594:return Ha.a.HFd(zb),$b.Task.Va(!0);case 1569285147:return this.qCc(cb,zb),$b.Task.Va(!0);default:return Va.a(R)}}qCc(R,cb){R=cb.showPivotFilterDialogCommandData;this.cell=R.cell;this.dataSourceIndex=R.dataSourceIndex;this.fieldId=R.fieldId;this.Oi=R.optionalPivotAnchorParameter;this.DCc=!1;R=0;let zb=null,V=-1,Ea=-1;this.Oi&&(R=this.Oi.AnchorType,
zb=this.Oi.ChartId,V=this.Oi.AnchorValue1,Ea=this.Oi.AnchorValue2);const pb={};pb.AnchorType=R;pb.ChartId=zb;pb.AnchorValue1=V;pb.AnchorValue2=Ea;this.Oi=pb;const Jb=cb.domEvent;sa.g(Jb);this.pivotTableName=cb.pivotName;Jb&&Jb.target&&Jb.rawEvent?(void this.$xe(Jb),this.aye=this.gWb?zc=>{this.lm.kq(zc,"context_menu_pivot_drop_down_apply",null,["context-menu-pivot-drop-down-filter-items"])}:void 0,cb=new wa.SheetProtection(this.$.qa),this.$.Zk(this.cell),this.ME=Ia.H(this.cell),cb.ie(8192)?na.SortFilterService.Oa()?
this.$.fa.ug&&(this.ZNa||this.RYa(),this.g4a(Jb.target)):this.fJa?this.g4a(Jb.target):(this.E3=()=>{this.RYa();this.g4a(Jb.target);this.fJa=!0},this.iWa()):this.tl?Ga.a.Kl(Ib.qCc,kb.a.CAg,eb.a.V2a,!1,!0):O.ULS.sendTraceTag(507565790,0,10,"PivotDropDownContextMenu.handleShowPivotDropDownMenu:protected sheet, cannot be modified")):this.tl?Ga.a.Kl(Ib.qCc,kb.a.Jqf,eb.a.V2a,!1,!0):O.ULS.sendTraceTag(507565791,0,10,"PivotDropDownContextMenu.handleShowPivotDropDownMenu:domEvent is undefined.")}Rc(R,cb,zb){switch(cb.command){case 1701016594:case 1569285147:return!!zb;
default:return!1}}l1b(R){R.MenuSectionList.push(...this.Ura)}RYa(){this.m7=sortFilter.PivotDropDownControllerFactoryGlobal.createPivotDropDownController({getFilterByValueItemsRequest:this.XU,applyFilterByValueRequest:this.cpb,onMenuItemClick:this.onMenuItemClick,focusShiftOnMenuDismiss:this.focusShiftOnMenuDismiss,filterMenuWidth:Nb.DNb});this.KX=Object(B.f)(Y.a)||new la.a(this.$.Oc,this.$);this.ZNa=!0}iWa(){this.$.fa.ug?Object(tc.loadChunkWithDynamicScriptLoader)("sortFilter",{xa:1}).then(()=>{this.E3()},
R=>{this.tl?Ga.a.Kl(Ib.h6a,kb.a.pue,eb.a.V2a,!1,!1):ia.a.yi(R,"PivotDropDownContextMenu.filterScriptLoad")}):this.$.fa.Nr(this.Hj)}g4a(R){this.target=R;var cb;$a.EwaSettings.PZd()||Sys.UI.DomElement.getBounds(R);this.cell||(this.tl?Ga.a.Kl(Ib.Brb,kb.a.jdf,eb.a.V2a,!0,!1):O.ULS.sendTraceTag(507565788,0,10,"PivotDropDownContextMenu.renderReactMenu:Cell is undefined."));R=Ha.a.dPb(this.$,this.cell);Ha.a.UTb(R)||(this.tl?Ga.a.Kl(Ib.Brb,kb.a.eif,eb.a.V2a,!0,!1):O.ULS.sendTraceTag(507565787,0,10,"PivotDropDownContextMenu.renderReactMenu:context menu cell not in view."));
(cb=Ha.a.oPb(this.$,R,!0))?(R=cb.x,cb=cb.y,ta.f(this.$).rtl?this.location=new Sys.UI.Point(R-this.zoomManager.Aqa(Nb.DNb),cb):this.location=new Sys.UI.Point(R,cb),this.location=this.zoomManager.B7(this.location),this.NXi()):this.tl?Ga.a.Kl(Ib.Brb,kb.a.CAf,eb.a.V2a,!0,!1):O.ULS.sendTraceTag(507565786,0,10,"PivotDropDownContextMenu.renderReactMenu:\u00a0failed to get the context menu coordinates.")}NXi(){this.$.userOperationManager.enqueueOperation(new Sa.a(1045,0,(R,cb,zb)=>{const V=this.$;return Pa.p(V.ma.sa,
this.cell,this.dataSourceIndex,this.pivotTableName,this.fieldId,Nb.rla,!1,0,0,V.domElement.id,V.isChromeRtl,V.workbookContext.NovMode,Z.c(R,this.PZj),Z.b(cb,this.OZj),zb,this.target,this.Oi)},80),null)}WZj(R){R=this.Zzg(R.MenuModel);this.m7.showPivotDropDownMenu({targetPoint:{left:this.location.x,top:this.location.y},filterMenu:R,isMultipleRowFields:this.DCc},this.aye);this.aye=null}async $xe(R){R&&R.rawEvent&&(this.gWb?this.lm.kq(R.rawEvent,"context_menu_pivot_drop_down",null,["context-menu-pivot-drop-down",
"context-menu-pivot-drop-down-filter-items"]):(await kc.a.resolve(na.InteractivityTrackerServiceIdentifier)).kq(R.rawEvent,"context_menu_pivot_drop_down",null,["context-menu-pivot-drop-down"]))}NZj(R){if(R){var cb=new mb.a(!0);R.PivotFilterItemsList&&R.PivotFilterItemsList.PivotFilterItems&&cb.add("FilterItemsCount",R.PivotFilterItemsList.PivotFilterItems.length);cb.add("Location","contextMenu");R={filterByValueItems:this.eEa(R.PivotFilterItemsList),hasMoreRecords:R.PivotFilterItemsList.ItemListMaxExceeded};
this.m7.onGetFilterByValueItemsFinish(R)}else this.tl?Ga.a.Kl(Ib.getPivotFilterMenuAndFilterData,kb.a.nbk,eb.a.rLd,!0,!1):O.ULS.sendTraceTag(507379726,0,10,"PivotDropDownContextMenu.onGetPivotFilterDataSucceeded: PivotFilterData is null")}Zzg(R){const cb=[];for(const zb of R.Sections){const V=this.$fk(zb);cb.push(V)}return Object(U.a)(new Yb,{Id:R.Id,Sections:cb})}$fk(R){const cb=[];for(const zb of R.MenuItems)if(2!==zb.Identifier)switch(zb.Type){case 3:case 2:cb.push(this.Yfk(zb,2===zb.Type));break;
case 1:cb.push(this.Zfk(zb))}return Object(U.a)(new Mb,{MenuItems:cb,DisplayType:R.DisplayType,Id:this.KEf(R)})}Zfk(R){const {label:cb,mua:zb}=this.lJd(R),V=this.Zzg(R.SubMenu),Ea=this.iJd(R);let pb="MissingIcon_20";zb&&(pb=this.KX.Eib(zb));const Jb=cb||R.Label;return Object(U.a)(new Gb,{Disabled:R.Disabled,Type:R.Type,Identifier:R.Identifier,Id:Ea,CommandData:R.CommandData,Label:Jb,SubMenu:V,IsChecked:R.IsChecked,IconName:"MissingIcon_20"===pb?null:pb})}Yfk(R,cb){const {label:zb,mua:V,Ti:Ea}=this.LOb(R,
cb&&R.IsChecked);cb=this.qyc(R,zb);let pb="MissingIcon_20";V&&(pb=this.KX.Eib(V));return Object(U.a)(new Gb,{Disabled:R.Disabled,Type:R.Type,Identifier:R.Identifier,Id:cb,RibbonCommand:Ea,CommandData:R.CommandData,Label:zb||R.Label,SubMenu:null,IsChecked:R.IsChecked,IconName:"MissingIcon_20"===pb?null:pb})}cud(){this.RC&&(O.ULS.sendTraceTag(507565783,0,15,`PivotDropDownContextMenu.cancelSearchFilterItemListWebRequest Cancelling pending web request with ID=${this.RC}`),Pa.i(this.$.ma.sa,this.RC,null,
null,null),this.RC=null);this.rG&&(X.AFrameworkApplication.od.dy(this.rG.sx),this.rG=null)}$1a(){return R=>{this.rG=this.RC=null;if(Ga.a.X9(R)){var cb=Ga.a.v7(R);this.tl?Ga.a.Kl(Ib.getPivotFilterData,cb.MessageIdName,eb.a.rLd,!0,!0):O.ULS.sendTraceTag(507565778,0,10,`PivotDropDownContextMenu::OnGetFilterByValueItemsSuccessCallback failed with Exception -${cb.MessageIdName}`)}hb.a(R)||(O.ULS.sendTraceTag(507565777,0,50,"PivotDropDownContextMenu::OnGetFilterByValueItems service call succeeded"),R=R.Result,
cb=new mb.a(!0),R.PivotFilterItemsList&&R.PivotFilterItemsList.PivotFilterItems&&cb.add("FilterItemsCount",R.PivotFilterItemsList.PivotFilterItems.length),cb.add("Location","contextMenu"),R={filterByValueItems:this.eEa(R.PivotFilterItemsList),hasMoreRecords:R.PivotFilterItemsList.ItemListMaxExceeded},this.m7.onGetFilterByValueItemsFinish(R))}}t_b(){return R=>{this.rG=this.RC=null;R=Ba.a.te(R.data);R=Ma.a.pc(R);this.tl?Ga.a.Kl(Ib.XU,kb.a.yIf,eb.a.rLd,!1,!0):O.ULS.sendTraceTag(507565776,0,10,`PivotDropDownContextMenu.OnGetFilterByValueItemsFailureCallback Errors: [${R}].`)}}dae(){return R=>
{this.rG=this.RC=null;R=Ba.a.te(R.data);R=Ma.a.pc(R);this.tl?Ga.a.Kl(Ib.XU,kb.a.qOg,eb.a.exg,!1,!0):O.ULS.sendTraceTag(507028416,0,10,`PivotDropDownContextMenu.onSearchInFilterFailureCallback Errors: [${R}].`)}}OZj(){return R=>{this.rG=this.RC=null;R=Ba.a.te(R.data);R=Ma.a.pc(R);this.tl?Ga.a.Kl(Ib.XU,kb.a.dMf,eb.a.MGa,!1,!0):O.ULS.sendTraceTag(507028387,0,10,`PivotDropDownContextMenu.onGetPivotMenuAndFilterDataFailureCallback Errors: [${R}].`)}}F8d(){return R=>{this.rG=this.RC=null;R=Ba.a.te(R.data);
R=Ma.a.pc(R);this.tl?Ga.a.Kl(Ib.XU,kb.a.U7e,eb.a.dxg,!1,!0):O.ULS.sendTraceTag(507028386,0,10,`PivotDropDownContextMenu.onApplyInFilterFailureCallback Errors: [${R}].`)}}eEa(R){const cb=f(R.PivotFilterItems),zb=[],V=[];let Ea=0,pb=0;R.HasBlanks&&(R=c(xa.a.instance.ia(782),R.IsBlanksSelected?Oa.Selected:Oa.NotSelected,Za.a.xnc),zb[Ea++]=R);for(const Jb of cb)-1!==Array.indexOf(Sb.a.Mgb,Jb.displayText)?V[pb++]=Jb:zb[Ea++]=Jb;return Array.prototype.concat(V,zb)}btd(R,cb,zb){return(V,Ea,pb)=>{const Jb=
Pa.M(this.$.ma.sa,this.cell,this.dataSourceIndex,this.Oi);Jb.fieldId=this.fieldId;Jb.parentId=R;Jb.needConnect=cb;return Pa.h(this.$.ma.sa,"GetPivotFilterData",Jb,Z.c(V,this.$1a()),Z.b(Ea,this.t_b()),pb,zb,4)}}GHb(R,cb){return(zb,V,Ea)=>{const pb=Pa.M(this.$.ma.sa,this.cell,this.dataSourceIndex,this.Oi);pb.fieldId=this.fieldId;pb.parentId=Nb.rla;pb.searchText=cb;pb.hierarchyLevel=this.e2;return Pa.h(this.$.ma.sa,"SearchPivotFilter",pb,Z.c(zb,this.U_b(cb)),Z.b(V,this.dae()),Ea,R,0)}}U_b(R){return cb=>
{this.rG=this.RC=null;if(Ga.a.X9(cb)){var zb=Ga.a.v7(cb);this.tl?Ga.a.Kl(Ib.searchPivotFilter,zb.MessageIdName,eb.a.exg,!0,!0):O.ULS.sendTraceTag(507565775,0,10,`PivotDropDownContextMenu::OnSearchInFilterSuccessCallback failed with Exception -${zb.MessageIdName}`)}hb.a(cb)||(O.ULS.sendTraceTag(507565774,0,50,"PivotDropDownContextMenu::onSearchInFilterSuccess service call succeeded"),cb=cb.Result,zb=new mb.a(!0),cb&&cb.PivotFilterItems&&zb.add("FilterItemsCount",cb.PivotFilterItems.length),zb.add("Location",
"contextMenu"),cb={filterByValueItems:this.eEa(cb),hasMoreRecords:cb.ItemListMaxExceeded,searchText:R},this.m7.onGetFilterByValueItemsFinish(cb))}}};Af.rla=-1;Af.DNb=268;Af=Nb=Object(L.__decorate)([Object(kc.d)(na.PivotDropDownContextMenuService),Object(L.__param)(0,Object(na.EwaControlService)()),Object(L.__param)(1,Object(na.RibbonControlsService)()),Object(L.__param)(2,Object(na.ContextMenuControllerService)()),Object(L.__param)(3,Object(na.ZoomService)()),Object(L.__param)(4,Object(na.InteractivityTrackerServiceIdentifier)()),
Object(L.__param)(5,Object(na.PivotFilterCacheService)()),Object(L.__param)(6,Object(na.SortFilterService)())],Af);Object(J.a)(Af,"PivotDropDownContextMenu",Ha.a,[]);var gf;let Qe=gf=class extends yb{constructor(R,cb,zb,V,Ea,pb){super(R,"PopulatePivotContextMenu",2123758504,912277356,pb,cb,zb,V,Ea)}get Sx(){return"PopulatePivotContextMenu"}get tB(){return Za.a.RCg}executeCommand(R,cb,zb){let V=!1;const Ea=cb.command;switch(Ea){case 37023044:V=this.LFd(zb,cb);se.b(this.$).kq(zb.rawEvent,"context_menu_pivot_filter",
null,["context-menu"]);break;case 541421805:case -569786022:V=this.QQd(R,cb)}return V?$b.Task.Va(!0):Va.a(Ea)}Rc(R,cb,zb){R=!1;switch(cb.command){case 37023044:R=!!zb;break;case 541421805:case -569786022:R=!0}return R}QQd(R,cb){var zb=8===R,V=this.$,Ea=ed.a(V),pb=ta.f(V).ha.ob.Wb;let Jb=R=null;zb&&Ea?(R=Ea.chartId,Jb=Ea.Zc):!zb&&pb&&(R=pb.floatingObject.id,Jb=pb.floatingObject.Zc);return gf.k8e(Jb,260)?(zb={},V.Zk(zb),zb.FirstColumn=zb.FirstRow=-1,V={["rawEvent"]:null,["pivotName"]:null,["cell"]:zb,
["requiresConfirmation"]:gf.k8e(Jb,64),["dataSourceIndex"]:Jb.ExternalSourceIndex},pb?(Ea=pb.floatingObject,V.domElement=pb.domElement,V.objectId=Ea.id,V.objectVersion=Ea.version):Ea&&(V.domElement=Ea.pv,V.objectId=Ea.chartId,V.objectVersion=Ea.Ldf),pb={AnchorType:7},pb.ChartId=R,pb.AnchorValue1=-1,pb.AnchorValue2=-1,V.optionalPivotMenuAnchorParameter=pb,this.LFd(V,cb)):!1}static k8e(R,cb){return(R.Attributes&cb)===cb}};Qe=gf=Object(L.__decorate)([Object(kc.d)(na.PivotFilterContextMenuService),Object(L.__param)(0,
Object(na.EwaControlService)()),Object(L.__param)(1,Object(na.RibbonControlsService)()),Object(L.__param)(2,Object(na.ContextMenuControllerService)()),Object(L.__param)(3,Object(na.ZoomService)()),Object(L.__param)(4,Object(na.PivotFilterCacheService)())],Qe);Object(J.a)(Qe,"PivotFilterContextMenu",yb,[]);var Aa;const Fb=Za.a.j3h;let Ta=Aa=class extends Ha.a{constructor(R,cb,zb,V,Ea,pb,Jb){super(R,"PopulatePivotPageFilterContextMenu",null,null,Fb,!0,!1,"PivotPageFilterContextMenuRoot",Jb,cb,!1,zb,
V);this.ME=this.Ura=null;this.fJa=!1;this.hAd=this.rG=this.MKb=this.RC=this.Nta=this.m7=this.E3=null;this.e2=0;this.ZNa=!1;this.lm=null;this.gWb=$a.EwaSettings.nYd();this.bT=0;this.cell=this.Oi=null;this.dataSourceIndex=0;this.Pb=this.fieldId=null;this.qm=()=>{this.iWa();this.$.fa.tie(this.qm)};this.Hj=()=>{this.iWa();this.$.fa.Av(this.Hj)};this.XU=zc=>{var Mc=!!zc.searchText,od=this.$.ma.sa.mc();Mc?(Mc=168,zc=this.GHb(null,zc.searchText)):(Mc=167,zc=this.btd(Aa.rla,!1,null));this.MKb=od.RequestId;
this.Nta&&!this.Nta.dequeueUtcTime&&(this.$.userOperationManager.Sia(this.Nta),this.cud());od=new Sa.a(Mc,0,zc,80);this.Nta=this.$.userOperationManager.enqueueOperation(od,null);this.rG=this.hAd;this.RC=this.MKb};this.onMenuItemClick=(zc,Mc,od)=>{pa.b(this.$).Jd(Na.a.u3j,fc.g(),void 0,!0);Mc={["CommandValueId"]:Mc,["MenuItemId"]:Mc,["InputMethod"]:od,["TopCellAddress"]:this.ME};const Td=new da.a(zc,od,this.$.isEditMode?2:1,19,null);this.$.Ia.Gb(Td,Mc);O.ULS.sendTraceTag(507779162,0,50,`PivotPageFilterContextMenu::OnMenuItemClick ${zc}, ${od}`)};
this.focusShiftOnMenuDismiss=()=>{ta.f(this.$).focus()};this.cpb=zc=>{this.bT=Date.now();if(zc.checkedItems&&zc.checkedItems.length){pa.b(this.$).Jd(Na.a.E8d,fc.g(),void 0,!0);1===zc.checkedItems.length&&"[AllSearchResultsAndAddCurrentSelection]"===zc.checkedItems[0]&&(zc.checkedItems[0]="[AllSearchResults]",zc.checkedItems.push("[AddCurrentSelection]"));var Mc=b(this.cell,this.fieldId,this.dataSourceIndex,this.Oi,this.e2),od=Zd=>{var xe={["ToggleFilterOperationCount"]:0,["ApplyFilterTime"]:this.bT?
Date.now()-this.bT:-1,["ToggleAndApplyFilterTime"]:0};O.ULS.sendTraceTag(507601546,0,50,`PivotPageFilterContextMenu::ApplyFilterByValue Perf Telemetry : ${JSON.stringify(xe)}`);Ga.a.X9(Zd)&&(xe=Ga.a.v7(Zd),this.tl?Ga.a.Kl(Ib.applyItemFilter,xe.MessageIdName,eb.a.fxg,!0,Ga.a.BIa(xe.MessageId)):O.ULS.sendTraceTag(507601545,0,10,`PivotPageFilterContextMenu::OnApplyFilterByValue failed with Exception -${xe.MessageIdName}`));hb.a(Zd)||(O.ULS.sendTraceTag(507601544,0,50,"PivotPageFilterContextMenu::OnApplyFilterByValue service call succeeded"),
pa.b(this.$).Jd(Na.a.YNc,fc.g(),void 0,!0),this.m7.onApplyFilterByValueFinish({isSuccess:!0}),fc.k(this.$,this.ME))},Td=new Sa.a(208,0,(Zd,xe,pe)=>Pa.a(this.$.ma.sa,Mc,zc.checkedItems,Z.c(Zd,od),Z.b(xe,this.F8d()),pe,null,null),134,()=>new oa.a(zc.checkedItems,Mc));(()=>{this.$.userOperationManager.enqueueOperation(Td,null)})()}else O.ULS.sendTraceTag(507779161,0,15,"PivotPageFilterContextMenu::OnApplyFilterByValue Received Zero checked items to apply filter on")};this.zoom=V;this.tl=Ga.a.Lkb();this.lm=
Ea}get Sx(){return"PopulatePivotPageFilterContextMenu"}get tB(){return Za.a.xkk}executeCommand(R,cb,zb){R=cb.command;switch(R){case 1701016594:return Ha.a.HFd(zb),$b.Task.Va(!0);case -32628781:return this.lRb(cb,zb),$b.Task.Va(!0);default:return Va.a(R)}}lRb(R,cb){R=aa.a.Xj(cb[ba.a.Bf]);this.cell=R.cell;this.dataSourceIndex=R.dataSourceIndex;if(this.fieldId=R.fieldId){this.Oi=R.optionalPivotAnchorParameter;R=0;var zb=null,V=-1,Ea=-1;this.Oi&&(R=this.Oi.AnchorType,zb=this.Oi.ChartId,V=this.Oi.AnchorValue1,
Ea=this.Oi.AnchorValue2);var pb={};pb.AnchorType=R;pb.ChartId=zb;pb.AnchorValue1=V;pb.AnchorValue2=Ea;this.Oi=pb;var Jb=cb.domEvent;sa.g(Jb);Jb&&Jb.target&&Jb.rawEvent?(cb=new wa.SheetProtection(this.$.qa),this.$.Zk(this.cell),this.ME=Ia.H(this.cell),cb.ie(8192)?na.SortFilterService.Oa()?this.$.fa.ug&&(this.ZNa||this.RYa(),this.g4a(Jb.target)):this.fJa?this.g4a(Jb):(this.E3=()=>{this.RYa();this.g4a(Jb);this.fJa=!0},this.iWa()):this.tl?Ga.a.Kl(Ib.lRb,kb.a.CAg,eb.a.W2a,!1,!0):O.ULS.sendTraceTag(507605397,
0,10,"PivotPageFilterContextMenu.handleShowPivotPageFilterMenu:protected sheet, cannot be modified")):this.tl?Ga.a.Kl(Ib.lRb,kb.a.Jqf,eb.a.W2a,!1,!0):O.ULS.sendTraceTag(507605398,0,10,"PivotPageFilterContextMenu.handleShowPivotPageFilterMenu:domEvent is undefined.")}else this.tl?Ga.a.Kl(Ib.lRb,kb.a.QAf,eb.a.W2a,!1,!0):O.ULS.sendTraceTag(507364559,0,10,"PivotPageFilterContextMenu.handleShowPivotPageFilterMenu:fieldId is undefined.")}Rc(R,cb,zb){switch(cb.command){case 1701016594:case -32628781:return!!zb;
default:return!1}}l1b(R){R.MenuSectionList.push(...this.Ura)}RYa(){this.m7=sortFilter.PivotPageFilterControllerFactoryGlobal.createPivotPageFilterController({getFilterByValueItemsRequest:this.XU,applyFilterByValueRequest:this.cpb,onMenuItemClick:this.onMenuItemClick,focusShiftOnMenuDismiss:this.focusShiftOnMenuDismiss,filterMenuWidth:Aa.DNb});this.ZNa=!0}iWa(){this.$.fa.ug?Object(tc.loadChunkWithDynamicScriptLoader)("sortFilter",{xa:1}).then(()=>{this.E3()},R=>{this.tl?Ga.a.Kl(Ib.h6a,kb.a.pue,eb.a.W2a,
!1,!1):ia.a.yi(R,"PivotPageFilterContextMenu.filterScriptLoad")}):this.$.fa.Nr(this.Hj)}g4a(R){if(!$a.EwaSettings.PZd()){var cb=Sys.UI.DomElement.getBounds(R.target);var zb=cb.x+cb.width;cb=cb.y}this.cell||(this.tl?Ga.a.Kl(Ib.Brb,kb.a.jdf,eb.a.W2a,!0,!1):O.ULS.sendTraceTag(507779165,0,10,"PivotPageFilterContextMenu.renderReactMenu:Cell is undefined."));zb=Ha.a.dPb(this.$,this.cell);Ha.a.UTb(zb)||(this.tl?Ga.a.Kl(Ib.Brb,kb.a.eif,eb.a.W2a,!0,!1):O.ULS.sendTraceTag(507601547,0,10,"PivotPageFilterContextMenu.renderReactMenu:context menu cell not in view."));
(cb=Ha.a.oPb(this.$,zb,!0))?(zb=cb.x,cb=cb.y,zb=ta.f(this.$).rtl?new Sys.UI.Point(zb-this.zoomManager.Aqa(Aa.DNb),cb):new Sys.UI.Point(zb,cb),zb=this.zoomManager.B7(zb),zb={targetPoint:{left:zb.x,top:zb.y}},void this.$xe(R),this.m7.showPivotPageFilterMenu(zb,this.gWb?V=>{this.lm.kq(V,"context_menu_pivot_page_filter_apply",null,["context-menu-pivot-page-filter-items"])}:void 0)):this.tl?Ga.a.Kl(Ib.Brb,kb.a.CAf,eb.a.W2a,!0,!1):O.ULS.sendTraceTag(507779164,0,10,"PivotPageFilterContextMenu.renderReactMenu:\u00a0failed to get the context menu coordinates.")}async $xe(R){this.gWb?
this.lm.kq(R.rawEvent,"context_menu_pivot_page_filter",null,["context-menu-pivot-page-filter","context-menu-pivot-page-filter-items"]):(await kc.a.resolve(na.InteractivityTrackerServiceIdentifier)).kq(R.rawEvent,"context_menu_pivot_page_filter",null,["context-menu-pivot-page-filter"])}cud(){this.RC&&(O.ULS.sendTraceTag(507779163,0,15,`PivotPageFilterContextMenu.cancelSearchFilterItemListWebRequest Cancelling pending web request with ID=${this.RC}`),Pa.i(this.$.ma.sa,this.RC,null,null,null),this.RC=
null);this.rG&&(X.AFrameworkApplication.od.dy(this.rG.sx),this.rG=null)}$1a(){return R=>{this.rG=this.RC=null;if(Ga.a.X9(R)){var cb=Ga.a.v7(R);this.tl?Ga.a.Kl(Ib.getPivotFilterData,cb.MessageIdName,eb.a.zIf,!0,!0):O.ULS.sendTraceTag(507601543,0,10,`PivotPageFilterContextMenu::OnGetFilterByValueItemsSuccessCallback failed with Exception -${cb.MessageIdName}`)}hb.a(R)||(O.ULS.sendTraceTag(507779160,0,50,"PivotPageFilterContextMenu::OnGetFilterByValueItems service call succeeded"),R=R.Result,cb=new mb.a(!0),
R.PivotFilterItemsList&&R.PivotFilterItemsList.PivotFilterItems&&cb.add("FilterItemsCount",R.PivotFilterItemsList.PivotFilterItems.length),cb.add("Location","contextMenu"),R={filterByValueItems:this.eEa(R.PivotFilterItemsList),hasMoreRecords:R.PivotFilterItemsList.ItemListMaxExceeded,searchText:null},this.m7.onGetFilterByValueItemsFinish(R))}}t_b(){return R=>{this.rG=this.RC=null;R=Ba.a.te(R.data);R=Ma.a.pc(R);this.tl?Ga.a.Kl(Ib.XU,kb.a.yIf,eb.a.zIf,!1,!0):O.ULS.sendTraceTag(507779159,0,10,`PivotPageFilterContextMenu.OnGetFilterByValueItemsFailureCallback Errors: [${R}].`)}}dae(){return R=>
{this.rG=this.RC=null;R=Ba.a.te(R.data);R=Ma.a.pc(R);this.tl?Ga.a.Kl(Ib.XU,kb.a.qOg,eb.a.gxg,!1,!0):O.ULS.sendTraceTag(507028385,0,10,`PivotPageFilterContextMenu.onSearchInFilterFailureCallback Errors: [${R}].`)}}F8d(){return R=>{this.rG=this.RC=null;R=Ba.a.te(R.data);R=Ma.a.pc(R);this.tl?Ga.a.Kl(Ib.XU,kb.a.U7e,eb.a.fxg,!1,!0):O.ULS.sendTraceTag(507028384,0,10,`PivotPageFilterContextMenu.onApplyInFilterFailureCallback Errors: [${R}].`)}}eEa(R){const cb=f(R.PivotFilterItems),zb=[],V=[];let Ea=0,pb=
0;R.HasBlanks&&(R=c(xa.a.instance.ia(782),R.IsBlanksSelected?Oa.Selected:Oa.NotSelected,Za.a.xnc),zb[Ea++]=R);for(const Jb of cb)-1!==Array.indexOf(Sb.a.Mgb,Jb.displayText)?V[pb++]=Jb:zb[Ea++]=Jb;return Array.prototype.concat(V,zb)}btd(R,cb,zb){return(V,Ea,pb)=>{const Jb=Pa.M(this.$.ma.sa,this.cell,this.dataSourceIndex,this.Oi);Jb.fieldId=this.fieldId;Jb.parentId=R;Jb.needConnect=cb;return Pa.h(this.$.ma.sa,"GetPivotFilterData",Jb,Z.c(V,this.$1a()),Z.b(Ea,this.t_b()),pb,zb,4)}}GHb(R,cb){return(zb,
V,Ea)=>{const pb=Pa.M(this.$.ma.sa,this.cell,this.dataSourceIndex,this.Oi);pb.fieldId=this.fieldId;pb.parentId=Aa.rla;pb.searchText=cb;pb.hierarchyLevel=this.e2;return Pa.h(this.$.ma.sa,"SearchPivotFilter",pb,Z.c(zb,this.U_b(cb)),Z.b(V,this.dae()),Ea,R,0)}}U_b(R){return cb=>{this.rG=this.RC=null;if(Ga.a.X9(cb)){var zb=Ga.a.v7(cb);this.tl?Ga.a.Kl(Ib.searchPivotFilter,zb.MessageIdName,eb.a.gxg,!0,!0):O.ULS.sendTraceTag(507601542,0,10,`PivotPageFilterContextMenu::OnSearchInFilterSuccessCallback failed with Exception -${zb.MessageIdName}`)}hb.a(cb)||
(O.ULS.sendTraceTag(507779158,0,50,"PivotPageFilterContextMenu::onSearchInFilterSuccess service call succeeded"),cb=cb.Result,zb=new mb.a(!0),cb&&cb.PivotFilterItems&&zb.add("FilterItemsCount",cb.PivotFilterItems.length),zb.add("Location","contextMenu"),cb={filterByValueItems:this.eEa(cb),hasMoreRecords:cb.ItemListMaxExceeded,searchText:R},this.m7.onGetFilterByValueItemsFinish(cb))}}};Ta.rla=-1;Ta.DNb=268;Ta=Aa=Object(L.__decorate)([Object(kc.d)(na.PivotPageFilterContextMenuService),Object(L.__param)(0,
Object(na.EwaControlService)()),Object(L.__param)(1,Object(na.RibbonControlsService)()),Object(L.__param)(2,Object(na.ContextMenuControllerService)()),Object(L.__param)(3,Object(na.ZoomService)()),Object(L.__param)(4,Object(na.InteractivityTrackerServiceIdentifier)()),Object(L.__param)(5,Object(na.SortFilterService)())],Ta);Object(J.a)(Ta,"PivotPageFilterContextMenu",Ha.a,[]);var Eb=a(1458),oc=a(1267),Lc=a(268),Jd=a(429),Ab=a(368),Uc=a(33);const Od=Za.a.k3h,le=Od+".RemoveField",ge=Od+".Subtotal",
ze=Od+".ClearFilter",Le=Od+".LayoutSameColumn",nf=Od+".LayoutNextColumn";let cf=class extends Ha.a{constructor(R,cb,zb,V,Ea){super(R,"PopulatePivotTableContextMenu",-1475408662,1114549926,Od,!0,!1,"PivotTableContextMenuRootName",Ea,cb,!0,zb,V);this.pCe=this.activeCell=this.kc=null;this.MX=this.refresh=this.expandCollapse=this.tWd=this.GIc=!1;this.arb=this.Pb=this.Qeb=this.lD=this.xf=null;this.EXd=!1;this.YZj=pb=>{pb&&!Ma.a.zf(pb.Errors)&&this.kc&&(this.kc.Rr=pb.Result,this.a6b());this.showPivotTableContextMenu()};
this.XZj=()=>{};this.P2j=()=>{this.Esb()};this.O2j=()=>{this.Esb()};this.mTj=()=>{this.Esb()};this.lTj=()=>{this.Esb()};this.FI=()=>{this.rze();this.EXd=!1};this.Px=()=>{if(this.EXd){O.ULS.sendTraceTag(537167E3,0,50,"PivotTableContextMenu.OnAfterAllBlocksUpdated: Context menu was closed after changes were made by other users");const pb=this.kc;this.grid.Eb.eo(this.grid.ha.oa.activeCell)!==pb&&(this.Esb(),this.mcj())}};this.qji=new DOMParser;this.IQk=!0;this.grid=ta.f(R);this.MLc=!0}get Sx(){return"PopulatePivotTableContextMenu"}get tB(){return Za.a.SCg}executeCommand(R,
cb,zb){cb=cb.command;R=null;this.grid=ta.f(this.$);this.activeCell=Ia.r(this.grid.ha.oa.activeCell,this.$);if(this.$.isEditMode&&(this.kc=this.grid.Eb.eo(this.grid.ha.oa.activeCell),!this.kc))return O.ULS.sendTraceTag(537167007,0,10,"No PivotTable range found."),db.TaskExtensions.E7();this.pCe=this.$.ma.sa;this.Qeb=Object(Qa.a)(ec.a,zb.eventArgs);switch(cb){case 671488277:this.SSk()?this.OXi():(this.Esb(),this.showPivotTableContextMenu());break;case 1801458190:this.performPivotTableOperation(1801458190,
1);break;case -2016405815:this.performPivotTableOperation(-2016405815,6);break;case 671485366:this.performPivotTableOperation(671485366,7);break;case 772221736:this.performPivotTableOperation(772221736,8);break;case 1600778266:this.performPivotTableOperation(1600778266,2);break;case -556893687:this.performPivotTableOperation(-556893687,3);break;case -1966978671:this.performPivotTableOperation(-1966978671,4);break;case 1885005049:$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8346637_PivotTableDeleteInContextMenu")&&
this.performPivotTableOperation(1885005049,19);break;case -1683649734:$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualGroupingInPivotTables",!1)&&this.performPivotTableOperation(-1683649734,20);break;case 660506187:$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualGroupingInPivotTables",!1)&&this.performPivotTableOperation(660506187,21);break;case -1951357930:this.performPivotTableOperation(-1951357930,5);break;case -1390365353:this.performPivotTableOperation(-1390365353,
9);break;case -1457478532:this.performPivotTableOperation(-1457478532,10);break;case -771066011:this.lD.PivotValueFieldSummarizeValueByApplyData.Aggregation=2;this.applyValueFieldSettingsToPivotTable(-771066011,!0);break;case 1746132849:this.lD.PivotValueFieldSummarizeValueByApplyData.Aggregation=1;this.applyValueFieldSettingsToPivotTable(1746132849,!0);break;case 1475494885:this.lD.PivotValueFieldSummarizeValueByApplyData.Aggregation=6;this.applyValueFieldSettingsToPivotTable(1475494885);break;case 376946683:this.lD.PivotValueFieldSummarizeValueByApplyData.Aggregation=
11;this.applyValueFieldSettingsToPivotTable(376946683,!0);break;case 835007294:this.lD.PivotValueFieldSummarizeValueByApplyData.Aggregation=3;this.applyValueFieldSettingsToPivotTable(835007294,!0);break;case -413510754:$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableNewAggregations",!1)&&(this.lD.PivotValueFieldSummarizeValueByApplyData.Aggregation=12,this.applyValueFieldSettingsToPivotTable(-413510754,!0));break;case 929115636:this.lD.PivotValueFieldSummarizeValueByApplyData.Aggregation=
4;this.applyValueFieldSettingsToPivotTable(929115636,!0);break;case 1935475057:this.lD.PivotValueFieldSummarizeValueByApplyData.Aggregation=5;this.applyValueFieldSettingsToPivotTable(1935475057,!0);break;case 588680636:this.lD.PivotValueFieldSummarizeValueByApplyData.Aggregation=7;this.applyValueFieldSettingsToPivotTable(588680636);break;case -910892852:this.lD.PivotValueFieldSummarizeValueByApplyData.Aggregation=8;this.applyValueFieldSettingsToPivotTable(-910892852);break;case -1255320719:this.lD.PivotValueFieldSummarizeValueByApplyData.Aggregation=
0;this.applyValueFieldSettingsToPivotTable(-1255320719,!0);break;case 1668427539:this.lD.PivotValueFieldSummarizeValueByApplyData.Aggregation=9;this.applyValueFieldSettingsToPivotTable(1668427539);break;case -1751371357:this.lD.PivotValueFieldSummarizeValueByApplyData.Aggregation=10;this.applyValueFieldSettingsToPivotTable(-1751371357);break;case -841863025:this.x5a(0,0);this.applyValueFieldSettingsToPivotTable(-841863025);break;case -178796371:this.x5a(7,0);this.applyValueFieldSettingsToPivotTable(-178796371);
break;case 786592977:this.x5a(6,0);this.applyValueFieldSettingsToPivotTable(786592977);break;case 767774849:this.x5a(5,0);this.applyValueFieldSettingsToPivotTable(767774849);break;case 282586693:this.x5a(9,0);this.applyValueFieldSettingsToPivotTable(282586693);break;case -1067664355:this.x5a(10,0);this.applyValueFieldSettingsToPivotTable(-1067664355);break;case -2031744961:zb=Number.parseInvariant(zb.MenuItemId.split(".")[2]);this.x5a(11,zb);this.applyValueFieldSettingsToPivotTable(-2031744961);break;
case -1007663920:this.applyPivotSort(1);break;case 234234584:this.applyPivotSort(2);break;case 1194992911:this.$.Dc(-1556797033,ba.a.Hb,8,null);break;case 1514686611:$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DisableManualFilterButtonOnRightClickContextMenuForPT",!1)||this.vBj();break;case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:zb=Number.parseInvariant(zb.MenuItemId);this.eZh(zb);break;case 1778578888:zb=Number.parseInvariant(zb.MenuItemId);this.XJh(zb);
break;case 2059542618:this.performPivotTableOperation(2059542618,11);break;case 713270357:this.performPivotTableOperation(713270357,12);break;case -1842411134:this.performPivotTableOperation(-1842411134,13);break;case 2054968064:this.performPivotTableOperation(2054968064,14);break;case 74278997:this.performPivotTableOperation(74278997,15);break;case 8572743:this.performPivotTableOperation(8572743,16);break;case 833996216:this.performPivotTableOperation(833996216,17);break;case 139202061:this.performPivotTableOperation(139202061,
18);break;default:R=Va.a(cb)}return R||db.TaskExtensions.E7()}Rc(R,cb){R=!1;switch(cb.command){case 671488277:R=wb.k(this.grid);break;case 1801458190:case -2016405815:case 671485366:case 772221736:R=!0;break;case 1600778266:R=!0;break;case -556893687:R=!0;break;case -1966978671:R=!0;break;case 1885005049:R=$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8346637_PivotTableDeleteInContextMenu");break;case -1683649734:R=$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualGroupingInPivotTables",
!1);break;case 660506187:R=$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualGroupingInPivotTables",!1);break;case -1951357930:R=!0;break;case -1390365353:case -1457478532:R=!0;break;case -249874296:case -771066011:case 1746132849:case 1475494885:case 376946683:case 835007294:case 929115636:case -413510754:case 1935475057:case 588680636:case -910892852:case -1255320719:case 1668427539:case -1751371357:R=!0;break;case -1128612833:case -841863025:case -178796371:case 767774849:case 786592977:case 282586693:case -1067664355:case -2031744961:R=
!0;break;case -1007663920:case 234234584:case 1194992911:R=!0;break;case 1514686611:case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:case 1778578888:R=!0;break;case 2059542618:case 713270357:case -1842411134:case 2054968064:case 74278997:case 8572743:case 833996216:case 139202061:R=!0}return R}SSk(){if(!this.$.isEditMode||this.kc.HFc)return!1;const R=this.xre(!1);return $a.EwaSettings.isChangeGateEnabled("OfficeVSO:6214209_EnableFullRightClickMenuForExtNativePT")?!this.kc.isOlap||
R:!this.kc.jHc()||R}gd(R,cb){let zb=!1;switch(cb){case -249874296:case -1128612833:case 1801458190:case -1951357930:case -1390365353:case -1457478532:case 1600778266:case -556893687:case -1966978671:case 1514686611:case 1778578888:case 2059542618:case 713270357:case -1842411134:case 2054968064:case 74278997:case 8572743:case 833996216:case 139202061:zb=this.IL();break;case 1885005049:zb=!$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8346637_PivotTableDeleteInContextMenu")||this.IL();break;case -1683649734:zb=
!$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualGroupingInPivotTables",!1)||this.IL();break;case 660506187:zb=!$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualGroupingInPivotTables",!1)||this.IL();break;case -1007663920:case 234234584:zb=this.bRk()||this.IL();break;case 1194992911:zb=this.cRk()||this.IL();break;case 1217404289:zb=!oc.b(this.Pb.LabelOrDateFilterType)||this.IL();break;case -743135194:zb=!oc.e(this.Pb.ValueFilterType)&&!oc.d(this.Pb.ValueFilterType)||
this.IL();break;case 771421327:zb=0===this.Pb.LabelOrDateFilterType&&0===this.Pb.ValueFilterType&&!this.Pb.HasManualFilter||this.IL();break;case 1015867427:zb=!oc.a(this.Pb.LabelOrDateFilterType)||this.IL();break;case 1105960559:zb=!oc.c(this.Pb.LabelOrDateFilterType)||this.IL()}return zb||super.gd(R,cb)}Esb(){this.arb=this.Pb=this.xf=null}Ave(){this.grid.h6(this.Px);this.$.Ia.GFb(this.FI)}rze(){this.grid.yZ(this.Px);this.$.Ia.x3b(this.FI)}a6b(){if(this.kc&&this.kc.Rr){this.xf=this.kc.Rr;this.Pb=
this.kc.rzc();if(this.vVg()){const R=this.kc.BG[4===this.xf.CellType?this.kc.DAd-1:this.xf.CurrentFieldIndex-1];R&&(this.arb=-2===R.Index?this.kc.Rmf:R.Caption)}this.Cgj();this.Pb&&8===this.xf.CellArea&&(this.lD.PivotValueFieldSummarizeValueByApplyData.Aggregation=this.Pb.DataFieldAggregationType,this.lD.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=this.Pb.DataFieldFormatType,this.lD.PivotValueFieldShowValueAsApplyData.SelectedBaseField=this.Pb.BaseFieldIndex,this.lD.PivotValueFieldTitle=
this.Pb.Caption)}}xre(R){return this.kc?this.kc.isOlap&&!this.kc.Amb(!R):!1}iRk(){const R=$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1);return 1!==this.Pb.MeasureType&&(!this.kc.T3f||R&&2===this.Pb.MeasureType)}sX(){const R=this.Ya.pq(this.menuId),cb=this.Ya.uc(),zb=ta.f(this.$).Ob(null);if(this.kc)this.xf&&this.kc.Rr&&this.xf!==this.kc.Rr&&O.ULS.shipAssertTag(537167006,0,!1,"CurrentCellInfo is out of sync with cell info from PivotTable Range"),this.Pb&&
this.Pb!==this.kc.rzc()&&O.ULS.shipAssertTag(537167005,0,!1,"CurrentField is out of sync with field from PivotTable Range");else return R;this.lGi(R);if(this.$.isEditMode){this.refresh&&this.JHi(R);if($a.EwaSettings.isChangeGateEnabled("OfficeVSO:8346637_PivotTableDeleteInContextMenu")){var V=this.Ya.uc();this.uGi(V);R.Zb.push(V)}$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualGroupingInPivotTables",!1)&&(V=this.Ya.uc(),this.iHi(V),R.Zb.push(V));$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualGroupingInPivotTables",
!1)&&(V=this.Ya.uc(),this.hHi(V),R.Zb.push(V));this.xf&&this.Pb&&(V=this.Ya.uc(),this.$Hi(V),this.DGi(V),R.Zb.push(V));this.MX&&cb.buttons.push(this.Ya.yb(99));this.xf&&this.Pb&&this.dHi(R);if(this.expandCollapse){V=this.Ya.iu("ContextMenu.PivotExpandCollapse",null,xa.a.instance.ia(1167),589118293);const Ea=this.Ya.uc();Ea.buttons.push(this.Ya.yb(243));Ea.buttons.push(this.Ya.yb(244));Ea.buttons.push(this.Ya.yb(245));Ea.buttons.push(this.Ya.yb(246));V.menu.Zb.push(Ea);V&&0<Ea.buttons.length&&cb.buttons.push(V)}this.xf&&
(V=this.Ya.uc(),this.pHi(V),this.KHi(V),0<V.buttons.length&&R.Zb.push(V));this.xf&&this.Pb&&8===this.xf.CellArea&&8!==this.xf.CellType&&(V=this.Ya.uc(),this.iRk()&&this.bIi(V),3!==this.xf.CellType&&this.VHi(V),R.Zb.push(V));!this.kc.jHc()&&""!==(null===zb||void 0===zb?void 0:zb.text)&&this.xf&&0===this.xf.CellType&&this.UHi(R);this.Auj()?cb.buttons.push(this.Ya.yb(257)):cb.buttons.push(this.Ya.yb(258));this.tWd?cb.buttons.push(this.Ya.yb(59)):cb.buttons.push(this.Ya.yb(58))}R.Zb.push(cb);return R}I5a(){return this.Pb&&
this.Pb.Caption?20<this.Pb.Caption.length:!1}fXa(R){return this.Pb&&this.Pb.Caption?R?this.Pb.Caption.substring(0,20)+"...":this.Pb.Caption:""}AGa(R){return $a.EwaSettings.isChangeGateEnabled("OfficeVSO:5548525_FixLoggingColumnNameInButtonId")?$c.a.hashCode(R).toString():R}$Hi(R){if(this.xf&&this.Pb&&4!==this.xf.CellArea){var cb=this.lta(this.jN("PivotTableContextMenu.Sort",this.AGa(this.Pb.Caption)),-1777747317,0,0!==this.Pb.SortInfo,xa.a.instance.ia(227)),zb=this.Ya.uc();zb.buttons.push(this.Ie("PivotTableContextMenu.SortAscending",
-1007663920,0,1===this.Pb.SortInfo,xa.a.instance.ia(228)));zb.buttons.push(this.Ie("PivotTableContextMenu.SortDescending",234234584,0,2===this.Pb.SortInfo,xa.a.instance.ia(229)));1!==this.xf.CellArea&&2!==this.xf.CellArea||zb.buttons.push(this.Ie("PivotTableContextMenu.SortByValue",1194992911,0,3===this.Pb.SortInfo||4===this.Pb.SortInfo,xa.a.instance.ia(153)));cb.menu.Zb.push(zb);cb&&0<zb.buttons.length&&R.buttons.push(cb)}}DGi(R){if(this.xf&&this.Pb&&(1===this.xf.CellArea||2===this.xf.CellArea)){var cb=
this.RSk();const Ea=this.lta(this.jN("PivotTableContextMenu.Filter",this.AGa(this.Pb.Caption)),-1777747317,0,cb,xa.a.instance.ia(651)),pb=this.Ya.uc();var zb="";const Jb=this.I5a();var V=String.format(xa.a.instance.Ib(156),this.fXa(Jb));Jb&&(zb=String.format(xa.a.instance.Ib(156),this.Pb.Caption));cb=this.AGa(this.Pb.Caption)+"."+(cb?"enabled":"disabled");zb=this.Ie(this.jN(ze,cb),771421327,0,!1,V,"0",zb,8,Ub.a.Ygb);cb=this.AGa(this.Pb.Caption)+"."+this.Pb.LabelOrDateFilterType.toString();this.Pb.IsDateField?
(V=this.lta(this.jN("PivotTableContextMenu.DateFilter",cb),-1777747317,0,0!==this.Pb.LabelOrDateFilterType,xa.a.instance.ia(96)),this.oGi(V.menu)):(V=this.lta(this.jN("PivotTableContextMenu.LabelFilter",cb),-1777747317,0,0!==this.Pb.LabelOrDateFilterType,xa.a.instance.ia(649)),this.cHi(V.menu));cb=this.AGa(this.Pb.Caption)+"."+this.Pb.ValueFilterType.toString();cb=this.lta(this.jN("PivotTableContextMenu.ValueFilter",cb),-1777747317,0,0!==this.Pb.ValueFilterType,xa.a.instance.ia(650));this.nIi(cb.menu);
pb.buttons.push(zb);pb.buttons.push(V);pb.buttons.push(cb);Ea.menu.Zb.push(pb);$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DisableManualFilterButtonOnRightClickContextMenuForPT",!1)||(zb=this.Ya.uc(),zb.buttons.push(this.Ie("PivotTableContextMenu.ManualFilter",1514686611,0,this.Pb.HasManualFilter,xa.a.instance.ia(93))),Ea.menu.Zb.push(zb));Ea&&0<pb.buttons.length&&R.buttons.push(Ea)}}oGi(R){R.Zb.push(this.Vzc(!0,!1));R.Zb.push(this.sOi());R.Zb.push(this.rOi());R.Zb.push(this.JQi());
R.Zb.push(this.MQi());R.Zb.push(this.KQi());R.Zb.push(this.LQi());R.Zb.push(this.NQi());R.Zb.push(this.OQi());R.Zb.push(this.bOi())}bGi(R){R.Zb.push(this.Vzc(!0,!0));R.Zb.push(this.XYi());R.Zb.push(this.xVi())}cHi(R){R.Zb.push(this.Vzc(!0,!1));R.Zb.push(this.nIf(!0));R.Zb.push(this.nKi());R.Zb.push(this.fNi());R.Zb.push(this.kHf(!0));R.Zb.push(this.$Ff(!0))}nIi(R){R.Zb.push(this.Vzc(!1,!1));R.Zb.push(this.nIf(!1));R.Zb.push(this.kHf(!1));R.Zb.push(this.$Ff(!1));R.Zb.push(this.o3i())}o3i(){const R=
this.Ya.uc();R.buttons.push(this.Ie("PivotTableContextMenu.Top10",-1611233597,0,oc.d(this.Pb.ValueFilterType),xa.a.instance.ia(104)));return R}fNi(){const R=this.Ya.uc();this.Pb&&(R.buttons.push(this.Ie("PivotTableContextMenu.Contains",786260386,0,10===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(652),"10")),R.buttons.push(this.Ie("PivotTableContextMenu.DoesNotContain",786260386,0,11===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(653),"11")));return R}nKi(){const R=this.Ya.uc();this.Pb&&(R.buttons.push(this.Ie("PivotTableContextMenu.BeginsWith",
786260386,0,6===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(654),"6")),R.buttons.push(this.Ie("PivotTableContextMenu.DoesNotBeginWith",786260386,0,7===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(655),"7")),R.buttons.push(this.Ie("PivotTableContextMenu.EndsWith",786260386,0,8===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(656),"8")),R.buttons.push(this.Ie("PivotTableContextMenu.DoesNotEndWith",786260386,0,9===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(657),"9")));return R}nIf(R){const cb=
this.Ya.uc();if(this.Pb){const zb=R?Eb.c:Eb.f;cb.buttons.push(this.Ie(this.jN("PivotTableContextMenu.Equals",zb),786260386,0,R?4===this.Pb.LabelOrDateFilterType:18===this.Pb.ValueFilterType,xa.a.instance.ia(99),R?"4":"18"));cb.buttons.push(this.Ie(this.jN("PivotTableContextMenu.DoesNotEqual",zb),786260386,0,R?5===this.Pb.LabelOrDateFilterType:19===this.Pb.ValueFilterType,xa.a.instance.ia(100),R?"5":"19"))}return cb}kHf(R){const cb=this.Ya.uc();if(this.Pb){const zb=R?Eb.c:Eb.f;cb.buttons.push(this.Ie(this.jN("PivotTableContextMenu.GreaterThan",
zb),786260386,0,R?12===this.Pb.LabelOrDateFilterType:20===this.Pb.ValueFilterType,xa.a.instance.ia(101),R?"12":"20"));cb.buttons.push(this.Ie(this.jN("PivotTableContextMenu.GreaterThanOrEqualTo",zb),786260386,0,R?13===this.Pb.LabelOrDateFilterType:21===this.Pb.ValueFilterType,xa.a.instance.ia(658),R?"13":"21"));cb.buttons.push(this.Ie(this.jN("PivotTableContextMenu.LessThan",zb),786260386,0,R?14===this.Pb.LabelOrDateFilterType:22===this.Pb.ValueFilterType,xa.a.instance.ia(102),R?"14":"22"));cb.buttons.push(this.Ie(this.jN("PivotTableContextMenu.LessThanOrEqualTo",
zb),786260386,0,R?15===this.Pb.LabelOrDateFilterType:23===this.Pb.ValueFilterType,xa.a.instance.ia(659),R?"15":"23"))}return cb}$Ff(R){const cb=this.Ya.uc();if(this.Pb){const zb=R?Eb.c:Eb.f;cb.buttons.push(this.Ie(this.jN("PivotTableContextMenu.Between",zb),786260386,0,R?16===this.Pb.LabelOrDateFilterType:24===this.Pb.ValueFilterType,xa.a.instance.ia(103),R?"16":"24"));cb.buttons.push(this.Ie(this.jN("PivotTableContextMenu.NotBetween",zb),786260386,0,R?17===this.Pb.LabelOrDateFilterType:25===this.Pb.ValueFilterType,
xa.a.instance.ia(660),R?"17":"25"))}return cb}Vzc(R,cb){const zb=this.Ya.uc();if(this.Pb){var V=xa.a.instance.ia(97);const pb=R?this.Pb.LabelOrDateFilterType.toString():this.Pb.ValueFilterType.toString();var Ea=["PivotTableContextMenu.ClearFilter",this.AGa(this.Pb.Caption),pb];R=R?this.Pb.IsDateField?cb?1015867427:1105960559:1217404289:-743135194;Ea.push(R.toString());Ea=Ea.join(".");V=this.Ie(Ea,R,0,!1,V,pb,V,8,Ub.a.Ygb);zb.buttons.push(V)}return zb}sOi(){const R=this.Ya.uc();this.Pb&&R.buttons.push(this.Ie(this.jN("PivotTableContextMenu.Equals",
Eb.d),786260386,0,26===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(99),"26"));return R}rOi(){const R=this.Ya.uc();this.Pb&&(R.buttons.push(this.Ie("PivotTableContextMenu.Before",786260386,0,27===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(111),"27")),R.buttons.push(this.Ie("PivotTableContextMenu.After",786260386,0,28===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(112),"28")),R.buttons.push(this.Ie("PivotTableContextMenu.Between",786260386,0,29===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(103),
"29")));return R}JQi(){const R=this.Ya.uc();this.Pb&&(R.buttons.push(this.Ie("PivotTableContextMenu.Tomorrow",1778578888,0,30===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(109),"30")),R.buttons.push(this.Ie("PivotTableContextMenu.Today",1778578888,0,31===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(108),"31")),R.buttons.push(this.Ie("PivotTableContextMenu.Yesterday",1778578888,0,32===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(110),"32")));return R}MQi(){const R=this.Ya.uc();this.Pb&&(R.buttons.push(this.Ie("PivotTableContextMenu.NextWeek",
1778578888,0,33===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(114),"33")),R.buttons.push(this.Ie("PivotTableContextMenu.ThisWeek",1778578888,0,34===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(113),"34")),R.buttons.push(this.Ie("PivotTableContextMenu.LastWeek",1778578888,0,35===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(115),"35")));return R}KQi(){const R=this.Ya.uc();this.Pb&&(R.buttons.push(this.Ie("PivotTableContextMenu.NextMonth",1778578888,0,36===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(116),
"36")),R.buttons.push(this.Ie("PivotTableContextMenu.ThisMonth",1778578888,0,37===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(117),"37")),R.buttons.push(this.Ie("PivotTableContextMenu.LastMonth",1778578888,0,38===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(118),"38")));return R}LQi(){const R=this.Ya.uc();this.Pb&&(R.buttons.push(this.Ie("PivotTableContextMenu.NextQuarter",1778578888,0,39===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(119),"39")),R.buttons.push(this.Ie("PivotTableContextMenu.ThisQuarter",
1778578888,0,40===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(120),"40")),R.buttons.push(this.Ie("PivotTableContextMenu.LastQuarter",1778578888,0,41===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(121),"41")));return R}NQi(){const R=this.Ya.uc();this.Pb&&(R.buttons.push(this.Ie("PivotTableContextMenu.NextYear",1778578888,0,42===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(122),"42")),R.buttons.push(this.Ie("PivotTableContextMenu.ThisYear",1778578888,0,43===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(123),
"43")),R.buttons.push(this.Ie("PivotTableContextMenu.LastYear",1778578888,0,44===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(124),"44")));return R}OQi(){const R=this.Ya.uc();if(this.Pb){R.buttons.push(this.Ie("PivotTableContextMenu.YearToDate",1778578888,0,45===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(125),"45"));const cb=this.lta("PivotTableContextMenu.AllDatesInThePeriod",1778578888,0,oc.a(this.Pb.LabelOrDateFilterType),xa.a.instance.ia(126));this.bGi(cb.menu);R.buttons.push(cb)}return R}bOi(){const R=
this.Ya.uc();this.Pb&&R.buttons.push(this.Ie("PivotTableContextMenu.CustomFilter",786260386,0,this.MSk(this.Pb.LabelOrDateFilterType),xa.a.instance.ia(107),"26"));return R}XYi(){const R=this.Ya.uc();this.Pb&&(R.buttons.push(this.Ie("PivotTableContextMenu.Quarter1",1778578888,0,46===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(127),"46")),R.buttons.push(this.Ie("PivotTableContextMenu.Quarter2",1778578888,0,47===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(128),"47")),R.buttons.push(this.Ie("PivotTableContextMenu.Quarter3",
1778578888,0,48===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(129),"48")),R.buttons.push(this.Ie("PivotTableContextMenu.Quarter4",1778578888,0,49===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(130),"49")));return R}xVi(){const R=this.Ya.uc();this.Pb&&(R.buttons.push(this.Ie("PivotTableContextMenu.January",1778578888,0,50===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(131),"50")),R.buttons.push(this.Ie("PivotTableContextMenu.February",1778578888,0,51===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(132),
"51")),R.buttons.push(this.Ie("PivotTableContextMenu.March",1778578888,0,52===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(133),"52")),R.buttons.push(this.Ie("PivotTableContextMenu.April",1778578888,0,53===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(134),"53")),R.buttons.push(this.Ie("PivotTableContextMenu.May",1778578888,0,54===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(135),"54")),R.buttons.push(this.Ie("PivotTableContextMenu.June",1778578888,0,55===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(136),
"55")),R.buttons.push(this.Ie("PivotTableContextMenu.July",1778578888,0,56===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(137),"56")),R.buttons.push(this.Ie("PivotTableContextMenu.August",1778578888,0,57===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(138),"57")),R.buttons.push(this.Ie("PivotTableContextMenu.September",1778578888,0,58===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(139),"58")),R.buttons.push(this.Ie("PivotTableContextMenu.October",1778578888,0,59===this.Pb.LabelOrDateFilterType,
xa.a.instance.ia(140),"59")),R.buttons.push(this.Ie("PivotTableContextMenu.November",1778578888,0,60===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(141),"60")),R.buttons.push(this.Ie("PivotTableContextMenu.December",1778578888,0,61===this.Pb.LabelOrDateFilterType,xa.a.instance.ia(142),"61")));return R}dHi(R){const cb=this.Ya.uc();if(this.vVg()){var zb=this.kc.BG[4===this.xf.CellType?this.kc.DAd-1:this.xf.CurrentFieldIndex-1];if(zb&&this.arb){var V=this.Ya.iu("ContextMenu.PivotTableLayout",null,
xa.a.instance.ia(647),-1777747317);var Ea=this.Ya.uc();const pb=String.format(xa.a.instance.Ib(169),this.arb),Jb=String.format(xa.a.instance.Ib(170),this.arb);Ea.buttons.push(this.Ie(nf,-1457478532,0,!zb.IsCompactLayout,pb));Ea.buttons.push(this.Ie(Le,-1390365353,0,zb.IsCompactLayout,Jb));V.menu.Zb.push(Ea);V&&cb.buttons.push(V)}}if(1===this.xf.CellArea||2===this.xf.CellArea)this.Pb.Caption&&(zb="",Ea=this.I5a(),V=String.format(xa.a.instance.Ib(159),this.fXa(Ea)),Ea&&(zb=String.format(xa.a.instance.Ib(159),
this.Pb.Caption)),1===this.xf.CellArea?(zb=this.lta("ContextMenu.PivotTableSubtotal",1801458190,0,this.Pb.ShowSubtotal,V),V=this.Ya.uc(),V.buttons.push(this.Ya.yb(259)),V.buttons.push(this.Ie("ContextMenu.PivotTableSubtotalOnTop",671485366,639,this.Pb.ShowSubtotal&&this.Pb.ShowSubtotalAtTop)),V.buttons.push(this.Ie("ContextMenu.PivotTableSubtotalOnBottom",772221736,640,this.Pb.ShowSubtotal&&!this.Pb.ShowSubtotalAtTop)),zb.menu.Zb.push(V),zb&&0<V.buttons.length&&cb.buttons.push(zb)):(Ea=Ea?this.jN(ge,
this.AGa(V)):ge,cb.buttons.push(this.Ie(Ea,1801458190,0,this.Pb.ShowSubtotal,V,null,zb)))),cb.buttons.push(this.Ie("ContextMenu.RepeatItemLabels",-556893687,642,this.Pb.RepeatItemLabels));1===this.xf.CellArea&&cb.buttons.push(this.Ie("ContextMenu.PivotBlankLineAfterEachItem",1600778266,641,this.Pb.ShowBlankLineAfterEachItem));R.Zb.push(cb)}UHi(R){const cb=this.Ya.uc();cb.buttons.push(this.Ya.yb(247));R.Zb.push(cb)}pHi(R){if(this.$.isEditMode&&this.grid){var cb=this.grid.ha.oa.activeRange;if(cb.top===
cb.bottom&&cb.left===cb.right&&0!==this.xf.MoveItemsMenuState){cb=this.lta("PivotTableContextMenu.Move",-1777747317,0,!1,xa.a.instance.ia(73));var zb=this.Ya.uc();this.$Fa(zb,"PivotTableContextMenu.MoveToBeginning",2059542618,String.format(xa.a.instance.Ib(162),this.xf.MoveItemName),0===(this.xf.MoveItemsMenuState&1));this.$Fa(zb,"PivotTableContextMenu.MoveUp",713270357,String.format(xa.a.instance.Ib(163),this.xf.MoveItemName),0===(this.xf.MoveItemsMenuState&2));this.$Fa(zb,"PivotTableContextMenu.MoveDown",
-1842411134,String.format(xa.a.instance.Ib(160),this.xf.MoveItemName),0===(this.xf.MoveItemsMenuState&4));this.$Fa(zb,"PivotTableContextMenu.MoveToEnd",2054968064,String.format(xa.a.instance.Ib(161),this.xf.MoveItemName),0===(this.xf.MoveItemsMenuState&8));cb.menu.Zb.push(zb);zb=this.Ya.uc();this.$Fa(zb,"PivotTableContextMenu.MoveDataItemTop",74278997,String.format(xa.a.instance.Ib(167),this.fXa(this.I5a())),0===(this.xf.MoveItemsMenuState&16));this.$Fa(zb,"PivotTableContextMenu.MoveDataItemUp",8572743,
String.format(xa.a.instance.Ib(164),this.fXa(this.I5a())),0===(this.xf.MoveItemsMenuState&32));this.$Fa(zb,"PivotTableContextMenu.MoveDataItemDown",833996216,String.format(xa.a.instance.Ib(165),this.fXa(this.I5a())),0===(this.xf.MoveItemsMenuState&64));this.$Fa(zb,"PivotTableContextMenu.MoveDataItemBottom",139202061,String.format(xa.a.instance.Ib(166),this.fXa(this.I5a())),0===(this.xf.MoveItemsMenuState&128));cb.menu.Zb.push(zb);R.buttons.push(cb)}}}uGi(R){const cb=this.Ya.yb(301);R.buttons.push(cb)}iHi(R){const cb=
this.Ya.yb(306);R.buttons.push(cb)}hHi(R){const cb=this.Ya.yb(307);R.buttons.push(cb)}KHi(R){var cb="";let zb="";var V=!1;3===this.xf.CellType?cb=xa.a.instance.ia(644):8===this.xf.CellType?this.kc&&(cb=String.format(xa.a.instance.Ib(168),this.kc.Rmf)):this.Pb&&((V=this.I5a())&&(zb=String.format(xa.a.instance.Ib(168),this.Pb.Caption)),cb=String.format(xa.a.instance.Ib(168),this.fXa(V)));cb&&(V=V?this.jN(le,this.AGa(cb)):le,cb=this.Ie(V,-1951357930,0,!1,cb,null,zb,8,Ub.a.Yvc),R.buttons.push(cb))}lGi(R){const cb=
this.Ya.uc();cb.buttons.push(this.Ya.yb(43));if(this.Pb&&this.xf&&this.$.isEditMode&&(0===this.xf.CellType||4===this.xf.CellType)){var zb=de.a.olb()?this.Ya.yb(300):this.Ya.yb(136);cb.buttons.push(zb)}$a.EwaSettings.isChangeGateEnabled("OfficeVSO:7094993_ShowImageDetailsInPivotTableContextMenu")&&this.grid&&this.grid.ha&&(zb=this.grid.ha.oa.selectedRanges)&&1===zb.length&&(zb[0].isSingle||this.grid.Eb.mmb(zb[0]))&&this.grid.Eb.xIa(zb[0])&&!this.grid.Eb.wTb(zb[0])&&(this.grid.Eb.HTb(zb[0])?cb.buttons.push(this.Ya.yb(217)):
cb.buttons.push(this.Ya.yb(216)));R.Zb.push(cb)}JHi(R){const cb=this.Ya.uc();cb.buttons.push(this.Ya.yb(100));R.Zb.push(cb)}bIi(R){const cb=2===this.Pb.MeasureType&&!this.Pb.IsNumeric,zb=this.Ya.iu("ContextMenu.SummarizeValuesBy",null,xa.a.instance.ia(645),-249874296),V=this.Ya.uc();V.buttons.push(this.Ie("ContextMenu.SummarizeValuesBySum",-1255320719,1106,0===this.Pb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,cb));V.buttons.push(this.Ie("ContextMenu.SummarizeValuesByCount",1746132849,
1107,1===this.Pb.DataFieldAggregationType));V.buttons.push(this.Ie("ContextMenu.SummarizeValuesByAverage",-771066011,1108,2===this.Pb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,cb));V.buttons.push(this.Ie("ContextMenu.SummarizeValuesByMax",835007294,1109,3===this.Pb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,cb));V.buttons.push(this.Ie("ContextMenu.SummarizeValuesByMin",929115636,1110,4===this.Pb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,cb));$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableNewAggregations",
!1)&&V.buttons.push(this.Ie("ContextMenu.SummarizeValuesByMedian",-413510754,2426,12===this.Pb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,this.xre(!0)||cb));V.buttons.push(this.Ie("ContextMenu.SummarizeValuesByProduct",1935475057,1111,5===this.Pb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,this.xre(!0)||cb));2!==this.Pb.MeasureType&&(V.buttons.push(this.Ie("ContextMenu.SummarizeValuesByCountNumbers",1475494885,1112,6===this.Pb.DataFieldAggregationType)),V.buttons.push(this.Ie("ContextMenu.SummarizeValuesByStdDeviation",
588680636,1113,7===this.Pb.DataFieldAggregationType)),V.buttons.push(this.Ie("ContextMenu.SummarizeValuesByStdDeviationPercent",-910892852,1114,8===this.Pb.DataFieldAggregationType)),V.buttons.push(this.Ie("ContextMenu.SummarizeValuesByVariant",1668427539,1115,9===this.Pb.DataFieldAggregationType)),V.buttons.push(this.Ie("ContextMenu.SummarizeValuesByVariantPercent",-1751371357,1116,10===this.Pb.DataFieldAggregationType)));this.kc&&this.kc.jHc()?V.buttons.push(this.Ie("ContextMenu.SummarizeValuesByDistinctCountPPM",
376946683,1117,11===this.Pb.DataFieldAggregationType)):$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableNewAggregations",!1)&&V.buttons.push(this.Ie("ContextMenu.SummarizeValuesByDistinctCountPPM",376946683,1117,11===this.Pb.DataFieldAggregationType));zb.menu.Zb.push(V);R.buttons.push(zb)}VHi(R){const cb=this.Ya.iu("ContextMenu.ShowValuesAs",null,xa.a.instance.ia(646),-1128612833),zb=this.Ya.uc();zb.buttons.push(this.Ie("ContextMenu.ShowValuesAsNoCalculation",-841863025,1123,
0===this.Pb.DataFieldFormatType));zb.buttons.push(this.Ie("ContextMenu.ShowValuesAsPercentOfGrandTotal",-178796371,1130,7===this.Pb.DataFieldFormatType));zb.buttons.push(this.Ie("ContextMenu.ShowValuesAsPercentOfColumnTotal",786592977,1129,6===this.Pb.DataFieldFormatType));zb.buttons.push(this.Ie("ContextMenu.ShowValuesAsPercentOfRowTotal",767774849,1128,5===this.Pb.DataFieldFormatType));zb.buttons.push(this.Ie("ContextMenu.ShowValuesAsPercentOfParentRowTotal",282586693,1133,9===this.Pb.DataFieldFormatType));
zb.buttons.push(this.Ie("ContextMenu.ShowValuesAsParentColumnTotal",-1067664355,1134,10===this.Pb.DataFieldFormatType));if(this.kc&&this.kc.BG&&0<this.kc.BG.length||this.kc.oia&&0<this.kc.oia.length){const V=this.lta("ContextMenu.ShowValuesAsPercentOfParentTotal",-1128612833,1135,11===this.Pb.DataFieldFormatType),Ea=this.Ya.uc(),pb=this.aIi();for(let Jb=0;Jb<pb.length;Jb++){const zc=pb[Jb];Ea.buttons.push(this.Ie("ContextMenu.ShowValuesAsPercentOfParentTotal."+zc.Caption,-2031744961,1135,11===this.Pb.DataFieldFormatType&&
this.Pb.BaseFieldIndex===zc.Index,zc.Caption,"ContextMenu.ShowValuesAsPercentOfParentTotal."+zc.Index))}V.menu.Zb.push(Ea);zb.buttons.push(V)}cb.menu.Zb.push(zb);R.buttons.push(cb)}showPivotTableContextMenu(){var R;this.tWd=!0;this.expandCollapse=this.MX=this.refresh=!1;var cb=this.$,zb=ta.f(cb),V=null;kc.a.Cb(na.DataRefreshManagerService)?V=null===(R=kc.a.Cb(na.DataRefreshManagerService))||void 0===R?void 0:R.wQb():void kc.a.resolve(na.DataRefreshManagerService,{xa:0});if(V){R=kc.a.Cb(na.FieldManagerPaneService);
if(null===R||void 0===R?0:R.zre)this.tWd=Tc.g(cb.Pf);cb=cb.$b;this.MX=V.supportsBIExplore&&cb.Uaa(32768);cb.allowInteractivity&&(V=zb.Ob(null),(null===V||void 0===V?0:V.cell)&&(V.cell.Ptd||V.cell.rVg)&&(this.expandCollapse=!0),cb.allowManualDataRefresh&&(this.refresh=!0))}V=null;cb=1;this.Qeb&&1!==this.Qeb.Yb?(V=new Sys.UI.Point(this.Qeb.clientPoint.x,this.Qeb.clientPoint.y),cb=this.Qeb.Yb):(zb=wb.h(zb,this.$))&&(V=new Sys.UI.Point(zb.x+(this.$.isChromeRtl?0:zb.width),zb.y+zb.height));ba.a.Hb=cb;
this.GIc=3===cb;this.Xo(V,!0,cb);this.EXd=!0;this.Ave()}mcj(){const R=new da.a(1114549926,0,this.$.xc,19,null);this.$.Ia.Gb(R)}OXi(){if(this.kc&&this.kc.Rr){var R=this.kc.Rr.CurrentCol;if(this.kc.Rr.CurrentRow===this.activeCell.FirstRow&&R===this.activeCell.FirstColumn){this.a6b();this.showPivotTableContextMenu();return}}R=new Sa.a(228,0,(cb,zb,V)=>Ab.q(this.$.ma.sa,this.activeCell,Z.c(cb,this.YZj),Z.b(zb,this.XZj),V,null),16);this.$.userOperationManager.enqueueOperation(R,null)}Auj(){const R=kc.a.Cb(na.PivotTableSettingsPaneManagerService);
return R?R.cN:!1}jN(R,cb){return R+"."+cb}performPivotTableOperation(R,cb){const zb=Uc.a.zb.Jc;if(this.kc&&(this.Pb||!this.xf||3===this.xf.CellType||$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8346637_PivotTableDeleteInContextMenu")&&1885005049===R)){var V=this.kc.isOlap&&(!$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8346637_PivotTableDeleteInContextMenu")||1885005049!==R),Ea=pb=>{pb&&this.$.enqueueOperation(R,(Jb,zc,Mc)=>{var od=this.pCe,Td=this.activeCell,Zd=this.Pb?this.Pb.Caption:null,xe=
this.arb;Jb=Z.c(Jb,this.P2j);zc=Z.b(zc,this.O2j);var pe=this.$.ma.sa.mc();pe=od.$a(41,void 0===pe?null:pe);pe.activeCell=Td;pe.operationType=cb;pe.fieldCaption=Zd;pe.prevFieldCaption=xe;return Pa.h(od,"ExecutePivotTableOperation",pe,Jb,zc,Mc,null,0)},zb,0,4,229)};void kc.a.resolve(na.DataRefreshManagerService,{xa:0}).then(pb=>{pb.KH(V,Ea)})}else this.Wi()}applyValueFieldSettingsToPivotTable(R,cb){cb=void 0===cb?!1:cb;const zb=Uc.a.zb.Jc;if(this.kc&&this.Pb){cb&&2===this.Pb.MeasureType&&O.ULS.sendTraceTag(537167002,
0,50,"change aggregation type for an implicit measure from right click context menu.");var V=this.kc.isOlap,Ea=pb=>{pb&&this.$.enqueueOperation(R,(Jb,zc,Mc)=>{var od=this.pCe,Td=this.activeCell,Zd=this.lD;Jb=Z.c(Jb,this.mTj);zc=Z.b(zc,this.lTj);var xe=this.$.ma.sa.mc();xe=od.$a(41,void 0===xe?null:xe);xe.activeCell=Td;xe.pivotValueFieldSettingsApplyData=Zd;return Pa.h(od,"ApplyValueFieldSettingsToPivotTable",xe,Jb,zc,Mc,null,0)},zb,0,4,231)};void kc.a.resolve(na.DataRefreshManagerService,{xa:0}).then(pb=>
{pb.KH(V,Ea)})}else this.Wi()}Ie(R,cb,zb,V,Ea,pb,Jb,zc,Mc,od){Ea=void 0===Ea?null:Ea;pb=void 0===pb?null:pb;Jb=void 0===Jb?null:Jb;zc=void 0===zc?8:zc;Mc=void 0===Mc?null:Mc;od=void 0===od?!1:od;V&&(R+=".Checked");od&&(R+=".Disabled");this.Ya.TUd(R)&&this.Ya.Nhe(R);zb=Ea||xa.a.instance.ia(zb);R=this.Ya.yUa(R,zb,cb,null,"None",pb,od,null);R.Toe(null);Jb&&R.Ap(Jb);V?R.NZ("Image16by16",3,Ub.a.eja):Mc?R.NZ("Image16by16",zc,Mc):R.Rpc();return R}lta(R,cb,zb,V,Ea){zb=(void 0===Ea?null:Ea)||xa.a.instance.ia(zb);
this.Ya.TUd(R)?this.Ya.Nhe(R):this.Ya.Nhe(R+".Checked");V&&(R+=".Checked");this.IQk&&(zb=this.qji.parseFromString(zb,"text/html").body.innerText);R=this.Ya.P0(R,null,zb,cb,3,Ub.a.eja);R.EVf=V;!V&&$a.EwaSettings.isChangeGateEnabled("OfficeVSO:4877664_HidePivotTableContextMenuFlyoutCheckmark")&&R.Rpc();return R}Cgj(){this.lD=Object(U.a)(new Pd,{PivotValueFieldSummarizeValueByApplyData:Object(U.a)(new Jf,{Aggregation:-1}),PivotValueFieldShowValueAsApplyData:Object(U.a)(new wf,{SelectedDataFormat:-1,
SelectedBaseField:-1,SelectedBaseItem:-1}),PivotValueFieldTitle:null})}x5a(R,cb){this.lD.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=R;this.lD.PivotValueFieldShowValueAsApplyData.SelectedBaseField=cb;this.lD.PivotValueFieldShowValueAsApplyData.SelectedBaseItem=-1}aIi(){const R=[];if(this.kc&&this.kc.oia&&0<this.kc.oia.length)for(const cb of this.kc.oia)cb&&R.push(cb);if(this.kc&&this.kc.BG&&0<this.kc.BG.length)for(const cb of this.kc.BG)cb&&R.push(cb);R.sort((cb,zb)=>cb.Index-zb.Index);
return R}vVg(){if(!this.xf||!this.kc||!this.kc.BG)return!1;const R=1===this.xf.CellArea||4===this.xf.CellType&&this.xf.IsRowAxis,cb=4===this.xf.CellType?0<this.kc.DAd:0<this.xf.CurrentFieldIndex;return 1<this.kc.BG.length&&R&&cb}gXa(R){const cb=[];3===R?this.$.isEditMode?$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInEditMode",!1)&&this.$.isMobileMode?cb.push(...[Db.a.zce,Db.a.Ace]):cb.push(...[Db.a.zce,Db.a.Ace,Db.a.qbk]):cb.push(...[Db.a.copy]):2===R&&cb.push(Db.a.Cud);return cb}Wi(){const R=
Ma.a.Cd(1,0,0,648,0,104573951,"PivotTableContextMenuOperationFailure");Bb.a(this.$).Wi(R)}RSk(){return this.Pb?0!==this.Pb.LabelOrDateFilterType||0!==this.Pb.ValueFilterType||this.Pb.HasManualFilter:!1}MSk(R){return 62<=R&&65>=R}vBj(){if(this.activeCell&&this.Pb&&this.kc){var R={};R.cell=this.activeCell;R.dataSourceIndex=this.kc.externalSourceIndex;R.fieldId=this.Pb.Index.toString();R.isOlap=this.kc.isOlap;R.confirmationRequired=this.kc.confirmationRequiredForDataOps;var cb={};cb.showPivotFilterDialogCommandData=
R;this.$.Dc(492140419,ba.a.Hb,19,cb)}}eZh(R){this.activeCell&&this.Pb&&this.kc&&this.$.userOperationManager.enqueueOperation(new Sa.a(153,0,(cb,zb,V)=>Pa.B(this.$.ma.sa,this.activeCell,this.kc.externalSourceIndex,this.Pb.Index.toString(),R,cb,zb,V,null,null)),null)}XJh(R){!(30>R||61<R)&&this.activeCell&&this.Pb&&this.kc&&this.$.userOperationManager.enqueueOperation(new Sa.a(152,0,(cb,zb,V)=>Pa.e(this.$.ma.sa,this.activeCell,this.kc.externalSourceIndex,this.Pb.Index.toString(),R,cb,zb,V,null,null)),
null)}applyPivotSort(R){if(this.kc&&this.Pb&&this.activeCell&&this.xf){var cb=1===this.xf.CellArea||2===this.xf.CellArea;8===this.xf.CellArea?Jd.a(this.$.userOperationManager,(zb,V,Ea)=>Ab.b(this.$.ma.sa,this.activeCell,R,this.Pb.Caption,zb,V,Ea,null),zb=>new Sa.a(1015,0,zb,void 0,null),null):cb&&(cb=1===this.xf.CellArea?1:2,$a.EwaSettings.Ra(600)?Lc.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.kc.externalSourceIndex,this.Pb.Index.toString(),this.Pb.Caption,this.kc.isOlap?
"":this.Pb.Caption,cb,1===R):Lc.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.kc.externalSourceIndex,this.Pb.Index.toString(),1===R))}}IL(){return!this.kc||!this.kc.isActionable}bRk(){return(this.xf||this.kc)&&4!==this.xf.CellType&&(0!==this.xf.CellType||8!==this.xf.CellArea||this.kc.oia&&this.kc.oia.length||this.kc.BG&&this.kc.BG.length)?!1:!0}cRk(){return this.xf&&this.kc&&(1===this.xf.CellArea||2===this.xf.CellArea)&&this.kc.bac&&this.kc.bac.length?!1:!0}$Fa(R,
cb,zb,V,Ea){R.buttons.push(this.Ie(cb,zb,0,!1,V,null,null,8,null,Ea))}};cf=Object(L.__decorate)([Object(kc.d)(na.PivotTableContextMenuService),Object(L.__param)(0,Object(na.EwaControlService)()),Object(L.__param)(1,Object(na.RibbonControlsService)()),Object(L.__param)(2,Object(na.ContextMenuControllerService)()),Object(L.__param)(3,Object(na.ZoomService)())],cf);Object(J.a)(cf,"PivotTableContextMenu",Ha.a,[]);var Te=a(369),Wf=a(328);const Hf=Za.a.m3h;let ib=class extends Ha.a{constructor(R,cb,zb,
V,Ea){super(R,"PopulateTableFieldListContextMenu",-751848458,-1085236154,Hf,!0,!1,"TableFieldListContextMenuRoot",Ea,cb,!1,zb,V);this.qsc=null;this.R7d=0;this.nhc=null;this.grid=ta.f(R)}get Sx(){return"PopulateTableFieldListContextMenu"}get tB(){return Za.a.UCg}get mV(){this.nhc||(this.nhc=this.$.ra.Tb(261));return this.nhc}executeCommand(R,cb,zb){R=cb.command;switch(R){case 639960842:this.applyTableFieldList(zb);this.mV.Dsb();break;case -1085236154:O.ULS.sendTraceTag(537166999,0,50,`TableFieldListContextMenu:TableFieldListContextMenuClose, ColWithEntities, ${this.R7d}`);
this.mV.Dsb();break;case 1833782813:this.mV.showCallout();break;default:return Va.a(R)}return $b.Task.Va(!0)}applyTableFieldList(R){let cb=R.MenuItemId.toString();$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5239502_UpdatePulloutFieldNameContainingSplChars")&&(cb=cb.replace("'","''"),cb=cb.replace("[","'["),cb=cb.replace("]","']"));var zb=Object(Qa.a)(String,R.SourceControlId);const V={};V.PulloutField=cb;V.PulloutCardPath=R.SourceCardKeyPath;V.PulloutCardSourceRow=R.SourceCardRow;V.PulloutCardSourceColumn=
R.SourceCardColumn;V.PulloutExtractType=$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeGate.JsonStringReturnExtractType_2",!1)?R.ExtractType:null;if(this.mV.HY){O.ULS.sendTraceTag(38887748,0,50,"Table Pullout operation started");V.ParameterType=2;R=R.ColumnIndex;if(void 0===R||null===R){if(void 0===zb||null===zb){O.ULS.shipAssertTag(537166998,0,!1,"TableFieldListContextMenu: ApplyTableFieldList, must specifiy ColumnIndex or SourceControlId");return}R=0<=this.mV.GAg?this.mV.GAg:
parseInt(zb.substring(20+cb.length+1,zb.length),10);if(isNaN(R)){O.ULS.shipAssertTag(537166997,0,!1,`TableFieldListContextMenu:ApplyTableFieldListMalformatHTMLAttribute, Attribute, ${zb}`);return}}V.PulloutRichColumnSourceIndex=R;if(this.nhc.iHh){this.hIh(cb,V);return}}else O.ULS.sendTraceTag(38887749,0,50,"Grid Pullout operation started"),V.ParameterType=4,zb=this.mV.selectedRange.right,void 0!==V.PulloutCardSourceColumn&&null!==V.PulloutCardSourceColumn&&(zb=V.PulloutCardSourceColumn+1),V.PulloutRichColumnSourceIndex=
zb;this.TQg(cb,V)}TQg(R,cb,zb){zb=void 0===zb?0:zb;O.ULS.sendTraceTag(537166996,0,50,`TableFieldListContextMenu:ApplyTableFieldList, ColWithEntities, ${this.R7d}, SelectedColumnIndex, ${cb.PulloutRichColumnSourceIndex}`);R=Object(U.a)(new Wf.a,{Text:R});this.grid.setCell(R,this.mV.LJa,0,127,cb,zb);this.grid.focus();this.qsc=null;this.mV.Dsb();this.mV.Hyk()}Rc(R,cb,zb){if(R=this.$.isEditMode&&$a.EwaSettings.Ra(128)&&!!this.mV)switch(cb.command){case -1085236154:break;case 639960842:R=!!zb;break;case 1833782813:R=
this.mV.PHa&&this.mV.aKc;break;default:R=!1}return R}sfa(R,cb,zb){this.$.isEditMode&&(this.qsc=this.mHi(Object(Qa.a)(579,zb)),super.sfa(R,cb,null,null,!1))}sX(){return this.qsc}Iyd(R){if(!this.mV||!R||!R.Yr)return O.ULS.shipAssertTag(537166994,0,!!this.mV,"TableFieldListContextMenu:CreateContextMenuItemList PulloutManager null"),O.ULS.shipAssertTag(537166993,0,!!R,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager null"),R&&O.ULS.shipAssertTag(537166992,0,!!R.Yr,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager.FieldInfoListContextList null"),
null;const cb=[];for(const zb of R.Yr){R=[zb.ColumnName,zb.ColumnIndex.toString()];const V=zb.FieldInfoDataList.map(Ea=>Ea.Name).sort($c.b);cb.push([...R,...V])}return cb}mHi(R){var cb=this.Iyd(R);if(!cb||!cb.length)return this.qsc=null;const zb=this.Ya;R=zb.uc();const V=1<cb.length;this.R7d=cb.length;for(var Ea of cb){V||(R.title=Ea[0]);cb=zb.uc();for(let pb=2,Jb=Ea.length;pb<Jb;++pb)(V?cb.buttons:R.buttons).push(zb.yUa("ApplyTableFieldList."+Ea[pb]+"."+Ea[1],Ea[pb],639960842,null,"None",Ea[pb],
!1,void 0,!0));if(V){const pb=zb.iu("ApplyTableFieldList."+Ea[0],this.menuId,Ea[0],798637440);pb.menu.Zb.push(cb);R.buttons.push(pb)}}Ea=zb.pq(this.menuId);Ea.Zb.push(R);return Ea}hIh(R,cb){const zb=Ma.a.Cd(12,1,0,900,0,2007340793,"RichValuePulloutIntoNonEmptyRange"),V=new Te.a(this.$,zb);V.Paa(()=>{2===V.returnValue&&this.TQg(R,cb,8)})}};ib=Object(L.__decorate)([Object(kc.d)(na.PulloutFieldListContextMenuService),Object(L.__param)(0,Object(na.EwaControlService)()),Object(L.__param)(1,Object(na.RibbonControlsService)()),
Object(L.__param)(2,Object(na.ContextMenuControllerService)()),Object(L.__param)(3,Object(na.ZoomService)())],ib);Object(J.a)(ib,"PulloutFieldListContextMenu",Ha.a,[]);const xc=Za.a.$Cg;let Kc=class extends Ha.a{constructor(R,cb,zb,V,Ea){super(R,"PopulateRichTextContextMenu",679816325,1151222423,xc,!0,!1,xc,Ea,cb,!0,zb,V);this.grid=ta.f(R)}get Sx(){return"PopulateRichTextContextMenu"}get tB(){return Za.a.$Cg}Rc(R,cb,zb){return-1687037502===cb.command&&!!zb&&this.grid.isEditing}executeCommand(R,cb,
zb){this.showRichTextFloatie(zb);return $b.Task.Va(!0)}gXa(){return[Db.a.sWh]}showRichTextFloatie(R){var cb=Object(Qa.a)(ec.a,R.eventArgs);cb&&(R=this.gXa(cb.Yb),cb=new Sys.UI.Point(cb.Ha.clientX,cb.Ha.clientY),this.showFloatie(R,new Sys.UI.Bounds(cb.x,cb.y,0,0),2))}};Kc=Object(L.__decorate)([Object(kc.d)(na.RichTextContextMenuService),Object(L.__param)(0,Object(na.EwaControlService)()),Object(L.__param)(1,Object(na.RibbonControlsService)()),Object(L.__param)(2,Object(na.ContextMenuControllerService)()),
Object(L.__param)(3,Object(na.ZoomService)())],Kc);Object(J.a)(Kc,"RichTextContextMenu",Ha.a,[]);var ra=a(117),jb=a(212),vc=a(671),md=a(557),Qd=a(684);const v=Za.a.l3h;let Qb=class extends Ha.a{constructor(R,cb,zb,V,Ea,pb){super(R,"PopulateSheetOpsContextMenu",274207288,-1497523576,v,!0,!1,"SheetTabContextMenuRootName",pb,cb,!1,zb,V);this.Fsf=this.Hsf=this.Nsf=this.tIc=this.GUb=!1;this.copyPasteInfrastructure=Ea}get Sx(){return"PopulateSheetOpsContextMenu"}get tB(){return Za.a.aDg}executeCommand(R,
cb,zb){if(Ed.a(this.$))return $b.Task.Va(!0);this.$.isEditMode&&(this.Fsf=zb[Za.a.UTg],R=zb[Za.a.Qqe],R=R.x&&R.y?new Sys.UI.Point(R.x+(this.$.isChromeRtl?10:-10),R.y):Fe.DOMElementExtensions.getLocation({element:zb[Za.a.Rqe]}),this.Xo(R,!1));return $b.Task.Va(!0)}Rc(R,cb,zb){return-1075099431===cb.command&&!!zb}sX(){const R=this.Ya.pq(this.menuId);if(!$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInEditMode",!1)||!this.$.isMobileMode)if(this.Fsf)this.kHi(R);else{var cb=this.$.isEditMode;
this.V8g();this.ZGi(R,cb);if($a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)){var zb=this.Ya.uc();this.yEf(zb);R.Zb.push(zb);zb=this.Ya.uc();this.UEf(zb,cb);this.bFf(zb);R.Zb.push(zb);cb=this.Ya.uc();this.JEf(cb);this.xEf(cb);this.YEf(cb);this.MEf(cb);R.Zb.push(cb)}else cb=this.Ya.uc(),this.FEf(cb),R.Zb.push(cb),cb=this.Ya.uc(),this.YEf(cb),R.Zb.push(cb),cb=this.Ya.uc(),this.MEf(cb),R.Zb.push(cb)}return R}MEf(R){var cb;if($a.EwaSettings.isChangeGateEnabled("OfficeVSO:8501332_ShareExcelNamedSheetView")||
$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8728468_NSVContextMenuOptimization")){const zb=this.$.qa.la;(null===(cb=null===zb||void 0===zb?void 0:zb.ue)||void 0===cb?0:cb.Bq)&&this.sHi(R)}}kHi(R){const cb=this.Ya,zb=cb.uc();zb.buttons.push(cb.yb(360));this.OEf(zb);this.V8g();this.fSa(zb.buttons,!this.GUb,115,113);R.Zb.push(zb)}fSa(R,cb,zb,V){R.push(this.Ya.yb(cb?zb:V))}UEf(R,cb){R.buttons.push(this.Ya.yb(55));cb&&this.fSa(R.buttons,this.tIc,126,125)}OEf(R){this.Nsf=this.copyPasteInfrastructure.SVb()&&
this.copyPasteInfrastructure.Q0f()||this.copyPasteInfrastructure.SEa();this.fSa(R.buttons,!this.Nsf,341,340)}yEf(R){this.Hsf=this.$.qa.la&&xb.o(this.$.qa.la);vc.a.fIa?(this.fSa(R.buttons,!this.Hsf,339,338),this.OEf(R)):R.buttons.push(this.Ya.yb(158))}ZGi(R,cb){const zb=this.Ya,V=zb.uc();V.buttons.push(zb.yb(54));this.fSa(V.buttons,this.tIc,127,56);$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)&&(this.FEf(V),vc.a.fIa&&V.buttons.push(this.Ya.yb(158)));
$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)||(this.UEf(V,cb),vc.a.fIa&&V.buttons.push(this.Ya.yb(158)),this.yEf(V),this.xEf(V),this.JEf(V),this.bFf(V));R.Zb.push(V)}xEf(R){if($a.EwaSettings.isChangeGateEnabled("OfficeVSO:8218038_moveCanShareExcelSectionToHelper")&&md.a(this.$)||this.eIb())$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8575759_CopyLinkContextMenu")?R.buttons.push(this.Ya.yb(312)):R.buttons.push(this.Ya.yb(299))}JEf(R){if(this.$.fa.M6b&&
X.AFrameworkApplication.u8(jb.f)){const cb=Object(Qa.a)(ra.a,this.$.la);cb&&xb.o(cb)&&this.$.isEditMode&&(R.buttons.push(this.Ya.yb(277)),cb.isLockPausedInSession?R.buttons.push(this.Ya.yb(279)):cb.Ih&&R.buttons.push(this.Ya.yb(278)))}}bFf(R){const cb=this.Ya.iu("ContextMenu.TabColor",null,xa.a.instance.ia(518),1841703919),zb=this.Ya.eKb(467002767,1549407384,541,-221093529,de.a.aG()?-605730035:null,this.tB);cb.menu.Zb.push(zb);R.buttons.push(cb)}FEf(R){this.fSa(R.buttons,this.tIc,114,112);this.fSa(R.buttons,
!this.GUb,115,113)}YEf(R){$a.EwaSettings.Ra(418)&&!xb.e(this.$.qa.la)&&R.buttons.push(this.Ya.yb(263))}V8g(){const {uyd:R,gjf:cb}=this.$.tyd();this.tIc=1===R;this.GUb=0<cb}sHi(R){$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8728468_NSVContextMenuOptimization")&&R.buttons.push(this.Ya.yb(319));($a.EwaSettings.isChangeGateEnabled("OfficeVSO:8218038_moveCanShareExcelSectionToHelper")&&md.a(this.$,!0)||this.eIb(!0))&&$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8501332_ShareExcelNamedSheetView")&&R.buttons.push(this.Ya.yb(317))}eIb(R){var cb;
const zb=this.$.qa.la;return this.$.TK||!$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8096934_ShareExcelSection")||!md.b(this.$)||this.$.fa.isNamedObjectViewMode||this.$.isMobileMode||!($a.EwaSettings.isChangeGateEnabled("OfficeVSO:8501332_ShareExcelNamedSheetView")&&R||null===(cb=null===zb||void 0===zb?void 0:zb.ue)||void 0===cb)&&cb.Bq?!1:!0}};Qb=Object(L.__decorate)([Object(kc.d)(na.SheetOpsContextMenuService),Object(L.__param)(0,Object(na.EwaControlService)()),Object(L.__param)(1,Object(na.RibbonControlsService)()),
Object(L.__param)(2,Object(na.ContextMenuControllerService)()),Object(L.__param)(3,Object(na.ZoomService)()),Object(L.__param)(4,Object(Qd.c)())],Qb);Object(J.a)(Qb,"SheetOpsContextMenu",Ha.a,[]);var Dc=a(611);let id=class extends Ha.a{constructor(R,cb,zb,V,Ea){super(R,"PopulateSlicerContextMenu",-1920954846,723126814,"SlicerContextMenu",!0,!1,"SlicerContextMenuRootName",Ea,cb,!0,zb,V);this.zoom=V}get Sx(){return"PopulateSlicerContextMenu"}get tB(){return Za.a.bDg}gd(R,cb){var zb=!0;switch(cb){case -231711729:zb=
!1;break;case -1909381757:zb=this.Pta();zb=!!zb&&zb.yWd;break;case 1312363469:zb=!0}return!zb||super.gd(R,cb)}executeCommand(R,cb,zb){if(!this.$.isEditMode)return db.TaskExtensions.E7();R=cb.command;cb=this.Pta();let V=null;switch(R){case 2108047455:cb&&cb.qff();break;case -231711729:O.ULS.shipAssertTag(537166990,0,!1,"Shouldn't be hitting Slicer Refresh - NYI");break;case -1909381757:cb&&cb.XIb();break;case 1312363469:this.showSlicerContextMenu(zb);break;default:V=Va.a(R)}return V||db.TaskExtensions.E7()}Rc(R,
cb,zb){R=!1;switch(cb.command){case -231711729:case 2108047455:case -1909381757:R=!0;break;case 1312363469:R=!!zb}return R}sX(){const R=this.Ya.pq(this.menuId);var cb=this.Ya.uc();cb.buttons.push(this.Ya.yb(252));cb.buttons.push(this.Ya.yb(253));cb.buttons.push(this.Ya.yb(254));R.Zb.push(cb);cb=this.Ya.uc();this.$wj()?cb.buttons.push(this.Ya.yb(266)):cb.buttons.push(this.Ya.yb(267));R.Zb.push(cb);return R}$wj(){const R=kc.a.Cb(na.SlicerSettingsPaneManagerService);return R?R.cN:!1}showSlicerContextMenu(R){var cb=
Object(Qa.a)(ec.a,R.eventArgs);R=this.ZWa(Object(Qa.a)(ec.a,R.eventArgs));cb=cb.Yb;ba.a.Hb=cb;this.Xo(R,!1,cb)}$Ef(R){const cb=this.Ya.uc(),zb=this.Ya.uc();zb.buttons.push(this.Ya.yb(255));zb.buttons.push(this.Ya.yb(256));const V=this.Ya.P0("ContextMenu.SlicerSort",null,xa.a.instance.ia(2179),-814639094,0,Ub.a.Xwf);V.menu.Zb.push(zb);cb.buttons.push(V);R.Zb.push(cb)}mse(R){return R.sc.className===Ub.a.gNb||1===R.Yb}ZWa(R){var cb=ta.f(this.$).ha.ob.Wb;let zb=R&&1!==R.Yb&&R.clientPoint?R.clientPoint:
ic.HelperMethods.isStandardZoomCssSupportedByBrowser?Fe.DOMElementExtensions.getLocation({element:cb.domElement,di:!0}):Sys.UI.DomElement.getLocation(cb.domElement);if(this.mse(R)){var V=this.Pta();V&&(R.sc.className===Ub.a.gNb&&(zb=ic.HelperMethods.kPb(R.Ha)),1===R.Yb&&(zb=ic.HelperMethods.isStandardZoomCssSupportedByBrowser?Fe.DOMElementExtensions.getLocation({element:V.frame}):this.zoomManager.B7(Fe.DOMElementExtensions.getLocation({element:V.frame}))))}else if(R=this.Pta())R=this.MLd(R.frame),
(V=ic.HelperMethods.aE(this.$.Wf,this.$.domElement,ta.f(this.$).rtl,!1))?(R.x=this.zoomManager.sh(R.x-V.x)+V.x,R.y=this.zoomManager.sh(R.y-V.y)+V.y):O.ULS.sendTraceTag(537166989,0,15,"Cannot get constant pane size."),zb.y+=R.y,zb.x+=R.x;R=this.$.domElement;V=ta.f(this.$).rtl;cb=ic.HelperMethods.aE(cb.Ug.domElement,R,V);zb.y=Math.max(zb.y,cb.y);zb.x=Math.max(zb.x,cb.x);return zb}Pta(){const R=ta.f(this.$).ha.ob.Wb;O.ULS.shipAssertTag(537166988,0,!!R);return Dc.a(this.$).EK(R.floatingObject.id)}MLd(R){let cb=
new Sys.UI.Point(R.offsetParent.offsetLeft,R.offsetParent.offsetTop);var zb=ta.f(this.$);if(!zb)return cb;const V=ta.f(this.$).rtl;cb=ic.HelperMethods.aE(R,this.$.Su.ownerDocument.body,V);zb.lyd(cb);cb.x=V?this.$.Su.clientWidth-cb.x-R.clientWidth:cb.x;R=zb.view.t6;zb=V?-zb.Yea.sla(R.x):R.x;cb.x-=zb;cb.y-=R.y;return cb}};id=Object(L.__decorate)([Object(kc.d)(na.SlicerContextMenuService),Object(L.__param)(0,Object(na.EwaControlService)()),Object(L.__param)(1,Object(na.RibbonControlsService)()),Object(L.__param)(2,
Object(na.ContextMenuControllerService)()),Object(L.__param)(3,Object(na.ZoomService)())],id);Object(J.a)(id,"SlicerContextMenu",Ha.a,[]);var Md;let Sd=Md=class extends Ha.a{constructor(R,cb,zb,V,Ea){super(R,"PopulateTimeSlicerContextMenu",1851761031,429416385,Md.Ywe,!0,!1,Md.B4a,Ea,cb,!0,zb,V);this.zoom=V}get Sx(){return"PopulateTimeSlicerContextMenu"}get tB(){return Za.a.eDg}gd(R,cb){var zb=!0;switch(cb){case -741340954:zb=this.Pta();zb=!!zb&&zb.yWd;break;case 205863562:zb=!0}return!zb||super.gd(R,
cb)}executeCommand(R,cb,zb){if(!this.$.isEditMode)return db.TaskExtensions.E7();R=cb.command;cb=this.Pta();let V=null;switch(R){case -741340954:cb&&cb.XIb();break;case 205863562:this.showTimeSlicerContextMenu(zb);break;default:V=Va.a(R)}return V||db.TaskExtensions.E7()}Rc(R,cb,zb){R=!1;switch(cb.command){case -741340954:R=!0;break;case 205863562:R=!!zb}return R}sX(){const R=this.Ya.pq(this.menuId);var cb=this.Ya.uc();cb.buttons.push(this.Ya.yb(345));cb.buttons.push(this.Ya.yb(254));R.Zb.push(cb);
cb=this.Ya.uc();R.Zb.push(cb);return R}showTimeSlicerContextMenu(R){var cb=Object(Qa.a)(ec.a,R.eventArgs);R=this.ZWa(Object(Qa.a)(ec.a,R.eventArgs));cb=cb.Yb;ba.a.Hb=cb;this.Xo(R,!1,cb)}mse(R){return R.sc.className===Ub.a.gNb||1===R.Yb}ZWa(R){var cb=ta.f(this.$).ha.ob.Wb;let zb=R&&1!==R.Yb&&R.clientPoint?R.clientPoint:ic.HelperMethods.isStandardZoomCssSupportedByBrowser?Fe.DOMElementExtensions.getLocation({element:cb.domElement,di:!0}):Sys.UI.DomElement.getLocation(cb.domElement);if(this.mse(R)){var V=
this.Pta();V&&(R.sc.className===Ub.a.gNb&&(zb=ic.HelperMethods.kPb(R.Ha)),1===R.Yb&&(zb=ic.HelperMethods.isStandardZoomCssSupportedByBrowser?Fe.DOMElementExtensions.getLocation({element:V.frame}):this.zoomManager.B7(Fe.DOMElementExtensions.getLocation({element:V.frame}))))}else if(R=this.Pta())R=this.MLd(R.frame),(V=ic.HelperMethods.aE(this.$.Wf,this.$.domElement,ta.f(this.$).rtl,!1))?(R.x=this.zoomManager.sh(R.x-V.x)+V.x,R.y=this.zoomManager.sh(R.y-V.y)+V.y):O.ULS.sendTraceTag(507807046,0,15,"Cannot get constant pane size."),
zb.y+=R.y,zb.x+=R.x;R=this.$.domElement;V=ta.f(this.$).rtl;cb=ic.HelperMethods.aE(cb.Ug.domElement,R,V);zb.y=Math.max(zb.y,cb.y);zb.x=Math.max(zb.x,cb.x);return zb}Pta(){const R=ta.f(this.$).ha.ob.Wb;O.ULS.shipAssertTag(507807045,0,!!R);return Dc.a(this.$).UGa(R.floatingObject.id)}MLd(R){let cb=new Sys.UI.Point(R.offsetParent.offsetLeft,R.offsetParent.offsetTop);var zb=ta.f(this.$);if(!zb)return cb;const V=ta.f(this.$).rtl;cb=ic.HelperMethods.aE(R,this.$.Su.ownerDocument.body,V);zb.lyd(cb);cb.x=V?
this.$.Su.clientWidth-cb.x-R.clientWidth:cb.x;R=zb.view.t6;zb=V?-zb.Yea.sla(R.x):R.x;cb.x-=zb;cb.y-=R.y;return cb}};Sd.Ywe=Za.a.o3h;Sd.B4a="TimeSlicerContextMenuRootName";Sd=Md=Object(L.__decorate)([Object(kc.d)(na.TimeSlicerContextMenuService),Object(L.__param)(0,Object(na.EwaControlService)()),Object(L.__param)(1,Object(na.RibbonControlsService)()),Object(L.__param)(2,Object(na.ContextMenuControllerService)()),Object(L.__param)(3,Object(na.ZoomService)())],Sd);Object(J.a)(Sd,"TimeSlicerContextMenu",
Ha.a,[]);class ne{constructor(R,cb,zb){this.type=R;this.h3h=cb;this.Ti=zb}}Object(J.a)(ne,"TimeSlicerRibbonButtonParameter",null,[]);var Ce;let Ge=Ce=class extends Ha.a{constructor(R,cb,zb,V,Ea){super(R,"PopulateTimeSlicerLevelMenu",-227942804,1634477200,Ce.Ywe,!0,!1,Ce.B4a,Ea,cb,!1,zb,V);this.OUa=0;this.Prf=this.rXa=this.EDa=null;this.zoom=V}get Sx(){return"PopulateTimeSlicerLevelMenu"}get tB(){return Za.a.fDg}executeCommand(R,cb,zb){R=cb.command;switch(R){case 2000085697:R=zb.DOMElement;this.EDa=
zb.ChangeLevelCallback;this.rXa=zb.GetLevelLabelCallback;this.OUa=zb.CurrentLevel;const V=zb.DomEvent;sa.g(V);const Ea=zb.location;zb=zb.levelLabelText;this.Prf=Fe.DOMElementExtensions.MK(document.activeElement,"iframe")&&zb?zb.parentNode:null;zb=Sys.UI.DomElement.getBounds(zb);zb.x=Ea.x;zb.y=Ea.y;this.sfa(V,R,zb,cb,!0);break;case -649826274:this.EDa(0);break;case 149600865:this.EDa(1);break;case -2012435159:this.EDa(2);break;case -1979934975:this.EDa(3);break;case 1634477200:Fe.DOMElementExtensions.setFocus(this.Prf);
break;default:return Va.a(R)}return $b.Task.Va(!0)}Rc(R,cb,zb){R=!1;switch(cb.command){case 2000085697:R=!!zb;break;case -649826274:case 149600865:case -2012435159:case -1979934975:case 1634477200:R=!0}return R}sfa(R,cb,zb){R=ic.HelperMethods.isStandardZoomCssSupportedByBrowser?Fe.DOMElementExtensions.getBoundingClientRect({element:cb,di:!1}):Sys.UI.DomElement.getBounds(cb);ic.HelperMethods.isStandardZoomCssSupportedByBrowser||(zb.x=this.zoomManager.sh(zb.x),zb.y=this.zoomManager.sh(zb.y),R.x=this.zoomManager.sh(R.x),
R.y=this.zoomManager.sh(R.y));R=new Sys.UI.Point(R.x+zb.x,R.y+zb.y);this.showContextMenu(new Sys.UI.Bounds(R.x,R.y-zb.height,zb.width,zb.height))}sX(){const R=this.Ya,cb=R.pq(this.menuId),zb=R.uc();for(let Ea=0;3>=Ea;Ea++){const pb=this.rXa(Ea);var V=Ce.eLi(Ea);V=R.y5h(V.h3h,V.Ti,this.OUa===Ea,Ce.sef);V.label=pb;V.Ap(pb);this.OUa===Ea?V.NZ("Image16by16",8,Ce.sef):V.Rpc();zb.buttons.push(V)}cb.Zb.push(zb);return cb}static eLi(R){let cb=null;switch(R){case 0:cb=new ne(87,"ContextMenu.TimeSlicerLevelYear",
-649826274);break;case 1:cb=new ne(88,"ContextMenu.TimeSlicerLevelQuater",149600865);break;case 2:cb=new ne(89,"ContextMenu.TimeSlicerLevelMonth",-2012435159);break;case 3:cb=new ne(90,"ContextMenu.TimeSlicerLevelDay",-1979934975)}return cb}};Ge.Ywe=Za.a.n3h;Ge.B4a="TimeSlicerLevelMenuRootName";Ge.sef=Ub.a.wFa;Ge=Ce=Object(L.__decorate)([Object(kc.d)(na.TimeSlicerLevelMenuService),Object(L.__param)(0,Object(na.EwaControlService)()),Object(L.__param)(1,Object(na.RibbonControlsService)()),Object(L.__param)(2,
Object(na.ContextMenuControllerService)()),Object(L.__param)(3,Object(na.ZoomService)())],Ge);Object(J.a)(Ge,"TimeSlicerLevelMenu",Ha.a,[]);var Ee=a(1262),Ue=a(936),We=a(174),ya=a(401),Cb=a(4),qa=a(59);class qb extends Ue.a{constructor(R){super(R)}oq(){const R=this.$,cb=fb.a.jfb(this.Aa,"Task","IRootUser",$a.EwaSettings.Og()?null:qa.telemetryManager()),zb=We.a(R);let V=null;V=(xe,pe)=>{zb.yHg(V);cb.setResult(pe.grc)};zb.J4e(V);zb.NLf();const Ea=Object(Cc.d)(kc.a.resolve(na.RibbonControlsService,{xa:this.Cc})),
pb=Object(Cc.d)(kc.a.resolve(na.ContextMenuControllerService,{xa:this.Cc})),Jb=Jc.GetServiceTaskFactory.Ne(this.$.ra,254,255,this.Cc),zc=Object(Cc.d)(kc.a.resolve(na.ZoomService)),Mc=Object(Cc.d)(kc.a.resolve(na.FilteredResultsStatusBarManagerService,{xa:this.Cc}));let od;od=$a.EwaSettings.isChangeGateEnabled("OfficeVSO:8836799_AutoFilterItemsAsyncUiMeasurement")||$a.EwaSettings.nYd()?Object(Cc.d)(kc.a.resolve(na.InteractivityTrackerServiceIdentifier,{xa:this.Cc})):$b.Task.Va(null);const Td=na.SortFilterService.Oa()?
Object(Cc.d)(kc.a.resolve(na.SortFilterService,{xa:this.Cc})):$b.Task.Va(null),Zd=na.PivotFilterCacheService.Oa()?Object(Cc.d)(kc.a.resolve(na.PivotFilterCacheService,{xa:this.Cc})):$b.Task.Va(null);db.TaskExtensions.tb(db.TaskExtensions.jl([cb.task,Ea,pb,zc,Mc,Jb,od,Zd,Td],this.Aa),()=>{const xe=Ea.result,pe=cb.task.result,Re=pb.result;var pf=Jb.result;const vf=zc.result,Qf=Mc.result,yf=od.result,Df=Zd.result,pg=Td.result;pf=[new Da(R,xe,Re,vf,yf,Qf,pg,pe),new rc(R,xe,Re,vf,pe),new cd(R,xe,Re,vf,
pe),new kd(R,xe,Re,vf,Df,pe),new je(R,xe,Re,vf,pe),new fe(R,xe,Re,vf,pe),new Je.GridContextMenu(R,xe,Re,vf,Qf,pe),new Qe(R,xe,Re,vf,Df,pe),new Qb(R,xe,Re,vf,pf,pe),new Ge(R,xe,Re,vf,pe),new Sd(R,xe,Re,vf,pe),new ib(R,xe,Re,vf,pe),new Ud(R,xe,Re,vf,pe),new cf(R,xe,Re,vf,pe),new id(R,xe,Re,vf,pe),new Kc(R,xe,Re,vf,pe)];$a.EwaSettings.oVb()&&pf.push(new Ta(R,xe,Re,vf,yf,pg,pe));$a.EwaSettings.nVb()&&pf.push(new Af(R,xe,Re,vf,yf,Df,pg,pe));this.fn(pf)},R.Aa,3)}static initData(){const R=ya.a.xha;$a.EwaSettings.iFc()&&
(R(2045563128,Cb.a.Ba,80,0),R(1651433993,Cb.a.Ac|131072,0,0),R(1675506831,Cb.a.Ac|24576,0,0),R(-1793121409,Cb.a.Ac|24576,0,0),R(1378457149,Cb.a.Ac|212992,0,0),R(912277356,Cb.a.Ac|131072,0,0),R(2123758504,Cb.a.Ac|24576,0,0));R(1851761031,Cb.a.Ac|24576,0,0);R(429416385,Cb.a.Ac|131072,0,0);R(-741340954,128,128,0);R(2000085697,20479,0,0);R(-227942804,Cb.a.Ac|24576,0,0);R(1634477200,Cb.a.Ac|131072,0,0);R(-649826274,4095,0,0);R(149600865,4095,0,0);R(-2012435159,4095,0,0);R(-1979934975,4095,0,0);R(1247109494,
Cb.a.Ac|24576,0,0);R(-2064931494,Cb.a.Ac|131072,0,0);R(-1396319072,Cb.a.Ba,128,0);$a.EwaSettings.MQ()&&(R(-397772485,Cb.a.Ba,0,0),R(-81713080,Cb.a.Ba,0,0));R(-1253126584,Cb.a.Ba,0,0);R(274207288,Cb.a.Ac|24576,0,0);R(-1497523576,Cb.a.Ac|131072,0,0);R(-498523270,Cb.a.Ac|24576,64,0);R(1640762262,Cb.a.Ac|131072,64,0);R(-2017893763,Cb.a.Ac|24576,0,0);R(1350204367,Cb.a.Ac|131072,0,0);R(-889576107,Cb.a.wx,128,0);R(-1170196828,Cb.a.wx,128,0);R(389774337,Cb.a.wx,128,0);R(1529312473,Cb.a.wx,128,0);R(2033235475,
Cb.a.wx,128,0);R(-96230454,Cb.a.wx,128,0);R(74086617,Cb.a.wx,128,0);R(563292088,Cb.a.wx,128,0);R(-1092351914,Cb.a.wx,128,0);R(-2141589616,Cb.a.wx|16384,128,0);R(745182485,Cb.a.wx,0,0);R(359279088,Cb.a.wx,128,0);R(-67292059,Cb.a.wx,128,0);R(926905850,Cb.a.wx,128,0);R(547535945,Cb.a.wx,128,0);R(-2108836646,Cb.a.wx,128,0);R(1374696078,Cb.a.Ac|24576,0,0);R(495005930,Cb.a.Ac|212992,0,0);R(-1045020714,Cb.a.Ac|24576,0,0);R(-170383950,Cb.a.Ac|212992,0,0);R(324156914,Cb.a.Ba,0,0);R(-1085236154,Cb.a.rz,0,0);
R(-751848458,Cb.a.Am|16384,0,0);R(216058793,Cb.a.rz,0,0);R(474690375,Cb.a.Am|16384,0,0);R(-1920954846,Cb.a.Ac|24576,0,0);R(723126814,Cb.a.Ac|131072,0,0);R(2108047455,128,128,0);R(-231711729,128,128,0);R(-1909381757,128,128,0);R(-814639094,128,128,0);R(1701016594,Cb.a.Ac|3072,128,0);R(-1475408662,Cb.a.Ac|24576,0,0);R(1114549926,Cb.a.Ac|131072,32,0)}static Ea(R){Ue.a.cw(10,new qb(R))}}Object(J.a)(qb,"ContextMenuCommandHandlerFactory",Ue.a,[]);var bc=a(9);String(n);window.___1717508023589_closurehack=
n;a(1498);(()=>{qb.initData();bc.a.wb(R=>{$a.EwaSettings.iFc()||qb.Ea(R)})})();String(k);String(x);String(h);String(n);String(m);String(u);String(l);String(t);String(d);String(Ie);String(Je);String(e);String(w);String(z);String(E);String(M);String(G);String(A);String(N);String(K);String(I);String(Ee);window.___1717508060442_closurehack=k;window.___1717508060442_closurehack=x;window.___1717508060442_closurehack=h;window.___1717508060442_closurehack=n;window.___1717508060442_closurehack=m;window.___1717508060442_closurehack=
u;window.___1717508060442_closurehack=l;window.___1717508060442_closurehack=t;window.___1717508060442_closurehack=d;window.___1717508060442_closurehack=Ie;window.___1717508060442_closurehack=Je;window.___1717508060442_closurehack=e;window.___1717508060442_closurehack=w;window.___1717508060442_closurehack=z;window.___1717508060442_closurehack=E;window.___1717508060442_closurehack=M;window.___1717508060442_closurehack=G;window.___1717508060442_closurehack=A;window.___1717508060442_closurehack=N;window.___1717508060442_closurehack=
K;window.___1717508060442_closurehack=I;window.___1717508060442_closurehack=Ee},946:function(y,r,a){a.d(r,"a",function(){return Ha});y=a(0);var c=a(19);r=Object(c.b)("Common.App.UI.IPresenceContextMenuSectionBuilder");const b=Object(c.c)(r);var f=a(2),k=a(15),x=a(493),d=a(91),h=a(437),n=a(285),m=a(705),u=a(677),l=a(90),t=a(242),e=a(930);class w{static Veg(Za,fa){if(void 0===fa)return w.vLj(Za);const la=new e.a(fa);return ba=>{let aa;try{let oa=la.Od(ba,null);({value:aa}=oa);if(oa.returnValue)return aa}catch(oa){k.ULS.sendTraceTag(539890393,
344,10,"FuncExtensions memoize crash, dictionary length: {0}, error message: {1}",la.count,oa.message)}aa=Za(ba);la.add(ba,aa);return aa}}static vLj(Za){const fa=new Map;return la=>{if(fa.has(la))return fa.get(la);const ba=Za(la);fa.set(la,ba);return ba}}}Object(y.a)(w,"FuncExtensions",null,[]);var z=a(363),E=a(1657);r=a(661);var M=a(93),G=a(20),A=a(7),N=a(963),K=a(70),I=a(44),L=a(73),J=a(134),B=a(139),Y=a(1),U=a(12),O=a(28),C=a(13),X=a(25),S=a(1001),ea=a(5),Oa=a(65);class Ha extends M.a{constructor(Za,
fa,la,ba,aa,oa,Na,Ia,Sa,Pa,za,wa,db){super();this.MLc=!1;this.t8c=this.tad=this.DF=null;this.AWd=!1;this.GVc=this.QLb=null;this.SAe=!1;this.jC=()=>{this.DF?this.DF.jC():k.ULS.sendTraceTag(537167068,0,10,"ContextMenuBase.DismissFloatie: the context menu controller is null when attempintg to dismiss floatie on KeyDown.");this.h6g()};this.Qb=Za;this.zoom=db;this.$eg=aa;this.lid=Pa;this.Lxg=oa;this.populateOnlyOnce=Na;this.waj=za;this.ahe(wa)}get zoomManager(){return this.zoom.zoomManager}get EF(){return this.GVc}get $(){return this.Qb}get Ya(){return this.lid}get menuId(){return this.$.Oc+
this.$eg}get uOb(){this.tad||(this.tad=B.a(this.$));return this.tad}get qIb(){this.t8c||(this.t8c=X.f(this.$).Rb);return this.t8c}gd(Za,fa){Za=!0;switch(fa){case 1651433993:case 1675506831:case 966232027:Za=this.ie(4096)||this.ie(2048);break;case 2045563128:Za=this.ie(4096);break;case 912277356:case 2123758504:case -32628781:case 1569285147:case -1793121409:case 1378457149:Za=this.ie(8192)}return!Za}td(Za,fa,la){la.IsShadowMenuOpen||N.m(this.$,N.e);Za=!1;fa===this.Sx&&(la.IsShadowMenuOpen||N.m(this.$,
N.a),fa=Object(f.a)(new x.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]}),this.l1b(fa,la.IsShadowMenuOpen),la.MenuItems=fa,la.IsShadowMenuOpen||N.m(this.$,N.c),Za=!0);Za&&this.MLc&&U.HelperMethods.goc&&!la.IsShadowMenuOpen&&N.o(this.$);return Za}l1b(Za,fa){(fa=this.sX(fa))?(this.TUf(fa),Za.MenuSectionList.push(...fa.wH().MenuSectionList),this.TAh(Za)):k.ULS.sendTraceTag(537167105,0,10,"ContextMenuBase.PopulateContextMenuProps: CreateRibbonMenu() returned null instead of RibbonMenu instance")}sX(){k.ULS.sendTraceTag(537167104,
0,10,"ContextMenuBase.CreateRibbonMenu: This method should not be called if the menu is not ready for React!");return null}sfa(Za,fa,la,ba,aa){Za=Sys.UI.DomElement.getBounds(fa);fa=new Sys.UI.Point(Za.x,Za.y+Za.height);this.$.isChromeRtl&&(fa.x+=Za.width);this.Xo(fa,aa)}Xo(Za,fa,la,ba){la=void 0===la?0:la;ba=void 0===ba?!1:ba;fa&&(Za=this.zoomManager.B7(Za));fa=!0;if(this.waj)if(3===la)(ba=this.gXa(3))&&0<ba.length?(fa=!1,this.showFloatie(ba,new Sys.UI.Bounds(Za.x,Za.y,0,0),la)):k.ULS.sendTraceTag(537167075,
0,10,`ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the touch floatie groups. Context menu ID: ${this.menuId}`);else if(2===la){var aa=Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ProactiveColumnControls",!1);aa&&ba&&(fa=!1);this.$.isEditMode&&((ba=this.gXa(2,ba))&&0<ba.length?aa&&ba[0]===S.a.qgf&&ba[1]===S.a.fQf?this.showFloatie(ba,new Sys.UI.Bounds(Za.x,Za.y,0,0),la):ba[0]!==Ha.vCf?(fa=!1,Y.EwaSettings.isChangeGateEnabled("OfficeVSO:8782536_ChartElementSupportsContextMenu")?
(aa=X.f(this.$).ha.ob.Wb,!aa||0!==aa.floatingObject.type||aa.OWc()||aa.u5b()||aa.getContextMenuButtonList()&&0!==aa.getContextMenuButtonList().length?this.iZc(ba,new Sys.UI.Bounds(Za.x,Za.y,0,0),la):this.showFloatie(ba,new Sys.UI.Bounds(Za.x,Za.y,0,0),la)):this.iZc(ba,new Sys.UI.Bounds(Za.x,Za.y,0,0),la)):k.ULS.sendTraceTag(537167074,0,50,`ContextMenuBase.ShowAt: The context menu does not support floatie. Context menu ID: ${this.menuId}`):k.ULS.sendTraceTag(537167073,0,10,`ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the mouse floatie groups. Context menu ID: ${this.menuId}`))}fa&&
this.showContextMenu(new Sys.UI.Bounds(Za.x,Za.y,0,0),la)}gXa(){return null}INd(Za,fa){let la="";3===Za?la="touch":2===Za&&(la="mouse");return{["IsEditMode"]:this.$.isEditMode,["IsSLR"]:!!L.a.Eg&&L.a.Eg.SQ,["IsReactMLR"]:!!L.a.Eg&&L.a.Eg.C2,["IsNov"]:this.$.fa.isNamedObjectViewMode,["InputType"]:la,["FloatieGroups"]:JSON.stringify(void 0===fa?null:fa)}}showContextMenu(Za,fa){fa=void 0===fa?0:fa;const la=this.INd(fa);k.ULS.sendTraceTag(595359709,0,50,`ContextMenuBase.ShowContextMenu: rendering a context menu with given arguments: ${JSON.stringify(la)}`);
this.DF?this.tB!==A.a.Nfe&&this.tB!==A.a.Ofe||0===fa?this.DF.Sse(this.tB,Za,K.a.Hb):this.DF.Sse(this.tB,Za,fa):k.ULS.sendTraceTag(537167072,0,10,"ContextMenuBase.ShowContextMenu: the context menu controller is null when attempintg to show context menu.")}showFloatie(Za,fa,la){const ba=this.INd(la,Za);k.ULS.sendTraceTag(595359710,0,50,`ContextMenuBase.ShowFloatie: rendering a floatie with given arguments: ${JSON.stringify(ba)}`);this.DF?(this.NEg(),this.DF.Qub(Za,fa,la)):(Za=JSON.stringify(Za),k.ULS.sendTraceTag(537167071,
0,10,`ContextMenuBase.ShowFloatie: the context menu controller is null when attempting to show the floatie with floatieGroups ${Za}.`))}iZc(Za,fa,la){var ba=this.INd(la,Za);ba=JSON.stringify(ba);k.ULS.sendTraceTag(537167070,0,50,`ContextMenuBase.ShowContextMenuWithFloatie: rendering a floatie with given arguments: ${ba}`);this.DF?(this.NEg(),this.DF.Rse(Za,fa,la,this.tB)):k.ULS.sendTraceTag(587335491,0,10,"ContextMenuBase.ShowContextMenuWithFloatie: the context menu controller is null when attempintg to show floatie with ContextMenu.")}ahe(Za){this.DF=
Za}dispose(){this.$&&this.$.Ia.bsb(this);this.Qb=null;this.h6g();this.GVc&&(d.a.vb(this.GVc),this.GVc=null);super.dispose()}AGi(Za){var fa=this.$.ra.Tb(204);fa&&(fa=fa.nHi(this.$eg))&&Za.Zb.push(fa)}ie(Za){return(new J.SheetProtection(this.$.qa)).ie(Za)}TUf(Za){for(const fa of Za.Zb)if(Object(z.a)(303,fa)){Za=fa;Za.title&&(Za.title=this.SAe?Ha.RAd(Za.title):Ha.Dg(Za.title));for(const la of Za.buttons)Object(z.a)(246,la)?(Za=la,this.SAe?(Za.label=Ha.RAd(Za.label),Za.Ap(Ha.RAd(Za.alt))):(Za.label=Ha.Dg(Za.label),
Za.Ap(Ha.Dg(Za.alt)))):Object(z.a)(304,la)&&this.TUf(la.menu)}}Xeg(Za,fa){fa=void 0===fa?!1:fa;const la=[];for(const ba of Za)la.push(this.Q0(ba,fa));return la}Q0(Za){const fa=[];for(const la of Za.MenuItems)switch(la.Type){case 3:fa.push(this.l6h(la));break;case 2:fa.push(this.cbi(la));break;case 1:fa.push(this.M7h(la))}return Object(f.a)(new h.a,{ControlList:fa,Title:Za.Title,DisplayMode:"Menu16",MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0})}qyc(Za,
fa){fa=[this.QLb,Za.RibbonCommand.toString(),fa?this.uJf(fa):this.uJf(Za.Label),Za.Disabled?Za.Disabled.toString():"False"];let la=Za.CommandData;la=O.a.hashCode(la).toString();fa.push(la,Za.Identifier.toString());fa=fa.join("_");Za.IsChecked&&(fa+="_Checked");return fa}KEf(Za){const fa=[this.QLb,O.a.hashCode(Za.Title).toString()];for(const la of Za.MenuItems)fa.push(la.RibbonCommand.toString());return fa.join("_")}iJd(Za){var fa=Za.Label;fa=O.a.hashCode(fa).toString();fa=[this.QLb,fa];Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5139850_FixPivotFilterMenuDuplicatingIdenticalFields")&&
Za.Id&&fa.push(O.a.hashCode(Za.Id).toString());fa=fa.join("_");Za.IsChecked&&(fa+="_Checked");return fa}l6h(Za){const {label:fa,mua:la,Ti:ba}=this.LOb(Za,!1),aa=this.qyc(Za,fa);return Object(f.a)(new n.a,{Command:Za.Disabled?(-251203935).toString():ba.toString(),ExternalId:aa,Id:aa,Image16by16Class:la,LabelText:fa||Za.Label,MenuItemId:Za.CommandData,CommandValueId:Za.CommandData})}cbi(Za){const {label:fa,mua:la,Ti:ba}=this.LOb(Za,Za.IsChecked),aa=this.qyc(Za,fa);return Object(f.a)(new m.a,{Command:Za.Disabled?
(-251203935).toString():ba.toString(),ExternalId:aa,Id:aa,Image16by16Class:la,LabelText:fa||Za.Label,MenuItemId:Za.CommandData,CommandValueId:Za.CommandData,IsChecked:Za.IsChecked})}M7h(Za){const {label:fa,mua:la}=this.lJd(Za),ba=Object(f.a)(new x.a,{MenuSectionList:[],UpdateDynamically:!0});ba.MenuSectionList.push(...this.Xeg(Za.SubMenu.Sections,!0));const aa=this.iJd(Za);Za=fa||Za.Label;return Object(f.a)(new u.a,{ExternalId:aa,Id:aa,LabelText:Za,PopulateOnlyOnce:!1,Menu:ba,Image16by16Class:la,
ImageIsVisible:!!la})}lJd(Za){const {label:fa,mua:la,Ti:ba}=this.LOb(Za,!0);return{label:fa,mua:la,Ti:ba}}LOb(Za,fa){let la;switch(Za.Identifier){case 26:la=912804500;fa=G.a.$xf;Za=C.a.instance.ia(1951);break;case 3:la=-1902148570;fa=fa?G.a.eja:null;Za=C.a.instance.ia(1911);break;case 4:la=-1902148570;fa=fa?G.a.eja:null;Za=C.a.instance.ia(1912);break;case 5:la=-1902148570;fa=fa?G.a.eja:null;Za=null;break;case 1:la=-1677817820;fa=G.a.Wvc;Za=C.a.instance.ia(233);break;case 2:la=-1649376918;fa=Za.IsChecked?
G.a.wFa:null;Za=C.a.instance.ia(2122);break;case 23:la=1701016594;fa=Za.IsChecked?G.a.wFa:null;Za=C.a.instance.ia(2122);break;case 6:la=-87741481;fa=null;Za=C.a.instance.ia(2123);break;case 7:la=1948650742;fa=G.a.Rwf;Za=C.a.instance.ia(1949);break;case 8:la=1933713114;fa=G.a.Qwf;Za=C.a.instance.ia(1950);break;case 14:la=504133448;fa=G.a.RVa;Za=C.a.instance.ia(144);break;case 30:la=504133448;fa=G.a.RVa;Za=C.a.instance.La(744);break;case 32:la=504133448;fa=G.a.RVa;Za=C.a.instance.ia(148);break;case 34:la=
504133448;fa=G.a.RVa;Za=C.a.instance.ia(150);break;case 27:la=1701016594;fa=fa?G.a.$vc:G.a.RVa;Za=C.a.instance.ia(144);break;case 15:la=-798968736;fa=G.a.SVa;Za=C.a.instance.ia(146);break;case 31:la=-798968736;fa=G.a.SVa;Za=C.a.instance.La(745);break;case 33:la=-798968736;fa=G.a.SVa;Za=C.a.instance.ia(149);break;case 35:la=-798968736;fa=G.a.SVa;Za=C.a.instance.ia(151);break;case 28:la=1701016594;fa=fa?G.a.awc:G.a.SVa;Za=C.a.instance.ia(146);break;case 21:la=-2058042992;fa=G.a.Ygb;Za=null;break;case 29:la=
1701016594;fa=G.a.Ygb;Za=null;break;case 9:la=1701016594;Za=fa=null;break;case 11:la=-1494291901;Za=fa=null;break;case 25:la=-1045020714;fa=Za.IsChecked?G.a.wFa:null;Za=null;break;case 13:la=1701016594;fa=Za.IsChecked?G.a.wFa:null;Za=C.a.instance.ia(153);break;case 16:la=1701016594;fa=G.a.Mvc;Za=C.a.instance.ia(1082);break;case 17:la=1701016594;fa=G.a.Xgb;Za=null;break;case 18:la=1701016594;fa=G.a.Wgb;Za=null;break;case 19:la=1701016594;fa=G.a.Nvc;Za=C.a.instance.ia(1087);break;case 20:la=1701016594;
fa=G.a.IEd;Za=C.a.instance.ia(1088);break;case 24:la=1675506831;Za=fa=null;break;case 22:la=Za.RibbonCommand;fa=Za.IsChecked?G.a.eja:null;Za=null;break;case 36:la=1461300262;fa=null;Za=C.a.instance.ia(152);break;case 38:la=Za.RibbonCommand;fa=G.a.aFd;Za=C.a.instance.ia(1822);break;case 37:la=1461300262;fa=null;Za=C.a.instance.ia(155);break;default:k.ULS.shipAssertTag(537167069,0,!1,`Unable to map menu item: ${JSON.stringify(Za)}`),la=1461300262,Za=fa=null}return{label:Za,mua:fa,Ti:la}}uJf(Za){return O.a.hashCode(Za+
U.HelperMethods.JHk).toString()}TAh(Za){if(!this.$.fa.WW){var fa=Oa.a.Cb(ea.PresenceViewService);if(fa&&!l.a.isEmpty(fa.Fza)&&(fa=fa.Y4i(),!t.a.Zg(fa))){var la=[];Object(c.a)(b).x$h(fa,la);Za.MenuSectionList.push(...la)}}}NEg(){this.AWd||(this.uOb&&this.uOb.vlc(this.jC),this.qIb&&this.qIb.vlc(this.jC),this.AWd=!!this.uOb||!!this.qIb)}h6g(){this.uOb&&this.uOb.dUc(this.jC);this.qIb&&this.qIb.dUc(this.jC);this.AWd=!1}static dPb(Za,fa,la){fa=I.H(fa);Za=X.f(Za);return la?Za.shb(fa.left):Za.za.GGa(fa)}static UTb(Za,
fa){return fa?!!Za:!(null===Za||void 0===Za||!Za.Ak)}static oPb(Za,fa,la,ba){if(fa){var aa=X.f(Za);ba=ba?aa.XLd(fa):aa.getCellBounds(fa);aa=fa.J9e;fa=fa.G9e;var oa=ba.x+aa.x;ba=ba.y+aa.y;la&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")&&(X.f(Za).rtl||(oa+=fa),ba-=fa);return new Sys.UI.Point(oa,ba)}k.ULS.sendTraceTag(509220164,0,15,`ContextMenuBase.getContextMenuCoordinates:\u00a0cellProxy is undefined, isHeaderCommandData=${ba}`)}static HFd(Za){try{Object(E.a)(Za.CommandValueId)}catch(fa){}}static Dg(Za){const fa=
Ha.cgb.parseFromString(Za,"text/html");return fa?fa.body.innerText:(k.ULS.sendTraceTag(537167066,0,15,"Not able to decode htmlFormattedText"),Za)}}Ha.cgb=new DOMParser;Ha.vCf="Unsupported";Ha.RAd=Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StringComparerMemoizationForDecodeTextHtml",!1)?w.Veg(Ha.Dg,new r.a(!1)):w.Veg(Ha.Dg);Object(y.a)(Ha,"ContextMenuBase",M.a,[29,305,4])},963:function(y,r,a){function c(L,J){if(!m.EwaSettings.gVb())return!1;L=n.f(L);return L&&J&&-1!==J.top?(L=L.YWa())?
L.contains(J):!1:!1}a.d(r,"d",function(){return"ContextMenuEventStartMark"});a.d(r,"n",function(){return"ContextMenuPerf.A"});a.d(r,"b",function(){return"ContextMenuPerf.B"});a.d(r,"e",function(){return"ContextMenuPerf.C1"});a.d(r,"a",function(){return"ContextMenuPerf.C2"});a.d(r,"c",function(){return"ContextMenuPerf.D"});a.d(r,"h",function(){return l});a.d(r,"g",function(){return e});a.d(r,"j",function(){return w});a.d(r,"i",function(){return z});a.d(r,"f",function(){return E});a.d(r,"k",function(){return G});
a.d(r,"l",function(){return A});a.d(r,"m",function(){return N});a.d(r,"o",function(){return K});a.d(r,"p",function(){return c});var b=a(15),f=a(494),k=a(10),x=a(72),d=a(27),h=a(12),n=a(25),m=a(1),u=a(17);const l=(L,J)=>{var B=L.Ob(null);if((null===B||void 0===B?0:B.cell.Ak)&&t(B,L,J))return L.getCellBounds(B.cell);B=L.ha.oa.activeCell;return(J=M(new d.Range(B.top,B.left,k.a.sf,B.left,!1,!1),2,!0,L,J)||M(new d.Range(1,B.left,B.top,B.left,!1,!1),2,!1,L,J)||M(new d.Range(B.top,B.right,B.top,k.a.rf,!1,
!1),1,!0,L,J)||M(new d.Range(B.top,1,B.top,B.right,!1,!1),1,!1,L,J)||null)&&J.Ak?L.getCellBounds(J):h.HelperMethods.isStandardZoomCssSupportedByBrowser?u.DOMElementExtensions.getBounds({element:L.ZT.ud,di:!0}):Sys.UI.DomElement.getBounds(L.ZT.ud)},t=(L,J,B)=>{var Y=J.rtl,U=B.isChromeRtl;L=L.cell;return(B=n.f(B).qQ(L))?(B=B.topLeft,Y=B.x+=Y===U?L.offsetWidth:0,U=B.y+=L.offsetHeight,J.view.visibleArea.contains(new x.a(Y,U,0,0))):!1},e=L=>{let J=0;for(const B of L)L=B.right-B.left+1,J+=0<L?L:-1*L;return J},
w=L=>{const J=null===L||void 0===L?void 0:L.length;L.sort();return 1===J?L[0].top===L[0].bottom?d.Range.nF(L[0].top.toString(),!1):d.Range.nF(L[0].top.toString(),!1)+" - "+d.Range.nF(L[0].bottom.toString(),!1):1<J&&L[J-1].top-L[0].top+1===J?d.Range.nF(L[0].top.toString(),!1)+" - "+d.Range.nF(L[J-1].top.toString(),!1):""},z=L=>{let J=0;for(const B of L)J+=B.bottom-B.top+1;return J},E=L=>{const J=null===L||void 0===L?void 0:L.length;L.sort();return 1===J?L[0].left===L[0].right?d.Range.nF(d.Range.dK(L[0].left),
!1):d.Range.nF(d.Range.dK(L[0].left),!1)+" - "+d.Range.nF(d.Range.dK(L[0].right),!1):1<J&&L[J-1].right-L[0].left+1===J?d.Range.nF(d.Range.dK(L[0].left),!1)+" - "+d.Range.nF(d.Range.dK(L[J-1].right),!1):""},M=(L,J,B,Y,U)=>{L=Y.Np("ContextMenuHelper.FindFirstCellInViewportArea",L,J,B);try{for(L.$$rst();L.$$mn();){const O=L.$$cu();if(O&&t(O,Y,U))return O.cell}}finally{L&&L.dispose()}return null},G=L=>L.Eb.tU(L.ha.oa.activeCell),A=L=>{L=n.f(L).ha.oa;return L.vi&&(L.Ed.isRow||L.Ed.Oe)},N=(L,J)=>{h.HelperMethods.Nsd&&
window.performance.mark(J)},K=()=>{if(f.a.gTa){const L=m.EwaSettings.isChangeGateEnabled("OfficeVSO:8690935_CMServiceInitMarkerEnabled")?I("CMServiceInit","ContextMenuEventStartMark","ContextMenuPerf.A"):-1,J=I("OnContextMenuHandling","ContextMenuPerf.A","ContextMenuPerf.B"),B=I("PrepInfraWork","ContextMenuPerf.B","ContextMenuPerf.C1"),Y=I("EWAPopulation","ContextMenuPerf.C2","ContextMenuPerf.D");b.ULS.sendTraceTag(537167064,0,50,`ContextMenuHelper.ReportPerformanceIfSupported: ContextMenuServiceInit: [${L}], OnContextMenuHandling=[${J}], PrepInfraWork=[${B}], EWAPopulation =[${Y}]`)}},
I=(L,J,B)=>{window.performance.measure(L,J,B);J=window.performance.getEntriesByName(L);J.length||b.ULS.sendTraceTag(537167063,0,10,`ContextMenuHelper.MeasureTime: measure name [${L}] returned no measures.`);return J[J.length-1]?J[J.length-1].duration:-1}}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.ctxm.js.map/dac154af834086c40bc482adb70913a9/EwaTS.ctxm.js.map