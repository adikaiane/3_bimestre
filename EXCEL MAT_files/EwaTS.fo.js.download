'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[11],{1003:function(y,r,a){a.d(r,"h",function(){return h});a.d(r,"d",function(){return n});a.d(r,"a",function(){return m});a.d(r,"k",function(){return u});a.d(r,"n",function(){return l});a.d(r,"g",function(){return t});a.d(r,"i",function(){return e});a.d(r,"b",function(){return w});a.d(r,"p",function(){return z});a.d(r,"f",function(){return E});a.d(r,"l",function(){return M});a.d(r,"e",function(){return G});a.d(r,
"o",function(){return A});a.d(r,"j",function(){return N});a.d(r,"m",function(){return K});a.d(r,"c",function(){return I});var c=a(78),b=a(1127);a(72);var f=a(17),k=a(12),x=a(119),d=a(1);const h=L=>[1,1,2,3,3,3,2,1][L],n=L=>h((L+2)%8),m=(L,J)=>{x.a.rFb(L,x.a.HVc+J+x.a.htc,null)},u=(L,J,B)=>l(L,new Sys.UI.Point(0,0),J,B),l=(L,J,B,Y)=>{Y=Y?-1:1;return new Sys.UI.Point(k.HelperMethods.IVc((L.x-J.x)*B[0]+(L.y-J.y)*Y*B[1]+J.x),k.HelperMethods.IVc((L.x-J.x)*Y*B[2]+(L.y-J.y)*B[3]+J.y))},t=(L,J,B,Y,U)=>{B=
I(B);B[1]=-B[1];B[2]=-B[2];L=l(L,J,B,!1);L.x=(L.x-J.x)*Y+J.x;L.y=(L.y-J.y)*U+J.y;B[1]=-B[1];B[2]=-B[2];return l(L,J,B,!1)},e=(L,J)=>{L%=180;L+=0>L?180:0;if(x.a.p8(L,J))L-=90;else if(135<L||135===L&&!J)L-=180;return L},w=(L,J,B,Y,U,O,C)=>{const X=L.x,S=L.y,ea=L.width,Oa=L.height,Ha=new Sys.UI.Point(X+ea/2,S+Oa/2);var Za=J.width;const fa=J.height;let la=J=0;const ba=Y[0],aa=C?Y[1]:-Y[1];L=Za*ba;const oa=Za*aa,Na=fa*ba,Ia=fa*aa,Sa=Za/2*(1-ba)+fa/2*aa;Za=fa/2*(1-ba)-Za/2*aa;switch(B){case 2:case 4:case 3:B=
l(new Sys.UI.Point(X,S),Ha,Y,C);J=B.x-(Sa+(U?L:0)-(O?Ia:0));la=B.y-(Za+(U?oa:0)+(O?Na:0));break;case 6:case 5:B=l(new Sys.UI.Point(X+ea,S),Ha,Y,C);J=B.x-(Sa+(U?0:L)-(O?Ia:0));la=B.y-(Za+(U?0:oa)+(O?Na:0));break;case 0:case 1:B=l(new Sys.UI.Point(X,S+Oa),Ha,Y,C);J=B.x-(Sa+(U?L:0)-(O?0:Ia));la=B.y-(Za+(U?oa:0)+(O?0:Na));break;case 7:B=l(new Sys.UI.Point(X+ea,S+Oa),Ha,Y,C),J=B.x-(Sa+(U?0:L)-(O?0:Ia)),la=B.y-(Za+(U?0:oa)+(O?0:Na))}return new Sys.UI.Point(k.HelperMethods.IVc(J),k.HelperMethods.IVc(la))},
z=(L,J)=>{if(J&&L.$b.YDa&12582912){const B=J.getAttributeNode("Src").value,Y=c.a.$r(B,"iro");let U=0;Y&&(U=parseInt(Y));L=U|L.$b.YDa&12582912;L!==U&&J.setAttribute("Src",c.a.yk(B,"iro",L.toString()))}},E=(L,J,B,Y,U)=>{const O=L.x;U=U?-L.width:L.width;const C=L.y,X=L.height;L=null;switch(Y){case 2:case 4:case 3:L=new Sys.UI.Point(O,C);break;case 6:case 5:L=new Sys.UI.Point(O+U,C);break;case 0:case 1:L=new Sys.UI.Point(O,C+X);break;case 7:L=new Sys.UI.Point(O+U,C+X)}return J?(J=new Sys.UI.Point(O+U/
2,C+X/2),l(L,J,B,!1)):L},M=(L,J,B,Y)=>{if(J){var U=L.width;L=L.height;var O=new Sys.UI.Point(U/2,L/2);if(d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FOResizeHandlesFix",!1))for(var C of J){var X=C.domElement;J=C.GLa;var S=L,ea=U;J=[new Sys.UI.Point(ea/2,0),new Sys.UI.Point(ea,0),new Sys.UI.Point(ea,S/2),new Sys.UI.Point(ea,S),new Sys.UI.Point(ea/2,S),new Sys.UI.Point(0,S),new Sys.UI.Point(0,S/2),new Sys.UI.Point(0,0)][J];N(X,J,O,B,Y)}else for(X of J){C=X.domElement;switch(X.GLa){case 0:J=
new Sys.UI.Point(U/2,0);break;case 2:J=new Sys.UI.Point(U,L/2);break;case 4:J=new Sys.UI.Point(U/2,L);break;case 6:J=new Sys.UI.Point(0,L/2);break;case 1:J=new Sys.UI.Point(U,0);break;case 3:J=new Sys.UI.Point(U,L);break;case 5:J=new Sys.UI.Point(0,L);break;case 7:J=new Sys.UI.Point(0,0);break;default:J=new Sys.UI.Point(0,0)}N(C,J,O,B,Y)}}},G=L=>{let J=0;45>=L||315<L?J=0:45<L&&135>=L?J=1:135<L&&225>=L?J=2:225<L&&315>=L&&(J=3);return J},A=(L,J,B,Y)=>{for(const S of L){L=S.domElement;var U=S.GLa,O=
J,C=B,X=Y;const ea="n-resize ne-resize e-resize se-resize s-resize sw-resize w-resize nw-resize".split(" ");let Oa=0;const Ha=e(O,!1);25<=Ha&&45>=Ha?Oa=1:-25>Ha&&-45<=Ha&&(Oa=-1);O=G(O);C&&void 0!==X&&X!==O&&(Oa+=-2*(O-X));U=(U+Oa)%ea.length;U=0>U?U+ea.length:U;L.style.setProperty("cursor",ea[U],"important")}},N=(L,J,B,Y,U)=>{B&&L&&J&&Y&&(J=l(J,B,Y,U),f.DOMElementExtensions.updatePosition(L,J.x,J.y,!0,U))},K=(L,J,B,Y)=>{let U="";for(const O of Y){let C=Y="";1!==O.Sxa||1!==O.Txa?C=x.a.k3e(O.absoluteRotation,
x.a.iai(O.Sxa,O.Txa)):O.Yvj&&(Y=x.a.Pnd(O.ULg,-O.translateX,-O.translateY));const X=x.a.D3e(O.translateX,O.translateY);if(0<X.length||0<Y.length||0<C.length)U=X+C+Y+U}0<U.length&&x.a.rFb(L,U+";",x.a.flc(J,B))},I=L=>{L=b.a.oei(L);const J=Array(4);J[0]=Math.cos(L);J[1]=-Math.sin(L);J[2]=-J[1];J[3]=J[0];return J}},1004:function(y,r,a){a.d(r,"a",function(){return c});y=a(0);class c{constructor(b,f,k){this.chartId=null;this.operationType=0;this.propertyValue=null;this.chartId=b;this.operationType=f;this.propertyValue=
k}hPb(){return this.chartId}jNd(){return this.operationType}getPropertyValue(){return this.propertyValue}}Object(y.a)(c,"MacroRecorderChartPropertyAppliedPayload",null,[67])},1015:function(y,r,a){a.r(r);a.d(r,"GC2FloatingObjectControl",function(){return la});y=a(0);var c=a(15),b=a(82),f=a(972),k=a(1277),x=a(998),d=a(6),h=a(365),n=a(103);r=a(953);var m=a(31),u=a(70),l=a(969),t=a(114),e=a(43),w=a(1467),z=a(1276),E=a(183),M=a(172),G=a(33),A=a(17),N=a(42),K=a(1),I=a(12),L=a(28),J=a(119),B=a(99),Y=a(454),
U=a(433),O=a(1069);class C extends O.a{constructor(){super()}}Object(y.a)(C,"ExcelInkHostConfig",O.a,[]);class X extends O.a{constructor(){super();this.isGridViewRTL=this.onPictureDownloadComplete=this.isEnabled=this.getPlaceHolderUrl=null}}Object(y.a)(X,"ExcelPictureHostConfig",O.a,[]);class S extends O.a{constructor(){super();this.isEnabled=this.onAutoFitResize=this.showDialog=this.onTextSelectionChanged=this.onEditStatusChanged=null}}Object(y.a)(S,"ExcelShapeHostConfig",O.a,[]);class ea{constructor(ba,
aa){this.y=this.x=0;this.x=ba;this.y=aa}}Object(y.a)(ea,"Point2D",null,[]);var Oa=a(65),Ha=a(5),Za=a(29),fa=a(64);class la extends r.a{constructor(ba,aa,oa,Na="",Ia=!0){super(ba,aa,m.a.vFa,oa,Na,Ia);this.Zn=null;this.IUb=this.AW=!1;this.RB=this.THb=this.nYc=null;this.Gkb=!1;this.x7j=()=>{Za.a.s2()?5===this.floatingObject.type&&this.AW&&this.endEdit():this.AW&&this.endEdit()};this.lO=Sa=>{if(!Za.a.s2()||5===this.floatingObject.type){var Pa=Sa.rawEvent.type;this.THb=new b.a(Pa,Sa.rawEvent.srcElement,
Sa,"mouseup"===Pa?2:1);this.nYc=E.AsyncMethodContext.Ax(()=>{B.a(this.$).h5j(this.THb)},10,"ShapeTextEditingMouseUp",this.nYc)}};this.SXi=()=>{K.EwaSettings.isChangeGateEnabled("OfficeVSO:8189843_AddEwaControlNullCheckInGC2FOC")&&!this.$&&c.ULS.sendTraceTag(508359203,5,50,`GC2FloatingObjectControl: EwaControl is null/undefined. Is object disposed: ${null===this||void 0===this?void 0:this.Xd}`);return(!K.EwaSettings.isChangeGateEnabled("OfficeVSO:8189843_AddEwaControlNullCheckInGC2FOC")||this.$)&&
this.$.frame&&this.$.frame.jI&&this.$.frame.jI.oU?fa.a.current.Lo(101):fa.a.current.Lo(118)};this.fXj=Sa=>{this.onEditStatusChanged(Sa)};this.isEnabled=(Sa,Pa)=>{var za;return Sa&&"CG"===Pa?null!==(za=K.EwaSettings.isChangeGateEnabled(Sa))&&void 0!==za?za:!1:Sa&&"FG"===Pa?K.EwaSettings.getBooleanFeatureGate(Sa,!1):!1};this.mrj=(Sa,Pa)=>{switch(Pa){case 0:return K.EwaSettings.isChangeGateEnabled(Sa);case 1:return K.EwaSettings.getBooleanFeatureGate(Sa,!1);default:c.ULS.sendTraceTag(508409101,0,50,
"GC2FloatingObjectControl.isGateEnabled: Unsupported GateType.")}return!1};this.onPictureDownloadComplete=Sa=>{K.EwaSettings.isChangeGateEnabled("OfficeVSO:8410875_IsDisposedCheckInCallback")&&!this.hra()?c.ULS.sendTraceTag(508035138,5,15,"GC2FloatingObjectControl.onPictureDownloadComplete. Object is disposed."):t.d(()=>{if(this.hra())switch(Sa){case 2:this.g3(null);break;case 3:this.Cla(null);break;default:c.ULS.sendTraceTag(508143247,5,50,`GC2FloatingObjectControl.onGC2GraphicLoadSuccess. Unsupported GraphicLoadStatus ${Sa}`)}},
this.$.Aa)};this.isGridViewRTL=()=>this.da?this.da.rtl:!1;this.pTj=(Sa,Pa)=>{this.onAutoFitResize(Sa,Pa)};this.onTextSelectionChanged=()=>{B.a(this.$).lae()};this.showDialog=Sa=>{"clipboardErrorDialog"===Sa&&(Sa=this.$.ra.Tb(254))&&Sa.$xg()};if(5!==aa.renderType)throw c.ULS.sendTraceTag(537162369,5,10,"GC2FloatingObjectControl: RenderType is not GC2."),Error.invalidOperation("Creating GC2FloatingObjectControl for non GC2 render Type.");this.pFc=K.EwaSettings.isChangeGateEnabled("OfficeVSO:8279691_FixDIPTelemetryForGC2Image");
this.Gkb=K.EwaSettings.isChangeGateEnabled("OfficeVSO:8668792_AdditionalTelemetryForGC2ShapesFromHostCache");this.A3j=e.TaskExtensions.tb(Y.a.Zka(aa.type),()=>{!this.Xd&&aa.Wu&&this.vTg(aa)},this.$.ra.Aa,8);this.Rn=this.Df.SP();this.Rn.Ea("blur",this.x7j);this.Dd.Ea("mouseup",this.lO);this.Hf=Za.a.Hf()}get isEditing(){return this.AW}get Kq(){this.RB||(this.RB=Oa.a.Cb(Ha.ThemesManagerService));return this.RB}dispose(){var ba;(null===(ba=this.nYc)||void 0===ba?0:ba.en)&&this.nYc.cancel();this.Rn&&this.Rn.detach("blur");
this.Rn=null;this.Dd.Vp("mouseup")&&this.Dd.detach("mouseup");super.dispose()}getHitTestData(ba,aa){return this.Zn.getHitTestData(this.Zd,new ea(ba.x,ba.y),aa)}cJ(ba,aa=!1){this.AW||super.cJ(ba,aa)}Gna(){Za.a.t_a()&&K.EwaSettings.isChangeGateEnabled("OfficeVSO:8140451_MoveGC2PicturesToGetRange")&&this.jre()?this.ZXf():this.y3j(()=>{this.hra()&&this.idl()})}x2(){return!!this.floatingObject&&!!this.floatingObject.Sb&&this.floatingObject.Sb.IsHlinkPresent}startEdit(){5===this.floatingObject.type&&(c.ULS.sendTraceTag(537162339,
0,50,"GC2FloatingObjectControl.StartEdit: Starting Shape text Editing."),this.Zn.startEdit())}endEdit(){5===this.floatingObject.type&&(c.ULS.sendTraceTag(537162337,0,50,"GC2FloatingObjectControl.EndEdit: Ending Shape text Editing."),this.Zn.endEdit())}shouldShowFloatie(ba,aa){return this.Zn.shouldShowFloatie(ba,aa)}handleCommand(ba,aa){const oa=J.a.SRi(ba);if(Za.a.s2()){if("Unsupported"!==oa)switch(this.floatingObject.type){case 1:this.Zn.handleCommand(oa,aa);break;case 5:this.XRf(oa,aa,ba)}}else this.XRf(oa,
aa,ba)}handleQueryCommand(ba,aa){const oa=this.$.Vb.Uc("ModelUpdate","GC2FloatingObjectControl.HandleQueryCommand");var Na=J.a.TRi(ba);if("Unsupported"!==Na&&this.Zn){var Ia=this.Zn.handleQueryCommand(Na);if("value"in Ia){switch(ba){case "QueryBold":case "QueryItalics":case "QueryUnderline":case "QueryStrikethrough":aa[f.a.On]=Ia.value;break;case "QueryFontPickerFont":c.ULS.shipAssertTag(507844167,0,this.Hf,"GC2FloatingObjectControl.handleQueryCommand: Unexpected command QueryFontPickerFont triggered when modern font picker and/or font service disabled");
ba=Ia.value;Na=this.uRi(ba,Ia);Ia=I.HelperMethods.hOd(ba,Ia.bold,Ia.italic,Na,!0);aa[k.a.SelectedFont]=Ia;break;case "QueryFontName":Na=ba=Ia.value;L.a.Zg(ba)||(Ia=Ia.fontFamily,Ia.startsWith("+mj")?(ba=I.HelperMethods.KQb(ba,1),Na="MajorThemeFont"):Ia.startsWith("+mn")&&(ba=I.HelperMethods.KQb(ba,2),Na="MinorThemeFont"));aa[x.a.Key]=Na;aa[x.a.Value]=ba;break;case "QueryFontSize":aa[x.a.Value]=Ia.value;break;case "QueryAlignmentTop":case "QueryAlignmentMiddle":case "QueryAlignmentBottom":case "QueryAlignmentLeft":case "QueryAlignmentCenter":case "QueryAlignmentRight":aa[f.a.On]=
Ia.value===Na}oa.stop()}else c.ULS.sendTraceTag(537162335,0,10,"GC2FloatingObjectControl.HandleQueryCommand: resultProps missing value.")}}updateTransformDuringOperation(ba,aa,oa,Na,Ia){this.Zn.updateTransformDuringOperation(oa,Na,ba,aa,Ia)}updateTransformResizeEnded(ba,aa){this.Zn.updateTransformResizeEnded(ba,aa)}g3(ba){var aa;if(!d.AFrameworkApplication.Sf&&this.floatingObject){this.Gkb&&J.a.Qkb(this.floatingObject)&&c.ULS.sendTraceTag(507577889,5,50,`GC2FloatingObjectControl:OnImageLoadSuccess: Successfully rendered the cached GC2 shape with ID: ${null===
(aa=this.floatingObject)||void 0===aa?void 0:aa.Ec} `);aa=this.S6b();this.H8.stop();this.pfa&&this.iqa(G.a.zb.me.m,(aa?"Step1-":"")+"ImageLoadSuccess",this.H8.Kc,!0);if(K.EwaSettings.isChangeGateEnabled("OfficeVSO:8953925_TelemetryFoLoggingCountOfGC2ImagesWithProps")&&this.floatingObject.KQ){const oa=performance.now(),Na=this.Dqf();this.Uel(Na,oa)}this.x_c("ImageLoadSuccess",!aa);this.bJa.f6("ImageLoadSuccess");this.Gda(!0);super.g3(ba)}}nse(){return!1}iVg(){return!!this.$j&&!this.floatingObject.Lka&&
!this.floatingObject.Wu}jre(){return 1===this.floatingObject.type&&this.gk}L3h(){try{const ba=JSON.parse(this.floatingObject.Wu).imageURL;c.ULS.shipAssertTag(507638432,0,!L.a.Zg(ba),`GC2FloatingObjectControl.convertGC2ImageURLtoNonGC2: URL cannot be undefined, null or empty. Floating Object Id: ${this.floatingObject.Ec}`);const aa=new URL(ba),oa=new URLSearchParams(aa.search),Na=oa.get("iro");oa.set("iro",(parseInt(Na,10)&-9).toString());aa.search=oa.toString();return aa.href}catch(ba){throw c.ULS.sendTraceTag(507639189,
5,50,`GC2FloatingObjectControl.convertGC2ImageURLtoNonGC2: Something went wrong while creating the nonGC2 URL. Floating Object Id: ${this.floatingObject.Ec}, Exception: ${ba}`),ba;}}Dqf(){if(!this.floatingObject.KQ||!this.floatingObject.Wu)return!1;try{const ba=JSON.parse(this.floatingObject.Wu),aa=JSON.parse(ba.pictureMetaData),oa=aa.flip;if(0!==aa.rotation||oa.x||oa.y)return!0;const Na=JSON.parse(aa.pictureModelJson);if(Na.line||Na.fill||Na.effects||Na.pictureEffects)return!0}catch(ba){c.ULS.sendTraceTag(507811730,
5,50,`GC2FloatingObjectControl.doesGC2PictureHaveProps: Something went wrong while parsing the gc2 payload. Floating Object Id: ${this.floatingObject.Ec}, Exception: ${ba}`)}return!1}XRf(ba,aa,oa){let Na=null;this.AW||(Na=this.zRh(oa,aa));if((aa.SqmControlId||"").includes("ThemeColorPicker"))if(this.Kq){let Ia,Sa;({themeIndex:Ia,kNa:Sa}=this.Kq.getThemeColor(aa.Color)).returnValue&&(aa.Color=l.a.U2i(this.Kq.Lvb[Ia],Ia,Sa))}else c.ULS.sendTraceTag(537162336,0,10,"GC2FloatingObjectControl.HandleCommand: Themes Manager is null");
"Unsupported"!==ba&&this.Zn.handleCommand(ba,aa,Na);this.Hf&&-1293291468===oa&&(this.$.Sg(),h.a.N2e(aa[u.a.Bf]))}idl(){var ba;if(this.hra()){var aa=this.$.Vb.Uc("ModelUpdate","GC2FloatingObjectControl.UpdateGC2FloatingObjectContent");this.j1f()||(this.Zd||this.vTg(this.floatingObject),this.Zd.removeAttribute("style"),this.Zd.removeAttribute("class"),this.u9a=this.floatingObject.mu,Za.a.Qua()&&this.floatingObject.KQ||this.l5a(this.mu),this.Gkb&&J.a.Qkb(this.floatingObject)&&c.ULS.sendTraceTag(507578197,
5,50,`GC2FloatingObjectControl.updateGC2FloatingObjectContent: Invoking updateModel api for the cached GC2 shape with ID: ${null===(ba=this.floatingObject)||void 0===ba?void 0:ba.Ec}`),this.Zn.updateModel(this.floatingObject.Wu),this.Zn.isRenderOverflowSupported()&&(this.Zd.style.overflow="visible"),this.NH=this.Zn.isRenderTransparencySupported()?m.a.wvf:m.a.dNb,this.N2c(),this.lya(this.floatingObject.XE),this.pFc&&1===this.floatingObject.type||t.d(()=>{this.hra()&&(this.floatingObject.wUc?this.Cla(null):
this.g3(null))},this.$.Aa),aa.stop())}}hra(){return!this.Xd}y3j(ba){e.TaskExtensions.tb(this.A3j,()=>{ba()},this.$.ra.Aa,8)}vTg(ba){this.CAa=document.createElement("div");this.Zd.id="Host-"+this.domElement.id;this.oMa(!1);this.domElement.appendChild(this.Zd);switch(ba.type){case 5:var aa=new S;aa.id=ba.id;aa.parent=this.Zd;aa.actionHandler=w.a.Bgb(this.$);aa.onEditStatusChanged=this.fXj;aa.onTextSelectionChanged=this.onTextSelectionChanged;aa.showDialog=this.showDialog;aa.onAutoFitResize=this.pTj;
aa.isEnabled=this.isEnabled;aa.logger=new z.a;aa.excelHealth=this.getHealth();this.Zn=GC2Host.excelShapeHostFactoryGlobal.createHost(aa);break;case 1:aa=new X;aa.id=ba.id;aa.parent=this.Zd;aa.actionHandler=w.a.Bgb(this.$);aa.logger=new z.a;aa.excelHealth=this.getHealth();aa.getPlaceHolderUrl=this.SXi;aa.isEnabled=this.mrj;aa.onPictureDownloadComplete=this.pFc?this.onPictureDownloadComplete:void 0;aa.isGridViewRTL=K.EwaSettings.isChangeGateEnabled("OfficeVSO:8928608_CropDimensionsInRTL")?this.isGridViewRTL:
void 0;this.Zn=GC2Host.excelPictureHostFactoryGlobal.createHost(aa);break;case 8:aa=new C;aa.id=ba.id;aa.parent=this.Zd;aa.actionHandler=w.a.Bgb(this.$);aa.logger=new z.a;this.Zn=InkHost.excelInkHostFactoryGlobal.createHost(aa);break;default:throw c.ULS.sendTraceTag(537162334,5,10,"GC2FloatingObjectControl: Type is not GC2 supported."),Error.invalidOperation("Creating GC2FloatingObjectControl Host for non GC2 Type.");}this.Zn.setSelected(this.IUb)}getHealth(){return n.Health.instance}select(ba,aa){super.select(ba,
aa);this.IUb=ba;this.Zn&&this.Zn.setSelected(ba)}onEditStatusChanged(ba){!ba&&this.extension&&this.extension.VK.p4b(!0);this.AW=ba;if(Za.a.s2())switch(this.floatingObject.type){case 5:B.a(this.$).lae();A.DOMElementExtensions.toggleCssClass(this.Tj,m.a.uvf,ba);!this.AW&&this.IUb&&this.setFocus(!0);U.c(this.$,!ba,"GC2FOControl:OnEditStatusChanged");break;case 1:K.EwaSettings.isChangeGateEnabled("OfficeVSO:8844986_DisablePictureRibbonCommandsWhenInCropMode")&&this.$.Sg()}else B.a(this.$).lae(),A.DOMElementExtensions.toggleCssClass(this.Tj,
m.a.uvf,ba),!this.AW&&this.IUb&&this.setFocus(!0),U.c(this.$,!ba,"GC2FOControl:OnEditStatusChanged")}onAutoFitResize(ba,aa){J.a.p8(this.floatingObject.Sb.Rotation,!1)?this.extension.ync(ba,aa):this.extension.ync(aa,ba)}bAc(){if(!this.floatingObject||!this.Zn||8!==this.floatingObject.type)return null;const ba={};ba[this.floatingObject.dC.toString()]=this.Zn.createInkCollection();return ba}zRh(ba,aa){let oa=0;var Na={};const Ia={},Sa={};Ia.Font=Sa;switch(ba){case -287251124:Sa.ValidMembers=4;this.handleQueryCommand("QueryBold",
Na);Sa.Bold=!Na[f.a.On];break;case -1925065947:Sa.ValidMembers=8;this.handleQueryCommand("QueryItalics",Na);Sa.Italic=!Na[f.a.On];break;case 1764140053:Sa.ValidMembers=16;this.handleQueryCommand("QueryUnderline",Na);Sa.Underline=!Na[f.a.On];break;case -1293291468:Na=I.HelperMethods.d$[aa[u.a.Bf]];Sa.ValidMembers=1;Sa.FontName=Na;if(this.Hf&&Na){Sa.ValidMembers|=12;Sa.Bold=!1;Sa.Italic=!1;aa=aa.Format;if(null===aa||void 0===aa?0:aa.isBold)Sa.Bold=aa.isBold;if(null===aa||void 0===aa?0:aa.isItalic)Sa.Italic=
aa.isItalic}break;case -1077965542:aa=parseFloat(aa[aa[x.a.IsFreeForm]?x.a.Value:u.a.Bf].toString());Sa.ValidMembers=2;Sa.FontSize=aa;break;case 1970784898:case -1832800737:Na=aa.Color;Sa.ValidMembers=32;Sa.FontColor=M.a.zK(Na,N.a.rh(aa,"IntColor"));break;case -571165336:case 1041132226:case -394785302:oa=1;Ia.VerticalAlignment=N.a.Mq(J.a.rcb,ba.toString(),0);break;case -1150205178:case -1142465846:case -286432209:oa=2,Ia.HorizontalAlignment=N.a.Mq(J.a.rcb,ba.toString(),1)}Ia.ValidMembers=ba.toString()in
J.a.rcb?oa:4;return Ia}uRi(ba,aa){if(L.a.Zg(ba))return 0;ba=aa.fontFamily;return ba.startsWith("+mj")?1:ba.startsWith("+mn")?2:0}static yse(ba){return Za.a.t_a()?5===ba.renderType||8===ba.type:5===ba.type&&5===ba.renderType||8===ba.type}}Object(y.a)(la,"GC2FloatingObjectControl",r.a,[])},1032:function(y,r,a){a.d(r,"d",function(){return b});a.d(r,"e",function(){return f});a.d(r,"f",function(){return k});a.d(r,"c",function(){return x});a.d(r,"a",function(){return d});a.d(r,"g",function(){return h});
a.d(r,"b",function(){return n});var c=a(61);const b=(m,u,l,t,e,w)=>{const z=m.$a(1);z.imageId=u;return c.h(m,"GetEffectsExtents",z,l,t,e,w,4)},f=(m,u,l,t,e,w,z,E,M,G,A,N,K)=>{const I=m.$a(9);I.floatingObjectType=u;I.id=l;I.absoluteLeft=t;I.absoluteTop=e;I.absoluteRight=w;I.absoluteBottom=z;I.toggleFlipX=E;I.toggleFlipY=M;return c.h(m,"MoveAndResizeFloatingObject",I,G,A,N,K,0)},k=(m,u,l,t,e,w,z,E,M,G,A,N,K,I,L,J,B)=>{const Y=m.$a(9);Y.floatingObjectType=u;Y.id=l;Y.absoluteLeft=t;Y.absoluteTop=e;Y.absoluteRight=
w;Y.absoluteBottom=z;Y.toggleFlipX=E;Y.toggleFlipY=M;Y.connectToFloatingObjectType=G;Y.connectToId=A;Y.connectionSite=N;Y.endpointType=K;return c.h(m,"ResizeConnectorFloatingObject",Y,I,L,J,B,0)},x=(m,u,l,t,e,w,z)=>{const E=m.$a(9);E.floatingObjectType=u;E.id=l;return c.h(m,"DeleteFloatingObject",E,t,e,w,z,0)},d=(m,u,l,t,e,w,z)=>{const E=m.$a(9);E.id=u;E.zOrderChangeType=l;return c.h(m,"ChangeFloatingObjectZOrder",E,t,e,w,z,0)},h=(m,u,l,t,e,w,z)=>{const E=m.$a(9);E.id=u;E.rotationAngle=l;return c.h(m,
"RotateOartElement",E,t,e,w,z,0)},n=(m,u,l,t,e,w,z,E,M)=>{const G=m.$a(9);G.id=u;G.dimension=l;G.positionTransform=t;G.srcRect=e;return c.h(m,"CropPicture",G,w,z,E,M,0)}},1035:function(y,r,a){a.d(r,"e",function(){return b});a.d(r,"a",function(){return f});a.d(r,"b",function(){return k});a.d(r,"d",function(){return x});a.d(r,"f",function(){return d});a.d(r,"c",function(){return h});var c=a(61);const b=(n,m,u,l,t,e,w,z,E,M,G,A)=>{A=n.$a(9,A);A.chartSource=m;A.chartType=u;A.positionRow=l;A.positionCol=
t;A.positionOffsetX=e;A.positionOffsetY=w;return c.h(n,"InsertChart",A,z,E,M,G,0)},f=(n,m,u,l,t,e,w,z,E)=>{E=n.$a(9,E);E.imageId=m;E.operationType=u;E.propertyValue=l;return c.h(n,"ApplyChartProperty",E,t,e,w,z,0)},k=(n,m,u,l,t,e,w,z,E)=>{E=n.$a(9,E);E.imageId=m;E.contextType=u;E.operationType=l;E.propertyValues=t;return c.h(n,"ApplyChartPropertyDual",E,e,w,z,null,0)},x=(n,m,u,l,t,e,w,z,E,M,G)=>{M=n.$a(1,M);M.ewaControlId=m;M.imageId=u;M.versionId=l;M.chartWidth=t;M.chartHeight=e;M.isAdvancedChartEditingEnabled=
G;return c.h(n,"GetChartElementData",M,w,z,null,E,4)},d=(n,m,u,l,t,e,w)=>{const z=n.$a(9);z.sheetName=m;z.parameters=u;return c.h(n,"InsertInk",z,l,t,e,w,0)},h=(n,m,u,l,t,e,w)=>{const z=n.$a(9);z.sheetName=m;z.selections=u;return c.h(n,"DeleteInkStrokes",z,l,t,e,w,0)}},1049:function(y,r,a){a.r(r);a.d(r,"ChartCommandHandler",function(){return Ka});y=a(133);r=a(0);var c=a(15),b=a(32),f=a(55),k=a(20),x=a(177),d=a(401),h=a(70),n=a(1004),m=a(44),u=a(429),l=a(213),t=a(134),e=a(64),w=a(4),z=a(198),E=a(42),
M=a(36),G=a(1),A=a(209),N=a(28),K=a(13),I=a(266),L=a(99),J=a(25);class B{constructor(da,sa,mb,Ma){this.chartId=da;this.operation=sa;this.WWh=mb;this.Tye=Ma}}Object(r.a)(B,"ApplyChartPropertyContext",null,[]);var Y=a(1036),U=a(610),O=a(1E3),C=a(1035),X=a(432);class S extends O.a{constructor(da,sa,mb,Ma){super(da);this.dEc=null;this.dkk=(hb,$a)=>{1===hb?(this.dEc=$a[S.Ujk],hb=this.dEc!==this.RKa,c.ULS.sendTraceTag(557937567,0,50,`EditChartDataDialog.ReactChartEditDataDialogHandler: EditChartDataDialog OK button pressed with valid input. DataRangeEdited: ${hb}`),
hb&&this.commit()):c.ULS.sendTraceTag(557937566,0,50,"EditChartDataDialog.ReactChartEditDataDialogHandler: EditChartDataDialog Cancel button pressed")};this.Zi=()=>{};this.chartId=Ma;this.RKa=(this.XR=mb)||!sa?"":sa;K.a.instance.ia(891);this.mvc=da.Mb.Hb;this.initializeAndShow(K.a.instance.ia(890),this.dkk,this.qN());c.ULS.sendTraceTag(557937568,0,50,"EditChartDataDialog.EditChartDataDialog: React Dialog Opened.")}get Tc(){return"ChartEditDataDialog"}get kD(){return 529}qN(){const da={[X.a.Xs]:this.Tc,
[S.Hgj]:this.RKa,[S.OXk]:this.XR};this.XR&&(da[S.jkl]=1);return da}Bn(){const da=this.chartId,sa=this.dEc;return()=>new n.a(da,-100,sa)}QJ(){const da=this.$.ma.sa,sa=this.chartId,mb=this.dEc,Ma=da.mc();return(hb,$a,Va)=>C.a(da,sa,-100,mb,this.Zdb(hb,this.Zi),$a,Va,null,Ma)}}S.Hgj="initialRange";S.OXk="showWarning";S.jkl="dialogIcon";S.Ujk="range";Object(r.a)(S,"EditChartDataDialog",O.a,[]);var ea=a(375),Oa;(function(da){da[da.editDataViaFoils=-99]="editDataViaFoils";da[da.editData=-100]="editData";
da[da.switchRowCol=-101]="switchRowCol";da[da.chartTitleEdit=-102]="chartTitleEdit";da[da.horizontalAxisTitleEdit=-103]="horizontalAxisTitleEdit";da[da.verticalAxisTitleEdit=-104]="verticalAxisTitleEdit";da[da.changeChartTypeColumnClustered=-105]="changeChartTypeColumnClustered";da[da.changeChartTypeColumnStacked=-106]="changeChartTypeColumnStacked";da[da.changeChartTypeColumnStacked100=-107]="changeChartTypeColumnStacked100";da[da.changeChartTypeLine=-108]="changeChartTypeLine";da[da.changeChartTypeLineStacked=
-109]="changeChartTypeLineStacked";da[da.changeChartTypeLineStacked100=-110]="changeChartTypeLineStacked100";da[da.changeChartTypeLineMarkers=-111]="changeChartTypeLineMarkers";da[da.changeChartTypeLineMarkersStacked=-112]="changeChartTypeLineMarkersStacked";da[da.changeChartTypeLineMarkersStacked100=-113]="changeChartTypeLineMarkersStacked100";da[da.changeChartTypePie=-114]="changeChartTypePie";da[da.changeChartTypePieExploded=-115]="changeChartTypePieExploded";da[da.changeChartTypeBarClustered=
-116]="changeChartTypeBarClustered";da[da.changeChartTypeBarStacked=-117]="changeChartTypeBarStacked";da[da.changeChartTypeBarStacked100=-118]="changeChartTypeBarStacked100";da[da.changeChartTypeArea=-119]="changeChartTypeArea";da[da.changeChartTypeAreaStacked=-120]="changeChartTypeAreaStacked";da[da.changeChartTypeAreaStacked100=-121]="changeChartTypeAreaStacked100";da[da.changeChartTypeXYScatter=-122]="changeChartTypeXYScatter";da[da.changeChartTypeXYScatterSmooth=-123]="changeChartTypeXYScatterSmooth";
da[da.changeChartTypeXYScatterLines=-124]="changeChartTypeXYScatterLines";da[da.changeChartTypeXYScatterSmoothNoMarkers=-125]="changeChartTypeXYScatterSmoothNoMarkers";da[da.changeChartTypeXYScatterLinesNoMarkers=-126]="changeChartTypeXYScatterLinesNoMarkers";da[da.changeChartTypeDoughnut=-127]="changeChartTypeDoughnut";da[da.changeChartTypeDoughnutExploded=-128]="changeChartTypeDoughnutExploded";da[da.changeChartTypeRadar=-129]="changeChartTypeRadar";da[da.changeChartTypeRadarMarkers=-130]="changeChartTypeRadarMarkers";
da[da.changeChartTypeRadarFilled=-131]="changeChartTypeRadarFilled";da[da.chartTitleBoldEdit=-132]="chartTitleBoldEdit";da[da.chartTitleItalicsEdit=-133]="chartTitleItalicsEdit";da[da.chartTitleUnderlineEdit=-134]="chartTitleUnderlineEdit";da[da.chartTitleFontTypeEdit=-135]="chartTitleFontTypeEdit";da[da.chartTitleColorEdit=-136]="chartTitleColorEdit";da[da.chartPrimaryHorizontalAxisTitleBoldEdit=-137]="chartPrimaryHorizontalAxisTitleBoldEdit";da[da.chartPrimaryHorizontalAxisTitleItalicsEdit=-138]=
"chartPrimaryHorizontalAxisTitleItalicsEdit";da[da.chartPrimaryHorizontalAxisTitleUnderlineEdit=-139]="chartPrimaryHorizontalAxisTitleUnderlineEdit";da[da.chartPrimaryHorizontalAxisTitleFontTypeEdit=-140]="chartPrimaryHorizontalAxisTitleFontTypeEdit";da[da.chartPrimaryHorizontalAxisTitleColorEdit=-141]="chartPrimaryHorizontalAxisTitleColorEdit";da[da.chartPrimaryVerticalAxisTitleBoldEdit=-142]="chartPrimaryVerticalAxisTitleBoldEdit";da[da.chartPrimaryVerticalAxisTitleItalicsEdit=-143]="chartPrimaryVerticalAxisTitleItalicsEdit";
da[da.chartPrimaryVerticalAxisTitleUnderlineEdit=-144]="chartPrimaryVerticalAxisTitleUnderlineEdit";da[da.chartPrimaryVerticalAxisTitleFontTypeEdit=-145]="chartPrimaryVerticalAxisTitleFontTypeEdit";da[da.chartPrimaryVerticalAxisTitleColorEdit=-146]="chartPrimaryVerticalAxisTitleColorEdit";da[da.chartLegendBoldEdit=-147]="chartLegendBoldEdit";da[da.chartLegendItalicsEdit=-148]="chartLegendItalicsEdit";da[da.chartLegendUnderlineEdit=-149]="chartLegendUnderlineEdit";da[da.chartLegendFontTypeEdit=-150]=
"chartLegendFontTypeEdit";da[da.chartLegendColorEdit=-151]="chartLegendColorEdit";da[da.chartPrimaryHorizontalAxisLabelBoldEdit=-152]="chartPrimaryHorizontalAxisLabelBoldEdit";da[da.chartPrimaryHorizontalAxisLabelItalicsEdit=-153]="chartPrimaryHorizontalAxisLabelItalicsEdit";da[da.chartPrimaryHorizontalAxisLabelUnderlineEdit=-154]="chartPrimaryHorizontalAxisLabelUnderlineEdit";da[da.chartPrimaryHorizontalAxisLabelFontTypeEdit=-155]="chartPrimaryHorizontalAxisLabelFontTypeEdit";da[da.chartPrimaryHorizontalAxisLabelColorEdit=
-156]="chartPrimaryHorizontalAxisLabelColorEdit";da[da.chartPrimaryVerticalAxisLabelBoldEdit=-157]="chartPrimaryVerticalAxisLabelBoldEdit";da[da.chartPrimaryVerticalAxisLabelItalicsEdit=-158]="chartPrimaryVerticalAxisLabelItalicsEdit";da[da.chartPrimaryVerticalAxisLabelUnderlineEdit=-159]="chartPrimaryVerticalAxisLabelUnderlineEdit";da[da.chartPrimaryVerticalAxisLabelFontTypeEdit=-160]="chartPrimaryVerticalAxisLabelFontTypeEdit";da[da.chartPrimaryVerticalAxisLabelColorEdit=-161]="chartPrimaryVerticalAxisLabelColorEdit";
da[da.chartSeriesDataLabelsBoldEdit=-162]="chartSeriesDataLabelsBoldEdit";da[da.chartSeriesDataLabelsItalicsEdit=-163]="chartSeriesDataLabelsItalicsEdit";da[da.chartSeriesDataLabelsUnderlineEdit=-164]="chartSeriesDataLabelsUnderlineEdit";da[da.chartSeriesDataLabelsFontTypeEdit=-165]="chartSeriesDataLabelsFontTypeEdit";da[da.chartSeriesDataLabelsColorEdit=-166]="chartSeriesDataLabelsColorEdit";da[da.chartPrimaryHorizontalAxisMaxEdit=-167]="chartPrimaryHorizontalAxisMaxEdit";da[da.chartPrimaryVerticalAxisMaxEdit=
-168]="chartPrimaryVerticalAxisMaxEdit";da[da.chartPrimaryHorizontalAxisMinEdit=-169]="chartPrimaryHorizontalAxisMinEdit";da[da.chartPrimaryVerticalAxisMinEdit=-170]="chartPrimaryVerticalAxisMinEdit";da[da.chartPrimaryHorizontalAxisColorEdit=-171]="chartPrimaryHorizontalAxisColorEdit";da[da.chartPrimaryVerticalAxisColorEdit=-172]="chartPrimaryVerticalAxisColorEdit";da[da.chartPrimaryHorizontalAxisWidthEdit=-173]="chartPrimaryHorizontalAxisWidthEdit";da[da.chartPrimaryVerticalAxisWidthEdit=-174]="chartPrimaryVerticalAxisWidthEdit";
da[da.chartPrimaryHorizontalAxisStyleEdit=-175]="chartPrimaryHorizontalAxisStyleEdit";da[da.chartPrimaryVerticalAxisStyleEdit=-176]="chartPrimaryVerticalAxisStyleEdit";da[da.chartPrimaryHorizontalAxisMajorTickMarkEdit=-177]="chartPrimaryHorizontalAxisMajorTickMarkEdit";da[da.chartPrimaryHorizontalAxisMinorTickMarkEdit=-178]="chartPrimaryHorizontalAxisMinorTickMarkEdit";da[da.chartPrimaryVerticalAxisMajorTickMarkEdit=-179]="chartPrimaryVerticalAxisMajorTickMarkEdit";da[da.chartPrimaryVerticalAxisMinorTickMarkEdit=
-180]="chartPrimaryVerticalAxisMinorTickMarkEdit";da[da.chartPrimaryHorizontalAxisMajorGridlinesColorEdit=-181]="chartPrimaryHorizontalAxisMajorGridlinesColorEdit";da[da.chartPrimaryHorizontalAxisMinorGridlinesColorEdit=-182]="chartPrimaryHorizontalAxisMinorGridlinesColorEdit";da[da.chartPrimaryVerticalAxisMajorGridlinesColorEdit=-183]="chartPrimaryVerticalAxisMajorGridlinesColorEdit";da[da.chartPrimaryVerticalAxisMinorGridlinesColorEdit=-184]="chartPrimaryVerticalAxisMinorGridlinesColorEdit";da[da.chartPrimaryHorizontalAxisMajorGridlinesWidthEdit=
-185]="chartPrimaryHorizontalAxisMajorGridlinesWidthEdit";da[da.chartPrimaryHorizontalAxisMinorGridlinesWidthEdit=-186]="chartPrimaryHorizontalAxisMinorGridlinesWidthEdit";da[da.chartPrimaryVerticalAxisMajorGridlinesWidthEdit=-187]="chartPrimaryVerticalAxisMajorGridlinesWidthEdit";da[da.chartPrimaryVerticalAxisMinorGridlinesWidthEdit=-188]="chartPrimaryVerticalAxisMinorGridlinesWidthEdit";da[da.chartPrimaryHorizontalAxisMajorGridlinesStyleEdit=-189]="chartPrimaryHorizontalAxisMajorGridlinesStyleEdit";
da[da.chartPrimaryHorizontalAxisMinorGridlinesStyleEdit=-190]="chartPrimaryHorizontalAxisMinorGridlinesStyleEdit";da[da.chartPrimaryVerticalAxisMajorGridlinesStyleEdit=-191]="chartPrimaryVerticalAxisMajorGridlinesStyleEdit";da[da.chartPrimaryVerticalAxisMinorGridlinesStyleEdit=-192]="chartPrimaryVerticalAxisMinorGridlinesStyleEdit";da[da.chartSeriesColorEdit=-193]="chartSeriesColorEdit";da[da.chartSeriesLineWidthEdit=-194]="chartSeriesLineWidthEdit";da[da.chartSeriesLineStyleEdit=-195]="chartSeriesLineStyleEdit";
da[da.chartSeriesLineMarkerSizeEdit=-196]="chartSeriesLineMarkerSizeEdit";da[da.chartSeriesChangeChartTypeEdit=-197]="chartSeriesChangeChartTypeEdit";da[da.chartSeriesTrendlineAdd=-198]="chartSeriesTrendlineAdd";da[da.chartSeriesTrendlineDelete=-199]="chartSeriesTrendlineDelete";da[da.chartPlotAreaColorOpactiyEdit=-200]="chartPlotAreaColorOpactiyEdit";da[da.changeChartTypeWaterfall=-216]="changeChartTypeWaterfall";da[da.changeChartTypeFunnel=-217]="changeChartTypeFunnel";da[da.changeChartTypeTreemap=
-218]="changeChartTypeTreemap";da[da.changeChartTypeSunburst=-219]="changeChartTypeSunburst";da[da.changeChartTypeBoxWhisker=-220]="changeChartTypeBoxWhisker";da[da.changeChartTypeHistogram=-221]="changeChartTypeHistogram";da[da.changeChartTypePareto=-222]="changeChartTypePareto";da[da.chartTitleNone=0]="chartTitleNone";da[da.chartTitleCenteredOverlay=1]="chartTitleCenteredOverlay";da[da.chartTitleAboveChart=2]="chartTitleAboveChart";da[da.legendNone=100]="legendNone";da[da.legendRight=101]="legendRight";
da[da.legendTop=102]="legendTop";da[da.legendLeft=103]="legendLeft";da[da.legendBottom=104]="legendBottom";da[da.legendRightOverlay=105]="legendRightOverlay";da[da.legendLeftOverlay=106]="legendLeftOverlay";da[da.dataLabelNone=200]="dataLabelNone";da[da.dataLabelShow=201]="dataLabelShow";da[da.dataLabelCenter=202]="dataLabelCenter";da[da.dataLabelInsideEnd=203]="dataLabelInsideEnd";da[da.dataLabelInsideBase=204]="dataLabelInsideBase";da[da.dataLabelOutsideEnd=205]="dataLabelOutsideEnd";da[da.dataLabelLeft=
206]="dataLabelLeft";da[da.dataLabelRight=207]="dataLabelRight";da[da.dataLabelTop=208]="dataLabelTop";da[da.dataLabelBottom=209]="dataLabelBottom";da[da.dataLabelBestFit=210]="dataLabelBestFit";da[da.primaryCategoryAxisTitleNone=300]="primaryCategoryAxisTitleNone";da[da.primaryCategoryAxisTitleAdjacentToAxis=301]="primaryCategoryAxisTitleAdjacentToAxis";da[da.primaryCategoryAxisTitleBelowAxis=302]="primaryCategoryAxisTitleBelowAxis";da[da.primaryCategoryAxisTitleRotated=303]="primaryCategoryAxisTitleRotated";
da[da.primaryCategoryAxisTitleVertical=304]="primaryCategoryAxisTitleVertical";da[da.primaryCategoryAxisTitleHorizontal=305]="primaryCategoryAxisTitleHorizontal";da[da.primaryValueAxisTitleNone=306]="primaryValueAxisTitleNone";da[da.primaryValueAxisTitleAdjacentToAxis=307]="primaryValueAxisTitleAdjacentToAxis";da[da.primaryValueAxisTitleBelowAxis=308]="primaryValueAxisTitleBelowAxis";da[da.primaryValueAxisTitleRotated=309]="primaryValueAxisTitleRotated";da[da.primaryValueAxisTitleVertical=310]="primaryValueAxisTitleVertical";
da[da.primaryValueAxisTitleHorizontal=311]="primaryValueAxisTitleHorizontal";da[da.primaryValueGridlinesNone=328]="primaryValueGridlinesNone";da[da.primaryValueGridlinesMinor=329]="primaryValueGridlinesMinor";da[da.primaryValueGridlinesMajor=330]="primaryValueGridlinesMajor";da[da.primaryValueGridlinesMinorMajor=331]="primaryValueGridlinesMinorMajor";da[da.primaryCategoryGridlinesNone=332]="primaryCategoryGridlinesNone";da[da.primaryCategoryGridlinesMinor=333]="primaryCategoryGridlinesMinor";da[da.primaryCategoryGridlinesMajor=
334]="primaryCategoryGridlinesMajor";da[da.primaryCategoryGridlinesMinorMajor=335]="primaryCategoryGridlinesMinorMajor";da[da.primaryCategoryAxisNone=348]="primaryCategoryAxisNone";da[da.primaryCategoryAxisShowLTR=349]="primaryCategoryAxisShowLTR";da[da.primaryCategoryAxisWithoutLabels=350]="primaryCategoryAxisWithoutLabels";da[da.primaryCategoryAxisShowRTL=351]="primaryCategoryAxisShowRTL";da[da.primaryValueAxisNone=352]="primaryValueAxisNone";da[da.primaryValueAxisShow=353]="primaryValueAxisShow";
da[da.primaryValueAxisThousands=354]="primaryValueAxisThousands";da[da.primaryValueAxisMillions=355]="primaryValueAxisMillions";da[da.primaryValueAxisBillions=356]="primaryValueAxisBillions";da[da.primaryValueAxisLogScale=357]="primaryValueAxisLogScale";da[da.primaryCategoryAxisThousands=372]="primaryCategoryAxisThousands";da[da.primaryCategoryAxisMillions=373]="primaryCategoryAxisMillions";da[da.primaryCategoryAxisBillions=374]="primaryCategoryAxisBillions";da[da.primaryCategoryAxisLogScale=375]=
"primaryCategoryAxisLogScale";da[da.dataTableNone=500]="dataTableNone";da[da.dataTableShow=501]="dataTableShow";da[da.dataTableWithLegendKeys=502]="dataTableWithLegendKeys";da[da.seriesDelete=510]="seriesDelete";da[da.dataChange=511]="dataChange";da[da.seriesDataChange=512]="seriesDataChange"})(Oa||(Oa={}));Object(r.b)("ChartOperationType",Oa);var Ha=a(61),Za=a(255);class fa extends O.a{constructor(da,sa,mb,Ma,hb,$a,Va){super(da);this.S7=null;this.fkk=(xa,ia)=>{const Z=this.mIf(this.entryLocation);
if(1===xa){if(this.S7=ia[fa.v5k],xa=this.S7!==this.Y6a.PreviousTitle)c.ULS.sendTraceTag(559518685,5,50,`EditTitleDialog.ReactEditTitleDialogHandler. ID:${this.floatingObjectId}, Operation:${Enum.toString(Oa,this.operation)}, EntryMethod:${Enum.toString(ea.a,this.mvc)}, EntryLocation:${Z}, TitleEdited:${xa}`),this.commit()}else c.ULS.sendTraceTag(559518684,0,50,`EditTitleDialog.ReactEditTitleDialogHandler Cancel button pressed. ID:${this.floatingObjectId}, Operation:${Enum.toString(Oa,this.operation)}, EntryMethod:${Enum.toString(ea.a,
this.mvc)}, EntryLocation:${Z}, TitleEdited:${!1}`)};this.jlj=xa=>{const ia=a(1049).ChartCommandHandler.f3i(this.operation,this.chartType),Z=this.$.ma.sa.mc();this.ZYa(this.kD,(ta,pa,Ga)=>Ha.u(this.$.ma.sa,this.floatingObjectId,ia,this.$db(ta,this.a9(xa)),this.G0(pa),Ga,null,Z),16,!0)};this.Zi=()=>{};this.floatingObjectId=sa;this.operation=mb;this.chartType=Ma;this.fXf=$a;this.dialogTitle=K.a.instance.ia(887);this.Y6a={};this.Y6a.PreviousTitle=this.fXf?hb:"";this.Y6a.HasPreviousTitle=this.fXf?!0:
!1;this.Y6a.PreviousTitleIsFormula=!1;this.mvc=da.Mb.Hb;this.entryLocation=Va;this.initializeAndShow(this.dialogTitle,this.fkk,this.kEa());c.ULS.sendTraceTag(507266057,5,50,`EditTitleDialog.Constructor. Lauched Edit Dialog - ID:${this.floatingObjectId}, Operation:${Enum.toString(Oa,mb)}, EntryMethod:${Enum.toString(ea.a,this.mvc)}, EntryLocation:${this.mIf(Va)}`)}get Tc(){return"ChartEditTitleDialog"}get kD(){return 529}QJ(){const da=this.kLf(this.S7),sa=this.UWa(da),mb=this.floatingObjectId,Ma=this.$.ma.sa,
hb=this.$.ma.sa.mc();return($a,Va,xa)=>C.a(Ma,mb,sa,da,this.Zdb($a,this.Zi),Va,xa,null,hb)}Bn(){const da=this.floatingObjectId;let sa=this.S7;const mb=this.UWa(sa);sa=this.kLf(sa);return()=>new n.a(da,mb,sa)}kEa(){const da={};da[fa.CQ]=this.Tc;da.invokeGetTitle=this.jlj;return da}a9(da){return sa=>{Za.a(sa)?(c.ULS.sendTraceTag(537155040,0,10,"  result contains non-status messages"),this.hide()):(this.Y6a=sa.Result,da(this.Y6a.PreviousTitle))}}D2g(da){return!da&&this.Y6a.HasPreviousTitle}kLf(da){return this.D2g(da)?
"":da}UWa(da){const {ChartCommandHandler:sa}=a(1049);let mb=this.operation;if(this.D2g(da))switch(this.operation){case -102:mb=0;break;case -103:mb=sa.UWa(-1324968385,this.chartType);break;case -104:mb=sa.UWa(1769742759,this.chartType);break;default:c.ULS.sendTraceTag(537155037,6,50,`EditTitleDialog.GetChartOperationType: Unexpected operation ${this.operation}.`)}return mb}mIf(da){switch(da){case 19:return"ContextMenu";case 2:case 14:case 15:case 16:return"Ribbon";case 30:return"Canvas";default:return c.ULS.sendTraceTag(507266056,
5,50,`EditTitleDialog.getEntryLocationString. Unsupported UI Location. LocationEnum:${da}`),"Unsupported"}}}fa.CQ="id";fa.v5k="title";Object(r.a)(fa,"EditTitleDialog",O.a,[]);var la=a(74);const ba=(da,sa,mb,Ma,hb,$a,Va,xa=null)=>{xa=da.$a(9,xa);xa.id=sa;xa.targetSheetName=mb;return Ha.h(da,"MoveArt",xa,Ma,hb,$a,Va,0)};O=a(431);var aa=a(211);class oa extends O.a{constructor(da,sa){super(da);this.Jdf=this.N6a=this.chartId=null;this.RMj=(mb,Ma)=>{if(1===mb)if(this.Cee(Ma),this.N6a&&0!==this.N6a.length){c.ULS.sendTraceTag(507315404,
0,50,"Move chart triggered.");var hb=this.$.ma.sa,$a=()=>null;u.a(this.$.userOperationManager,(Va,xa,ia)=>ba(hb,this.chartId,this.N6a,I.c(Va,this.Zi),I.b(xa,this.Ila),ia,null),Va=>new l.a(614,0,Va,void 0,$a),null)}else c.ULS.sendTraceTag(507315405,0,10,"Move chart triggered but no target sheet.");else c.ULS.sendTraceTag(507315403,0,50,"Move chart cancelled.")};this.Zi=(mb,Ma,hb)=>{mb&&!Za.a(mb)&&this.N6a&&(c.ULS.sendTraceTag(507315402,0,50,`Move chart: ${hb} succeeded.`),mb=this.$.qa.getItemByName(this.N6a),
null===mb||void 0===mb?0:mb.name)&&(Ma=aa.a.MA(0,this.chartId),(Ma=L.a(this.$).fr(Ma))?(J.f(this.$).ha.ob.WH(Ma),Ma.isVisible=!1):c.ULS.sendTraceTag(507035859,0,10,"MoveChartDialog.onWebMethodSuccess: Prior FOC is null."),this.$.Qw(),mb.activate({scenario:"other"}),mb=m.q(this.Jdf,this.N6a),J.f(this.$).ha.ob.FDa(mb,this.chartId,0))};this.Ila=(mb,Ma,hb)=>{c.ULS.sendTraceTag(507315401,0,10,`Move chart: ${hb} failed.`)};this.chartId=sa;this.Jdf=J.f(this.$).ha.ob.Wb.floatingObject.cellLocation;this.sheetNames=
this.aib();da={[oa.Xs]:this.Tc,["sheetNames"]:this.sheetNames};this.initializeAndShow(K.a.instance.ia(2556),this.RMj,da)}get Tc(){return"MoveChartDialog"}get kD(){return 614}Cee(da){this.N6a=da.destinationSheet}aib(){const da=this.$.zn.activeItemIndex;return this.$.qa.items.filter(sa=>sa.visible&&sa.index!==da&&!la.e(sa)).map(sa=>sa.name)}}Object(r.a)(oa,"MoveChartDialog",O.a,[]);class Na{constructor(da,sa){this.multiRange=null;this.type=0;this.multiRange=da;this.type=sa}LGf(){return this.type}}Object(r.a)(Na,
"MacroRecorderChartInsertedPayload",null,[67]);var Ia=a(67),Sa=a(65),Pa=a(5),za=a(29),wa=a(119),db=a(491);O=a(684);var Ba;let Ka=Ba=class{constructor(da,sa,mb,Ma,hb){this.ljg=($a,Va)=>{M.a.zf($a.Errors)||2===$a.Result&&new fa(this.$,Va.chartId,Va.operation,Va.WWh,"",!1,Va.Tye)};this.w0j=$a=>{if(!this.Xd){var Va;!$a||M.a.zf($a.Errors)||N.a.Zg(Va=$a.Result)?$a&&M.a.zf($a.Errors)&&c.ULS.sendTraceTag(537155091,0,50,`ChartCommandHandler.OnInsertChartSuccess: Operation succeeded with errors. FreezePanes support: ${J.f(this.$).VR}, Errors: ${M.a.pc($a.Errors)}`):
(c.ULS.sendTraceTag(537155092,0,50,`ChartCommandHandler.OnInsertChartSuccess: Operation succeeded. FreezePanes support: ${J.f(this.$).VR}`),x.a(this.$).u3a(4),L.a(this.$).XLa(0,Va),Ba.xek(this.$,$a))}};this.v0j=()=>{this.Xd||c.ULS.sendTraceTag(537155090,0,50,`ChartCommandHandler.OnInsertChartFailed: Operation failed. FreezePanes support: ${J.f(this.$).VR}`)};this.$=da;this.viewBlockContainerHelpers=sa;this.Ya=mb;this.Kw=Ma;this.vg=hb;this.Xd=!1}get Wb(){return J.f(this.$).ha.ob.Wb}executeCommand(da,
sa,mb){let Ma;switch(da){case 1:Ma=this.c8i(sa,mb);break;case 2:case 4:case 64:case 8:Ma=this.l7i(sa,mb,da);break;default:Ma=A.a(sa.command)}const hb=sa.Re;if((19===hb?za.a.nva():9===hb?za.a.LK():za.a.nva()||za.a.LK())&&2===da){const $a=J.f(this.$).ha.ob.Qj?J.f(this.$).ha.ob.Qj:"Null";sa=db.a(sa.command);let Va="Invalid";switch(hb){case 19:Va="ContextMenu";break;case 9:if(mb.ParentMenuId&&N.a.contains(mb.ParentMenuId,"ChartContextMenu",!0)){Va="ContextMenu";break}Va="Floatie";break;case 2:case 14:case 15:case 16:Va=
"Ribbon";break;case 6:Va="Keyboard";break;case 30:Va="Canvas"}if(!this.Wb)return c.ULS.sendTraceTag(507386061,6,50,"ChartCommandHandler.ExecuteCommand: Invalid Floating Object Control. ElementId:{0}, Command:{1}, EntryPoint:{2}",$a,sa,Va),Ma;mb=this.Wb.floatingObject;da=!!(this.kKd(da).Attributes&4);c.ULS.sendTraceTag(508371731,6,50,"ChartCommandHandler.ExecuteCommand:ID:{0}, ElementID:{1}, RibbonCommand:{2}, isSVGChart:{3}, isPivotChart:{4}, entryPoint:{5}",mb.Ec,$a,sa,!!wa.a.y8(mb),da,Va)}return Ma}Rc(da,
sa,mb,Ma){if(mb=!!mb&&!!Ma&&1===Ma.DH)switch(sa=sa.command,da){case 1:mb=699602235===sa||1644530823===sa;break;case 4:case 64:case 2:G.EwaSettings.isChangeGateEnabled("OfficeVSO:8804847_EnsureFOControlExists")&&(mb=!!this.Wb);break;case 8:break;default:mb=!1}return mb}td(da,sa,mb){var Ma=this.kKd(da);if(!Ma)return!1;let hb;da=null;switch(sa){case "PopulateAxesFlyout":da=this.Ya.pq("Axes.AxesGroups");sa=this.Ya.uc();sa.ku="Menu16";da.Zb.push(sa);var $a=G.EwaSettings.isChangeGateEnabled("OfficeVSO:8870332_enableFunnelChartRibbonAxisProps")?
19!==Ma.ChartCategory:!0;16!==Ma.ChartCategory&&$a&&(Ma=this.Ya.iu("Axes.Axes.Horizontal",null,K.a.instance.ia(968),-1777747317),Ma.populateOnlyOnce=!1,Ma.Sx="PopulateAxesHorizontalMenu",Ma.menuOpenCommand=-1495055390,Ma.menuCloseCommand=1929313450,Ma.JWb=K.a.instance.ia(1611),Ma.NZ("Image16by16",4,k.a.UEd),sa.buttons.push(Ma));Ma=this.Ya.iu("Axes.Axes.Vertical",null,K.a.instance.ia(969),-1777747317);Ma.populateOnlyOnce=!1;Ma.Sx="PopulateAxesVerticalMenu";Ma.menuOpenCommand=774399778;Ma.menuCloseCommand=
-1188713306;Ma.JWb=K.a.instance.ia(1612);Ma.NZ("Image16by16",4,k.a.WEd);sa.buttons.push(Ma);break;case "PopulateGridlinesFlyout":da=this.Ya.pq("Axes.AxesGroups");sa=this.Ya.uc();sa.ku="Menu16";da.Zb.push(sa);$a=this.Ya.iu("Axes.Gridlines.Horizontal",null,K.a.instance.ia(981),-1777747317);$a.populateOnlyOnce=!1;$a.Sx="PopulateGridlinesHorizontalMenu";$a.menuOpenCommand=685576228;$a.menuCloseCommand=-59166688;$a.JWb=K.a.instance.ia(1622);$a.NZ("Image16by16",4,k.a.Hxf);sa.buttons.push($a);16!==Ma.ChartCategory&&
(Ma=this.Ya.iu("Axes.Gridlines.Vertical",null,K.a.instance.ia(982),-1777747317),Ma.populateOnlyOnce=!1,Ma.Sx="PopulateGridlinesVerticalMenu",Ma.menuOpenCommand=-1048456E3,Ma.menuCloseCommand=600630160,Ma.JWb=K.a.instance.ia(1623),Ma.NZ("Image16by16",4,k.a.Mxf),sa.buttons.push(Ma));break;case "PopulateChartElements":hb=String.format('<Menu Id="{0}"><MenuSection Id="{0}Section"><Controls>',"ChartElementsList");Ma=Y.ChartElementManager.Yyc(this.$);if(!Ma)return!0;for(let Va=0,xa=Ma.length;Va<xa;Va++)13!==
Ma[Va].ChartContextType&&($a=Y.ChartElementManager.fOf(Ma[Va]),sa=b.a.Ig(Y.ChartElementManager.DKf(Ma[Va])),hb+=`<Button Id=${$a} MenuItemId=${$a} Command=${-1868205502} LabelText=${sa} />`);hb+="</Controls></MenuSection></Menu>";break;case "PopulateChartFillMenu":za.a.LK()&&wa.a.y8(this.Wb.floatingObject)?(da=this.Ya.pq(),Ma=this.Ya.eKb(1597684571,87208751,540,1532790410,za.a.aG()?1188510340:null,mb.MenuId),da.Zb.push(Ma)):hb="<Menu>"+this.Kw.ZGf(-981141954)+"</Menu>";break;case "PopulateChartOutlineMenu":za.a.LK()&&
wa.a.y8(this.Wb.floatingObject)?(da=this.Ya.pq(),Ma=this.Ya.eKb(409031041,-1744769642,539,-822056969,za.a.aG()?-984702347:null,mb.MenuId),da.Zb.push(Ma)):hb="<Menu>"+this.Kw.ZGf(409031041)+"<MenuSection><Controls>"+String.format('<FlyoutAnchor\r\n\t\t\t\t\t\t\tId="{0}"\r\n\t\t\t\t\t\t\tCommand="{1}"\r\n\t\t\t\t\t\t\tCommandMenuClose="{2}"\r\n\t\t\t\t\t\t\tLabelText="{3}"\r\n\t\t\t\t\t\t\tImage16by16="{4}"\r\n\t\t\t\t\t\t\tImage16by16Class="{5}"\r\n\t\t\t\t\t\t\tAlt="{3}"\r\n\t\t\t\t\t\t\tTemplateAlias="o1"\r\n\t\t\t\t\t\t\tPopulateDynamically="true"\r\n\t\t\t\t\t\t\tPopulateOnlyOnce="false"\r\n\t\t\t\t\t\t\tPopulateQueryCommand="{6}"\r\n\t\t\t\t\t\t\tKeytip="{7}"/>',
"OutlineWeight",-671455029,1461300262,K.a.instance.ia(1434),e.a.Lh(4),k.a.Tvc,"PopulateChartOutlineWeightMenu","")+String.format('<FlyoutAnchor\r\n\t\t\t\t\t\t\tId="{0}"\r\n\t\t\t\t\t\t\tCommand="{1}"\r\n\t\t\t\t\t\t\tCommandMenuClose="{2}"\r\n\t\t\t\t\t\t\tLabelText="{3}"\r\n\t\t\t\t\t\t\tImage16by16="{4}"\r\n\t\t\t\t\t\t\tImage16by16Class="{5}"\r\n\t\t\t\t\t\t\tAlt="{3}"\r\n\t\t\t\t\t\t\tTemplateAlias="o1"\r\n\t\t\t\t\t\t\tPopulateDynamically="true"\r\n\t\t\t\t\t\t\tPopulateOnlyOnce="false"\r\n\t\t\t\t\t\t\tPopulateQueryCommand="{6}"\r\n\t\t\t\t\t\t\tKeytip="{7}"/>',
"OutlineDashes",-1525887957,1461300262,K.a.instance.ia(1446),e.a.Lh(4),k.a.Qvc,"PopulateChartOutlineDashMenu","")+"</Controls></MenuSection></Menu>";break;default:Ma=Ba.ASh(sa,Ma,this.Ya);if(!Ma||!Ma.length)return!1;da=this.Ya.pq();$a=this.Ya.uc();"PopulateChartOutlineDashMenu"!==sa&&"PopulateChartOutlineWeightMenu"!==sa&&($a.ku="Menu32");$a.buttons.push(...Ma);da.Zb.push($a)}hb?mb.PopulationXML=hb:mb.MenuItems=da.wH();return!0}gd(da,sa){if(da&10){var mb=this.$;switch(sa){case 1942711205:return!1;
case -243317679:return!1;case -1985798686:case -911352779:if(G.EwaSettings.isChangeGateEnabled("OfficeVSO:8435566_TurnOffObserverChartCutCopy")&&wa.a.isObserverChart(this.Wb.floatingObject))return!0;break;case -219946702:case 1970784898:case -287251124:case -1925065947:case 1764140053:case -1077965542:case -1293291468:case -1832800737:case 1597684571:if(wa.a.y8(this.Wb.floatingObject))return this.Wb.vya(sa);break;case 409031041:if(za.a.LK()&&wa.a.y8(this.Wb.floatingObject))return this.Wb.vya(sa);
break;case 862825906:case -803000997:case 1532790410:case -822056969:if(za.a.LK()&&wa.a.y8(this.Wb.floatingObject))return this.Wb.vya(sa);break;case 1849330294:case -873142594:case 1855740761:case 2117491830:case 2107851680:case -1986737526:case 119706583:case -1741941813:if(za.a.nva()&&wa.a.y8(this.Wb.floatingObject))return this.Wb.vya(sa);break;case 1188510340:case -1828502776:case -984702347:if(za.a.LK()&&za.a.aG()&&wa.a.y8(this.Wb.floatingObject))return this.Wb.vya(sa);break;case 87208751:case -1744769642:if(za.a.LK()&&
wa.a.y8(this.Wb.floatingObject))return this.Wb.vya(sa)}if(!G.EwaSettings.Ra(16)&&-219946702===sa)return!0;const Ma=this.kKd(da);if(!Ma)return sa.toString()in Ba.Eke;if(1221897806===sa||1930653487===sa||1172793074===sa&&G.EwaSettings.Ra(155)){if(da&8)return!0;switch(Ma.ChartCategory){case 4:case 6:case 8:case 14:case 10:case 25:case 1:case 17:case 28:return!0}}if(da=E.a.Od(Ba.sBd,sa.toString())){const hb=Ma.Attributes;if(da.includes(Ma.ChartCategory)||hb&16&&da.includes(26)||!(hb&2)&&da.includes(27)||
hb&4&&da.includes(28))return!0}da=mb.$b;if(2054778433===sa)return Ma.Attributes&4?!(da.allowPivotSpecificOperations&&da.allowInteractivity):!0;if(G.EwaSettings.Ra(16)){if(!Y.ChartElementManager.Yyc(this.$))return sa.toString()in Ba.Dke;if(da=E.a.Od(Ba.hof,sa.toString())){mb=Y.ChartElementManager.Kma(mb);if(!mb)return!0;mb=mb.ChartContextType;if(da.includes(mb)||11===mb&&(mb=E.a.Od(Ba.iof,sa.toString()))&&mb.includes(Ma.ChartCategory))return!0}}}return this.qIc(sa)||699602235===sa&&L.a(this.$).U6b}dispose(){this.$=
null;this.Xd=!0}kKd(da){let sa=null;8===da?(da=U.a(this.$))&&!da.Haj&&(sa=da.Zc):2===da&&(da=this.Wb)&&(sa=da.floatingObject.Zc);return sa}qIc(da){let sa=!1;switch(da){case 878838759:case 1058162689:case -672614340:case 1755642342:case -845652330:case 1930653487:case 1221897806:sa=!(new t.SheetProtection(this.$.qa)).ie(1)}return sa}l7i(da,sa,mb){var Ma,hb=da.command,$a=8===mb,Va=this.Wb;if(1701016594===hb||817296323===hb||-1075099431===hb||!Va&&!$a||!$a&&(null===(Ma=Va.extension)||void 0===Ma?0:Ma.cxb)&&
1872288872!==hb)return Ia.Task.Va(!0);let xa=Ma=null;var ia=U.a(this.$);$a&&ia?(Ma=ia.chartId,xa=ia.Zc):!$a&&Va&&(Ma=Va.floatingObject.id,xa=Va.floatingObject.Zc);J.f(this.$);$a=null;ia=!0;switch(hb){case -1268000318:case -1315025180:case 705259519:case 1337914559:case 1104037533:case 669779310:case 1411819830:case -1115893616:case -119153793:case 1693000238:case -1324968385:case -482182953:case 1769742759:case -996710402:case 490661775:case -1162087593:case 80515665:case 2147076534:case -306129902:case -1253752845:case 1711257557:case 680253336:case -1772953364:case -215161981:case 895828731:case 683614408:case -1612014670:case 1259259728:case -220179662:case 1534680966:case -238895611:case -892714755:case 2006508979:case 252405382:case 670842692:case -572426128:case -806496391:case -1700998151:case 2104548628:case 1717508862:case -1391465588:case 342631857:case 1867444565:case 374300079:case -1996266048:case 493396546:case 1599247052:case 342855531:case -472675112:case -1774499423:case -1809877936:case -204160914:case -87783054:case 1650379138:xa&&
Ma?(hb=Ba.UWa(hb,xa.ChartCategory),$a=this.applyChartProperty(hb,Ma,xa,da)):ia=!1;break;case 419803868:case -2011789595:case -1513952223:ia=this.Bdf(hb,Ma,xa,da.Re);break;case 1356474004:Ma?$a=this.applyChartProperty(-101,Ma,xa,da):ia=!1;break;case 1942711205:hb=!1;G.EwaSettings.Ra(147)&&(Va=Sa.a.Cb(Pa.SafeLinksService))&&(hb=Va.rza("https://go.microsoft.com/fwlink/?LinkID=2270042"));hb||b.a.nda("https://go.microsoft.com/fwlink/?LinkID=2270042")&&f.a.YX("https://go.microsoft.com/fwlink/?LinkID=2270042");
ia=!0;break;case -243317679:Ma?(new oa(this.$,Ma),ia=!0):ia=!1;break;case 1172793074:G.EwaSettings.Ra(155)&&8!==mb||(xa&&Ma?new S(this.$,xa.DataRangeForDisplay,!(xa.Attributes&10),Ma):ia=!1);break;case 484692258:case 699602235:G.EwaSettings.isChangeGateEnabled("OfficeVSO:8695615_EnableComboChartTelemetry")&&699602235===hb&&sa[h.a.Wc]&&c.ULS.sendTraceTag(507557773,6,50,"ChartCommandHandler.InsertChart, menuItem:{1}",sa[h.a.Wc]);$a=this.applyChartProperty(Ba.ZLi(sa[h.a.Wc]),Ma,xa,da);break;case 2054778433:void Sa.a.resolve(Pa.DataRefreshManagerService,
{xa:1}).then(Z=>{Z.VSc(xa.DataConnectionName,xa.ExternalSourceIndex,da)});break;case -219946702:case 1970784898:case -287251124:case -1925065947:case 1764140053:case -1077965542:case -1293291468:case -1832800737:case 1597684571:case 1650812936:if(Va){Va.Gb(da,sa);break}case -803000997:case 409031041:za.a.LK()&&(-803000997===hb&&(sa.Color="#000000"),Va&&Va.Gb(da,sa));break;case -822056969:case 1532790410:case 862825906:za.a.LK()&&(mb=sa=null,862825906===hb?(sa="#000000",mb=-1832800737):-822056969===
hb?(sa="#FFFFFF",mb=409031041):(sa="#FFFFFF",mb=1597684571),Va&&(sa=Va.yQb(mb)),null!==sa&&null!==mb&&this.vg.mnb(mb,da,sa));break;case 1849330294:case -873142594:case 1855740761:case 2117491830:case 2107851680:case -1986737526:case 119706583:case -1741941813:za.a.nva()&&Va&&Va.Gb(da,sa);break;case 87208751:case -1744769642:za.a.LK()&&(sa.clearFillOutlineCmdVal="-2",Va&&Va.Gb(da,sa));break;case 1188510340:case -1828502776:case -984702347:$a=za.a.LK()&&za.a.aG()?this.vg.launchEyedropper(hb,da):Ia.Task.Va(!1);
break;default:G.EwaSettings.Ra(16)?$a=this.k7i(da,Ma,sa,xa):ia=!1}return $a||Ia.Task.Va(ia)}k7i(da,sa,mb,Ma){switch(da.command){case -1868205502:return Y.ChartElementManager.selectChartElement(this.$,mb[h.a.Bf]),Ia.Task.Va(!0);case -1156957021:return mb=Y.ChartElementManager.u_i(this.$),Ia.Task.Va(1461300262!==mb&&this.Bdf(mb,sa,Ma,da.Re));default:return this.m7i(da,sa,mb)}}m7i(da,sa,mb){var Ma=Y.ChartElementManager.Kma(this.$);if(!Ma)return Ia.Task.Va(!1);const hb=Ma.ChartContextType;let $a,Va=0;
Y.ChartElementManager.Ewj(hb)?($a=Array(2),$a[0]=Y.ChartElementManager.seriesIndex(Ma).toString(),Va=1):$a=Array(1);Ma=Y.ChartElementManager.CLd(Ma);switch(da.command){case -981141954:$a[Va]=mb.Color;mb=16;break;case 409031041:$a[Va]=mb.Color;mb=17;break;case -1736601456:$a[Va]=mb[h.a.Bf];mb=9;break;case -619033944:$a[Va]=mb[h.a.Bf];mb=8;break;case -287251124:$a[Va]=(Ma.Bold=!Ma.Bold).toString();Ma.ValidMembers^=4;mb=0;break;case 1970784898:$a[Va]=mb.Color;mb=4;break;case -1293291468:Ma.FontName=
$a[Va]=mb[h.a.Bf];mb=3;break;case -1077965542:Ma.FontSize=parseFloat($a[Va]=mb[h.a.Bf]);mb=5;break;case -1925065947:$a[Va]=(Ma.Italic=!Ma.Italic).toString();Ma.ValidMembers^=8;mb=1;break;case 1764140053:$a[Va]=(Ma.Underline=!Ma.Underline)?"1":"0";Ma.ValidMembers^=16;mb=2;break;default:return Ia.Task.Va(!1)}return this.applyChartPropertyDual(hb,mb,sa,$a,da)}c8i(da,sa){const mb=da.command;switch(mb){case 699602235:da=this.insertChart(Ba.LGf(sa[h.a.Wc]),da);break;case 1644530823:da=this.insertChart(51,
da);break;default:da=A.a(mb)}return da}insertChart(da,sa){if(!this.$.Ss(null,!1))return Ia.Task.Va(!0);var mb=J.f(this.$);const Ma=m.u(mb.ha.oa.selectedRanges,this.$),hb=this.$.ma.sa.mc();var $a=this.viewBlockContainerHelpers.X7a(mb);let Va,xa,ia,Z;$a?(mb=$a.nf,Va=mb.Fd.top,xa=mb.Fd.left,ia=$a.ZO.x,Z=$a.ZO.y):(Va=xa=1,$a=this.viewBlockContainerHelpers.VGa(mb),ia=$a.x,Z=$a.y);const ta=()=>new Na(Ma,da);return u.a(this.$.userOperationManager,(pa,Ga,Ca)=>C.e(this.$.ma.sa,Ma,da,Va,xa,ia,Z,I.c(pa,this.w0j),
I.b(Ga,this.v0j),Ca,null,hb),pa=>new l.a(528,0,pa,64,ta),sa)}Bdf(da,sa,mb,Ma){if(!sa||!mb)return!1;da=Ba.UWa(da,mb.ChartCategory);new fa(this.$,sa,da,mb.ChartCategory,mb.ChartTitle,!0,Ma);return!0}applyChartProperty(da,sa,mb,Ma){if(!sa)return A.a(Ma.command);const hb=this.$.ma.sa.mc(),$a=()=>new n.a(sa,da,""),Va=new B(sa,da,mb.ChartCategory,Ma.Re);return u.a(this.$.userOperationManager,(xa,ia,Z)=>C.a(this.$.ma.sa,sa,da,"",I.c(xa,this.ljg),ia,Z,Va,hb),xa=>new l.a(529,0,xa,68,$a),Ma)}applyChartPropertyDual(da,
sa,mb,Ma,hb){if(!mb)return A.a(hb.command);const $a=this.$.ma.sa.mc();return u.a(this.$.userOperationManager,(Va,xa,ia)=>C.b(this.$.ma.sa,mb,da,sa,Ma,I.c(Va,this.ljg),xa,ia,$a),Va=>new l.a(530,0,Va,68),hb)}static initData(){Ba.Vsd();Ba.$Ph();Ba.mQh();Ba.JPh();G.EwaSettings.isChangeGateEnabled("OfficeVSO:8870332_enableFunnelChartRibbonAxisProps")&&Ba.zQh();Ba.nQh();Ba.oQh();Ba.pQh();Ba.ZPh();Ba.oRh();Ba.nRh()}static LGf(da){return Ba.Kdf[da]}static UWa(da,sa){let mb;G.EwaSettings.isChangeGateEnabled("OfficeVSO:8870332_enableFunnelChartRibbonAxisProps")?
(mb=Ba.WAd[da.toString()],Ba.$Yf(da)&&(5===sa||6===sa?mb=Ba.Qrd[da.toString()]:19===sa&&(mb=Ba.kEf[da.toString()]))):mb=!Ba.$Yf(da)||5!==sa&&6!==sa?Ba.WAd[da.toString()]:Ba.Qrd[da.toString()];return mb}static ZLi(da){return Ba.udf[da]}static f3i(da,sa){sa=5===sa||6===sa;switch(da){case -102:case 1:case 2:da=1;break;case -103:da=2;break;case -104:da=3;break;case 307:case 308:case 311:case 309:case 310:da=sa?2:3;break;case 301:case 302:case 305:case 303:case 304:da=sa?3:2;break;default:da=1}return da}static ASh(da,
sa,mb){const Ma=sa.ChartCategory;let hb=[];sa=sa.Attributes;switch(da){case "PopulateDataLabelsMenu":switch(Ma){case 3:case 5:case 18:case 23:case 24:hb=[0,4,7,9];sa&32||(hb=hb.concat(10));break;case 7:case 11:hb=[1,5,12,13,14,15];break;case 9:case 10:hb=[2,6,8,11,16];break;case 12:hb=[0,4,12,13,14,15];break;case 13:case 16:case 6:case 4:case 14:hb=[0,3];break;case 20:hb=[0,144];break;case 21:hb=[2,145];break;case 19:hb=[0,143];break;case 25:hb=[0,3];break;case 22:hb=[141,139,142,140,138];break;case 15:hb=
[2,3];break;case 17:hb=[0];break;case 8:hb=[1,3]}break;case "PopulateAxesHorizontalMenu":switch(Ma){case 3:case 4:case 7:case 8:case 13:case 17:case 14:hb=[17,18,19,20];break;case 11:case 12:case 5:case 6:hb=sa&1?[17,21,25]:[17,21,22,23,24,25];break;case 18:case 23:case 24:case 22:hb=[17,18,19]}break;case "PopulateAxesVerticalMenu":switch(Ma){case 3:case 4:case 7:case 8:case 11:case 12:case 16:case 13:case 17:case 14:hb=sa&1?[26,27,31]:[26,27,28,29,30,31];break;case 18:case 23:case 24:case 22:hb=
[26,27,28,29,30];break;case 5:case 6:hb=[26,27,32,33];break;case 19:G.EwaSettings.isChangeGateEnabled("OfficeVSO:8870332_enableFunnelChartRibbonAxisProps")&&(hb=[26,27])}break;case "PopulateGridlinesHorizontalMenu":hb=[34,35,36,37];break;case "PopulateGridlinesVerticalMenu":hb=[38,39,40,41];break;case "PopulatePivotContextMenu":break;case "PopulateChartOutlineWeightMenu":hb=[128,129,130,131];break;case "PopulateChartOutlineDashMenu":hb=[132,133,134];break;default:return null}da=Array(hb.length);for(let $a=
0,Va=da.length;$a<Va;$a++)da[$a]=mb.yb(hb[$a]);return da}static Vsd(){const da=d.a.xha;da(1929313450,w.a.xx,0,0);da(-1495055390,w.a.Vu,0,0);da(-963696720,w.a.xx,0,0);da(1031074088,w.a.Vu,0,0);da(-1188713306,w.a.xx,0,0);da(774399778,w.a.Vu,0,0);da(-416895062,w.a.xx,0,0);da(-72507346,w.a.Vu,0,0);da(-1749121940,w.a.xx,0,0);da(468560048,w.a.Vu,0,0);da(1436480230,w.a.xx,0,0);da(689093526,w.a.Vu,0,0);da(484692258,w.a.zd,0,4);da(-1478278396,w.a.xx,0,0);da(-508421920,w.a.Vu,0,0);da(71265892,w.a.xx,0,0);da(-740159776,
w.a.Vu,0,0);da(-562781919,w.a.xx,0,0);da(-1070738481,w.a.Vu,0,0);da(-239339751,w.a.xx,0,0);da(-249448185,w.a.Vu,0,0);da(417064315,w.a.xx,0,0);da(468398977,w.a.Vu,0,0);da(-1053233165,w.a.xx,0,0);da(-1256174279,w.a.Vu,0,0);da(1731418977,w.a.xx,0,0);da(1322442299,w.a.Vu,0,0);da(705259519,w.a.zd,0,0);da(-1315025180,w.a.zd,0,0);da(-1268000318,w.a.zd,0,0);da(-204160914,w.a.zd,0,0);da(-87783054,w.a.zd,0,0);da(1650379138,w.a.zd,0,0);da(-1996266048,w.a.zd,0,0);da(1599247052,w.a.zd,0,0);da(493396546,w.a.zd,
0,0);da(-472675112,w.a.zd,0,0);da(374300079,w.a.zd,0,0);da(342855531,w.a.zd,0,0);da(-1774499423,w.a.zd,0,0);da(-1809877936,w.a.zd,0,0);da(-1391465588,w.a.zd,0,0);da(342631857,w.a.zd,0,0);da(1867444565,w.a.zd,0,0);da(419803868,w.a.zd,0,0);da(1172793074,w.a.zd,0,0);da(-2011789595,w.a.zd,0,0);da(-1513952223,w.a.zd,0,0);da(609898710,w.a.xx,0,0);da(2107545606,w.a.Vu,0,0);da(-1156957021,w.a.zd,0,0);da(-981141954,w.a.zd,0,0);da(853483460,w.a.Vu,0,0);da(-286073132,w.a.xx,0,0);da(-238895611,w.a.zd,0,0);da(683614408,
w.a.zd,0,0);da(-892714755,w.a.zd,0,0);da(1534680966,w.a.zd,0,0);da(895828731,w.a.zd,0,0);da(1259259728,w.a.zd,0,0);da(-482182953,w.a.zd,0,0);da(-1324968385,w.a.zd,0,0);da(-220179662,w.a.zd,0,0);da(-1612014670,w.a.zd,0,0);da(-306129902,w.a.zd,0,0);da(2147076534,w.a.zd,0,0);da(-1253752845,w.a.zd,0,0);da(80515665,w.a.zd,0,0);da(-1115893616,w.a.zd,0,0);da(1411819830,w.a.zd,0,0);da(1693000238,w.a.zd,0,0);da(1337914559,w.a.zd,0,0);da(1104037533,w.a.zd,0,0);da(-119153793,w.a.zd,0,0);da(669779310,w.a.zd,
0,0);da(409031041,w.a.zd,0,0);da(1188510340,w.a.zd,0,0);da(-1828502776,w.a.zd,0,0);da(-984702347,w.a.zd,0,0);da(-1736601456,w.a.zd,0,0);da(-1525887957,w.a.Vu,0,0);da(-1211266709,w.a.Vu,0,0);da(-1030447919,w.a.xx,0,0);da(-619033944,w.a.zd,0,0);da(-671455029,w.a.Vu,0,0);da(1356474004,w.a.zd,0,0);da(-1192695931,w.a.xx,0,0);da(-561794525,w.a.Vu,0,0);da(-806496391,w.a.zd,0,0);da(252405382,w.a.zd,0,0);da(-1700998151,w.a.zd,0,0);da(-572426128,w.a.zd,0,0);da(2006508979,w.a.zd,0,0);da(1717508862,w.a.zd,0,
0);da(670842692,w.a.zd,0,0);da(-1162087593,w.a.zd,0,0);da(1769742759,w.a.zd,0,0);da(-996710402,w.a.zd,0,0);da(490661775,w.a.zd,0,0);da(2104548628,w.a.zd,0,0);da(-1772953364,w.a.zd,0,0);da(680253336,w.a.zd,0,0);da(-215161981,w.a.zd,0,0);da(1711257557,w.a.zd,0,0);da(1279388860,w.a.jX,0,0);da(-1639945714,w.a.xx,0,0);da(1240254154,w.a.Vu,0,0);da(443471155,w.a.xx,0,0);da(1601208909,w.a.Vu,0,0);da(-59166688,w.a.xx,0,0);da(685576228,w.a.Vu,0,0);da(-1746717186,w.a.xx,0,0);da(1249042882,w.a.Vu,0,0);da(600630160,
w.a.xx,0,0);da(-1048456E3,w.a.Vu,0,0);da(845857104,w.a.xx,0,0);da(2055047988,w.a.Vu,0,0);da(-1868205502,w.a.zd,0,0);da(1942711205,w.a.zd,0,0);da(-243317679,w.a.zd,0,0)}static $Ph(){Ba.Kdf={["ColumnClustered"]:51,["ColumnStacked"]:52,["ColumnStacked100"]:53,["Line"]:4,["LineStacked"]:63,["LineStacked100"]:64,["LineMarkers"]:65,["LineMarkersStacked"]:66,["LineMarkersStacked100"]:67,["Pie"]:5,["PieExploded"]:69,["BarClustered"]:57,["BarStacked"]:58,["BarStacked100"]:59,["Area"]:1,["AreaStacked"]:76,
["AreaStacked100"]:77,["XYScatter"]:-4169,["XYScatterSmooth"]:72,["XYScatterLines"]:74,["XYScatterSmoothNoMarkers"]:73,["XYScatterLinesNoMarkers"]:75,["Doughnut"]:-4120,["DoughnutExploded"]:80,["Radar"]:-4151,["RadarMarkers"]:81,["RadarFilled"]:82,["Waterfall"]:119,["Funnel"]:123,["Treemap"]:117,["Sunburst"]:120,["BoxWhisker"]:121,["Histogram"]:118,["Pareto"]:122,["RegionMap"]:140,["Combo"]:-4152,["ComboColumnClusteredLine"]:113,["ComboColumnClusteredLineSecondaryAxis"]:114,["ComboAreaStackedColumnClustered"]:115}}static mQh(){Ba.WAd=
{["1356474004"]:-101,["419803868"]:-102,["-2011789595"]:-103,["-1513952223"]:-104,["-1324968385"]:300,["-482182953"]:301,["1769742759"]:306,["-996710402"]:309,["490661775"]:310,["-1162087593"]:311,["-1268000318"]:0,["-1315025180"]:1,["705259519"]:2,["1337914559"]:100,["1104037533"]:101,["669779310"]:102,["1411819830"]:103,["-1115893616"]:104,["-119153793"]:105,["1693000238"]:106,["374300079"]:200,["-1809877936"]:201,["-1996266048"]:202,["493396546"]:203,["1599247052"]:204,["342855531"]:205,["-472675112"]:206,
["-1774499423"]:207,["-204160914"]:208,["-87783054"]:209,["1650379138"]:210,["-1391465588"]:500,["342631857"]:501,["1867444565"]:502,["895828731"]:348,["683614408"]:349,["-1612014670"]:350,["1259259728"]:351,["-220179662"]:372,["1534680966"]:373,["-238895611"]:374,["-892714755"]:375,["2006508979"]:352,["252405382"]:353,["670842692"]:354,["-572426128"]:355,["-806496391"]:356,["-1700998151"]:357,["80515665"]:328,["2147076534"]:329,["-306129902"]:330,["-1253752845"]:331,["1711257557"]:332,["680253336"]:333,
["-1772953364"]:334,["-215161981"]:335}}static ZPh(){Ba.udf={["ColumnClustered"]:-105,["ColumnStacked"]:-106,["ColumnStacked100"]:-107,["Line"]:-108,["LineStacked"]:-109,["LineStacked100"]:-110,["LineMarkers"]:-111,["LineMarkersStacked"]:-112,["LineMarkersStacked100"]:-113,["Pie"]:-114,["PieExploded"]:-115,["BarClustered"]:-116,["BarStacked"]:-117,["BarStacked100"]:-118,["Area"]:-119,["AreaStacked"]:-120,["AreaStacked100"]:-121,["XYScatter"]:-122,["XYScatterSmooth"]:-123,["XYScatterLines"]:-124,["XYScatterSmoothNoMarkers"]:-125,
["XYScatterLinesNoMarkers"]:-126,["Doughnut"]:-127,["DoughnutExploded"]:-128,["Radar"]:-129,["RadarMarkers"]:-130,["RadarFilled"]:-131,["Waterfall"]:-216,["Funnel"]:-217,["Treemap"]:-218,["Sunburst"]:-219,["BoxWhisker"]:-220,["Histogram"]:-221,["Pareto"]:-222}}static JPh(){Ba.Qrd={["-1324968385"]:306,["-482182953"]:307,["1769742759"]:300,["-996710402"]:303,["490661775"]:304,["-1162087593"]:305,["895828731"]:352,["683614408"]:353,["-220179662"]:354,["1534680966"]:355,["-238895611"]:356,["-892714755"]:357,
["2006508979"]:348,["252405382"]:349,["2104548628"]:350,["1717508862"]:351,["1711257557"]:328,["680253336"]:329,["-1772953364"]:330,["-215161981"]:331,["80515665"]:332,["2147076534"]:333,["-306129902"]:334,["-1253752845"]:335}}static zQh(){Ba.kEf={["1769742759"]:300,["2006508979"]:348,["252405382"]:349}}static nQh(){const da=[0,1,2],sa=[];G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSComboChartUIInXLO",!1)&&sa.push(da.pop());const mb=[9,15,10],Ma=[11,12],hb=[12,17],$a=[5,6],
Va=[16],xa=[19],ia=[20,21,25],Z=[18,19,20,21,22,23,24,25],ta=[18,19,20,21,23,24,25],pa=[22],Ga=[0,2,3,4,7,8,9,13,15,16,17,14,10],Ca=[25],kb=[26],eb=[28];let Yb=hb;G.EwaSettings.isChangeGateEnabled("OfficeVSO:5099858_EnableAllChangeChartTypes")||(Yb=hb.concat(Z));const Gb=[17],Mb=[13,16,15,6,4,8,14],Rb=[5,3],$b=[9,10],cc=[11,7,12],fb=[...mb,...sa,...ia,...kb];G.EwaSettings.isChangeGateEnabled("OfficeVSO:8870332_enableFunnelChartRibbonAxisProps")||fb.push(...xa);Ba.sBd={["-845652330"]:da.concat(Yb),
["1058162689"]:da.concat(Yb),["878838759"]:da.concat(hb,eb),["-672614340"]:da.concat(kb),["1755642342"]:da.concat(fb),["-561794525"]:da.concat(kb),["468560048"]:da.concat(fb,Va),["-72507346"]:da.concat(sa,mb,Va,xa,ia,kb),["689093526"]:da.concat(fb,Va),["2055047988"]:da.concat(kb),["1240254154"]:da.concat(sa,kb),["1601208909"]:da.concat(sa,mb,Va,Ma,Z,kb),["1031074088"]:da.concat(fb),["-1495055390"]:da.concat(sa,mb,xa,ia,Va,kb),["774399778"]:da.concat(fb),["1249042882"]:da.concat(sa,mb,xa,ia,kb),["685576228"]:da.concat(sa,
mb,xa,ia,kb),["-1048456000"]:da.concat(sa,mb,ia,Va,xa,kb),["1356474004"]:da.concat(sa,hb,[27],eb,Z),["419803868"]:da.concat(kb),["-2011789595"]:da.concat(sa,mb,Va,xa,ia,kb),["-1513952223"]:da.concat(sa,mb,Va,ia,kb),["1172793074"]:da.concat(hb,eb),["1930653487"]:da.concat(hb,eb),["699602235"]:da.concat(hb,Ca),["-96249359"]:da.concat(sa,Z),["484692258"]:da.concat(hb,Ca),["-1268000318"]:da.concat(kb),["-1315025180"]:da.concat(kb),["705259519"]:da.concat(kb),["-1324968385"]:da.concat(sa,mb,ia,xa,Va,kb),
["-1612014670"]:da.concat(sa,mb,ia,xa,Va,kb),["1769742759"]:da.concat(fb,Va),["-996710402"]:da.concat(sa,mb,ia,xa,Va,kb),["490661775"]:da.concat(sa,mb,Z,Va,kb),["-1162087593"]:da.concat(sa,mb,Z,Va,kb),["1337914559"]:da.concat(kb),["1104037533"]:da.concat(kb),["669779310"]:da.concat(kb),["1411819830"]:da.concat(kb),["-1115893616"]:da.concat(kb),["-119153793"]:da.concat(kb),["1693000238"]:da.concat(kb),["374300079"]:da.concat(sa,kb),["-1809877936"]:da.concat(sa,Gb,Rb,$b,cc,[18,23,24],kb),["-1996266048"]:da.concat(sa,
Gb,Mb,xa,ia,pa,kb),["493396546"]:da.concat(sa,Gb,Mb,ia,xa,pa,cc,kb),["1599247052"]:da.concat(sa,Gb,Mb,ia,xa,pa,$b,cc,kb),["342855531"]:da.concat(sa,Gb,Mb,ia,xa,pa,cc,kb),["-472675112"]:da.concat(sa,Gb,Mb,Rb,ta,$b,kb),["-1774499423"]:da.concat(sa,Gb,Mb,Rb,ta,$b,kb),["-204160914"]:da.concat(sa,Gb,Mb,Rb,ta,$b,kb),["-87783054"]:da.concat(sa,Gb,Mb,Rb,ta,$b,kb),["1650379138"]:da.concat(sa,Gb,Mb,Rb,Z,cc,kb),["-1391465588"]:da.concat(sa,mb,Va,Ma,Z,kb),["342631857"]:da.concat(sa,mb,Va,Ma,Z,kb),["1867444565"]:da.concat(sa,
mb,Va,Ma,Z,kb),["895828731"]:da.concat(sa,mb,Va,xa,ia,kb),["683614408"]:da.concat(sa,mb,Va,xa,ia,kb),["-1612014670"]:da.concat(sa,mb,Va,xa,ia,Ma,$a,kb),["1259259728"]:da.concat(sa,mb,Va,Z,Ma,$a,kb),["-220179662"]:Ga.concat(Z,kb),["1534680966"]:Ga.concat(Z,kb),["-238895611"]:Ga.concat(Z,kb),["-892714755"]:Ga.concat(Z,kb),["2006508979"]:da.concat(fb),["252405382"]:da.concat(fb),["670842692"]:da.concat(sa,mb,xa,ia,$a,kb),["-572426128"]:da.concat(sa,mb,xa,ia,$a,kb),["-806496391"]:da.concat(sa,mb,xa,ia,
$a,kb),["-1700998151"]:da.concat(sa,mb,Z,$a,kb),["1717508862"]:Ga.concat(Ma,Z,kb),["2104548628"]:Ga.concat(Ma,Z,kb),["80515665"]:da.concat(sa,mb,xa,ia,kb),["2147076534"]:da.concat(sa,mb,xa,ia,kb),["-306129902"]:da.concat(sa,mb,xa,ia,kb),["-1253752845"]:da.concat(sa,mb,xa,ia,kb),["1711257557"]:da.concat(sa,mb,ia,Va,xa,kb),["680253336"]:da.concat(sa,mb,ia,Va,xa,kb),["-1772953364"]:da.concat(sa,mb,ia,Va,xa,kb),["-215161981"]:da.concat(sa,mb,ia,Va,xa,kb)};Ba.mck(Ba.sBd,da.concat(sa,Gb,Z,kb))}static Sce(da,
sa){z.c(da,{["-981141954"]:sa,["-286073132"]:sa,["853483460"]:sa})}static Tce(da,sa){z.c(da,{["409031041"]:sa,["-1736601456"]:sa,["-1525887957"]:sa,["-1030447919"]:sa,["-1211266709"]:sa,["-619033944"]:sa,["-671455029"]:sa})}static Ixg(da,sa){z.c(da,{["609898710"]:sa,["2107545606"]:sa,["-1868205502"]:sa})}static Jxg(da,sa){z.c(da,{["-287251124"]:sa,["1970784898"]:sa,["1636441681"]:sa,["-1293291468"]:sa,["-1077965542"]:sa,["-1925065947"]:sa,["1764140053"]:sa})}static mck(da,sa){Ba.Sce(da,sa);Ba.Tce(da,
sa);Ba.Ixg(da,sa);Ba.Jxg(da,sa);z.c(da,{["-1156957021"]:sa,["1279388860"]:sa,["459047735"]:sa})}static oQh(){const da=[0,1,2],sa=[3,4],mb=[7,8,9,10],Ma=[13],hb=[14],$a=[11],Va=[5,6],xa=Ba.hof={["-1156957021"]:mb.concat($a,Ma,sa,Va,hb)};Ba.Sce(xa,da.concat(sa,mb,Va,Ma));Ba.Tce(xa,da.concat(sa,Ma));Ba.Ixg(xa,null);Ba.Jxg(xa,mb.concat($a,Ma,hb))}static pQh(){const da=[11,12],sa=Ba.iof={};Ba.Sce(sa,[7,8].concat([9,15,16,10],da));Ba.Tce(sa,da)}static oRh(){Ba.Eke=z.a({},"878838759 1356474004 1172793074 1058162689 484692258 -845652330 699602235 -672614340 -561794525 -1268000318 -1315025180 705259519 419803868 468560048 -72507346 -1324968385 -482182953 -2011789595 689093526 1769742759 -996710402 490661775 -1162087593 -1513952223 2055047988 1337914559 1104037533 669779310 1411819830 -1115893616 -119153793 1693000238 1601208909 -1391465588 342631857 1867444565 1240254154 374300079 -1996266048 493396546 1599247052 342855531 -472675112 -1774499423 -1809877936 -204160914 -87783054 1650379138 1755642342 1031074088 -1495055390 895828731 683614408 -1612014670 1259259728 -220179662 1534680966 -238895611 -892714755 774399778 2006508979 252405382 670842692 -572426128 -806496391 -1700998151 2104548628 1717508862 1249042882 685576228 80515665 2147076534 -306129902 -1253752845 -1048456000 1711257557 680253336 -1772953364 -215161981 1930653487".split(" "));
Ba.Daf(Ba.Eke)}static nRh(){Ba.Dke={};Ba.Daf(Ba.Dke)}static Daf(da){z.a(da,"-981141954 853483460 -287251124 1970784898 1636441681 -1293291468 -1077965542 -1925065947 2107545606 -1156957021 1764140053 409031041 -1736601456 -1525887957 -1211266709 -619033944 -671455029 -1868205502".split(" "))}static xek(da,sa){const mb=G.EwaSettings.isChangeGateEnabled("OfficeVSO:8434150_MigrateValidationTelemetryManager")?Sa.a.Cb(Pa.ValidationTelemetryManagerService):da.ra.Tb(277);mb&&mb.znd(da,0,sa.Result,sa,"InsertChart")}static $Yf(da){let sa=
!1;switch(da){case -238895611:case 683614408:case -892714755:case 1534680966:case 895828731:case 1259259728:case -220179662:case -482182953:case -1324968385:case -1612014670:case -306129902:case 2147076534:case -1253752845:case 80515665:case -806496391:case 252405382:case -1700998151:case -572426128:case 2006508979:case 1717508862:case 670842692:case -1162087593:case 1769742759:case -996710402:case 490661775:case 2104548628:case -1772953364:case 680253336:case -215161981:case 1711257557:sa=!0}return sa}};
Ka.Kdf=null;Ka.WAd=null;Ka.Qrd=null;Ka.kEf=null;Ka.udf=null;Ka.sBd=null;Ka.hof=null;Ka.iof=null;Ka.Eke=null;Ka.Dke=null;Ka=Ba=Object(y.__decorate)([Object(Sa.d)(Pa.ChartCommandHandlerService),Object(y.__param)(0,Object(Pa.EwaControlService)()),Object(y.__param)(1,Object(O.i)()),Object(y.__param)(2,Object(Pa.RibbonControlsService)()),Object(y.__param)(3,Object(Pa.PopulateDynamicHelperService)()),Object(y.__param)(4,Object(Pa.MoreColorsHelperService)())],Ka);Object(r.a)(Ka,"ChartCommandHandler",null,
[29,4])},1053:function(y,r,a){a.d(r,"a",function(){return I});y=a(0);var c=a(15),b=a(91),f=a(105),k=a(72),x=a(1130),d=a(953),h=a(70),n=a(150),m=a(944),u=a(1067),l=a(1068),t=a(1003);class e{constructor(L,J){this.position=L;this.$m=J}}Object(y.a)(e,"PositionAndExtent",null,[]);var w=a(1128),z=a(1),E=a(12),M=a(119),G=a(435),A=a(151),N=a(115),K=a(17);class I extends f.a{constructor(L,J,B,Y,U,O=null,C=null){super(L,C);this.M0a=null;this.Znb=!1;this.wEa=0;this.jbe=null;this.cXe=this.translateY=this.translateX=
this.Txa=this.Sxa=0;this.Qva=this.jfc=this.Xhd=this.Vmc=!1;this.zIndex=0;this.Dh=this.w6=this.Afa=this.jo=this.vf=this.Sb=null;this.kbe=0;this.pD=null;this.yK=this.xK=!1;this.zB=this.PUa=null;this.R6=0;this.m9d=X=>{16===X.keyCode?!this.Znb&&this.X3&&(this.Znb=!0,this.ZP.Ea("keyup",this.n9d),this.update()):this.da.u0d(X)};this.n9d=X=>{this.Znb&&this.X3&&16===X.keyCode&&(this.Znb=!1,this.ZP.detach("keyup"),this.update())};this.ZP=this.Df.zUa();this.da=J;this.control=B;this.hbb=O;this.Ep=Y;this.Pbc=
U;this.ULa();A.a(this.control.$,X=>{this.M0a=X.tX(n.a.SCi,!1)})}Xod(L){this.addHandler(I.r4b,L)}EHg(L){this.removeHandler(I.r4b,L)}UFh(L){this.addHandler("Resized",L)}Cuk(L){this.removeHandler("Resized",L)}TFh(L){this.addHandler(I.q4b,L)}Buk(L){this.removeHandler(I.q4b,L)}SFh(L){this.addHandler("ResizeCancelled",L)}Auk(L){this.removeHandler("ResizeCancelled",L)}get X3(){return this.Xhd}get WHc(){return this.jfc}get viewBlockContainerHelpers(){return this.hbb}get dT(){return this.Pbc}get rotation(){return this.cXe}set rotation(L){const J=
this.Sb?this.Sb.FlipX!==this.Sb.FlipY:!1;this.kbe=L;this.cXe=t.i(L,J);this.Vmc=M.a.p8(L,J)}get control(){return this.pD}set control(L){this.pD=L}get TO(){return this.rotation+this.R6}get A0b(){return this.control.cx?this.control.cx.offsetTop:0}get z0b(){return this.control.cx?this.control.cx.offsetLeft:0}dispose(){b.a.vb(this.ZP);this.f1();this.da=null;super.dispose()}tka(L){return L.Dq!==Sys.UI.MouseButton.middleButton}wwa(L){L.qye?this.lIb():this.gca()}xwa(L){this.control.$&&N.a().Qf(L);this.gca()}ywa(L){L=
this.control.$?N.a().Qf(L):L;this.resize(L.clientPoint,!1);return!0}V1a(L){L=this.control.$?N.a().Qf(L):L;if(!this.NNc(L))return!1;this.PUa=this.i_i(L.sc);if(!this.PUa)return!1;this.s6a(L.clientPoint,I.j_i(this.PUa));return!0}update(){this.w6&&this.resize(this.w6,!1)}yia(L){this.Sb||(this.rotation=(this.Sb=this.control.floatingObject.Sb)?this.Sb.Rotation:0);this.Epd();this.control.yia(L,8,this);this.W3(null)}f1(){this.control.f1(this)}s6a(L,J){this.X3||(this.Dh=this.control.Ug,this.vf=this.Wg(),this.Fpe(L,
J),this.Afa=this.hA(L,this.Dh.rtl),this.raiseEvent(I.r4b),this.resize(L,!0))}lIb(){this.jfc=!0;this.control.clientVersion--;this.resize(this.jbe,!0);this.gca()}W3(L){this.m4a(this.control,L)}upgrade(L){this.R6=0;if(null===L||void 0===L?0:L.Sb)this.rotation=(this.Sb=L.Sb)?this.Sb.Rotation:0,this.Epd(),this.W3(L)}Wrc(L,J){L=this.VNd(J);J=this.da.rtl;L=3===h.a.Hb?this.dT.hbi(this.control.Tj.style.borderTopColor,J,L,!!this.rotation):this.dT.V$h(J,L,!!this.rotation);L.style.zIndex=String(this.zIndex);
return L}VNd(L){return L}RRd(){}m4a(L){if(L.RI&&this.control.Taa()&&L.isVisible){var J=t.c(this.TO);t.l(E.HelperMethods.isStandardZoomCssSupportedByBrowser?K.DOMElementExtensions.getBoundingClientRect({element:L.Tj.parentNode,di:!0}):Sys.UI.DomElement.getBounds(L.Tj.parentNode),L.RI,J,L.Ug.rtl);z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FOResizeHandlesFix",!1)&&t.o(L.RI,this.rotation,!1)}}D1h(L){const J=this.control;if(J.RI&&this.control.Taa()&&J.isVisible){var B=t.e(this.kbe);t.o(J.RI,
L,!0,B)}}ULa(){this.Dh=this.control.Ug;this.vf=this.Wg();this.R6=0;this.Ep&&this.Ep.splice(0)}Vfa(L){this.R6=L;this.W3(null)}Xpe(L,J){this.viewBlockContainerHelpers.WQg(this.Dh,this.control.domElement,L,J)}Wg(){return this.viewBlockContainerHelpers.Dca(this.Dh,this.control.domElement)}hA(L,J){return this.viewBlockContainerHelpers.hA(this.Dh,L,J)}resize(L,J){this.w6=L;const B=this.Dh.Nn,Y=this.control.Ug.Nn;this.zB=this.hA(L,this.Dh.rtl);const U=m.a.OL(this.zB,this.Afa);this.zB=this.hA(L,!1);this.da.rtl&&
(L=G.a.pN(this.Dh.paneType,this.Dh.view.Ci),this.zB.x-=2*L.x);this.Apd(U);this.ele(J,U.x-(Y.x-B.x),U.y-(Y.y-B.y),-this.Dh.Nn.x,-this.Dh.Nn.y,!0)}Apd(L){if(this.TO){var J=t.c(this.TO);J=t.k(new Sys.UI.Point(L.x,L.y),[J[0],-J[1],-J[2],J[3]],this.Dh.rtl);L.x=J.x;L.y=J.y}}NNc(L){if(!this.tka(L))return!1;this.control.extension&&this.control.extension.VK&&this.control.extension.VK.p4b();return!0}ele(L,J,B,Y,U,O){const {FloatingObjectControlExtension:C}=a(983),X=t.d(this.wEa),S=t.h(this.wEa);var ea=!!this.Sb&&
M.a.BN(this.Sb);J=I.zKg(this.vf.topLeft.x,this.vf.width,ea?0:I.minWidth,J,X);B=I.zKg(this.vf.topLeft.y,this.vf.height,ea?0:I.minHeight,B,S);ea=I.yKg(this.vf.topLeft.x,this.vf.width,J,X);const Oa=I.yKg(this.vf.topLeft.y,this.vf.height,B,S);if((this.Znb||this.Qva)&&x.a(this.wEa)){const Ha=I.ratio(this.vf.width,this.vf.height);I.ratio(J.$m,B.$m)<Ha?I.nCf(Ha,ea,J,B.$m,X,!0):I.nCf(Ha,Oa,B,J.$m,S,!1)}I.R$e(this.vf.topLeft.x,I.minWidth,Y,J);I.R$e(this.vf.topLeft.y,I.minHeight,U,B);this.TO&&(Y=t.c(this.TO),
U=new k.a(J.position,B.position,J.$m,B.$m),Y=t.b(this.vf,U,this.wEa,Y,this.xK,this.yK,this.Dh.rtl),J.position=Y.x,B.position=Y.y);Y=new k.a(J.position,B.position,0,0);O&&(this.Dh=C.Bpd(Y,this.vf,this.Dh,this.control,!0));this.Xpe(new k.a(Y.x,Y.y,J.$m,B.$m),L);this.jo=this.Wg();this.xK=ea;this.yK=Oa;this.control.floatingObject&&this.control.Taa()?(this.W3(null),this.bzk(J.$m,B.$m,this.xK,this.yK)):this.control.floatingObject&&this.control.g_a()&&(this.W3(null),this.ezk(J.$m,B.$m,this.xK,this.yK));
this.raiseEvent("Resized",new l.a(J.$m,B.$m,this.xK,this.yK));this.M0a&&this.M0a(()=>({["floatingObjectType"]:M.a.tC(this.control.floatingObject),["Location"]:"canvas"}))}gca(){this.ktf();if(this.WHc)this.gtf();else{const {qnb:L,$sb:J,bwb:B,mdb:Y,flipX:U,flipY:O}=this.itf();this.raiseEvent(I.q4b,new u.a(L,B,J,Y,U,O,this.Dh));this.Sb&&this.Sb.IsShapeGC2ModelRendered&&this.control.extension.updateTransformResizeEnded(U,O)}this.htf()}Epd(){this.control.floatingObject&&(this.zIndex=this.control.p_a?d.a.Hac:
d.a.jOa+2*this.control.floatingObject.XE+1,this.Qva=this.control.floatingObject.Qva)}Fpe(L,J){this.Xhd=!0;this.jfc=!1;this.wEa=J;this.jbe=L;this.Znb=this.yK=this.xK=!1;this.ZP.Ea("keydown",this.m9d);L=this.control.floatingObject.type;this.control.ffa(!1,0!==L&&3!==L);this.control.clientVersion++;this.control&&this.control.extension&&(L=this.control.extension,c.ULS.sendTraceTag(537162309,5,50,`ImageResizableBehavior:StartResize: Image-Updated=${0<L.FLa||0<L.FJa||0<L.Lxa?"false":"true"} ResizeOperationsSinceLastLoad=${L.FLa} MoveOperationsSinceLastLoad=${L.FJa} RotateOperationsSinceLastLoad=${L.Lxa} ResizeType=${J}`))}i_i(L){for(;L&&
L!==this.control.domElement;){const J=f.a.XJd(L,744);if(J)return J;L=L.parentNode}c.ULS.shipAssertTag(537162308,5,!1,"ImageResizableBehavior.GetResizePointHandle: Can't find the resize point");return null}FXa(L,J,B){return(B?-1:1)*J/(L||1)}wNg(){t.m(this.control.cx,0,0,this.Ep)}ktf(){this.ZP.XH();this.Xhd=!1}itf(){(this.control.Taa()||this.control.g_a())&&this.Ep.push(new w.a(this.Sxa,this.Txa,this.translateX,this.translateY,this.TO));let L=this.vf,J=this.jo;this.Sb&&M.a.p8(this.TO,this.Sb.FlipX!==
this.Sb.FlipY)&&(L=this.vf.XNb(),J=this.jo.XNb());return{qnb:J.topLeft.x-L.topLeft.x,$sb:J.bottomRight.x-L.bottomRight.x,bwb:J.topLeft.y-L.topLeft.y,mdb:J.bottomRight.y-L.bottomRight.y,flipX:this.Vmc?this.yK:this.xK,flipY:this.Vmc?this.xK:this.yK}}gtf(){this.jfc=!1;this.raiseEvent("ResizeCancelled")}htf(){this.w6=this.zB=this.Afa=this.vf=null;this.yK=this.xK=!1;this.jbe=null;this.control&&this.control.extension&&(this.control.ffa(!0),this.control.extension.FLa++)}uNg(L,J,B,Y){const U=this.Dh.rtl,
O=new Sys.UI.Point(this.vf.x+this.z0b-(U?this.vf.width:0),this.vf.y+this.A0b);var C=t.c(this.TO);C=t.f(this.vf,this.TO,C,this.wEa,this.Dh.rtl);this.Sxa=this.FXa(this.vf.width,L,B);this.Txa=this.FXa(this.vf.height,J,Y);L=t.g(C,O,this.TO,this.Sxa,this.Txa);this.translateX=C.x-L.x;this.translateY=C.y-L.y;this.jo=this.Wg();this.translateX=U?this.translateX-(this.vf.bottomRight.x-this.jo.bottomRight.x):this.translateX+(this.vf.topLeft.x-this.jo.topLeft.x);this.translateY+=this.vf.topLeft.y-this.jo.topLeft.y}ezk(L,
J,B,Y){if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:4260575_ThickBorderResizingOrigin")){this.uNg(L,J,!1,!1);if(B)switch(this.wEa){case 7:case 6:case 5:this.translateX=this.Dh.rtl?this.translateX-L:this.translateX+L;break;case 1:case 2:case 3:this.translateX=this.Dh.rtl?this.translateX+L:this.translateX-L}if(Y)switch(this.wEa){case 7:case 0:case 1:this.translateY+=J;break;case 5:case 4:case 3:this.translateY-=J}this.Ep.push(new w.a(this.Sxa,this.Txa,this.translateX,this.translateY,0))}else this.Ep.push(new w.a(this.Sxa,
this.Txa,0,0,0));this.wNg();this.Ep.pop()}bzk(L,J,B,Y){this.control.Zd&&(this.uNg(L,J,B,Y),this.Sb&&this.Sb.IsShapeGC2ModelRendered?this.Vmc?this.control.extension.updateTransformDuringOperation(J,L,Y,B,null):this.control.extension.updateTransformDuringOperation(L,J,B,Y,null):(this.Ep.push(new w.a(this.Sxa,this.Txa,this.translateX,this.translateY,this.TO)),this.wNg(),this.Ep.pop()))}static j_i(L){return L?L.GLa:0}static Jtf(L,J){return(0>L?-1:1)*Math.max(Math.abs(L),J)}static ratio(L,J){return J?
L/J:1}static zKg(L,J,B,Y,U){const O=new e(L,J);switch(U){case 1:J-=Y;O.$m=I.Jtf(J,B);O.position=L+Y-(O.$m-J);break;case 3:O.$m=I.Jtf(J+Y,B)}return O}static yKg(L,J,B,Y){const U=0>B.$m;if(U)switch(B.$m*=-1,Y){case 3:B.position=L-B.$m;break;case 1:B.position=L+J}return U}static nCf(L,J,B,Y,U,O){const C=B.$m;B.$m=O?E.HelperMethods.DE(Y*L):E.HelperMethods.DE(Y/(L||1));if(!J&&1===U||J&&3===U)B.position-=B.$m-C}static R$e(L,J,B,Y){Y.position<B&&(Y.$m+=Y.position-B,Y.position=B,Y.$m<J&&(Y.position=L,Y.$m=
J))}}I.minWidth=5;I.minHeight=5;I.r4b="ResizeStarted";I.q4b="ResizeFinished";Object(y.a)(I,"ImageResizableBehavior",f.a,[763,109])},1067:function(y,r,a){a.d(r,"a",function(){return c});y=a(0);class c extends Sys.EventArgs{constructor(b,f,k,x,d,h,n,m=!1){super();this.Bed=b;this.gld=f;this.pid=k;this.Q7c=x;this.cld=d;this.dld=h;this.Ukh=n;this.Woh=m}get qnb(){return this.Bed}get bwb(){return this.gld}get $sb(){return this.pid}get mdb(){return this.Q7c}get txe(){return this.cld}get uxe(){return this.dld}get Ug(){return this.Ukh}get Gmj(){return this.Woh}}
Object(y.a)(c,"MoveAndResizeCompleteEventArgs",Sys.EventArgs,[])},1069:function(y,r,a){a.d(r,"a",function(){return c});y=a(0);class c{constructor(){this.excelHealth=this.actionHandler=this.logger=this.parent=this.id=null}}Object(y.a)(c,"ExcelHostConfig",null,[])},1094:function(y,r,a){a.r(r);a.d(r,"ChartFloatingObjectControl",function(){return tb});y=a(0);var c=a(15),b=a(1277),f=a(375),k=a(972),x=a(998),d=a(91),h=a(182),n=a(363),m=a(154);r=a(953);var u;(function(La){La.QueryBreadcrumbDocName="QueryBreadcrumbDocName";
La.QuerySessionId="QuerySessionId";La.QueryBuildVersion="QueryBuildVersion";La.QueryFormatPainter="QueryFormatPainter";La.QueryFontSize="QueryFontSize";La.QueryZoomValue="QueryZoomValue";La.QueryFontName="QueryFontName";La.QueryBold="QueryBold";La.QueryFormulaView="QueryFormulaView";La.QueryItalics="QueryItalics";La.QueryUnderline="QueryUnderline";La.QueryDoubleUnderline="QueryDoubleUnderline";La.QueryChartGalleryIcon="QueryChartGalleryIcon";La.QueryEditingView="QueryEditingView";La.QueryReadingView=
"QueryReadingView";La.QuerySelectedChartElement="QuerySelectedChartElement";La.QueryShowChanges="QueryShowChanges";La.QueryShowComments="QueryShowComments";La.QueryAlignmentWrap="QueryAlignmentWrap";La.QueryMergeCellsMenu="QueryMergeCellsMenu";La.QueryShowGridlines="QueryShowGridlines";La.QueryShowHeadings="QueryShowHeadings";La.QueryShowFormulaBar="QueryShowFormulaBar";La.QueryChangeSheetDirection="QueryChangeSheetDirection";La.QuerySimplifiedRibbonIsEnabled="QuerySimplifiedRibbonIsEnabled";La.QueryAlignment=
"QueryAlignment";La.QueryAlignmentLeft="QueryAlignmentLeft";La.QueryAlignmentCenter="QueryAlignmentCenter";La.QueryAlignmentRight="QueryAlignmentRight";La.QueryAlignmentTop="QueryAlignmentTop";La.QueryFreezePanes="QueryFreezePanes";La.QueryUnFreezePanes="QueryUnFreezePanes";La.QueryFreezeRows="QueryFreezeRows";La.QueryFreezeColumns="QueryFreezeColumns";La.QueryFreezePanesTopRow="QueryFreezePanesTopRow";La.QueryFreezePanesFirstColumn="QueryFreezePanesFirstColumn";La.QueryAlignmentMiddle="QueryAlignmentMiddle";
La.QueryAlignmentBottom="QueryAlignmentBottom";La.QueryCopyAndEditButton="QueryCopyAndEditButton";La.QueryNumberFormat="QueryNumberFormat";La.QueryAverageButton="QueryAverageButton";La.QueryCountButton="QueryCountButton";La.QueryNumericalCountButton="QueryNumericalCountButton";La.QueryMinimumButton="QueryMinimumButton";La.QueryMaximumButton="QueryMaximumButton";La.QuerySumButton="QuerySumButton";La.QueryStrikethrough="QueryStrikethrough";La.QueryToggleAutoFilter="QueryToggleAutoFilter";La.QueryIncreaseIndent=
"QueryIncreaseIndent";La.QueryDecreaseIndent="QueryDecreaseIndent";La.QueryShapeOutlineWeight="QueryShapeOutlineWeight";La.QueryShapeOutlineDashes="QueryShapeOutlineDashes";La.QueryShapeStyle="QueryShapeStyle";La.QueryConditionalFormattingGalleryIcon="QueryConditionalFormattingGalleryIcon";La.QueryDeleteCellsShiftLeft="QueryDeleteCellsShiftLeft";La.QueryInsertCellsShiftRight="QueryInsertCellsShiftRight";La.QueryInsertColumnsTable="QueryInsertColumnsTable";La.QueryInsertCopiedCutCells="QueryInsertCopiedCutCells";
La.QuerySetReadOnlyRecommended="QuerySetReadOnlyRecommended";La.QueryLinkedEntityGalleryButtons="QueryLinkedEntityGalleryButtons";La.QueryLinkedEntityMenuGalleryButtons="QueryLinkedEntityMenuGalleryButtons";La.QueryBorderColor="QueryBorderColor";La.QueryBorderStyle="QueryBorderStyle";La.QueryActiveNamedSheetViewName="QueryActiveNamedSheetViewName";La.QueryCalcMode="QueryCalcMode";La.QueryCalcModeMLR="QueryCalcModeMLR";La.QueryAdvancedPasteContextMenuGalleryIcon="QueryAdvancedPasteContextMenuGalleryIcon";
La.QueryTableStyleOption="QueryTableStyleOption";La.QuerySensitivity="QuerySensitivity";La.QueryBorderGalleryIcon="QueryBorderGalleryIcon";La.QueryCellStyles="QueryCellStyles";La.QueryTableStyle="QueryTableStyle";La.QueryEditInExcel="QueryEditInExcel";La.QueryTableName="QueryTableName";La.QueryPivotTableRowHeaders="QueryPivotTableRowHeaders";La.QueryPivotTableColumnHeaders="QueryPivotTableColumnHeaders";La.QueryPivotTableBandedRows="QueryPivotTableBandedRows";La.QueryPivotTableBandedColumns="QueryPivotTableBandedColumns";
La.QueryAutomateGalleryButtons="QueryAutomateGalleryButtons";La.QueryFieldListStatus="QueryFieldListStatus";La.QueryPivotTableDrillInState="QueryPivotTableDrillInState";La.QueryPivotTableSettingsStatus="QueryPivotTableSettingsStatus";La.QueryModeSwitcherViewMode="QueryModeSwitcherViewMode";La.QueryModeSwitcherEditMode="QueryModeSwitcherEditMode";La.QueryLinkedEntityGalleryIcon="QueryLinkedEntityGalleryIcon";La.QueryClearGallerySelection="QueryClearGallerySelection";La.QuerySlicerSettingsStatus="QuerySlicerSettingsStatus";
La.QueryLinkedEntityMenuGalleryButtonsRedesign="QueryLinkedEntityMenuGalleryButtonsRedesign";La.QueryToggleCatchUpFlyout="QueryToggleCatchUpFlyout";La.QueryInkDrawWithTouch="QueryInkDrawWithTouch";La.QueryInkTool="QueryInkTool";La.QueryInkThickness="QueryInkThickness";La.QueryInkRecentColors="QueryInkRecentColors";La.QueryInkSnapToText="QueryInkSnapToText";La.QueryPivotTableStyles="QueryPivotTableStyles";La.QuerySlicerStyles="QuerySlicerStyles";La.QueryTableFormatStyles="QueryTableFormatStyles";La.QueryRecentFillColor=
"QueryRecentFillColor";La.QueryRecentFontColor="QueryRecentFontColor";La.QueryRecentBorderColor="QueryRecentBorderColor";La.QueryRecentShapesFillColor="QueryRecentShapesFillColor";La.QueryRecentShapesOutlineColor="QueryRecentShapesOutlineColor";La.QueryRecentChartOutlineColor="QueryRecentChartOutlineColor";La.QueryNewEditNote="QueryNewEditNote";La.QueryShowAllNotes="QueryShowAllNotes";La.QueryPhonetics="QueryPhonetics";La.QueryPauseResumeProtection="QueryPauseResumeProtection";La.QueryPresentModeOverlayState=
"QueryPresentModeOverlayState";La.QueryOrientation="QueryOrientation";La.QueryRotateTextUp45="QueryRotateTextUp45";La.QueryRotateTextDown45="QueryRotateTextDown45";La.QueryRotateTextUp90="QueryRotateTextUp90";La.QueryRotateTextDown90="QueryRotateTextDown90";La.QueryVerticalText="QueryVerticalText";La.QueryAddInFlyout="QueryAddInFlyout";La.QueryUndoRedo="QueryUndoRedo";La.QueryUndo="QueryUndo";La.QueryRedo="QueryRedo";La.QueryInsertCells="QueryInsertCells";La.QueryDeleteCells="QueryDeleteCells";La.QueryFontPickerFont=
"QueryFontPickerFont";La.QueryInsertColumns="QueryInsertColumns";La.QueryFullScreen="QueryFullScreen";La.QueryZoomComboBoxValue="QueryZoomComboBoxValue";La.QueryPivotTableAutoRefresh="QueryPivotTableAutoRefresh";La.QueryCopilot="QueryCopilot";La.QueryPivotTableName="QueryPivotTableName";La.QueryFlowGalleryButtons="QueryFlowGalleryButtons";La.QueryPivotTableActiveField="QueryPivotTableActiveField";La.QueryRequestMoreAccess="QueryRequestMoreAccess";La.QueryFileMenuAutoFit="QueryFileMenuAutoFit"})(u||
(u={}));Object(y.b)("RibbonQueryCommand",u);var l=a(31),t=a(1034),e=a(227),w=a(74),z=a(70),E=a(1004),M=a(1274),G=a(429),A=a(213),N=a(61),K=a(29),I=a(43),L=a(124),J=a(2),B=a(179),Y=a(309),U=a(16),O=a(286),C=a(12),X=a(13),S=a(1115);class ea{constructor(La,wb){this.chartBannerLink=this.iX=this.KD=null;this.lTc=this.kTc=this.jTc=this.Dic=this.R8a=!1;this.p3j=[];this.tTj=[];this.d_b=()=>{this.oVg()&&(this.tte(),c.ULS.sendTraceTag(577525538,5,50,`ChartBanner.OnChartElementPointerDown. ID:${this.Yq.floatingObject.Ec}, FreezePanes:${this.Yq.da.rb.mj}, chart banner is shown.`));
return!1};this.l9d=Wa=>{this.A7i();for(const Fa of this.tTj)Fa(this,Wa);c.ULS.sendTraceTag(577525537,5,50,`ChartBanner.OnDismissChartBanner. ID:${this.Yq.floatingObject.Ec}, FreezePanes:${this.Yq.da.rb.mj}, chart banner is dismissed.`);return!0};this.W8d=()=>{C.HelperMethods.Rg(ea.Gdf,"_blank");c.ULS.sendTraceTag(577288206,5,50,`ChartBanner.OnChartBannerInvokeLink. ID:${this.Yq.floatingObject.Ec}, FreezePanes:${this.Yq.da.rb.mj}, chart banner link is invoked.`);return!0};if(!La)throw c.ULS.sendTraceTag(537162458,
5,10,"ChartBanner.ChartBanner: chartFloatingObjectControl is null."),Error.invalidOperation("chartFloatingObjectControl is null.");this.Yq=La;this.ha=wb}dispose(){this.fre()&&(this.stc(),this.lze(),this.k6g())}oVg(){return this.Yq.mda()&&this.Yq.floatingObject&&this.Yq.floatingObject.Zc&&this.Yq.floatingObject.Zc.ChartPlayerData?!!this.Yq.floatingObject.Zc.ChartPlayerData.ImageData&&!this.R8a&&this.Yq.NVb:!1}fre(){if(this.Yq.mda()){if(!this.Yq.floatingObject||!this.Yq.floatingObject.Zc||!this.Yq.floatingObject.Zc.ChartPlayerData)return!1;
if(this.Yq.floatingObject.Zc.ChartPlayerData.ImageData&&!this.R8a)return!0}return!1}H$h(){if(!this.KD){this.KD=document.createElement("div");this.KD.style.position="absolute";this.KD.style.top="0px";this.KD.style.width="100%";this.KD.style.visibility="hidden";this.KD.className=ea.Tud;this.Yq.Zd.style.overflow="hidden";this.Yq.Zd.appendChild(this.KD);this.chartBannerLink=this.iX=null;var La=Date.now();B.a.JMd().then(wb=>{wb.initializeMessageBarInStore();const Wa=Object(J.a)(new S.a,{message:X.a.instance.ia(985),
isMultiline:!0,messageBarType:5,closeable:!0,dismissButtonAriaLabel:X.a.instance.ia(986),onDismiss:()=>{},linkProps:{["type"]:"AppLinkProps",["text"]:X.a.instance.ia(987),["handler"]:{["href"]:ea.Gdf,["target"]:"_blank"}}});wb.createNewMessageBar(this.KD,Wa);window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.$df();var Fa=this.KD.querySelector('[aria-label="'+X.a.instance.ia(986)+'"]');Fa&&(this.iX=Fa,this.Unk());if(Fa=this.KD.getElementsByTagName("a")[0])this.chartBannerLink=Fa,this.Vnk();
Fa=Date.now()-La;c.ULS.sendTraceTag(577525568,5,50,`ChartBanner.CreateReactChartBanner: ID:${this.Yq.floatingObject.Ec}: chart banner is rendered in ${Fa}ms`)},0)});return null},wb=>{c.ULS.sendTraceTag(577525539,5,15,`ChartBanner.CreateReactChartBanner: ID:${this.Yq.floatingObject.Ec}: Failed to GetMessageBarAPIAsync: ${wb}`);return null})}}tte(){this.KD?(this.Yq.Zd.getElementsByClassName(ea.Tud).length||this.Yq.Zd.appendChild(this.KD),this.$df()):this.H$h();this.Dic=!0;this.stc();for(const La of this.p3j)La(this,
new Sys.EventArgs)}$df(){this.KD&&(this.KD.style.visibility="hidden",this.KD.style.display="block",0<this.Yq.Zd.offsetHeight&&.75>this.KD.offsetHeight/this.Yq.Zd.offsetHeight?this.KD.style.visibility="visible":this.Yq.Zd.removeChild(this.KD))}o1k(La){switch(La){case null:this.tte();this.ha.ob.EH=ea.ceb;break;case ea.ceb:this.ha.ob.EH=ea.beb;this.iX.style.border="1px solid";this.iX.style.borderColor=this.Yq.borderColor;break;case ea.beb:this.l9d(null);this.ha.ob.EH=null;break;case ea.chartBannerLink:this.W8d(null)}}q1k(La){switch(La){case ea.ceb:return this.ha.ob.EH=
null,!1;case ea.beb:this.iX.style.border="0px";this.ha.ob.EH=ea.ceb;break;case ea.chartBannerLink:this.chartBannerLink.style.border="0px",this.ha.ob.EH=ea.ceb}return!0}p1k(La){switch(La){case ea.beb:this.ha.ob.EH=ea.chartBannerLink;this.iX.style.border="0px";this.chartBannerLink.style.border="1px solid";this.chartBannerLink.style.borderColor=this.Yq.borderColor;break;case ea.chartBannerLink:this.ha.ob.EH=ea.beb,this.chartBannerLink.style.border="0px",this.iX.style.border="1px solid"}return!0}PLh(){this.jTc||
window.setTimeout(()=>{Y.a.instance.va(U.a.Sd,this.Yq.domElement,this.d_b);this.jTc=!0},0)}stc(){this.jTc&&(Y.a.instance.Ua(U.a.Sd,this.Yq.domElement,this.d_b),this.jTc=!1)}Unk(){this.kTc||(this.iX&&O.a.instance.va(U.a.click,this.iX,this.l9d),this.kTc=!0)}lze(){this.kTc&&(this.iX&&O.a.instance.Ua(U.a.click,this.iX,this.l9d),this.kTc=!1)}Vnk(){this.lTc||(this.chartBannerLink&&O.a.instance.va(U.a.click,this.chartBannerLink,this.W8d),this.lTc=!0)}k6g(){this.lTc&&(this.chartBannerLink&&O.a.instance.Ua(U.a.click,
this.chartBannerLink,this.W8d),this.lTc=!1)}A7i(){this.lze();this.k6g();0<this.Yq.Zd.getElementsByClassName(ea.Tud).length&&this.Yq.Zd.removeChild(this.KD);this.R8a=!0;this.chartBannerLink=this.iX=this.KD=null;this.ha.ob.EH=null}select(La){La?this.PLh():(this.stc(),this.ha.ob.EH=null,this.iX&&(this.iX.style.border="0px"),this.chartBannerLink&&(this.chartBannerLink.style.border="0px"))}getSelectionDescription(La){let wb=null;La===ea.ceb?wb=X.a.instance.ia(985):La===ea.beb?wb=X.a.instance.ia(986):La===
ea.chartBannerLink&&(wb=X.a.instance.ia(987));return wb}get Fdf(){return this.R8a}set Fdf(La){this.R8a!==La&&(this.R8a=La)}get Lse(){return this.Dic}set Lse(La){this.Dic!==La&&(this.Dic=La)}}ea.Tud="chart-banner";ea.ceb="chart-banner-root";ea.beb="chart-banner-closeButton";ea.chartBannerLink="chart-banner-link";ea.Gdf="https://support.microsoft.com/office/2063733d-f4ec-4869-8f02-1534ced82d78";Object(y.a)(ea,"ChartBanner",null,[]);var Oa=a(27),Ha=a(44);class Za{constructor(La,wb,Wa,Fa,Da){this.category=
La;this.data=wb;this.title=Wa;this.bubble=Fa;this.id=Da}}Object(y.a)(Za,"Series",null,[]);var fa=a(397);class la{constructor(){this.Wbg=[];this.Xbg=[];this.Ybg=[];this.jdg=[]}get series(){return this.jdg}get iIh(){return this.Wbg}get kIh(){return this.Xbg}get oIh(){return this.Ybg}n3e(La,wb,Wa,Fa,Da){this.series.push(new Za(La,wb,Wa,Fa,Da))}mla(){let La=[],wb=[],Wa=[];for(const Fa of this.jdg)La=La.concat(Fa.category),wb=wb.concat(Fa.title),Wa=Wa.concat(Fa.data),Wa=Wa.concat(Fa.bubble);this.Wbg=this.F5d(La);
this.Ybg=this.F5d(wb);this.Xbg=this.F5d(Wa)}F5d(La){La.sort((Fa,Da)=>Fa.range.left<Da.range.left?-1:Fa.range.left==Da.range.left?Fa.range.top<Da.range.top?-1:1:1);const wb=[];for(const Fa of La){var Wa=!1;for(La=0;La<wb.length;La++)if(this.amj(Fa,wb[La])){Wa=new fa.a(Ha.L([Fa.range,wb[La].range]),Fa.sheetId);wb[La]=Wa;Wa=!0;break}Wa||this.contains(Fa,wb)||wb.push(Fa)}return wb}contains(La,wb){for(const Wa of wb)if(La.range.right<=Wa.range.right&&La.range.left>=Wa.range.left&&La.range.top<=Wa.range.top&&
La.range.bottom>=Wa.range.bottom)return!0;return!1}amj(La,wb){if(La.sheetId===wb.sheetId)if(La.range.top===wb.range.top&&La.range.bottom===wb.range.bottom){if(La.range.right+1===wb.range.left||wb.range.right+1===La.range.left)return!0}else if(La.range.right===wb.range.right&&La.range.left===wb.range.left&&(La.range.bottom+1===wb.range.top||wb.range.bottom+1===La.range.top))return!0;return!1}}Object(y.a)(la,"Chart",null,[]);var ba=a(25);class aa{constructor(La){this.onPointerDown=wb=>{Z.c3c(wb.Yb);
return!0};this.Cq=ba.f(La)}update(La,wb,Wa){this.hide();this.gl=[null,null,null];this.gl[0]={XX:0,Fv:La,GK:[36],Gf:null};this.gl[1]={XX:1,Fv:wb,GK:[34],Gf:null};this.gl[2]={XX:2,Fv:Wa,GK:[35],Gf:null};this.show()}dispose(){this.hide();this.gl=null}show(){this.gl&&this.gl.forEach(La=>{var wb;0<(null===(wb=La.Fv)||void 0===wb?void 0:wb.length)&&(this.Cq.Ub.HL(La.Fv,La.GK,!0),La.Gf=this.Cq.Ub.sQ(La.GK[0],this.Cq.rb.Yh(La.Fv[0].range.topLeft)).Gf,Y.a.instance.va(U.a.Sd,La.Gf,this.onPointerDown))})}hide(){this.gl&&
this.gl.forEach(La=>{var wb;0<(null===(wb=La.Fv)||void 0===wb?void 0:wb.length)&&(Y.a.instance.Ua(U.a.Sd,La.Gf,this.onPointerDown),this.Cq.Ub.rl(La.GK),this.Cq.Ub.pn(null,La.GK))})}}Object(y.a)(aa,"ChartFoilsStaticBehavior",null,[]);var oa=a(7),Na=a(60),Ia=a(39),Sa=a(194);class Pa extends E.a{constructor(La,wb,Wa,Fa){super(La,512,null);this.region=this.seriesIndex=-1;this.sheetRange=null;this.seriesIndex=wb;this.region=Wa;this.sheetRange=Fa}}Object(y.a)(Pa,"MacroRecorderChartSeriesDataChangedPayload",
E.a,[]);var za=a(36),wa=a(1),db=a(28),Ba=a(266),Ka=a(45),da;(function(La){La[La.title=0]="title";La[La.category=1]="category";La[La.data=2]="data";La[La.bubblesize=3]="bubblesize";La[La.none=4]="none"})(da||(da={}));Object(y.b)("FoilRegion",da);class sa{}Object(y.a)(sa,"FoilInfo",null,[]);var mb;(function(La){La[La.none=0]="none";La[La.resize=1]="resize";La[La.move=2]="move"})(mb||(mb={}));Object(y.b)("Action",mb);var Ma;(function(La){La[La.topLeft=0]="topLeft";La[La.topRight=1]="topRight";La[La.bottomRight=
2]="bottomRight";La[La.bottomLeft=3]="bottomLeft";La[La.length=4]="length"})(Ma||(Ma={}));Object(y.b)("Corner",Ma);var hb;(function(La){La[La.none=0]="none";La[La.top=1]="top";La[La.bottom=2]="bottom";La[La.left=3]="left";La[La.right=4]="right";La[La.ambiguous=5]="ambiguous"})(hb||(hb={}));Object(y.b)("Direction",hb);class $a{constructor(){this.y=this.x=0}}Object(y.a)($a,"Coord",null,[]);class Va extends sa{}Object(y.a)(Va,"FoilInfoInteractive",sa,[]);class xa{}Object(y.a)(xa,"HandleSizeConfig",null,
[]);class ia{constructor(La,wb,Wa){this.j4d=!1;this.lYb=ia.kYb.Tte;this.Dcg=ia.kYb.n8d;this.l4d=ia.kYb.Ste;this.Ccg=ia.kYb.l8d;this.onPointerDown=Fa=>{var Da,ja,Qa,Ob;Z.c3c(Fa.Yb);this.xpd(Z.Yb);if(this.$Q!=mb.none)return!0;if(2===Fa.Yb&&Fa.Dq!=Sys.UI.MouseButton.leftButton)return!1;if(Ka.a(this.Cq.$).gXd||Ka.a(this.Cq.$).ks())return this.Ypc(),!0;Fa=this.zoomManager.Qf(Fa);this.sJa=this.yNd(Fa);if(!this.sJa)return!0;this.Mda=this.sJa.clone();var Ub=this.WMf(Fa?Fa.sc:null);Ub?(this.$Q=mb.resize,this.hB=
Ub.region,this.W0a=Ub.corner,this.x4d=Ub.s7i,Ub=this.VMf(this.W0a),this.bpe(Ub),this.Cq.$h.Jt(Ub)):(this.hB=this.mFf(this.sJa),this.$Q=mb.move,this.bpe(ia.u4d),this.Cq.$h.Jt(ia.u4d));if(4===this.hB)return!0;this.kcg=!0;3===Fa.Yb&&this.$0e(Fa);this.Zva=null===(Da=this.Yya)||void 0===Da?void 0:Da.clone();this.ela=null===(ja=this.kra)||void 0===ja?void 0:ja.clone();this.QY=null===(Qa=this.Zra)||void 0===Qa?void 0:Qa.clone();this.dYb=null===(Ob=this.hoc)||void 0===Ob?void 0:Ob.clone();return!0};this.sj=
()=>{try{if(this.$Q===mb.none)return!1;this.acl();this.Ypc()}catch(Fa){c.ULS.sendTraceTag(524895697,0,10,`ChartFoils onPointerUp error: Error: ${Fa.message}`)}return!0};this.Lm=Fa=>{Fa=this.zoomManager.Qf(Fa);if(this.$Q==mb.none)return this.$0e(Fa),!1;this.Mda=this.yNd(Fa);return this.$Q===mb.move?(this.Mda&&this.WMj(),!0):this.$Q===mb.resize?(this.jcg=Fa.clientPoint,this.Mda&&this.azk(),!0):!1};this.iYj=(Fa,Da)=>{0<this.qJa&&this.qJa--;c.ULS.sendTraceTag(524150548,6,50,`ChartFoils change request success: Errors: ${Fa&&
Fa.Errors&&0<Fa.Errors.length?za.a.pc(Fa.Errors):"none"}, Region: ${Da&&Da.region}, Action: ${Da&&Da.action}, Level: ${Da&&Da.level}`)};this.hYj=(Fa,Da)=>{0<this.qJa&&this.qJa--;c.ULS.sendTraceTag(524150547,6,50,`ChartFoils change request failure: Errors: ${Fa&&Fa.Errors&&0<Fa.Errors.length?za.a.pc(Fa.Errors):"none"}, Region: ${Da&&Da.region}, Action: ${Da&&Da.action}, Level: ${Da&&Da.level}`)};this.Cq=ba.f(La);this.H4d=Wa;this.lJa=wb;this.qJa=0;this.Qcg=Ia.a.ot||Ia.a.AY;this.xpd(Z.Yb)}get zoomManager(){return this.H4d.zoomManager}update(La,
wb,Wa,Fa,Da,ja,Qa=null){this.kcg||0<this.qJa||(this.hide(),this.q6g(),this.fYb=La,this.qYb=wb,this.jYb=Wa,this.Ypc(),this.gl=[null,null,null,null],this.gl[0]={XX:0,Fv:Fa,GK:[39],Gf:null,K7:null},this.gl[1]={XX:1,Fv:Da,GK:[37],Gf:null,K7:null},this.gl[2]={XX:2,Fv:ja,GK:[38],Gf:null,K7:null},this.hzi()&&this.OX()&&Qa&&0<Qa.length&&(this.gl[3]={XX:3,Fv:Qa,GK:[40],Gf:null,K7:null}),this.xpd(Z.Yb),this.show(),this.E5e(Z.Yb),this.vok())}OX(){return null!=this.qYb&&0<this.qYb.length}hzi(){var La=this.fYb;
return 36==La||37==La}getSheetName(La){if((La=this.gl[La])&&La.Fv&&0<La.Fv.length){La=La.Fv[0].sheetId;for(const wb of this.Cq.$.qa.items)if(La===(null===wb||void 0===wb?void 0:wb.sheetId))return wb.name}return null}Gib(La){return this.gl[La]&&this.gl[La].Fv&&0<this.gl[La].Fv.length?this.gl[La].Fv[0].range:null}get Yya(){return this.Gib(0)}get kra(){return this.Gib(1)}get Zra(){return this.Gib(2)}get hoc(){return this.Gib(3)}Ypc(){this.bpe(ia.u4d);this.Cq.$h.Jt(oa.a.I7);this.hB=4;this.W0a=Ma.length;
this.jcg=this.Mda=this.sJa=this.x4d=null;this.$Q=mb.none;this.kcg=!1;this.dYb=this.QY=this.ela=this.Zva=null}dispose(){this.q6g();this.VKg();this.hide();this.Ypc();this.qYb=this.fYb=this.lJa=this.gl=this.Cq=null;this.qJa=0;this.sLc=null}show(){this.gl&&this.gl.forEach(La=>{var wb;La&&0<(null===(wb=La.Fv)||void 0===wb?void 0:wb.length)&&(this.Cq.Ub.HL(La.Fv,La.GK,!0),La.Gf=this.Cq.Ub.sQ(La.GK[0],this.Cq.rb.Yh(La.Fv[0].range.topLeft)).Gf);La&&La.Gf&&this.iBh(La)})}hide(){this.gl&&this.gl.forEach(La=>
{var wb;La&&0<(null===(wb=La.Fv)||void 0===wb?void 0:wb.length)&&(this.Cq.Ub.rl(La.GK),this.Cq.Ub.pn(null,La.GK))})}vok(){if(!this.Qcg&&this.gl&&(this.gl.forEach(La=>{La&&La.Gf&&Y.a.instance.va(U.a.Sd,La.Gf,this.onPointerDown)}),this.Cq))for(const La of this.Cq.$p)Y.a.instance.va(U.a.At,La.domElement,this.Lm),Y.a.instance.va(U.a.Lj,La.domElement,this.sj),Sa.a.instance.va(U.a.Ai,La.domElement,this.Lm),Sa.a.instance.va(U.a.If,La.domElement,this.sj)}q6g(){if(!this.Qcg&&this.gl&&(this.gl.forEach(La=>
{La&&La.Gf&&Y.a.instance.Ua(U.a.Sd,La.Gf,this.onPointerDown)}),this.Cq))for(const La of this.Cq.$p)Y.a.instance.Ua(U.a.At,La.domElement,this.Lm),Y.a.instance.Ua(U.a.Lj,La.domElement,this.sj),Sa.a.instance.Ua(U.a.Ai,La.domElement,this.Lm),Sa.a.instance.Ua(U.a.If,La.domElement,this.sj)}$0e(La){this.VKg();let wb=!1,Wa;const Fa=this.WMf(La?La.sc:null);Wa=Fa?Fa.region:this.mFf(this.yNd(La));if(Fa){wb=!0;const Da=this.gl[Wa].K7[Fa.corner];Da.style.zIndex=ia.tIj;Da.style.width=this.l4d;Da.style.height=this.l4d;
4!=Wa&&3===La.Yb&&(Da.style.outlineWidth=ia.Zcg);this.epe(Da,Fa.corner,this.Ccg)}4!=Wa&&(wb=!0,La=this.gl[Wa].Gf,La.style.outlineWidth=ia.Zcg,La.style.zIndex=ia.CIj);this.j4d=wb}WMj(){let La=!1;2===this.hB?La=this.SMj():1===this.hB?La=this.QMj():0===this.hB?La=this.ZMj():3===this.hB&&(La=this.PMj());La&&(this.hide(),this.show())}azk(){let La=!1;2===this.hB?La=this.Xyk():1===this.hB?La=this.Wyk():0===this.hB?La=this.gzk():3===this.hB&&(La=this.Vyk());La&&(this.hide(),this.show())}h_i(La){switch(La){case 0:return Na.a.nyf;
case 1:return Na.a.myf;case 2:return Na.a.oyf;case 3:return Na.a.lyf;default:throw Error.argumentOutOfRange;}}epe(La,wb,Wa){if(this.Cq.rtl)switch(wb){case Ma.topLeft:La.style.top=Wa;La.style.right=Wa;break;case Ma.topRight:La.style.top=Wa;La.style.left=Wa;break;case Ma.bottomRight:La.style.bottom=Wa;La.style.left=Wa;break;case Ma.bottomLeft:La.style.bottom=Wa,La.style.right=Wa}else switch(wb){case Ma.topLeft:La.style.top=Wa;La.style.left=Wa;break;case Ma.topRight:La.style.top=Wa;La.style.right=Wa;
break;case Ma.bottomRight:La.style.bottom=Wa;La.style.right=Wa;break;case Ma.bottomLeft:La.style.bottom=Wa,La.style.left=Wa}}VMf(La){return this.Cq.rtl?La===Ma.topLeft||La===Ma.bottomRight?ia.Tcg:ia.Ucg:La===Ma.topLeft||La===Ma.bottomRight?ia.Ucg:ia.Tcg}iBh(La){this.gl[La.XX].K7=[null,null,null,null];if(La.Gf.children&&La.Gf.children.length==Ma.length)for(var wb=Ma.topLeft;wb<Ma.length;++wb)this.gl[La.XX].K7[wb]=La.Gf.children[wb];else{var Wa=this.h_i(La.XX);Wa&&(wb=Fa=>{const Da=document.createElement("div");
Da.className=Wa;this.epe(Da,Fa,"0px");Da.style.cursor=this.VMf(Fa);this.gl[La.XX].K7[Fa]=Da;La.Gf.appendChild(Da)},wb(Ma.topLeft),wb(Ma.topRight),wb(Ma.bottomRight),wb(Ma.bottomLeft))}}WMf(La){if(La){var wb=Wa=>{var Fa,Da=null===(Fa=this.gl[Wa])||void 0===Fa?void 0:Fa.K7;if(Da)for(Fa=Ma.topLeft;Fa<Ma.length;++Fa)if(La===Da[Fa])return Da=new $a,Fa===Ma.topLeft?(Da.y=this.gl[Wa].Fv[0].range.top-1,Da.x=this.gl[Wa].Fv[0].range.left-1):Fa===Ma.topRight?(Da.y=this.gl[Wa].Fv[0].range.top-1,Da.x=this.gl[Wa].Fv[0].range.right):
Fa===Ma.bottomLeft?(Da.y=this.gl[Wa].Fv[0].range.bottom,Da.x=this.gl[Wa].Fv[0].range.left-1):Fa===Ma.bottomRight&&(Da.y=this.gl[Wa].Fv[0].range.bottom,Da.x=this.gl[Wa].Fv[0].range.right),{region:Wa,corner:Fa,s7i:Da}};for(const Wa of[0,1,2,3]){const Fa=wb(Wa);if(Fa)return Fa}}}bpe(La){this.gl&&this.gl.forEach(wb=>{wb&&wb.Gf&&(wb.Gf.style.cursor=La)})}E5e(La){this.gl.forEach(wb=>{if(wb&&wb.K7)for(let Wa=Ma.topLeft;Wa<Ma.length;++Wa){const Fa=wb.K7[Wa];Fa&&(Fa.style.width=this.lYb,Fa.style.height=this.lYb,
this.epe(Fa,Wa,this.Dcg),2===La?(Fa.style.borderRadius=null,Fa.style.outlineColor=ia.Vcg,Fa.style.outlineWidth=ia.rIj,Fa.style.backgroundColor=ia.Bcg[wb.XX]):(Fa.style.borderRadius="50%",Fa.style.outlineColor=ia.Bcg[wb.XX],Fa.style.outlineWidth=ia.$cg,Fa.style.backgroundColor=ia.Vcg))}})}xpd(La){La=2===La?ia.kYb:ia.sIj;this.lYb=La.Tte;this.Dcg=La.n8d;this.l4d=La.Ste;this.Ccg=La.l8d}VKg(){this.j4d&&(this.j4d=!1,this.gl.forEach(La=>{La&&La.Gf&&(La.Gf.style.outlineWidth=ia.$cg,La.Gf.style.zIndex=ia.DIj[La.XX]);
if(La&&La.K7)for(const wb of La.K7)wb&&(wb.style.width=this.lYb,wb.style.height=this.lYb,wb.style.zIndex=ia.uIj[La.XX])}),this.E5e(Z.Yb))}mFf(La){var wb,Wa,Fa,Da;let ja=4;if(!La)return ja;if(null===(wb=this.Zra)||void 0===wb?0:wb.ld(La))ja=2;else if(null===(Wa=this.kra)||void 0===Wa?0:Wa.ld(La))ja=1;else if(null===(Fa=this.Yya)||void 0===Fa?0:Fa.ld(La))ja=0;else if(null===(Da=this.hoc)||void 0===Da?0:Da.ld(La))ja=3;return ja}yNd(La){return this.Cq.ha.Ft(La.clientPoint,La.sc,0)}tEe(La,wb){if(!La||
!wb)return hb.none;if(La.right<wb.left){if(La.top===wb.top&&La.bottom===wb.bottom)return hb.left}else if(La.left>wb.right){if(La.top===wb.top&&La.bottom===wb.bottom)return hb.right}else if(La.bottom<wb.top){if(La.left===wb.left&&La.right===wb.right)return hb.top}else if(La.top>wb.bottom&&La.left===wb.left&&La.right===wb.right)return hb.bottom;return hb.ambiguous}Q6b(La,wb,Wa){La.left+=wb;La.right+=wb;La.top+=Wa;La.bottom+=Wa}o6b(La,wb){La=this.Gib(La);if(!La||!wb||La.equals(wb))return!1;La.top=wb.top;
La.bottom=wb.bottom;La.left=wb.left;La.right=wb.right;return!0}V9(La,wb,Wa){Wa=this.o6b(2,Wa);Wa=this.o6b(1,wb)||Wa;return Wa=this.o6b(0,La)||Wa}Feb(La,wb,Wa){if(!Wa)return[La,null];const Fa=La.clone();let Da=Wa.clone();wb=this.tEe(Wa,wb);wb===hb.right?(Da.top=La.top,Da.bottom=La.bottom,La=La.right-Da.left+1,0<La&&(this.$Q===mb.move?this.Q6b(Fa,-La,0):this.$Q===mb.resize&&(Fa.right+=-La))):wb===hb.left?(Da.top=La.top,Da.bottom=La.bottom,La=La.left-Da.right-1,0>La&&(this.$Q===mb.move?this.Q6b(Fa,-La,
0):this.$Q===mb.resize&&(Fa.left+=-La))):wb===hb.top?(Da.left=La.left,Da.right=La.right,La=La.top-Da.bottom-1,0>La&&(this.$Q===mb.move?this.Q6b(Fa,0,-La):this.$Q===mb.resize&&(Fa.top+=-La))):wb===hb.bottom?(Da.left=La.left,Da.right=La.right,La=La.bottom-Da.top+1,0<La&&(this.$Q===mb.move?this.Q6b(Fa,0,-La):this.$Q===mb.resize&&(Fa.bottom+=-La))):Da=null;return[Fa,Da]}Cpd(La,wb,Wa,Fa){wb=this.tEe(Fa,wb);wb===hb.right?(Wa.top=La.top,Wa.bottom=La.bottom):wb===hb.left?(Wa.top=La.top,Wa.bottom=La.bottom):
wb===hb.top?(Wa.left=La.left,Wa.right=La.right):wb===hb.bottom&&(Wa.left=La.left,Wa.right=La.right)}K5e(La){let wb=null;[La,wb]=this.Feb(La,this.QY,this.ela);let Wa=null;[La,Wa]=this.Feb(La,this.QY,this.Zva);this.Cpd(La,this.QY,wb,this.ela);return[Wa,wb,La]}J5e(La){let wb=null;[La,wb]=this.Feb(La,this.ela,this.QY);let Wa=null;[wb,Wa]=this.Feb(wb,this.QY,this.Zva);this.Cpd(wb,this.QY,La,this.ela);return[Wa,La,wb]}L5e(La){let wb=null;[La,wb]=this.Feb(La,this.Zva,this.QY);let Wa=null;[wb,Wa]=this.Feb(wb,
this.QY,this.ela);this.Cpd(wb,this.QY,La,this.Zva);return[La,Wa,wb]}C1c(La,wb,Wa){if(!Wa)return null;const Fa=La.right-wb.right;La=La.bottom-wb.bottom;Wa=Wa.clone();this.Q6b(Wa,Math.max(-Wa.left+1,Fa),Math.max(-Wa.top+1,La));return 0>=Wa.top||0>=Wa.left?null:Wa}SMj(){const La=this.C1c(this.Mda,this.sJa,this.QY);if(!La)return!1;if(this.OX())return this.V9(this.Yya,this.kra,La);const [wb,Wa,Fa]=this.K5e(La);return this.V9(wb,Wa,Fa)}QMj(){const La=this.C1c(this.Mda,this.sJa,this.ela);if(!La)return!1;
if(this.OX())return this.V9(this.Yya,La,this.Zra);const [wb,Wa,Fa]=this.J5e(La);return this.V9(wb,Wa,Fa)}ZMj(){const La=this.C1c(this.Mda,this.sJa,this.Zva);if(!La)return!1;if(this.OX())return this.V9(La,this.kra,this.Zra);const [wb,Wa,Fa]=this.L5e(La);return this.V9(wb,Wa,Fa)}PMj(){if(!this.OX())return!1;const La=this.C1c(this.Mda,this.sJa,this.dYb);return La?this.o6b(3,La):!1}g_i(){const La=this.x4d.x,wb=this.x4d.y;let Wa=this.Mda.right,Fa=this.Mda.bottom;const Da=this.Cq.Uyc(this.jcg).returnValue;
var ja=this.Cq.Ob(this.Mda);Da&&ja&&(ja=this.Cq.getCellBounds(ja.cell,!1))&&(Wa>La?(Wa--,Da.x>ja.width/2&&Wa++):Da.x<ja.width/2&&Wa--,Fa>wb?(Fa--,Da.y>ja.height/2&&Fa++):Da.y<ja.height/2&&Fa--);return{deltaX:Wa-La,deltaY:Fa-wb}}Jxa(La){if(!La)return null;const {deltaX:wb,deltaY:Wa}=this.g_i(),Fa=La.clone();switch(this.W0a){case Ma.topLeft:Fa.left=Math.max(1,Fa.left+wb);Fa.left=Math.min(Fa.left,Fa.right);Fa.top=Math.max(1,Fa.top+Wa);Fa.top=Math.min(Fa.top,Fa.bottom);break;case Ma.topRight:Fa.right=
Math.max(1,Fa.right+wb);Fa.right=Math.max(Fa.left,Fa.right);Fa.top=Math.max(1,Fa.top+Wa);Fa.top=Math.min(Fa.top,Fa.bottom);break;case Ma.bottomLeft:Fa.left=Math.max(1,Fa.left+wb);Fa.left=Math.min(Fa.left,Fa.right);Fa.bottom=Math.max(1,Fa.bottom+Wa);Fa.bottom=Math.max(Fa.top,Fa.bottom);break;case Ma.bottomRight:Fa.right=Math.max(1,Fa.right+wb);Fa.right=Math.max(Fa.left,Fa.right);Fa.bottom=Math.max(1,Fa.bottom+Wa);Fa.bottom=Math.max(Fa.top,Fa.bottom);break;default:return null}0===this.hB?this.OX()?
1<Fa.height&&Fa.height>=Fa.width?this.W0a==Ma.topLeft||this.W0a==Ma.bottomLeft?(Fa.left=La.right,Fa.right=La.right):(Fa.left=La.left,Fa.right=La.left):1<Fa.width&&Fa.width>Fa.height&&(this.W0a==Ma.topLeft||this.W0a==Ma.topRight?(Fa.top=La.bottom,Fa.bottom=La.bottom):(Fa.top=La.top,Fa.bottom=La.top)):this.jYb?(Fa.top=La.top,Fa.bottom=La.bottom):(Fa.left=La.left,Fa.right=La.right):2!==this.hB&&3!==this.hB||!this.OX()||(this.jYb?(Fa.left=La.left,Fa.right=La.right):(Fa.top=La.top,Fa.bottom=La.bottom));
return Fa.Aw?Fa:null}Xyk(){const La=this.Jxa(this.QY);if(!La)return!1;if(this.OX())return this.V9(this.Yya,this.kra,La);const [wb,Wa,Fa]=this.K5e(La);return this.V9(wb,Wa,Fa)}Vyk(){if(!this.OX())return!1;const La=this.Jxa(this.dYb);return La?this.o6b(3,La):!1}Wyk(){const La=this.Jxa(this.ela);if(!La)return!1;if(this.OX())return this.V9(this.Yya,La,this.Zra);const [wb,Wa,Fa]=this.J5e(La);return this.V9(wb,Wa,Fa)}gzk(){const La=this.Jxa(this.Zva);if(!La)return!1;if(this.OX())return this.V9(La,this.kra,
this.Zra);const [wb,Wa,Fa]=this.L5e(La);return this.V9(wb,Wa,Fa)}acl(){let La=!1;this.Yya&&this.Zva&&!this.Yya.equals(this.Zva)&&(La=!0);!La&&this.kra&&this.ela&&!this.kra.equals(this.ela)&&(La=!0);!La&&this.Zra&&this.QY&&!this.Zra.equals(this.QY)&&(La=!0);!La&&this.hoc&&this.dYb&&!this.hoc.equals(this.dYb)&&(La=!0);La&&this.rDk()}Pzc(La){if(!La)return null;const wb={};wb[ia.Bch]=[{[ia.Ech]:La.top},{[ia.Cch]:La.right},{[ia.ych]:La.bottom},{[ia.Ach]:La.left}];return wb}lQh(){const La={};let wb=4,Wa=
null,Fa=null,Da=null;if(this.OX()){La[ia.Dch]=this.qYb;var ja=(Qa,Ob)=>{const Ub=this.Gib(Qa);La[Ob]=this.Pzc(Ub);wb=Qa;Wa=this.getSheetName(Qa);Fa=Ub.topLeft.clone();Fa.top--;Fa.left--;Da=Ub.bottomRight.clone();Da.bottom--;Da.right--};0===this.hB?ja(this.hB,ia.BDe):1===this.hB?ja(this.hB,ia.zDe):2===this.hB?ja(this.hB,ia.ADe):3===this.hB&&ja(this.hB,ia.zch)}else{if(ja=this.Pzc(this.Yya))La[ia.BDe]=ja,Wa||(Wa=this.getSheetName(0));if(ja=this.Pzc(this.kra))La[ia.zDe]=ja,Wa||(Wa=this.getSheetName(1));
if(ja=this.Pzc(this.Zra))La[ia.ADe]=ja,Wa||(Wa=this.getSheetName(2))}return[JSON.stringify(La),wb,Wa,Fa,Da]}MQh(La,wb,Wa,Fa){if(this.OX()){var Da=this.qYb.split("_");if(1<Da.length&&(Da=Da[Da.length-1],db.a.MG(Da,"Series")&&(Da=parseInt(Da.substring(6),10),!isNaN(Da)&&0<=Da)))return new Pa(this.lJa,Da,La,{sheet:wb,range:{topLeft:{row:Wa.top,column:Wa.left},bottomRight:{row:Fa.bottom,column:Fa.right}}})}return null}rDk(){const [La,wb,Wa,Fa,Da]=this.lQh();if(La){var ja={region:this.hB,action:this.$Q,
level:this.OX()?1:0},Qa=this.Cq.$.ma.sa.mc(),Ob=null;wa.EwaSettings.isChangeGateEnabled("OfficeVSO:7179826_ChartSeriesDataChangedMacroRecording")&&this.Cq.$.bva&&(Ob=()=>this.MQh(wb,Wa,Fa,Da));this.Cq.$.userOperationManager.enqueueOperation(new A.a(529,0,(Ub,Zb,uc)=>{const Hc=this.Cq.$.ma.sa.$a(9,Qa);Hc.imageId=this.lJa;Hc.operationType=-99;Hc.propertyValue=La;return N.h(this.Cq.$.ma.sa,"ApplyChartProperty",Hc,Ba.c(Ub,this.iYj),Ba.b(Zb,this.hYj),uc,ja,0)},64,Ob),null);this.sLc&&(clearTimeout(this.sLc),
this.sLc=null);this.qJa++;this.sLc=setTimeout(()=>{this.qJa=0},3E3)}}}ia.u4d="move";ia.Ucg="nwse-resize";ia.Tcg="nesw-resize";ia.$cg="2px";ia.Zcg="3px";ia.rIj="1px";ia.Vcg="rgba(255, 255, 255, 1)";ia.kYb={Tte:"4px",n8d:"-3px",Ste:"8px",l8d:"-5px"};ia.sIj={Tte:"14px",n8d:"-8px",Ste:"24px",l8d:"-13px"};ia.Bcg=["rgba(188, 47, 52)","rgba(124, 83, 172)","rgba(0, 108, 190)","rgba(252, 88, 190)"];ia.DIj=["6","5","4","3"];ia.uIj=["10","9","8","7"];ia.CIj="7";ia.tIj="11";ia.Dch="se";ia.zDe="ca";ia.ADe="da";
ia.BDe="ti";ia.zch="bl";ia.Bch="ra";ia.Ech="t";ia.Cch="r";ia.ych="b";ia.Ach="l";Object(y.a)(ia,"ChartFoilsInteractiveBehavior",null,[]);class Z{static c3c(La){La&&(Z.oYb="string"===typeof La?db.a.contains(La,"Touch",!0)?3:2:3===La?3:2)}static get Yb(){return Z.oYb}constructor(La,wb){this.Wva=this.Yva=null;null==Z.oYb&&(Z.c3c(z.a.Hb),null==Z.oYb&&(Z.oYb=2));this.qcg=La;this.H4d=wb;this.reset()}update(La,wb,Wa,Fa){if(wb&&La&&Wa){if(this.lJa!==La||this.zcg!==Wa||this.lcg!==Fa)this.reset(),this.lJa!==
La&&this.iCd(),this.K$j(Wa)?(this.lJa=La,this.Zcl(Fa),this.zcg=Wa,this.lcg=Fa):(this.reset(),this.iCd())}else this.reset(),this.iCd()}reset(){this.lcg=this.zcg=this.Vva=null;this.h4d=!1;this.fYb=-1;this.jYb=this.scg=!1}iCd(){this.lJa=null;this.Yva&&(this.Yva.dispose(),this.Yva=null);this.Wva&&(this.Wva.dispose(),this.Wva=null)}Zcl(La){if(this.Vva){var wb=null;if(!this.h4d&&La){var Wa=[];var Fa=[];var Da=[];var ja=[];for(const Qa of this.Vva.series)if(Qa.id===La){Wa=Qa.category;Fa=Qa.data;Da=Qa.title;
ja=Qa.bubble;wb=Qa.id;break}}else this.Vva.mla(),Wa=this.Vva.iIh,Fa=this.Vva.kIh,Da=this.Vva.oIh;(La=this.scg||null!=wb)?(this.Yva&&(this.Yva.dispose(),this.Yva=null),null==this.Wva&&(this.Wva=new ia(this.qcg,this.lJa,this.H4d)),this.Wva.update(this.fYb,wb,this.jYb,Da,Wa,Fa,ja)):(this.Wva&&(this.Wva.dispose(),this.Wva=null),null==this.Yva&&(this.Yva=new aa(this.qcg)),this.Yva.update(Da,Wa,Fa));c.ULS.sendTraceTag(524150550,6,50,`ChartFoils update: type: ${La?1:0}`)}}K$j(La){if(!La||0>=La.length)return!1;
try{var wb=JSON.parse(La);this.Vva=new la;this.scg=wb[Z.Kch];var Wa=wb[Z.Jch];this.jYb=wb[Z.Rch];this.fYb=wb[Z.Hch];if(Wa===Z.Lch){this.h4d=!0;var Fa=wb[Z.EDe],Da=new Oa.Range(Fa[Z.HDe]+1,Fa[Z.DDe]+1,Fa[Z.CDe]+1,Fa[Z.FDe]+1,!0,!0),ja=wb[Z.GDe],Qa=[];Qa.push(new fa.a(Da.clone(),ja));this.Vva.n3e([],Qa,[],[],"")}else if(Wa===Z.Och){this.h4d=!1;Qa=wb[Z.Nch];const Ob=wb[Z.Mch];for(Da=0;Da<Ob.length;Da++){ja=[];La=[];wb=[];Wa=[];const Ub=Ob[Da],Zb=Ub[Z.Qch]||"";for(const uc in Ub){const Hc=Ub[uc],Dd=Hc[Z.EDe]||
[],jc=Qa[Hc[Z.GDe]];for(Fa=0;Fa<Dd.length;Fa++){const $c=Dd[Fa],ud=new Oa.Range($c[Z.HDe]+1,$c[Z.DDe]+1,$c[Z.CDe]+1,$c[Z.FDe]+1,!0,!0);switch(uc){case Z.Ich:La.push(new fa.a(ud.clone(),jc));break;case Z.Fch:Wa.push(new fa.a(ud.clone(),jc));break;case Z.Gch:ja.push(new fa.a(ud.clone(),jc));break;case Z.Pch:wb.push(new fa.a(ud.clone(),jc))}}}this.Vva.n3e(ja,La,wb,Wa,Zb)}}return!0}catch(Ob){return c.ULS.sendTraceTag(524150549,6,10,`ChartFoils parsing: error: ${Ob.message}`),!1}}}Z.oYb=null;Z.Jch="dt";
Z.Lch="pt";Z.Och="st";Z.Rch="vt";Z.Kch="dn";Z.HDe="t";Z.FDe="r";Z.CDe="b";Z.DDe="l";Z.Gch="ca";Z.Ich="da";Z.Pch="ti";Z.Fch="bl";Z.Mch="se";Z.Nch="sh";Z.GDe="si";Z.EDe="ra";Z.Qch="uo";Z.Hch="ct";Object(y.a)(Z,"ChartFoils",null,[]);var ta=a(1131),pa=a(947),Ga=a(57),Ca=a(53),kb=a(197),eb=a(172),Yb=a(83),Gb=a(17),Mb=a(42),Rb=a(119),$b=a(99),cc=a(454),fb=a(1467),Sb=a(1276);da=a(1069);class kc extends da.a{constructor(){super();this.onTextSelectionChanged=this.onEditStatusChanged=null}}Object(y.a)(kc,"ExcelChartHostConfig",
da.a,[]);class na extends E.a{constructor(La,wb){super(La,510,null);this.seriesIndex=-1;this.seriesIndex=wb}}Object(y.a)(na,"MacroRecorderChartSeriesDeletedPayload",E.a,[]);var fc=a(65),Cc=a(5),tc=a(989),nb;(function(La){La[La.Selection=0]="Selection";La[La.SnowballChart=1]="SnowballChart"})(nb||(nb={}));Object(y.b)("ChartTaskPaneMessageType",nb);class tb extends r.a{constructor(La,wb,Wa,Fa,Da="",ja=!0){super(La,wb,l.a.vFa,Wa,Da,ja);this.Fp=this.FH=null;this.qEf=this.R7f=this.Q7f=this.o8f=this.t8f=
this.z8f=-1;this.lBa=this.SYd=this.NSf=!1;this.b1d=-1;this.Bfg=this.dx=null;this.zLc=new Mb.a(!1);this.YJ=this.Rka=this.XUc=null;this.$Ga=this.LPd=!1;this.Zn=null;this.IPd=this.KPd=this.IUb=!1;this.CAd=null;this.FJj="ManualPlacement";this.JPd=!1;this.vIc=this.$ta=this.inputType=null;this.oSf=!1;this.onEditStatusChanged=()=>{$b.a(this.$).hkg()};this.onTextSelectionChanged=()=>{$b.a(this.$).hkg()};this.L9d=Qa=>{Qa&&!za.a.zf(Qa.Errors)&&(Qa=Qa.Result)&&this.floatingObject.Zc&&(this.floatingObject.Zc.ChartTitle=
Qa.PreviousTitle?Qa.PreviousTitle:"")};this.K9d=()=>{c.ULS.sendTraceTag(537162434,6,10,`ChartFloatingObjectControl.OnGetChartTitleWebMethodFailed: The attempt to get chart title data has failed or been aborted. ID: ${this.floatingObject.Ec}`)};if(0!==wb.type)throw c.ULS.sendTraceTag(537162457,5,10,"ChartFloatingObjectControl.ChartFloatingObjectControl: Not a FloatingObjectType.Chart."),Error.invalidOperation("Creating ChartFloatingObjectControl for non FloatingObjectType.Chart");this.Zxd=this.$.Vb.Pg("DOMUpdate",
"ChartConvertToSvgStopwatch");this.vze=this.$.Vb.Pg("Task","ChartUnsupportedFontsStopwatch");this.mda()&&(this.YJ=new ea(this,this.ha));this.CAd=new Z(this.$,Fa)}get NVb(){return this.lBa}dispose(){this.Fjb()?(this.$Ga=this.mda()&&!!this.YJ&&this.YJ.Lse,this.YJ&&this.YJ.fre()&&(this.YJ.stc(),this.YJ.lze())):c.ULS.sendTraceTag(571758413,5,50,`ChartFloatingObjectControl.Dispose. ID:${this.floatingObject.Ec}, GotSelected: ${this.LPd}, GotInteracted: ${this.$Ga}`);Rb.a.Cag(this.floatingObject.Ec,!0,!this.Fjb(),
this.LPd,this.$Ga);this.Kdb();super.dispose()}g_a(){return!0}isElementMovementInProgress(){return this.FH.isElementMovementInProgress()}restoreElementPosition(){return this.FH.restoreElementPosition()}cJ(La,wb=!1){tb.Vif(this.floatingObject,La);super.cJ(La,wb);this.q7g()}Gna(){c.ULS.sendTraceTag(537162456,5,50,`ChartFloatingObjectControl.UpdateFloatingObject Updating ID: ${this.floatingObject.Ec}.`);this.sGg();this.yVg&&this.qjf();this.uLe=!this.floatingObject.Eka&&this.ynj();this.jFa&&c.ULS.sendTraceTag(537162455,
5,50,`ChartFloatingObjectControl.UpdateFloatingObjectContent: Empty scene graph. Id: ${this.floatingObject.Ec}, ChartMetaData: ${this.floatingObject.Zc?"valid":"null"}`);if(this.gk||this.jFa)this.gk=!1,this.floatingObject.Hsb(),this.clientVersion=this.floatingObject.version,c.ULS.sendTraceTag(537162454,5,50,`ChartFloatingObjectControl.UpdateFloatingObject: Workbook cache Placeholder detected. Returning. ID: ${this.floatingObject.Ec}, Type: ${this.floatingObject.type}`);this.Zd&&(this.lya(this.floatingObject.XE),
wa.EwaSettings.isChangeGateEnabled("OfficeVSO:4398210_MoveAndResizeCompleteSvgChartFlickerfix")&&!this.floatingObject.Eka||Gb.DOMElementExtensions.Mtb(this.Zd,new Sys.UI.Bounds(0,0,this.floatingObject.width,this.floatingObject.height),!1));this.NZd()&&this.lBa&&this.vIc&&(this.oSf?this.isChartDataUnhealthy()||(this.vIc=!1,this.Zhg(nb.SnowballChart)):(this.XAj(),this.oSf=!0));this.$hk()}$hk(){if(this.hra()&&!this.SYd){this.SYd=!0;var La=this.$.Vb.Pg("Task","ChartRenderDelayStopwatch");La.start();I.TaskExtensions.tb($b.a(this.$).aDj(),
()=>{this.SYd=!1;La.stop();this.hra()&&(this.o8f=La.Kc,this.render())},this.$.ra.Aa,8)}}eWf(){$b.a(this.$).maj()?(chartPlayer.ChartPlayerFactoryGlobal.enableFeatures(this.cMi()),this.FH=chartPlayer.ChartPlayerFactoryGlobal.getChartPlayerWrapper(this.Zd,this),this.Fp||(this.Fp=chartPlayer.ChartPlayerFactoryGlobal.getUOMirrorWrapper())):c.ULS.sendTraceTag(537162453,6,10,"ChartFloatingObjectControl.InitChartPlayerWrapper: The attempt to create a ChartPlayerWrapper failed")}resetVisualTrackerForChart(){const La=
this.$.ma.sa,wb=this.floatingObject.Ec;c.ULS.sendTraceTag(537162435,5,50,`ChartFloatingObjectControl.resetVisualTrackerForChart. ID:${wb}`);G.a(this.$.userOperationManager,(Wa,Fa,Da)=>ta.c(La,wb,Wa,Fa,Da,null),Wa=>new A.a(605,0,Wa,void 0),null)}Mbk(){this.eWf();let La=!1;if(this.FH){this.Hqj()&&(this.vze.start(),this.xni(),this.vze.stop(),this.Q7f=this.vze.Kc);this.Zxd.start();let wb=null;this.mda()&&this.floatingObject.Zc.ChartPlayerData.InteractivityJSON&&(wb='{ "data" : '+this.floatingObject.Zc.ChartPlayerData.InteractivityJSON+
" }");La=this.FH.renderChart('{ "data" : '+this.floatingObject.Zc.ChartPlayerData.SceneGraphJSON+" }",wb);this.Fp&&(this.dx=this.floatingObject.Zc.VisualID,this.Bfg=this.floatingObject.Zc.ChartPlayerData.VisualTrackerJSON,2===this.Fp.updateModel(this.Bfg)&&this.resetVisualTrackerForChart());wb&&(this.FH.setInteractivityEnabled(!0),this.FH.select(this.lBa?this.ha.ob.Qj:null,null));this.Zxd.stop();this.z8f=this.Zxd.Kc;this.t8f=this.floatingObject.Zc.ChartPlayerData.SceneGraphJSON.length}La?(this.b1d=
this.floatingObject.version,this.g3(null)):(this.v7h(),this.Cla(null))}hra(){return this.Xd?!1:!this.gk&&!this.jFa&&!this.floatingObject.Eka&&(!!this.$j||!this.J8b())}render(){this.lqk();this.CAa=this.Sai();if(this.Fjb()&&this.floatingObject.Zc.ChartPlayerData.SceneGraphJSON)c.ULS.shipAssertTag(537162452,6,!1,`ChartFloatingObjectControl.Render: ChartPlayerData cannot contain both ImageData and ScenegraphJson at the same time. ID: ${this.floatingObject.Ec}`);else if(this.Fjb()){this.eWf();let La=!1;
this.FH&&(La=this.FH.renderImage(this.floatingObject.Zc.ChartPlayerData.ImageData),Gb.DOMElementExtensions.Mtb(this.Zd,new Sys.UI.Bounds(0,0,this.floatingObject.width,this.floatingObject.height),!1));La?(this.b1d=this.floatingObject.version,this.g3(null)):this.Cla(null);this.mda()&&this.vCc()&&this.YJ.tte()}else this.Mbk(),this.lya(this.floatingObject.XE),this.u9a=this.floatingObject.mu,this.mu&&-1!==this.mu.EffectsHeight?(this.Zd.style.overflow="visible",Gb.DOMElementExtensions.Mtb(this.Zd,new Sys.UI.Bounds(-this.mu.XEffectsDelta,
-this.mu.YEffectsDelta,this.mu.EffectsWidth,this.mu.EffectsHeight),!1)):Gb.DOMElementExtensions.Mtb(this.Zd,new Sys.UI.Bounds(0,0,this.floatingObject.width,this.floatingObject.height),!1),this.tdk()}Sai(){let La;La=document.createElement("div");La.className=this.NH;La.style.borderColor=this.borderColor;La.style.direction="ltr";this.domElement.appendChild(La);La.style.visibility="hidden";return La}lqk(){this.Zd&&(Gb.DOMElementExtensions.isVisible(this.Zd)?(this.LI=this.Zd,this.qpb=this.cZ,this.cZ=
null):this.VVc(),this.Zn=null)}dXg(La){const wb=!tb.ZMc||!tb.Uoc;tb.ZMc||(tb.ZMc=document.createElement("div"));null===tb.Uoc&&(tb.Uoc=X.a.instance.ia(2571));(La||wb)&&appChrome.renderObserverChartAwarenessCallout(tb.ZMc,this.Zd,tb.Uoc)}tdk(){var La;Rb.a.trk(this.Zd);var wb=this.Zd.firstChild;wb.style.width="100%";wb.style.height="100%";wb.setAttribute("draggable","false");tc.a()&&this.tooltip&&(wb=null===(La=this.tooltip)||void 0===La?void 0:La.cXa(this.Ug.paneType))&&this.Zd.appendChild(wb);La=
db.a.uu(this.floatingObject.altTextDescription)?X.a.instance.ia(1455):String.format(X.a.instance.Ib(182),this.floatingObject.altTextDescription);this.Zd.title=La;this.Rmk();Rb.a.isObserverChart(this.floatingObject)&&(this.highlightObserverChart(),this.dXg(!1))}p$d(){Rb.a.isObserverChart(this.floatingObject)&&this.dXg(!0)}highlightObserverChart(){const La=new Yb.a(1200018948,0,2,30,null);this.$.Ia.Gb(La,{[Rb.a.Idf]:this.floatingObject.id,[Rb.a.$Mc]:this.floatingObject&&this.floatingObject.Zc?this.floatingObject.Zc.ObserverChartSrcFileName:
null,[Rb.a.aNc]:this.floatingObject&&this.floatingObject.Zc?this.floatingObject.Zc.ObserverChartSrcFileUrl:null})}v7h(){var La=this.Zd.firstChild;La&&Gb.DOMElementExtensions.vh(La);La=document.createElement("img");let wb,Wa;db.a.uu(this.floatingObject.altTextDescription)?(wb=X.a.instance.ia(1455),Wa=X.a.instance.ia(1456)):(wb=String.format(X.a.instance.Ib(182),this.floatingObject.altTextDescription),Wa=String.format(X.a.instance.Ib(183),this.floatingObject.altTextDescription));La.title=wb;La.alt=
Wa;La.className=tb.cXh;La.style.width="100%";La.style.height="100%";La.style.border="0px";La.style.display="block";this.Zd.appendChild(La);c.ULS.sendTraceTag(537162451,6,10,`ChartFloatingObjectControl.CreateErrorMessage: The attempt to render the chart failed. Version: ${this.floatingObject.version}, ID: ${this.floatingObject.Ec}`)}R_d(){return!0}YFc(La,wb){return!wb.Eka&&wb.version>this.b1d?!0:super.YFc(La,wb)}FJd(){let La=super.FJd();La||(La={});La.SvgConversionDuration=this.z8f;La.SceneGraphSize=
this.t8f;La.LastRenderDelay=this.o8f;La.LastFontDetectTime=this.Q7f;La.LastGC2LoadDelay=this.R7f;La.GC2ModelLoadTime=this.qEf;const wb=!!this.Zd;La.HasElement=wb;!this.NSf&&wb&&(La.ElementCount=this.Zd.getElementsByTagName("*").length,this.NSf=!0);this.floatingObject&&this.floatingObject.Zc&&this.floatingObject.Zc.ChartPlayerData&&(La.HasImageData=this.Fjb());return La}Zhg(La){const wb=Cc.DdaFacadeService.Oa()?fc.a.Cb(Cc.DdaFacadeService):e.a(this.$);if(wb){var Wa={};if(La===nb.Selection){if(La=this.ha.ob,
tb.d8f!==La.activeFloatingObjectControlId||tb.e8f!==La.Qj)Wa.EventId="select",Wa.SubSelection=La.Qj,Wa.selectionStartTimeMs=Date.now(),c.ULS.sendTraceTag(537162450,6,50,`ChartFloatingObjectControl.NotifyTaskPane: Sending messsage to ChartTaskPane FloatingObjectID: ${this.floatingObject.Ec}, SubSelection:${Wa.SubSelection}`),wb.H7d(Wa),tb.d8f=La.activeFloatingObjectControlId,tb.e8f=La.Qj,this.$Ga=!0}else this.NZd()&&La===nb.SnowballChart&&(Wa.EventId="snowballChart",Wa.isSnowballChartFixed=!this.vIc,
wb.H7d(Wa),c.ULS.sendTraceTag(507389259,6,50,`ChartFloatingObjectControl.NotifyTaskPane: Sending messsage to ChartTaskPane FloatingObjectID: ${this.floatingObject.Ec}, isSnowballChartFixed:${Wa.isSnowballChartFixed}`))}}XAj(){var La=Cc.DdaFacadeService.Oa()?fc.a.Cb(Cc.DdaFacadeService):e.a(this.$);if(La&&La.zZf()){La.yZf()||La.aRg();const wb={EventId:"snowballChart",isSnowballChartDetected:!0};c.ULS.sendTraceTag(507389258,6,50,`ChartFloatingObjectControl.launchChartDataPaneOnSnowBallChartDetection: Sending messsage to ChartTaskPane FloatingObjectID: ${this.floatingObject.Ec}, isSnowballChartDetected:${wb.isSnowballChartDetected}}`);
La.H7d(wb)}else La=new Yb.a(1930653487,0,2,30,"SnowballView"),this.$.Ia.Gb(La),c.ULS.sendTraceTag(507314312,6,50,`ChartFloatingObjectControl.launchChartDataPaneOnSnowBallChartDetection: launched chart task pane for FloatingObjectID: ${this.floatingObject.Ec}}}`)}u$i(La,wb,Wa,Fa){Fa=new Yb.a(37023044,Fa,this.$.xc,0,null);Fa.jUb=!0;this.$.Ia.Gb(Fa,{["rawEvent"]:null,["pivotName"]:null,["cell"]:La,["requiresConfirmation"]:64==(this.floatingObject.Zc.Attributes&64),["dataSourceIndex"]:this.floatingObject.Zc.ExternalSourceIndex,
["domElement"]:this.Zd,["objectId"]:wb.ChartId,["objectVersion"]:this.floatingObject.version,["location"]:Wa,["optionalPivotMenuAnchorParameter"]:wb});c.ULS.sendTraceTag(509366740,5,50,`ChartFloatingObjectControl.HandleShowPivotContextMenu. ID:${this.floatingObject.Ec}`)}KRf(La,wb){if(!db.a.contains(La,"ValueFieldButton",!0)&&this.Fp){if(wa.EwaSettings.isChangeGateEnabled("OfficeVSO:8966521_fixPivotButtonCrash")){var Wa=this.Fp.getEnumProp(this.dx,La+"_ButtonState");if(null===Wa||db.a.contains(Wa,
"Disabled",!0)||db.a.contains(Wa,"Label",!0))return}var Fa=this.Fp.getIntProp(this.dx,La+"_PivotHierarchy");Wa=this.Fp.getStringProp(this.dx,La+"_Caption");if(null===Fa||void 0===Fa||null===Wa||void 0===Wa)c.ULS.sendTraceTag(528815107,5,10,`ChartFloatingObjectControl.HandlePivotButtonCommand: Unable to get button props. ID:${this.floatingObject.Ec}, button ID: ${La}`);else{var Da={};Da.ChartId=this.ha.ob.activeFloatingObjectControlId;Da.AnchorValue1=Fa;Da.AnchorValue2=-1;if(db.a.contains(La,"ReportFilterFieldButton",
!0))Da.AnchorType=4,La=0!=(this.floatingObject.Zc.Attributes&128),ba.f(this.$).showPivotFilter(this.$.domElement,{},this.floatingObject.Zc.ExternalSourceIndex,Wa,La,!0,null,Da);else{if(db.a.contains(La,"AxisFieldButton",!0))Da.AnchorType=5;else if(db.a.contains(La,"LegendFieldButton",!0))Da.AnchorType=6;else{c.ULS.sendTraceTag(528815106,5,10,`ChartFloatingObjectControl.HandlePivotButtonCommand: Unexpected Button ID. ID:${this.floatingObject.Ec}, button ID: ${La}`);return}Wa=JSON.parse(this.FH.getSelectionBounds());
if(null!=Wa)var ja=new Sys.UI.Point(Wa.x+(this.$.isChromeRtl?Wa.width:0),Wa.y+Wa.height);else c.ULS.sendTraceTag(528815105,5,10,`ChartFloatingObjectControl.HandlePivotButtonCommand: Error getting button location. ID:${this.floatingObject.Ec}, button ID: ${La}`),La=C.HelperMethods.isStandardZoomCssSupportedByBrowser?Gb.DOMElementExtensions.getBounds({element:this.Zd,di:!0}):Sys.UI.DomElement.getBounds(this.Zd),ja=new Sys.UI.Point(La.x,La.y);var Qa={};this.$.Zk(Qa);var Ob=Zb=>{Zb&&this.u$i(Qa,Da,ja,
wb?3:2)},Ub=64==(this.floatingObject.Zc.Attributes&64);void fc.a.resolve(Cc.DataRefreshManagerService,{xa:1}).then(Zb=>{Zb.KH(Ub,Ob)})}}}}onSelectionChange(La,wb){Z.c3c(wb);if(this.mda()){this.inputType=wb;var Wa=this.ha.ob.Qj?this.ha.ob.Qj:"Null",Fa=La||"Null";"Null"!=Wa&&Wa!=Fa&&(c.ULS.sendTraceTag(528773846,5,50,`ChartFloatingObjectControl.OnSelectionChange. ID:${this.floatingObject.Ec}, FreezePanes:${ba.f(this.$).rb.mj}, elementId:${Wa}, gotRibbonEdited:${this.KPd}, gotFloatieEdited:${this.IPd}`),
this.IPd=this.KPd=!1);if(this.lBa||La){if(!this.lBa){var Da=$b.a(this.$),ja=this.floatingObject.Fh();Da&&ja&&((Da=Da.fr(ja))?this.ha.ob.KZ(Da):c.ULS.sendTraceTag(509751577,5,50,"ChartFloatingObjectControl.OnSelectionChange : Selected Floating Object Control is null, cannot select new chart"))}Da=wb||"None";ja=!1;null!==this.floatingObject.Zc&&(ja=0!==(this.floatingObject.Zc.Attributes&4));var Qa=!1,Ob=wa.EwaSettings.isChangeGateEnabled("OfficeVSO:6412352_isUOPropPathValid");Ob&&this.Fp&&(Qa=this.Fp.isUOPropPathValid(this.dx,
Wa,this.FJj));c.ULS.sendTraceTag(588330568,5,50,`ChartFloatingObjectControl.OnSelectionChange. ID:${this.floatingObject.Ec}, FreezePanes:${ba.f(this.$).rb.mj}, CurrentSubSelection:${Wa}, NextSubSelection:${Fa}, SelectionType:${Da}, ManuallyPlaceable:${Ob?Qa:"None"}, gotManualPlaced:${this.JPd}, IsPivot:${ja}`);this.JPd=!1;this.ha.ob.Qj=La;this.Zhg(nb.Selection);Wa=null!=La;this.Suj()&&(Wa=null!=La&&null!=wb);Wa&&db.a.contains(La,"FieldButton",!0)&&(this.iWd()&&db.a.contains(wb,"Keyboard",!0)||this.KRf(La,
db.a.contains(Da,"Touch",!0)));(wb=$b.a(this.$))?wb.aYj():c.ULS.sendTraceTag(509751576,5,50,"ChartFloatingObjectControl.OnSelectionChange : FloatingObjectManager is null, cannot refresh Ribbon UI");this.extension&&(wb=this.extension,wb.ev&&(wb.ev.eMb=null==La));this.inputType&&(this.inputType=null);db.a.contains(Da,"Touch",!0)?this.OBd(!0):db.a.contains(Da,"Mouse",!0)&&this.OBd(!1)}}}q7g(){this.CAd&&this.CAd.update(this.floatingObject.id,this.lBa,this.floatingObject.Zc.ChartDataRanges,this.ha.ob.Qj)}e3i(La){let wb=
0;if(({ZJ:wb}=this.JGf(La,wb)).returnValue)switch(wb){case 2:return 419803868;case 9:return-2011789595;case 10:return-1513952223}return 1461300262}bSf(La,wb){var Wa=!1;const Fa=this.e3i(La);1461300262!==Fa&&(Wa=new Yb.a(Fa,wb,2,30,null),this.$.Ia.Gb(Wa),Wa=!0);c.ULS.sendTraceTag(537162449,5,50,`ChartFloatingObjectControl.HandleTitleEditRibbonCommand. ID:${this.floatingObject.Ec}, CurrentSubSelection:${La||"Null"}, EntryPoint:${Enum.toString(f.a,wb)}, EditTitleCommandHandled:${Wa}`);this.$Ga=!0;return Wa}onDoubleClick(La){if(this.mda()&&
wa.EwaSettings.Ra(155)){var wb;(wb=Cc.DdaFacadeService.Oa()?fc.a.Cb(Cc.DdaFacadeService):e.a(this.$))&&wb.zZf()?this.bSf(La,2)?wb="OpenTitleDialog":wb.yZf()?wb="NoOp":(wb.aRg(),wb="FocusOnTaskpane"):(wb=new Yb.a(1221897806,0,2,30,null),this.$.Ia.Gb(wb),wb="OpenTaskPane");c.ULS.sendTraceTag(578069908,5,50,`ChartFloatingObjectControl.OnDoubleClick. ID:${this.floatingObject.Ec}, CurrentSubSelection:${La||"Null"}, ActionTaken:${wb}`);this.$Ga=!0}}onManualPlacement(La,wb,Wa,Fa){if(wb||Wa){this.zLc.Bb(this.floatingObject.Ec)?
c.ULS.sendTraceTag(528295050,5,15,`ChartFloatingObjectControl.OnManualPlacement : making another request before processing the older one, InputType:${Fa}, Element:${La}`):this.zLc.add(this.floatingObject.Ec,!0);var Da=null,ja=this.Fp.getDoubleProp(this.dx,La+"_Left")+wb,Qa=this.Fp.getDoubleProp(this.dx,La+"_Top")+Wa;Da=this.Izf(La+"_ManualPlacement",'"'+wb+";"+Wa+'"',tb.XLk,()=>new M.a(this.floatingObject.Ec,La+"_ManualPlacement",ja+";"+Qa));Da.continueWith(()=>{let Ob=!1;kb.b(Da)&&(Ob=this.JPd=!0);
c.ULS.sendTraceTag(537162448,5,50,`ChartFloatingObjectControl.OnManualPlacement. ID:${this.floatingObject.Ec}, DraggedElement: ${La}, isSuccessful: ${Ob}
        )}, inputType: ${Fa}`)})}}DOk(){if(null==this.Zn){const La=new kc;La.id=this.floatingObject.id;La.parent=this.Zd;La.actionHandler=fb.a.Bgb(this.$);La.logger=new Sb.a;La.onEditStatusChanged=this.onEditStatusChanged;La.onTextSelectionChanged=this.onTextSelectionChanged;this.Zn=GC2Host.excelChartHostFactoryGlobal.createHost(La)}}onEmbeddedContentLoad(La){if(this.z1f()&&La){var wb=this.$.Vb.Pg("Task","ChartGC2LoadStopwatch"),Wa=this.$.Vb.Pg("Task","ChartGC2TextModelStopwatch");wb.start();Wa.start();
I.TaskExtensions.tb(cc.a.Zka(this.floatingObject.type),Fa=>{wb.stop();this.hra()&&null!=this.Zd&&(null!=this.Zn&&(this.Zn=null),this.R7f=wb.Kc,this.DOk(),this.Zn.updateModel(La));Wa.stop();this.qEf=Wa.Kc;c.ULS.sendTraceTag(527976224,5,50,`ChartFloatingObjectControl.OnEmbeddedContentLoad. ID:${this.floatingObject.Ec}, IsSuccessful: ${kb.b(Fa)}`)},this.$.ra.Aa,8)}else c.ULS.sendTraceTag(527976225,0,50,"ChartFloatingObjectControl.onEmbeddedContentLoad: Embedded content is null or empty.")}select(La,
wb){super.select(La,wb);if(this.mda()){!this.lBa&&La&&(this.LPd=!0);(this.lBa=La)||this.OBd(!1);var Wa=wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5891773_SelectionInputType")?this.inputType:null;tb.gtb(this.FH,Fa=>{Fa.select(La?this.ha.ob.Qj:null,Wa)});this.inputType=null;this.YJ.fre()&&this.YJ.select(La);this.q7g();this.NZd()&&La&&this.isChartDataUnhealthy()&&(this.vIc=!0)}}Q_c(La){if(this.vCc()&&this.YJ.p1k(this.ha.ob.EH))c.ULS.sendTraceTag(537162447,5,50,`ChartFloatingObjectControl.SubSelectNextSibling. ID:${this.floatingObject.Ec}, FreezePanes:${ba.f(this.$).rb.mj}, chart banner CurrentSubSelection is ${this.ha.ob.EH}.`);
else{var wb=this.ha.ob.Qj?this.ha.ob.Qj:"Chart";c.ULS.sendTraceTag(588330567,5,50,`ChartFloatingObjectControl.SubSelectNextSibling. ID:${this.floatingObject.Ec}, FreezePanes:${ba.f(this.$).rb.mj}, CurrentSubSelection:${wb}`);tb.gtb(this.FH,Wa=>{Wa.navigateNextSibling(La)})}}P_c(La,wb){this.bSf(wb,1)||(this.O_c(La),this.iWd()&&wb&&La&&db.a.contains(wb,"FieldButton",!0)&&this.KRf(wb,!1));c.ULS.sendTraceTag(573137555,5,50,`ChartFloatingObjectControl.SubSelectFirstChildOrCommitEdit. ID:${this.floatingObject.Ec}, FreezePanes:${ba.f(this.$).rb.mj}, CurrentSubSelection:${wb||
"Chart"}`)}O_c(La){La&&this.YJ.oVg()?(this.YJ.o1k(this.ha.ob.EH),c.ULS.sendTraceTag(537162446,5,50,`ChartFloatingObjectControl.SubSelectFirstChild. ID:${this.floatingObject.Ec}, FreezePanes:${ba.f(this.$).rb.mj}, chart banner CurrentSubSelection is ${this.ha.ob.EH}.`)):(La=this.ha.ob.Qj?this.ha.ob.Qj:"Chart",c.ULS.sendTraceTag(537162445,5,50,`ChartFloatingObjectControl.SubSelectFirstChild. ID:${this.floatingObject.Ec}, FreezePanes:${ba.f(this.$).rb.mj}, CurrentSubSelection:${La}`),tb.gtb(this.FH,
wb=>{wb.selectFirstChild()}))}R_c(){if(this.vCc()){var La=this.YJ.q1k(this.ha.ob.EH);c.ULS.sendTraceTag(537162444,5,50,`ChartFloatingObjectControl.SubSelectParent. ID:${this.floatingObject.Ec}: chart banner CurrentSubSelection is ${this.ha.ob.EH}.`);La||tb.gtb(this.FH,wb=>{wb.selectParent()})}else La=this.ha.ob.Qj?this.ha.ob.Qj:"Chart",c.ULS.sendTraceTag(588330565,5,50,`ChartFloatingObjectControl.SubSelectParent. ID:${this.floatingObject.Ec}, FreezePanes:${ba.f(this.$).rb.mj}, CurrentSubSelection:${La}`),
tb.gtb(this.FH,wb=>{wb.selectParent()})}moveElementByKey(La){const wb=this.ha.ob.Qj?this.ha.ob.Qj:"Chart";let Wa="";switch(La){case -798660877:Wa="ArrowDown";break;case -1470715894:Wa=this.da.rtl?"ArrowRight":"ArrowLeft";break;case -1231471547:Wa=this.da.rtl?"ArrowLeft":"ArrowRight";break;case 137938150:Wa="ArrowUp";break;default:c.ULS.sendTraceTag(537162443,5,50,`ChartFloatingObjectControl.MoveElementByKey: invalid command ${La} passed in.`)}tb.gtb(this.FH,Fa=>{Fa.moveElementByKey(Wa)});c.ULS.sendTraceTag(537162442,
5,50,`ChartFloatingObjectControl.MoveElementByKey. ID:${this.floatingObject.Ec}, FreezePanes:${ba.f(this.$).rb.mj}, CurrentSubSelection:${wb}, MoveDirection:${Wa}, isRTL:${this.da.rtl}`)}Gb(La,wb){if(this.Fp){var Wa=La.command,Fa=this.SOf(La.Re);La=null;var Da=this.ha.ob.Qj?this.ha.ob.Qj:"Null";if(({Hwd:La}=this.R$j(Wa,wb,La)).returnValue)if(wb=this.Fp.handleUORibbonCommand(this.dx,this.ha.ob.Qj,this.UOf(Wa),La)){var ja=this.Izf(wb.propPath,wb.propVal,wb.propCommand);ja.continueWith(Qa=>{c.ULS.sendTraceTag(544089631,
5,50,`ChartFloatingObjectControl.HandleRibbonCommand. ID:${this.floatingObject.Ec}, RibbonCommand: ${Enum.toString(t.a,Wa)}, isSuccessful: ${kb.b(Qa)}, CurrentSubSelection: ${Da}, UILocation: ${Fa}`);kb.b(ja)&&(Fa===tb.vLg&&(this.KPd=!0),Fa===tb.uCf&&(this.IPd=!0))});this.$Ga=!0}else c.ULS.sendTraceTag(544089632,5,10,`ChartFloatingObjectControl.HandleRibbonCommand: Error while executing uoMirrorWrapper.HandleUORibbonCommand. ID:${this.floatingObject.Ec}, RibbonCommand: ${Enum.toString(t.a,Wa)}, CommandVal: ${La} , UILocation: ${Fa}`);
else c.ULS.sendTraceTag(544089633,5,10,`ChartFloatingObjectControl.HandleRibbonCommand: Error while executing ParseRibbonCmdPropertiesDictionary. ID:${this.floatingObject.Ec}, RibbonCommand: ${Enum.toString(t.a,Wa)}, CommandVal: ${La}, UILocation: ${Fa}`)}}pCc(La,wb){if(this.Fp){var Wa=this.L3i(La);if(20===Wa)c.ULS.sendTraceTag(537162441,5,50,`ChartFloatingObjectControl.HandleRibbonQueryCommand: Invalid UORibbonCmd. ID:${this.floatingObject.Ec}, RibbonCommand: ${Enum.toString(u,La)}`);else switch(La){case "QueryBold":case "QueryItalics":case "QueryUnderline":if(!this.ha.ob.Qj){wb[k.a.On]=
!1;break}La=this.Fp.getUORibbonCommandVal(this.dx,this.ha.ob.Qj,Wa);if(!La||!La.isValid)break;wb[k.a.On]=Boolean.parse(La.returnVal);break;case "QueryFontName":case "QueryFontPickerFont":case "QueryFontSize":if(this.ha.ob.Qj){if((Wa=this.Fp.getUORibbonCommandVal(this.dx,this.ha.ob.Qj,Wa))&&Wa.isValid)if(this.Hf()&&"QueryFontPickerFont"===La){La=Wa.returnVal;let Fa=Wa=!1;const Da=this.Fp.getUORibbonCommandVal(this.dx,this.ha.ob.Qj,1),ja=this.Fp.getUORibbonCommandVal(this.dx,this.ha.ob.Qj,2);Da&&Da.isValid&&
(Wa=Boolean.parse(Da.returnVal));ja&&ja.isValid&&(Fa=Boolean.parse(ja.returnVal));La=C.HelperMethods.hOd(La,Wa,Fa,0,!1);wb[b.a.SelectedFont]=La}else wb[x.a.Value]=Wa.returnVal}else wb[x.a.Value]=!1}}}vya(La){switch(La){case -219946702:return this.ha.ob.Qj?!1:!0;case -287251124:case -1925065947:case 1764140053:case -1077965542:case -1293291468:case 1970784898:case 862825906:case -803000997:case -1832800737:case -1744769642:case 87208751:case 409031041:case -822056969:case 1532790410:case 1597684571:case 1849330294:case -873142594:case 1855740761:case 2117491830:case 2107851680:case -1986737526:case 119706583:case -1741941813:case 1188510340:case -1828502776:case -984702347:return this.ha.ob.Qj&&
this.Fp?!this.Fp.isUORibbonCommandSupported(this.dx,this.ha.ob.Qj,this.UOf(La)):!0;default:return!0}}Izf(La,wb,Wa,Fa){Wa=this.kTa(La,wb,Wa);const Da=new h.a;c.ULS.sendTraceTag(537162438,5,50,`ChartFloatingObjectControl.ExecuteSetPropertyOfficeJSApi: Executing OfficeJS API. ID:${this.floatingObject.Ec}, PropPath: ${La}, PropVal: ${wb}`);return this.jca(null!==Fa&&void 0!==Fa?Fa:()=>new M.a(this.floatingObject.Ec,La,wb),ja=>{(ja=ja.Result)&&200===ja.ResponseStatusCode?Da.setResult(!0):(c.ULS.sendTraceTag(537162440,
5,10,`ChartFloatingObjectControl.ExecuteSetPropertyOfficeJSApi: Unexpected Status Code from the response of Executing OfficeJS API. ID:${this.floatingObject.Ec}, PropPath: ${La}, PropVal: ${wb}`),Da.setResult(!1));La.endsWith("_ManualPlacement")&&this.zLc.remove(this.floatingObject.Ec)},()=>{c.ULS.sendTraceTag(537162439,5,10,`ChartFloatingObjectControl.ExecuteSetPropertyOfficeJSApi: Error while Executing OfficeJS API. ID:${this.floatingObject.Ec}, PropPath: ${La}, PropVal: ${wb}`);Da.setResult(!1);
La.endsWith("_ManualPlacement")&&this.zLc.remove(this.floatingObject.Ec)},Wa,Da)}SOf(La){switch(La){case 9:return tb.uCf;case 2:case 14:case 15:case 16:return tb.vLg;case 19:return tb.c3h;case 6:return tb.lAj;default:return c.ULS.sendTraceTag(507510794,5,50,`ChartFloatingObjectControl.getUILocationString. Unsupported UI Location. ID:${this.floatingObject.Ec}, ElementId:${this.ha.ob.Qj?this.ha.ob.Qj:"Null"}, LocationEnum:${La}`),"Invalid"}}jca(La,wb,Wa,Fa,Da){const ja=this.$.userOperationManager,Qa=
this.$.ma;let Ob=null,Ub=null,Zb=null;const uc=()=>{if(ja.mUa())return!1;Ob&&ja.kn(Ob);Ub&&Qa.xG(Ub);Zb&&Qa.sV(Zb);ja.rK(new A.a(507,0,(Hc,Dd,jc)=>N.h(Qa.sa,"ExecuteRichApiRequest",Fa,Ba.c(Hc,wb),Ba.b(Dd,Wa),jc,null,0),64,La));return!0};uc()||(Ob=()=>{uc()},Ub=()=>{uc()},Zb=()=>{uc()},ja.Kp(Ob),Qa.ED(Ub),Qa.yP(Zb));return Da.task}kTa(La,wb,Wa){const Fa={HttpMethod:"POST",PathAndQuery:"ProcessQuery",RequestHeaders:null};Fa.RequestBody='{"AutoKeepReference":false,"Actions":[{"Id":390,"ActionType":3,"Name":"'+
Wa+'","ObjectPathId":15,"ArgumentInfo":{"Arguments":["'+La+'",'+wb+']}}],"ObjectPaths":{"1":{"Id":1,"ObjectPathType":1,"Name":""},"6":{"Id":6,"ObjectPathType":4,"Name":"Worksheets","ParentObjectPathId":1,"T":"WorksheetCollection"},"8":{"Id":8,"ObjectPathType":5,"Name":"","ParentObjectPathId":6,"ArgumentInfo":{"Arguments":["'+w.d(this.$.qa.la)+'"]},"T":"Worksheet"},"10":{"Id":10,"ObjectPathType":4,"Name":"Visuals","ParentObjectPathId":8,"T":"VisualCollection"},"15":{"Id":15,"ObjectPathType":5,"Name":"","ParentObjectPathId":10,"ArgumentInfo":{"Arguments":["'+
this.dx+'"]},"T":"Visual"}}}';Fa.RequestFlags=17;La=this.$.ma.sa.$a(1);La.request=Fa;return La}R$j(La,wb,Wa){switch(La){case -287251124:case -1925065947:case 1764140053:Wa=wb.On?"true":"false";break;case -1077965542:case -1293291468:if(wa.EwaSettings.isChangeGateEnabled("OfficeVSO:9018608_fixFontNameSizeBug")&&-1077965542===La){La=wb[x.a.IsFreeForm]?x.a.Value:z.a.Bf;Wa=La in wb&&wb[La]?parseFloat(wb[La].toString()).toString():"No font size command value provided";break}Wa=z.a.Bf;if(wa.EwaSettings.isChangeGateEnabled("OfficeVSO:9018608_fixFontNameSizeBug")?
Wa in wb&&wb[Wa]:Wa in wb){Wa=wb[Wa];wa.EwaSettings.isChangeGateEnabled("OfficeVSO:8791094_LogFontVariantUseForCharts")&&K.a.Hf()&&(wb=wb.Format)&&(wb.isBold||wb.isItalic)&&c.ULS.sendTraceTag(507360982,5,50,`ChartFloatingObjectControl.parseRibbonCmdPropertiesDictionary: L2 Variant Selected. ID:${this.floatingObject.Ec}, IsBold:${wb.isBold}, IsItalic:${wb.isItalic} `);break}return{returnValue:!1,Hwd:-1077965542===La?"No font size command value provided":"No font name command value provided"};case 409031041:case 1597684571:case 1650812936:case -1832800737:case 1970784898:Wa=
eb.a.WZ(eb.a.zK(wb.Color,Mb.a.rh(wb,"IntColor")));break;case -803000997:Wa=wb.Color;break;case 1849330294:case -873142594:case 1855740761:case 2117491830:case -1986737526:case 119706583:case -1741941813:Wa=null;!1;break;case 2107851680:Wa="true";!1;break;case 87208751:case -1744769642:Wa=wb.clearFillOutlineCmdVal;break;default:return{returnValue:!1,Hwd:Wa}}return{returnValue:!0,Hwd:Wa}}UOf(La){switch(La){case -287251124:return 1;case -1925065947:return 2;case 1764140053:return 3;case -1077965542:return 6;
case -1293291468:return 5;case -1832800737:case 1970784898:case 862825906:case -803000997:case -1828502776:return 4;case 1532790410:case 1597684571:case 1650812936:case 1188510340:return this.TOf();case -822056969:case 409031041:case -984702347:return 8;case -1744769642:return 10;case 87208751:return this.K3i();case 1849330294:return 12;case -873142594:return 14;case 1855740761:return 15;case 2117491830:return 13;case 2107851680:return 16;case -1986737526:return 17;case 119706583:return 18;case -1741941813:return 19;
default:return 20}}PSf(){return this.Fp?this.Fp.hasUOElementType(this.dx,this.ha.ob.Qj?this.ha.ob.Qj:"Chart",0):null}K3i(){const La=this.PSf();return null===La?20:La?11:9}TOf(){const La=this.PSf();return null===La?20:La?7:0}L3i(La){switch(La){case "QueryBold":return 1;case "QueryItalics":return 2;case "QueryUnderline":return 3;case "QueryFontSize":return 6;case "QueryFontName":return 5;case "QueryFontPickerFont":return this.Hf()?5:20;default:return 20}}JGf(La,wb){if(!La)return{returnValue:!1,ZJ:wb,
index:-1};const Wa=La.split("_"),Fa=Wa[Wa.length-1];if(db.a.contains(Fa,"ChartTitle",!0))return{returnValue:!0,ZJ:2,index:-1};if(db.a.contains(Fa,"Legend",!0))return{returnValue:!0,ZJ:3,index:-1};if(db.a.contains(Fa,"DataTable",!0))return{returnValue:!0,ZJ:11,index:-1};if(db.a.contains(Fa,"PrimaryValue",!0))return wb=11===this.floatingObject.Zc.ChartCategory?db.a.contains(Fa,"0",!0)?7:8:5===this.floatingObject.Zc.ChartCategory?7:8,{returnValue:!0,ZJ:wb,index:-1};if(db.a.contains(Fa,"PrimaryCategory",
!0))return wb=5===this.floatingObject.Zc.ChartCategory||19===this.floatingObject.Zc.ChartCategory?8:7,{returnValue:!0,ZJ:wb,index:-1};if(db.a.contains(Fa,"AxisTitle",!0)){if(2>Wa.length)return c.ULS.shipAssertTag(537162437,6,!1,`ChartFloatingObjectControl.GetChartElementFromElementUOPath: Invalid UO Path for AxisTitle. ID: ${this.floatingObject.Ec}, UOPath: ${La}`),{returnValue:!1,ZJ:wb,index:-1};La=Wa[Wa.length-2];return db.a.contains(La,"PrimaryValue",!0)?(wb=11===this.floatingObject.Zc.ChartCategory?
db.a.contains(La,"0",!0)?9:10:5===this.floatingObject.Zc.ChartCategory?9:10,{returnValue:!0,ZJ:wb,index:-1}):db.a.contains(La,"PrimaryCategory",!0)?(wb=5===this.floatingObject.Zc.ChartCategory||19===this.floatingObject.Zc.ChartCategory?10:9,{returnValue:!0,ZJ:wb,index:-1}):{returnValue:!1,ZJ:wb,index:-1}}if(db.a.contains(Fa,"Gridlines",!0)){if(3>Wa.length)return c.ULS.shipAssertTag(537162436,6,!1,`ChartFloatingObjectControl.GetChartElementFromElementUOPath: Invalid UO Path for Gridlines. ID: ${this.floatingObject.Ec}, UOPath: ${La}`),
{returnValue:!1,ZJ:wb,index:-1};La=Wa[Wa.length-3];return db.a.contains(La,"PrimaryValue",!0)?(wb=11===this.floatingObject.Zc.ChartCategory?db.a.contains(La,"0",!0)?13:12:5===this.floatingObject.Zc.ChartCategory?13:12,{returnValue:!0,ZJ:wb,index:-1}):db.a.contains(La,"PrimaryCategory",!0)?(wb=5===this.floatingObject.Zc.ChartCategory||19===this.floatingObject.Zc.ChartCategory?12:13,{returnValue:!0,ZJ:wb,index:-1}):{returnValue:!1,ZJ:wb,index:-1}}return db.a.MG(Fa,"Series")?(wb=parseInt(Fa.substring(6),
10),isNaN(wb)?{returnValue:!1,ZJ:4,index:-1}:{returnValue:!0,ZJ:4,index:wb}):{returnValue:!1,ZJ:4,index:-1}}LQh(La){var wb=0;let Wa;if(!({ZJ:wb,index:Wa}=this.JGf(La,wb)).returnValue)return null;La=this.floatingObject.Ec;if(wa.EwaSettings.isChangeGateEnabled("OfficeVSO:7160650_ChartSeriesDeleteMacroRecording")&&4===wb)return 0>Wa?null:new na(La,Wa);switch(wb){case 2:wb=0;break;case 3:wb=100;break;case 11:wb=500;break;case 7:wb=348;break;case 8:wb=352;break;case 9:wb=300;break;case 10:wb=306;break;
case 13:wb=328;break;case 12:wb=332;break;default:return null}return new E.a(La,wb,"")}ntc(La,wb){const Wa=this.$.ma.sa;c.ULS.sendTraceTag(509634253,5,50,`ChartFloatingObjectControl.DeleteSubSelection. ID:${this.floatingObject.Ec}, CurrentSubSelection:${La},
        EntryPoint:${this.SOf(wb)}`);const Fa=()=>this.LQh(La);G.a(this.$.userOperationManager,(Da,ja,Qa)=>ta.b(Wa,this.floatingObject.Ec,La,Da,ja,Qa,null),Da=>new A.a(594,0,Da,void 0,Fa),null);this.$Ga=!0}FQb(La){if(!this.dx||!this.Fp)return null;const wb=[],Wa=this.ha.ob.Qj;3===La&&this.Fp.supportsDeletion(this.dx,Wa)&&wb.push(tb.$Wh);wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9FloatieEnabled",!1)&&wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)?(this.z2e(Wa,La,wb),this.y2e(Wa,wb)):(this.y2e(Wa,wb),this.z2e(Wa,La,wb));return wb}z2e(La,wb,Wa){this.Fp.isUORibbonCommandSupported(this.dx,La,5)&&(3===wb?Wa.push(tb.fXh):2===wb&&Wa.push(tb.hXh))}y2e(La,wb){if(this.Fp.isUORibbonCommandSupported(this.dx,La,8)){const Wa=this.Fp.hasUOElementType(this.dx,La,0)?7:0;this.Fp.isUORibbonCommandSupported(this.dx,La,Wa)?wb.push(tb.dXh):wb.push(tb.gXh)}}yQb(La){if(!this.dx||!this.Fp)return null;let wb=20;switch(La){case 1597684571:wb=this.TOf();break;case 409031041:wb=
8;break;case -1832800737:case 1970784898:wb=4;break;default:c.ULS.sendTraceTag(507852897,5,50,`ChartFloatingObjectControl.getRibbonCommandVal: Command ${La} not supported.`)}return 20!==wb?(La=this.Fp.getUORibbonCommandVal(this.dx,this.ha.ob.Qj,wb))&&La.isValid?La.returnVal:null:null}getSelectionDescription(){if(!this.mda()||!this.FH)return null;if(this.vCc()){var La=this.YJ.getSelectionDescription(this.ha.ob.EH);if(La)return La}return(La=this.FH.getSelectionDescription())?La:null}getContextMenuButtonList(){return this.dx&&
this.Fp?this.Fp.getContextMenuButtonList(this.dx,this.ha.ob.Qj):null}u5b(){return this.Fp.supportsDeletion(this.dx,this.ha.ob.Qj)}OWc(){return this.Fp.supportsTaskPane(this.dx,this.ha.ob.Qj?this.ha.ob.Qj:"Chart")}Kdb(){this.Rka&&(L.a.dy(this.Rka.sx),this.Rka=null);this.XUc&&(d.a.vb(this.XUc),this.XUc=null)}Rmk(){this.Kdb();this.XUc=Ga.a.instance.create(()=>{this.Rka=N.u(this.$.ma.sa,this.floatingObject.id,1,this.L9d,this.K9d,null,null,this.$.ma.sa.mc())},0,Ca.a.eXh,!0,!0)}xni(){if(void 0===this.floatingObject.Zc.ChartPlayerData.Fonts||
null===this.floatingObject.Zc.ChartPlayerData.Fonts)c.ULS.sendTraceTag(537162433,6,10,`ChartFloatingObjectControl.EnsureFonts: Invalid Font List. Version: ${this.floatingObject.version}, ID: ${this.floatingObject.Ec}`);else for(const La of this.floatingObject.Zc.ChartPlayerData.Fonts)this.FH.ensureFont(La)}mda(){return!!this.$&&wa.EwaSettings.Ra(407)}z1f(){return wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSInPlaceTextEditing",!1)}Ppj(){return!wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5903230_EscapeKeyManualPlacementFix")}iWd(){return wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5526587_EnterKeyPivotButtonMenu")}Suj(){return wa.EwaSettings.isChangeGateEnabled("OfficeVSO:6102446_PreventFloatingPivotMenu")}Hf(){return K.a.Hf()}Wyj(){return wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSWebTooltipTextFormat",
!1)}NZd(){return wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSSnowballChartImprovement",!1)}vCc(){return this.mda()&&!!this.YJ&&this.YJ.Lse&&!this.YJ.Fdf}cMi(){const La=[];this.z1f()&&La.push("EnableInPlaceTextEditing");this.Ppj()&&La.push("EnableEscKeyboardEvents");this.iWd()&&La.push("EnableEnterKeyPivotButtonMenu");this.Wyj()&&La.push("EnableWebTooltipTextFormat");return La}Hqj(){return wa.EwaSettings.isChangeGateEnabled("OfficeVSO:3868811_IsFontLoadingEnabled")}ynj(){return!this.floatingObject.Zc||
!this.floatingObject.Zc.ChartPlayerData||!this.floatingObject.Zc.ChartPlayerData.SceneGraphJSON&&!this.Fjb()}Fjb(){return this.floatingObject&&this.floatingObject.Zc&&this.floatingObject.Zc.ChartPlayerData?!!this.floatingObject.Zc.ChartPlayerData.ImageData:!1}isChartDataUnhealthy(){return this.floatingObject.Zc&&this.floatingObject.Zc.Attributes&2048?!0:!1}static aZc(La){const wb=K.a.THc(),Wa=0===La.type&&3===La.renderType;!wb&&Wa&&c.ULS.sendTraceTag(537162432,5,50,`ChartFloatingObjectControl.ShouldUseForFloatingObject - Prevented ChartPlayer from being created. ID:${La.Ec}, Type: ${La.type}, RenderType: ${La.renderType}`);
return wb&&Wa}static uyj(La){return Object(n.a)(tb,La)||Object(n.a)(pa.a,La)&&(La=Object(m.a)(pa.a,La).Jm,Object(n.a)(tb,La))?!0:!1}static gtb(La,wb){La&&wb(La)}OBd(La){if(null!=this.$ta||La){La&&null==this.$ta&&(this.$ta=ba.f(this.$).pg(1).domElement);var wb=Gb.DOMElementExtensions.htb(this.$ta,tb.cEe);La&&wb||Gb.DOMElementExtensions.toggleCssClass(this.$ta,tb.cEe,La)}}static Vif(La,wb){wb&&La&&wb.version===La.version&&!La.Eka&&(wb.Zc=La.Zc,La.mu&&-1!==La.mu.EffectsHeight&&(wb.mu=La.mu),wb.Eka=!1)}}
tb.cXh="ewrchart-img-err";tb.d8f=null;tb.e8f=null;tb.cEe="ewrchart-disable-touch";tb.hXh="ChartRTEFloatie";tb.dXh="ChartFillOutlineFloatie";tb.gXh="ChartOutlineFloatie";tb.$Wh="ChartDeleteFloatie";tb.fXh="ChartFontColorFloatie";tb.XLk="SetProperty";tb.uCf="Floatie";tb.vLg="Ribbon";tb.c3h="ContextMenu";tb.lAj="Keyboard";tb.ZMc=null;tb.Uoc=null;Object(y.a)(tb,"ChartFloatingObjectControl",r.a,[766])},1128:function(y,r,a){a.d(r,"a",function(){return c});y=a(0);class c{constructor(b,f,k,x,d,h=!1){this.ULg=
this.absoluteRotation=0;this.Sxa=b;this.Txa=f;this.translateX=k;this.translateY=x;(this.Yvj=h)?this.ULg=d:this.absoluteRotation=d}}Object(y.a)(c,"TransformationParameters",null,[])},1129:function(y,r,a){a.d(r,"a",function(){return c});y=a(0);a=a(1067);class c extends a.a{constructor(b,f,k,x,d,h,n,m,u,l,t){super(b,f,k,x,d,h,n);this.i2h=m;this.h2h=u;this.o2h=l;this.s2h=t}}Object(y.a)(c,"ResizeConnectorCompleteEventArgs",a.a,[])},1130:function(y,r,a){a.d(r,"a",function(){return c});const c=b=>[1,7,3,
5].includes(b)},1131:function(y,r,a){a.d(r,"b",function(){return b});a.d(r,"c",function(){return f});a.d(r,"d",function(){return k});a.d(r,"a",function(){return x});var c=a(61);const b=(d,h,n,m,u,l,t,e=null)=>{e=d.$a(9,e);e.id=h;e.uoPath=n;return c.h(d,"RemoveChartElementUO",e,m,u,l,t,0)},f=(d,h,n,m,u,l,t=null)=>{t=d.$a(9,t);t.id=h;return c.h(d,"ResetVisualTrackerForChart",t,n,m,u,l,0)},k=(d,h,n,m,u,l,t,e,w,z,E,M,G=null)=>{G=d.$a(9,G);G.id=h;G.shapeTextJson=n;G.fResizeNeeded=m;G.absoluteLeft=u;G.absoluteTop=
l;G.absoluteRight=t;G.absoluteBottom=e;return c.h(d,"SetShapeTextV2",G,w,z,E,M,0)},x=(d,h,n,m,u,l,t=null)=>{t=d.$a(9,t);t.id=h;return c.h(d,"PutFloatingImageInCell",t,n,m,u,l,0)}},1132:function(y,r,a){a.d(r,"b",function(){return h});a.d(r,"c",function(){return n});a.d(r,"a",function(){return u});var c=a(15),b=a(72),f=a(49),k=a(944),x=a(17),d=a(435);const h=(l,t)=>{l.Pke();l.grid.insertBefore(l.get_element(),l.grid.firstChild);n(l,new b.a(t.x,t.y,t.width,t.height),!0);l.l5a(l.ic.mu);l.oMa(!0);l.yza(!0);
l.isVisible=!0;l.ic.isVisible=!1},n=(l,t,e)=>{x.DOMElementExtensions.SG(l.get_element(),t.width);x.DOMElementExtensions.P4(l.get_element(),t.height);const w=l.Z1,z=new f.a(t.x,t.y);z.x=Math.max(z.x,w.x);z.y=Math.max(z.y,w.y);k.a.l6b(l.grid,l.get_element(),z,!1,!1);e&&(e=u(l,z),e=d.a.pN(e.paneType,e.view.Ci),l.floatingObject.width=t.width,l.floatingObject.height=t.height,l.floatingObject.Lu=z.x-w.x+e.x,l.floatingObject.OW=l.floatingObject.Lu+l.floatingObject.width,l.floatingObject.Wv=z.y-w.y+e.y,l.floatingObject.c0=
l.floatingObject.Wv+l.floatingObject.height)},m=(l,t)=>{l=l.da.rb;if(!l.mj||t.x>=l.width&&t.y>=l.height)return 1;if(t.x<l.width&&t.y<l.height)return 2;if(t.x<l.width&&t.y>=l.height)return 4;if(t.x>=l.width&&t.y<l.height)return 3;c.ULS.shipAssertTag(537162460,5,!1,`AboveGridFloatingObjectControlHelper.GetContainerPaneType: couldn't find Container Pane Type of gridPosition: X:${t.x}, Y:${t.y}`);return 1},u=(l,t)=>{const e=l.Z1;t=k.a.OL(t,new f.a(e.x,e.y));t=m(l,t);return l.da.pg(t)}},1270:function(y,
r,a){a.d(r,"a",function(){return u});y=a(0);var c=a(15),b=a(309),f=a(16),k=a(286);r=a(105);var x=a(31),d=a(7),h=a(134),n=a(71),m=a(12);class u extends r.a{constructor(l,t=!0){super(l.domElement);this.Gjc=!1;this.VU=w=>{n.g(w.Ha,!1);if(3===w.Yb||w.Dq===Sys.UI.MouseButton.middleButton)return!1;if(w.Dq===Sys.UI.MouseButton.leftButton&&!this.control.extension.selected)return this.launchHyperlink(w.Ha.rawEvent),!0;this.Gjc||this.Oud(!0);return!1};this.q2a=w=>{3===w.Yb&&this.launchHyperlink(w.Ha.rawEvent);
return!0};this.control=l;l=this.control.$;const e=(new h.SheetProtection(l.qa)).ie(1);if(l.$d&32||!e)this.Gjc=!0;t&&this.Yz(this.control)}Yz(l){b.a.instance.va(f.a.Sd,l.domElement,this.VU);k.a.instance.va(f.a.click,l.domElement,this.q2a);k.a.instance.va(f.a.Gn,l.domElement,this.q2a);l.domElement.classList.add(x.a.Cvc)}kA(l){b.a.instance.Ua(f.a.Sd,l.domElement,this.VU);k.a.instance.Ua(f.a.click,l.domElement,this.q2a);k.a.instance.Ua(f.a.Gn,l.domElement,this.q2a);l.domElement.classList.remove(x.a.Cvc)}get viewMode(){return this.Gjc}set viewMode(l){this.Gjc=
l}dispose(){this.kA(this.control);super.dispose()}Oud(l){this.ydf(this.control,l)}ydf(l,t){l.domElement&&(t?l.domElement.classList.remove(x.a.Cvc):l.domElement.classList.add(x.a.Cvc))}launchHyperlink(l){const t=this.control.floatingObject;if(t){var e=t.Sb;e?(c.ULS.sendTraceTag(537162324,5,50,`ImageHyperLinkBehavior.LaunchHyperlink: Launch ImageHyperLink for control Id: ${t.Ec} , isInternalLink: ${e.HLinkTarget===d.a.cVf?!0:!1}`),e.HLinkTarget===d.a.cVf?this.control.da.lRf(l,e.HLinkRange.NamedObjectName,
e.HLinkRange.SheetName,e.HLinkRange.FirstRow,e.HLinkRange.FirstColumn,e.HLinkRange.LastRow,e.HLinkRange.LastColumn):m.HelperMethods.Rg(e.HLinkTarget,"_blank",void 0,"ImageHyperLinkBehavior.HLinkTarget")):c.ULS.shipAssertTag(537162325,5,!1,`ImageHyperLinkBehavior.LaunchHyperlink: ShapeMetaData is null. Floating Object ID: ${t.Ec}, Type: ${Object.getType(t)}`)}}}Object(y.a)(u,"ImageHyperLinkBehavior",r.a,[])},1271:function(y,r,a){a.d(r,"a",function(){return e});y=a(0);var c=a(15),b=a(16),f=a(189),k=
a(286),x=a(309);r=a(105);var d=a(31),h=a(71),n=a(25),m=a(98),u=a(941),l=a(5),t=a(65);class e extends r.a{constructor(w){super(w.domElement);this.Hd=z=>this.GUg()?z.eventName!==b.a.Gn?(this.Cfb=window.setTimeout(this.kRb,e.knf),!0):!1:!1;this.onDoubleClick=()=>{window.clearTimeout(this.Cfb);this.Cfb=e.EMc;return!0};this.VU=z=>{if(!this.GUg())return!1;h.g(z.Ha,!1);return z.Dq!==Sys.UI.MouseButton.leftButton||this.control.extension.selected?!1:(this.Cfb=window.setTimeout(this.kRb,e.knf),!0)};this.kRb=
()=>{this.Cfb=e.EMc;const z=this.control.floatingObject;if(this.control.xda()){n.f(this.control.$).isEditing&&n.f(this.control.$).Bu(!0);const E=f.a.create();m.d(838263848,!0,void 0,2,30,void 0,[{name:u.a.C6,string:E.toString()}]);const M=t.a.Cb(l.OfficeScriptsCommandManagerService);c.ULS.shipAssertTag(512276319,0,!!M);M.l$i(z.id,z.Sb.ScriptLink,E,z.Sb.ShapeText)}};this.BTg=()=>{if(this.control.$){const z=n.f(this.control.$).ha.ob;z.isFloatingObjectSelected?z.Wb.floatingObject.id===this.control.floatingObject.id?
this.control.domElement.classList.remove(d.a.eNb):this.control.domElement.classList.add(d.a.eNb):this.control.domElement.classList.add(d.a.eNb)}};this.control=w;this.Cfb=e.EMc;this.khe(this.control)}dispose(){this.kA(this.control);super.dispose()}Yz(w){k.a.instance.va(b.a.click,w.domElement,this.Hd);k.a.instance.va(b.a.Gn,w.domElement,this.onDoubleClick);x.a.instance.va(b.a.Sd,w.domElement,this.VU);w.domElement.classList.add(d.a.eNb);n.f(this.control.$).ha.ob.pF(this.BTg)}kA(w){k.a.instance.Ua(b.a.click,
w.domElement,this.Hd);k.a.instance.Ua(b.a.Gn,w.domElement,this.onDoubleClick);x.a.instance.Ua(b.a.Sd,w.domElement,this.VU);w.domElement.classList.remove(d.a.eNb);n.f(this.control.$).ha.ob.yL(this.BTg)}khe(w){void t.a.resolve(l.OfficeScriptsCommandManagerService,{xa:1}).then(z=>{null===z||void 0===z?void 0:z.u4f().then(E=>{E&&this.Yz(w)}).catch(()=>{})})}GUg(){return!!this.control.$&&this.control.$.bva&&this.Cfb===e.EMc&&this.control.$.Ss(null,!1,1023)}}e.EMc=-1;e.knf=500;Object(y.a)(e,"ShapeRunFromButtonBehavior",
r.a,[])},1272:function(y,r,a){a.d(r,"a",function(){return c});y=a(0);class c{constructor(b,f){this.control=b;this.control.$Jb(f)}dispose(){this.control.cuc()}update(b){c.a8g(this.control,b)}static a8g(b,f){if(b.LH&&b.floatingObject.zx&&b.LH.length===b.floatingObject.zx.length)for(let k=0,x=b.LH.length;k<x;k++)b.LH[k].update(f,b,f.zx[k]);else b.cuc(),b.$Jb(f);c.Fel(b)}static Fel(b){if(b.LH&&b.da)for(let f=0;f<b.LH.length;f++)b.LH[f].setPosition(b.da.rtl)}}Object(y.a)(c,"ImageConnectableManager",null,
[4])},1273:function(y,r,a){a.d(r,"a",function(){return G});y=a(0);var c=a(15),b=a(39);r=a(105);var f=a(72),k=a(27),x=a(150),d=a(944),h=a(1067),n=a(1129),m=a(57),u=a(53),l=a(17),t=a(1);a(28);var e=a(119),w=a(151),z=a(115),E=a(60),M=a(31);class G extends r.a{constructor(A,N){super(A.domElement);this.eLe=this.N2d=this.du=null;this.Pzb=this.canDrag=!1;this.Dh=this.r6a=this.Aoc=null;this.control=A;this.HCd=[];this.viewBlockContainerHelpers=N;this.control.cW(G.Zqf,!0);w.a(this.control.$,K=>{this.N2d=K.tX(x.a.QCi,
!1)})}g4e(A){this.addHandler(G.Auc,A)}cHg(A){this.removeHandler(G.Auc,A)}e4e(A){this.addHandler("DragCancelled",A)}aHg(A){this.removeHandler("DragCancelled",A)}f4e(A){this.addHandler("DragFinished",A)}bHg(A){this.removeHandler("DragFinished",A)}get jrf(){return this.Pzb}get eMb(){return this.canDrag}set eMb(A){this.canDrag!==A&&(this.control.cW(G.irf,A),this.canDrag=A)}tka(A){return this.canDrag&&!this.Wpj(A.sc)&&(3!==A.Yb||!(b.a.mi&&3===this.control.floatingObject.type))}V1a(A){A=this.control.$?
z.a().Qf(A):A;if(!this.tka(A))return t.EwaSettings.isChangeGateEnabled("OfficeVSO:5903230_EscapeKeyManualPlacementFix")&&this.control.isElementMovementInProgress()&&this.control.setFocus(!0),!1;this.control.extension&&this.control.extension.VK&&this.control.extension.VK.p4b();this.control.ZSa();this.Pzb=!0;this.raiseEvent(G.Auc);const N=this.viewBlockContainerHelpers.BK(this.control.Ug,this.control.domElement);A=this.viewBlockContainerHelpers.hA(this.control.Ug,A.clientPoint,this.control.Ug.rtl);
this.eLe=d.a.OL(A,N);this.r6a=new f.a(N.x,N.y,0,0);this.Dh=this.control.Ug;this.NNc();return!0}ywa(A){const {FloatingObjectControlExtension:N}=a(983);this.Aoc=A=this.control.$?z.a().Qf(A):A;var K=this.viewBlockContainerHelpers.hA(this.Dh,A.clientPoint,this.Dh.rtl),I=this.Dh.Nn;K=d.a.OL(K,this.eLe);K.x=Math.max(-I.x,K.x);K.y=Math.max(-I.y,K.y);I=new f.a(K.x,K.y,0,0);this.Dh=N.Bpd(I,this.r6a,this.Dh,this.control,!1);this.viewBlockContainerHelpers.l6b(this.Dh,this.control.domElement,I.topLeft,!1);this.R5e(A,
!1);this.X$f();return!0}xwa(A){this.control.$&&z.a().Qf(A);this.control.xT();this.Pzb=!1;this.du=null;this.control.ffa(!0);var N=this.pPf();const K=A=N.x-this.r6a.x,I=N=N.y-this.r6a.y;5===this.control.floatingObject.type&&e.a.BN(this.control.floatingObject.Sb)?this.raiseEvent("DragFinished",new n.a(K,I,A,N,!1,!1,this.Dh,100,null,-1,2)):this.raiseEvent("DragFinished",new h.a(K,I,A,N,!1,!1,this.Dh));this.control&&this.control.extension&&this.control.extension.FJa++}wwa(A){A.qye?(this.control.ffa(!0),
this.Pzb=!1,this.control.clientVersion--,this.control.xT(),this.raiseEvent("DragCancelled")):this.xwa(null)}dispose(){var A;(null===(A=this.du)||void 0===A?0:A.en)&&this.du.cancel();this.control.domElement&&(this.control.cW(G.Zqf,!1),this.control.cW(G.irf,!1));super.dispose()}update(){this.Aoc&&this.ywa(this.Aoc)}qzh(A){this.HCd.push(A)}Wpj(A){for(let N=0,K=this.HCd.length;N<K;++N)if(l.DOMElementExtensions.Ki(this.HCd[N],A))return!0;return!1}pPf(){return this.viewBlockContainerHelpers.BK(this.Dh,
this.control.domElement)}NNc(){this.control.clientVersion++;this.control.ffa(!1,!1);if(this.control&&this.control.extension){const A=this.control.extension;c.ULS.sendTraceTag(537162332,5,50,`ImageDragAdapter:OnDragStart: Image-Updated=${0<A.FLa||0<A.FJa||0<A.Lxa?"false":"true"} ResizeOperationsSinceLastLoad=${A.FLa} MoveOperationsSinceLastLoad=${A.FJa} RotateOperationsSinceLastLoad=${A.Lxa}`)}}X$f(){this.N2d&&this.N2d(()=>({["floatingObjectType"]:e.a.tC(this.control.floatingObject),["Location"]:"canvas"}))}R5e(A,
N){if(A=this.control.da.ha.Ft(A.clientPoint,A.sc,5,N,void 0,!0)){var K=new k.Range(Math.max(1,A.top-3),Math.max(1,A.left-1),A.bottom+3,A.right+1,!1,!1);this.du?this.du.en||(this.du=m.a.instance.create(()=>{this.control.da.Ix(K,60,"ImageDragAdapter.OnDragMove")},40,u.a.imageDragAdapterOnDragMove)):(c.ULS.sendTraceTag(537162331,5,50,`ImageDragAdapter.OnDragMove Viewport movement started from  ${K.top.toString()} ${K.left.toString()} ${K.bottom.toString()} ${K.right.toString()}`),this.du=m.a.instance.create(()=>
{this.control.da.Ix(K,60,"ImageDragAdapter.OnDragMove")},40,u.a.imageDragAdapterOnDragMove))}}}G.Zqf=M.a.QVa;G.irf=E.a.qEd;G.Auc="DragStarted";Object(y.a)(G,"ImageDragAdapter",r.a,[764,109])},1276:function(y,r,a){a.d(r,"a",function(){return b});y=a(0);var c=a(15);class b{logTrace(f){c.ULS.sendTraceTag(537162333,5,50,f)}}Object(y.a)(b,"GC2Logger",null,[778])},1278:function(y,r,a){a.d(r,"a",function(){return z});y=a(0);var c=a(15),b=a(91),f=a(6);r=a(953);var k=a(31),x=a(61),d=a(124),h=a(1032),n=a(1003),
m=a(57),u=a(53),l=a(33),t=a(36),e=a(119),w=a(616);class z extends r.a{constructor(E,M,G,A,N="",K=!0){super(E,M,k.a.vFa,A,N,K);this.hIf=this.Rka=this.nkb=this.qAa=null;this.qUh=()=>{this.hIf=this.Bzc.start();this.Rka=h.d(this.$.ma.sa,this.floatingObject.id,this.cZj,this.bZj,null,null)};this.cZj=I=>{this.pfa&&this.iqa(l.a.zb.me.m,"Step2-GetEffectsExtentsSuccess",this.Bzc.Kc,!1);this.YZg("GetEffectsExtentsSuccess");this.bJa.f6("GetEffectsExtentsSuccess");this.Gda(!0,!0);this.pfa&&this.$Kd.start();this.floatingObject.version<
this.clientVersion||(I&&!t.a.zf(I.Errors)&&(this.u9a=I.Result,this.l5a(I.Result)),this.pfa&&(w.a(this.$Kd),this.iqa(l.a.zb.me.m,"Step3-GetEffectsExtentsSuccess-LayoutAndRender",this.$Kd.Kc,!1),this.GKc()),super.g3(null))};this.bZj=()=>{this.pfa&&(this.iqa(l.a.zb.me.m,"Step2-GetEffectsExtentsFailure",this.Bzc.Kc),this.GKc());this.YZg("GetEffectsExtentsFailure");this.bJa.f6("GetEffectsExtentsFailure");this.Gda(!1,!0);super.g3(null)};this.pUh=()=>{const I=this.$.ma.sa.mc();this.Rka=x.u(this.$.ma.sa,
this.floatingObject.id,1,this.L9d,this.K9d,null,null,I)};this.L9d=I=>{I&&!t.a.zf(I.Errors)&&(I=I.Result)&&this.floatingObject.Zc&&(this.floatingObject.Zc.ChartTitle=I.PreviousTitle?I.PreviousTitle:"")};this.K9d=()=>{};this.GDa=G;this.Bzc=this.$.Vb.Pg("ModelUpdate","FloatingObjectGetEffectsExtentsStopwatch");this.$Kd=this.$.Vb.Pg("ModelUpdate","FloatingObjectGetEffectsExtentsBrowserLayoutStopwatch")}get $J(){return this.qAa}set $J(E){this.qAa=E}dispose(){this.floatingObject&&0===this.floatingObject.type&&
e.a.Cag(this.floatingObject.Ec,!1,!1,!1,!1);b.a.xd([this.qAa,this.nkb]);this.Kdb();this.GDa=this.nkb=this.qAa=null;super.dispose()}cJ(E,M=!1){super.cJ(E,M);this.GDa.WGb(this.$,this)}x2(){return!!this.floatingObject&&!!this.floatingObject.Sb&&this.floatingObject.Sb.IsHlinkPresent}Moe(E){this.qAa&&this.floatingObject&&(E.version>this.floatingObject.version||E.instanceId!==this.floatingObject.instanceId&&this.floatingObject.T5b<E.T5b)&&this.qAa.Rqk();super.Moe(E)}q2a(){return!this.x2()}g3(E){if(!f.AFrameworkApplication.Sf&&
this.floatingObject){var M=this.S6b();this.H8.stop();this.pfa&&this.iqa(l.a.zb.me.m,(M?"Step1-":"")+"ImageLoadSuccess",this.H8.Kc,!0);this.x_c("ImageLoadSuccess",!M);this.bJa.f6("ImageLoadSuccess");if(this.Vp){const G=this.$j.block;c.ULS.sendTraceTag(537162329,5,50,`ImageFloatingObjectControl.OnLoadSuccess - Time since GetRangeContent request received [${G.cnb}], FloatingObjects Count in block [${G.Ii.count}], this FloatingObject IsSvg [${this.floatingObject.isSvg}]`)}if(M){if(this.floatingObject.version<
this.clientVersion)return;this.Ije(this.H8.Kc,!0);this.Kdb();b.a.vb(this.nkb);this.nkb=m.a.instance.create(this.qUh,0,u.a.Xdj,!0,!0)}else this.floatingObject.isSvg||this.floatingObject.mu?(this.u9a=this.floatingObject.mu,this.l5a(this.mu)):this.Taa()&&this.pJk(),this.Gda(!0),super.g3(E);this.$J&&(this.qAa.uke(this),this.qAa.Hoe(this.floatingObject.Zc));0===this.floatingObject.type&&(this.movable&&(this.Kdb(),b.a.vb(this.nkb),this.nkb=m.a.instance.create(this.pUh,0,u.a.Wdj,!0,!0)),n.p(this.$,this.MUa))}}nse(){return!1}Kdb(){this.Rka&&
(d.a.dy(this.Rka.sx),this.Rka=null)}YZg(E){this.Bzc.stop();this.gbg(E,this.hIf,!1,this.K9f)}S6b(){if(!this.floatingObject||!this.floatingObject.Sb||this.floatingObject.mu)return!1;(this.floatingObject.isSvg||this.floatingObject.Nkb)&&c.ULS.sendTraceTag(537162327,5,15,`ImageFloatingObjectControl.ShouldCallGetEffectsExtents: floating object does not have effects extents. Rendered as ${this.floatingObject.renderType}`);return 5===this.floatingObject.type?this.floatingObject.Sb.HasEffects||!!this.floatingObject.Sb.Rotation||
this.OOk():1===this.floatingObject.type?this.floatingObject.Sb.HasEffects||!!this.floatingObject.Sb.Rotation:!1}pJk(){const E={XEffectsDelta:1,YEffectsDelta:1};E.EffectsWidth=this.floatingObject.width+1;E.EffectsHeight=this.floatingObject.height+1;this.u9a=E;this.l5a(E)}OOk(){if(5===this.floatingObject.type&&this.floatingObject.Sb)switch(this.floatingObject.Sb.ShapeType){case 4:case 34:case 25:case 43:case 16:case 3:case 92:case 142:case 26:case 50:case 2:case 46:case 44:break;case 0:return!this.Xnj();
default:return!0}return!1}Xnj(){return e.a.BN(this.floatingObject.Sb)&&0===this.floatingObject.jUa[0].wxd&&0===this.floatingObject.jUa[1].wxd}}Object(y.a)(z,"ImageFloatingObjectControl",r.a,[310])},1279:function(y,r,a){a.r(r);a.d(r,"ConnectorFloatingObjectControlExtension",function(){return h});y=a(0);var c=a(983),b=a(492),f=a(213),k=a(1280),x=a(1032),d=a(266);class h extends c.FloatingObjectControlExtension{constructor(n,m){super(n,m)}Hpb(n){var m=this.tk;const u=m.ria;m=m.Cra;this.control.floatingObject.jUa[u.index].ygb=
!1;this.control.floatingObject.jUa[m.index].ygb=!1;u.$5b(!1);m.$5b(!1);super.Hpb(n)}Hyd(){}CUa(){this.control.movable&&(this.tk=new k.a(this.control.domElement,this.control.Tj,this.control.da,this.control,this.Ep,c.FloatingObjectControlExtension.dT,c.FloatingObjectControlExtension.viewBlockContainerHelpers),this.eTc())}HVb(n=!1){return n&&super.HVb(n)}lJg(n){var m=this.tk;const u=m.ria;m=m.Cra;u&&m&&(n.zx[0].offsetX=u.domElement.offsetLeft+n.offsetX,n.zx[0].offsetY=u.domElement.offsetTop+n.offsetY,
n.zx[1].offsetX=m.domElement.offsetLeft+n.offsetX,n.zx[1].offsetY=m.domElement.offsetTop+n.offsetY)}$lf(n){const m=this.control.floatingObject.id,u=this.control.floatingObject.type,l=this.Yha,t=this.$ha,e=this.Zha,w=this.Xha,z=n.txe,E=n.uxe,M=n.h2h,G=n.i2h,A=n.o2h,N=n.s2h,K=this.control.$.ma.sa;return new f.a(521,0,(I,L,J)=>x.f(K,u,m,l,t,e,w,z,E,G,M,A,N,d.c(I,this.Ipg),d.b(L,this.Hpg),J,null),64,()=>new b.a)}}Object(y.a)(h,"ConnectorFloatingObjectControlExtension",c.FloatingObjectControlExtension,
[])},1280:function(y,r,a){a.d(r,"a",function(){return t});y=a(0);var c=a(15),b=a(39),f=a(1053),k=a(217),x=a(31),d=a(1129),h=a(1003),n=a(17),m=a(119),u=a(99),l=a(12);class t extends f.a{constructor(e,w,z,E,M,G,A=null,N=null){super(e,z,E,M,G,A,N);this.YHa=!1;this.BKg=0;this.VNb=this.nja=this.qfb=this.u$c=this.Oyb=this.cC=null;this.Tj=w;this.Knh=E.$.Wf;this.zjh=G}get Tj(){return this.Oyb}set Tj(e){this.Oyb=e}get ria(){return this.control.RI?0<this.control.RI.length?this.control.RI[0]:null:null}get Cra(){return this.control.RI?
1<this.control.RI.length?this.control.RI[1]:null:null}get fca(){return this.u$c}get $ta(){return this.Knh}dispose(){this.fca&&(n.DOMElementExtensions.vh(this.fca.parentNode),this.u$c=null);super.dispose()}yia(e){this.BKg=e;this.Sb||(this.rotation=(this.Sb=this.control.floatingObject.Sb)?this.Sb.Rotation:0);this.Epd();c.ULS.shipAssertTag(537162399,0,this.control.floatingObject.zx.length===t.ZDa,`ConnectorResizableBehavior.CreateAndAttachResizeHandles: expecting 2 connection points, but have ${this.control.floatingObject.zx.length}.`);
this.control.floatingObject.zx.length===t.ZDa&&(this.GIk(),this.control.yia(e,t.ZDa,this));b.a.b0c&&this.Lyd();this.W3(null)}s6a(e,w){this.W3(null);this.nja=this.jVc()?this.Cra:this.ria;this.VNb=l.HelperMethods.isStandardZoomCssSupportedByBrowser?n.DOMElementExtensions.getBoundingClientRect({element:this.nja.domElement,di:!0}):Sys.UI.DomElement.getBounds(this.nja.domElement);super.s6a(e,w);b.a.b0c&&(this.Lyd(),this.da.ha&&this.da.ha.ob.Wb&&(this.qfb=this.control.cx,n.DOMElementExtensions.setVisible(this.qfb,
!1)),n.DOMElementExtensions.setVisible(this.Tj,!0));n.DOMElementExtensions.$ya(this.$ta,!0,x.a.uEd,x.a.Bvc)}lIb(){this.fca&&(n.DOMElementExtensions.setVisible(this.qfb,!0),this.RRd());super.lIb()}W3(e){this.control.RI&&(this.mvd(),this.m4a(this.control,e))}RRd(){this.JCd(0,0,0)}upgrade(e){e&&e.Sb&&(this.Sb=e.Sb,this.rotation=this.Sb.Rotation,(e=this.da.ha.ob.Wb)&&this.control.domElement.id===e.domElement.id&&(this.f1(),this.yia(this.BKg)))}Wrc(e,w){e=this.zjh.G6h(this.VNd(w),w,this.control.floatingObject.jUa[w].ygb);
e.style.zIndex=String(this.zIndex);return e}VNd(e){return this.cC[e]}resize(e,w){super.resize(e,w);this.fca&&!this.WHc&&this.z8g()}gca(){n.DOMElementExtensions.$ya(this.$ta,!1,x.a.uEd,x.a.Bvc);this.ktf();if(this.WHc)this.gtf();else{const {qnb:e,$sb:w,bwb:z,mdb:E,flipX:M,flipY:G}=this.itf(),A=this.PUa,{n_h:N,m_h:K,returnValue:I}=u.a(this.control.$).j9k(this.zB);I?(this.control.floatingObject.jUa[A.index].ygb=!0,A.$5b(!0),this.raiseEvent(f.a.q4b,new d.a(e,z,w,E,M,G,this.Dh,N.floatingObject.type,N.floatingObject.id,
K.index,this.jVc()?0:1))):(this.control.floatingObject.jUa[A.index].ygb=!1,A.$5b(!1),this.raiseEvent(f.a.q4b,new d.a(e,z,w,E,M,G,this.Dh,100,null,-1,this.jVc()?0:1)))}this.htf();this.qfb=null}FXa(e,w,z){return e?(z?-1:1)*w/e:1}m4a(e,w){if(e.RI){var z=0;w=w||e.floatingObject;for(const E of e.RI){const M=m.a.nzc(w,w.zx[z],e.da.rtl);n.DOMElementExtensions.updatePosition(E.domElement,M.x,M.y,!0);z++}}}mvd(){if(this.Sb){this.YHa=this.Sb.FlipX!==this.Sb.FlipY;let e=this.kbe%360;e+=0>e?360:0;e=this.YHa?
360-e:e;this.YHa=45<=e&&135>e||225<=e&&315>e?!this.YHa:this.YHa}}jVc(){return this.PUa===this.ria}Lyd(){if(!this.fca){var e=k.a.Pya;const w=this.Tj.ownerDocument.createElementNS(e,"svg");w.setAttribute("xmlns",e);w.setAttribute("version","1.1");w.setAttribute("height","100%");w.setAttribute("width","100%");w.setAttribute("style","position: absolute;");e=this.Tj.ownerDocument.createElementNS(e,"line");e.setAttribute("style","stroke:#000000;stroke-width:1.0;stroke-dasharray:3,3;");w.appendChild(e);
this.Tj.appendChild(w);this.u$c=e}}z8g(){var e=this.control.domElement;if(e&&this.Sb){var w=this.xK!==this.yK!==this.YHa;w?this.JCd(e.clientWidth,0,e.clientHeight):this.JCd(0,e.clientWidth,e.clientHeight);w?(this.ria.GLa=1,this.Cra.GLa=5):(this.ria.GLa=7,this.Cra.GLa=3);e=h.c(this.TO);h.l(l.HelperMethods.isStandardZoomCssSupportedByBrowser?n.DOMElementExtensions.getBoundingClientRect({element:this.Tj.parentNode,di:!0}):Sys.UI.DomElement.getBounds(this.Tj.parentNode),this.control.RI,e,!1);e=l.HelperMethods.isStandardZoomCssSupportedByBrowser?
n.DOMElementExtensions.getBoundingClientRect({element:this.nja.domElement,di:!0}):Sys.UI.DomElement.getBounds(this.nja.domElement);if(2<Math.abs(e.x-this.VNb.x)||2<Math.abs(e.y-this.VNb.y))e=this.ria.domElement.offsetLeft,w=this.ria.domElement.offsetTop,n.DOMElementExtensions.updatePosition(this.ria.domElement,this.Cra.domElement.offsetLeft,this.Cra.domElement.offsetTop,!0),n.DOMElementExtensions.updatePosition(this.Cra.domElement,e,w,!0);this.VNb=l.HelperMethods.isStandardZoomCssSupportedByBrowser?
n.DOMElementExtensions.getBoundingClientRect({element:this.nja.domElement,di:!0}):Sys.UI.DomElement.getBounds(this.nja.domElement)}}JCd(e,w,z){this.fca&&(this.fca.setAttribute("x1",e.toString()),this.fca.setAttribute("y1",(0).toString()),this.fca.setAttribute("x2",w.toString()),this.fca.setAttribute("y2",z.toString()))}GIk(){this.cC=Array(t.ZDa);const e=Array(t.ZDa);if(this.rotation){var w=Array(t.ZDa),z=l.HelperMethods.isStandardZoomCssSupportedByBrowser?n.DOMElementExtensions.getBoundingClientRect({element:this.Tj.parentNode,
di:!0}):Sys.UI.DomElement.getBounds(this.Tj.parentNode);z=new Sys.UI.Point(z.width/2,z.height/2);const E=h.c(-this.rotation);for(let M=0;M<t.ZDa;M++)w[M]=m.a.nzc(this.control.floatingObject,this.control.floatingObject.zx[M],!1),e[M]=h.n(w[M],z,E,this.control.Ug.rtl)}else for(w=0;w<t.ZDa;w++)e[w]=m.a.nzc(this.control.floatingObject,this.control.floatingObject.zx[w],!1);this.mvd();e[0].x===e[1].x?e[0].y<e[1].y?this.YHa?(this.cC[0]=1,this.cC[1]=5):(this.cC[0]=7,this.cC[1]=3):this.YHa?(this.cC[0]=5,this.cC[1]=
1):(this.cC[0]=3,this.cC[1]=7):e[0].y===e[1].y?e[0].x<e[1].x?(this.cC[0]=7,this.cC[1]=3):(this.cC[0]=1,this.cC[1]=5):e[0].x<e[1].x?e[0].y<e[1].y?(this.cC[0]=7,this.cC[1]=3):(this.cC[0]=5,this.cC[1]=1):e[0].y<e[1].y?(this.cC[0]=1,this.cC[1]=5):(this.cC[0]=3,this.cC[1]=7)}}t.ZDa=2;Object(y.a)(t,"ConnectorResizableBehavior",f.a,[])},1434:function(y,r,a){a.d(r,"g",function(){return G});a.d(r,"f",function(){return A});a.d(r,"d",function(){return N});a.d(r,"a",function(){return K});a.d(r,"c",function(){return I});
a.d(r,"b",function(){return L});a.d(r,"e",function(){return J});a.d(r,"j",function(){return B});a.d(r,"k",function(){return Y});a.d(r,"l",function(){return U});a.d(r,"h",function(){return O});a.d(r,"i",function(){return C});var c=a(15),b=a(60),f=a(31),k=a(983);y=a(0);var x=a(154),d=a(1273),h=a(72),n=a(49),m=a(944),u=a(947),l=a(115);class t extends d.a{constructor(X,S){super(X,S);this.drf=null}get ic(){return Object(x.a)(u.a,this.control)}V1a(X){X=this.control.$?l.a().Qf(X):X;if(!this.tka(X))return!1;
this.ic.ZSa();this.Pzb=!0;this.raiseEvent(d.a.Auc);var S=this.viewBlockContainerHelpers.BK(this.ic.Ug,this.ic.domElement);X=this.viewBlockContainerHelpers.hA(this.ic.Ug,X.clientPoint,this.ic.Ug.rtl);this.drf=m.a.OL(X,S);this.Dh=this.ic.Ug;S=this.viewBlockContainerHelpers.Dca(this.Dh,this.ic.domElement);this.r6a=new h.a(S.x+this.Dh.Nn.x,S.y+this.Dh.Nn.y,S.width,S.height);X=this.ic.Qd;this.ic.HMa(new h.a(this.r6a.x+X.Z1.x,this.r6a.y+X.Z1.y,S.width,S.height));X.ZSa();this.NNc();return!0}ywa(X){this.Aoc=
X=this.control.$?l.a().Qf(X):X;this.R5e(X,!0);this.r7k(X.clientPoint);this.X$f();return!0}xwa(X){X=this.control.$?l.a().Qf(X):X;this.ic.Qd.xT();this.Dh=this.ic.Qd.Ug;super.xwa(X)}dispose(){super.dispose()}pPf(){const X=this.viewBlockContainerHelpers.BK(this.Dh,this.ic.Qd.domElement);return new n.a(X.x+this.Dh.Nn.x,X.y+this.Dh.Nn.y)}r7k(X){const S=this.ic.Qd;X=m.a.hA(new n.a(0,0),S.grid,X,this.Dh.rtl);X=m.a.OL(X,this.drf);const ea=this.viewBlockContainerHelpers.Dca(S.Ug,S.domElement);S.V5b(new h.a(X.x,
X.y,ea.width,ea.height),!1)}}Object(y.a)(t,"MultiPanesImageDragAdapter",d.a,[]);r=a(1270);class e extends r.a{constructor(X){super(X,!1);this.UU=(S,ea)=>{this.Yz(ea.KP)};this.fpb=(S,ea)=>{this.kA(ea.KP)};for(const S of this.ic.children)this.Yz(S);this.ic.xFb(this.UU);this.ic.klc(this.fpb)}get ic(){return Object(x.a)(u.a,this.control)}dispose(){for(const X of this.ic.children)this.kA(X);super.dispose()}Oud(X){for(const S of this.ic.children)this.ydf(S,X)}}Object(y.a)(e,"MultiPanesImageHyperLinkBehavior",
r.a,[]);r=a(1463);var w=a(1033);class z extends r.a{constructor(X,S,ea,Oa,Ha){super(X,S,ea,Oa,Ha)}get ic(){return Object(x.a)(u.a,this.control)}update(){if(this.Bva){var X=this.jo,S=X.topLeft;w.a(X,0>S.x?-S.x:0,0>S.y?-S.y:0);this.ic.HMa(X);this.ic.ova()&&this.Jna(X,this.ic.Qd)}}mXc(X){this.Bva||(this.vf=this.Wg(),this.jo=this.vf.clone());(X&&!this.C_a||!X&&!this.m_a)&&this.Syg(X)}rOc(X){this.jo&&(0>this.jo.x||0>this.jo.y)&&(this.jo=new h.a(Math.max(this.jo.x,0),Math.max(this.jo.y,0),this.jo.width,
this.jo.height));super.rOc(X)}Wg(){var X=this.ic.Qd.grid;X=m.a.BK(new n.a(0,0),X,this.ic.domElement,this.da.rtl);return new h.a(X.x,X.y,this.ic.domElement.clientWidth,this.ic.domElement.clientHeight)}}Object(y.a)(z,"MultiPanesImageKeyboardAdjustBehavior",r.a,[]);r=a(1461);class E extends r.a{constructor(X){super(X,!1);this.UU=(S,ea)=>{this.Yz(ea.KP);this.selected&&ea.KP.yza(!0)};this.fpb=(S,ea)=>{this.kA(ea.KP)};for(const S of this.ic.children)this.Yz(S);this.Yz(this.ic.Qd);this.ic.xFb(this.UU);this.ic.klc(this.fpb)}get ic(){return Object(x.a)(u.a,
this.control)}get pif(){return this.ic.Qd&&this.ic.Qd.isVisible?this.ic.Qd:this.ic.Jm}dispose(){for(const X of this.ic.children)this.kA(X);this.ic.Qd&&this.kA(this.ic.Qd);this.ic.oie(this.UU);this.ic.QGg(this.fpb);super.dispose()}Twb(X,S){for(const ea of this.ic.children)super.Twb(ea,S);for(const ea of this.ic.nbf)super.Twb(ea,S);this.ic.Qd&&super.Twb(this.ic.Qd,S)}kA(X){X!==this.ic&&super.kA(X)}Yz(X){X!==this.ic&&super.Yz(X)}nqb(X,S,ea=!1){if(this.ic.Qd){const Oa=this.ic.Qd.isVisible;this.ic.Qd.isVisible=
!1;super.nqb(X,S,ea);this.ic.Qd.isVisible=Oa}}}Object(y.a)(E,"MultiPanesImageSelectableBehavior",r.a,[]);a=a(1271);class M extends a.a{constructor(X){super(X);this.UU=(S,ea)=>{this.khe(ea.KP)};this.fpb=(S,ea)=>{this.kA(ea.KP)};for(const S of this.ic.children)this.khe(S);this.ic.xFb(this.UU);this.ic.klc(this.fpb)}get ic(){return Object(x.a)(u.a,this.control)}dispose(){for(const X of this.ic.children)this.kA(X);super.dispose()}}Object(y.a)(M,"MultiPanesShapeRunFromButtonBehavior",a.a,[]);const G=(X,
S,ea)=>{X.xFb(S);X.klc(ea)},A=(X,S,ea)=>{X.oie(S);X.QGg(ea)},N=(X,S)=>{S.$C&&(X.TI=new E(S),X.ZEg())},K=(X,S)=>{if(S.$C&&S.movable){X.ev=new t(S,k.FloatingObjectControlExtension.viewBlockContainerHelpers);X.KEg();for(const ea of S.children)X.x9(ea);S.Qd&&X.x9(S.Qd)}},I=(X,S)=>{S.$C&&(X.ns=new z(S.domElement,S.da,S,k.FloatingObjectControlExtension.viewBlockContainerHelpers,X.Ep),X.QEg())},L=X=>{X.rUg()&&(X.ekb=new e(X.control),c.ULS.sendTraceTag(537162206,5,50,`MultiPanesFloatingObjectControlExtensionHelper.CreateImageHyperLinkBehavior: Create CreateImageHyperLinkBehaviorByExtension for control Id: ${X.control.floatingObject?
X.control.floatingObject.Ec:"unknown"}`))},J=X=>{X.sUg()&&(X.oqe=new M(X.control),c.ULS.sendTraceTag(537162205,5,50,`MultiPanesFloatingObjectControlExtensionHelper.CreateShapeRunFromButtonBehavior: Create CreateShapeRunFromButtonBehaviorByExtension for control Id: ${X.control.floatingObject?X.control.floatingObject.Ec:"unknown"}`))},B=X=>{const S=X.Qd;if(null===S||void 0===S?0:S.isVisible)X.isVisible=!0},Y=(X,S,ea)=>{X.Nfg(ea)&&(S.isVisible=!0)},U=(X,S)=>{for(const ea of S.children)X.e2c(ea);S.Qd&&
X.e2c(S.Qd)},O=(X,S)=>{var ea;if(null===(ea=X.TI)||void 0===ea?0:ea.selected)X.tk&&(X.tk.yia(X.TI.Hb),X.ev&&S.KP.cW(b.a.qEd,!0)),X.Uo&&X.Uo.xUa();X.ev&&(S.KP.cW(f.a.QVa,!0),X.x9(S.KP))},C=(X,S)=>{X.tk&&S.KP.f1(X.tk);X.ev&&(S.KP.cW(b.a.qEd,!1),S.KP.cW(f.a.QVa,!1),X.e2c(S.KP));X.Uo&&S.KP.isa(X.Uo)}},1461:function(y,r,a){a.d(r,"a",function(){return I});y=a(0);var c=a(15),b=a(16),f=a(309),k=a(194),x=a(332),d=a(286),h=a(407),n=a(55);r=a(105);var m=a(70),u=a(1003);class l extends Sys.EventArgs{constructor(L,
J){super();this.selected=L;this.inputMethod=J}}Object(y.a)(l,"ImageSelectionChangedEventArgs",Sys.EventArgs,[]);var t=a(83),e=a(17),w=a(71),z=a(36),E=a(1),M=a(119),G=a(45),A=a(115),N=a(65),K=a(5);class I extends r.a{constructor(L,J=!0){super(L.domElement);this.q1b=this.Un=!1;this.r$a=this.JMc=0;this.Sb=null;this.TO=0;this.VU=B=>{B=this.control.$?A.a().Qf(B):B;return this.c$d(B,B.clientPoint,this.mVg(B.Dq))};this.$lg=B=>{B=this.control.$?A.a().Qf(B):B;return this.c$d(B,B.clientPoint,this.mVg(B.Dq))};
this.bmg=B=>{B=this.control.$?A.a().Qf(B):B;return this.c$d(B,B.clientPoint,!1)};this.Hd=B=>{if(this.control.floatingObject.Vqc){if(9!==this.control.floatingObject.type&&this.LYc(B))return this.nqb(B.Ha,B.clientPoint,!0),!1;this.control.showE1ODialog();return!0}B=this.control.$?A.a().Qf(B):B;if(3===B.Yb||B.eventName===b.a.Gn){if(this.LYc(B))return this.nqb(B.Ha,B.clientPoint,!0),!1;this.Un||3===B.Yb&&(this.control.x2()||this.control.xda())||(this.da.ha.ob.KZ(this.control),this.da.ha.ob.uOg());if(3===
B.Yb){if(this.control.floatingObject&&3===this.control.floatingObject.type)return!1;(this.control.floatingObject&&0===this.control.floatingObject.type&&3===this.control.floatingObject.renderType?!E.EwaSettings.isChangeGateEnabled("OfficeVSO:4817161_IsPointerEventEnabled"):1)&&this.Un&&this.showChartContextMenu(B)}}return(!this.control.x2()&&!this.control.xda()||this.Un)&&3!==B.Yb};this.onDoubleClick=B=>this.Hd(B)?(this.control.$.isEditMode&&(5===this.control.floatingObject.renderType&&5===this.control.floatingObject.type?
(B=new t.a(-445658892,this.Hb,this.control.$.xc,30,null),this.control.$.Ia.Gb(B,null)):5!==this.control.floatingObject.type||M.a.BN(this.control.floatingObject.Sb)||this.control.floatingObject.Sb.IsGroup||(c.ULS.sendTraceTag(554723232,5,15,`Shape text editing not supported on the shape with id: ${this.control.floatingObject.Ec}`),B=z.a.Cd(1,0,824,825,0,-833623233,"ShapeTextEditingUnsupported"),G.a(this.control.$).Wi(B))),!this.control.xda()):!1;this.Jj=B=>{B=this.control.$?A.a().Qf(B):B;this.LYc(B)?
this.nqb(B.Ha,B.clientPoint):(this.Un||this.da.ha.ob.KZ(this.control),this.showChartContextMenu(B));return!0};this.amg=B=>{B=this.control.$?A.a().Qf(B):B;if(B.Dq===Sys.UI.MouseButton.leftButton||B.Dq===Sys.UI.MouseButton.rightButton)E.EwaSettings.isChangeGateEnabled("OfficeVSO:8910920_isMouseRightClickCheckAdded")&&(this.da.ha.ob.NXd=B.Ha.button===Sys.UI.MouseButton.rightButton?!0:!1),this.Un&&this.da.ha.ob.uOg(),this.da.ha.ob.LXd=!1;return!1};this.tA=L.da;this.control=L;J&&this.Yz(this.control);
this.selected=!1}Yz(L){f.a.instance.va(b.a.Sd,L.domElement,this.VU);k.a.instance.va(b.a.ih,L.domElement,this.bmg);x.a.instance.va(b.a.wt,L.domElement,this.$lg);f.a.instance.va(b.a.Lj,L.domElement,this.amg);d.a.instance.va(b.a.click,L.domElement,this.Hd);d.a.instance.va(b.a.Gn,L.domElement,this.onDoubleClick);h.a.instance.va(L.domElement,this.Jj)}kA(L){f.a.instance.Ua(b.a.Sd,L.domElement,this.VU);x.a.instance.Ua(b.a.wt,L.domElement,this.$lg);k.a.instance.Ua(b.a.ih,L.domElement,this.bmg);f.a.instance.Ua(b.a.Lj,
L.domElement,this.amg);d.a.instance.Ua(b.a.click,L.domElement,this.Hd);d.a.instance.Ua(b.a.Gn,L.domElement,this.onDoubleClick);h.a.instance.Ua(L.domElement,this.Jj)}get Hb(){return this.r$a}set Hb(L){this.r$a=L;m.a.Hb=L}mEh(L){this.addHandler("ImgSeleChnged",L)}gtk(L){this.removeHandler("ImgSeleChnged",L)}get selected(){return this.Un}set selected(L){this.Un!==L&&(this.q1b||this.ldk(),this.Un=L,this.raiseEvent("ImgSeleChnged",new l(L,this.Hb)),this.control.yza(L))}get pif(){return this.control}get da(){return this.tA}dispose(){this.kA(this.control);
this.tA=null;super.dispose()}upgrade(L){L&&(this.selected&&this.control.ffa(!0,!1),L.floatingObject.Sb&&(this.Sb=L.floatingObject.Sb,this.JMc=u.i(this.Sb.Rotation,this.Sb.FlipX!==this.Sb.FlipY),this.Twb(L,this.JMc),this.TO=this.JMc))}Vfa(L){this.TO=this.JMc+L;this.Twb(this.control,this.TO)}c$d(L,J,B){this.Hb=L.Yb;if(this.LYc(L))return this.nqb(L.Ha,J),!1;w.g(L.Ha,!1);if(3===L.Yb)return!1;B&&(E.EwaSettings.isChangeGateEnabled("OfficeVSO:8910920_isMouseRightClickCheckAdded")&&(this.da.ha.ob.NXd=L.Ha.button===
Sys.UI.MouseButton.rightButton?!0:!1),this.Un||this.da.ha.ob.KZ(this.control),this.da.ha.ob.LXd=!0);return!1}Twb(L,J){u.a(L.Tj,J);M.a.BN(this.Sb)&&(L.Tj.style.borderWidth="0px")}nqb(L,J,B=!1){const Y=this.control.isVisible;this.control.isVisible=!1;if(J=n.a.Czc(J))B?e.DOMElementExtensions.vEc(J,L):e.DOMElementExtensions.U7(J,L,new Sys.UI.Point(0,0)),w.g(L,!1);this.control.isVisible=Y}Mrj(L,J){let B=!1;L=e.DOMElementExtensions.getBoundingClientRect({element:L});var Y=new Sys.UI.Point(L.x+L.width/2,
L.y+L.height/2),U=u.c(-this.TO);J=u.n(J,Y,U,!1);Y=J.x-L.x;U=J.y-L.y;this.Un&&(Math.abs(Y)<=I.Znc||Math.abs(U)<=I.Znc||Math.abs(U-L.height)<=I.Znc||Math.abs(Y-L.width)<=I.Znc)?B=!0:1===this.control.floatingObject.type&&J.x>=L.x&&J.x<=L.x+L.width&&J.y>=L.y&&J.y<=L.y+L.height&&(B=!0);return B}ldk(){this.control.Taa()&&this.upgrade(this.control);this.q1b=!0}Krj(L,J){if(!this.control.DDc||4===this.control.floatingObject.renderType||9===this.control.floatingObject.type)return!1;if(this.control.floatingObject.bG)return this.Lrj(L,
J);var B=document.createElement("canvas");J=this.control.s4c;const Y=e.DOMElementExtensions.getBoundingClientRect({element:J});B.width=J.width;B.height=J.height;B=B.getContext("2d");B.drawImage(J,0,0,J.width,J.height);return this.n1f(B,new Sys.UI.Point(L.x-Y.x,L.y-Y.y),L,J.parentNode.parentNode)}n1f(L,J,B,Y){if(!M.a.BN(this.Sb)&&this.Mrj(Y,B))return!1;var U=new Sys.UI.Point(J.x-5.5,J.y-5.5);J=Math.max(U.x,0);B=Math.max(U.y,0);Y=11+Math.min(U.x,0);U=11+Math.min(U.y,0);Y||(Y=5.5);U||(U=5.5);L=L.getImageData(J,
B,Y,U);J=0;for(B=3;B<L.data.length;B+=4)J+=L.data[B];return!J}Lrj(L,J){return(J=this.pif.getHitTestData(L,J))?this.n1f(J.context,new Sys.UI.Point(J.offsetPoint.x,J.offsetPoint.y),L,this.control.domElement):!1}LYc(L){if(!this.control.Tvd)return!1;let J=!1;try{J=this.Krj(L.clientPoint,L.sc)}catch(B){const Y=this.control.floatingObject;c.ULS.sendTraceTag(537162305,5,50,`ImageSelectableBehavior.IsHitInTransparentArea, Exception was thrown when calling GetBoundingClientRect. Exception [${B.message}], Stack [${B.stack}], FOType [${Y.type}], FORenderType [${Y.renderType}]`)}return J&&
!this.control.tFc(L.sc)}showChartContextMenu(L){const J=this.da.ha.ob.Wb,B=J?J.floatingObject:null;B&&void N.a.resolve(K.ChartElementManagerService,{xa:0}).then(Y=>{Y.wEc(B.Zc,L.Yb,L)})}mVg(L){const J=this.control.xda()&&this.control.$.bva;return L!==Sys.UI.MouseButton.middleButton&&!((this.control.x2()||J)&&L===Sys.UI.MouseButton.leftButton)}}I.Znc=3;Object(y.a)(I,"ImageSelectableBehavior",r.a,[])},1462:function(y,r,a){a.d(r,"a",function(){return A});y=a(0);var c=a(15),b=a(91),f=a(1127);r=a(105);
var k=a(953),x=a(150),d=a(1003),h=a(39),n=a(31),m=a(20),u=a(7),l=a(64),t=a(17);class e{constructor(){this.iVe=null;this.hsh=document.createElement("div");this.qO.className=n.a.Esi;if(h.a.b0c){const N=document.createElementNS("http://www.w3.org/2000/svg","svg");N.setAttribute("xmlns","http://www.w3.org/2000/svg");N.setAttribute("version","1.1");N.setAttribute("height","100%");N.setAttribute("width","100%");N.setAttribute("overflow","visible");const K=document.createElementNS("http://www.w3.org/2000/svg",
"line");K.setAttribute("style","stroke:#8c8a8a;stroke-width:1.5;");K.setAttribute("x1","12");K.setAttribute("y1","-5");K.setAttribute("x2","12");K.setAttribute("y2","10");N.appendChild(K);this.qO.appendChild(N)}this.dai()}get qO(){return this.hsh}get Y2a(){return this.iVe}get isVisible(){return t.DOMElementExtensions.isVisible(this.qO)}set isVisible(N){t.DOMElementExtensions.setVisible(this.qO,N)}dai(){this.iVe=document.createElement("div");this.Y2a.className=m.a.$vd;const N=document.createElement("img");
N.classList.add(m.a.Mti);N.src=l.a.Lh(1);N.draggable=!1;this.Y2a.appendChild(N);this.Y2a.style.cursor=String.format(u.a.zEa,l.a.current.Lo(109));this.qO.insertBefore(this.Y2a,this.qO.firstChild)}}e.jCd=10;Object(y.a)(e,"RotatePoint",null,[784]);var w=a(1128),z=a(119),E=a(151),M=a(115),G=a(12);class A extends r.a{constructor(N,K,I,L){super(N);this.translateY=this.translateX=0;this.lZg=null;this.TTa=!1;this.n3d=null;this.zzg=this.Azg=this.xK=this.yK=!1;this.w6=null;this.ZLc=this.z2a=this.P1b=0;this.Sb=
null;this.D4a=!1;this.vf=null;this.aPa=0;this.m9d=J=>{16===J.keyCode&&!this.TTa&&this.D4a&&(this.TTa=!0,this.ZP.Ea("keyup",this.n9d),this.update())};this.n9d=J=>{16===J.keyCode&&this.TTa&&this.D4a&&(this.TTa=!1,this.ZP.detach("keyup"),this.update())};this.control=K;this.Ep=I;this.viewBlockContainerHelpers=L;this.ZP=this.Df.zUa();this.ULa();E.a(this.control.$,J=>{this.n3d=J.tX(x.a.UCi,!1)})}get vX(){return this.aPa}get R6(){return this.vX+this.P1b}get A0b(){return this.control.cx.offsetTop}get z0b(){return this.control.cx.offsetLeft}dispose(){b.a.vb(this.ZP);
super.dispose()}WFh(N){this.addHandler("RotateStarted",N)}Euk(N){this.removeHandler("RotateStarted",N)}Vfa(N){this.aPa=0;this.P1b=N+this.z2a;this.l4a()}wzd(){const N=new e;N.qO.style.zIndex=this.control.p_a?String(k.a.Hac-1):String(k.a.jOa+2*this.control.floatingObject.XE);return N}xUa(){this.control.xUa(this);this.l4a()}isa(){this.control.isa(this)}tka(N){return N.Dq!==Sys.UI.MouseButton.middleButton}V1a(N){N=this.control.$?M.a().Qf(N):N;this.Vue(N);return!0}ywa(N){N=this.control.$?M.a().Qf(N):N;
this.w6=this.hA(N.clientPoint);this.update();return!0}xwa(N){this.control.$&&M.a().Qf(N);this.ltf()}wwa(N){N.qye&&(this.w6=this.lZg,this.update(),this.control.clientVersion--);this.ltf()}UQj(){this.zzg=this.xK;this.Azg=this.yK}TQj(N,K){this.xK=this.zzg!==N;this.yK=this.Azg!==K;this.l4a()}upgrade(N){if(null===N||void 0===N?0:N.Sb)this.Sb=N.Sb,this.z2a=this.Sb.Rotation,this.yK=this.xK=!1,this.Vfa(0)}l4a(){this.Qke(this.control)}ULa(){this.vf=this.Wg();this.P1b=this.z2a=(this.Sb=this.control.floatingObject.Sb)?
this.Sb.Rotation:0;this.aPa=0;this.xK=this.yK=!1;this.Ep&&this.Ep.splice(0)}update(){if(this.w6){this.iBk(this.w6);const N=this.R6-this.z2a;this.control.extension&&this.control.extension.Vfa(N,!1);this.l4a();this.n3d&&this.n3d(()=>({["floatingObjectType"]:z.a.tC(this.control.floatingObject),["Location"]:"canvas"}))}}Qke(N){if(N.BL){var K=N.Ug.rtl,I=G.HelperMethods.isStandardZoomCssSupportedByBrowser?t.DOMElementExtensions.getBoundingClientRect({element:N.Tj.parentNode,di:!0}):Sys.UI.DomElement.getBounds(N.Tj.parentNode),
L=this.R6,J=z.a.p8(this.z2a,this.Sb?this.Sb.FlipX!==this.Sb.FlipY:!1);if(J){var B=K?e.jCd+I.width:-e.jCd;var Y=I.height/2;L+=90}else B=I.width/2,Y=-e.jCd;this.ZLc=(J?this.xK:this.yK)!==(this.Sb?this.Sb.FlipY:!1)?180:0;d.a(N.BL.qO,this.R6+this.ZLc);(L+=this.ZLc)?(I=new Sys.UI.Point(I.width/2,I.height/2),B=new Sys.UI.Point(B,Y),L=d.c(L),d.j(N.BL.qO,B,I,L,K)):t.DOMElementExtensions.updatePosition(N.BL.qO,B,Y,!0,K)}}Vue(N){const K=this.control.extension;K&&(K.jPc(),K.VK&&K.VK.p4b(),c.ULS.sendTraceTag(537162306,
5,50,`ImageRotatableBehavior:OnDragStart: Image-Updated=${0<K.FLa||0<K.FJa||0<K.Lxa?"false":"true"} ResizeOperationsSinceLastLoad=${K.FLa} MoveOperationsSinceLastLoad=${K.FJa} RotateOperationsSinceLastLoad=${K.Lxa}`));this.raiseEvent("RotateStarted",null);this.control.clientVersion++;this.ZP.Ea("keydown",this.m9d);this.lZg=this.hA(N.clientPoint);this.vf=this.Wg();this.TTa=!1;this.D4a=!0}hA(N){return this.viewBlockContainerHelpers.hA(this.control.Ug,N,this.control.Ug.rtl)}Wg(){return this.viewBlockContainerHelpers.Dca(this.control.Ug,
this.control.domElement)}BJi(N,K,I){I=(I?-1:1)*(N.x-K.x);if(N=K.y-N.y)K=f.a.jik(Math.atan(I/N));else if(0<I)K=90;else if(0>I)K=-90;else return this.vX;0>N&&(K+=180);return K-=this.ZLc}pHh(){d.m(this.control.cx,0,0,this.Ep)}iBk(N){if(this.control.cx){var K=this.control.Ug.rtl,I=new Sys.UI.Point(this.vf.x+this.vf.width/2,this.vf.y+this.vf.height/2);this.aPa=this.BJi(N,I,K);this.aPa=this.vX-this.P1b;this.TTa&&(N=this.R6%15,0>N&&(N+=15),this.aPa=this.vX-N);N=new Sys.UI.Point(this.vf.x+(K?-1:1)*this.vf.width/
2,this.vf.y+this.vf.height/2);K=new Sys.UI.Point(this.vf.x+this.z0b-(K?this.vf.width:0),this.vf.y+this.A0b);this.translateX=N.x-K.x;this.translateY=N.y-K.y;this.Sb&&this.Sb.IsShapeGC2ModelRendered?this.control.extension.updateTransformDuringOperation(null,null,!1,!1,this.Sb.Rotation+this.R6-this.z2a):(this.Ep.push(new w.a(1,1,this.translateX,this.translateY,this.vX,!0)),this.pHh(),this.Ep.pop())}}ltf(){this.w6=null;this.control.ova()&&this.Ep.push(new w.a(1,1,this.translateX,this.translateY,this.vX,
!0));this.P1b=this.R6;this.aPa=0;this.D4a=this.TTa=!1;this.ZP.XH();this.control.extension.Hpb(this.R6)}}Object(y.a)(A,"ImageRotatableBehavior",r.a,[762,109])},1463:function(y,r,a){a.d(r,"a",function(){return E});y=a(0);var c=a(91);r=a(105);var b=a(1033),f=a(1067),k=a(1129),x=a(1068),d=a(1053),h=a(1003),n=a(1128),m=a(57),u=a(53),l=a(119),t=a(433);class e extends Sys.EventArgs{constructor(M,G,A,N,K,I){super();this.Bed=M;this.gld=G;this.pid=A;this.Q7c=N;this.cld=K;this.dld=I}get qnb(){return this.Bed}get bwb(){return this.gld}get $sb(){return this.pid}get mdb(){return this.Q7c}get txe(){return this.cld}get uxe(){return this.dld}}
Object(y.a)(e,"MoveEventArgs",Sys.EventArgs,[]);var w=a(17),z=a(12);class E extends r.a{constructor(M,G,A,N,K){super(M);this.tTe=0;this.hjd=this.gle=this.Sle=null;this.Ycd=this.ndd=!1;this.Sb=this.Dh=this.jo=this.vf=null;this.DZg=this.vX=0;this.da=G;this.pD=A;this.hbb=N;this.Ep=K;this.BN=!!this.control.floatingObject&&5===this.control.floatingObject.type&&l.a.BN(this.control.floatingObject.Sb);this.ULa()}BEh(M){this.addHandler("KeyboardAdjustFinished",M)}utk(M){this.removeHandler("KeyboardAdjustFinished",
M)}zod(M){this.addHandler("KeyboardResize",M)}Lie(M){this.removeHandler("KeyboardResize",M)}AEh(M){this.addHandler("KeyboardAdjust",M)}ttk(M){this.removeHandler("KeyboardAdjust",M)}DEh(M){this.addHandler("KeyboardRotate",M)}wtk(M){this.removeHandler("KeyboardRotate",M)}get Bva(){return this.C_a||this.m_a}get C_a(){return this.ndd}get m_a(){return this.Ycd}get control(){return this.pD}get viewBlockContainerHelpers(){return this.hbb}get B7d(){return this.tTe}set B7d(M){this.tTe=h.i(M,this.Sb?this.Sb.FlipX!==
this.Sb.FlipY:!1)}get boe(){return this.hjd||(this.hjd=m.a.instance.create(()=>{this.rOc(!1)},1E3,u.a.$dj,!1))}get absoluteRotation(){return this.B7d+this.vX}get A0b(){return this.control.cx.offsetTop}get z0b(){return this.control.cx.offsetLeft}dispose(){c.a.vb(this.hjd);this.da=null;super.dispose()}P7d(M){this.mXc(!1);let G=0,A=0;switch(M){case 2:A=-1;break;case 3:A=1;break;case 0:G=this.da.rtl?1:-1;break;case 1:G=this.da.rtl?-1:1}b.a(this.jo,G,A);this.update();this.raiseEvent("KeyboardAdjust",new e(G,
A,G,A,!1,!1));this.boe.Cv()}rotate(M){if(!this.control.extension.cxb||this.Bva)this.mXc(!0),this.control.extension.Vfa(l.a.MJa(this.vX+15*(M?-1:1)),!0),this.update(),this.raiseEvent("KeyboardRotate",null),this.boe.Cv()}resize(M,G,A,N){if(!this.control.extension.cxb||this.Bva){this.mXc(!1);var K=!1;this.Sb&&(K=l.a.p8(this.Sb.Rotation,this.Sb.FlipX!==this.Sb.FlipY));if(M&1&&!K||M&2&&K)N=E.qJf(this.jo.width,d.a.minWidth,N),this.jo.topLeft.x-=N,this.jo.bottomRight.x+=N;if(M&1&&K||M&2&&!K)M=E.qJf(this.jo.height,
d.a.minHeight,A),this.jo.topLeft.y-=M,this.jo.bottomRight.y+=M;this.update();this.raiseEvent("KeyboardResize",new x.a(this.jo.width,this.jo.height,!1,!1));G||this.boe.Cv()}}update(){const {FloatingObjectControlExtension:M}=a(983);if(this.jo){const G=this.jo,A=G.topLeft,N=this.Dh.Nn;b.a(G,A.x<-N.x?N.x-A.x:0,A.y<-N.y?N.y-A.y:0);this.Dh=M.Bpd(G,this.vf,this.Dh,this.control,!1);this.viewBlockContainerHelpers.WQg(this.Dh,this.control.domElement,G,!1);this.control.Taa()&&this.Jna(G,this.control)}}ULa(){this.Dh=
this.control.Ug;this.vX=0;this.Ep&&this.Ep.splice(0)}p4b(M=!1){this.Bva&&this.rOc(M);this.jo=null}upgrade(M){if(null===M||void 0===M?0:M.Sb)this.Sb=M.Sb,this.B7d=this.Sb.Rotation,this.vX=0}Vfa(M){this.vX=M}mXc(M){this.Bva||(this.vf=this.viewBlockContainerHelpers.Dca(this.Dh,this.control.domElement),this.jo=this.vf.clone());(M&&!this.C_a||!M&&!this.m_a)&&this.Syg(M)}Syg(M){M?(this.ndd=!0,this.DZg=this.absoluteRotation):this.Ycd=!0;this.Dh=this.control.Ug;this.control.clientVersion++;t.c(this.control.$,
!1,"ImageKeyboardAdjustBehavior:PrepareForKeyboardOperation")}rOc(M){this.Bva&&(this.C_a&&(this.ndd=!1,this.t1h()),this.m_a&&(this.Ycd=!1,this.r1h(M)),t.c(this.control.$,!0,"ImageKeyboardAdjustBehavior:OnKeyboardOperationTimerFinish"))}Jna(M,G){G.cx&&(this.Sb&&this.Sb.IsShapeGC2ModelRendered?(this.C_a&&this.control.extension.updateTransformDuringOperation(null,null,!1,!1,this.Sb.Rotation+l.a.MJa(this.vX)),this.m_a&&(l.a.p8(this.Sb.Rotation,this.Sb.FlipX!==this.Sb.FlipY)?this.control.extension.updateTransformDuringOperation(M.height,
M.width,!1,!1,null):this.control.extension.updateTransformDuringOperation(M.width,M.height,!1,!1,null))):(this.C_a&&this.hCh(),this.m_a&&this.gCh(M),this.rKh(),this.m_a&&(this.Sb&&this.Sb.IsShapeGC2ModelRendered||this.Ep.pop()),this.C_a&&this.Ep.pop()),M=h.c(this.absoluteRotation),h.l(z.HelperMethods.isStandardZoomCssSupportedByBrowser?w.DOMElementExtensions.getBoundingClientRect({element:G.Tj.parentNode,di:!0}):Sys.UI.DomElement.getBounds(G.Tj.parentNode),G.RI,M,G.Ug.rtl))}gCh(M){let G,A;this.BN?
(G=this.vf.width?M.width/this.vf.width:1,A=this.vf.height?M.height/this.vf.height:1):(G=M.width/(this.vf.width?this.vf.width:1),A=M.height/(this.vf.height?this.vf.height:1));this.gle=this.POf(M,G,A,this.absoluteRotation,!1);this.Ep.push(this.gle)}hCh(){this.Sle=this.POf(this.vf,1,1,this.absoluteRotation-this.DZg,!0);this.Ep.push(this.Sle)}POf(M,G,A,N,K){var I=this.Dh.rtl;const L=new Sys.UI.Point(this.vf.x+this.z0b-(I?M.width:0),this.vf.y+this.A0b),J=new Sys.UI.Point(this.vf.x-(I?M.width:0)+this.vf.width/
2,this.vf.y+this.vf.height/2),B=h.g(J,L,this.absoluteRotation,G,A);K?(I=J.x-L.x,M=J.y-L.y):(I=J.x-B.x+(M.width-this.vf.width)/2,M=J.y-B.y+(M.height-this.vf.height)/2);return new n.a(G,A,I,M,N,K)}rKh(){h.m(this.control.cx,0,0,this.Ep)}t1h(){this.control.ova()&&this.Ep.push(this.Sle);this.control.extension.Hpb(this.Sb.Rotation+this.vX)}r1h(M){this.control.Taa()&&this.Ep.push(this.gle);var G=this.vf;let A=this.jo;this.Sb&&l.a.p8(this.absoluteRotation,this.Sb.FlipX!==this.Sb.FlipY)&&(G=this.vf.XNb(),
A=this.jo.XNb());const N=A.topLeft.x-G.topLeft.x,K=A.bottomRight.x-G.bottomRight.x,I=A.topLeft.y-G.topLeft.y;G=A.bottomRight.y-G.bottomRight.y;this.Sb&&l.a.BN(this.Sb)?this.raiseEvent("KeyboardAdjustFinished",new k.a(N,I,K,G,!1,!1,this.Dh,100,null,-1,2)):this.raiseEvent("KeyboardAdjustFinished",new f.a(N,I,K,G,!1,!1,this.Dh,M))}static qJf(M,G,A){A=Math.round(M*A);A=Math.max(A,G);return Math.round((A-M)/2)}}Object(y.a)(E,"ImageKeyboardAdjustBehavior",r.a,[765])},1467:function(y,r,a){a.d(r,"a",function(){return E});
y=a(0);var c=a(15),b=a(363),f=a(154),k=a(211),x=a(1275),d=a(1070),h=a(429),n=a(213),m=a(947),u=a(1131),l=a(99),t=a(621);class e{constructor(M,G,A,N){this.srcRect=this.positionTransform=this.dimension=this.id=null;this.id=M;this.dimension=G;this.positionTransform=A;this.srcRect=N}getId(){return this.id}getDimension(){return this.dimension}getPositionTransform(){return this.positionTransform}getSrcRect(){return this.srcRect}}Object(y.a)(e,"MacroRecorderPictureCropPayload",null,[67]);var w=a(1032),z=
a(1);class E{constructor(M){this.$=M}executeAction(M){switch(M.getType()){case 0:this.setShapeText(M);break;case 1:t.a(this.$).deleteInkStrokes(M);break;case 2:this.beginCropPreview(M);break;case 3:this.performCrop(M);break;default:throw Error.invalidOperation("Unknown GC2 action");}}setShapeText(M){let G;G=M.getShapeTextFormat()?()=>new d.a(M.getShapeTextFormat(),M.getId()):()=>new x.a(M.getId(),M.getTextContent());const A=this.$.ma.sa;let N=null;if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:8753559_CallFOManagerHelperFunction"))var K=
l.a(this.$).zLd(5,M.getId());else K=k.a.MA(5,M.getId()),K=l.a(this.$).fr(K);if(K){let I=K.floatingObject;Object(b.a)(m.a,K)&&(I=Object(f.a)(m.a,K).Qd.floatingObject);N=(L,J,B)=>u.d(A,M.getId(),M.getText(),M.getResizeNeeded(),I.Lu,I.Wv,I.OW,I.c0,L,J,B,null)}h.a(this.$.userOperationManager,N,I=>new n.a(581,0,I,void 0,G),null)}beginCropPreview(M){try{const G=l.a(this.$).zLd(1,M.getId());G?(G.extension.Lud(!0),z.EwaSettings.isChangeGateEnabled("OfficeVSO:8861794_DisablePlaceInCellWhenInCropMode")&&G.uBg(),
G.extension.NBd(),window.requestAnimationFrame(()=>{G.extension.KJk()})):c.ULS.sendTraceTag(507363535,5,15,`GC2ActionHandler.beginCropPreview: No floating object found with id ${null===M||void 0===M?void 0:M.getId()} while handling BeginCropPreviewHostAction.`)}catch(G){c.ULS.sendTraceTag(507363534,5,10,`GC2ActionHandler.beginCropPreview: Something went wrong while handling BeginCropPreviewHostAction. Floating Object Id: ${null===M||void 0===M?void 0:M.getId()}, Exception: ${G}`)}}performCrop(M){try{const L=
l.a(this.$).zLd(1,M.getId());if(L)if(L.extension.Lud(!1),window.requestAnimationFrame(()=>{L.extension.uyk()}),isNullOrUndefined(M.getDimension())||isNullOrUndefined(M.getPositionTransform())||isNullOrUndefined(M.getSrcRect()))c.ULS.sendTraceTag(507347994,5,15,`GC2ActionHandler.performCrop: Crop parameters are null or undefined for floating object with id ${null===M||void 0===M?void 0:M.getId()}. Dropping crop operation.`);else{var G={};G.Height=M.getDimension().height;G.Width=M.getDimension().width;
var A={};A.X=M.getPositionTransform().x;A.Y=M.getPositionTransform().y;var N={};N.Top=M.getSrcRect().top;N.Bottom=M.getSrcRect().bottom;N.Left=M.getSrcRect().left;N.Right=M.getSrcRect().right;L.da.ha.ob.WH(L);L.extension.smd();var K=()=>new e(L.floatingObject.id,G,A,N),I=this.$.ma.sa;h.a(this.$.userOperationManager,(J,B,Y)=>w.b(I,L.floatingObject.id,G,A,N,J,B,Y,null),J=>new n.a(1044,0,J,void 0,K),null)}else c.ULS.sendTraceTag(507377291,5,15,`GC2ActionHandler.performCrop: No floating object found with id ${null===
M||void 0===M?void 0:M.getId()} while handling PerformCropHostAction. Dropping crop operation.`)}catch(L){c.ULS.sendTraceTag(507379860,5,10,`GC2ActionHandler.performCrop: Something went wrong while handling PerformCropHostAction. Floating Object Id: ${null===M||void 0===M?void 0:M.getId()}, Exception: ${L}`)}}static Bgb(M){if(E.instance)return E.instance;E.instance=new E(M);return E.instance}}E.instance=null;Object(y.a)(E,"GC2ActionHandler",null,[779])},1501:function(y,r,a){a.r(r);a.d(r,"ChartAboveGridFloatingObjectControl",
function(){return h});y=a(0);r=a(1094);var c=a(31),b=a(49),f=a(74),k=a(1132),x=a(17),d=a(119);class h extends r.ChartFloatingObjectControl{constructor(n,m,u,l,t){super(n,m,l,t,d.a.u6d,!1);this.Sca=this.pY=null;this.fH=n.Wf;this.sN=null;this.gCb=u;this.cJ(m);this.cW(c.a.QVa,!0);this.isVisible=!1}get grid(){return this.fH}get Z1(){if(f.b(this.$.la))return this.pY||(this.pY=new b.a(this.da.nn,this.da.uz)),this.pY;this.Sca||(this.Sca=new b.a(this.da.nn,this.da.uz));return this.Sca}get ic(){return this.gCb}get Ug(){this.sN||
(this.sN=x.DOMElementExtensions.getLocation({element:this.grid}));const n=x.DOMElementExtensions.getLocation({element:this.get_element()});return k.a(this,new b.a(n.x-this.sN.x,n.y-this.sN.y))}dispose(){this.sN=this.fH=null;super.dispose()}STd(n){k.b(this,n)}hide(){this.isVisible=!1}V5b(n,m){k.c(this,n,m)}J8b(){return!1}c7b(){return!1}Pke(){f.b(this.$.la)&&(this.pY=null)}}Object(y.a)(h,"ChartAboveGridFloatingObjectControl",r.ChartFloatingObjectControl,[703,314,4,704])},1502:function(y,r,a){a.r(r);
a.d(r,"GC2AboveGridFloatingObjectControl",function(){return h});y=a(0);r=a(1015);var c=a(31),b=a(49),f=a(74),k=a(1132),x=a(17),d=a(119);class h extends r.GC2FloatingObjectControl{constructor(n,m,u,l){super(n,m,l,d.a.u6d,!1);this.Sca=this.pY=null;this.fH=n.Wf;this.sN=null;this.gCb=u;this.cJ(m);this.cW(c.a.QVa,!0);this.isVisible=!1}get grid(){return this.fH}get Z1(){if(f.b(this.$.la))return this.pY||(this.pY=new b.a(this.da.nn,this.da.uz)),this.pY;this.Sca||(this.Sca=new b.a(this.da.nn,this.da.uz));
return this.Sca}get ic(){return this.gCb}get Ug(){this.sN||(this.sN=x.DOMElementExtensions.getLocation({element:this.grid}));const n=x.DOMElementExtensions.getLocation({element:this.get_element()});return k.a(this,new b.a(n.x-this.sN.x,n.y-this.sN.y))}dispose(){this.sN=this.fH=null;super.dispose()}STd(n){k.b(this,n)}V5b(n,m){k.c(this,n,m)}hide(){this.isVisible=!1}Pke(){f.b(this.$.la)&&(this.pY=null)}J8b(){return!1}c7b(){return!1}tNd(){return"@G"}onAutoFitResize(n,m){d.a.p8(this.floatingObject.Sb.Rotation,
!1)?this.ic.extension.ync(n,m):this.ic.extension.ync(m,n)}onEditStatusChanged(n){n||this.ic.extension.VK.p4b(!0);super.onEditStatusChanged(n)}}Object(y.a)(h,"GC2AboveGridFloatingObjectControl",r.GC2FloatingObjectControl,[703,314,4,704])},1503:function(y,r,a){r=a(490);a=a(1504);a=a.Di?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);r(a,{insert:"head",Oj:!1});y.exports=a.Fk||{}},1504:function(y,r,a){r=a(489)(!1);r.push([y.i,".ewa-root-rtl .ewa-fo-img-div{direction:rtl}",""]);y.exports=r},1619:function(y,
r,a){a.r(r);a.d(r,"MultiPanesFloatingObjectControlExtension",function(){return M});y=a(0);var c=a(15),b=a(154),f=a(983),k=a(72),x=a(49),d=a(944),h=a(947),n=a(1434),m=a(1272);class u extends m.a{constructor(G,A){super(G,A);this.UU=(N,K)=>{K.KP.$Jb(this.floatingObject)};this.control=G;this.floatingObject=A;for(const N of this.ic.children)N.$Jb(A);this.ic.xFb(this.UU)}get ic(){return Object(b.a)(h.a,this.control)}dispose(){for(const G of this.ic.children)G.cuc();this.ic.oie(this.UU);super.dispose()}update(G){for(const A of this.ic.children)m.a.a8g(A,
G)}}Object(y.a)(u,"MultiPanesImageConnectableManager",m.a,[]);var l=a(1053);class t extends l.a{constructor(G,A,N,K,I,L=null,J=null){super(G,A,N,K,I,L,J)}get ic(){return Object(b.a)(h.a,this.control)}dispose(){super.dispose()}s6a(G,A){this.X3||(this.Dh=this.ic.Ug,this.vf=this.Wg(),this.ic.HMa(this.vf),this.Fpe(G,A),this.Afa=this.aPb(G),this.raiseEvent(l.a.r4b),this.resize(G,!0))}resize(G,A){this.w6=G;G=this.aPb(G);G=d.a.OL(G,this.Afa);this.Apd(G);const N=this.ic.Qd;this.ele(A,G.x,G.y,N.Z1.x,N.Z1.y,
!1)}gca(){this.Dh=this.ic.Qd.Ug;super.gca()}Xpe(G){this.ic.Qd.V5b(G,!1)}Wg(){const G=d.a.BK(new x.a(0,0),this.ic.Qd.grid,this.ic.domElement,this.da.rtl);return new k.a(G.x,G.y,this.ic.domElement.clientWidth,this.ic.domElement.clientHeight)}W3(G){const A=this.ic.Qd;if(null===A||void 0===A?0:A.isVisible)this.m4a(A,G);else for(const N of this.ic.children)this.m4a(N,G)}aPb(G){return d.a.hA(new x.a(0,0),this.ic.Qd.grid,G,this.Dh.rtl)}}Object(y.a)(t,"MultiPanesImageResizableBehavior",l.a,[]);r=a(1462);
var e=a(435);class w extends r.a{constructor(G,A,N,K){super(G,A,N,K)}get ic(){return Object(b.a)(h.a,this.control)}l4a(){const G=this.ic.Qd;if(null===G||void 0===G?0:G.isVisible)this.Qke(G);else for(const A of this.ic.children)this.Qke(A)}Vue(G){super.Vue(G);this.ic.HMa(this.xIi());this.ic.yza(!1)}xIi(){const G=this.ic.Qd,A=this.viewBlockContainerHelpers.Dca(this.ic.Ug,this.ic.domElement),N=e.a.pN(this.ic.Ug.paneType,this.ic.Ug.view.Ci);return new k.a(A.x-N.x+this.ic.Ug.Nn.x+G.Z1.x,A.y-N.y+this.ic.Ug.Nn.y+
G.Z1.y,A.width,A.height)}}Object(y.a)(w,"MultiPanesImageRotatableBehavior",r.a,[]);var z=a(36),E=a(45);class M extends f.FloatingObjectControlExtension{constructor(G,A){super(G,A);this.UU=(N,K)=>{n.h(this,K)};this.e_b=(N,K)=>{n.i(this,K)};n.g(this.ic,this.UU,this.e_b)}get ic(){return Object(b.a)(h.a,this.control)}dispose(){n.f(this.ic,this.UU,this.e_b);super.dispose()}Hpb(G){super.Hpb(G);this.TLg(G)&&(this.ic.isVisible=!0,this.aKg())}startEdit(){const G=d.a.BK(new x.a(0,0),this.ic.Qd.grid,this.ic.domElement,
this.ic.da.rtl);this.ic.HMa(new k.a(G.x,G.y,this.ic.domElement.clientWidth,this.ic.domElement.clientHeight));this.ic.Qd.startEdit()}endEdit(){this.ic.Qd.endEdit()}Lud(G){this.ic.Qd.onEditStatusChanged(G)}bua(G,A){const N=d.a.BK(new x.a(0,0),this.ic.Qd.grid,this.ic.domElement,this.ic.da.rtl);this.ic.HMa(new k.a(N.x,N.y,this.ic.domElement.clientWidth,this.ic.domElement.clientHeight));this.ic.Qd.handleCommand(G,A)}dCc(G,A){if(this.control.floatingObject.KQ){const N=d.a.BK(new x.a(0,0),this.ic.Qd.grid,
this.ic.domElement,this.ic.da.rtl);this.ic.HMa(new k.a(N.x,N.y,this.ic.domElement.clientWidth,this.ic.domElement.clientHeight));this.ic.Qd.handleCommand(G,A)}else c.ULS.sendTraceTag(507527238,306,15,"FloatingObjectControlExtension: Not a GC2 FOC = {0}",this.control.floatingObject.Ec),G=z.a.Cd(1,0,2561,2562,0,382441300,"ImageEditingUnsupported"),E.a(this.control.$).Wi(G)}handleQueryCommand(G,A){this.ic.Qd.handleQueryCommand(G,A)}updateTransformDuringOperation(G,A,N,K,I){this.ic.Qd.updateTransformDuringOperation(G,
A,N,K,I)}updateTransformResizeEnded(G,A){this.ic.Qd.updateTransformResizeEnded(G,A)}shouldShowFloatie(G,A){return this.ic.Qd.shouldShowFloatie(G,A)}NBd(){super.NBd()}smd(){super.smd()}yzd(){n.d(this,this.ic)}Kyd(){n.a(this,this.ic)}dzd(){n.c(this,this.ic)}CUa(){this.ic.movable&&(this.tk=new t(this.ic.domElement,this.ic.da,this.ic,this.Ep,f.FloatingObjectControlExtension.dT,f.FloatingObjectControlExtension.viewBlockContainerHelpers),this.eTc())}vzd(){this.HVb()&&(this.Uo=new w(this.ic.domElement,this.ic,
this.Ep,f.FloatingObjectControlExtension.viewBlockContainerHelpers))}bzd(){n.b(this)}Czd(){n.e(this)}Hyd(G){this.Ieb=new u(this.ic,G)}o$d(){n.j(this.ic)}J_b(G,A){super.J_b(G,A);n.k(this,this.ic,A)}Rfa(){n.l(this,this.ic)}rHd(){}}Object(y.a)(M,"MultiPanesFloatingObjectControlExtension",f.FloatingObjectControlExtension,[])},1626:function(y,r,a){a.r(r);a.d(r,"MultiPanesConnectorFloatingObjectControlExtension",function(){return w});y=a(0);var c=a(154);r=a(1279);var b=a(983),f=a(1280),k=a(31),x=a(72),
d=a(49),h=a(944),n=a(1053),m=a(947),u=a(17),l=a(12);class t extends f.a{constructor(z,E,M,G,A,N,K=null,I=null){super(z,E,M,G,A,N,K,I)}get Tj(){const z=this.ic.Qd;return z?z.Tj:null}get control(){const z=this.ic.Qd;return(null===z||void 0===z?0:z.isVisible)?z:this.ic}get ic(){return Object(c.a)(m.a,super.control)}dispose(){super.dispose()}s6a(z,E){this.X3||(this.W3(null),this.Dh=this.ic.Ug,this.vf=this.Wg(),this.ic.HMa(this.vf),this.PUa=this.ic.Qd.RI.find(M=>M.index===this.PUa.index),this.nja=this.jVc()?
this.Cra:this.ria,this.VNb=l.HelperMethods.isStandardZoomCssSupportedByBrowser?u.DOMElementExtensions.getBoundingClientRect({element:this.nja.domElement,di:!0}):Sys.UI.DomElement.getBounds(this.nja.domElement),this.Fpe(z,E),this.Afa=this.aPb(z),this.raiseEvent(n.a.r4b),this.resize(z,!0),this.Lyd(),this.qfb=this.ic.cx,u.DOMElementExtensions.setVisible(this.qfb,!1),u.DOMElementExtensions.setVisible(this.Tj,!0),u.DOMElementExtensions.$ya(this.$ta,!0,k.a.uEd,k.a.Bvc))}resize(z,E){this.w6=z;this.zB=this.aPb(z);
const M=h.a.OL(this.zB,this.Afa);this.Apd(M);const G=this.ic.Qd;this.zB=h.a.OL(this.zB,G.Z1);const A=this.da.pg(this.da.rb.yXi(this.zB));this.zB=this.viewBlockContainerHelpers.hA(A,z,!1);this.zB=h.a.add(this.zB,A.Nn);this.zB.x=Math.max(this.zB.x,0);this.zB.y=Math.max(this.zB.y,0);this.ele(E,M.x,M.y,G.Z1.x,G.Z1.y,!1);this.fca&&!this.WHc&&this.z8g()}gca(){this.Dh=this.ic.Qd.Ug;super.gca()}Xpe(z){this.ic.Qd.V5b(z,!1)}Wg(){const z=h.a.BK(new d.a(0,0),this.ic.Qd.grid,this.ic.domElement,this.da.rtl);return new x.a(z.x,
z.y,this.ic.domElement.clientWidth,this.ic.domElement.clientHeight)}W3(z){this.mvd();const E=this.ic.Qd;E&&this.m4a(E,z);for(const M of this.ic.children)this.m4a(M,z)}f1(){this.ic.f1(this)}aPb(z){return h.a.hA(new d.a(0,0),this.ic.Qd.grid,z,this.Dh.rtl)}set Tj(z){super.Tj=z}set control(z){super.control=z}}Object(y.a)(t,"MultiPanesConnectorResizableBehavior",f.a,[]);var e=a(1434);class w extends r.ConnectorFloatingObjectControlExtension{constructor(z,E){super(z,E);this.UU=(M,G)=>{e.h(this,G)};this.e_b=
(M,G)=>{e.i(this,G)};e.g(this.ic,this.UU,this.e_b)}get ic(){return Object(c.a)(m.a,this.control)}dispose(){e.f(this.ic,this.UU,this.e_b);super.dispose()}yzd(){e.d(this,this.ic)}Kyd(){e.a(this,this.ic)}dzd(){e.c(this,this.ic)}CUa(){this.ic.movable&&(this.tk=new t(this.ic.domElement,null,this.ic.da,this.ic,this.Ep,b.FloatingObjectControlExtension.dT,b.FloatingObjectControlExtension.viewBlockContainerHelpers),this.eTc())}vzd(){}bzd(){e.b(this)}Czd(){e.e(this)}o$d(){e.j(this.ic)}J_b(z,E){super.J_b(z,
E);e.k(this,this.ic,E)}Rfa(){e.l(this,this.ic)}rHd(){}}Object(y.a)(w,"MultiPanesConnectorFloatingObjectControlExtension",r.ConnectorFloatingObjectControlExtension,[])},336:function(y,r,a){a.r(r);var c={};a.r(c);a.d(c,"MOEFloatingObjectCommandHandler",function(){return E});var b={};a.r(b);a.d(b,"BehaviorsFactory",function(){return wa});var f={};a.r(f);a.d(f,"ChartElementSelectableBehaviorManager",function(){return Mb});var k={};a.r(k);a.d(k,"FloatingObjectCommandHandler",function(){return Ob});var x=
{};a.r(x);a.d(x,"InkOverlay",function(){return Fc});var d={};a.r(d);a.d(d,"InkCommandHandler",function(){return xd});var h={};a.r(h);a.d(h,"LoadBlockingFloatingObjectsCommandHandler",function(){return bd});var n={};a.r(n);a.d(n,"LoadBlockingFloatingObjectsTaskPane",function(){return Rc});var m=a(133),u=a(0),l=a(209),t=a(25),e=a(67),w=a(5),z=a(65);let E=class{constructor(sb){this.$=sb}gd(){return!1}executeCommand(sb,Gc){Gc=Gc.command;if(16!==sb)return l.a(Gc);sb=t.f(this.$).ha.ob.Wb;switch(Gc){case 1872288872:return e.Task.Va(sb.z_c());
case 267796030:return e.Task.Va(sb.startEdit());default:return l.a(Gc)}}Rc(sb,Gc){return 16===sb&&(267796030===Gc.command||1872288872===Gc.command)}td(){return!1}};E=Object(m.__decorate)([Object(z.d)(w.AgaveA11yCommandHandlerService),Object(m.__param)(0,Object(w.EwaControlService)())],E);Object(u.a)(E,"MOEFloatingObjectCommandHandler",null,[29]);var M=a(105);class G extends M.a{constructor(sb){super(document.createElement("div"));this.GLa=sb}}Object(u.a)(G,"ResizePointBehaviorBase",M.a,[744,147,4]);
class A extends G{constructor(sb,Gc,ad){super(sb);this.Yj=Gc;this.domElement.style.position="absolute";sb=document.createElementNS("http://www.w3.org/2000/svg","svg");sb.setAttribute("xmlns","http://www.w3.org/2000/svg");sb.setAttribute("version","1.1");sb.setAttribute("overflow","visible");sb.setAttribute("width","12");sb.setAttribute("height","12");Gc=document.createElementNS("http://www.w3.org/2000/svg","circle");Gc.setAttribute("style","pointer-events: all; cursor: crosshair;");Gc.setAttribute("r",
"4");Gc.setAttribute("stroke-width","1");Gc.setAttribute("id","svgCircleId");sb.appendChild(Gc);this.domElement.appendChild(sb);this.xef=this.getElementById("svgCircleId");this.$5b(ad)}get index(){return this.Yj}$5b(sb){const Gc=sb?"green":"white";this.xef.setAttribute("stroke",sb?"white":"grey");this.xef.setAttribute("fill",Gc)}}Object(u.a)(A,"ConnectorResizePointBehavior",G,[747,744,147,4]);var N=a(94),K=a(393),I=a(155),L=a(16),J=a(31),B=a(72),Y=a(49),U=a(1130),O=a(64),C=a(20),X=a(1);const S=(sb,
Gc,ad)=>1===ad?sb?J.a.fsi:J.a.esi:(sb?[J.a.Jvf,J.a.Lvf,J.a.Pvf,J.a.Ovf,J.a.Mvf,J.a.Nvf,J.a.Ivf,J.a.Kvf]:[J.a.Jvf,J.a.Kvf,J.a.Ivf,J.a.Nvf,J.a.Mvf,J.a.Ovf,J.a.Pvf,J.a.Lvf])[Gc],ea=C.a.gNb,Oa=C.a.CZh,Ha=C.a.Oti,Za=C.a.BZh,fa=C.a.yti;class la extends G{constructor(sb,Gc,ad,Wd){super(Gc);let je;const Ie=X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FOResizeHandlesFix",!1);if(Ie||U.a(Gc)||ad){var Je=Oa;je=1===Wd?fa:ea}else Je=Za,je=Ha;sb=S(sb,Gc,Wd);this.domElement.className=Ie?`${J.a.rri} ${sb} ${Je}`:
`${ad?J.a.sri:sb} ${Je}`;ad=O.a.Lh(1);Je=document.createElement("img");Je.classList.add(je);Je.src=ad;Je.draggable=!1;this.domElement.appendChild(Je)}}Object(u.a)(la,"ResizePointBehavior",G,[]);var ba=a(17);const aa=J.a.xsi,oa=J.a.ysi;class Na extends G{constructor(sb,Gc,ad,Wd){super(ad);this.domElement.className=aa;ba.DOMElementExtensions.$ya(this.domElement,Wd,J.a.tri,S(Gc,ad,0));this.domElement.classList.add(Gc&&!Wd?J.a.Asi:J.a.zsi);Gc=this.domElement.appendChild(document.createElement("div"));
Gc.className=oa;Gc.style.borderColor=sb;if(U.a(ad)||Wd)Gc.style.borderRadius="50%"}}Object(u.a)(Na,"TouchResizePointBehavior",G,[]);var Ia=a(70),Sa=a(944),Pa=a(1068);class za extends M.a{constructor(sb,Gc,ad){super(sb);this.cle=this.X3=!1;this.zWe=this.zB=this.Afa=this.vf=null;this.onKeyDown=Wd=>Wd.Ha.shiftKey&&Wd.Ha.keyCode>=N.a.RNa&&Wd.Ha.keyCode<=N.a.Gza?(this.cAj(Wd),!0):!1;this.da=Gc;this.domElement.classList.add(J.a.vFa);this.tzd(ad);this.o9e()}get fle(){return this.zWe}dispose(){this.da=null;
this.cle&&(K.a.instance.Rfa(this.fle.domElement,this),I.a.instance.Ua(L.a.nd,this.domElement,this.onKeyDown),this.cle=!1);this.domElement.classList.remove(J.a.vFa);super.dispose()}tka(sb){return sb.Dq!==Sys.UI.MouseButton.middleButton}wwa(){this.gca()}xwa(){this.gca()}ywa(sb){this.Lfg(sb.clientPoint);return!0}V1a(sb){if(!this.tka(sb))return!1;this.s6a(sb.clientPoint);return!0}s6a(sb){this.X3||(this.X3=!0,this.vf=this.Wg(),this.Afa=this.$Kf(sb,this.da.rtl),this.Lfg(sb))}gca(){this.X3=!1;this.zB=this.Afa=
this.vf=null}P4e(sb){this.addHandler("ResizeRequestedEvent",sb)}Ytk(sb){this.removeHandler("ResizeRequestedEvent",sb)}Wg(){const sb=new Y.a(0,0);return new B.a(sb.x,sb.y,this.domElement.clientWidth,this.domElement.clientHeight)}$Kf(sb,Gc){const ad=new Y.a(0,0);return Sa.a.hA(ad,this.domElement,sb,Gc)}wJg(sb){this.raiseEvent("ResizeRequestedEvent",new Pa.a(this.vf.width+sb.x,this.vf.height+sb.y,!1,!1))}Lfg(sb){this.zB=this.$Kf(sb,this.da.rtl);sb=Sa.a.OL(this.zB,this.Afa);this.wJg(sb)}cAj(sb){this.vf=
this.Wg();let Gc=0,ad=0;if(!(!sb.Ha.shiftKey||sb.Ha.keyCode<N.a.RNa||sb.Ha.keyCode>N.a.Gza)){if(sb.Ha.keyCode===N.a.Gza)ad+=10;else if(sb.Ha.keyCode===N.a.T7a)ad-=10;else if(!this.da.rtl&&sb.Ha.keyCode===N.a.exb||this.da.rtl&&sb.Ha.keyCode===N.a.RNa)Gc+=10;else if(!this.da.rtl&&sb.Ha.keyCode===N.a.RNa||this.da.rtl&&sb.Ha.keyCode===N.a.exb)Gc-=10;sb=new Y.a(Gc,ad);this.wJg(sb)}}o9e(){this.domElement.appendChild(this.fle.domElement)}tzd(sb){this.zWe=this.Wrc(3,sb);K.a.instance.x9(this.fle.domElement,
this);I.a.instance.va(L.a.nd,this.domElement,this.onKeyDown);this.cle=!0}Wrc(sb,Gc){const ad=this.da.rtl;return 3===Ia.a.Hb?new Na(this.domElement.style.borderTopColor,ad,sb,!1):new la(ad,sb,!1,Gc)}}Object(u.a)(za,"ResizableBehavior",M.a,[109,745,4]);let wa=class{CUa(sb,Gc,ad){return new za(sb,Gc,ad)}V$h(sb,Gc,ad){return new la(sb,Gc,ad,0)}hbi(sb,Gc,ad,Wd){return new Na(sb,Gc,ad,Wd)}G6h(sb,Gc,ad){return new A(sb,Gc,ad)}};wa=Object(m.__decorate)([Object(z.d)(w.BehaviorsFactoryServiceService)],wa);
Object(u.a)(wa,"BehaviorsFactory",null,[731]);var db=a(1049),Ba=a(1036),Ka=a(15),da=a(6),sa=a(69),mb=a(91),Ma=a(286),hb=a(407),$a=a(309),Va=a(78),xa=a(7),ia=a(709),Z=a(213),ta=a(61),pa=a(83),Ga=a(71),Ca=a(610),kb=a(1035);class eb extends M.a{constructor(sb,Gc,ad,Wd,je,Ie){super(sb);this.id=this.Gdc=this.vpc=this.pv=this.EHa=this.uia=null;this.Uud=this.Vud=this.version=0;this.O8b=this.Aab=this.Usa=this.gPb=null;this.QUa=-1;this.$zd="";this.MIe=null;this.dzb=0;this.Mc=null;this.SYj=Je=>{this.She();
this.MIe=Je.Result;this.aK&&(this.enk(),this.bcl());this.gPb=null};this.TYj=()=>{this.H0e()};this.d_b=Je=>{Je.Dq!==Sys.UI.MouseButton.middleButton&&3!==Je.Yb&&this.selectChartElement(Je.sc);return!1};this.Jj=Je=>{this.Gua&&this.selectChartElement(Je.sc);void z.a.resolve(w.ChartElementManagerService,{xa:0}).then($e=>{$e.wEc(this.Zc,Je.Yb,Je)});return!0};this.Zp=()=>{this.LTb()||this.B2c(null)};this.z_b=Je=>{this.k_b(Je,Sys.EventArgs.Empty);this.EHa&&ba.DOMElementExtensions.setVisible(this.EHa,!1)};
this.k_b=()=>{const Je=this.aAf;Je&&Je.Dy();this.B2c(null)};this.Flg=()=>{this.TSc()};this.Clg=()=>{this.TSc()};this.dZ=Je=>{Ga.g(Je)};this.$U=Je=>{this.fVd(this.Xyc(Je.target))&&(this.domElement.style.cursor="pointer");Ga.g(Je)};this.ZU=Je=>{this.domElement.style.cursor="";Ga.g(Je)};this.Hd=Je=>{let $e=!1;if(2===Je.Yb&&Je.Ha.button===Sys.UI.MouseButton.leftButton||2!==Je.Yb)$e=this.TRc(Je.sc,Je.clientPoint,Je.Yb),this.Gua&&($e=this.selectChartElement(Je.sc)||$e);$e||this.uia||!this.Gua||3!==Je.Yb||
void z.a.resolve(w.ChartElementManagerService,{xa:0}).then(Ib=>{Ib.wEc(this.Zc,Je.Yb,Je)});return $e};this.lWj=Je=>{Ga.g(Je);this.Wzg(Je.target)};this.gkg=Je=>{this.Wzg(Je.sc);return!0};this.$=ad;this.Zc=Wd;this.wIb=Gc;this.Mc=Ie;this.Gua=ad.isEditMode&&X.EwaSettings.Ra(16);if(sb=this.uia=je)sb.Lni(),sb.b7&&(sb.b7.g4e(this.k_b),sb.b7.f4e(this.Flg),sb.b7.e4e(this.Clg)),sb.Isb&&sb.Isb.Xod(this.k_b),sb.VK&&sb.VK.zod(this.z_b);t.f(ad).KJ(this.Zp)}lEh(sb){this.addHandler("ImageElementSelectionChanged",
sb)}ftk(sb){this.removeHandler("ImageElementSelectionChanged",sb)}get aK(){return this.MIe}get dC(){return this.dzb}get Kma(){return this.Aab||(this.Aab=Ba.ChartElementManager.BOi(this.wpc))}set Kma(sb){this.sAe(sb,!0)}get wpc(){return this.aK?this.aK.ChartElementInfoItems:null}get aAf(){return this.Gdc||(this.Gdc=z.a.Cb(w.BIExploreManagerService))}dispose(){if(this.$){var sb=t.f(this.$);(null===sb||void 0===sb?0:sb.ha)&&sb.xL(this.Zp)}this.$=this.Gdc=null;if(sb=this.uia)sb.b7&&(sb.b7.cHg(this.k_b),
sb.b7.bHg(this.Flg),sb.b7.aHg(this.Clg)),sb.Isb&&sb.Isb.EHg(this.k_b),sb.VK&&sb.VK.Lie(this.z_b),this.uia=null;this.She();this.pv=this.EHa=null;this.H0e();this.Mc=null;super.dispose()}Jxk(sb){this.pv=sb.pv;this.id=sb.chartId;this.version=sb.Ldf;this.Vud=sb.qbf.width;this.Uud=sb.qbf.height;this.dzb=0;this.gMa()}uke(sb){this.pv=sb.MUa;this.id=sb.floatingObject.id;this.version=sb.floatingObject.version;this.Vud=sb.floatingObject.width;this.Uud=sb.floatingObject.height;this.dzb=sb.floatingObject.dC;this.gMa()}H0e(){this.gPb&&
(da.AFrameworkApplication.od.dy(this.gPb.sx),this.gPb=null)}Rqk(){this.She()}Hoe(sb){this.Zc=sb}enk(){X.EwaSettings.Ra(16)&&this.Aab&&this.sAe(Ba.ChartElementManager.KGf(Ba.ChartElementManager.fOf(this.Aab),this.wpc),!1)}sAe(sb,Gc){this.Aab!==sb&&(this.Aab=sb,Gc&&this.TSc(),this.$.Sg(),this.raiseEvent("ImageElementSelectionChanged"))}gMa(){const sb=this.$.ma.sa.mc();this.gPb=kb.d(this.$.ma.sa,this.$.Oc,this.id,this.version,this.Vud,this.Uud,this.SYj,this.TYj,null,sb,this.Gua)}bcl(){if(this.pv&&this.pv.parentNode){var sb=
this.EHa;sb||(sb=this.EHa=document.createElement("div"));sb.title=this.pv.title;var Gc=null;this.aK.ContentHTML&&(this.Mc.vl(sb,this.aK.ContentHTML),this.Usa=sa.a.GIf(sb,"map"),(Gc=this.O8b=sa.a.GIf(sb,"svg"))&&this.Usa&&(sb.removeChild(this.Usa),this.Usa=null));mb.a.vb(this.vpc);if(Gc)ba.DOMElementExtensions.Mtb(Gc,new Sys.UI.Bounds(0,0,this.pv.offsetWidth,this.pv.offsetHeight),this.$.isChromeRtl),Ma.a.instance.va(L.a.click,Gc,this.Hd),Ma.a.instance.va(L.a.Gn,Gc,this.gkg),!this.Gua&&this.wIb||hb.a.instance.va(Gc,
this.Jj),this.Gua&&$a.a.instance.va(L.a.Sd,Gc,this.d_b);else{const ad=this.vpc=this.Df.pf(this.Usa);ad.Ea("mousemove",this.dZ);ad.Ea("mouseout",this.ZU);ad.Ea("mouseover",this.$U);ad.Ea("dblclick",this.lWj);Ma.a.instance.va(L.a.click,this.Usa,this.Hd)}this.pv.parentNode.appendChild(sb);this.pv.setAttribute("usemap","#"+this.aK.ImagemapId);this.TSc();this.domElement&&(this.domElement.style.cursor="");!Gc&&this.uia&&this.uia.b7&&this.uia.b7.qzh(sb)}}She(){mb.a.vb(this.vpc);this.vpc=null;this.B2c(null);
if(this.EHa){this.Usa&&(Ma.a.instance.Ua(L.a.click,this.Usa,this.Hd),this.Usa=null);const sb=this.O8b;sb&&(Ma.a.instance.Ua(L.a.click,sb,this.Hd),Ma.a.instance.Ua(L.a.Gn,sb,this.gkg),!this.Gua&&this.wIb||hb.a.instance.Ua(sb,this.Jj),this.Gua&&$a.a.instance.Ua(L.a.Sd,sb,this.d_b),this.O8b=null);ba.DOMElementExtensions.vh(this.EHa);this.EHa=null}}fVd(sb){if(!sb)return!1;switch(sb.Type){case 1:return 260===(this.Zc.Attributes&260)&&-1===sb.SeriesIndex;case 3:return 388===(this.Zc.Attributes&388);default:return!0}}LTb(){return this.wIb?
t.f(this.$).ha.ob.Wb===this.uia.control:!0}TSc(){this.Gua&&this.LTb()&&(this.QUa=Ba.ChartElementManager.aMi(this.Kma,this.aK,this.Zc),this.a7g(-1===this.QUa?"":this.QUa.toString()))}B2c(sb){let Gc=-1,ad="",Wd=!1;sb&&(ad=sb.getAttribute(xa.a.bXh),Gc=parseInt(sb.getAttribute(xa.a.Orf),10));this.QUa!==Gc&&(this.QUa=Gc,Wd=this.a7g(ad),-1!==Gc&&this.sAe(Ba.ChartElementManager.bMi(this.aK.ChartElementItems[Gc],this.Zc,this.wpc),!1));return Wd}a7g(sb){if(!this.O8b||this.$zd===sb)return!1;const Gc=this.O8b.childNodes;
for(let ad=0,Wd=Gc.length;ad<Wd;ad++){const je=Gc[ad],Ie=je.getAttribute("id");Ie===this.$zd?this.S2g(je,!1):Ie===sb&&this.S2g(je,!0)}this.$zd=sb;return!0}S2g(sb,Gc){eb.Z2g(sb,J.a.yri,J.a.zri,Gc);const ad=this.Zc.ChartCategory;(!Gc||-1===this.QUa||3!==this.aK.ChartElementItems[this.QUa].Type||9!==ad&&15!==ad)&&eb.Z2g(sb,J.a.wri,J.a.xri,Gc)}selectChartElement(sb){this.wIb&&!this.LTb()&&t.f(this.$).ha.ob.KZ(this.uia.control);return this.Xyc(sb)?this.B2c(sb):!1}TRc(sb,Gc,ad){sb=this.Xyc(sb);if(!this.fVd(sb))return!1;
const Wd={};Wd.ChartId=this.id;Wd.AnchorValue1=sb.CategoryIndex;Wd.AnchorValue2=sb.SeriesIndex;const je={};let Ie=null;if(sb.CoordList){var Je=Sys.UI.DomElement.getBounds(this.pv);const $e=this.$.isChromeRtl?2:3;Ie=new Sys.UI.Point(sb.CoordList[$e].X+Je.x,sb.CoordList[$e].Y+Je.y)}Je=!1;switch(sb.Type){case 4:Wd.AnchorType=4;Gc=!!(this.Zc.Attributes&128);t.f(this.$).showPivotFilter(this.$.domElement,je,this.Zc.ExternalSourceIndex,sb.ValueString,Gc,!0,null,Wd);Je=!0;break;case 5:case 6:this.$.Zk(je);
Wd.AnchorType=5===sb.Type?5:6;const $e=Ib=>{Ib&&this.QQd(je,Wd,Ie,ad)};void z.a.resolve(w.DataRefreshManagerService,{xa:1}).then(Ib=>{Ib.KH(64===(this.Zc.Attributes&64),$e)});Je=!0;break;case 1:case 3:case 2:this.aAf&&(this.Gdc.Uzg(Gc,this.id,this.Zc,sb,this.dC),this.wIb&&t.f(this.$).ha.ob.KZ(this.uia.control),Je=!0)}return Je}QQd(sb,Gc,ad,Wd){Wd=new pa.a(37023044,Wd,this.$.xc,0,null);Wd.jUb=!0;this.$.Ia.Gb(Wd,{["rawEvent"]:null,["pivotName"]:null,["cell"]:sb,["requiresConfirmation"]:64===(this.Zc.Attributes&
64),["dataSourceIndex"]:this.Zc.ExternalSourceIndex,["domElement"]:this.pv,["objectId"]:this.id,["objectVersion"]:this.aK.Version,["location"]:ad,["optionalPivotMenuAnchorParameter"]:Gc})}Qji(sb,Gc){const ad=Wd=>{if(Wd){t.f(sb).Bu(!0);const je={};sb.Zk(je);je.FirstRow=-1;je.FirstColumn=-1;Wd=new Z.a(161,0,(Ie,Je,$e)=>ta.K(sb.ma.sa,je,this.Zc.ExternalSourceIndex,!0,!0,!0,!1,!1,Ie,Je,$e,null,Gc),6,()=>new ia.a(je,!1));sb.userOperationManager.enqueueOperation(Wd,null)}};void z.a.resolve(w.DataRefreshManagerService,
{xa:1}).then(Wd=>{Wd.KH(!0,ad)})}Wzg(sb){sb=this.Xyc(sb);if(this.fVd(sb)){var Gc=sb.Type;if(1===Gc||2===Gc||3===Gc){var ad={};ad.ChartId=this.id;ad.AnchorValue1=sb.SeriesIndex;ad.AnchorValue2=-1;switch(Gc){case 1:ad.AnchorType=2;ad.AnchorValue1=sb.CategoryIndex;break;case 2:0<=sb.SeriesIndex?ad.AnchorType=1:(ad.AnchorType=2,ad.AnchorValue1=sb.CategoryIndex);break;default:ad.AnchorType=3,ad.AnchorValue2=sb.CategoryIndex}this.Qji(this.$,ad)}}}Xyc(sb){sb=parseInt(sb.getAttribute(xa.a.Orf),10);return isNaN(sb)?
null:this.aK.ChartElementItems[sb]}static snc(sb,Gc){const ad=Ca.a(sb);ad&&(eb.ogl(sb,ad.pv),ad.O1k&&eb.yre(sb,ad.Zc)?(ad.$J||(ad.$J=new eb(ad.pv,!1,sb,ad.Zc,null,Gc)),ad.Qnc=!1,ad.$J.Jxk(ad)):ad.Qnc=!0)}static WGb(sb,Gc){!sb.$J&&eb.yre(Gc,sb.floatingObject.Zc)&&(sb.$J=new eb(sb.domElement,sb.$C,Gc,sb.floatingObject.Zc,sb.extension,sb.Mc),(Gc=sb.MUa)?ba.DOMElementExtensions.isVisible(Gc.parentNode)&&sb.$J.uke(sb):Ka.ULS.shipAssertTag(537155043,5,sb.uXd,"ChartElementSelectableBehavior.AttachFloatingObjectControl currentImageTagElement is null and lightweight placeholder does not exists. We are in unknown state."))}static yre(sb,
Gc){const ad=sb.$b,Wd=[2,17,1,0];return!!Gc&&ad.allowInteractivity&&(260===(Gc.Attributes&260)&&ad.allowPivotSpecificOperations||!Wd.includes(Gc.ChartCategory)&&sb.isEditMode&&X.EwaSettings.Ra(16))}static ogl(sb,Gc){if(Gc&&sb.$b.YDa&12582912){const ad=Gc.getAttributeNode("Src").value,Wd=Va.a.$r(ad,"iro");let je=0;Wd&&(je=parseInt(Wd));sb=je|sb.$b.YDa&12582912;sb!==je&&Gc.setAttribute("Src",Va.a.yk(ad,"iro",sb.toString()))}}static Z2g(sb,Gc,ad,Wd){(sb=ba.DOMElementExtensions.wq(sb,Gc))&&ba.DOMElementExtensions.toggleCssClass(sb,
ad,Wd)}}Object(u.a)(eb,"ChartElementSelectableBehavior",M.a,[743,4]);var Yb=a(43),Gb=a(88);let Mb=class{constructor(sb){this.c_b=()=>{this.snc()};this.$=sb;sb.fa.isNamedObjectViewMode&&(Ca.a(this.$).aw(this.c_b),Ca.a(sb).xY&&this.snc())}WGb(sb,Gc){if(Gc.extension)eb.WGb(Gc,sb);else{let ad=null;ad=Wd=>{eb.WGb(Wd,sb);Wd.gsb(ad)};Gc.Rbb(ad)}}dispose(){Ca.a(this.$).Zz(this.c_b)}snc(){const sb=Object(Gb.d)(z.a.resolve(w.HtmlSanitizationHelperService,{xa:0}));Yb.TaskExtensions.tb(sb,Gc=>{eb.snc(this.$,
Gc.result)},this.$.Aa,3)}};Mb=Object(m.__decorate)([Object(z.d)(w.ChartElementSelectableBehaviorManagerService),Object(m.__param)(0,Object(w.EwaControlService)())],Mb);Object(u.a)(Mb,"ChartElementSelectableBehaviorManager",null,[730,4]);var Rb=a(1133),$b=a(189),cc=a(150),fb=a(429),Sb=a(134),kc=a(1032),na=a(1131);class fc{constructor(sb,Gc){this.type=0;this.id=null;this.type=sb;this.id=Gc}getId(){return this.id}}Object(u.a)(fc,"MacroRecorderFloatingObjectDeletedPayload",null,[67]);var Cc=a(28),tc=
a(266),nb=a(99),tb=a(98);class La{constructor(sb,Gc){this.id=null;this.zOrderType=0;this.id=sb;this.zOrderType=Gc}getId(){return this.id}}Object(u.a)(La,"MacroRecorderFloatingObjectZOrderChangedPayload",null,[67]);class wb{constructor(sb){this.id=null;this.id=sb}getId(){return this.id}}Object(u.a)(wb,"MacroRecorderFloatingObjectPutFloatingImageInCellPayload",null,[67]);var Wa=a(941),Fa=a(36),Da=a(177),ja=a(29),Qa;let Ob=Qa=class{constructor(sb,Gc,ad){this.$=sb;this.vg=Gc;this.Vna=ad}gd(sb,Gc){let ad=
!1;const Wd=!!(this.$.$d&32);switch(Gc){case -1096598696:case -220469023:case -445658892:case 1166778132:ad=Wd;break;case -1024854261:case -1480025782:case 565697619:case -884976206:case 1804967129:ja.a.s2()&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:8844986_DisablePictureRibbonCommandsWhenInCropMode")?(sb=t.f(this.$).ha.ob.Wb,ad=Wd||!!sb&&sb.floatingObject.KQ&&sb.isEditing):ad=Wd;break;case -848953656:ad=64===sb;break;case -700002548:ad=Wd&&X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TransitionFloatingInCellImages",
!1)}return ad}executeCommand(sb,Gc,ad){let Wd=!1;var je=null;sb=t.f(this.$).ha.ob.Wb;const Ie=t.f(this.$).ha.ob.Qj,Je=!!t.f(this.$).ha.ob.EH,$e=Gc.command;switch($e){case 1872288872:X.EwaSettings.isChangeGateEnabled("OfficeVSO:5903230_EscapeKeyManualPlacementFix")&&sb.isElementMovementInProgress()?sb.restoreElementPosition():Ie||Je?sb.R_c():sb.extension.ocf();Wd=!0;break;case 267796030:Gc=ad.event;sb.P_c(!!Gc&&13===Gc.keyCode,Ie);Wd=!0;break;case -867294282:sb.showE1ODialog();Wd=!0;break;case 1504715724:case 2045211913:case -848953656:case -1228228458:Ie?
(sb.ntc(Ie,Gc.Re),Wd=!0):je=Qa.Mei(sb,this.$,Gc);break;case 706199415:case 125627505:Gc=125627505===$e;Ie||Je?sb.Q_c(Gc):this.selectNextFloatingObject(Gc);Wd=!0;break;case -798660877:case -1470715894:case -1231471547:case 137938150:Ie?(sb.moveElementByKey(Gc.command),Wd=!0):je=e.Task.Va(Qa.Z8i(Gc.command,sb));break;case -1603798598:case -31900117:case 2039316657:case 589730764:je=e.Task.Va(Qa.B8i(Gc.command,sb));break;case -1096598696:case -220469023:je=e.Task.Va(Qa.C8i(Gc.command,sb));break;case -445658892:je=
e.Task.Va(Qa.G7i(sb));break;case 1166778132:je=e.Task.Va(Qa.O7i(sb));break;case 1517579890:ja.a.s2()&&(je=e.Task.Va(Qa.dCc($e,ad,sb)));break;case -287251124:case -1925065947:case 1764140053:case -1590502662:case -1077965542:case -1293291468:case -394785302:case 1041132226:case -571165336:case -1150205178:case -1142465846:case -286432209:je=e.Task.Va(Qa.bua($e,ad,sb));break;case 1970784898:je=ad.Color;this.vg.Hrb=je;this.vg.nxa(ad,je,Gc);je=e.Task.Va(Qa.bua($e,ad,sb));break;case -1832800737:this.vg&&
(ad.Color=this.vg.Hrb);je=e.Task.Va(Qa.bua($e,ad,sb));break;case 862825906:je=this.vg.mnb(1970784898,Gc,"#FFFFFF");break;case -1828502776:je=ja.a.aG()?this.vg.launchEyedropper($e,Gc):e.Task.Va(!1);break;case -803000997:ad[Rb.a.Color]="000000";je=e.Task.Va(Qa.bua(1970784898,ad,sb));break;case -585097204:je=e.Task.Va(Qa.b9i(sb));break;case -1024854261:je=Qa.eCc(sb,this.$,1,Gc);break;case -1480025782:je=Qa.eCc(sb,this.$,0,Gc);break;case 565697619:je=Qa.eCc(sb,this.$,3,Gc);break;case -884976206:je=Qa.eCc(sb,
this.$,2,Gc);break;case -700002548:je=Qa.putFloatingImageInCell(sb,this.$,this.Vna,Gc)}Wd||je||(je=l.a($e));return je||e.Task.Va(!0)}Rc(sb,Gc){var ad=!1;switch(sb){case 2:case 4:case 128:case 64:case 256:case 8:case 16:ad=!0}if(ad)switch(Gc.command){case 1872288872:case 1504715724:case 2045211913:case -848953656:case -1228228458:case 125627505:case 706199415:break;case -445658892:case 1166778132:case -287251124:case -1925065947:case 1764140053:case -1590502662:case -1077965542:case -1293291468:case 1970784898:case -1832800737:case 862825906:case -803000997:case -394785302:case 1041132226:case -571165336:case -1150205178:case -1142465846:case -286432209:ad=
this.def();break;case -1828502776:ad=ja.a.aG()&&this.def();break;case -585097204:ad=t.f(this.$).ha.ob.Wb;ad=!!ad&&!(this.$.$d&32)&&5===ad.floatingObject.type;break;case -798660877:case -1470715894:case -1231471547:case 137938150:case -1603798598:case -31900117:case 2039316657:case 589730764:case -1096598696:case -220469023:case -1024854261:case -1480025782:case 565697619:case -884976206:ad=t.f(this.$).ha.ob.Wb;ad=!!ad&&ad.movable;break;case 1517579890:ja.a.s2()&&(ad=t.f(this.$).ha.ob.Wb,ad=!!ad&&
ad.movable);break;case -700002548:X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TransitionFloatingInCellImages",!1)&&(ad=t.f(this.$).ha.ob.Wb,ad=!!ad&&1===ad.floatingObject.type);break;default:ad=!1}2===sb&&267796030===Gc.command&&(ad=X.EwaSettings.Ra(407));512!==sb||-867294282!==Gc.command&&706199415!==Gc.command&&125627505!==Gc.command||(ad=!0);return ad}td(){return!1}selectNextFloatingObject(sb){const Gc=t.f(this.$).ha.ob.Wb;Gc&&nb.a(this.$).selectNextFloatingObject(Gc,sb)}static Mei(sb,
Gc,ad){const Wd=new Sb.SheetProtection(Gc.qa);let je=sb?sb.floatingObject.id:null;if(!sb||!je||!Wd.ie(1))return e.Task.Va(!1);const Ie=sb.floatingObject.type,Je=Qa.$Fi(Gc,sb);sb.mjb();2===Ie&&(je=sb.ll);nb.a(Gc).deleteFloatingObject(sb,15,!0);t.f(Gc).ha.ob.FF=null;const $e=()=>new fc(Ie,je);return fb.a(Gc.userOperationManager,(Ib,Nb,Bc)=>kc.c(Gc.ma.sa,Ie,je,tc.c(Ib,Je),Nb,Bc,null),Ib=>new Z.a(522,0,Ib,void 0,$e),ad)}static $Fi(sb,Gc){const ad=Gc.floatingObject.Fh();let Wd=null;Gc.$j&&(Wd=Gc.$j.block);
return je=>{const Ie=X.EwaSettings.isChangeGateEnabled("OfficeVSO:8434150_MigrateValidationTelemetryManager")?z.a.Cb(w.ValidationTelemetryManagerService):sb.ra.Tb(277);Ie&&Wd&&Ie.Hkc(()=>!Wd.Ii.Bb(ad),je.StateId,"DeleteFloatingObject")}}static Z8i(sb,Gc){if(!Gc)return!1;switch(sb){case -798660877:sb=3;break;case -1470715894:sb=0;break;case -1231471547:sb=1;break;case 137938150:sb=2;break;default:return!1}Gc.extension.P7d(sb);return!0}static C8i(sb,Gc){if(!Gc)return!1;Gc.extension.nAj(-1096598696===
sb);return!0}static G7i(sb){if(!sb)return!1;sb.extension.startEdit();return!0}static O7i(sb){if(!sb)return!1;sb.extension.endEdit();return!0}static bua(sb,Gc,ad){if(!ad)return!1;ad.extension.bua(sb,Gc);return!0}static dCc(sb,Gc,ad){if(!ad)return!1;ad.extension.dCc(sb,Gc);return!0}static B8i(sb,Gc){if(!Gc)return!1;switch(sb){case -1603798598:sb=6;break;case -31900117:sb=10;break;case 2039316657:sb=5;break;case 589730764:sb=9;break;default:return!1}Gc.floatingObject.Qva&&(sb|=3);Gc.extension.mAj(sb);
return!0}static b9i(sb){if(!sb)return Ka.ULS.sendTraceTag(537162395,5,15,"FloatingObjectCommandHandler.HandleOfficeScriptViewScript: Parameter for IFloatingObjectControl is null"),!1;const Gc=sb.floatingObject;if(sb.xda()){const ad=$b.a.create();tb.a(cc.a.mSj,void 0,void 0,[{name:Wa.a.C6,string:ad.toString()}]);void z.a.resolve(w.OfficeScriptsCommandManagerService,{xa:0}).then(Wd=>{Wd.WRf(Gc.id,Gc.Sb.ScriptLink,ad)})}return!0}static eCc(sb,Gc,ad,Wd){const je=()=>new La(sb.floatingObject.id,ad);return fb.a(Gc.userOperationManager,
(Ie,Je,$e)=>kc.a(Gc.ma.sa,sb.floatingObject.id,ad,Ie,Je,$e,null),Ie=>new Z.a(263,0,Ie,void 0,je),Wd)}static putFloatingImageInCell(sb,Gc,ad,Wd){const je=()=>new wb(sb.floatingObject.id);return fb.a(Gc.userOperationManager,(Ie,Je,$e)=>na.a(Gc.ma.sa,sb.floatingObject.id,tc.c(Ie,this.j3j(Gc,ad)),tc.b(Je,this.i3j),$e,null),Ie=>new Z.a(269,0,Ie,void 0,je),Wd)}static j3j(sb,Gc){return ad=>{let Wd;!ad||Fa.a.zf(ad.Errors)||Cc.a.Zg(Wd=ad.Result)?ad&&Fa.a.zf(ad.Errors)&&Ka.ULS.sendTraceTag(509109773,0,50,`FloatingObjectCommandHandler.onConvertInCellToFloatingE2oSuccess: operation succeeded with errors. Errors: ${Fa.a.pc(ad.Errors)}`):
(Ka.ULS.sendTraceTag(509109774,0,50,"FloatingObjectCommandHandler.onPutFloatingImageInCellSuccess: operation succeeded"),Da.a(sb).u3a(0),ad=Gc.W4g([Wd]),Gc.c3f(ad)&&Gc.cQf(ad))}}def(){const sb=t.f(this.$).ha.ob.Wb;return!!sb&&!(this.$.$d&32)&&5===sb.floatingObject.renderType&&5===sb.floatingObject.type}};Ob.i3j=()=>{Ka.ULS.sendTraceTag(509109772,0,50,"FloatingObjectCommandHandler.onPutFloatingImageInCellFailed: operation failed")};Ob=Qa=Object(m.__decorate)([Object(z.d)(w.FloatingObjectCommandHandlerService),
Object(m.__param)(0,Object(w.EwaControlService)()),Object(m.__param)(1,Object(w.MoreColorsHelperService)()),Object(m.__param)(2,Object(w.ViewportHelpersService)())],Ob);Object(u.a)(Ob,"FloatingObjectCommandHandler",null,[29]);var Ub=a(1136),Zb=a(681),uc=a(39),Hc=a(55),Dd=a(74),jc=a(369),$c=a(138),ud=a(2),Ud=a(1266),ec=a(27),Db=a(226),ic=a(172);class Pc{constructor(sb,Gc,ad,Wd){this.a=this.b=this.g=this.r=0;this.r=sb;this.g=Gc;this.b=ad;this.a=Wd}}Object(u.a)(Pc,"Color",null,[]);class Ed{constructor(sb,
Gc,ad,Wd){this.bottom=this.top=this.right=this.left=0;this.top=sb;this.left=Gc;this.bottom=ad;this.right=Wd}}Object(u.a)(Ed,"Rect2D",null,[]);class de{constructor(sb,Gc){this.col=this.row=0;this.row=sb;this.col=Gc}}Object(u.a)(de,"Cell",null,[]);class se{constructor(sb,Gc,ad){this.sheetName=this.bottomRight=this.topLeft=null;this.topLeft=sb;this.bottomRight=Gc;this.sheetName=ad}}Object(u.a)(se,"Range",null,[]);var Fe=a(328);class fe{constructor(sb,Gc,ad){this.qv=null;this.$=sb;this.zoom=ad;this.inkOverlay=
Gc;void z.a.Bd(w.InstantaneousSupportInformationManagerService).then(Wd=>this.qv=Wd)}get zoomManager(){return this.zoom.zoomManager}isDataEntryAllowed(sb){sb=this.inkOverlay.QGf(sb,!1);sb=this.inkOverlay.PPi(sb.left+Math.abs(sb.right-sb.left)/2,sb.top+Math.abs(sb.top-sb.bottom)/2);return!sb||!!ba.DOMElementExtensions.EIf(sb,J.a.dwc)}getRange(sb){var Gc=t.f(this.$).ha;const ad=this.inkOverlay.QGf(sb,!0),Wd=this.zoomManager.zoom;sb=Gc.Ft(new Sys.UI.Point(ad.left/Wd,ad.top/Wd),null,0,!0);Gc=Gc.Ft(new Sys.UI.Point(ad.right/
Wd,ad.bottom/Wd),null,0,!0);return sb&&Gc?new se(new de(sb.top,sb.left),new de(Gc.top,Gc.left),this.$.la.sheetName):(Ka.ULS.sendTraceTag(537155033,0,50,"DryInkStore.GetRange: Failed to resolve range."),null)}getCellBounds(sb){var Gc=t.f(this.$);const ad=Gc.za.ft(this.joc(sb));if(!ad)return Ka.ULS.sendTraceTag(537155032,0,50,"DryInkStore.GetCellBounds: Failed to obtain cellProxy."),null;sb=this.zoomManager.zoom;Gc=Gc.getCellBounds(ad);Gc=new Ed(Gc.y*sb,Gc.x*sb,(Gc.y+Gc.height)*sb,(Gc.x+Gc.width)*sb);
return this.inkOverlay.uXi(Gc)}getHighlight(sb){const Gc=t.f(this.$);var ad=Gc.cPb(null,sb.topLeft.row,sb.topLeft.col);if(!ad)return Ka.ULS.sendTraceTag(537155031,0,50,"DryInkStore.GetHighlight: First cell missing."),null;ad=ad.backgroundColor;sb=Gc.Np("InkDataStore.GetHighlight",fe.AHb(sb));try{for(;sb.$$mn();)if(sb.$$cu().cell.backgroundColor!==ad)return null}finally{sb&&sb.dispose()}sb=ic.a.np(ad);return new Pc(sb.r,sb.g,sb.b,1)}getInputScope(sb){switch(this.CWi(sb)){case 1:return 0;case 2:return 1;
case 5:return 3;case 9:return 4;default:return 5}}CWi(sb){if(!this.qv)return 0;const Gc=t.f(this.$);var ad=Gc.cPb(null,sb.topLeft.row,sb.topLeft.col);if(!ad)return Ka.ULS.sendTraceTag(537155030,0,50,"DryInkStore.GetNumberFormatCategoryForRange: First cell missing."),0;ad=this.xAc(ad.oi);sb=Gc.Np("InkDataStore.GetNumberFormatCategoryForRange",fe.AHb(sb));try{for(;sb.$$mn();)if(this.xAc(sb.$$cu().cell.oi)!==ad)return 0}finally{sb&&sb.dispose()}return ad}xAc(sb){let Gc=0;({category:Gc}=this.qv.Fna(sb,
!0));return Gc}FWc(sb,Gc=!1){const ad=t.f(this.$),Wd=ad.ha,je=fe.AHb(sb);Wd.updateSelection(je,je.topLeft,0);Gc&&Ka.ULS.sendTraceTag(507588687,0,15,"InkDataStore.selectInternal: showContextMenu is true.");Gc&&void z.a.resolve(w.ContextMenuManagerService).then(Ie=>{if(Ie){var Je=ad.za.ft(je.topRight);if(Je){Je=ad.getCellBounds(Je);var $e=new Ud.a;$e.clientPoint=new Sys.UI.Point(Je.x+Je.width,Je.y);$e.inputMethod=3;Ie.showContextMenu(null,null,$e)}else Ka.ULS.sendTraceTag(537155029,0,50,"DryInkStore.SelectInternal: Failed to obtain cellProxy.")}})}select(sb){this.FWc(sb,
!0)}erase(sb){this.FWc(sb);this.$.Ia.Gb(new pa.a(-848953656,2,2,30,null))}highlight(sb,Gc){const ad={};ad.Color=Db.a.BOb(Gc.r,Gc.g,Gc.b).fS();ad.IntColor=!0;Gc=new pa.a(1650812936,2,2,30,null);this.FWc(sb);this.$.Ia.Gb(Gc,ad)}unHighlight(sb){this.FWc(sb);this.$.Ia.Gb(new pa.a(87208751,2,2,30,null))}enterText(sb){if(sb.length){var Gc=t.f(this.$),ad=this.joc(sb[0].cell);for(const Wd of sb)ad.union(this.joc(Wd.cell));Gc.ha.updateSelection(ad,ad.topLeft,0);for(const Wd of sb)sb=Object(ud.a)(new Fe.a,
{Text:Wd.text}),Gc.setCell(sb,this.joc(Wd.cell),0,127,null)}}joc(sb){return fe.AHb(new se(sb,sb,this.$.la.sheetName))}static AHb(sb){return new ec.Range(sb.topLeft.row,sb.topLeft.col,sb.bottomRight.row,sb.bottomRight.col,!0,!1)}}Object(u.a)(fe,"InkDataStore",null,[749]);var Tc=a(19),ed=a(663),pd=a(154),Kb=a(207),rb=a(211),rc=a(953),ld=a(12);class Tb{constructor(){this.collections=this.clipRect=null}}Object(u.a)(Tb,"IInkCollections",null,[]);var Wc=a(146),Ac=a(475),nd=a(169);class qd{constructor(sb){this._count=
0;this.$$ge=this.getEnumerator;this.oS=sb;this.clear()}getEnumerator(){return nd.selectMany(nd.asEnumerable(this.aF),sb=>nd.asEnumerable(sb)).$$ge()}[Symbol.iterator](){return Object(Wc.a)(this.getEnumerator())}get count(){return this._count}add(sb){const Gc=({buckets:this.aF}=Ac.b(this.aF,sb,this.oS,this.count)).returnValue;for(let ad=0;ad<Gc.length;ad++)if(this.oS.equals(Gc[ad],sb))return!1;this._count=this.count+1;Gc.push(sb);return!0}clear(){this._count=0;this.aF=Ac.c([],this.oS,7)}contains(sb){const Gc=
this.aF[Ac.a(this.aF,this.oS.getHashCode(sb))];for(let ad=0;ad<Gc.length;ad++)if(this.oS.equals(Gc[ad],sb))return!0;return!1}remove(sb){const Gc=this.aF[Ac.a(this.aF,this.oS.getHashCode(sb))];for(let ad=0;ad<Gc.length;ad++)if(this.oS.equals(Gc[ad],sb))return Array.removeAt(Gc,ad),this._count=this.count-1,!0;return!1}}Object(u.a)(qd,"HashSet",null,[369,31]);var Xd=a(676);class Hd{constructor(sb,Gc,ad){this.sLb=[];this.Ila=(Wd,je,Ie)=>{Ka.ULS.sendTraceTag(537155025,0,10,`Ink method ${Ie} failed.`)};
this.$=sb;this.inkOverlay=Gc;this.zoom=ad}get zoomManager(){return this.zoom.zoomManager}getInk(){const sb={};for(var Gc of nb.a(this.$).WX){var ad=Gc.bAc();if(ad)for(const Ie in ad){var Wd=Ie,je=ad[Ie];Wd in sb?sb[Wd].push(je):sb[Wd]=[je]}}Wd=[];for(const Ie in sb)je=Ie,Gc=sb[Ie],ad=new Tb,ad.clipRect=this.lMi(je),ad.collections=Gc,Wd.push(ad);return Wd}flush(){if(this.sLb.length){var sb={};for(var Gc of this.sLb){var ad=Gc.getId();sb[ad]||(sb[ad]=new qd(Xd.a.wQ()));ad=Object(pd.a)(qd,sb[ad]);for(var Wd of Gc.getStrokeIds())ad.add(Wd)}Gc=
Object.keys(sb);var je=Array(Gc.length);for(Wd=0;Wd<je.length;Wd++){je[Wd]={};je[Wd].Id=Gc[Wd];je[Wd].StrokeIds=[];for(const $e of sb[Gc[Wd]])je[Wd].StrokeIds.push($e)}var Ie=this.sLb;this.sLb=[];var Je=this.$.ma.sa.mc();fb.a(this.$.userOperationManager,($e,Ib,Nb)=>kb.c(this.$.ma.sa,this.$.la.sheetName,je,tc.c($e,(Bc,Af,gf)=>{this.Zi(Bc,Af,gf);for(const Qe of Ie)Qe.onCompletion()}),tc.b(Ib,this.Ila),Nb,Je),$e=>new Z.a(579,0,$e,64),null)}}add(sb,Gc,ad,Wd){try{const je=t.f(this.$),Ie=this.zoomManager.zoom,
Je=fe.AHb(sb),$e=je.rb.Yh(Je.topLeft),Ib={};Ib.CreationId=Hd.Ckf();Ib.InkJSON=Wd;Ib.Row=Je.top;Ib.Col=Je.left;Ib.OffsetX=Math.round((je.rtl?Gc.right-ad.right:ad.left-Gc.left)/Ie);Ib.OffsetY=Math.round((ad.top-Gc.top)/Ie);Ib.Width=Math.abs(Math.round((ad.right-ad.left)/Ie));Ib.Height=Math.abs(Math.round((ad.bottom-ad.top)/Ie));je.rtl&&1!==$e&&(Ib.OffsetX-=$c.a.Gt);let Nb=null;sb.sheetName===this.$.la.sheetName&&(Nb=this.Ojj(Je,Ib));const Bc=this.$.ma.sa.mc();fb.a(this.$.userOperationManager,(Af,gf,
Qe)=>{this.$.Qw();return kb.f(this.$.ma.sa,sb.sheetName,Ib,tc.c(Af,(Aa,Fb,Ta)=>{this.Zi(Aa,Fb,Ta);Nb&&(Nb.Skb=!1)}),tc.b(gf,this.Ila),Qe,Bc)},Af=>new Z.a(578,0,Af,64),null);Hd.F1f&&this.l8k()}catch(je){Ka.ULS.sendTraceTag(537155028,0,10,`Add failed. Exception ${je.message}`)}}l8k(){if(X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelPenNsatSurvey",!1))try{const sb=Object(Tc.d)(ed.a);sb&&sb.execute(Gc=>{Gc.logActivity("AddPenStrokeInExcel",null)})}catch(sb){Ka.ULS.sendTraceTag(512501467,
12,10,"Exception thrown while triggering AddPenStrokeInExcel. Exception: {0}",sb)}}deleteInkStrokes(sb){this.sLb.push(sb)}Ojj(sb,Gc){var ad=t.f(this.$),Wd=sb.topLeft;sb=ad.rb.Yh(Wd);var je=ad.jS(Wd);if(!je)return Ka.ULS.sendTraceTag(537155027,0,10,"gridViewBlock is null"),null;const Ie=ld.HelperMethods.aE(je.domElement,je.Wl.domElement,ad.rtl);ad.rtl&&1===sb&&(Ie.x+=$c.a.Gt);Wd=ad.Wg(Wd,sb);ad=new Kb.a(ad.za.ti(je.hashCode),je.hashCode);je={};je.Id=Gc.CreationId;je.Name=Hd.Ckf();je.InstanceId=0;je.SessionRevision=
0;je.AltText=[];je.AltTextDescription=[];je.ZOrder=rc.a.jOa;je.Visible=!0;je.LockAspectRatio=!1;je.IsObjectLocked=!1;je.Type=8;je.RenderType=5;je.Version=-1;je.IsClientEstimation=!0;je.ContentHtml=InkHost.excelInkHostFactoryGlobal.createPayload(Gc.Width,Gc.Height,Gc.InkJSON);je.Width=Gc.Width;je.Height=Gc.Height;je.ClippedWidth=Gc.Width;je.ClippedHeight=Gc.Height;je.IsZeroDimension=!1;je.ContainerPane=sb;je.OriginDeltaX=Wd.x-Ie.x+Gc.OffsetX;je.OriginDeltaY=Wd.y-Ie.y+Gc.OffsetY;Gc=new rb.a(je);ad.block.Ii.add(Gc);
Gc.Hsb();nb.a(this.$).zrc(Gc,ad);return Gc}Zi(){}lMi(sb){var Gc=this.zoomManager.zoom,ad=parseInt(sb,10),Wd=t.f(this.$);sb=this.inkOverlay.getBounds();sb.left/=Gc;sb.top/=Gc;sb.right/=Gc;sb.bottom/=Gc;var je=Wd.pg(ad);if(!je)return Ka.ULS.sendTraceTag(537155024,0,10,"Failed to obtain clipping pane"),sb;ad=je.ul;je=je.Nn;Wd.rtl?(Wd=sb.right-(je.x+$c.a.Gt/Gc),Gc=Wd-ad.width):(Gc=je.x,Wd=Gc+ad.width);return new Ed(sb.top+je.y,sb.left+Gc,sb.top+je.y+ad.height,sb.left+Wd)}static Ckf(){const sb=$b.a.create().toString();
return`${sb.length+2}.{${sb.toUpperCase()}}`}}Hd.F1f=!1;Object(u.a)(Hd,"InkDryStore",null,[742]);class Zc{info(sb){Ka.ULS.sendTraceTag(591943768,0,50,sb)}error(sb){Ka.ULS.sendTraceTag(591943767,0,10,sb)}}Object(u.a)(Zc,"InkLogger",null,[748]);var Jc=a(1505),gc=a(972),dd=a(945),Bb=a(1135);class pc extends Bb.a{constructor(){super();this.animateTransition=!1}}Object(u.a)(pc,"AdditionalInkButtonProperties",Bb.a,[]);var wc=a(1281);class cd extends wc.a{constructor(){super();this.animateTransition=!1}}
Object(u.a)(cd,"AdditionalInkFlyoutAnchorProperties",wc.a,[]);class Vd{constructor(sb,Gc){this.uoc={};this.iJb=null;this.inkOverlay=sb;this.G9g=Gc}fLi(sb){if(sb in this.uoc)return this.uoc[sb];const Gc=appChrome.selectors.getInkButtonState(sb);return this.uoc[sb]=Gc}fzc(sb){sb=appChrome.selectors.getColorPickerState(sb);return sb?Array.isArray(sb.colorCells)?sb.colorCells:null:(Ka.ULS.sendTraceTag(537155021,0,50,"InkRibbonManager.GetColorPickerColors: Missing State."),[])}mbi(sb){if(!this.iJb){this.iJb=
{};var Gc=Array.isArray(this.fzc("InkColorPickerPen").concat(this.fzc("InkColorPickerHighlighter")))?this.fzc("InkColorPickerPen").concat(this.fzc("InkColorPickerHighlighter")):null;for(const ad of Gc)this.iJb[ad.id]=ad}Gc=[];for(const ad of sb)ad in this.iJb&&Gc.push(this.iJb[ad]);return appChrome.actions.populateColorPickerCells("InkColorPickerMRU",Gc)}Tai(sb,Gc){const ad=this.fLi(sb.id);return Vd.KCf.includes(sb.id)&&Gc?[appChrome.actions.addControls([appChrome.api.createInkFlyoutAnchorModel(sb.id,
ad.label,Object(ud.a)(new cd,{iconSet:this.G9g?ad.iconSet:(new Jc.a(ad.iconName)).iconSet,iconColor:sb.color,keytip:ad.keytip,menuModel:appChrome.getInkFlyoutAnchorMenuModel(sb.id),animateTransition:!0,toggled:!0}))])]:[appChrome.actions.addControls([appChrome.api.createInkButtonModel(sb.id,ad.label,Object(ud.a)(new pc,{iconSet:this.G9g?ad.iconSet:(new Jc.a(ad.iconName)).iconSet,iconColor:sb.color,keytip:ad.keytip,animateTransition:!0}))]),appChrome.actions.toggleButton(sb.id,Gc)]}goj(sb,Gc){const ad=
appChrome.selectors.getModelType(sb);return!Vd.KCf.includes(sb)||"InkFlyoutAnchorModel"===ad&&Gc||"InkButtonModel"===ad&&!Gc}eYa(sb,Gc){var ad=this.inkOverlay.getCurrentTool();"QueryInkTool"===sb?(sb=this.inkOverlay.getTool(Object(pd.a)(String,Gc[gc.a.SourceControlId])),ad=sb===ad,sb.id in this.uoc&&this.goj(sb.id,ad)?(Gc[gc.a.On]=ad,Gc[dd.a.iconColor]=sb.color):Gc[dd.a.A2b]=this.Tai(sb,ad)):"QueryInkThickness"===sb&&ad?Gc[Ub.a.Value]=ad.thickness:"QueryInkRecentColors"===sb&&ad?Gc[dd.a.A2b]=[this.mbi(ad.recentColors)]:
"QueryInkSnapToText"===sb&&ad?Gc[gc.a.On]=ad.snapToText:"QueryInkDrawWithTouch"===sb&&(Gc[gc.a.On]=this.inkOverlay.isDrawWithTouchEnabled())}Pfl(sb){appChrome.api.dispatch([appChrome.actions.updateSliderSelectedValue("InkThickness",sb)])}}Vd.KCf=["InkPen1","InkPen2","InkHighlighter","InkActionPen"];Object(u.a)(Vd,"InkRibbonManager",null,[]);class xb{constructor(sb,Gc){this.analysisKey=this.analysisUrl=null;this.analysisUrl=sb;this.analysisKey=Gc}}Object(u.a)(xb,"ServiceInfo",null,[]);class ub{logActivity(sb,
Gc,ad,Wd){const je=[];for(let Ie=0;Ie<ad.length;Ie++)ad[Ie]&&Wd[Ie]&&je.push({name:ad[Ie],string:Wd[Ie]});tb.a(sb,!0,Gc,je)}}Object(u.a)(ub,"InkActivityLogger",null,[741]);Object(z.b)(w.InkOverlayService,{we:"singleton"})(async sb=>{const Gc=await z.a.resolve(w.EwaControlService,sb);sb=await z.a.resolve(w.ZoomService,sb);await Object(Gb.a)(nb.a(Gc).Zka(8));return new Fc(Gc,sb)});class Fc{constructor(sb,Gc){this.OTd=this.inkOverlay=this.container=null;this.Vz=()=>{this.y$b(this.$.la);this.inkOverlay.canvas.updateCanvasDimensions();
this.inkOverlay.canvas.setZoom(this.zoomManager.zoom)};this.UJa=(ad,Wd)=>{Wd.la!==Wd.Vx&&(this.inkOverlay.canvas.flush(),this.y$b(Wd.la))};this.b_b=()=>{this.inkOverlay.canvas.onCanvasesCrashDetected()};this.$=sb;this.zoom=Gc;this.mrf=new Hd(sb,this,Gc);this.Gci=new fe(sb,this,Gc);this.$.DD(this.Vz);t.f(this.$).view.Ks(this.Vz);this.$.qa.VS(this.UJa);t.f(this.$).CTa.V4e(this.b_b);w.InkOverlayService.Oa()&&this.init()}get zoomManager(){return this.zoom.zoomManager}get t9j(){return this.inkOverlay}init(){const sb=
this.$.pT;this.container=document.createElement("div");this.container.className=J.a.Pri;sb.appendChild(this.container);this.y$b(this.$.la);X.EwaSettings.isChangeGateEnabled("OfficeVSO:6052930:InkActivityMinutes")&&(this.xjj=new ub);this.inkOverlay=InkHost.excelInkOverlayFactoryGlobal.create(this.container,this.container,sb,this,new Zc,this.xjj,!0);this.inkOverlay.canvas.setZoom(this.zoomManager.zoom);this.OTd=new Vd(this.inkOverlay,X.EwaSettings.isChangeGateEnabled("OfficeVSO:4373042_InkDrawTabIconSet"))}y$b(sb){var Gc=
!(new Sb.SheetProtection(this.$.qa)).ie(1);if(Dd.e(sb)||Gc)this.container.style.display="none";else{sb=t.f(this.$);Gc=Sa.a.LPb(sb,this.zoomManager,!1);var ad=this.zoomManager.zoom,Wd=sb.rtl?$c.a.Gt:sb.nn*ad;this.container.style.top=((parseFloat(sb.nh.style.top)+sb.uz)*ad).toString()+"px";this.container.style.left=Wd.toString()+"px";this.container.style.width=(Gc.x*ad).toString()+"px";this.container.style.height=(Gc.y*ad).toString()+"px";this.container.style.display="initial"}}getDryStore(){return this.mrf}getGrid(){return this.Gci}getLanguage(){return this.$.ta.DataCultureTag}getServiceInfo(){return new xb(this.$.ta.InkAnalysisUrl,
this.$.ta.InkAnalysisKey)}displayError(sb){switch(sb){case 1:sb=927;break;case 2:sb=928;break;default:sb=926}sb=Fa.a.Cd(1,0,26,sb,0,0,"InkDisplayError");new jc.a(this.$,sb)}onPointerDown(){t.f(this.$).ha.ob.WH(null,!0)}QGf(sb,Gc){const ad=ba.DOMElementExtensions.getBoundingClientRect({element:this.container});return Gc?(Gc=this.zoomManager.zoom+.5,new Ed(Math.max(sb.top,Gc)+ad.y,Math.max(sb.left,Gc)+ad.x,Math.min(sb.bottom,ad.height-Gc)+ad.y,Math.min(sb.right,ad.width-Gc)+ad.x)):new Ed(sb.top+ad.y,
sb.left+ad.x,sb.bottom+ad.y,sb.right+ad.x)}uXi(sb){const Gc=ba.DOMElementExtensions.getBoundingClientRect({element:this.container});return new Ed(sb.top-Gc.y,sb.left-Gc.x,sb.bottom-Gc.y,sb.right-Gc.x)}getBounds(){const sb=ba.DOMElementExtensions.getBoundingClientRect({element:this.container});return new Ed(sb.y,sb.x,sb.y+sb.height,sb.x+sb.width)}PPi(sb,Gc){let ad=null;const Wd=this.container.firstChild.style.display;this.container.firstChild.style.display="none";try{ad=Hc.a.Czc(new Sys.UI.Point(sb,
Gc))}catch(je){Ka.ULS.sendTraceTag(537155023,0,10,je.message)}ad||Ka.ULS.sendTraceTag(537155022,0,10,"InkOverlay.GetElementAt: Failed to find element.");this.container.firstChild.style.display=Wd;return ad}dispose(){this.$.vG(this.Vz);t.f(this.$).view.xs(this.Vz);this.$.qa.xZ(this.UJa);t.f(this.$).CTa.DHg(this.b_b)}eYa(sb,Gc){this.OTd.eYa(sb,Gc)}setThickness(sb){this.inkOverlay.setThickness(sb);this.OTd.Pfl(sb)}zDd(sb){const Gc=this.inkOverlay.isDrawWithTouchEnabled();return sb&&!Gc||!sb&&Gc?(this.inkOverlay.setDrawWithTouch(sb),
this.$.Sg(),!0):!1}deleteInkStrokes(sb){this.mrf.deleteInkStrokes(sb)}static Bgb(sb,Gc){let ad=sb.ra.Tb(380);if(ad)return ad;ad=new Fc(sb,Gc);ad.init();sb.ra.zc(380,ad);return ad}}Object(u.a)(Fc,"InkOverlay",null,[728,4,729]);Object(z.b)(w.InkCommandHandlerService,{we:"singleton"})(async sb=>{const Gc=await z.a.resolve(w.EwaControlService,sb),ad=w.InkOverlayService.Oa()?null:await z.a.resolve(w.ZoomService,sb);sb=w.InkOverlayService.Oa()?await z.a.resolve(w.InkOverlayService,sb):null;w.InkOverlayService.Oa()||
await Object(Gb.a)(nb.a(Gc).Zka(8));return new xd(Gc,sb,ad)});class xd{constructor(sb,Gc,ad){this.$=sb;this.inkOverlay=Gc;this.zoom=ad}executeCommand(sb,Gc,ad){sb=Gc.command;const Wd=w.InkOverlayService.Oa()?this.inkOverlay:Fc.Bgb(this.$,this.zoom),je=Wd.t9j;this.tQk(Gc.method,sb)&&je.setDrawWithTouch(!0);switch(sb){case -1190865050:je.selectSelect();break;case -23978586:t.f(this.$).ha.ob.WH(null,!0);je.selectEraser();break;case -661723044:je.selectPen1();break;case -661723047:je.selectPen2();break;
case -2032507089:je.selectHighlighter();break;case 236119185:je.selectActionPen();break;case -1836555960:if(!(Ub.a.Value in ad))return Ka.ULS.sendTraceTag(537155035,0,10,"InkCommandHandler.ExecuteCommand: InkThickness missing value."),e.Task.Va(!1);Wd.setThickness(ad[Ub.a.Value]);break;case -1065705021:je.setDrawWithTouch(!je.isDrawWithTouchEnabled());break;case 2122019213:case -1601650754:case -1004421438:if(!(Rb.a.Color in ad))return Ka.ULS.sendTraceTag(537155034,0,10,"InkCommandHandler.ExecuteCommand: InkColor missing value."),
e.Task.Va(!1);je.setColor(ad[Rb.a.Color]);break;case -938244532:je.setSnapToText(!je.getCurrentTool().snapToText);break;case -1224297244:return this.aUk();case 1310795349:return Da.a(this.$).um.BRg(!1),Da.a(this.$).um.activateRibbonTab(xa.a.rR),je.selectSelect(),e.Task.Va(!0);case -1464607177:return je.selectSelect(),Da.a(this.$).um.BRg(!0),Da.a(this.$).um.activateRibbonTab(xa.a.WCg),e.Task.Va(!0);default:return l.a(sb)}da.AFrameworkApplication.ua.Ab.jE&&Zb.a.hT(1,2);this.$.Sg();return e.Task.Va(!0)}Rc(sb,
Gc){if(!Gc||!this.$.isEditMode||8===sb)return!1;switch(Gc.command){case -1190865050:case -2032507089:case -1836555960:case 2122019213:case -1004421438:case -1065705021:case -23978586:case -661723044:case -661723047:case -1601650754:case 236119185:case -938244532:case -1224297244:case 1310795349:case -1464607177:return!0;default:return!1}}gd(sb){return 8===sb?!0:!1}td(){return!1}dispose(){}tQk(sb,Gc){Hd.F1f=4===sb?!0:!1;return 4!==sb||uc.a.mi||uc.a.cFc?-1065705021!==Gc:!1}aUk(){const sb=new pa.a(-859308420,
Ia.a.Hb,this.$.xc,2,null);return this.$.Ia.Gb(sb,{[Ia.a.Bf]:"HelpID=19098",["InputMethod"]:Ia.a.Hb,[Ia.a.Wc]:xa.a.VF,["ShouldCanvasTakeFocus"]:!0})}}Object(u.a)(xd,"InkCommandHandler",null,[29,4]);var Ic=a(368);let bd=class{constructor(sb){this.$=sb}gd(){return!1}executeCommand(sb,Gc){sb=!1;Gc=Gc.command;switch(Gc){case -104572626:this.Zkj(),sb=!0}return sb?e.Task.Va(!0):l.a(Gc)}Rc(sb,Gc){switch(Gc.command){case -104572626:return!0;default:return!1}}td(){return!1}Zkj(){this.$.userOperationManager.enqueueOperation(new Z.a(1026,
0,(sb,Gc)=>Ic.d(this.$.ma.sa,tc.c(sb,this.JUj()),tc.b(Gc,this.IUj()),null,null)),null)}JUj(){return sb=>{if(sb.Result){Ka.ULS.sendTraceTag(512278679,0,50,"LoadBlockingFloatingObjectsCommandHandler.onCleanupRequestSuccess: Clean Up of LoadBlocking floating objects Succeeded.");this.$.workbookContext.LoadBlockingFloatingObjectsInfo=null;const Gc=Object(Gb.d)(z.a.resolve(w.LoadBlockingFloatingObjectsService,{xa:0}));Yb.TaskExtensions.tb(Gc,()=>{Gc.result.AQ()},this.$.Aa,3);this.$.Ia.Gb(new pa.a(-8805455,
0,this.$.xc,12,null))}}}IUj(){return()=>{Ka.ULS.sendTraceTag(512278678,0,50,"LoadBlockingFloatingObjectsCommandHandler.onCleanupRequestFailure: Clean Up of LoadBlocking floating objects failed.")}}};bd=Object(m.__decorate)([Object(z.d)(w.LoadBlockingFloatingObjectsCommandHandlerService),Object(m.__param)(0,Object(w.EwaControlService)())],bd);Object(u.a)(bd,"LoadBlockingFloatingObjectsCommandHandler",null,[29]);var yb=a(179),Oc=a(1483),kd=a(13);let Rc=class{constructor(sb){this.$=sb}HO(){ja.a.Fj()?
void z.a.resolve(w.ReactTaskPaneManagerService,{xa:0}).then(sb=>sb.PC("LoadBlockingFloatingObjectsTaskPane",this.yl())):void yb.a.li().then(sb=>{sb.showTaskPane("LoadBlockingFloatingObjectsTaskPane",this.yl());return null})}AQ(){ja.a.Fj()?void z.a.resolve(w.ReactTaskPaneManagerService,{xa:0}).then(sb=>sb.hideTaskPane("LoadBlockingFloatingObjectsTaskPane")):void yb.a.li().then(sb=>{sb.hideTaskPane("LoadBlockingFloatingObjectsTaskPane",2);return null})}YLa(){ja.a.Fj()?void z.a.resolve(w.ReactTaskPaneManagerService,
{xa:0}).then(sb=>sb.setSelectedTaskPane("LoadBlockingFloatingObjectsTaskPane")):void yb.a.li().then(sb=>{sb.setSelectedTaskPane("LoadBlockingFloatingObjectsTaskPane")})}yl(){var sb,Gc,ad,Wd,je,Ie;return Object.assign(new Oc.a,{contentProps:{type:"LoadBlockingFloatingObjectsTaskPaneProps",loadBlockingFloatingObjectsTaskPaneSubHeader:kd.a.instance.ia(1956),loadBlockingFloatingObjectsTaskPaneBody:kd.a.instance.ia(1957),allowEditingSoftBlockedFiles:this.allowEditingSoftBlockedFiles.bind(this),isSoftBlocked:2===
this.$.workbookContext.LoadBlockingFloatingObjectsInfo.LoadBlockType,containsEmptyTextBox:!!((null===(Gc=null===(sb=this.$.workbookContext)||void 0===sb?void 0:sb.LoadBlockingFloatingObjectsInfo)||void 0===Gc?NaN:Gc.LoadBlockingFloatingObjects)&1),containsInvalidShape:!!((null===(Wd=null===(ad=this.$.workbookContext)||void 0===ad?void 0:ad.LoadBlockingFloatingObjectsInfo)||void 0===Wd?NaN:Wd.LoadBlockingFloatingObjects)&2),containsInvalidImage:!!((null===(Ie=null===(je=this.$.workbookContext)||void 0===
je?void 0:je.LoadBlockingFloatingObjectsInfo)||void 0===Ie?NaN:Ie.LoadBlockingFloatingObjects)&4)},width:300,title:kd.a.instance.ia(1955)})}allowEditingSoftBlockedFiles(sb){this.$.fa.jDd=sb;this.$.workbookContext.LoadBlockingFloatingObjectsInfo=null;Ka.ULS.sendTraceTag(509669841,0,50,"LoadBlockingFloatingObjectsTaskPane.allowEditingSoftBlockedFiles: User has decided to skip cleaning up the load blocking floating objects.");this.AQ()}};Rc=Object(m.__decorate)([Object(z.d)(w.LoadBlockingFloatingObjectsService),
Object(m.__param)(0,Object(w.EwaControlService)())],Rc);Object(u.a)(Rc,"LoadBlockingFloatingObjectsTaskPane",null,[725]);var Xb=a(9),dc=a(1268),Vc=a(936);class yd extends Vc.a{constructor(sb){super(sb);this.create()}oq(){if(X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",!1)){const sb=z.a.resolve(w.ViewportHelpersService,{xa:this.Cc}),Gc=z.a.resolve(w.MoreColorsHelperService,{xa:this.Cc});void Promise.all([Gc,sb]).then(([ad,Wd])=>{this.fn([new Ob(this.$,ad,Wd)])})}else{const sb=
Object(Gb.d)(z.a.resolve(w.ViewportHelpersService,{xa:this.Cc})),Gc=Object(Gb.d)(z.a.resolve(w.MoreColorsHelperService,{xa:this.Cc}));Yb.TaskExtensions.tb(Yb.TaskExtensions.jl([Gc,sb],this.Aa),()=>{this.fn([new Ob(this.$,Gc.result,sb.result)])},this.Aa,3)}}static Ea(sb){Vc.a.cw(71,new yd(sb))}}Object(u.a)(yd,"FloatingObjectCommandHandlerFactory",Vc.a,[]);var Pd=a(983),re=a(363),ue=a(93),He=a(1094),bf=a(1015),af=a(1278),Pe=a(81);const wf=J.a.Ari;class xf extends rc.a{constructor(sb,Gc,ad){super(sb,
Gc,J.a.Nui+" "+J.a.vFa+" "+xa.a.Qdj,ad);this.sn=null;this.Joa=Gc.Bj.InstanceId}get mcb(){return OSF.OsfControlTarget.InContent}get instanceId(){return this.Joa}get NH(){return wf}dispose(){this.sn=null;super.dispose()}select(sb,Gc){sb&&this.sn&&this.sn.J7d(this);super.select(sb,Gc)}startEdit(){t.f(this.$).Bu(!0);t.f(this.$).ha.ob.WH(this);this.sn.Cf.notifyAgave(this.Joa,OSF.AgaveHostAction.TabIn);return!0}z_c(){const sb=t.f(this.$);sb.ha.ob.KZ(this);sb.focus();return!0}x7f(){this.sn.Cf.notifyAgave(this.Joa,
OSF.AgaveHostAction.TabIn)}y7f(){this.sn.Cf.notifyAgave(this.Joa,OSF.AgaveHostAction.TabInShift)}oMa(sb){super.oMa(sb);this.isVisible=sb}rnc(){Ka.ULS.shipAssertTag(507867616,0,!da.AFrameworkApplication.disableWholeAppsForOfficeFeature,"MOEFloatingObjectControl:attachCallback - we should not get here when web extension is disabled");const sb=this.sn?e.Task.Va(this.sn):w.DdaFacadeService.Oa()?Object(Gb.d)(z.a.resolve(w.DdaFacadeService,{xa:0})):Pe.GetServiceTaskFactory.create(this.$.ra,106,this.Aa,
0);Yb.TaskExtensions.tb(sb,()=>{const Gc=!this.sn;this.sn=sb.result;this.sn.jMh(this);Gc&&this.sn.J7d(this)},this.Aa,3)}set NH(sb){super.NH=sb}}Object(u.a)(xf,"MOEFloatingObjectControl",rc.a,[231]);var Cf=a(947),tf=a(119);class Jf extends ue.a{constructor(sb,Gc,ad){super();this.zXd=this.pmb=this.m8=!1;this.$Wc=this.Foc=null;this.yDd=this.u_d=this.Gkb=this.ICa=this.K4f=this.nZf=this.J4f=this.mZf=!1;this.m_b=Wd=>{Wd.extension.ANa(Wd.floatingObject);Wd.gsb(this.m_b)};this.$=sb;this.zoom=ad;this.GDa=
Gc;this.m8=X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LoadGC2ShapesFromHostCache",!1);this.ICa=X.EwaSettings.isChangeGateEnabled("OfficeVSO:8651155_AddTelemetryForHostBundleConsumption");this.pmb=this.m8&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:8546928_SkipHtmlSanitizationForCachedGC2Shape");X.EwaSettings.isChangeGateEnabled("OfficeVSO:8682844_TelemetryForCreatorServiceOptimization")&&Ka.ULS.sendTraceTag(507568143,5,50,"ImageMOEFloatingObjectCreator:constructor: - In the constructor of the ImageMOEFloatingObjectCreator class.");
this.zXd=X.EwaSettings.isChangeGateEnabled("OfficeVSO:8567370_LogTimeDurationFromQueueToCreatorForCachedGC2Shapes");this.Foc=this.$.Vb.Pg("Task","HTMLSanitizationHelperService");this.$Wc=this.$.Vb.Pg("Task","HTMLSanitizationHelperService");this.Gkb=X.EwaSettings.isChangeGateEnabled("OfficeVSO:8668792_AdditionalTelemetryForGC2ShapesFromHostCache");this.u_d=X.EwaSettings.isChangeGateEnabled("OfficeVSO:8899796_ReplaceFOByBlockFOInCaseOFCachedAndServerFOMismatch");this.yDd=X.EwaSettings.isChangeGateEnabled("OfficeVSO:9009384_MoveReplacementOfFOWithBlockFOBeforeSkippingSanitization")}lEa(sb,
Gc){var ad;if(Gc&&(Ka.ULS.sendTraceTag(537162323,5,50,`ImageMOEFloatingObjectCreator:CreateFloatingObjectControl: Create Floating object called. ID: ${sb.Ec}, IsFromWorkbookCache: ${sb.gk}, Block: ${Gc.hash}, ContentSource: ${Gc.block.Cm}`),!Gc.block.Ak||sb.gk&&(!Gc.block.Ii.exists(sb)||!t.f(this.$).za.ti(Gc.hash)))){var Wd=nb.a(this.$)?nb.a(this.$).Xwa:null;tf.a.LKc(Wd?Wd[sb.id]:null,sb.Ec,!1,!0);tf.a.Yhe(sb.id,sb.Ec,nb.a(this.$));Ka.ULS.sendTraceTag(537162322,5,50,`ImageMOEFloatingObjectCreator:CreateFloatingObjectControl: Block or floating object mismatch. Control creation is skipped and placeholder removed. Id: ${sb.Ec}, Block: ${Gc.hash}`);
return}this.zXd&&(!this.mZf&&tf.a.Qkb(sb)?(this.Foc.start(),this.mZf=!0):this.J4f||sb.gk||!tf.a.YZa(sb)||(this.$Wc.start(),this.J4f=!0));const je=null===(ad=null===(Wd=null===Gc||void 0===Gc?void 0:Gc.block)||void 0===Wd?void 0:Wd.Ii)||void 0===ad?void 0:ad.find(sb);this.yDd&&this.u_d&&je&&tf.a.YZa(sb)&&tf.a.YZa(je)&&sb.gk&&!je.gk&&(sb=je,Ka.ULS.sendTraceTag(507015316,5,20,`ImageMOEFloatingObjectCreator.createFloatingObjectControl: Shape with ID: ${sb.Ec} has cached FO but block already has server FO. So due to this mismatch, we are replacing cached FO with block's server FO`));
this.pmb&&5===sb.type&&sb.bG&&sb.gk?(Ka.ULS.sendTraceTag(507787467,5,50,this.ICa?`ImageMOEFloatingObjectCreator.CreateFloatingObjectControl: Html Sanitization is skipped for cached GC2 shape with ID: ${sb.Ec} as it is server generated and would be replaced by next GFO call, so not harmful.`:"ImageMOEFloatingObjectCreator.CreateFloatingObjectControl :: Html Sanitization is skipped for cached GC2 shape"),this.Ryd(sb,Gc,null)):X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",
!1)?void z.a.resolve(w.HtmlSanitizationHelperService,{xa:0}).then(Ie=>{this.Ryd(sb,Gc,Ie)}):(Wd=Object(Gb.d)(z.a.resolve(w.HtmlSanitizationHelperService,{xa:0})),Yb.TaskExtensions.tb(Wd,Ie=>{this.Ryd(sb,Gc,Ie.result)},this.$.Aa,3))}Ryd(sb,Gc,ad){this.zXd&&(!this.nZf&&tf.a.Qkb(sb)?(this.Foc.stop(),Ka.ULS.sendTraceTag(507590285,5,50,`ImageMOEFloatingObjectCreator.CreateFloatingObjectControlInternal: Time duration for cached GC2 shape from queueing to creator: ${this.Foc.Kc} ms`),this.nZf=!0):this.K4f||
sb.gk||!tf.a.YZa(sb)||(this.$Wc.stop(),Ka.ULS.sendTraceTag(507590284,5,50,`ImageMOEFloatingObjectCreator.CreateFloatingObjectControlInternal: Time duration for server GC2 shape from queueing to creator: ${this.$Wc.Kc} ms`),this.K4f=!0));switch(sb.type){case 0:He.ChartFloatingObjectControl.aZc(sb)?this.p6h(sb,Gc,ad):this.kKb(sb,Gc,ad);break;case 9:case 4:this.kKb(sb,Gc,ad);break;case 1:if(ja.a.t_a()){var Wd=Gc.block.Ii.find(sb);Wd&&rb.a.oGc(sb,Wd)&&(sb=Wd);bf.GC2FloatingObjectControl.yse(sb)?this.Vyd(sb,
Gc,ad):this.kKb(sb,Gc,ad)}else this.kKb(sb,Gc,ad);break;case 5:Wd=Gc.block.Ii.find(sb);const je=this.u_d&&Wd&&sb.gk&&!Wd.gk;Wd&&rb.a.oGc(sb,Wd)&&(sb=Wd);!this.yDd&&je&&(sb=Wd,Ka.ULS.sendTraceTag(507122133,5,50,`ImageMOEFloatingObjectCreator.createFloatingObjectControlInternal: Shape with ID: ${sb.Ec} has cached FO but block already has server FO. So due to this mismatch, we are replacing cached FO with block's server FO`));bf.GC2FloatingObjectControl.yse(sb)?!this.m8&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:8551802_DontRenderCachedGC2ShapesInCreator")&&
sb.gk?Ka.ULS.sendTraceTag(507797576,5,50,this.ICa?`ImageMOEFloatingObjectCreator.createFloatingObjectControlInternal: As the flight LoadGC2ShapesFromHostCache is not yet enabled for current ring, return and do not render the cached GC2 shape with ID: ${sb.Ec}`:`ImageMOEFloatingObjectCreator.CreateFloatingObjectControlCommon: Return and don't render for cached floating object with ID: ${sb.Ec}`):(this.m8&&this.ICa&&sb.gk&&Ka.ULS.sendTraceTag(507585491,5,50,`ImageMOEFloatingObjectCreator.createFloatingObjectControlInternal: Create GC2 Floating Object Control for the cached GC2 shape with ID: ${sb.Ec}`),
this.Vyd(sb,Gc,ad)):this.kKb(sb,Gc,ad);break;case 8:this.Vyd(sb,Gc,ad);break;case 3:this.V8h(sb,Gc,ad);break;case 2:void z.a.resolve(w.SlicerManagerService,{xa:0}).then(Ie=>{Ie.Fai(sb,Gc,ad)})}}Qyd(sb,Gc,ad,Wd,je){var Ie,Je,$e;const Ib=this.$,Nb=nb.a(Ib);let Bc=Nb.fr(sb.Fh(),Gc);if(!Bc||!sb.E_a||Bc.bUb||!sb.Eka){var Af=t.f(Ib).VR&&tf.a.QXd(sb.type),gf=He.ChartFloatingObjectControl.aZc(sb),Qe=!!Bc&&Af!==Object(re.a)(Cf.a,Bc),Aa=!1;Qe=this.m8&&5===(null===(Ie=null===Bc||void 0===Bc?void 0:Bc.floatingObject)||
void 0===Ie?void 0:Ie.type)&&(null===(Je=null===Bc||void 0===Bc?void 0:Bc.floatingObject)||void 0===Je?0:Je.bG)&&(null===($e=null===Bc||void 0===Bc?void 0:Bc.floatingObject)||void 0===$e?0:$e.gk)&&5===(null===sb||void 0===sb?void 0:sb.type)&&(null===sb||void 0===sb?0:sb.bG)&&(null===sb||void 0===sb||!sb.gk)?!0:Qe;this.KQk()?Bc&&(Aa=He.ChartFloatingObjectControl.uyj(Bc)!==gf||rb.a.oGc(Bc.floatingObject,sb),Qe=Qe||Aa):Qe=Qe||!!Bc&&He.ChartFloatingObjectControl.aZc(Bc.floatingObject)!==gf;Qe&&(gf&&He.ChartFloatingObjectControl.Vif(Bc.floatingObject,
sb),Ka.ULS.sendTraceTag(537162320,5,50,`ImageMOEFloatingObjectCreator.CreateFloatingObjectControlCommon - Deleting FloatingObjectControl. ID:${Bc.floatingObject.Ec}, Type: ${Bc.floatingObject.type}, RenderType: ${Bc.floatingObject.renderType}, IsFromWorkbookCache: ${Bc.floatingObject.gk}, IsControlMismatch: ${Aa}`),Bc.CZa=Aa,Nb.deleteFloatingObject(Bc),Bc=null);if(Bc)Object(re.a)(Cf.a,Bc)&&sb.version>=Bc.clientVersion&&Bc.pjf(sb);else{if(Af){if(this.m8&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:8549765_DontRenderCachedGC2ShapesInMultipane")&&
5===(null===sb||void 0===sb?void 0:sb.type)&&(null===sb||void 0===sb?0:sb.bG)&&(null===sb||void 0===sb?0:sb.gk)){Ka.ULS.sendTraceTag(507787466,5,50,this.ICa?`ImageMOEFloatingObjectCreator.CreateFloatingObjectControlCommon: Return and don't render cached GC2 shape in multi-panes mode with ID: ${sb.Ec}`:"ImageMOEFloatingObjectCreator.CreateFloatingObjectControlCommon :: Don't render cached GC2 shape in multi-panes mode");return}Bc=new Cf.a(Ib,sb,this.GDa,je,this.zoom)}else Ka.ULS.sendTraceTag(537162319,
5,50,`ImageMOEFloatingObjectCreator.CreateFloatingObjectControlCommon: Creating floating object with ID: ${sb.Ec} RenderType: ${tf.a.zXa(sb.renderType)} Type: ${sb.type}`),Bc=ad(),Bc.cJ(sb);Nb.Gkc(Bc);this.e$b(Bc);Wd&&this.GDa.WGb(Ib,Bc)}Gc&&Bc&&sb.version>=Bc.clientVersion&&(Bc.ivb(Gc),this.m8&&5===(null===sb||void 0===sb?void 0:sb.type)&&(null===sb||void 0===sb?0:sb.bG)&&(null===sb||void 0===sb?0:sb.gk)?(this.Gkb&&Ka.ULS.sendTraceTag(507578199,5,50,`ImageMOEFloatingObjectCreator.CreateFloatingObjectControlCommon - Invoking anchorControl api with isInvokedByImageMOECreatorForCachedFO as true for cached GC2 shape with ID:${null===
sb||void 0===sb?void 0:sb.Ec}`),Bc.scb(sb,Gc,!0)):Bc.scb(sb,Gc),Bc.vSa(!1))}}kKb(sb,Gc,ad){this.Qyd(sb,Gc,()=>new af.a(this.$,sb,this.GDa,ad),!0,ad)}p6h(sb,Gc,ad){this.Qyd(sb,Gc,()=>new He.ChartFloatingObjectControl(this.$,sb,ad,this.zoom),!1,ad)}Vyd(sb,Gc,ad){this.Qyd(sb,Gc,()=>new bf.GC2FloatingObjectControl(this.$,sb,ad),!1,ad)}V8h(sb,Gc,ad){if(Gc&&!Gc.block.Ak)Ka.ULS.sendTraceTag(537162315,5,50,`ImageMOEFloatingObjectCreator:CreateMultiPanesFloatingObjectControl called After block was evicted, block position: ${Gc.block.We.BlockCachePosition}, floating object ID: ${sb.Ec}`);
else{var Wd=this.$,je=nb.a(Wd),Ie=je.fr(sb.Fh());Ie||(Ie=new xf(Wd,sb,ad),Ie.cJ(sb),je.Gkc(Ie),this.e$b(Ie));Gc&&Ie.scb(sb,Gc)}}e$b(sb){sb.extension?sb.extension.ANa(sb.floatingObject):sb.Rbb(this.m_b)}KQk(){return X.EwaSettings.isChangeGateEnabled("OfficeVSO:3868811_ShouldDeleteControlCG")}static Ea(sb){const Gc=Object(Gb.d)(z.a.resolve(w.ChartElementSelectableBehaviorManagerService,{xa:1})),ad=Object(Gb.d)(z.a.resolve(w.CommonUIStringsService,{xa:1})),Wd=Object(Gb.d)(z.a.resolve(w.ZoomService));
Yb.TaskExtensions.tb(Yb.TaskExtensions.jl([Gc,ad,Wd],sb.Aa),()=>{sb.ra.zc(70,new Jf(sb,Gc.result,Wd.result))},sb.ra.Aa,3)}}Object(u.a)(Jf,"ImageMOEFloatingObjectCreator",ue.a,[739]);var dg=a(430),uf=a(748),lf=a(435),Pf=a(115),Rf=a(563);class Mf extends ue.a{constructor(sb){super();this.da=t.f(sb);sb.ra.zc(103,this)}hA(sb,Gc,ad){const Wd=lf.a.pN(sb.paneType,sb.view.Ci);return Sa.a.hA(Wd,sb.domElement,Gc,ad)}BK(sb,Gc){const ad=lf.a.pN(sb.paneType,sb.view.Ci);return Sa.a.BK(ad,sb.domElement,Gc,sb.rtl)}l6b(sb,
Gc,ad,Wd){Sa.a.l6b(sb.domElement,Gc,ad,sb.rtl,Wd)}Dca(sb,Gc){sb=this.BK(sb,Gc);return new B.a(sb.x,sb.y,Gc.clientWidth,Gc.clientHeight)}WQg(sb,Gc,ad,Wd){ba.DOMElementExtensions.SG(Gc,ad.width);ba.DOMElementExtensions.P4(Gc,ad.height);this.l6b(sb,Gc,ad.topLeft,Wd)}X7a(sb){var Gc=sb.view;if(!Gc||!Gc.visibleArea)return null;Gc=this.VGa(sb);const ad=sb.qPd(Gc);let Wd=null;ad&&(sb=this.BK(sb,ad.domElement),Wd=new Sys.UI.Point(Gc.x-sb.x,Gc.y-sb.y));return ad?new uf.a(ad,Wd):null}VGa(sb){sb=sb.view.visibleArea;
const Gc=new Y.a(0,0);Gc.x=Math.round(sb.topLeft.x+sb.width/2);Gc.y=Math.round(sb.topLeft.y+sb.height/2);return Gc}vWc(sb,Gc,ad=!0){if((!ad||!sb.ul.ld(Gc))&&this.da&&this.da.view){var Wd=sb.paneType,je=this.da.view.Ci.clone(),Ie=sb.ul.topLeft;3!==Wd&&(Ie.y>Gc.y||Ie.y+sb.aq.y<Gc.y)&&(je.y=Math.max(0,Gc.y+(Gc.height-sb.aq.y)/2),je.y>Gc.y&&(je.y=Gc.y));4!==Wd&&(Ie.x>Gc.x||Ie.x+sb.aq.x<Gc.x)&&(je.x=Math.max(0,Gc.x+(Gc.width-sb.aq.x)/2),je.x>Gc.x&&(je.x=Gc.x));ad||(ad=Pf.a().sh(20),Gc.x<Ie.x?je.x=Math.max(0,
Gc.x-ad):Gc.x+Gc.width>Ie.x+sb.aq.x&&(je.x+=Gc.x+Gc.width-(Ie.x+sb.aq.x)+ad),Gc.y<Ie.y?je.y=Math.max(0,Gc.y-ad):Gc.y+Gc.height>Ie.y+sb.aq.y&&(je.y+=Gc.y+Gc.height-(Ie.y+sb.aq.y)+ad));this.da.view.Ci.equals(je)||(Ka.ULS.sendTraceTag(537150282,5,50,"ViewBlockContainerHelpers.ScrollToFitInPane: scrolls into the given view area"),Rf.a.vWc)}}dispose(){this.da=null;super.dispose()}}Object(u.a)(Mf,"ViewBlockContainerHelpers",ue.a,[759]);class zf extends dg.a{constructor(sb){super();this.$=sb;this.$.ra.zc(104,
this);this.ri()}get viewBlockContainerHelpers(){return this.$.ra.Tb(103)||new Mf(this.$)}create(){Yb.TaskExtensions.tb(Object(Gb.d)(z.a.resolve(w.CommonUIStringsService,{xa:this.Cc})),()=>{this.Uf(this.viewBlockContainerHelpers)},this.Aa,3)}dispose(){this.$=null;super.dispose()}static Ea(sb){new zf(sb)}}Object(u.a)(zf,"ViewBlockContainerHelpersFactory",dg.a,[]);class df extends Vc.a{constructor(sb){super(sb);this.create()}dispose(){super.dispose()}oq(){const sb=Pe.GetServiceTaskFactory.create(this.$.ra,
104,this.Aa,this.Cc),Gc=Object(Gb.d)(z.a.resolve(w.RibbonControlsService,{xa:this.Cc})),ad=Object(Gb.d)(z.a.resolve(w.PopulateDynamicHelperService,{xa:this.Cc})),Wd=Object(Gb.d)(z.a.resolve(w.MoreColorsHelperService,{xa:this.Cc}));Yb.TaskExtensions.tb(Yb.TaskExtensions.jl([sb,Gc,ad],this.Aa),()=>{const je=new db.ChartCommandHandler(this.$,sb.result,Gc.result,ad.result,Wd.result);this.fn([je])},this.Aa,3)}static Ea(sb){sb.ra.zc(97,new df(sb))}}Object(u.a)(df,"ChartCommandHandlerFactory",Vc.a,[]);var Bf=
a(156);class Kf extends ue.a{constructor(sb,Gc,ad){super();this.ypc=null;this.onKeyDown=Wd=>{var je=Wd.keyCode,Ie=this.chartView.$;eb.yre(Ie,this.chartView?this.chartView.Zc:null)&&(Kf.smj(Wd)&&40===je||Wd.shiftKey&&121===je||Wd.ctrlKey&&(66===je||73===je||85===je))&&(je=this.shortcutKeyManager.yy(Wd),Ie=new pa.a(je,1,Ie.xc,6,null),this.Ia.iCc(Wd,Ie))};this.chartView=sb;this.shortcutKeyManager=Gc;this.Ia=ad;this.k9e(this.chartView.Chb)}dispose(){mb.a.vb(this.ypc);this.shortcutKeyManager=this.Ia=this.chartView=
null;super.dispose()}HWh(){mb.a.vb(this.ypc);this.k9e(this.chartView.Chb)}k9e(sb){this.ypc=Bf.a.instance.pf(sb);this.ypc.Ea("keydown",this.onKeyDown)}static Ea(sb){const Gc=Ca.a(sb);var ad=sb.$b;ad=ad.allowInteractivity&&ad.allowPivotSpecificOperations;Gc&&ad&&Gc.MKk(new Kf(Gc,sb.shortcutKeyManager,sb.Ia))}static smj(sb){return sb.altKey||sb.rawEvent.metaKey||0===sb.rawEvent.charCode}}Object(u.a)(Kf,"ChartViewKeyboardHandler",ue.a,[738,4]);class Vf extends Vc.a{constructor(sb){super(sb)}oq(){const sb=
nb.a(this.$).Zka(8),Gc=w.InkOverlayService.Oa()?e.Task.Va(null):Object(Gb.d)(z.a.resolve(w.ZoomService)),ad=w.InkOverlayService.Oa()?Object(Gb.d)(z.a.resolve(w.InkOverlayService,{xa:this.Cc})):e.Task.Va(null);Yb.TaskExtensions.tb(Yb.TaskExtensions.jl([sb,Gc,ad],this.$.ra.Aa),()=>{this.fn([new xd(this.$,ad.result,Gc.result)])},this.$.ra.Aa,3)}static Ea(sb){const Gc=new Vf(sb);sb.ra.zc(379,Gc)}}Object(u.a)(Vf,"InkCommandHandlerFactory",Vc.a,[]);Type.registerNamespace("Common.App.ImageProcessor");(()=>
{dc.a.Pha=Pd.FloatingObjectControlExtension.h9e;Cf.a.Pha=Pd.FloatingObjectControlExtension.h9e;Xb.a.wb(sb=>{Jf.Ea(sb);w.FloatingObjectCommandHandlerService.Oa()&&X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseCommandRouterSyncFlow",!1)?void z.a.resolve(w.FloatingObjectCommandHandlerService).then(Gc=>sb.Ia.Bc.Srb(sb,Gc)):yd.Ea(sb);nb.a(sb).krd()})})();a(1503);Xb.a.wb(zf.Ea);(()=>{db.ChartCommandHandler.initData();Ba.ChartElementManager.initData();Xb.a.wb(sb=>{w.ChartCommandHandlerService.Oa()?
void z.a.resolve(w.ChartCommandHandlerService).then(Gc=>sb.Ia.Bc.Srb(sb,Gc)):df.Ea(sb);Kf.Ea(sb);w.InkCommandHandlerService.Oa()||Vf.Ea(sb)})})();String(c);String(b);String(db);String(Ba);String(f);String(k);String(d);String(x);String(h);String(n);window.___1717508060459_closurehack=c;window.___1717508060459_closurehack=b;window.___1717508060459_closurehack=db;window.___1717508060459_closurehack=Ba;window.___1717508060459_closurehack=f;window.___1717508060459_closurehack=k;window.___1717508060459_closurehack=
d;window.___1717508060459_closurehack=x;window.___1717508060459_closurehack=h;window.___1717508060459_closurehack=n},947:function(y,r,a){a.d(r,"a",function(){return K});y=a(0);var c=a(15),b=a(91),f=a(154);r=a(267);var k=a(211),x=a(953),d=a(31),h=a(49),n=a(74),m=a(1132),u=a(17),l=a(119);class t extends x.a{constructor(I,L,J,B){super(I,L,d.a.vFa,B,l.a.u6d,!1);this.Sca=this.pY=null;this.fH=I.Wf;this.sN=null;this.gCb=J;this.cJ(L);this.cW(d.a.QVa,!0);this.isVisible=!1}get grid(){return this.fH}get Z1(){if(n.b(this.$.la))return this.pY||
(this.pY=new h.a(this.da.nn,this.da.uz)),this.pY;this.Sca||(this.Sca=new h.a(this.da.nn,this.da.uz));return this.Sca}get ic(){return this.gCb}get Ug(){this.sN||(this.sN=u.DOMElementExtensions.getLocation({element:this.grid}));const I=u.DOMElementExtensions.getLocation({element:this.get_element()});return m.a(this,new h.a(I.x-this.sN.x,I.y-this.sN.y))}dispose(){this.sN=this.fH=null;super.dispose()}STd(I){m.b(this,I)}V5b(I,L){m.c(this,I,L)}hide(){this.isVisible=!1}Pke(){n.b(this.$.la)&&(this.pY=null)}J8b(){return!1}c7b(){return!1}tNd(){return"@G"}}
Object(y.a)(t,"AboveGridFloatingObjectControl",x.a,[703,314,4,704]);class e extends Sys.EventArgs{constructor(I){super();this.KP=I}}Object(y.a)(e,"ChildAddedOrRemovedEventArgs",Sys.EventArgs,[]);var w=a(1278),z=a(42),E=a(1),M=a(99),G=a(25),A=a(433),N=a(45);class K extends r.a{constructor(I,L,J,B,Y){super(document.createElement("div"));this.xk=null;this.vba=0;this.Mc=this.ll=this.ada=this.$J=this.Qd=this.iT=this.cCb=null;this.HUj=U=>{U=Object(f.a)(314,U);if(U.floatingObject.version<this.clientVersion)this.vba=
0;else{this.vba++;var O=this.Rt.values.length-(this.iT?1:0);c.ULS.sendTraceTag(23069526,5,50,`MultiPanesFloatingObjectControl.OnChildImageLoaded: childrenLoadedCount: ${this.vba}, all viewportChildren count: ${this.Rt.values.length}, childPendingRemoval: ${!!this.iT}, aboveGrid isVisible: ${this.Qd.isVisible}, childPaneType: ${U?l.a.Wvg(U.floatingObject.dC):"null"}, controlType: ${U?l.a.tC(U.floatingObject):"null"}`);this.vba>=O&&(this.vba>this.Rt.values.length&&c.ULS.sendTraceTag(537162245,5,15,
"MultiPanesFloatingObjectControl.OnChildImageLoaded: childrenLoadedCount exceeded viewportChildren count"),this.QRb(),this.cvc(),this.$J&&(this.$J.uke(this),this.$J.Hoe(this.floatingObject.Zc)),this.raiseEvent(l.a.V7a),this.raiseEvent(l.a.GYa))}};this.Mc=B;this.fH=I.Wf;this.Qb=I;this.zoom=Y;this.Rt=new z.a(!1);this.lga=new z.a(!1);this.GDa=J;this.pjf(L);this.cvc();E.EwaSettings.isChangeGateEnabled("OfficeVSO:4390665_fixMPFOC_VisualContainer_XLUID")?this.ll=this.Jm?this.Jm.ll:null:this.ll=L.ll;K.Pha&&
K.Pha(this,L);this.ep=!1}Sbb(I){this.get_events().addHandler(l.a.GYa,I)}hsb(I){this.get_events().removeHandler(l.a.GYa,I)}xFb(I){this.get_events().addHandler(l.a.pvd,I)}oie(I){this.get_events().removeHandler(l.a.pvd,I)}klc(I){this.get_events().addHandler(l.a.rvd,I)}QGg(I){this.get_events().removeHandler(l.a.rvd,I)}Qlc(I){this.get_events().addHandler(l.a.V7a,I)}K3b(I){this.get_events().removeHandler(l.a.V7a,I)}Rbb(I){this.get_events().addHandler(l.a.fhb,I)}gsb(I){this.get_events().removeHandler(l.a.fhb,
I)}a4e(I){this.get_events().addHandler(l.a.lfb,I)}XGg(I){this.get_events().removeHandler(l.a.lfb,I)}get grid(){return this.fH}get isEditing(){return!!this.Qd&&this.Qd.isVisible&&this.Qd.isEditing}get children(){if(void 0===this.Rt||null===this.Rt)return c.ULS.sendTraceTag(537162274,5,15,"MultiPanesFloatingObjectControl.Children: Accessing Children when viewportChildren is null"),null;this.Rt.count||c.ULS.sendTraceTag(537162273,5,15,"MultiPanesFloatingObjectControl.Children: Accessing viewportChildren when their count is 0");
return this.Rt.values}get nbf(){return void 0===this.lga||null===this.lga?null:this.lga.values}get $(){return this.Qb}get isVisible(){return this.Jm.isVisible}set isVisible(I){if(this.children)for(const L of this.children)L.isVisible=I;I&&this.QRb()}get domElement(){return this.Qd&&this.Qd.isVisible?this.Qd.domElement:this.Jm.domElement}get_element(){return this.domElement}get MUa(){return this.Jm.MUa}get Bsc(){return this.Jm.Bsc}get s4c(){return x.a.dMd(this.cx)}get Tj(){return this.Jm.Tj}get Zd(){return this.Jm.Zd}get cx(){return this.Qd&&
this.Qd.isVisible&&this.Qd.cx?this.Qd.cx:this.Jm.cx}get clientVersion(){let I=this.cCb.clientVersion;if(this.children)for(const L of this.children)L.clientVersion>I&&(I=L.clientVersion);return I}set clientVersion(I){if(this.children)for(const L of this.children)L.clientVersion=I}get BL(){c.ULS.shipAssertTag(537162270,5,!1,"MultiPanesFloatingObjectControl.RotatePoint: Property is used for FloatingObjectControl and shouldn't be accessed for MultiPanesFloatingObjectControl");return this.Jm.BL}get XE(){return this.floatingObject.XE}get CZa(){if(this.children)for(const I of this.children)if(I.CZa)return!0;
return!1}set CZa(I){if(this.children)for(const L of this.children)L.CZa=I;this.Qd&&(this.Qd.CZa=I)}get Xd(){return this.ep}showE1ODialog(){this.Jm.showE1ODialog()}get Ug(){return this.Jm.Ug}get $j(){return this.Jm.$j}get Vp(){return!!this.$j}get VNa(){return this.Jm.VNa}get IE(){return this.Jm.IE}get extension(){return this.xk}set extension(I){const L=!this.xk&&!!I;b.a.vb(this.xk);this.xk=I;L&&this.raiseEvent(l.a.fhb)}get floatingObject(){return this.Jm.floatingObject}get RI(){return this.cCb.RI}get da(){return G.f(this.$)}get $C(){E.EwaSettings.hE();
return this.Jm.$C}get Tvd(){return this.Jm.Tvd}get mu(){return this.Jm.mu}get movable(){return this.Jm.movable}get o4c(){return this.Jm.o4c}set o4c(I){for(const L of this.children)L.o4c=I}get expanded(){return this.Jm.expanded}set expanded(I){for(const L of this.children)L.expanded=I}get DTa(){return this.Jm.DTa}get PRc(){return this.Jm.PRc}set PRc(I){for(const L of this.children)L.PRc=I}get KRc(){return this.Jm.KRc}set KRc(I){for(const L of this.children)L.KRc=I}get i2(){return this.Jm.i2}set i2(I){for(const L of this.children)L.i2=
I}get DDc(){return this.children.every(I=>I.DDc)}get lSb(){return this.children&&this.Rt.count?this.children.every(I=>I.lSb):!1}get LH(){return this.Jm.LH}get Jm(){return this.cCb}get p_a(){return!0}get uXd(){return!1}pjf(I){var {ChartFloatingObjectControl:L}=a(1094);const {GC2FloatingObjectControl:J}=a(1015);this.iT&&this.iT.floatingObject.dC===I.dC&&(this.iT=null);if(!this.xja(I.dC)){const B=l.a.PCi+l.a.Wvg(I.dC);E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.MultipaneFOCCaching",
!1)&&this.lga.getItem(I.dC.toString())?(L=Object(f.a)(314,this.lga.getItem(I.dC.toString())),this.lga.remove(I.dC.toString())):(L=a(1094).ChartFloatingObjectControl.aZc(I)?new L(this.$,I,this.Mc,this.zoom,B,!1):a(1015).GC2FloatingObjectControl.yse(I)?new J(this.$,I,this.Mc,B,!1):new w.a(this.$,I,this.GDa,this.Mc,B,!1),L.cJ(I),L.Sbb(this.HUj));this.Rt.add(I.dC.toString(),L);this.cCb=this.oN();this.raiseEvent(l.a.pvd,new e(L))}}dispose(){if(this.$){const I=G.f(this.$);(null===I||void 0===I?0:I.ha)&&
I.ha.ob.Wb===this&&I.ha.ob.WH(this,!1)}b.a.xd([this.xk]);this.Rt&&b.a.xd(this.Rt.values);this.lga&&b.a.xd(this.lga.values);this.xk=null;b.a.vb(this.Qd);this.Mc=this.lga=this.Rt=this.fH=this.Qb=this.Qd=null;super.dispose();this.ep=!0}select(I){this.extension&&this.extension.select(I);const L=!!this.$&&E.EwaSettings.isChangeGateEnabled("OfficeVSO:4413245_fixInkFreezePaneSelection")&&!!this.floatingObject&&5===this.floatingObject.renderType;if(this.R_a()||L){for(const J of this.children)J.select(I,!1);
this.Qd&&(this.Qd.select(I,!1),I||this.QRb())}}P_c(I,L){this.R_a()&&this.oN().P_c(I,L)}O_c(I){this.R_a()&&this.oN().O_c(I)}Q_c(I){this.R_a()&&this.oN().Q_c(I)}R_c(){this.R_a()&&this.oN().R_c()}ntc(I,L){this.R_a()&&this.oN().ntc(I,L)}moveElementByKey(I){this.oN().moveElementByKey(I)}getSelectionDescription(){return this.R_a()?this.oN().getSelectionDescription():null}FQb(I){return this.KTb()?this.oN().FQb(I):null}yQb(I){return this.KTb()?this.oN().yQb(I):null}Gb(I,L){this.oN().Gb(I,L)}pCc(I,L){this.oN().pCc(I,
L)}vya(I){return this.oN().vya(I)}getContextMenuButtonList(){return this.KTb()?this.oN().getContextMenuButtonList():null}u5b(){return this.KTb()?this.oN().u5b():null}OWc(){return this.KTb()?this.oN().OWc():null}clc(I){this.SRa(I,L=>{L.clc(I)})}h3b(I){this.SRa(I,L=>{L.h3b(I)})}yBd(){for(const I of this.children)I.yBd()}VQd(){for(const I of this.children)if(I.VQd())return!0;return!1}Khe(I){const L=this.xja(I.block.We.BlockCachePosition.PaneType);return L?L.Khe(I):!1}DSa(I,L=!1){this.SRa(I,J=>{J.DSa(I,
L)})}mjb(){return!!this.xk&&this.xk.mjb()}scb(I,L){this.SRa(L,J=>{J.scb(I,L)});this.xk&&this.xk.ANa(I);this.Qd.floatingObject.gk&&!I.gk&&this.Qd.cJ(I,!1)}Q8b(){for(const I of this.children)I.Q8b()}Zrb(I){this.SRa(I,L=>{L.Zrb(I,!1);L.$j||this.lBd(L)});I.block.Ak||this.$&&this.i2||this.QRb()}Ovd(){for(const I of this.children)I.Ovd()}K2c(I){this.SRa(I,L=>{L.K2c(I,!1);L.$j||this.lBd(L)})}cJ(I,L=!1){this.xja(I.dC).cJ(I,L)}Gna(){}mJg(){}ZSa(){this.Jm.ZSa()}xT(){this.Jm.xT()}p$d(){}cvc(){this.floatingObject||
c.ULS.sendTraceTag(537162250,5,15,`MultiPanesFloatingObjectControl:EnsureAboveGridFloatingObjectControl: FloatingObject is null, IsDisposed: ${this.Xd}`);const I=l.a.oeb(this.floatingObject);I.ZOrder++;const L=new k.a(I);this.Qd||(this.Qd=this.wIi(L));this.clientVersion<=I.Version&&(this.Qd.cJ(L),this.Qd.E2c(L))}HMa(I){this.vba=0;this.cvc();this.Qd.STd(I);this.xk.aKg()}yia(I,L,J){for(const B of this.children)B.yia(I,L,J);this.Qd.yia(I,L,J)}f1(I){for(const L of this.children)L.f1(I);this.Qd&&this.Qd.f1(I)}tFc(I){for(const L of this.children)if(L.tFc(I))return!0;
return this.Qd?this.Qd.tFc(I):!1}xUa(I){for(const L of this.children)L.xUa(I);this.Qd&&this.Qd.xUa(I)}isa(I){for(const L of this.children)L.isa(I);this.Qd&&this.Qd.isa(I)}H2c(I,L,J){if(this.children)for(const B of this.children)B&&B.H2c(I,L,J)}Knd(I){if(this.children)for(const L of this.children)null===L||void 0===L?void 0:L.Knd(I)}eie(I){if(this.children)for(const L of this.children)null===L||void 0===L?void 0:L.eie(I)}I2c(I){if(this.children)for(const L of this.children)L&&L.I2c(I)}yza(I){for(const L of this.children)L.yza(I);
for(const L of this.nbf)L.yza(I);this.Qd&&this.Qd.isVisible&&this.Qd.yza(I)}E2c(I){const L=this.xja(I.dC),J=parseInt(L.get_element().style.width,10);for(const B of this.children)if(B.floatingObject.version===I.version&&B.floatingObject.width===I.width+1&&J===I.width+1){I=B.floatingObject;break}L.E2c(I)}c$b(I,L){this.Qd&&this.Qd.c$b(I,L)}C2c(I){this.Qd&&this.Qd.C2c(I)}D2c(I){this.Qd&&this.Qd.D2c(I)}wAe(I,L){for(const J of this.children)J.wAe(I,L)}cW(I,L){for(const J of this.children)J.cW(I,L)}UXc(I){for(const L of this.children)L.UXc(I);
this.Qd&&this.Qd.UXc(I)}ffa(I,L=!0){for(const J of this.children)J.ffa(I,L,!1);this.Qd&&this.Qd.ffa(I,L,!1);A.c(this.$,I&&(!this.Qd||!this.Qd.isVisible),"MultiPaneFOControl:SetChromeDivAndHandlesVisibility")}setFocus(){this.$C&&(this.da.focus(),this.da.ha.ob.KZ(this))}x2(){return this.Jm.x2()}xda(){return this.Jm.xda()}$Jb(){}cuc(){}ova(){return this.Jm.ova()}Gda(){c.ULS.shipAssertTag(537162248,5,!1,"MultiPanesFloatingObjectControl.LogImageLoad: Cannot log abstract object.")}Taa(){return this.Jm.Taa()}g_a(){return this.Jm.g_a()}isElementMovementInProgress(){return this.Jm.isElementMovementInProgress()}restoreElementPosition(){this.Jm.restoreElementPosition()}R_d(){return E.EwaSettings.isChangeGateEnabled("OfficeVSO:4390665_fixMPFOC_VisualContainer_XLUID")?
!!this.floatingObject&&0===this.floatingObject.type:!1}get bUb(){return this.Jm.bUb}HOb(){return this.xk?this.xk.HOb():(c.ULS.shipAssertTag(537162247,5,!1,"FOC.GenerateBase64Image was called with extension not ready"),"")}Zhb(){return this.xk?this.xk.Zhb():(c.ULS.shipAssertTag(537162246,5,!1,"FOC.GenerateBase64Image was called with extension not ready"),null)}qma(){for(const I of this.children)I.qma();this.Qd.qma()}ivb(I){this.SRa(I,L=>{L.ivb(I)})}JGc(){return this.Jm.JGc()}vSa(I=!0){if(I||this.JGc()){for(const L of this.children)L.vSa(I);
this.Qd.vSa(I);b.a.vb(this.xk);this.xk=null;K.Pha(this,this.floatingObject);!N.a(this.$).ks()&&this.extension&&this.extension.ANa(this.floatingObject)}}xja(I){return Object(f.a)(314,this.Rt.getItem(I.toString()))}rnc(){}QRb(){const I=this.Qd;I&&I.isVisible&&(I.hide(),this.iT&&this.lBd(this.iT),this.vba=0)}SRa(I,L){(I=this.xja(I.block.We.BlockCachePosition.PaneType))&&L(I)}oN(){return this.xja(2)||this.xja(3)||this.xja(4)||this.xja(1)}l5a(){throw Error.notImplemented();}lBd(I){1<this.Rt.count?(I===
this.iT&&(this.iT=null),E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.MultipaneFOCCaching",!1)&&(this.lga.add(I.floatingObject.dC.toString(),I),I.isVisible=!1),this.Rt.remove(I.floatingObject.dC.toString()),this.cCb=this.oN(),this.vba=0<this.vba?this.vba-1:0,this.raiseEvent(l.a.rvd,new e(I)),E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.MultipaneFOCCaching",!1)||I.dispose(),this.vba===this.Rt.values.length-(this.iT?1:0)&&(this.iT&&c.ULS.sendTraceTag(537162244,
5,50,"MultiPanesFloatingObjectControl.DeleteChild: childPendingRemoval exists when hiding AboveGrid"),this.QRb(),this.cvc(),this.raiseEvent(l.a.V7a),this.raiseEvent(l.a.GYa))):this.Qd&&this.Qd.isVisible?(this.iT&&this.iT.floatingObject.dC!==I.floatingObject.dC&&c.ULS.sendTraceTag(537162243,5,15,"MultiPanesFloatingObjectControl.DeleteChild: control to delete is different than childPendingRemoval"),this.iT=I):this.iT!==I&&M.a(this.$).deleteFloatingObject(this)}R_a(){return!!this.$&&E.EwaSettings.Ra(407)&&
!!this.floatingObject&&this.floatingObject.E_a}KTb(){return E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSChartRightClickFloatie",!1)}wIi(I){const {ChartAboveGridFloatingObjectControl:L}=a(1501),{GC2AboveGridFloatingObjectControl:J}=a(1502);switch(I.renderType){case 3:return new L(this.$,I,this,this.Mc,this.zoom);case 5:return new J(this.$,I,this,this.Mc)}return new t(this.$,I,this,this.Mc)}bAc(){if(!this.floatingObject||8!==this.floatingObject.type)return null;var I=this.children;
if(!I)return null;const L={};for(const J of I)if(I=J.bAc())for(const B in I)L[B]=I[B];return L}w0f(){return!0}uBg(){this.raiseEvent(l.a.lfb)}}K.Pha=null;Object(y.a)(K,"MultiPanesFloatingObjectControl",r.a,[314,4,704,310])},983:function(y,r,a){a.r(r);a.d(r,"FloatingObjectControlExtension",function(){return mb});y=a(0);var c=a(15),b=a(393),f=a(91),k=a(182),x=a(363),d=a(154),h=a(195),n=a(31),m=a(49),u=a(207),l=a(211),t=a(953),e=a(65),w=a(5),z=a(88),E=a(213),M=a(81),G=a(944),A=a(43),N=a(1033),K=a(1032),
I=a(1272),L=a(1273),J=a(1270),B=a(1463),Y=a(1053),U=a(1462),O=a(1461);class C{constructor(Ma,hb,$a,Va){this.id=null;this.top=this.left=this.type=0;this.id=Ma;this.type=hb;this.left=$a;this.top=Va}getId(){return this.id}}Object(y.a)(C,"MacroRecorderFloatingObjectMovedAndResizedPayload",null,[67]);class X{constructor(Ma,hb){this.id=null;this.absoluteRotation=0;this.id=Ma;this.absoluteRotation=hb}getId(){return this.id}}Object(y.a)(X,"MacroRecorderFloatingObjectRotatedPayload",null,[67]);var S=a(947),
ea=a(1271);a(33);var Oa=a(17),Ha=a(769),Za=a(36),fa=a(1),la=a(266),ba=a(119),aa=a(99),oa=a(25),Na=a(435),Ia=a(59),Sa=a(611);class Pa{constructor(Ma){this.JIj=Ma;this.nLc=this.JIj.Pg("UserAction","ImageProcessor")}QXk(Ma,hb){let $a=null;if(Ma){let Va=Ma.width,xa=Ma.height;hb=this.k1i(Va,xa,hb);Va=Math.floor(Va*hb);xa=Math.floor(xa*hb);try{$a=this.Zii(Ma,Va,xa)}catch(ia){c.ULS.sendTraceTag(20841027,826,15,"ShrinkHTML5ImageByResolution failed. Error message: "+ia.message+", Call stack: "+ia.stack)}}return $a}Zii(Ma,
hb,$a){if(0>=hb||0>=$a)return null;let Va;this.nLc.start();var xa=document.createElement("canvas");xa.width=hb;xa.height=$a;var ia=xa.getContext("2d");Va=this.nLc.Kc;ia.drawImage(Ma,0,0,hb,$a);ia=this.nLc.Kc-Va;xa=xa.toDataURL("image/png");Ma=String.format("DoShrink: Before={0}x{1},After={2}x{3},CreateCanvas={4}ms,DrawImage={5}ms,ToDataURL={6}ms",Ma.width,Ma.height,hb,$a,Va,ia,this.nLc.Kc-(Va+ia));c.ULS.sendTraceTag(20841028,813,50,Ma);return xa}k1i(Ma,hb,$a){return 0>=Ma||0>=hb?0:0<$a&&(Ma>$a||hb>
$a)?Math.min($a/Ma,$a/hb):1}get URL(){return window.URL||window.webkitURL}}Object(y.a)(Pa,"ImageProcessor",null,[760]);var za=a(29),wa=a(399),db=a(45),Ba=a(1001),Ka=a(115),da=a(12);const sa=1/1.1;class mb{constructor(Ma,hb){this.ERc=this.q1b=!1;this.tLb=0;this.ama=null;this.Lxa=this.FJa=this.FLa=0;this.Ieb=this.Uo=this.oqe=this.ekb=this.tk=this.TI=this.ns=this.ev=null;this.Xha=this.Zha=this.$ha=this.Yha=0;this.QUb=this.Z_f=!1;this.$Bj=80;this.ZBj=50;this.YBj=40;this.aCj=180;this.XBj=5;this.$8f=12;
this.Udi=54;this.Hdh="EditorContainer";this.ePc=()=>{this.OEa();this.control.isEditing&&this.control.extension.endEdit();this.control.ZSa();this.Uo&&this.Uo.UQj()};this.ypb=($a,Va)=>{this.J_b($a,Va)};this.Hpg=()=>{this.Xd||(c.ULS.sendTraceTag(537162379,5,50,`FloatingObjectControlExtension.OnMoveAndResizeFailed: Operation failed. FreezePanes support: ${this.control.da.VR}, type = ${this.control.floatingObject.type}`),2===this.control.floatingObject.type&&Sa.a(this.control.$).zpb(this.control.floatingObject,
!1))};this.Ipg=$a=>{!this.Xd&&$a&&(Za.a.zf($a.Errors)?c.ULS.sendTraceTag(537162377,5,50,`FloatingObjectControlExtension.OnMoveAndResizeSuccess: Operation succeeded with errors. FreezePanes support: ${this.control.da.VR}, Errors: ${Za.a.pc($a.Errors)}, type = ${this.control.floatingObject.type}`):c.ULS.sendTraceTag(537162378,5,50,`FloatingObjectControlExtension.OnMoveAndResizeSuccess: Operation succeeded. FreezePanes support: ${this.control.da.VR}, type = ${this.control.floatingObject.type}`),2===
this.control.floatingObject.type&&Sa.a(this.control.$).zpb(this.control.floatingObject,!0))};this.GOc=()=>{this.o$d()};this.Rsg=()=>{if(this.ev){const $a=this.control.da.ha.ob.yZd;this.ev.eMb=!$a;this.control.cW(n.a.QVa,!$a);this.control.cW(n.a.bqi,$a)}};this.qog=($a,Va)=>{this.tk&&(Va.selected?this.tk.yia(Va.inputMethod):this.tk.f1());this.Uo&&(Va.selected?this.Uo.xUa():this.Uo.isa());this.ev&&(this.ev.eMb=Va.selected);Va.selected&&this.ns&&this.ns.upgrade(this.control.floatingObject);Va.selected?
(this.JOb(!1),this.control.da.ha.ob.NXd||this.hte()):this.OEa()};this.hte=($a=!1)=>{const Va=[Ba.a.zTg];if(this.QUb&&this.control&&this.control.$.isEditMode&&5===this.control.floatingObject.type){c.ULS.sendTraceTag(507328035,5,50,"FloatingObjectControlExtension.showLeftClickFloatie: Left Click Floatie triggered for Shapes");const xa=da.HelperMethods.isStandardZoomCssSupportedByBrowser?Oa.DOMElementExtensions.getLocation({element:this.control.domElement,di:!0}):Sys.UI.DomElement.getLocation(this.control.domElement),
ia=da.HelperMethods.isStandardZoomCssSupportedByBrowser?Oa.DOMElementExtensions.getLocation({element:this.control.Tj.parentElement,di:!0}):Sys.UI.DomElement.getLocation(this.control.Tj.parentElement),Z=da.HelperMethods.isStandardZoomCssSupportedByBrowser?Oa.DOMElementExtensions.getLocation({element:this.control.Tj,di:!0}):Sys.UI.DomElement.getLocation(this.control.Tj),ta=null!==ba.a.XNd(this.control.floatingObject,!0)?$a?this.xLd(Z):this.xLd(ia):this.xLd(xa);void e.a.resolve(w.ContextMenuControllerService,
{xa:3}).then(pa=>{pa.Qub(Va,new Sys.UI.Bounds(ta.x,ta.y,0,0),2)})}};this.OEa=()=>{this.QUb&&void e.a.resolve(w.ContextMenuControllerService,{xa:3}).then($a=>{$a.mlb()&&$a.jC()})};this.fPc=($a,Va)=>{this.control.c$b(Va.width,Va.height);this.Uo&&this.Uo.TQj(Va.xK,Va.yK)};this.onFloatingObjectControlVersionChanged=$a=>{this.TI&&this.TI.upgrade($a);this.tk&&this.tk.upgrade($a.floatingObject);this.ns&&this.ns.upgrade($a.floatingObject);this.Uo&&this.Uo.upgrade($a.floatingObject);this.tLb=0;this.ERc=this.JKd()};
this.q_b=()=>{this.tk&&(this.tk.ULa(),this.tk.X3||this.tk.RRd());this.ns&&this.ns.ULa();this.Uo&&this.Uo.ULa();this.tLb=0;!this.control.da.rb.mj&&this.control.domElement.parentNode&&(this.ama=mb.viewBlockContainerHelpers.BK(this.control.Ug,this.control.domElement));this.ERc=this.JKd();this.selected?this.JOb():this.Mhe();this.Lxa=this.FJa=this.FLa=0};this.control=Ma;this.Ep=[];this.yzd();this.Kyd();this.Hyd(hb);Ma.$C&&Ma.movable&&(this.control.Qlc(this.onFloatingObjectControlVersionChanged),this.control.Sbb(this.q_b));
hb=this.control.da;hb=mb.c5h(hb.rb.Lu,hb.rb.Wv,Ma.floatingObject);1<hb&&this.nGj(Ma.floatingObject,hb);(Ma=this.control.$?aa.a(this.control.$):null)&&Ma.a5e(this.Rsg);this.Xd=!1;this.Z_f=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8627680_EwaControlNullCheck");(this.QUb=fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LeftClickFloatieForFloatingObjects",!1))&&window.addEventListener&&(window.addEventListener("scroll",this.OEa,!1),window.addEventListener("zoom",this.OEa,!0))}get cxb(){return this.hMc||
!!this.ns&&this.ns.Bva}get b7(){return this.ev}get Isb(){return this.tk}get VK(){return this.ns}get SLg(){return this.Uo}get selected(){return!!this.TI&&this.TI.selected}get hMc(){return!!this.ev&&this.ev.jrf||!!this.tk&&this.tk.X3||!!this.Uo&&this.Uo.D4a}select(Ma){this.ekb&&this.ekb.Oud(Ma);this.fyg();this.TI.selected=Ma}ANa(Ma){this.ev&&this.ev.jrf?(this.control.wAe(this.Zha-this.Yha,this.Xha-this.$ha),this.ev.update()):this.tk&&this.tk.X3?this.tk.update():this.ns&&this.ns.Bva?this.ns.update():
this.Uo&&this.Uo.D4a?this.Uo.update():(this.control.E2c(Ma),this.eTh(Ma));this.tk&&(this.tk.zIndex=t.a.jOa+2*Ma.XE+1,this.tk.Qva=Ma.Qva,this.tk.X3||this.tk.W3(Ma));this.Uo&&!this.Uo.D4a&&this.Uo.l4a();this.bzd();this.Czd();this.Ieb&&this.Ieb.update(Ma)}Vfa(Ma,hb){this.tLb=Ma;this.TI&&this.TI.Vfa(Ma);this.tk&&this.tk.Vfa(Ma);this.ns&&this.ns.Vfa(Ma);hb&&this.Uo&&this.Uo.Vfa(Ma)}mjb(){if(this.cxb||this.control.floatingObject.Skb)this.control.i2=!0;return this.control.i2}dispose(){this.ocf(!0);this.fii();
this.control&&this.control.movable&&(this.control.K3b(this.onFloatingObjectControlVersionChanged),this.control.hsb(this.q_b));this.control.ada&&this.Mhe();this.Ieb=this.Uo=this.ekb=this.tk=this.ns=this.ev=this.TI=null;const Ma=this.control.$?aa.a(this.control.$):null;Ma&&Ma.KHg(this.Rsg);this.QUb&&window.removeEventListener&&(window.removeEventListener("scroll",this.OEa,!1),window.removeEventListener("zoom",this.OEa,!0));this.Xd=!0}ocf(Ma=!1){this.hMc&&b.a.instance.Xtd();(Ma||!this.hMc)&&this.TI&&
this.TI.selected&&this.control.da.ha.ob.WH(this.control)}P7d(Ma){this.ns?this.ns.P7d(Ma):c.ULS.sendTraceTag(537162392,5,50,`FloatingObjectControlExtension.Nudge: this.isDisposed: ${this.Xd}`)}mAj(Ma){if(this.control.movable&&this.ns){let hb=1;Ma&8?hb=1.1:Ma&4&&(hb=sa);this.ns.resize(Ma,!1,hb,hb)}}ync(Ma,hb){this.ns&&this.ns.resize(3,!0,Ma,hb)}nAj(Ma){this.HVb(!0)&&this.ns&&this.ns.rotate(Ma)}Lni(){this.fyg()}aKg(){this.Uo&&this.Uo.l4a();this.tk&&this.tk.W3(null)}jPc(){this.OEa();this.control.isEditing&&
this.control.extension.endEdit();this.control.ffa(!1);this.control.ZSa()}Hpb(Ma){Ma=ba.a.MJa(Ma);this.TI.selected&&this.control.ffa(!0);this.control.xT();this.control.i2=!1;if(this.TLg(Ma))this.control.clientVersion--;else{this.Lxa+=1;var hb=this.control.floatingObject.id;this.control.da.rb.mj||(this.ama=mb.viewBlockContainerHelpers.BK(this.control.Ug,this.control.domElement));this.Oni();fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FOResizeHandlesFix",!1)&&this.tk.D1h(Ma);var $a=this.control.$,
Va=$a.ma.sa;this.sEc();var xa=new E.a(523,0,(ia,Z,ta)=>K.g(Va,hb,Ma,ia,Z,ta,null),64,()=>new X(hb,Ma));xa.fc=$a.Dia(727263662,2);$a.userOperationManager.enqueueOperation(xa,null);this.hte(!0)}}Ani(){if(this.ama){var Ma=mb.viewBlockContainerHelpers.BK(this.control.Ug,this.control.domElement),hb=this.ama.y-Ma.y;Ma=this.ama.x-Ma.x;if(hb||Ma)this.ama.y-=hb,this.ama.x-=Ma,this.control.mJg(hb,Ma)}}HOb(){const Ma=this.control.ada?this.control.ada:this.control.s4c;return Ma?this.control.floatingObject.Nkb?
Ma.attributes.getNamedItem(h.a.src).value:this.Uxd(Ma,new Pa(this.control.$.Vb)):""}Zhb(){const Ma=new k.a;za.a.Qua()&&this.control.floatingObject.KQ?this.JOb(!0,!0):this.JOb();const hb=this.control.ada?this.control.ada:this.control.s4c;if(hb)if(this.control.floatingObject.Nkb)Ma.setResult(hb.attributes.getNamedItem(h.a.src).value);else if(this.control.floatingObject.isSvg||this.control.floatingObject.E_a||this.control.floatingObject.bG){const $a=new Ha.a(hb);$a.Ea("load",()=>{var Va;!this.Z_f||(null===
(Va=this.control)||void 0===Va?0:Va.$)?Ma.setResult(this.Uxd(hb,new Pa(this.control.$.Vb))):(c.ULS.sendTraceTag(507601417,5,15,`FloatingObjectControlExtension.generateBase64ImageAsync: Setting base64 result to null as FO is already disposed. IsDisposed: ${this.Xd}.`),Ma.setResult(null));$a.detach("load")})}else Ma.setResult(this.Uxd(hb,new Pa(this.control.$.Vb)));else Ma.setResult("");return Ma.task}ZEg(){this.TI.mEh(this.qog)}KEg(){this.ev.f4e(this.ypb);this.ev.e4e(this.GOc)}x9(Ma){b.a.instance.x9(Ma.domElement,
this.ev)}QEg(){this.ns.BEh(this.ypb);this.ns.zod(this.fPc)}rUg(){return!this.ekb&&this.control.x2()&&this.control.$.$b.Uaa(8)}sUg(){return!this.oqe&&this.control.xda()&&this.control.$.ZW}Nfg(Ma){return!Ma.qnb&&!Ma.bwb&&!Ma.$sb&&!Ma.mdb&&this.enj()}e2c(Ma){b.a.instance.Rfa(Ma.domElement,this.ev)}TLg(Ma){return ba.a.MJa(Ma)===ba.a.MJa(this.control.floatingObject.Sb.Rotation)}fyg(){this.q1b||(this.dzd(),this.CUa(),this.vzd(),this.q1b=!0)}bzd(){this.rUg()&&(this.ekb=new J.a(this.control),c.ULS.sendTraceTag(537162390,
5,50,`FloatingObjectControlExtension.CreateImageHyperLinkBehavior: Create ImageHyperLinkBehavior for control Id: ${this.control.floatingObject?this.control.floatingObject.Ec:"null"}`))}Czd(){this.sUg()&&(this.oqe=new ea.a(this.control),c.ULS.sendTraceTag(537162389,5,50,`FloatingObjectControlExtension.CreateShapeRunFromButtonBehavior: Create ShapeRunFromButtonBehavior for control Id: ${this.control.floatingObject?this.control.floatingObject.Ec:"null"}`))}yzd(){this.control.$C&&(this.TI=new O.a(this.control),
this.ZEg())}vzd(){this.HVb()&&(this.Uo=new U.a(this.control.domElement,this.control,this.Ep,mb.viewBlockContainerHelpers))}Hyd(Ma){this.Ieb=new I.a(this.control,Ma)}Kyd(){this.control.$C&&this.control.movable&&(this.ev=new L.a(this.control,mb.viewBlockContainerHelpers),this.KEg(),this.x9(this.control))}dzd(){this.control.$C&&(this.ns=new B.a(this.control.domElement,this.control.da,this.control,mb.viewBlockContainerHelpers,this.Ep),this.QEg())}CUa(){this.control.movable&&(this.tk=new Y.a(this.control.domElement,
this.control.da,this.control,this.Ep,mb.dT,mb.viewBlockContainerHelpers),this.eTc())}eTc(){this.tk.UFh(this.fPc);this.tk.TFh(this.ypb);this.tk.SFh(this.GOc);this.tk.Xod(this.ePc)}Rfa(){this.e2c(this.control)}startEdit(){this.control.startEdit()}endEdit(){this.control.endEdit()}bua(Ma,hb){this.control.handleCommand(Ma,hb)}dCc(Ma,hb){this.control.floatingObject.KQ?this.control.handleCommand(Ma,hb):(c.ULS.sendTraceTag(507527239,306,15,"FloatingObjectControlExtension: Not a GC2 FOC = {0}",this.control.floatingObject.Ec),
Ma=Za.a.Cd(1,0,2561,2562,0,382441300,"ImageEditingUnsupported"),db.a(this.control.$).Wi(Ma))}handleQueryCommand(Ma,hb){this.control.handleQueryCommand(Ma,hb)}updateTransformDuringOperation(Ma,hb,$a,Va,xa){this.control.updateTransformDuringOperation(Ma,hb,$a,Va,xa)}updateTransformResizeEnded(Ma,hb){this.control.updateTransformResizeEnded(Ma,hb)}shouldShowFloatie(Ma,hb){return this.control.shouldShowFloatie(Ma,hb)}KJk(){Object(x.a)(S.a,this.control)||this.control.lya(wa.a.b5)}uyk(){Object(x.a)(S.a,
this.control)||this.control.lya(this.control.floatingObject.XE)}NBd(){this.tk&&this.tk.f1();this.Uo&&this.Uo.isa();this.ev&&(this.ev.eMb=!1);fa.EwaSettings.isChangeGateEnabled("OfficeVSO:9006371_CropUpdateGreenBorder")?this.control.C2c(ba.a.H3g):this.control.Tj.style.borderColor=ba.a.H3g;fa.EwaSettings.isChangeGateEnabled("OfficeVSO:9011106_RemoveDragCursorAtTheCropEdges")&&this.control.D2c("default")}smd(){fa.EwaSettings.isChangeGateEnabled("OfficeVSO:9006371_CropUpdateGreenBorder")?this.control.C2c(ba.a.Qia):
this.control.Tj.style.borderColor=ba.a.Qia;fa.EwaSettings.isChangeGateEnabled("OfficeVSO:9011106_RemoveDragCursorAtTheCropEdges")&&this.control.D2c("move")}Lud(Ma){this.control.onEditStatusChanged(Ma)}mRi(Ma){let hb,$a,Va,xa;hb=null;xa=Va=$a=0;let ia;if(Object(x.a)(t.a,this.control))ia=oa.f(this.control.$).pg(1),Ma=this.control,hb=mb.viewBlockContainerHelpers.Dca(ia,this.control.domElement);else if(Object(x.a)(S.a,this.control)){ia=oa.f(this.control.$).pg(Ma);Ma=Object(d.a)(S.a,this.control).xja(Ma);
if(!Ma)return{returnValue:!1,VNa:hb,rotation:$a,translateX:Va,translateY:xa};hb=mb.viewBlockContainerHelpers.Dca(ia,Ma.domElement)}else return c.ULS.sendTraceTag(537162381,5,10,"FloatingObjectControlExtension.GetFloatingObjectViewportAreaAndTransform: Failed to retrieve viewportArea."),{returnValue:!1,VNa:hb,rotation:$a,translateX:Va,translateY:xa};if(!hb.Xe(ia.ul))return{returnValue:!1,VNa:hb,rotation:$a,translateX:Va,translateY:xa};Ma.ova()&&($a=ba.a.XNd(Ma.floatingObject,!0)+this.tLb,Va=hb.x-ia.ul.x+
hb.width/2,xa=hb.y-ia.ul.y+hb.height/2);return{returnValue:!0,VNa:hb,rotation:$a,translateX:Va,translateY:xa}}fii(){this.ev&&(this.ev.aHg(this.GOc),this.ev.bHg(this.ypb),this.Rfa());this.tk&&(this.tk.Auk(this.GOc),this.tk.Buk(this.ypb),this.tk.Cuk(this.fPc),this.tk.f1());this.Uo&&this.Uo.isa();this.ns&&(this.ns.utk(this.ypb),this.ns.Lie(this.fPc));this.TI&&this.TI.gtk(this.qog);this.hMc&&b.a.instance.Xtd();f.a.xd([this.TI,this.ev,this.ns,this.tk,this.Uo,this.Ieb])}J_b(Ma,hb){this.control.xT();Ma=
this.control.$;this.control.i2=!1;this.Nfg(hb)?this.control.clientVersion--:(this.control.da.rb.mj||(this.ama=mb.viewBlockContainerHelpers.BK(this.control.Ug,this.control.domElement)),this.Yha=Math.min(this.Yha+hb.qnb,2147483647),this.$ha=Math.min(this.$ha+hb.bwb,2147483647),this.Zha=Math.min(this.Zha+hb.$sb,2147483647),this.Xha=Math.min(this.Xha+hb.mdb,2147483647),this.rHd(hb.Ug),this.sEc(),this.JOb(),hb.Gmj||(hb=this.$lf(hb),hb.fc=Ma.Dia(-1036601044,2),Ma.userOperationManager.enqueueOperation(hb,
null)),this.hte(),this.control.p$d())}$lf(Ma){const hb=this.control.floatingObject.type;let $a=this.control.floatingObject.id;2===hb&&($a=this.control.ll,Sa.a(this.control.$).HOc(this.control.floatingObject));const Va=this.Yha,xa=this.$ha,ia=this.Zha,Z=this.Xha,ta=Ma.txe,pa=Ma.uxe,Ga=this.control.$.ma.sa;return new E.a(524,0,(Ca,kb,eb)=>K.e(Ga,hb,$a,Va,xa,ia,Z,ta,pa,la.c(Ca,this.Ipg),la.b(kb,this.Hpg),eb,null),64,()=>new C($a,hb,Va,xa))}HVb(){if(!this.control||!this.control.floatingObject)return!1;
const Ma=this.control.floatingObject.Sb;return this.control.movable&&this.control.ova()&&!!Ma&&!this.control.floatingObject.$4f}o$d(){const Ma=Object(d.a)(t.a,this.control);2===this.control.floatingObject.type&&Sa.a(this.control.$).zpb(this.control.floatingObject,!1);Ma.i2?(Ma.i2=!1,aa.a(this.control.$).deleteFloatingObject(this.control)):(Ma.cJ(Ma.floatingObject),Ma.l6=null,Ma.Q8b());Ma.xT()}rHd(Ma){const hb=this.control;this.oQg(hb.floatingObject);const $a=mb.viewBlockContainerHelpers.Dca(Ma,hb.domElement);
hb.Ovd();let Va=!1;for(const ta of Ma)for(const pa of ta){var xa=mb.viewBlockContainerHelpers.Dca(Ma,pa.domElement);if($a.ld(xa)){var ia=pa.hashCode;const Ga=hb.da.za.ti(ia);if(Ga){var Z=Ga.Ii.find(hb.floatingObject);Z?this.oQg(Z):(Z=ba.a.oeb(hb.floatingObject),Z=new l.a(Z),Ga.Ii.add(Z));xa=G.a.OL($a.topLeft,xa.topLeft);Z.offsetX=xa.x;Z.offsetY=xa.y;this.lJg(Z);ia=new u.a(Ga,ia);hb.clc(ia);hb.$j&&hb.$j.equals(ia)&&(Va=!0)}else c.ULS.sendTraceTag(537162374,5,15,`FixAnchorAndSpannedBlocksForMove: BlockCacheItem is null in block, hash: ${ia}`)}}!Va&&
0<hb.IE.count&&(Ma=hb.IE.Mh(0),hb.DSa(Ma))}lJg(){}oQg(Ma){Ma.Lu=this.Yha;Ma.Wv=this.$ha;Ma.OW=this.Zha;Ma.c0=this.Xha;Ma.width=this.Zha-this.Yha;Ma.height=this.Xha-this.$ha}eTh(Ma){this.Yha=Ma.Lu;this.$ha=Ma.Wv;this.Zha=Ma.OW;this.Xha=Ma.c0}enj(){const Ma=this.control.floatingObject;return this.Yha===Ma.Lu&&this.$ha===Ma.Wv&&this.Zha===Ma.OW&&this.Xha===Ma.c0}xLd(Ma){var hb,$a,Va,xa,ia,Z=0,ta=0;const pa=Ka.a();Ma&&pa&&(Z=document.getElementById(this.Hdh),ta=null===(hb=null===Z||void 0===Z?void 0:
Z.getBoundingClientRect())||void 0===hb?void 0:hb.top,hb=null===($a=null===Z||void 0===Z?void 0:Z.getBoundingClientRect())||void 0===$a?void 0:$a.left,$a=null===(Va=null===Z||void 0===Z?void 0:Z.getBoundingClientRect())||void 0===Va?void 0:Va.bottom,ta=Ma.y<ta?ta+pa.sh(this.$Bj):pa.sh(Ma.y+this.$8f),Z=Ma.x<hb?hb+pa.sh(this.ZBj):pa.sh(Ma.x+this.XBj),Va=this.control.BL,(null===Va||void 0===Va?0:Va.qO)&&0>parseInt(null===(xa=Va.qO.style)||void 0===xa?void 0:xa.top,10)&&parseInt(null===(ia=Va.qO.style)||
void 0===ia?void 0:ia.left,10)<this.aCj&&(ta=pa.sh(Ma.y+(0<this.control.Tj.offsetHeight?this.control.Tj.offsetHeight:this.control.floatingObject.height))+(0<Va.qO.offsetHeight?Va.qO.offsetHeight:this.Udi)+this.$8f,ta>$a&&(ta=$a-pa.sh(this.YBj))));return new Sys.UI.Point(Z,ta)}nGj(Ma,hb){const $a={};$a.a=this.control.$.ta.UserSessionId;$a.b=Ma.type;$a.c=Ma.Ec;$a.d=hb;Ia.logDataOncePerSession(28,$a)}sEc(){this.control.da.za.o2()}Oni(){if(this.control.floatingObject.Sb){var Ma=this.JKd();this.ERc!==
Ma&&(this.ERc=Ma,Ma=this.control.floatingObject.Ova.XNb(),this.Yha=Ma.topLeft.x,this.$ha=Ma.topLeft.y,this.Zha=Ma.bottomRight.x,this.Xha=Ma.bottomRight.y)}}JOb(Ma=!0,hb=!1){if(!(this.control.bUb||4!==this.control.floatingObject.renderType&&!this.control.floatingObject.E_a&&!this.control.floatingObject.bG||za.a.Qua()&&this.control.floatingObject.KQ&&!hb||this.control.ada&&!Ma)){this.Mhe();var $a=this.control.Bsc;if($a){Ma=this.control.$.Vb.Uc("Task","GenerateCopyableImage");hb=document.createElement("img");
if(za.a.Qua()&&this.control.floatingObject.KQ){$a=this.control instanceof S.a?this.control.Qd:this.control;var Va=$a.Dqf();c.ULS.sendTraceTag(507798423,5,50,`FloatingObjectControlExtension.generateCopyableImage: Floating Object Id: ${$a.floatingObject.Ec}, DoesPictureHaveProps: ${Va}`);hb.src=$a.L3h()}else Va=(new XMLSerializer).serializeToString($a),hb.height=$a.clientHeight,hb.width=$a.clientWidth,hb.src=URL.createObjectURL(new Blob([Va],{type:"image/svg+xml;charset=utf-8"}));this.control.ada=hb;
Ma.stop()}}}Mhe(){this.control.ada&&(URL.revokeObjectURL(this.control.ada.src),this.control.ada=null)}Uxd(Ma,hb){const $a=new Image;$a.src=Ma.attributes.getNamedItem(h.a.src).value;$a.height=Ma.height;$a.width=Ma.width;return hb.QXk($a,Math.max($a.height,$a.width))}JKd(){const Ma=this.control.floatingObject.Sb;return Ma?ba.a.p8(Ma.Rotation+this.tLb,Ma.FlipX!==Ma.FlipY):!1}static get viewBlockContainerHelpers(){return mb.hbb}static get dT(){return mb.Pbc}static h9e(Ma,hb){if(Ma.$C)if(mb.viewBlockContainerHelpers&&
mb.dT)Ma.extension=mb.dkf(Ma,hb);else{const $a=Object(z.d)(e.a.resolve(w.BehaviorsFactoryServiceService,{xa:0})),Va=M.GetServiceTaskFactory.Ne(Ma.$.ra,103,104,0);A.TaskExtensions.tb(A.TaskExtensions.jl([Va,$a],Ma.Aa),()=>{mb.Pbc=$a.result;mb.hbb=Va.result;Ma.extension||(Ma.extension=mb.dkf(Ma,hb))},Ma.Aa,3)}}static dkf(Ma,hb){const {MultiPanesConnectorFloatingObjectControlExtension:$a}=a(1626),{MultiPanesFloatingObjectControlExtension:Va}=a(1619),{ConnectorFloatingObjectControlExtension:xa}=a(1279);
return Object(x.a)(S.a,Ma)?5===hb.type&&ba.a.BN(hb.Sb)?new $a(Ma,hb):new Va(Ma,hb):5===hb.type&&ba.a.BN(hb.Sb)?new xa(Ma,hb):new mb(Ma,hb)}static Bpd(Ma,hb,$a,Va,xa){var ia=Va.extension;null===ia||void 0===ia?void 0:ia.OEa();ia=$a.paneType;const Z=Va.da,ta=$a.Nn,pa=$a.aq;xa=xa?new m.a(0,0):Z.view.Ci;let Ga=0,Ca=0,kb=0,eb=0;0>Ma.x?(Ga=ta.x,kb=-Na.a.pN(ia,xa).x,ia=mb.Cyc(ia,!1)):Ma.x>ta.x+pa.x&&(2===ia||4===ia)&&(ia=mb.Cyc(ia,!1),Ga=-pa.x,kb=Na.a.pN(ia,xa).x);0>Ma.y?(Ca=ta.y,eb=-Na.a.pN(ia,xa).y,ia=
mb.Cyc(ia,!0)):Ma.y>ta.y+pa.y&&(2===ia||3===ia)&&(ia=mb.Cyc(ia,!0),Ca=-pa.y,eb=Na.a.pN(ia,xa).y);if(Ga||Ca)N.a(Ma,Ga+kb,Ca+eb),N.a(hb,Ga,Ca),Oa.DOMElementExtensions.vh(Va.domElement),$a=Z.pg(ia),Ma=$a.zCf,Ma.insertBefore(Va.domElement,Ma.firstChild);return $a}static Cyc(Ma,hb){switch(Ma){case 2:return hb?4:3;case 3:return hb?1:2;case 4:return hb?2:1;case 1:return hb?3:4}return 0}static c5h(Ma,hb,$a){return $a?($a.Wv<hb&&$a.Wv+$a.height>hb?2:1)*($a.Lu<Ma&&$a.Lu+$a.width>Ma?2:1):1}}mb.hbb=null;mb.Pbc=
null;Object(y.a)(mb,"FloatingObjectControlExtension",null,[740,4])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.fo.js.map/a9e0c8d9fc72fb34f11aa316b9a594cd/EwaTS.fo.js.map