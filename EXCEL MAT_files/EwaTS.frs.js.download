'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[2],{1362:function(y,r,a){r=a(490);a=a(1562);a=a.Di?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);r(a,{insert:"head",Oj:!1});y.exports=a.Fk||{}},1558:function(y,r,a){r=a(490);a=a(1559);a=a.Di?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);r(a,{insert:"head",Oj:!1});y.exports=a.Fk||{}},1559:function(y,r,a){r=a(489)(!1);r.push([y.i,".insert-media-dialog-old{width:870px;float:left;margin-top:7px}.insert-media-dialog{width:870px;width:clamp(400px,870px,80vw);float:left;margin-top:7px}.app-rtl .insert-media-dialog{float:right}.insert-media-frame{width:100%;height:100%;visibility:visible}.insert-media-panel-old{height:550px}.insert-media-panel{height:550px;height:clamp(300px,550px,90vh)}.keep-focus-start{position:absolute;width:-1000px;top:-1000px}.keep-focus{position:absolute;width:-1000px;top:1000px}.display-none{display:none}.padding-zero{padding:0}",
""]);y.exports=r},1560:function(y,r,a){r=a(490);a=a(1561);a=a.Di?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);r(a,{insert:"head",Oj:!1});y.exports=a.Fk||{}},1561:function(y,r,a){r=a(489)(!1);r.push([y.i,".ewr-selection-draghandle-grab{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto;cursor:grab}.ewr-selection-draghandle-top{top:-2px;left:-2px;right:-2px;height:calc(1px + 4px / var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom{right:0;left:-2px;bottom:calc(-1px - 2px / var(--zoom-level-canvas,1));height:calc(1px + 2px / var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left{top:0;left:calc(-1px - 1px / var(--zoom-level-canvas,1));bottom:0;width:calc(1px + 5px / var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right{top:0;right:-2px;bottom:0;width:calc(1px + 5px / var(--zoom-level-canvas,1))}.ewr-selection-draghandle-top-updated{border-top:1px solid transparent;top:-2px;left:-2px;right:-2px;height:calc(3.5px / var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-updated{border-top:.75px solid transparent;right:0;left:-2px;bottom:-2px;height:calc(2.5px / var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-updated{border-left:1.25px solid transparent;top:0;left:-2px;bottom:0;width:calc(5px / var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-updated{border-right:1.25px solid transparent;top:0;right:-2px;bottom:0;width:calc(5px / var(--zoom-level-canvas,1))}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:fit-content;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr-selection-drag-tooltip,.ewr-selection-drag-tooltip-fluent{position:absolute;background-color:#fff;box-shadow:0 0 2px 0 rgba(0,0,0,.12),0 4px 8px 0 rgba(0,0,0,.15);outline:1px solid transparent;border-radius:4px;height:fit-content;width:max-content;font-size:10px;padding:4px 8px 6px 8px}.ewr-selection-drag-tooltip{pointer-events:none;z-index:53;left:0;top:0}.ewr-selection-drag-tooltip-shift-instruction{font-style:italic;color:#8A8886}.ewa-root-ltr .ewr-selection-draghandle-reduced .ewr-selection-draghandle-right{width:calc(3px / var(--zoom-level-canvas,1))}.ewa-root-rtl .ewr-selection-draghandle-reduced .ewr-selection-draghandle-left{width:calc(3px / var(--zoom-level-canvas,1))}.ewr_selection_rearrangeleft{border-left:3px solid #107C41;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #107C41;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #107C41;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #107C41;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr_selection_rearrange-flange-left,.ewr_selection_rearrange-fullrowcol-flange-left{border-left:3px solid #107C41;border-radius:1.5px;position:absolute;height:10px;width:0;left:-2px;top:-3.5px}.ewr_selection_rearrange-flange-right,.ewr_selection_rearrange-fullrowcol-flange-right{border-right:3px solid #107C41;border-radius:1.5px;position:absolute;height:10px;width:0;right:-5px;top:-3.5px}.ewr_selection_rearrange-flange-top,.ewr_selection_rearrange-fullrowcol-flange-top{border-top:3px solid #107C41;border-radius:1.5px;position:absolute;width:10px;height:0;top:-2px;left:-3.5px}.ewr_selection_rearrange-flange-bottom,.ewr_selection_rearrange-fullrowcol-flange-bottom{border-bottom:3px solid #107C41;border-radius:1.5px;position:absolute;width:10px;height:0;bottom:-5px;left:-3.5px}.ewr_selection_rearrange-fullrowcol-flange-left{left:0}.ewr_selection_rearrange-fullrowcol-flange-right{right:-3px}.ewr_selection_rearrange-fullrowcol-flange-top{top:0}.ewr_selection_rearrange-fullrowcol-flange-bottom{bottom:-3px}.ewr-cell-selection-highlight-all-after-fluent.selecting .ewr-selection-draghandle-grab{cursor:unset}.ewr-selection-drag-shadow{position:absolute;top:0;background-color:#107C41;opacity:15%;z-index:52;pointer-events:none;border-radius:2px}.ewa-grid-ltr .ewr-selection-drag-shadow{left:0}.ewa-grid-rtl .ewr-selection-drag-shadow{right:0}@media (forced-colors:active){.ewr-selection-drag-shadow{forced-color-adjust:none;background-color:#fff;opacity:20%}}@media (forced-colors:active) and (prefers-color-scheme:light){.ewr-selection-drag-shadow{background-color:#000}}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#107C41;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{left:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft{right:-4px}.ewr-marquee-thick{z-index:calc(10 + 1)!important;border-width:3px!important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px!important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0!important}.ewr-resizemarqueehandle-thick{height:6px!important;width:6px!important}",
""]);y.exports=r},1562:function(y,r,a){r=a(489)(!1);r.push([y.i,".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}",
""]);y.exports=r},1563:function(y,r,a){(function(c){a.d(r,"a",function(){return K});var b=a(0),f=a(15),k=a(189),x=a(154),d=a(1564),h=a(41),n=a(227),m=a(44),u=a(429),l=a(213),t=a(61),e=a(83),w=a(13),z=a(25),E=a(48),M=a(1565),G=a(1),A=a(98),N=a(5);class K extends h.a{constructor(I,L,J,B){super();this.dej=d.a.getTypeName();this.kSb=this.J0=this.fc=null;this.imageHeight=this.imageWidth=0;this.HYa=this.errorMessage=this.yvb=null;this.vSd=0;this.imd=!1;this.Pmf=Y=>{if(Y){var U={};if((()=>{let X=E.d(this.qdi(Y.data));
({Ws:U}=X);return X})().returnValue){var O=Object(x.a)(Object,U);if("."===O.DataFromPictureWildcard)if(O.SessionId!==this.HYa)f.ULS.sendTraceTag(523805139,0,10,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(f.ULS.sendTraceTag(523805138,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane"),O.CmdType){case "ACK":this.imd=!0;this.r1g.stop();f.ULS.sendTraceTag(523805137,
0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - SDX pane launched.");this.$Fk();0<this.errorMessage.length?this.WOg():0<this.yvb.length&&this.pPg();break;case "insert_html":const X=this.$.ma.sa,S={};var C=z.f(this.$).ha.oa.Ed.clone();S.PasteId=k.a.create().toString();S.DestinationRanges=m.v(m.y(C,this.$));C=O.Parameters.split("|",3);G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveCCforDataFromPictureXLO",!1)||f.ULS.sendTraceTag(523805136,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - LCC:${C[0]}|${C[1]}|${C[2]}.`);
C=O.Parameters.indexOf("|");C=O.Parameters.indexOf("|",C+1);C=O.Parameters.indexOf("|",C+1);S.SourceHtml=O.Parameters.substring(C+1);S.CopyOperationId=null;const ea=X.$a(1,X.mc());ea.pasteHtmlParameters=S;u.a(this.$.userOperationManager,(Oa,Ha,Za)=>t.h(X,"pasteHtmlContent",ea,Oa,Ha,Za,null,64),Oa=>new l.a(204,0,Oa,1),null);this.vSd++;f.ULS.sendTraceTag(523805135,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - Number of pastes to workbook per Session ID:${this.vSd.toString()}`);
A.b("DataFromPictureCompleted")}}}};this.cej=(Y,U)=>{if(Y=U.annotation)if(!U.parentPath||1>=U.parentPath.length||U.parentPath[1]!==this.HYa)f.ULS.sendTraceTag(523805124,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{f.ULS.sendTraceTag(523805123,0,50,"DataFromPictureManager.ImageToTableAnnotationHandler() - Annotation Received.");U=Y.errorCode;switch(U){case null:case -1:this.errorMessage=w.a.instance.ia(2273);
break;case 1:this.errorMessage=w.a.instance.ia(2274);break;case 2:this.errorMessage=w.a.instance.ia(2275)}0<this.errorMessage.length&&f.ULS.sendTraceTag(523805122,0,10,`DataFromPictureManager.ImageToTableAnnotationHandler() - ErrorCode:${U?U.toString():"null"}.`);this.U6e.stop();this.yvb=Y.html;this.imd&&(0<this.errorMessage.length?this.WOg():0<this.yvb.length&&this.pPg())}else f.ULS.sendTraceTag(523805125,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - Received annotation is null.")};
this.$=I;this.ddaFacade=B;this.hj=L;this.uploaderCreator=J;this.initialize()}dispose(){window.removeEventListener("message",this.Pmf,!1);this.hj.unregister("DataFromPicture");super.dispose()}X5j(I,L){f.ULS.sendTraceTag(523805146,0,50,"DataFromPictureManager.onSuccessfulFileLoad - Start function.");let J=new Image;J.onload=()=>{var B=document.createElement("canvas");B.width=J.width;B.height=J.height;const Y=B.getContext("2d");try{Y.drawImage(J,0,0,J.width,J.height)}catch(C){f.ULS.sendTraceTag(523805145,
0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't draw to canvas. ex.Message: ${C.message}`);return}let U;try{U=B.toDataURL("image/jpeg")}catch(C){f.ULS.sendTraceTag(523805144,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg. ex.Message: ${C.message}`);return}B=U.split(",");if(2>B.length)f.ULS.sendTraceTag(523805143,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg.");else{B=B[1];try{var O=window.self.atob(B)}catch(C){f.ULS.sendTraceTag(523805142,
0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't convert image to byte string. ex.Message: ${C.message}`);return}28E5<O.length?(f.ULS.sendTraceTag(523805141,0,15,"DataFromPictureManager.onSuccessfulFileLoad - Image exceeds max size limit."),L.eVk()):(this.QBk(this.fc,this.J0,B,J.width,J.height),URL.revokeObjectURL(J.src),J=null,f.ULS.sendTraceTag(523805140,0,50,"DataFromPictureManager.onSuccessfulFileLoad - End function."))}};J.src=I}wek(I,L,J,B){this.fc=I;this.J0=B;this.uploaderCreator.uhj(this.$,
L,J,B,this)}QBk(I,L,J,B,Y){this.HYa=k.a.create().toString();this.vSd=0;this.kSb=J;this.imageWidth=B;this.imageHeight=Y;this.errorMessage=this.yvb="";this.imd=!1;this.r1g=this.$.Vb.Pg("LoadResource","DataFromPictureTaskpaneLaunch");this.r1g.start();this.B8j(I,L);this.U6e=this.$.Vb.Pg("LoadResource","DataFromPictureAnnotation");this.U6e.start();this.vgl()}vgl(){if(this.kSb.length){var I=window.self.atob(this.kSb),L=new Uint8Array(I.length);for(let J=0;J<I.length;J++)L[J]=I.charCodeAt(J);this.hj.ugl(L,
this.HYa,this.imageWidth,this.imageHeight)}else f.ULS.sendTraceTag(523805134,0,10,"DataFromPictureManager.UploadImageToAugmentationLoop - imageDataBase64 is empty")}B8j(I,L){L.SessionID=this.HYa;L.DataFromPictureAssetId="FA000000050";L.LoadDataFromPictureTaskpane=!0;I=new e.a(-859308420,I.method,I.mode,I.Re,I.tabName);this.$.Ia.Gb(I,L)}ADd(I){try{const L=c.from(I,"utf16le").toString("base64");return M.a.sUa(this.HYa,L)}catch(L){return f.ULS.sendTraceTag(523805133,0,10,"DataFromPictureManager.encodeAndEncrypt - Buffer can't encode message."),
""}}qdi(I){try{const L=M.a.sUa(this.HYa,I);return c.from(L,"base64").toString("utf16le")}catch(L){return f.ULS.sendTraceTag(523805132,0,50,"DataFromPictureManager.decryptAndDecode - Buffer can't decode message."),""}}$Fk(){if(this.kSb.length){var I=N.DdaFacadeService.Oa()?this.ddaFacade.UX("FA000000050"):n.a(this.$).UX("FA000000050"),L={["DataFromPictureWildcard"]:"."};L.imageData=this.ADd(this.kSb);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(I,"onCustomMessage",L,J=>{J&&f.ULS.sendTraceTag(523805130,
0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else f.ULS.sendTraceTag(523805131,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")}pPg(){if(this.yvb.length){var I=N.DdaFacadeService.Oa()?this.ddaFacade.UX("FA000000050"):n.a(this.$).UX("FA000000050"),L={["DataFromPictureWildcard"]:"."};L.tableHtml=this.ADd(this.yvb);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(I,"onCustomMessage",
L,J=>{J&&f.ULS.sendTraceTag(523805128,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else f.ULS.sendTraceTag(523805129,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")}WOg(){if(this.errorMessage.length){var I=N.DdaFacadeService.Oa()?this.ddaFacade.UX("FA000000050"):n.a(this.$).UX("FA000000050"),L={["DataFromPictureWildcard"]:"."};L.errorMessage=this.ADd(this.errorMessage);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(I,
"onCustomMessage",L,J=>{J&&f.ULS.sendTraceTag(523805126,0,10,"DataFromPictureManager.sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else f.ULS.sendTraceTag(523805127,0,10,"DataFromPictureManager.sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")}initialize(){window.addEventListener("message",this.Pmf,!1);this.hj.register(this.hj.RT().NV("DataFromPicture").LV(()=>{}).activateAnnotation({annotationType:this.dej,ls:!1,
dO:this.cej}).build())}}Object(b.a)(K,"DataFromPictureManager",h.a,[816])}).call(this,a(795).Buffer)},1564:function(y,r,a){a.d(r,"a",function(){return b});y=a(0);r=a(614);var c=a(367);class b extends r.a{constructor(){super();this.html=this.errorDescription=this.errorCode=null;this.H_=Object.assign(new c.a,{T_:b.getTypeName(),B_:b.getBaseTypes()})}static getTypeName(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(y.a)(b,"DetectedHtmlTableAnnotation",
r.a,[])},1565:function(y,r,a){a.d(r,"a",function(){return c});y=a(0);class c{static sUa(b,f){if(!(b&&f&&b.length&&f.length)||256<b.length)return"";const k=Array(256),x=Array(256);let d,h=0,n=0;let m,u="";for(d=0;256>d;d++)k[d]=d;for(d=0;256>d;d++){var l=b.charCodeAt(d%b.length);if(256<=l)return"";h=(h+k[d]+l)%256;l=k[d];k[d]=k[h];k[h]=l}for(d=0;256>d;d++)x[d]=k[256-d-1];h=d=0;for(b=0;b<f.length;b++){d=(d+1)%256;h=(h+k[d])%256;l=k[d];k[d]=k[h];k[h]=l;l=f.charCodeAt(b);if(256<=l)return"";m=l^k[(k[d]+
k[h])%256];n=(n+x[d])%256;l=x[d];x[d]=x[n];x[n]=l;u+=String.fromCharCode(m^k[(x[d]+x[n])%256])}return u}}Object(y.a)(c,"RC4A",null,[])},184:function(y,r,a){function c(F,va){if(!va)return F;va=va.sheet;if(!va)return F;va=va.cssRules;if(!va)return F;var lb=Array.clone(va);lb.reverse();let sc=va=0,Yc=0,jd=0;for(const Kd of lb){lb=Kd.style;var Ad=Kd.selectorText;lb=lb?lb.cssText:null;Ad=Ad?Ad.split(","):null;if(lb&&Ad&&Kd.type===Kd.STYLE_RULE){jd+=Ad.length;for(const ye of Ad){0<=ye.indexOf("#")&&va++;
0<=ye.indexOf(".")&&sc++;0>ye.indexOf("#")&&0>ye.indexOf(".")&&Yc++;Ad=null;try{Ad=F.querySelectorAll(ye)}catch(Ne){C.ULS.sendTraceTag(507536148,0,50,"Exception in querySelectorAll: {0}",Ne.message)}if(Ad)for(let Ne=0;Ne<Ad.length;Ne++)Ad[Ne].setAttribute("style",lb+(Ad[Ne].getAttribute("style")||""))}}}C.ULS.sendTraceTag(507536147,0,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",jd,va,sc,Yc);return F}function b(F){if(void 0===F||-1===F.indexOf("px"))return 0;
F=F.match(If);let va=11;F&&(1===F.length?va=parseFloat(F[0]):3===F.length&&(va=parseFloat(F[1])));return $c.HelperMethods.WQc(va)}function f(F,va,lb){const sc=[];lb&&(va=F.parentElement.closest("td,th").style);"none"!==va.borderTopStyle&&""!==va.borderTopStyle&&(F=b(va.borderTopWidth),sc.push({BorderLineStyle:k(va.borderTopStyle,F),BorderPosition:0,Weight:F,Color:x(va.borderTopColor)}));"none"!==va.borderBottomStyle&&""!==va.borderBottomStyle&&(F=b(va.borderBottomWidth),sc.push({BorderLineStyle:k(va.borderBottomStyle,
F),BorderPosition:1,Weight:F,Color:x(va.borderBottomColor)}));"none"!==va.borderLeftStyle&&""!==va.borderLeftStyle&&(F=b(va.borderLeftWidth),sc.push({BorderLineStyle:k(va.borderLeftStyle,F),BorderPosition:2,Weight:F,Color:x(va.borderLeftColor)}));"none"!==va.borderRightStyle&&""!==va.borderRightStyle&&(F=b(va.borderRightWidth),sc.push({BorderLineStyle:k(va.borderRightStyle,F),BorderPosition:3,Weight:F,Color:x(va.borderRightColor)}));return sc}function k(F,va){switch(F){case "solid":return 1>va?1:
1.5>va?2:5;case "dashed":return 1>va?3:8;case "double":return 6;case "dotted":return 4;case "dotDash":return 10;case "dotDotDash":return 1>va?12:10;case "dotDashSlanted":return 13;case "triple":return 6;case "hairline":return 7;default:return 0}}function x(F){const va={};if(void 0===F||""===F)return va.Red=0,va.Green=0,va.Blue=0,va;Oa.a.compare(F,"windowtext",!0)?(F=id.a.np(F),va.Red=F.r,va.Green=F.g,va.Blue=F.b):(va.Red=0,va.Green=0,va.Blue=0);return va}function d(F){F=id.a.np(F);return id.a.GB(F)}
function h(F,va,lb,sc,Yc){try{if(va&&F.parentElement){lb.fontFamily="Aptos Narrow";if(Yc.map(Kd=>Kd.WDa.fontFamily).some(Kd=>Kd)&&va.fontFamily){const Kd=va.fontFamily.replace(/['"]+/g,"").split(",");0<Kd.length&&(Kg.hasOwnProperty(Kd[0])?lb.fontFamily=Kg[Kd[0]]:lb.fontFamily=Kd[0])}lb.fontSize=11;const jd=Yc.map(Kd=>Kd.WDa.fontSize),Ad=Yc.map(Kd=>Kd.element.tagName);(jd.some(Kd=>Kd)||Ad.some(Kd=>ef.includes(Kd)))&&va.fontSize&&(lb.fontSize=Math.round(b(va.fontSize)));va.fontWeight&&700<=parseInt(va.fontWeight,
10)&&(lb.bold=!0);lb.borders=f(F,va,sc);va.textDecoration&&"underline"===va.N1g&&("solid"===va.O1g?lb.Owe=1:"double"===va.O1g&&(lb.Owe=2));va.textDecoration&&"line-through"===va.N1g&&(lb.iDf=!0);lb.color="#000000";Yc.map(Kd=>Kd.WDa.color).some(Kd=>Kd)&&va.color&&(lb.color=d(va.color));if(sc){const Kd=F.parentElement.closest("td,th");lb.backgroundColor=Kd.style.backgroundColor?d(Kd.style.backgroundColor):""}if("italic"===va.fontStyle||"oblique"===va.fontStyle)lb.italic=!0}}catch(jd){C.ULS.sendTraceTag(507377813,
0,10,"CssStyleProcessor.setHtmlCellStyle: Error while setting cell style",jd)}return lb}a.r(r);var n={};a.r(n);a.d(n,"FocusBasedReadout",function(){return sa});var m={};a.r(m);a.d(m,"AriaLiveNotifier",function(){return mb});var u={};a.r(u);a.d(u,"DataFromPictureCommandHandler",function(){return Z});var l={};a.r(l);a.d(l,"EmbeddedWorkbookReadoutHandler",function(){return pa});var t={};a.r(t);a.d(t,"EwaAccessibilityManager",function(){return tc});var e={};a.r(e);a.d(e,"GridHighlightBehaviorEventManager",
function(){return tb});var w={};a.r(w);a.d(w,"GridHighlightsBehaviorManager",function(){return Rf});var z={};a.r(z);a.d(z,"PictureCommandHandler",function(){return Le});var E={};a.r(E);a.d(E,"PasteIndicationManager",function(){return ra});var M={};a.r(M);a.d(M,"PasteShortcutManager",function(){return vc});var G={};a.r(G);a.d(G,"SelectionReadoutHandler",function(){return ne});var A={};a.r(A);a.d(A,"SessionReloadActivity",function(){return Ue});var N={};a.r(N);a.d(N,"SessionReloadSilentActivity",function(){return cb});
var K={};a.r(K);a.d(K,"SparklineManager",function(){return V});var I={};a.r(I);a.d(I,"TableManager",function(){return pf});var L={};a.r(L);a.d(L,"UploaderCreator",function(){return hd});var J={};a.r(J);a.d(J,"WorkbookReadoutHandler",function(){return qe});var B={};a.r(B);a.d(B,"HtmlProcessor",function(){return gh});var Y={};a.r(Y);a.d(Y,"PastableIframe",function(){return mc});var U=a(133),O=a(0),C=a(15),X=a(31),S=a(7),ea=a(17),Oa=a(28),Ha=a(13),Za=a(440),fa=a(25),la=a(32);class ba{constructor(F){this.UVc=
F||""}static get Csf(){return ba.vLe||(ba.vLe=new ba(""))}static get I3d(){return ba.dSe||(ba.dSe=ba.vca(2).UVc)}static hta(F){F=la.a.$l(F||"");return new ba(F)}static COb(F){return ba.hta(Ha.a.instance.ia(F))}static vca(F){return new ba(Ha.a.instance.La(F))}static YDf(F,...va){return ba.pFi(Ha.a.instance.Ib(F),...va)}static pFi(F,...va){const lb=va.length,sc=Array(lb);for(let Yc=0;Yc<lb;Yc++)sc[Yc]=(va[Yc]||ba.Csf).UVc;return new ba(String.format(F,sc))}}ba.vLe=null;ba.dSe=null;Object(O.a)(ba,"SafeHtml",
null,[307]);const aa=(F,va)=>{va&&(F.append(va),F.append(ba.I3d))};var oa=a(1),Na=a(178),Ia=a(126),Sa=a(159),Pa=a(99),za=a(972),wa=a(39),db=a(246),Ba=a(5),Ka=a(65),da;let sa=da=class{constructor(F,va,lb){this.t9=this.sZ=this.wR=null;this.ata=Ba.FocusBasedReadoutService.Oa()?va.cellTextEditBox.Za.qg:lb;this.N$h(F);this.pek()}get isActive(){return!!this.ata&&document.activeElement===this.ata}readText(F){F=oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7663175_RemoveGridBeingReadoutInFocusBasedReadout")?
F:String.format(Ha.a.instance.Ib(30),F);this.wR.setAttribute(S.a.oy,F);this.sZ.setAttribute(S.a.oy,F);this.x2k()}dispose(){this.t9&&this.t9.parentNode&&this.t9.parentNode.removeChild(this.t9);this.sZ=this.wR=this.t9=this.ata=null}N$h(F){var va=F.Oc+"readoutElementWrapper";const lb=F.Oc+"readoutElement1",sc=F.Oc+"readoutElement2";this.t9=document.getElementById(va);this.t9||(this.t9=document.createElement(db.a.div),this.t9.id=va,this.wR=document.createElement(db.a.label),this.wR.id=lb,this.wR.setAttribute(S.a.Ae,
S.a.inc),this.wR.setAttribute("aria-roledescription",""),this.wR.setAttribute("aria-multiline",!1),this.sZ=document.createElement(db.a.label),this.sZ.id=sc,this.sZ.setAttribute(S.a.Ae,S.a.inc),this.sZ.setAttribute("aria-roledescription",""),this.sZ.setAttribute("aria-multiline",!1),this.wR.style.width="0px",this.wR.style.height="0px",this.sZ.style.width="0px",this.sZ.style.height="0px",this.wR.tabIndex=-1,this.sZ.tabIndex=-1,this.t9.appendChild(this.wR),this.t9.appendChild(this.sZ),F=F.Oc+S.a.Zqc,
va=document.getElementById(F),C.ULS.shipAssertTag(537153942,3,!!va,`FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: ${F}`),va&&va.appendChild(this.t9))}pek(){this.ata&&this.wR&&this.sZ&&(this.ata.setAttribute(S.a.Xaa,this.wR.id),this.ata.setAttribute(S.a.hnc,`${this.wR.id} ${this.sZ.id}`))}x2k(){if(oa.EwaSettings.isChangeGateEnabled("OfficeVSO:8194559_StaleValueReadoutFixEnabled")||this.isActive){let F="";ea.DOMElementExtensions.hasAttribute(this.ata,S.a.Xaa)&&
(F=this.ata.getAttribute(S.a.Xaa).toString());this.ata.setAttribute(S.a.Xaa,F===this.wR.id?this.sZ.id:this.wR.id)}this.isActive||C.ULS.sendTraceTag(537153941,0,50,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")}static nlb(){null==da.lOb&&(wa.a.qva?(da.lOb=!1,wa.a.Yg&&(da.lOb=!0)):da.lOb=!0);return da.lOb}};sa.lOb=null;sa=da=Object(U.__decorate)([Object(Ka.d)(Ba.FocusBasedReadoutService),Object(U.__param)(0,Object(Ba.EwaControlService)()),Object(U.__param)(1,Object(Ba.GridViewService)())],
sa);Object(O.a)(sa,"FocusBasedReadout",null,[222,4]);let mb=class{constructor(F,va,lb,sc){lb=void 0===lb?F.pT:lb;sc=void 0===sc?F.Wf:sc;this.SOg=()=>{this.$.fa.yc||Na.a.sendTelemetryEvent({name:"Office.Excel.Online.Accessibility.AriaLiveNotifier",dataFields:Ia.a.Eh({["AriaLiveOffCount"]:this.vHe,["AriaLivePoliteCount"]:this.wHe,["AriaLiveAssertiveCount"]:this.uHe,["AriaLiveRudeCount"]:this.xHe,["ScreenReaderDivCount"]:this.uXe,["AlertScreenReaderDivCount"]:this.eHe,["AuxScreenReaderDivCount"]:this.EHe,
["AriaAlertCount"]:this.sHe,["ReadCommandOnCompletionCount"]:this.bWe,["TotalAriaLiveRegionUpdates"]:this.g_e})})};this.$=F;this.Mc=void 0===va?null:va;this.fga=document.createElement("div");this.fga.setAttribute(S.a.Yaa,S.a.Vl);this.fga.className=X.a.yEd;lb.insertBefore(this.fga,sc);this.gha=document.createElement("div");this.gha.setAttribute(S.a.Yaa,S.a.Vl);this.gha.className=X.a.yEd;lb.insertBefore(this.gha,this.fga);this.Dqh=Ha.a.instance.La(2);this.cba=document.createElement("div");this.cba.setAttribute(S.a.Ae,
S.a.Lqa);this.cba.setAttribute(S.a.Mqa,S.a.fDa);this.cba.className=X.a.yEd;lb.insertBefore(this.cba,this.gha);this.g_e=this.bWe=this.sHe=this.EHe=this.eHe=this.uXe=this.xHe=this.uHe=this.wHe=this.vHe=0;this.register();oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)||this.$.ra.zc(211,this)}get P0a(){return this.Dqh}get isActive(){return!0}get fIh(){return this.fga}get NDk(){return this.gha}get activeCell(){return fa.f(this.$).Ob(null)}dispose(){this.$&&
this.unregister();ea.DOMElementExtensions.vh(this.cba);ea.DOMElementExtensions.vh(this.fga);ea.DOMElementExtensions.vh(this.gha);this.gha=this.fga=this.cba=this.$=null}setEnabled(F){this.HQg(this.gha,F)}vJk(){this.HQg(this.fga,!0)}readText(F){this.u2b(ba.hta(F),!0)}L3(F){this.u2b(ba.hta(F),!1)}jDg(F,va){if(1>va||!F)C.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var lb=new Sys.StringBuilder;F=String.format(Ha.a.instance.Ib(34),va,F);aa(lb,F);aa(lb,Ha.a.instance.ia(857));
this.u2b(ba.hta(lb.toString()),!1)}}Nkk(F,va,lb){if(1>lb||1>va||va>lb||!F)C.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");else{var sc=new Sys.StringBuilder;aa(sc,F);sc.append(String.format(Ha.a.instance.Ib(55),va,lb));this.u2b(ba.hta(sc.toString()),!1)}}Lkk(F){F=this.t_i(F);this.u2b(F,!1,!0)}u2b(F,va,lb){lb=void 0===lb?!1:lb;if(F=F?F.UVc:null)va=va?this.gha:this.fga,Oa.a.equals(va.innerHTML,F,!1)&&(F+=ba.I3d),this.A3g(va,lb),this.Mc.vl(va,F)}gLa(F,va){this.cba.getAttribute(S.a.Mqa)!==
va&&this.cba.setAttribute(S.a.Mqa,va);F=F?ba.hta(F).UVc:"";this.A3g(this.cba);this.Mc.vl(this.cba,F)}Okk(F,va,lb,sc){var Yc=!0;Yc=void 0===Yc?!1:Yc;const jd=Ha.a.instance.Ib(54);C.ULS.shipAssertTag(537153949,0,!(void 0===F||null===F));C.ULS.shipAssertTag(537153948,0,!(void 0===va||null===va));C.ULS.shipAssertTag(537153947,0,!(void 0===lb||null===lb));C.ULS.shipAssertTag(537153946,0,!(void 0===sc||null===sc));C.ULS.shipAssertTag(537153945,0,!(void 0===jd||null===jd));F=String.format(jd,F||"",va||"",
lb||"",sc||"");Yc?this.gLa(F,S.a.gDa):this.readText(F)}zbl(F){var va=this.gha.style;F?(F=Za.a.VRh(F.cell,va),va=F.dz,va.top=va.left=va.bottom=va.right=null,F.q0()):va.cssText=""}t_i(F){if(6!==F.Re)return null;const va=this.activeCell;if(!va)return null;switch(F.command){case -1985798686:return ba.COb(12);case -911352779:return ba.COb(11);case 237279923:return ba.COb(13);case -1502853784:return ba.vca(81);case -111689794:return ba.vca(78);case 368460465:F=fa.f(this.$).Eb.dg(va.range,!0);if(null!==
F)return this.DXa(2291,!F.hasAutoFilter,!1);F=this.$.qa.la;if(!F)break;return this.DXa(2291,null===F.bD,!1);case -1522760979:return this.DXa(1150,fa.f(this.$).isFormulaView,!1);case 1941920197:return ba.COb(836);case 1051390410:return ba.vca(589);case 1542466017:return ba.vca(591);case -706918724:return ba.vca(590);case 369708605:return ba.vca(592);case -1215659745:return ba.vca(523);case 1783960667:return ba.vca(521);case -1355155015:return ba.vca(554);case -1158102843:return ba.vca(522);case -287251124:return F=
this.gGc(F.command,va),null===F?null:this.DXa(1333,F);case -1925065947:return F=this.gGc(F.command,va),null===F?null:this.DXa(1334,F);case 1764140053:return F=this.gGc(F.command,va),null===F?null:this.DXa(1335,F);case -1590502662:return F=this.gGc(F.command,va),null===F?null:this.DXa(1336,F);case 862890474:case 963349338:F=this.wGa(va);if(null===F)break;F=ba.hta(String(F));return ba.YDf(214,F);case 1896159024:return ba.hta(Ha.a.instance.Ib(228));case -1554384558:return ba.hta(Ha.a.instance.Ib(229))}return null}register(){C.ULS.shipAssertTag(537153944,
0,!!this.$,"Can't register to ewaControl's events");this.$&&(C.ULS.shipAssertTag(537153943,0,!!this.$.Ia,"Can't register to CommandHandlerManager's event"),this.$.fa&&this.$.fa.qF(this.SOg))}unregister(){this.$&&this.$.fa.wG(this.SOg)}HQg(F,va){const lb=F===this.fga;va?(lb&&sa.nlb()||F.setAttribute(S.a.Mqa,S.a.gDa),lb&&F.setAttribute(S.a.Ae,S.a.Lqa),F.setAttribute(S.a.Yaa,S.a.rx),F.removeAttribute(S.a.Yaa),this.Mc.vl(F,F.innerHTML+" ")):(F.removeAttribute(S.a.Mqa),lb&&F.removeAttribute(S.a.Ae),F.setAttribute(S.a.Yaa,
S.a.Vl))}A3g(F,va){va=void 0===va?!1:va;switch(F.getAttribute(S.a.Mqa)){case S.a.A8e:++this.vHe;break;case S.a.gDa:++this.wHe;break;case S.a.fDa:++this.uHe;break;case S.a.eLh:++this.xHe}switch(F){case this.NDk:++this.uXe;break;case this.fIh:++this.eHe;break;case this.cba:++this.EHe}F.getAttribute(S.a.Ae)===S.a.Lqa&&++this.sHe;va&&++this.bWe;this.g_e++}DXa(F,va,lb){lb=void 0===lb?!0:lb;return ba.YDf(va?lb?7:216:lb?8:217,ba.COb(F))}gGc(F,va){return fa.f(this.$).ha.ob.isFloatingObjectSelected?this.Qqj(F):
this.Rqj(F,va)}Qqj(F){const va={};switch(F){case -287251124:F="QueryBold";break;case -1925065947:F="QueryItalics";break;case 1764140053:F="QueryUnderline";break;case -1590502662:F="QueryStrikethrough";break;default:return!1}const lb=Pa.a(this.$);return lb?(lb.eYa(F,va),va[za.a.On]):!1}Rqj(F,va){if(!va)return null;var lb=fa.f(this.$);va=Sa.a(va);lb.isEditing&&(va.Font=lb.Ej.xGa(va.Font));lb=va.Font;switch(F){case -287251124:return lb.Bold;case -1925065947:return lb.Italic;case 1764140053:return lb.Underline;
case -1590502662:return lb.Strikethrough}return!1}wGa(F){if(!F)return null;const va=fa.f(this.$);if(va.ha.ob.isFloatingObjectSelected)return null;F=Sa.a(F);va.isEditing&&(F.Font=va.Ej.xGa(F.Font));return F.Font.FontSize}};mb=Object(U.__decorate)([Object(Ka.d)(Ba.AriaLiveNotifierService),Object(U.__param)(0,Object(Ba.EwaControlService)()),Object(U.__param)(1,Object(Ba.HtmlSanitizationHelperService)())],mb);Object(O.a)(mb,"AriaLiveNotifier",null,[221,222,4]);var Ma=a(95),hb=a(6),$a=a(1563),Va=a(212),
xa=a(209),ia=a(67);let Z=class{constructor(F,va,lb,sc){this.cLb=null;this.$=F;this.ddaFacade=sc;va?(C.ULS.sendTraceTag(537163346,0,50,"DataFromPictureCommandHandler.constructor - AugmentationLoopManager and UploaderCreator instantiated."),this.cLb=new $a.a(F,va,lb,this.ddaFacade)):C.ULS.sendTraceTag(537163347,0,10,"DataFromPictureCommandHandler.constructor - Failed to instantiate AugmentationLoopManager.")}gd(){return!1}executeCommand(F,va,lb){F=!1;switch(va.command){case 73979048:this.cLb&&this.cLb.wek(va,
Ma.TaskManager.instance,hb.AFrameworkApplication.ea,lb),F=!0}return F?ia.Task.Va(!0):xa.a(va.command)}Rc(F,va){return 73979048===va.command&&hb.AFrameworkApplication.u8(Va.a)}td(){return!1}dispose(){this.cLb&&this.cLb.dispose()}};Z=Object(U.__decorate)([Object(Ka.d)(Ba.DataFromPictureCommandHandlerService),Object(U.__param)(0,Object(Ba.EwaControlService)()),Object(U.__param)(1,Object(Ba.AugmentationLoopManagerService)()),Object(U.__param)(2,Object(Ba.UploaderCreatorService)()),Object(U.__param)(3,
Object(Ba.DdaFacadeService)())],Z);Object(O.a)(Z,"DataFromPictureCommandHandler",null,[29,4]);class ta{constructor(F,va){this.$=va;this.ariaLiveNotifier=F}nDg(){const F=this.QJi();this.ariaLiveNotifier.gLa(F,S.a.fDa)}QJi(){const F=new Sys.StringBuilder;this.$.workbookContext&&aa(F,this.$.workbookContext.WorkbookFileName);aa(F,Ha.a.instance.ia(855));aa(F,this.SJi());aa(F,this.RJi());aa(F,Ha.a.instance.ia(856));return F.toString()}SJi(){return this.$.isEditMode?Ha.a.instance.ia(860):Ha.a.instance.ia(861)}RJi(){var F=
this.Rjl();const va=this.$.qa.la;F=1!==F?String.format(Ha.a.instance.Ib(32),F):Ha.a.instance.ia(854);F=new Sys.StringBuilder(F);va&&va.sheetName&&(F.append(ba.I3d),F.append(String.format(Ha.a.instance.Ib(33),va.sheetName)));return F.toString()}Rjl(){let F=0;for(const va of this.$.qa.items)va.visible&&F++;return F}}Object(O.a)(ta,"WorkbookReadout",null,[]);let pa=class{constructor(F,va,lb){this.Nog=()=>{this.zCe.nDg();this.ariaLiveNotifier.setEnabled(!0)};this.$=va;this.ariaLiveNotifier=F;this.zCe=
new ta(F,va);this.Pxc=lb.mNd(this.$);this.Pxc.CEh(this.Nog)}dispose(){this.Pxc&&this.Pxc.vtk(this.Nog);this.Pxc=this.ariaLiveNotifier=this.$=null}};pa=Object(U.__decorate)([Object(Ka.d)(Ba.EmbeddedWorkbookReadoutHandlerService),Object(U.__param)(0,Object(Ba.AriaLiveNotifierService)()),Object(U.__param)(1,Object(Ba.EwaControlService)()),Object(U.__param)(2,Object(Ba.SharedUIControlsFactoryService)())],pa);Object(O.a)(pa,"EmbeddedWorkbookReadoutHandler",null,[4]);var Ga=a(136),Ca=a(282),kb=a(681),eb=
a(488),Yb=a(105),Gb=a(306),Mb=a(177),Rb=a(86),$b=a(310),cc=a(81),fb=a(43),Sb=a(83),kc=a(71),na=a(688);class fc extends Yb.a{constructor(F,va){super(F);this.G_=[];this.sQe=null;this.S5f=!1;this.v4a=lb=>{let sc="forward";lb.Values.Direction?sc=lb.Values.Direction.toLowerCase():C.ULS.sendTraceTag(537166664,0,15,"Didn't find direction in message values");lb=0;let Yc=!0;"backward"===sc?(lb=this.t0d.length-1,Yc=!1):"forward"===sc?(lb=0,Yc=!0):C.ULS.sendTraceTag(537166663,0,15,`Received unknown direction to resume focus: ${sc}`);
this.Pfg(Yc,lb,!1)};this.Kog=()=>{this.G_=[]};this.c2a=lb=>{this.$.shortcutKeyManager.dmk(lb);const sc=this.$.shortcutKeyManager.yy(lb);if(-411645385===sc&&this.M1f()||this.S5f&&(369708605===sc||1542466017===sc))this.$.Ia.Gb(new Sb.a(sc,1,this.$.xc,6,null),{["event"]:lb},lb),lb.stopPropagation()};this.P0j=lb=>{this.Dwa(lb)};this.Qb=va;this.tA=fa.f(this.Qb);this.S5f=oa.EwaSettings.isChangeGateEnabled("OfficeVSO:8797275_unhideRowColKeyBoardCommandBugFix");this.Dd.Ea("keydown",this.P0j);this.Dd.Ea("keyup",
this.c2a);Gb.a(va).$Fh(this.Kog);Rb.a(va.ta,27)&&(Ba.HostMessengerService.Oa()?void Ka.a.resolve(Ba.HostMessengerService,{xa:1}).then(lb=>{lb.nl(Ga.a.mDc);lb.ik(Ga.a.mDc,this.v4a)}):fb.TaskExtensions.tb(cc.GetServiceTaskFactory.Ne(va.ra,21,137,1),lb=>{lb=lb.result;lb.nl(Ga.a.mDc);lb.ik(Ga.a.mDc,this.v4a)},va.Aa))}get $(){return this.Qb}get t0d(){this.G_.length||(this.G_=this.iKf());return this.G_}get Cva(){return this.sQe}set Cva(F){this.sQe=F;this.G_=this.iKf()}dispose(){this.$&&Gb.a(this.$).Iuk(this.Kog);
this.Qb=null;this.G_.length=0;super.dispose()}Wfk(F){this.Dwa(F)}Pfg(F,va,lb,sc){sc=void 0===sc?null:sc;var Yc=this.r2k(F,va,void 0===lb?!0:lb,sc);if(!Yc){lb=va;var jd=F?1:-1,Ad=this.t0d;do{Yc=!1;if(Rb.a(this.$.ta,27)){if(lb+=jd,lb>=Ad.length||0>lb)Yc=!0}else lb=(lb+jd+Ad.length)%Ad.length;if(Yc){this.$Hj(F,va,sc);break}else if(Yc=this.B0g(F,va,lb,!1,sc))break}while(lb!==va)}}r2k(F,va,lb,sc){sc=void 0===sc?null:sc;let Yc=null;0<=va&&(Yc=this.G_[va]);return(null===Yc||void 0===Yc?0:Yc.ij)&&Yc.Nj(F,
void 0===lb?!0:lb)?(sc&&kc.g(sc),C.ULS.sendTraceTag(537166669,0,50,`Switched focus inside current section ${Yc.tf} into a sub region`),Yc.Hm(),!0):!1}B0g(F,va,lb,sc,Yc){Yc=void 0===Yc?null:Yc;lb=this.G_[lb];const jd=Gb.a(this.Qb).$A(Ca.a.MFa),Ad=Gb.a(this.Qb).$A(Ca.a.ZQb),Kd=this.tA.ha.ob.isFloatingObjectSelected;if(lb===Ad&&Kd||lb===jd&&!sc&&!Kd)return!1;if((null===lb||void 0===lb?0:lb.ij)&&lb.Nj(F,!1)){Yc&&kc.g(Yc);lb.Hm();if(F=this.G_[va])F.fo(),C.ULS.sendTraceTag(537166668,0,50,`Switched focus from section ${F.tf} to ${lb.tf}`);
return!0}return!1}$Hj(F,va,lb){(lb=void 0===lb?null:lb)&&kc.g(lb);if(va=this.G_[va])va.fo(),C.ULS.sendTraceTag(537166666,0,50,`Lost focus from section ${va.tf}`);Ba.HostMessengerService.Oa()?void Ka.a.resolve(Ba.HostMessengerService,{xa:0}).then(sc=>{sc.sendMessage(Ga.a.yCa,{["Direction"]:F?"forward":"backward"})}):fb.TaskExtensions.tb(cc.GetServiceTaskFactory.Ne(this.$.ra,21,137,0),sc=>{sc.result.sendMessage(Ga.a.yCa,{["Direction"]:F?"forward":"backward"})},this.$.Aa)}Dwa(F){var va=this.$.isEditMode?
Mb.a(this.$):null;fc.y1f(va)&&this.$.shortcutKeyManager.d9k(F,va.um);if(!this.$.Mb.rda||fc.y1f(va))if(117===F.keyCode&&(F.ctrlKey||kc.b(F))){va=this.rNf(F.target);var lb=!F.shiftKey;C.ULS.sendTraceTag(537166662,0,50,`AccessibilityManager.OnKeyDownHandler: Ctrl+F6 loop. The root index section is: ${va}`);var sc=Gb.a(this.Qb).$A(Ca.a.E4b);sc=this.G_.indexOf(sc);hb.AFrameworkApplication.ua.Ab.jE&&this.$.H2&&-1!==sc&&va===sc&&kb.a.hT(this.$.I7b,0);this.Pfg(lb,va,!0,F)}else 117!==F.keyCode||fc.wAf?-411645385===
this.$.shortcutKeyManager.yy(F)?this.M1f()&&(this.$.Ia.Gb(new Sb.a(-411645385,1,this.$.xc,6,null),{["event"]:F},F),F.stopPropagation()):1588554917===this.$.shortcutKeyManager.yy(F)?0===this.mode?(na.a(this.$)||this.$.Ia.Gb(new Sb.a(1588554917,1,this.$.xc,6,null),{["event"]:F},F),F.preventDefault(),F.stopPropagation()):3===this.mode&&(F.preventDefault(),F.stopPropagation()):1058684758===this.$.shortcutKeyManager.yy(F)?(va=this.rNf(F.target),sc=Gb.a(this.Qb).$A(Ca.a.E4b),lb=Gb.a(this.Qb).$A(Ca.a.MFa),
sc=this.G_.indexOf(sc),lb=this.G_.indexOf(lb),hb.AFrameworkApplication.ua.Ab.jE&&this.$.H2&&-1!==sc&&va===sc&&1===this.$.I7b&&kb.a.hT(1,0),-1!==lb&&va!==lb&&this.B0g(!0,va,lb,!0,F)):oa.EwaSettings.isChangeGateEnabled("OfficeVSO:8198803_AddingScopeToShortcuts")&&1===this.$.shortcutKeyManager.b1i(F)?(va=this.$.shortcutKeyManager.yy(F),C.ULS.sendTraceTag(508342917,0,50,`AccessibilityManager.OnKeyDownHandler : RibbonCommand ${va} fired in ${this.mode} mode`),0===this.mode?(this.$.Ia.Gb(new Sb.a(va,1,
this.$.xc,6,null)),F.preventDefault(),F.stopPropagation()):4===this.mode&&-1966746939===va&&(F.preventDefault(),F.stopPropagation())):this.W7i(F):(F=$b.a.Xv.KC.QP(eb.a.rQi(),!1),F.image=3,$b.a.Xv.KC.pz(F),fc.wAf=!0)}rNf(F){const va=this.t0d;for(let lb=0,sc=va.length;lb<sc;++lb){const Yc=va[lb];if(Yc&&Yc.zk(F))return lb}return-1}iKf(){const F=[];for(let va=0,lb=this.Cva.length;va<lb;va++){const sc=Gb.a(this.$).$A(this.Cva[va]);sc&&F.push(sc)}return F}M1f(){return 0===this.mode||4===this.mode}static y1f(F){return F?
F.inKeytipMode:!1}}fc.wAf=!1;Object(O.a)(fc,"AccessibilityManager",Yb.a,[814,4]);var Cc=a(174);let tc=class extends fc{constructor(F){super(document.documentElement,F);this.xJ=0;this.ANh=[Ca.a.Sif,Ca.a.F7d,Ca.a.TCc,Ca.a.Dxe,Ca.a.E4b,Ca.a.jtd,Ca.a.vId,Ca.a.hQf,Ca.a.gsd,Ca.a.swe,Ca.a.JYk,Ca.a.bUg,Ca.a.ZQb,Ca.a.NDf,Ca.a.qud,Ca.a.MFa,Ca.a.Uqe,Ca.a.wud,Ca.a.TZg,Ca.a.w9f,Ca.a.Fsd];this.sjl=[Ca.a.TCc,Ca.a.U$g,Ca.a.T$g,Ca.a.V$g];this.Dfk=[Ca.a.TCc,Ca.a.Lzg,Ca.a.Mzg,Ca.a.Pzg];this.hWh=[Ca.a.CDf,Ca.a.gQf,Ca.a.BDf,
Ca.a.yDf,Ca.a.dnf];this.Yek=[Ca.a.Sif,Ca.a.F7d,Ca.a.jtd,Ca.a.vId,Ca.a.gsd,Ca.a.swe,Ca.a.ZQb,Ca.a.qud,Ca.a.MFa,Ca.a.Uqe,Ca.a.fzg,Ca.a.wud,Ca.a.Fsd];this.pfk=[Ca.a.ZQb,Ca.a.zId];const va=Ha.a.instance.La(253);this.YJk=this.$.shortcutKeyManager.Jib(va);this.mode=0;Ba.HostMessengerService.Oa()?void Ka.a.resolve(Ba.HostMessengerService,{xa:1}).then(lb=>{lb.nl(Ga.a.yCa);lb.ik(Ga.a.yCa,this.v4a)}):fb.TaskExtensions.tb(cc.GetServiceTaskFactory.Ne(F.ra,21,137,1),lb=>{lb=lb.result;lb.nl(Ga.a.yCa);lb.ik(Ga.a.yCa,
this.v4a)},F.Aa)}get mode(){return this.xJ}set mode(F){this.xJ=F;switch(F){case 0:this.Cva=this.ANh;break;case 2:this.Cva=this.sjl;break;case 3:this.Cva=this.Dfk;break;case 4:this.Cva=this.hWh;break;case 5:this.Cva=this.Yek;break;case 6:this.Cva=this.pfk;break;default:C.ULS.shipAssertTag(537170759,0,!0,"Accessibility Mode value is not in allowed values")}}Dwa(F){this.$.$d&65536&&super.Dwa(F)}W7i(F){if(Oa.a.equals(this.YJk,this.$.shortcutKeyManager.ULd(F),!1)){const va=Cc.b(this.$);if(null===va||void 0===
va?0:va.ij)kc.g(F),va.Nj(!0,!1)}}};tc=Object(U.__decorate)([Object(Ka.d)(Ba.EwaAccessibilityManagerService),Object(U.__param)(0,Object(Ba.EwaControlService)())],tc);Object(O.a)(tc,"EwaAccessibilityManager",fc,[]);var nb=a(41);let tb=class extends nb.a{constructor(){super()}qGh(F){this.addHandler("TAF",F)}$uk(F){this.removeHandler("TAF",F)}Cik(){this.raiseEvent("TAF")}};tb=Object(U.__decorate)([Object(Ka.d)(Ba.GridHighlightBehaviorEventManagerService),Object(U.__param)(0,Object(Ba.EwaControlService)())],
tb);Object(O.a)(tb,"GridHighlightBehaviorEventManager",nb.a,[802,4]);var La=a(93),wb=a(309),Wa=a(16),Fa=a(194),Da=a(139);class ja extends Sys.EventArgs{constructor(F,va){super();this.start=F;this.ASb=va}}Object(O.a)(ja,"MarqueeResizeStartedOrEndedEventArgs",Sys.EventArgs,[]);class Qa extends nb.a{constructor(F){super();this.Ydg=[3];this.L9a=void 0;this.da=F}get WA(){if(this.L9a)return this.L9a;const F=Ka.a.Cb(Ba.FormulaAssistanceManagerService);F||C.ULS.sendTraceTag(510255179,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaAssistanceManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");
F.WA||C.ULS.sendTraceTag(510255178,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaHighlightsControl is null.");return this.L9a=F.WA}QEh(F){this.addHandler("mrek",F)}qxa(F,va,lb){for(const sc of this.da.$p)wb.a.instance.va(Wa.a.At,sc.domElement,F);wb.a.instance.va(Wa.a.Lj,document.documentElement,va);this.da.cellTextEditBox.wgb(!0);lb&&wb.a.instance.va(Wa.a.sG,this.da.nh,va)}Wnk(F,va,lb){document.documentElement.addEventListener("pointermove",F);document.documentElement.addEventListener("pointerup",
va);this.da.cellTextEditBox.wgb(!0);lb&&this.da.nh.addEventListener("pointerleave",va)}m6g(F,va,lb){for(const sc of this.da.$p)wb.a.instance.Ua(Wa.a.At,sc.domElement,F);wb.a.instance.Ua(Wa.a.Lj,document.documentElement,va);this.da.cellTextEditBox.wgb(!1);lb&&wb.a.instance.Ua(Wa.a.sG,this.da.nh,va)}ral(F,va,lb){document.documentElement.removeEventListener("pointermove",F);document.documentElement.removeEventListener("pointerup",va);this.da.cellTextEditBox.wgb(!1);lb&&this.da.nh.removeEventListener("pointerleave",
va)}Xnk(F,va){for(const lb of this.da.$p)Fa.a.instance.va(Wa.a.Ai,lb.domElement,F);Fa.a.instance.va(Wa.a.If,document.documentElement,va)}sal(F,va){for(const lb of this.da.$p)Fa.a.instance.Ua(Wa.a.Ai,lb.domElement,F);Fa.a.instance.Ua(Wa.a.If,document.documentElement,va)}Yjf(F,va,lb,sc){const Yc=document.createElement("div");Yc.className=va;for(const jd of lb)Yc.classList.add(jd);F.appendChild(Yc);wb.a.instance.va(Wa.a.Sd,Yc,sc);return Yc}tNf(F){F=F.sc.parentNode;if(!F)return C.ULS.shipAssertTag(537159394,
0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),null;F=parseInt(F.getAttribute(S.a.ASb),10);return isNaN(F)?(C.ULS.shipAssertTag(537159393,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.da.Ub.sQ(3,1,F)}u6b(F,va,lb){F=(void 0===lb?!0:lb)&&!!this.WA&&this.WA.btj(F);for(const sc of va)ea.DOMElementExtensions.setVisible(sc,F)}zJd(){return this.da.rv?Da.a(this.da.$):this.da.Rb}yDg(){const F=
this.zJd();F&&this.WA?F.eW(null):(C.ULS.sendTraceTag(510255177,0,10,"BehaviorHelperMethods.RecalculateFormulaHighlights: Can't UpdateFormulaHighlights, will hide all marquee as a last fallback."),this.da.Ub.rl(this.Ydg),this.da.Ub.pn(null,this.Ydg))}MBg(F,va){this.raiseEvent("mrek",new ja(F,va))}}Object(O.a)(Qa,"BehaviorHelperMethods",nb.a,[]);var Ob=a(91),Ub=a(55),Zb=a(88);class uc extends Yb.a{constructor(F,va){super(F,void 0===va?null:va)}hcb(){}}Object(O.a)(uc,"HighlightFlyweightBehavior",Yb.a,
[]);var Hc=a(20),Dd=a(515),jc=a(70),$c=a(12),ud=a(138),Ud=a(286),ec=a(52),Db=a(267),ic=a(10),Pc=a(60);class Ed extends Db.a{constructor(F,va,lb,sc){super(document.createElement("div"));this.usc=null;this.pac=!1;this.onPointerDown=Yc=>{Yc=this.zoomManager?this.zoomManager.Qf(Yc):Yc;this.pac=!1;if(3===(jc.a.Hb=Yc.Yb)){const jd=Yc.Ha.rawEvent,Ad=jd.srcElement||jd.target;ea.DOMElementExtensions.Ki(this.domElement,Ad)&&ea.DOMElementExtensions.Ki(jd.currentTarget,Ad)&&(this.pac=!0,this.usc=Yc.clientPoint)}return!1};
this.sj=Yc=>{Yc=this.zoomManager?this.zoomManager.Qf(Yc):Yc;this.raiseEvent("GrPointerUp",Yc);return this.pac=!1};this.Lm=Yc=>{Yc=this.zoomManager?this.zoomManager.Qf(Yc):Yc;3===Yc.Yb&&this.pac&&this.Laj(Yc.clientPoint)&&(this.raiseEvent("GrDrag"),this.pac=!1);return!1};this.Hd=Yc=>{this.zoomManager&&this.zoomManager.Qf(Yc);return!0};this.$=lb;this.zoom=sc;this.domElement.classList.add(Pc.a.yyf);this.domElement.classList.add(Pc.a.gwc);F.appendChild(this.domElement);ea.DOMElementExtensions.setVisible(this.domElement,
!1);this.cYa=document.createElement("div");this.cYa.classList.add(Pc.a.fwc);this.cYa.style.borderColor=va;this.domElement.appendChild(this.cYa);wb.a.instance.va(Wa.a.Sd,this.domElement,this.onPointerDown);wb.a.instance.va(Wa.a.Lj,this.domElement,this.sj);Fa.a.instance.va(Wa.a.If,this.domElement,this.sj);wb.a.instance.va(Wa.a.At,this.domElement,this.Lm);Fa.a.instance.va(Wa.a.Ai,this.domElement,this.Lm);Ud.a.instance.va(Wa.a.click,this.domElement,this.Hd)}get zoomManager(){return this.zoom.zoomManager}r4e(F){this.addHandler("GrDrag",
F)}jHg(F){this.removeHandler("GrDrag",F)}q4e(F){this.addHandler("GrContxt",F)}iHg(F){this.removeHandler("GrContxt",F)}s4e(F){this.addHandler("GrPointerUp",F)}kHg(F){this.removeHandler("GrPointerUp",F)}dispose(){ec.a.tLa(this.domElement);super.dispose()}TPg(){this.domElement.classList.remove(Pc.a.gwc);this.cYa.classList.remove(Pc.a.fwc);this.cYa.classList.add(oa.EwaSettings.OQ?Pc.a.Ayf:Pc.a.zyf)}A6g(){this.cYa.classList.remove(oa.EwaSettings.OQ?Pc.a.Ayf:Pc.a.zyf);this.cYa.classList.add(Pc.a.fwc);this.domElement.classList.add(Pc.a.gwc)}Laj(F){return!!this.usc&&
(3<Math.abs(F.x-this.usc.x)||3<Math.abs(F.y-this.usc.y))}static iPb(F){return Math.round(9/Math.max(F.zoomManager?F.zoomManager.zoom:ic.a.IC,1))}}Ed.U4d=0;Object(O.a)(Ed,"TouchGrippie",Db.a,[]);var de=a(173);class se extends uc{constructor(F,va,lb,sc,Yc){super(va);this.o_d=this.FGb=!1;this.Boc=null;this.wI=this.Bka=this.k_d=!1;this.Vz=()=>{this.FGb&&this.k_d?this.Bya():this.Xca()};this.Ing=Ad=>{3===Ad.Yb&&(this.k_d=!0,this.Bya());return!1};this.Jng=Ad=>{if(3===Ad.Yb){if(!Ad.sc||this.Qpj(Ad))return!1;
this.k_d=!1;this.Xca()}return!1};this.ph=()=>{this.Bka&&this.qze();this.Bya();this.o_d=!1};this.Hw=()=>{this.Xca();this.o_d=!0};this.kL=(Ad,Kd)=>{Kd.P7===this.P7&&(Kd.visible?this.o_d||this.Bya():this.Xca())};this.Utg=()=>{this.Kng(this.YZ.domElement,!1)};this.Ojg=()=>{this.Kng(this.eX.domElement,!0)};this.fOc=(Ad,Kd)=>{this.wI&&de.b(this.da.$).kq(Kd.Ha.rawEvent,"context_menu_grippie",null,["floatie"]);this.ha.jxa(Kd)};this.gOc=(Ad,Kd)=>{this.wI&&de.b(this.da.$).kq(Kd.Ha.rawEvent,"context_menu_grippie",
null,["floatie"]);this.ha.jxa(Dd.a(Kd))};this.A_b=()=>{3===jc.a.Hb?this.Bya():this.Xca();this.Bka&&1===jc.a.Hb&&this.qze()};this.Vtg=()=>{this.eIk()};this.Frf=()=>{this.Xca()};this.Zp=()=>{this.ha.ob.Wb&&this.Xca()};this.Cjg=()=>{this.Xca()};this.Bng=(Ad,Kd)=>{this.qze();3===Kd.Yb?this.Bya():this.Xca()};this.tSc=()=>{this.FGb&&(this.Xca(),this.Bya())};const jd=lb.$;this.tA=lb;this.zoom=Yc;this.ha=lb.ha;this.wN=F;this.oFk=va;this.paneType=sc;F=this.domElement.currentStyle;va="#000000";F&&(va=F.borderTopColor);
this.YZ=new Ed(this.GBf(),va,jd,Yc);this.eX=new Ed(this.GBf(),va,jd,Yc);this.YZ.r4e(this.Utg);this.YZ.q4e(this.fOc);this.YZ.s4e(this.gOc);this.eX.r4e(this.Ojg);this.eX.q4e(this.fOc);this.eX.s4e(this.gOc);for(const Ad of this.da.$p)Fa.a.instance.va(Wa.a.ih,Ad.domElement,this.Jng),Fa.a.instance.va(Wa.a.If,Ad.domElement,this.Ing);lb.view.Ks(this.Vz);lb.Rb.Jp(this.Frf);lb.Ub.Xbb(this.kL);lb.hlc(this.Cjg);jd.DD(this.tSc);lb.aw(this.tSc);this.ha.Qaa(this.ph);this.ha.vqa(this.Hw);lb.KJ(this.Zp);this.ha.AFb(this.Bng);
jc.a.y4e(this.A_b);fb.TaskExtensions.tb(Object(Zb.d)(Ka.a.resolve(Ba.GridHighlightBehaviorEventManagerService,{xa:0})),Ad=>{Ad.result.qGh(this.Vtg)},jd.Aa,3);this.wI=oa.EwaSettings.isChangeGateEnabled("OfficeVSO:8836781_TrackAsyncContextMenu")}get da(){return this.tA}dispose(){Ob.a.xd([this.YZ,this.eX]);this.YZ.jHg(this.Utg);this.YZ.iHg(this.fOc);this.YZ.kHg(this.gOc);this.eX.jHg(this.Ojg);this.eX.iHg(this.fOc);this.eX.kHg(this.gOc);for(var F of this.da.$p)Fa.a.instance.Ua(Wa.a.ih,F.domElement,this.Jng),
Fa.a.instance.Ua(Wa.a.If,F.domElement,this.Ing);this.da.view.xs(this.Vz);this.da.Rb.zp(this.Frf);this.da.Ub.osb(this.kL);this.da.STc(this.Cjg);this.da.$.vG(this.tSc);this.da.Zz(this.tSc);this.ha.z9(this.ph);this.ha.tma(this.Hw);this.da.xL(this.Zp);this.ha.s3b(this.Bng);jc.a.qHg(this.A_b);this.Bka&&C.ULS.sendTraceTag(537159314,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");(F=Ka.a.Cb(Ba.GridHighlightBehaviorEventManagerService))&&F.$uk(this.Vtg);super.dispose()}G5a(){if(!this.wN.range||
!this.wN.range.equals(this.stb))return!1;const F=!this.da.cva();return this.da.isEditing&&F&&(this.stb.isRow||this.stb.Oe)?!1:this.Bka?!0:3===jc.a.Hb}Xca(){this.FGb&&(this.YZ.set_visible(!1),this.eX.set_visible(!1),this.FGb=!1)}Bya(){if(this.G5a()){var F=ea.DOMElementExtensions.getBoundingClientRect({element:this.Boc,di:!0});F||C.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. GridView.ContainerElement: {0}, Freezepanes: {1}",this.da.nh,this.da.rb.mj);var va=ea.DOMElementExtensions.getBoundingClientRect({element:this.oFk,
di:!0}),lb=new Sys.UI.Bounds(va.x-F.x,va.y-F.y,va.width,va.height),sc=this.stb,Yc=sc.topLeft,jd=sc.bottomRight,Ad=sc.isRow||sc.Oe;if(sc.Oe){var Kd=this.oBi();sc=lb.x-2*Ed.iPb(this.zoom);var ye=Kd;var Ne=lb.x+va.width}else sc.isRow?(sc=Ne=this.nBi(),ye=lb.y-2*Ed.iPb(this.zoom),Kd=lb.y+va.height):(ye=lb.y,Kd=lb.y+va.height,this.da.rtl?(sc=lb.x+va.width,Ne=lb.x):(sc=lb.x,Ne=lb.x+va.width));va=Ed.U4d+(Ad?0:Ed.iPb(this.zoom));this.YZ.style.left=$c.HelperMethods.$c(sc-va);this.YZ.style.top=$c.HelperMethods.$c(ye-
va);this.eX.style.left=$c.HelperMethods.$c(Ne-va);this.eX.style.top=$c.HelperMethods.$c(Kd-va);this.YZ.set_visible(this.b1f(ye,sc,Yc,Ad,F));this.eX.set_visible(this.b1f(Kd,Ne,jd,Ad,F));this.FGb=!0}}b1f(F,va,lb,sc,Yc){const jd=ea.DOMElementExtensions.getBoundingClientRect({element:this.da.pg(this.paneType).domElement,di:!0});Yc=new Sys.UI.Bounds(jd.x-Yc.x-3,jd.y-Yc.y-3,jd.width+6,jd.height+6);return(this.da.rb.Yh(lb)===this.paneType||sc)&&Ub.a.qU(Yc,new Sys.UI.Point(va,F))}oBi(){return(this.da.view.visibleArea.height+
this.da.rb.height+Ed.U4d-Ed.iPb(this.zoom))/2}nBi(){return(this.da.view.visibleArea.width+this.da.rb.width+Ed.U4d-Ed.iPb(this.zoom))/2}jsg(){this.Bya()}Qpj(F){return ea.DOMElementExtensions.htb(F.sc,Hc.a.YD)&&(this.wrj(F)||this.xrj(F))}xrj(F){if(this.da.rtl)F=F.clientPoint.x;else{const va=ea.DOMElementExtensions.getBoundingClientRect({element:F.sc});F=F.clientPoint.x-(va.x+va.width-ud.a.Gt)}return 0<F&&F<=ud.a.Gt}wrj(F){const va=ea.DOMElementExtensions.getBoundingClientRect({element:F.sc});F=F.clientPoint.y-
(va.y+va.height-ud.a.Gt);return 0<F&&F<=ud.a.Gt}Kng(F,va){this.Bka&&C.ULS.sendTraceTag(537159312,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ha.iud(F,va,this.Bka);this.Xca()}eIk(){this.Bka||(C.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.Bka=!0,this.YZ.TPg(),this.eX.TPg(),this.da.ha.sourceRange=this.da.ha.oa.Ed,this.Bya())}qze(){this.Bka&&(C.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),
this.Bka=!1,this.YZ.A6g(),this.eX.A6g())}GBf(){this.Boc||(this.Boc=this.da.nh);return this.Boc}}Object(O.a)(se,"SelectionTouchGrippiesBehaviorBase",uc,[]);class Fe extends se{constructor(F,va,lb,sc,Yc){super(F,va,lb,sc,Yc)}get P7(){return 19}get stb(){return this.da.ha.oa.activeRange}G5a(){const F=this.da.nk||this.da.isEditing;return!this.da.ha.oa.vi&&!F&&super.G5a()}}Object(O.a)(Fe,"DiscontinuousSelectionTouchGrippiesBehavior",se,[]);var fe=a(653);class Tc extends uc{constructor(F){super(F);const va=
document.createElement("div");va.className=Pc.a.vwi;F.appendChild(va)}}Object(O.a)(Tc,"SelectionBorderBehavior",uc,[]);class ed{}ed.Dvc="ewa-grid-ltr";ed.Evc="ewa-grid-rtl";ed.hyf="ewr-cell-selection-highlight-all-after-fluent";ed.TVa="ewr-grdcontarea-ltr";ed.kNb="ewr-grdcontarea-rtl";ed.Xvi="ewr-marquee-thick";ed.cwi="ewr-resizemarqueehandle-thick";ed.iwi="ewr-selection-draghandle-bottom";ed.jwi="ewr-selection-draghandle-bottom-updated";ed.Tyf="ewr-selection-draghandle-grab";ed.kwi="ewr-selection-draghandle-left";
ed.lwi="ewr-selection-draghandle-left-updated";ed.Uyf="ewr-selection-draghandle-reduced";ed.mwi="ewr-selection-draghandle-right";ed.nwi="ewr-selection-draghandle-right-updated";ed.owi="ewr-selection-draghandle-top";ed.pwi="ewr-selection-draghandle-top-updated";ed.ewi="ewr-selection-drag-shadow";ed.gwi="ewr-selection-drag-tooltip";ed.hwi="ewr-selection-drag-tooltip-fluent";ed.Syf="ewr-selection-drag-tooltip-shift-instruction";ed.qwi="ewr-selection-dragtooltip-updated";ed.Jwi="ewr_selection_rearrangebottom";
ed.ywi="ewr_selection_rearrange-flange-bottom";ed.zwi="ewr_selection_rearrange-flange-left";ed.Awi="ewr_selection_rearrange-flange-right";ed.Bwi="ewr_selection_rearrange-flange-top";ed.Cwi="ewr_selection_rearrange-fullrowcol-flange-bottom";ed.Dwi="ewr_selection_rearrange-fullrowcol-flange-left";ed.Ewi="ewr_selection_rearrange-fullrowcol-flange-right";ed.Fwi="ewr_selection_rearrange-fullrowcol-flange-top";ed.Kwi="ewr_selection_rearrangeleft";ed.Lwi="ewr_selection_rearrangeright";ed.Mwi="ewr_selection_rearrangetop";
ed.Nwi="ewr-selection-resizemarqueehandle";ed.Owi="ewr-selection-resizemarqueehandle-bottomleft";ed.Pwi="ewr-selection-resizemarqueehandle-bottomright";ed.Qwi="ewr-selection-resizemarqueehandle-topleft";ed.Rwi="ewr-selection-resizemarqueehandle-topright";ed.selecting="selecting";Object(O.a)(ed,"GridHighlightsBehaviorClassNames",null,[]);var pd=a(227);class Kb extends Tc{constructor(F,va,lb,sc,Yc){super(F);this.t6a=!1;this.Omd=this.Pmd=null;this.mxb=this.Vjb=this.SM=this.vha=0;this.nZ=this.Xb=this.sourceRange=
this.RKa=null;this.Xg=oa.EwaSettings.Xg();this.sj=jd=>{jd=this.zoomManager.Qf(jd);return this.Lqg(jd)};this.onPointerDown=jd=>{jd=this.zoomManager.Qf(jd);if(!this.ise())return!1;if(2===jd.Yb&&jd.Dq===Sys.UI.MouseButton.leftButton&&!this.t6a){var Ad=this.iOd(jd);if(!Ad)return C.ULS.shipAssertTag(537159379,0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;this.Xb=Ad.clone();this.sourceRange=this.Xb.clone();this.Xg&&(this.RKa=null);if(Ad=this.EVi(jd))return this.mxb=Ad.top-
this.sourceRange.top,this.Vjb=Ad.left-this.sourceRange.left,fa.f(this.$).$h.Jt(Kb.ICd),this.K$d(jd),this.t6a=!0,pd.b(this.$,!0),!0}return!1};this.Lm=jd=>{jd=this.zoomManager.Qf(jd);if(this.L$d(jd))return!0;if(jd=this.Lx?this.ha.r0(jd.clientPoint,jd.sc,5,!0):this.ha.Ft(jd.clientPoint,jd.sc,5,void 0,void 0,!0)){if(this.Xg)this.gfa(this.bia(jd));else{jd=this.bia(jd);if(this.Xb.equals(jd))return!0;this.Xb=jd}if(!this.Jwb())return C.ULS.shipAssertTag(537159378,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),
this.Kwc(!0),!1}return!0};this.Jqg=jd=>{jd=new Sys.UI.DomEvent(jd);jd=fe.a.create(jd.type,jd.target,jd,2);return this.Omd(jd)};this.Pqg=jd=>{jd=new Sys.UI.DomEvent(jd);jd=fe.a.create(jd.type,jd.target,jd,2);return this.Pmd(jd)};this.de=(jd,Ad)=>{Ad.xU||this.wXc(this.$.isEditMode)};this.vy=[];this.$=va;this.da=fa.f(this.$);this.zoom=Yc;this.ha=fa.f(this.$).ha;this.paneType=lb;this.Qr=sc;this.Lx=oa.EwaSettings.Lx();oa.EwaSettings.isChangeGateEnabled("OfficeVSO:8967940_DragHandleUsabilityImprovement")?
this.Gne=[ed.owi,ed.iwi,ed.kwi,ed.mwi]:this.Gne=[ed.pwi,ed.jwi,ed.lwi,ed.nwi];this.$.Ul(this.de)}get zoomManager(){return this.zoom.zoomManager}get Ub(){return fa.f(this.$).Ub}get ju(){return this.ha.selectionType}set ju(F){this.ha.selectionType=F}dispose(){this.vy.forEach(F=>{wb.a.instance.Ua(Wa.a.Sd,F,this.onPointerDown)});this.vy.length=0;this.RKa=this.sourceRange=this.Xb=null;C.ULS.sendTraceTag(537159381,0,50,`DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = ${this.vha}, EwaControl is null : ${!this.$}`);
this.$&&(this.$.tm(this.de),1===this.vha&&(C.ULS.sendTraceTag(537159380,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.LDa(this.Omd,this.Pmd,!1)));super.dispose()}Lqg(F){if(5!==this.ju)return!1;(F=this.i2a(F))||this.Kwc(!1);pd.b(this.$,!1);return F}qxa(F,va){C.ULS.shipAssertTag(537159377,0,!this.vha,`DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected but got ${this.vha}`);this.vha+=1;this.Omd=F;this.Pmd=
va;this.Lx?this.Qr.Wnk(this.Jqg,this.Pqg,this.H9b()):this.Qr.qxa(F,va,this.H9b())}bia(F){if(!F||!this.Xb)return C.ULS.shipAssertTag(537159376,0,!!F,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),C.ULS.shipAssertTag(537159375,0,!!this.Xb,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;const va=this.Xb.clone();1!==this.SM&&(va.left=Math.max(F.left-this.Vjb,1),va.right=va.left+this.sourceRange.width-1);2!==this.SM&&(va.top=Math.max(F.top-
this.mxb,1),va.bottom=va.top+this.sourceRange.height-1);return this.a2d(va)}LDa(F,va,lb,sc){lb=void 0===lb?!0:lb;sc=void 0===sc?!0:sc;C.ULS.shipAssertTag(537159374,0,1===this.vha,`DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration but got ${this.vha}`);--this.vha;this.Lx?this.Qr.ral(this.Jqg,this.Pqg,this.H9b()):this.Qr.m6g(F,va,this.H9b());lb&&this.Gef(sc);this.SM=0;this.t6a=!1}a2d(F){const va=F.clone();va.right>ic.a.rf&&1!==this.SM&&(va.right=ic.a.rf,va.left=va.right-
F.width+1);va.bottom>ic.a.sf&&2!==this.SM&&(va.bottom=ic.a.sf,va.top=va.bottom-F.height+1);var lb=fa.f(this.$);if(lb.rb.gr){const sc=lb.rb.SA;lb=lb.rb.ZD;va.left<sc&&1!==this.SM&&(va.left=sc,va.right=Math.min(va.left+F.width-1,ic.a.rf));va.top<lb&&2!==this.SM&&(va.top=lb,va.bottom=Math.min(va.top+F.height-1,ic.a.sf))}this.Xg||(this.RKa=va);return va}wXc(F){this.vy.forEach(va=>{ea.DOMElementExtensions.setVisible(va,F)})}b_f(){return!this.Xb.equals(this.RKa)}gfa(F){this.RKa=this.Xb;this.Xb=F}EVi(F){const va=
F.sc;F=F.clientPoint;if(!va||!F)return C.ULS.shipAssertTag(537159373,0,!!va,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),C.ULS.shipAssertTag(537159372,0,!!F,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),null;F.y+=va===this.vy[Kb.hMb]?2:va===this.vy[Kb.GCd]?-2:0;F.x+=va===this.vy[Kb.yuc]?2:va===this.vy[Kb.gMb]?-2:0;return this.Lx?this.ha.r0(F,va,5,!0):this.ha.Ft(F,va,5,void 0,void 0,!0)}}Kb.orc="copy";Kb.ICd="grabbing";Kb.hMb=0;Kb.GCd=1;Kb.yuc=
2;Kb.gMb=3;Object(O.a)(Kb,"DragSelectionClickBehaviorBase",Tc,[]);class rb extends Kb{constructor(F,va,lb,sc,Yc,jd,Ad){super(F,va,lb,Yc,Ad);this.qd=this.KR=null;this.yRf=()=>{this.Kwc(!0)};for(const Kd of this.Gne)va=this.Qr.Yjf(F,Kd,[ed.Tyf],this.onPointerDown),this.vy.push(va);this.wXc(this.$.isEditMode);this.$K=sc;F=Ka.a.Cb(Ba.FormulaAssistanceManagerService);C.ULS.shipAssertTag(512312961,0,!!F,"DragMarqueeClickBehavior Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen.");
this.WA=F.WA;for(const Kd of this.vy)wb.a.instance.va(Wa.a.B3,Kd,this.$K.RUf),wb.a.instance.va(Wa.a.sG,Kd,this.$K.SUf);this.hcb(jd)}hcb(F){this.Qr.u6b(F,this.vy);this.$K.wV()}K$d(F){C.ULS.sendTraceTag(537159390,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");this.da.JYa=!0;this.qd.VJ(!1);this.ju=5;this.$K.erf(F.sc);this.qd.Za.removeSelection();this.qd.vlc(this.yRf);this.qxa(this.Lm,this.sj);this.SM=this.sourceRange.isRow?1:this.sourceRange.Oe?2:0}i2a(){const F=
this.k4();this.ju=-1;this.LDa(this.Lm,this.sj);return F}Gef(){this.da.JYa=!1;this.$K.frf(this.vy[0]);this.qd.Za.setCaretPositionToEnd();this.qd.dUc(this.yRf);this.Qr.yDg()}Kwc(F){C.ULS.sendTraceTag(537159389,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate formula highlights as a fallback in CleanUp.");F&&this.LDa(this.Lm,this.sj)}iOd(F){this.qd=this.Qr.zJd();this.KR=this.Qr.tNf(F);return this.qd&&this.KR&&this.KR.range?this.KR.range:(C.ULS.shipAssertTag(537159388,
0,!!this.qd,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),C.ULS.shipAssertTag(537159387,0,!!this.KR,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),C.ULS.shipAssertTag(537159386,0,!!this.KR.range,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),null)}k4(){return this.KR?this.WA.Rfg(this.qd,this.KR,this.Xb):(C.ULS.shipAssertTag(537159385,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),
!1)}Jwb(){return this.k4()}H9b(){return!0}L$d(){return!1}ise(){return!0}}Object(O.a)(rb,"DragMarqueeClickBehavior",Kb,[]);var rc=a(94),ld=a(155),Tb=a(189),Wc=a(363),Ac=a(944),nd=a(72),qd=a(231),Xd=a(36),Hd=a(45),Zc=a(377),Jc=a(233),gc=a(44),dd=a(435);class Bb extends Kb{constructor(F,va,lb,sc,Yc,jd){super(F,va,lb,Yc,jd);this.sc=this.Iia=this.SKa=this.kw=null;this.Oe=this.isRow=!1;this.nm=oa.EwaSettings.nm();this.d2=oa.EwaSettings.LQ()&&oa.EwaSettings.ZWd();this.XEa=nd.a.DX;this.kMb=0;this.i_d=!1;
this.N4f=oa.EwaSettings.isChangeGateEnabled("OfficeVSO:8971925_setUpDragShadowJSCrashFix");this.Mng=(Ad,Kd)=>{this.DUb=!0;this.onPointerDown(Kd)};this.ph=()=>{this.domElement.classList.remove(ed.selecting);this.wXc(this.$.isEditMode&&!this.goi());if(this.ha.oa.I2){const Ad=this.Ob(this.ha.oa.Ed);null!==Ad&&(Ad.hasAutoFilter?this.domElement.classList.add(ed.Uyf):this.domElement.classList.remove(ed.Uyf))}};this.Hw=()=>{this.domElement.classList.add(ed.selecting)};this.je=sc;this.ZVd=!1;if(0===Bb.guc[lb].length)for(const Ad of this.Gne)va=
document.createElement("div"),va.className=Ad,va.classList.add(ed.Tyf),Bb.guc[lb].push(va);for(const Ad of Bb.guc[lb])F.appendChild(Ad),wb.a.instance.va(Wa.a.Sd,Ad,this.onPointerDown),this.vy.push(Ad);this.wXc(this.$.isEditMode);this.Xg||(this.Qt={});this.da.FQ=!1;this.ha.vqa(this.Hw);this.ha.Qaa(this.ph);this.Lx&&1===this.paneType&&(this.NDa(),this.da.hFh(this.Mng));void Ka.a.resolve(Ba.InteractivityTrackerServiceIdentifier).then(Ad=>{this.LHa=Ad})}dispose(){this.ha&&(this.ha.tma(this.Hw),this.ha.z9(this.ph));
if(!this.Xg){if(this.Qt)for(var F=1;4>=F;F++)ea.DOMElementExtensions.vh(this.Qt[F.toString()]);this.Qt=null}for(F=1;4>=F;F++)Bb.guc[F].length=0;this.kw=null;this.Lx&&1===this.paneType&&this.da.Utk(this.Mng);super.dispose()}Gef(F){F&&(fa.f(this.$).$h.Jt(S.a.I7),this.Hef(),this.da.FQ=!1);if(!this.Xg)for(F=1;4>=F;F++){const va=this.Qt[F.toString()];va&&va.parentNode.removeChild(va);this.Qt[F.toString()]=null}this.kw=null;this.Xg&&(this.SKa=null)}iOd(){return this.ha.oa.Ed}k4(){this.ha.updateSelection(this.Xb,
this.Xb.topLeft,0);return!0}O5a(F,va){va=void 0===va?!1:va;var lb=!isNullOrUndefined(this.Pba);if(F&&va||F!==lb){lb=this.mU();var sc=this.i8();F&&(lb||sc)?(va&&this.Pba&&(this.Ub.rl(this.Pba),this.Pba=null),this.Ub.Rjb(!0),this.Pba=this.YVd()?[65]:[62,lb?63:64],this.Ub.pn(this.sourceRange,this.Pba),this.Ub.Iq(this.Pba),C.ULS.sendTraceTag(507872737,0,50,`DragSelectionClickBehavior.showOrHideSourceHighlights: show source highlights for ${this.YVd()?"copy":"cut"} operation`)):this.Pba&&(this.Ub.rl(this.Pba),
this.Pba=null,this.Ub.wfa(),C.ULS.sendTraceTag(507872736,0,50,"DragSelectionClickBehavior.showOrHideSourceHighlights: hide source highlights"))}}Ucf(F){this.grf=F}y7b(F){isNullOrUndefined(this.Pba)&&Math.abs(this.mU()?F.y-this.grf.y:F.x-this.grf.x)>=Bb.OZk&&this.O5a(!0)}A3c(){const F=!isNullOrUndefined(this.Pba);this.O5a(F,!0)}Jwb(F){F=void 0===F?!1:F;if(this.Xg&&!this.b_f()&&this.Iia)return!0;if(this.nm){const lb=this.mU();var va=this.i8();lb||va?(va=this.l6f(),this.Iia=lb?Bb.Eji:Bb.Dji,this.Ub.pn(this.Xb,
this.Iia),va?(this.Ub.Iq(this.Iia),this.Xg&&this.EAe(F,!0,!1)):(this.RRb(),this.Xg&&this.vN())):(this.Iia=Bb.sVa,this.Ub.pn(this.Xb,this.Iia),this.Ub.Iq(this.Iia),this.Xg&&this.EAe(F,!0,!1))}else this.Ub.pn(this.Xb,Bb.sVa),this.Ub.Iq(Bb.sVa);this.Xg||this.I7a(F);return!0}RRb(){this.Iia&&(this.Ub.rl(this.Iia),this.Iia=null)}Kwb(F,va,lb){F=void 0===F?!1:F;va=void 0===va?!0:va;lb=void 0===lb?!1:lb;const sc=this.KTk();if(!this.Xg||this.b_f()||sc){this.Ub.pn(this.Xb,this.kw);if(this.nm){const Yc=this.mU()||
this.i8(),jd=this.m6f();Yc&&!jd?this.SKa&&(this.Ub.rl(this.kw),this.Xg&&this.vN()):(this.Xg&&this.SKa&&sc&&this.Ub.rl(this.SKa),this.Ub.Iq(this.kw),this.Xg&&(this.SKa=this.kw,this.EAe(F,va,!0,lb)))}else this.Ub.Iq(this.kw);this.Xg||this.I7a(F)}}KTk(){return this.SKa&&this.kw?!(this.kw.length===this.SKa.length&&this.kw.every((F,va)=>F===this.SKa[va])):!0}NDa(){this.DUb=!1}xTh(F,va,lb,sc,Yc,jd,Ad,Kd,ye){va?(va=Ad,Yc=sc.y+Yc.y-jd.y-Kd,Ad=jd.width-ye-va,sc=sc.height,F=F.y-jd.y-Yc):(va=lb?sc.x-Yc.right+
jd.right+Kd:sc.x+Yc.left-jd.left-Kd,Yc=Ad,Ad=sc.width,sc=jd.height-ye-Yc,F=lb?jd.width-(F.x-jd.left)-va:F.x-jd.left-va);return{XEa:new nd.a(va,Yc,Ad,sc),kMb:F}}yTh(F,va,lb,sc,Yc,jd){va?(va=sc.x,F=F.y-jd.y-Yc):(va=lb?jd.width-(F.x-jd.left)-Yc:F.x-jd.left-Yc,F=sc.y);return new Sys.UI.Point(va*(lb?-1:1),F)}Ozd(){Bb.QO=document.createElement("div");Bb.QO.className=ed.gwi;var F=document.createElement("div");Bb.QO.appendChild(F);F=document.createElement("div");F.className=ed.Syf;Bb.QO.appendChild(F);this.da.nh.appendChild(Bb.QO)}s4(){Bb.QO?
(ea.DOMElementExtensions.setVisible(Bb.QO,!0),this.i_d=!0):C.ULS.shipAssertTag(507314703,0,!1,"DragSelectionClickBehavior showTooltip: TooltipDiv is null")}vN(){Bb.QO&&(ea.DOMElementExtensions.setVisible(Bb.QO,!1),this.i_d=!1)}EAe(F,va,lb,sc){Bb.QO||this.Ozd();var Yc=this.da.rb.Yh(this.Xb);const jd=this.da.Wg(this.Xb,Yc,!0);if(jd){var Ad=$c.HelperMethods.isStandardZoomCssSupportedByBrowser?ea.DOMElementExtensions.lib({element:this.da.nh,di:!0}):this.da.nh.getBoundingClientRect(),Kd=this.da.pg(Yc),
ye=dd.a.pN(Yc,Kd.view.Ci);Yc=va?ye.x:0;va=va?ye.y:0;oa.EwaSettings.sZa()?(ye=Kd.lX,Kd=this.da.rtl?ye.x+ye.width-jd.x+Yc:ye.x-Ad.x+jd.x-Yc):(ye=Kd.domElement.getBoundingClientRect(),Kd=this.da.rtl?ye.right-jd.x+Yc:ye.x-Ad.x+jd.x-Yc);ye=ye.y-Ad.y+jd.y-va;var Ne=lb?0:jd.height,hf=lb?0:jd.width;Yc=new Jc.a(Bb.QO.style);va=Yc.dz;if(this.mU())lb=this.da.rtl?Ad.right-Bb.zUf:Bb.zUf,sc=ye+Bb.eza+Ne,va.transform=this.da.rtl?`translate(calc(${lb}px - 100%), ${sc}px)`:`translate(${lb}px, ${sc}px)`;else if(this.i8())lb=
this.da.rtl?Kd+Bb.eza:Kd+Bb.eza+hf,sc=Bb.wjl,va.transform=`translate(${lb}px, ${sc}px)`;else if(lb&&sc||!lb&&(this.sc===this.vy[Kb.hMb]||this.sc===this.vy[Kb.GCd]))lb=this.da.rtl?Kd-jd.width+Bb.Ife*jd.width:Kd+Bb.Ife*jd.width,this.sc===this.vy[Kb.hMb]?(sc=ye-Bb.eza,va.transform=`translate(${lb}px, calc(${sc}px - 100%))`):(sc=ye+Bb.eza+Ne,va.transform=`translate(${lb}px, ${sc}px)`);else if(lb&&!sc||!lb&&(this.sc===this.vy[Kb.yuc]||this.sc===this.vy[Kb.gMb]))sc=ye+Bb.Ife*jd.height,this.sc===this.vy[Kb.yuc]?
(lb=this.da.rtl?Kd-Bb.eza-hf:Kd-Bb.eza,va.transform=`translate(calc(${lb}px - 100%), ${sc}px)`):(lb=this.vy[Kb.gMb]&&this.da.rtl?Kd+Bb.eza:Kd+Bb.eza+hf,va.transform=`translate(${lb}px, ${sc}px)`);this.I7a(F);Yc.q0();this.i_d||this.s4()}}sTg(F){var va=this.da.nh,lb=$c.HelperMethods.isStandardZoomCssSupportedByBrowser?ea.DOMElementExtensions.lib({element:va,di:!0}):va.getBoundingClientRect(),sc=this.da.Eb.VGf(F),Yc=this.da.Eb.ULf(sc)||this.da.pg(1);sc=Yc.domElement;const jd=$c.HelperMethods.isStandardZoomCssSupportedByBrowser?
ea.DOMElementExtensions.lib({element:sc,di:!0}):sc.getBoundingClientRect(),Ad=this.Ub.QWa(this.sourceRange,Yc.paneType,!1);if(this.N4f&&!Ad)C.ULS.shipAssertTag(507090181,0,!1,"DragSelectionClickBehavior setUpDragShadow: sourceRangeBounds is null. SourceRange: "+this.sourceRange+", PaneType: "+Yc.paneType),this.XEa=nd.a.DX,this.kMb=0;else{Yc=this.mU();var {XEa:Kd,kMb:ye}=this.xTh(F,Yc,this.da.rtl,Ad,jd,lb,(Yc?this.da.K9:this.da.oX).YLd(),Yc?sc.scrollTop:sc.scrollLeft,ud.a.Gt/this.zoomManager.zoom);
this.XEa=Kd;this.kMb=ye;Bb.Xba||(Bb.Xba=document.createElement("div"),Bb.Xba.id=`${this.da.$.Oc}rowColDragShadow`,Bb.Xba.className=ed.ewi,ea.DOMElementExtensions.setVisible(Bb.Xba,!1),va.appendChild(Bb.Xba));va=new Jc.a(Bb.Xba.style);lb=va.dz;lb.height=`${this.XEa.height}px`;lb.width=`${this.XEa.width}px`;this.Nub(F,va)}}SRb(){Bb.Xba&&ea.DOMElementExtensions.setVisible(Bb.Xba,!1)}Nub(F,va){if(!(!Bb.Xba||this.N4f&&this.XEa.equals(nd.a.DX))){va=va||new Jc.a(Bb.Xba.style);var lb=va.dz,sc=$c.HelperMethods.isStandardZoomCssSupportedByBrowser?
ea.DOMElementExtensions.lib({element:this.da.nh,di:!0}):this.da.nh.getBoundingClientRect(),{x:Yc,y:jd}=this.yTh(F,this.mU(),this.da.rtl,this.XEa,this.kMb,sc);lb.transform=`translate(${Yc}px, ${jd}px)`;ea.DOMElementExtensions.Ype(va,Bb.Xba,!0);va.q0()}}Ob(F){return(F=this.da.za.ft(F))?new Zc.a(F,this.da):null}goi(){if(this.ha.oa.vi){const F=this.ha.oa.Ed;if(null!=F&&1===F.top&&1===F.left&&F.bottom===F.maxRows&&F.right===F.maxColumns)return!0}return!1}Kwc(){C.ULS.sendTraceTag(508908561,0,15,"DragSelectionClickBehavior.FailureFallback: this function was not implemented for dragging selection")}H9b(){return!1}cub(F,
va,lb,sc){sc=void 0===sc?!1:sc;var Yc=ea.DOMElementExtensions.getBoundingClientRect({element:va,di:!0});let jd=va===this.vy[Kb.hMb]||va===this.vy[Kb.GCd];var Ad=va===this.vy[Kb.yuc]||va===this.vy[Kb.gMb];this.isRow&&Ad||this.Oe&&jd?Ad="100px":(jd=this.isRow||jd,Ad=this.nm?jd?(sc?Bb.x6k:Bb.C6k)+"px":(sc?Bb.u6k:Bb.y6k)+"px":(jd?sc?Bb.w6k:Bb.B6k:sc?Bb.v6k:Bb.z6k)+"px");va=jd?va===this.vy[Kb.hMb]?"top":"bottom":va===this.vy[Kb.gMb]?"right":"left";F=100*(jd?F.x-Yc.x:F.y-Yc.y)/(jd?Yc.width:Yc.height);for(Yc=
1;4>=Yc;Yc++){var Kd=document.createElement("div");const Ne=document.createElement("div");if(!this.Xg){var ye=document.createElement("div");Kd.appendChild(ye)}Kd.appendChild(Ne);sc&&(ye=document.createElement("div"),Kd.appendChild(ye),this.Xg?ye.className=ed.Syf:Ne.style.fontWeight="bold");Kd.className=this.nm?ed.hwi:ed.qwi;this.Qt[Yc.toString()]=Kd;this.Ub.sQ(lb,Yc).Gf.appendChild(Kd);if(Kd=this.Qt[Yc.toString()])Kd.style[va]=Ad,Kd.style[jd?"left":"top"]=F+"%"}}HJd(F,va,lb,sc){var Yc=fa.f(this.$);
const jd=Yc.pg(sc),Ad=dd.a.pN(sc,jd.view.Ci);lb=Ac.a.hA(Ad,jd.domElement,lb,Yc.rtl);sc=Yc.Wg(F,sc,!0);Yc=this.da.hd;return va&&lb.y-sc.topLeft.y>sc.height/2?gc.F(Yc.XOb(F)):!va&&lb.x-sc.topLeft.x>sc.width/2?gc.F(Yc.zQb(F)):F}QTa(F){this.Ub.rl(this.kw);this.LDa(this.VOc,this.WOc,void 0,F);this.y_c()}jT(F){this.nm?this.RRb():this.Ub.rl(Bb.sVa);this.LDa(this.Lm,this.sj,void 0,F);this.y_c()}y_c(){var F;this.ECd&&(null===(F=this.LHa)||void 0===F?void 0:F.stopTrackAnimation(this.ECd));this.ECd=void 0}i8b(F,
va){var lb;this.y_c();if(null===(lb=this.LHa)||void 0===lb?0:lb.startTrackAnimation(va,F))this.ECd=F}Wkb(F){return F.Ha.keyCode===rc.a.PNa||wa.a.isMac&&F.Ha.keyCode===rc.a.dxb}GVd(F){return F.Ha.ctrlKey||wa.a.isMac&&F.Ha.altKey}gTb(F){F=fa.f(this.$).getRangeInformation(F);for(let va=0,lb=F.length;va<lb;++va)if(Object(Wc.a)(qd.PivotTableRange,F[va]))return F=Xd.a.Cd(1,0,902,901,0,2105176604,"InsDelCellsPivotTable"),Hd.a(this.$).Zx([F]),!0;return!1}V2e(){this.ZVd||(this.ha.X4e(this.fae),this.ZVd=!0)}V3a(){this.ha&&
(this.ha.GHg(this.fae),this.ZVd=!1)}c5a(F){var va;this.da.FQ=F;null===(va=Ka.a.Cb(Ba.HeaderInsertService))||void 0===va?void 0:va.g8i(F)}mU(){return 1===this.SM}i8(){return 2===this.SM}}Bb.z6k=-85;Bb.B6k=-40;Bb.v6k=-120;Bb.w6k=-50;Bb.y6k=-95;Bb.C6k=-50;Bb.u6k=-130;Bb.x6k=-60;Bb.eza=15;Bb.zUf=150;Bb.wjl=100;Bb.Ife=.4;Bb.OZk=2;Bb.sVa=[48];Bb.Eji=[66,68];Bb.Dji=[67,69];Bb.slk=[58,60];Bb.rlk=[59,61];Bb.guc=[[],[],[],[],[],[]];Object(O.a)(Bb,"DragSelectionClickBehavior",Kb,[]);var pc=a(27),wc;(function(F){F[F.none=
0]="none";F[F.copyPasteLengthTooLong=1]="copyPasteLengthTooLong";F[F.applyLinkFailed=2]="applyLinkFailed";F[F.pasteHtmlFailed=3]="pasteHtmlFailed";F[F.pasteStringFailed=4]="pasteStringFailed";F[F.pasteRangeFailed=5]="pasteRangeFailed";F[F.pasteFromClipboardIsNotValidForFormattingAndTranspose=6]="pasteFromClipboardIsNotValidForFormattingAndTranspose";F[F.asyncCopyFailedToPopulateClipboard=7]="asyncCopyFailedToPopulateClipboard";F[F.clipboardIsInaccessible=8]="clipboardIsInaccessible";F[F.pasteArtFailed=
9]="pasteArtFailed";F[F.noArtSourceItem=10]="noArtSourceItem";F[F.blockedCrossSessionArtPaste=11]="blockedCrossSessionArtPaste";F[F.failedToParseShadowWorkbookJson=12]="failedToParseShadowWorkbookJson";F[F.invalidShadowWorkbook=13]="invalidShadowWorkbook";F[F.failedToStringifyShadowWorkbook=14]="failedToStringifyShadowWorkbook";F[F.failedToPasteExternalImage=15]="failedToPasteExternalImage";F[F.lastAsyncSerializeFailed=16]="lastAsyncSerializeFailed";F[F.pasteOnArtIsNotValidForText=17]="pasteOnArtIsNotValidForText";
F[F.pasteFromExternalNotSupportDiscontinuousSelection=18]="pasteFromExternalNotSupportDiscontinuousSelection";F[F.pasteFromSameSessionNotSupportDiscontinuousSelection=19]="pasteFromSameSessionNotSupportDiscontinuousSelection";F[F.pasteFromCrossSessionNotSupportDiscontinuousSelection=20]="pasteFromCrossSessionNotSupportDiscontinuousSelection";F[F.insertCopiedCutCellsFailed=21]="insertCopiedCutCellsFailed";F[F.rearrangeRowColumnFailed=22]="rearrangeRowColumnFailed";F[F.invalidHtml=23]="invalidHtml";
F[F.failedToProcessClipboardHtml=24]="failedToProcessClipboardHtml"})(wc||(wc={}));Object(O.b)("PasteErrorType",wc);class cd{constructor(F,va){this.errorName=this.innerError=null;this.errorName=F;this.innerError=void 0===va?null:va}}Object(O.a)(cd,"CCPError",null,[]);class Vd extends cd{constructor(F,va){va=void 0===va?null:va;super(Xd.a.pc(void 0===F?null:F,"_"),va)}}Object(O.a)(Vd,"EwaCCPError",cd,[]);class xb extends cd{constructor(F,va,lb,sc,Yc){va=void 0===va?null:va;lb=void 0===lb?null:lb;sc=
void 0===sc?"":sc;Yc=void 0===Yc?100:Yc;super(wc[F]);this.pasteErrorName=0;this.ewaErrors=this.message=null;this.validationFailureReason=0;this.pasteErrorName=F;this.ewaErrors=va;this.validationFailureReason=Yc;this.innerError=va?new Vd(va,lb):lb;this.message=sc}}Object(O.a)(xb,"PasteInnerError",cd,[]);var ub=a(213),Fc=a(124),xd=a(266),Ic=a(61);class bd{constructor(F,va){this.destinationRange=this.sourceRange=null;this.sourceRange=F;this.destinationRange=va}}Object(O.a)(bd,"MacroRecorderTableRowColumnRearrangedPayload",
null,[67]);class yb extends Bb{constructor(F,va,lb,sc,Yc,jd,Ad){super(F,va,lb,sc,Yc,jd);this.ina=null;this.kE=this.fG=!1;this.LWb=0;this.P6b=this.tVa=null;this.XM=0;this.dAd=null;this.crf=this.Xg?Ha.a.instance.Ib(246):Ha.a.instance.ia(2269);this.Jji=this.Xg?Ha.a.instance.Ib(247):Ha.a.instance.ia(2270);this.dUg=this.Xg?Ha.a.instance.ia(2552):Ha.a.instance.ia(2271);this.$Pk=this.Xg?Ha.a.instance.ia(2553):Ha.a.instance.ia(2272);this.Mc=null;this.yFc=oa.EwaSettings.isChangeGateEnabled("OfficeVSO:8963999_DragTooltipDragResponsivenessRegressionFix");
this.hrf=null;this.onKeyDown=Kd=>{if(this.Wkb(Kd)||Kd.Ha.keyCode===rc.a.fxb){this.M2b();!this.u2&&this.Wkb(Kd)&&(this.u2=!0,fa.f(this.$).$h.Jt(Kb.orc),this.nm&&this.A3c());if(!this.iE&&Kd.Ha.keyCode===rc.a.fxb){this.iE=!0;const ye=this.Xg?!0:!1;2===this.XM?(this.jT(!1),this.SM=0,this.fG=this.kE,this.j8b(ye,Kd.Ha.rawEvent)):3===this.XM?(this.PTa(!1),this.SM=this.isRow?1:2,this.Z9(ye,Kd.Ha.rawEvent)):1===this.XM&&(this.QTa(!1),this.Z9(ye,Kd.Ha.rawEvent))}return!0}return!1};this.onKeyUp=Kd=>this.Wkb(Kd)||
Kd.Ha.keyCode===rc.a.fxb?(this.LWb=this.Wkb(Kd)?0:1,this.Xg&&this.zNa(this.LWb),1===this.LWb&&(2===this.XM?(this.PTa(!1),this.SM=0,this.Z9(!0,Kd.Ha.rawEvent)):3===this.XM?(this.jT(!1),this.SM=this.isRow?1:2,this.j8b(!0,Kd.Ha.rawEvent)):1===this.XM&&(this.jT(!1),this.jvb(!0,Kd.Ha.rawEvent))),this.Xg||this.zNa(this.LWb),0===this.LWb&&(this.da.FQ&&fa.f(this.$).$h.Jt(Kb.ICd),this.nm&&this.A3c()),!0):!1;this.WOc=Kd=>{Kd=this.zoomManager.Qf(Kd);this.V3a();5===this.ju?this.Lqg(Kd):(this.d2?this.c5a(!1):
this.da.FQ=!1,this.nm&&(this.O5a(!1),this.SRb()),this.Yke(),!this.$.Ss([this.Xb],!1)||this.tlk()||this.XXd()||(this.ha.sourceRange=this.sourceRange.clone(),this.ngk(),this.kE?this.Xb.top>this.sourceRange.top&&(Kd=this.Xb.height,this.Xb.top-=Kd,this.Xb.bottom-=Kd):this.Xb.left>this.sourceRange.left&&(Kd=this.Xb.width,this.Xb.left-=Kd,this.Xb.right-=Kd),this.k4()));this.QTa(!0);this.tableRange=null;this.ju=-1;this.ina=null;this.XM=0;return!0};this.Oqg=()=>{this.d2?this.c5a(!1):this.da.FQ=!1;this.V3a();
this.XM=0;this.nm&&(this.O5a(!1),this.SRb());this.Yke();if(!this.$.Ss([this.Xb],!1))return this.PTa(!0),this.ju=-1,this.NDa(),!0;if(this.H$g()&&!this.gTb(this.Xb)&&!this.gTb(this.sourceRange)&&!this.XXd()){this.k4();this.ha.sourceRange=this.sourceRange.clone();var Kd=this.ha.sourceRange;const ye=this.ha.oa.Ed;this.Lx?this.$.Dc(-694765314,2,30,{[S.a.Yia]:this.u2,[S.a.xuc]:!0,[S.a.zuc]:this.fG,[S.a.k1]:Kd,[S.a.j1]:ye,[S.a.lsa]:this.iE,[S.a.ggb]:this.DUb}):this.$.Dc(-694765314,2,30,{[S.a.Yia]:this.u2,
[S.a.xuc]:!0,[S.a.zuc]:this.fG,[S.a.k1]:Kd,[S.a.j1]:ye,[S.a.lsa]:this.iE});this.u2||(this.Xb.top>this.sourceRange.top&&(this.isRow||this.Xb.left===this.sourceRange.left&&this.fG)?(Kd=this.Xb.height,this.Xb.top-=Kd,this.Xb.bottom-=Kd):this.Xb.left>this.sourceRange.left&&(this.Oe||this.Xb.top===this.sourceRange.top&&!this.fG)&&(Kd=this.Xb.width,this.Xb.left-=Kd,this.Xb.right-=Kd),this.k4())}this.PTa(!0);this.ina=this.tableRange=null;this.ju=-1;this.fG=!1;this.NDa();return!0};this.VOc=Kd=>{Kd=this.zoomManager.Qf(Kd);
var ye=Kd.clientPoint;this.nZ=Kd;var Ne=this.Lx?this.ha.r0(ye,Kd.sc,5,!0):this.ha.Ft(ye,Kd.sc,5,void 0,void 0,!0);this.nm&&(this.mU()||this.i8())&&(this.Nub(ye),this.y7b(ye));if(Ne){if(this.tableRange.contains(Ne.topLeft)){if(Kd=this.da.rb.Yh(Ne),Ne=this.HJd(Ne,this.kE,ye,Kd),this.Xg?this.gfa(this.D0(Ne)):this.Xb=this.D0(Ne),this.ha.sourceRange=this.Xb,this.Xg?this.Kwb(!1,Kd===this.da.rb.Yh(this.Xb),this.kE):(this.Ub.pn(this.Xb,this.kw),this.Ub.Iq(this.kw)),this.nm?this.RRb():this.Ub.rl(Bb.sVa),6!==
this.ju){if(!this.Xg)for(ye=1;4>=ye;ye++)if(Ne=this.Qt[ye.toString()])Ne.parentNode.removeChild(Ne),this.Ub.sQ(this.kE?11:12,ye).Gf.appendChild(Ne);this.ju=6}}else this.Xg?this.gfa(this.bia(Ne)):this.Xb=this.bia(Ne),this.QQf(Kd,!1);this.Xg||this.I7a(!1)}return!0};this.Hqg=Kd=>{Kd=this.zoomManager.Qf(Kd);var ye=Kd.clientPoint;this.nZ=Kd;var Ne=this.Lx?this.ha.r0(ye,Kd.sc,5,!0):this.ha.Ft(ye,Kd.sc,5,void 0,void 0,!0);this.nm&&(this.mU()||this.i8())&&(this.Nub(ye),this.y7b(ye));if(Ne){if(this.DSf(Ne))return this.Xg?
this.gfa(this.bia(Ne)):this.Xb=this.bia(Ne),this.PQf(Kd,!1),!0;var hf=this.da.rb.Yh(Ne);if(this.isRow||this.Oe)Ne=this.HJd(Ne,this.isRow,ye,hf),this.Xg?this.gfa(this.bia(Ne)):this.Xb=this.bia(Ne);else{var sf=fa.f(this.$),Gf=sf.pg(hf);const Yf=dd.a.pN(hf,Gf.view.Ci);ye=Ac.a.hA(Yf,Gf.domElement,ye,sf.rtl);sf=sf.Wg(Ne,hf,!0);this.fG=Gf=!1;Math.abs(ye.x-sf.topLeft.x)<.3*sf.width?this.fG=!1:Math.abs(ye.x-sf.bottomRight.x)<.15*sf.width?(this.fG=!1,Gf=!0):ye.y-sf.topLeft.y<=sf.height/2?this.fG=!0:ye.y-sf.topLeft.y>
sf.height/2&&(Gf=this.fG=!0);this.ina&&(this.fG=this.kE);Gf&&(sf=this.da.hd,Ne=this.fG?gc.F(sf.XOb(Ne)):gc.F(sf.zQb(Ne)));this.Xg||this.Ub.rl(this.kw);this.kw=this.fG?[11]:[12];if(!this.Xg){for(sf=1;4>=sf;sf++)(ye=this.Qt[sf.toString()])&&ye.parentNode.removeChild(ye),this.Qt[sf.toString()]=null;this.cub(Kd.clientPoint,Kd.sc,this.fG?11:12)}this.Xg?this.gfa(this.D0(Ne)):this.Xb=this.D0(Ne)}this.ha.sourceRange=this.Xb;Kd=this.Xg?hf===this.da.rb.Yh(this.Xb):!0;this.nm?this.Kwb(!1,Kd,this.Xg?this.fG:
!1):(this.Ub.pn(this.Xb,this.kw),this.Ub.Iq(this.kw));this.nm?this.RRb():this.Ub.rl(Bb.sVa);if(6!==this.ju){if(!this.Xg)for(Kd=1;4>=Kd;Kd++)if(Ne=this.Qt[Kd.toString()])hf=this.nm?this.isRow?58:this.Oe?59:this.fG?11:12:this.isRow||this.fG?11:12,Ne.parentNode.removeChild(Ne),this.Ub.sQ(hf,Kd).Gf.appendChild(Ne);this.ju=6}this.nm||this.I7a(!1)}return!0};this.fae=()=>{this.da.FQ&&5<=this.ju&&(this.tableRange?this.iE?this.jT(!0):this.QTa(!0):this.iE?this.isRow||this.Oe?this.jT(!0):this.PTa(!0):this.isRow||
this.Oe?this.PTa(!0):this.jT(!0));this.zNa(void 0);this.XM=0;this.ju=-1;this.V3a()};this.tableRange=null;this.Xua=this.u2=this.iE=!1;this.Mc=Ad}dispose(){this.zNa(void 0);super.dispose()}K$d(F){this.nZ=F;this.Xg&&(this.sc=this.nZ.sc);this.ina=null;this.kE=this.isRow=this.Oe=this.fG=!1;ld.a.instance.va(Wa.a.nd,this.domElement.ownerDocument.body,this.onKeyDown);if(F.Ha.shiftKey||this.GVd(F))this.M2b(),F.Ha.shiftKey&&(this.iE=!0),this.GVd(F)&&(this.u2=!0,fa.f(this.$).$h.Jt(Kb.orc));this.V2e();this.d2?
this.c5a(!0):this.da.FQ=!0;this.tableRange=this.dUh(this.je.jt(this.sourceRange.topLeft));const va=this.Xg?!0:!1;this.tableRange&&!this.tableRange.equals(this.sourceRange)?(this.ina=this.tableRange,this.XM=1,this.kE=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right,this.iE?this.Z9(va,F.Ha.rawEvent):this.jvb(!0,F.Ha.rawEvent)):(this.tableRange=null,this.isRow=this.sourceRange.isRow,this.Oe=this.sourceRange.Oe,this.isRow||this.Oe?(this.XM=3,this.SM=this.isRow?
1:2,this.iE?this.Z9(va,F.Ha.rawEvent):this.j8b(!0,F.Ha.rawEvent),this.nm&&(F=F.clientPoint,this.sTg(F),this.Ucf(F))):(this.XM=2,this.SM=0,this.iE?this.j8b(va,F.Ha.rawEvent):this.Z9(!0,F.Ha.rawEvent)))}i2a(){this.d2?this.c5a(!1):this.da.FQ=!1;this.V3a();this.XM=0;this.nm&&(this.O5a(!1),this.SRb());this.Yke();if(!this.$.Ss([this.Xb],!1))return this.jT(!0),this.NDa(),this.ju=-1,!0;if(!this.H$g()||this.gTb(this.Xb)||this.gTb(this.sourceRange))this.ju=-1;else{this.k4();this.ha.sourceRange=this.sourceRange.clone();
const F=this.ha.sourceRange,va=this.ha.oa.Ed;this.Lx?this.$.Dc(-694765314,2,30,{[S.a.Yia]:this.u2,[S.a.k1]:F,[S.a.j1]:va,[S.a.lsa]:this.iE,[S.a.ggb]:this.DUb}):this.$.Dc(-694765314,2,30,{[S.a.Yia]:this.u2,[S.a.k1]:F,[S.a.j1]:va,[S.a.lsa]:this.iE})}this.jT(!0);this.NDa();return!0}L$d(F){const va=F.clientPoint,lb=this.Lx?this.ha.r0(va,F.sc,5,!0):this.ha.Ft(va,F.sc,5,void 0,void 0,!0);this.nZ=F;this.nm&&(this.mU()||this.i8())&&(this.Nub(va),this.y7b(va));return this.DSf(lb)?(this.Xg?this.gfa(this.D0(lb)):
this.Xb=this.D0(lb),this.PQf(F,!0),!0):this.paj(lb)?(this.Xg?this.gfa(this.bia(lb)):this.Xb=this.bia(lb),this.QQf(F,!0),!0):!1}POd(F){return!this.mU()||this.iE&&1!==F.height?!this.i8()||this.iE&&1!==F.width?F.toString():pc.Range.dK(F.left):F.top.toString()}I7a(F){if(this.Xg)Bb.QO&&(this.yFc&&this.tVa===this.dAd?this.hrf.textContent=this.POd(this.Xb):(F=this.yFc?'<span id="dragTooltipRange" style="font-weight:600;">'+this.POd(this.Xb)+"</span>":'<span style="font-weight:600;">'+this.POd(this.Xb)+"</span>",
this.Mc.vl(Bb.QO.childNodes[0],String.format(this.tVa,F)),this.yFc&&(this.hrf=Bb.QO.querySelector("#dragTooltipRange"),this.dAd=this.tVa),Bb.QO.childNodes[1].innerText=this.iE?"":this.P6b));else{const va=this.Xb.toString();for(let lb=1;4>=lb;lb++){const sc=this.Qt[lb.toString()];sc&&sc.childNodes&&0<sc.childNodes.length&&(sc.childNodes[0].innerText=va,sc.childNodes[1].innerText=this.tVa,F&&(sc.childNodes[2].innerText=this.P6b))}}}DSf(F){return!!this.ina&&1!==this.XM&&!!F&&this.ina.contains(F.topLeft)}paj(F){return!!this.ina&&
1===this.XM&&!!F&&!this.ina.contains(F.topLeft)}PQf(F,va){this.tableRange=this.ina;this.XM=1;const lb=!this.iE;va?(this.jT(!1),this.jvb(this.Xg?!0:lb,F.Ha.rawEvent)):(this.PTa(!1),this.Z9(this.Xg?!1:lb,F.Ha.rawEvent))}QQf(F,va){this.tableRange=null;this.XM=2;const lb=!this.iE;va?(this.jT(!1),this.fG=this.kE,this.j8b(this.Xg?!1:lb,F.Ha.rawEvent)):(this.QTa(!1),this.Z9(this.Xg?!0:lb,F.Ha.rawEvent))}ise(){if(!fa.f(this.$).ha.oa.vi)return!1;const F=fa.f(this.$).getRangeInformation(this.ha.oa.Ed);for(const va of F)if(Object(Wc.a)(qd.PivotTableRange,
va))return!1;return!0}dUh(F){if(F&&F.contains(this.sourceRange)&&!F.equals(this.sourceRange)){if(F.eua&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===F.top){const va=new pc.Range(this.sourceRange.top,this.sourceRange.left,F.bottom,this.sourceRange.right,!1,!1);if(!va.equals(F))return this.sourceRange=va,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),F}this.kE=F.left===this.sourceRange.left&&F.right===this.sourceRange.right;if(F.top===this.sourceRange.top&&
F.bottom===this.sourceRange.bottom||this.kE)return F}return null}D0(F){const va=F.clone();this.kE?va.left=Math.max(F.left-this.Vjb,1):va.top=Math.max(F.top-this.mxb,1);va.right=va.left+this.sourceRange.width-1;va.bottom=va.top+this.sourceRange.height-1;return this.a2d(va)}XXd(){const F=this.Xb.topLeft.ld(this.sourceRange);return!F&&(this.tableRange||this.nm&&(this.isRow||this.Oe))?this.kE||this.nm&&this.isRow?this.Xb.top===this.sourceRange.bottom+1:this.Xb.left===this.sourceRange.right+1:F}tlk(){if(this.kE&&
this.Xb.left!==this.tableRange.left||!this.kE&&this.Xb.top!==this.tableRange.top){const F=Xd.a.Cd(1,1,0,918,0,2065438552,"RearrangeInvalidDest");Hd.a(this.$).Zx([F]);return!0}return!1}ngk(){const F=this.$.Vb.Uc("UserAction","RearrangeRowColumnClientSide"),va={["CopyPasteTargetType"]:1,["OperationId"]:Tb.a.create().toString(),["Stopwatch"]:F,["DragDropIsShiftKeyDown"]:this.iE,["EncounteredDeploymentErrors"]:!1},lb=this.u2?2:1,sc=this.$.ra.Tb(254);(new Promise((Yc,jd)=>{this.gyi(Ad=>{Ad.Errors&&0<Ad.Errors.length?
jd(new xb(22,Ad.Errors)):Yc(!0)},Ad=>{Ad=Fc.a.te(Ad.data);jd(new xb(22,Ad))})})).then(()=>{C.ULS.sendTraceTag(520747156,0,50,'DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: success. copyPasteTargetType="1"');sc&&sc.NGj(va,lb,this.sourceRange,this.Xb);return Promise.resolve(!0)},Yc=>{C.ULS.sendTraceTag(520747155,0,10,`DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: ${Yc?copyPasteInfra.getStringifiedError(Yc):"null"}, copyPasteTargetType="${1}"`);return sc?sc.B3j(Yc,
va,lb,this.sourceRange,this.Xb):Promise.reject(Yc)})}gyi(F,va){F=void 0===F?null:F;va=void 0===va?null:va;const lb={};this.kE?(lb.FirstRow=this.Xb.top-1,lb.FirstColumn=0,lb.DeltaColumn=0,lb.DeltaRow=this.Xb.bottom-this.Xb.top+1):(lb.FirstRow=0,lb.FirstColumn=this.Xb.left-1,lb.DeltaColumn=this.Xb.right-this.Xb.left+1,lb.DeltaRow=0);lb.LastRow=ic.a.Qz;lb.LastColumn=ic.a.Ny;lb.SheetName=this.$.qa.la?this.$.qa.la.name:this.$.wc.getItemByName(this.$.wc.la.name).sheetName;const sc=gc.y(this.sourceRange,
this.$);this.$.userOperationManager.enqueueOperation(new ub.a(514,0,(Yc,jd,Ad)=>{var Kd=this.$.ma.sa;Yc=F?xd.c(Yc,F):Yc;jd=va?xd.b(jd,va):jd;const ye=Kd.$a(41,null);ye.sourceRange=sc;ye.destinationRange=lb;return Ic.h(Kd,"RearrangeRowColumn",ye,Yc,jd,Ad,null,0)},64,()=>new bd(sc,lb)),null)}zNa(F){void 0===F?this.iE=this.u2=!1:0===F?this.u2=!1:1===F&&(this.iE=!1);!this.Xua||this.u2||this.iE||(ld.a.instance.Ua(Wa.a.Ye,this.domElement.ownerDocument.body,this.onKeyUp),this.Xua=!1)}M2b(){this.Xua||(ld.a.instance.va(Wa.a.Ye,
this.domElement.ownerDocument.body,this.onKeyUp),this.Xua=!0)}Hef(){ld.a.instance.Ua(Wa.a.nd,this.domElement.ownerDocument.body,this.onKeyDown);this.zNa(void 0)}ehe(F){F=void 0===F?!1:F;this.ju=5;this.qxa(this.Lm,this.sj);this.tVa=this.Jji;this.P6b=this.$Pk;this.Xg||this.cub(this.nZ.clientPoint,this.nZ.sc,this.nm&&this.isRow?66:this.nm&&this.Oe?67:48,F)}Dnk(F){F=void 0===F?!1:F;this.ju=6;let va;this.nm?this.isRow?(this.kw=Bb.slk,va=58):this.Oe?(this.kw=Bb.rlk,va=59):this.kE?(this.kw=[11],va=11):(this.kw=
[12],va=12):(va=this.isRow||this.kE?11:12,this.kw=[va]);this.qxa(this.Hqg,this.Oqg);this.tVa=this.crf;this.P6b=this.dUg;this.Xg||this.cub(this.nZ.clientPoint,this.nZ.sc,va,F)}she(F){F=void 0===F?!1:F;this.ju=6;this.kw=this.kE?[11]:[12];this.qxa(this.VOc,this.WOc);this.tVa=this.crf;this.P6b=this.dUg;this.Xg||this.cub(this.nZ.clientPoint,this.nZ.sc,this.kE?11:12,F)}Z9(F,va){this.i8b(this.isRow?"drag_row_replace":this.Oe?"drag_column_replace":"drag_range_replace",va);this.ehe(F);this.Jwb(F)}j8b(F,va){this.i8b(this.isRow?
"drag_row_insert":this.Oe?"drag_column_insert":"drag_range_insert",va);this.Dnk(F);this.Kwb(F)}jvb(F,va){this.i8b(this.kE?"drag_table_row_rearrange":"drag_table_column_rearrange",va);this.she(F);this.Kwb(F)}PTa(F){this.Ub.rl(this.kw);this.LDa(this.Hqg,this.Oqg,void 0,F);this.y_c()}Yke(){this.Xg&&(this.yFc&&(this.dAd=null),this.vN())}l6f(){return!this.Xb.equals(this.sourceRange)}m6f(){return!this.XXd()}YVd(){return this.u2}H$g(){return this.ha.oa.Ed.equals(this.Xb)?(C.ULS.sendTraceTag(507787463,0,
50,"DragSelectionClickBehaviorCellRangeAndTable: Drag Drop Not Allowed because source range and destination range are the same"),!1):!0}}Object(O.a)(yb,"DragSelectionClickBehaviorCellRangeAndTable",Bb,[]);var Oc=a(438),kd=a(134);class Rc extends Bb{constructor(F,va,lb,sc,Yc,jd){super(F,va,lb,sc,Yc,jd);this.fae=()=>{this.da.FQ&&this.QTa(!0);5===this.ju&&this.jT(!0);this.V3a()};this.WOc=Ad=>{this.zoomManager.Qf(Ad);this.d2?this.c5a(!1):this.da.FQ=!1;this.V3a();this.nm&&(this.O5a(!1),this.SRb());this.Xg&&
this.vN();this.ha.sourceRange=this.sourceRange.clone();if(this.W4f)this.$.Dc(927125067,jc.a.Hb,30,null);else if(this.fda){this.k4();this.ha.sourceRange=this.sourceRange.clone();Ad=this.ha.sourceRange;const Kd=this.ha.oa.Ed;this.Lx?this.$.Dc(-694765314,2,30,{[S.a.Yia]:!0,[S.a.k1]:Ad,[S.a.j1]:Kd,[S.a.lsa]:!1,[S.a.ggb]:this.DUb}):this.$.Dc(-694765314,2,30,{[S.a.Yia]:!0,[S.a.k1]:Ad,[S.a.j1]:Kd,[S.a.lsa]:!1});C.ULS.sendTraceTag(509617280,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerUpRearrange: dragDropCells");
fa.f(this.$).$h.Jt(S.a.I7);this.fda=!1}else this.fgk();this.QTa(!0);this.Lx&&this.NDa();this.ju=-1;return!0};this.VOc=Ad=>{Ad=this.zoomManager.Qf(Ad);const Kd=Ad.clientPoint;this.nZ=Ad;let ye=this.Lx?this.ha.r0(Kd,Ad.sc,5,!0):this.ha.Ft(Kd,Ad.sc,5,void 0,void 0,!0);this.nm&&(this.mU()||this.i8())&&(this.Nub(Kd),this.y7b(Kd));if(ye){if(!this.JYd(ye))return this.B7i(Ad),!0;Ad=this.da.rb.Yh(ye);ye=this.HJd(ye,this.isRow,Kd,Ad);if(this.isRow||this.Oe)this.Xg?this.gfa(this.D0(ye)):this.Xb=this.D0(ye);
this.ha.sourceRange=this.Xb;this.Xg?this.Kwb(!1,Ad===this.da.rb.Yh(this.Xb),this.isRow):(this.Ub.pn(this.Xb,this.kw),this.Ub.Iq(this.kw));this.nm?this.RRb():this.Ub.rl(Bb.sVa);this.Xg||this.I7a()}return!0};this.onKeyDown=Ad=>this.Wkb(Ad)?(this.M2b(),this.fda||(this.fda=!0,fa.f(this.$).$h.Jt(Kb.orc),this.nm&&this.A3c()),!0):!1;this.onKeyUp=Ad=>{this.Wkb(Ad)&&(this.zNa(),this.da.FQ?fa.f(this.$).$h.Jt(Kb.ICd):fa.f(this.$).$h.Jt(S.a.I7),this.nm&&this.A3c());return!0};this.Kpg=Ad=>{Ad.Errors&&0<Ad.Errors.length?
(C.ULS.sendTraceTag(521410185,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsSuccess: Errors: [${Xd.a.pc(Ad.Errors)}]`),this.Xb.left=this.sourceRange.left,this.Xb.right=this.sourceRange.right,this.Xb.top=this.sourceRange.top,this.Xb.bottom=this.sourceRange.bottom):this.isRow?this.sourceRange.top<=this.Xb.top&&this.sourceRange.bottom>=this.Xb.top-1?(this.Xb.top=this.sourceRange.top,this.Xb.bottom=this.sourceRange.bottom):(this.sourceRange.top>this.Xb.top||(this.Xb.top-=this.sourceRange.height),
this.Xb.bottom=this.Xb.top+this.sourceRange.height-1):this.sourceRange.left<=this.Xb.left&&this.sourceRange.right>=this.Xb.left-1?(this.Xb.left=this.sourceRange.left,this.Xb.right=this.sourceRange.right):(this.sourceRange.left>this.Xb.left||(this.Xb.left-=this.sourceRange.width),this.Xb.right=this.Xb.left+this.sourceRange.width-1);this.k4();this.ju=-1};this.Jpg=Ad=>{Ad=Fc.a.te(Ad.data);C.ULS.sendTraceTag(521410184,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsFail: Errors: [${Xd.a.pc(Ad)}]`)};
this.fda=this.Xua=!1}dispose(){super.dispose()}K$d(F){this.nZ=F;this.Xg&&(this.sc=F.sc);this.isRow=this.Oe=!1;this.V2e();this.SM=null!=this.Xb?this.Xb.isRow?1:this.Xb.Oe?2:0:0;this.d2?this.c5a(!0):this.da.FQ=!0;ld.a.instance.va(Wa.a.nd,this.domElement.ownerDocument.body,this.onKeyDown);this.GVd(F)&&(this.M2b(),this.fda=!0,fa.f(this.$).$h.Jt(Kb.orc));this.kc=this.je.Ita(this.sourceRange);this.MZf=this.ovj(this.Xb);this.kc||C.ULS.sendTraceTag(512341332,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerDownInternal: pivotTableRange null for range {0}",
this.sourceRange);this.W4f=(new kd.SheetProtection(this.$.qa)).Ih;this.JYd(this.Xb)?(this.isRow=this.dwj(),this.Oe=this.Snj(),this.isRow||this.Oe?(this.Plb=!1,this.Xg?this.gfa(this.D0(this.Xb)):this.Xb=this.D0(this.Xb),this.jvb(F)):(this.Plb=!0,this.Z9(F))):(this.Plb=!0,this.Z9(F),this.nm&&(this.mU()||this.i8())&&(F=F.clientPoint,this.sTg(F),this.Ucf(F)))}i2a(){this.d2?this.c5a(!1):this.da.FQ=!1;this.V3a();this.nm&&(this.O5a(!1),this.SRb());this.Xg&&this.vN();if(this.W4f)return this.$.Dc(927125067,
jc.a.Hb,30,null),this.Lx&&this.NDa(),this.jT(!0),this.Plb=!1,this.ju=-1,!0;if(this.fda||this.MZf){this.k4();this.ha.sourceRange=this.sourceRange.clone();const F=this.ha.sourceRange,va=this.ha.oa.Ed;this.Lx?this.$.Dc(-694765314,2,30,{[S.a.Yia]:this.fda,[S.a.k1]:F,[S.a.j1]:va,[S.a.lsa]:!1,[S.a.ggb]:this.DUb}):this.$.Dc(-694765314,2,30,{[S.a.Yia]:this.fda,[S.a.k1]:F,[S.a.j1]:va,[S.a.lsa]:!1});C.ULS.sendTraceTag(509617281,0,50,`DragSelectionClickBehaviorPivotTableRange.onPointerUpInternal: dragDropCells with isCopyOperation="${this.fda}"`);
fa.f(this.$).$h.Jt(S.a.I7);this.jT(!0);this.Lx&&this.NDa();this.Plb=!1;this.ju=-1;this.MZf=!1;return!0}return 5===this.ju?(this.jT(!0),this.Plb=!1,this.XUk(),this.ju=-1,!0):!1}L$d(F){const va=F.clientPoint,lb=this.Lx?this.ha.r0(va,F.sc,5,!0):this.ha.Ft(va,F.sc,5,void 0,void 0,!0);this.nZ=F;this.nm&&(this.mU()||this.i8())&&(this.Nub(va),this.y7b(va));return this.Plb?!1:this.JYd(lb)?(this.C7i(F),!0):!1}I7a(){const F=new pc.Range(this.Xb.top,this.Xb.left,this.Xb.bottom,this.Xb.right,!1,!0);6===this.ju&&
(this.isRow?(--F.top,F.bottom=F.top+this.Xb.height-1):(--F.left,F.right=F.left+this.Xb.width-1));if(this.Xg)Bb.QO&&(Bb.QO.childNodes[0].innerText=F.toString(),Bb.QO.childNodes[1].innerText="");else for(let va=1;4>=va;va++){const lb=this.Qt[va.toString()];lb&&lb.childNodes&&0<lb.childNodes.length&&(lb.childNodes[0].innerText=F.toString())}}ise(){if(!fa.f(this.$).ha.oa.vi)return!1;var F=fa.f(this.$).getRangeInformation(this.ha.oa.Ed);for(var va of F)if(Object(Wc.a)(qd.PivotTableRange,va)&&(F=this.je.Ita(va)))return va=
!F.isOlap||!F.Amb(!0),C.ULS.sendTraceTag(512341331,0,50,"DragSelectionClickBehaviorPivotTableRange.shouldShowHandlesOnSelectionChanged: enabling for range {0}",F),F.isActionable&&va;return!1}D0(F){F=F.clone();this.isRow?(F.left=this.sourceRange.left,F.right=this.kc.right,F.bottom=F.top+this.sourceRange.height-1):this.Oe?(F.top=this.sourceRange.top,F.bottom=this.kc.CG?this.kc.CG.bottom:this.kc.bottom,F.right=F.left+this.sourceRange.width-1):C.ULS.sendTraceTag(520176346,0,10,"DragSelectionClickBehaviorPivotTableRange.calculateRearrangeRange: no row/column rearrange");
return this.a2d(F)}fgk(){const F={},va=gc.y(this.sourceRange,this.$);if(this.isRow){va.FirstColumn=F.FirstColumn=this.Xb.left-1;va.LastColumn=F.LastColumn=this.Xb.right-1;if(this.sourceRange.top<=this.Xb.top&&this.sourceRange.bottom>=this.Xb.top-1){C.ULS.sendTraceTag(520176345,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}this.sourceRange.top>this.Xb.top?F.LastRow=F.FirstRow=this.Xb.top-1:(F.FirstRow=this.Xb.top-this.sourceRange.height-1,F.LastRow=F.FirstRow+
this.sourceRange.height-1)}else{F.FirstRow=Math.min(this.Xb.top,this.Xb.bottom-1);F.LastRow=this.Xb.bottom-1;if(this.sourceRange.left<=this.Xb.left&&this.sourceRange.right>=this.Xb.left-1){C.ULS.sendTraceTag(520176344,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}F.LastColumn=this.sourceRange.left>this.Xb.left?F.FirstColumn=this.Xb.left-1:F.FirstColumn=this.Xb.left-this.sourceRange.width-1}const lb={};lb.SheetName=this.$.qa.la?this.$.qa.la.name:this.$.wc.getItemByName(this.$.wc.la.name).sheetName;
lb.Ranges=Array(2);lb.Ranges[0]=va;lb.Ranges[1]=F;this.byi(lb)}byi(F){this.$.userOperationManager.enqueueOperation(new ub.a(265,0,(va,lb,sc)=>{var Yc=this.$.ma.sa;va=this.Kpg?xd.c(va,this.Kpg):va;lb=this.Jpg?xd.b(lb,this.Jpg):lb;const jd=Yc.$a(1,null);jd.moveRange=F;return Ic.h(Yc,"MoveLineItems",jd,va,lb,sc,null,0)},64),null)}JYd(F){return null!==this.kc&&null!==F&&this.Osj(F)&&this.Wvj(F)&&this.fyj(F)&&this.Tmj(F)}Osj(F){return this.kc.CG?F.left>=this.kc.CG.left:this.kc.OD?F.left>=this.kc.OD.left:
F.left>=this.kc.left}Wvj(F){return this.kc.OD?F.right<=this.kc.OD.right:this.kc.CG?F.right<=this.kc.CG.right:F.right<=this.kc.right}fyj(F){return this.isRow?null!==this.kc.CG&&F.top>=this.kc.CG.top:this.Oe?null!==this.kc.OD&&F.top>=this.kc.OD.top:null===this.kc.top||F.top>=this.kc.top}Tmj(F){return this.kc.CG?F.bottom<=this.kc.CG.bottom:this.kc.OD?F.bottom<=this.kc.OD.bottom:F.bottom<=this.kc.bottom}ovj(F){return null!==this.kc&&this.kc.left>=F.left&&this.kc.right<=F.right&&this.kc.top>=F.top&&this.kc.bottom<=
F.bottom}dwj(){return null!==this.kc&&null!==this.kc.CG&&this.kc.CG.top<=this.Xb.top&&this.kc.CG.left<=this.Xb.left&&this.kc.CG.right>=this.Xb.left}Snj(){return null!==this.kc&&null!==this.kc.OD&&this.kc.OD.top===this.Xb.top&&this.kc.OD.left<=this.Xb.left&&this.kc.OD.right>=this.Xb.right}she(F){this.ju=6;this.kw=this.isRow?[11]:[12];this.qxa(this.VOc,this.WOc);this.Xg||this.cub(F.clientPoint,F.sc,this.isRow?11:12,!1)}ehe(F){this.ju=5;this.qxa(this.Lm,this.sj);this.Xg||this.cub(F.clientPoint,F.sc,
this.nm&&this.mU()?66:this.nm&&this.i8()?67:48,!1)}jvb(F){this.i8b(this.isRow?"drag_pivot_row_rearrange":"drag_pivot_column_rearrange",F.Ha.rawEvent);this.she(F);this.Kwb()}Z9(F){this.i8b("drag_pivot_replace",F.Ha.rawEvent);this.ehe(F);this.Jwb()}C7i(F){this.jT(!1);this.Xg?this.gfa(this.D0(this.Xb)):this.Xb=this.D0(this.Xb);this.jvb(F)}B7i(F){this.QTa(!1);this.Z9(F)}XUk(){if((null==this.sourceRange||null==this.Xb||this.sourceRange.Gz(!1)!==this.Xb.Gz(!1))&&!this.gTb(this.Xb)){var F=Xd.a.Cd(1,0,904,
903,0,2069074184,"PivotTableInvalidMove");F.HelpTopicId=Oc.a.DZk;F.HelpDescription=Ha.a.instance.ia(913);Hd.a(this.$).Zx([F])}}zNa(){this.fda=!1;this.Xua&&(ld.a.instance.Ua(Wa.a.Ye,this.domElement.ownerDocument.body,this.onKeyUp),this.Xua=!1)}M2b(){this.Xua||(ld.a.instance.va(Wa.a.Ye,this.domElement.ownerDocument.body,this.onKeyUp),this.Xua=!0)}l6f(){return!this.Xb.equals(this.sourceRange)}m6f(){return!1}YVd(){return this.fda}Hef(){ld.a.instance.Ua(Wa.a.nd,this.domElement.ownerDocument.body,this.onKeyDown);
this.zNa()}}Object(O.a)(Rc,"DragSelectionClickBehaviorPivotTableRange",Bb,[]);var Xb=a(433);class dc extends Tc{constructor(F,va){super(F);this.ph=()=>{this.domElement.classList.remove(ed.selecting);Xb.c(this.da.$,!0,"FillHandleClickBehavior:OnSelectionEnded")};this.Hw=()=>{this.domElement.classList.add(ed.selecting)};this.onPointerDown=lb=>{2===lb.Yb&&lb.Dq===Sys.UI.MouseButton.leftButton&&(this.da.ha.selectionType=4,this.da.ha.sourceRange=this.da.ha.oa.Ed,Xb.c(this.da.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));
return!1};this.bKa=()=>{this.da.$.Dc(1983983164,2,30,null);return!0};this.de=()=>{ea.DOMElementExtensions.setVisible(this.kja,this.da.$.isEditMode)};this.r0b=()=>{ea.DOMElementExtensions.setVisible(this.kja,!1)};this.q0b=()=>{ea.DOMElementExtensions.setVisible(this.kja,!0)};this.Dng=()=>{ea.DOMElementExtensions.setVisible(this.kja,!1)};this.Cng=()=>{ea.DOMElementExtensions.setVisible(this.kja,!0)};this.h_b=(lb,sc)=>{ea.DOMElementExtensions.setVisible(this.kja,!sc.Tmd)};this.da=va;va=document.createElement("div");
va.className=oa.EwaSettings.OQ()?Pc.a.uwi:Pc.a.twi;this.kja=va;this.de(null,null);F.appendChild(va);wb.a.instance.va(Wa.a.Sd,this.kja,this.onPointerDown);Ud.a.instance.va(Wa.a.Gn,this.kja,this.bKa);this.da.$.Ul(this.de);this.da.$.Mb.j5e(this.r0b);this.da.$.Mb.i5e(this.q0b);this.da.X3e(this.h_b);this.da.cellTextEditBox.Jp(this.Dng);this.da.cellTextEditBox.Uq(this.Cng)}dispose(){wb.a.instance.Ua(Wa.a.Sd,this.kja,this.onPointerDown);Ud.a.instance.Ua(Wa.a.Gn,this.kja,this.bKa);this.da.$&&(this.da.ha.tma(this.Hw),
this.da.ha.z9(this.ph),this.da.$.tm(this.de),this.da.$.Mb.WHg(this.r0b),this.da.$.Mb.VHg(this.q0b),this.da.TGg(this.h_b),this.da.cellTextEditBox.zp(this.Dng),this.da.cellTextEditBox.gq(this.Cng));super.dispose()}}Object(O.a)(dc,"FillHandleClickBehavior",Tc,[]);class Vc{constructor(F){this.RUf=va=>{this.M2c(va.sc,1);return!0};this.SUf=va=>{this.M2c(va.sc,-1);return!0};this.ph=()=>{this.lXd=!1};this.Hw=()=>{this.lXd=!0};this.da=F;this.akb=0;this.lXd=this.DGc=!1;this.Cda=Number.NaN;this.da.ha.vqa(this.Hw);
this.da.ha.Qaa(this.ph);this.da.ha.X4e(this.ph)}dispose(){this.da.ha.tma(this.Hw);this.da.ha.z9(this.ph);this.da.ha.GHg(this.ph)}wV(){this.akb=0;this.DGc=!1;this.Cda=Number.NaN}erf(F){this.DGc=!0;this.M2c(F,1)}frf(F){this.DGc=!1;this.M2c(F,-1)}M2c(F,va){if(F)if(F.parentNode)if(this.lXd)isNaN(this.Cda)||(this.f3c(this.Cda,!1),this.Cda=Number.NaN);else if(F=parseInt(F.parentNode.getAttribute(S.a.ASb),10),isNaN(F))C.ULS.shipAssertTag(537159366,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");
else{if(!isNaN(this.Cda)&&F!==this.Cda){if(this.DGc)return;this.f3c(this.Cda,!1)}if(isNaN(this.Cda)||F!==this.Cda)this.Cda=F,this.akb=0;!this.akb&&0<va&&this.f3c(F,!0);this.akb=Math.max(this.akb+va,0);!this.akb&&0>va&&(this.f3c(F,!1),this.Cda=Number.NaN)}else C.ULS.shipAssertTag(537159367,0,!!F.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");else C.ULS.shipAssertTag(537159368,0,!!F,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")}f3c(F,va){var lb=this.da.rb.lac;
for(const sc of lb)for(lb=this.da.Ub.sQ(3,sc,F).Gf,ea.DOMElementExtensions.toggleCssClass(lb,ed.Xvi,va),lb=lb.firstChild;lb;lb=lb.nextSibling)Oa.a.contains(lb.className,"resizemarqueehandle",!0)&&ea.DOMElementExtensions.toggleCssClass(lb,ed.cwi,va)}}Object(O.a)(Vc,"MarqueeHoveringManager",null,[]);var yd=a(332),Pd=a(154),re=a(1085),ue=a(1444),He=a(397);class bf extends uc{constructor(F,va){super(F);this.wCc=!1;this.UOc=()=>{if(!this.vw)return C.ULS.shipAssertTag(537159364,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),
!1;this.vw.wjk(this.Vja);this.vw.Hmi(this.Wja);if(3===this.vw.model.state)return!0;this.vw.rSd(!0);return!0};this.Ela=()=>{if(!this.vw)return!1;this.vw.wBg(!1);this.vw.Rke(this.Wja,!1);if(3===this.vw.model.state)return!0;this.vw.rSd(!1);return!0};this.onPointerDown=lb=>this.vw?2===lb.Yb&&lb.Dq===Sys.UI.MouseButton.leftButton?!0:!1:!1;this.H_b=()=>{if(!this.vw)return!1;this.vw.Rke(this.Wja,!0);this.vw.rSd(!1);this.vw.Xfb();return!0};this.onDoubleClick=lb=>{if(lb.Ha)return lb.Ha.stopPropagation(),!0;
C.ULS.sendTraceTag(537159363,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");return!0};this.container=F;this.vw=Object(Pd.a)(ue.a,va.metadata);this.fVg(va)&&this.qXf(va.isVisible)}dispose(){this.FFg();this.vw=null;super.dispose()}hcb(F){this.vw=Object(Pd.a)(ue.a,F.metadata);this.fVg(F)?this.qXf(F.isVisible):this.FFg();!oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7800556_DisableRangeHighlightAdjustBehaivor")&&F.isVisible!==F.Uka&&this.vw&&(this.vw.CNk(F.isVisible?
1:0),ea.DOMElementExtensions.setVisible(this.Wja,F.isVisible))}qXf(F){this.wCc||(this.wCc=!0,this.Wja=document.createElement("div"),this.Wja.id=`${this.container.id}-${S.a.bdf}`,this.Wja.className=re.a.XVh,this.Vja=document.createElement("div"),this.Vja.id=`${this.container.id}-${S.a.uud}`,this.Vja.className=re.a.uud,this.rY=document.createElement("div"),this.rY.appendChild(this.Vja),this.rY.className=re.a.WVh,this.Wja.appendChild(this.rY),this.container.appendChild(this.Wja),C.ULS.sendTraceTag(537159365,
0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created."),wb.a.instance.va(Wa.a.B3,this.rY,this.UOc),wb.a.instance.va(Wa.a.sG,this.rY,this.Ela),wb.a.instance.va(Wa.a.Sd,this.rY,this.onPointerDown),yd.a.instance.va(Wa.a.click,this.rY,this.H_b),yd.a.instance.va(Wa.a.Gn,this.rY,this.onDoubleClick),ea.DOMElementExtensions.setVisible(this.rY,F))}FFg(){this.wCc&&(this.wCc=!1,wb.a.instance.Ua(Wa.a.B3,this.rY,this.UOc),wb.a.instance.Ua(Wa.a.sG,
this.rY,this.Ela),wb.a.instance.Ua(Wa.a.Sd,this.rY,this.onPointerDown),yd.a.instance.Ua(Wa.a.click,this.rY,this.H_b),yd.a.instance.Ua(Wa.a.Gn,this.rY,this.onDoubleClick),ea.DOMElementExtensions.vh(this.Vja),this.Vja=null,ea.DOMElementExtensions.vh(this.Wja),this.Wja=null)}fVg(F){F=new He.a(F.range,F.sheetId);return!!this.vw&&this.vw.JEc(F)}}Object(O.a)(bf,"RangeCatchUpActivityHighlightBehavior",uc,[]);class af extends se{constructor(F,va,lb,sc,Yc){super(F,va,lb,sc,Yc)}get P7(){return 16}get stb(){return this.da.ha.rangePicker.BJd(!1)}G5a(){return(this.da.inRangePicker||
this.da.nk)&&super.G5a()}}Object(O.a)(af,"RangePickerTouchGrippiesBehavior",se,[]);class Pe extends uc{constructor(F,va,lb){super(F);const sc=document.createElement("div"),Yc=document.createElement("div");oa.EwaSettings.nm()?lb?(sc.className=va?ed.Dwi:ed.Fwi,Yc.className=va?ed.Ewi:ed.Cwi):(sc.className=va?ed.zwi:ed.Bwi,Yc.className=va?ed.Awi:ed.ywi):(sc.className=va?ed.Kwi:ed.Mwi,Yc.className=va?ed.Lwi:ed.Jwi);F.appendChild(sc);F.appendChild(Yc)}}Object(O.a)(Pe,"RearrangeHighlightBehavior",uc,[]);
var wf;(function(F){F[F.topLeft=0]="topLeft";F[F.topRight=1]="topRight";F[F.bottomLeft=2]="bottomLeft";F[F.bottomRight=3]="bottomRight";F[F.error=4]="error"})(wf||(wf={}));Object(O.b)("Corner",wf);class xf extends uc{constructor(F,va,lb,sc,Yc,jd){super(F);this.qd=this.KR=null;this.Kba=0;this.Xb=this.sourceRange=null;this.t6a=!1;this.onPointerDown=Ad=>{Ad=this.zoomManager.Qf(Ad);if(this.HUg(Ad)&&!this.t6a){this.fbg();this.qd=this.Qr.zJd();this.KR=this.Qr.tNf(Ad);if(!this.qd||!this.KR||!this.KR.range)return C.ULS.shipAssertTag(537159361,
0,!!this.qd,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),C.ULS.shipAssertTag(537159360,0,!!this.KR,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),C.ULS.shipAssertTag(537159331,0,!!this.KR.range,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;this.Xb=this.KR.range.clone();this.sourceRange=this.Xb.clone();this.Kba=this.HIf(Ad);if(4===this.Kba)return C.ULS.shipAssertTag(537159330,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),
!1;const Kd=this.aLf(Ad,!0);if(!Kd)return C.ULS.shipAssertTag(537159329,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;if(!this.Ukf(Kd))return C.ULS.shipAssertTag(537159328,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;this.da.JYa=!0;this.qd.VJ(!1);this.$K.erf(Ad.sc);this.Qr.MBg(!0,this.wN.mia);this.qd.Za.removeSelection();this.qd.vlc(this.zRf);this.TEg();this.t6a=!0;pd.b(this.$,!0)}return!0};this.Lm=
Ad=>{Ad=this.zoomManager.Qf(Ad);Ad=this.aLf(Ad,!1);if(!Ad)return!0;Ad=this.Ukf(Ad);if(!Ad)return C.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),this.uxc(!0),!1;if(this.Xb.equals(Ad))return!0;this.Xb=Ad;Ad=this.Jwb();Ad||(C.ULS.shipAssertTag(537159326,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.uxc(!0));return Ad};this.sj=Ad=>{this.zoomManager.Qf(Ad);Ad=this.k4();C.ULS.shipAssertTag(537159325,0,Ad,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");
this.uxc(!Ad);return Ad};this.zRf=()=>{this.uxc(!0)};this.da=va;this.zoom=jd;this.$=va.$;this.ER=[];this.ha=this.da.ha;this.$K=lb;this.Qr=sc;this.wN=Yc;va=Ka.a.Cb(Ba.FormulaAssistanceManagerService);C.ULS.shipAssertTag(510255176,0,!!va,"ResizeMarqueeBehaviorBase Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen.");this.WA=va.WA;for(const Ad of this.AKg())va=this.Qr.Yjf(F,Ad,this.w5e(),this.onPointerDown),this.ER.push(va);for(const Ad of this.ER)wb.a.instance.va(Wa.a.B3,
Ad,this.$K.RUf),wb.a.instance.va(Wa.a.sG,Ad,this.$K.SUf);this.hcb(Yc)}dispose(){this.ER.forEach(F=>{wb.a.instance.Ua(Wa.a.Sd,F,this.onPointerDown)});this.ER.length=0;super.dispose()}get zoomManager(){return this.zoom.zoomManager}hcb(F){this.wN=F;this.F5e(F);this.Qr.u6b(F,this.ER,this.hse());this.$K.wV()}aLf(F,va){const lb=F.sc;F=F.clientPoint;if(!lb||!F)return C.ULS.shipAssertTag(537159324,0,!!lb,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),C.ULS.shipAssertTag(537159323,0,!!F,
"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),null;va&&(F=this.Sfg(F));va=this.ha.Ft(F,lb,0,!0,!1,!0);va||(F=this.Sfg(F),va=this.ha.Ft(F,lb,0,!0,!1,!0));return va}Sfg(F){F.y+=0===this.Kba||1===this.Kba?2:-2;F.x+=0===this.Kba||2===this.Kba?2:-2;return F}Ukf(F){if(!F||!this.sourceRange)return C.ULS.shipAssertTag(537159322,0,!!F,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),C.ULS.shipAssertTag(537159321,0,!!this.sourceRange,"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),
null;if(0===this.Kba)return new pc.Range(F.top,F.left,this.sourceRange.bottom,this.sourceRange.right,!0,!1);if(1===this.Kba)return new pc.Range(F.top,this.sourceRange.left,this.sourceRange.bottom,F.right,!0,!1);if(2===this.Kba)return new pc.Range(this.sourceRange.top,F.left,F.bottom,this.sourceRange.right,!0,!1);if(3===this.Kba)return new pc.Range(this.sourceRange.top,this.sourceRange.left,F.bottom,F.right,!0,!1);C.ULS.shipAssertTag(537159320,0,!1,`ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: ${wf[this.Kba]}`);
return null}k4(){return this.WA.Rfg(this.qd,this.KR,this.Xb)}Jwb(){return this.k4()}uxc(F){F&&C.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate formula highlights as a fallback.");this.$K.frf(this.ER[0]);this.Qr.MBg(!1,this.wN.mia);this.qd.Za.setCaretPositionToEnd();this.qd.dUc(this.zRf);this.r6g();this.t6a=this.da.JYa=!1;pd.b(this.$,!1);this.Qr.yDg()}}Object(O.a)(xf,"ResizeMarqueeBehaviorBase",uc,[]);class Cf extends xf{constructor(F,
va,lb,sc,Yc,jd){super(F,va,lb,sc,Yc,jd)}AKg(){return[ed.Qwi,ed.Rwi,ed.Owi,ed.Pwi]}w5e(){return[ed.Nwi]}HIf(F){F=F.sc;if(F===this.ER[0])return 0;if(F===this.ER[1])return 1;if(F===this.ER[2])return 2;if(F===this.ER[3])return 3;C.ULS.shipAssertTag(537159318,0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}TEg(){this.Qr.qxa(this.Lm,this.sj,!0)}r6g(){this.Qr.m6g(this.Lm,this.sj,!0)}HUg(F){return 2===(jc.a.Hb=F.Yb)&&F.Dq===Sys.UI.MouseButton.leftButton}hse(){return!0}fbg(){C.ULS.sendTraceTag(537159317,
0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")}F5e(F){for(const va of this.ER)va.style.backgroundColor=F.Gf.style.borderColor}}Object(O.a)(Cf,"ResizeMarqueeMouseBehavior",xf,[]);class tf extends xf{constructor(F,va,lb,sc,Yc,jd){super(F,va,lb,sc,Yc,jd);this.A_b=()=>{const Ad=3===jc.a.Hb;this.Q0d&&!Ad?this.Qr.u6b(this.wN,this.ER,!1):!this.Q0d&&Ad&&this.Qr.u6b(this.wN,this.ER,!0);this.Q0d=Ad};this.$3j=(Ad,Kd)=>{Kd.ASb===this.wN.mia&&this.Qr.u6b(this.wN,
this.ER,!Kd.start&&this.hse())};jc.a.y4e(this.A_b);this.Q0d=3===jc.a.Hb;this.Qr.QEh(this.$3j)}dispose(){jc.a.qHg(this.A_b);super.dispose()}AKg(){return[Pc.a.Ovi,Pc.a.Nvi]}w5e(){return[Pc.a.yyf,Pc.a.gwc,Pc.a.fwc]}HIf(F){F=F.sc;if(F===this.ER[0])return 0;if(F===this.ER[1])return 3;C.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}TEg(){this.Qr.Xnk(this.Lm,this.sj)}r6g(){this.Qr.sal(this.Lm,this.sj)}HUg(F){return 3===(jc.a.Hb=
F.Yb)}hse(){return 3===jc.a.Hb}fbg(){C.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")}F5e(){}}Object(O.a)(tf,"ResizeMarqueeTouchBehavior",xf,[]);class Jf extends uc{constructor(F,va){super(F);Jf.fKb(F,Hc.a.Ryf+" "+Pc.a.xFa,null===va||void 0===va?void 0:va.horizontal);Jf.fKb(F,Hc.a.Qyf+" "+Pc.a.xFa,null===va||void 0===va?void 0:va.vertical);Jf.fKb(F,Hc.a.Oyf+" "+Pc.a.xFa,null===va||void 0===va?void 0:va.horizontal);Jf.fKb(F,
Hc.a.Pyf+" "+Pc.a.xFa,null===va||void 0===va?void 0:va.vertical);Jf.fKb(F,Pc.a.dwi)}static fKb(F,va,lb){const sc=document.createElement("div");sc.className=va;lb&&(sc.style.backgroundImage=`url("${lb}")`);F.appendChild(sc)}}Object(O.a)(Jf,"SelectionCutCopyBehavior",uc,[]);class dg extends uc{constructor(F){super(F);appChrome.renderSpinner(F)}}Object(O.a)(dg,"SelectionPasteBehavior",uc,[]);class uf extends uc{constructor(F,va){super(F);uf.wKb(F,Hc.a.$yf+" "+Pc.a.xFa,null===va||void 0===va?void 0:va.horizontal);
uf.wKb(F,Hc.a.Zyf+" "+Pc.a.xFa,null===va||void 0===va?void 0:va.vertical);uf.wKb(F,Hc.a.Xyf+" "+Pc.a.xFa,null===va||void 0===va?void 0:va.horizontal);uf.wKb(F,Hc.a.Yyf+" "+Pc.a.xFa,null===va||void 0===va?void 0:va.vertical);uf.wKb(F,Pc.a.wwi)}static wKb(F,va,lb){const sc=document.createElement("div");sc.className=va;lb&&(sc.style.backgroundImage=`url("${lb}")`);F.appendChild(sc)}}Object(O.a)(uf,"SelectionRangePickerBehavior",uc,[]);class lf extends se{constructor(F,va,lb,sc,Yc){super(F,va,lb,sc,Yc)}get P7(){return 0}get stb(){return this.da.ha.oa.Ed}G5a(){const F=
this.da.nk||this.da.isEditing;return this.da.ha.oa.vi&&!F&&super.G5a()}}Object(O.a)(lf,"SelectionTouchGrippiesBehavior",se,[]);var Pf=a(64);let Rf=class extends La.a{constructor(F,va,lb,sc){super();this.VGb=(Yc,jd)=>{Yc=jd.P7;const Ad=this.da;jd=jd.Ncj;const Kd=jd.Gf,ye=jd.p6;switch(Yc){case 24:jd.p6.push(new bf(Kd,jd));break;case 0:jd.p6.push(new dc(Kd,Ad));wa.a.ot||(ye.push(new yb(Kd,this.da.$,jd.paneType,this.je,this.Qr,this.zoom,this.sdj)),ye.push(new Rc(Kd,this.da.$,jd.paneType,this.je,this.Qr,
this.zoom)));ye.push(new lf(jd,Kd,Ad,jd.paneType,this.zoom));break;case 3:ye.push(new Tc(Kd));wa.a.ot||(ye.push(new rb(Kd,this.da.$,jd.paneType,this.$K,this.Qr,jd,this.zoom)),ye.push(new Cf(Kd,this.da,this.$K,this.Qr,jd,this.zoom)),ye.push(new tf(Kd,this.da,this.$K,this.Qr,jd,this.zoom)));break;case 4:case 5:case 65:ye.push(new Jf(Kd,this.b7e));break;case 30:ye.push(new dg(Kd));break;case 16:ye.push(new uf(Kd,this.b7e));ye.push(new af(jd,Kd,Ad,jd.paneType,this.zoom));break;case 11:case 12:case 58:case 59:case 60:case 61:ye.push(new Pe(Kd,
11===Yc||58===Yc||60===Yc,58===Yc||59===Yc||60===Yc||61===Yc));break;case 17:ye.push(new Tc(Kd));break;case 19:ye.push(new Tc(Kd)),ye.push(new Fe(jd,Kd,Ad,jd.paneType,this.zoom))}jd.iHb=!0};this.$=F;this.zoom=lb;this.da=fa.f(F);this.sdj=sc;this.je=va;this.$K=new Vc(this.da);this.Qr=new Qa(this.da);this.da.Ub&&(this.da.Ub.iEh(this.VGb),this.da.Ub.update(!1))}get b7e(){oa.EwaSettings.isChangeGateEnabled("OfficeVSO:6809974_DancingAnts1Cdn")&&!this.a7e&&(this.a7e={vertical:Pf.a.current.Lo(105),horizontal:Pf.a.current.Lo(106)});
return this.a7e}dispose(){this.da.Ub.ctk(this.VGb);this.$K&&(this.$K.dispose(),this.$K=null);super.dispose()}};Rf=Object(U.__decorate)([Object(Ka.d)(Ba.GridHighlightsBehaviorManagerService),Object(U.__param)(0,Object(Ba.EwaControlService)()),Object(U.__param)(1,Object(Ba.TableManagerService)()),Object(U.__param)(2,Object(Ba.ZoomService)()),Object(U.__param)(3,Object(Ba.HtmlSanitizationHelperService)())],Rf);Object(O.a)(Rf,"GridHighlightsBehaviorManager",La.a,[]);var Mf=a(182),zf=a(29),df=a(19),Bf=
a(257),Kf=a(1364),Vf=a(292),sb=a(1016),Gc=a(190),ad=a(24);class Wd extends Kf.a{constructor(F,va,lb){super(F,va,lb);this.bhc=this.qCa=null}get YV(){return hb.AFrameworkApplication.ua.KE}pIf(F){switch(F){case 1:return Object(ad.a)("ImageUploadNoFileSpecified");case 2:return Object(ad.a)("ImageUploadUnsupportedFileType");default:return""}}r$g(F){return Wd.Sna(F,this.C4i())}C4i(){return Wd.V_e}Sna(F,va){va=void 0===va?null:va;F=this.r$g(F);return 0!==F?(va&&va.o2e(),2===F&&(va=this.pIf(F),this.Wi(0,
va)),!1):!0}finalizeUpload(F,va){C.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");this.Bae=va;this.UVk();Vf.a.mark(5576);this.bhc=this.YV.Uc("LoadResource","PictureUploadTime")}Wi(F,va){const lb=new Gc.a;lb.hc=0;lb.JG(F,Object(ad.a)("ImageUploadFailedTitle"),va,null)}m0b(){C.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");super.m0b();this.bhc&&(this.bhc.stop(),this.bhc=null);this.$Zh()}UVk(){this.qCa=(new sb.a).create();this.qCa.message=Object(ad.a)("ImageUploadWait");
this.qCa.hc=5;this.qCa.ov=!1;this.qCa.MMa(null,null,null)}$Zh(){this.qCa&&(this.qCa.close(),this.qCa=null)}static hbj(F,va){F=la.a.wm(F);for(let lb=0;lb<va.length;++lb)if(F.endsWith(va[lb]))return!0;return!1}static Sna(F,va){va=void 0===va?null:va;va||(va=Wd.V_e);return F?Wd.hbj(F,va)?0:2:1}}Wd.V_e=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(O.a)(Wd,"PictureUploader",Kf.a,[]);var je=a(103),Ie=a(666),Je=a(429),$e=a(368),Ib=a(255),Nb=a(238),Bc=a(128),Af=a(245),gf;(function(F){F[F.unknown=
0]="unknown";F[F.bing=1]="bing";F[F.M365=2]="M365"})(gf||(gf={}));Object(O.b)("InsertMediaProviders",gf);var Qe=a(92),Aa=a(369),Fb=a(1099),Ta=a(78);class Eb extends Fb.a{constructor(F,va){super(F,Ta.a.getOrigin(va))}N2b(F,va){this.isEnabled()&&this.pH(this.targetOrigin)&&(this.nl(F),this.ik(F,va))}}Object(O.a)(Eb,"InsertMediaCrossDocumentMessenger",Fb.a,[844,201,4]);var oc=a(2);class Lc{}Object(O.a)(Lc,"OnlineMediaSearchResult",null,[]);var Jd=a(434),Ab;(function(F){F[F.OK=0]="OK";F[F.cancel=1]="cancel";
F[F.error=2]="error";F[F.open=3]="open"})(Ab||(Ab={}));Object(O.b)("HubbleAction",Ab);class Uc extends Nb.a{constructor(F,va,lb,sc,Yc,jd){super();this.HGc=!1;this.W1d=this.Bt=this.HHa=null;this.Y3f=!1;this.correlationId=null;this.bUj=()=>{this.yFa(this.pdb);this.Etb(1)};this.q0d=Ad=>{Ad.keyCode===Sys.UI.Key.tab&&("KeepFocusDiv"!==Ad.target.id||Ad.shiftKey?"KeepFocusStartDiv"===Ad.target.id&&Ad.shiftKey&&(Ad.preventDefault(),document.getElementById("KeepFocusDiv").focus()):(Ad.preventDefault(),document.getElementById("KeepFocusStartDiv").focus()))};
this.Z0j=()=>{this.sGb&&(this.sGb.launchUpsellExperience("stockimages"),C.ULS.sendTraceTag(537155807,0,50,"OnLaunchM365Upsell: Launched Dime Upsell flow"))};this.C2j=Ad=>{Ad&&Ad.Values&&(Ad=Ad.Values,delete Ad.m_Origin,delete Ad.m_Source,delete Ad.m_ReceivedTime,C.ULS.sendTraceTag(508953229,0,50,"Received OTel event: "+Ad.eventName||!1),Na.a.sendOtelEvent({otelEvent:Ad}))};this.dialogTitle=jd;this.$=F;this.vXf=va;this.sGb=lb;this.afa=[];this.iob=sc;this.Cgi=Yc;this.r6e=this.$.ta.InsertOnlinePictureMaxCountOfImagesToInsert;
this.wj=this.x8h();this.Y3f=oa.EwaSettings.isChangeGateEnabled("OfficeVSO:8665911_RemoveMediaDetailsInTelemetry")}IVk(F){this.HGc=!1;this.showDialog(this.dialogTitle,null);this.HHa=document.getElementById(this.qj("InsertMediaFrame"));if(!this.HHa)throw this.yFa(this.pdb),Error.invalidOperation("Couldn't get InsertMediaIframe.");const va=document.getElementById(this.qj("WACDialogPanel"));va&&va.setAttribute(eb.a.Ae,eb.a.OSa);var lb=document.createElement("div");lb.id="KeepFocusStartDiv";lb.tabIndex=
0;lb.className="keep-focus-start";this.HHa.parentNode.insertBefore(lb,this.HHa.parentNode.firstChild);lb=document.createElement("div");lb.id="KeepFocusDiv";lb.tabIndex=0;lb.className="keep-focus";this.correlationId=Tb.a.create();this.HHa.parentNode.appendChild(lb);$addHandler(this.Pfb,"keydown",this.q0d);this.HHa.src=this.vXf;this.HHa.frameBorder="0";lb=document.getElementById(this.qj("WACDialogButtonPanel"));if(!lb)throw Error.invalidOperation("Couldn't get WACDialogButtonPanel.");lb.className="display-none";
lb=document.getElementById(this.qj("WACDialogTitleText"));if(!lb)throw Error.invalidOperation("Couldn't get WACDialogTitleText.");lb.className="display-none";2===this.iob&&(document.getElementById(this.qj("WACDialogTitlePanel")).className="display-none",document.getElementById(this.qj("WACDialogBodyPanel")).className="padding-zero");oa.EwaSettings.isChangeGateEnabled("OfficeVSO:8728224_StockImagesDialogHeightFix")&&va&&(va.style.overflow="hidden",va.style.height="auto",lb=document.getElementById(this.qj("WACDialogOuterContainer")))&&
(va.style.marginTop="",va.style.top=(lb.parentElement.clientHeight-va.clientHeight)/2+"px");Bc.FocusManager.instance().fY().scope.JY=!0;this.Bt=new Eb(this.HHa.contentWindow,this.vXf);this.Bt.pH("https://osiziwuspersimmon002.blob.core.windows.net");this.Bt.pH("https://osizewuspersimmon001.blob.core.windows.net");this.Bt.pH("https://osizpscuspersimmon000.blob.core.windows.net");this.Bt.pH("https://res-dev.cdn.officeppe.net");this.Bt.pH("https://res-sdf.cdn.office.net");this.Bt.pH("https://cdn.hubblecontent.msit.osi.office.net");
this.Bt.pH("https://cdn.hubblecontent.osi.office.net");this.Bt.pH("https://hubblecontent.azureedge.eaglex.ic.gov");this.Bt.pH("https://hubblecontent.azureedge.microsoft.scloud");this.Bt.N2b(Ga.a.Wzh,sc=>{this.KSj(sc,F.Wfa)});this.Bt.N2b(Ga.a.insert,()=>{this.u0j(F.Wfa)});this.Bt.N2b(Ga.a.Wtd,this.bUj);this.Bt.N2b(Ga.a.FAh,sc=>{this.C2j(sc)});2===this.iob&&0===this.Cgi&&(this.Bt.N2b(Ga.a.uBj,this.Z0j),this.W1d=this.sGb.oLa("MsoPremiumStockImages",sc=>{C.ULS.sendTraceTag(537155811,0,50,"OnCompleteM365Upsell: Upsell completed from stock images");
sc.isEnabled?this.Bt.sendMessage(Ga.a.ngl,{["LicenseTier"]:sc.toString()}):C.ULS.sendTraceTag(537155810,0,10,"OnCompleteM365Upsell: Upsell completed but license tier didn't upgrade.")}));this.Etb(3)}dispose(){this.afa=null;this.sGb&&this.W1d&&this.sGb.ATc("MsoPremiumStockImages",this.W1d);this.Bt&&(this.Bt.dispose(),this.Bt=null);super.dispose()}hide(){super.hide();Qe.a.CXc(this.$)}get wca(){return Af.a.ytc+"/InsertMediaDialog"}get nba(){return!1}KSj(F,va){F=F&&F.Values?(F=F.Values)?Object(oc.a)(new Lc,
{Action:F.action||"",Caption:F.caption||"",ContentType:F.contentType||"",FileExtension:F.extension||"",PageUrl:F.pageUrl||"",SourceUrl:F.sourceUrl||"",ThumbnailUrl:F.thumbnailUrl||"",LicenseUrl:F.licenseUrl||"",LicenseDisplayName:F.licenseDisplayName||"",Height:F.height||0,Width:F.width||0}):null:null;F&&(this.afa.push(F),this.HGc&&(C.ULS.sendTraceTag(537155809,0,50,"InsertMediaDialog.OnAddItem: Insert Message handling was pending"),va(this.afa),this.HGc=!1,this.yFa(this.pdb)))}u0j(F){this.afa&&0<
this.afa.length?this.afa.length<=this.r6e?(F(this.afa),this.Etb(0),this.yFa(this.pdb)):(this.JG(),C.ULS.sendTraceTag(537155808,0,10,"OnInsert : Tried to insert more than allowed limit of items."),this.afa.length=0,this.Etb(2)):this.HGc=!0}x8h(){const F=document.createElement("div");F.id="InsertMediaDialog";F.className=oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixHorizonalScroll",!0)?"insert-media-dialog":"insert-media-dialog-old";const va=document.createElement("div");
va.id="InsertMediaPanel";va.className=oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixCancelButton",!0)?"insert-media-panel":"insert-media-panel-old";const lb=document.createElement("iframe");lb.id="InsertMediaFrame";lb.className="insert-media-frame";F.appendChild(va);va.appendChild(lb);return Jd.b(F)}JG(){const F=Xd.a.Cd(1,0,0,0,0,466721363,"InsertPictureExceededAllowedCount");F.Description=String.format(Ha.a.instance.Ib(206),this.r6e.toLocaleString());
new Aa.a(this.$,F)}bVi(){return 2===this.iob?"M365":"bing"}Etb(F){var va,lb;if(2===this.iob||1===this.iob){const Yc=hb.AFrameworkApplication.ea.Qa("InsertMediaDialogAriaTenantNameSpace");if(Yc&&""!==Yc){var sc=[{name:"DialogMode",string:this.bVi()},{name:"Provider",string:gf[this.iob]},{name:"InsertedFiles",int64:null===(va=this.afa)||void 0===va?void 0:va.length},{name:"DialogResult",string:Ab[F]},{name:"CorrelationId",string:null===(lb=this.correlationId)||void 0===lb?void 0:lb.toString()}];this.Y3f||
sc.push({name:"MediaDetails",string:this.afa?JSON.stringify(this.afa.map(jd=>jd.SourceUrl)):null});Na.a.sendTelemetryEvent({name:String.format("{0}.{1}",Yc,"InsertOnlineImages"),dataFields:sc})}}}}Object(O.a)(Uc,"InsertMediaDialog",Nb.a,[]);var Od=a(441),le=a(341),ge=a(366);class ze extends Wd{constructor(F,va,lb,sc,Yc,jd){super(null,lb,sc);this.Pbg=0;this.Wfa=Ad=>{if(Ad){var Kd=Array(Ad.length);for(var ye=0;ye<Ad.length;ye++){const sf=Ad[ye];Kd[ye]={};Kd[ye].SourceUrl=sf.SourceUrl;la.a.nda(sf.LicenseUrl)&&
la.a.nda(sf.PageUrl)&&(Kd[ye].LicenseUrl=sf.LicenseUrl,Kd[ye].LicenseDisplayName=sf.LicenseDisplayName,Kd[ye].PageUrl=sf.PageUrl);Kd[ye].AltText=-2053056795===this.fc.command?sf.Caption:"";Kd[ye].IsCellPicture=15735758===this.fc.command||570484235===this.fc.command}var Ne=-2009825598===this.fc.command?"bing":"M365";ye=fa.f(this.$);var hf=gc.r(ye.ha.oa.activeCell,this.$);Je.a(this.$.userOperationManager,(sf,Gf,Yf)=>$e.x(this.$.ma.sa,hf,Kd,Ne,xd.c(sf,this.U2j),xd.b(Gf,this.T2j),Yf,null),sf=>new ub.a(595,
0,sf),this.fc);$c.HelperMethods.l8?(ye=new Map,ye.set("MediaProvider",Ne),ye.set("ImagesCount",Ad.length.toString()),ye.set("TimeTakenToOpenDialog",this.Pbg.toString()),je.Health.instance.recordKpiUsage(le.a.Ujj,ge.b.SuccessBased,Od.a.A1g,ye)):C.ULS.sendTraceTag(537155805,0,15,"OnlinePictureUploaderWrapper.UploadResponseReceived: KPI Usage not supported.");this.m0b()}else C.ULS.sendTraceTag(537155806,0,10,"OnlinePictureUploaderWrapper.UploadResponseReceived: Response is null")};this.U2j=Ad=>{if(Ib.a(Ad))C.ULS.sendTraceTag(537155799,
0,10,`OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded with errors. Errors: ${Xd.a.pc(Ad.Errors)}`);else{C.ULS.sendTraceTag(537155801,0,50,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded.");const Kd=this.fc.command;15735758!==Kd&&570484235!==Kd&&(Ad.Result?Pa.a(this.$).XLa(1,Ad.Result):C.ULS.sendTraceTag(537155800,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess:Result.result is null"))}};this.T2j=()=>{C.ULS.sendTraceTag(537155798,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadFailed: Operation failed")};
this.$=F;this.fc=va;this.PO=jd;this.g7e=Object(df.d)(Bf.a);this.showDialog()}dispose(){this.$=null}showDialog(){let F=null;F=this.$.Vb.Uc("UserAction","showOnlineImagesDialogTimeStopwatch");switch(this.fc.command){case -2009825598:case 15735758:this.QUk();break;case -2053056795:case 570484235:this.g7e.execute(va=>{va.isFeatureEnabled("MsoPremiumStockImages",!1).catch(lb=>C.ULS.sendTraceTag(557200643,0,10,`OnlinePictureUploaderWrapper::ShowDialog - Failed to load the premium state from application feature helper: ${lb}`)).then(lb=>
{this.RUk(lb);return null})})}F.stop();this.Pbg=F.Kc}QUk(){let F=this.$.ta.BingPictureEndpoint;const va=Ie.a.kN(hb.AFrameworkApplication.lcid),lb=Tb.a.create();F?(F=0<F.search(RegExp("insertmedia.bing.office.net","gi"))?String.format(F,1,1):String.format(F,1,hb.AFrameworkApplication.lcid,va?va.name:"en-us",hb.AFrameworkApplication.buildVersion,lb.toString(),1,this.$.ta.DocumentHostInfo.LoggableUserId),this.Brc(F,1,-1,Ha.a.instance.ia(1764))):(C.ULS.sendTraceTag(537155804,0,10,"OnlinePictureUploaderWrapper::ShowDialogForBingPictures - Can't access the Bing service endpoint"),
this.PO.setException(Error.create("Failed to access the Bing service endpoint")))}RUk(F){var va=this.$.ta.M365PictureEndpoint,lb=Tb.a.create();if(va){var sc=this.$.ta.DocumentHostInfo.UserId;sc=sc?la.a.qz(sc).toString():"0";var Yc=this.g7e.instance.isFreemiumUpsellEnabled();F=F?1:Yc?0:-1;lb=lb.toString();Yc=Ie.a.kN(hb.AFrameworkApplication.lcid).name;va=String.format(va,hb.AFrameworkApplication.lcid,Yc,hb.AFrameworkApplication.buildVersion,lb,1,sc,F,1);this.Brc(va,2,F,Ha.a.instance.ia(1763))}else C.ULS.sendTraceTag(537155803,
0,10,"OnlinePictureUploaderWrapper::ShowDialogForStockImages - Can't access the M365 service endpoint"),this.PO.setException(Error.create("Failed to access the M365 service endpoint"))}Brc(F,va,lb,sc){try{(new Uc(this.$,F,Object(df.f)(Bf.a),va,lb,sc)).IVk(this),this.PO.setResult(!0)}catch(Yc){C.ULS.sendTraceTag(537155802,0,10,`OnlinePictureUploaderWrapper::CreateAndShowDialog failed [Exception : ${Yc}] [MediaProvider : ${va}] [DialogLicenseTier : ${lb}]`),this.PO.setException(Yc)}}}Object(O.a)(ze,
"OnlinePictureUploaderWrapper",Wd,[4]);let Le=class{constructor(F,va){this.$=F;this.uploaderCreator=va}executeCommand(F,va,lb){F=va.command;switch(F){case 1403967063:case -2060689045:if(lb&&"dataUrl"in lb)return va=new Mf.a,this.uploaderCreator&&this.uploaderCreator.fhj(this.$,Ma.TaskManager.instance,hb.AFrameworkApplication.ea,lb,lb.dataUrl,va),va.task;this.uploaderCreator&&this.uploaderCreator.rij(this.$,va,Ma.TaskManager.instance,hb.AFrameworkApplication.ea,lb);return ia.Task.Va(!0);case -2053056795:case -2009825598:case 570484235:case 15735758:return F=
new Mf.a,new ze(this.$,va,Ma.TaskManager.instance,hb.AFrameworkApplication.ea,lb,F),F.task;default:return xa.a(F)}}Rc(F,va){let lb=this.$.isEditMode;if(lb)switch(va.command){case 1403967063:lb=!0;break;case -2053056795:lb=!0;break;case -2009825598:lb=!0;break;case -2060689045:case 15735758:case 570484235:lb=zf.a.OUb()&&1===F;break;default:lb=!1}return lb}td(){return!1}gd(){return!1}};Le=Object(U.__decorate)([Object(Ka.d)(Ba.InsertPictureCommandHandlerService),Object(U.__param)(0,Object(Ba.EwaControlService)()),
Object(U.__param)(1,Object(Ba.UploaderCreatorService)())],Le);Object(O.a)(Le,"PictureCommandHandler",null,[29]);var nf=a(74);class cf{}cf.Rhi="DisplayNotInvoked";cf.hCd="Displayed";cf.Oek="PrerequisitesNotReady";Object(O.a)(cf,"PasteIndicationDisplayStatus",null,[]);var Te=a(57),Wf=a(53),Hf=a(33),ib=a(312),xc=a(943),Kc;let ra=Kc=class{constructor(F){this.KKb="";this.lB=this.tx=null;this.pqb=new Map;this.Gaa=null;this.vRc=!1;this.OTf=(va,lb)=>{this.hide(void 0===va?null:va,void 0===lb?null:lb)};this.$=
F;this.da=fa.f(F);this.da.ha.Vq(this.OTf)}ACd(){this.vRc||(C.ULS.sendTraceTag(537167680,0,50,"PasteIndicationManager.DownloadPrerequisitesIfNeeded: Trying to get appChrome"),this.da.$.kY(F=>{F.O1(0).then(()=>{this.vRc=!0})}))}qDk(F){this.ACd();this.KKb=F;this.RNg(F)}ENg(F){const va=F.commandParameters.id;C.ULS.sendTraceTag(537167651,0,50,`PasteIndicationManager.ScheduleDisplay: pasteCommandId = ${va}, cancelCtx is null = ${!this.tx}, PrerequisitesDownloaded = ${this.vRc}`);this.ACd();this.KKb=va;
const lb=!this.fhg();if(!this.tx||lb)this.scf(),this.tx=Te.a.instance.create(()=>{this.Ohi(F)},void 0===F.timeoutToShowSpinnerInMs||null===F.timeoutToShowSpinnerInMs?100:F.timeoutToShowSpinnerInMs,Wf.a.oak);this.Gaa=F.commandParameters.originalDestinations;this.RNg(va)}Ohi(F){this.vRc?(this.display(F.commandParameters.originalDestinations),F.pasteIndicationDisplayStatus=cf.hCd):(C.ULS.sendTraceTag(537167650,0,50,"PasteIndicationManager.DisplayIfPossible: Prerequisites were not ready, skipping display"),
this.hide(),F.pasteIndicationDisplayStatus=cf.Oek)}RNg(F){this.pqb.set(F,Hf.a.zb.me);Te.a.instance.create(()=>{this.bii(F)},this.$.ta.PasteToastNotificationDelayTime,Wf.a.pak)}bii(F){this.pqb.has(F)&&(this.lB?this.lB.displayTimeoutSeconds+=this.$.ta.PasteToastNotificationDefaultDisplayDuration:(F=Ha.a.instance.ia(2341),this.lB=$b.a.Xv.KC.QP(F,!1),this.lB.image=5,this.lB.sY=xc.a.Kmk,this.lB.displayTimeoutSeconds=this.$.ta.PasteToastNotificationDefaultDisplayDuration,$b.a.Xv.KC.pz(this.lB)))}Yca(F,
va,lb){F&&this.lB&&(F=lb?`"${va}" ${Ha.a.instance.ia(2433)}`:Ha.a.instance.ia(2342),this.lB.Z2c(F),this.lB.image=5,this.lB.sY=lb?xc.a.A5k:xc.a.qef);setTimeout(()=>{this.rrk()},3E3)}rrk(){this.lB&&($b.a.Xv.KC.removeEntry(this.lB),this.lB=null)}display(F){C.ULS.sendTraceTag(537167649,0,50,"PasteIndicationManager.Display: started");this.da.Ub.HL(He.a.a7a(nf.d(this.da.$.la),F),Kc.AQc,!0);this.da.Ub.Iq(Kc.AQc)}qYa(F,va,lb,sc){va=void 0===va?!0:va;lb=void 0===lb?null:lb;sc=void 0===sc?!1:sc;C.ULS.sendTraceTag(537167648,
0,50,`PasteIndicationManager.HideForPasteId: pasteCommandId = ${F}, currentPasteCommandId = ${this.KKb}`);F&&Oa.a.equals(F,this.KKb,!1)&&this.hide();if(F&&this.pqb.has(F)){const Yc=ib.a(Hf.a.zb.me,this.pqb.get(F));6E4<Yc&&C.ULS.sendTraceTag(508839751,0,50,`PasteIndicationManager.hideForPasteId: large paste. CommandId (${F}), scheduleDisplayToHideDurationInMs (${Yc}))`);this.pqb.delete(F);null!=this.lB&&0===this.pqb.size&&this.Yca(va,lb,sc)}}hide(F){this.Gaa&&(void 0===F?0:F)&&this.fhg()&&C.ULS.sendTraceTag(537167647,
0,15,"PasteIndicationManager.Hide: Triggered by a SelectionChanged event while indication is (or will be) active but active range did not change");this.KKb="";this.scf();this.Gaa=null;0!==this.da.Ub.MJd([30]).length&&(this.da.Ub.rl(Kc.AQc),this.da.Ub.pn(null,Kc.AQc))}fhg(){return gc.Y(this.da.ha.oa.selectedRanges,this.Gaa)}scf(){this.tx&&(Ob.a.vb(this.tx),this.tx=null)}dispose(){this.hide();this.lB&&this.Yca(!1);this.da.ha.vr(this.OTf)}};ra.AQc=[30];ra=Kc=Object(U.__decorate)([Object(Ka.d)(Ba.PasteIndicationManagerService),
Object(U.__param)(0,Object(Ba.EwaControlService)())],ra);Object(O.a)(ra,"PasteIndicationManager",null,[800,4]);var jb=a(156);Object(Ka.b)(Ba.PasteShortcutManagerService,{we:"singleton"})(async F=>{F=await Ka.a.resolve(Ba.EwaControlService,F);const va=ld.a.instance,lb=jb.a.instance.SP();return new vc(F,va,lb)});class vc extends nb.a{constructor(F,va,lb){super();this.statusBarManager=null;this.opf=()=>{this.Ptc()};this.fhi=()=>{this.Ptc()};this.npf=sc=>{10===sc&&this.Ptc()};this.onKeyDown=sc=>13===
sc.Ha.keyCode?(sc=new Sb.a(237279923,1,2,6,null),this.$.Ia.Gb(sc,{[S.a.skipClipboardAccess]:!0,[S.a.Ttf]:!0}),!0):!1;this.$=F;this.Jy=va;this.Rn=lb;this.aEd=!1;this.$.ra.Vc(29,sc=>{this.statusBarManager=sc;sc.FJ(this)})}dispose(){this.Bi();this.Rn=this.Jy=this.$=null;this.statusBarManager&&(this.statusBarManager.OI(this),this.statusBarManager=null)}Wj(){return!0}vq(F,va){if("QueryPasteShortcutEnabledLabel"!==F&&!vc.C0k.includes(F))return!1;const lb=this.SK();"QueryPasteShortcutEnabledLabel"===F?(va.Visible=
lb,C.ULS.sendTraceTag(537167636,0,100,`PasteShortcutManager.ExecuteRootCommand: Setting visible to ${lb} for commandId ${F}`)):(va.Visible=!lb,C.ULS.sendTraceTag(537167635,0,100,`PasteShortcutManager.ExecuteRootCommand: Setting visible to ${!lb} for commandId ${F}`));return!0}mmi(){this.Aj();this.raiseEvent("pasteShortcutStatusChanged")}Ptc(){this.Bi();this.raiseEvent("pasteShortcutStatusChanged")}SK(){return this.aEd}Js(F){this.addHandler("pasteShortcutStatusChanged",F)}vs(F){this.removeHandler("pasteShortcutStatusChanged",
F)}Aj(){if(!this.SK()){this.aEd=!0;fa.f(this.$).Ej.Jp(this.opf);this.Rn.Ea("blur",this.fhi);const F=Ka.a.Cb(Ba.ExcelCommentManagerService);F&&F.Cba&&F.Cba.registerForCommentEvents(this.npf);this.Jy.Vy(Wa.a.nd,this.$.pT,this.onKeyDown,!0)}}Bi(){if(this.SK()){this.aEd=!1;fa.f(this.$).Ej.zp(this.opf);this.Rn.detach("blur");const F=Ka.a.Cb(Ba.ExcelCommentManagerService);F&&F.Cba&&F.Cba.unregisterForCommentEvents(this.npf);this.Jy.fz(Wa.a.nd,this.$.pT,this.onKeyDown,!0)}}}vc.C0k=["QuerySheetNumberButton",
"QueryWorkbookStatisticsButton"];Object(O.a)(vc,"PasteShortcutManager",nb.a,[801,360,217,4]);const md=F=>{switch(F){case 1:return 1457;case 2:return 1458;case 3:return 1459;case 4:return 1460;case 5:return 1461;case 6:return 1462;case 7:return 1463;case 8:return 1464;case 9:return 1465;case 10:return 1466;case 11:return 1467;case 12:return 1468;case 13:return 1469;case 14:return 1470;case 15:return 1471;case 16:return 1472;case 17:return 1473;case 18:return 1474;case 19:return 1475;case 20:return 1476;
case 21:return 1477;case 22:return 1480;case 23:return 1478;case 24:return 1479;case 25:return 1481;case 26:return 1482;case 27:return 1483;case 28:return 1484;default:return 1485}};var Qd=a(210),v=a(119);class Qb{static get Ljk(){return Qb.UVe||(Qb.UVe=RegExp("([A-Z]+)","g"))}static get Kjk(){return Qb.TVe||(Qb.TVe=RegExp("([A-Z])","g"))}static get QXh(){return Qb.PIe||(Qb.PIe=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}static LNd(F){return Qb.zMf(F.toString())}static zMf(F){return Qb.QXh.test(F)?
F.replace(Qb.Ljk,"$1 ").replace(Qb.Kjk,' "$1"').trim():F}static mwk(F){const va=F.lastIndexOf("!");return F.substring(0,-1<va?va+1:0)+Qb.zMf(F.substring(-1<va?va+1:0,F.length))}}Qb.UVe=null;Qb.TVe=null;Qb.PIe=null;Object(O.a)(Qb,"RangeAriaExtensions",null,[]);class Dc{constructor(){this.activeItemName=null;this.B4f=!1;this.tableName=null;this.seb=0;this.o0c=!1}}Object(O.a)(Dc,"SelectionReadoutState",null,[]);var id=a(172),Md=a(969),Sd;let ne=Sd=class{constructor(F,va,lb,sc,Yc){this.ADa=this.gridReadoutNotifier=
null;this.UNg=!1;this.hma=()=>{oa.EwaSettings.isChangeGateEnabled("OfficeVSO:5963256_DoNotReadActiveItemIfDisposed")&&!this.$?C.ULS.sendTraceTag(526235470,0,15,"calling readActiveItemDescription after dispose, ignoring."):fa.f(this.$).isEditing&&!fa.f(this.$).inRangePicker||this.lnc.Cv()};this.FSj=()=>{if(!fa.f(this.$).ha.ob.hYd){var jd,Ad=(()=>{let Kd=this.HIi();({activeCell:jd}=Kd);return Kd})().returnValue;this.readText(Ad,jd)}};this.jO=()=>{const jd=this.activeCell;this.readText("Editing",jd);
oa.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||jd&&jd.FCc&&!fa.f(this.$).rSf||this.lnc.cancel()};this.Nd=()=>{oa.EwaSettings.isChangeGateEnabled("OfficeVSO:6053639_DoNotHandleSelectionChangedIfDisposed")&&!this.$?C.ULS.sendTraceTag(525366409,0,15,"calling onSelectionChanged after dispose, ignoring."):this.hma()};this.$=va;this.ariaLiveNotifier=F;this.c8b=sc;this.je=lb;this.MI=new Dc;this.nlb=sa.nlb();this.UNg=oa.EwaSettings.isChangeGateEnabled("OfficeVSO:8582263_ScreenReaderShapeInfoReadoutEnabled");
this.nlb&&(this.gridReadoutNotifier=Yc,C.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7945213_removeActiveCellDelayForBraille")?Sd.Cmd=0:Sd.Cmd=700);this.lnc=Te.a.instance.create(this.FSj,Sd.Cmd,Wf.a.uFk,!1);this.Aj()}get activeCell(){return fa.f(this.$).Ob(null)}dispose(){this.$&&this.Bi();Ob.a.vb(this.lnc);this.c8b=this.$=this.lnc=null}Tyc(F,va,lb){lb=void 0===lb?!0:lb;
if(null!==this.$.Mb.Ph&&"FindAndReplaceDialog"===this.$.Mb.Ph.Tc||!F)return"";var sc=this.$.ra;const Yc=new Sys.StringBuilder;this.KJh(Yc,F,va);if(oa.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var jd=this.je.Ita(F.range);(null===jd||void 0===jd?0:jd.Ose)&&this.z7e(Yc,jd);jd=this.je.jt(F.range);(null===jd||void 0===jd?0:jd.eua)&&this.z7e(Yc,jd)}jd=F.L7?this.KJf(F):F.text;aa(Yc,jd);jd=this.$.activeItemName;this.MI.activeItemName!==jd&&(aa(Yc,jd),this.MI.activeItemName=
jd);jd=1===va.length?gc.S(va).isSingle?"":Ha.a.instance.ia(853):String.format(Ha.a.instance.Ib(31),va.length);aa(Yc,jd);for(var Ad of va)jd=this.nlb?Ad.toString():Qb.LNd(Ad),aa(Yc,jd),1===va.length&&Sd.hyj(Ad)&&(jd=fa.f(this.$).za.ft(Ad.bottomRight),void 0!==jd&&null!==jd&&jd.text&&(jd=jd.L7?this.JJf(jd,jd.text):jd.text,aa(Yc,jd)));Ad=F.cell;Ad=this.sXi(Ad.rBk,Ad.Y_h);aa(Yc,Ad);this.tJh(Yc,F);lb&&(F.Tlb?aa(Yc,Ha.a.instance.ia(841)):F.u_a&&aa(Yc,Ha.a.instance.ia(842)));if(F.hasAutoFilter||F.Qja)this.LJh(Yc,
F.hasAutoFilter?F.cell.autoFilterType:F.cell.ibk),lb&&aa(Yc,Ha.a.instance.ia(844));Qd.d(this.$,F.range)&&aa(Yc,Ha.a.instance.ia(848));this.rJh(Yc,F);lb=(lb=Ka.a.Cb(Ba.DataValidationControlService))?lb.NJi():"";aa(Yc,lb);F.Jx&&(lb=fa.f(this.$).za.ft(F.range),lb=!!lb&&lb.hasIgnorableError,Sd.kQk(F)?Sd.sJh(Yc,F):oa.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&lb?aa(Yc,Ha.a.instance.ia(846)):aa(Yc,Ha.a.instance.ia(845)));F.tN&&(aa(Yc,Ha.a.instance.ia(847)),F.uRb&&aa(Yc,
String.format(Ha.a.instance.Ib(16),F.Lci)),aa(Yc,F.iconName));F.hasRichValueIcon&&(Ad=Ka.a.Cb(Ba.ConvertToLinkedEntityManagerService),lb="",Ad&&F.cell.nKc&&(Ad=Ad.i1(F.cell.nKc))&&Ad.DomainId.Id!==Sd.Ekl&&(lb=Ad.Name),F.cell.tmj?(aa(Yc,String.format(Ha.a.instance.Ib(187),lb)),aa(Yc,Ha.a.instance.ia(1812))):(aa(Yc,String.format(Ha.a.instance.Ib(185),lb)),aa(Yc,Ha.a.instance.ia(1811))));this.zaj(F)&&aa(Yc,Sd.NRi(F));(sc=sc.Tb(231))&&aa(Yc,sc.aKf(va,!0));1===va.length&&va[0].isSingle&&Sd.jQk(F,va[0])&&
(va=Ka.a.Cb(Ba.ConvertToLinkedEntityManagerService))&&aa(Yc,va.eKi());F.A9b&&F.B9b&&aa(Yc,F.B9b);(va=F.cell.Eud)&&aa(Yc,va);this.qJh(Yc,F);F.s_a&&F.b1b&&(F=F.vce)&&(aa(Yc,Ha.a.instance.ia(1985)),aa(Yc,F));return Yc.toString()}kbf(F){this.ADa=this.MI;this.MI=Object(oc.a)(new Dc,{activeItemName:this.ADa.activeItemName,o0c:F?this.ADa.o0c:!1,tableName:F?this.ADa.tableName:"",seb:F?this.ADa.seb:-1})}SKg(){this.ADa&&(this.MI=this.ADa,this.ADa=null)}sXi(F,va){return 2===F||2===va?Ha.a.instance.ia(875):1===
F||1===va?Ha.a.instance.ia(876):""}KJf(F){return this.JJf(F.cell,F.text)}KJh(F,va,lb){if(lb&&1===lb.length&&lb[0].isSingle){lb="";var sc=this.je.Ita(va.range);if(sc){lb=sc.pivotTableName;this.jqd(F,lb);var Yc=sc.HFc?Ha.a.instance.ia(835):"";oa.EwaSettings.isChangeGateEnabled("OfficeVSO:6154754_NarratorReadoutForPivotTableAltText")&&(Yc+=(sc.altText?sc.altText+" . ":"")+(sc.altTextSummary?sc.altTextSummary:""));this.B7e(F,!0,lb,Yc);aa(F,this.je.awj(sc,va.range)?Ha.a.instance.ia(838):"");aa(F,this.je.Qnj(sc,
va.range)?Ha.a.instance.ia(837):"")}else if(sc=this.je.jt(va.range)){lb=(Yc=fa.f(this.$).Eb.dg(va.range))?Yc.name:"";this.jqd(F,lb);let jd="";Yc&&(jd=(Yc.I6a?Yc.I6a+" . ":"")+(Yc.J6a?Yc.J6a:""));this.B7e(F,!1,lb,jd);aa(F,this.je.d1f(sc,va.range)?Ha.a.instance.ia(837):"")}else this.jqd(F,lb),this.MI.tableName="",this.MI.seb=-1}}jqd(F,va){va!==this.MI.tableName&&this.MI.tableName&&(F.append(Ha.a.instance.ia(this.MI.o0c?834:833)),aa(F," "+this.MI.tableName))}B7e(F,va,lb,sc){lb!==this.MI.tableName&&(F.append(Ha.a.instance.ia(va?
832:831)),aa(F," "+lb),aa(F,sc),this.MI.tableName=lb,this.MI.o0c=va,this.MI.seb=-1)}z7e(F,va){const lb=fa.f(this.$).ha.oa.activeCell;if(lb.top!==va.top&&lb.left!==this.MI.seb){F.append(Ha.a.instance.ia(837));va=new pc.Range(va.top,lb.left,va.top,lb.left,!0,!0);aa(F,Qb.LNd(va));if(va=fa.f(this.$).Ob(va))va=va.L7?this.KJf(va):va.text,aa(F,va);this.MI.seb=lb.left}}JJf(F,va){const lb=F.Lz;return F.iHa?String.format(Ha.a.instance.Ib(14),va,lb):String.format(Ha.a.instance.Ib(13),va,Qb.mwk(lb))}Aj(){C.ULS.shipAssertTag(537153930,
0,!!this.$,"Can't register to ewaControl's events");if(this.$){var F=fa.f(this.$);C.ULS.shipAssertTag(537153929,0,!!F,"Can't register to grid's events");F&&(F.Rb.Jp(this.jO),F.za.Or(this.hma),F.KJ(this.hma),F=F.ha,C.ULS.shipAssertTag(537153928,0,!!F,"Can't register to selectionManager's events"),F&&(F.Vq(this.Nd),F.add_activeCellChanged(this.hma),F.ob.pF(this.hma)))}}Bi(){if(this.$){var F=fa.f(this.$);F&&(F.Rb.zp(this.jO),F.za.Gq(this.hma),F.xL(this.hma),F=F.ha)&&(F.vr(this.hma),F.remove_activeCellChanged(this.hma),
F.ob.yL(this.hma))}}readText(F,va){this.nlb&&this.gridReadoutNotifier&&(oa.EwaSettings.isChangeGateEnabled("OfficeVSO:8194559_StaleValueReadoutFixEnabled")||this.gridReadoutNotifier.isActive)?this.gridReadoutNotifier.readText(F):(this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(F),va&&this.ariaLiveNotifier.zbl(va))}HIi(){let F;F=null;var va=fa.f(this.$).ha;if(1!==va.gf&&!va.ob.Wb)return C.ULS.sendTraceTag(537153927,0,15,`selectionManager.CommandSelectionMode=${va.gf} and selectionManager.SelectedFloatingObjectControl is null`),
{returnValue:"",activeCell:F};switch(va.gf){case 2:return{returnValue:this.$Li(va),activeCell:F};case 64:var lb=va.ob.Wb.floatingObject;let sc="";if(va=va.ob.Wb.cx||va.ob.Wb.Zd)sc=(va=va.firstChild)?ea.DOMElementExtensions.getTextContent(va):"";return this.UNg?{returnValue:this.J0i(lb),activeCell:F}:{returnValue:String.format(Ha.a.instance.Ib(53),Sd.vyc(lb.altText,lb.altTextDescription,lb.name),sc,lb.altTextDescription),activeCell:F};case 4:return{returnValue:Sd.DIh(va.ob.Wb.floatingObject),activeCell:F};
case 512:return{returnValue:v.a.eIf(va.ob.Wb.floatingObject.VCd),activeCell:F};case 8:return lb=va.ob.Wb.floatingObject,{returnValue:String.format(Ha.a.instance.Ib(51),lb?lb.name:""),activeCell:F};case 1:return F=this.activeCell,lb=va.oa.selectedRanges,fa.f(this.$).inRangePicker?this.pZi(va,F):{returnValue:this.Tyc(F,lb),activeCell:F}}return{returnValue:"",activeCell:F}}pZi(F,va){F=F.rangePicker.jV.map(sc=>sc.range);const lb=fa.f(this.$).Ob(F[0]);return{returnValue:this.Tyc(lb,F),activeCell:va}}$Li(F){const va=
new Sys.StringBuilder;va.append(Sd.aXh(F));const lb=this.$.ra.Tb(231);lb&&aa(va,lb.aKf(F.ob.Wb.floatingObject,!1));return va.toString()}J0i(F){var va,lb,sc,Yc,jd,Ad=null;isNullOrUndefined(null===(va=F.Sb)||void 0===va?void 0:va.ShapeFillColor)||(-1===F.Sb.ShapeFillColor?Ad=F.Sb.HasEffects?"gradient":null:(Ad=(null===(lb=F.Sb)||void 0===lb?0:lb.IsShapeConnector)?id.a.WZ(F.Sb.ShapeOutlineColor):id.a.WZ(F.Sb.ShapeFillColor),Ad=id.a.np(Ad.toUpperCase()),Ad=Md.a.EGa(Ad)));lb=!la.a.hia(Ad);return(va=!la.a.hia(null===
(sc=F.Sb)||void 0===sc?void 0:sc.ShapeText))&&lb?String.format(Ha.a.instance.Ib(235),F.altText,F.altTextDescription,F.name,Ad,null===(Yc=F.Sb)||void 0===Yc?void 0:Yc.ShapeText):!lb&&va?String.format(Ha.a.instance.Ib(236),F.altText,F.altTextDescription,F.name,null===(jd=F.Sb)||void 0===jd?void 0:jd.ShapeText):!va&&lb?String.format(Ha.a.instance.Ib(237),F.altText,F.altTextDescription,F.name,Ad):String.format(Ha.a.instance.Ib(234),F.altText,F.altTextDescription,F.name)}zaj(F){F=F.vZf();let va=!1;this.MI.B4f!==
F&&(this.MI.B4f=F,va=!0);return va}tJh(F,va){if(va.Gjb)if(va=this.c8b.v1i(va)){var lb=Ha.a.instance,sc=lb.ia;a:switch(va.type){case 0:var Yc=828;break a;case 1:Yc=829;break a;default:Yc=830}lb=sc.call(lb,Yc);aa(F,String.format(Ha.a.instance.Ib(25),lb));va=String.format(Ha.a.instance.Ib(24),Qb.LNd(va.XZk));aa(F,va)}else C.ULS.sendTraceTag(537153925,0,15,"No sparkline range was found on a cell with sparkline."),aa(F,String.format(Ha.a.instance.Ib(25),""))}LJh(F,va){switch(va){case 1:case 11:aa(F,Ha.a.instance.ia(849));
break;case 6:aa(F,Ha.a.instance.ia(849));aa(F,Ha.a.instance.ia(851));break;case 7:aa(F,Ha.a.instance.ia(849));aa(F,Ha.a.instance.ia(852));break;case 2:aa(F,Ha.a.instance.ia(850));aa(F,Ha.a.instance.ia(851));break;case 3:aa(F,Ha.a.instance.ia(850));aa(F,Ha.a.instance.ia(852));break;default:aa(F,Ha.a.instance.ia(850))}}rJh(F,va){var lb;const sc=Ka.a.Cb(Ba.ExcelCommentManagerService);va=sc?sc.mGa(va.range):null;let Yc="";const jd=Object(Pd.a)(399,va);if(va)Yc=!va.Alb&&jd&&jd.Kxj?String.format(Ha.a.instance.Ib(29),
jd.i3k):String.format(Ha.a.instance.Ib(23),va.author);else if(null===(lb=null===sc||void 0===sc?void 0:sc.om)||void 0===lb?0:lb.UF)Yc=String.format(Ha.a.instance.Ib(28),sc.om.OU.author);aa(F,Yc)}qJh(F,va){const lb=Ba.CatchUpActivityManagerService.Oa()?Ka.a.Cb(Ba.CatchUpActivityManagerService):this.$.ra.Tb(286);lb&&(va=lb.PJi(nf.d(this.$.la),va.range))&&0<va.length&&(va=String.format(Ha.a.instance.Ib(1===va.length?220:221),va[0]),aa(F,va))}static DIh(F){return String.format(Ha.a.instance.Ib(52),Sd.vyc(F.altText,
F.altTextDescription,F.name),F.altTextDescription)}static NRi(F){return Ha.a.instance.ia(F.vZf()?839:840)}static vyc(F,va,lb){return F||va?F:lb}static aXh(F){var va=F.ob.Wb;F=va.floatingObject;const lb=F.Zc,sc=lb.ChartTitle,Yc=F.altText,jd=F.altTextDescription,Ad=!!(lb.Attributes&4);return(va=va.getSelectionDescription())?va:lb.DataRangeForDisplay?String.format(Ha.a.instance.Ib(Ad?49:47),Sd.vyc(Yc,jd,F.name),jd,sc,Ha.a.instance.ia(md(lb.ChartCategory)),lb.DataRangeForDisplay):String.format(Ha.a.instance.Ib(Ad?
50:48),Sd.vyc(Yc,jd,F.name),jd,sc,Ha.a.instance.ia(md(lb.ChartCategory)))}static kQk(F){return oa.EwaSettings.Ra(101)&&(F.hUb||F.CFc)}static sJh(F,va){va.n6a?va.hUb?aa(F,String.format(Ha.a.instance.Ib(26),va.n6a.topLeft.toString())):va.CFc&&(va=va.n6a.Zw(),aa(F,String.format(Ha.a.instance.Ib(27),(va.LastColumn-va.FirstColumn+1).toString(),(va.LastRow-va.FirstRow+1).toString()))):C.ULS.shipAssertTag(537153924,0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.")}static jQk(F,
va){return F.Jx||!oa.EwaSettings.Ra(131)?!1:(F=Ka.a.Cb(Ba.ConvertToLinkedEntityManagerService))?F.aFc(va):!1}static hyj(F){return F.top===F.bottom&&F.left+1===F.right||F.top+1===F.bottom&&F.left===F.right}};ne.esl="#";ne.Ekl=268435712;ne.Cmd=500;ne=Sd=Object(U.__decorate)([Object(Ka.d)(Ba.SelectionReadoutHandlerService),Object(U.__param)(0,Object(Ba.AriaLiveNotifierService)()),Object(U.__param)(1,Object(Ba.EwaControlService)()),Object(U.__param)(2,Object(Ba.TableManagerService)()),Object(U.__param)(3,
Object(Ba.SparklineManagerService)()),Object(U.__param)(4,Object(Ba.FocusBasedReadoutService)())],ne);Object(O.a)(ne,"SelectionReadoutHandler",null,[797,4]);var Ce=a(8),Ge=a(127),Ee=a(38);let Ue=class extends Ge.a{constructor(F,va){F=void 0===F?Ce.a.Itb:F;va=void 0===va?Ce.a.aC:va;super(F,va)}execute(F){const va=Object(Pd.a)(190,F.ff);C.ULS.shipAssertTag(537153921,0,Xd.a.GGb(F.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");va.sL(!0,!0);F.activityState[Ee.a.pkc]=
va.fa.sessionId;F.activityState[Ee.a.REb]=!0;F.activityState[Ee.a.vkc]=!0;C.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3}};Ue=Object(U.__decorate)([Object(Ka.d)(Ba.SessionReloadActivityService)],Ue);Object(O.a)(Ue,"SessionReloadActivity",Ge.a,[]);var We=a(58),ya=a(313),Cb=a(42),qa=a(40),qb=a(278),bc=a(111);const R=(F,va)=>new cb(F,va,Ce.a.aC,Ce.a.yj,Ce.a.fwb);Object(Ka.b)(Ba.SessionReloadSilentActivityService,{we:"singleton"})(()=>
R(Ce.a.Qma,Ce.a.Wcb));Object(Ka.b)(Ba.SessionReloadSilentOpenActivityService,{we:"singleton"})(()=>R(Ce.a.R5b,Ce.a.vKa));Object(Ka.b)(Ba.SessionReloadSilentOpenForSaveAsActivityService,{we:"singleton"})(()=>R(Ce.a.S5b,Ce.a.TPc));Object(Ka.b)(Ba.SessionReloadSilentProcessingUserOperationsActivityService,{we:"singleton"})(()=>R(Ce.a.kMa,Ce.a.hS));class cb extends Ge.a{constructor(F,va,lb,sc,Yc){super(F,va);cb.B4d=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];cb.A4d=[-1468309555,
-315732528,-399065540,810218235,1531005923,1593924569,1112506702,1220851643];cb.mdg=[-1468309555,611268539,-1750576502,61029505,-658377927];cb.ldg=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-658377927,-1337545025];this.GZc=lb;this.WXk=sc;this.M6k=Yc}execute(F){var va=Object(Pd.a)(190,F.ff);F.activityState[Ee.a.CCa]=!0;var lb=cb.l1i(F);if(cb.zQk(F,lb))return cb.aKj(F),lb=50,0<F.errors.length&&(lb=15),C.ULS.sendTraceTag(537153891,0,lb,`SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : ${Xd.a.pc(F.errors)}`),
F.activityState[Ee.a.CCa]=!1,this.zi(Ce.a.idle),3;switch(lb){case 1:case 3:this.ujj(F,lb);break;case 2:this.tjj(F);break;case 0:F.activityState[Ee.a.Bbb]=null}C.ULS.sendTraceTag(21837003,0,50,`SessionReloadSilentActivity.Execute: silentReloadType:${lb}. activityName:${this.activityName}. NextActivityName:${this.V8}. TimeFromLastStatefulResponse:${va.fa.I4}.`);var sc=Cb.a.rh(F.activityState,bc.a.mwb);C.ULS.shipAssertTag(40502925,0,!sc||sc&&(1===lb||3===lb),`triggerSilentReloadAfterTokenRefresh: ${sc}, silentReloadType: ${lb}`);
va=va.Nm.reloadCount;return 0!==lb&&0<va?(sc=ya.a.cjb(va,200),C.ULS.sendTraceTag(537153890,0,50,`SessionReloadSilentActivity.Execute: schedule Silent-Type [${lb}] retryNum [${va}] delayInMs [${sc}] activityName [${this.activityName}]`),Te.a.instance.create(()=>{cb.MP(F)},sc,Wf.a.EHk),1):3}ujj(F,va){C.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");const lb=Object(Pd.a)(190,F.ff);F.activityState[Ee.a.REb]=!0;lb.KEc||qa.a.instance.tg("ReopenOnLoad");
cb.isEditMode(F)&&oa.EwaSettings.isChangeGateEnabled("OfficeVSO:8609965_SilentReloadInCollabModeInClient")&&cb.XHa(F)||!Xd.a.GGb(F.errors)||(C.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),F.activityState[Ee.a.pkc]=lb.fa.sessionId,F.activityState[Ee.a.vkc]=!0);F.V4d();3===va?(lb.fa.Hg()||lb.fa.WQj(),lb.sL(!0,!0),this.zi(this.M6k),F.activityState[Ee.a.G1e]=lb.workbookContext.CalcMode):(oa.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&
1===va&&lb.sL(!0,!0),F.activityState[Ee.a.bnd]=!1,this.zi(this.GZc))}tjj(F){C.ULS.sendTraceTag(537153888,0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");F.activityState[Ee.a.Bbb]=null;F.V4d();this.zi(this.WXk);F=Object(Pd.a)(190,F.ff);F.KEc||(qa.a.instance.tg("RefreshOnLoad"),F.Y3b())}static MP(F){F.MP()}static l1i(F){const va=Object(Pd.a)(190,F.ff),lb=va.fa,sc=cb.isEditMode(F),Yc=cb.XHa(F);var jd=oa.EwaSettings.isChangeGateEnabled("OfficeVSO:8609965_SilentReloadInCollabModeInClient"),
Ad=Xd.a.hi(F.errors,sc||jd&&Yc?cb.A4d:cb.B4d);jd=Xd.a.hi(F.errors,sc||jd&&Yc?cb.ldg:cb.mdg);const Kd=va.hU,ye=va.Nm.reloadCount,Ne=va.ta.MaxConsecutiveSilentReloadAllowed,hf=va.Nm.QSf(),sf=Xd.a.pc(F.errors),Gf=Xd.a.pc(F.VKa),Yf=0<Xd.a.HT(zi=>!zi.triggerSilentReopenOnly,F.errors).length;let Ng=Ad;const dh=Cb.a.rh(F.activityState,bc.a.mwb);dh&&(Ng=!0);const vg={name:"SessionReloadSilentActivity.GetSilentReloadType"};vg.editMode=sc;vg.isSilentReopenError=Ad;vg.isSilentRefreshError=jd;vg.reloadSequenceCount=
va.Nm.R3a;vg.reloadCount=ye;vg.maxReloads=Ne;vg.stopSilentReloads=hf;vg.errorNames=sf;vg.processedErrorNames=Gf;vg.isClientDirty=Kd;vg.errorsForSilentReopenOnly=Yf;vg.triggerSilentReloadAfterTokenRefresh=dh;vg.IsReopenDisabled=va.A_a;vg.isCollabViewMode=Yc;Ad=We.a.Nc(vg);C.ULS.sendTraceTag(21837004,0,50,Ad);if(!hf){if(Ng&&(sc||Yc?cb.oQk(F):cb.rQk(F)))return qb.a.nUg(F,va)?3:va.A_a?2:1;if(jd&&(sc||Yc||!lb.Frb))return 2}return 0}static zQk(F,va){for(const lb of F.errors)if(-1337545025===lb.MessageId||
-238814601===lb.MessageId)return!1;return Xd.a.HT(lb=>!lb.triggerSilentReopenOnly,F.errors).length?3!==va:!1}static aKj(F){const va=Xd.a.HT(lb=>!lb.triggerSilentReopenOnly,F.errors);for(const lb of va)F.jla(lb)}static isEditMode(F){const va=Object(Pd.a)(190,F.ff);return va.fa.yc?va.ir&&!!(va.$d&64):Cb.a.rh(F.activityState,Ee.a.Mu)}static XHa(F){const va=Object(Pd.a)(190,F.ff);C.ULS.sendTraceTag(507618584,0,50,`SessionReloadSilentActivity.isEditMode: isEditMode [${va.isEditMode}] Edit Mode capabilities [${va.$d&
64}]`);return va.fa.yc?va.fa.XHa:Cb.a.rh(F.activityState,Ee.a.Xmd)}static rQk(F){const va=Object(Pd.a)(190,F.ff);if(Xd.a.mca(F.errors,cb.B4d).some(lb=>lb.ForceVersionUpgrade))return!1;F=Xd.a.GGb(F.errors);return!va.fa.Frb||F?!0:!1}static oQk(F){return!Xd.a.mca(F.errors,cb.A4d).some(va=>va.ForceVersionUpgrade)}}cb.B4d=null;cb.A4d=null;cb.mdg=null;cb.ldg=null;Object(O.a)(cb,"SessionReloadSilentActivity",Ge.a,[]);var zb=a(559);let V=class extends zb.a{constructor(F){super(Object(fa.f)(F))}v1i(F){for(const va of this.rangeList)if(F.range.contains(va))return va;
return null}zfe(F){return F.GridBlockModel&&(F=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(F.GridBlockModel))?F.getSparklineRanges():null}};V=Object(U.__decorate)([Object(Ka.d)(Ba.SparklineManagerService),Object(U.__param)(0,Object(Ba.EwaControlService)())],V);Object(O.a)(V,"SparklineManager",zb.a,[799]);var Ea=a(620),pb=a(193),Jb=a(191);class zc extends Yb.a{constructor(F,va,lb,sc,Yc){super(F);this.d1g=[6];this.Z0g=[26];this.du=null;this.ZUb=this.JIc=!1;this.yw=this.Pja=null;this.onPointerDown=
jd=>{if(1!==this.$.Ia.lN())return!0;jd=this.zoomManager.Qf(jd);if(this.cG)return!0;var Ad=Hd.a(this.$).gXd||Hd.a(this.$).ks();if(this.wZd||Ad)return this.Csb(),!0;this.yw=this.Dp;this.Phe();this.ZRd();Ad=2===jd.Yb&&jd.Dq===Sys.UI.MouseButton.leftButton;const Kd=3===jd.Yb;if(Ad||Kd)jd=this.ha.Ft(jd.clientPoint,jd.sc,5,void 0,void 0,!0),jd||(jd=this.yw),this.ZUb=Ad,this.JIc=Kd,this.yw=this.$Of(jd),this.ZRd(),Ad?this.uok():Kd&&this.opk(),pd.b(this.$,!0);return!0};this.Lm=jd=>{jd=this.zoomManager.Qf(jd);
if(!this.cG)return!1;let Ad=this.ZUb?this.ha.Ft(jd.clientPoint,jd.sc,5,void 0,void 0,!0):this.ha.Ft(jd.clientPoint,jd.sc,5,!0,!1,!0);Ad||(Ad=this.ha.r0(jd.clientPoint,jd.sc,5));Ad&&(jd=this.$Of(this.oHh(Ad)),this.eoc(jd.bottomRight),this.yw.equals(jd)||(this.yw=jd,this.c3b(!1),this.Phe(!1),this.ZRd(!1),this.Hcj(),this.Ub.update(!1)),this.pcl(this.yw));return!0};this.sj=jd=>{this.zoomManager.Qf(jd);if(!this.cG)return!1;this.resizeTable();this.Csb();return!0};this.k0b=jd=>{this.zoomManager.Qf(jd);if(!this.cG)return C.ULS.shipAssertTag(537151233,
0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1;this.resizeTable();this.Csb();return!0};this.Ela=jd=>{this.zoomManager.Qf(jd);this.Csb();return!0};this.Xjg=()=>{this.cG&&this.Csb()};this.da=va;this.zoom=Yc;this.$=va.$;this.je=sc;this.ha=va.ha;this.Ub=va.Ub;this.parentElement=F;this.ORh();wa.a.ot||wa.a.AY||wb.a.instance.va(Wa.a.Sd,this.Pja,this.onPointerDown);this.Dp=lb;this.ydd=this.wZd=!1;this.je.VCh(this.Xjg)}get cG(){return this.ZUb||this.JIc}get t5f(){return this.ydd}dispose(){this.Csb();
this.je.Xrk(this.Xjg);this.t5f||wa.a.ot||wa.a.AY||wb.a.instance.Ua(Wa.a.Sd,this.Pja,this.onPointerDown);if(this.cG){pd.b(this.$,!1);try{this.kA()}catch(F){C.ULS.sendTraceTag(537151236,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${F}`)}}this.parentElement&&this.parentElement.contains(this.Pja)&&this.parentElement.removeChild(this.Pja);this.Pja=this.parentElement=null;super.dispose()}get zoomManager(){return this.zoom.zoomManager}$Of(F){const va=F.bottom-this.Dp.topLeft.bottom-
1;return 0<=F.right-this.Dp.topLeft.right+1&&0<=va&&F.bottom>=this.Dp.top&&F.right>=this.Dp.left?new pc.Range(this.Dp.top,this.Dp.left,F.bottom,F.right,!1,!1):this.yw}ZRd(F){this.GXc([this.yw],6,void 0===F?!0:F);this.Ub.Iq(this.d1g)}c3b(F){F=void 0===F?!0:F;this.Ub.rl(this.d1g);this.GXc([null],6,F)}Phe(F){F=void 0===F?!0:F;this.Ub.rl(this.Z0g);this.GXc([null],26,F)}Hcj(){var F=!1;F=void 0===F?!0:F;const va=this.W2k();0<va.length&&(this.GXc(va,26,F),this.Ub.Iq(this.Z0g))}W2k(){const F=[];this.Dp.contains(this.yw)&&
(this.Dp.right!==this.yw.right&&F.push(new pc.Range(this.Dp.top,this.yw.right+1,this.yw.bottom,this.Dp.right,!1,!1)),this.Dp.bottom!==this.yw.bottom&&F.push(new pc.Range(this.yw.bottom+1,this.Dp.left,this.Dp.bottom,this.Dp.right,!1,!1)));return F}resizeTable(){if(!this.yw.equals(this.Dp)){const F=new pc.Range(this.Dp.top,this.Dp.left,this.yw.bottom,this.yw.right,!1,!1);this.x8k(F);this.wZd=!0}}onKeyDown(F){this.zoomManager.Qf(F);return!0}s9d(){this.t5f&&(wa.a.ot||wa.a.AY||(wb.a.instance.va(Wa.a.Sd,
this.Pja,this.onPointerDown),this.Pja.classList.remove("ewr-table-resize-default-cursor"),this.ydd=this.Pja.disabled=!1),this.ydd=!1)}ORh(){const F=document.createElement("div");F.className="ewr-table-resize-handle";const va=document.createElement("div");va.className="ewr-table-resize-fillhandle-higher";const lb=document.createElement("div");lb.className="ewr-table-resize-fillhandle-broader";F.appendChild(va);F.appendChild(lb);this.Pja=F;this.parentElement.appendChild(this.Pja)}eoc(F){let va=60;const lb=
this.yw.contains(F);let sc=F.top,Yc=F.bottom,jd=F.left,Ad=F.right,Kd=null;if(lb){if(this.da.Iy(this.Dp.topLeft)&&!this.Dp.g6a)return;F.bottom<this.yw.bottom?(sc=Math.max(1,Yc-2,this.Dp.top),va=16):(jd=Math.max(1,Ad-2,this.Dp.left),va=4);Yc=sc;Ad=jd;Kd=new pc.Range(sc,jd,sc,jd,!1,!1)}else F.right>=this.Dp.right?(Ad+=2,va=8):F.bottom>=this.Dp.bottom&&(Yc+=2,va=32),sc=Yc,jd=Ad,Kd=new pc.Range(Yc,Ad,Yc,Ad,!1,!1),va=16;this.da.Iy(Kd)||(this.du?this.du.en||(this.du=Te.a.instance.create(()=>{this.da.Ix(Kd,
va,"TableResizeBehavior.BringRangeIntoView")},40,Wf.a.b1g)):this.du=Te.a.instance.create(()=>{this.da.Ix(Kd,va,"TableResizeBehavior.BringRangeIntoView")},40,Wf.a.b1g))}oHh(F){let va=F;if(this.da.rb.gr){if(!this.da.Ob(F.topLeft)){const lb=this.da.Np("TableResizeBehavior.AdjustHiddenRowColumns",this.da.uja,this.yw.top!==F.top?1:2);try{lb.Gm=this.yw.top<F.top||this.yw.left<F.left,lb.kG(F.topLeft),va=lb.$$cu().range}finally{lb&&lb.dispose()}}va.right=va.left+F.width-1;va.bottom=va.top+F.height-1}return va}GXc(F,
va,lb){lb=void 0===lb?!0:lb;const sc=[];for(const Yc of F)sc.push(new He.a(Yc,nf.d(this.$.la)));this.Ub.HL(sc,[va],!0,void 0,lb)}uok(){wb.a.instance.va(Wa.a.At,document.documentElement,this.Lm);for(const F of this.da.$p)wb.a.instance.va(Wa.a.At,F.domElement,this.Lm);wb.a.instance.va(Wa.a.Lj,document.documentElement,this.sj);this.mpf()}opk(){Fa.a.instance.va(Wa.a.Ai,document.documentElement,this.Lm);for(const F of this.da.$p)Fa.a.instance.va(Wa.a.Ai,F.domElement,this.Lm);Fa.a.instance.va(Wa.a.If,document.documentElement,
this.k0b);this.mpf()}kA(){this.ZUb&&this.zal();this.JIc&&this.Kal()}zal(){wb.a.instance.Ua(Wa.a.At,document.documentElement,this.Lm);for(const F of this.da.$p)wb.a.instance.Ua(Wa.a.At,F.domElement,this.Lm);wb.a.instance.Ua(Wa.a.Lj,document.documentElement,this.sj);this.eEg()}Kal(){Fa.a.instance.Ua(Wa.a.Ai,document.documentElement,this.Lm);for(const F of this.da.$p)Fa.a.instance.Ua(Wa.a.Ai,F.domElement,this.Lm);Fa.a.instance.Ua(Wa.a.If,document.documentElement,this.k0b);this.eEg()}mpf(){this.da.cellTextEditBox.wgb(!0)}eEg(){this.da.cellTextEditBox.wgb(!1)}x8k(F){this.$.Dc(-1400250766,
jc.a.Hb,30,{["ResizeTableRange"]:F,["OriginalTableRange"]:this.Dp})}pcl(F){if(!this.Dp.contains(F)){F=this.V2k();for(const va of F)if(this.je.ZZd(va)){this.da.$h.Jt(S.a.iQj);return}}this.da.rtl?this.da.$h.Jt(S.a.jPj):this.da.$h.Jt(S.a.IRj)}Csb(){if(this.cG){pd.b(this.$,!1);try{this.kA()}catch(F){C.ULS.sendTraceTag(537151232,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${F}`)}}this.du&&(this.du.cancel(),this.du.dispose());this.JIc=this.ZUb=!1;this.c3b();this.Phe();
pd.b(this.$,!1);this.da.$h.Jt(S.a.I7)}V2k(){const F=[];this.Dp.right!==this.yw.right&&F.push(new pc.Range(this.Dp.top,this.Dp.right+1,this.yw.bottom,this.yw.right,!1,!1));this.Dp.bottom!==this.yw.bottom&&F.push(new pc.Range(this.Dp.bottom+1,this.Dp.left,this.yw.bottom,this.Dp.right,!1,!1));return F}static createInstance(F,va,lb,sc,Yc){if(!va)return null;const jd=F.Ub;jd.HL(lb,[27],!0);jd.Iq(zc.Q2k);lb=jd.sQ(27,F.rb.Yh(va.bottomRight),zc.jPi(va,lb)).Gf;return new zc(lb,F,va,sc,Yc)}static jPi(F,va){var lb;
for(let sc=0;sc<va.length;sc++)if((null===(lb=va[sc])||void 0===lb?0:lb.range)&&va[sc].range.equals(F))return sc;return 0}}zc.Q2k=[27];Object(O.a)(zc,"TableResizeBehavior",Yb.a,[]);class Mc{}Mc.bti="ewa-ttrd-buttonarea";Mc.gyf="ewr-cell-selection-highlight-all";Mc.TVa="ewr-grdcontarea-ltr";Mc.kNb="ewr-grdcontarea-rtl";Mc.gzf="ewr-table-resize-handle";Mc.selecting="Selecting";Object(O.a)(Mc,"TableClassNames",null,[]);var od=a(49),Td=a(150),Zd=a(151),xe=a(328);class pe extends Db.a{constructor(F,va){super(document.createElement("div"));
this.Gmd=this.$Vd=this.awg=this.qY=!1;this.Bne=null;this.j_d=!1;this.onActiveCellChanged=()=>{Qd.d(this.$,this.da.ha.oa.activeCell)?(this.cZa=!0,this.aKb(!1)):(this.d8=this.cZa=!1,this.F6g())};this.yt=()=>{this.cZa?this.aKb(!0):this.d8=!1};this.YJa=()=>{this.Gmd=!0;this.cZa&&(this.d8=!1)};this.onContentReady=()=>{this.$.isEditMode?Qd.d(this.$,this.da.ha.oa.activeCell)&&(this.cZa=!0,this.aKb(!1)):this.d8=!1};this.XJa=()=>{this.Gmd=!1;this.cZa?this.aKb(!1):this.d8=!1};this.onBlockCacheItemChanged=(lb,
sc)=>{this.cZa&&(lb=this.da.E2a(sc.he.block.We.BlockCachePosition.PaneType).fJ(sc.he.hash))&&(lb.ije(this.oTf),lb.ipd(this.oTf))};this.oTf=()=>{this.sIg()};this.$=F;this.zoom=va;this.da=fa.f(this.$);this.parentElement=this.domElement;this.parentElement.className=Mc.bti;this.YXa=this.da.nh;this.tHd=oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7603637_LocalizeSubtotalOfTotalRow");this.j_d=oa.EwaSettings.isChangeGateEnabled("OfficeVSO:8842054_TotalTableRowOptionsButtonRenderingBugFix");this.cZa=!0;
this.Lhj();this.tHd&&this.nfj();this.RLh();this.aKb(!1);C.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ")}get zoomManager(){return this.zoom.zoomManager}get d8(){return this.$Vd}set d8(F){this.$Vd!==F&&(this.$Vd=this.isVisible=F)}get jWb(){return!!(this.$.$d&16)}get Ksj(){const F=this.da.ha.oa.activeCell;return F.right===F.maxColumns}get KEb(){const F=this.da.Ob(null);return F&&this.da.q8(F.range)?this.Ica(F):(F&&C.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),
null)}dispose(){this.$&&this.Kfi();this.$=this.da=this.parentElement=this.YXa=null;super.dispose()}BMi(F){const va=this.D3i(this.da.Ob(null).range);return va?this.tHd?`=${this.nOf()}(${F}${this.$.listSeparator}${va})`:`=SUBTOTAL(${F},${va})`:null}nOf(){var F,va,lb;return null!==(lb=null===(va=null===(F=this.Yd)||void 0===F?void 0:F.localeInfo)||void 0===va?void 0:va.getWorksheetFuncName(344))&&void 0!==lb?lb:"SUBTOTAL"}D3i(F){var va=fa.f(this.$).Eb.dg(F);if(!va)return null;va=Jb.a(va,!1);va.right=
va.left=F.left;return va.toString()}Lhj(){pe.AP={};pe.AP["100"]=Ha.a.instance.ia(1105);pe.AP["101"]=Ha.a.instance.ia(1108);pe.AP["102"]=Ha.a.instance.ia(1107);pe.AP["103"]=Ha.a.instance.ia(1112);pe.AP["104"]=Ha.a.instance.ia(1109);pe.AP["105"]=Ha.a.instance.ia(1110);pe.AP["109"]=Ha.a.instance.ia(1106);pe.AP["107"]=Ha.a.instance.ia(1113);pe.AP["110"]=Ha.a.instance.ia(1115);pe.AP["111"]=Ha.a.instance.ia(1166)}nfj(){void Ka.a.resolve(Ba.CalcManagerService).then(F=>this.Yd=F)}v$j(){var F=this.da.Ob(null);
if(F&&(F=F.Jx?F.formulaBarText:null))if(this.tHd){const va="="+this.nOf()+"(",lb=va.length;if(F.toUpperCase().startsWith(va)){if(F=F.substring(lb,lb+3),F in pe.AP)return F}else return"111"}else if("=SUBTOTAL("===F.substring(0,10)){if(F=F.substring(10,13),F in pe.AP)return F}else return"111";return"100"}RLh(){this.da.za.$t(this.onBlockCacheItemChanged);this.da.ha.add_activeCellChanged(this.onActiveCellChanged);this.da.aw(this.onContentReady);this.da.cellTextEditBox.Jp(this.YJa);this.da.cellTextEditBox.Uq(this.XJa)}Kfi(){this.da&&
(this.da.ha&&(this.da.ha.remove_activeCellChanged(this.onActiveCellChanged),this.da.za.yu(this.onBlockCacheItemChanged)),this.da.Zz(this.onContentReady),this.da.cellTextEditBox&&(this.da.cellTextEditBox.zp(this.YJa),this.da.cellTextEditBox.gq(this.XJa)),this.F6g())}aKb(F){this.Ecl(F);this.jWb&&(this.x1k(),this.KEb?(this.awg||this.bMh(),this.Gmd?this.d8=!1:(this.d8=!0,this.sIg())):(C.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),
this.d8=!1))}sIg(){appChrome.renderTableTotalRowOptions(this.parentElement,pe.AP,pe.AP[this.v$j()].toString(),Math.round(this.zoomManager.sh(17)),F=>{C.ULS.sendTraceTag(537151198,0,50,`TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : ${F}`);const va={["SelectedOption"]:pe.AP[F],["FunctionKeyCode"]:F,["Location"]:"canvas"};Zd.b(this.$).Jd(Td.a.$2k,va,null,!0);if("111"===F)return this.mlj(),!0;if("100"!==F){this.Bne=this.BMi(F);if(!this.Bne)return C.ULS.sendTraceTag(537151197,0,
50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),!0;this.h5a(this.Bne)}else this.h5a("");ea.DOMElementExtensions.setFocus(this.da.Rb.Za.domElement);return!0})}mlj(){C.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");const F=new Sb.a(753860909,0,this.$.isEditMode?2:1,19,null);this.$.Ia.Gb(F)}Ica(F){if(!F)return null;var va=this.da.cellTextEditBox.Za.domElement;var lb=0<ea.DOMElementExtensions.getHeight(va)&&
0<ea.DOMElementExtensions.getWidth(va)&&0<=va.offsetTop&&0<=va.offsetLeft;if(lb&&!this.j_d)va=ea.DOMElementExtensions.Ica({nq:va,parentElement:this.da.nh});else{va=this.da.getCellBounds(F.cell);var sc=ea.DOMElementExtensions.getBoundingClientRect({element:this.da.nh,di:!0});va=new Sys.UI.Bounds(va.x-sc.x,va.y-sc.y,va.width,va.height)}if(va)if(lb&&!this.j_d)2<va.height&&2<va.height&&(va.x+=1,va.y+=1,va.height-=2,va.width-=2);else if(lb=fa.f(this.$).qQ(F.cell))lb=lb.width,sc=Oa.a.equals(Za.a.rPb(F.cell,
this.da.rtl),"right",!0),this.da.rtl&&sc&&(va.x=va.x+va.width-lb),F.sva&&this.da.rtl===sc&&(va.width=lb);else return null;return va}Ecl(F){var va=this.KEb;if(va){var lb=17>=va.height?va.y:va.y+va.height-17-2;va=this.Ksj?this.da.rtl?va.x:va.x+va.width-(17<va.height?17:va.height):this.da.rtl?va.x-(17<va.height?17:va.height):va.x+va.width;var sc=this.zoomManager.B7(new Sys.UI.Point(va,lb));this.parentElement.style.top=$c.HelperMethods.$c(sc.y);this.parentElement.style.left=$c.HelperMethods.$c(sc.x);
this.zoomManager.wLk(this.parentElement);F&&(this.d8=this.da.YIc(new od.a(va,lb)))}else this.d8=!1}bMh(){this.YXa.insertBefore(this.parentElement,this.YXa.firstChild);this.awg=!0}x1k(){this.qY||(this.da.view.Ks(this.yt),this.qY=!0)}F6g(){this.qY&&this.da.view&&(this.da.view.xs(this.yt),this.qY=!1)}h5a(F){const va=this.da.Rb,lb=this.da.Ob(null);lb&&(F=Object(oc.a)(new xe.a,{Text:F}),this.da.setCell(F,lb.range,0,127,null),va.endEdit(!0,"TableTotalRowOptions.SetCellContent",0))}}pe.Z2k="TableTotalRowDropDownIconButtonId";
pe.AP=null;Object(O.a)(pe,"TableTotalRowOptions",Db.a,[4]);var Re=a(1362);let pf=class extends zb.a{constructor(F,va){super(fa.f(F));this.$Hb=this.h$=this.s0c=this.YHb=null;this.e7e=!1;this.yQe=null;this.Ucc=0;this.Csc=null;this.vnc=()=>{const lb={},sc=this.PNd();for(const jd in sc){const Ad=sc[jd];if(!Ad)continue;const Kd=this.y2i(Ad);if(Kd){if(Kd in this.XRa){var Yc=this.XRa[Kd];if(Yc.cG){Yc.Dp.equals(Ad)||(Yc.Dp=Ad);delete this.XRa[Kd];lb[Kd]=Yc;continue}}(Yc=zc.createInstance(fa.f(this.$),Ad,
this.jJi(),this,this.zoom))?lb[Kd]=Yc:C.ULS.sendTraceTag(537151239,0,15,`TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range ${Ad.Gz(!1)}`)}}this.Hpc(null,null);this.qbc=lb};this.Hpc=()=>{const lb=this.XRa;for(const jd in lb){var sc=jd,Yc=lb[jd];Yc&&(Yc.dispose(),delete this.XRa[sc])}this.qbc={}};this.zCg=()=>{this.Hpc(null,null);this.vnc(null,null)};this.onFocus=()=>{this.yQe=fa.f(this.$).ha.oa.activeCell};this.vv=()=>{if(this.$.isEditMode)this.onActiveCellChanged(null,null)};
this.onActiveCellChanged=()=>{!this.e7e&&Qd.d(this.$,this.da.ha.oa.activeCell)&&this.xDj()};this.qm=()=>{this.KSb(1)};this.p1b=()=>{this.e7e=!0;this.s0c=new pe(this.$,this.zoom)};this.$=F;this.zoom=va;this.da=fa.f(this.$);this.qbc={};this.vnc(null,null);this.$.qa&&this.$.qa.mh(this.zCg);this.Tod(this.vnc);this.$.fa.CD(this.vv);this.da.ha.add_activeCellChanged(this.onActiveCellChanged);if(this.$.isEditMode)this.onActiveCellChanged(null,null)}Tod(F){this.addHandler(zb.a.m2b,F)}Yie(F){this.removeHandler(zb.a.m2b,
F)}VCh(F){this.addHandler("tce",F)}Xrk(F){this.removeHandler("tce",F)}get XRa(){return this.qbc}get y0d(){return this.yQe}get SUa(){return this.Ucc}get Vs(){const F=fa.f(this.$);return F.Eb.dg(F.ha.oa.activeCell,!1)}get gee(){return this.y0d?fa.f(this.$).Eb.dg(this.y0d,!1):null}ZZd(F){return!!this.TLf(F)}jt(F){return this.nZi(this.DMf(F))}WOb(F){return this.DMf(F)}lpk(F){F?(this.$Hb?this.$Hb!==F&&(Ob.a.vb(this.h$),this.h$=null,this.$Hb=F):this.$Hb=F,this.h$||(this.h$=jb.a.instance.pf(this.$Hb)),this.h$.Vp("focusin")||
this.h$.Ea("focusin",this.onFocus)):C.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement received")}d1f(F,va){return F?F.eua&&F.top===va.top:(C.ULS.shipAssertTag(537151244,0,!!F,"autofilterRange can't be null"),!1)}Ita(F){F=this.YHb?gc.P(F,this.YHb):this.view.getRangeInformation(F);return 0<F.length&&Object(Wc.a)(qd.PivotTableRange,F[0])?F[0]:null}Qnj(F,va){return F?!F.HFc&&!!F.OD&&F.OD.ld(va):(C.ULS.shipAssertTag(537151243,0,!!F,"Pivot table can't be null"),
!1)}awj(F,va){return F?!F.HFc&&!!F.CG&&F.CG.ld(va):(C.ULS.shipAssertTag(537151242,0,!!F,"Pivot table can't be null"),!1)}Zkc(F){super.Zkc(F);if((F=$c.HelperMethods.eMf(F))&&0<F.length){this.YHb=Array(F.length);for(let va=0;va<F.length;va++)this.YHb[va]=pb.a.sC(F[va])}}W2b(){super.W2b();this.YHb=null}X4h(F,va){let lb;lb=!1;if(!F||!va)return{returnValue:!1,q6:lb};F=F.clone();F.right+=1;F.left=F.right;if(!F.Aw)return{returnValue:!1,q6:lb};if(F.top<va.rb.Gg){const sc=F.clone();sc.bottom>=va.rb.Gg&&(sc.bottom=
va.rb.Gg-1);if(!(()=>{let Yc=this.djf(sc,va);({q6:lb}=Yc);return Yc})().returnValue)return{returnValue:!1,q6:lb}}if(F.bottom>=va.rb.Gg){const sc=F.clone();sc.top<=va.rb.Gg&&(sc.top=va.rb.Gg);if(!(()=>{let Yc=this.djf(sc,va);({q6:lb}=Yc);return Yc})().returnValue)return{returnValue:!1,q6:lb}}return{returnValue:!0,q6:lb}}c1g(F){(F=this.jt(F.topLeft))&&F.toString()in this.XRa&&(this.XRa[F.toString()].wZd=!1)}pik(){this.raiseEvent("tce")}Ok(F,va){if(!this.s0c)return!1;switch(va){case -569786022:case 541421805:if(this.s0c.d8){const lb=
document.getElementById(pe.Z2k);lb&&Te.a.instance.create(()=>{ea.DOMElementExtensions.vEc(lb,null)},0,Wf.a.S2k,!0,!0)}return!0;default:return!1}}dispose(){this.Hpc(null,null);this.Yie(this.vnc);this.$.qa.xh(this.zCg);this.$.ro(this.Hpc);this.qbc=null;this.$.fa&&this.$.fa.xB(this.vv);this.da.ha.remove_activeCellChanged(this.onActiveCellChanged);this.s0c=null;this.h$&&(Ob.a.vb(this.h$),this.h$=null);super.dispose()}G$i(F,va,lb,sc){var Yc=this.da.Eb.dg(new pc.Range(va,lb,va,lb,!1,!1));if(this.Csc=Yc){var jd=
Yc.usedRange,Ad=F.ctrlKey||wa.a.isMac&&kc.b(F);Yc=!F.shiftKey&&Ad;F=F.shiftKey&&!Ad;fa.f(this.$).ha.selectionType=3;switch(sc){case 0:this.Ucc=0;va=this.Kzd(F,jd.top,lb,jd.bottom,lb);this.Ope(va,Yc,F);break;case 1:this.Ucc=1;va=this.Kzd(F,va,jd.left,va,jd.right);this.Ope(va,Yc,F);break;case 2:this.Ucc=2;va=this.Kzd(F,jd.top,jd.left,jd.bottom,jd.right);this.Ope(va,Yc,F);break;default:C.ULS.shipAssertTag(537151240,0,!1,`TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: ${sc.toString()}`);
return}fa.f(this.$).ha.selectionType=3;C.ULS.sendTraceTag(527212953,0,50,"TableManager.handleTableSelectorsSelection: A table selector was clicked using hover arrows")}else C.ULS.shipAssertTag(537151241,0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")}MQk(F){const va=this.Csc.usedRange;return this.G3f(F)||1!==this.SUa&&this.G3f(new pc.Range(va.top,F.left,va.bottom,F.right,!1,!1))?!0:!1}zfe(F){return F.Autofilters}djf(F,va){let lb;lb=!1;const sc=
va.rb.Yh(F),Yc=va.pg(sc).Ek;if(!Yc)return C.ULS.sendTraceTag(537151238,0,15,`TableManager.CouldExpandImpl - loadedRange is null. PaneType=${sc}`),{returnValue:!1,q6:lb};if(!Yc.Xe(F))return{returnValue:!0,q6:lb};F=va.Np("TableManager.CouldExpandImpl",F,2);try{for(;F.$$mn();){if(F.$$cu().text||F.Go.jYa)return lb=!0,{returnValue:!1,q6:lb};if(F.$$cu().AC)return{returnValue:!1,q6:lb}}}finally{F&&F.dispose()}return{returnValue:!0,q6:lb}}nZi(F){if(!F)return null;const va=new Ea.AutofilterRange(F.top,F.left,
F.bottom,F.right,null,null,null,F.id,F.eua);va.g6a=F.g6a;const lb=this.da.Eb.dg(F,!0);if(!lb)return null;for(let sc=0,Yc=this.rangeList.length;sc<Yc;sc++){const jd=this.rangeList[sc],Ad=this.da.Eb.dg(jd,!0);Ad&&Ad.name===lb.name&&jd!==F&&this.gvj(jd)&&(va.union(jd),jd.g6a&&(va.g6a=!0))}return va}gvj(F){return!!fa.f(this.$).Eb.dg(F)}jJi(){const F=[];for(const va of this.rangeList){const lb=new He.a(this.jt(va.topLeft),nf.d(this.$.la));F.push(lb)}return F}PNd(){const F={};for(const va of this.rangeList){if(!va)continue;
const lb=this.jt(va.topLeft);lb&&(F[lb.toString()]=this.jt(va.topLeft))}return F}xDj(){this.$.fa.io?this.KSb(0):this.$.fa.Yv(this.qm)}KSb(F){this.$.kY(va=>{va.O1(F).then(this.p1b)})}y2i(F){const va=this.da.Eb.dg(F);return va?va.name:F.toString()}Ope(F,va,lb){F&&(lb=lb?fa.f(this.$).ha.oa.activeCell:F.topLeft,va?this.da.ha.updateSelection(F,lb,0,1):this.da.ha.VI([F],0,lb,0))}Kzd(F,va,lb,sc,Yc){const jd=Jb.d(this.Csc),Ad=Jb.g(this.Csc),Kd=va+(1!==this.SUa&&jd?1:0),ye=sc-(1!==this.SUa&&Ad?1:0),Ne=this.da.inRangePicker||
this.da.nk;if(F){var hf=Ne&&!He.a.Vrc(this.da.ha.rangePicker.jV).length?new pc.Range(Kd,lb,ye,Yc,!1,!1):Ne?this.da.ha.rangePicker.activeCell:this.da.ha.oa.activeCell;hf=new pc.Range(hf.top<Kd?hf.top:Kd,hf.left<lb?hf.left:lb,hf.bottom>ye?hf.bottom:ye,hf.right>Yc?hf.right:Yc,!1,!1)}else hf=new pc.Range(Kd,lb,ye,Yc,!1,!1);if(1!==this.SUa&&(jd||Ad)&&(!F||F&&this.cxd(hf,Kd,lb,ye,Yc))){F=Ne?He.a.Vrc(this.da.ha.rangePicker.jV):this.da.ha.oa.selectedRanges;for(const sf of F)if(this.cxd(sf,Kd,lb,ye,Yc)){hf.top=
va;hf.bottom=sc;break}}return hf}G3f(F){const va=this.da.inRangePicker||this.da.nk?He.a.Vrc(this.da.ha.rangePicker.jV):this.da.ha.oa.selectedRanges;for(const lb of va)if(this.cxd(lb,F.top,F.left,F.bottom,F.right))return!0;return!1}cxd(F,va,lb,sc,Yc){return!!F&&F.top===va&&F.bottom===sc&&F.left===lb&&F.right===Yc}};pf=Object(U.__decorate)([Object(Ka.d)(Ba.TableManagerService),Object(U.__param)(0,Object(Ba.EwaControlService)()),Object(U.__param)(1,Object(Ba.ZoomService)())],pf);Object(O.a)(pf,"TableManager",
zb.a,[796,4]);String(Re);window.___1717508035901_closurehack=Re;var vf=a(786),Qf=a(658),yf=a(1365);class Df extends Nb.a{constructor(F,va){va=void 0===va?!0:va;super(!1,!1,!0);this.bab=null;this.YLe=!1;this.Rq=[];this.wk=null;this.BYj=lb=>{this.Xth&&(this.wk=this.TSg(lb,this.yjc))};this.Y6j=()=>{this.wk&&this.wk.uK&&(this.YLe||(this.wk.Aok(this.y9d),this.YLe=!0),this.wk.WAf())};this.y9d=lb=>{this.bab.uploadStatusLabel=lb;this.BNa(this.titleText,this.VTd,this.bab)};this.VTd=lb=>{1===lb&&this.isEnabled()?
this.wk.uK&&!this.wk.uK.value?(this.bab.uploadStatusLabel=Object(ad.a)("FileUploadNoFileSpecified"),this.BNa(this.titleText,this.VTd,this.bab)):(this.Pjb(),this.yjc.finalizeUpload(this.wk,this.dispose)):0===lb&&this.hide()};this.Cae=()=>{this.Yzg()};this.onKeyDown=lb=>{4!==Bc.FocusManager.instance().bAg(lb)&&lb.preventDefault()};this.yjc=F;this.Xth=va;this.uD=this.AZe=!1;this.Opa=null;this.uf="InsertFileDialog";this.Ic(1,this.actionButtonText);this.bab={["id"]:this.uf,["bodyControls"]:{["uploadButtonProps"]:{["label"]:Object(ad.a)("DialogChooseFile"),
["onExecute"]:this.Y6j}},["uploadStatusLabel"]:Object(ad.a)("DialogNoFileChosen"),["onFrameReady"]:this.BYj};this.initializeAndShow(this.titleText,this.VTd,this.bab);this.a$c=!0}get zgl(){return this.yjc}tNk(){this.WLe=!1;this.wk=this.TSg(document.getElementById("uploadFrameContainer"),this.yjc);hb.AFrameworkApplication.ea.ka("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.Opa=this.Cae,ec.a.addHandler(this.wk.ySd,"load",this.Opa));this.wk.uK||C.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");
this.Yzg()}Yzg(){if(this.wk&&!this.WLe){var F=this.wk.uK;F&&(ec.a.addHandler(F,Wa.a.nd,this.onKeyDown),F=[F],this.Rq=F.concat.apply(F,this.Rq),this.Qdl(),this.WLe=!0)}}dispose(){if(this.wk){const F=this.wk.uK;F&&ec.a.removeHandler(F,Wa.a.nd,this.onKeyDown);this.Opa&&ec.a.removeHandler(this.wk.ySd,"load",this.Opa)}this.wk=null;super.dispose()}Qdl(){if(0<this.Rq.length){const F=new yf.a(this.Rq),va=Bc.FocusManager.instance().fY();va&&(this.Rq[0].focus(),va.Li=F,va.Lda=!0)}}static JG(F){const va=document.getElementById("errorText");
va.innerText=F;va.style.display="inline-block"}}Object(O.a)(Df,"InsertFileDialog",Nb.a,[]);class pg{static get wj(){return Nb.a.qw(pg.rq,Object(ad.a)("ImageUploadDialogText"),Object(ad.a)("ImageUploadNoFileSpecified"))}}pg.rq="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";Object(O.a)(pg,
"InsertImageDialogHtml",null,[]);class Zf extends Df{constructor(F,va){super(F,void 0===va?!0:va)}get actionButtonText(){return Object(ad.a)("ImageUploadButtonText")}get titleText(){return Object(ad.a)("ImageUploadingTitle")}validate(){this.wk.uK||C.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var F=Object(Pd.a)(Wd,this.zgl);const va=F.r$g(this.wk.uK.value);return 0!==va?(F=F.pIf(va),Df.JG(F),!1):!0}}Object(O.a)(Zf,"InsertImageDialog",Df,[]);var Tg=a(875),Wg=a(141),ph=
a(1623);class Ug extends ph.a{constructor(F,va,lb,sc,Yc,jd,Ad,Kd){Kd=void 0===Kd?!1:Kd;super(F,va,lb,sc,Yc,"UploadFrame",jd.fa.sessionId,"image/*",!1,null,void 0===Ad?!1:Ad);this.$=jd;this.H9g=!0;this.qnj=Kd;this.JTd()}ia(F){return F}OPg(F){C.ULS.shipAssertTag(526399105,0,!!this.sessionId,"SessionId shouldn't be null.");Fc.a.lqd(F,this.$.ta);F.Oaa(ic.a.sessionId,this.sessionId);var va=fa.f(this.$).ha;va=gc.r(va.oa.u7,this.$);F.Oaa(ic.a.LAg,this.$.qa.la.name);F.Oaa(ic.a.hhk,va.FirstRow.toString());
F.Oaa(ic.a.ghk,va.FirstColumn.toString());F.Oaa(ic.a.Yjj,this.qnj.toString())}gSf(){this.NKg("ServerUploadError")}t2a(F){this.NKg(F)}static bqj(F){return!F||Oa.a.equals(F,"ServerUploadError",!1)}}Object(O.a)(Ug,"UploadFrameWrapper",ph.a,[]);class fh extends Zf{constructor(F,va,lb,sc){super(F,!1);this.ysa=null;this.WMa=!1;this.Mc=null;this.INc=()=>{this.Pze("");this.k2c();return!1};this.$=va;this.G3c=F;this.uY=Tg.a.instance;this.ea=lb;this.Mc=sc;this.tNk();this.khj();this.$.Mb.DC=!0}TSg(F,va){return new Ug(F,
Object(Wg.a)(va,va.s2a,"onUploadFrameInitialized"),Object(Wg.a)(va,va.Wfa,"uploadResponseReceived"),this.ea,!0,this.$)}dispose(){this.k2c();this.uY=this.G3c=null;super.dispose()}hide(){super.hide();this.$.Mb.DC=!1}validate(){var F=this.G3c.Y$b(this.wk.uK.value,this.G3c.L4g(this.wk));return 0!==F?(F=this.G3c.fLd(F).Description,this.Pze(F),this.Bve(),!1):!0}isEnabled(){return!0}Pze(F){var va;null===(va=this.Mc)||void 0===va?void 0:va.LQg(this.ysa,F)}khj(){this.ysa=document.getElementById("errorText");
this.ysa.style.display="inline-block";this.WMa=!1;this.Pze("");this.Pfb.style.maxWidth=this.Pfb.currentStyle.minWidth}Bve(){this.uY.va(Wa.a.click,this.wk.uK,this.INc);this.uY.va(Wa.a.nd,this.wk.uK,this.INc);this.WMa=!0}k2c(){this.WMa&&(this.uY.Ua(Wa.a.click,this.wk.uK,this.INc),this.uY.Ua(Wa.a.nd,this.wk.uK,this.INc),this.WMa=!1)}}Object(O.a)(fh,"InsertImageDialogWrapper",Zf,[]);var rg=a(59);class jh extends Wd{constructor(F,va,lb,sc,Yc){Yc=void 0===Yc?!0:Yc;super(null,va,lb);this.Jsa=this.PL=null;
this.bVd=this.xmb=!1;this.wce=null;this.Wfa=jd=>{this.oCe.stop();this.pnc.cancel();if(Ug.bqj(jd))this.J4?this.TQf(4):(jd=new vf.a(0,2,null,null,!1,null,null,null),jd.status=8,this.kye(new Qf.a(jd),null,"InsertPictureWebMethod")),C.ULS.sendTraceTag(526399121,0,50,`Http Error occurred, isTimeoutError: ${this.J4}`);else{const Ad=jh.Oil(jd);0!==Ad?(C.ULS.sendTraceTag(526399122,0,50,`Server returned error, response: ${jd}`),this.TQf(Ad)):this.z$i(jd)}this.m0b();this.dispose()};this.HXj=jd=>{this.Sna(jd,
this.wk)&&this.finalizeUpload(this.wk,null)};this.s2a=jd=>{C.ULS.sendTraceTag(526399120,0,50,"Upload frame initialized");this.wk=jd;if(!this.JEa){if(this.J3c){if(this.bcf()||this.s1a&&wa.a.lE){jd.SLb(this.HXj);return}const Ad=jd.SLb(null);if(!this.Sna(Ad,jd))return}this.finalizeUpload(jd,null)}};this.z6j=()=>{this.J4=!0};this.Qb=F;this.oCe=F.Vb.Pg("WebServiceCall","InsertPictureOperation");this.pnc=Te.a.instance.create(this.z6j,1E5,Wf.a.CNh,!1);this.J4=!1;this.CLc=this.$.ta.InsertPictureMaxFileSizeBytes;
sc&&(this.xmb="TestOnly"in sc);sc&&(this.bVd="IsCellPicture"in sc);Yc&&this.showDialog()}get $(){return this.Qb}get mKj(){return this.CLc/1024/1024}dispose(){Ob.a.vb(this.pnc);this.wk&&this.wk.o2e();this.wk=this.pnc=this.Qb=null}Vkk(F){if(!this.$)return C.ULS.sendTraceTag(526399119,0,50,"ReadPictureAsDataURLTask: EwaControl is null"),ia.Task.Va(!0);if(!this.$.oda)return ia.Task.Va(!0);const va=new Mf.a,lb=new FileReader;F=F.uK.files[0];const sc=()=>{va.jA(!0)};lb.onload=()=>{this.wce=lb.result;va.jA(!0)};
lb.onerror=sc;lb.onabort=sc;lb.readAsDataURL(F);return va.task}L4g(F){let va=-1;F=F.uK;(null===F||void 0===F?0:F.files)&&0<F.files.length&&(va=F.files[0].size);return va}Y$b(F,va){let lb=jh.u4h(Wd.Sna(F));0===lb?-1!==va&&(C.ULS.sendTraceTag(526399118,0,50,`Validating picture, pictureSize: ${va}, maxAllowedSize: ${this.CLc}, remainingWorkbookSize: ${this.$.fa.n8f}`),va>this.CLc?lb=3:va>this.$.fa.n8f&&(lb=7)):6===lb&&this.KHj(F);C.ULS.sendTraceTag(526399117,0,50,`Validated file on client, validation result: ${lb}`);
return lb}Sna(F,va){F=this.Y$b(F,this.L4g(va));return 0!==F?(this.JEa||(oa.EwaSettings.isChangeGateEnabled("OfficeVSO:8882591_InsertPictureUnsupportedFormateErrorDialogToToastFix")&&6===F?this.JVk():1!==F&&this.fte(F)),!1):!0}JVk(){var F=Ha.a.instance.ia(1762);F=$b.a.Xv.KC.QP(F,!1);F.image=2;$b.a.Xv.KC.pz(F)}V3g(F){F.u1k()}fLd(F){let va=0,lb=1,sc=-1100324317,Yc="InsertPictureUnknownError",jd=null;switch(F){case 1:va=1758;lb=0;sc=940870981;Yc="InsertPictureNoFileSelected";break;case 3:lb=0;sc=1250467391;
Yc="InsertPicturePictureTooBig";jd=String.format(Ha.a.instance.Ib(181),this.mKj.toLocaleString());break;case 6:va=1762;lb=0;sc=1380041209;Yc="InsertPictureUnsupportedFormat";break;case 7:va=1759;lb=0;sc=-903115058;Yc="InsertPictureExceedWorkbookSize";break;case 4:va=1760;lb=0;sc=1218352119;Yc="InsertPictureUploadTimeout";break;case 5:va=1761,lb=0,sc=1979899005,Yc="InsertPictureServiceNonDeterministicError"}F=jh.Cd(va,lb,sc,Yc);jd&&(F.Description=jd);return F}showDialog(){if(this.bcf())this.JEa=!1,
this.wk=new Ug(this.$.domElement,this.s2a,this.Wfa,this.ea,!1,this.$,!0,this.bVd);else if(C.ULS.sendTraceTag(526399115,0,50,"Showing Insert Picture dialog"),!this.xmb&&wa.a.lE&&72>wa.a.wef)this.JEa=!1,this.wk=new Ug(this.$.domElement,this.s2a,this.Wfa,this.ea,!1,this.$);else{this.JEa=!0;const F=Object(Zb.d)(Ka.a.resolve(Ba.HtmlSanitizationHelperService,{xa:0}));fb.TaskExtensions.tb(F,()=>{this.wk=(new fh(this,this.$,this.ea,F.result)).wk},this.$.Aa,3)}}z$i(F){let va={};try{if(va=We.a.Xj(F),rg.addLinkedObjects(this.oCe.id,
va.ServerCorrelationId,"actions","ServerActions"),!Xd.a.zf(va.Errors)&&va.Result&&(this.$.fa.R4(va.StateId,"BasePictureUploaderWrapper.UploadResponseReceived"),!this.bVd)){const lb=va.Result;Pa.a(this.$).XLa(1,lb);const sc=oa.EwaSettings.isChangeGateEnabled("OfficeVSO:8434150_MigrateValidationTelemetryManager")?Ka.a.Cb(Ba.ValidationTelemetryManagerService):this.$.ra.Tb(277);sc&&sc.znd(this.$,1,va.Result,va,"InsertPicture");C.ULS.sendTraceTag(526399114,0,50,"Insert picture completed successfully :)")}}catch(lb){C.ULS.sendTraceTag(526399113,
0,50,`BasePictureUploaderWrapper.HandleSuccessCallback: got exception while try to JSON.Parse string length: ${F?F.length:-1}, errror: ${lb}`)}this.F1c(va,null,"InsertPictureWebMethod")}TQf(F){F=this.fLd(F);const va={};va.Errors=[F];this.F1c(va,null,"InsertPictureWebMethod")}F1c(F,va,lb){this.PL(F,va,lb)}kye(F,va,lb){this.Jsa(F,va,lb)}fte(F){F=this.fLd(F);new Aa.a(this.$,F)}KHj(F){const va=this.$.ta.InsertPicturUnsupportedExtensionsForLogging;F=la.a.wm(F);for(let lb=0;lb<va.length;++lb)if(F.endsWith(va[lb])){C.ULS.sendTraceTag(526399112,
0,50,`Insert picture blocked invalid extension: ${va[lb]}`);break}}static Oil(F){return!F||Oa.a.equals(F,ic.a.insertPictureUnknownError,!0)?2:Oa.a.equals(F,ic.a.insertPictureNoFileSelectedError,!0)?1:Oa.a.equals(F,ic.a.Xjj,!0)?3:Oa.a.equals(F,ic.a.$jj,!0)?5:0}static Cd(F,va,lb,sc){return Xd.a.Cd(1,0,0,F,va,lb,sc)}static u4h(F){switch(F){case 1:return 1;case 2:return 6}return 0}bcf(){return this.xmb||void 0===window.self.FormData||null===window.self.FormData?!1:!0}}Object(O.a)(jh,"BasePictureUploaderWrapper",
Wd,[4]);class zh extends jh{constructor(F,va,lb,sc,Yc,jd){jd=void 0===jd?!0:jd;super(F,va,lb,sc,!1);this.fAi=Yc;this.cxc=F.Vb.Pg("LoadResource","FileReaderUploaderLoadResource");jd&&this.showDialog()}eVk(){this.CLc=28E5;this.fte(3)}NGd(F){C.ULS.sendTraceTag(526399111,0,50,"FileReaderUploaderWrapper.finalizeUploadImpl - Start function.");const va=new FileReader;F=F.uK.files;if(0==F.length)C.ULS.sendTraceTag(526399110,0,15,"FileReaderUploaderWrapper.finalizeUploadImpl - No image file found.");else{var lb=
F[0];va.onload=()=>{this.cxc.stop();this.fAi.X5j(va.result,this);C.ULS.sendTraceTag(526399109,0,50,`FileReaderUploaderWrapper.finalizeUploadImpl - End function. Type:${lb.type}, Size:${lb.size.toString()}`)};va.onerror=()=>{this.cxc.stop();C.ULS.sendTraceTag(526399108,0,10,`FileReaderUploaderWrapper.finalizeUploadImpl - Can't read image. Type:${lb.type}, Size:${lb.size.toString()}`)};va.onabort=()=>{this.cxc.stop();C.ULS.sendTraceTag(526399107,0,10,`FileReaderUploaderWrapper.finalizeUploadImpl - Aborted read image. Type:${lb.type}, Size:${lb.size.toString()}`)};
this.cxc.start();va.readAsDataURL(lb)}}finalizeUpload(F,va){this.NGd(F,va)}}Object(O.a)(zh,"FileReaderUploaderWrapper",jh,[824]);class zg{constructor(F,va){this.dataUri=this.sheetName=null;this.sheetName=F;this.dataUri=va}getSheetName(){return this.sheetName}}Object(O.a)(zg,"MacroRecorderPictureInsertedPayload",null,[67]);class Zg extends jh{constructor(F,va,lb,sc,Yc,jd){jd=void 0===jd?!0:jd;super(F,lb,sc,Yc,!1);this.fc=va;jd&&this.showDialog()}NGd(F,va){super.finalizeUpload(F,va);Je.a(this.$.userOperationManager,
(lb,sc)=>{this.PL=lb;this.Jsa=sc;this.oCe.start();this.pnc.Cv();this.J4=!1;this.V3g(F);return this.Vkk(F)},lb=>{const sc={};this.$.Zk(sc);const Yc=sc.SheetName;lb=new ub.a(510,0,lb,72,()=>new zg(Yc,this.wce?this.wce:""));lb.sMa(()=>!0);lb.fc=this.fc;return lb},this.fc)}finalizeUpload(F,va){this.NGd(F,va)}}Object(O.a)(Zg,"PictureUploaderWrapper",jh,[]);class ab{constructor(F,va){this.filename=F;this.blob=va}}Object(O.a)(ab,"UploadBlobParameters",null,[]);class Ua extends Zg{constructor(F,va,lb,sc,
Yc,jd,Ad){super(F,va,lb,sc,Yc,!1);this.J3c=!1;this.PO=Ad;this.BDc=Ua.CGi(jd);F=this.Y$b(this.BDc.name,this.BDc.size);0!==F?(this.fte(F),this.PO.setException(Error.create("DataUrlUploaderWrapper: Invlid data url")),this.dispose()):this.wk=new Ug(this.$.domElement,this.s2a,this.Wfa,sc,!1,this.$)}kye(F,va,lb){super.kye(F,va,lb);this.PO.setException(Error.create("DataUrlUploaderWrapper.TriggerFailedCallback: File upload request failed"))}F1c(F,va,lb){super.F1c(F,va,lb);Xd.a.zf(F.Errors)?this.PO.setException(Error.create(`DataUrlUploaderWrapper.TriggerSuccessCallback: File upload request returned with errors: ${Xd.a.pc(F.Errors)}`)):
this.PO.setResult(!0)}V3g(F){const va=new ab(this.BDc.name,this.BDc);F.K_g(va)}static CGi(F){var va=F.split(",");F=va[0].includes("base64")?window.self.atob(va[1]):window.self.decodeURI(va[1]);va=va[0].split(":")[1].split(";")[0];const lb=new Uint8Array(F.length);for(let sc=0;sc<F.length;sc++)lb[sc]=F.charCodeAt(sc);F=new Blob([lb],{type:va});F.name="Image.png";return F}}Object(O.a)(Ua,"DataUrlUploaderWrapper",Zg,[]);let hd=class{constructor(){}rij(F,va,lb,sc,Yc){-2060689045===va.command&&(Yc.IsCellPicture=
!0);new Zg(F,va,lb,sc,Yc,!0)}fhj(F,va,lb,sc,Yc,jd){new Ua(F,null,va,lb,sc,Yc,jd)}uhj(F,va,lb,sc,Yc){new zh(F,va,lb,sc,Yc,!0)}};hd=Object(U.__decorate)([Object(Ka.d)(Ba.UploaderCreatorService)],hd);Object(O.a)(hd,"UploaderCreator",null,[798]);let qe=class{constructor(F,va){this.p3=()=>{this.Xd||this.W6e()};this.Xd=!1;this.S6=va.sT;this.ariaLiveNotifier=F;this.zCe=new ta(F,va);this.S6&&this.S6.xY?this.W6e():this.Aj()}dispose(){this.Bi();this.ariaLiveNotifier=this.S6=null;this.Xd=!0}Aj(){if(this.S6){this.S6.aw(this.p3);
this.S6.za.Or(this.p3);this.S6.KJ(this.p3);var F=Object(Pd.a)(218,this.S6);F&&(F.Rb.Jp(this.p3),F.ha.Vq(this.p3),F.ha.add_activeCellChanged(this.p3),F.ha.ob.pF(this.p3))}else C.ULS.sendTraceTag(537153923,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")}Bi(){if(this.S6){this.S6.za.Gq(this.p3);this.S6.xL(this.p3);const F=Object(Pd.a)(218,this.S6);F&&(F.Rb.zp(this.p3),F.ha.vr(this.p3),F.ha.remove_activeCellChanged(this.p3),F.ha.ob.yL(this.p3))}}W6e(){this.zCe.nDg();this.ariaLiveNotifier.setEnabled(!0);
this.ariaLiveNotifier.vJk();this.dispose()}};qe=Object(U.__decorate)([Object(Ka.d)(Ba.WorkbookReadoutHandlerService),Object(U.__param)(0,Object(Ba.AriaLiveNotifierService)()),Object(U.__param)(1,Object(Ba.EwaControlService)())],qe);Object(O.a)(qe,"WorkbookReadoutHandler",null,[4]);var Ae=a(263);const ef="H1 H2 H3 H4 H5 H6".split(" "),Tf=["TD","TH"],Nf=["P","DIV","TABLE","TBODY","THEAD","TFOOT","ARTICLE","ADDRESS","ASIDE","BLOCKQUOTE","CAPTION","CODE","FORM","DETAILS","SUMMARY","LEGEND","FIELDSET",
"FOOTER","HEADER","KBD","MAIN","SECTION",...ef],wg="SPAN A ABBR ACRONYM B STRONG I EM SUB SUP BDO BDI BUTTON CITE DATA LABEL DEL INS DFN DIALOG HGROUP MARK S TIME U V FONT".split(" "),Uf=["UL","OL","LI","INPUT","SELECT","AREA","AUDIO","B","BASE","BR","CANVAS","COL","COLGROUP","DATALIST","DD","DETAILS","DFN","DIR","DL","DT","EMBED","FIGCAPTION","FIGURE","HR","IFRAME","IMG","LINK","MAP","MENU","MENUITEM","META","METER","NAV","NOSCRIPT","OBJECT","OPTGROUP","OPTION","OUTPUT","PICTURE","PRE","PROGRESS",
"Q","RP","RT","RUBY","SAMP","SMALL","SOURCE","TEMPLATE","TEXTAREA","TR","TRACK","VAR","VIDEO",...Nf,...wg,...Tf],lg="table table;table ul;table ol;table dl;ul ul;ol ol;ol ul;ul ol;dl;img".split(";"),Kg={"sans-serif":"Arial",fAl:"Times New Roman",qtl:"Courier New",orl:"Comic Sans MS",Nrl:"Algerian"},If=/^(\d+|\d+\.\d+)(\w+)$/,hg=/>\s+</g;let gh=class{constructor(F){this.uSd=[];this.BQ=[];this.A0d=this.JJc=this.Hia=this.Lia=0;this.S0b=F}J$j(F,va){this.nL={rdj:-1,UUf:-1,tdj:-1,ksl:F.length,odj:0};const lb=
[];if(!va.token.oI)try{const sc=this.zrk(F),Yc=performance.now();this.ckb=this.S0b.kCk(sc);if(!this.ckb)return C.ULS.sendTraceTag(507377812,0,50,"HtmlProcessor.parseHtml: htmlContent is null after sanitizeAndAppendPastedHtml call"),Ae.a.Va({yYa:lb,cseStatus:46,nL:this.nL});this.nL.rdj=performance.now()-Yc;F=!1;for(const ye of lg)if(this.ckb.querySelector(ye)){F=!0;break}if(F){const ye=performance.now();this.S0b.oGg();this.nL.UUf=performance.now()-ye;return Ae.a.Va({yYa:lb,cseStatus:41,nL:this.nL})}this.Nek();
this.initialize();const jd=performance.now(),Ad=this.uzj(this.ckb,lb,va);this.nL.tdj=performance.now()-jd;const Kd=performance.now();this.S0b.oGg();this.nL.UUf=performance.now()-Kd;return Ad?(this.nL.odj=lb.length,Ae.a.Va({yYa:lb,cseStatus:1,nL:this.nL})):Ae.a.Va({yYa:lb,cseStatus:39,nL:this.nL})}catch(sc){return C.ULS.sendTraceTag(507377811,0,10,"HtmlProcessor.parseHtml: Error parsing the html",sc),Ae.a.Va({yYa:lb,cseStatus:46,nL:this.nL})}return Ae.a.Va({yYa:lb,cseStatus:39,nL:this.nL})}initialize(){this.A0d=
this.JJc=this.Hia=this.Lia=0;this.jK=null;this.ySb=!1;this.BQ=[]}Nek(){try{C.ULS.sendTraceTag(507377810,0,50,"HtmlProcessor.preprocessStyle: start");const F=this.ckb.getElementsByTagName("style");if(F&&0<F.length){C.ULS.sendTraceTag(507536152,0,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let va=0;va<F.length;va++)this.ckb=c(this.ckb,F[va]),F[va]&&(F[va].parentNode.removeChild(F[va]),va--)}}catch(F){C.ULS.sendTraceTag(507377809,0,10,"HtmlProcessor.preprocessStyle: Error while converting style elements to inline style",
F)}}uzj(F,va,lb){try{const sc=F.childNodes;for(F=0;F<sc.length;F++){if(lb.token.oI)return!1;this.tRf(sc[F],va)}return!0}catch(sc){return C.ULS.sendTraceTag(507377808,0,10,"HtmlProcessor.iterateOverChildNodesOfBody: Error while iterating over child nodes of body",sc),!1}}zrk(F){return F.replace(hg,"><")}m1a(){this.Lia++;this.Lia>this.JJc&&(this.JJc=this.Lia);this.jK=null}Ufg(){this.Hia++;this.Hia>this.A0d&&(this.A0d=this.Hia);this.jK=null}Qrc(F){const va={borders:[],fontFamily:"",cellText:"",Owe:0,
iDf:!1,color:"",fontSize:11,italic:!1,backgroundColor:"",bold:!1,Lz:"",rowIndex:this.Lia,colIndex:this.Hia};F.push(va);return va}nFc(){var F;return!(null===(F=this.jK)||void 0===F?0:F.cellText)||0===this.jK.cellText.length}AWb(F,va){F=F.childNodes;for(let lb=0;lb<F.length;lb++)this.tRf(F[lb],va)}K$i(F,va){let lb;if(F.textContent){if(this.BQ.map(sc=>sc.element.tagName).some(sc=>Tf.includes(sc))||F.nextElementSibling&&wg.includes(F.nextElementSibling.nodeName))lb=F.textContent;else if(lb=F.textContent.trim(),
!lb||0===lb.length)return;this.jK||(this.jK=this.Qrc(va));this.jK.cellText=this.jK.cellText?`${this.jK.cellText}${lb}`:lb;F.parentElement?(va=this.S0b.KAf(F.parentElement))?this.jK=h(F,va,this.jK,this.ySb,this.BQ):C.ULS.sendTraceTag(507536151,0,50,"Computed style is null for parent element"):C.ULS.sendTraceTag(507536150,0,50,"Parent element is null")}}K8i(F,va){const lb=F.getAttribute("href");lb&&0<lb.trim().length&&(this.jK||(this.jK=this.Qrc(va)),this.jK.Lz=lb);this.uRf(F,va)}mQd(F,va){this.nFc()||
this.m1a();this.BQ.push({element:F,WDa:F.style});this.AWb(F,va);this.BQ.pop();this.nFc()||this.m1a()}uRf(F,va){this.BQ.push({element:F,WDa:F.style});this.AWb(F,va);this.BQ.pop()}E$i(F,va){const lb=this.Hia,sc=this.Lia;this.nFc()||this.m1a();this.BQ.push({element:F,WDa:F.style});this.AWb(F,va);this.BQ.pop();this.Lia=this.JJc;this.Lia===sc&&this.Hia>lb&&this.m1a();this.Hia=lb}D$i(F,va){const lb=this.Lia;this.ySb=!0;this.BQ.push({element:F,WDa:F.style});this.AWb(F,va);this.BQ.pop();this.ySb=!1;this.Lia=
lb;this.Ufg()}$6i(F){this.jK||(this.jK=this.Qrc(F));this.ySb?this.jK.cellText=`${this.jK.cellText}\n`:this.m1a()}f8i(F,va){this.BQ.push({element:F,WDa:F.style});this.uSd=[];this.mQd(F,va);this.BQ.pop()}M8i(F,va){var lb=F.closest("ul, ol");if(lb){this.uSd.push(F);this.nFc()||this.m1a();var sc=this.Hia;if("OL"===lb.nodeName){lb=this.Qrc(va);lb.cellText=`${this.uSd.length}`;const Yc=this.S0b.KAf(F);Yc?h(F,Yc,lb,this.ySb,this.BQ):C.ULS.sendTraceTag(507536149,0,50,"Computed style is null for list item element");
this.Ufg()}this.BQ.push({element:F,WDa:F.style});this.AWb(F,va);this.BQ.pop();this.Hia=sc;this.m1a()}}tRf(F,va){switch(F.nodeName){case "#text":this.K$i(F,va);break;case "A":this.K8i(F,va);break;case "TR":this.E$i(F,va);break;case "TD":case "TH":this.D$i(F,va);break;case "BR":this.$6i(va);break;case "UL":case "OL":this.f8i(F,va);break;case "LI":this.M8i(F,va);break;case "CAPTION":F.parentElement&&"TABLE"===F.parentElement.nodeName&&this.mQd(F,va);break;default:F.nodeType===Node.ELEMENT_NODE&&(-1<
Nf.indexOf(F.nodeName)?this.mQd(F,va):-1<wg.indexOf(F.nodeName)&&this.uRf(F,va))}}};gh=Object(U.__decorate)([Object(Ka.d)(Ba.HtmlProcessorService),Object(U.__param)(0,Object(Ba.PastableIframeService)())],gh);Object(O.a)(gh,"HtmlProcessor",null,[]);let mc=class{constructor(F){this.Mc=F;this.zkf()}kCk(F){try{C.ULS.sendTraceTag(507377807,0,50,"PastableIframe.sanitizeAndAppendPastedHtml: start");const va=this.Mc.U_i(F);if(this.Sja.contentDocument)return this.Sja.contentDocument.body.replaceWith(va),this.Sja.contentDocument.body;
C.ULS.sendTraceTag(507529291,0,15,"iframe not loaded when append method was called");return va}catch(va){return C.ULS.sendTraceTag(507377806,0,10,"PastableIframe.sanitizeAndAppendPastedHtml: Error while sanitizing and appending html to iframe",va),null}}oGg(){if(this.Sja.contentDocument){var F=this.Sja.contentDocument.body;F?this.Mc.HH(F):C.ULS.sendTraceTag(507529290,0,15,"iframe body itself is null")}}KAf(F){var va;const lb=null===(va=this.Sja.contentDocument)||void 0===va?void 0:va.body;return(null===
lb||void 0===lb?0:lb.contains(F))?getComputedStyle(F):F?F.style:null}zkf(){const F=performance.now();this.Sja=document.createElement("iframe");Object.assign(this.Sja.style,{visibility:"hidden",zIndex:"-100",position:"absolute",contain:"strict"});this.Sja.setAttribute("sandbox","allow-same-origin");this.Sja.setAttribute("data-debug-id","paste-iframe");const va=document.getElementsByTagName("body")[0];va?va.appendChild(this.Sja):C.ULS.sendTraceTag(507529289,0,15,"Body not found");C.ULS.sendTraceTag(507529288,
0,50,"Time taken to create iframe: "+(performance.now()-F))}};mc=Object(U.__decorate)([Object(Ka.d)(Ba.PastableIframeService),Object(U.__param)(0,Object(Ba.HtmlSanitizationHelperService)())],mc);Object(O.a)(mc,"PastableIframe",null,[]);var sd=a(1432),ie=a(430),te=a(375),Ve=a(374);const kf=F=>{F?(F.isAsyncCopy=!1,F.isSelectionAllowed=!1,F.isFromCache=!1,F.plainTextPayloadSize=0,F.shadowWorkbookPayloadSize=0,F.htmlPayloadSize=0,F.htmlSizeExceedsLimit=!1,F.clientSideCopyTime=0,F.encounteredDeploymentErrors=
!1,F.shadowWorkbookSizeExceedsLimit=!1,F.originalSourceRangesCountExceedsLimit=!1,F.copyTotalSizeExceedsLimit=!1):C.ULS.sendTraceTag(537167826,0,10,"CommonCopyPasteUtils.InitializeCopyContext: copyContext is null.")},Of=(F,va,lb,sc,Yc)=>{const jd=F.Stopwatch,Ad={};Ad.a=Yc;Ad.e=jd.id;Ad.c="RearrangeRowColumn";Ad.b="mouse";Ad.d=F.OperationId.toString();Ad.f=lb.toString();Ad.g=sc.toString();Ad.h=va.toString();Ad.i=F.DragDropIsShiftKeyDown;Ad.j=!0;Ad.o=jd.Kc;Ad.q=!1;Ad.r=F.CopyPasteTargetType.toString();
Ad.s=F.EncounteredDeploymentErrors;return Ad};class Sf{constructor(F,va){this.nGi=()=>{const lb={};lb.SourceItem=this.toString();return lb};this.sessionStateId=F;this.sessionId=va;this.toJSON=this.nGi}IFc(F){return F?this.sessionStateId===F.sessionStateId&&this.sessionId===F.sessionId:!1}isFromCurrentSession(F){return this.sessionId===F.ta.UserSessionId}}Object(O.a)(Sf,"SourceItem",null,[]);class fg extends Sf{constructor(F,va,lb,sc,Yc){super(lb,sc);this.activeFloatingObjectControlId=F;this.sheetName=
va;this.type=Yc}isEqual(F){return F&&Object.getType(F)===fg?this.IFc(F)&&this.activeFloatingObjectControlId===F.activeFloatingObjectControlId&&this.sheetName===F.sheetName:!1}toString(){return this.type.toString()}}Object(O.a)(fg,"ArtSourceItem",Sf,[]);var Pg;(function(F){F[F.valid=0]="valid";F[F.notPairwiseDisjoint=1]="notPairwiseDisjoint";F[F.cutNotSupportedInDiscontinuousSelection=2]="cutNotSupportedInDiscontinuousSelection";F[F.notValidForm=3]="notValidForm";F[F.temporarilyBlockedCopy=4]="temporarilyBlockedCopy"})(Pg||
(Pg={}));Object(O.b)("CopySourceValidationOptions",Pg);class lh extends Sf{constructor(F,va){super(F,va)}isEqual(F){return this.IFc(F)}}Object(O.a)(lh,"NonGridSourceItem",Sf,[]);class Qg extends Sf{constructor(F,va,lb,sc,Yc){super(sc,Yc);C.ULS.shipAssertTag(537167645,0,!!va&&0<va.length,"RangeSourceItem.ctor: ranges should not be null or empty");this.$=F;this.ranges=va;this.sheetName=lb}isEqual(F){return F&&Object.getType(F)===Qg?this.IFc(F)&&gc.Y(this.ranges,F.ranges)&&this.sheetName===F.sheetName:
!1}toString(){return gc.k(this.ranges,",",this.$,!1)}}Object(O.a)(Qg,"RangeSourceItem",Sf,[]);const tg=F=>!!F&&Object.getType(F)===Qg,Dh=F=>!!F&&Object.getType(F)===lh;class Gg{}Gg.chl="PasteError_FailedToReadFromClipboard_UserHashMismatchError";Object(O.a)(Gg,"ExpectedErrorNames",null,[]);var gg=a(954);const Hg=F=>F.clipboardItems&&(F=F.clipboardItems.getItem(gg.a.Msj))&&"1"===F?!0:!1,Lg=F=>Hg(F)&&!(void 0===F.clipboardItems||null===F.clipboardItems)&&!!F.clipboardItems.getItem(gg.a.png)&&!F.clipboardItems.getItem(gg.a.plainText),
qh=F=>F.clipboardItems&&(F=F.clipboardItems.getItem(gg.a.Hnj))&&"1"===F?!0:!1,Dg=F=>F&&(F=F.getCachedMetadata(),null===F||void 0===F?0:F.lastCopy)?F.lastCopy:null;class mh{constructor(F,va,lb,sc,Yc){this.$=F;this.zoom=Yc;this.originalDestinations=va;this.ywc=lb;this.Bih=sc;this.Msh=this.originalDestinations;this.xmh=this.ywc;this.kqh="PasteRecoveryUI"}get zoomManager(){return this.zoom.zoomManager}get gHh(){return this.Bih}get V8f(){return this.kqh}get Bmk(){return this.Msh}get Xzf(){return this.xmh}oGa(){return mh.tak}fPi(){return this.ywc&&
1===this.ywc.length?this.gPi(this.ywc[0]):null}VKd(){return"PasteRecoveryUI-Floatie"}gPi(F){var va=fa.f(this.$);const lb=va.rb.Yh(F);var sc=va.Wg(F,lb);va=va.rtl;if(!sc)return null;F=fa.f(this.$).pg(lb);const Yc=F.ul;if(!Yc.ld(sc))return null;sc=Yc.Xe(sc);const jd=sc.topLeft.y;var Ad=sc.bottomRight.y;const Kd=va?sc.bottomRight.x:sc.topLeft.x;sc=va?sc.topLeft.x:sc.bottomRight.x;var ye=new od.a(sc+(va?-81:81),Ad+38+6);if(Yc.Dra(ye))return this.Zib(F,Yc,lb,sc,Ad,va?12:-3,66);ye=new od.a(sc+(va?-81:81),
Ad);if(Yc.Dra(ye))return this.Zib(F,Yc,lb,sc,Ad,va?20:3,22);ye=new od.a(sc,Ad+38+6);if(Yc.Dra(ye))return this.Zib(F,Yc,lb,sc,Ad,-81+(va?18:0),66);sc=new od.a(Kd+(va?81:-81),Ad);if(Yc.Dra(sc))return this.Zib(F,Yc,lb,Kd,Ad,-81+(va?12:-6),22);Ad=new od.a(Kd,jd-38-6);return Yc.Dra(Ad)?this.Zib(F,Yc,lb,Kd,jd,va?15:0,16):this.Zib(F,Yc,lb,va?Yc.topLeft.x:Yc.bottomRight.x,Yc.bottomRight.y,-81+(va?15:-6),22)}Zib(F,va,lb,sc,Yc,jd,Ad){var Kd=fa.f(this.$);const ye=Kd.rtl;F=$c.HelperMethods.isStandardZoomCssSupportedByBrowser?
ea.DOMElementExtensions.getLocation({element:F.domElement,di:!0}):Sys.UI.DomElement.getLocation(F.domElement);sc=new Sys.UI.Point(sc+(ye?0:F.x)-va.topLeft.x,Yc+F.y-va.topLeft.y);ye&&(Kd=Kd.view.visibleArea,sc.x=Kd.bottomRight.x-Kd.topLeft.x-sc.x,2===lb||4===lb)&&(sc.x+=va.bottomRight.x);sc=this.zoomManager.B7(sc);return new Sys.UI.Point(sc.x+jd,sc.y+Ad)}}mh.tak=["PasteRecoveryUI"];Object(O.a)(mh,"PasteRecoveryUI",null,[846]);var Rg=a(671);class xg{}xg.Xxh="ActiveSelection";xg.shadowWorkbook="ShadowWorkbook";
xg.jeh="GVML";xg.plainText="PlainText";xg.html="Html";xg.bOh="Bitmap";Object(O.a)(xg,"PayloadType",null,[]);class nh{}nh.NYk="Slice6";Object(O.a)(nh,"SliceName",null,[]);class Ah{}Ah.jQj="NotCalled";Ah.success="Success";Ah.failed="Failed";Object(O.a)(Ah,"SucceededPopulatingSystemClipboardOptions",null,[]);var sh=a(302);const eg=(F,va)=>F?va&&va.ta?F.sessionId!==va.ta.UserSessionId:(C.ULS.shipAssertTag(537166209,0,!1,"ewaControl shouldn't be null"),!1):(C.ULS.shipAssertTag(537166210,0,!1,"copyContext shouldn't be null"),
!1),th=F=>{switch(F){case 0:return"None";case 2:return"Art";case 1:return"Range";default:return"Unknown"}},uh=F=>{if(!F)return"null";const va=[];for(const lb of F.get())va.push(`${lb.clipboardDataFormat}(${lb.data.length})`);va.sort();return va.join(",")};var ka;(function(F){F[F.valid=0]="valid";F[F.destinationRangesIsEmpty=1]="destinationRangesIsEmpty";F[F.discontinuousSelectionNotSupportPasteFromExternal=2]="discontinuousSelectionNotSupportPasteFromExternal";F[F.discontinuousSelectionNotSupportPasteCrossSession=
3]="discontinuousSelectionNotSupportPasteCrossSession";F[F.multipleSourcesAndMultipleDestinationsAreNotSupported=4]="multipleSourcesAndMultipleDestinationsAreNotSupported";F[F.multipleDestinationsAreNotMultiplyOfSourceRange=5]="multipleDestinationsAreNotMultiplyOfSourceRange";F[F.sourceAndDestinationAreOverlapping=6]="sourceAndDestinationAreOverlapping";F[F.copySourceNotValid=7]="copySourceNotValid";F[F.cutNotSupportedInDiscontinuousSelection=8]="cutNotSupportedInDiscontinuousSelection";F[F.pasteLinkNotSupportMultipleDestination=
9]="pasteLinkNotSupportMultipleDestination";F[F.temporarilyBlockedPaste=10]="temporarilyBlockedPaste";F[F.unknown=100]="unknown"})(ka||(ka={}));Object(O.b)("PasteValidationOptions",ka);var ac=a(186),Xc=a(143),Bd=a(142),we=a(678),Cd=a(113);class Q extends Sys.EventArgs{constructor(F,va,lb){super();this.command=F;this.destinationRange=va;this.sourceRange=lb}}Object(O.a)(Q,"PasteCSERenderedEventArgs",Sys.EventArgs,[]);var Ja=a(140);class ob extends mh{constructor(F,va,lb,sc,Yc){super(F,va,lb,sc,Yc);
this.NBj="DragRecoveryUI"}get V8f(){return this.NBj}oGa(){return ob.Gji}VKd(){return"DragRecoveryUI-Floatie"}}ob.Gji=["DragRecoveryUI"];Object(O.a)(ob,"DragFillRecoveryUI",mh,[]);var qc=a(780),gd=a(431);class td extends gd.a{constructor(F,va,lb){super(F);this.hc=0;this.initializeAndShow(Ha.a.instance.ia(1060),va,lb)}get Tc(){return"CopyPasteShortcutReactDialog"}}Object(O.a)(td,"CopyPasteShortcutReactDialog",gd.a,[]);var ca=a(432);class bb{constructor(F){this.LD=null;this.VTa=va=>{this.LD(1===va?bb.cJb:
qc.a[va],!1);bb.vea=!1};this.$=F}showDialog(F,va,lb,sc){this.LD=sc;bb.TUb=wa.a.isMac||wa.a.mi;this.LD||(this.LD=()=>{});bb.vea?sc(bb.bJb,!1):(bb.vea=!0,va={},F?(va.forwardElementText=Ha.a.instance.ia(1061),va.cutText=bb.TUb?Ha.a.instance.ia(1050):Ha.a.instance.ia(1062),va.copyText=bb.TUb?Ha.a.instance.ia(1051):Ha.a.instance.ia(1063),va.pasteText=bb.TUb?Ha.a.instance.ia(1052):Ha.a.instance.ia(1064),va.pasteTextOnly=bb.TUb?Ha.a.instance.ia(1055):Ha.a.instance.ia(1065)):(va.forwardElementText=Ha.a.instance.ia(1066),
va.cutText=Ha.a.instance.ia(1067)),new td(this.$,this.VTa,{[ca.a.Xs]:bb.id,["bodyControls"]:va}))}}bb.vea=!1;bb.TUb=!1;bb.bJb="notOpened";bb.cJb="ok";bb.id="CopyPasteShortcutDialog";Object(O.a)(bb,"CopyPasteShortcutDialog",null,[845]);class Hb extends gd.a{constructor(F,va,lb){super(F);this.hc=0;this.Ic(1,Ha.a.instance.ia(1054));this.hfa(1);this.initializeAndShow(Ha.a.instance.ia(1046),va,lb)}get Tc(){return"CopyPasteInstallReactDialog"}}Object(O.a)(Hb,"CopyPasteInstallReactDialog",gd.a,[]);class Vb{constructor(F){this.LD=
null;this.VTa=va=>{1===va?(C.ULS.sendTraceTag(508359137,0,50,"User clicked the install button"),this.j6h(),this.Xck(),this.LD(Vb.cJb,!0)):(C.ULS.sendTraceTag(508359136,0,50,"User clicked the cancel button"),this.LD(qc.a[va],!1));Vb.vea=!1};this.$=F}showDialog(F,va,lb,sc){this.LD=sc=void 0===sc?()=>{}:sc;va=wa.a.isMac||wa.a.mi;Vb.vea?sc(Vb.bJb,!1):(Vb.vea=!0,sc={},F&&(sc.extensionStartText=sc.extensionStartText=wa.a.mHc?Ha.a.instance.ia(1048):Ha.a.instance.ia(1047),sc.extensionLink=null,sc.extensionEndText=
null,sc.shortcutsMessageText=Ha.a.instance.ia(1049),sc.cutText=va?Ha.a.instance.ia(1050):Ha.a.instance.ia(1062),sc.copyText=va?Ha.a.instance.ia(1051):Ha.a.instance.ia(1063),sc.pasteText=va?Ha.a.instance.ia(1052):Ha.a.instance.ia(1064),sc.pasteTextOnly=va?Ha.a.instance.ia(1055):Ha.a.instance.ia(1065)),new Hb(this.$,this.VTa,{[ca.a.Xs]:Vb.id,["bodyControls"]:sc}))}j6h(){void Ka.a.resolve(Ba.BusinessBarManagerService,{xa:0}).then(F=>{F.lh(68,null)})}Xck(){const F=this.$.ta;Ub.a.Rg(`${F.ChromeClipboardAccessExtensionLink}${wa.a.mHc?
F.ChromeClipboardAccessExtensionId:F.OfficeOnlineChromeExtensionId}`,"_blank",void 0,"ChromeCCPInstallDialog")}}Vb.vea=!1;Vb.bJb="notOpened";Vb.cJb="ok";Vb.id="CopyPasteInstallDialog";Object(O.a)(Vb,"CopyPasteInstallDialog",null,[845]);class Ec extends Sys.EventArgs{constructor(F,va){super();this.wof=F;this.Ti=va}}Object(O.a)(Ec,"PasteSucceededEventArgs",Sys.EventArgs,[]);var rd=a(114);class Id extends gd.a{constructor(F,va,lb){super(F);this.hc=0;hb.AFrameworkApplication.ea.ka("IsNewStringEnabled")?
this.Ic(1,CommonUiStrings.DialogOk):this.Ic(1,CommonUIStrings.l_DialogOk);this.hfa(1);this.initializeAndShow(Ha.a.instance.ia(2390),va,lb)}get Tc(){return"CopyPasteNoClipboardAccessReactDialog"}}Object(O.a)(Id,"CopyPasteNoClipboardAccessReactDialog",gd.a,[]);class W{constructor(F){this.LD=null;this.VTa=va=>{1===va?this.LD(W.cJb,!0):this.LD(qc.a[va],!1);W.vea=!1;this.fyd&&URL.revokeObjectURL(this.fyd)};this.$=F}showDialog(F,va,lb,sc){this.LD=sc=void 0===sc?()=>{}:sc;va=wa.a.isMac||wa.a.mi;W.vea?sc(W.bJb,
!1):(W.vea=!0,sc={},F&&(sc.startText=Ha.a.instance.ia(2391),sc.endText=Ha.a.instance.ia(2392),hb.AFrameworkApplication.ea.ka("IsNewStringEnabled")?(sc.cutText=CommonUiStrings.CutString,sc.copyText=CommonUiStrings.CopyString,sc.pasteText=CommonUiStrings.PasteString,sc.cutShortcutText=va?CommonUiStrings.CutShortcut_Mac:CommonUiStrings.CutShortcut,sc.copyShortcutText=va?CommonUiStrings.CopyShortcut_Mac:CommonUiStrings.CopyShortcut,sc.pasteShortcutText=va?CommonUiStrings.PasteShortcut_Mac:CommonUiStrings.PasteShortcut,
sc.imageAltText=CommonUiStrings.NoClipboardAccessDialogImageAltText,sc.primaryButtonLabel=CommonUiStrings.DialogOk):(sc.cutText=CommonUIStrings.l_CutString,sc.copyText=CommonUIStrings.l_CopyString,sc.pasteText=CommonUIStrings.l_PasteString,sc.cutShortcutText=va?CommonUIStrings.l_CutShortcut_Mac:CommonUIStrings.l_CutShortcut,sc.copyShortcutText=va?CommonUIStrings.l_CopyShortcut_Mac:CommonUIStrings.l_CopyShortcut,sc.pasteShortcutText=va?CommonUIStrings.l_PasteShortcut_Mac:CommonUIStrings.l_PasteShortcut,
sc.imageAltText=CommonUIStrings.l_NoClipboardAccessDialogImageAltText,sc.primaryButtonLabel=CommonUIStrings.l_DialogOk),this.fyd=URL.createObjectURL(new Blob(['\n<svg width="440" height="114" viewBox="0 0 457 114" fill="none" xmlns="http://www.w3.org/2000/svg">\n<g filter="url(#filter0_dd_2_4645)">\n<rect x="15" y="8" width="427" height="85" rx="8" fill="#F3F3F3"/>\n<g clip-path="url(#clip0_2_4645)">\n<rect x="15" y="8" width="427" height="40" fill="#CECECE"/>\n<mask id="mask0_2_4645" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="15" y="40" width="427" height="12">\n<rect x="15" y="40" width="427" height="12" fill="#FF00FF"/>\n</mask>\n<g mask="url(#mask0_2_4645)">\n<g filter="url(#filter1_dd_2_4645)">\n<rect x="15" y="48" width="427" height="4" fill="#F3F3F3"/>\n</g>\n</g>\n<mask id="mask1_2_4645" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="23" y="12" width="256" height="36">\n<rect x="23" y="12" width="256" height="36" fill="#FF00FF"/>\n</mask>\n<g mask="url(#mask1_2_4645)">\n<g filter="url(#filter2_dd_2_4645)">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M31 24C31 19.5817 34.5817 16 39 16H263C267.418 16 271 19.5817 271 24V40C271 44.4183 274.582 48 279 48V52H271H31H23V48C27.4183 48 31 44.4183 31 40V24Z" fill="#F3F3F3"/>\n</g>\n</g>\n<g clip-path="url(#clip1_2_4645)">\n<path d="M251.089 28.2157L251.146 28.1464C251.32 27.9729 251.589 27.9536 251.784 28.0886L251.854 28.1464L255 31.293L258.146 28.1464C258.342 27.9512 258.658 27.9512 258.854 28.1464C259.049 28.3417 259.049 28.6583 258.854 28.8536L255.707 32L258.854 35.1464C259.027 35.32 259.046 35.5894 258.911 35.7843L258.854 35.8536C258.68 36.0271 258.411 36.0464 258.216 35.9114L258.146 35.8536L255 32.707L251.854 35.8536C251.658 36.0488 251.342 36.0488 251.146 35.8536C250.951 35.6583 250.951 35.3417 251.146 35.1464L254.293 32L251.146 28.8536C250.973 28.68 250.954 28.4106 251.089 28.2157L251.146 28.1464L251.089 28.2157Z" fill="#1A1A1A"/>\n</g>\n<g clip-path="url(#clip2_2_4645)">\n<path d="M55 28.6641V32L52.3359 33L49.6641 32L43 28.6641V25.3359C43 25.1484 43.0651 24.9896 43.1953 24.8594C43.3255 24.7292 43.4818 24.6641 43.6641 24.6641H49.6641L55 28.6641Z" fill="#21A366"/>\n<path d="M55 25.3359V28.6641H49.6641V24.6641H54.3359C54.4245 24.6641 54.5104 24.6823 54.5938 24.7188C54.6719 24.7552 54.7422 24.8047 54.8047 24.8672C54.862 24.9245 54.9089 24.9948 54.9453 25.0781C54.9818 25.1562 55 25.2422 55 25.3359Z" fill="#33C481"/>\n<path d="M55 35.3359V38.6641C55 38.8516 54.9349 39.0104 54.8047 39.1406C54.6745 39.2708 54.5182 39.3359 54.3359 39.3359H43.6641C43.4818 39.3359 43.3255 39.2708 43.1953 39.1406C43.0651 39.0104 43 38.8516 43 38.6641V35.375V32H49.6641L55 35.3359Z" fill="#185C37"/>\n<path d="M49.6641 28.6797V32H43V28.6797H49.6641ZM55 35.3359H49.6641V32.0078H55V35.3359Z" fill="black" fill-opacity="0.5"/>\n<path d="M48.2188 28C48.4375 28 48.6224 28.0755 48.7734 28.2266C48.9245 28.3776 49 28.5625 49 28.7812V36.4297C49 36.5391 48.974 36.6484 48.9219 36.7578C48.8698 36.862 48.7995 36.9583 48.7109 37.0469C48.6224 37.1302 48.5234 37.2005 48.4141 37.2578C48.2995 37.3099 48.1849 37.3359 48.0703 37.3359H43V28H48.2188Z" fill="black" fill-opacity="0.498"/>\n<path d="M47.5547 36.6641H39.7812C39.5625 36.6641 39.3776 36.5911 39.2266 36.4453C39.0755 36.2943 39 36.1094 39 35.8906V28.1094C39 27.8906 39.0755 27.7083 39.2266 27.5625C39.3776 27.4115 39.5625 27.3359 39.7812 27.3359H47.5547C47.7734 27.3359 47.9583 27.4115 48.1094 27.5625C48.2604 27.7083 48.3359 27.8906 48.3359 28.1094V35.8906C48.3359 36.1094 48.2604 36.2943 48.1094 36.4453C47.9583 36.5911 47.7734 36.6641 47.5547 36.6641Z" fill="#107C41"/>\n<path d="M41.2812 34.6641L43.0078 31.9922L41.4297 29.3359H42.7031L43.5625 31.0312C43.6042 31.1146 43.638 31.1849 43.6641 31.2422C43.6849 31.2995 43.7057 31.349 43.7266 31.3906H43.7422C43.7682 31.3281 43.7969 31.2656 43.8281 31.2031C43.8542 31.1406 43.8854 31.0781 43.9219 31.0156L44.8438 29.3359H46.0078L44.3828 31.9766L46.0469 34.6641H44.8047L43.8125 32.7969C43.7656 32.7292 43.724 32.6458 43.6875 32.5469H43.6719C43.6615 32.5781 43.6484 32.6146 43.6328 32.6562C43.612 32.6927 43.5885 32.737 43.5625 32.7891L42.5312 34.6641H41.2812Z" fill="white"/>\n</g>\n<rect x="67" y="29" width="96" height="6" rx="3" fill="#B2AFAC"/>\n<path d="M289 24.5C289 24.2239 288.776 24 288.5 24C288.224 24 288 24.2239 288 24.5V31H281.5C281.224 31 281 31.2239 281 31.5C281 31.7761 281.224 32 281.5 32H288V38.5C288 38.7761 288.224 39 288.5 39C288.776 39 289 38.7761 289 38.5V32H295.5C295.776 32 296 31.7761 296 31.5C296 31.2239 295.776 31 295.5 31H289V24.5Z" fill="#1A1A1A"/>\n</g>\n<rect x="15" y="48" width="427" height="38" fill="#F3F3F3"/>\n<rect x="15" y="86" width="427" height="1" fill="#CCCCCC"/>\n<path d="M42.159 73.3666C42.3629 73.5528 42.6792 73.5384 42.8654 73.3345C43.0515 73.1305 43.0371 72.8143 42.8332 72.6281L36.6653 66.9974H50.4961C50.7722 66.9974 50.9961 66.7735 50.9961 66.4974C50.9961 66.2212 50.7722 65.9974 50.4961 65.9974H36.6682L42.8332 60.3693C43.0371 60.1831 43.0515 59.8668 42.8654 59.6629C42.6792 59.459 42.3629 59.4446 42.159 59.6307L35.2426 65.9448C35.1027 66.0725 35.0229 66.2401 35.0031 66.4132C34.9985 66.4406 34.9961 66.4687 34.9961 66.4974C34.9961 66.5242 34.9982 66.5506 35.0023 66.5763C35.0205 66.7522 35.1006 66.9229 35.2426 67.0526L42.159 73.3666Z" fill="#1A1A1A"/>\n<g opacity="0.3">\n<path d="M87.8371 59.6307C87.6332 59.4446 87.3169 59.459 87.1307 59.6629C86.9446 59.8668 86.959 60.1831 87.1629 60.3693L93.3307 66H79.5C79.2239 66 79 66.2239 79 66.5C79 66.7761 79.2239 67 79.5 67H93.3279L87.1629 72.6281C86.959 72.8143 86.9446 73.1305 87.1307 73.3345C87.3169 73.5384 87.6332 73.5528 87.8371 73.3666L94.7535 67.0526C94.8934 66.9248 94.9732 66.7573 94.993 66.5841C94.9976 66.5568 95 66.5287 95 66.5C95 66.4731 94.9979 66.4468 94.9938 66.421C94.9756 66.2451 94.8955 66.0745 94.7535 65.9448L87.8371 59.6307Z" fill="#1A1A1A"/>\n</g>\n<path d="M124.066 66.05C124.59 62.2198 128.121 59.5401 131.951 60.0648C133.894 60.3309 135.54 61.3695 136.623 62.8297L136.749 63H133.5C133.224 63 133 63.2239 133 63.5C133 63.7761 133.224 64 133.5 64H137.5C137.776 64 138 63.7761 138 63.5V59.5C138 59.2239 137.776 59 137.5 59C137.224 59 137 59.2239 137 59.5V61.7073C135.776 60.3185 134.065 59.3451 132.087 59.074C127.709 58.4744 123.675 61.5369 123.075 65.9143C122.475 70.2917 125.538 74.3264 129.915 74.926C134.293 75.5256 138.327 72.4631 138.927 68.0857C139.001 67.5445 139.019 67.0079 138.986 66.4821C138.968 66.2065 138.73 65.9974 138.455 66.015C138.179 66.0326 137.97 66.2703 137.988 66.5459C138.017 67.0055 138.001 67.4752 137.936 67.95C137.412 71.7802 133.881 74.4599 130.051 73.9353C126.221 73.4106 123.541 69.8802 124.066 66.05Z" fill="#1A1A1A"/>\n<g filter="url(#filter3_d_2_4645)">\n<rect x="159" y="52" width="275" height="30" rx="8" fill="#FBFBFB"/>\n</g>\n<rect x="171" y="55" width="27" height="24" rx="4" fill="#F3F2F1"/>\n<path d="M190.051 65.3663V73H178.527V65.3663H180.686V62.1832C180.686 61.7458 180.782 61.3333 180.973 60.9457C181.159 60.558 181.415 60.2201 181.741 59.9318C182.067 59.6436 182.45 59.4175 182.888 59.2535C183.327 59.0845 183.794 59 184.289 59C184.784 59 185.251 59.0845 185.689 59.2535C186.128 59.4175 186.51 59.6436 186.837 59.9318C187.163 60.2201 187.422 60.558 187.613 60.9457C187.798 61.3333 187.891 61.7458 187.891 62.1832V65.3663H190.051ZM181.412 65.3663H187.166V62.1832C187.166 61.8353 187.09 61.5073 186.938 61.1991C186.786 60.886 186.581 60.6152 186.322 60.3866C186.063 60.158 185.76 59.9766 185.411 59.8424C185.057 59.7082 184.683 59.6411 184.289 59.6411C183.889 59.6411 183.515 59.7082 183.167 59.8424C182.818 59.9766 182.514 60.158 182.256 60.3866C181.997 60.6152 181.792 60.886 181.64 61.1991C181.488 61.5073 181.412 61.8353 181.412 62.1832V65.3663ZM189.325 66H179.252V72.3589H189.325V66Z" fill="black"/>\n</g>\n<defs>\n<filter id="filter0_dd_2_4645" x="0.6" y="4.76837e-07" width="455.8" height="113.8" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n<feFlood flood-opacity="0" result="BackgroundImageFix"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="6.4"/>\n<feGaussianBlur stdDeviation="7.2"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.13 0"/>\n<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_2_4645"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="1.2"/>\n<feGaussianBlur stdDeviation="1.8"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"/>\n<feBlend mode="normal" in2="effect1_dropShadow_2_4645" result="effect2_dropShadow_2_4645"/>\n<feBlend mode="normal" in="SourceGraphic" in2="effect2_dropShadow_2_4645" result="shape"/>\n</filter>\n<filter id="filter1_dd_2_4645" x="7.8" y="44" width="441.4" height="18.4" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n<feFlood flood-opacity="0" result="BackgroundImageFix"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="3.2"/>\n<feGaussianBlur stdDeviation="3.6"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.22 0"/>\n<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_2_4645"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="0.44"/>\n<feGaussianBlur stdDeviation="0.9"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.18 0"/>\n<feBlend mode="normal" in2="effect1_dropShadow_2_4645" result="effect2_dropShadow_2_4645"/>\n<feBlend mode="normal" in="SourceGraphic" in2="effect2_dropShadow_2_4645" result="shape"/>\n</filter>\n<filter id="filter2_dd_2_4645" x="15.8" y="12" width="270.4" height="50.4" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n<feFlood flood-opacity="0" result="BackgroundImageFix"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="3.2"/>\n<feGaussianBlur stdDeviation="3.6"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.22 0"/>\n<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_2_4645"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="0.44"/>\n<feGaussianBlur stdDeviation="0.9"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.18 0"/>\n<feBlend mode="normal" in2="effect1_dropShadow_2_4645" result="effect2_dropShadow_2_4645"/>\n<feBlend mode="normal" in="SourceGraphic" in2="effect2_dropShadow_2_4645" result="shape"/>\n</filter>\n<filter id="filter3_d_2_4645" x="155" y="50" width="283" height="38" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n<feFlood flood-opacity="0" result="BackgroundImageFix"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="2"/>\n<feGaussianBlur stdDeviation="2"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"/>\n<feBlend mode="multiply" in2="BackgroundImageFix" result="effect1_dropShadow_2_4645"/>\n<feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_2_4645" result="shape"/>\n</filter>\n<clipPath id="clip0_2_4645">\n<path d="M15 16C15 11.5817 18.5817 8 23 8H434C438.418 8 442 11.5817 442 16V48H15V16Z" fill="white"/>\n</clipPath>\n<clipPath id="clip1_2_4645">\n<rect width="12" height="12" fill="white" transform="translate(249 26)"/>\n</clipPath>\n<clipPath id="clip2_2_4645">\n<rect width="16" height="16" fill="white" transform="translate(39 24)"/>\n</clipPath>\n</defs>\n</svg>\n'],
{type:"image/svg+xml"})),sc.imageSrc=this.fyd,sc.learnMoreLink=null),new Id(this.$,this.VTa,{[ca.a.Xs]:W.id,["bodyControls"]:sc}))}}W.vea=!1;W.bJb="notOpened";W.cJb="ok";W.id="CopyPasteNoClipboardAccessDialog";Object(O.a)(W,"CopyPasteNoClipboardAccesslDialog",null,[845]);var Ra=a(198),nc=a(75),yc=a(63),Fd;(function(F){F[F.source=0]="source";F[F.destination=1]="destination"})(Fd||(Fd={}));Object(O.b)("RangeType",Fd);class $d extends nb.a{constructor(F,va,lb,sc,Yc,jd,Ad,Kd,ye,Ne,hf,sf){sf=void 0===
sf?null:sf;super();this.c2g=this.d2g=this.rqb=this.iMb=null;this.hmb=!1;this.Q_a=oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StickyFormattingEnabled",!1);this.Cpf=()=>{var Gf;(null===(Gf=this.iMb)||void 0===Gf?0:Gf.P3f())&&!gc.Y(fa.f(this.$).ha.oa.selectedRanges,this.iMb.HJc)&&(this.iMb.gsa(),this.iMb=null);this.da.ha.vr(this.Cpf)};this.l$d=Gf=>{this.CQk(Gf)&&(this.$u.MRd(),C.ULS.sendTraceTag(537167777,0,50,"CopyPasteInfrastructure.OnMetadataChanged: found that cut/copy operation was preformed in another session therefore removed the highlight in this session."))};
this.jHj=(Gf,Yf)=>{C.ULS.sendTraceTag(537167768,0,50,`CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got shortcut dialog, user pressed [${Gf}]. userPressedExtensionLink=${Yf}`);this.da.focus()};this.hGj=(Gf,Yf)=>{C.ULS.sendTraceTag(508130372,0,50,`CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got No Clipboard Access Dialog, user pressed [${Gf}]. userPressedOK=${Yf}`);this.da.focus()};this.de=(Gf,Yf)=>{Yf.xU||Yf.Hg||this.Vr("OnWorkbookOpened",!1).catch(()=>{})};this.Gj=(Gf,Yf)=>
{Gf=Dg(this.jG);const Ng=this.$u.QAc(Gf);Ng&&(Yf.la&&Yf.la.sheetName===Ng.sheetName&&Ng.isFromCurrentSession(this.$)?this.$u.nUf(Ng.ranges,Gf.commandParameters.commandType):this.$u.MRd())};this.oOc=(Gf,Yf)=>{Gf=Dg(this.jG);(Gf=this.$u.QAc(Gf))&&Yf.item&&Yf.item.sheetName===Gf.sheetName&&Gf.isFromCurrentSession(this.$)&&this.Vr("OnItemDeleting",!1).catch(()=>{})};this.o3=()=>{this.d2g()};this.WU=()=>{this.c2g()};this.eZ=(Gf,Yf)=>{1===Yf.Fq&&Yf.jg.operation.flags&2&&this.Vr("OnQueueItemChanged/ItemRemoved",
!1).catch(()=>{})};this.$=F;this.zoom=ye;this.Srh=hf;this.$e=lb;this.da=fa.f(F);this.$u=Yc;this.Kjj=jd;this.jG=va;this.vUa=sc;this.VUf=Ne;this.getStringifiedError=sf||copyPasteInfra.getStringifiedError;this.xVg=1===Kd;this.Aj();Ad||(C.ULS.sendTraceTag(537167824,0,50,"CopyPasteInfrastructure.ctor: userId is null, using default userId."),Ad=$d.fei);this.userHash=la.a.qz(Ad);this.OLj="CultureTag: "+Ha.a.instance.dtc+" HASH: ";this.jG.addMetadataChangeListener($d.ofg,this.l$d);this.RKj=this.$.ta.CCPPastePlainTextLimit;
this.EYb=this.$.ta.CCPCopyPasteHtmlLimit;void Ka.a.Bd(Ba.PasteShortcutManagerService).then(Gf=>{this.rqb=Gf});this.d2g=ac.c(()=>{this.N5j()},1,this.$.Aa,"CopyPasteInfrastructure.OnStartEditInternal",!0);this.c2g=ac.c(()=>{this.mXj()},1,this.$.Aa,"CopyPasteInfrastructure.onEndEditInternal",!0)}get H7f(){return this.fqh}SEa(){var F=Dg(this.jG);return F?(F=F.sourceItem)&&!F.isFromCurrentSession(this.$)?(C.ULS.sendTraceTag(537167778,0,50,"CopyPasteInfrastructure.DoesClipboardHaveCopiedOrCutContent: Last copy/cut operation was from a different session."),
!1):!0:!1}get pasteIndicationManager(){return Ba.PasteIndicationManagerService.Oa()?this.Srh:this.$.ra.Tb(373)}uFh(F){this.addHandler($d.rae,F)}auk(F){this.removeHandler($d.rae,F)}MFb(F){this.addHandler($d.A5c,F)}huk(F){this.removeHandler($d.A5c,F)}copy(F){F.stopwatch=this.$.Vb.Uc("UserAction",rg.resolveRibbonCommandName(F.ribbonCommandInfo.command)+"ClientSide");void Ka.a.resolve(Ba.PasteShortcutManagerService).then(jd=>{this.rqb=jd});const va=!!Dg(this.jG);Rg.a.hZa&&(this.hmb=!1);this.Vr("Copy/before/"+
te.a[F.ribbonCommandInfo.method],!1,void 0,!0,F.copyPasteTargetType).catch(()=>{});var lb=-1985798686===F.ribbonCommandInfo.command;if(1===this.da.gf&&(lb=this.$u.RZf(this.da.ha.oa.selectedRanges,lb),0!==lb)){const jd=$d.F3h(lb);this.JKa(jd,Pg[lb],!1);return Promise.reject(!1)}F.userHash=this.userHash;F.id=Tb.a.create().toString();const sc=this,Yc=this;return this.vUa.onCopy(F).then(jd=>{var Ad;jd.isAsyncCopy||F.stopwatch.stop();sc.pasteIndicationManager.ACd();var Kd=sh.d(F);C.ULS.sendTraceTag(24150883,
0,50,`CopyPasteInfrastructure.OnCopy: Copy operation finished successfully. ${Kd}`);sc.REj(jd,va);Kd=1===F.copyPasteTargetType;!F.isFormatPainter&&Kd&&(sc.rqb?sc.rqb.mmi():C.ULS.shipAssertTag(537167823,0,!1,"Copy: pasteShortcutManager is null."));oa.EwaSettings.CY()&&tg(jd.sourceItem)&&1===jd.sourceItem.ranges.length&&(jd=jd.sourceItem.ranges[0],Kd=this.da.za.Ata(jd,this.$.activeItemName),jd=null===Kd||void 0===Kd?void 0:Kd.Ex(jd),this.fqh=null===(Ad=null===jd||void 0===jd?void 0:jd.formattedText)||
void 0===Ad?void 0:Ad.Text);return Promise.resolve(!0)},jd=>{let Ad=!1,Kd="none",ye=$d.Dfb,Ne=!0,hf=-1,sf=$d.copyErrorName+$d.oFa,Gf=!1,Yf=null;if(jd){Yf=jd.copyContext;hf=jd.reason;sf+=$d.yGa(jd);jd.message&&(ye=jd.message);var Ng=$d.E3h(jd);if(Ng)if(3===Ng.copyErrorName)Ad=!0,ye=Kd="Async Copy canceled by the user.",Ne=!1;else if(Xd.a.Ls(Ng.ewaErrors))if(ye=Yc.Fzc(Ng.ewaErrors),Xd.a.hi(Ng.ewaErrors,$d.operationSucceededWithAlert))Gf=Ad=!0;else if(Xd.a.hi(Ng.ewaErrors,$d.pasteDataLimitHit)||Xd.a.hi(Ng.ewaErrors,
$d.copyThrottlingError))Ad=!0;13===jd.reason?(Ad=!0,Ne=!1):11===jd.reason&&(Ne=!1)}Ng=jd?Yc.getStringifiedError(jd):"null";Ad?(Ng=sh.d(F),C.ULS.sendTraceTag(36304157,0,15,`CopyPasteInfrastructure.OnCopy: Copy operation failed with an expected error. clearStateNeeded: ${Ne}, Friendly message: ${Kd}, Error Message: ${ye}, CommandParameters: ${Ng}`)):C.ULS.sendTraceTag(24150912,0,10,`CopyPasteInfrastructure.OnCopy: Copy operation failed with an unexpected error. clearStateNeeded: ${Ne}, Error Message: ${Ng}, CommandParameters: ${sh.d(F)}`);
Ne&&Yc.Vr("Copy/fail/"+te.a[F.ribbonCommandInfo.method],!0,void 0,void 0,F.copyPasteTargetType).catch(()=>{});Yc.R$f(F,Ad,ye,sf,hf,Gf,Yf);return Promise.reject(jd)})}writeToClipboard(F){F.stopwatch=this.$.Vb.Uc("UserAction",rg.resolveRibbonCommandName(F.ribbonCommandInfo.command)+"ClientSide");this.Vr("Copy/before/"+te.a[F.ribbonCommandInfo.method],!1,void 0,!0,F.copyPasteTargetType).catch(()=>{});F.userHash=this.userHash;F.id=Tb.a.create().toString();return this.vUa.onCopy(F).then(()=>{F.stopwatch.stop();
return Promise.resolve(!0)},va=>{let lb=$d.Dfb,sc=-1,Yc=$d.copyErrorName+$d.oFa,jd=null;va&&(jd=va.copyContext,sc=va.reason,Yc+=$d.yGa(va),va.message&&(lb=va.message));const Ad=sh.d(F);C.ULS.sendTraceTag(508074081,0,15,`CopyPasteInfrastructure.writeToClipboard: Copy operation failed with an error. Error Message: ${lb}, CommandParameters: ${Ad}`);this.R$f(F,!1,lb,Yc,sc,!1,jd);return Promise.reject(va)})}Oak(F){if(this.SEa())return Zb.a(this.TTd(F.commandType,F.ribbonCommandInfo));const va=gc.e(this.da.ha.oa.selectedRanges);
F.originalDestinations=va;F.expandDestinations=this.Moc(F.originalDestinations,F.commandType);if(this.Xoc(F.commandType,F.expandDestinations)||this.ccf())F.userHash=this.userHash,F.id=Tb.a.create().toString(),this.vUa.onPaste(F).then(()=>Promise.resolve(!0),lb=>Promise.reject(lb));return Promise.resolve(!0)}Lak(F){const va=sh.b();va.ribbonCommandInfo=F;va.userHash=this.userHash;va.id=Tb.a.create().toString();va.isKeyboardEvent=!1;va.copyPasteTargetType=this.XIa();va.skipSystemClipboardAccess=!1;va.stopwatch=
this.$.Vb.Uc("UserAction",rg.resolveRibbonCommandName(va.ribbonCommandInfo.command)+"ClientSide");this.Vr("CopyPasteInfrastructure.performFullSheetCopy",!1).catch(lb=>Promise.reject(lb));return this.vUa.onCopy(va).then(()=>{const lb=sh.d(va);C.ULS.sendTraceTag(507818122,0,50,`CopyPasteInfrastructure.performFullSheetCopy: Operation finished successfully. ${lb}`);return Promise.resolve(!0)},lb=>Promise.reject(lb))}Mak(F,va){if(this.SEa())return Promise.resolve(null);const lb=sh.c();lb.ribbonCommandInfo=
F;lb.id=Tb.a.create().toString();lb.clearStateOnFinish=!1;lb.isKeyboardEvent=this.rlb(F,va);lb.skipClipboardAccess=Ra.d(va,S.a.skipClipboardAccess);lb.copyPasteTargetType=this.XIa();lb.skipSystemClipboardAccess=!1;return this.vUa.onPaste(lb).then(sc=>sc).catch(sc=>Promise.reject(sc))}Q0f(){var F;return null===(F=Dg(this.jG))||void 0===F?void 0:F.isFullSheetCopy}zNi(){var F;return null===(F=Dg(this.jG))||void 0===F?void 0:F.sourceItem.sheetName}nmg(F,va){if(F.method){var lb=new ob(this.$,gc.e(this.da.ha.oa.selectedRanges),
gc.e(this.da.ha.oa.selectedRanges),{},this.zoom);(sc=>{const Yc=Object(Zb.d)(Ka.a.resolve(Ba.RecoveryUIControllerService,{xa:0}));fb.TaskExtensions.tb(Yc,()=>{F.method&&sc(Yc.result)},this.Aa,8)})(sc=>{sc.hsd(lb);sc.ute(F.method,va);this.iMb=sc});C.ULS.sendTraceTag(508680074,0,50,"CopyPasteInfrastructure.OnFill: Drag Copy Fill Floatie");this.da.ha.Vq(this.Cpf)}}paste(F){F.stopwatch=this.$.Vb.Uc("UserAction",rg.resolveRibbonCommandName(F.ribbonCommandInfo.command)+"ClientSide");Rg.a.hZa&&(C.ULS.sendTraceTag(537167822,
0,50,"CopyPasteInfrastructure.OnPaste: Cross-app shadow workbook paste is enabled"),this.hmb=!1);fa.f(this.$).Ce&&fa.f(this.$).Ce.ML(this.jNd(F.ribbonCommandInfo.command),F.stopwatch.id);if(F.isPasteCommandFromRecoveryUI){var va=Ka.a.Cb(Ba.RecoveryUIControllerService);var lb=gc.e(va.HJc);if(!lb)return C.ULS.sendTraceTag(508699777,0,20,"RecoveryUI paste destinations must not be null or undefined"),Promise.resolve(!0);va=va.z0d;F.pasteRecoveryCachedClipboardItems=va?va[$d.zwg]:null}else lb=gc.e(this.da.ha.oa.selectedRanges);
F.originalDestinations=lb;F.expandDestinations=this.Moc(F.originalDestinations,F.commandType);if(this.Xoc(F.commandType,F.expandDestinations)||this.ccf())return F.userHash=this.userHash,F.id=Tb.a.create().toString(),ui(this.$)&&(F.isAsyncSystemClipboardEnabled=!0),this.vUa.onPaste(F).then(sc=>this.ROc(sc,F),sc=>this.O_b(F,sc));this.$.Dc(927125067,jc.a.Hb,30,null);lb=gc.k(F.expandDestinations,",",this.$,!1);C.ULS.sendTraceTag(24150913,0,15,`CopyPasteInfrastructure.OnPaste: paste was triggered but the estimated destination range is not editable, do nothing. ExpandDestinations: ${lb}, CommandType: ${F.commandType}, copyPasteTargetType="${F.copyPasteTargetType}"`);
return Promise.resolve(!0)}jNd(F){switch(F){case 1804571062:return 6;case -185374993:return 7;case 1766348718:return 8;case -875588320:return 19;default:return 3}}ccf(){return!!fa.f(this.$).ha.ob.activeFloatingObjectControlId&&this.$.Ss(null,!1,470)}XIa(){const F=Dg(this.jG);return F&&F.commandParameters?F.commandParameters.copyPasteTargetType:0}Lsj(){return!!Dg(this.jG)&&eg(Dg(this.jG),this.$)}Vr(F,va,lb,sc,Yc){lb=void 0===lb?!1:lb;sc=void 0===sc?!1:sc;Yc=void 0===Yc?0:Yc;try{this.rqb&&this.rqb.Ptc();
let jd=Yc;const Ad=this.FAj();if(!sc&&2===Ad)return C.ULS.sendTraceTag(537167821,0,50,`CopyPasteInfrastructure.ClearState clipboard won't be cleared as there's art in the clipboard. clearClipboardContent = '${va}', isExplicit = '${lb}', isForce = '${sc}', Current CCP operation copyPasteTargetType = '${Yc}', LastCopyPasteTargetType = '${Ad}'`),Promise.reject(null);0===jd&&(jd=Ad);const Kd=this.$.Vb.Uc("UserAction","ClearCopyState"),ye=Kd.id;C.ULS.sendTraceTag(537167820,0,50,`CopyPasteInfrastructure.ClearState clear clipboard state. clearClipboardContent = '${va}', isExplicit = '${lb}', isForce = '${sc}', Current CCP operation copyPasteTargetType = '${Yc}', LastCopyPasteTargetType = '${Ad}'`);
this.$u.MRd();this.xjk();return this.vUa.onCancelCopy(va).then(()=>{va&&Rg.a.hZa&&(this.hmb=!1);Kd.stop();this.P$f(F,ye,!0,lb,va,"","",Kd.Kc,jd);return Promise.resolve(!0)},Ne=>{var hf=Ne?this.getStringifiedError(Ne):"null";C.ULS.sendTraceTag(24150915,0,15,`CopyPasteInfrastructure.ClearState: error during call to copyPasteFlowManager.OnClear(). error: ${hf}`);Kd.stop();hf=$d.rVh+$d.oFa;let sf=$d.Dfb;Ne&&(hf+=$d.yGa(Ne),Ne.message&&(sf=Ne.message));this.P$f(F,ye,!1,lb,va,sf,hf,Kd.Kc,jd);return Promise.reject(Ne)})}catch(jd){return Promise.reject(null)}}Pvd(F,
va,lb,sc){var Yc=void 0;Yc=void 0===Yc?!1:Yc;lb=void 0===lb?!1:lb;sc=void 0===sc?0:sc;return lb||this.SEa()?this.Vr(F,va,Yc,lb,sc):(C.ULS.sendTraceTag(537167819,0,50,"CopyPasteInfrastructure.ClearStateOnlyIfClipboardHasContentFromSameSession clipboard won't be cleared as there is no content in the clipboard from the current session"),Promise.reject(null))}JKa(F,va,lb){C.ULS.sendTraceTag(590705172,0,50,`CopyPasteInfrastructure.PopupDiscontinuousSelectionErrorDialog: Blocked CCP due to discontinuous selection, reason: ${va}`);
const sc=new Cd.a;sc.ga("reason",va);we.a(Xc.a.discontinuousSelectionBlocking,[lb?Bd.a.lak:Bd.a.J4h],!0,!0,!1,!1,sc);F=Xd.a.Cd(1,1,751,F,0,371863010,"DiscontinuousSelectionBlocking");new Aa.a(this.$,F)}FAj(){const F=Dg(this.jG);return F&&F.sourceItem&&Object.getType(F.sourceItem)!==lh?Object.getType(F.sourceItem)===fg?2:1:0}Fji(F,va,lb,sc,Yc){Yc=void 0===Yc?!1:Yc;F.stopwatch=this.$.Vb.Uc("UserAction","DragDropReplaceClientSide");F.isDragDrop=!0;this.Pvd("DragDropReplace/before/"+te.a[F.ribbonCommandInfo.method],
!1,void 0,F.copyPasteTargetType).catch(()=>{});const jd=Yc?2:1;let Ad=0;Ad=Yc?4:sc?256:128;const Kd={encounteredDeploymentErrors:!1};Kd.commandParameters=F;F.isDragInsert=!1;F.userHash=this.userHash;F.id=Tb.a.create().toString();return this.$u.pasteRange(F.ribbonCommandInfo,gc.t(va,this.$),gc.t(lb,this.$),jd,Ad,[F.stopwatch],Kd,!1,()=>{C.ULS.sendTraceTag(537167816,0,50,`CopyPasteInfrastructure.DragDropReplaceCells: success. copyPasteTargetType="${F.copyPasteTargetType}"`);this.W$f(F,jd,va,lb,Kd)},
ye=>this.Alg(ye,F,jd,va,lb,Kd)).then(()=>{this.da.ha.selectionType=-1;return Promise.resolve(!0)},ye=>Promise.reject(ye))}$qf(F,va,lb,sc,Yc){Yc=void 0===Yc?!1:Yc;F.stopwatch=this.$.Vb.Uc("UserAction","DragDropInsertClientSide");this.Pvd("DragDropInsert/before/"+te.a[F.ribbonCommandInfo.method],!1,void 0,F.copyPasteTargetType).catch(()=>{});const jd=Yc?2:1,Ad=gc.S(this.Moc([lb],jd));var Kd=this.$.fa.la.sheetName;const ye=this.$.fa.la.sheetName,Ne=gc.y(va,this.$);Ne.SheetName=Kd;Kd=gc.y(Ad,this.$);
Kd.SheetName=ye;sc=Ad.isRow||va.isRow||sc?1:0;const hf={encounteredDeploymentErrors:!1};F.isDragInsert=!0;hf.commandParameters=F;F.userHash=this.userHash;F.id=Tb.a.create().toString();Yc=this.$u.Iji(hf,Ne,Kd,Yc,sc,F.ribbonCommandInfo,()=>{C.ULS.sendTraceTag(537167814,0,50,`CopyPasteInfrastructure.DragDropInsertCells: success. copyPasteTargetType="${F.copyPasteTargetType}"`);this.W$f(F,jd,va,lb,hf)},sf=>{this.Alg(sf,F,jd,va,lb,hf)});return Zb.d(Yc.then(()=>{this.da.ha.selectionType=-1;return Promise.resolve(!0)},
sf=>Promise.reject(sf))).jw(()=>!0)}TTd(F,va,lb,sc,Yc){var jd=Dg(this.jG);if(!jd)return C.ULS.sendTraceTag(537167812,0,50,"InsertCopiedCutCells: CopyContext must not be null or undefined"),ia.Task.Va(!1);if(!tg(jd.sourceItem))return C.ULS.sendTraceTag(537167811,0,50,"InsertCopiedCutCells: CopyContext must be a Range"),ia.Task.Va(!1);var Ad=jd.sourceItem;if(!Ad)return C.ULS.shipAssertTag(537167810,0,!!Ad,"InsertCopiedCutCells: rangeSourceItem must not be null or undefined"),ia.Task.Va(!1);if(1<Ad.ranges.length)return C.ULS.sendTraceTag(537167808,
0,50,"InsertCopiedCutCells: multiple source ranges are not supported"),this.JKa(2192,"InsertCopiedCutCells",!0),ia.Task.Va(!1);jd=gc.S(Ad.ranges);var Kd=this.da.ha.oa.Ed.clone();F=gc.S(this.Moc([Kd],F));const ye=this.h8f();Ad=Ad.sheetName;Kd=this.$.fa.la.sheetName;const Ne=gc.y(jd,this.$);Ne.SheetName=Ad;const hf=gc.y(F,this.$);hf.SheetName=Kd;Ad=this.da.ha.oa.activeRange;const sf=()=>{C.ULS.sendTraceTag(508929747,0,50,"InsertCopiedCutCellsCrossSession Succeeded")},Gf=()=>{C.ULS.sendTraceTag(508929746,
0,50,"InsertCopiedCutCellsCrossSession Failed")};return(F.Oe||jd.Oe||this.$u.CSk(this.$,jd,Ad)?ia.Task.Va(0):F.isRow||jd.isRow||this.$u.DSk(this.$,jd,Ad)?ia.Task.Va(1):this.Kjj.Brc(this.$,fa.f(this.$).rtl)).jw(Yf=>this.SEa()?this.$u.executeInsertCopiedCutCellsOperation(Ne,hf,ye,Yf.result,va,null,null):this.$u.executeInsertCopiedCutCellsAcrossSession(Ne,hf,ye,Yf.result,va,sf,Gf,lb,sc,Yc)).continueWith(()=>{this.Vr("InsertCopiedCutCells/success/"+te.a[va.method],!0)})}NUb(){const F=Dg(this.jG),va=this.da.ha.oa.vi;
return!!F&&tg(F.sourceItem)&&va&&1===F.sourceItem.ranges.length}h8f(){return this.i8f(-911352779)}SVb(){var F,va;const lb=Dg(this.jG);return lb?(null===(F=lb.asyncClipboardItemsKeys)||void 0===F?void 0:F.includes(gg.a.shadowWorkbook))||(null===(va=lb.syncClipboardItemsKeys)||void 0===va?void 0:va.includes(gg.a.shadowWorkbook))||3!==lb.copyStatus:!1}GJc(){return this.i8f(-1985798686)}Xoc(F,va){var lb=new kd.SheetProtection(this.$.qa),sc=36===F;const Yc=lb.ie(4);F=2===this.XIa()&&lb.ie(1);sc=sc&&Yc;
lb=!lb.Ih||!this.GJc()||!kd.SheetProtection.luc(va,fa.f(this.$));return sc||F||this.$.Ss(va,!0)&&lb}rlb(F,va){return this.$u.rlb(F,va)}dispose(){super.dispose();this.Bi();this.jG.removeMetadataChangeListener($d.ofg)}oCd(F,va,lb,sc,Yc){let jd=null;if(!this.uZh(F.commandParameters.ribbonCommandInfo.command))return F.cseStatus=2,!1;if(sc.width%va.width||sc.height%va.height)return F.cseStatus=16,!1;if(sc.Oe||sc.isRow)return F.cseStatus=31,!1;oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PasteOnlyOnVisibleCells",
!1)&&(jd=this.Kdj(sc,F.commandParameters.id,F.id));const Ad=sc.Xe(this.da.Ek);if(!Ad)return F.cseStatus=7,!1;var Kd=this.t$e(this.da,F.commandParameters.ribbonCommandInfo.command,va);if(0!==Kd)return F.cseStatus=Kd,!1;Kd=this.t$e(this.da,F.commandParameters.ribbonCommandInfo.command,Ad);if(0!==Kd)return F.cseStatus=Kd,!1;Kd=gc.y(va,this.$);Kd.SheetName=lb;lb=this.$e.qak(this.da,Kd,gc.y(Ad,this.$),F.commandParameters.ribbonCommandInfo.command,jd,F.commandParameters.stopwatch);1===lb&&(Yc&&(va.ld(sc)?
(sc=gc.gb(va,F.commandParameters.expandDestinations[0]),this.$e.Gvd(sc,!1,F.commandParameters.id),this.$e.Gvd(sc,!0,F.commandParameters.id)):(this.$e.Tpc(va,!1),this.$e.Tpc(va,!0))),va=new Q(F.commandParameters.ribbonCommandInfo.command,Ad,va),fa.f(this.$).qfe(va),this.pasteIndicationManager.qYa(F.commandParameters.id,!0),this.ptb(F.commandParameters.expandDestinations,F.commandParameters.isPasteCommandFromRecoveryUI),this.Wpc("DoPasteClientEstimation/"+te.a[F.commandParameters.ribbonCommandInfo.method],
F));F.cseStatus=lb;return 1===lb}t$e(F,va,lb){F=new Ja.a("CopyPasteInfrastructure.blockCseForPaste",F,lb);try{for(;F.moveNext();){const sc=F.get_current().cell;if(sc.eB)return 8;if(237279923===va||1804571062===va){if(!oa.EwaSettings.JIa()&&sc.mA)return 18;if(sc.tN)return 19}}}catch(sc){nc.a.yi(sc,"CopyPasteInfrastructure.BlockCseForPasteRange: exception thrown before CSE")}finally{F&&F.dispose()}return 0}$xg(){ui(this.$)?(new W(this.$)).showDialog(!0,!1,!1,this.hGj):(!oa.EwaSettings.isChangeGateEnabled("OfficeVSO:8971211_RemoveInstallExtensionDialog")&&
(wa.a.Wp||wa.a.mHc||wa.a.CZf)?new Vb(this.$):new bb(this.$)).showDialog(!0,!1,!1,this.jHj)}NGj(F,va,lb,sc){F=Of(F,va,lb,sc,this.$.ta.UserSessionId);F.k=!0;rg.logData(45,F,!0)}B3j(F,va,lb,sc,Yc){var jd=!1,Ad=!1,Kd=$d.Dfb,ye=$d.Yqf+$d.oFa;F&&(ye+=$d.yGa(F),Xd.a.Ls(F.ewaErrors)?(Kd=this.Fzc(F.ewaErrors),Xd.a.hi(F.ewaErrors,[-103190598,1512686094])&&(jd=!0)):F.message&&(Kd=F.message));Ad||(Ad=this.nWd(F));va=Of(va,lb,sc,Yc,this.$.ta.UserSessionId);va.k=!1;va.l=Ad;va.n=Kd;va.p=ye;va.q=jd;rg.logData(45,
va,!0);return Promise.reject(F)}prd(F,va,lb,sc){let Yc;if(!this.VUf)return F.cseStatus=40,Ae.a.Va(!1);if(oa.EwaSettings.isChangeGateEnabled("OfficeVSO:8968485_AddLimitForPasteHtmlCse")&&102400<va.length)return F.cseStatus=47,Ae.a.Va(!1);const jd=this.Ypj(F.commandParameters.ribbonCommandInfo.command,lb,this.da);if(0!==jd)return F.cseStatus=jd,Ae.a.Va(!1);fb.TaskExtensions.ts(Ae.a.delay(0),()=>{Yc=this.VUf.J$j(va,sc).result;return Ae.a.Va(!0)},sc.token).continueWith(()=>{C.ULS.sendTraceTag(507582610,
0,50,`CopyPasteInfrastructure.AttemptExternalHtmlPasteClientEstimation: pasteId=${F.id}, result=${JSON.stringify(null===Yc||void 0===Yc?void 0:Yc.nL)}`);if(1!==(null===Yc||void 0===Yc?void 0:Yc.cseStatus))return F.cseStatus=Yc?Yc.cseStatus:46,Ae.a.Va(!1);if(sc.token.oI)return F.cseStatus=39,Ae.a.Va(!1);var Ad=lb.topLeft?this.o8h(lb.topLeft,Yc.yYa):lb;F.commandParameters.expandDestinations=[Ad];if(!fa.h(this.da,Ad))return F.cseStatus=7,Ae.a.Va(!1);F.cseStatus=this.$e.nak(this.da,Yc.yYa,lb.topLeft,
sc,F.commandParameters.stopwatch);return 1===F.cseStatus?(Ad=new Q(F.commandParameters.ribbonCommandInfo.command,lb,null),fa.f(this.$).Ce.LO(F.commandParameters.stopwatch.id,yc.BasicTelemetryCalculator.zN),fa.f(this.$).qfe(Ad),this.pasteIndicationManager.qYa(F.commandParameters.id,!0),this.ptb(F.commandParameters.expandDestinations,F.commandParameters.isPasteCommandFromRecoveryUI),this.Wpc("AttemptExternalHtmlPasteClientEstimation/"+te.a[F.commandParameters.ribbonCommandInfo.method],F),Ae.a.Va(!0)):
Ae.a.Va(!1)});return Ae.a.Va(!1)}nMh(F,va,lb){F.cseStatus=0;F.cseStatus=this.$pj(F.commandParameters.ribbonCommandInfo.command,lb,this.da,va);if(0!==F.cseStatus)return!1;F.cseStatus=this.$e.rak(this.da,va,lb,F.commandParameters.stopwatch);va=new Q(F.commandParameters.ribbonCommandInfo.command,lb,null);1===F.cseStatus&&(fa.f(this.$).qfe(va),this.pasteIndicationManager.qYa(F.commandParameters.id,!0),this.ptb(F.commandParameters.expandDestinations,F.commandParameters.isPasteCommandFromRecoveryUI),this.Wpc("AttemptExternalPlainTextPasteClientEstimation/"+
te.a[F.commandParameters.ribbonCommandInfo.method],F));return 1===F.cseStatus}Ypj(F,va,lb){return 237279923!==F?2:lb.Eb.Glb(va)?8:lb.Eb.tU(va)?11:this.$e.vuc(va)?12:0}o8h(F,va){return oa.EwaSettings.isChangeGateEnabled("OfficeVSO:8910362_FixMathMaxJsCrash")?new pc.Range(F.top,F.left,F.top+va.reduce((lb,sc)=>sc.rowIndex>lb?sc.rowIndex:lb,0),F.left+va.reduce((lb,sc)=>sc.colIndex>lb?sc.colIndex:lb,0),!0,!0):new pc.Range(F.top,F.left,F.top+Math.max(...va.map(lb=>lb.rowIndex)),F.left+Math.max(...va.map(lb=>
lb.colIndex)),!0,!0)}$pj(F,va,lb,sc){if(-875588320!==F&&-185374993!==F&&237279923!==F)return 2;if(lb.Eb.Glb(va))return 8;if(!oa.EwaSettings.JIa()&&lb.Eb.jzj(va))return 18;if(lb.Eb.tU(va))return 11;if(this.$e.vuc(va))return 12;F=this.wTh(va,sc);return fa.h(this.da,F)?0:7}wTh(F,va){var lb=va.indexOf("\r");lb=-1!==lb?"\n"===va[lb+1]?va.split("\r\n"):va.split("\r"):va.split("\n");va=lb.length;lb=lb[0].split("\t").length;return new pc.Range(F.top,F.left,F.top+va-1,F.left+lb-1,!0,!0)}uZh(F){switch(F){case 237279923:case 808159687:case -185374993:case 1804571062:case -875588320:return!0;
case 264209770:return oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PasteWithColumnWidthCSEEnabled",!1);default:return!1}}i8f(F){const va=Dg(this.jG);return va?va.commandParameters.ribbonCommandInfo.command===F:!1}CQk(F){return F&&F.lastCopy?eg(F.lastCopy,this.$):!0}aIf(F,va,lb,sc,Yc){const jd={};jd.a=this.$.ta.UserSessionId;jd.e=F.stopwatch.id;jd.c=rg.resolveRibbonCommandName(F.ribbonCommandInfo.command);jd.b=te.a[F.ribbonCommandInfo.method];jd.d=F.id;jd.f=lb.toString();jd.g=sc.toString();
jd.h=va.toString();jd.o=F.stopwatch.Kc;jd.q=!1;jd.r=F.copyPasteTargetType.toString();jd.s=Yc.encounteredDeploymentErrors;jd.i=Yc.commandParameters.dragDropIsShiftKeyDown;jd.j=Yc.commandParameters.isDragInsert;oa.EwaSettings.Lx()&&(jd.t=Yc.commandParameters.isHeaderDrag);return jd}W$f(F,va,lb,sc,Yc){F=this.aIf(F,va,lb,sc,Yc);F.k=!0;rg.logData(45,F,!0)}ZEj(F,va,lb,sc,Yc,jd,Ad,Kd,ye){F=this.aIf(F,va,lb,sc,ye);F.k=!1;F.l=Yc;F.n=jd;F.p=Ad;F.q=Kd;rg.logData(45,F,!0)}P$f(F,va,lb,sc,Yc,jd,Ad,Kd,ye){const Ne=
{};Ne.a=this.$.ta.UserSessionId;Ne.b=va;Ne.c=F;Ne.f=lb;Ne.e=sc;Ne.d=Yc;Ne.g=jd;Ne.h=Ad;Ne.i=Kd;Ne.j=ye.toString();rg.logData(46,Ne,!0)}REj(F,va){F=this.sHf(F.commandParameters,F);F.l=!0;F.j=va;rg.logData(43,F,!0)}R$f(F,va,lb,sc,Yc,jd,Ad){F=this.sHf(F,Ad);F.l=!1;F.m=va;F.o=lb;F.y=sc;F.x=Yc;F.z=jd;rg.logData(43,F,!0);C.ULS.sendTraceTag(537167776,0,15,`CopyPasteInfrastructure.LogCopyFailedTelemetry: ErrorName=${F.y},ErrorReason=${F.x},IsExpectedError=${F.m},IsSucceededWithAlert=${F.z},ErrorMessage=${F.o}`)}sHf(F,
va){const lb={};lb.a=this.$.ta.UserSessionId;lb.f=F.stopwatch.id;lb.g=F.id;lb.c=rg.resolveRibbonCommandName(F.ribbonCommandInfo.command);lb.b=te.a[F.ribbonCommandInfo.method];lb.q=F.stopwatch.Kc;lb.bd=$d.Qyc();lb.bg=F.copyPasteHandlerName;lb.bj=void 0===F.ribbonCommandInfo.Re||null===F.ribbonCommandInfo.Re?null:Ve.a[F.ribbonCommandInfo.Re];lb.bq=F.uploadToClipService;lb.br=F.floatingObjectType;lb.s=F.copyPasteTargetType.toString();lb.bc=th(F.copyPasteTargetType);lb.z=!1;if(va){lb.bk=va.id;lb.bl=va.serverRequestTimeInMs;
va.requestTelemetryData&&(lb.bm=va.requestTelemetryData.EcsOperationDuration,lb.bn=va.requestTelemetryData.EcsRequestDuration,lb.bo=va.requestTelemetryData.WfeRequestDuration);lb.d=va.sourceItem?va.sourceItem.toString():null;lb.e=-1;if(tg(va.sourceItem)){lb.e=0;F=va.sourceItem.ranges;for(const sc of F)lb.e+=sc.gu}lb.h=va.isAsyncCopy;lb.i=va.isFromCache;lb.k=va.isSelectionAllowed;lb.r=va.plainTextPayloadSize;lb.u=va.htmlPayloadSize;lb.v=va.htmlSizeExceedsLimit;lb.w=va.copyTotalSizeExceedsLimit;lb.t=
va.shadowWorkbookPayloadSize;lb.p=va.clientSideCopyTime;lb.ba=va.encounteredDeploymentErrors;lb.bb=va.shadowWorkbookSizeExceedsLimit;lb.be=va.syncClipboardItemsKeys;lb.bf=va.asyncClipboardItemsKeys;lb.bh=this.Mif(va.succeededPopulatingSystemClipboardSync);lb.bi=this.Mif(va.succeededPopulatingSystemClipboardAsync);ui(this.$)&&(lb.bs=va.commandParameters.isAsyncClipboardAPI)}return lb}ptb(F,va){va=void 0===va?!1:va;if(!this.da.isEditing&&!this.da.nk){var lb=this.da.ha.oa,sc=!va&&1===F.length&&gc.Y(F,
lb.selectedRanges),Yc=sc?lb.activeCell:F[0].topLeft;F[0].contains(Yc)||(C.ULS.shipAssertTag(537167775,0,!1,`CopyPasteInfrastructure.SelectPastedRange: SelectedRanges ${lb.selectedRanges}, IndexOfActiveRange ${lb.mt}, ActiveCell ${lb.activeCell}, calculatedDestinationRanges ${F}, keepThePreviousActiveCell ${sc}, newActiveCell ${Yc}, isPasteCommandFromRecoveryUI ${va}`),Yc=F[0].topLeft);this.da.ha.VI(F,0,Yc,0,void 0,"CopyPasteInfrastructure.SelectPastedRange")}}WLf(F,va){var lb,sc,Yc;const jd={};jd.a=
this.$.ta.UserSessionId;jd.g=F.stopwatch.id;jd.t=F.stopwatch.Kc;jd.bz=!1;va&&(jd.bv=va.id,jd.bw=va.serverRequestTimeInMs,jd.n=va.commandParameters.clipboardFormatReadTimes,jd.o=va.commandParameters.clipboardFormatReadStatus,jd.q=va.commandParameters.asyncApiReadTimedOut,va.requestTelemetryData&&(jd.cb=va.requestTelemetryData.EcsOperationDuration,jd.cc=va.requestTelemetryData.EcsRequestDuration,jd.cd=va.requestTelemetryData.WfeRequestDuration));jd.x=F.copyPasteTargetType.toString();jd.bl=th(F.copyPasteTargetType);
jd.br=F.copyPasteHandlerName;jd.i=(null===va||void 0===va?0:va.isHtmlPaste)?gc.k(gc.i(va.pastedRange.Ranges),",",this.$,!1):gc.k(F.expandDestinations,",",this.$,!1);jd.h=gc.k(F.originalDestinations,",",this.$,!1);jd.e=F.id;jd.d=F.commandType;jd.c=rg.resolveRibbonCommandName(F.ribbonCommandInfo.command);jd.b=te.a[F.ribbonCommandInfo.method];jd.bf=!1;jd.bg=!1;jd.bp=$d.Qyc();jd.bt=void 0===F.ribbonCommandInfo.Re||null===F.ribbonCommandInfo.Re?null:Ve.a[F.ribbonCommandInfo.Re];jd.cj=F.isPasteCommandFromEnterShortcut;
if(jd.ca=F.isPasteCommandFromRecoveryUI)jd.cf=F.pasteRecoveryUndoStopwatch.id,jd.cg=F.pasteRecoveryUndoStopwatch.Kc;if(oa.EwaSettings.isChangeGateEnabled("OfficeVSO:8934631_logPasteOnFilterRangeData")&&0<(null===(lb=null===F||void 0===F?void 0:F.expandDestinations)||void 0===lb?void 0:lb.length)){lb=this.$.Vb.Uc("Task","PasteOnFilterRange");const Ad=F.expandDestinations[0];F=this.da.Eb.J3f(Ad);const Kd=lb.Kc;let ye=0;if(F){const Ne=this.da.hd,hf=Object(Qd.a)(this.$,Ad),sf=this.$.qa.getItemByName(this.$.la.sheetName);
ye=lb.Kc-Kd;jd.co=!0;jd.cp=null!==(Yc=null!==(sc=null===hf||void 0===hf?void 0:hf.hasActiveFilter)&&void 0!==sc?sc:null===sf||void 0===sf?void 0:sf.hasActiveFilter)&&void 0!==Yc?Yc:!1;jd.cq=Ne.pva(Ad);jd.cr=Ne.yZa(Ad)}sc=lb.Kc;lb.stop();C.ULS.sendTraceTag(507121804,0,50,`CopyPasteInfrastructure.getPasteUsageData: ${JSON.stringify({destinationIsFilteredRange:F,timeTakenToIdentifyFilteredRange:Kd,timeTakenToGetFilterObject:ye,totalTime:sc})}`)}if(va){if((sc=va.copyContextSnapshot)&&!va.wasLastCopyExternal){jd.f=
sc.commandParameters.id;jd.j=sc.sourceItem.toString();jd.k=-1;if(tg(sc.sourceItem)){jd.k=0;Yc=sc.sourceItem.ranges;for(const Ad of Yc)jd.k+=Ad.gu}jd.bg=1===sc.commandParameters.commandType}else va.clipboardItems?jd.f=va.clipboardItems.getItem(gg.a.qrc):C.ULS.sendTraceTag(537167774,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext.ClipboardItems is null");jd.bz=va.pasteRecoveryUIDisplayed;jd.ci=va.cseStatus}else C.ULS.sendTraceTag(537167773,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext is null");
return jd}qGj(F,va,lb,sc,Yc,jd,Ad,Kd,ye){var Ne,hf;F=this.WLf(F,Kd);F.l=!1;F.m=va;F.s=lb;F.bc=sc;F.be=Yc;F.bd=jd;F.bf=Ad;if(Kd){F.y=Hg(Kd)||!Kd.copyContextSnapshot;F.bi=!F.y&&eg(Kd.copyContextSnapshot,this.$);F.bj=Kd.shadowWorkbookSizeExceedsLimit;F.v=Kd.shadowWorkbookPayloadSize;F.w=Kd.htmlPayloadSize;F.bq=uh(Kd.clipboardItems);F.bb=Kd.activeSelectionType;F.bs=Kd.isSameSession;F.bn=Kd.payloadOrigin;F.bo=Kd.payloadType;F.bu=Kd.externalAppSource;F.bx=Kd.indicationDisplayScheduled;F.by=Kd.pasteIndicationDisplayStatus;
F.ck=Kd.pasteDestinationHasMergedCells;if(oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)||oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1))F.cl=Kd.ArtSourceItemType;ui(this.$)&&(F.cm=null===(Ne=Kd.commandParameters)||void 0===Ne?void 0:Ne.isAsyncClipboardAPI);F.cn=null===(hf=Kd.commandParameters)||void 0===hf?void 0:hf.isChromiumExtension}else F.bi=eg(ye,this.$);rg.logData(44,F,!0);C.ULS.sendTraceTag(537167772,
0,15,`CopyPasteInfrastructure.LogPasteFailedTelemetry: ErrorName=${F.be},ErrorReason=${F.bd},IsExpectedError=${F.m},IsSucceededWithAlert=${F.bf},ErrorMessage=${F.s}`)}sGj(F){var va,lb;const sc=this.WLf(F.commandParameters,F);sc.y=F.wasLastCopyExternal;sc.l=!0;sc.u=F.plainTextPayloadSize;sc.v=F.shadowWorkbookPayloadSize;sc.w=F.htmlPayloadSize;sc.z=F.isClipboardDataContainShadowWorkbook;sc.ba=F.isShadowWorkbookParsedSuccessfully;sc.bb=F.activeSelectionType;sc.bc=F.pasteResult;sc.bh=F.encounteredDeploymentErrors;
sc.bj=F.shadowWorkbookSizeExceedsLimit;sc.bk=qh(F);sc.bq=uh(F.clipboardItems);sc.bs=F.isSameSession;sc.bn=F.payloadOrigin;sc.bo=F.payloadType;sc.bu=F.externalAppSource;sc.bx=F.indicationDisplayScheduled;sc.by=F.pasteIndicationDisplayStatus;sc.ck=F.pasteDestinationHasMergedCells;sc.bm=F.clipboardItems?F.clipboardItems.getItem(gg.a.iYh):null;sc.bi=!F.isSameSession&&!F.wasLastCopyExternal;sc.ci=F.cseStatus;if(oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",
!1)||oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1))sc.cl=F.ArtSourceItemType;ui(this.$)&&(sc.cm=null===(va=F.commandParameters)||void 0===va?void 0:va.isAsyncClipboardAPI);sc.cn=null===(lb=F.commandParameters)||void 0===lb?void 0:lb.isChromiumExtension;rg.logData(44,sc,!0)}Aj(){this.$.qa.mh(this.Gj);this.$.qa.vEh(this.oOc);this.$.userOperationManager.Kp(this.eZ);this.$.Ul(this.de);fa.f(this.$).Rb.Jp(this.o3);fa.f(this.$).Rb.WS(this.WU)}Bi(){this.$&&
this.$.qa&&(this.$.qa.xh(this.Gj),this.$.qa.otk(this.oOc));this.$&&this.$.userOperationManager&&this.$.userOperationManager.kn(this.eZ);this.da&&this.da.Rb&&(this.da.Rb.zp(this.o3),this.da.Rb.zZ(this.WU))}O_b(F,va){var lb=null;let sc=!1;var Yc=null;let jd="UnknownFailure",Ad=-1,Kd=$d.Dfb,ye=$d.pasteErrorName+$d.oFa,Ne=!1;this.pasteIndicationManager.qYa(F.id,!1);this.pasteDestinationHasMergedCells(F.expandDestinations)&&(va.pasteContext.pasteDestinationHasMergedCells=!0);const hf=Dg(this.jG);(F.clearStateOnFinish||
F.clearSystemClipboard)&&this.Vr("Paste/fail/"+te.a[F.ribbonCommandInfo.method],!0,void 0,void 0,F.copyPasteTargetType).catch(()=>{});if(va){Ad=va.reason;ye+=$d.yGa(va);va.message&&(Kd=va.message);if(lb=$d.V3h(va))if(1===lb.pasteErrorName)sc=!0,jd="CopyPasteLengthTooLongPopup",Kd=Yc="The pasted content is too long. Popup a dialog to the user.",C.ULS.sendTraceTag(25216992,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Yc}, copyPasteTargetType="${F.copyPasteTargetType}"`),lb=Xd.a.Cd(1,0,26,690,0,1306609195,
"CopyPasteOversizeError"),new Aa.a(this.$,lb);else if(7===lb.pasteErrorName)sc=!0,jd="No-Op",Kd=Yc="The shadow workbook is not ready yet and an async copy failed to populate the clipboard. Do nothing (by the spec)",C.ULS.sendTraceTag(33948251,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Yc}, copyPasteTargetType="${F.copyPasteTargetType}"`);else if(8===lb.pasteErrorName)sc=!0,jd="UseShortcutsPopup",Kd=Yc="Unable to paste content from the system clipboard. Popup dialog to the user.",C.ULS.sendTraceTag(25216994,
0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Yc}, copyPasteTargetType="${F.copyPasteTargetType}"`),this.$xg();else if(18===lb.pasteErrorName){sc=!0;jd="PasteExternalNotSupportMultipleSelectionPopup";Kd="Paste external not support multiple selection.";Yc="Unknown";var sf=2192;100!==lb.validationFailureReason&&(Yc=ka[lb.validationFailureReason],sf=$d.Cif(lb.validationFailureReason));this.JKa(sf,Yc,!0)}else 20===lb.pasteErrorName||19===lb.pasteErrorName?(sc=!0,20===lb.pasteErrorName?(jd="PasteAcrossSessionNotSupportMultipleSelectionPopup",
Kd="Paste across session does not support multiple selection."):(jd="PasteInSameSessionNotSupportMultipleSelectionPopup",Kd="This kind of multiple selection is not supported for same session paste."),Yc="Unknown",sf=2192,100!==lb.validationFailureReason&&(Yc=ka[lb.validationFailureReason],sf=$d.Cif(lb.validationFailureReason)),lb=6===lb.validationFailureReason,this.Xoc(F.commandType,F.expandDestinations)&&lb&&this.ptb(F.expandDestinations),this.JKa(sf,Yc,!0)):6===lb.pasteErrorName?(sc=!0,jd="No-Op",
Kd=Yc="Paste Formatting/Transpose is not yet a supported operation on System Clipboard based content",C.ULS.sendTraceTag(36263241,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Yc}, copyPasteTargetType="${F.copyPasteTargetType}"`)):17===lb.pasteErrorName?(sc=!0,jd="No-Op",Kd=Yc="Paste text on Art is not yet a supported operation",C.ULS.sendTraceTag(0,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Yc}, copyPasteTargetType="${F.copyPasteTargetType}"`)):16===lb.pasteErrorName?(sc=!0,jd="No-Op",Kd=Yc=
"Paste has failed because the previous copy has failed",lb=this.getStringifiedError(lb),C.ULS.sendTraceTag(537167771,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Yc}, copyPasteTargetType="${F.copyPasteTargetType}", error=${lb}`)):Xd.a.Ls(lb.ewaErrors)?(Xd.a.Waa(lb.ewaErrors)||Xd.a.hi(lb.ewaErrors,Xd.a.IBc())?(sc=!0,jd="CommunicationError",Yc=Xd.a.pc(lb.ewaErrors),C.ULS.sendTraceTag(36304159,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Kd} copyPasteTargetType="${F.copyPasteTargetType}"`)):Xd.a.hi(lb.ewaErrors,
$d.WCk)?(sc=!0,jd="SavingWorkbookError",Yc=Xd.a.pc(lb.ewaErrors),C.ULS.sendTraceTag(36304160,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Kd} copyPasteTargetType="${F.copyPasteTargetType}"`)):Xd.a.hi(lb.ewaErrors,$d.operationSucceededWithAlert)&&(Ne=sc=!0,jd="OperationSucceededWithAlert",Yc=Xd.a.pc(lb.ewaErrors),C.ULS.sendTraceTag(36304161,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Kd} copyPasteTargetType="${F.copyPasteTargetType}"`)),sc||(Kd=this.Fzc(lb.ewaErrors),sc=this.nWd(va))):11===lb.pasteErrorName&&
(sc=!0,jd="No-Op",Kd="Paste has failed because user try copy cross-session oart object");15===va.reason&&(sc=!0,jd="No-Op",Kd="Rejecting deferred paste there is metadata update without copy context. Usually it means that copy canceled before finished.");Oa.a.equals(ye,Gg.chl,!1)&&(sc=!0,jd="No-Op",Kd="User hash of the copy is different then the user hash of the paste during cross-session copy-paste. Do nothing.")}sc||(lb=va?this.getStringifiedError(va):"null",C.ULS.sendTraceTag(24150916,0,10,`CopyPasteInfrastructure.OnPasteFailed: ${lb}, copyPasteTargetType="${F.copyPasteTargetType}"`));
this.qGj(F,sc,Kd,jd,ye,Ad,Ne,va.pasteContext,hf);return Promise.reject(va)}ROc(F,va){var lb;C.ULS.sendTraceTag(24150917,0,50,`CopyPasteInfrastructure.OnPasteSuccess: paste succeed. copyPasteTargetType="${va.copyPasteTargetType}"`);this.pasteIndicationManager.qYa(va.id,!0);if(this.wak(va.copyPasteTargetType,F)){Rg.a.hZa&&F.wasLastCopyExternal&&F.payloadType===xg.shadowWorkbook&&(this.hmb=!0);let sc=null;(null===(lb=F.pastedRange)||void 0===lb?0:lb.Ranges)&&0<F.pastedRange.Ranges.length?sc=gc.i(F.pastedRange.Ranges):
F.wasLastCopyExternal||(sc=va.expandDestinations);this.cFk(F,sc);if(this.aTk(F,sc)){lb=gc.e(va.originalDestinations);const Yc=1028===va.commandType?gc.e(va.expandDestinations):gc.e(sc);let jd=null;F.wasLastCopyExternal&&(va.isKeyboardEvent||va.isPasteCommandFromRecoveryUI)&&(jd={[$d.zwg]:F.clipboardItems});this.pasteDestinationHasMergedCells(va.expandDestinations)&&(F.pasteDestinationHasMergedCells=!0);F.pasteRecoveryUIDisplayed=!0;const Ad=new mh(this.$,lb,Yc,jd,this.zoom),Kd=Object(Zb.d)(Ka.a.resolve(Ba.RecoveryUIControllerService,
{xa:0}));264209770===va.ribbonCommandInfo.command?this.da.za.iKa(()=>{fb.TaskExtensions.tb(Kd,()=>{const ye=Kd.result;ye.hsd(Ad);ye.ute(va.ribbonCommandInfo.method)},this.Aa,8)}):fb.TaskExtensions.tb(Kd,()=>{const ye=Kd.result;ye.hsd(Ad);ye.ute(va.ribbonCommandInfo.method,va.event)},this.Aa,8)}this.kWj(F,sc)}this.Wpc("Paste/success/"+te.a[va.ribbonCommandInfo.method],F);this.sGj(F);this.xVg&&(!va.isKeyboardEvent||qh(F))&&this.$.fa.Kh.get(66)&&(C.ULS.sendTraceTag(537167770,0,15,"CopyPasteInfrastructure.OnPasteSuccess: show localStorage disable notification"),
this.xVg=!1,this.K5h());F=new Ec(va.expandDestinations,F.commandParameters.ribbonCommandInfo.command);this.cjk(F);return Promise.resolve(!0)}kWj(F,va){Ba.TableSuggestionManagerService.Oa()?void Ka.a.resolve(Ba.TableSuggestionManagerService,{xa:1}).then(lb=>{lb.d4g(F,va)}):fb.TaskExtensions.tb(cc.GetServiceTaskFactory.Ne(this.$.ra,534,535,1),lb=>{lb.result.d4g(F,va)},this.$.Aa,3)}aTk(F,va){return!va||1!==va.length||F.commandParameters.clearSystemClipboard||F.commandParameters.clearStateOnFinish||F.commandParameters.skipClipboardAccess?
!1:Hg(F)&&(va=F.clipboardItems.getItem(gg.a.plainText),F=F.clipboardItems.getItem(gg.a.html),void 0===va||null===va||va.length>this.RKj||void 0===F||null===F||F.length>this.EYb)?(C.ULS.sendTraceTag(537167769,0,50,"CopyPasteInfrastructure.ShouldShowPasteRecoveryUI: Not showing PasteRecoveryUI for external copy."),!1):!0}wak(F,va){return 1===F||va.payloadType===xg.plainText||va.payloadType===xg.html||Rg.a.hZa&&va.payloadType===xg.shadowWorkbook}pasteDestinationHasMergedCells(F){const va=fa.f(this.$).za.lv();
if(!va||!va.length)return!1;for(const lb of va)if(lb.nv(F[0]))return!0;return!1}Wpc(F,va){let lb;(()=>{let sc=this.Enj(va);({RTa:lb}=sc);return sc})().returnValue&&this.Vr(F,lb,void 0,void 0,va.commandParameters.copyPasteTargetType).catch(()=>{})}Alg(F,va,lb,sc,Yc,jd){const Ad=F?this.getStringifiedError(F):"null";let Kd=!1,ye=!1,Ne=!1,hf=$d.Dfb,sf=$d.Yqf+$d.oFa;F&&(sf+=$d.yGa(F),Xd.a.Ls(F.ewaErrors)?(hf=this.Fzc(F.ewaErrors),Xd.a.hi(F.ewaErrors,$d.operationSucceededWithAlert)&&(Kd=!0),Xd.a.hi(F.ewaErrors,
$d.dragDropNonEmptyRange)&&(ye=Ne=!0)):F.message&&(hf=F.message));Ne||(Ne=this.nWd(F));ye?this.da.ha.selectionType=-1:this.$u.Hmk(Yc);Ne||C.ULS.sendTraceTag(24150918,0,10,`CopyPasteInfrastructure.OnDragAndDropCellsFailed: ${Ad}, copyPasteTargetType="${va.copyPasteTargetType}`);this.ZEj(va,lb,sc,Yc,Ne,hf,sf,Kd,jd)}Moc(F,va){let lb=F;const sc=this.jUi();if(null===sc||void 0===sc?0:sc.ranges)lb=this.$u.VTh(va,sc.ranges,F);return lb}jUi(){const F=Dg(this.jG);return F&&tg(F.sourceItem)?F.sourceItem:null}xjk(){this.raiseEvent($d.rae,
null)}cjk(F){Object(rd.e)(()=>{this.raiseEvent($d.A5c,F)})}cFk(F,va){const lb=F.commandParameters.originalDestinations;va&&(gc.Y(this.da.ha.oa.selectedRanges,lb)?(this.ptb(va),F=$c.HelperMethods.NGb(va),C.ULS.sendTraceTag(537167767,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range, range: ${F}`)):F.commandParameters.isPasteCommandFromRecoveryUI?(this.ptb(va,!0),C.ULS.sendTraceTag(537167766,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range for IsPasteCommandFromRecoveryUI, range: ${va}, active cell: ${va[0].topLeft}`)):
(F=$c.HelperMethods.NGb(lb),C.ULS.sendTraceTag(537167765,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: user change his selection during paste operation. don't change selection. originalPasteDestinations: ${F}`)))}Enj(F){if(F.isPlainTextPaste||F.isHtmlPaste||Lg(F)||F.commandParameters.isPasteCommandFromEnterShortcut)return{returnValue:!0,RTa:!1};var va=F.copyContextSnapshot;if(F.commandParameters.clearStateOnFinish)return{returnValue:!0,RTa:!0};if(va&&tg(va.sourceItem)){var lb=va.sourceItem;
if(!lb.isFromCurrentSession(this.$))return{returnValue:!1,RTa:!0};va=-1985798686===va.commandParameters.ribbonCommandInfo.command;if(!(1<lb.ranges.length||1<F.commandParameters.expandDestinations.length)){const sc=gc.S(lb.ranges),Yc=gc.S(F.commandParameters.expandDestinations),jd=this.$.fa.la.sheetName;lb=lb.sheetName;if(lb===jd&&Yc.equals(sc))return{returnValue:!1,RTa:!0};if(lb===jd&&Yc.Xe(sc))return{returnValue:!(this.Q_a&&F.commandParameters.isFormatPainter),RTa:!1}}return{returnValue:va,RTa:!0}}return{returnValue:!1,
RTa:!0}}N5j(){Dg(this.jG)&&this.Vr("OnStartEdit",!1).catch(()=>{})}mXj(){Dg(this.jG)&&this.Vr("OnEndEdit",!0).catch(()=>{})}Fzc(F){F=Xd.a.dQi(F,$d.oFa);return this.OLj+la.a.qz(F).toString()}nWd(F){F=$d.yGa(F);return!!F&&Oa.a.FMb(F,$d.NLj)}K5h(){const F=Xd.a.Cd(1,2,327,328,wa.a.Wp?329:331,530046625,"ActivateLocalStorage"),va=Object(Zb.d)(Ka.a.resolve(Ba.BusinessBarManagerService,{xa:0}));fb.TaskExtensions.tb(va,()=>{va.result.lh(43,F)},this.Aa,3)}Mif(F){return void 0===F||null===F?Ah.jQj:F?Ah.success:
Ah.failed}static V3h(F){const va=F.innerError;return va&&0!==va.pasteErrorName?F.innerError:null}static E3h(F){const va=F.innerError;return va&&0!==va.copyErrorName?F.innerError:null}static yGa(F){let va="";if(!F)return $d.vnf;F.errorName&&(va=F.errorName,F.innerError&&(va+=$d.oFa+$d.yGa(F.innerError)));va||(va=F&&F.name?F.name:$d.vnf);return va}static Qyc(){$d.Ma||($d.Ma=nh.NYk);return $d.Ma}static Cif(F){switch(F){case 7:case 1:return 2199;case 5:return 2196;case 6:return 2195;case 8:case 3:case 2:case 4:case 9:case 10:return 2192;
default:return C.ULS.shipAssertTag(537167764,0,!1,`CopyPasteInfrastructure.ConvertPasteValidationOptionToJsStringId: no case for validationOptions = ${F}`),2199}}static F3h(F){switch(F){case 3:return 2193;case 1:return 2194;case 2:case 4:return 2192;default:return C.ULS.shipAssertTag(537167763,0,!1,`CopyPasteInfrastructure.ConvertCopySourceValidationOptionToJsStringId: no case for validationOptions = ${F}`),2199}}Kdj(F,va,lb){var sc,Yc;let jd;if(this.da.Eb.J3f(F)){this.da.hd.pva(F)&&(jd=this.Lyi(F));
const Ad=Object(Qd.a)(this.$,F);F=this.$.qa.getItemByName(this.$.la.sheetName);va={Kol:va,Jol:lb,wnl:Ad?"table":"autoFilter",Wol:0<(null===jd||void 0===jd?void 0:jd.length),cml:null!==(Yc=null!==(sc=null===Ad||void 0===Ad?void 0:Ad.hasActiveFilter)&&void 0!==sc?sc:null===F||void 0===F?void 0:F.hasActiveFilter)&&void 0!==Yc?Yc:!1};C.ULS.sendTraceTag(507295680,0,50,`CopyPasteInfrastructure.identifyHiddenRowsForPasteInFilteredRange: ${JSON.stringify(va)}`)}return jd}Lyi(F){const va=this.da.hd,lb=[];
for(let sc=F.Zw().FirstRow;sc<=F.Zw().LastRow;sc++){const Yc=F.Zw();Yc.FirstRow=Yc.LastRow=sc;va.pva(pb.a.sC(Yc))&&(F.bottom+=1,lb.push(sc))}return lb}}$d.ofg="EwaJsMetadataChangeListenerId";$d.rae="cpiOSC";$d.A5c="cpiPS";$d.fei="cpiDID";$d.Dfb="Unknown";$d.vnf="UnknownError";$d.oFa="_";$d.Yqf="DragAndDropError";$d.pasteErrorName="PasteError";$d.rVh="CancelError";$d.copyErrorName="CopyError";$d.NLj="MergedCellOverlap";$d.zwg="PasteRecoveryCachedClipboardItems";$d.WCk=[1352631530,1679665408];$d.operationSucceededWithAlert=
[-103190598,1512686094];$d.pasteDataLimitHit=[1306609195];$d.copyThrottlingError=[-386183710];$d.dragDropNonEmptyRange=[563945982];$d.Ma=null;Object(O.a)($d,"CopyPasteInfrastructure",nb.a,[837,838,4]);class Me{constructor(){this.meb=this.wff=null}}Object(O.a)(Me,"ClipboardPlatformInitializationResult",null,[]);var ff=a(791),jf=a(790),Lf=a(661),Ef=a(242),jg=a(118);const Eg=(F,va,lb,sc,Yc,jd,Ad,Kd)=>{Kd=void 0===Kd?null:Kd;Ad=F.$a(1,Ad);Ad.pasteHtmlParameters=va;return Ic.h(F,"PasteHtmlContent",Ad,
lb,sc,Yc,jd,64,Kd)},bh=(F,va,lb,sc,Yc,jd,Ad,Kd,ye,Ne)=>{Ne=void 0===Ne?null:Ne;ye=F.$a(9,ye);const hf={};hf.DestinationRange=va;hf.Source=lb;hf.AutoAdjustColumnsOn=sc;ye.pasteStringParameters=hf;return Ic.h(F,"PasteString",ye,Yc,jd,Ad,Kd,64,Ne)},ch=(F,va,lb,sc,Yc,jd,Ad,Kd)=>{Kd=void 0===Kd?null:Kd;Ad=F.$a(1,void 0===Ad?null:Ad);Ad.copyParameters=va;return Ic.h(F,"Copy",Ad,lb,sc,Yc,jd,0,Kd)},Fg=(F,va,lb,sc,Yc,jd,Ad,Kd)=>{Kd=void 0===Kd?null:Kd;Ad=F.$a(1,void 0===Ad?null:Ad);Ad.pasteParameters=va;return Ic.h(F,
"Paste",Ad,lb,sc,Yc,jd,64,Kd)};class og{constructor(F,va,lb){this.destinationRange=this.sourceRange=null;this.pasteFlags=0;this.sourceRange=F;this.destinationRange=va;this.pasteFlags=lb}}Object(O.a)(og,"MacroRecorderPasteRangePayload",null,[67]);class qg{constructor(F,va){this.content=this.destinationRange=null;this.destinationRange=F;this.content=va}getContent(){return this.content}}Object(O.a)(qg,"MacroRecorderPasteStringPayload",null,[67]);class Bh{constructor(F){this.pasteParameters=null;this.pasteParameters=
F}}Object(O.a)(Bh,"MacroRecorderPastePayload",null,[67]);var Jh=a(712),Rh=a(240);class hi{constructor(F){this.parameters=null;this.parameters=F}getParameters(){return this.parameters}}Object(O.a)(hi,"MacroRecorderRangeCopyCutCellsInsertedPayload",null,[67]);class Ni{constructor(F){this.sheetName=null;this.sheetName=F}getSheetName(){return this.sheetName}}Object(O.a)(Ni,"MacroRecorderFullSheetCopyPayload",null,[67]);class Eh{constructor(F,va){this.VWb=this.Eva=null;this.rUd=!1;this.s0=null;this.Tz=
(lb,sc)=>{if(2===sc.Fq)this.xu=[],this.Eva=null;else if(1===sc.Fq&&this.xu&&this.xu.includes(sc.jg)){lb=jg.a(sc.jg.operation.operationName);const Yc=sc.jg.dequeueUtcTime.getTime()-sc.jg.enqueueUtcTime.getTime();C.ULS.sendTraceTag(526758673,0,50,`CopyPasteUtils.OnQueueChanged: web method ${lb} returned, it took ${Yc} milliseconds to complete.`);this.xu.splice(this.xu.indexOf(sc.jg),1);this.Eva=null}};this.$=F;this.da=va;this.rUd&&(this.$.userOperationManager.Kp(this.Tz),this.xu=[]);zf.a.RHa()&&void Ka.a.resolve(Ba.AutoAdjustColumnsManagerService,
{xa:1}).then(lb=>{this.s0=lb})}get EYb(){return this.$.ta.CCPCopyPasteHtmlLimit}get qeg(){return this.$.ta.CCPPastePlainTextLimit}copy(F,va,lb,sc,Yc){sc=void 0===sc?null:sc;Yc=void 0===Yc?null:Yc;const jd=this.$.ma.sa.mc();this.rUd&&this.Y5();this.VWb=jd.ClientRequestId;var Ad=new ub.a(505,0,(Kd,ye,Ne)=>{const hf={CopyPasteTargetType:1};hf.SourceRanges=F;hf.CopyOperationId=va.id;return this.Eva=ch(this.$.ma.gyd,hf,xd.c(Kd,lb),sc?xd.b(ye,sc):ye,Ne,va.ribbonCommandInfo,jd,Yc)},80);Ad=this.$.userOperationManager.enqueueOperation(Ad,
va.ribbonCommandInfo);this.rUd&&this.xu.push(Ad)}fullSheetCopy(F,va,lb,sc){sc=void 0===sc?null:sc;const Yc=this.$.ma.sa.mc();this.VWb=Yc.ClientRequestId;const jd=new ub.a(609,0,(Ad,Kd,ye)=>{var Ne=this.$.ma.sa;Ad=xd.c(Ad,lb);Kd=sc?xd.b(Kd,sc):Kd;var hf=va.ribbonCommandInfo;const sf=Ne.$a(1,void 0===Yc?null:Yc);sf.sheetName=F;return this.Eva=Ic.h(Ne,"CopySheetToShadowWorkbook",sf,Ad,Kd,ye,hf,0)},80,()=>new Ni(F));this.$.userOperationManager.enqueueOperation(jd,va.ribbonCommandInfo)}ywg(F,va,lb,sc,
Yc){return new Promise((jd,Ad)=>{var Kd;const ye=Yc.commandParameters.stopwatch.Kc;let Ne=2;20===Yc.commandParameters.commandType&&(Ne=16);36===Yc.commandParameters.commandType&&(Ne=32);68===Yc.commandParameters.commandType&&(Ne=64);zf.a.u6f(this.$)&&1028===Yc.commandParameters.commandType&&(Ne=1024);4100===Yc.commandParameters.commandType&&(Ne=4096);let hf=null;if(null===(Kd=Yc.copyContextSnapshot)||void 0===Kd?0:Kd.commandParameters)hf=Yc.copyContextSnapshot.commandParameters.id;Eh.Zne(this.$,F,
lb,va,null,sf=>{Eh.kCc(sf,Yc,jd,Ad,ye,this.$,null,!0,null,null)},sf=>{Yc.serverRequestTimeInMs=Yc.commandParameters.stopwatch.Kc-ye;sf=Fc.a.te(sf.data);Ad(new xb(5,sf))},sc,Ne,hf,Yc.commandParameters.id)})}pasteRange(F,va,lb,sc,Yc,jd,Ad,Kd,ye,Ne){return new Promise((hf,sf)=>{const Gf=Ad.commandParameters.stopwatch.Kc;Eh.lGk(this.$,F,va,lb,sc|-5&Yc,Yf=>{Eh.kCc(Yf,Ad,hf,sf,Gf,this.$,null,!0,ye,Ne)},Yf=>{Ad.serverRequestTimeInMs=Ad.commandParameters.stopwatch.Kc-Gf;Yf=Fc.a.te(Yf.data);Yf=new xb(5,Yf);
null===Ne||void 0===Ne?void 0:Ne(Yf);sf(Yf)},jd,Kd)})}kgk(F,va,lb,sc,Yc,jd,Ad,Kd){const ye=new ff.a;return new Promise((Ne,hf)=>{if(va)if(va.length>this.EYb){var sf=Ad.clipboardItems.getItem(gg.a.plainText);let Gf=-1;void 0!==sf&&null!==sf&&(Gf=sf.length);C.ULS.sendTraceTag(42071712,0,15,`CopyPasteInfrastructure.ProcessPasteHtml copy paste length too long. clipboardHtml.Length: ${va.length}, MaxHtmlImportLength: ${this.EYb}, PlainTextLength: ${Gf}`);hf(new xb(1))}else sf=new ub.a(204,0,(Gf,Yf,Ng)=>
{this.$.Qw();const dh=Ad.commandParameters.stopwatch.Kc;Gf=xd.c(Gf,Ij=>{Ba.HtmlProcessorService.Oa()&&ye.cancel();Eh.kCc(Ij,Ad,Ne,hf,dh,this.$,va,!1,null,null)});Yf=xd.b(Yf,Ij=>{Ad.serverRequestTimeInMs=Ad.commandParameters.stopwatch.Kc-dh;Ij=Fc.a.te(Ij.data);Ba.HtmlProcessorService.Oa()&&ye.cancel();hf(new xb(3,Ij))});const vg=this.$.ma.sa.mc(),zi=gc.y(F,this.$),Vh={};Vh.SourceHtml=va;Vh.DestinationRanges=zi?gc.v(zi):null;Vh.CopyOperationId=lb;Vh.PasteId=sc;Vh.AutoAdjustColumnsOn=this.uH();return Eg(this.$.ma.gyd,
Vh,Gf,Yf,Ng,null,vg,jd)},65),this.$.userOperationManager.enqueueOperation(sf,Yc),Ba.HtmlProcessorService.Oa()&&this.prd(Ad,va,F,Kd,ye),this.rGj(va);else Ne("")})}prd(F,va,lb,sc,Yc){return sc.prd(F,va,lb,Yc)}rGj(F){if(F&&F.trim()&&oa.EwaSettings.isChangeGateEnabled("OfficeVSO:8472105_EnablePasteHtmlTelemetry")){var va=performance.now(),lb=(new DOMParser).parseFromString(F,"text/html");if(lb){F=[];lb.querySelector("table table")&&F.push("NestedTable");lb.querySelector("table ol")&&F.push("OrderedListInsideTable");
lb.querySelector("table ul")&&F.push("UnorderedListInsideTable");lb.querySelector("ol table")&&F.push("TableInsideOrderedList");lb.querySelector("ul table")&&F.push("TableInsideUnorderedList");lb.querySelector("ol ol")&&F.push("NestedOrderedList");lb.querySelector("ul ul")&&F.push("NestedUnorderedList");lb.querySelector("ol ul")&&F.push("UnorderedListInsideOrderedList");lb.querySelector("ul ol")&&F.push("OrderedListInsideUnorderedList");lb.querySelector("td[rowspan], td[colspan], th[rowspan], th[colspan]")&&
F.push("TableWithCellSpan");var sc=new Set;lb.querySelectorAll("*").forEach(Yc=>{Yc.nodeType===Node.ELEMENT_NODE&&oa.EwaSettings.isChangeGateEnabled("OfficeVSO:8708534_PasteHtmlTelemetryFix")&&Uf.includes(Yc.tagName)&&sc.add(Yc.tagName)});lb=Array.from(sc);F.push(...lb);va=performance.now()-va;C.ULS.sendTraceTag(507545676,0,50,`htmlClipboardItem.logPasteHtmlStructureTelemetry | tagAnalysisTotalTime: ${va.toFixed(2)} ms, htmlTagAnalysisResult: ${JSON.stringify(F)}`)}}}uH(){return null==this.s0?!1:
this.s0.uH}lgk(F,va,lb,sc,Yc){return new Promise((jd,Ad)=>{C.ULS.sendTraceTag(537167754,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: method start. pasteContext.Id=${Yc.id}`);va&&(va=Oa.a.trimEnd(va,"\n","\r"));C.ULS.sendTraceTag(537167753,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after clipboardText.TrimEnd. pasteContext.Id=${Yc.id}`);if(va)if(va.length>this.qeg)C.ULS.sendTraceTag(24150921,0,15,"CopyPasteInfrastructure.ProcessPasteText copy paste length too long. clipboardText.Length: {0}, MaxCopyPasteLength: {1}",
va.length,this.qeg),Ad(new xb(1));else{let ye,Ne;const hf=gc.y(F,this.$);C.ULS.sendTraceTag(537167752,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before treatAsLink calculation. pasteContext.Id=${Yc.id}`);var Kd=!this.$.fa.isNamedObjectViewMode&&!va.includes("\n")&&!va.includes("\t");C.ULS.sendTraceTag(537167751,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before isLink check. pasteContext.Id=${Yc.id}. treatAsLink=${Kd}`);Kd=Kd&&Oa.a.X1f(va);C.ULS.sendTraceTag(537167750,
0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after treatAsLink calculation. pasteContext.Id=${Yc.id}. treatAsLink=${Kd}`);const sf=this.$.ma.sa.mc();if(Kd){Ne=526;C.ULS.sendTraceTag(537167749,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before FixUpUrl. pasteContext.Id=${Yc.id}`);const Gf=Rh.a.Hxc(va);C.ULS.sendTraceTag(537167748,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after FixUpUrl. pasteContext.Id=${Yc.id}`);const Yf=gc.v(hf);Kd=(Ng,
dh,vg)=>{const zi=Yc.commandParameters.stopwatch.Kc;Ng=xd.c(Ng,Vh=>{C.ULS.sendTraceTag(537167747,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: on ApplyHyperlink successCallback. pasteContext.Id=${Yc.id}`);Yc.requestTelemetryData=Vh.RequestTelemetryData;Yc.serverRequestTimeInMs=Yc.commandParameters.stopwatch.Kc-zi;Vh.Errors&&0<Vh.Errors.length?Ad(new xb(2,Vh.Errors)):jd(va)});dh=xd.b(dh,Vh=>{Yc.serverRequestTimeInMs=Yc.commandParameters.stopwatch.Kc-zi;Vh=Fc.a.te(Vh.data);Ad(new xb(2,
Vh))});this.$.Qw();C.ULS.sendTraceTag(537167746,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before ApplyHyperlink. pasteContext.Id=${Yc.id}`);return Ic.b(this.$.ma.sa,Yf,va,Gf,!1,!1,63,Ng,dh,vg,F,sf,sc)};ye=()=>new Jh.a(Yf,va,Gf)}else Ne=180,Kd=(Gf,Yf,Ng)=>{this.$.Qw();const dh=Yc.commandParameters.stopwatch.Kc;Gf=xd.c(Gf,vg=>{C.ULS.sendTraceTag(537167745,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: on PasteString successCallback. pasteContext.Id=${Yc.id}`);
Eh.kCc(vg,Yc,jd,Ad,dh,this.$,va,!1,null,null)});Yf=xd.b(Yf,vg=>{Yc.serverRequestTimeInMs=Yc.commandParameters.stopwatch.Kc-dh;vg=Fc.a.te(vg.data);Ad(new xb(4,vg))});C.ULS.sendTraceTag(537167744,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before PasteString. pasteContext.Id=${Yc.id}`);return bh(this.$.ma.gyd,hf,va,this.uH(),Gf,Yf,Ng,null,sf,sc)},ye=()=>new qg(hf,va);C.ULS.sendTraceTag(537167715,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before UserWebMethodOperation. pasteContext.Id=${Yc.id}`);
Kd=new ub.a(Ne,0,Kd,65,ye);C.ULS.sendTraceTag(537167714,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: returning. pasteContext.Id=${Yc.id}`);this.$.userOperationManager.enqueueOperation(Kd,lb)}else jd("")})}nUf(F,va){va=[1===va?4:5];this.da.Ub.HL(He.a.a7a(nf.d(this.$.la),F),va,!0);this.da.Ub.Iq(va);this.da.Ub.update(!0)}MRd(){const F=[4,5];this.da.Ub.rl(F,!1,!1);this.da.Ub.pn(null,F,!1);1===this.da.ha.gf&&this.da.Iq(!1,!1);this.da.Ub.update(!1,!1)}VTh(F,va,lb){const sc=[];for(const Yc of lb)sc.push(this.bUh(F,
va,Yc));return sc}Y5(){if(this.xu)for(const F of this.xu)if(this.$&&this.$.userOperationManager){if(F.operation){const va=jg.a(F.operation.operationName);C.ULS.sendTraceTag(526758675,0,50,`CopyPasteUtils.AbortOutstandingUserOperation: Trying to abort pending operation ${va}.`)}this.pVh();this.$.userOperationManager.Sia(F)}}pVh(){if(this.Eva){const F=this.Eva.sx;C.ULS.sendTraceTag(526758674,0,15,`Cancelling pending copy request with Id=${F}`);Fc.a.dy(F);!oa.EwaSettings.isChangeGateEnabled("OfficeVSO:6151555_DisableCancelCopyRequest")&&
this.VWb&&Ic.i(this.$.ma.sa,this.VWb,null,null,null);this.VWb=this.Eva=null}}bUh(F,va,lb){C.ULS.shipAssertTag(537167713,0,!!va,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray shouldn't be null");C.ULS.shipAssertTag(537167712,0,0<va.length,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray length shouldn't be zero");let sc=0,Yc=0;var jd=new Set;const Ad=new Set;for(const Kd of va){va=`${Kd.left}_${Kd.right}`;const ye=`${Kd.top}_${Kd.bottom}`;Ad.has(va)||(Ad.add(va),Yc+=Kd.width);jd.has(ye)||
(jd.add(ye),sc+=Kd.height)}if(36===F)return lb.isSingle?Eh.Uzf(Yc,sc,lb):lb.clone();516===F&&(F=sc,sc=Yc,Yc=F);F=!(lb.width%Yc)&&!(lb.height%sc);jd=lb.wU&&!(lb.height%sc);lb.w8&&!(lb.width%Yc)||jd?lb=Eh.Uzf(Yc,sc,lb):F?lb=lb.clone():(lb=lb.clone(),lb.bottom=Math.min(ic.a.sf,lb.top+sc-1),lb.right=Math.min(ic.a.rf,lb.left+Yc-1));return lb}QKh(F,va,lb,sc,Yc,jd,Ad,Kd,ye,Ne,hf){if(!sc||!sc.length)return 1;if(1<sc.length){if(Ne)return 0;if(Kd)return 9;if(ye)return 8;if(hf)return 2;if(1<va.length)return 4;
const sf=va[0];if(!Ad&&!Ef.a.all(sc,Gf=>Gf.isSingle||!(Gf.width%sf.width)&&!(Gf.height%sf.height)))return 5;if(!jd&&Oa.a.equals(F,lb,!0))for(const Gf of Yc)if(Gf.ld(sf)&&!Gf.equals(sf))return 6}else if(va&&0<va.length){if(0!==this.RZf(va,ye))return 7;if(1<va.length&&!jd&&Oa.a.equals(F,lb,!0))for(const sf of va)if(F=Yc[0],sf.ld(F)&&!sf.equals(F))return 6}return 0}RZf(F,va){if(!F||1>=F.length)return 0;if(va)return 2;if(!gc.ab(F))return 1;va=new jf.a(Lf.a.Ef());for(const lb of F)for(const sc of F){const Yc=
lb.top===sc.top&&lb.bottom===sc.bottom,jd=lb.left===sc.left&&lb.right===sc.right,Ad=Math.max(lb.left,sc.left)<Math.min(lb.right,sc.right);if(Math.max(lb.top,sc.top)<Math.min(lb.bottom,sc.bottom)&&!Yc||Ad&&!jd)return 3;va.add(`${lb.top}-${lb.bottom}-${sc.left}-${sc.right}`);va.add(`${sc.top}-${sc.bottom}-${lb.left}-${lb.right}`)}for(const lb of F)va.remove(`${lb.top}-${lb.bottom}-${lb.left}-${lb.right}`);return 0<va.count?3:0}Hmk(F){const va=this.da.ha;va.updateSelection(F,F.topLeft,0);va.selectionType=
-1}QAc(F){if(null===F||void 0===F?0:F.sourceItem){if(!tg(F.sourceItem))return null;if((F=F.sourceItem)&&gc.nb(F.ranges,!0))return F}return null}rlb(F,va){C.ULS.shipAssertTag(537167711,0,!!F,"CopyPasteUtils.IsFromKeyboardShortcut: commandInfo shouldn't be null");return va&&S.a.fA in va||F.tabName?!1:1===F.method}static lGk(F,va,lb,sc,Yc,jd,Ad,Kd,ye){const Ne=F.ma.sa.mc(ye?{hla:!0,lka:1}:{hla:!1,lka:0});ye=new ub.a(506,0,(hf,sf,Gf)=>{F.Qw();var Yf=F.ma.sa;hf=xd.c(hf,jd);sf=xd.b(sf,Ad);var Ng=Kd;Ng=
void 0===Ng?null:Ng;const dh=Yf.$a(9,Ne);dh.sourceRanges=lb;dh.destinationRanges=sc;dh.flags=Yc;return Ic.h(Yf,"PasteRange",dh,hf,sf,Gf,null,64,Ng)},65,()=>new og(lb,sc,Yc));F.userOperationManager.enqueueOperation(ye,va)}static kCc(F,va,lb,sc,Yc,jd,Ad,Kd,ye,Ne){Ad=void 0===Ad?null:Ad;C.ULS.sendTraceTag(537167710,0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: on HandlePasteResult start. pasteContext.Id=${va.id}`);va.requestTelemetryData=F.RequestTelemetryData;va.serverRequestTimeInMs=
va.commandParameters.stopwatch.Kc-Yc;Xd.a.zf(F.Errors)?Xd.a.Jqa(F.Errors)?(va&&(va.encounteredDeploymentErrors=!0),F=Xd.a.pc(F.Errors),C.ULS.sendTraceTag(537167707,0,15,`CopyPasteUtils.HandlePasteServerResponse: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${F}`)):(F=new xb(5,F.Errors),null===Ne||void 0===Ne?void 0:Ne(F),sc(F)):F.Result?(sc=!!F&&!!F.RequestTelemetryData,fa.f(jd).Ce.UY(va.commandParameters.stopwatch.id,F.StateId,sc?F.RequestTelemetryData.EcsOperationDuration:
0,sc?F.RequestTelemetryData.EcsRequestDuration:0,sc?F.RequestTelemetryData.WfeRequestDuration:0),sc=F.Result,va.pastedRange=sc.SheetMultiRange,C.ULS.sendTraceTag(537167708,0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise ewaResult.Result is not null. pasteContext.Id=${va.id}`),null===ye||void 0===ye?void 0:ye(),lb(!0),oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!0)&&Kd&&!va.commandParameters.isDragDrop?
(va=Ka.a.Cb(Ba.OptimizeWorkbookManagerService))&&va.Mfa(6,F):zf.a.RHa()&&sc.AutoAdjustedColumns&&void Ka.a.resolve(Ba.AutoAdjustColumnsManagerService,{xa:1}).then(hf=>{hf.wjg("Paste")})):(C.ULS.sendTraceTag(537167709,0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise when ewaResult.Result is null. pasteContext.Id=${va.id}`),lb(Ad||!0))}static Zne(F,va,lb,sc,Yc,jd,Ad,Kd,ye,Ne,hf){const sf=F.ma.sa.mc(),Gf=Eh.hlf(lb,sc,ye,Ne,hf);lb=new ub.a(503,0,(Yf,Ng,dh)=>{F.Qw();return Fg(F.ma.sa,
Gf,xd.c(Yf,jd),xd.b(Ng,Ad),dh,Yc,sf,Kd)},65,()=>new Bh(Gf));F.userOperationManager.enqueueOperation(lb,va)}static hlf(F,va,lb,sc,Yc){const jd={};jd.ShadowWorkbookBase64=F.shadowWorkbookBase64;jd.SourceRanges={};jd.SourceRanges.Ranges=Array(1);jd.SourceRanges.Ranges[0]={};jd.SourceRanges.Ranges[0].FirstRow=F.rangeRowStart;jd.SourceRanges.Ranges[0].LastRow=F.rangeRowEnd;jd.SourceRanges.Ranges[0].FirstColumn=F.rangeColumnStart;jd.SourceRanges.Ranges[0].LastColumn=F.rangeColumnEnd;va?jd.DestinationRanges=
gc.x(va.SheetName,va.NamedObjectName,gc.i(va.Ranges)):(C.ULS.sendTraceTag(537167706,0,15,"CopyPasteInfrastructure.CreatePasteParameters: multiRangeDestination is null"),jd.DestinationRanges=null);jd.CopyPasteTargetType=1;jd.PasteType=lb;jd.CopyOperationId=sc;jd.PasteId=Yc;jd.SourceClientPath=F.sourceClientPath;jd.SourceSheetName=F.sourceSheetName;jd.SourceWorkbookName=F.sourceWorkbookName;if(!F.originalSourceRangesCountExceedsLimit&&F.originalSourceRanges&&0<F.originalSourceRanges.length&&1024===
lb){jd.OriginalSourceMultiRange={};va=Array(F.originalSourceRanges.length);for(lb=0;lb<va.length;++lb)va[lb]={},va[lb].FirstRow=F.originalSourceRanges[lb][0],va[lb].FirstColumn=F.originalSourceRanges[lb][1],va[lb].LastRow=F.originalSourceRanges[lb][2],va[lb].LastColumn=F.originalSourceRanges[lb][3];jd.OriginalSourceMultiRange.Ranges=va}return jd}static Uzf(F,va,lb){lb=lb.clone();lb.height<va&&(lb.bottom=Math.min(ic.a.sf,lb.top+va-1));lb.width<F&&(lb.right=Math.min(ic.a.rf,lb.left+F-1));return lb}DSk(F,
va,lb){return(F=fa.f(F).Eb.dg(lb))?va.width===F.usedRange.width&&lb.left===F.usedRange.left||lb.left===F.usedRange.left&&lb.right===F.usedRange.right&&0===lb.width%va.width:!1}CSk(F,va,lb){return(F=fa.f(F).Eb.dg(lb))?va.height===F.usedRange.height&&lb.top===F.usedRange.top||lb.top===F.usedRange.top&&lb.bottom===F.usedRange.bottom&&0===lb.height%va.height:!1}executeInsertCopiedCutCellsOperation(F,va,lb,sc,Yc,jd,Ad){jd=void 0===jd?null:jd;Ad=void 0===Ad?null:Ad;const Kd={};Kd.InsertDirection=sc;Kd.SourceRange=
F;Kd.DestRange=va;Kd.CopyCutOperation=lb?0:1;const ye=this.$.ma.sa,Ne=this.$.ma.sa.mc(),hf=()=>new hi(Kd);return Je.a(this.$.userOperationManager,(sf,Gf,Yf)=>{sf=jd?xd.c(sf,jd):sf;Gf=Ad?xd.b(Gf,Ad):Gf;const Ng=ye.$a(41,null);Ng.insertCopiedCutCellsParameters=Kd;return Ic.h(ye,"InsertCopiedCutCellsV2",Ng,sf,Gf,Yf,Ne,0)},sf=>new ub.a(104,0,sf,void 0,hf),Yc)}Iji(F,va,lb,sc,Yc,jd,Ad,Kd){return new Promise((ye,Ne)=>{this.executeInsertCopiedCutCellsOperation(va,lb,sc,Yc,jd,hf=>{F.requestTelemetryData=hf.RequestTelemetryData;
if(hf.Errors&&0<hf.Errors.length){const sf=new xb(21,hf.Errors);null===Kd||void 0===Kd?void 0:Kd(sf);Ne(new xb(21,hf.Errors))}else null===Ad||void 0===Ad?void 0:Ad(),ye(!0)},hf=>{hf=Fc.a.te(hf.data);hf=new xb(21,hf);null===Kd||void 0===Kd?void 0:Kd(hf);Ne(hf)})})}executeInsertCopiedCutCellsAcrossSession(F,va,lb,sc,Yc,jd,Ad,Kd,ye,Ne){jd=void 0===jd?null:jd;Ad=void 0===Ad?null:Ad;const hf={};hf.PasteParameters=Eh.hlf(ye,Kd,2,Ne.copyContextSnapshot.commandParameters.id,Ne.commandParameters.id);hf.InsertDirection=
sc;hf.SourceRange=F;hf.DestRange=va;hf.CopyCutOperation=lb?0:1;const sf=this.$.ma.sa,Gf=this.$.ma.sa.mc(),Yf=()=>new hi(hf);return Je.a(this.$.userOperationManager,(Ng,dh,vg)=>{Ng=jd?xd.c(Ng,jd):Ng;dh=Ad?xd.b(dh,Ad):dh;const zi=sf.$a(41,null);zi.insertCopiedCutCellsParameters=hf;return Ic.h(sf,"InsertCopiedCutCellsCrossSession",zi,Ng,dh,vg,Gf,0)},Ng=>new ub.a(106,0,Ng,void 0,Yf),Yc)}}Object(O.a)(Eh,"CopyPasteUtils",null,[834]);var ri=a(509),Oi;(function(F){F[F.range=0]="range";F[F.art=1]="art";F[F.nonGrid=
2]="nonGrid";F[F.fullSheet=3]="fullSheet"})(Oi||(Oi={}));Object(O.b)("SourceItemType",Oi);class Gh extends Sf{constructor(F,va,lb){super(va,lb);this.sheetName=F}isEqual(F){return F&&Object.getType(F)===Gh?this.IFc(F)&&this.sheetName===F.sheetName:!1}}Object(O.a)(Gh,"FullSheetSourceItem",Sf,[]);class bi{constructor(F){this.y_g={["SourceItemType.Range"]:0,["SourceItemType.Art"]:1,["SourceItemType.NonGrid"]:2,["SourceItemType.FullSheet"]:3};this.k6a={};this.u_g={["FloatingObjectType.Unknown"]:99,["FloatingObjectType.CardView"]:6,
["FloatingObjectType.Chart"]:0,["FloatingObjectType.Group"]:7,["FloatingObjectType.Image"]:1,["FloatingObjectType.Ink"]:8,["FloatingObjectType.InteractiveReport"]:4,["FloatingObjectType.ModernOfficeExtension"]:3,["FloatingObjectType.Shape"]:5,["FloatingObjectType.Slicer"]:2,["FloatingObjectType.Unsupported"]:100};this.Zqd={["99"]:"FloatingObjectType.Unknown",["6"]:"FloatingObjectType.CardView",["0"]:"FloatingObjectType.Chart",["7"]:"FloatingObjectType.Group",["1"]:"FloatingObjectType.Image",["8"]:"FloatingObjectType.Ink",
["4"]:"FloatingObjectType.InteractiveReport",["3"]:"FloatingObjectType.ModernOfficeExtension",["5"]:"FloatingObjectType.Shape",["2"]:"FloatingObjectType.Slicer",["100"]:"FloatingObjectType.Unsupported"};this.x_g={["RibbonCommand.Copy"]:-911352779,["RibbonCommand.Cut"]:-1985798686,["RibbonCommand.WriteToClipboard"]:396830482,["RibbonCommand.FullSheetCopy"]:-207190267};this.Dle={["-911352779"]:"RibbonCommand.Copy",["-1985798686"]:"RibbonCommand.Cut",["396830482"]:"RibbonCommand.WriteToClipboard",["-207190267"]:"RibbonCommand.FullSheetCopy"};
this.w_g={["InputManager.InputMethod.NotDefined"]:-1,["InputManager.InputMethod.Unknown"]:0,["InputManager.InputMethod.Keyboard"]:1,["InputManager.InputMethod.Mouse"]:2,["InputManager.InputMethod.Touch"]:3,["InputManager.InputMethod.CrossSlide"]:9};this.tua={};this.v_g={["FrameMode.None"]:0,["FrameMode.Reading"]:1,["FrameMode.Edit"]:2};this.Ohb={};this.A_g={["UILocation.Unknown"]:0,["UILocation.UpperRibbon"]:1,["UILocation.Ribbon"]:2,["UILocation.QAT"]:3,["UILocation.Jewel"]:4,["UILocation.NavigationPane"]:5,
["UILocation.KeyboardShortcut"]:6,["UILocation.StatusBar"]:7,["UILocation.Dialog"]:8,["UILocation.Floatie"]:9,["UILocation.NotificationBar"]:10,["UILocation.StandaloneCuiRoot"]:11,["UILocation.TaskPane"]:12,["UILocation.HeroDock"]:13,["UILocation.SingleLineRibbon"]:14,["UILocation.MultilineRibbon"]:15,["UILocation.Overflow"]:16,["UILocation.TellMe"]:17,["UILocation.FarPeripheralControls"]:18,["UILocation.ContextMenu"]:19,["UILocation.DialogMenu"]:20,["UILocation.Header"]:21,["UILocation.FileMenu"]:22,
["UILocation.Toolbar"]:26,["UILocation.Canvas"]:30};this.Jv={};this.$=F;this.tua.notDefined="InputManager.InputMethod.NotDefined";this.tua.unknown="InputManager.InputMethod.Unknown";this.tua.keyboard="InputManager.InputMethod.Keyboard";this.tua.mouse="InputManager.InputMethod.Mouse";this.tua.touch="InputManager.InputMethod.Touch";this.tua.crossSlide="InputManager.InputMethod.CrossSlide";this.Ohb.none="FrameMode.None";this.Ohb.reading="FrameMode.Reading";this.Ohb.edit="FrameMode.Edit";this.Jv.unknown=
"UILocation.Unknown";this.Jv.upperRibbon="UILocation.UpperRibbon";this.Jv.ribbon="UILocation.Ribbon";this.Jv.QAT="UILocation.QAT";this.Jv.jewel="UILocation.Jewel";this.Jv.navigationPane="UILocation.NavigationPane";this.Jv.keyboardShortcut="UILocation.KeyboardShortcut";this.Jv.statusBar="UILocation.StatusBar";this.Jv.dialog="UILocation.Dialog";this.Jv.floatie="UILocation.Floatie";this.Jv.notificationBar="UILocation.NotificationBar";this.Jv.standaloneCuiRoot="UILocation.StandaloneCuiRoot";this.Jv.taskPane=
"UILocation.TaskPane";this.Jv.heroDock="UILocation.HeroDock";this.Jv.singleLineRibbon="UILocation.SingleLineRibbon";this.Jv.multilineRibbon="UILocation.MultilineRibbon";this.Jv.overflow="UILocation.Overflow";this.Jv.tellMe="UILocation.TellMe";this.Jv.farPeripheralControls="UILocation.FarPeripheralControls";this.Jv.header="UILocation.Header";this.Jv.fileMenu="UILocation.FileMenu";this.Jv.contextMenu="UILocation.ContextMenu";this.Jv.dialogMenu="UILocation.DialogMenu";this.Jv.toolbar="UILocation.Toolbar";
this.Jv.canvas="UILocation.Canvas";this.k6a.range="SourceItemType.Range";this.k6a.art="SourceItemType.Art";this.k6a.nonGrid="SourceItemType.NonGrid";this.k6a.fullSheet="SourceItemType.FullSheet"}serializeSourceItem(F){const va={};if(F&&Object.getType(F)===Qg)va.sheetName=F.sheetName,va.topArray=Ef.a.map(F.ranges,lb=>lb.top),va.leftArray=Ef.a.map(F.ranges,lb=>lb.left),va.bottomArray=Ef.a.map(F.ranges,lb=>lb.bottom),va.rightArray=Ef.a.map(F.ranges,lb=>lb.right),va.sessionStateId=F.sessionStateId,va.sessionId=
F.sessionId,va.sourceItemType=this.WWc(0);else if(F&&Object.getType(F)===fg)va.activeFloatingObjectControlId=F.activeFloatingObjectControlId,va.sheetName=F.sheetName,va.sessionStateId=F.sessionStateId,va.sessionId=F.sessionId,va.floatingObjectType=this.YGk(F.type),va.sourceItemType=this.WWc(1);else if(F&&Object.getType(F)===lh)va.sessionStateId=F.sessionStateId,va.sessionId=F.sessionId,va.sourceItemType=this.WWc(2);else if(F&&Object.getType(F)===Gh)va.sheetName=F.sheetName,va.sessionStateId=F.sessionStateId,
va.sessionId=F.sessionId,va.sourceItemType=this.WWc(3);else return C.ULS.shipAssertTag(537167705,0,!1,"EnvironmentSerializationHelper.SerializeSourceItem: sourceItem shouldn't be null."),null;return JSON.stringify(va)}serializeCommandParameters(F){if(!F)return C.ULS.shipAssertTag(537167704,0,!1,"EnvironmentSerializationHelper.Serialize: commandParameters shouldn't be null."),null;const va={};va.id=F.id;va.commandType=F.commandType;va.copyPasteTargetType=F.copyPasteTargetType;F.ribbonCommandInfo&&
(va.ribbonCommandName=this.hHk(F.ribbonCommandInfo.command),va.inputMethodName=this.bHk(F.ribbonCommandInfo.method),va.frameModeName=this.$Gk(F.ribbonCommandInfo.mode),va.uiLocationName=this.kHk(F.ribbonCommandInfo.Re),va.tabName=F.ribbonCommandInfo.tabName);return JSON.stringify(va)}deserializeSourceItem(F){if(!F)return null;try{const va=JSON.parse(F);if(!va)return C.ULS.shipAssertTag(537167703,0,!1,"EnvironmentSerializationHelper.Deserialize: Json.Parse return null result."),null;let lb=null;switch(this.Afi(va.sourceItemType)){case 0:lb=
new Qg(this.$,this.xfi(va),va.sheetName,va.sessionStateId,va.sessionId);break;case 1:lb=new fg(va.activeFloatingObjectControlId,va.sheetName,va.sessionStateId,va.sessionId,this.ufi(va.floatingObjectType));break;case 2:lb=new lh(va.sessionStateId,va.sessionId);break;case 3:lb=new Gh(va.sheetName,va.sessionStateId,va.sessionId)}return lb}catch(va){return C.ULS.sendTraceTag(537167702,0,10,`EnvironmentSerializationHelper.DeserializeSourceItem: got exception while try to JSON.Parse string length: ${F?
F.length:0}, errror: ${va}`),null}}deserializeCommandParameters(F){if(!F)return null;try{const va=JSON.parse(F);if(!va)return C.ULS.shipAssertTag(537167701,0,!1,"EnvironmentSerializationHelper.DeserializeCommandParameters: Json.Parse return null result."),null;const lb=sh.a();lb.id=va.id;lb.ribbonCommandInfo=this.zfi(va);lb.commandType=va.commandType;lb.copyPasteTargetType=va.copyPasteTargetType;return lb}catch(va){return C.ULS.sendTraceTag(537167700,0,10,`EnvironmentSerializationHelper.DeserializeCommandParameters: got exception while try to JSON.Parse string length: ${F?
F.length:0}, errror: ${va}`),null}}xfi(F){const va=[];C.ULS.shipAssertTag(537167699,0,!!F.topArray&&0<F.topArray.length,`EnvironmentSerializationHelper.DeserializeRanges: TopArray shouldn't be ${F.topArray?"empty":"null"}.`);C.ULS.shipAssertTag(537167698,0,!!F.leftArray&&0<F.leftArray.length,`EnvironmentSerializationHelper.DeserializeRanges: LeftArray shouldn't be ${F.leftArray?"empty":"null"}.`);C.ULS.shipAssertTag(537167697,0,!!F.bottomArray&&0<F.bottomArray.length,`EnvironmentSerializationHelper.DeserializeRanges: BottomArray shouldn't be ${F.bottomArray?
"empty":"null"}.`);C.ULS.shipAssertTag(537167696,0,!!F.rightArray&&0<F.rightArray.length,`EnvironmentSerializationHelper.DeserializeRanges: RightArray shouldn't be ${F.rightArray?"empty":"null"}.`);if(!(F.topArray&&F.leftArray&&F.bottomArray&&F.rightArray))return va;C.ULS.shipAssertTag(537167695,0,F.topArray.length===F.bottomArray.length&&F.topArray.length===F.leftArray.length&&F.topArray.length===F.rightArray.length,`EnvironmentSerializationHelper.DeserializeRanges: The length of TopArray(${F.topArray.length}), BottomArray(${F.bottomArray.length}), LeftArray(${F.leftArray.length}), RightArray(${F.rightArray.length}) should be the same.`);
const lb=Math.min(F.topArray.length,F.bottomArray.length,F.leftArray.length,F.rightArray.length);for(let sc=0;sc<lb;sc++)va.push(new pc.Range(F.topArray[sc],F.leftArray[sc],F.bottomArray[sc],F.rightArray[sc],!1,!1));return va}zfi(F){return new Sb.a(this.yfi(F.ribbonCommandName),this.wfi(F.inputMethodName),this.vfi(F.frameModeName),this.Cfi(F.uiLocationName),F.tabName)}hHk(F){return void 0!==F&&null!==F&&F.toString()in this.Dle?this.Dle[F.toString()]:(C.ULS.shipAssertTag(537167694,0,!1,`EnvironmentSerializationHelper.SerializeRibbonCommand expected to get RibbonCommand.Copy(${-911352779}) or RibbonCommand.Cut(${-1985798686}) but got ${F}`),
this.Dle["-911352779"])}yfi(F){return F&&F in this.x_g?this.x_g[F]:(C.ULS.shipAssertTag(537167693,0,!1,`EnvironmentSerializationHelper.DeserializeRibbonCommand: expected to get RibbonCommand.Copy(${-911352779}) or RibbonCommand.Cut(${-1985798686}) but got ${F}`),-911352779)}bHk(F){return void 0!==F&&null!==F&&te.a[F]in this.tua?this.tua[te.a[F]]:(C.ULS.shipAssertTag(537167692,0,!1,`EnvironmentSerializationHelper.SerializeInputMethod: got unexpected value ${F}`),this.tua.unknown)}wfi(F){return F&&
F in this.w_g?this.w_g[F]:(C.ULS.shipAssertTag(537167691,0,!1,`EnvironmentSerializationHelper.DeserializeInputMethod: got unexpected value ${F}`),0)}$Gk(F){return void 0!==F&&null!==F&&ri.a[F]in this.Ohb?this.Ohb[ri.a[F]]:(C.ULS.shipAssertTag(537167690,0,!1,`EnvironmentSerializationHelper.SerializeFrameMode: got unexpected value ${F}`),this.Ohb.edit)}vfi(F){return F&&F in this.v_g?this.v_g[F]:(C.ULS.shipAssertTag(537167689,0,!1,`EnvironmentSerializationHelper.DeserializeFrameMode: got unexpected value ${F}`),
2)}WWc(F){return void 0!==F&&null!==F&&Oi[F]in this.k6a?this.k6a[Oi[F]]:(C.ULS.shipAssertTag(537167688,0,!1,`EnvironmentSerializationHelper.SerializeSourceItemType: got unexpected value ${F}`),this.k6a.range)}Afi(F){return F&&F in this.y_g?this.y_g[F]:(C.ULS.shipAssertTag(537167687,0,!1,`EnvironmentSerializationHelper.DeserializeSourceItemType: got unexpected value ${F}`),0)}YGk(F){return void 0!==F&&null!==F&&F.toString()in this.Zqd?this.Zqd[F.toString()]:(C.ULS.shipAssertTag(537167686,0,!1,`EnvironmentSerializationHelper.SerializeArtSourceItemType: got unexpected value ${F}`),
this.Zqd["99"])}ufi(F){return F&&F in this.u_g?this.u_g[F]:(C.ULS.shipAssertTag(537167685,0,!1,`EnvironmentSerializationHelper.DeserializeArtSourceItemType: got unexpected value ${F}`),99)}kHk(F){return void 0!==F&&null!==F&&Ve.a[F]in this.Jv?this.Jv[Ve.a[F]]:(C.ULS.shipAssertTag(36229129,0,!1,`EnvironmentSerializationHelper.SerializeUILocation: got unexpected value ${F}`),this.Jv.ribbon)}Cfi(F){return F&&F in this.A_g?this.A_g[F]:(C.ULS.shipAssertTag(537167684,0,!1,`EnvironmentSerializationHelper.DeserializeUILocation: got unexpected value ${F}`),
2)}}Object(O.a)(bi,"EnvironmentSerializationHelper",null,[]);class Ig{}Ig.JMg="SameSession";Ig.Szd="CrossSession";Ig.a9f="LegacyCrossSession";Ig.external="External";Object(O.a)(Ig,"PayloadOrigin",null,[]);const Ci=F=>F?F.shadowWorkbookSizeExceedsLimit&&void 0!==F.shadowWorkbookBlockedSize&&null!==F.shadowWorkbookBlockedSize?F.shadowWorkbookBlockedSize:F.shadowWorkbookBase64?F.shadowWorkbookBase64.length:0:0,ci=F=>F.shadowWorkbookSizeExceedsLimit?!0:Ci(F)>ic.a.FLc;var di=a(98);class Vi{constructor(F,
va,lb){lb=void 0===lb?null:lb;this.tSa=!1;this._name=va;this.$=F;this.il=Ha.a.instance;this.$u=new Eh(F,fa.f(F));this.VJb=lb}get name(){return this._name}get PGb(){return this.il.La(5)}shouldWaitForCopyToComplete(){return!1}onDeferredPasteStarted(){}onDeferredPasteCompleted(){}beforePaste(){}C9k(F){let va;va=null;try{const lb=F.getItem(gg.a.shadowWorkbook);if(!lb)return{returnValue:!1,WI:va};va=JSON.parse(lb);return{returnValue:this.Iyj(va),WI:va}}catch(lb){return C.ULS.sendTraceTag(537167835,0,50,
"BaseCopyPasteHandler.TryParseRangeShadowWorkbookPayload: Exception caught: "+lb),{returnValue:!1,WI:va}}}Iyj(F){return!!F&&(!!F.shadowWorkbookBase64||F.shadowWorkbookSizeExceedsLimit)&&void 0!==F.rangeRowStart&&void 0!==F.rangeRowEnd&&void 0!==F.rangeColumnStart&&void 0!==F.rangeColumnEnd}zQc(F){F.wasLastCopyExternal=!0;oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SetDefaultPaste",!1)&&F.commandParameters.isPasteDefault&&this.$.shortcutKeyManager&&(F.commandParameters.commandType=
-185374993===this.$.shortcutKeyManager.atc?20:4);if(Rg.a.hZa&&516!==F.commandParameters.commandType&&1028!==F.commandParameters.commandType){let va=null;if((()=>{let lb=this.C9k(F.clipboardItems);({WI:va}=lb);return lb})().returnValue)return F.isShadowWorkbookParsedSuccessfully=!0,this.mak(F,va)}if(516!==F.commandParameters.commandType&&36!==F.commandParameters.commandType&&4100!==F.commandParameters.commandType){if(20!==F.commandParameters.commandType){const va=F.clipboardItems.getItem(gg.a.html),
lb=this.j6f(va),sc=F.clipboardItems.getItem(gg.a.qrc),Yc=Sa.f(F.clipboardItems.getItem(gg.a.plainText));return!lb||!sc&&Yc?(Yc&&C.ULS.sendTraceTag(508863578,0,50,"BaseCopyPasteHandler.pasteFromExternal: Pasting a formula as plaintext"),this.Zbe(F)):this.uwg(F,va,void 0===sc?null:sc)}return this.Zbe(F)}return Promise.reject(new xb(6))}mak(F,va){C.ULS.sendTraceTag(537167834,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: Pasting shadow workbook from system clipboard");F.pasteResult="SystemClipboardShadowWorkbookPaste";
F.payloadType=xg.shadowWorkbook;F.payloadOrigin=Ig.external;F.shadowWorkbookPayloadSize=Ci(va);F.shadowWorkbookSizeExceedsLimit=ci(va);let lb;lb=gc.u(F.commandParameters.originalDestinations,this.$);va.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(F.originalSourceRangesCountExceedsLimit=va.originalSourceRangesCountExceedsLimit);if(F.shadowWorkbookSizeExceedsLimit)return C.ULS.sendTraceTag(537167833,0,15,`BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: shadow workbook length(${F.shadowWorkbookPayloadSize}) is over the limit(${ic.a.FLc}). reject the paste request. ShadowWorkbookSizeExceedsLimit: ${va.shadowWorkbookSizeExceedsLimit}`),
Promise.reject(new xb(1));C.ULS.sendTraceTag(537167832,0,50,`BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: trigger Paste request. PasteOperationId=${F.commandParameters.id}`);return this.$u.ywg(F.commandParameters.ribbonCommandInfo,lb,va,[F.commandParameters.stopwatch],F)}Zbe(F){var va=F.clipboardItems.getItem(gg.a.plainText);if(void 0!==va&&null!==va&&va.trim()===this.PGb)return Promise.reject(new xb(7));void 0!==va&&null!==va&&(F.plainTextPayloadSize=va.length);let lb=!1;null!==this.VJb&&
(lb=this.VJb.nMh(F,Oa.a.trimEnd(va,"\n","\r"),gc.S(F.commandParameters.originalDestinations)));lb&&fa.f(this.$).Ce.LO(F.commandParameters.stopwatch.id,yc.BasicTelemetryCalculator.zN);this.tSa||(this.tSa=!0,di.b("AutoAdjustColumnWidthTriggered"));F.isPlainTextPaste=!0;F.pasteResult="SystemClipboardPaste";F.payloadOrigin=qh(F)?Ig.a9f:Ig.external;F.payloadType=xg.plainText;C.ULS.sendTraceTag(537167831,0,50,`BaseRangeCopyPasteHandler.PasteByPlainText: trigger ProcessPasteText request. pasteContext.Id=${F.id}, PasteOperationId=${F.commandParameters.id}`);
va=this.$u.lgk(gc.S(F.commandParameters.originalDestinations),va,F.commandParameters.ribbonCommandInfo,[F.commandParameters.stopwatch],F);C.ULS.sendTraceTag(537167830,0,50,`BaseRangeCopyPasteHandler.PasteByPlainText: returned from ProcessPasteText. pasteContext.Id=${F.id}`);return va}uwg(F,va,lb){this.tSa||(this.tSa=!0,di.b("AutoAdjustColumnWidthTriggered"));F.htmlPayloadSize=va.length;F.isHtmlPaste=!0;F.pasteResult="SystemClipboardHtmlPaste";F.payloadType=xg.html;F.payloadOrigin=qh(F)?Ig.a9f:Ig.external;
F.cseStatus=3;C.ULS.sendTraceTag(42071711,0,50,`BaseRangeCopyPasteHandler.PasteByHtml: trigger ProcessPasteHtml request. PasteOperationId=${F.commandParameters.id}`);return this.$u.kgk(gc.S(F.commandParameters.originalDestinations),va,lb,F.commandParameters.id,F.commandParameters.ribbonCommandInfo,[F.commandParameters.stopwatch],F,this.VJb)}Bzd(F){const va={};F&&(va.shadowWorkbookBase64=F.ShadowWorkbookBase64,va.shadowWorkbookSizeExceedsLimit=F.ShadowWorkbookSizeExceedsLimit,va.originalSourceRangesCountExceedsLimit=
F.OriginalSourceRangesCountExceedsLimit,va.originalSourceRangesCount=F.OriginalSourceRangesCount,va.shadowWorkbookBlockedSize=F.ShadowWorkbookBlockedSize);return va}s$g(F,va){const lb=Hg(F),sc=32===(F.commandParameters.commandType&32),Yc=1024===(F.commandParameters.commandType&1024);let jd=!1,Ad=null,Kd=null,ye=!1;if(!lb){jd=-1985798686===F.commandParameters.ribbonCommandInfo.command;var Ne=F.copyContextSnapshot;if(va)ye=!Ne.sourceItem.isFromCurrentSession(this.$);else if(Ne=this.$u.QAc(Ne))Ad=Ne.ranges,
Kd=Ne.sheetName,ye=!F.isSameSession}return this.$u.QKh(Kd,Ad,this.$.la.sheetName,F.commandParameters.originalDestinations,F.commandParameters.expandDestinations,ye,sc,Yc,jd,va,lb)}j6f(F){return!(void 0===F||null===F)&&!!F&&F.trim()!==this.PGb&&(F.startsWith("<")||wa.a.Yg&&F.startsWith("\n<"))}}Object(O.a)(Vi,"BaseCopyPasteHandler",null,[866,848,867]);class Ch{constructor(F){this.clipboardItems=this.key=null;this.mX=F}bE(F){return this.key&&this.key.isEqual(F)?this.createClipboardItems(this.clipboardItems):
null}setValue(F,va){this.key=F;this.clipboardItems=this.createClipboardItems(va)}createClipboardItems(F){const va=this.mX.create();var lb=F.getItem(gg.a.plainText);lb&&va.setItem(gg.a.plainText,lb);(lb=F.getItem(gg.a.shadowWorkbook))&&va.setItem(gg.a.shadowWorkbook,lb);(F=F.getItem(gg.a.html))&&va.setItem(gg.a.html,F);return va}}Object(O.a)(Ch,"CopyCache",null,[]);class Pi extends Vi{constructor(F,va,lb,sc,Yc){Yc=void 0===Yc?null:Yc;super(F,sc,va);this.VJb=va;this.mX=lb;this.TJb=Yc||new Ch(this.mX);
this.da=fa.f(F);this.ha=this.da.ha}getSourceItem(){const F=gc.e(this.da.ha.oa.selectedRanges);return new Qg(this.$,F,this.$.fa.la.sheetName,this.$.fa.Je,this.$.ta.UserSessionId)}beforeSerialize(F){F.isSelectionAllowed=!1;F.isAsyncCopy=!1;F.isFromCache=!1;F.encounteredDeploymentErrors=!1;F.plainTextPayloadSize=0;F.shadowWorkbookPayloadSize=0;F.htmlPayloadSize=0;F.clientSideCopyTime=0;if(!F.isFullSheetCopy){var va=new kd.SheetProtection(this.$.qa),lb=F.sourceItem;F.isSelectionAllowed=Ef.a.all(lb.ranges,
sc=>this.isSelectionAllowed(va,sc));F.isSelectionAllowed&&this.$u.nUf(lb.ranges,F.commandParameters.commandType)}}x_a(F){return this.da.za.W7()&&fa.h(this.da,F)}Rak(F,va,lb,sc){if(!this.$.qa.Bl(lb.sheetName))return Promise.reject(new xb(5));let Yc=!1;const jd=1===va.commandParameters.commandType,Ad=sc[0].gu;1===lb.ranges.length&&1===sc.length?jd&&1!==Ad&&Ad!==lb.ranges[0].gu?F.cseStatus=17:Yc=this.VJb.oCd(F,gc.S(lb.ranges),lb.sheetName,gc.S(F.commandParameters.expandDestinations),jd):F.cseStatus=
5;Yc&&fa.f(this.$).Ce.LO(F.commandParameters.stopwatch.id,yc.BasicTelemetryCalculator.zN);return this.uak(F,lb,gc.x(this.$.la.sheetName,null,sc),va.commandParameters.commandType,Yc)}isSelectionAllowed(F,va){return F.omb(va,this.da)}uak(F,va,lb,sc,Yc){va=gc.x(va.sheetName,null,va.ranges);F.pasteResult="SameSessionPaste";F.payloadOrigin=Ig.JMg;F.payloadType=xg.Xxh;C.ULS.sendTraceTag(537167829,0,50,`BaseRangeCopyPasteHandler.PasteSameSession: trigger PasteRange request. PasteOperationId=${F.commandParameters.id}`);
return this.$u.pasteRange(F.commandParameters.ribbonCommandInfo,va,lb,sc,F.commandParameters.commandType,[F.commandParameters.stopwatch],F,Yc,null,null)}}Object(O.a)(Pi,"BaseRangeCopyPasteHandler",Vi,[]);class Di{constructor(F){this.c1=new Cb.a(!0);this.$=F}onDeferredPasteStarted(F){this.c1.Bb(F.id)||this.c1.add(F.id,!0);if(0<this.c1.count)if(oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",!1))void Ka.a.resolve(Ba.BusinessBarManagerService,{xa:0}).then(va=>
{va.lh(28,null)});else{const va=Object(Zb.d)(Ka.a.resolve(Ba.BusinessBarManagerService,{xa:0}));fb.TaskExtensions.tb(va,()=>{va.result.lh(28,null)},this.$.Aa,3)}}onDeferredPasteCompleted(F){const va=0<this.c1.count;this.c1.Bb(F.id)&&this.c1.remove(F.id);if(va&&!this.c1.count)if(oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",!1))void Ka.a.resolve(Ba.BusinessBarManagerService,{xa:0}).then(lb=>{lb.removeEntry(28)});else{const lb=Object(Zb.d)(Ka.a.resolve(Ba.BusinessBarManagerService,
{xa:0}));fb.TaskExtensions.tb(lb,()=>{lb.result.removeEntry(28)},this.$.Aa,3)}}}Object(O.a)(Di,"DeferredPasteTracker",null,[]);var Wi;(function(F){F[F.none=0]="none";F[F.loadClipboardFromServerFailed=1]="loadClipboardFromServerFailed";F[F.loadCopiedDataFromServerFailed=2]="loadCopiedDataFromServerFailed";F[F.asyncCopyCanceled=3]="asyncCopyCanceled";F[F.loadCopiedArtDataFromServerFailed=4]="loadCopiedArtDataFromServerFailed"})(Wi||(Wi={}));Object(O.b)("CopyErrorType",Wi);class Wh extends cd{constructor(F,
va){va=void 0===va?null:va;super(Wi[F]);this.copyErrorName=0;this.ewaErrors=null;this.copyErrorName=F;this.ewaErrors=va;if(null===va||void 0===va?0:va.length)this.innerError=new Vd(va,null)}}Object(O.a)(Wh,"CopyInnerError",cd,[]);class Sh extends La.a{constructor(F,va){super();this.da=F;this.source=va}dispose(){this.source=this.da=null;super.dispose()}toString(){const F=this.source;let va="";if(this.da.uja.contains(F)){var lb=this.da.za.y7(F,this.da.$.activeItemName);if(lb){const jd=Array(F.height);
for(let Ad=0;Ad<F.height;Ad++)jd[Ad]=Array(F.width);for(var sc of lb)for(var Yc of this.da.Eca(F,sc)){lb=Sh.vgk(Yc.originalText);if(Yc.AC)for(const Ad of Yc.range.M8e(Yc.range.gu))Ad.right!==F.right&&(jd[Ad.top-F.top][Ad.left-F.left]="\t");Yc.range.topLeft.right!==F.right&&(lb+="\t");jd[Yc.range.top-F.top][Yc.range.left-F.left]=lb}for(sc=0;sc<jd.length;sc++){for(Yc=0;Yc<jd[sc].length;Yc++)va+=jd[sc][Yc]?jd[sc][Yc]:"";sc!==F.height-1&&jd[sc][0]&&(va+="\r\n")}}}return va}static vgk(F){F=Sh.XAh(F);return Sh.cwk(F)}static cwk(F){return F.replace(Sh.YPj,
Sh.RZk)}static XAh(F){return F.includes("\n")||F.includes("\r")||F.includes("\t")?`"${F.replace(RegExp('"',"g"),'""')}"`:F}}Sh.YPj=String.fromCharCode(160);Sh.RZk=String.fromCharCode(32);Object(O.a)(Sh,"ClipboardRange",La.a,[4]);class ah extends Pi{constructor(F,va,lb,sc){super(F,va,lb,"AcrossSessionRangeCopyPasteHandler",void 0===sc?null:sc);this.c1=new Di(F)}serialize(F){const va=F.sourceItem,lb={};let sc=this.TJb.bE(va);if(sc)lb.synchronousResult=sc,F.isFromCache=!0,F.clientSideCopyTime=F.commandParameters.stopwatch.Kc;
else{let jd=null;var Yc=gc.L(va.ranges);if(!zf.a.s1f()&&this.x_a(Yc)){C.ULS.sendTraceTag(537167936,0,50,"AcrossSessionRangeCopyPasteHandler.Serialize: All data is loaded prepare the data in the client side.");Yc=new Sh(this.da,Yc);try{jd=Yc.toString(),sc=this.mX.create(),sc.setItem(gg.a.plainText,jd),this.TJb.setValue(va,sc),lb.synchronousResult=sc,F.clientSideCopyTime=F.commandParameters.stopwatch.Kc}finally{Yc&&Yc.dispose()}}else F.isAsyncCopy=!0,lb.synchronousResult=this.mX.create(),lb.synchronousResult.setItem(gg.a.plainText,
this.PGb);lb.asynchronousResult=this.aXa(F,va,jd)}F.syncClipboardItemsKeys=uh(lb.synchronousResult);return lb}shouldWaitForCopyToComplete(F){if(!F||!F.copyContextSnapshot)return C.ULS.sendTraceTag(537167907,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: pasteContext or pasteContext.CopyContextSnapshot is not define, return false."),!1;C.ULS.shipAssertTag(537167906,0,!!this.$.ta,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: this.EwaControl.BootstrapContext shouldn't be null");
if(F.copyContextSnapshot.sessionId===this.$.ta.UserSessionId)return C.ULS.sendTraceTag(537167905,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: Same session copy scenario, return false."),!1;C.ULS.sendTraceTag(537167904,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0}onDeferredPasteStarted(F){this.c1.onDeferredPasteStarted(F)}onDeferredPasteCompleted(F){this.c1.onDeferredPasteCompleted(F)}deserialize(F){var va;F.isClipboardDataContainShadowWorkbook=
!(void 0===F.clipboardItems.getItem(gg.a.shadowWorkbook)||null===F.clipboardItems.getItem(gg.a.shadowWorkbook));if(fa.f(this.$).ha.gf&326)return Hg(F)&&(F.wasLastCopyExternal=!0),Promise.reject(new xb(17));var lb=this.s$g(F,!1);if(0!==lb)return Promise.reject(new xb(Hg(F)?18:F.isSameSession?19:20,void 0,void 0,void 0,lb));lb=F.copyContextSnapshot;const sc=this.$u.QAc(lb);if(Hg(F)||(null===(va=F.copyContextSnapshot)||void 0===va?0:va.sourceItem)&&Dh(F.copyContextSnapshot.sourceItem))return this.zQc(F);
va=F.commandParameters.originalDestinations;if(sc&&F.isSameSession)return this.Rak(F,lb,sc,va);if(516!==F.commandParameters.commandType){let Yc=null;if((()=>{let jd=this.O9b(F.clipboardItems);({WI:Yc}=jd);return jd})().returnValue)return F.isShadowWorkbookParsedSuccessfully=!0,lb=null,lb=gc.u(va,this.$),this.jak(F,lb,Yc);if(F.isClipboardInaccessible)return Promise.reject(new xb(8));if(36!==F.commandParameters.commandType)return this.Zbe(F)}return Promise.reject(new xb(6))}beforePaste(F){Ba.PasteIndicationManagerService.Oa()?
Ka.a.Cb(Ba.PasteIndicationManagerService).ENg(F):this.$.ra.Tb(373).ENg(F);F.indicationDisplayScheduled=!0}vye(F){let va;if(!(F&&F.SourceRanges&&F.SourceRanges.Ranges&&F.SourceRanges.Ranges.length&&(F.OriginalSourceRangesCountExceedsLimit||F.OriginalSourceMultiRange&&F.OriginalSourceMultiRange.Ranges&&F.OriginalSourceMultiRange.Ranges.length)))return{returnValue:!1,WI:null};var lb=F.SourceRanges.Ranges[0];if(!F.ShadowWorkbookBase64&&!F.ShadowWorkbookSizeExceedsLimit)return{returnValue:!1,WI:null};
va=this.Bzd(F);va.rangeRowStart=lb.FirstRow;va.rangeRowEnd=lb.LastRow;va.rangeColumnStart=lb.FirstColumn;va.rangeColumnEnd=lb.LastColumn;va.sourceClientPath=F.SourceClientPath;va.sourceSheetName=F.SourceSheetName;va.sourceWorkbookName=F.SourceWorkbookName;if(!F.OriginalSourceRangesCountExceedsLimit)for(F=F.OriginalSourceMultiRange.Ranges,va.originalSourceRanges=Array(F.length),lb=0;lb<F.length;++lb)va.originalSourceRanges[lb]=[F[lb].FirstRow,F[lb].FirstColumn,F[lb].LastRow,F[lb].LastColumn];return{returnValue:!0,
WI:va}}O9b(F){let va;va=null;F=F.getItem(gg.a.shadowWorkbook);if(!F)return{returnValue:!1,WI:va};va=JSON.parse(F);return{returnValue:this.G_d(va),WI:va}}aXa(F,va,lb){C.ULS.shipAssertTag(537167901,0,!!F,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: copyContext shouldn't be null");const sc=F.commandParameters.stopwatch.Kc,Yc=gc.x(va.sheetName,null,va.ranges);return new Promise((jd,Ad)=>{C.ULS.sendTraceTag(26035421,0,50,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data for copy Id: ${F.id}`);
this.$u.copy(Yc,F.commandParameters,Kd=>{F.requestTelemetryData=Kd.RequestTelemetryData;F.serverRequestTimeInMs=F.commandParameters.stopwatch.Kc-sc;if(Xd.a.zf(Kd.Errors))if(Xd.a.Jqa(Kd.Errors))F.encounteredDeploymentErrors=!0,Kd=Xd.a.pc(Kd.Errors),C.ULS.sendTraceTag(537167898,0,15,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${Kd}. copy Id: ${F.id}`);else{var ye=Xd.a.pc(Kd.Errors);if(Xd.a.hi(Kd.Errors,
[-591377245])){var Ne=this.Gz(Yc);if(Ne){Ne=String.format(this.il.Ib(218),Ne.toLocaleUpperCase());var hf=Kd.Errors.findIndex(Yf=>-591377245===Yf.MessageId);Kd.Errors[hf].Description=Ne;C.ULS.sendTraceTag(509125507,0,50,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Added range string to CopyMaxCellCountExceededError. copy Id: ${F.id}`)}}C.ULS.sendTraceTag(26035419,0,10,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${ye}. copy Id: ${F.id}`);
Ad(new Wh(2,Kd.Errors))}else if(C.ULS.sendTraceTag(537167900,0,50,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeed for copy Id: ${F.id}`),F.markForCancellation)Ad(new Wh(3,Kd.Errors));else{var sf=Kd.Result;Ne=sf.PlainTextResult;void 0!==lb&&null!==lb&&(Ne=lb);void 0!==Ne&&null!==Ne&&(F.plainTextPayloadSize=Ne.length);ye=this.mX.create();var Gf;(()=>{let Yf=this.vye(sf);({WI:Gf}=Yf);return Yf})().returnValue&&(F.shadowWorkbookPayloadSize=Ci(Gf),F.shadowWorkbookSizeExceedsLimit=
ci(Gf),F.originalSourceRangesCountExceedsLimit=sf.OriginalSourceRangesCountExceedsLimit,hf=JSON.stringify(Gf),ye.setItem(gg.a.shadowWorkbook,hf));ye.setItem(gg.a.plainText,Ne);zf.a.s1f()&&(Ne=sf.HtmlResult,F.htmlSizeExceedsLimit=sf.HtmlSizeExceedsLimit,void 0!==Ne&&null!==Ne&&(F.htmlPayloadSize=Ne.length),ye.setItem(gg.a.html,Ne));F.copyTotalSizeExceedsLimit=sf.CopyTotalSizeExceedsLimit;ye.setItem(gg.a.qrc,F.commandParameters.id);this.TJb.setValue(va,ye);F.asyncClipboardItemsKeys=uh(ye);jd(ye);oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",
!0)&&(ye=1===F.commandParameters.commandType?8:7,(Ne=Ka.a.Cb(Ba.OptimizeWorkbookManagerService))&&Ne.Mfa(ye,Kd))}},Kd=>{F.serverRequestTimeInMs=F.commandParameters.stopwatch.Kc-sc;Kd=Fc.a.te(Kd.data);const ye=Xd.a.pc(Kd);C.ULS.sendTraceTag(537167897,0,10,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${ye}. copy Id: ${F.id}`);Ad(new Wh(2,Kd))},[F.commandParameters.stopwatch])})}G_d(F){return!!F&&(!!F.shadowWorkbookBase64||F.shadowWorkbookSizeExceedsLimit)&&
void 0!==F.rangeRowStart&&void 0!==F.rangeRowEnd&&void 0!==F.rangeColumnStart&&void 0!==F.rangeColumnEnd}jak(F,va,lb){C.ULS.shipAssertTag(537167903,0,!!lb,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadowWorkbookPayload shouldn't be null");F.pasteResult="CrossSessionPaste";F.payloadOrigin=Ig.Szd;F.payloadType=xg.shadowWorkbook;F.shadowWorkbookPayloadSize=Ci(lb);F.shadowWorkbookSizeExceedsLimit=ci(lb);F.cseStatus=3;lb.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(F.originalSourceRangesCountExceedsLimit=
lb.originalSourceRangesCountExceedsLimit);if(F.shadowWorkbookSizeExceedsLimit)return C.ULS.sendTraceTag(34415003,0,15,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadow workbook length(${F.shadowWorkbookPayloadSize}) is over the limit(${ic.a.FLc}). reject the paste request. ShadowWorkbookSizeExceedsLimit: ${lb.shadowWorkbookSizeExceedsLimit}`),Promise.reject(new xb(1));if(1028===F.commandParameters.commandType&&F.originalSourceRangesCountExceedsLimit)return C.ULS.sendTraceTag(572617859,
0,15,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: Original source ranges count(${lb.originalSourceRangesCount}) is over the limit(${ic.a.uKj}). Reject the paste request. OriginalSourceRangesCountExceedsLimit: ${lb.originalSourceRangesCountExceedsLimit}`),Promise.reject(new xb(1));C.ULS.sendTraceTag(537167902,0,50,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: trigger Paste request. PasteOperationId=${F.commandParameters.id}`);return this.$u.ywg(F.commandParameters.ribbonCommandInfo,
va,lb,[F.commandParameters.stopwatch],F)}Gz(F){return null==F||null==F.Ranges||0===F.Ranges.length?(C.ULS.sendTraceTag(509125506,0,15,"AcrossSessionRangeCopyPasteHandler.GetRangeString sourceRange is null"),null):(1===F.Ranges.length?gc.G(F.Ranges[0]):gc.L(gc.i(F.Ranges))).toString()}}Object(O.a)(ah,"AcrossSessionRangeCopyPasteHandler",Pi,[]);var ei=a(1354);class Uh{constructor(F,va,lb,sc,Yc,jd,Ad){this.floatingObjectId=F;this.commandParameters=va;this.PL=lb;this.qci=sc;this.Ksa=void 0===jd?null:
jd;this.ZAe=void 0===Ad?null:Ad;this.C4h=Yc}}Object(O.a)(Uh,"CopyArtRequest",null,[]);class gj{constructor(F,va,lb,sc,Yc,jd,Ad,Kd,ye){this.promise=null;this.ribbonCommandInfo=F;this.destination=va;this.uof=lb;this.ZAe=Yc;this.WI=jd;this.item=Ad;this.pasteContext=Kd;this.Q0a=lb||va.FirstRow+"_"+va.FirstColumn;this.P1f=!0;this.sff=ye}}Object(O.a)(gj,"PasteArtRequest",null,[]);class ii{constructor(F,va){this.k4b=new Cd.a;this.RSa=F;this.$=va;this.Pgk=lb=>Promise.resolve(lb);this.O_b=lb=>Promise.reject(lb)}U9i(F){if(this.puj(F.Q0a)){C.ULS.sendTraceTag(537167681,
5,50,`PasteArtRequestManager.HandleRequest: Enqueued paste request as a result of rapid paste on same destination: ${F.Q0a}`);const va=this.k4b.pa(F.Q0a);this.k4b.ga(F.Q0a,F);const lb=va.promise;va.P1f=!1;return this.Nmi(F,lb)}this.k4b.ga(F.Q0a,F);return this.FBj(F)}puj(F){return this.k4b.Bb(F)}FBj(F){return new Promise((va,lb)=>{F.promise=this.RSa.twg(F).then(sc=>{va(null);return this.ROc(F,sc)},sc=>{lb(null);return this.O_b(sc)})})}Nmi(F,va){return new Promise((lb,sc)=>{F.promise=va.then(Yc=>{this.yel(F,
Yc);return this.RSa.twg(F).then(jd=>{lb(null);return this.ROc(F,jd)},jd=>{sc(null);return this.O_b(jd)})},Yc=>this.O_b(Yc))})}ROc(F,va){F.P1f&&(this.UYh(F.Q0a),this.yne(F,va));return this.Pgk(va)}UYh(F){this.k4b.remove(F)}yne(F,va){const lb=this.l0i();F.Q0a===lb&&this.RSa.yne(F.destination,va,F.item.type)}l0i(){var F=fa.f(this.$).ha.ob.activeFloatingObjectControlId;F||(F=gc.y(fa.f(this.$).ha.oa.activeCell,this.$),F=F.FirstRow+"_"+F.FirstColumn);return F}yel(F,va){F.destination=null;F.uof=va}}Object(O.a)(ii,
"PasteArtRequestManager",null,[]);var Kh=a(211);class ji extends Vi{constructor(F,va,lb,sc,Yc){Yc=void 0===Yc?null:Yc;super(F,"ArtCopyPasteHandler");this.MZh="XLO";this.NZh="3";this.c1=new Di(F);this.mX=va;this.RSa=lb;this.ha=fa.f(F).ha;this.nrc=Yc||new Ch(this.mX);this.kak=new ii(lb,F);this.OGb=sc}getSourceItem(){C.ULS.shipAssertTag(537167896,0,!!this.ha.ob.activeFloatingObjectControlId,"Expecting a floating object to be currently selected for copy");C.ULS.sendTraceTag(537167895,0,50,`ArtCopyPasteHandler.GetSourceItem: Creating ArtSourceItem with FloatingObjectId=[${this.ha.ob.activeFloatingObjectControlId}]`);
return new fg(this.ha.ob.activeFloatingObjectControlId,this.$.fa.la.sheetName,this.$.fa.Je,this.$.ta.UserSessionId,this.ha.ob.Wb.floatingObject.type)}beforeSerialize(F){F&&F.commandParameters?(kf(F),F.commandParameters.copyPasteTargetType=2):C.ULS.sendTraceTag(537167894,0,10,"ArtCopyPasteHandler.BeforeSerialize: copyContext or copyContext.CommandParameters is null.")}serialize(F){const va=F.sourceItem,lb={};if(!va)return C.ULS.sendTraceTag(537167893,0,10,"ArtCopyPasteHandler.Serialize: artSourceItem should not be null"),
lb;if(!this.Axj())return C.ULS.sendTraceTag(36824456,0,50,"ArtCopyPasteHandler.Serialize: Unsupported floating object type. This will clear the clipboard"),lb;C.ULS.sendTraceTag(537167892,0,50,`ArtCopyPasteHandler.Serialize: Serializing ArtSourceItem with FloatingObjectId=[${va.activeFloatingObjectControlId}]`);this.ude();let sc=this.nrc.bE(va);if(sc)lb.synchronousResult=sc,F.isFromCache=!0,F.isAsyncCopy=!1,F.clientSideCopyTime=F.commandParameters.stopwatch.Kc,1===F.commandParameters.commandType&&
this.$.Dc(2045211913,F.commandParameters.ribbonCommandInfo.method,F.commandParameters.ribbonCommandInfo.Re,null);else{F.isFromCache=!1;F.isAsyncCopy=!0;sc=this.mX.create();if(F.commandParameters.uploadToClipService){const Yc={};Yc["data-clipservice-ccpid"]=F.commandParameters.id;Yc["data-pkey"]=F.commandParameters.pKey;Yc["data-clipservice-type"]=F.commandParameters.clipServiceDataType;Yc["data-clipservice-count"]=F.commandParameters.objectCount.toString();Yc["data-clipservice-dc"]=F.commandParameters.clipServiceDataCenter;
Yc["data-clipservice-client"]=this.MZh;Yc["data-TimeStamp"]=(new Date).toUTCString();Yc["data-clipservice-version"]=this.NZh;sc.setItem(gg.a.hHh,JSON.stringify(Yc))}zf.a.Qua()?(lb.synchronousResult=this.o2i(sc),lb.asynchronousResult=this.VJi(F,va,sc)):(lb.synchronousResult=this.H2e(sc),lb.asynchronousResult=this.aXa(F,va,sc))}F.syncClipboardItemsKeys=uh(lb.synchronousResult);return lb}o2i(F){return this.ha.ob.Wb.floatingObject.KQ?(F.setItem(gg.a.plainText,this.PGb),F):this.H2e(F)}H2e(F){C.ULS.shipAssertTag(537167891,
0,!!this.ha.ob.Wb,"Expecting a floating object to be currently selected for copy");F||(F=this.mX.create());const va=this.ha.ob.Wb.HOb();va&&F.setItem(gg.a.html,`<img src='${va}'>`);return F}ude(){const F=this.ha.ob.Wb;this.OGb.ude(v.a.oeb(F.floatingObject),v.a.PZh(F.mu))}shouldWaitForCopyToComplete(){C.ULS.sendTraceTag(537167890,0,50,"ArtCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0}onDeferredPasteStarted(F){this.c1.onDeferredPasteStarted(F)}onDeferredPasteCompleted(F){this.c1.onDeferredPasteCompleted(F)}deserialize(F){var va=
Hg(F),lb=null;let sc=null;var Yc=!1;if(!va){lb=F.copyContextSnapshot;sc=lb.sourceItem;if(!sc)return Promise.reject(new xb(10));Yc=sc.isFromCurrentSession(this.$)}var jd=this.s$g(F,!0);if(0!==jd)return Promise.reject(new xb(va?18:Yc?19:20,void 0,void 0,void 0,jd));if(va)return this.zQc(F);if(!Yc&&!ji.qoj(sc))return F=`User attempted to paste art of type [${sc.type}] between sessions.`,C.ULS.sendTraceTag(537167889,0,50,F),Promise.reject(new xb(11,void 0,void 0,F));if(lb.isAsyncSerializeFailed)return Promise.reject(new xb(16,
void 0,void 0,"Last async serialize failed, therefore no current shadow workbook payload to paste"));let Ad;try{const Kd=F.clipboardItems.getItem(gg.a.shadowWorkbook);if(zf.a.Qua()&&!Kd&&1===sc.type)return this.Rfk(F);Ad=JSON.parse(Kd)}catch(Kd){return F=copyPasteInfra.getStringifiedError(Kd),C.ULS.sendTraceTag(507798424,0,10,`ArtCopyPasteHandler.Deserialize: Failed to parse shadow workbook JSON with exception: ${F}`),Promise.reject(new xb(12,void 0,Kd))}Ad.floatingObjectId!==sc.activeFloatingObjectControlId?
C.ULS.sendTraceTag(537167887,0,10,`ArtCopyPasteHandler.Deserialize: FloatingObjectId mismatch! Deserializing with artSourceItem.ActiveFloatingObjectControlId=[${sc.activeFloatingObjectControlId}], shadowWorkbookPayload.FloatingObjectId=[${Ad.floatingObjectId}]`):C.ULS.sendTraceTag(537167886,0,50,`ArtCopyPasteHandler.Deserialize: Deserializing with artSourceItem.ActiveFloatingObjectControlId=[${sc.activeFloatingObjectControlId}], shadowWorkbookPayload.FloatingObjectId=[${Ad.floatingObjectId}]`);if(!Ad||
!Ad.shadowWorkbookBase64)return Promise.reject(new xb(13,void 0,void 0,`shadowWorkbookPayload is null = ${!Ad}`));F.isShadowWorkbookParsedSuccessfully=!0;F.shadowWorkbookPayloadSize=Ci(Ad);F.shadowWorkbookSizeExceedsLimit=ci(Ad);F.payloadOrigin=Yc?Ig.JMg:Ig.Szd;F.payloadType=xg.jeh;F.cseStatus=0;if(ci(Ad))return F=`Shadow workbook size [${F.shadowWorkbookPayloadSize}] is over the limit [${ic.a.FLc}]. ShadowWorkbookSizeExceedsLimit: ${Ad.shadowWorkbookSizeExceedsLimit}`,C.ULS.sendTraceTag(36304156,
0,15,`ArtCopyPasteHandler.Deserialize: ${F}`),Promise.reject(new xb(1,void 0,void 0,F));lb=va=null;fa.f(this.$).ha.gf&326?lb=fa.f(this.$).ha.ob.activeFloatingObjectControlId:va=this.$.la&&this.$.la.activeCell?gc.y(this.$.la.activeCell,this.$):gc.y(gc.S(F.commandParameters.originalDestinations),this.$);Yc||!oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)&&!oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1)||
(F.ArtSourceItemType=ei.a[sc.type],C.ULS.sendTraceTag(508422155,0,20,`User is attempting to paste art of type [${sc.type}] between sessions.`));Yc=null;if(this.OGb.XUg(sc))try{Yc=this.OGb.oCd(),F.cseStatus=1}catch(Kd){F.cseStatus=15,jd=copyPasteInfra.getStringifiedError(Kd),C.ULS.sendTraceTag(537167885,0,10,`ArtCopyPasteHandler.Deserialize: Exception encountered while performing client-side estimation. Exception: ${jd}`)}else F.cseStatus=26;return this.kak.U9i(new gj(F.commandParameters.ribbonCommandInfo,
va,lb,F.commandParameters.commandType,[F.commandParameters.stopwatch],Ad,sc,F,Yc))}zQc(F){F.wasLastCopyExternal=!0;if(F.clipboardItems.getItem("image/png")){const va=F.commandParameters.stopwatch.Kc;F.payloadType=xg.bOh;return Zb.c(this.$.Dc(1403967063,F.commandParameters.ribbonCommandInfo.method,F.commandParameters.ribbonCommandInfo.Re,{["dataUrl"]:F.clipboardItems.getItem("image/png")})).then(lb=>{F.serverRequestTimeInMs=F.commandParameters.stopwatch.Kc-va;return lb?Promise.resolve(null):Promise.reject(new xb(15))},
()=>{F.serverRequestTimeInMs=F.commandParameters.stopwatch.Kc-va;return Promise.reject(new xb(15))})}C.ULS.shipAssertTag(537167884,0,!1,"Should not paste external content that is not image via ArtCopyPasteHandler");return super.zQc(F)}Rfk(F){try{const va=F.clipboardItems.getItem(gg.a.html);return this.j6f(va)?this.uwg(F,va,null):Promise.reject(new xb(23))}catch(va){return F=copyPasteInfra.getStringifiedError(va),C.ULS.sendTraceTag(507782405,0,10,`ArtCopyPasteHandler.processClipboardHtml: Failed to process clipboard html with exception: ${F}`),
Promise.reject(new xb(24,void 0,va))}}Axj(){const F=fa.f(this.$).ha;return F.ob.activeFloatingObjectControlId&&F.ob.Wb&&F.ob.Wb.floatingObject?F.ob.Wb.floatingObject.Mve():!1}VJi(F,va,lb){return this.ha.ob.Wb.floatingObject.KQ?new Promise((sc,Yc)=>{const jd=this.WJi(F,lb),Ad=this.aXa(F,va,lb);void Promise.allSettled([jd,Ad]).then(Kd=>{var [ye,Ne]=Kd;"rejected"===ye.status?(1===F.commandParameters.commandType&&this.RSa.H5g(va.type,va.activeFloatingObjectControlId),Yc(ye.reason)):("rejected"===Ne.status&&
C.ULS.sendTraceTag(507811728,0,50,`ArtCopyPasteHandler.getAsyncData: Promise fetching data from server has failed with error ${Ne.reason}. Proceeding with resolving clipboard items from asyncArtData.`),Kd=ye.value,this.nrc.setValue(va,Kd),sc(Kd))})}):this.aXa(F,va,lb)}WJi(F,va){return new Promise((lb,sc)=>{const Yc=this.ha.ob.Wb;Yc.Zhb().continueWith(jd=>{var Ad;try{const Kd=jd.result;va.setItem(gg.a.plainText,"");if(Kd){const ye=new Image;ye.src=Kd;va.setItem(gg.a.html,Jd.b(ye))}else return C.ULS.sendTraceTag(507811727,
0,15,`ArtCopyPasteHandler.getAsyncImageData: Base64 URL of picture is null. ArtSourceItem id: ${Yc.floatingObject.Ec}`),sc(new Wh(4));F.asyncClipboardItemsKeys=uh(va);lb(va)}catch(Kd){jd=null===(Ad=null===Yc||void 0===Yc?void 0:Yc.floatingObject)||void 0===Ad?void 0:Ad.Ec,C.ULS.sendTraceTag(507811726,0,10,`ArtCopyPasteHandler.getAsyncImageData: Failed to fetch base64 URL of picture. ArtSourceItem id: ${jd}. Exception: ${Kd}`),sc(new Wh(4))}})})}aXa(F,va,lb){return new Promise((sc,Yc)=>{const jd=F.commandParameters.stopwatch.Kc,
Ad=this.ha.ob.Wb;C.ULS.sendTraceTag(41562516,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data...");this.RSa.F4h(new Uh(va.activeFloatingObjectControlId,F.commandParameters,Kd=>{var ye;F.requestTelemetryData=Kd.RequestTelemetryData;F.serverRequestTimeInMs=F.commandParameters.stopwatch.Kc-jd;if(Xd.a.zf(Kd.Errors))if(Xd.a.Jqa(Kd.Errors))F.encounteredDeploymentErrors=!0,Kd=Xd.a.pc(Kd.Errors),C.ULS.sendTraceTag(537167879,0,15,`ArtCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${Kd}`);
else{var Ne=Xd.a.pc(Kd.Errors);C.ULS.sendTraceTag(36229122,0,10,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${Ne}`);Yc(new Wh(4,Kd.Errors))}else if(C.ULS.sendTraceTag(537167883,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for FloatingObjectId=[${va.activeFloatingObjectControlId}].`),F.markForCancellation)Yc(new Wh(3,Kd.Errors));else{if(Xd.a.Ls(Kd.Errors)){var hf=Xd.a.pc(Kd.Errors);C.ULS.sendTraceTag(537167882,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: Server messages present. Errors: ${hf}`)}if(hf=
Kd.Result){hf=this.Bzd(hf);hf.floatingObjectId=va.activeFloatingObjectControlId;F.shadowWorkbookPayloadSize=Ci(hf);F.shadowWorkbookSizeExceedsLimit=ci(hf);try{Ne=JSON.stringify(hf)}catch(sf){Yc(new xb(14,void 0,sf,`Failed to stringify shadow workbook: copyContext.ShadowWorkbookPayloadSize: [${F.shadowWorkbookPayloadSize}], shadowWorkbookPayload.FloatingObjectId: [${hf.floatingObjectId}]`));return}C.ULS.shipAssertTag(537167881,0,!!lb,"Expecting syncClipboardItems to be defined");zf.a.Qua()&&(null===
(ye=null===Ad||void 0===Ad?void 0:Ad.floatingObject)||void 0===ye?0:ye.KQ)?(ye=new Blob([Ne]),1048576<ye.size?C.ULS.sendTraceTag(507798425,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: ShadowWorkbookPayload size is ${ye.size} for floating object id ${Ad.floatingObject.Ec}. Ignoring shadow workbook to avoid failure in saving to local storage.`):lb.setItem(gg.a.shadowWorkbook,Ne)):lb.setItem(gg.a.shadowWorkbook,Ne);1===F.commandParameters.commandType&&(this.oek(va.type,va.activeFloatingObjectControlId,
Kd.StateId),this.deleteFloatingObject(va.activeFloatingObjectControlId,va.type));this.nrc.setValue(va,lb);F.asyncClipboardItemsKeys=uh(lb);sc(lb)}else C.ULS.sendTraceTag(537167880,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: Result form server returned null, copied item id: ${va.activeFloatingObjectControlId}`),sc(this.nrc.bE(va))}},F.commandParameters.commandType,va.type,Kd=>{F.serverRequestTimeInMs=F.commandParameters.stopwatch.Kc-jd;Kd=Fc.a.te(Kd.data);1!==F.commandParameters.commandType||
zf.a.Qua()&&Ad.floatingObject.KQ||this.RSa.H5g(va.type,va.activeFloatingObjectControlId);const ye=Xd.a.pc(Kd);C.ULS.sendTraceTag(537167878,0,10,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${ye}`);Yc(new Wh(4,Kd))},[F.commandParameters.stopwatch]))})}deleteFloatingObject(F,va){F=Kh.a.MA(va,F);if(F=Pa.a(this.$).fr(F))Pa.a(this.$).deleteFloatingObject(F,14,!0),fa.f(this.$).ha.ob.FF=null}oek(F,va,lb){const sc=oa.EwaSettings.isChangeGateEnabled("OfficeVSO:8434150_MigrateValidationTelemetryManager")?
Ka.a.Cb(Ba.ValidationTelemetryManagerService):this.$.ra.Tb(277);if(sc){let jd=null;F=Kh.a.MA(F,va);F=Pa.a(this.$).fr(F);if(null===F||void 0===F?0:F.$j)jd=F.$j.block;if(jd){var Yc=F.floatingObject.Fh();sc.Hkc(()=>!jd.Ii.Bb(Yc),lb,"CutArt")}}}static qoj(F){return 1===F.type||5===F.type||oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)&&0===F.type||oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1)&&8===F.type}}
Object(O.a)(ji,"ArtCopyPasteHandler",Vi,[]);class ki extends Bh{constructor(F,va,lb,sc){super(F);this.isFromCurrentSession=!1;this.left=this.top=0;this.isFromCurrentSession=va;this.top=lb;this.left=sc}}Object(O.a)(ki,"MacroRecorderPasteArtPayload",Bh,[]);class Zi{constructor(F,va){this.$=F;this.OGb=va}rfj(F,va,lb,sc,Yc,jd,Ad){jd=void 0===jd?null:jd;Ad=void 0===Ad?null:Ad;const Kd=this.$.ma.sa.mc();let ye=null;const Ne={CopyPasteTargetType:2};Ne.FloatingObjectId=F;Ne.CopyOperationId=lb.id;lb.floatingObjectType=
va;Ne.UploadToClipService=lb.uploadToClipService;Ne.PKey=lb.pKey;Ne.ClipServiceDataCenter=lb.clipServiceDataCenter;let hf=0;2===Yc?(Yc=505,hf=16,ye=(sf,Gf,Yf)=>ch(this.$.ma.sa,Ne,xd.c(sf,sc),jd?xd.b(Gf,jd):Gf,Yf,lb.ribbonCommandInfo,Kd,Ad)):(Yc=179,ye=(sf,Gf,Yf)=>{this.Iii(va,F);this.$.Qw();var Ng=this.$.ma.sa;sf=xd.c(sf,sc);Gf=jd?xd.b(Gf,jd):Gf;var dh=lb.ribbonCommandInfo,vg=Ad;vg=void 0===vg?null:vg;const zi=Ng.$a(1,void 0===Kd?null:Kd);zi.copyParameters=Ne;return Ic.h(Ng,"Cut",zi,sf,Gf,Yf,dh,0,
vg)});this.$.userOperationManager.enqueueOperation(new ub.a(Yc,0,ye,hf|64),lb.ribbonCommandInfo)}Iii(F,va){var lb=Kh.a.MA(F,va);(lb=Pa.a(this.$).fr(lb))?(fa.f(this.$).ha.ob.WH(lb),lb.isVisible=!1):C.ULS.sendTraceTag(537167876,0,50,`ArtCopyPasteUtils.DoCutClientEstimation: floatingObjectcontrol is null. FloatingObjectType : ${F}, FloatingObjectId: ${va}`)}H5g(F,va){F=Kh.a.MA(F,va);if(F=Pa.a(this.$).fr(F))F.isVisible=!0}F4h(F){this.rfj(F.floatingObjectId,F.C4h,F.commandParameters,F.PL,F.qci,F.Ksa,F.ZAe)}Yfj(F,
va,lb,sc,Yc,jd,Ad,Kd,ye){Kd=void 0===Kd?null:Kd;ye=void 0===ye?!0:ye;return new Promise((Ne,hf)=>{const sf=jd.commandParameters.stopwatch.Kc;this.Zne(F,Yc,va,lb,Gf=>{jd.requestTelemetryData=Gf.RequestTelemetryData;jd.serverRequestTimeInMs=jd.commandParameters.stopwatch.Kc-sf;if(Xd.a.Jqa(Gf.Errors))jd&&(jd.encounteredDeploymentErrors=!0),Gf=Xd.a.pc(Gf.Errors),C.ULS.sendTraceTag(537167875,0,15,`ArtCopyPasteUtils.PasteArt: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${Gf}`);
else if(Xd.a.zf(Gf.Errors)){var Yf=Xd.a.pc(Gf.Errors);C.ULS.sendTraceTag(36459652,0,10,`ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: ${Yf}`);hf(new xb(9,Gf.Errors))}else Gf.Result?(Yf=Gf.Result,C.ULS.sendTraceTag(537167874,0,50,"ArtCopyPasteUtils.PasteArt: PasteArt succeeded."),this.Cek(Ad,Yf.FloatingObjectId,Gf.StateId),Ne(Zi.OSd(Yf.FloatingObjectId))):(C.ULS.sendTraceTag(537167873,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed, result returned from server is null."),hf(new xb(9,Gf.Errors)))},
Gf=>{jd.serverRequestTimeInMs=jd.commandParameters.stopwatch.Kc-sf;Gf=Fc.a.te(Gf.data);C.ULS.sendTraceTag(537167872,0,10,`ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: ${Xd.a.pc(Gf)}`);hf(new xb(9,Gf))},sc,Kd,ye)})}Cek(F,va,lb){const sc=oa.EwaSettings.isChangeGateEnabled("OfficeVSO:8434150_MigrateValidationTelemetryManager")?Ka.a.Cb(Ba.ValidationTelemetryManagerService):this.$.ra.Tb(277);if(sc){const Yc=Kh.a.MA(F,Zi.OSd(va));sc.Hkc(()=>!!Pa.a(this.$).fr(Yc),lb,"PasteArt")}}$ye(F,va){va&&this.OGb.$ye(F,
Kh.a.MA(F.type,va))}twg(F){return this.Yfj(F.ribbonCommandInfo,F.destination,F.uof,F.ZAe,F.WI,F.pasteContext,F.item.type,F.sff,F.item.isFromCurrentSession(this.$)).then(va=>va,va=>{this.$ye(F.item,F.sff);return Promise.reject(va)})}yne(F,va,lb){F||(F=gc.y(fa.f(this.$).ha.oa.activeCell,this.$));fa.f(this.$).FHc(gc.I(F),1)?Pa.a(this.$).XLa(lb,va,!0):fa.f(this.$).ha.ob.FDa(F,va,lb).continueWith(sc=>{sc.result?C.ULS.sendTraceTag(537167843,5,50,`ArtCopyPasteUtils.SelectPastedObject: Selection succeeded in async manner for object ID [${va}]`):
C.ULS.sendTraceTag(537167842,5,10,`ArtCopyPasteUtils.SelectPastedObject: Selection failed in async manner for object ID [${va}]`)})}Zne(F,va,lb,sc,Yc,jd,Ad,Kd,ye){ye=void 0===ye?!0:ye;const Ne=this.$.ma.sa.mc(),hf={};hf.ShadowWorkbookBase64=va.shadowWorkbookBase64;hf.FloatingObjectId=sc;hf.DestinationRanges=lb?gc.v(lb):null;hf.CopyPasteTargetType=2;hf.ClientEstimationFloatingObjectId=Kd;lb=new ub.a(503,0,(sf,Gf,Yf)=>{Kd||this.$.Qw();return Fg(this.$.ma.sa,hf,xd.c(sf,Yc),xd.b(Gf,jd),Yf,null,Ne,Ad)},
void 0,()=>{if(ye){let sf;sf=We.a.Xj(We.a.Nc(hf));sf.FloatingObjectId=va.floatingObjectId;hf.DestinationRanges||(sf.DestinationRanges=gc.s(this.$.qa.la.sheetName,"",0,0,0,0));return new ki(sf,ye,0,0)}return new ki(hf,ye,0,0)});lb.flags=65;this.$.userOperationManager.enqueueOperation(lb,F)}static OSd(F){return`${F.length+2}.{${F.toUpperCase()}}`}}Object(O.a)(Zi,"ArtCopyPasteUtils",null,[851]);var Lh=a(207);class Fh{constructor(F){this.byd=this.gEa=null;this.qqb=15;this.$=F}ude(F,va){this.gEa=F;this.byd=
va}oCd(){if(!this.gEa||!this.byd)return C.ULS.sendTraceTag(537167841,0,15,"ArtPasteClientEstimation.DoPasteClientEstimation: copiedFloatingObjectControl and/or copiedEffectsExtents is null, aborting client side estimation."),"";const F=v.a.oeb(new Kh.a(this.gEa));F.Id=Zi.OSd(Tb.a.create().toString());F.Version=-1;F.Name="";F.IsClientEstimation=!0;var va=this.xhj(F);if(!va)return null;const lb=new Kh.a(F);va.block.Ii.add(lb);lb.Hsb();const sc=Pa.a(this.$);sc.zrc(lb,va);va=sc.fr(Kh.a.uSi(F));!va||va.floatingObject.bG||
va.floatingObject.E_a||va.l5a(this.byd);sc.XLa(F.Type,F.Id,!0);return F.Id}XUg(F){return oa.EwaSettings.Ra(205)&&F.isFromCurrentSession(this.$)&&!fa.f(this.$).rtl&&!fa.f(this.$).rb.mj}$ye(F,va){this.XUg(F)&&(F=Pa.a(this.$).fr(va))&&(C.ULS.sendTraceTag(537167840,5,50,`ArtPasteClientEstimation.UndoPasteClientEstimation: undoing client-side estimation. Removing floating object with ID: [${va}] of type [${F.floatingObject.type}]`),Pa.a(this.$).deleteFloatingObject(F,15,!0),F.$j&&F.Zrb(F.$j,!1))}xhj(F){if(!F)return C.ULS.sendTraceTag(537167839,
0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: Called with null FloatingObjectData."),null;if(fa.f(this.$).ha.ob.activeFloatingObjectControlId){var va=fa.f(this.$).ha.ob.FF.floatingObject;F.OriginDeltaX=va.offsetX+this.qqb;F.OriginDeltaY=va.offsetY+this.qqb;F.AbsoluteLeft+=this.qqb;F.AbsoluteTop+=this.qqb;F.AbsoluteRight+=this.qqb;F.AbsoluteBottom+=this.qqb;F.ZOrder=va.XE+1;return fa.f(this.$).ha.ob.FF.$j}if(!this.$.la||!this.$.la.activeCell)return C.ULS.sendTraceTag(537167838,0,
15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: ActiveItem/ActiveCell is null - cannot perform estimation for grid paste."),null;var lb=this.$.la.activeCell;va=fa.f(this.$).jS(lb);if(!va)return C.ULS.sendTraceTag(537167837,0,15,`ArtPasteClientEstimation.InitializeFloatingObjectLocation: gridViewBlock for range ${lb.toString()} is null.`),null;const sc=$c.HelperMethods.fNd(va.domElement,va.Wl.domElement);lb=va.da.Wg(lb,2);if(!sc||!lb)return C.ULS.sendTraceTag(537167836,0,15,`ArtPasteClientEstimation.InitializeFloatingObjectLocation: blockPositionRelativeToGridOrigin is null: ${!sc}. cellPositionRelativeToGridOrigin is null: ${!lb} .`),
null;F.OriginDeltaX=lb.topLeft.x-sc.x;F.OriginDeltaY=lb.topLeft.y-sc.y;F.AbsoluteLeft=lb.topLeft.x;F.AbsoluteTop=lb.topLeft.y;F.AbsoluteRight=F.AbsoluteLeft+Math.abs(this.gEa.AbsoluteRight-this.gEa.AbsoluteLeft);F.AbsoluteBottom=F.AbsoluteTop+Math.abs(this.gEa.AbsoluteBottom-this.gEa.AbsoluteTop);F.ZOrder=this.gEa.ZOrder+100;return new Lh.a(va.da.za.ti(va.hashCode),va.hashCode)}}Object(O.a)(Fh,"ArtPasteClientEstimation",null,[850]);class fi{create(){const F=window.clipboardPlatform;return F?F.createClipboardItems():
null}}Object(O.a)(fi,"ClipboardItemsFactory",null,[849]);class Qi{}Qi.undefined="Undefined";Object(O.a)(Qi,"CCPTelemetryConsts",null,[]);class si{}si.cells="Cells";si.floatingObject="FloatingObject";si.unknown="Unknown";Object(O.a)(si,"ActiveSelection",null,[]);class hj extends ah{constructor(F,va,lb,sc){super(F,va,lb,void 0===sc?null:sc);this.wUa=null}beforePaste(){C.ULS.sendTraceTag(508121693,0,50,"AcrossSessionInsertCopiedCutCellsHandler is called")}deserialize(F){F.isClipboardDataContainShadowWorkbook=
!(void 0===F.clipboardItems.getItem(gg.a.shadowWorkbook)||null===F.clipboardItems.getItem(gg.a.shadowWorkbook));const va=F.commandParameters.originalDestinations;if(!F.isClipboardDataContainShadowWorkbook)return Promise.resolve(!0);let lb=null;if((()=>{let sc=this.O9b(F.clipboardItems);({WI:lb}=sc);return sc})().returnValue){F.isShadowWorkbookParsedSuccessfully=!0;let sc=null;sc=gc.u(va,this.$);return this.Iak(F,sc,lb)}return F.isClipboardInaccessible?Promise.reject(new xb(8)):Promise.reject(new xb(6))}get copyPasteInfrastructure(){var F;
null!==(F=this.wUa)&&void 0!==F?F:this.wUa=this.$.ra.Tb(254,!0);return this.wUa}Jjj(F,va,lb){return this.copyPasteInfrastructure?Zb.a(this.copyPasteInfrastructure.TTd(null,lb.commandParameters.ribbonCommandInfo,F,va,lb)):Promise.reject(new xb(0))}Iak(F,va,lb){F.pasteResult="CrossSessionPaste";F.payloadOrigin=Ig.Szd;F.payloadType=xg.shadowWorkbook;F.shadowWorkbookPayloadSize=Ci(lb);F.shadowWorkbookSizeExceedsLimit=ci(lb);lb.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(F.originalSourceRangesCountExceedsLimit=
lb.originalSourceRangesCountExceedsLimit);return F.shadowWorkbookSizeExceedsLimit?Promise.reject(new xb(1)):1028===F.commandParameters.commandType&&F.originalSourceRangesCountExceedsLimit?Promise.reject(new xb(1)):this.Jjj(va,lb,F)}}Object(O.a)(hj,"AcrossSessionInsertCopiedCutCellsHandler",ah,[]);class li{constructor(F,va){this.$=F;this.mX=va}get name(){return"NonGridCopyHandler"}getSourceItem(){return new lh(this.$.fa.Je,this.$.ta.UserSessionId)}beforeSerialize(F){kf(F);F.commandParameters.copyPasteTargetType=
0}serialize(F){const va={};if(!F.sourceItem)return C.ULS.sendTraceTag(508074082,0,10,"NonGridCopyHandler.Serialize: sourceItem should not be null"),va;F.isFromCache=!1;F.isAsyncCopy=!1;const lb=this.mX.create();gg.a.plainText in F.commandParameters.clipboardItems&&lb.setItem(gg.a.plainText,F.commandParameters.clipboardItems[gg.a.plainText]);gg.a.html in F.commandParameters.clipboardItems&&lb.setItem(gg.a.html,F.commandParameters.clipboardItems[gg.a.html]);va.synchronousResult=lb;return va}}Object(O.a)(li,
"NonGridCopyHandler",null,[848]);class $i extends ah{constructor(F,va,lb,sc){super(F,va,lb,void 0===sc?null:sc)}getSourceItem(){return new Gh(this.$.fa.la.sheetName,this.$.fa.Je,this.$.ta.UserSessionId)}beforeSerialize(F){F.isFullSheetCopy=!0;super.beforeSerialize(F)}vye(F){if(!F.ShadowWorkbookBase64&&!F.ShadowWorkbookSizeExceedsLimit)return{returnValue:!1,WI:null};const va=this.Bzd(F);va.sourceClientPath=F.SourceClientPath;va.sourceSheetName=F.SourceSheetName;va.sourceWorkbookName=F.SourceWorkbookName;
return{returnValue:!0,WI:va}}aXa(F,va){C.ULS.shipAssertTag(507834589,0,!!F,"AcrossSessionFullSheetCopyPasteHandler.GetCopiedDataFromServer: copyContext shouldn't be null");const lb=F.commandParameters.stopwatch.Kc;return new Promise((sc,Yc)=>{C.ULS.sendTraceTag(507815952,0,50,`AcrossSessionFullSheetCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data for copy Id: ${F.id}`);this.$u.fullSheetCopy(va.sheetName,F.commandParameters,jd=>{F.requestTelemetryData=jd.RequestTelemetryData;
F.serverRequestTimeInMs=F.commandParameters.stopwatch.Kc-lb;if(!Xd.a.zf(jd.Errors)){C.ULS.sendTraceTag(507834588,0,50,`AcrossSessionFullSheetCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for copy Id: ${F.id}`);const Ad=this.mX.create();let Kd;const ye=jd.Result;(()=>{let Ne=this.vye(ye);({WI:Kd}=Ne);return Ne})().returnValue&&(F.shadowWorkbookPayloadSize=Ci(Kd),F.shadowWorkbookSizeExceedsLimit=ci(Kd),F.originalSourceRangesCountExceedsLimit=ye.OriginalSourceRangesCountExceedsLimit,
F.shadowWorkbookSizeExceedsLimit||(jd=JSON.stringify(Kd),Ad.setItem(gg.a.shadowWorkbook,jd)));Ad.setItem(gg.a.qrc,F.commandParameters.id);this.TJb.setValue(va,Ad);F.asyncClipboardItemsKeys=uh(Ad);sc(Ad)}},jd=>{F.serverRequestTimeInMs=F.commandParameters.stopwatch.Kc-lb;jd=Fc.a.te(jd.data);const Ad=Xd.a.pc(jd);C.ULS.sendTraceTag(507834587,0,10,`AcrossSessionFullSheetCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${Ad}. copy Id: ${F.id}`);Yc(new Wh(2,jd))})})}beforePaste(){}deserialize(F){F.isClipboardDataContainShadowWorkbook=
!F.clipboardItems.getItem(gg.a.shadowWorkbook);return F.isClipboardDataContainShadowWorkbook?this.O9b(F.clipboardItems).returnValue?(F.isShadowWorkbookParsedSuccessfully=!0,Promise.resolve(!0)):F.isClipboardInaccessible?Promise.reject(new xb(8)):Promise.reject(new xb(6)):Promise.resolve(!0)}serialize(F){const va=F.sourceItem,lb={},sc=this.TJb.bE(va);sc?(lb.synchronousResult=sc,F.isFromCache=!0,F.clientSideCopyTime=F.commandParameters.stopwatch.Kc):(F.isAsyncCopy=!0,lb.synchronousResult=this.mX.create(),
lb.synchronousResult.setItem(gg.a.plainText,this.PGb),lb.asynchronousResult=this.aXa(F,va,null));F.syncClipboardItemsKeys=uh(lb.synchronousResult);return lb}}Object(O.a)($i,"AcrossSessionFullSheetCopyPasteHandler",ah,[]);class xj{constructor(F){this.Xfd=this.Cad=this.hcd=this.q7c=this.Ahd=null;this.$=F}get aQj(){!this.Xfd&&this.$.ra.Tb(254,!0)&&(this.Xfd=new li(this.$,new fi));return this.Xfd}get yfe(){if(!this.Ahd){const F=this.$.ra.Tb(254,!0);F&&(this.Ahd=new ah(this.$,F,new fi))}return this.Ahd}get Mjj(){if(!this.hcd){const F=
this.$.ra.Tb(254,!0);F&&(this.hcd=new hj(this.$,F,new fi))}return this.hcd}get aEf(){if(!this.Cad){const F=this.$.ra.Tb(254,!0);F&&(this.Cad=new $i(this.$,F,new fi))}return this.Cad}get Yqd(){if(!this.q7c&&this.$.ra.Tb(254,!0)){const F=new Fh(this.$);this.q7c=new ji(this.$,new fi,new Zi(this.$,F),F)}return this.q7c}getCopyFlowHandler(F){if(-207190267===F.commandParameters.ribbonCommandInfo.command)return this.aEf;if(F.commandParameters.clipboardItems)return this.aQj;const va=this.DNi(fa.f(this.$).gf);
F.commandParameters.copyPasteHandlerName=va.name;return va}getPasteFlowHandler(F){var va=F.copyContextSnapshot;switch(F.commandParameters.ribbonCommandInfo.command){case 440556491:return F=this.aEf;case -160032004:case -1065525230:return F=this.Mjj;default:return va=Lg(F)?this.Yqd:Hg(F)?this.yfe:(null===va||void 0===va?0:va.sourceItem)&&Object.getType(va.sourceItem)===fg?this.Yqd:this.yfe,F.commandParameters.copyPasteHandlerName=va.name,va}}initializePasteContext(F){if(F){F.isSameSession=!1;F.isShadowWorkbookParsedSuccessfully=
!1;F.pasteResult=Qi.undefined;F.payloadOrigin=Qi.undefined;F.payloadType=Qi.undefined;F.encounteredDeploymentErrors=!1;F.shadowWorkbookSizeExceedsLimit=!1;F.originalSourceRangesCountExceedsLimit=!1;F.activeSelectionType=this.KIi();F.indicationDisplayScheduled=!1;F.pasteDestinationHasMergedCells=!1;F.cseStatus=0;F.pasteIndicationDisplayStatus=cf.Rhi;if(oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)||oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",
!1))F.ArtSourceItemType=Qi.undefined;if(F.copyContextSnapshot){var va=F.copyContextSnapshot;const Ad=tg(va.sourceItem);var lb=va.sourceItem;var sc=!!lb&&Object.getType(lb)===fg;lb=0;var Yc=!1;Ad?(Yc=va.sourceItem,F.isSameSession=Yc.isFromCurrentSession(this.$),lb=1,Yc=this.ruj(Yc,F)):sc&&(F.isSameSession=va.sourceItem.isFromCurrentSession(this.$),lb=2);if(F.copyContextSnapshot.commandParameters){const Kd=-1985798686===va.commandParameters.ribbonCommandInfo.command;sc=F.commandParameters;var jd=this.$;
va?jd&&jd.ta?va=va.sessionId===jd.ta.UserSessionId:(C.ULS.shipAssertTag(537166211,0,!1,"ewaControl shouldn't be null"),va=!1):(C.ULS.shipAssertTag(537166212,0,!1,"copyContext shouldn't be null"),va=!1);sc.clearSystemClipboard=va&&Kd&&Ad&&!Yc;F.commandParameters.copyPasteTargetType=lb}}}}getSessionId(){return this.$.ta.UserSessionId}ruj(F,va){const lb=F.ranges.some(sc=>sc.Oe)&&va.commandParameters.originalDestinations.some(sc=>1!==sc.top);return F.ranges.some(sc=>sc.isRow)&&va.commandParameters.originalDestinations.some(sc=>
1!==sc.left)||lb}DNi(F){switch(F){case 1:return this.yfe;case 64:case 4:case 2:case 256:return this.Yqd;default:throw Error.invalidOperation("Unsupported selection");}}KIi(){return fa.f(this.$).ha.gf&470?si.floatingObject:1===fa.f(this.$).ha.gf?si.cells:si.unknown}getDialogResponse(){}}Object(O.a)(xj,"ExcelCopyPasteApplicationHost",null,[833]);class ti extends gd.a{constructor(F,va){super(F);this.Cx=null;this.Ljj=(lb,sc)=>{1===lb?(lb=ti.Ygi[sc[ti.Xgi]],C.ULS.sendTraceTag(537167683,0,50,`InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler OK button pressed with valid input, shift direction = ${0===
lb?"Horizontal":"Vertical"}`),this.Cx.setResult(lb)):(C.ULS.sendTraceTag(537167682,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler cancel button pressed"),this.Cx.Yx())};this.ei(va)}get Tc(){return"InsertCopiedCutCellsDialog"}ei(F){this.Cx=new Mf.a;const va=Ha.a.instance.ia(16);F=this.qN(F);this.initializeAndShow(va,this.Ljj,F)}qN(F){return{[ti.Xs]:this.Tc,[ti.gwj]:F}}}ti.Xgi="direction";ti.gwj="isRtl";ti.Ygi={["Vertical"]:1,["Horizontal"]:0};Object(O.a)(ti,"InsertCopiedCutCellsDialog",
gd.a,[]);class Ei{Brc(F,va){return(new ti(F,va)).Cx.task}}Object(O.a)(Ei,"InsertCopiedCutCellsDialogFactory",null,[825]);var Ag=a(1242),vh=a(942),Fi=a(619);const mi=()=>{var F=navigator.userAgentData;if(F)for(let va=0;va<F.brands.length;va++){if("Microsoft Edge"===F.brands[va].brand&&79<=parseFloat(F.brands[va].version))return!0}else if(navigator.userAgent&&(F=navigator.userAgent.match(/(Edg|EdgiOS|EdgA)\/(\d+)/i))&&79<=parseFloat(F[2]))return!0;return!1},ui=F=>{const va=Rg.a.Bmj&&!F.isMobileMode,
lb=Rg.a.Cmj&&F.isMobileMode&&F.isEditMode;F=F.Fe.get(57);return(va||lb)&&!F&&!!(navigator&&navigator.clipboard&&navigator.clipboard.read&&navigator.clipboard.write&&(mi()||wa.a.Wp&&wa.a.VHa(86)))};class Qh extends ie.a{constructor(F){super();this.LZh="clipboard-read";this.$=F;this.il=Ha.a.instance;this.ri()}create(){const F=Pf.a.T2([75,76],4,this.Cc,void 0,void 0,void 0,Qh.O5b),va=Object(Zb.d)(Ka.a.resolve(Ba.FormatCellsActionService,{xa:this.Cc})),lb=Object(Zb.d)(Ka.a.resolve(Ba.ZoomService)),sc=
Ba.HtmlProcessorService.Oa()?Object(Zb.d)(Ka.a.resolve(Ba.HtmlProcessorService,{xa:this.Cc})):Ae.a.Va(null),Yc=Ba.PasteIndicationManagerService.Oa()?Object(Zb.d)(Ka.a.resolve(Ba.PasteIndicationManagerService,{xa:this.Cc})):Ae.a.Va(null);fb.TaskExtensions.tb(fb.TaskExtensions.jl([va,F,lb,sc,Yc],this.Aa),()=>{const jd=new Ag.a;let Ad=null;this.N1h(jd).then(Kd=>{Ad=Kd.wff;const ye=copyPasteInfra.createCopyPasteInfra(Ad,new xj(this.$),jd);C.ULS.shipAssertTag(537167762,0,!!this.$.ta,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext should not be null");
C.ULS.shipAssertTag(537167761,0,!!this.$.ta&&!!this.$.ta.DocumentHostInfo,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext.DocumentHostInfo should not be null");const Ne=Ad.getMetadataManager();var hf=Object(vh.a)(this.$.ra,254,()=>new $d(this.$,Ne,va.result,ye,new Eh(this.$,fa.f(this.$)),new Ei,this.$.ta.DocumentHostInfo.UserId,Ad.getInitializationError(),lb.result,sc.result,Yc.result));this.Uf(hf);if(Kd.meb){hf=$d.Qyc();const sf=JSON.stringify(Kd.meb.dataClipboardCapabilities),
Gf=Kd.meb.clipboardStrategiesToInitialize[0].clipboardStrategyType===Kd.meb.dataClipboardStrategyType,Yf=void 0===window.bsqmXLSPageLoadStartTime||null===window.bsqmXLSPageLoadStartTime?"-1":(Date.now()-window.bsqmXLSPageLoadStartTime.getTime()).toString();C.ULS.sendTraceTag(41731933,0,50,`CopyPasteInfrastructureFactory.Create: Initialize CCP infra succeed. SliceName=${hf}, StrategyType=${Kd.meb.dataClipboardStrategyType}, StrategyCapabilities=${sf}, IsBestStrategyTypeInitialized=${Gf}, InfraLoadTimeMS=${Yf}`)}else C.ULS.shipAssertTag(537167760,
0,!1,"CopyPasteInfrastructureFactory.Create: initResult.ClipboardPlatformEnvironmentInitializationInfo should not be null")},Kd=>{const ye=$d.Qyc();Kd=Kd?copyPasteInfra.getStringifiedError(Kd):"null";C.ULS.shipAssertTag(38847436,0,!1,`CopyPasteInfrastructureFactory.Create: error during call to clipboardPlatformEnvironment.Init(). Copy Paste operations will not be available in this session. SliceName: ${ye} error: ${Kd}`)})},this.Aa,3)}dispose(){super.dispose()}N1h(F){var va,lb;let sc=null;var Yc=
window.clipboardPlatform;Yc&&(sc=Yc.getClipboardPlatformEnvironment(),null===(va=Yc.setClipboardPlatformFeatureGateManager)||void 0===va?void 0:va.call(Yc,Fi.a()));if(!sc)return C.ULS.shipAssertTag(537167759,0,!1,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: getClipboardPlatformEnvironment should have returned a valid object"),Promise.reject(null);va=this.$.ta;Yc=[va.OfficeOnlineChromeExtensionId,va.ChromeClipboardAccessExtensionId];const jd=this.il.La(5),Ad=this.$.Fe.get(57);
let Kd=!Ad&&this.$.Fe.get(5);var ye=this.$.fa.$b;ye&&(ye.inWebPart||ye.inViewerFromWebPart||ye.isDivSyndicated)&&(Kd=!1);(ye=ui(this.$))&&C.ULS.sendTraceTag(508703874,0,50,"CopyPasteInfrastructureFactory.configureClipboardPlatformEnvironment: Async System Clipboard is allowed");try{(null===(lb=null===navigator||void 0===navigator?void 0:navigator.permissions)||void 0===lb?0:lb.query)&&navigator.permissions.query({name:this.LZh}).then(Ne=>{C.ULS.sendTraceTag(508151361,0,50,`CopyPasteInfrastructureFactory.configureClipboardPlatformEnvironment: Clipboard read permission state: ${null===
Ne||void 0===Ne?void 0:Ne.state}`)}).catch(Ne=>{C.ULS.sendTraceTag(508151360,0,50,`CopyPasteInfrastructureFactory.configureClipboardPlatformEnvironment: Failed to get clipboard-read permission state. Error: ${JSON.stringify(Ne)}`)})}catch(Ne){C.ULS.sendTraceTag(508151331,0,50,`CopyPasteInfrastructureFactory.configureClipboardPlatformEnvironment: Failed to get clipboard-read permission state. Error: ${JSON.stringify(Ne)}`)}lb=this.mMi(Kd,!Ad,ye);C.ULS.shipAssertTag(537167758,0,!!va.DocumentHostInfo,
"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: bootstrapContext.DocumentHostInfo should not be null");return sc.init(F,Yc,va.SharedClipboardHostingApp,va.SharedClipboardHostingApps,va.SharedClipboardHostingEnvironments,va.SharedClipboardOverrideOrigin,va.SharedClipboardSchemaVersion,va.SharedClipboardExpirationInMinutes,va.ClipboardPromiseTimeoutInMinutes,jd,va.MachineCluster,new bi(this.$),lb,va.DocumentHostInfo.UserId,va.ClipboardTtlInMS,oa.EwaSettings.Ra(273),va.UserSessionId,
va.BulsEndpointUrl).then(Ne=>Object(oc.a)(new Me,{wff:sc,meb:Ne}),Ne=>Promise.reject(Ne))}mMi(F,va,lb){const sc=[];F&&lb&&sc.push(this.Mlf(9));F&&va&&sc.push(this.Mlf(6));va&&(sc.push(this.Jzd(7)),sc.push(this.Jzd(0)));F&&sc.push(this.Ikf());sc.push({clipboardStrategyType:4});lb=sc?sc.map(Yc=>JSON.stringify(Yc)).join(","):"[]";C.ULS.sendTraceTag(39978242,0,50,`CopyPasteInfrastructureFactory.GetClipboardStrategiesInitList: create clipboard stratgy initialization list: isBrowserStorageAllowed=${F}, isSystemClipboardAllowed=${va}, result = ${lb}`);
return sc}Ikf(){const F=this.$.ta,va={clipboardStrategyType:5};va.sessionId=F.UserSessionId;va.useSharedClipboardIframe=!0;va.sharedClipboardHostingApp=F.SharedClipboardHostingApp;va.sharedClipboardHostingApps=F.SharedClipboardHostingApps;va.sharedClipboardHostingEnvironments=F.SharedClipboardHostingEnvironments;va.sharedClipboardOverrideOrigin=F.SharedClipboardOverrideOrigin;va.sharedClipboardSchemaVersion=F.SharedClipboardSchemaVersion;va.sharedClipboardExpirationInMinutes=F.SharedClipboardExpirationInMinutes;
va.wacCluster=F.MachineCluster;return va}Mlf(F){const va={};va.clipboardStrategyType=F;va.localStorageStrategyParameters=this.Ikf();va.systemClipboardStrategyParameters=this.Jzd(0);return va}Jzd(F){const va={};va.clipboardStrategyType=F;va.skipFilesIfPlainTextExists=!0;return va}static Ea(F){Ba.PasteIndicationManagerService.Oa()||F.ra.zc(373,new ra(F));F.ra.zc(Qh.O5b,new Qh(F))}}Qh.O5b=255;Object(O.a)(Qh,"CopyPasteInfrastructureFactory",ie.a,[]);var Xi=a(9);const ij=Object(df.b)("Common.App.GestureManager.GestureInputManager"),
Rd=Object(df.c)(ij);var ve=a(254),Ej=a(448);class hh{constructor(){this.jma=this.iFf=null}}Object(O.a)(hh,"GestureAdapterInfo",null,[]);var Ri=a(664),wi=a(340);class Si{constructor(){this.P9c=null}dDj(){if(!this.P9c){var F="hammer.min.js";hb.AFrameworkApplication.ea.Dj("IsServerFlavorDebug")&&(F=hb.AFrameworkApplication.ea.ka("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");F=hb.AFrameworkApplication.EE(String.format("{0}",F),5);F=wi.a.create(F,null,null);Ri.a.usa(F);this.P9c=F.Anb}return this.P9c}static get instance(){Si.Wa||
(Si.Wa=new Si);return Si.Wa}}Si.Wa=null;Object(O.a)(Si,"HammerJsDependencyLoader",null,[847]);var ni;(function(F){F[F.none=-1]="none";F[F.QQc=0]="pinch";F[F.pan=1]="pan";F[F.awe=2]="swipe"})(ni||(ni={}));Object(O.b)("GestureEvent",ni);var oi=a(82);class aj extends oi.a{constructor(F,va,lb,sc,Yc,jd,Ad,Kd){super(F,lb,sc,jd);this.Pyb=va;this.zpa=Ad;this.o5=Kd;this.onh=Yc}get shiftKey(){return this.zpa}get ctrlKey(){return this.o5}get clientPoint(){return this.Pyb}get aGa(){return this.onh}static create(F,
va,lb,sc,Yc,jd){if(lb.rawEvent)if(jd){var Ad=lb.rawEvent;Ad=new Sys.UI.Point(Ad.clientX,Ad.clientY)}else Ad=oi.a.lPb(lb);else Ad=new Sys.UI.Point(lb.clientX,lb.clientY);return new aj(F,Ad,va,lb,sc,Yc,lb.shiftKey,lb.ctrlKey,jd)}}Object(O.a)(aj,"GestureEventArgs",oi.a,[]);class jj{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=
this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(O.a)(jj,"GestureManagerData",null,[]);class Gi{}Gi.Xfh=2;Gi.Yfh=4;Gi.Zfh=8;Gi.$fh=8;Object(O.a)(Gi,"HammerConstants",null,[]);var sj=a(107),oh=a(218),Yh=a(169);class xi extends ec.a{constructor(F,va){super();this.fBa=Ej.a.sIi;this.bhd=!!window.PointerEvent;this.h_e=window.hasOwnProperty("ontouchstart");this.N9a=this.rCb=null;this.Iga=!1;
this.L_=new Cd.a;this.LCb=new Cd.a;this.pnh=new ve.a;this.BAa=null;this.P8a=this.Xad=this.OIe=this.y8c=this.Qed=this.xWe=this.UIe=this.sEb=!1;this.WBb=-1;this.curRecognizer=this.element=this.handlers=this.session=this.jkd=null;this.nKa=(lb,sc,Yc)=>{lb=this.XJf(lb);sc=this.mTi(Yc);Hammer.inputHandler(this,lb,sc);this.Iga&&Yc.preventDefault();return this.Iga};this.h2a=(lb,sc,Yc)=>{var jd=Yc.rawEvent.pointerType.toString();const Ad=Yc.rawEvent.pointerId.toString();if("touch"!==jd)return!1;lb=this.XJf(lb);
if(1!==lb&&!this.L_.Bb(Ad))return!1;this.UIe&&1===lb&&Yc.rawEvent.isPrimary&&this.L_.count&&(C.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.cpc());this.sEb?this.BAh(Ad,sc,Yc):this.L_.ga(Ad,Yc);this.Qed&&2===lb&&(!this.y8c||this.y8c&&"function"===typeof Yc.rawEvent.getCoalescedEvents)&&(sc=Yc.rawEvent.getCoalescedEvents())&&this.jSf()&&(this.WBb=Math.max(this.WBb,sc.length));this.xWe&&(this.Iga=!1);jd=this.lTi(this.L_,Yc,jd);Hammer.inputHandler(this,lb,jd);if(4===lb||8===
lb)this.sEb?this.qGg(Ad):this.L_.remove(Ad),this.L_.count||(this.session=null,this.Qed&&-1!==this.WBb&&(C.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.WBb),this.WBb=-1));this.Iga&&Yc.preventDefault();return this.Iga};this.FOc=()=>!1;this.Ee=sj.EventHandlerManager.instance;this.bhd?(C.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.rCb=this.h2a,this.N9a=Wa.a.uIi):this.h_e?(C.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.rCb=this.nKa,this.N9a=
Wa.a.hwb):(C.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.rCb=this.FOc,this.N9a=Wa.a.tIi);this.Xi=va;this.voa=F;hb.AFrameworkApplication.ea&&(this.sEb=hb.AFrameworkApplication.ea.ka("UsePointerCaptureIsEnabled"),this.UIe=hb.AFrameworkApplication.ea.ka("ClearCacheOnPrimaryPointerIsEnabled"),this.xWe=hb.AFrameworkApplication.ea.ka("ResetHandledBeforeInputHandlerIsEnabled"),this.Qed=hb.AFrameworkApplication.ea.ka("LogCoalescedEventsIsEnabled"),this.y8c=hb.AFrameworkApplication.ea.ka("CheckExistenceOfGetCoalescedEventsIsEnabled"),
this.OIe=hb.AFrameworkApplication.ea.ka("CheckIfHammerExistsAfterDownloadIsEnabled"),this.Xad=hb.AFrameworkApplication.ea.ka("HammerJsPerformanceTimersIsEnabled"),this.P8a=this.sEb&&hb.AFrameworkApplication.ea.ka("CancelDragFromGestureInputManagerIsEnabled")&&hb.AFrameworkApplication.ea.ka("UseGestureInputManagerPointerCacheIsEnabled"))}ZRi(){return this.bhd?0:this.h_e?1:2}Tp(F){super.Tp(F);this.Ee.rua(this.N9a,F,0,this.rCb)}Io(F){super.Io(F);this.Ee.eVa(F,this.N9a)}Qnk(F,va,lb){lb=void 0===lb?null:
lb;var sc=void 0===sc?null:sc;hb.AFrameworkApplication.cHc()?Si.instance.dDj().continueWith(Yc=>{this.f0k();if(Yc.Ng||Yc.fi)C.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",Yc.status);else{C.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",Yc.status);if(this.OIe){Yc=window.Hammer;if("undefined"===typeof Yc){C.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.D_c();return}if("undefined"===typeof Yc.inputHandler){C.ULS.sendTraceTag(590901390,
310,10,"Hammer.inputHandler does not exist");this.D_c();return}}if(!F)throw this.D_c(),Error.argumentNull("source element can not be null");Yc=oh.a.IGa(F,this.fBa);if(void 0===Yc||null===Yc)Yc=new Cd.a,oh.a.Utb(F,this.fBa,Yc),this.Rnk(F);var jd=null;if(!Yc.Bb(ni[0])){jd=Object;var Ad=jd.assign,Kd=new hh,ye=ni[0],Ne=sc;Ne=void 0===Ne?null:Ne;if(void 0===this||null===this)throw C.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");let hf=null;switch(ye){case Wa.a.QQc:hf=
new Hammer.Pinch(Ne);break;case Wa.a.pan:hf=new Hammer.Pan(Ne)}hf&&(hf.manager=this);jd=Ad.call(jd,Kd,{jma:hf,iFf:va});Yc.add(ni[0],jd)}if(void 0!==lb&&null!==lb)for(Ad=0;Ad<lb.length;Ad++)Yc.Bb(ni[lb[Ad]])&&(Kd=Yc.pa(ni[lb[Ad]]),jd.jma.recognizeWith(Kd.jma))}this.D_c()}):C.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}f0k(){this.Xad&&(this.Xi?this.jkd=this.Xi.Uc("Task","RegisterGestureAdapterAfterLoad"):C.ULS.sendTraceTag(590387074,310,
10,"_stopwatchBuilder is null"))}D_c(){this.Xad&&(this.jkd?this.jkd.stop():C.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}Rnk(F){this.pnh.add(F);this.Ee.rua(this.N9a,F,0,this.rCb)}recognize(F){var va=Array(F.pointers.length);for(var lb=0;lb<F.pointers.length;lb++)va[lb]=F.pointers[lb].target;lb=null;for(this.BAa=this.RUi(va);void 0!==this.BAa&&null!==this.BAa&&(lb=oh.a.IGa(this.BAa,this.fBa),void 0===lb||null===lb);this.BAa=this.BAa.parentNode);if(void 0!==
lb&&null!==lb){this.curRecognizer&&this.curRecognizer.state===Gi.$fh&&(this.curRecognizer=null);va=lb.keys;for(const sc of va){va=lb.pa(sc);void 0!==va&&null!==va&&void 0!==va.jma&&null!==va.jma&&(void 0===this.curRecognizer||null===this.curRecognizer||va.jma===this.curRecognizer||va.jma.canRecognizeWith(this.curRecognizer))&&va.jma.recognize(F);const Yc=va.jma.state;this.curRecognizer||Gi.Xfh!==Yc&&Gi.Yfh!==Yc&&Gi.Zfh!==Yc||(this.curRecognizer=va.jma)}}}emit(F,va){if("hammer.input"!==F){this.Iga=
!1;va=aj.create(F,this.BAa,va.srcEvent,va,3,this.bhd);var lb=oh.a.IGa(this.BAa,this.fBa);if(this.xuj(F))var sc=0;else if(this.juj(F))sc=1;else if(this.Gxj(F))sc=2;else{C.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}({value:lb}=lb.Od(ni[sc]));void 0!==lb&&null!==lb&&((lb=lb.iFf,lb.orj())?F.endsWith("start")?this.Iga=lb.IYj(va):F.endsWith("end")?(lb.GYj(va),this.Iga=!0):F.endsWith("cancel")?(lb.FYj(va),this.Iga=!0):F.endsWith("move")&&(this.Iga=lb.HYj(va)):
C.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",F))}}get(F){return Object(Pd.a)(Hammer.Recognizer,F)}RUi(F){if(1>F.length)return null;if(1===F.length)return F[0];var va=F[0],lb=!0;for(let sc=1;sc<F.length;sc++){if(!F[sc])return null;if(va!==F[sc]){lb=!1;break}}if(lb)return va;va=this.yFf(F[0]);lb=0;for(const sc of F){F=this.yFf(sc);if(va.pa(va.count-1)!==F.pa(F.count-1))return null;for(let Yc=va.count-2,jd=F.count-2;Yc>=lb&&0<=jd;Yc--,jd--)if(va.pa(Yc)!==F.pa(jd)){lb=
Yc+1;break}}return va.pa(lb)}yFf(F){const va=new ve.a;for(;void 0!==F&&null!==F;F=F.parentNode)va.add(F);return va}XJf(F){switch(F){case Wa.a.ih:case Wa.a.$qa:return 1;case Wa.a.Ai:case Wa.a.fTa:return 2;case Wa.a.If:case Wa.a.wHb:return 4;case Wa.a.w1c:case Wa.a.Ksd:return 8}return 0}jSf(){return 1<this.L_.count}cpc(){C.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.sEb)for(const F of this.L_)this.qGg(F.key);else this.L_=new Cd.a;this.session=null}BAh(F,va,lb){C.ULS.sendTraceTag(594055959,
310,50,"AddOrReplacePointerInCaches: pointerId: {0}",F);if(!this.LCb.Bb(F)){try{va.setPointerCapture(F)}catch(sc){C.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",sc)}this.LCb.add(F,va)}this.L_.ga(F,lb);this.P8a&&1<this.L_.count&&this.voa&&!this.voa.iIb&&(this.voa.iIb=!0)}qGg(F){C.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",F);if(this.LCb.Bb(F)){try{this.LCb.pa(F).releasePointerCapture(F)}catch(va){C.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",va)}this.LCb.remove(F)}else C.ULS.sendTraceTag(594055955,
310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",F);this.L_.remove(F);this.P8a&&1>=this.L_.count&&this.voa&&this.voa.iIb&&(this.voa.iIb=!1)}mTi(F){const va=new jj;var lb=F.rawEvent;const sc=lb.touches;lb=lb.changedTouches;va.pointers=Array.clone(sc);va.pointers=Array.clone(0<sc.length?sc:lb);va.changedPointers=Array.clone(lb);va.srcEvent=F;va.pointerType="touch";return va}lTi(F,va,lb){const sc=new jj;sc.pointers=Yh.toArray(F.values);sc.changedPointers=[va];sc.pointerType=lb;sc.srcEvent=
va;return sc}xuj(F){return la.a.startsWith(F,Wa.a.QQc)}juj(F){return la.a.startsWith(F,Wa.a.pan)}Gxj(F){return la.a.startsWith(F,Wa.a.awe)}}Object(O.a)(xi,"GestureInputManager",ec.a,[835,836]);var Zh=a(393),bj=a(281);class tj{constructor(){this.oc=null;this.LB=!1}get name(){return"Common.App.GestureInputManager"}ji(F){F.register(xi,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").Lc().Qc(()=>new xi(Zh.a.instance,hb.AFrameworkApplication.ua.KE));this.oc=F}init(){this.LB||
(Object(df.a)(Rd),this.LB=!0)}dispose(){}static main(){bj.a.instance.Qi(new tj)}}Object(O.a)(tj,"GestureInputManagerPackage",null,[11,12]);const $h=Object(df.b)("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor"),Fj=Object(df.b)("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo");var cj=a(112);class Mh extends cj.a{constructor(){super()}static instance(){return Mh.Wa||(Mh.Wa=new Mh)}}Mh.q6j="OnTextSelectionHighlightChangeEvent";Mh.Wa=null;Object(O.a)(Mh,"TextSelectionHighlightChangeEvent",
cj.a,[]);class yj extends Nb.a{constructor(F,va){super(!1,!1,!0);this.aAk=(lb,sc)=>{1===lb&&(this.tOa.tSd=sc.tooltipPersistenceEnabled,lb=sc.textSelectionChangeEnabled,this.tOa.e9b!==lb&&this.Kvh.raiseEvent(Mh.q6j),this.tOa.e9b=lb)};this.tOa=F;this.Kvh=va}start(){const F={["tooltipPersistenceEnabled"]:this.tOa.tSd};F.textSelectionChangeEnabled=this.tOa.e9b;this.initializeAndShow("",this.aAk,{["id"]:"AccessibilitySettingsDialog",["bodyControls"]:F});C.ULS.sendTraceTag(507905246,324,50,"User opened the Accessibility Settings Dialog")}}
Object(O.a)(yj,"AccessibilitySettingsDialog",Nb.a,[]);var cg=a(135),mf=a(26);class Vg{constructor(F,va){this.ZTk=()=>{(new yj(this.tOa,Mh.instance())).start();return 32};this.pb=F;this.tOa=va}wi(){this.pb.jc(mf.a.YTk,cg.a.frame,this.ZTk)}}Object(O.a)(Vg,"AccessibilitySettingsDialogActor",null,[840]);const Hh=F=>{const va=new Mf.a;hb.AFrameworkApplication.od.Wn(Yi(F),1,null,null,!0,2,lb=>{200===lb.data.httpStatus?va.setResult("true"===lb.data.responseData.toLowerCase()):va.setResult(!1)},()=>{va.setResult(!1)},
null,void 0,void 0,void 0,void 0,"7");return va.task},Nh=(F,va)=>{hb.AFrameworkApplication.od.Wn(Yi(F),2,va.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8")},Yi=F=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",hb.AFrameworkApplication.ea.appSettings.RoamingServiceHandlerWebServiceBase||"",F,hb.AFrameworkApplication.Uh);var pi=a(104);class rf{constructor(){this.Vab=this.T9a=null}get tSd(){return!!this.T9a}set tSd(F){F!==this.T9a&&(this.T9a=F,pi.a("setHoverableTooltipsPreference")&&
appChrome.api.setHoverableTooltipsPreference(F),this.aIc()&&Nh("saveHoverableRibbonTooltipIsEnabled",F))}get e9b(){return!!this.Vab}set e9b(F){F!==this.Vab&&(this.Vab=F,this.aIc()&&Nh("saveTextSelectionHighlightChangeIsEnabled",F))}kDj(){const F=new Mf.a;if(this.T9a)F.setResult(this.T9a);else if(this.aIc()){const va=Hh("getHoverableRibbonTooltipIsEnabled");va.continueWith(()=>{this.T9a=va.result;pi.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(va.result);F.setResult(va.result)},
8)}else F.setResult(!1)}JDj(){const F=new Mf.a;if(this.Vab)F.setResult(this.Vab);else if(this.aIc()){const va=Hh("getTextSelectionHighlightChangeIsEnabled");va.continueWith(()=>{this.Vab=va.result;F.setResult(va.result)},8)}else F.setResult(!1)}aIc(){const F=hb.AFrameworkApplication.ea.ka("IsRoamingServiceEnabled"),va=hb.AFrameworkApplication.ea.ka("IsAnonymousUser");return F&&!va}}Object(O.a)(rf,"AccessibilitySettingsInfo",null,[839]);var kj=a(101);class Hi{constructor(){this.oc=null}get name(){return"Common.App.AccessibilitySettings"}ji(F){this.oc=
F;this.oc.register(rf,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Qc(()=>new rf).Lc();this.oc.register(Vg,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Qc(()=>new Vg(hb.AFrameworkApplication.Kb,Object(df.f)(Fj))).Lc()}init(){const F=Object(df.f)(Fj),va=Object(df.f)($h);F&&va?(va.wi(),F.kDj(),F.JDj(),kj.a(508827098,200,50,
"Text Selection Highlight Change Setting value on boot: {0}",F.e9b)):kj.a(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){bj.a.instance.Qi(new Hi)}}Object(O.a)(Hi,"AccessibilitySettingsPackage",null,[11,12]);class lj extends ie.a{constructor(F){super();this.$=F;this.ri()}create(){const F=Object(Zb.d)(Ka.a.resolve(Ba.HtmlSanitizationHelperService,{xa:this.Cc}));fb.TaskExtensions.tb(fb.TaskExtensions.jl([F],
this.$.Aa),()=>{this.Uf(this.$.ra.Tb(211)||new mb(this.$,F.result,this.$.pT,this.$.Wf))},this.Aa,3)}static Ea(F){F.ra.zc(212,new lj(F))}}Object(O.a)(lj,"AriaLiveNotifierFactory",ie.a,[]);var Ii=a(1161);const Gj=Object(df.c)(Ii.a);var Yg=a(1162);const yi=Object(df.c)(Yg.a);var mj=a(1318);const Hj=Object(df.c)(mj.a);var Ji=a(605),zj=a(1320),Oh=a(1468);class nj extends Oh.a{constructor(){super();this.lkd=this.JCb=null;this.state=0;this.ncd=this.oOe=!1}get pR(){return this.JCb}get Jya(){return this.lkd}get skj(){return this.oOe}YMf(){return"GetMoreInfo Result"}}
Object(O.a)(nj,"GetMoreInfoResult",Oh.a,[843,300]);var Ki=a(1164),qi=a(125);class P{constructor(F,va,lb){this.jic=this.Ik=null;this.hid=0;this.Rth=F;this.Ve=va;this.wKe=lb}LHh(){this.hid=this.Qsb+1}Wke(F){this.Ik&&(this.Ve.Xr(this.Ik),this.Ik=null);F&&(this.hid=0)}Y_k(F){const va=this.l5k;0<=va?(this.LHh(),this.Wke(!1),this.Ik=new qi.a(4,1,va,F,107),this.Ve.Ag(this.Ik)):(this.Wke(!0),C.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.wKe}))}get Qsb(){return this.hid}get l5k(){return this.Qsb>=
this.APg.length?-1:this.APg[this.Qsb]}get APg(){if(!this.jic){const F=(this.Rth.value||"0").split(",");this.jic=[];for(let va=0;va<F.length;va++){const lb=parseInt(F[va]);isNaN(lb)?C.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.wKe,["Entry"]:F[va]}):Array.add(this.jic,lb)}}return this.jic}}Object(O.a)(P,"RetryHelper",null,[]);var ua=a(48);class Xa extends zj.a{constructor(F,va){super();this.laa=F;this.kDb=new P(va,this.VYb.xMc,"GetMoreInfo");
this.Ku=new nj}cJj(){this.M4d("Document opened")}X8h(F){return()=>{this.M4d(F,!0)}}Krg(F,va){va=void 0===va?null:va;C.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:F});3===this.Ku.state?(va&&this.xsf(va,this.Ku),C.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:F})):this.M4d(F);return this.Ku}M4d(F,va){this.kDb.Wke(!(void 0===va?0:va));1===this.Ku.state?C.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",
{["Trigger"]:F,["RetryIndex"]:this.kDb.Qsb}):(C.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:F,["RetryIndex"]:this.kDb.Qsb}),this.Ku.state=1,va=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.VYb.fR,hb.AFrameworkApplication.Uh),this.VYb.Job.f0(va,1,null,null,[Xa.aVe,Xa.gZe],!1,5,this.Z7h(),this.Y7h(F),null))}Z7h(){return F=>{var va=!1;let lb=!1;var sc=!1,Yc;if(hb.AFrameworkApplication.ea.ka("GetMoreInfoDataFromResponseBody"))if(F.data.responseData){let jd=ua.d(F.data.responseData);
({Ws:Yc}=jd);jd.returnValue?Yc?(sc=!0,this.Ku.lkd=Yc.StorageServiceDisplayName,this.Ku.JCb=Xa.o6f(Yc.PersonalFileStorageUrl)?Yc.PersonalFileStorageUrl:"",""===this.Ku.pR&&"SharePointOnlineConsumer"===hb.AFrameworkApplication.ea.Qa("FileSource")&&(this.Ku.JCb=Ta.a.wZ(hb.AFrameworkApplication.breadcrumbFolderUrl)),va=""===this.Ku.pR&&""!==this.Ku.Jya):C.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):
C.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers")}else C.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers");sc||((Yc=F.data.responseHeaders)?(this.Ku.lkd=(Yc[Xa.gZe]||"").toString(),va=(Yc[Xa.aVe]||"").toString(),this.Ku.JCb=Xa.o6f(va)?va:"",""===this.Ku.pR&&"SharePointOnlineConsumer"===hb.AFrameworkApplication.ea.Qa("FileSource")?
(this.Ku.JCb=Ta.a.wZ(hb.AFrameworkApplication.breadcrumbFolderUrl),va=""===this.Ku.pR&&""!==this.Ku.Jya):va=""===va&&""!==this.Ku.Jya):(C.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),lb=!0));sc=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",this.kDb.Qsb,lb,va,sc);this.VYb.bla("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",F.data,sc);this.NPg(3,va,lb)}}Y7h(F){return va=>{this.VYb.bla("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",
va.data,"Failure");this.NPg(2);this.kDb.Y_k(this.X8h(F))}}NPg(F,va,lb){this.Ku.state=F;this.Ku.oOe=void 0===va?!1:va;this.Ku.ncd=void 0===lb?!1:lb;this.tDd(this.Ku)}get VYb(){return this.laa.value}static get instance(){return Xa.Wa||(Xa.Wa=Xa.QT())}static QT(){return new Xa(new Ji.a(()=>Ki.a.instance),new Ji.a(()=>hb.AFrameworkApplication.AVi))}static o6f(F){if(!F)return C.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(la.a.wm(F).startsWith("https://"))return!0;
C.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}Xa.aVe="PersonalFileStorageUrl";Xa.gZe="StorageServiceDisplayName";Xa.Wa=null;Object(O.a)(Xa,"GetMoreInfoActor",zj.a,[]);class Pb{constructor(F,va,lb,sc,Yc){this.woh=6E4;this.NVf="inactive";this.h1e="active";this.fF=!0;this.Ve=F;this.wnh=va;this.Mad=lb;this.mjc=sc;this.xb=new cj.a;Yc&&this.M_k();this.zQe=this.oKf()}$1e(F){this.xb.addHandler(this.h1e,F)}zAh(F){this.xb.addHandler(this.NVf,F)}M_k(){const F=new qi.a(5,2,this.woh,
Object(Wg.a)(this,this.tej,"inactiveLoop"),108);this.uej.Ag(F)}tej(){const F=this.oKf(),va=this.ZA()-F;va>this.Z0c&&this.fF&&(C.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:va}),this.fF=!1,this.xb.raiseEvent(this.NVf));F-this.zQe>this.Z0c&&(this.fF=!0,this.xb.raiseEvent(this.h1e));this.zQe=F}get uej(){return this.Ve.value}get oKf(){return this.wnh}get ZA(){return this.Mad}get Z0c(){return this.mjc.value}static get instance(){return Pb.Wa||(Pb.Wa=Pb.QT())}static QT(){return new Pb(new Ji.a(()=>
Ma.TaskManager.instance),()=>hb.AFrameworkApplication.s0a.getTime(),()=>(new Date).getTime(),new Ji.a(()=>hb.AFrameworkApplication.Z0c),!0)}}Pb.Wa=null;Object(O.a)(Pb,"InactivityManager",null,[]);var hc=a(1445);class Qc{constructor(){this.rEb=this.dWe=this.oc=null;this.ep=!1;this.Sei=()=>{Ma.TaskManager.instance.Xr(this.agg)};this.E2e=()=>{Ma.TaskManager.instance.Ag(this.agg)}}get name(){return"Common.App.NewAndOpen.Core"}ji(F){this.oc=F;F.register(298,"Common.INewAndOpenCommonHelpers").Lc().Qc(()=>
Ki.a.instance);F.register(301,"Common.IEventEmitter<Common.IGetMoreInfoResult>").Lc().Qc(()=>Xa.instance);F.register(301,"Common.IEventEmitter<Common.IMruResult>").Lc().Qc(()=>hc.a.instance)}init(){hb.AFrameworkApplication.ea.hr(()=>{this.DSb()})}DSb(){Object(df.a)(Hj);Object(df.a)(Gj);Object(df.a)(yi);var F=!1;Ki.a.instance.xnk();hb.AFrameworkApplication.kB&&(F=!0);hb.AFrameworkApplication.iDg&&(hc.a.instance.eJj(),0<hb.AFrameworkApplication.$fg&&this.E2e(),this.GOk(),F=!0);hb.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&
F&&Xa.instance.cJj();hb.AFrameworkApplication.Ydl&&(F=hc.a.instance,F.ypk(),F.nJj(),Ma.TaskManager.instance.Ag(this.Zdl))}GOk(){Pb.instance.$1e(Object(Wg.a)(hc.a.instance,hc.a.instance.dJj,"makeGetMruRequestActivityTrigger"));Pb.instance.$1e(this.E2e);Pb.instance.zAh(this.Sei)}get agg(){return this.dWe||(this.dWe=new qi.a(5,2,hb.AFrameworkApplication.$fg,Object(Wg.a)(hc.a.instance,hc.a.instance.KVi,"getMruFromServerTask"),109))}get Zdl(){return this.rEb||(this.rEb=new qi.a(2,2,6E4*hb.AFrameworkApplication.ea.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",
1440),Object(Wg.a)(hc.a.instance,hc.a.instance.oJj,"makeUpdateMruTask"),197))}dispose(){this.ep||(this.ep=!0,this.rEb&&(Ma.TaskManager.instance.Xr(this.rEb),this.rEb=null))}}Object(O.a)(Qc,"CorePackageManager",null,[11,12,4]);const vd=Object(df.b)("Common.App.O365Shell.O365ShellActor"),Nd=Object(df.c)(vd);var ke=a(991);class Be{constructor(F,va){this.yjd=this.xjd=null;this.Fab=new Mf.a;this.j0e=!1;this.f0b=lb=>{let sc=null;sc&&sc.length||!lb||!lb.data||(sc=lb.data.responseData);if(sc&&sc.length)try{const Yc=
ua.a(sc);this.xjd=Yc.NavBarDataJson;C.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");this.xjd?(()=>{let jd=ua.d(Yc.NavBarDataJson);({Ws:this.yjd}=jd);return jd})().returnValue?(this.fGj(this.yjd),this.Fab.setResult(this.yjd)):(C.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:ke.a.k7a(this.xjd)}),this.Fab.Yx()):(C.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.Fab.Yx())}catch(Yc){C.ULS.sendTraceTag(6362370,215,
10,"Unable to parse the response from O365ShellServiceProxy."),this.Fab.Yx()}else C.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")};this.n_b=()=>{this.Fab.Yx();C.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")};this.sg=F;this.qha=va.appSettings[Be.okl]||"";this.j0e=va.getBooleanFeatureGate("Microsoft.Office.SharedOnline.WACAADTokenForO365ShellServiceProxyAshxIsEnabled",!1)}get YPk(){return this.Fab.task}get yba(){return this.sg.value}Wxk(){this.j0e?
this.yba.p0b(()=>{this.xJg()}):this.xJg()}xJg(){const F={};F[Be.baj]=hb.AFrameworkApplication.Uh;F["Content-Type"]="application/json; charset=utf-8";C.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const va=Ta.a.yk(this.qha+Be.ZPk,Be.aSj,hb.AFrameworkApplication.ua.Ab.gi.toString());this.yba.Wn(va,1,"",F,!0,2,this.f0b,this.n_b,null,void 0,void 0,void 0,void 0,"20")}fGj(F){try{const va={};va.FlightName=F.FlightName;va.SessionID=F.SessionID;C.ULS.sendTraceTag(594883776,
215,50,ua.c(va))}catch(va){C.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}static get instance(){return Be.Wa||(Be.Wa=Be.yca())}static yca(){return new Be(new Ji.a(()=>hb.AFrameworkApplication.od),hb.AFrameworkApplication.ea,hb.AFrameworkApplication.ua.Ab.gi)}}Be.baj="X-qs";Be.aSj="at";Be.ZPk="O365ShellServiceProxy.ashx";Be.Wa=null;Be.okl="ShellWebServiceBase";Object(O.a)(Be,"O365ShellActor",null,[795]);class Ze{constructor(){this.oc=null;this.LC=()=>{hb.AFrameworkApplication.useO365ShellService&&
hb.AFrameworkApplication.ua.Ab.ms&&Object(df.a)(Nd).Wxk()}}get name(){return"Common.App.O365Shell"}ji(F){this.oc=F;this.oc.register(Be,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").Lc().Qc(()=>new Be(new Ji.a(()=>hb.AFrameworkApplication.od),hb.AFrameworkApplication.ea,hb.AFrameworkApplication.ua.Ab.gi))}init(){hb.AFrameworkApplication.ea.hr(this.LC)}dispose(){}static main(){bj.a.instance.Qi(new Ze)}}Object(O.a)(Ze,"PackageManager",null,[11,12]);class of extends ie.a{constructor(F,
va){super();this.activityName=F;this.WP=va;this.ri()}create(){this.Uf(new cb(this.activityName,this.WP,Ce.a.aC,Ce.a.yj,Ce.a.fwb))}static Ea(F){F.ra.zc(143,new of(Ce.a.Qma,Ce.a.Wcb));F.ra.zc(144,new of(Ce.a.R5b,Ce.a.vKa));F.ra.zc(145,new of(Ce.a.S5b,Ce.a.TPc));F.ra.zc(154,new of(Ce.a.kMa,Ce.a.hS))}}Object(O.a)(of,"SessionReloadSilentActivityFactory",ie.a,[]);var Xf=a(1083),bg=a(144),Mg=a(1088);class Jg{constructor(F){this.gYb=F}get name(){return"CopilotBootVisibilityCheck"}ji(){}init(){const F=async va=>
{const lb=Date.now(),sc=await va.isFeatureEnabled("Copilot",!1);va=Date.now()-lb;C.ULS.sendTraceTag(507839317,3050,50,"[Copilot Chat] Early call to Copilot license check latency: "+va);hb.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowEarlyAFHCHeck",!1)?pi.c()?(C.ULS.sendTraceTag(507331603,306,50,"Copilot Chat loaded so dispatching visibility"),appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(this.gYb,!sc))):(C.ULS.sendTraceTag(507331602,3050,50,
"[Copilot Chat] AppChrome not loaded so setting cached visibility in local storage"),Object(Mg.b)(this.gYb,sc),bg.a.get_instance().Mg(10,()=>{pi.c()&&(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(this.gYb,!sc)),C.ULS.sendTraceTag(507839316,306,50,"Copilot Chat visibility marked early"))})):bg.a.get_instance().Mg(10,()=>{pi.c()&&(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(this.gYb,!sc)),C.ULS.sendTraceTag(507331601,306,50,"Copilot Chat visibility marked early"))})};
hb.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowEarlyAFHCHeck",!1)?hb.AFrameworkApplication.ea.hr(()=>{Object(Mg.a)(this.gYb)?C.ULS.sendTraceTag(507331875,306,50,"Copilot Chat visibility already cached, skipping early check"):F(Object(Xf.a)())}):Object(df.d)(Bf.a).execute(F)}dispose(){}}Object(O.a)(Jg,"CopilotBootVisibilityCheck",null,[11,12]);oa.EwaSettings.KN()||Object(sd.a)();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");
(()=>{Xi.a.wb(F=>{Qh.Ea(F)})})();a(1558);Type.registerNamespace("Common.App.GestureManager");tj.main();Type.registerNamespace("Common.App.AccessibilitySettings");Hi.main();(()=>{Xi.a.wb(F=>{oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)||lj.Ea(F)})})();a(1560);Type.registerNamespace("Common.App.NewAndOpen.Core");bj.a.instance.Qi(new Qc);Type.registerNamespace("Common.App.O365Shell");Ze.main();oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveRequireFromSlices",
!1)||a(1362);bj.a.instance.Qi(new Jg("Copilot"));(()=>{Xi.a.wb(F=>{Ba.SessionReloadSilentActivityService.Oa()||of.Ea(F)})})();String(m);String(u);String(l);String(t);String(n);String(e);String(w);String(z);String(E);String(M);String(G);String(A);String(N);String(K);String(I);String(L);String(J);String(B);String(Y);window.___1717508060463_closurehack=m;window.___1717508060463_closurehack=u;window.___1717508060463_closurehack=l;window.___1717508060463_closurehack=t;window.___1717508060463_closurehack=
n;window.___1717508060463_closurehack=e;window.___1717508060463_closurehack=w;window.___1717508060463_closurehack=z;window.___1717508060463_closurehack=E;window.___1717508060463_closurehack=M;window.___1717508060463_closurehack=G;window.___1717508060463_closurehack=A;window.___1717508060463_closurehack=N;window.___1717508060463_closurehack=K;window.___1717508060463_closurehack=I;window.___1717508060463_closurehack=L;window.___1717508060463_closurehack=J;window.___1717508060463_closurehack=B;window.___1717508060463_closurehack=
Y}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.frs.js.map/ec07145dca8bfe18014c17257a5e5399/EwaTS.frs.js.map