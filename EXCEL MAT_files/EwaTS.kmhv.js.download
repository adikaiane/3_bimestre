'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[12],{1322:function(y,r,a){a.d(r,"a",function(){return f});y=a(0);r=a(244);var c=a(17),b=a(12);class f extends r.a{constructor(k,x,d,h){super(k,d,2,void 0===h?null:h);this.Dbd=null;this.onResize=()=>{const n=this.TSi();this.AYa.setAttribute("width",n.x.toString());this.AYa.setAttribute("height",n.y.toString());this.ucl(n);this.tog()};this.Nnf=x;this.$.DD(this.onResize);this.JRd()}get AYa(){return this.Dbd}initialize(){const k=
this.$.Oc+"iframeDialog_frame",x=this.$.Oc+"iframeDialog";this.Ld.style.margin=b.HelperMethods.$c(0);this.Ld.style.marginBottom=b.HelperMethods.$c(-2);const d=document.createElement("iframe");d.id=k;d.frameBorder="0";d.scrolling="auto";d.src=this.cJf(x);this.Ld.appendChild(d);this.Dbd=document.getElementById(k);this.domElement.id=x;this.onResize(null,Sys.EventArgs.Empty);super.initialize()}dispose(){this.$&&this.$.vG(this.onResize);super.dispose()}setFocus(){c.DOMElementExtensions.setFocus(this.AYa)}onHide(){this.AYa.contentWindow.close();
c.DOMElementExtensions.vh(this.AYa);this.Dbd=null;super.onHide()}ucl(k){const x=this.domElement.style;x.width=b.HelperMethods.$c(k.x);x.marginLeft=b.HelperMethods.$c(-k.x/2)}TSi(){const k=c.DOMElementExtensions.getBounds({element:document.body});return new Sys.UI.Point(Math.min(Math.floor(.9*k.width),this.Nnf.x),Math.min(Math.floor(.9*k.height),this.Nnf.y))}}Object(y.a)(f,"IFrameDialog",r.a,[])},1323:function(y,r,a){a.d(r,"a",function(){return x});y=a(0);r=a(1002);var c=a(147),b=a(20),f=a(64),k=a(13);
class x extends r.a{constructor(d,h,n,m,u,l,t){l=void 0===l?0:l;super(d,k.a.instance.ia(h),!1);this.Mc=null;this.message=n;this.q8d=m;this.kCe=u;this.operationFlags=l;this.Mc=t}get Tc(){return"WebMethodConfirmationDialog"}get kD(){return 1005}get Eeb(){return this.operationFlags}initialize(){let d="<div class='"+c.a.LF+"'>\r\n\t<div class='"+c.a.cvf+"'>\r\n\t\t<div class='"+b.a.vff+"'>\r\n\t\t\t<img src='{0}' class='"+b.a.Xxf+"' alt='{1}' />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class='"+c.a.dvf+"'>\r\n\t\t<p>{2}</p>\r\n\t</div>\r\n</div>";
d=String.format(d,f.a.Lh(13),k.a.instance.ia(25),k.a.instance.ia(this.message));this.Mc.vl(this.Ld,d);this.addButton(0,this.q8d);this.addButton(1);super.initialize()}QJ(){return this.kCe}}Object(y.a)(x,"WebMethodConfirmationDialog",r.a,[])},1324:function(y,r,a){a.d(r,"b",function(){return b});a.d(r,"c",function(){return f});a.d(r,"a",function(){return k});var c=a(61);const b=(x,d,h,n,m,u)=>{u=x.$a(1,u);return c.h(x,"ShareForm",u,d,h,n,m,0)},f=(x,d,h,n,m,u)=>{u=x.$a(1,u);return c.h(x,"UnshareForm",
u,d,h,n,m,0)},k=(x,d,h,n,m,u)=>{u=x.$a(9,u);u.surveyId=null;return c.h(x,"DeleteSurvey",u,d,h,n,m,0)}},1522:function(y,r,a){r=a(490);a=a(1523);a=a.Di?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);r(a,{insert:"head",Oj:!1});y.exports=a.Fk||{}},1523:function(y,r,a){r=a(489)(!1);r.push([y.i,".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107C41;z-index:1030}",""]);
y.exports=r},1525:function(y,r,a){a.r(r);(function(c){a.d(r,"SocialSharingCommandHandler",function(){return ia});var b=a(133),f=a(0),k=a(15),x=a(6),d=a(136),h=a(189),n=a(39),m=a(263),u=a(232),l=a(268),t=a(100),e=a(74),w=a(73),z=a(43),E=a(240),M=a(715),G=a(83),A=a(36),N=a(1),K=a(12),I=a(209),L=a(28),J=a(25),B=a(45),Y=a(283),U=a(1527),O=a(1620),C=a(1529),X=a(1528),S=a(1324),ea=a(1323),Oa=a(278),Ha=a(8),Za=a(89),fa=a(287),la=a(76),ba=a(765),aa=a(163),oa=a(622),Na=a(98),Ia=a(291),Sa=a(26),Pa=a(18),za=
a(1526),wa=a(88),db=a(65),Ba=a(5),Ka=a(177),da=a(7),sa=a(210),mb=a(256),Ma=a(1063),hb;const $a=N.EwaSettings.isChangeGateEnabled("OfficeVSO:8560736_shouldEnableBase64EncodingForContextualLocation"),Va=N.EwaSettings.isChangeGateEnabled("OfficeVSO:8840907_shouldEnableUpdatedBase64Encoding"),xa=N.EwaSettings.isChangeGateEnabled("OfficeVSO:8938416_ShareDialogExitFullScreen");let ia=hb=class extends u.a{constructor(Z,ta,pa){super();this.Wbf=this.Xbf=!1;this.jhb=0;this.Isa=!1;this.ZTj=Ga=>{var Ca;N.EwaSettings.isChangeGateEnabled("OfficeVSO:9005963_FixEmbedUrlRecivedFromHost")&&
(Ga=null===(Ca=Ga.Values.HostEmbeddedViewUrl)||void 0===Ca?void 0:Ca.toString(),this.$.z7g(Ga));this.Xbf=!0;this.eWg()};this.$=Z;this.Ya=ta;this.XQ=pa;la.a(this.$).Zge(new aa.a(Ha.a.I6g,Ha.a.idle,hb.FWh),new Oa.a(Ha.a.Iff,Ha.a.U8,null,Ha.a.hS,Ha.a.idle))}get H4c(){return t.b(this.$.Pf)}get rme(){return this.$.isEditMode&&(this.$.fa.zki||this.$.hU)}gd(Z,ta){switch(ta){case 353606613:case -1099009678:case 192430811:return!N.EwaSettings.isChangeGateEnabled("OfficeVSO:8096934_ShareExcelSection")||this.ure();
case 783415632:return!N.EwaSettings.isChangeGateEnabled("OfficeVSO:8096933_ShareExcelSheet")||this.ure();case 709515373:return!N.EwaSettings.isChangeGateEnabled("OfficeVSO:8575759_CopyLinkContextMenu")||this.ure();case 869186573:return this.xUg();case -1570751769:case 1986648902:return 131072!==(this.$.DT&131072);case 330035228:return!(this.Mhb(!0)&&this.H4c);case -509039657:return!(this.Mhb()&&this.H4c);case 1334518759:return!(this.Mhb()&&this.H4c&&this.icf())}return!1}ure(){return this.$.fa.isNamedObjectViewMode||
this.$.isMobileMode||this.xUg()}xUg(){const Z=this.$.workbookContext.FullDocumentInfo,ta=Ia.a()&&this.$.fa.Kh.get(5);return!Z.FileSharingUrl&&!ta}executeCommand(Z,ta,pa){Z=this.$.workbookContext.FullDocumentInfo;const Ga=Sa.a.workflow;var Ca=z.TaskExtensions.kl();const kb=ta.command;if(kb===Ga||-266099===kb)return this.V$i(ta,Ga,Z);switch(kb){case 1986648902:this.SSg();break;case -1570751769:this.H7i(ta);break;case 869186573:xa&&Ma.a.ida&&this.$.Ia.Gb(new G.a(-1912752143,0,this.$.xc,8,null),{["triggeredBy"]:"share"});
var eb=Sa.a.TOk;ta=x.AFrameworkApplication.ea.ka("ShareMenuIsEnabled");Ca=null;(N.EwaSettings.Ra(478)||ta)&&pa&&"CopyLink"===pa.SourceControlId?(Ca={mode:"copy"},eb=Sa.a.qqe):ta&&pa&&"ManageAccess"===pa.SourceControlId?(Ca={mode:"manageAccess"},eb=Sa.a.VOk):pa&&"LinkToComment"===pa.SourceControlId?(Ca={mode:"copy"},Ca.nav=pa.navId,N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareContextualInfo",!1)&&(Ca.contextualSharingContext=8),eb=Sa.a.qqe):!pa||"SaveAsCopyLink"!==pa.SourceControlId&&
"ShareCopyLink"!==pa.SourceControlId&&"ShareTabCopyLink"!==pa.SourceControlId?"SharePointOnlineConsumer"===x.AFrameworkApplication.ea.Qa("FileSource")&&(Ca={},mb.a.tt("WACsimplifiedshare-t;WACsimplifiedshare-c"),pa=x.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsInOfficeSimplifiedShareTreatment",!1),Ca.isInOfficeSimplifiedShareTreatment=pa):(Ca={mode:"copy"},eb=Sa.a.qqe);Ca=this.EXg(Z,Ca);Na.c(eb);break;case -1099009678:Ca=this.I6b(12,Z);break;case 192430811:Ca=this.I6b(13,
Z);break;case 353606613:Ca=this.I6b(14,Z);break;case -1592351768:Ca=m.a.Va(!0);N.EwaSettings.isChangeGateEnabled("OfficeVSO:8501332_ShareExcelNamedSheetView")&&(pa=this.$.qa.la,(null===(eb=null===pa||void 0===pa?void 0:pa.ue)||void 0===eb?0:eb.vI)?(k.ULS.sendTraceTag(508164248,0,50,"SocialSharingCommandHandler.ExecuteCommand: Auto save named sheet view invoked, on sharing temporary named sheet view"),this.$.Dc(621685370,-1,0,{[da.a.vqf]:!0})):(pa=da.a.x3a,Ca=this.I6b(16,Z),pa!==Ka.a(this.$).um.Tw&&
Ka.a(this.$).um.activateRibbonTab(pa)));break;case 783415632:xa&&Ma.a.ida&&this.$.Ia.Gb(new G.a(-1912752143,0,this.$.xc,8,null),{["triggeredBy"]:"share"});pa&&"LinkToThisSheet"===pa.SourceControlId&&k.ULS.sendTraceTag(509691100,0,50,"SocialSharingCommandHandler.ExecuteCommand: Share Sheet invoked from Collab Corner");Ca=this.I6b(15,Z);break;case -59906385:case 1197060601:this.T9i(ta,Z);break;case 1305810481:this.hRf(!1,ta);break;case 330035228:this.hRf(!0,ta);break;case -509039657:Z=Object(wa.d)(db.a.resolve(Ba.HtmlSanitizationHelperService,
{xa:0}));z.TaskExtensions.tb(Z,Yb=>{this.deleteForm(Yb.result)},this.$.Aa,3);break;case 1334518759:ta.jUb=!0;Z=Object(wa.d)(db.a.resolve(Ba.HtmlSanitizationHelperService,{xa:0}));z.TaskExtensions.tb(Z,Yb=>{this.shareForm(Yb.result)},this.$.Aa,3);break;case 710925581:w.a.Eg.BYc("710925581")&&(Ca=z.TaskExtensions.tb(Object(wa.d)(this.XQ(0)),Yb=>{Yb.result.sendMessage(d.a.conversation,{})},this.Aa,3));break;case 327119921:this.p7i();break;default:Ca=I.a(kb)}return Ca}Rc(Z,ta){Z=!1;ta=ta.command;if(ta===
Sa.a.workflow)return!0;switch(ta){case 1986648902:case -1570751769:case 869186573:case -59906385:case 1197060601:case 1305810481:case 330035228:case -509039657:case 1334518759:case -266099:case 710925581:case 327119921:Z=!0;break;case 353606613:case -1099009678:case 192430811:Z=N.EwaSettings.isChangeGateEnabled("OfficeVSO:8096934_ShareExcelSection")&&!this.$.fa.isNamedObjectViewMode;break;case -1592351768:Z=N.EwaSettings.isChangeGateEnabled("OfficeVSO:8501332_ShareExcelNamedSheetView")&&!this.$.fa.isNamedObjectViewMode;
break;case 783415632:Z=N.EwaSettings.isChangeGateEnabled("OfficeVSO:8096933_ShareExcelSheet")&&!this.$.fa.isNamedObjectViewMode;break;case 709515373:Z=N.EwaSettings.isChangeGateEnabled("OfficeVSO:8575759_CopyLinkContextMenu")&&!this.$.fa.isNamedObjectViewMode}return Z}td(Z,ta,pa){if("PopulateFormMenu"===ta){ta=this.H4c?this.icf()?hb.pyi:hb.qyi:hb.yPj;Z=this.Ya.uc();for(let Ga=0;Ga<ta.length;Ga++)Z.buttons.push(this.Ya.yb(ta[Ga]));ta=this.Ya.pq("Forms.Flyout");ta.Zb.push(Z);pa.MenuItems=ta.wH();return!0}return!1}V$i(Z,
ta,pa){return this.rme&&Z.command===ta?(this.pme(Z,-266099),z.TaskExtensions.E7()):z.TaskExtensions.tb(Object(wa.d)(this.XQ(0)),Ga=>{M.a(Ga.result,d.a.workflow,null,pa.WorkflowPostMessage)||K.HelperMethods.Rg(pa.WorkflowUrl,"_blank",void 0,"SocialSharingCommandHandler.WorkflowUrl")},this.Aa,3)}icf(){return!!this.$.workbookContext.FullDocumentInfo.ShareFormCommandUrl||this.$.fa.Kh.get(26)}p7i(){const Z=h.a.create().toString();k.ULS.sendTraceTag(528581128,306,50,`Calling share to teams deeplink with ID: ${Z}`);
this.$.frame.lZb(Object(za.b)(Z,this.$),!0)}H7i(Z){this.rme?this.pme(Z,1986648902):this.SSg()}hRf(Z,ta){!Z&&this.$.ta.SurveyRedirectUrl?this.Mgk():(Z=new O.a(this.$,Z,ta),Z.initialize(),Z.Om())}T9i(Z,ta){this.rme&&1197060601===Z.command?this.pme(Z,-59906385):z.TaskExtensions.tb(Object(wa.d)(this.XQ(0)),pa=>{pa=pa.result;pa&&M.a(pa,d.a.replyWithChanges,null,this.$.fa.Kh.get(8))||(pa=new Sys.StringBuilder(ta.ReplyWithChangesUrl),E.a.ol(pa,oa.e,oa.d),l.a.ntw(pa.toString(),this.$))},this.Aa,3)}pme(Z,
ta){const pa=la.a(this.$).Kd.activityState,Ga=new G.a(ta,Z.method,Z.mode,Z.Re,Z.tabName);B.a(this.$).Dt(new Y.a(Ha.a.xy,5,()=>{pa[fa.a.Tq]=Ha.a.QMg;pa[ba.a.Ymd]=Ga;this.$.Nm.BD("SocialSharingSaveBeforeCommand");this.$.Nm.c3e(Ga.command)}))}SSg(){const Z=this.$.ta.DocumentHostInfo;Z.HostEmbeddedViewUrl||this.Xbf?this.eWg():this.$.Fe.get(53)&&z.TaskExtensions.tb(Object(wa.d)(this.XQ(0)),ta=>{this.X9k(ta.result)||l.a.ntw(Z.FileEmbedCommandUrl,this.$)},this.Aa,3)}X9k(Z){return Z.isEnabled()&&(this.Wbf||
(this.Wbf=Z.ik(d.a.Vbf,this.ZTj)))?Z.sendMessage(d.a.Szi,null):!1}eWg(){if(n.a.ot)l.a.ntw(this.$.ta.EmbedConfiguratorUrl,this.$);else{const Z=new U.a(this.$);Z.initialize();Z.Om()}}deleteForm(Z){const ta=this.$;Z=new ea.a(ta,1277,1278,1270,(pa,Ga,Ca)=>{const kb=ta.ma.sa.mc();return S.a(ta.ma.sa,pa,Ga,Ca,null,kb)},0,Z);Z.initialize();Z.Om()}shareForm(Z){const ta=this.$.workbookContext.FullDocumentInfo;this.$.fa.Kh.get(26)?(Z=new X.a(this.$,Z),Z.initialize(),Z.Om()):z.TaskExtensions.tb(Object(wa.d)(this.XQ(0)),
pa=>{M.a(pa.result,d.a.shareForm,{["SurveyTitle"]:this.$.workbookContext.SurveyTitle},this.$.fa.Kh.get(10))||l.a.ntw(ta.ShareFormCommandUrl,this.$)},this.Aa,3)}Mgk(){const Z=this.$;Z.ta.SurveyRedirectUrl.replace(RegExp("&startupdialog=[formedit|formpreview]","gi"),"");const ta=new Sys.StringBuilder(Z.ta.SurveyRedirectUrl);E.a.ol(ta,"startupDialog","FormEdit");const pa=la.a(this.$),Ga=pa.Kd.activityState;Ga[Za.a.Haa]=ta.toString();Ga[Za.a.QS]=Za.a.H6d;this.$.Nm.BD("SocialSharingEnvironmentChange");
B.a(Z).Dt(new Y.a(Ha.a.xy,5,()=>{const Ca=A.a.Cd(3,2,1322,1323,1324,554412057,"FossEnvironmentUnsupported");pa.Kd.Yt([Ca]);Ga[fa.a.Tq]=Ha.a.I6g}))}Mhb(Z){return(this.$.fa.isEditMode||(void 0===Z?!1:Z))&&this.$.fa.Kh.get(25)&&Ia.a()}R0i(Z){var ta=void 0===ta?null:ta;var pa=J.f(this.$).ha;let Ga=!1;const Ca=this.$.qa.la?e.d(this.$.qa.la):null;if(!Ca)return k.ULS.sendTraceTag(537151649,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find current sheet id for navType: ${C.a[Z]}.`),null;
var kb=ta;let eb=ta=null;const Yb=N.EwaSettings.isChangeGateEnabled("OfficeVSO:8683552_ShareContextualInfo");switch(Z){case 15:Yb&&(eb=this.$.activeItemName,ta=5);break;case 14:kb=this.n0i(pa);Yb&&(eb=this.m0i(pa),ta=6);break;case 12:kb=pa.Xra;kb=L.a.contains(kb,"!",!0)?kb.split("!")[1]:kb;J.f(this.$).ha.oa.fE()&&(Ga=!0);Yb&&(ta=3,eb=kb);break;case 13:var Gb=pa.oa.selectedRanges;Gb[0]&&(pa=J.f(this.$).ha.oa.activeCell,(pa=J.f(this.$).Eb.dg(pa))||(pa=sa.a(this.$,Gb[0])),pa&&(pa.activate({scenario:"namedObject"}),
kb=pa.ll,Yb&&(ta=4,eb=pa.name)));break;case 16:N.EwaSettings.isChangeGateEnabled("OfficeVSO:8501332_ShareExcelNamedSheetView")&&(kb=this.$.qa.la,kb=null===(Gb=null===kb||void 0===kb?void 0:kb.ue)||void 0===Gb?void 0:Gb.PW,Yb&&(ta=7,eb=kb))}if(!kb&&15!==Z)return k.ULS.sendTraceTag(537151648,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find the selected range reference or object id for navType: ${C.a[Z]}`),null;Gb={mode:"copy"};Gb.nav=this.UPi(Z,kb,Ca);Gb.scenarioId="deepLinkShare";
Yb&&(Gb.contextualSharingContext=ta,eb?(ta=$a?Va?Object(za.a)("'"+eb+"'"):this.base64Encoding("'"+eb+"'"):btoa("'"+eb+"'"),Gb.contextualSharingLocation=ta):k.ULS.sendTraceTag(508036745,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find contextual sharing location for navType: ${C.a[Z]}`));k.ULS.sendTraceTag(537151647,0,50,`SocialSharingCommandHandler.GetSharingDetail: Send Section_Sharing post message with navType: ${C.a[Z]} and SheetId: ${Ca} and isPartialTable: ${Ga}`);return Gb}n0i(Z){if(Z.ob.isFloatingObjectSelected&&
(Z=Z.ob.Wb.floatingObject)&&0===Z.type){const ta=Z.id.split(".");if(1<ta.length)return ta[1];k.ULS.sendTraceTag(537151646,0,10,`SocialSharingCommandHandler.GetSelectedFloatingObjectXluid: Invalid floating object id =  ${Z.id}`)}return null}m0i(Z){var ta;return(Z=null===Z||void 0===Z?void 0:Z.ob)&&Z.isFloatingObjectSelected&&(Z=null===(ta=Z.Wb)||void 0===ta?void 0:ta.floatingObject)&&0===Z.type?Z.name:null}UPi(Z,ta,pa){let Ga=Z+"_";Ga=15===Z?Ga+pa:Ga+(ta+"_"+pa);$a?Ga=Va?Object(za.a)(Ga):this.base64Encoding(Ga):
(Ga=btoa(Ga),Ga=Ga.replace(RegExp("\\+","g"),"-"),Ga=Ga.replace(RegExp("\\/","g"),"_"),Ga=Ga.replace(RegExp("\\=+$","g"),""));(null==Ga||1024<Ga.length)&&k.ULS.sendTraceTag(507785753,0,10,`SocialSharingCommandHandler.GetEncodedValue: Either encoded navid is null or the length of encoded navid exceeds 1024 characters, navid length = ${null===Ga||void 0===Ga?void 0:Ga.length}`);return Ga}base64Encoding(Z){try{let ta=c.from(Z).toString("base64");ta=ta.replace(RegExp("\\+","g"),"-");ta=ta.replace(RegExp("\\/",
"g"),"_");return ta=ta.replace(RegExp("\\=+$","g"),"")}catch(ta){k.ULS.sendTraceTag(507785752,0,10,`SocialSharingCommandHandler.Base64Encoding: Error while encoding the content to base64. The exception is: ${ta}`)}return null}EXg(Z,ta,pa){pa=void 0===pa?!1:pa;return z.TaskExtensions.tb(Object(wa.d)(this.XQ(0)),Ga=>{M.a(Ga.result,d.a.sharing,ta,this.$.fa.Kh.get(5))?(k.ULS.sendTraceTag(537151644,0,50,`SocialSharingCommandHandler.ShowShareDialog: Send UI_Sharing post message with mode: ${ta?ta.mode:
""}`),pa&&N.EwaSettings.isChangeGateEnabled("OfficeVSO:8096934_ShareExcelSection")&&!this.Isa&&(this.jhb=window.setInterval(()=>{this.R7k()},6E4),this.Isa=!0)):K.HelperMethods.Rg(Z.FileSharingUrl,"_blank",void 0,"SocialSharingCommandHandler.FileSharingUrl")},this.Aa,3)}I6b(Z,ta){if(15===Z&&!N.EwaSettings.isChangeGateEnabled("OfficeVSO:8096933_ShareExcelSheet")||15!==Z&&!N.EwaSettings.isChangeGateEnabled("OfficeVSO:8096934_ShareExcelSection")||this.$.isMobileMode)return null;const pa=this.R0i(Z);if(pa)return k.ULS.sendTraceTag(520737606,
0,50,`SocialSharingCommandHandler.ShareExcelSection: Calling share dialog with nav id=${pa.nav.substring(0,3)}`),this.EXg(ta,pa,!0);k.ULS.sendTraceTag(537151643,0,10,`SocialSharingCommandHandler.ShareExcelSection: Unable to get the sharing details for navType: ${C.a[Z]}`);return null}R7k(){this.Isa&&window.clearInterval(this.jhb);this.$.Dc(638984051,0,0,null);k.ULS.sendTraceTag(512328542,0,50,"SocialSharingCommandHandler.triggerDeepLinkCreationSurvey: FPS survey got triggered.")}};ia.yPj=[103];ia.pyi=
[107,104,105,106];ia.qyi=[104,105];ia.FWh=[new Pa.a(Ha.a.Iff,554412057,0,0,1325),new Pa.a(Ha.a.idle,554412057,0,1)];ia=hb=Object(b.__decorate)([Object(db.d)(Ba.SocialSharingCommandHandlerService),Object(b.__param)(0,Object(Ba.EwaControlService)()),Object(b.__param)(1,Object(Ba.RibbonControlsService)()),Object(b.__param)(2,Object(Ba.HostMessengerService)({CU:!0}))],ia);Object(f.a)(ia,"SocialSharingCommandHandler",u.a,[29])}).call(this,a(795).Buffer)},1526:function(y,r,a){function c(m,u){const l=new k.QueryStringBuilder(f.AFrameworkApplication.ea.Qa("TeamsMeetingShareEndpoint"));
l.uj("deeplinkId",m);l.uj("lm","deeplink");m=l.uj;var t={};const e=new k.QueryStringBuilder(f.AFrameworkApplication.ea.Qa("TeamsAppSharingUrl"));e.uj("auth","2");e.uj("flight","officeunihost");e.uj("source","deepLink_online");var w={};w.fileType=x.a.x7(u.workbookContext.FullDocumentInfo.WorkbookPath).substring(1);w.objectUrl=n.EwaSettings.isChangeGateEnabled("OfficeVSO:8053799_EncodeUrlFixForDeeplink")?encodeURI(u.workbookContext.FullDocumentInfo.WorkbookPath):u.workbookContext.FullDocumentInfo.WorkbookPath;
w.baseUrl=n.EwaSettings.isChangeGateEnabled("OfficeVSO:8053799_EncodeUrlFixForDeeplink")?encodeURI(u.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl):u.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl;{u=u.workbookContext.WorkbookFileVersionId;let z=decodeURIComponent(u);for(;u!=z;)u=z,z=decodeURIComponent(u);0>u.indexOf("{")||0>u.indexOf("}")?(h.ULS.sendTraceTag(528250338,306,15,`Decoded fileId does not match expected format. Decoded id: ${u}`),u=""):u=u.substring(u.indexOf("{")+1,u.indexOf("}")).toLowerCase()}w.fileId=
u;w=d.c(d.c(w));e.uj("subEntityId",w.substring(1,w.length-1));t.appSharingUrl=e.toString();t.appId=f.AFrameworkApplication.ea.Qa("TeamsAppId");t.useMeetNow=!0;t=JSON.stringify(t);m.call(l,"appContext",t);return l.toString()}function b(m){if(null==m)return h.ULS.sendTraceTag(507282765,0,10,"CoEditInTeamsUrlHelper.Base64Encoding: Error while base64 encoding the null content."),null;try{let u=null;const l=(new TextEncoder).encode(m),t=Array.from(l,e=>String.fromCodePoint(e)).join("");u=btoa(t);u=u.replace(RegExp("\\+",
"g"),"-");u=u.replace(RegExp("\\/","g"),"_");return u=u.replace(RegExp("\\=+$","g"),"")}catch(u){h.ULS.sendTraceTag(507285765,0,10,`CoEditInTeamsUrlHelper.Base64Encoding: Error while base64 encoding the content. The exception is: ${u}`)}return null}a.d(r,"b",function(){return c});a.d(r,"a",function(){return b});var f=a(6),k=a(284),x=a(32),d=a(48),h=a(15),n=a(1)},1527:function(y,r,a){a.d(r,"a",function(){return d});y=a(0);var c=a(15);r=a(1322);var b=a(7),f=a(240),k=a(13),x=a(1);class d extends r.a{constructor(h){super(h,
new Sys.UI.Point(960,680),k.a.instance.ia(1264));this.name=b.a.wsf}get Tc(){return"EmbeddingDialog"}cJf(h){const n=new Sys.StringBuilder(this.$.ta.EmbedConfiguratorUrl);f.a.ol(n,b.a.Wpi,h);this.$.ta.AlternateEwaBasePrefix&&f.a.ol(n,b.a.Vuf,this.$.ta.AlternateEwaBasePrefix);this.$.ta.AlternateEwaBaseFolder&&f.a.ol(n,b.a.Uuf,this.$.ta.AlternateEwaBaseFolder);x.EwaSettings.isChangeGateEnabled("OfficeVSO:9005963_FixEmbedUrlRecivedFromHost")&&this.$.ta.DocumentHostInfo.HostEmbeddedViewUrl&&f.a.ol(n,"edheu",
this.$.ta.DocumentHostInfo.HostEmbeddedViewUrl);return n.toString()}onShow(){c.ULS.sendTraceTag(537151690,0,50,"EmbeddingDialog.OnShow: the dialog is being shown");super.onShow()}}Object(y.a)(d,"EmbeddingDialog",r.a,[])},1528:function(y,r,a){a.d(r,"a",function(){return t});y=a(0);var c=a(91),b=a(39);r=a(1263);var f=a(147),k=a(20),x=a(668),d=a(1203),h=a(17),n=a(13),m=a(333),u=a(1324),l=a(1323);class t extends r.a{constructor(e,w){super(e,n.a.instance.ia(1271));this.Mc=this.w7a=this.U4a=this.Za=null;
this.fug=()=>{const z=this.$;this.zF();const E=new l.a(z,1274,1275,1276,(M,G,A)=>{const N=z.ma.sa.mc();return u.c(z.ma.sa,M,G,A,null,N)},16,this.Mc);E.initialize();E.Om()};this.Mc=w}get Tc(){return"ShareFormDialog"}dispose(){this.w7a&&this.w7a.Lea(this.fug);c.a.xd([this.Za,this.U4a,this.w7a]);this.w7a=this.U4a=this.Za=null;super.dispose()}initialize(){let e="<div class='"+f.a.LF+"'>\r\n\t<span>{0}</span>\r\n</div>\r\n<div class='"+f.a.yvc+"'>\r\n\t<input type='text' id='{1}' class='"+f.a.JX+"' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}</a>\r\n</div>";
e=String.format(e,n.a.instance.ia(1272),"sfd_input","sfd_unshare",k.a.XD,n.a.instance.ia(1273));this.Mc.vl(this.Ld,e);this.Za=new m.a(this.getElementById("sfd_input"));this.U4a=new d.a(this.Za.domElement);this.w7a=x.a.create(this.getElementById("sfd_unshare"));this.w7a.i6(this.fug);this.Za.text=n.a.instance.ia(736);this.Za.enabled=!1;this.Za.readOnly=!b.a.mi;this.addButton(1,10);super.initialize()}udb(){return(e,w,z)=>{const E=this.$.ma.sa.mc();return u.b(this.$.ma.sa,this.pib(e),this.TWa(w),z,null,
E)}}a9(e,w,z){this.Za.text=e.Result;this.Za.enabled=!0;h.DOMElementExtensions.setVisible(this.w7a.domElement,!0);super.a9(e,w,z)}setFocus(){if(this.Za&&this.Za.enabled)try{this.Za.focus();return}catch(e){}super.setFocus()}}Object(y.a)(t,"ShareFormDialog",r.a,[])},1529:function(y,r,a){a.d(r,"a",function(){return c});y=a(0);var c;(function(b){b[b.comment=10]="comment";b[b.range=12]="range";b[b.table=13]="table";b[b.chart=14]="chart";b[b.sheet=15]="sheet";b[b.namedSheetView=16]="namedSheetView"})(c||
(c={}));Object(y.b)("NavigationType",c)},1620:function(y,r,a){a.d(r,"a",function(){return E});y=a(0);var c=a(1099),b=a(91),f=a(78),k=a(974);r=a(1322);class x{}x.DTg="FrameDialog_ShareFromEdit";x.view="FrameDialog_View";x.Dff="FrameDialog_CloseAndRefresh";x.UOk="FrameDialog_ShareFromView";x.edit="FrameDialog_Edit";x.Zmk="FrameDialog_RefreshGrid";x.a_h="FrameDialog_CloseMe";x.Jff="FrameDialog_CloseMeError";x.ready="FrameDialog_Ready";x.Nbk="FrameDialog_PleaseClose";x.xQ="GotoRange";Object(y.a)(x,"PostMessageConstants",
null,[]);var d=a(7),h=a(213),n=a(368),m=a(240),u=a(124),l=a(255),t=a(13),e=a(266),w=a(25);class z{constructor(){this.xQ=null;this.ede=1461300262}}Object(y.a)(z,"SessionUpdateContext",null,[]);class E extends r.a{constructor(M,G,A){super(M,new Sys.UI.Point(E.jei,E.Edi),t.a.instance.ia(G?1269:1268));this.mfb=null;this.Ucd=!1;this.FPc=N=>{const K=this.$,I=new z;I.xQ=N.Values[x.xQ];let L=!1;switch(N.MessageId){case x.DTg:this.zF();L=!0;I.ede=1334518759;break;case x.view:this.nNa=t.a.instance.ia(1269);
this.Y8g(!0);break;case x.Dff:this.zF(),L=!0}N=new h.a(140,0,(J,B,Y)=>n.s(K.ma.sa,e.c(J,this.W4j),B,Y,I));N.flags=L?16:80;K.userOperationManager.enqueueOperation(N,this.fc)};this.eXj=()=>{const N=this.$;N.ta.SurveyRedirectUrl?(this.zF(),N.Dc(1305810481,0,8,null)):(this.nNa=t.a.instance.ia(1268),this.Y8g(!1))};this.i5j=()=>{const N=this.$;this.zF();N.Dc(1334518759,0,8,null)};this.g_b=N=>{const K=this.$;this.zF();N.MessageId===x.Jff&&K.fa.mId()};this.z3j=()=>{this.Ucd=!0;this.raiseEvent(E.Y1d)};this.W4j=
(N,K)=>{if(!l.a(N)){N=this.$;if(K.xQ){const I=N.fa.qa;if(I.contains(K.xQ.SheetName))this.pOc(K);else{let L=null;L=()=>{I.zxa(L);this.pOc(K)};I.sqa(L)}}1461300262!==K.ede&&N.Dc(K.ede,0,8,null)}};this.wD=G;this.fc=A}HEh(M){this.addHandler(E.Y1d,M)}Atk(M){this.removeHandler(E.Y1d,M)}get Tc(){return"FormDialog"}get V1f(){return this.Ucd}get CHc(){return this.wD}dispose(){b.a.vb(this.mfb);this.mfb=null;super.dispose()}initialize(){super.initialize();const M=f.a.getOrigin(this.$.ta.FormLightBoxUrl),G=this.mfb=
new c.a(this.AYa.contentWindow,M);G.isEnabled()&&G.pH(M)&&(this.rxa(x.DTg,this.FPc),this.rxa(x.view,this.FPc),this.rxa(x.Dff,this.FPc),this.rxa(x.UOk,this.i5j),this.rxa(x.edit,this.eXj),this.rxa(x.Zmk,this.FPc),this.rxa(x.ready,this.z3j),this.rxa(x.a_h,this.g_b),this.rxa(x.Jff,this.g_b))}close(M){M===this.nX&&this.V1f&&this.mfb.send(new k.a(x.Nbk))||super.close(M)}cJf(){return this.kkf(this.CHc)}kkf(M){const G=this.$.ta,A=new Sys.StringBuilder(G.FormLightBoxUrl);m.a.ol(A,d.a.wEi,this.$.fa.sessionId);
m.a.ol(A,d.a.uEi,M?d.a.vEi:d.a.tEi);u.a.wGb(A,G);return A.toString()}Y8g(M){this.Ucd=!1;this.AYa.src=this.kkf(M);this.wD=M}rxa(M,G){this.mfb.nl(M);this.mfb.ik(M,G)}pOc(M){const G=this.$.fa.qa.getItemByName(M.xQ.SheetName);G&&0===G.HE&&w.f(this.$).lj(M.xQ,null,null,null,20,"FormDialog.OnItemInserted")}}E.jei=900;E.Edi=1200;E.Y1d="lightBoxReady";Object(y.a)(E,"FormDialog",r.a,[216])},337:function(y,r,a){a.r(r);var c={};a.r(c);a.d(c,"CreateNewCommandHandler",function(){return A});var b={};a.r(b);a.d(b,
"MsFormCommandHandler",function(){return oa});var f={};a.r(f);a.d(f,"NamedSheetViewPublic",function(){return Ma});var k={};a.r(k);a.d(k,"NamedSheetViewTeachingCallout",function(){return Ga});var x={};a.r(x);var d={};a.r(d);a.d(d,"OpenFromMruCommandHandler",function(){return pd});var h={};a.r(h);a.d(h,"SheetOptionsToggleCommandHandler",function(){return Hd});var n={};a.r(n);a.d(n,"SortFilterManager",function(){return cd});var m={};a.r(m);a.d(m,"TryOfficeThroughTellMeCommandHandler",function(){return Vd});
var u=a(133),l=a(0),t=a(6),e=a(209),w=a(26),z=a(67),E=a(5),M=a(65),G=a(29);let A=class{constructor(Ic){this.zh=Ic}gd(){return!1}executeCommand(Ic,bd,yb){Ic=2;switch(bd.command){case 1056925771:Ic=this.zh.pe(w.a.newDocument,2,yb);break;case w.a.Zqa:Ic=this.zh.pe(w.a.Zqa,2,yb);break;case w.a.S8:Ic=this.zh.pe(w.a.S8,2,yb)}return 2!==Ic?z.Task.Va(!0):e.a(bd.command)}Rc(Ic,bd){Ic=!1;switch(bd.command){case 1056925771:Ic=!0;break;case w.a.Zqa:case w.a.S8:Ic=G.a.E2()}return Ic}td(Ic,bd,yb){Ic=!0;switch(bd){case "PopulateNewMenu":this.zh&&
(t.AFrameworkApplication.ea.ka("IsO365ConsumerHost")&&(t.AFrameworkApplication.ea.appSettings.TemplateCollectionId="ExcelConsumerWAC",t.AFrameworkApplication.ea.appSettings.NumberOfTemplatesInBackstage="23"),this.zh.pe(G.a.E2()?w.a.Txg:w.a.Sqb,2,yb));break;default:Ic=!1}return Ic}};A=Object(u.__decorate)([Object(M.d)(E.CreateNewCommandHandlerService),Object(u.__param)(0,Object(E.ActionManagerService)()),Object(u.__param)(1,Object(E.CommonUIStringsService)()),Object(u.__param)(2,Object(E.NewAndOpenUXService)())],
A);Object(l.a)(A,"CreateNewCommandHandler",null,[29]);var N=a(32),K=a(83),I=a(100),L=a(213),J=a(43),B=a(12),Y=a(28),U=a(266),O=a(536);class C{}C.create="Create";C.activate="Activate";C.close="Close";C.remove="Delete";C.duplicate="Duplicate";Object(l.a)(C,"Actions",null,[]);var X=a(36),S=a(45);class ea extends z.Task{constructor(Ic){super();this.SCe=null;this.UCe=0;this.Nbc=null;this._state=0;this.moveNext=()=>{try{for(this._state=1;1===this._state;)this.O$a=this.O$a()}catch(bd){this.dispose(),this.vMa(bd),
this._state=3}};this.iy=Ic;this.O$a=this.T4c;this.moveNext()}T4c(){this.SCe=X.a.Cd(3,2,0,1667,0,-1244327602,"MsFormDeleteConfirmation");this.Nbc=S.a(this.iy.$).Wi(this.SCe).G();this.Nbc.isCompleted||(this._state=2,this.Nbc.hpb(this.moveNext));return this.Qbh}Qbh(){this.UCe=this.Nbc.DK();0===this.UCe&&(this.iy.$.workbookContext.Options=B.HelperMethods.OV(!1,this.iy.$.workbookContext.Options,2048),this.iy.deleteMsFormMetaDataSheet());this._state=3;this.i5a(!0)}dispose(){}}Object(l.a)(ea,"$$sm_Microsoft$Office$Excel$WebUI$Client$MsForm$MsFormCommandHandler$DeleteMsForm",
z.Task,[4]);class Oa{}Oa.action="Action";Oa.CCi="FlexPane";Oa.Xxc="formId";Oa.id="id";Oa.title="Title";Oa.Gac="XlWorkbookId";Oa.VEi="Fragment";Oa.host="Host";Oa.k3g="TopView";Oa.accountType="auth_pvr";Oa.zve="subpage";Object(l.a)(Oa,"Parameters",null,[]);var Ha=a(61);const Za=(Ic,bd,yb,Oc,kd,Rc,Xb)=>{Xb=Ic.$a(9,void 0===Xb?null:Xb);Xb.sheetName=bd;Xb.confirmationChoice=!0;return Ha.h(Ic,"DeleteSheet",Xb,yb,Oc,kd,Rc,0)};var fa=a(1),la=a(684),ba=a(81),aa=a(189);let oa=class{constructor(Ic){this.Zn=
"Excel";this.properties={};this.$=Ic;this.E1=O.a.current;this.I$b=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8570812_UseFormsDesignPageV2")}get hasMsForm(){return I.c(this.$.Pf)||this.I$b&&this.$.workbookContext.HasMsFormsExcelDataSync}get o1a(){return this.$.workbookContext.MsFormId}get Dac(){return this.$.workbookContext.MsFormDocUrl}get accountType(){return Y.a.contains(this.$.IA.DocumentHostInfo.FileSource,"onedrive",!0)?"MSA":"OrgId"}gd(Ic,bd){switch(bd){case -105284469:return!I.j(this.$.Pf)||
this.hasMsForm||fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8155542_MsFormsRibbonAndDisconnectionSupport")&&this.$.workbookContext.HasMsFormsExcelDataSync;case -1219864912:case 1674421386:case -1128532220:case 2023601781:return!this.hasMsForm}return!1}executeCommand(Ic,bd){Ic=J.TaskExtensions.kl();bd=bd.command;switch(bd){case -105284469:this.insertMsForm();break;case -1219864912:this.previewMsForm();break;case -1128532220:this.editMsForm();break;case 1674421386:this.sendMsForm();break;case 2023601781:Ic=
this.deleteMsForm();break;default:Ic=e.a(bd)}return Ic}Rc(Ic,bd){if(!this.$.fa.Kh.get(61))return!1;Ic=!1;switch(bd.command){case -105284469:Ic=I.j(this.$.Pf)&&!this.hasMsForm;break;case -1219864912:case 1674421386:case -1128532220:case 2023601781:Ic=this.hasMsForm}return Ic}td(){return!1}insertMsForm(){if(fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LaunchNewFormTaskPane",!1)){this.properties.mode="Create";this.properties.workbookUrl=this.$.workbookContext.ClientUrl||this.$.workbookContext.ReloadUrl;
this.properties.workbookFileName=this.$.workbookContext.WorkbookFileName;this.properties.contentLocale=this.$.ta.DataCultureTag;this.properties.correlationId=aa.a.create().toString();this.properties.serverDocId=this.$.ta.DocumentHostInfo.ServerDocId;this.properties.hostType=this.$.IA.DocumentHostInfo.FileSource;const Ic=new K.a(-105284469,1,this.$.xc,0,null);J.TaskExtensions.tb(ba.GetServiceTaskFactory.Ne(this.$.ra,374,375,1),bd=>{(bd=bd.result)&&bd.fCc(this.properties,Ic)},this.$.Aa,3)}else{const Ic=
N.a.nu(this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),bd={},yb={};bd[Oa.action]=C.create;bd[Oa.accountType]=this.accountType;yb[Oa.action]=C.create;yb[Oa.Gac]=encodeURIComponent(this.Dac);yb[Oa.host]=this.Zn;yb[Oa.title]=encodeURIComponent(Ic);this.tYb(bd,yb);this.$.workbookContext.Options=B.HelperMethods.OV(!1,this.$.workbookContext.Options,2048)}}editMsForm(){const Ic={},bd={};this.I$b&&this.$.workbookContext.HasMsFormsExcelDataSync?(bd[Oa.host]=this.Zn,bd[Oa.zve]="design",bd[Oa.id]=
this.o1a,bd[Oa.accountType]=this.accountType):(Ic[Oa.accountType]=this.accountType,bd[Oa.Xxc]=this.o1a,bd[Oa.Gac]=encodeURIComponent(this.Dac),bd[Oa.host]=this.Zn);this.tYb(Ic,bd)}previewMsForm(){const Ic={},bd={};this.I$b&&this.$.workbookContext.HasMsFormsExcelDataSync?(bd[Oa.host]=this.Zn,bd[Oa.zve]="design",bd[Oa.id]=this.o1a,bd[Oa.accountType]=this.accountType):(Ic[Oa.accountType]=this.accountType,bd[Oa.Xxc]=this.o1a,bd[Oa.Gac]=encodeURIComponent(this.Dac),bd[Oa.host]=this.Zn);bd[Oa.k3g]="Preview";
this.tYb(Ic,bd)}sendMsForm(){const Ic={},bd={};this.I$b&&this.$.workbookContext.HasMsFormsExcelDataSync?(bd[Oa.host]=this.Zn,bd[Oa.zve]="design",bd[Oa.id]=this.o1a,bd[Oa.accountType]=this.accountType,bd[Oa.k3g]="Send"):(Ic[Oa.accountType]=this.accountType,bd[Oa.Xxc]=this.o1a,bd[Oa.CCi]="SendForm",bd[Oa.Gac]=encodeURIComponent(this.Dac),bd[Oa.host]=this.Zn);this.tYb(Ic,bd)}deleteMsForm(){return new ea(this)}deleteMsFormMetaDataSheet(){this.$.userOperationManager.rK(new L.a(158,0,(Ic,bd,yb)=>Za(this.$.ma.ZY,
this.E1.sOb,U.c(Ic,()=>{this.Wei()}),bd,yb,null)))}Wei(){const Ic={},bd={};Ic[Oa.action]=C.remove;Ic[Oa.accountType]=this.accountType;bd[Oa.action]=C.remove;bd[Oa.host]=this.Zn;bd[Oa.Xxc]=encodeURIComponent(this.o1a);bd[Oa.Gac]=encodeURIComponent(this.Dac);this.tYb(Ic,bd)}tYb(Ic,bd){var yb=void 0===yb?!0:yb;if(this.I$b&&this.$.workbookContext.HasMsFormsExcelDataSync){yb=this.$.ta.MsFormBaseUrl+"/Pages/DesignPageV2.aspx";var Oc="";if(bd)for(var kd in bd){Ic=kd;var Rc=bd[kd];Oc+=Oc.length?"&":"?";Oc+=
Ic+"="+Rc}window.open(yb+Oc,"_blank")}else{kd=this.$.ta.MsFormBaseUrl+"/Pages/"+(yb?"DesignPage":"ResponsePage")+".aspx";let Vc=yb="";if(bd){for(Oc in bd){var Xb=Oc,dc=bd[Oc];Vc+=Vc.length?"&":"";Vc+=Xb+"="+dc}Ic||(Ic={});Ic[Oa.VEi]=encodeURIComponent(Vc)}if(Ic)for(Rc in Ic)bd=Rc,Oc=Ic[Rc],yb+=yb.length?"&":"?",yb+=bd+"="+Oc;window.open(kd+yb,"_blank")}}};oa=Object(u.__decorate)([Object(M.d)(E.MsFormCommandHandlerService),Object(u.__param)(0,Object(E.EwaControlService)()),Object(u.__param)(1,Object(la.b)())],
oa);Object(l.a)(oa,"MsFormCommandHandler",null,[29]);var Na=a(182),Ia=a(432),Sa=a(238),Pa=a(130);class za{static R1(){return Sa.a.qw(za.rq,Pa.a.La(444))}}za.rq="<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}</label> </div> </div> </div>";Object(l.a)(za,
"NamedSheetViewTeachingDialogHtml",null,[]);var wa=a(70),db=a(197),Ba=a(13),Ka=a(59),da=a(7);class sa extends Ia.a{constructor(Ic){super(Ic);this.stopwatch=this.Cx=null;this.IOj=bd=>{if(1===bd){var yb={[da.a.A6d]:!1};this.$.Ia.Gb(new K.a(-2050946363,wa.a.Hb,2,8,null),yb).continueWith(Oc=>{this.Cx.setResult(!db.a(Oc)&&Oc.result)});bd="Yes"}else yb=2===bd,this.Cx.setResult(yb),bd=2===bd?"No":"Close",yb&&this.ffk();this.eGj(bd);this.hide()}}get Tc(){return"ShowNamedSheetViewTeachingDialog"}ei(){this.hc=
4;this.stopwatch=this.$.Vb.Uc("UserAction",this.Tc);const Ic=Ba.a.instance.ia(1913);this.wj=za.R1();this.Cx=new Na.a;this.initializeAndShow(Ic,this.IOj,{});return this.Cx.task}HG(Ic){super.HG(Ic);this.Ic(1,Ba.a.instance.ia(1915));this.Ic(2,Ba.a.instance.La(457))}ffk(){this.$.fa.B6d=!1}eGj(Ic){const bd={};bd.a=this.$.ta.UserSessionId;bd.b="NamedSheetViewTeachingDialogClose";bd.c=Ic;bd.e=!0;this.stopwatch&&(this.stopwatch.stop(),bd.d=this.stopwatch.Kc);Ka.logData(53,bd,!0)}}Object(l.a)(sa,"NamedSheetViewTeachingDialog",
Ia.a,[]);var mb=a(149);let Ma=class{constructor(Ic){this.$=Ic;this.SXd=fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DisableSortFilterNSVEntryInSelfCoauthor",!1)}M5a(){return this.NSk()?(new sa(this.$)).ei():z.Task.Va(!0)}NSk(){const Ic=this.$.qa.la;return this.$.fa.W8&&this.$.fa.B6d&&!Ic.ue.Bq&&(this.SXd?this.$.fa.lVd()||!this.$.fa.WW&&this.$.fa.e6f():this.$.fa.aQ)&&!Object(mb.e)(this.$)&&!this.$.fa.$b.allowViewCollab}};Ma=Object(u.__decorate)([Object(M.d)(E.NamedSheetViewPublicService),
Object(u.__param)(0,Object(E.EwaControlService)())],Ma);Object(l.a)(Ma,"NamedSheetViewPublic",null,[464]);var hb=a(2),$a=a(1524),Va=a(1144),xa=a(539);class ia{constructor(Ic,bd,yb,Oc,kd,Rc,Xb){this.title=Ic;this.body=bd;this.wfk=yb;this.primaryButtonAction=Oc;this.secondaryButtonAction=Rc;this.rOg=kd;this.targetObject=Xb}}Object(l.a)(ia,"NamedSheetViewTeachingCalloutContent",null,[]);class Z{constructor(Ic){this.MZe=0;this.v1g=Ic}get t1g(){return this.MZe}get Ygk(){return this.t1g<this.v1g.length?
this.v1g[this.MZe++]:null}}Object(l.a)(Z,"NamedSheetViewTeachingCalloutList",null,[]);var ta=a(1321),pa;let Ga=pa=class{constructor(Ic){this.$=Ic;this.stopwatch=this.api=this.C0c=this.ywe=null;this.u1g=0}ugj(Ic){this.u1g=Ic;const bd=[];pa.qqj(Ic)?(bd.push(new ia(Ba.a.instance.La(446),Ba.a.instance.La(447),Ba.a.instance.ia(1943),()=>{this.Jda(2,"Continue");this.Xia(!0)},Ba.a.instance.ia(1944),()=>{this.Xia();this.Jda(1,"ExitGuide")},ta.a())),1===Ic&&bd.push(new ia(Ba.a.instance.ia(1945),Ba.a.instance.La(449),
Ba.a.instance.ia(1943),()=>{this.Jda(2,"FirstEnterTempViewContinueSecond");this.Xia(!0)},Ba.a.instance.ia(1944),()=>{this.Xia();this.Jda(1,"FirstEnterTempViewExitGuideSecond")},ta.a())),bd.push(new ia(Ba.a.instance.La(450),Ba.a.instance.La(451),Ba.a.instance.ia(1943),()=>{this.Jda(2,"FirstEnterExitCalloutContinue");this.Xia(!0)},Ba.a.instance.ia(1944),()=>{this.Xia();this.Jda(1,"FirstEnterExitCalloutGuide")},pa.ZVi())),bd.push(new ia(Ba.a.instance.ia(1946),Ba.a.instance.La(448),Ba.a.instance.ia(1947),
()=>{this.eWk();this.Xia();this.Jda(1,"LearnMore")},Ba.a.instance.ia(1948),()=>{this.Xia();this.Jda(1,"Done")},pa.YVi()))):2===Ic&&bd.push(new ia(Ba.a.instance.ia(1945),Ba.a.instance.La(449),Ba.a.instance.ia(1942),()=>{this.Xia();this.Jda(1,"EnterTempViewAfterPersistedView")},null,null,ta.a()));this.ywe=new Z(bd)}eWk(){const Ic=new K.a(-859308420,wa.a.Hb,this.$.xc,9,null);this.$.Ia.Gb(Ic,{[wa.a.Bf]:"HelpID=SheetViews",["InputMethod"]:wa.a.Hb,[wa.a.Wc]:da.a.VF,["ShouldCanvasTakeFocus"]:!0})}show(Ic){this.ugj(Ic);
this.showInternal()}oLk(Ic){this.api=Ic}showInternal(){var Ic=this.ywe.Ygk;if(Ic){var bd=Object(hb.a)(new $a.a,{label:Ic.wfk,onExecute:Ic.primaryButtonAction}),yb=null;Ic.rOg&&(yb=Object(hb.a)(new $a.a,{label:Ic.rOg,onExecute:Ic.secondaryButtonAction}));Ic=Object(hb.a)(new Va.a,{target:Ic.targetObject,content:Ic.body,title:Ic.title,showCloseIcon:!0,primaryButtonProps:bd,secondaryButtonProps:yb,useTeachingStyles:!0});Ic=this.api.callout(Ic);bd=Object(hb.a)(new xa.a,{onShow:()=>{this.Jda(0)}});this.C0c=
this.api.addNotification(Ic,bd)}}dismiss(){this.Xia();this.Jda(1,"DismissedByOthers")}Xia(Ic){Ic=void 0===Ic?!1:Ic;this.C0c&&(this.api.removeNotification(this.C0c),this.C0c=null);Ic&&this.showInternal()}Jda(Ic,bd){const yb={};yb.a=this.$.ta.UserSessionId;yb.b=this.u1g;yb.c=this.ywe.t1g;yb.d=Ic;yb.e=void 0===bd?null:bd;0===Ic?this.stopwatch=this.$.Vb.Uc("UserAction","ShowNamedSheetViewTeachingCallout"):(this.stopwatch&&(this.stopwatch.stop(),yb.f=this.stopwatch.Kc,this.stopwatch=null),2===Ic&&(this.stopwatch=
this.$.Vb.Uc("UserAction","ShowNamedSheetViewTeachingCalloutNext")));Ka.logData(52,yb,!0)}static YVi(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")}static ZVi(){return document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]")}static qqj(Ic){return 0===Ic||1===Ic}};Ga=pa=Object(u.__decorate)([Object(M.d)(E.NamedSheetViewTeachingCalloutService),Object(u.__param)(0,Object(E.EwaControlService)())],Ga);Object(l.a)(Ga,"NamedSheetViewTeachingCallout",null,[462]);
var Ca=a(19),kb=a(1162),eb=a(1318),Yb=a(1161),Gb=a(605),Mb=a(1319),Rb=a(15),$b=a(141),cc=a(1051),fb=a(158),Sb=a(24);class kc{static smi(Ic){return kc.Kaf("New",Ic)}static tmi(Ic){return kc.Kaf("Open",Ic)}static uaf(Ic,bd){return kc.bra("LoadingMenuSection",kc.TDj,Ic,kc.EHb("lblLoading",bd))}static FHb(Ic,bd,yb,Oc){return kc.bra("MessageMenuSection",kc.Xfg,bd,kc.EHb("lblMessage",Ic,void 0===yb?null:yb,void 0===Oc?null:Oc))}static VQh(Ic){return kc.uaf(Ic,Object(Sb.a)("VoicedLoadingText"))}static WQh(Ic,
bd){return kc.FHb(Object(Sb.a)("NewCreationLocationMessage"),Ic.Yi,bd.pR,bd.Jya)}static UQh(Ic,bd){return kc.FHb(String.format(Object(Sb.a)("NewProvisioningStorageMessage"),bd.Jya,"\n\n"),Ic.Yi)}static waf(Ic){return kc.FHb(Object(Sb.a)("NewGenericErrorMessage"),Ic.Yi)}static SQh(Ic,bd,yb){return kc.bra("menuNewBlank",kc.tbj,yb?Ic.Yi:null,kc.yHb(Ic.pTf,Ic.qTf,Ic.rTf,null,Ic.h2,Ic.iSb,bd,"blank"))}static SRh(){return kc.EHb("lblTemplatesLoading",Object(Sb.a)("VoicedLoadingText"))}static Iaf(){return kc.EHb("lblTemplatesError",
Object(Sb.a)("NewTemplateErrorMessage"))}static TRh(Ic,bd){return kc.bra("menuNewTemplates",Ic,null,bd)}static QQh(Ic,bd){return kc.bra("menuNewMoreTemplates",kc.jDf,null,kc.yHb("menuNewMoreTemplatesButton",Object(Sb.a)("NewMoreTemplates"),Object(Sb.a)("NewMoreTemplates"),null,null,null,Ic,bd))}static TPh(Ic,bd,yb){let Oc="";yb&&bd&&(Oc=kc.bra("BrowseMoreMenuSection",kc.jDf,null,kc.yHb("btnBrowseMore",bd,bd,null,null,null,Ic||"1959943459",yb)));return Oc}static EHb(Ic,bd,yb,Oc){yb=void 0===yb?null:
yb;let kd=Oc=void 0===Oc?null:Oc;bd&&0<bd.length&&(kd=kc.chg.LQc(bd).trimEnd(),kd=0<=kd.indexOf("{0}")?String.format(kd,Oc):String.format("{0} {1}",kd,Oc));yb=yb&&Oc?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',N.a.Ig(yb),N.a.Ig(Oc),N.a.Ig(kd)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',N.a.Ig(Ic||""),kc.chg.LQc(N.a.Ig(bd||"")),yb)}static yHb(Ic,bd,yb,Oc,kd,Rc,
Xb,dc){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',N.a.Ig(Ic||""),N.a.Ig(bd||""),N.a.Ig(yb||""),Oc||"32by32",N.a.Ig(kd||""),N.a.Ig(Rc||""),Xb,N.a.Ig(dc||""))}static Kaf(Ic,bd){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',Ic,bd)}static bra(Ic,bd,yb,Oc){yb=yb?String.format('Title="{0}"',
N.a.Ig(yb)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',N.a.Ig(Ic||""),N.a.Ig(bd||""),yb,Oc)}}kc.Xfg="MenuMru";kc.TDj="MenuLoading";kc.tbj="MenuHeader";kc.jDf="MenuFooter";kc.chg=fb.a.fC("\n","&#10;");Object(l.a)(kc,"NewAndOpenXmlUtilities",null,[]);var na=a(103),fc=a(98),Cc=a(104),tc=a(48);class nb{constructor(){this.folderName=
this.folderUrl=this.hostName=this.hostUrl=null}}Object(l.a)(nb,"HostInformation",null,[]);var tb=a(125),La=a(55),wb=a(136),Wa=a(793),Fa=a(687),Da=a(135),ja=a(672),Qa=a(200),Ob=a(366),Ub=a(256),Zb=a(298),uc=a(39),Hc=a(311),Dd=a(493),jc=a(437),$c=a(285),ud=a(991),Ud=a(239);const ec={p1c:"CreateNewDocument_FileMenu",featureName:"New",Fia:"wwbootperf",nxb:Qa.a[Qa.a.Boot],Dcb:Qa.a[Qa.a.Boot],oqf:!1};class Db{get YY(){this.HBa||(this.HBa=Object(Ca.f)(Mb.a));return this.HBa}constructor(Ic,bd,yb,Oc,kd,Rc){this.dEb=
this.lq=this.ecc=null;this.Fic=this.Njd=!1;this.ASe=0;this.jdd=!1;this.cfe=()=>32;this.Zqa=(Xb,dc,Vc,yd,Pd)=>{if(1===Vc)return 32;Pd.MenuItemId=this.CVi();return this.xt.jwa.pe(w.a.openUrlInNewTab,Vc,Pd,yd)};this.uPj=Xb=>{if(Xb&&Xb.data&&Xb.data.responseData){var dc;let Vc=tc.d(Xb.data.responseData);({Ws:dc}=Vc);Vc.returnValue?(Xb=dc,Xb.NewDocumentUrl?(Rb.ULS.sendTraceTag(507565458,202,50,"Got NewDocumentUrl with server StatusCode: {0}",Xb.StatusCode),La.a.Rg(Xb.NewDocumentUrl,"_blank",void 0,"CreateNewDocument"+
(Xb.StatusCode!==Ud.a.nA&&Xb.StatusCode!==Ud.a.FUa?"ErrorRedirect":""))):(Rb.ULS.sendTraceTag(507565459,202,10,"NewDocumentUrl not available"),this.QSc())):(Rb.ULS.sendTraceTag(507565461,202,10,"Failed to deserialize: {0}",{["ResponseData"]:ud.a.k7a(Xb.data.responseData)}),this.QSc())}else Rb.ULS.sendTraceTag(507565462,202,10,"Response data not available"),this.QSc()};this.tPj=Xb=>{Xb&&Xb.data&&Rb.ULS.sendTraceTag(507565457,202,10,"Request failed with status: {0}",Xb.data.status);this.QSc()};this.qck=
(Xb,dc,Vc,yd,Pd)=>{if(1===Vc)return 32;this.xt.supportsGetMoreInfoForPersonalStorage&&!this.lq&&this.dhg.DK("Opened New menu",!0);Pd.MenuItems=Object.assign(new Dd.a,{Id:"NewSection",MenuSectionList:[],UpdateDynamically:!0});Xb=this.E7h();Pd.MenuItems.MenuSectionList.push(Xb);return 32};this.Sqb=(Xb,dc,Vc,yd,Pd)=>{if(1===Vc)return 32;2!==Vc||this.jdd||(this.ASe=(new Date).getTime(),this.ffc&&this.Idc.J8({Po:"CreateNewDocument_FileMenuRender",Umb:Ob.b.FailureBased}),Rb.ULS.sendTraceTag(5849602,202,
50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.XYc,["CachedNewMenuXmlExists"]:!!this.ecc,["ShouldCallGetMoreInfo"]:this.xt.supportsGetMoreInfoForPersonalStorage}));return this.aph&&Zb.a.instance.tI(t.AFrameworkApplication.accessTokenTtl)?(Rb.ULS.sendTraceTag(507863243,202,15,"CreateNewActor: session is expired"),this.Utc(),32):this.Dck(Pd)};this.laa=Ic;this.hAb=bd;this.GPa=new Gb.a(()=>new cc.a(yb.value,Object($b.a)(this,this.dQb,"getMoreInfoEventReceived")));this.Vqh=
Oc;this.FBa=kd;this.muh=Rc;this.EDb=this.XYc;this.ofc=!!t.AFrameworkApplication.ea&&t.AFrameworkApplication.ea.ka("GateTemplateRenderingByGetMoreInfoResponse");this.aph=3===this.xt.qE&&!!t.AFrameworkApplication.ea&&t.AFrameworkApplication.ea.ka("CreateNewButtonGrayOutForExpiredSessionEnabled");this.ffc=3===this.xt.qE&&!!t.AFrameworkApplication.ea&&t.AFrameworkApplication.ea.ka("NewKpiForCreateNewActor");this.Idc=ja.a.getInstance(ec)}get BP(){switch(this.xt.qE){case 3:return"WordWAC";case 1:return"ExcelWAC";
case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}wi(){var Ic,bd;const yb=this.xt.jwa;yb.jc(w.a.cfe,Da.a.frame,this.cfe);yb.jc(w.a.newDocument,Da.a.frame,Object($b.a)(this,this.newDocument,"newDocument"));yb.jc(w.a.Sqb,Da.a.frame,this.Sqb);if(null===(Ic=t.AFrameworkApplication.ea)||void 0===Ic?0:Ic.ka("FileMenuTemplateErrorFixIsEnabled"))null===(bd=Hc.AFrameworkApplication_ActionManager.Kb)||void 0===bd?void 0:bd.O$i(w.a.Sqb);yb.jc(w.a.Txg,Da.a.frame,this.qck);yb.jc(w.a.Zqa,Da.a.frame,
this.Zqa)}newDocument(Ic,bd,yb,Oc,kd){var Rc;if(1===yb)return(null===(Rc=t.AFrameworkApplication.ea)||void 0===Rc?0:Rc.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FileMenuRedesignIsEnabled",!1))&&!this.KYd()?2:32;if(2===yb&&kd){this.ffc&&this.Idc.J8({Po:"CreateNewDocument_FileMenuExec",Umb:Ob.b.FailureBased});if(t.AFrameworkApplication.ea.ka("BackstagePremiumTemplateExperienceEnabled")&&kd.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),t.AFrameworkApplication.ea.ka("PassActionDataForPremiumTemplateExperience")?
t.AFrameworkApplication.Kb.pe(w.a.Qyg,2,kd):t.AFrameworkApplication.Kb.hf(w.a.Qyg,2);if(kd.MenuItemId&&kd.SourceControlId)return"NewDocumentHome"===kd.SourceControlId&&fc.a("NewDocumentFromHomeTab"),this.dfb(kd.MenuItemId,kd.SourceControlId)}return 8}CVi(){switch(this.xt.qE){case 3:return"https://www.office.com/template/Word";case 1:return"https://www.office.com/template/Excel";case 2:return"https://www.office.com/template/PowerPoint"}return null}QMd(){switch(this.xt.qE){case 3:return Object(Sb.a)("BlankDocumentLabel");
case 1:return Object(Sb.a)("BlankWorkbookLabel");case 2:return Object(Sb.a)("BlankPresentationLabel")}return""}cWi(){switch(this.xt.qE){case 3:return"DocumentAddColorFluent_20";case 1:return"TableAddColorFluent_20";case 2:return"SlideAddColorFluent_20"}return""}dfb(Ic,bd){var yb=this.AMc.jzd;if(null===yb)return this.OXb("RelativePathIsNull",!0),8;var Oc=t.AFrameworkApplication.ea.ka("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC"),kd=t.AFrameworkApplication.TQ;"blank"===Ic&&this.Htj()&&(Rb.ULS.sendTraceTag(508687196,
202,50,"Updating blank document id with new template id for appId={0}",this.BP),Ic="blankNew");if(kd&&Oc){Rb.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const Rc={};Rc.template=Ic;Rc.appID=this.BP;Rc.lcid=t.AFrameworkApplication.lcid.toString();Rc.reason=Wa.a.createNew;Rc.uiCulture=t.AFrameworkApplication.uiCulture;Rc.dataCulture=t.AFrameworkApplication.dataCulture;t.AFrameworkApplication.Jz().execute(Xb=>{Xb.sendMessage(wb.a.dfb,Rc)})}else Oc=
(new Date).getTime(),bd=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",yb,N.a.Jf(this.kB),N.a.Jf(Ic),N.a.Jf(this.BP),N.a.Jf(t.AFrameworkApplication.lcid.toString()),N.a.Jf(Oc.toString()),N.a.Jf(bd),N.a.Jf(t.AFrameworkApplication.IP),t.AFrameworkApplication.Uh),(yb=t.AFrameworkApplication.ea.Qa("ScenarioId"))&&""!==yb&&(bd+="&wdscenarioid="+N.a.Jf(yb)),bd+="&"+t.AFrameworkApplication.dBc(),yb=this.lq?this.lq.pR:null,this.YY&&
this.YY.Xxb&&(yb=this.YY.PersonalFileStorageUrl),yb?bd+="&DestinationUrl="+N.a.Jf(yb):3===this.xt.qE&&this.xt.supportsGetMoreInfoForPersonalStorage&&(this.OXb("GetMoreInfoOrPersonalFileStorageUrlIsEmpty",!0),Rb.ULS.sendTraceTag(508928088,202,10,"CreateNewDocument: getMorInfoResult is null or PersonalFileStorageUrl is empty")),"SharePoint"===this.kB||"SharePointOnlineConsumer"===this.kB?Ub.a.tt("6f63j813;9a66f561"):"OneDriveWopi"===this.kB&&Ub.a.tt("b8jd0489;3228j491"),(Oc=uc.a.AY||uc.a.yY||uc.a.XIc)&&
Rb.ULS.sendTraceTag(507569058,202,15,"CreateNewDocument: Opening window via form POST is blocked, isMobileBrowser: {0}, isElectron: {1}, isWebview2: {2}",uc.a.AY,uc.a.yY,uc.a.XIc),yb=t.AFrameworkApplication.od.kW,kd=!!yb,("SharePoint"===this.kB||"SharePointOnlineConsumer"===this.kB?t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseGraphFileUploaderForCreateNew",!1):"OneDriveWopi"===this.kB&&t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseGraphFileUploaderForOneDriveConsumerCreateNew",
!1))&&kd?Oc?this.xt.Job.Wn(bd,2,null,{"X-UseGraphFileUploader":"1","X-DoNotRedirect":"1"},!1,2,this.uPj,this.tPj,null):(Oc={ugfu:"1"},Oc.wacAadToken=yb,La.a.v1b("_blank",bd,Oc)):La.a.Rg(bd,"_blank",void 0,"CreateNewDocument");2!==this.xt.qE&&3!==this.xt.qE||Rb.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:Fa.a[this.xt.qE],["Template"]:Ic});t.AFrameworkApplication.ea&&t.AFrameworkApplication.ea.isChangeGateEnabled("Microsoft.Office.Excel.ChangeGate.ConsumerTemplateTelemetry")&&
1===this.xt.qE&&("blank"===Ic||"blankNew"===Ic?fc.b("ConsumerTemplateNewBlank"):fc.b("ConsumerTemplateNew",null,0,!0,0,[{name:"TemplateId",string:Ic}]));this.rag(!0);return 32}Htj(){let Ic=!1;switch(this.xt.qE){case 3:Ic=t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefaultsUpdate",!1);break;case 2:Ic=!0;break;case 1:Ic=t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.Excel.NewDefaultTemplate",!1)}return Ic}QSc(){this.BP||Rb.ULS.sendTraceTag(507565456,
202,10,"CreateNewDocument app ID not available");const Ic="https://office.live.com/start/"+(this.BP?this.BP.replace("WAC",".aspx"):"")+"?ec=1&auth=0&originalauth="+("SharePoint"===this.kB?"2":"1")+"&wdPreviousSession="+t.AFrameworkApplication.userSessionId;La.a.Rg(Ic,"_blank",void 0,"CreateNewDocumentErrorRedirect")}xHj(Ic){let bd=Number.MAX_VALUE,yb=Number.MIN_VALUE;const Oc=window.performance;if(Oc&&"undefined"!==typeof Oc.getEntriesByName){for(let Rc=0;Rc<Ic.length;Rc++){var kd=Oc.getEntriesByName(Ic[Rc]);
kd&&0<kd.length&&(kd=kd[0],bd=Math.min(parseInt(String(kd.fetchStart)),bd),yb=Math.max(parseInt(String(kd.responseEnd)),yb))}yb>bd&&Rb.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:yb-bd,["MinFetchStart"]:bd,["MaxResponseEnd"]:yb})}}E7h(){const Ic=Object.assign(new jc.a,{Title:"",Id:"FileMenuNewSection",DisplayMode:"Menu",ShowMenuSectionSeparator:!0,ControlList:[]});Ic.ControlList.push(Object.assign(new $c.a,{ExternalId:"btnBlankDocument",Command:w.a.newDocument.toString(),
CommandValueId:w.a.newDocument.toString(),LabelText:this.QMd(),Alt:this.QMd(),AriaDescription:this.QMd(),ExternalImageId:this.cWi(),MenuItemId:"blank",KeyTip:Object(Sb.a)("BlankDocumentKeytip")}));Ic.ControlList.push(Object.assign(new $c.a,{ExternalId:"btnBrowseTemplates",Command:w.a.Zqa.toString(),CommandValueId:w.a.Zqa.toString(),LabelText:Object(Sb.a)("BrowseTemplatesLabel"),Alt:Object(Sb.a)("BrowseTemplatesLabel"),AriaDescription:Object(Sb.a)("BrowseTemplatesLabel"),ExternalImageId:"TemplateBrowseColorFluent_20",
KeyTip:Object(Sb.a)("BrowseTemplatesKeytip")}));return Ic}Dck(Ic){Ic&&(this.ecc?Ic.PopulationXML=this.ecc:(this.xt.supportsGetMoreInfoForPersonalStorage&&!this.lq&&this.dhg.DK("Opened New menu",!0),Ic.PopulationXML=this.pIi(this.O2i())));return 32}KYd(){return!this.xt.supportsGetMoreInfoForPersonalStorage||!!this.lq&&3===this.lq.state&&!!this.lq.Jya&&!!this.lq.pR||this.YY&&this.YY.Xxb&&!!this.YY.PersonalFileStorageUrl}LYd(){return t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Ab.s8&&!this.ofc?
!0:this.KYd()}O2i(){if(!this.XYc&&!this.ofc&&!this.LYd())return null;if(this.EDb&&!this.Fic){let bd=!1;var Ic="9";const yb=t.AFrameworkApplication.ea.appSettings;"NumberOfTemplatesInBackstage"in yb&&(Ic=yb.NumberOfTemplatesInBackstage);let Oc=this.BP;"TemplateCollectionId"in yb&&(Oc=yb.TemplateCollectionId);"PowerPointWAC"===Oc&&(bd=!0);Ic=String.format(this.xt.fR+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",N.a.Jf(t.AFrameworkApplication.lcid.toString()),N.a.Jf(Oc),Ic);Boolean.parse(yb.AppendOriginQueryParam||
"false")&&(Ic+="&org=backstage");Boolean.parse(yb.BackstagePremiumTemplateExperienceEnabled||"false")&&"TemplateTier"in yb&&(Ic+="&templateTier="+yb.TemplateTier);Ic=bd?Ic+"&p=1":Ic+"&p=0";Ic+="&"+t.AFrameworkApplication.dBc();this.xt.Job.Wn(Ic,1,null,null,!1,2,kd=>{this.xt.bla("CreateNewActor.GetTemplateListJson",kd.data);this.D3k(kd.data.responseData)},kd=>{this.xt.bla("CreateNewActor.GetTemplateListJson",kd.data);this.C3k()},null,void 0,void 0,void 0,void 0,"5");this.EDb=!1}return this.dEb}D3k(Ic){this.dEb=
Ic;this.EDb=!1;this.G2b();this.ofc?this.LYd()?this.eCd():this.lq&&(Rb.ULS.sendTraceTag(508867410,202,10,"GetMoreInfo Received but info is missing"),this.OXb("GetMoreInfoReceivedButInfoIsMissing",!1),this.Utc()):this.eCd()}eCd(){if(t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Ab.s8&&Cc.c()){const Ic=t.AFrameworkApplication.ea.ka("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC"),bd=t.AFrameworkApplication.TQ;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.dEb,!0,
Ic&&bd));this.rag(!1);3===this.xt.qE&&Rb.ULS.sendTraceTag(508867409,202,15,"DispatchSuccessTemplateListJson")}}C3k(){this.Fic=this.EDb=!0;this.G2b();this.OXb("TemplateServiceFailed",!1);this.Utc();na.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}Utc(){t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Ab.s8&&Cc.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1)),3===this.xt.qE&&Rb.ULS.sendTraceTag(508867408,
202,15,"DispatchFailureTemplateListJson"))}rag(Ic){this.ffc&&this.Idc.ala({Po:Ic?"CreateNewDocument_FileMenuExec":"CreateNewDocument_FileMenuRender"})}OXb(Ic,bd){this.ffc&&this.Idc.Hda({Po:bd?"CreateNewDocument_FileMenuExec":"CreateNewDocument_FileMenuRender",errorName:Ic})}b3i(Ic){var bd=0;for(var yb=0;yb<Ic.length;yb++)if("ST"===Ic[yb].ImageType){bd=yb;break}const Oc=Ic.length?Ic[bd]:null;Ic=Oc?Oc.Url||"":"";var kd;let Rc=yb=bd=!1;if(Oc&&(kd=Oc.AspectRatio))kd=parseFloat(kd),1>kd?bd=!0:1.5<kd?yb=
!0:1===kd&&(Rc=!0);else switch(Rb.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:Ic}),this.xt.qE){case 3:bd=!0;break;case 2:yb=!0;break;case 5:Rc=!0}return{returnValue:Ic,aej:bd?"95by123":yb?"123by69":Rc?"100by100":"123by95"}}pIi(Ic){let bd;const yb=this.AMc.mTa||"1056925771",Oc=(()=>{let kd=this.TQh(Ic,this.AMc,yb);({zYc:bd}=kd);return kd})().returnValue;if(bd){this.ecc=Oc;const kd=(new Date).getTime()-this.ASe;Rb.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",
{["ElapsedMsSinceMenuOpened"]:kd})}return Oc}dQb(Ic,bd){Rb.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.lq||3!==Ic.state?2===Ic.state&&(Rb.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.Njd=!0,this.G2b()):(this.lq=Ic,bd||this.G2b(),t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Ab.s8&&Cc.c()&&Cc.d("setFileMenuHostInformation")&&(Ic=Object.assign(new nb,{hostUrl:this.lq.pR,hostName:this.lq.Jya,folderUrl:t.AFrameworkApplication.breadcrumbFolderUrl,
folderName:t.AFrameworkApplication.breadcrumbFolderName}),this.YY&&this.YY.Xxb&&(Ic.hostUrl=this.YY.PersonalFileStorageUrl),Rb.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(Ic)),this.ofc&&this.dEb&&this.dEb.length&&(this.LYd()?this.eCd():(this.OXb("PersonalFileStorageInfoIsMissing",!1),this.Utc()),Rb.ULS.sendTraceTag(508867407,202,15,"Dispatched on GetMoreInfoReceived"))))}TQh(Ic,bd,yb){let Oc;Oc=!1;const kd=
this.KYd();let Rc="";this.xt.supportsGetMoreInfoForPersonalStorage&&(this.Njd?(Rc=kc.waf(bd),this.Njd=!1,Rb.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.lq?kd?Rc=kc.WQh(bd,this.lq):this.lq.skj?(Oc=!0,this.EDb=!1,Rc=kc.UQh(bd,this.lq),Rb.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(Oc=!0,Rc=kc.waf(bd),Rb.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",
{["PersonalFileStorageUrlIsSet"]:!!this.lq.pR,["StorageServiceDisplayNameIsSet"]:!!this.lq.Jya})):(Rc=kc.VQh(bd.Yi),Rb.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));kd&&(Rc+=kc.SQh(bd,yb,!Rc)+(()=>{let Xb=this.RRh(Ic,yb);({zYc:Oc}=Xb);return Xb})().returnValue);return{returnValue:kc.smi(Rc),zYc:Oc}}RRh(Ic,bd){let yb;yb=!1;if(!this.XYc)return yb=!0,Rb.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",zYc:yb};let Oc=
"",kd="",Rc="MenuTemplate";if(this.Fic)Oc=kc.Iaf(),this.Fic=!1,Rb.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(Ic){try{const Xb=Sys.Serialization.JavaScriptSerializer.deserialize(Ic,!0);Oc=this.QRh(Xb,bd);Rb.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");t.AFrameworkApplication.ehg&&"OneDrive"===this.kB&&(kd=kc.QQh(this.zPj,t.AFrameworkApplication.ehg))}catch(Xb){Rb.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",
{["JsonToConvert"]:Ic}),Oc=kc.Iaf()}yb=!0}else Rc="MenuLoading",Oc=kc.SRh(),Rb.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:kc.TRh(Rc,Oc)+kd,zYc:yb}}QRh(Ic,bd){let yb="";const Oc=[];for(let Rc=0;Rc<Ic.length;Rc++){var kd=Ic[Rc];let Xb="";if(kd){const dc=kd.Title,Vc=kd.AssetId;kd=kd.Thumbnails;Vc&&dc&&kd&&({aej:kd,returnValue:Xb}=this.b3i(kd),yb+=kc.yHb("jbtnNewTemplate"+Rc,dc,null,kd,null,Xb,bd,Vc))}Oc[Rc]=Xb}Ic=new tb.a(4,1,5E3,()=>{this.xHj(Oc)},
106);this.xt.xMc.Ag(Ic);return yb}G2b(){this.jdd=!0;this.xt.Xgg.Kv(this.AMc.hOb);this.jdd=!1}get xt(){return this.laa.value}get AMc(){return this.hAb.value}get dhg(){return this.GPa.value}get zPj(){return this.Vqh.value}get kB(){let Ic=this.YY&&this.YY.Xxb?this.YY.NewDocumentDestinationHost:this.FBa.value;"SharePoint"===Ic&&t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseGraphFileUploaderForCreateNew",!1)&&t.AFrameworkApplication.ea.ka("IsO365ConsumerHost")&&(Ic=
"SharePointOnlineConsumer");return Ic}get XYc(){return this.muh.value}}Object(l.a)(Db,"CreateNewActor",null,[]);var ic=a(1521);class Pc extends ic.a{constructor(){super()}s3e(){this.g0(0,Object(Sb.a)("OpenMenuEmptyMruMessage"));this.g0(1,Object(Sb.a)("OpenMenuServerErrorMessage"));this.g0(2,Object(Sb.a)("Open"));this.g0(3,Object(Sb.a)("OpenMenuRecentDocuments"));this.g0(4,Object(Sb.a)("OpenMenuMoreOnHost"));this.g0(5,Object(Sb.a)("VoicedLoadingText"))}static get instance(){return Pc.Wa||(Pc.Wa=new Pc)}static x8j(Ic){return Pc.instance.ia(Ic)}}
Pc.Wa=null;Object(l.a)(Pc,"MruActorIntlHelper",ic.a,[]);var Ed;(function(Ic){Ic[Ic.success=0]="success";Ic[Ic.failure=1]="failure";Ic[Ic.spinner=2]="spinner";Ic[Ic.none=3]="none"})(Ed||(Ed={}));Object(l.b)("DisplayState",Ed);var de=a(1445);class se{constructor(Ic,bd,yb,Oc,kd,Rc,Xb,dc){this.f8c=null;this.Old=!0;this.dcc="";this.Yvh=0;this.u$a=null;this.ced=3;this.ogc=new Map;this.$cd=null;this.abh="SaveAsWordDocx_32";this.Adk="SaveAsPowerPointPptx_32";this.Dxi="SaveAsExcelXlsx_32";this.Fjl="LayerDiagonalColorFluent_20";
this.tgl="DesktopArrowUpColorFluent_20";this.Yfg="MruNoDataSection";this.hNj="MruSection";this.fA="SourceControlId";this.menuItemId="MenuItemId";this.Wfg="Mru";this.KBe=(Vc,yd,Pd,re,ue)=>{this.dBa||(Vc=this.Hsd,yd=this.Gsd,Vc&&yd||!this.wv.supportsGetMoreInfoForPersonalStorage||(yd=this.Rib.DK("File Open",!1),3===yd.state&&(Vc=yd.pR)),this.dBa=Vc);if(1===Pd)return this.dBa?32:8;if(!this.dBa)return 8;ue[this.menuItemId]=this.dBa;return this.wv.jwa.pe(w.a.openUrlInNewTab,Pd,ue,re)};this.c8j=(Vc,yd,
Pd,re,ue)=>{if(1==Pd)return 32;if(!ue[this.fA]||!this.ogc.has(ue[this.fA]))return Rb.ULS.sendTraceTag(507605730,324,15,"Unable to get the url for the document"),2;ue[this.menuItemId]=this.ogc.get(ue[this.fA])[1];ue[this.fA]="";return this.wv.jwa.pe(w.a.uKa,Pd,ue,re)};this.hRc=(Vc,yd,Pd,re,ue)=>{if(!this.o_a)return 2;if(1===Pd)return 32;ue.MenuItems=Object.assign(new Dd.a,{Id:"MruList",MenuSectionList:[],UpdateDynamically:!0});return this.yck(ue,de.a.instance.VSe)};this.iRc=(Vc,yd,Pd,re,ue)=>1!==Pd&&
ue?this.zck(ue):32;this.ya=dc;this.laa=Ic;this.PB=bd;this.Kmh=yb;this.Njh=Oc;this.Mjh=kd;this.GPa=new Gb.a(()=>new cc.a(Rc.value,null));this.ynh=new Gb.a(()=>new cc.a(Xb.value,Object($b.a)(this,this.gNj,"mruEventResultReceived")));this.ya.ka("WacInTabOpenMRUIsEnabledForUiHost");this.ya.ka("UiHostSupportsDocRebootFeatures")}gNj(Ic,bd){this.u$a=Ic;bd||this.pEg()}Sok(){const Ic=this.wv.jwa;Ic.ef(w.a.iRc,Da.a.frame,this.iRc,96);Ic.jc(w.a.tKa,Da.a.frame,this.c8j);Ic.jc(w.a.hRc,Da.a.frame,this.hRc);Ic.jc(w.a.KBe,
Da.a.frame,this.KBe)}yck(Ic,bd){(bd=this.h9h(bd))?(Rb.ULS.sendTraceTag(507605729,324,50,"Mru flyout data loaded successfully in file menu"),Ic.MenuItems.MenuSectionList.push(bd)):this.ock(Ic);bd=this.xbi();Ic.MenuItems.MenuSectionList.push(bd);return 32}h9h(Ic){if(Ic){var bd=this.Oyd(this.hNj,!0);Ic=JSON.parse(Ic);this.ogc.clear();Ic.forEach((yb,Oc)=>{this.ogc.set(this.Wfg+Oc.toString(),[yb.FileName,yb.DocumentUrl]);const kd=this.LVi(yb.FileName);bd.ControlList.push(Object.assign(new $c.a,{ExternalId:this.Wfg+
Oc.toString(),Command:w.a.tKa.toString(),CommandValueId:w.a.tKa.toString(),LabelText:kd,Alt:yb.FileName,AriaDescription:yb.FileName,ExternalImageId:this.USi(this.wv.qE)}))});return bd}}xbi(){const Ic=this.Oyd("ViewAllFilesAndUploadSection",!1);if(!this.dBa){let yb=this.Hsd;var bd=this.Gsd;yb&&bd||!this.wv.supportsGetMoreInfoForPersonalStorage||(bd=this.Rib.DK("File Open",!1),3===bd.state&&(yb=bd.pR));this.dBa=yb}this.dBa&&Ic.ControlList.push(Object.assign(new $c.a,{ExternalId:"btnViewMoreFiles",Command:w.a.openUrlInNewTab.toString(),
CommandValueId:w.a.openUrlInNewTab.toString(),LabelText:Object(Sb.a)("ViewMoreFilesLabel"),Alt:Object(Sb.a)("ViewMoreFilesLabel"),AriaDescription:Object(Sb.a)("ViewMoreFilesLabel"),ExternalImageId:this.Fjl,MenuItemId:this.dBa,KeyTip:Object(Sb.a)("ViewMoreFilesKeytip")}));Ic.ControlList.push(Object.assign(new $c.a,{ExternalId:"btnUploadDocument",Command:w.a.E$b.toString(),CommandValueId:w.a.E$b.toString(),LabelText:Object(Sb.a)("UploadFilesLabel"),Alt:Object(Sb.a)("UploadFilesLabel"),AriaDescription:Object(Sb.a)("UploadFilesLabel"),
ExternalImageId:this.tgl,KeyTip:Object(Sb.a)("UploadFilesKeytip")}));return Ic}Oyd(Ic,bd){bd=void 0===bd?!1:bd;return Object.assign(new jc.a,{Title:bd?Object(Sb.a)("MruTitle"):"",Id:Ic,DisplayMode:"Menu",ShowMenuSectionSeparator:!0,ControlsId:"Ctrl_"+Ic,ControlList:[]})}ock(Ic){Rb.ULS.sendTraceTag(507605728,324,50,"Mru data could not load in file menu flyout");Ic.MenuItems.MenuSectionList.push(this.i9h())}i9h(){const Ic=this.Oyd(this.Yfg,!1);Ic.ControlList.push(Object.assign(new $c.a,{ExternalId:this.Yfg,
LabelText:Object(Sb.a)("MruNoDataLabel")}));return Ic}LVi(Ic){return Ic&&Ic.length<=se.XSe?Ic:Ic.substring(0,se.XSe-3)+"..."}USi(Ic){let bd=this.abh;switch(Ic){case 3:bd=this.abh;break;case 2:bd=this.Adk;break;case 1:bd=this.Dxi}return bd}zck(Ic){this.kni();this.jni();Ic.PopulationXML=kc.tmi(this.dcc+this.f8c);return 32}kni(){let Ic=3,bd=!1;if(this.dcc&&this.Yvh===this.u$a.r5k)Rb.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),
Ic=this.ced;else{Rb.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var yb=this.wv.ZA();this.u$a=this.fNj.DK("File Open opened",!0);if(this.dcc&&2!==this.ced&&3!==this.u$a.state)bd=!0;else{const Oc=this.x0i(this.u$a);t.AFrameworkApplication.ua&&t.AFrameworkApplication.ua.Ab.s8&&Cc.c()&&Oc&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(Oc,!0));this.dcc=(()=>{let kd=this.qIi(this.u$a);({pPj:Ic}=kd);return kd})().returnValue}yb=
this.wv.ZA()-yb;Rb.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:yb})}2!==Ic&&(yb={["DisplayState"]:Ed[Ic]},1!==Ic&&(yb.IsStale=bd),Rb.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",yb));this.ced=Ic}x0i(Ic){let bd;try{bd=tc.c(Ic.o6d)}catch(yb){bd=null,Rb.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",yb)}return bd}jni(){this.Old?(Rb.ULS.sendTraceTag(5849632,
202,50,"Open menu Browse More Link creation necessary."),this.f8c=(()=>{let Ic=this.XIj();({ikl:this.Old}=Ic);return Ic})().returnValue):Rb.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");Rb.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.Old,["NotDisplayingLink"]:!this.f8c})}qIi(Ic){let bd;1===Ic.state||0===Ic.state?(Rb.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),Ic=2,bd=kc.uaf(this.Tta(2),
this.Tta(5))):3===Ic.state&&Ic.o6d?(bd=this.RQh(Ic.o6d),Ic=0):(Rb.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),bd=kc.FHb(this.Tta(1),this.Tta(2)),Ic=1);return{returnValue:bd,pPj:Ic}}RQh(Ic){let bd;const yb=this.JYb.mTa||"2155708348";if(Ic.length){bd=kc.EHb("lblRecentDocuments",this.Tta(3));let Oc=0;for(let kd=0;kd<Ic.length;kd++){const Rc=Ic[kd];"FileName"in Rc&&"DocumentUrl"in Rc&&"Path"in Rc&&(bd+=kc.yHb("MruButton"+kd,Rc.FileName.toString(),Rc.Path.toString(),
null,this.JYb.h2,this.JYb.iSb,yb,Rc.DocumentUrl.toString()),Rc.IsPinned&&Oc++)}bd=kc.bra("RecentDocumentsMenuSection",kc.Xfg,this.Tta(2),bd);Rb.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:Ic.length,["NumPinnedDocuments"]:Oc})}else bd=kc.FHb(this.Tta(0),this.Tta(2)),Rb.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return bd}XIj(){let Ic;Ic=!0;let bd=this.Hsd;var yb=this.Gsd;if(bd&&yb||!this.wv.supportsGetMoreInfoForPersonalStorage)Ic=
!1;else{const Oc=this.Rib.DK("File Open",!1);3===Oc.state&&(bd=Oc.pR,yb=Oc.Jya,Ic=!1)}yb=yb?String.format(this.Tta(4),yb):null;return{returnValue:kc.TPh(this.JYb.mTa,yb,bd),ikl:Ic}}pEg(){this.wv.Xgg.Kv(this.JYb.hOb)}get wv(){return this.laa.value}get Tta(){return this.PB.value}get JYb(){return this.Kmh.value}get Hsd(){return this.Njh.value}get Gsd(){return this.Mjh.value}get Rib(){return this.GPa.value}get fNj(){return this.ynh.value}get o_a(){this.$cd||(this.$cd=this.ya?this.ya.ka("IsO365CommercialHost")||
this.ya.ka("IsO365ConsumerHost"):!1);return this.$cd}}se.XSe=35;Object(l.a)(se,"MruRenderer",null,[]);class Fe{constructor(Ic,bd,yb,Oc,kd,Rc,Xb){this.lq=null;this.BXe=!1;this.TAa=this.rIe=0;this.dQb=dc=>{if(!this.lq&&3===dc.state)this.lq=dc;else if(2===dc.state){this.BXe?Rb.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.Rib.DK("NewDocumentFromStream",!0),this.BXe=!0);return}this.Rkf()};this.sPj=dc=>{if(dc&&dc.data&&dc.data.responseData){let yd=tc.d(dc.data.responseData);
({Ws:Vc}=yd);if(yd.returnValue)if(dc=Vc,dc.StatusCode!==Ud.a.nA&&dc.StatusCode!==Ud.a.FUa)Rb.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.BP,this.TAa,dc.StatusCode),this.N$a(null);else if(dc.NewDocumentUrl&&""!==dc.NewDocumentUrl){var Vc=(new Date).getTime()-this.rIe;Rb.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.BP,this.TAa,Vc);this.brh(dc.NewDocumentUrl)}else Rb.ULS.sendTraceTag(24904476,
202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.BP,this.TAa),this.N$a(null);else Rb.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.BP,this.TAa,{["ResponseData"]:ud.a.k7a(dc.data.responseData)}),this.N$a(null)}else Rb.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",
this.BP,this.TAa),this.N$a(null)};this.rPj=dc=>{dc&&dc.data&&Rb.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.BP,this.TAa,dc.data.status);this.N$a(null)};this.brh=Ic;this.N$a=bd;this.rgc=yb;this.hAb=Oc;this.FBa=kd;this.laa=Rc;this.GPa=new Gb.a(()=>new cc.a(Xb.value,this.dQb))}dfb(){!this.lq&&this.X6d.supportsGetMoreInfoForPersonalStorage?this.Rib.DK("NewDocumentFromStream",!0):this.Rkf()}Rkf(){this.rIe=(new Date).getTime();
var Ic=this.cAi.jzd;if(null===Ic)this.N$a(null);else{var bd=this.rgc.menuItemId,yb=this.rgc.fA,Oc=this.rgc.c1k,kd=this.rgc.hAi;this.TAa="streamBase64"===Oc?kd.length/1024:0;Rb.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.BP,this.TAa);var Rc=(new Date).getTime();Ic=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",Ic,N.a.Jf(this.kB),N.a.Jf(bd),N.a.Jf(this.BP),N.a.Jf(t.AFrameworkApplication.lcid.toString()),N.a.Jf(Rc.toString()),
N.a.Jf(yb),N.a.Jf(t.AFrameworkApplication.IP),t.AFrameworkApplication.Uh,N.a.Jf(Oc));Ic+="&"+t.AFrameworkApplication.dBc();(bd=this.lq?this.lq.pR:null)&&(Ic+="&DestinationUrl="+N.a.Jf(bd));"SharePoint"===this.kB||"SharePointOnlineConsumer"===this.kB?Ub.a.tt("6f63j813;9a66f561"):"OneDriveWopi"===this.kB&&Ub.a.tt("b8jd0489;3228j491");bd={"Content-Type":"application/json; charset=utf-8"};if("SharePoint"===this.kB||"SharePointOnlineConsumer"===this.kB?t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseGraphFileUploaderForCreateNew",
!1):"OneDriveWopi"===this.kB&&t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseGraphFileUploaderForOneDriveConsumerCreateNew",!1))bd["X-UseGraphFileUploader"]="1";this.X6d.Job.Wn(Ic,2,kd,bd,!0,2,this.sPj,this.rPj,null,void 0,void 0,void 0,void 0,"31")}}get BP(){switch(this.X6d.qE){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get cAi(){return this.hAb.value}get kB(){let Ic=this.FBa.value;"SharePoint"===
Ic&&t.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseGraphFileUploaderForCreateNew",!1)&&t.AFrameworkApplication.ea.ka("IsO365ConsumerHost")&&(Ic="SharePointOnlineConsumer");return Ic}get X6d(){return this.laa.value}get Rib(){return this.GPa.value}}Object(l.a)(Fe,"NewDocumentFromStreamOperation",null,[]);class fe{constructor(Ic,bd,yb,Oc){this.hAb=Ic;this.FBa=bd;this.laa=yb;this.xnh=Oc}create(Ic,bd,yb){return new Fe(Ic,bd,yb,this.hAb,this.FBa,this.laa,this.xnh)}}Object(l.a)(fe,
"NewDocumentFromStreamOperationFactory",null,[278]);var Tc=a(613);class ed{get name(){return"Common.App.NewAndOpen.UX"}ji(Ic){Ic.register(fe,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").Lc().Qc(()=>new fe(new Gb.a(()=>t.AFrameworkApplication.ua.Ab.oLd()),new Gb.a(()=>t.AFrameworkApplication.kB),new Gb.a(()=>Object(Ca.f)(eb.a)),new Gb.a(()=>Object(Ca.f)(Yb.a))))}init(){t.AFrameworkApplication.ea.hr(()=>{this.DSb()})}DSb(){const Ic=
Tc.a.Jq(Object(Ca.d)(eb.a)),bd=Tc.a.Jq(Object(Ca.d)(Yb.a));t.AFrameworkApplication.kB&&z.Task.WAA.call(null,Ic,bd).continueWith(()=>{const yb=new Db(new Gb.a(()=>Ic.result),new Gb.a(()=>t.AFrameworkApplication.ua.Ab.oLd()),new Gb.a(()=>bd.result),new Gb.a(()=>t.AFrameworkApplication.ua.Ab.pLd().mTa||"1959943459"),new Gb.a(()=>t.AFrameworkApplication.kB),new Gb.a(()=>t.AFrameworkApplication.Itj));yb.wi();yb.G2b()});if(t.AFrameworkApplication.iDg){const yb=Tc.a.Jq(Object(Ca.d)(kb.a));z.Task.WAA.call(null,
Ic,bd,yb).continueWith(()=>{const Oc=new se(new Gb.a(()=>Ic.result),new Gb.a(()=>Pc.x8j),new Gb.a(()=>t.AFrameworkApplication.ua.Ab.pLd()),new Gb.a(()=>t.AFrameworkApplication.w8j),new Gb.a(()=>t.AFrameworkApplication.v8j),new Gb.a(()=>bd.result),new Gb.a(()=>yb.result),t.AFrameworkApplication.ea);Oc.Sok();Oc.pEg()})}}dispose(){}}Object(l.a)(ed,"UXPackageManager",null,[11,12,4]);Object(M.b)(E.NewAndOpenUXService,{we:"transient"})(async Ic=>{await M.a.resolve(E.NewAndOpenCoreService,Ic);return new ed});
let pd=class{constructor(Ic,bd){this.zh=bd;this.$=Ic}executeCommand(Ic,bd,yb){Ic=2;switch(bd.command){case w.a.openUrlInNewTab:Ic=this.zh.pe(w.a.openUrlInNewTab,2,yb);break;case w.a.uKa:Ic=this.zh.pe(w.a.uKa,2,yb);break;case w.a.tKa:Ic=this.zh.pe(w.a.tKa,2,yb)}return 2!==Ic?z.Task.Va(!0):e.a(bd.command)}Rc(Ic,bd){Ic=!1;switch(bd.command){case w.a.openUrlInNewTab:case w.a.uKa:Ic=!0;break;case w.a.tKa:Ic=G.a.E2()}return Ic}td(Ic,bd,yb){return"PopulateMruMenu"===bd?(this.zh.pe(G.a.E2()?w.a.hRc:w.a.iRc,
2,yb),!0):!1}gd(){return!1}};pd=Object(u.__decorate)([Object(M.d)(E.OpenFromMruCommandHandlerService),Object(u.__param)(0,Object(E.EwaControlService)()),Object(u.__param)(1,Object(E.ActionManagerService)()),Object(u.__param)(2,Object(E.CommonUIStringsService)()),Object(u.__param)(3,Object(E.NewAndOpenUXService)())],pd);Object(l.a)(pd,"OpenFromMruCommandHandler",null,[29]);var Kb=a(154),rb=a(429),rc=a(117),ld=a(25),Tb=a(433);class Wc{constructor(Ic,bd){this.sheetName=null;this.value=!1;this.sheetName=
Ic;this.value=bd}getSheetName(){return this.sheetName}bE(){return this.value}}Object(l.a)(Wc,"MacroRecorderSheetOptionToggledPayload",null,[67]);const Ac=(Ic,bd,yb,Oc,kd,Rc,Xb,dc)=>{dc=Ic.$a(9,void 0===dc?null:dc);dc.sheetName=bd;dc.show=yb;return Ha.h(Ic,"ShowGridlines",dc,Oc,kd,Rc,Xb,0)},nd=(Ic,bd,yb,Oc,kd,Rc,Xb,dc)=>{dc=Ic.$a(9,void 0===dc?null:dc);dc.sheetName=bd;dc.show=yb;return Ha.h(Ic,"ShowHeadings",dc,Oc,kd,Rc,Xb,0)},qd=(Ic,bd,yb,Oc,kd,Rc,Xb,dc)=>{dc=Ic.$a(9,void 0===dc?null:dc);dc.sheetName=
bd;dc.directionRtl=yb;return Ha.h(Ic,"ChangeSheetDirection",dc,Oc,kd,Rc,Xb,0)};var Xd;let Hd=Xd=class{constructor(Ic){this.$=Ic}gd(){return!1}executeCommand(Ic,bd){const yb={};this.$.Zk(yb);Ic=bd.command;const Oc=Object(Kb.a)(rc.a,this.$.qa.getItemByName(yb.SheetName));if(!Oc)return e.a(Ic);let kd,Rc,Xb,dc,Vc;switch(Ic){case 705559150:case -1411193626:kd=16;Rc=!Oc.hideGridLines;Xb=Ac;Vc=183;dc=Oc.hideGridLines;break;case -2052321504:case 515737500:kd=4;Rc=!Oc.headersVisible;Xb=nd;Vc=184;dc=!Oc.headersVisible;
break;case -1478455630:kd=2;Rc=!Oc.displayRtl;Xb=qd;Vc=185;dc=!Oc.displayRtl;ld.f(this.$).gridBlockManager.Hbl(Rc);break;default:return e.a(Ic)}Oc.sIb(kd,Rc);const yd=()=>new Wc(yb.SheetName,dc),Pd=this.$.ma.sa;return rb.a(this.$.userOperationManager,(re,ue,He)=>Xb(Pd,yb.SheetName,dc,U.c(re,bf=>{Xd.f0b(bf,Oc,kd,Rc)}),U.b(ue,()=>{Xd.n_b(Oc,kd,Rc)}),He,null),re=>new L.a(Vc,0,re,void 0,yd),bd)}Rc(Ic,bd){Ic=!1;switch(bd.command){case -1411193626:case 515737500:case -1478455630:Ic=!0;break;case 705559150:case -2052321504:Ic=
Tb.a(this.$)}return Ic}td(){return!1}static f0b(Ic,bd,yb,Oc){X.a.Ls(Ic.Errors)&&bd.sIb(yb,!Oc)}static n_b(Ic,bd,yb){Ic.sIb(bd,!yb)}};Hd=Xd=Object(u.__decorate)([Object(M.d)(E.SheetOptionsToggleCommandHandlerService),Object(u.__param)(0,Object(E.EwaControlService)())],Hd);Object(l.a)(Hd,"SheetOptionsToggleCommandHandler",null,[29]);var Zc=a(1525),Jc=a(17),gc=a(927),dd=a(928),Bb=a(282),pc=a(306);class wc{constructor(Ic){this.$=Ic;this.Rbf="SheetViewEntryCallout";this.XEc=!1;this.Qea=bd=>{ld.f(this.$).focus();
this.XEc=!bd;bd&&this.zof()};this.dRj=document.createElement("div");this.nq=document.getElementById(this.$.Oc+da.a.wId);pc.a(this.$).hl(this);this.Vqa()}dispose(){var Ic;this.$=null;null===(Ic=pc.a(this.$))||void 0===Ic?void 0:Ic.XC(this)}dWk(){var Ic;!this.$.qa||(null===(Ic=this.$.qa.la)||void 0===Ic?0:Ic.ue.vI)?this.$.fa.LCa(this.showCallout):this.$.qa.wod(this.showCallout);this.$.fa.wlc(this.yLb)}Vqa(){this.showCallout=this.showCallout.bind(this);this.Yfb=this.Yfb.bind(this);this.yLb=this.yLb.bind(this)}showCallout(){var Ic;
this.yLb();null!==(Ic=this.$.qa.la)&&void 0!==Ic&&Ic.ue.vI?(this.iXg(!0),this.XEc=!0,this.$.fa.wlc(this.Yfb),this.$.qa.mh(this.Yfb)):Rb.ULS.sendTraceTag(508048723,gc.a.ewa,dd.a.warning,"SheetViewEntryCallout.showCallout: skipped as current sheet is not in temporary sheet view mode.")}Yfb(){this.XEc&&(this.iXg(!1),this.XEc=!1);this.zof()}yLb(Ic,bd){var yb;bd&&Rb.ULS.sendTraceTag(507839433,gc.a.ewa,dd.a.warning,"SheetViewEntryCallout.detachShowCalloutListeners: detaching without showing callout.");
this.$.fa.Oie(this.yLb);null===(yb=this.$.qa)||void 0===yb?void 0:yb.Iie(this.showCallout);this.$.fa.yxa(this.showCallout)}zof(){this.$.fa.Oie(this.Yfb);this.$.qa.xh(this.Yfb)}iXg(Ic){appChrome.showOrHideSheetViewEntryCallout(this.dRj,{showCallout:Ic,calloutId:this.Rbf,anchor:this.nq,restoreFocus:this.Qea})}get ud(){return document.getElementById(this.Rbf)}get ij(){return Jc.DOMElementExtensions.isVisible(this.ud)}get tf(){return Bb.a.bUg}Nj(Ic,bd){if(bd)return!1;Ic=this.ud.querySelectorAll(Jc.DOMElementExtensions.$D);
let yb;for(bd=0;bd<Ic.length;bd++){const Oc=Ic[bd];Jc.DOMElementExtensions.ij(Oc)&&(yb=Oc)}if(!yb)return Rb.ULS.sendTraceTag(508117186,gc.a.ewa,dd.a.error,"SheetViewEntryCallout.SetFocusOnSection: Could not find focusable element in SheetViewEntryCallout"),!1;yb.focus();return!0}zk(Ic){return Jc.DOMElementExtensions.Ki(this.ud,Ic)}Hm(){}fo(){}}Object(l.a)(wc,"SheetViewEntryCallout",null,[24,4]);let cd=class{constructor(Ic){this.$=Ic;this.Gab=!1;this.Zqe=null;this.yTb=fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NsvEntryOptimizationApplyForEveryone",
!1);this.SXd=fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DisableSortFilterNSVEntryInSelfCoauthor",!1);this.NOc=(bd,yb)=>{var Oc;bd=null===(Oc=yb.jg)||void 0===Oc?void 0:Oc.operation;0===yb.Fq&&bd&&bd.operationName===this.k1d&&(this.gXb=bd,this.$.userOperationManager.kn(this.NOc))};this.Zqe=new wc(this.$);this.NOc=this.NOc.bind(this)}dispose(){this.Zqe=this.$=this.k1d=this.gXb=this.NJc=null}gd(){return!1}Rc(Ic,bd){switch(bd.command){case -1062729243:return!0;default:return!1}}executeCommand(Ic,
bd){Ic=bd.command;switch(Ic){case -1062729243:return this.applyLastSortFilterInDefaultView(bd.Re)}return e.a(Ic)}td(){return!1}SJd(){return{isVisible:this.RYf(),isChecked:this.Gab}}g6k(){this.Gab=!this.Gab;Rb.ULS.sendTraceTag(508180431,0,50,`SortFilterManager::toggleShouldApplySortFilterForEveryone: Apply for everyone value updated to ${this.Gab}`)}EKa(Ic,bd,yb,Oc,kd){Rb.ULS.sendTraceTag(508180430,0,50,`SortFilterManager::performAction: Performing sort filter action. Caller: ${yb}`);this.ECk(Ic,Oc,
kd);return this.mQk?(Ic(),z.Task.Va(!0)):this.foi(Ic,bd)}get mQk(){if(this.RYf())return this.Gab;const Ic=this.$.qa.la;return!this.$.fa.$b.allowViewCollab||null!==Ic&&void 0!==Ic&&Ic.ue.Bq?!0:!1}RYf(){const Ic=this.$.qa.la;return this.yTb&&this.$.fa.W8&&!(null===Ic||void 0===Ic?0:Ic.ue.Bq)&&(this.SXd?this.$.fa.lVd()||!this.$.fa.WW&&this.$.fa.e6f():this.$.fa.aQ)&&!Object(mb.e)(this.$)&&!this.$.fa.$b.allowViewCollab}foi(Ic,bd){const yb={[da.a.A6d]:!1},Oc=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8336194_FUseNewNsvCreateCommand")?
2052531625:-2050946363;bd=this.$.Ia.Gb(new K.a(Oc,wa.a.Hb,2,bd,null),yb);bd.continueWith(kd=>{!db.a(kd)&&kd.result&&(Ic(),this.$.fa.$b.allowViewCollab?Rb.ULS.sendTraceTag(508044257,0,50,"SortFilterManager::enterNamedSheetViewAndPerformAction: showNamedSheetViewEntryCallout skipped in view collab mode."):this.Zqe.dWk())});return bd}applyLastSortFilterInDefaultView(Ic){this.Gab=!0;var bd=z.Task.Va(!0);const yb=this.$.qa.la;(null===yb||void 0===yb?0:yb.ue.Bq)?(bd={[da.a.rgg]:!0},bd=this.$.Ia.Gb(new K.a(1690118309,
wa.a.Hb,2,Ic,null),bd),bd.continueWith(Oc=>{Oc.isCompleted&&this.vDg()})):this.vDg();return bd}ECk(Ic,bd,yb){this.k1d=this.gXb=this.NJc=null;this.NJc=bd?bd:yb?this.AZi(yb):Ic}AZi(Ic){this.k1d=Ic;this.$.userOperationManager.Kp(this.NOc);return()=>{this.gXb?this.$.userOperationManager.enqueueOperation(this.gXb,this.gXb.fc):Rb.ULS.sendTraceTag(507901280,0,10,"SortFilterManager::getReapplyActionFromOperationName: lastSortFilterOperation is null.")}}vDg(){this.NJc?this.NJc():Rb.ULS.sendTraceTag(507901279,
0,10,"SortFilterManager::reapplyLastSortFilterAction: lastSortFilterReapplyAction is null.")}};cd=Object(u.__decorate)([Object(M.d)(E.SortFilterManagerService),Object(u.__param)(0,Object(E.EwaControlService)())],cd);Object(l.a)(cd,"SortFilterManager",null,[240,29,4]);let Vd=class{constructor(Ic){this.zh=Ic}executeCommand(Ic,bd,yb){return 2!==this.zh.pe(w.a.tryOfficeThroughTellMe,2,yb)?z.Task.Va(!0):e.a(bd.command)}Rc(Ic,bd){return 215809929===bd.command}td(){return!1}gd(){return!1}};Vd=Object(u.__decorate)([Object(M.d)(E.TryOfficeThroughTellMeCommandHandlerService),
Object(u.__param)(0,Object(E.ActionManagerService)())],Vd);Object(l.a)(Vd,"TryOfficeThroughTellMeCommandHandler",null,[29]);var xb=a(281),ub=a(9),Fc=a(936);class xd extends Fc.a{constructor(Ic){super(Ic)}oq(){const Ic=ba.GetServiceTaskFactory.create(this.$.ra,203,this.Aa,this.Cc);J.TaskExtensions.tb(J.TaskExtensions.jl([Ic],this.Aa),()=>{this.fn([new oa(this.$)])},this.Aa,3)}static Ea(Ic){Ic.fa.Kh.get(61)&&Fc.a.cw(215,new xd(Ic))}}Object(l.a)(xd,"MsFormCommandHandlerFactory",Fc.a,[]);Type.registerNamespace("Common.App.NewAndOpen.UX");
xb.a.instance.Qi(new ed);a(1522);(()=>{ub.a.wb(Ic=>{E.MsFormCommandHandlerService.Oa()||xd.Ea(Ic)})})();String(c);String(b);String(f);String(k);String(x);String(d);String(h);String(Zc);String(n);String(m);window.___1717508060479_closurehack=c;window.___1717508060479_closurehack=b;window.___1717508060479_closurehack=f;window.___1717508060479_closurehack=k;window.___1717508060479_closurehack=x;window.___1717508060479_closurehack=d;window.___1717508060479_closurehack=h;window.___1717508060479_closurehack=
Zc;window.___1717508060479_closurehack=n;window.___1717508060479_closurehack=m}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.kmhv.js.map/8a4739093babc441014cd54186d611ee/EwaTS.kmhv.js.map