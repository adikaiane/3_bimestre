'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[5],{1179:function(y,r){function a(){return"undefined"===typeof globalThis.e6c?b:globalThis.e6c()}function c(f,k){var x;return null!==(x=a()[f])&&void 0!==x?x:k}Object.defineProperty(r,"__esModule",{value:!0});r.setFeatureGateDictionaryGetter=r.getIntFeatureGate=r.yLf=r.getBooleanFeatureGate=r.getStringFeatureGate=r.CPb=void 0;var b={};r.CPb=a;r.getStringFeatureGate=c;r.getBooleanFeatureGate=function(f,k){var x;f=
null===(x=c(f))||void 0===x?void 0:x.trim().toLowerCase();return"true"===f?!0:"false"===f?!1:k};r.yLf=function(f,k){var x;f=null===(x=c(f))||void 0===x?void 0:x.trim().toLowerCase();if(void 0===f)return k;if("infinity"===f||"+infinity"===f)return Infinity;if("-infinity"===f)return-Infinity;x=parseFloat(f);return isNaN(x)?k:x};r.getIntFeatureGate=function(f,k){var x;f=null===(x=c(f))||void 0===x?void 0:x.trim();if(void 0===f)return k;x=parseInt(f,10);return isNaN(x)?k:x};r.setFeatureGateDictionaryGetter=
function(f){var k=globalThis.e6c;globalThis.e6c=f;return k}},1180:function(y,r){function a(){return"undefined"===typeof globalThis.d6c?{}:globalThis.d6c()}Object.defineProperty(r,"__esModule",{value:!0});r.setChangeGateDictionaryGetter=r.isChangeGateEnabled=r.Wyc=void 0;r.Wyc=a;r.isChangeGateEnabled=function(c){var b;return null!==(b=a()[c])&&void 0!==b?b:!0};r.setChangeGateDictionaryGetter=function(c){var b=globalThis.d6c;globalThis.d6c=c;return b}},1588:function(y,r,a){Object.defineProperty(r,"__esModule",
{value:!0});var c=a(133);c.__exportStar(a(1179),r);c.__exportStar(a(1589),r);c.__exportStar(a(1180),r);c.__exportStar(a(1590),r);c.__exportStar(a(1591),r);c.__exportStar(a(1592),r)},1589:function(y,r,a){Object.defineProperty(r,"__esModule",{value:!0});r.fJj=void 0;var c=a(1179);r.fJj=function(b){return function(f){var k=b[f];switch(typeof k){case "boolean":return(0,c.getBooleanFeatureGate)(f,k);case "number":return(0,c.yLf)(f,k);case "string":return(0,c.getStringFeatureGate)(f,k);default:throw Error("Wrong defaultValue type");
}}}},1590:function(y,r,a){Object.defineProperty(r,"__esModule",{value:!0});r.mJj=void 0;var c=a(1180);r.mJj=function(){return function(b){return(0,c.isChangeGateEnabled)(b)}}},1591:function(y,r,a){function c(k){var x=(0,f.setChangeGateDictionaryGetter)(void 0);(0,f.setChangeGateDictionaryGetter)(function(){var d=void 0!==x?x():{};return b.__assign(b.__assign({},d),k)});return x}Object.defineProperty(r,"__esModule",{value:!0});r.I9j=r.z9j=void 0;var b=a(133),f=a(1180);r.z9j=c;r.I9j=function(k,x){return c(x)}},
1592:function(y,r,a){function c(k){function x(){return{}}for(var d,h,n={},m=0,u=Object.keys(k);m<u.length;m++){var l=u[m];n[l]=null===(d=k[l])||void 0===d?void 0:d.toString()}var t=null!==(h=(0,f.setFeatureGateDictionaryGetter)(void 0))&&void 0!==h?h:x;(0,f.setFeatureGateDictionaryGetter)(function(){return b.__assign(b.__assign({},t()),n)});return t}Object.defineProperty(r,"__esModule",{value:!0});r.J9j=r.E9j=void 0;var b=a(133),f=a(1179);r.E9j=c;r.J9j=function(k,x){return c(x)}},203:function(y,r,
a){function c(ib){if(window&&window.performance&&window.performance.mark)try{window.performance.mark(ib)}catch(xc){}}function b(ib,xc){return ib?ib.nameManagerItems.filter(xc).map(Kc=>({runtimeUid:Kc.metadata.runtimeUid,name:Kc.name,reference:"="+Kc.reference,comment:Kc.comment,type:Zb.SVi(Kc.metadata.type),scope:Zb.X_i(Kc.scope),referenceSheetName:Kc.referenceSheetName,isInvalidReference:Kc.isInvalidReference,topLeft:Kc.topLeft,bottomRight:Kc.bottomRight})):null}function f(){return{show:{count:0,
repairCounts:[]},hideDurations:{["escape"]:[],["ignore"]:[],["selection"]:[],["edit"]:[],["commit"]:[],["scroll"]:[],["clearCell"]:[],["undo"]:[]}}}function k(ib){S.ULS.sendTraceTag(508370960,1,10,`FormulaRepairTelemetry.${ib}`)}function x(ib,xc,Kc,ra,jb){return za.EwaSettings.hIa()?gridRenderer.CanvasRendererGlobals.canMultipleRowColHideOrCascade(ib,xc,Kc,ra,jb):gridRenderer.CanvasRendererGlobals.canRowColHideOrCascade(ib,xc,ra,jb)}function d(ib){const xc=n(ib),Kc=h(ib),ra=[],jb={};ib.forEach(vc=>
{if(!(za.EwaSettings.isChangeGateEnabled("OfficeVSO:8836203_enableFreezePanesCseColumnWidthFailureFix")&&0>=vc.em)){tf&&Object(Pe.k)(vc);var {X:md,Y:Qd}=vc.YA().topLeft;jb[`${md},${Qd}`]=vc}});for(ib=0;ib<=xc;ib++)for(let vc=0;vc<=Kc;vc++){const md=jb[`${ib+1},${vc}`],Qd=jb[`${ib},${vc+1}`],v=jb[`${ib+1},${vc+1}`],Qb=jb[`${ib},${vc}`];ra.push({destination:null!==Qb&&void 0!==Qb?Qb:null,b8b:null!==md&&void 0!==md?md:null,$7b:null!==Qd&&void 0!==Qd?Qd:null,a8b:null!==v&&void 0!==v?v:null,sI:!1})}S.ULS.sendTraceTag(507586694,
0,50,`FreezePanesInstantaneousAction.getadjacentBlocksInViewport parameter = blockPairsLength, value=${ra.length}`);return ra}function h(ib){let xc=-1;for(let Kc=0;Kc<ib.length;Kc++){const ra=ib[Kc].YA().topLeft.Y;ra>xc&&(xc=ra)}return xc}function n(ib){let xc=-1;for(let Kc=0;Kc<ib.length;Kc++){const ra=ib[Kc].YA().topLeft.X;ra>xc&&(xc=ra)}return xc}function m(ib,xc,Kc){Kc=af.resolveRibbonCommandName(Kc);S.ULS.sendTraceTag(509723719,0,20,`FreezePanesInstantaneousAction: Time taken to complete operation=${ib} is time=${xc} and command=${Kc}`)}
a.r(r);var u={};a.r(u);a.d(u,"AutoSumCommandHandler",function(){return $a});var l={};a.r(l);a.d(l,"CellImageToFloatingObjectController",function(){return eb});var t={};a.r(t);a.d(t,"ClearCommandHandler",function(){return Sb});var e={};a.r(e);a.d(e,"ClearContentNotifier",function(){return na});var w={};a.r(w);a.d(w,"DefinedNameManager",function(){return uc});var z={};a.r(z);a.d(z,"FileCollectionOperation",function(){return de});var E={};a.r(E);a.d(E,"FloatingObjectToCellImageController",function(){return Fe});
var M={};a.r(M);a.d(M,"FontDropdownHelper",function(){return ld});var G={};a.r(G);a.d(G,"FormatCellsCommandHandler",function(){return Ic});var A={};a.r(A);a.d(A,"FormulaAnonymizer",function(){return bd});var N={};a.r(N);var K={};a.r(K);a.d(K,"FormulaRepairTelemetry",function(){return re});var I={};a.r(I);a.d(I,"FreezePanesInstantaneousAction",function(){return Jf});a.d(I,"canRowColHideOrCascade",function(){return x});a.d(I,"testableGetAdjacentBlocksInViewport",function(){return d});var L={};a.r(L);
a.d(L,"FreezePanesDragDirection",function(){return Kf});a.d(L,"FreezePaneDragOrigin",function(){return Vf});a.d(L,"FreezePaneDragAction",function(){return sb});var J={};a.r(J);a.d(J,"FreezePanesCommandHandler",function(){return gf});var B={};a.r(B);a.d(B,"HeaderInsert",function(){return Aa});var Y={};a.r(Y);a.d(Y,"ImageInCellCommandHandler",function(){return oc});var U={};a.r(U);a.d(U,"NameManagerCommandHandler",function(){return Od});var O={};a.r(O);a.d(O,"OfficePyUXCommandHandler",function(){return ze});
var C=a(133),X=a(0),S=a(15),ea=a(263),Oa=a(232),Ha=a(61);const Za=(ib,xc,Kc,ra,jb,vc)=>{if(xc){const md=ib.Za;ib.isEditing||ib.startEdit(xc,!0);ib.AYd=!0;ib.text=Kc;md.caretPosition=jb;jb<vc&&(ra&&ib.SMa(),md.selectRange(0,vc+1),md.selectRange(jb,vc))}};var fa=a(70);class la{constructor(ib,xc){this.sharedSheetRange=null;this.type=0;this.sharedSheetRange=ib;this.type=xc}djb(){return this.sharedSheetRange}}Object(X.a)(la,"MacroRecorderAutoSumPayload",null,[67]);var ba=a(44),aa=a(429),oa=a(213),Na=a(81),
Ia=a(43),Sa=a(369),Pa=a(36),za=a(1),wa=a(209),db=a(266),Ba=a(25),Ka=a(143),da=a(678),sa=a(67),mb=a(5),Ma=a(65),hb=a(88);let $a=class extends Oa.a{constructor(ib){super();this.M8j={[-134268171]:"+",[406756244]:"-",[1405397228]:"*",[-264074569]:"/"};this.SYf=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8968480_ArithmeticOperatorsCallout");this.iGc=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8968179_FormulaAccessibilityBugs");this.sTj=xc=>{const Kc=Ba.f(this.$);if(xc=xc.Result){let ra=ba.I(xc.NewSelection),
jb=ba.I(xc.NewActiveCell);if(ra&&jb)if(!xc.Committed&&xc.AutoSumFormula){const vc=Kc.Ob(jb);vc&&(Kc.ha.updateSelection(ra,jb,60),ra=jb=ba.I(xc.MarkedArea),Kc.ZH=2,Za(Kc.cellTextEditBox,vc,xc.AutoSumFormula,!!ra,xc.FormulaMarkStart,xc.FormulaMarkEnd),ra&&jb&&Kc.ha.updateSelection(ra,jb,0),Ia.TaskExtensions.tb(za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)?Object(hb.d)(Ma.a.resolve(mb.AriaLiveNotifierService,{xa:0})):Na.GetServiceTaskFactory.Ne(this.$.ra,
211,212,0),md=>{md.result.L3(Kc.cellTextEditBox.text)},this.$.Aa,3),Kc.cellTextEditBox.AYd=!1,void Ma.a.resolve(mb.FunctionInfoManagerService,{xa:0}).then(md=>{md.Egb(null)}))}else Kc.ha.updateSelection(ra,jb,60)}};this.$=ib}gd(){return!1}executeCommand(ib,xc,Kc){ib=xc.command;switch(ib){case 1220954656:case 505713221:xc=this.gqf(0,xc);break;case -1537138325:xc=this.gqf(parseInt(Kc[fa.a.Wc].toString(),10),xc);break;case -134268171:case 406756244:case 1405397228:case -264074569:xc=this.W6i(xc);break;
default:xc=wa.a(ib)}return xc}Rc(ib,xc){if(ib=1===ib)switch(xc.command){case 1220954656:case 505713221:case -1537138325:break;case -134268171:case 406756244:case 1405397228:case -264074569:ib=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BasicArithmeticOperations",!1);break;default:ib=!1}return ib}td(){return!1}RKf(ib,xc){return(ib=ib.nv(xc))?ib:xc}hQb(ib,xc,Kc){xc="above"===Kc?ba.J(xc,ib.hd):ba.K(xc,ib.hd);return this.RKf(ib,xc)}cIg(ib,xc,Kc,ra){var jb=Ba.f(this.$);Kc=`=${Kc.topLeft} ${xc} ${ra.topLeft} `;
ra=jb.ha.oa.activeCell;const vc=jb.nv(ra);ra=null!==vc&&vc!==ra;if(ib=jb.Ob(ib))jb=jb.getCellBounds(ib.cell,!0),ib=document.getElementById("arithmeticOperatorCalloutTarget"),ib||(ib=document.createElement("div"),ib.id="arithmeticOperatorCalloutTarget",document.body.appendChild(ib)),appChrome.renderArithmeticOperatorCallout(ib,jb.y,jb.x,jb.y+jb.height,64<=jb.width||ra?jb.x+Math.max(jb.width,8*Kc.length):jb.x+jb.width+8,xc)}D5h(ib,xc){const Kc=this.RKf(ib,ib.ha.oa.activeCell);let ra=null,jb=null;var vc=
null;const md=1===Kc.top||1===this.hQb(ib,Kc,"above").top;ra=md?this.hQb(ib,Kc,"below"):this.hQb(ib,Kc,"above");vc=JSON.parse(JSON.stringify(ra));vc.left=Kc.left;jb=md?this.hQb(ib,vc,"below"):this.hQb(ib,vc,"above");const Qd=`=${ra.topLeft} ${xc} `;vc=ib.Rb;ib.startEdit(!0,1);vc.text=`${Qd}`;vc.Za.e5a(Qd.length);vc.Za.caretPosition=Qd.length;this.iGc?(ib.cellTextEditBox.Za.domElement.y8e="off",Ia.TaskExtensions.tb(za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",
!1)?Object(hb.d)(Ma.a.resolve(mb.AriaLiveNotifierService,{xa:0})):Na.GetServiceTaskFactory.Ne(this.$.ra,211,212,0),v=>{v.result.L3(Qd);ib.ha.updateSelection(jb.topLeft,Kc,60);this.SYf&&this.cIg(Kc,xc,ra,jb)},this.$.Aa,8)):(ib.ha.updateSelection(jb.topLeft,Kc,60),this.SYf&&this.cIg(Kc,xc,ra,jb))}W6i(ib){const xc=Ba.f(this.$),Kc=this.M8j[ib.command];return Kc?ea.a.Va(Ma.a.resolve(mb.FormulaAssistanceManagerService,{xa:0}).then(()=>{this.D5h(xc,Kc);return!0}).catch(ra=>{S.ULS.sendTraceTag(507381573,
0,10,`AutoSumCommandHandler.handleArithmeticOperator: Error occurred while resolving FormulaAssistanceManagerService: ${ra}`);return!1})):(S.ULS.sendTraceTag(507388317,0,10,`AutoSumCommandHandler.handleArithmeticOperator: Unhandled command ${ib.command}`),ea.a.Va(!1))}gqf(ib,xc){const Kc=Ba.f(this.$);Kc.$h.LP(!1);if(!Ba.f(this.$).ha.oa.vi)return xc=Ba.f(this.$).ha.oa.gR,S.ULS.sendTraceTag(537170308,0,50,`AutoSumCommandHandler.DoAutoSum: Unhandled AutoSum of type ${ib} due to discontinuous selection. Number of selected ranges is ${xc}`),
this.JKa(),sa.Task.Va(!1);const ra=Kc.SF();if(!ra)return null;const jb=ba.y(Kc.ha.oa.Ed,this.$),vc=ba.r(Kc.ha.oa.activeCell,this.$),md=ba.r(ra,this.$),Qd=this.$.ma.sa.mc(),v=()=>new la(jb,ib);return this.$.Ss(Kc.ha.oa.selectedRanges,!0)?aa.a(this.$.userOperationManager,(Qb,Dc,id)=>{var Md=this.$.ma.sa;Qb=db.c(Qb,this.sTj);const Sd=Md.$a(9,Qd);Sd.selectedRange=jb;Sd.activeCell=vc;Sd.autoSumType=ib;Sd.topLeftCell=md;return Ha.h(Md,"AutoSum",Sd,Qb,Dc,id,ib,0)},Qb=>new oa.a(502,0,Qb,64,v),xc):sa.Task.Va(!1)}JKa(){da.a(Ka.a.discontinuousSelectionBlocking,
["OtherICE"],!0,!0,!1,!1,null);const ib=Pa.a.Cd(1,1,751,2192,0,371863010,"DiscontinuousSelectionBlocking");new Sa.a(this.$,ib)}};$a=Object(C.__decorate)([Object(Ma.d)(mb.AutoSumCommandHandlerService),Object(C.__param)(0,Object(mb.EwaControlService)())],$a);Object(X.a)($a,"AutoSumCommandHandler",Oa.a,[29]);var Va=a(93),xa=a(684),ia=a(178),Z=a(39),ta=a(943),pa=a(13),Ga=a(83),Ca=a(126),kb=a(134);let eb=class extends Va.a{constructor(ib,xc,Kc,ra){super();this.Hd=()=>{this.button.getButton(this.da.rb.Yh(this.da.ha.oa.activeCell)).Mqb();
ia.a.sendTelemetryEvent({name:"Office.Excel.Online.OnObjectUI.ButtonPressed",dataFields:Ca.a.Eh({["buttonType"]:"CellImageToFloatingObject"})});const jb=new Ga.a(2000316912,fa.a.Hb,this.$.xc,9,null);this.$.Ia.Gb(jb,null)};this.ph=()=>{this.p4()};this.qk=()=>{this.p4()};this.nB=()=>{this.p4()};this.yt=()=>{this.p4()};this.Nh=()=>{this.zQ()};this.rm=()=>{this.zQ()};this.vv=()=>{this.p4()};this.$=ib;this.button=Kc.pKb(ib,xc,this.Hd,null,null,pa.a.instance.ia(2318),"CellImageToFloatingObjectPointerDown");
this.isVisible=!1;this.da=Ba.f(this.$);this.da.ha.ZS(this.ph);this.da.Rb.qH(this.Nh);this.da.aw(this.nB);this.$.DD(this.qk);za.EwaSettings.isChangeGateEnabled("OfficeVSO:8726584_DisablePictureOOUIForViewMode")&&this.$.fa.CD(this.vv);this.da.view.Ks(this.yt);this.da.ha.ob.pF(this.rm);this.ariaLiveNotifier=ra}dispose(){this.da&&(this.da.ha.rV(this.ph),this.da.view.xs(this.yt),this.da.Zz(this.nB),this.da.ha.ob.yL(this.rm),this.da.Rb&&this.da.Rb.QI(this.Nh));this.$&&(this.$.vG(this.qk),za.EwaSettings.isChangeGateEnabled("OfficeVSO:8726584_DisablePictureOOUIForViewMode")&&
this.$.fa.xB(this.vv));this.button.dispose();this.ariaLiveNotifier=this.$=this.da=this.button=null;super.dispose()}fmd(){this.isVisible&&this.Hd(null,null)}uUg(ib){const xc=new kb.SheetProtection(this.$.qa);return xc&&xc.Ih&&(xc.D4f(ib,this.da)||!xc.ie(1))?!0:!1}p4(){if(za.EwaSettings.isChangeGateEnabled("OfficeVSO:8726584_DisablePictureOOUIForViewMode")&&!this.$.isEditMode)this.zQ();else{za.EwaSettings.isChangeGateEnabled("OfficeVSO:8478102_HideOOUIOnFloatingObjectSelected")&&this.da.ha.ob.isFloatingObjectSelected&&
this.zQ();var ib=this.da.ha.oa.activeCell;if(za.EwaSettings.isChangeGateEnabled("OfficeVSO:8495249_DisableOOUIOnProtectedSheet")&&this.uUg(ib))this.zQ();else{var xc=this.da.za.ft(ib);null!=xc&&xc.jYa?this.cna(ib):this.zQ()}}}cna(ib){const xc=this.da.rb.Yh(ib);ib=this.da.Wg(ib,xc);const Kc=this.da.pg(xc).ul;var ra=this.da.ha.oa.activeCell;if(!(za.EwaSettings.isChangeGateEnabled("OfficeVSO:8352188_DisableInCellOOUIForFormulaBasedImage")&&ra&&this.da.Eb.HTb(ra)&&this.da.Eb.$Ud(ra)||za.EwaSettings.isChangeGateEnabled("OfficeVSO:8352225_DisableInCellOOUIForPivotTable")&&
this.da.Eb.tU(ra)||za.EwaSettings.isChangeGateEnabled("OfficeVSO:8885665_DisableOOUIOnProtectedSheet")&&this.uUg(ra)))if(1===this.da.ha.gf&&ib&&ib.ld(Kc)&&Kc.width>ib.width){ra=ib.bottomRight.x+this.Kz;let jb=ib.topLeft.y-this.Kz-this.button.buttonWidth;ra+this.button.buttonWidth>Kc.bottomRight.x&&(ra=ib.topLeft.x-this.Kz-this.button.buttonWidth);jb<Kc.topLeft.y+this.Kz&&(jb=Kc.topLeft.y+this.Kz);this.Xo(ra,jb,this.da.rtl,xc)}else this.zQ()}Xo(ib,xc,Kc,ra){this.button.Y2c(ta.a.Zjj,pa.a.instance.ia(2318),
ra);this.button.x2c(pa.a.instance.ia(2318),ra);this.button.Xo(ib,xc,Kc,ra,!1,!0);this.isVisible=!0;this.WIh()}zQ(){this.button.hide();this.isVisible=!1}WIh(){let ib;ib=Z.a.isMac?pa.a.instance.ia(2321):pa.a.instance.ia(2320);this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.L3(ib)}get Kz(){return this.button.Kz}};eb=Object(C.__decorate)([Object(Ma.d)(mb.CellImageToFloatingObjectService),Object(C.__param)(0,Object(mb.EwaControlService)()),Object(C.__param)(1,Object(xa.h)()),Object(C.__param)(2,
Object(mb.SharedUIControlsFactoryService)()),Object(C.__param)(3,Object(mb.AriaLiveNotifierService)())],eb);Object(X.a)(eb,"CellImageToFloatingObjectController",Va.a,[]);var Yb=a(189),Gb=a(242),Mb=a(27),Rb=a(41),$b=a(1344),cc=a(255),fb=a(63);let Sb=class extends Rb.a{constructor(ib,xc,Kc,ra){super();this.$=ib;this.je=xc;this.$e=Kc;this.clearContentNotifier=ra;this.LUj=(jb,vc)=>{if(!cc.a(jb)&&vc){const md=!!jb&&!!jb.RequestTelemetryData;Ba.f(this.$).Ce.UY(vc.toString(),jb.StateId,md?jb.RequestTelemetryData.EcsOperationDuration:
0,md?jb.RequestTelemetryData.EcsRequestDuration:0,md?jb.RequestTelemetryData.WfeRequestDuration:0)}}}gd(){return!1}executeCommand(ib,xc){ib=xc.command;switch(ib){case -730106152:xc=this.oQd(xc,3);break;case -1228228458:xc=this.oQd(xc,4);break;case -848953656:case 2045211913:if(this.Tuj()){xc=sa.Task.Va(!0);break}xc=this.oQd(xc,1);break;default:xc=wa.a(ib)}return xc}Rc(ib,xc){if(ib=1===ib)switch(xc.command){case -730106152:case -1228228458:case -848953656:case 2045211913:break;default:ib=!1}return ib}td(){return!1}oQd(ib,
xc){const Kc=Ba.f(this.$),ra=Kc.ha.oa.selectedRanges,jb=ib.command,vc=Yb.a.create().toString();if(!this.$.Ss(ra,!0)&&-730106152!==jb)return sa.Task.Va(!0);const md=ba.u(ra,this.$);this.LVk(jb,Kc,ra,vc);za.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&this.clearContentNotifier.qik();const Qd=this.$.ma.sa.mc({hla:!0,lka:1}),v=()=>new $b.a(xc,md);return aa.a(this.$.userOperationManager,(Qb,Dc,id)=>{this.$.Qw();return Ha.d(this.$.ma.sa,xc,md,!1,db.c(Qb,this.LUj),
Dc,id,vc,Qd)},Qb=>new oa.a(508,0,Qb,67,v),ib)}LVk(ib,xc,Kc,ra){if(-848953656!==ib&&2045211913!==ib&&-730106152!==ib&&-1228228458!==ib)S.ULS.sendTraceTag(537167938,0,10,`ClearCommandHandler.ShowInstantaneousClear: Unexpected command ${ib}.`);else if(!Gb.a.any(Kc,vc=>0<xc.getRangeInformation(vc).length)){var jb=Gb.a.any(Kc,vc=>this.je.ZZd(vc));(-730106152===ib||-1228228458===ib)&&jb||za.EwaSettings.MQ()&&za.EwaSettings.Yoj()&&2045211913===ib&&this.fsj(Kc)||(this.t_k(xc,ib,ra,Kc),-730106152!==ib&&-1228228458!==
ib||this.$e.ena(xc,-730106152,{}),-1228228458!==ib&&2045211913!==ib&&-848953656!==ib||this.$e.Gvd(Kc,!0,ra),xc.Ce.LO(ra,fb.BasicTelemetryCalculator.zN))}}t_k(ib,xc,Kc,ra){let jb="";switch(xc){case -1228228458:jb="ClearAll";break;case 2045211913:case -848953656:jb="ClearContent";break;case -730106152:jb="ClearFormat";break;default:S.ULS.sendTraceTag(537167937,0,15,`ClearCommandHandler.StampTimeWithCompatibleDescription: Unexpected command ${xc}.`)}xc=ra.length;ra=ba.c(ra);ib.Ce.ML(15,Kc,jb+(", ranges to clear: "+
xc+", cells to clear: "+ra))}Tuj(){if(Ba.f(this.$).yC){const ib=this.$.ra.Tb(296);return!!ib&&ib.l1.cG}return!1}fsj(ib){return Gb.a.any(ib,xc=>{var Kc;const ra=Ba.f(this.$);for(let jb=xc.top;jb<=xc.bottom;jb++)for(let vc=xc.left;vc<=xc.right;vc++){const md=null===(Kc=ra.Ob(Mb.Range.Hc(jb,vc)))||void 0===Kc?void 0:Kc.cell;if(md&&md.inCellControlOptions&&0!==md.inCellControlOptions.Type)return!0}return!1})}};Sb=Object(C.__decorate)([Object(Ma.d)(mb.ClearCommandHandlerService),Object(C.__param)(0,Object(mb.EwaControlService)()),
Object(C.__param)(1,Object(mb.TableManagerService)()),Object(C.__param)(2,Object(mb.FormatCellsActionService)()),Object(C.__param)(3,Object(mb.ClearContentNotifierService)())],Sb);Object(X.a)(Sb,"ClearCommandHandler",Rb.a,[29]);var kc=a(373);let na=class extends Rb.a{wFb(ib){this.addHandler("ekcvc",ib)}q3b(ib){this.removeHandler("ekcvc",ib)}qik(){this.raiseEvent("ekcvc",new kc.a)}};na=Object(C.__decorate)([Object(Ma.d)(mb.ClearContentNotifierService)],na);Object(X.a)(na,"ClearContentNotifier",Rb.a,
[480]);var fc=a(124),Cc=a(76),tc=a(1659);class nb{}nb.mhl="utf-8";nb.YWi="GetOperationTimer";nb.afi="DeleteOperationTimer";nb.Bgl="UpsertOperationTimer";nb.Ddi=[tc.a.NamedRange,tc.a.Table,tc.a.PrintArea,tc.a.Others];nb.vOj=[0];nb.CDk=[0,1];Object(X.a)(nb,"ConstantsDefinedNameManager",null,[]);class tb extends Sys.EventArgs{constructor(ib,xc,Kc,ra){ra=void 0===ra?!1:ra;super();this.status=ib;this.operationType=xc;this.Htb=Kc;this.Asj=ra}}Object(X.a)(tb,"DefinedNameOperationEventArgs",Sys.EventArgs,
[]);var La=a(58);class wb{static create(ib){const xc=new wb;Object.assign(xc,ib);return La.a.Nc(xc)}}Object(X.a)(wb,"NameManagerTelemetryData",null,[]);class Wa{static Pz(ib,xc){(ib||xc)&&S.ULS.sendTraceTag(507581128,0,ib,xc)}static Kja(ib){switch(ib){case "success":return 50;case "successWithServerException":case "failure":return 10}}}Object(X.a)(Wa,"NameManagerTelemetry",null,[]);var Fa=a(28);const Da={namedrange:tc.a.NamedRange,table:tc.a.Table,others:tc.a.Others,print_area:tc.a.PrintArea},ja=
{global:0,local:1},Qa=[1546370075,472177316,-1818810228,-201732986],Ob={[0]:ib=>0===ib.scope,[1]:ib=>1===ib.scope,[2]:ib=>ib.isInvalidReference,[3]:ib=>!ib.isInvalidReference,[4]:ib=>ib.type===tc.a.NamedRange,[5]:ib=>ib.type===tc.a.Table},Ub=(ib,xc,Kc,ra,jb)=>{ib=Object.assign({},{method:`NameManagerUtils.${Kc}`,executionTime:xc-ib},ra&&{input_length:ra},jb&&{output_length:jb});S.ULS.sendTraceTag(507581578,0,50,La.a.Nc(ib))};class Zb{static dbj(ib,xc,Kc,ra,jb){return void 0===ra&&0!==(null===ib||
void 0===ib?void 0:ib.length)&&0!==(null===xc||void 0===xc?void 0:xc.length)?!0:ra&&ib&&xc&&jb?(jb=jb.find(vc=>vc.runtimeUid===ra))?(null===jb||void 0===jb?void 0:jb.name)!==ib||(null===jb||void 0===jb?void 0:jb.reference)!==xc||(null===jb||void 0===jb?void 0:jb.comment)!==Kc:!1:!1}static SVi(ib){return void 0!==ib?Da[ib.toLowerCase()]:null}static X_i(ib){return void 0!==ib?ja[ib.toLowerCase()]:null}static search(ib,xc){if(!ib||0===ib.length||!xc)return ib;const Kc=performance.now(),ra=ib.filter(vc=>
vc.name.toLowerCase().includes(xc.toLowerCase().trim())),jb=performance.now();Ub(Kc,jb,"search",ib.length,ra.length);return ra}static KOi(ib,xc){return null!==ib&&void 0!==ib&&ib.length&&null!==xc&&void 0!==xc&&0!==xc.length?ib.find(Kc=>Kc.runtimeUid===xc):null}static cTi(ib,xc){return null!==ib&&void 0!==ib&&ib.length&&null!==xc&&void 0!==xc&&0!==xc.length?ib.findIndex(Kc=>Kc.metadata.runtimeUid===xc):-1}static GYc(ib){return ib?Qa.includes(ib):!1}static gQi(ib){if(!ib||!ib.Htb||ib.status)return null;
const xc=[];let Kc;if(Zb.GYc(ib.Htb))switch(null===ib||void 0===ib?void 0:ib.Htb){case 472177316:xc.push({target:1,errorMessage:pa.a.instance.La(912)});break;case 1546370075:xc.push({target:0,errorMessage:pa.a.instance.La(911)});break;case -1818810228:Kc=pa.a.instance.La(1008);break;default:Kc=Zb.IHf(ib.operationType)}return{qgg:xc,s9b:Kc}}static IHf(ib){if(ib)switch(ib){case "add":return pa.a.instance.La(905);case "update":return pa.a.instance.La(906);case "delete":return pa.a.instance.La(907)}return null}static Vil(ib,
xc,Kc,ra,jb){const vc=[];let md;jb!==tc.a.Table&&(md=Zb.GVh(Kc,ib));ib=Zb.EVh(ra);xc=Zb.FVh(xc);md&&vc.push(md);ib&&vc.push(ib);xc&&vc.push(xc);return vc}static kOd(ib){return ib&&1===ib.length?ib[0].MessageId:null}static FVh(ib){let xc;var Kc;if(!(Kc=!ib||0===(null===ib||void 0===ib?void 0:ib.length)||255<(null===ib||void 0===ib?void 0:ib.length))){a:{for(Kc=0;Kc<ib.length;Kc++){const ra=ib.charAt(Kc),jb=ib.charCodeAt(Kc);if(!Kc){if("\\"!==ra&&"_"!==ra&&!Fa.a.isLetter(jb)){Kc=!1;break a}}else if("_"!==
ra&&"."!==ra&&!Fa.a.T1f(jb)&&!Fa.a.isNumeral(jb)){Kc=!1;break a}}Kc=!0}Kc=!Kc}if(Kc||Fa.a.MG(ib,"_xl"))xc=pa.a.instance.La(910);return xc?{target:0,errorMessage:xc}:null}static EVh(ib){let xc;255<(null===ib||void 0===ib?void 0:ib.length)&&(xc=pa.a.instance.La(914));return xc?{target:2,errorMessage:xc}:null}static GVh(ib,xc){if(ib&&0===ib.length)ib=pa.a.instance.La(912);else switch(xc(ib)){case "valid":return null;case "notFormulaString":ib=pa.a.instance.La(913);break;default:ib=pa.a.instance.La(912)}return{target:1,
errorMessage:ib}}static filterBy(ib,xc){if(!ib||0===ib.length||void 0===xc)return ib;const Kc=performance.now();xc=ib.filter(Ob[xc]);const ra=performance.now();Ub(Kc,ra,"filterBy",ib.length,xc.length);return xc}static Y4h(ib){const xc={[0]:0,[1]:0,[2]:0,[3]:0,[4]:0,[5]:0};if(!ib||0===ib.length)return xc;const Kc=performance.now();for(var ra of ib)for(const jb in Ob)Ob[jb](ra)&&xc[jb]++;ra=performance.now();Ub(Kc,ra,"countByFilter",ib.length);return xc}static groupBy(ib,xc,Kc){const ra={};xc.forEach(jb=>
{ra[jb]=[]});for(const jb of ib)ib=Kc(jb),ra[ib].push(jb);return ra}static nSi(ib){switch(ib){case 0:return{fQd:nb.Ddi,gQd:xc=>xc.type};case 1:return{fQd:nb.vOj,gQd:()=>0};case 2:return{fQd:nb.CDk,gQd:xc=>xc.scope}}}static sort(ib,xc){switch(xc){case 0:return ib.sort((Kc,ra)=>Kc.name.localeCompare(ra.name));case 1:return ib.sort((Kc,ra)=>ra.name.localeCompare(Kc.name))}}static eQd(ib,xc,Kc){if(!ib||0===ib.length||void 0===xc||void 0===Kc)return ib;const ra=performance.now(),{fQd:jb,gQd:vc}=Zb.nSi(xc),
md=Zb.groupBy(ib,jb,vc),Qd=[];jb.forEach(v=>{Qd.push(...Zb.sort(md[v],Kc))});xc=performance.now();Ub(ra,xc,"groupAndSortBy",ib.length,Qd.length);return Qd}static Z4h(ib){if(!ib)return null;const xc={};ib.forEach(Kc=>{const ra=Kc.scope;Kc=Kc.metadata.type;xc[ra]||(xc[ra]={});xc[ra][Kc]||(xc[ra][Kc]=0);xc[ra][Kc]++});return xc}}Object(X.a)(Zb,"NameManagerUtils",null,[]);let uc=class{constructor(ib,xc){var Kc;this.ub=new Rb.a;this.stateId=0;this.KWd=za.EwaSettings.kGc();this.R4e=ra=>{this.ub.addHandler("dnek",
ra)};this.H_d=ra=>this.Yd.H_d(ra);this.fg=()=>{var ra;const jb=null===(ra=this.$.fa.el)||void 0===ra?void 0:ra.NamedManagerResponseStateId;jb>this.stateId&&(this.stateId=jb,S.ULS.sendTraceTag(507639444,0,50,"DefinedNameManager.OnWorkbookMetadataChanged : Received a stateId change and Invoked GetDefinedNames API"),this.Rce(!0))};this.Rce=ra=>{this.JGa=this.$.Vb.Uc("WebServiceCall",nb.YWi);const jb=md=>{this.w7i(md,ra)},vc=md=>{var Qd,v;null===(Qd=this.JGa)||void 0===Qd?void 0:Qd.stop();md=fc.a.te(md.data);
md=Pa.a.pc(md);Qd=wb.create({operationType:"get",status:"failure",executionTime:null===(v=this.JGa)||void 0===v?void 0:v.Kc,error:md});Wa.Pz(Wa.Kja("failure"),Qd);this.cVa=null;this.raiseEvent("dnek",new tb(!1,"get",null,ra))};aa.a(this.$.userOperationManager,(md,Qd,v)=>{var Qb=this.$.ma.sa;md=db.c(md,jb);Qd=db.b(Qd,vc);var Dc=this.$;const id=Qb.$a(1,null);return Ha.h(Qb,"GetDefinedNames",id,md,Qd,v,Dc,0)},md=>new oa.a(1037,0,md,16),null)};this.raiseEvent=(ra,jb)=>{this.ub.raiseEvent(ra,jb)};this.upsertDefinedName=
(ra,jb,vc,md,Qd)=>{var v;this.Ywb=this.$.Vb.Uc("WebServiceCall",nb.Bgl);const Qb=Zb.cTi(null===(v=this.cVa)||void 0===v?void 0:v.nameManagerItems,md),Dc=Sd=>{this.Q$i(Sd,Qb,Qd)},id=Sd=>{var ne,Ce;null===(ne=this.Ywb)||void 0===ne?void 0:ne.stop();Sd=fc.a.te(Sd.data);Sd=Pa.a.pc(Sd);ne=wb.create({operationType:-1!==Qb?"update":"add",status:"failure",executionTime:null===(Ce=this.Ywb)||void 0===Ce?void 0:Ce.Kc,error:Sd,type:Qd});Wa.Pz(Wa.Kja("failure"),ne);this.raiseEvent("dnuek",new tb(!1,-1!==Qb?"update":
"add",null))},Md={Name:ra,Reference:jb,SheetName:"",Comment:vc,Type:Qd,RuntimeUid:md};aa.a(this.$.userOperationManager,(Sd,ne,Ce)=>{var Ge=this.$.ma.sa;Sd=db.c(Sd,Dc);ne=db.b(ne,id);var Ee=this.$;const Ue=Ge.$a(9,null);Ue.definedNameRequest=Md;return Ha.h(Ge,"UpsertDefinedName",Ue,Sd,ne,Ce,Ee,0)},Sd=>new oa.a(1035,0,Sd),null)};this.$=ib;this.Yd=xc;this.KWd&&(this.$.fa.au(this.fg),this.$.fa.el&&(this.stateId=null===(Kc=this.$.fa.el)||void 0===Kc?void 0:Kc.NamedManagerResponseStateId),this.Rce(!1))}EGh(ib){this.ub.addHandler("dnuek",
ib)}zDh(ib){this.ub.addHandler("dndok",ib)}luk(ib){this.ub.removeHandler("dnek",ib)}kvk(ib){this.ub.removeHandler("dnuek",ib)}ysk(ib){this.ub.removeHandler("dndok",ib)}au(){var ib;this.KWd||(this.$.fa.au(this.fg),this.$.fa.el&&(this.stateId=null===(ib=this.$.fa.el)||void 0===ib?void 0:ib.NamedManagerResponseStateId))}Bv(){this.KWd||this.$.fa.Bv(this.fg)}getItems(ib){return b(this.cVa,ib)}w7i(ib,xc){var Kc,ra,jb,vc,md,Qd,v,Qb,Dc;let id=!1,Md;try{if(ib&&!cc.a(ib)){const Sd=new Uint8Array(ib.Result),
ne=(new TextDecoder(nb.mhl)).decode(Sd.buffer);this.cVa=JSON.parse(ne);null===(Kc=this.JGa)||void 0===Kc?void 0:Kc.stop();id=!0;const Ce=wb.create({operationType:"get",status:"success",executionTime:null===(ra=this.JGa)||void 0===ra?void 0:ra.Kc,count:null===(vc=null===(jb=this.cVa)||void 0===jb?void 0:jb.nameManagerItems)||void 0===vc?void 0:vc.length,metadata:Zb.Z4h(null===(md=this.cVa)||void 0===md?void 0:md.nameManagerItems)});Wa.Pz(Wa.Kja("success"),Ce)}else{null===(Qd=this.JGa)||void 0===Qd?
void 0:Qd.stop();Md=Zb.kOd(null===ib||void 0===ib?void 0:ib.Errors);this.cVa=null;const Sd=wb.create({operationType:"get",status:"successWithServerException",executionTime:null===(v=this.JGa)||void 0===v?void 0:v.Kc,serverMessageId:Md.toString()});Wa.Pz(Wa.Kja("successWithServerException"),Sd)}}catch(Sd){this.cVa=null,null===(Qb=this.JGa)||void 0===Qb?void 0:Qb.stop(),ib=wb.create({operationType:"get",status:"failure",executionTime:null===(Dc=this.JGa)||void 0===Dc?void 0:Dc.Kc,error:"JsonParsingError"}),
Wa.Pz(Wa.Kja("failure"),ib)}this.raiseEvent("dnek",new tb(id,"get",Md,xc))}mtc(ib){this.Lfb=this.$.Vb.Uc("WebServiceCall",nb.afi);const xc=ra=>{this.x7i(ra,ib)},Kc=ra=>{var jb,vc;null===(jb=this.Lfb)||void 0===jb?void 0:jb.stop();ra=fc.a.te(ra.data);ra=Pa.a.pc(ra);jb=wb.create({operationType:"delete",status:"failure",executionTime:null===(vc=this.Lfb)||void 0===vc?void 0:vc.Kc,error:ra});Wa.Pz(Wa.Kja("failure"),jb);this.raiseEvent("dndok",new tb(!1,"delete",null))};aa.a(this.$.userOperationManager,
(ra,jb,vc)=>{var md=this.$.ma.sa;ra=db.c(ra,xc);jb=db.b(jb,Kc);var Qd=this.$;const v=md.$a(9,null);v.definedNameIds=ib;return Ha.h(md,"DeleteDefinedNames",v,ra,jb,vc,Qd,0)},ra=>new oa.a(1036,0,ra),null)}x7i(ib,xc){var Kc,ra,jb;let vc=!1,md;if(ib&&!cc.a(ib)&&xc){vc=!0;null===(Kc=this.Lfb)||void 0===Kc?void 0:Kc.stop();var Qd=wb.create({operationType:"delete",status:"success",executionTime:null===(ra=this.Lfb)||void 0===ra?void 0:ra.Kc,countOfNamesDeleted:xc.length});Wa.Pz(Wa.Kja("success"),Qd)}else md=
Zb.kOd(null===ib||void 0===ib?void 0:ib.Errors),null===(jb=this.Lfb)||void 0===jb?void 0:jb.stop(),Zb.GYc(md)&&Cc.a(this.$).Kd.oF(md),ra=wb.create({operationType:"delete",status:"successWithServerException",executionTime:null===(Qd=this.Lfb)||void 0===Qd?void 0:Qd.Kc,serverMessageId:md.toString(),countOfNamesDeleted:xc.length}),Wa.Pz(Wa.Kja("successWithServerException"),ra);this.raiseEvent("dndok",new tb(vc,"delete",md))}Q$i(ib,xc,Kc){var ra,jb,vc;let md=!1,Qd;if(ib&&!cc.a(ib)){md=!0;null===(ra=this.Ywb)||
void 0===ra?void 0:ra.stop();var v=wb.create({operationType:-1!==xc?"update":"add",status:"success",executionTime:null===(jb=this.Ywb)||void 0===jb?void 0:jb.Kc,type:Kc});Wa.Pz(Wa.Kja("success"),v)}else null===(vc=this.Ywb)||void 0===vc?void 0:vc.stop(),Qd=Zb.kOd(null===ib||void 0===ib?void 0:ib.Errors),Zb.GYc(Qd)&&Cc.a(this.$).Kd.oF(Qd),Kc=wb.create({operationType:-1!==xc?"update":"add",status:"successWithServerException",type:Kc,executionTime:null===(v=this.Ywb)||void 0===v?void 0:v.Kc,serverMessageId:Qd.toString()}),
Wa.Pz(Wa.Kja("successWithServerException"),Kc);this.raiseEvent("dnuek",new tb(md,-1!==xc?"update":"add",Qd))}};uc=Object(C.__decorate)([Object(Ma.d)(mb.DefinedNameManagerService),Object(C.__param)(0,Object(mb.EwaControlService)()),Object(C.__param)(1,Object(mb.CalcManagerService)())],uc);Object(X.a)(uc,"DefinedNameManager",null,[479]);var Hc=a(6),Dd=a(135),jc=a(52),$c=a(12),ud=a(238);class Ud{}Ud.HTML='<div id="WACDialogRow" class="WACDialogRow">\r\n\t\t\t\t\t<div id="WACDialogIconPanel" class="WACDialogIconPanel"></div>\r\n\t\t\t\t\t<div id="WACDialogTextPanel" class="WACDialogTextPanel" style="padding-right: 30px;">\r\n\t\t\t\t\t\t<div id="WACDialogErrorMessage"></div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorReportMessage"> </div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorTextPrompt" ></div> \r\n\t\t\t\t\t\t<textarea id="WACDialogInput" class="WACDialogInput" rows="5" style="margin-bottom: 10px; margin-top: 9px; overflow: auto;" maxlength="256"></textarea>\r\n\t\t\t\t\t\t<div id = "WACDialogSendFileCheckboxContainer" class="WACDialogRow" >\r\n\t\t\t\t\t\t<input type="checkbox" id="WACDialogSendFileCheckbox">\r\n\t\t\t\t\t\t<span id="WACDialogSendFileCheckboxText">text</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<a id="WACDialogPrivacyText"> </a> \r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>';
Object(X.a)(Ud,"FileUploadDialogHTML",null,[]);var ec=a(165),Db=a(26),ic=a(24);class Pc extends ud.a{constructor(ib){super(!1,!1,Pc.U4);this.m4d=!1;this.kdg=!0;this.pcg=0;this.eCj=(xc,Kc)=>{const ra=Kc[Pc.utd]||"";let jb=!0;void 0!==Kc[Pc.yoc]&&null!==Kc[Pc.yoc]&&(jb=Kc[Pc.yoc]);this.ty(xc,ra,jb)};this.Mfe=(xc,Kc)=>{this.ty(xc,Kc.text||"",Kc.reportErrorChecked)};this.e3j=xc=>{Hc.AFrameworkApplication.Kb.pe(Db.a.U1b,2,xc)};this.hc=1;this.Ic(1,Object(ic.a)("Send"));this.Ic(0,Object(ic.a)("NoThanks"));
this.wj=Ud.HTML;this.gcg=ib;this.uf=Pc.JSh}Wi(ib,xc,Kc,ra,jb){jb=void 0===jb?!0:jb;this.m4d=void 0===ra?!1:ra;this.SUk(xc);this.pcg=ib;jb&&Hc.AFrameworkApplication.Wy(ib)}SUk(ib){if(Pc.U4)this.RWk(ib);else{var xc={};xc[Pc.FSh]=ib;xc[Pc.LSh]=Object(ic.a)("SendFileErrorReportMessage");xc[Pc.MSh]=Object(ic.a)("SendFileErrorReportTextCaption");xc[Pc.utd]="";xc[Pc.ISh]=Object(ic.a)("UserReportLinkText");xc[Pc.yoc]=!0;this.initializeAndShow(Object(ic.a)("DefaultDialogTitle"),this.eCj,xc);this.ifa(Pc.SSh)}}RWk(ib){ib=
{["id"]:this.uf,["bodyControls"]:{["reportErrorCheckboxProps"]:this.m4d?{["label"]:Object(ic.a)("UserReportLinkText")}:null,["textAreaProps"]:this.kdg?{}:null,["privacyStatementLinkProps"]:{["text"]:Object(ic.a)("PrivacyStatement"),["handler"]:{["href"]:Hc.AFrameworkApplication.privacyUrl,["target"]:"_blank"}}},["errorMessage"]:ib,["errorReportMessage"]:Object(ic.a)("SendFileErrorReportMessage"),["errorTextPrompt"]:Object(ic.a)("SendFileErrorReportTextCaption")};this.initializeAndShow(Object(ic.a)("DefaultDialogTitle"),
this.Mfe,ib)}lOc(){if(!Pc.U4){var ib=document.getElementById(Pc.OSh);ib&&(ib.className=Pc.NSh,ib.appendChild(ec.a(32,32,Pc.KSh,null,!0,Object(ic.a)("DialogError"))));if(ib=document.getElementById(Pc.QSh))ib.innerText=Object(ic.a)("PrivacyStatement"),ib.href=Hc.AFrameworkApplication.privacyUrl,jc.a.addHandler(ib,"click",this.e3j);this.kdg||(ib=document.getElementById(Pc.utd))&&ib.parentNode&&ib.parentNode.removeChild(ib);this.m4d||(ib=document.getElementById(Pc.HSh))&&ib.parentNode&&ib.parentNode.removeChild(ib)}}IO(){Pc.U4||
(super.IO(),document.getElementById(this.qj("WACDialogPanel")).style.width=String.format("{0}px",400))}ty(ib,xc,Kc){this.gcg&&(Kc&&S.ULS.sendTraceTag(5768786,306,50,"Error Report sent for errorCode:{0}",this.pcg),this.gcg(ib,xc,Kc))}get nba(){return!1}static get U4(){return Hc.AFrameworkApplication.ua.Ab.HN&&Hc.AFrameworkApplication.ua.Ab.uvj}}Pc.FSh="WACDialogErrorMessage";Pc.LSh="WACDialogErrorReportMessage";Pc.MSh="WACDialogErrorTextPrompt";Pc.utd="WACDialogInput";Pc.QSh="WACDialogPrivacyText";
Pc.OSh="WACDialogIconPanel";Pc.KSh="CancelRequest_32x32x32";Pc.NSh="WACDialogIcon";Pc.SSh="WACDialogTextPanel";Pc.yoc="WACDialogSendFileCheckbox";Pc.HSh="WACDialogSendFileCheckboxContainer";Pc.ISh="WACDialogSendFileCheckboxText";Pc.JSh="FileUploadErrorDialog";Object(X.a)(Pc,"FileUploadErrorDialog",ud.a,[]);var Ed;let de=Ed=class extends Rb.a{constructor(ib){super();this.$=ib;this.yzg=0;this.$H=null;this.Dqk=xc=>{this.lsk(xc)};this.F_h=(xc,Kc)=>{if(1===xc&&this.$H.FileCollectionErrorStateId){xc=this.$.ma.sa;
var ra=this.$H.MessageId,jb=this.$H.OriginalEcsServerId,vc=this.$H.FileCollectionErrorStateId;const md=xc.$a(0);md.errorMessageId=ra;md.ecsServerId=jb;md.fileCollectionErrorStateId=vc;md.userComment=Kc;xc.Otd("CollectFile",md,null,null,null,null,0)}this.raiseEvent("fileCollectionComplete",null,this)}}lDh(ib){this.addHandler("fileCollectionComplete",ib)}lsk(ib){this.removeHandler("fileCollectionComplete",ib)}E_h(ib,xc,Kc){this.yzg=xc;this.$H=ib;this.lDh(Kc);Hc.AFrameworkApplication.privacyUrl=this.$.workbookContext.FullDocumentInfo.PrivacyUrl;
ib=new Pc(this.F_h);Hc.AFrameworkApplication.Kb.jc(Db.a.U1b,Dd.a.frame,Ed.Hfk);ib.Wi(0,"",null,!1,!1)}static Hfk(ib,xc,Kc,ra,jb){jc.a.gw(jb);Hc.AFrameworkApplication.privacyUrl&&$c.HelperMethods.Rg(Hc.AFrameworkApplication.privacyUrl,void 0,void 0,"FileCollectionOperation.PrivacyUrl");return 32}};de=Ed=Object(C.__decorate)([Object(Ma.d)(mb.FileCollectionOperationService),Object(C.__param)(0,Object(mb.EwaControlService)()),Object(C.__param)(1,Object(mb.CommonUIStringsService)())],de);Object(X.a)(de,
"FileCollectionOperation",Rb.a,[478,4]);var se=a(72);let Fe=class extends Va.a{constructor(ib,xc,Kc,ra){super();this.Lf=null;this.Hd=()=>{this.button.getButton(this.Lf.Ug.paneType).Mqb();ia.a.sendTelemetryEvent({name:"Office.Excel.Online.OnObjectUI.ButtonPressed",dataFields:Ca.a.Eh({["buttonType"]:"FloatingObjectToCellImage"})});const jb=new Ga.a(-700002548,fa.a.Hb,this.$.xc,9,null);this.$.Ia.Gb(jb,null)};this.nB=()=>{this.p4()};this.Jlg=()=>{this.Hvb()};this.ePc=()=>{this.Hvb()};this.jPc=()=>{this.Hvb()};
this.Mog=()=>{this.Hvb()};this.z_b=()=>{this.Hvb()};this.Oog=()=>{this.Hvb()};this.ilg=()=>{this.p4()};this.qk=()=>{this.p4()};this.yt=()=>{this.p4()};this.rm=()=>{this.p4()};this.vv=()=>{this.p4()};this.$=ib;this.isVisible=!1;this.button=Kc.pKb(ib,xc,this.Hd,null,null,pa.a.instance.ia(2319),"FloatingObjectToCellImagePointerDown");this.da=Ba.f(this.$);za.EwaSettings.isChangeGateEnabled("OfficeVSO:8726712_MoveGridViewContentReadyToCtor")&&this.da.aw(this.nB);this.$.DD(this.qk);za.EwaSettings.isChangeGateEnabled("OfficeVSO:8726584_DisablePictureOOUIForViewMode")&&
this.$.fa.CD(this.vv);this.da.view.Ks(this.yt);this.da.ha.ob.pF(this.rm);this.ariaLiveNotifier=ra}dispose(){this.da&&(this.da.view.xs(this.yt),this.da.ha.ob.yL(this.rm));this.$&&(this.$.vG(this.qk),za.EwaSettings.isChangeGateEnabled("OfficeVSO:8726584_DisablePictureOOUIForViewMode")&&this.$.fa.xB(this.vv));this.button.dispose();this.$=this.da=this.button=null;super.dispose()}fmd(){this.isVisible&&this.Hd(null,null)}p4(){if(za.EwaSettings.isChangeGateEnabled("OfficeVSO:8726584_DisablePictureOOUIForViewMode")&&
!this.$.isEditMode)this.zQ();else{var ib=this.da.ha.ob;if(ib.isFloatingObjectSelected&&1===ib.Wb.floatingObject.type)if(za.EwaSettings.isChangeGateEnabled("OfficeVSO:8861794_DisablePlaceInCellWhenInCropMode")&&ib.Wb.floatingObject.KQ&&ib.Wb.isEditing)this.zQ();else{if(za.EwaSettings.isChangeGateEnabled("OfficeVSO:8495249_DisableOOUIOnProtectedSheet")){const xc=new kb.SheetProtection(this.$.qa);if(xc&&xc.Ih){this.zQ();return}}null!==this.Lf&&this.WFg(this.Lf);this.Lf=ib.Wb;this.cna()}else this.zQ()}}cna(){const ib=
this.Lf.Ug.ul,xc=this.Lf.floatingObject;this.xzh(this.Lf);let Kc=xc.OW+this.toc,ra=xc.Wv,jb=0;var vc=0;switch(this.Lf.Ug.paneType){case 3:jb=this.da.rb.Lu;vc=this.da.rb.Wv-this.da.Nn.y;break;case 4:jb=this.da.rb.Lu-this.da.Nn.x;vc=this.da.rb.Wv;break;case 1:jb=this.da.rb.Lu;vc=this.da.rb.Wv;break;case 2:jb=this.da.rb.Lu-this.da.Nn.x,vc=this.da.rb.Wv-this.da.Nn.y}Kc-=jb;ra-=vc;vc=new se.a(xc.Lu-jb,ra,xc.width,xc.height);Kc+this.button.buttonWidth>ib.bottomRight.x&&(Kc=xc.Lu-jb-this.toc-this.button.buttonWidth);
ra<ib.topLeft.y+this.toc&&(ra=ib.topLeft.y+this.toc);4===this.da.ha.gf&&ib.ld(vc)&&ib.width>xc.width?this.Xo(Kc,ra,this.da.rtl,this.Lf.Ug.paneType,!0):this.zQ()}Xo(ib,xc,Kc,ra,jb){za.EwaSettings.isChangeGateEnabled("OfficeVSO:8726712_MoveGridViewContentReadyToCtor")||this.da.aw(this.nB);this.button.Y2c(ta.a.ebk,pa.a.instance.ia(2319),ra);za.EwaSettings.isChangeGateEnabled("OfficeVSO:8352230_UpdateDivTitleForSVGLaunchButtonOOUI")&&this.button.x2c(pa.a.instance.ia(2319),ra);this.button.Xo(ib,xc,Kc,
ra,!1,jb);this.isVisible=!0;this.VIh()}zQ(){this.da.Zz(this.nB);null!==this.Lf&&(this.WFg(this.Lf),this.Lf=null);this.button.hide();this.isVisible=!1}Hvb(){this.button.hide();this.isVisible=!1}VIh(){let ib;ib=Z.a.isMac?pa.a.instance.ia(2323):pa.a.instance.ia(2322);this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.L3(ib)}get toc(){return this.button.uIb}xzh(ib){var xc,Kc,ra,jb,vc,md;za.EwaSettings.isChangeGateEnabled("OfficeVSO:8861794_DisablePlaceInCellWhenInCropMode")&&ib.a4e(this.ilg);
if(ib=ib.extension)null===(xc=ib.b7)||void 0===xc?void 0:xc.g4e(this.Jlg),null===(Kc=ib.Isb)||void 0===Kc?void 0:Kc.Xod(this.ePc),null===(ra=ib.SLg)||void 0===ra?void 0:ra.WFh(this.jPc),null===(jb=ib.VK)||void 0===jb?void 0:jb.zod(this.z_b),null===(vc=ib.VK)||void 0===vc?void 0:vc.AEh(this.Mog),null===(md=ib.VK)||void 0===md?void 0:md.DEh(this.Oog)}WFg(ib){var xc,Kc,ra,jb,vc,md;za.EwaSettings.isChangeGateEnabled("OfficeVSO:8861794_DisablePlaceInCellWhenInCropMode")&&ib.XGg(this.ilg);if(ib=ib.extension)null===
(xc=ib.b7)||void 0===xc?void 0:xc.cHg(this.Jlg),null===(Kc=ib.Isb)||void 0===Kc?void 0:Kc.EHg(this.ePc),null===(ra=ib.SLg)||void 0===ra?void 0:ra.Euk(this.jPc),null===(jb=ib.VK)||void 0===jb?void 0:jb.Lie(this.z_b),null===(vc=ib.VK)||void 0===vc?void 0:vc.ttk(this.Mog),null===(md=ib.VK)||void 0===md?void 0:md.wtk(this.Oog)}};Fe=Object(C.__decorate)([Object(Ma.d)(mb.FloatingObjectToCellImageService),Object(C.__param)(0,Object(mb.EwaControlService)()),Object(C.__param)(1,Object(xa.h)()),Object(C.__param)(2,
Object(mb.SharedUIControlsFactoryService)()),Object(C.__param)(3,Object(mb.AriaLiveNotifierService)())],Fe);Object(X.a)(Fe,"FloatingObjectToCellImageController",Va.a,[]);var fe=a(493),Tc=a(437),ed=a(32),pd=a(640),Kb=a(599),rb=a(1343);a(225);var rc=a(29);Object(Ma.b)(mb.FontDropdownHelperService,{we:"singleton"})(async ib=>{const xc=await Ma.a.resolve(mb.EwaControlService,ib);ib=!za.EwaSettings.isChangeGateEnabled("OfficeVSO:8838479_RemoveOldFSImplementation")&&rc.a.Hf()?await Ma.a.resolve(mb.FontServiceManagerService,
ib):null;return new ld(xc,ib)});class ld{constructor(ib,xc){this.$=ib;this.jv=xc;this.menuId=this.ltd=this.d$=this.bta=null;this.YHd=0;this.jMj="+mn-lt";this.VIj="+mj-lt";this.$Oc=Kc=>{this.qVb=!0;this.$.kY(ra=>{ra.Rqb("FontName_New")});S.ULS.sendTraceTag(520710160,1,15,`PreviewFont Status is ${Kc}`)};this.Wmj=!!String.fromCodePoint&&!!window.gridRenderer&&gridRenderer.CanvasRendererGlobals.isFontLoadApiSupported();this.qVb=!1;this.da=Ba.f(this.$);this.Hf=!za.EwaSettings.isChangeGateEnabled("OfficeVSO:8838479_RemoveOldFSImplementation")&&
rc.a.Hf();this.x2f=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NewDefaultTemplate",!1);this.Hf&&this.jv&&(this.jv.Gqj?this.zQg():this.jv.Qzc(()=>{this.zQg()}))}get Kq(){this.RB||(this.RB=Ma.a.Cb(mb.ThemesManagerService));return this.RB}zQg(){this.d$=this.jv.j0g;this.bta=this.jv.XDi;this.YHd=2;this.qVb=this.jv.qVb}get j0g(){return this.d$}CEf(ib,xc,Kc,ra){ra=void 0===ra?null:ra;const jb=Object.assign(new fe.a,{Id:"FontDropdownMenu"});jb.MenuSectionList=[];this.Kq&&(this.Kq.CFa(ra),
ra=Object.assign(new Tc.a,{ControlsId:"ThemeFontsMenuSectionControl",Title:pa.a.instance.ia(1337),ControlList:this.V2i(ib,xc,Kc)}),jb.MenuSectionList.push(ra));ra=Object.assign(new Tc.a,{ControlsId:"FontsMenuSectionControl"});ra.Title=pa.a.instance.ia(1338);ra.ControlList=this.rRi(ib,xc,Kc);jb.MenuSectionList.push(ra);return jb}V2i(ib,xc,Kc){var ra;const jb=[];var vc=this.da.ha.ob.Wb;vc=5===(null===(ra=null===vc||void 0===vc?void 0:vc.floatingObject)||void 0===ra?void 0:ra.type);let md,Qd;this.Kq.Ot?
(md=this.Kq.Ot.W5d,Qd=this.Kq.Ot.K4d):S.ULS.sendTraceTag(520710165,1,15,"ThemeFonts are Null");(ra=this.Qlf(Qd,1,vc,ib,xc,Kc))&&jb.push(ra);(ib=this.Qlf(md,2,vc,ib,xc,Kc))&&jb.push(ib);return jb}Qlf(ib,xc,Kc,ra,jb,vc){var md=2===xc?this.jMj:this.VIj;let Qd;ib?(Kc=Kc?md:ed.a.Ig(ib),md=ed.a.Ig($c.HelperMethods.KQb(ib,xc)),Qd=ed.a.Ig(ib)):(Kc=Kc?md:void 0,md=ed.a.Ig(String.fromCodePoint(0)),Qd="msofp");return Object.assign(new pd.a,{MenuItemId:2===xc?rb.b:rb.a,CommandValueId:Kc,LabelText:md,LabelCss:String.format("font-size:12pt;font-family:{0};",
Qd),Styles:ld.lQb(Qd),AriaLabel:md,Alt:md,Command:ra.toString(),CommandPreviewId:jb.toString(),CommandRevertId:vc.toString(),Disabled:!ib})}rRi(ib,xc,Kc){if(this.ltd)return this.ltd.JAd;let ra;const jb=$c.HelperMethods.iG(()=>{const vc=this.Wmj&&!this.qVb;let md=!1;this.bta||(this.ZWf(),md=!0,S.ULS.sendTraceTag(509654348,1,15,"FontDropdownHelper.getFontButtonsForMenuSection: fontCodepointMap is Null. Initialize with old Font Dictionary."));ra=this.jkf(ib,xc,Kc,this.bta,vc,md);ra.FYc&&!md&&(S.ULS.sendTraceTag(520710162,
1,15,"FontDropdownHelper.getFontButtonsForMenuSection: ddEntries is Null. Fallback to old Font Dictionary."),this.ZWf(),ra=this.jkf(ib,xc,Kc,this.bta,vc,ra.FYc));this.Hf&&!ra.FYc&&(this.ltd=ra);vc&&!this.Hf&&gridRenderer.CanvasRendererGlobals.loadPreviewFont(this.$Oc)});10<jb&&S.ULS.sendTraceTag(512340117,1,50,`FontDropdownHelper.getFontButtonsForMenuSection: Duration for getFontButtonsForMenuSection, duration=${jb}`);return ra.JAd}jkf(ib,xc,Kc,ra,jb,vc){const md=[];let Qd;const v=this.Hf&&!vc;Qd=
v?"msofpNew":this.x2f?"msofp_v4_29":"msofp";for(const Sd in ra){var Qb=Sd,Dc=ra[Sd],id=ed.a.Ig(Qb),Md=void 0;if(v)if(Md=this.d$?this.d$[Qb]:null)Md=ed.a.Ig(Md);else return S.ULS.sendTraceTag(520710161,1,15,`FontDropdownHelper.getFontButtonsForMenuSection: localizedFontName in supportedFontFamiliesNew is not found for ${Qb}`),{FYc:!0,JAd:[]};else Md=ed.a.Ig($c.HelperMethods.d$[Qb]);Qb=ed.a.Ig(Qb);jb||(Dc=0);id=Object.assign(new pd.a,{MenuItemId:id,CommandValueId:id,LabelText:jb&&0<Dc?ed.a.Ig(String.fromCodePoint(Dc)):
Md,LabelCss:String.format("font-size:12pt;font-family:{0};",jb&&0<Dc?Qd:Qb),Styles:ld.lQb(jb&&0<Dc?Qd:Qb),AriaLabel:Md,Alt:Md,Command:ib.toString(),CommandPreviewId:xc.toString(),CommandRevertId:Kc.toString()});md.push(id)}return{FYc:vc,JAd:md}}gLk(ib){this.menuId=ib}Iqj(){return 2!==this.YHd&&3!==this.YHd?!1:!0}ZWf(){this.x2f?(this.bta={["Angsana New"]:983051,["Aptos Display"]:983056,["Aptos Narrow"]:983060,["Arial Black"]:983065,["Arial"]:983064,["Batang"]:983087,["Book Antiqua"]:983104,["Browallia New"]:983109,
["Calibri"]:983112,["Cambria"]:983116,["Candara"]:983118,["Century"]:983121,["Comic Sans MS"]:983128,["Consolas"]:983134,["Constantia"]:983135,["Corbel"]:983139,["Cordia New"]:983140,["Courier New"]:983142,["DilleniaUPC"]:983153,["Dotum"]:983155,["FangSong"]:983175,["Garamond"]:983193,["Georgia"]:983195,["Gulim"]:983222,["GungSuh"]:983226,["KaiTi"]:983263,["JasmineUPC"]:983258,["Malgun Gothic"]:983302,["Mangal"]:983306,["Meiryo"]:983309,["Microsoft JhengHei"]:983317,["Microsoft YaHei"]:983329,["MingLiU"]:983337,
["MingLiU_HKSCS"]:983341,["MS Gothic"]:983290,["MS Mincho"]:983292,["MS PGothic"]:983294,["MS PMincho"]:983296,["PMingliU"]:983372,["PMingLiU-ExtB"]:983374,["SimHei"]:983441,["SimSun"]:983443,["SimSun-ExtB"]:983445,["Source Sans Pro"]:983464,["Tahoma"]:983472,["THSarabunPSK"]:983471,["Times New Roman"]:983484,["Trebuchet MS"]:983495,["Verdana"]:983519,["Yu Gothic"]:983540,["Yu Mincho"]:983550},Kb.a.okb('@font-face{font-family:"msofp_v4_29";font-style:normal;font-weight:normal;src:url("https://fs.microsoft.com/fs/4.35/flat_officeFontsPreview.ttf") format(\'truetype\')}')):
this.bta={["Angsana New"]:983046,["Arial Black"]:983051,["Arial"]:983050,["Batang"]:983061,["Book Antiqua"]:983077,["Browallia New"]:983082,["Calibri"]:983085,["Cambria"]:983089,["Candara"]:983091,["Century"]:983095,["Comic Sans MS"]:983100,["Consolas"]:983101,["Constantia"]:983102,["Corbel"]:983106,["Cordia New"]:983107,["Courier New"]:983109,["DilleniaUPC"]:983121,["Dotum"]:983123,["FangSong"]:983138,["Garamond"]:983154,["Georgia"]:983156,["Gulim"]:983182,["GungSuh"]:983186,["KaiTi"]:983222,["JasmineUPC"]:983218,
["Malgun Gothic"]:983258,["Mangal"]:983262,["Meiryo"]:983264,["Microsoft JhengHei"]:983272,["Microsoft YaHei"]:983284,["MingLiU"]:983292,["MingLiU_HKSCS"]:983296,["MS Gothic"]:983245,["MS Mincho"]:983247,["MS PGothic"]:983249,["MS PMincho"]:983251,["PMingliU"]:983322,["PMingLiU-ExtB"]:983324,["SimHei"]:983382,["SimSun"]:983384,["SimSun-ExtB"]:983386,["Source Sans Pro"]:983396,["Tahoma"]:983405,["THSarabunPSK"]:983404,["Times New Roman"]:983415,["Trebuchet MS"]:983419,["Verdana"]:983443,["Yu Gothic"]:983464,
["Yu Mincho"]:983474}}static lQb(ib){const xc={};xc["font-family"]=ib;xc["font-size"]="12pt";ib={};ib.optionText=xc;return ib}}Object(X.a)(ld,"FontDropdownHelper",null,[477]);var Tb;(function(ib){ib[ib.FormatCellsListView=0]="FormatCellsListView";ib[ib.NumberFormatItemView=1]="NumberFormatItemView";ib[ib.AlignmentItemView=2]="AlignmentItemView";ib[ib.FontItemView=3]="FontItemView";ib[ib.BorderItemView=4]="BorderItemView"})(Tb||(Tb={}));var Wc;(function(ib){ib[ib.General=0]="General";ib[ib.Number=
1]="Number";ib[ib.Currency=2]="Currency";ib[ib.Accounting=3]="Accounting";ib[ib.Date=4]="Date";ib[ib.Time=5]="Time";ib[ib.Percentage=6]="Percentage";ib[ib.Fraction=7]="Fraction";ib[ib.Scientific=8]="Scientific";ib[ib.Text=9]="Text";ib[ib.Special=10]="Special";ib[ib.Custom=11]="Custom"})(Wc||(Wc={}));var Ac=a(10),nd=a(210),qd=a(1588);Object(qd.isChangeGateEnabled)("OfficeVSO:8756610_UserBrowserPerformanceAPI");class Xd{constructor(ib,xc,Kc){this.GD=!1;this.vZa=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8611831_FixEditingUxOnAlignment");
this.ZF=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8586390_FloatingObjectFormatCellsCentralFix");this.BTb=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8837194_ScopePollForStateAndUpdateToPane");this.txa=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8916750_RegisterPaneEventSeperately");this.zt=()=>{this.dispose()};this.jL=()=>{this.Bi()};this.onActiveCellChanged=(ra,jb)=>{jb&&jb.description===Tb[Tb.AlignmentItemView]&&this.IMa()};this.rm=(ra,jb)=>{jb&&jb.pId===Tb.AlignmentItemView&&(this.ZF?0!==
(jb.gf&470)?this.jf.WR(Tb.AlignmentItemView,null):this.IMa():this.jf.WR(Tb.AlignmentItemView,null,!0))};this.rr=(ra,jb)=>{jb&&jb.description===Tb[Tb.AlignmentItemView]&&this.IMa()};this.vNc=(ra,jb)=>{jb&&jb.description===Tb[Tb.AlignmentItemView]&&(this.BTb?this.jf.xxg():this.reactRibbonRoot.Oh(),this.IMa())};this.$=ib;this.properties=xc;this.fc=Kc;this.jf=xd.JPb(this.$,this.properties,this.fc);this.alignmentModel={horizontalAlignmentType:0,verticalAlignmentType:0,readingOrderType:0,isJustifyDistributed:!1,
indent:0,orientation:0,isWrapText:!1,isShrinkToFit:!1,isMergeCells:!1,isMergeCellsDisabled:!1,isFlipVertical:!1,disableAllControls:!1};this.rDf={};this.vZa&&!this.BTb&&(this.reactRibbonRoot=ib.ra.Tb(337,!0))}static getInstance(ib,xc,Kc){return this.Wa||(this.Wa=new this(ib,xc,Kc))}IMa(){var ib;this.txa&&(this.GD||this.Aj());const xc=Ba.f(this.$),Kc=null===(ib=xc.Ob(xc.ha.oa.activeCell))||void 0===ib?void 0:ib.cell;Kc?(c("AlignmentTab::Update::Start"),this.alignmentModel.horizontalAlignmentType=Kc.oG,
this.alignmentModel.verticalAlignmentType=Kc.verticalAlignment,this.alignmentModel.isJustifyDistributed=8===Kc.oG?!0:!1,this.alignmentModel.indent=Kc.indentation||0,this.alignmentModel.isWrapText=Kc.mA,this.alignmentModel.isShrinkToFit=Kc.G7b,this.alignmentModel.isMergeCells=Kc.eB,this.alignmentModel.isMergeCellsDisabled=nd.c(xc),this.alignmentModel.readingOrderType=Kc.CSc,this.vZa&&(this.alignmentModel.disableAllControls=xc.Rb.isEditing),za.EwaSettings.isChangeGateEnabled("OfficeVSO:8475627_FixVerticalTextOrientation")?
(this.alignmentModel.orientation=Kc.UIc?0:Kc.gA||0,this.alignmentModel.isFlipVertical=Kc.UIc):(this.alignmentModel.orientation=Kc.gA||0,this.alignmentModel.isFlipVertical=this.alignmentModel.orientation===Ac.a.verticalText?!0:!1),this.ddl(this.alignmentModel)):S.ULS.sendTraceTag(507250317,0,50,"activeCellGridProxy is not available. Alignment Task Pane will not be shown/updated.")}ddl(ib){this.rDf.alignmentModel=ib;this.jf.WR(Tb.AlignmentItemView,this.rDf);this.txa||this.GD||this.Aj()}Gb(ib,xc){c("AlignmentTab::CmdUpdate::Start");
xc=Object.assign({},xc);xc.ShouldCanvasTakeFocus=!1;this.$.Dc(ib,fa.a.Hb,12,xc);S.ULS.sendTraceTag(508389411,0,50,`Ribbon command called from Alignment Task Pane: ${ib}`)}Zze(ib){switch(ib){case 0:this.Zze(this.alignmentModel.horizontalAlignmentType);break;case 1:this.Gb(-1150205178,null);break;case 2:this.Gb(-1142465846,null);break;case 3:this.Gb(-286432209,null);break;case 6:this.Gb(2007171328,null)}}ota(){return{onHorizontalAlignmentChange:ib=>{this.alignmentModel.horizontalAlignmentType!==ib&&
this.Zze(ib)},onVerticalAlignmentChange:ib=>{switch(ib){case 0:this.Gb(-394785302,null);break;case 1:this.Gb(1041132226,null);break;case 2:this.Gb(-571165336,null)}},justifyDistributed:ib=>{ib&&this.Zze(8)},onTextDirectionChange:()=>{},onIndentationChange:ib=>{const xc=this.alignmentModel.indent;this.Gb(ib>xc?-1942512156:-1920201820,{Indentation:ib-xc});this.IMa()},onOrientationChange:ib=>{this.Gb(-1220714308,{Orientation:ib});this.IMa()},wrapText:()=>{this.Gb(-1116189897,null)},mergeCells:ib=>{this.Gb(ib?
1097660126:155820588,null)},flipVertical:()=>{this.Gb(-1526602249,null)}}}dispose(){this.Bi();this.jf.$Tc(this.zt);Xd.Wa=null}Aj(){this.jf.DFb(this.jL);this.jf.CFb(this.zt);this.jf.add_activeCellChanged(this.onActiveCellChanged);this.jf.pF(this.rm);this.jf.Alc(this.rr);this.vZa&&(this.jf.$Ch(this.vNc),this.jf.ZCh(this.vNc));this.GD=!0;S.ULS.sendTraceTag(508355650,0,50,"AlignmentViewModel events registered")}Bi(){this.jf.u3b(this.jL);this.jf.remove_activeCellChanged(this.onActiveCellChanged);this.jf.yL(this.rm);
this.jf.gUc(this.rr);this.vZa&&(this.jf.bsk(this.vNc),this.jf.ask(this.vNc));this.GD=!1;S.ULS.sendTraceTag(508355649,0,50,"AlignmentViewModel events Unregistered")}}Object(X.a)(Xd,"AlignmentTaskPaneManager",null,[4]);var Hd=a(179),Zc=a(1483);class Jc{constructor(ib,xc){this.ZF=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8586390_FloatingObjectFormatCellsCentralFix");this.$=xc;this.jf=ib}showTaskPane(ib,xc,Kc){rc.a.Fj()?void Ma.a.resolve(mb.ReactTaskPaneManagerService,{xa:0}).then(ra=>{ra.PC("FormatCellsTaskPane",
this.yl(ib,xc,Kc),`FormatCells:${Tb[ib]}`)}):void Hd.a.li().then(ra=>{const jb=this.$.Vb.Uc("UserAction",`OpenTaskPane:FormatCells:${Tb[ib]}`);ra.showTaskPane("FormatCellsTaskPane",this.yl(ib,xc,Kc));jb.stop();return null})}updateTaskPane(ib,xc,Kc){rc.a.Fj()?void Ma.a.resolve(mb.ReactTaskPaneManagerService,{xa:0}).then(ra=>{ra.updateTaskPane("FormatCellsTaskPane",this.yl(ib,xc,Kc),`FormatCells:${Tb[ib]}`)}):void Hd.a.li().then(ra=>{const jb=this.$.Vb.Uc("UserAction",`UpdateTaskPane:FormatCells:${Tb[ib]}`);
ra.updateTaskPane("FormatCellsTaskPane",this.yl(ib,xc,Kc));jb.stop();return null})}hideTaskPane(){rc.a.Fj()?void Ma.a.resolve(mb.ReactTaskPaneManagerService,{xa:0}).then(ib=>ib.hideTaskPane("FormatCellsTaskPane")):void Hd.a.li().then(ib=>{ib.hideTaskPane("FormatCellsTaskPane",2);return null})}close(){throw Error("Method not implemented.");}yl(ib,xc,Kc){ib={type:"FormatCellsTaskPaneProps",activePage:ib,callbacks:this.jf.ota(),viewModelData:xc,isFloatingObjectSelected:Kc};return Object.assign(new Zc.a,
{contentProps:ib,actionButtonProps:ib.activePage!==Tb.FormatCellsListView&&(this.ZF||!Kc)&&{label:pa.a.instance.ia(2351),icon:"CommonControlArrowLeftUseWithBorder_24",onExecute:()=>{this.updateTaskPane(Tb.FormatCellsListView,null,this.ZF?void 0:Kc);this.jf.activePage=Tb.FormatCellsListView}},title:ib.activePage===Tb.FormatCellsListView?pa.a.instance.ia(2304):pa.a.instance.ia(2305),onShow:()=>{this.jf.K2j()},onHide:()=>{this.jf.jL()},onClose:()=>{this.jf.zt()},width:320})}}Object(X.a)(Jc,"FormatCellsTaskPane",
null,[517]);var gc=a(1347);class dd extends Sys.EventArgs{constructor(ib,xc,Kc,ra){super();this.Ti=ib;this.cellFormat=xc;this.pId=Kc;this.gf=ra}}Object(X.a)(dd,"FormatCellsTaskPaneEventArgs",Sys.EventArgs,[]);var Bb=a(7);class pc extends Rb.a{constructor(ib,xc,Kc){super();this.YT=!1;this.vZa=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8611831_FixEditingUxOnAlignment");this.ZF=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8586390_FloatingObjectFormatCellsCentralFix");this.txa=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8916750_RegisterPaneEventSeperately");
this.activePage=Tb.FormatCellsListView;this.isFloatingObjectSelected=this.W_a=!1;this.EXj=()=>{const ra={};ra[Bb.a.MF]="FormatCellsTaskPane";this.$.Dc(802602464,fa.a.Hb,12,ra)};this.F0j=ra=>{if(this.ZF||!this.isFloatingObjectSelected){this.activePage===Tb.FormatCellsListView&&S.ULS.sendTraceTag(507597594,0,50,`User switched from Format Cells List View to ${Tb[ra]}`);var jb={ShouldCanvasTakeFocus:!1};switch(ra){case Tb.NumberFormatItemView:this.$.Dc(-395879625,fa.a.Hb,12,jb);break;case Tb.AlignmentItemView:this.$.Dc(-2019948858,
fa.a.Hb,12,jb);break;case Tb.FontItemView:this.$.Dc(456320978,fa.a.Hb,12,jb);break;case Tb.BorderItemView:this.$.Dc(119664190,fa.a.Hb,12,jb)}}};this.BWi=()=>this.activePage===Tb.NumberFormatItemView?xd.YMd(this.$,this.properties,this.fc).ota():null;this.iJi=()=>this.activePage===Tb.AlignmentItemView?xd.KJd(this.$,this.properties,this.fc).ota():null;this.bkg=()=>{this.raiseEvent("CellEditingStarted",new gc.a(Tb[this.activePage],null))};this.akg=()=>{this.raiseEvent("CellEditingEnded",new gc.a(Tb[this.activePage],
null))};this.onActiveCellChanged=()=>{this.raiseEvent("ActiveCellChanged",new gc.a(Tb[this.activePage],null));this.activePage===Tb.FormatCellsListView&&this.isFloatingObjectSelected&&this.WR(Tb.FormatCellsListView,null,this.ZF?void 0:!1);this.ZF||(this.isFloatingObjectSelected=!1)};this.rm=(ra,jb)=>{this.isFloatingObjectSelected=this.ZF?jb&&0!==(jb.gf&470):!0;this.activePage===Tb.FormatCellsListView?this.WR(Tb.FormatCellsListView,null,this.ZF?void 0:!0):this.raiseEvent("FloatingObjectSelectionChanged",
new dd(1461300262,null,this.activePage,jb.gf))};this.kXb=()=>{this.$.fa.Je!==Ac.a.Me&&this.$.fa.yc&&(this.YT=!0)};this.rr=()=>{this.$.fa.Je!==Ac.a.Me&&this.YT&&(this.YT=!1,(new kb.SheetProtection(this.$.qa)).ie(4)?this.raiseEvent("OnGridConsistent",new gc.a(Tb[this.activePage],null)):this.Ihb.hideTaskPane())};this.jd=(ra,jb)=>{!jb.Hg&&this.W_a&&this.Ihb.hideTaskPane()};this.$=ib;this.properties=xc;this.fc=Kc;this.Ihb=new Jc(this,ib);this.da=Ba.f(this.$);this.q_d=za.EwaSettings.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_8836792_AsyncTaskPaneUITiming");
this.ZF&&(this.isFloatingObjectSelected=this.da.ha.ob.isFloatingObjectSelected)}static getInstance(ib,xc,Kc){return this.Wa||(this.Wa=new this(ib,xc,Kc))}WR(ib,xc,Kc){Kc=void 0===Kc?this.ZF?this.PSk(ib)?this.isFloatingObjectSelected:!1:!1:Kc;this.W_a?this.Ihb.updateTaskPane(ib,xc,Kc):(this.q_d&&void this.j7k(),this.Ihb.showTaskPane(ib,xc,Kc),this.W_a=!0,this.Uy());this.activePage=ib}DFb(ib){this.addHandler("FCPaneCollapsed",ib)}u3b(ib){this.removeHandler("FCPaneCollapsed",ib)}CFb(ib){this.addHandler("FCPaneClosed",
ib)}$Tc(ib){this.removeHandler("FCPaneClosed",ib)}add_activeCellChanged(ib){this.addHandler("ActiveCellChanged",ib)}remove_activeCellChanged(ib){this.removeHandler("ActiveCellChanged",ib)}pF(ib){this.addHandler("FloatingObjectSelectionChanged",ib)}yL(ib){this.removeHandler("FloatingObjectSelectionChanged",ib)}Alc(ib){this.addHandler("OnGridConsistent",ib)}gUc(ib){this.removeHandler("OnGridConsistent",ib)}$Ch(ib){this.addHandler("CellEditingStarted",ib)}bsk(ib){this.removeHandler("CellEditingStarted",
ib)}ZCh(ib){this.addHandler("CellEditingEnded",ib)}ask(ib){this.removeHandler("CellEditingEnded",ib)}jL(){this.raiseEvent("FCPaneCollapsed");this.Y1c();this.W_a=!1;S.ULS.sendTraceTag(508385100,0,50,"TaskPane Collapsed")}zt(){this.raiseEvent("FCPaneClosed");this.Y1c();window.setTimeout(()=>{this.dispose()},0);S.ULS.sendTraceTag(508385099,0,50,"TaskPane Closed")}K2j(){this.ZF&&(this.isFloatingObjectSelected=this.da.ha.ob.isFloatingObjectSelected);if(!this.W_a)if(za.EwaSettings.isChangeGateEnabled("OfficeVSO:8593272_FormatCellSheetProtectionFix")&&
!(new kb.SheetProtection(this.$.qa)).ie(4))this.Ihb.hideTaskPane();else switch(this.activePage){case Tb.NumberFormatItemView:xd.YMd(this.$,this.properties,this.fc).mte(this.properties);S.ULS.sendTraceTag(508389441,0,50,"NumberFormatTaskPane Opened");break;case Tb.AlignmentItemView:xd.KJd(this.$,this.properties,this.fc).IMa();S.ULS.sendTraceTag(508389440,0,50,"Alignment TaskPane Opened");break;case Tb.FontItemView:xd.oBc(this.$,this.properties,this.fc).A7b(Tb.FontItemView);S.ULS.sendTraceTag(508078217,
0,50,"Font tab opened");break;case Tb.BorderItemView:xd.oBc(this.$,this.properties,this.fc).A7b(Tb.BorderItemView),S.ULS.sendTraceTag(507896131,0,50,"Border tab opened")}}dispose(){this.txa||(this.$=this.properties=this.Ihb=null);this.W_a=!1;pc.Wa=null}async j7k(){var ib;if(null!==(ib=this.properties)&&void 0!==ib&&ib.event){ib=this.properties.event.rawEvent||this.properties.event;var xc=ib.type.includes("key")?"keyboard":"mouse";(await Ma.a.resolve(mb.InteractivityTrackerServiceIdentifier)).kq(ib,
`task_pane_open_format_cell_${xc}`,null,["task-pane"])}}Uy(){this.da.ha.add_activeCellChanged(this.onActiveCellChanged);this.da.ha.ob.pF(this.rm);this.$.fa&&(this.$.fa.qF(this.kXb),this.$.fa.LCa(this.rr));this.$.Sj(this.jd);this.vZa&&(this.da.Rb.qH(this.akg),this.da.Rb.WS(this.bkg))}Y1c(){this.da.ha.remove_activeCellChanged(this.onActiveCellChanged);this.da.ha.ob.yL(this.rm);this.$.fa&&(this.$.fa.wG(this.kXb),this.$.fa.yxa(this.rr));this.$.ro(this.jd);this.vZa&&(this.da.Rb.QI(this.akg),this.da.Rb.zZ(this.bkg))}ota(){return{onItemClick:this.F0j,
onFeedbackButtonClick:this.EXj,numberFormatCallbacks:this.BWi(),alignmentCallbacks:this.iJi()}}PSk(ib){switch(ib){case Tb.AlignmentItemView:case Tb.NumberFormatItemView:return!0;default:return!1}}xxg(){const ib=this.$.ra.Tb(337,!0);if(ib){var xc=appChrome.selectors.getActiveControlsMapForATaskPane("FormatCellsTaskPane");ib.sR.Zwa(xc,12)}else S.ULS.shipAssertTag(507323542,0,!1,"ReactRibbonRoot not found in service registry")}}Object(X.a)(pc,"FormatCellsTaskPaneManager",Rb.a,[]);var wc=a(987),cd=a(2),
Vd=a(114);class xb{constructor(ib,xc,Kc){this.GD=!1;this.cy=this.sDf=this.Kg=null;this.FZb=-1;this.yYc=!0;this.JL=!1;this.ZF=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8586390_FloatingObjectFormatCellsCentralFix");this.jBd=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8900079_DelayNumberFormatTask");this.categoryDescriptionStrings=[pa.a.instance.ia(2306),pa.a.instance.ia(2307),pa.a.instance.ia(2308),pa.a.instance.ia(2309),pa.a.instance.ia(2310),pa.a.instance.ia(2311),pa.a.instance.ia(2312),pa.a.instance.ia(2313),
pa.a.instance.ia(2314),pa.a.instance.ia(2315),pa.a.instance.ia(2316),pa.a.instance.ia(2317)];this.logUserAction=ra=>{this.cy[ra]=this.cy[ra]?this.cy[ra]+1:1;this.cy.Total+=1};this.zt=()=>{this.dispose()};this.jL=()=>{this.t6g()};this.k3=()=>{const ra=this.numberFormatViewModel.Ilb(4,"NumberFormatTaskPaneManager.OnNumberFormatViewModelLoaded"),jb=this.numberFormatViewModel.Ilb(3,"NumberFormatTaskPaneManager.OnNumberFormatViewModelLoaded");if(jb||ra)this.jf.WR(Tb.NumberFormatItemView,this.Tzc()),jb?
(this.yYc?(this.numberFormatViewModel.formatCells(this.numberFormatViewModel.Cja(),this.fc),this.FZb=-1):this.yYc=!0,S.ULS.sendTraceTag(508355619,0,50,"NumberFormatViewModel Loaded by the TaskPane")):S.ULS.sendTraceTag(508355618,0,50,"NumberFormatViewModel Loaded by the Active Cell")};this.j3=()=>{S.ULS.sendTraceTag(508889099,0,50,"NumberFormatTaskPaneManager.onNumberFormatViewModelFailedLoad - Webservice call failed")};this.onActiveCellChanged=(ra,jb)=>{var vc;if(jb&&jb.description===Tb[Tb.NumberFormatItemView]){this.logUserAction("ActiveCellChange");
ra=null===(vc=Ba.f(this.$).Ob(null))||void 0===vc?void 0:vc.cell;if(!this.ZF&&this.jf.isFloatingObjectSelected||this.L2f(ra))this.ZF||(this.jf.isFloatingObjectSelected=!1),this.k2(!0,4);!za.EwaSettings.isChangeGateEnabled("OfficeVSO:8606029_PaneUpdateRegressionFix")&&ra&&(this.Imd=ra)}};this.rm=(ra,jb)=>{jb&&jb.pId===Tb.NumberFormatItemView&&(this.ZF?0!==(jb.gf&470)?this.jf.WR(Tb.NumberFormatItemView,null):this.k2(!0,4):this.jf.WR(Tb.NumberFormatItemView,null,!0))};this.rr=(ra,jb)=>{var vc,md;jb&&
jb.description===Tb[Tb.NumberFormatItemView]&&(ra=null===(vc=Ba.f(this.$).Ob(null))||void 0===vc?void 0:vc.cell,this.L2f(ra)&&!this.JL?(this.yYc=!1,this.k2(!0)):(this.JL=!1,za.EwaSettings.isChangeGateEnabled("OfficeVSO:8606029_PaneUpdateRegressionFix")&&(this.FZb=null!==(md=null===ra||void 0===ra?void 0:ra.oi)&&void 0!==md?md:-1)))};this.$=ib;this.properties=xc;this.fc=Kc;this.jf=xd.JPb(this.$,this.properties,this.fc);this.cy={Total:0}}static getInstance(ib,xc,Kc){return this.Wa||(this.Wa=new this(ib,
xc,Kc))}mte(ib){const xc=()=>{this.jf.WR(Tb.NumberFormatItemView,this.sDf);za.EwaSettings.isChangeGateEnabled("OfficeVSO:8589523_AvoidApplyingFormatOnPaneOpen")&&(this.yYc=!1);this.k2(!0,3,ib)};this.jBd?Object(Vd.e)(()=>{xc()}):xc()}dispose(){S.ULS.sendTraceTag(507875737,0,20,`Number format usage ${JSON.stringify(this.cy)}`);this.t6g();this.jf.$Tc(this.zt);xb.Wa=null}ota(){return{onCategoryTypeChange:ib=>{this.logUserAction("CategoryTypeChange");this.Kg.NumberFormatCategory=ib;this.JL=!0;switch(ib){case 0:case 9:this.sF();
break;default:this.k2()}S.ULS.sendTraceTag(508387598,0,50,`Number Format Category Changed ${ib}`)},onThousandSeparatorChanged:ib=>{this.logUserAction("ThousandsSeparatorChange");this.Kg.IsComma=ib;this.JL=!0;this.k2();S.ULS.sendTraceTag(508368995,0,50,`Thousand Separator Changed ${ib}`)},onDecimalPlacesChanged:ib=>{this.logUserAction("DecimalPlacesChange");this.Kg.DecimalPlaces=ib;this.JL=!0;switch(this.Kg.NumberFormatCategory){case 3:case 6:case 8:za.EwaSettings.isChangeGateEnabled("OfficeVSO:8507884_FixIncreaseDecreaseDecimalFlicker")?
this.k2():this.sF();break;default:this.k2()}S.ULS.sendTraceTag(508368994,0,50,`Decimal Places Changed ${ib}`)},onLocaleChanged:ib=>{this.logUserAction("LocaleChange");this.Kg.LocaleType=ib;this.JL=!0;this.k2();S.ULS.sendTraceTag(508389409,0,50,`Locale Changed ${ib}`)},overrideLocale:()=>{this.logUserAction("overrideLocale");this.JL=!0;this.$.Dc(151715844,fa.a.Hb,12,{selectedIndex:this.Kg.LocaleType});S.ULS.sendTraceTag(508389408,0,50,`Override default Locale button clicked ${this.Kg.LocaleType}`)},
onInputCalendarChecked:ib=>{this.logUserAction("InputCalendarChecked");this.JL=!0;this.Kg.IsInputCalendar=ib;this.k2();S.ULS.sendTraceTag(508387596,0,50,"Change in Input Calendar Type")},onGannenChecked:ib=>{this.logUserAction("GannenChecked");this.Kg.IsGannen=ib;this.JL=!0;this.k2();S.ULS.sendTraceTag(508389407,0,50,`Gannen changed ${this.Kg.LocaleType} ${ib}`)},onCalendarTypeChanged:ib=>{this.logUserAction("CalendarTypeChange");this.Kg.CalendarType=ib;this.JL=!0;this.k2();S.ULS.sendTraceTag(508389406,
0,50,`Calendar Type changed ${ib}`)},onSymbolChanged:ib=>{this.logUserAction("SymbolChange");this.Kg.CurrencyType=ib;this.JL=!0;3===this.Kg.NumberFormatCategory?this.sF():this.k2();S.ULS.sendTraceTag(508387595,0,50,`Currency Symbol changed ${ib}`)},onNegativeNumberTypeChanged:ib=>{this.logUserAction("NegativeNumberTypeChange");this.JL=!0;this.Kg.NegativeNumberType=ib;this.sF();S.ULS.sendTraceTag(508387594,0,50,`Negative Number Type changed ${ib}`)},onDateTypeChanged:ib=>{this.logUserAction("DateTypeChange");
this.JL=!0;this.Kg.DateType=ib;this.sF();S.ULS.sendTraceTag(508387593,0,50,`Date Type Changed ${ib}`)},onTimeTypeChanged:ib=>{this.logUserAction("TimeTypeChange");this.JL=!0;this.Kg.TimeType=ib;this.sF();S.ULS.sendTraceTag(508387592,0,50,`Time Type changed ${ib}`)},onFractionTypeChanged:ib=>{this.logUserAction("FractionTypeChange");this.JL=!0;this.Kg.FractionType=ib;this.sF();S.ULS.sendTraceTag(508387591,0,50,`Fraction Type changed ${ib}`)},onSpecialTypeChanged:ib=>{this.logUserAction("SpecialTypeChange");
this.JL=!0;this.Kg.SpecialType=ib;this.sF();S.ULS.sendTraceTag(508387590,0,50,`Special Type changed ${ib}`)},onCustomTypeChanged:ib=>{this.logUserAction("CustomTypeChange");this.JL=!0;this.Kg.CustomType=ib;this.sF();S.ULS.sendTraceTag(508387589,0,50,`CustomType changed ${ib}`)},onNegativeCurrencyTypeChanged:ib=>{this.logUserAction("NegativeCurrencyTypeChange");this.JL=!0;this.Kg.NegativeCurrencyType=ib;this.sF();S.ULS.sendTraceTag(508387588,0,50,`Negative Currency Type changed ${ib}`)}}}k2(ib,xc,
Kc){xc=void 0===xc?3:xc;let ra=null;if(this.activeCell=this.yyc())c("NumberFormatTab::DelayedUpdate::Start"),Kc&&(Kc.currencyType||fa.a.Wc in Kc&&Kc[fa.a.Wc])&&(ra=parseInt(Kc[fa.a.Wc].toString(),10)),this.numberFormatViewModel?(this.GD||this.fTc(),ra||ib?this.M9f(ra,xc,Kc):(this.Kg.Caller=xc,this.numberFormatViewModel.KVa(this.activeCell,this.Kg))):this.C9h(ra)}C9h(ib){void Ma.a.resolve(mb.NumberFormatViewModelService,{xa:0}).then(xc=>{this.numberFormatViewModel=xc;this.GD||this.fTc();this.numberFormatViewModel.gVc();
this.M9f(ib)})}fTc(){this.GD=!0;this.numberFormatViewModel.NCa(this.k3);this.numberFormatViewModel.IFb(this.j3);this.jf.DFb(this.jL);this.jf.CFb(this.zt);this.jf.add_activeCellChanged(this.onActiveCellChanged);this.jf.pF(this.rm);this.jf.Alc(this.rr);S.ULS.sendTraceTag(508355648,0,50,"NumberFormatViewModel events Registered")}M9f(ib,xc,Kc){xc=void 0===xc?3:xc;ib=Object(cd.a)(new wc.a,{Caller:xc,NumberFormatCategory:null!==ib&&void 0!==ib?ib:-1});Kc&&Kc.currencyType&&(ib.CurrencyType=Kc.currencyType,
ib.NumberFormatCategory=3);this.numberFormatViewModel.KVa(this.activeCell,ib)}Tzc(ib){var xc=this.numberFormatViewModel.$g.NumberFormatElement.toString();this.Kg=ib=ib?this.jPb():this.numberFormatViewModel.Cja();return this.sDf=xc={numberFormatModel:{categories:this.numberFormatViewModel.$g.Categories,categoryDescriptionStrings:this.categoryDescriptionStrings,negativeNumberTypes:this.numberFormatViewModel.$g.NegativeNumberTypes,negativeCurrencyTypes:this.numberFormatViewModel.$g.NegativeCurrencyTypes,
currencySymbols:this.numberFormatViewModel.$g.CurrencySymbols,dateTypes:this.numberFormatViewModel.$g.DateTypes,timeTypes:this.numberFormatViewModel.$g.TimeTypes,fractionTypes:this.numberFormatViewModel.$g.FractionTypes,specialTypes:this.numberFormatViewModel.$g.SpecialTypes,customTypes:this.numberFormatViewModel.$g.CustomTypes,localeOptions:this.numberFormatViewModel.$g.Locales,calendarTypes:this.numberFormatViewModel.$g.Calendars,isInputCalendarCheckboxRequired:"57607"===xc||"319751"===xc?!0:!1,
isGannenCheckboxRequired:"319751"===xc?!0:!1,currentCategory:ib.NumberFormatCategory,decimalPlaces:ib.DecimalPlaces,isComma:ib.IsComma,currencyType:ib.CurrencyType,negativeNumberType:ib.NegativeNumberType,dateType:ib.DateType,timeType:ib.TimeType,fractionType:ib.FractionType,specialType:ib.SpecialType,customType:ib.CustomType,negativeCurrencyType:ib.NegativeCurrencyType,calendarType:ib.CalendarType,localeIndex:ib.LocaleType,isInputCalendarChecked:ib.IsInputCalendar,isGannenChecked:ib.IsGannen}}}yyc(){var ib,
xc;let Kc;const ra=Ba.f(this.$),jb=ra.ha.oa.activeCell;if(za.EwaSettings.isChangeGateEnabled("OfficeVSO:8606029_PaneUpdateRegressionFix")){var vc=null===(ib=ra.Ob(jb))||void 0===ib?void 0:ib.cell;this.FZb=null!==(xc=null===vc||void 0===vc?void 0:vc.oi)&&void 0!==xc?xc:-1}else this.Imd=null===(vc=ra.Ob(jb))||void 0===vc?void 0:vc.cell;jb&&(Kc=ba.r(jb,this.$));return Kc}t6g(){this.GD=!1;this.numberFormatViewModel&&(this.numberFormatViewModel.xLa(this.k3),this.numberFormatViewModel.A3b(this.j3),this.jf.u3b(this.jL),
this.jf.remove_activeCellChanged(this.onActiveCellChanged),this.jf.yL(this.rm),this.jf.gUc(this.rr),S.ULS.sendTraceTag(508355617,0,50,"NumberFormatViewModel events Un-registered"))}jPb(){const ib=this.numberFormatViewModel.Cja();ib.NumberFormatCategory=this.Kg.NumberFormatCategory;ib.NegativeNumberType=this.Kg.NegativeNumberType;ib.NegativeCurrencyType=this.Kg.NegativeCurrencyType;ib.DateType=this.Kg.DateType;ib.TimeType=this.Kg.TimeType;ib.FractionType=this.Kg.FractionType;ib.SpecialType=this.Kg.SpecialType;
ib.CustomType=this.Kg.CustomType;ib.DecimalPlaces=this.Kg.DecimalPlaces;ib.CurrencyType=this.Kg.CurrencyType;return ib}sF(){c("NumberFormatTab::InstantUpdate::Start");this.numberFormatViewModel.formatCells(this.jPb(),this.fc);this.FZb=-1;this.jf.WR(Tb.NumberFormatItemView,this.Tzc(!0))}L2f(ib){return za.EwaSettings.isChangeGateEnabled("OfficeVSO:8606029_PaneUpdateRegressionFix")?ib&&ib.oi!==this.FZb:ib&&this.Imd&&ib.oi!==this.Imd.oi}}Object(X.a)(xb,"NumberFormatTaskPaneManager",null,[4]);class ub{constructor(ib,
xc,Kc){this.Wmc=this.GD=!1;this.cy=this.Kg=null;this.Tob=-1;this.MZc=!1;this.qLb=0;this.aQk=za.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.FormatCellsTaskPaneShimmerDelayInMs",200);this.jBd=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8900079_DelayNumberFormatTask");this.txa=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8916750_RegisterPaneEventSeperately");this.categoryDescriptionStrings=[pa.a.instance.ia(2306),pa.a.instance.ia(2307),pa.a.instance.ia(2308),pa.a.instance.ia(2309),pa.a.instance.ia(2310),
pa.a.instance.ia(2311),pa.a.instance.ia(2312),pa.a.instance.ia(2313),pa.a.instance.ia(2314),pa.a.instance.ia(2315),pa.a.instance.ia(2316),pa.a.instance.ia(2317)];this.k3=(ra,jb)=>{if(this.Xkb()){ra=ba.b(this.activeCell,jb.activeCell);jb=this.numberFormatViewModel.Ilb(4,"NumberFormatTaskPaneManager.OnNumberFormatViewModelLoaded");var vc=this.numberFormatViewModel.Ilb(3,"NumberFormatTaskPaneManager.OnNumberFormatViewModelLoaded");if(vc||jb)ra&&this.oIg(!1),vc?(S.ULS.shipAssertTag(507352925,0,ra,"The model is not of the current active cell."),
this.Tob=-1,this.numberFormatViewModel.formatCells(this.numberFormatViewModel.Cja(),this.fc),this.MZc=!0,S.ULS.sendTraceTag(507352923,0,50,"NumberFormatViewModel Loaded by the TaskPane")):S.ULS.sendTraceTag(507352922,0,50,"NumberFormatViewModel Loaded by the Active Cell")}};this.j3=()=>{S.ULS.sendTraceTag(508889099,0,10,"NumberFormatTaskPaneManager.onNumberFormatViewModelFailedLoad - Webservice call failed")};this.logUserAction=(ra,jb)=>{this.cy[ra]=this.cy[ra]?this.cy[ra]+1:1;this.cy.Total+=1;jb&&
S.ULS.sendTraceTag(507352926,0,50,jb)};this.zt=()=>{this.dispose()};this.jL=()=>{this.Nvd();this.txa?(this.p6g(),this.v6g()):this.f2c()};this.rm=(ra,jb)=>{this.Xkb()&&(0!==(jb.gf&470)?this.jf.WR(Tb.NumberFormatItemView,null):(this.Tob=-1,void this.fSc(!0)))};this.rr=()=>{this.Xkb()&&(this.MZc?this.MZc=!1:void this.fSc(!1))};this.onActiveCellChanged=()=>{this.Xkb()&&(this.logUserAction("ActiveCellChange"),void this.fSc(!0))};this.$=ib;this.fc=Kc;this.jf=xd.JPb(this.$,xc,this.fc);this.cy={Total:0}}static getInstance(ib,
xc,Kc){return this.Wa||(this.Wa=new this(ib,xc,Kc))}dispose(){S.ULS.sendTraceTag(507875737,0,20,`Number format usage ${JSON.stringify(this.cy)}`);this.Nvd();this.txa?(this.p6g(),this.v6g()):this.f2c();this.jf.$Tc(this.zt);ub.Wa=null}Xkb(){return this.jf&&this.jf.W_a&&this.jf.activePage===Tb.NumberFormatItemView}mte(ib){const xc=()=>{this.txa&&this.Fok();let Kc=!0;this.Xkb()?Kc=!1:this.Tob=-1;Kc&&this.xIg();void this.fSc(!1,ib)};this.jBd?Object(Vd.e)(()=>{xc()}):xc()}async Dni(){this.numberFormatViewModel||
(this.numberFormatViewModel=await Ma.a.resolve(mb.NumberFormatViewModelService,{xa:0}),this.numberFormatViewModel.gVc());this.txa?this.sok():this.GD||this.fhe()}async fSc(ib,xc){var Kc,ra;this.activeCell=null;var jb=Ba.f(this.$);const vc=jb.ha.oa.activeCell;vc?(this.activeCell=ba.r(vc,this.$),jb=null!==(ra=null===(Kc=jb.Ob(vc))||void 0===Kc?void 0:Kc.cell.oi)&&void 0!==ra?ra:-1,this.Tob===jb?S.ULS.sendTraceTag(507250438,0,10,`Skipping pane re-render as the number format index is same as the last rendered (or to be rendered) index. New format index: ${jb}`):
(ib&&this.Evk(),this.Tob=jb,ib=new wc.a,ib.Caller=4,ib.NumberFormatCategory=-1,this.G9j(ib,xc),await this.Dni(),this.numberFormatViewModel.KVa(this.activeCell,ib,!0))):S.ULS.sendTraceTag(507348099,0,10,"NumberFormatTaskPaneManager.queuePaneUpdateFromActiveCell - Active cell not available.")}Evk(){this.qLb=window.setTimeout(()=>{this.qLb=0;this.Xkb()&&this.xIg()},this.aQk)}xIg(){this.jf.WR(Tb.NumberFormatItemView,null)}Nvd(){this.qLb&&(window.clearTimeout(this.qLb),this.qLb=0)}oIg(ib){this.Nvd();this.jf.WR(Tb.NumberFormatItemView,
this.Tzc(ib))}BFa(){this.Kg.Caller=3;this.numberFormatViewModel.KVa(this.activeCell,this.Kg,!1)}sF(){this.Tob=-1;this.numberFormatViewModel.formatCells(this.jPb(),this.fc);this.MZc=!0;this.oIg(!0)}G9j(ib,xc){xc&&(xc.currencyType?(ib.NumberFormatCategory=3,ib.CurrencyType=xc.currencyType):fa.a.Wc in xc&&xc[fa.a.Wc]&&(xc=parseInt(xc[fa.a.Wc].toString(),10),S.ULS.shipAssertTag(507352927,0,-1<xc&&12>xc,`MenuItemId should represent a valid number format category. Current is ${xc}`),ib.NumberFormatCategory=
xc))}jPb(){const ib=this.numberFormatViewModel.Cja();ib.NumberFormatCategory=this.Kg.NumberFormatCategory;ib.NegativeNumberType=this.Kg.NegativeNumberType;ib.NegativeCurrencyType=this.Kg.NegativeCurrencyType;ib.DateType=this.Kg.DateType;ib.TimeType=this.Kg.TimeType;ib.FractionType=this.Kg.FractionType;ib.SpecialType=this.Kg.SpecialType;ib.CustomType=this.Kg.CustomType;ib.DecimalPlaces=this.Kg.DecimalPlaces;ib.CurrencyType=this.Kg.CurrencyType;return ib}Tzc(ib){const xc=this.numberFormatViewModel.$g.NumberFormatElement.toString();
this.Kg=ib=ib?this.jPb():this.numberFormatViewModel.Cja();return{numberFormatModel:{categories:this.numberFormatViewModel.$g.Categories,categoryDescriptionStrings:this.categoryDescriptionStrings,negativeNumberTypes:this.numberFormatViewModel.$g.NegativeNumberTypes,negativeCurrencyTypes:this.numberFormatViewModel.$g.NegativeCurrencyTypes,currencySymbols:this.numberFormatViewModel.$g.CurrencySymbols,dateTypes:this.numberFormatViewModel.$g.DateTypes,timeTypes:this.numberFormatViewModel.$g.TimeTypes,
fractionTypes:this.numberFormatViewModel.$g.FractionTypes,specialTypes:this.numberFormatViewModel.$g.SpecialTypes,customTypes:this.numberFormatViewModel.$g.CustomTypes,localeOptions:this.numberFormatViewModel.$g.Locales,calendarTypes:this.numberFormatViewModel.$g.Calendars,isInputCalendarCheckboxRequired:"57607"===xc||"319751"===xc,isGannenCheckboxRequired:"319751"===xc,currentCategory:ib.NumberFormatCategory,decimalPlaces:ib.DecimalPlaces,isComma:ib.IsComma,currencyType:ib.CurrencyType,negativeNumberType:ib.NegativeNumberType,
dateType:ib.DateType,timeType:ib.TimeType,fractionType:ib.FractionType,specialType:ib.SpecialType,customType:ib.CustomType,negativeCurrencyType:ib.NegativeCurrencyType,calendarType:ib.CalendarType,localeIndex:ib.LocaleType,isInputCalendarChecked:ib.IsInputCalendar,isGannenChecked:ib.IsGannen}}}ota(){return{onCategoryTypeChange:ib=>{this.logUserAction("CategoryTypeChange",`Number Format Category Changed ${ib}`);this.Kg.NumberFormatCategory=ib;switch(ib){case 0:case 9:this.sF();break;default:this.BFa()}},
onThousandSeparatorChanged:ib=>{this.logUserAction("ThousandsSeparatorChange",`Thousand Separator Changed ${ib}`);this.Kg.IsComma=ib;this.BFa()},onDecimalPlacesChanged:ib=>{this.logUserAction("DecimalPlacesChange",`Decimal Places Changed ${ib}`);this.Kg.DecimalPlaces=ib;this.BFa()},onLocaleChanged:ib=>{this.logUserAction("LocaleChange",`Locale Changed ${ib}`);this.Kg.LocaleType=ib;this.BFa()},overrideLocale:()=>{this.logUserAction("overrideLocale",`Override default Locale button clicked ${this.Kg.LocaleType}`);
this.$.Dc(151715844,fa.a.Hb,12,{selectedIndex:this.Kg.LocaleType})},onInputCalendarChecked:ib=>{this.logUserAction("InputCalendarChecked",`Change in Input Calendar Type: ${ib}`);this.Kg.IsInputCalendar=ib;this.BFa()},onGannenChecked:ib=>{this.logUserAction("GannenChecked",`Gannen changed ${this.Kg.LocaleType} ${ib}`);this.Kg.IsGannen=ib;this.BFa()},onCalendarTypeChanged:ib=>{this.logUserAction("CalendarTypeChange",`Calendar Type changed ${ib}`);this.Kg.CalendarType=ib;this.BFa()},onSymbolChanged:ib=>
{this.logUserAction("SymbolChange",`Currency Symbol changed ${ib}`);this.Kg.CurrencyType=ib;3===this.Kg.NumberFormatCategory?this.sF():this.BFa()},onNegativeNumberTypeChanged:ib=>{this.logUserAction("NegativeNumberTypeChange",`Negative Number Type changed ${ib}`);this.Kg.NegativeNumberType=ib;this.sF()},onDateTypeChanged:ib=>{this.logUserAction("DateTypeChange",`Date Type Changed ${ib}`);this.Kg.DateType=ib;this.sF()},onTimeTypeChanged:ib=>{this.logUserAction("TimeTypeChange",`Time Type changed ${ib}`);
this.Kg.TimeType=ib;this.sF()},onFractionTypeChanged:ib=>{this.logUserAction("FractionTypeChange",`Fraction Type changed ${ib}`);this.Kg.FractionType=ib;this.sF()},onSpecialTypeChanged:ib=>{this.logUserAction("SpecialTypeChange",`Special Type changed ${ib}`);this.Kg.SpecialType=ib;this.sF()},onCustomTypeChanged:ib=>{this.logUserAction("CustomTypeChange",`CustomType changed ${ib}`);this.Kg.CustomType=ib;this.sF()},onNegativeCurrencyTypeChanged:ib=>{this.logUserAction("NegativeCurrencyTypeChange",`Negative Currency Type changed ${ib}`);
this.Kg.NegativeCurrencyType=ib;this.sF()}}}sok(){this.GD?S.ULS.sendTraceTag(507250437,0,50,"NumberFormatViewModel events already registered. Skip registering."):(this.GD=!0,this.numberFormatViewModel.NCa(this.k3),this.numberFormatViewModel.IFb(this.j3),S.ULS.sendTraceTag(507352920,0,50,"NumberFormatViewModel events Registered"))}Fok(){this.Wmc?S.ULS.sendTraceTag(507250436,0,50,"Pane model events already registered. Skip registering."):(this.Wmc=!0,this.jf.DFb(this.jL),this.jf.CFb(this.zt),this.jf.add_activeCellChanged(this.onActiveCellChanged),
this.jf.pF(this.rm),this.jf.Alc(this.rr),S.ULS.sendTraceTag(507250435,0,50,"Pane model events registered"))}fhe(){this.GD=!0;this.numberFormatViewModel.NCa(this.k3);this.numberFormatViewModel.IFb(this.j3);this.jf.DFb(this.jL);this.jf.CFb(this.zt);this.jf.add_activeCellChanged(this.onActiveCellChanged);this.jf.pF(this.rm);this.jf.Alc(this.rr);S.ULS.sendTraceTag(507250402,0,50,"NumberFormatViewModel events Registered")}p6g(){this.GD?(this.GD=!1,this.numberFormatViewModel?(this.numberFormatViewModel.xLa(this.k3),
this.numberFormatViewModel.A3b(this.j3),S.ULS.sendTraceTag(507352919,0,50,"NumberFormatViewModel events Un-registered")):S.ULS.sendTraceTag(507250433,0,10,"this.NumberFormatViewModel is null or undefined")):S.ULS.sendTraceTag(507250434,0,50,"model events not registered. Skip un-registering.")}v6g(){this.Wmc?(this.Wmc=!1,this.jf.u3b(this.jL),this.jf.remove_activeCellChanged(this.onActiveCellChanged),this.jf.yL(this.rm),this.jf.gUc(this.rr),S.ULS.sendTraceTag(507250403,0,50,"Pane model events un-registered")):
S.ULS.sendTraceTag(507250432,0,50,"Pane manager events not registered. Skip un-registering.")}f2c(){this.GD=!1;this.numberFormatViewModel&&(this.numberFormatViewModel.xLa(this.k3),this.numberFormatViewModel.A3b(this.j3),this.jf.u3b(this.jL),this.jf.remove_activeCellChanged(this.onActiveCellChanged),this.jf.yL(this.rm),this.jf.gUc(this.rr),S.ULS.sendTraceTag(507250401,0,50,"NumberFormatViewModel events Un-registered"))}}Object(X.a)(ub,"NumberFormatTaskPaneManager",null,[4]);class Fc{constructor(ib,
xc,Kc){this.GD=!1;this.activePage=Tb.FormatCellsListView;this.isFloatingObjectSelected=!1;this.ZF=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8586390_FloatingObjectFormatCellsCentralFix");this.BTb=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8837194_ScopePollForStateAndUpdateToPane");this.zt=()=>{this.dispose()};this.jL=()=>{this.Bi()};this.onActiveCellChanged=(ra,jb)=>{this.isFloatingObjectSelected&&jb&&jb.description===Tb[this.activePage]&&(this.A7b(this.activePage),this.isFloatingObjectSelected=
!1)};this.rm=(ra,jb)=>{jb&&jb.pId===this.activePage&&(this.isFloatingObjectSelected=!0,this.jf.WR(this.activePage,null,!0))};this.jf=xd.JPb(ib,xc,Kc);za.EwaSettings.isChangeGateEnabled("OfficeVSO:8498050_PollForStateFontTabEdgeFix")&&!this.BTb&&(this.reactRibbonRoot=ib.ra.Tb(337,!0))}static getInstance(ib,xc,Kc){return this.Wa||(this.Wa=new this(ib,xc,Kc))}A7b(ib){this.jf.WR(ib,null);this.activePage=ib;this.GD||this.Aj();za.EwaSettings.isChangeGateEnabled("OfficeVSO:8498050_PollForStateFontTabEdgeFix")&&
requestAnimationFrame(()=>{this.BTb?this.jf.xxg():this.reactRibbonRoot.Oh()})}dispose(){this.Bi();this.jf.$Tc(this.zt);Fc.Wa=null}Aj(){this.jf.DFb(this.jL);this.jf.CFb(this.zt);this.ZF||(this.jf.add_activeCellChanged(this.onActiveCellChanged),this.jf.pF(this.rm));this.GD=!0;S.ULS.sendTraceTag(508078168,0,50,"Events registered")}Bi(){this.jf.u3b(this.jL);this.ZF||(this.jf.remove_activeCellChanged(this.onActiveCellChanged),this.jf.yL(this.rm));this.GD=!1;S.ULS.sendTraceTag(508078167,0,50,"Events unregistered")}}
Object(X.a)(Fc,"StoreConnectedItemViewTaskPaneManager",null,[4]);class xd{constructor(){}static JPb(ib,xc,Kc){return pc.getInstance(ib,xc,Kc)}static YMd(ib,xc,Kc){return za.EwaSettings.isChangeGateEnabled("OfficeVSO:8816021_NewNumberFormatPaneManager")?ub.getInstance(ib,xc,Kc):xb.getInstance(ib,xc,Kc)}static KJd(ib,xc,Kc){return Xd.getInstance(ib,xc,Kc)}static oBc(ib,xc,Kc){return Fc.getInstance(ib,xc,Kc)}}Object(X.a)(xd,"FormatCellsTaskPaneHelper",null,[]);let Ic=class{constructor(ib,xc){this.DF=
xc;this.$=ib}gd(){return!1}executeCommand(ib,xc,Kc){var ra;ib=!1;const jb=xc.command;switch(jb){case 2055979337:xd.JPb(this.$,Kc,xc).WR(Tb.FormatCellsListView,null);ib=!0;S.ULS.sendTraceTag(508369024,0,50,"FormatCellsTaskPane opened using FormatCells Command");break;case -395879625:xd.YMd(this.$,Kc,xc).mte(Kc);ib=!0;S.ULS.sendTraceTag(508385094,0,50,"NumberFormat Tab in FormatCellsTaskPane opened using showNumberFormat");break;case -2019948858:xd.KJd(this.$,Kc,xc).IMa();ib=!0;S.ULS.sendTraceTag(508385093,
0,50,"Alignment Tab in FormatCellsTaskPane opened using showAlignmentPane");break;case 456320978:xd.oBc(this.$,Kc,xc).A7b(Tb.FontItemView);ib=!0;S.ULS.sendTraceTag(508078218,0,50,"Font Tab in FormatCellsTaskPane opened.");break;case 119664190:xd.oBc(this.$,Kc,xc).A7b(Tb.BorderItemView),ib=!0,S.ULS.sendTraceTag(507896130,0,50,"Border Tab in FormatCellsTaskPane opened.")}za.EwaSettings.isChangeGateEnabled("OfficeVSO:8607151_FormatTaskpaneFloatieUI")&&(xc=null!==(ra=Kc.UILocation)&&void 0!==ra?ra:0,
ib&&9===xc&&this.DF.mlb()&&this.DF.jC());return ib?sa.Task.Va(!0):wa.a(jb)}Rc(ib,xc){switch(xc.command){case 2055979337:case -395879625:case -2019948858:case 456320978:case 119664190:return!0;default:return!1}}td(){return!1}};Ic=Object(C.__decorate)([Object(Ma.d)(mb.FormatCellsCommandHandlerService),Object(C.__param)(0,Object(mb.EwaControlService)()),Object(C.__param)(1,Object(mb.ContextMenuControllerService)())],Ic);Object(X.a)(Ic,"FormatCellsCommandHandler",null,[29]);Object(Ma.b)(mb.FormulaAnonymizerService)(async ib=>
{const xc=await Ma.a.resolve(mb.FormulaAuthoringHelperService,ib);ib=await Ma.a.resolve(mb.CalcManagerService,ib);await ib.JWf;return new bd(xc.getFormulaAnonymizer(ib.config))});class bd{constructor(ib){this.XIh=ib}anonymize(ib,xc){return this.XIh.anonymize(ib,{row:xc.top-1,col:xc.left-1,rows:1,cols:1})}}Object(X.a)(bd,"FormulaAnonymizer",null,[]);class yb{constructor(ib,xc,Kc,ra){this.$=ib;this.formulaAssistanceUIControl=xc;this.Yw=Kc;this.TA=ra;this.vYb=rc.a.f2f();this.VZa=rc.a.VZa();this.Uua=
this.IOe=this.KQc=!1;this.D8={repairs:[],cell:null};this.da=Object(Ba.f)(this.$);this.container=document.createElement("div");this.$.domElement.appendChild(this.container)}get THa(){return this.IOe}set THa(ib){this.IOe=ib;this.TA.ij=ib}ZWk(ib,xc,Kc,ra){ra=void 0===ra?"beside":ra;this.brd("card");if(this.VZa){const md=xc.repairs.map(Qd=>Qd.text);this.Yw.RUc({kind:"repair",Tzl:xc.repairs.length,formula:this.KQc?ib.text:"",repairs:this.KQc?md:[""]},xc.repairs.length)}else this.Yw.RUc({kind:"repair"},
xc.repairs.length);this.THa=!0;const jb=this.Gud(ib),vc=Object.assign({},xc,{callbacks:Kc,Szl:ra});this.D8={repairs:xc.repairs,cell:ib.rw};this.formulaAssistanceUIControl.renderFormulaRepair(this.container,jb,vc);this.nAe=md=>{md=Object.assign({},vc,{repairs:md});this.formulaAssistanceUIControl.renderFormulaRepair(this.container,jb,md)}}rXk(ib,xc){this.brd("card");this.Yw.RUc({kind:"errorIndication"});this.THa=!0;ib=this.Gud(ib);this.formulaAssistanceUIControl.renderSyntaxErrorIndication(this.container,
ib,xc)}lVk(ib,xc){this.brd("icon");this.Yw.RUc({kind:"icon"});this.Uua=!0;ib=this.Gud(ib);this.formulaAssistanceUIControl.renderFormulaRepairIcon(this.container,ib,xc)}hide(ib,xc){let Kc=!1;this.Uua&&(Kc=!0,this.Uua=!1);this.THa&&(this.vYb&&"commit"!==ib&&this.D8.repairs&&0<this.D8.repairs.length&&this.D8.cell&&this.Yw.V$d(this.D8),Kc=!0,this.THa=!1,this.nAe=null);Kc&&(this.formulaAssistanceUIControl.dismiss(this.container),this.Yw.Wwk(ib,xc),this.D8={repairs:[],cell:null});return Kc}brd(ib){S.ULS.shipAssertTag(508315279,
0,!this.THa&&!this.Uua,`FormulaRepairControl: Trying to show ${ib} while a ui is shown. Card: ${this.THa}, icon:${this.Uua}.`)}Gud(ib){ib=this.da.getCellBounds(ib,!0);return{top:ib.y,bottom:ib.y+ib.height,left:ib.x,right:ib.x+ib.width}}}Object(X.a)(yb,"FormulaRepairControl",null,[]);var Oc=a(308),kd=a(306),Rc=a(17);class Xb{constructor(ib,xc,Kc){this.$=ib;this.nne=xc;this.formulaAssistanceUIControl=Kc;this.ATa=!1}get ij(){return this.ATa}set ij(ib){this.ATa!==ib&&(ib?kd.a(this.$).hl(this):kd.a(this.$).XC(this),
this.ATa=ib)}get tf(){return this.nne}get ud(){return this.Vm}set ud(ib){this.Vm=ib}Nj(ib,xc){ib=!1;xc||(ib=this.formulaAssistanceUIControl.focusElement(this.ud));return ib}zk(ib){return null!=this.ud?Rc.DOMElementExtensions.Ki(this.ud,ib):!1}Hm(){}fo(){}}Object(X.a)(Xb,"FormulaRepairFocusManager",null,[24]);var dc=a(282),Vc=a(662);class yd{constructor(ib,xc,Kc,ra,jb){this.$=ib;this.pluginScheduler=xc;this.u5g=Kc;this.Yw=ra;this.vBe=jb;this.o0d=rc.a.LGc();this.isValuePreviewEnabled=this.Q2f=this.x_d=
!1;this.wsc=null;this.Ojb=this.dUf=this.jVd=!1;this.QRc=null;this.zl={id:0,active:!1,cell:null};this.onActiveCellChanged=(vc,md)=>{var Qd,v;this.x_d=!1;this.zl.active&&Object(Oc.b)(md.cell)&&md.cell.range.toString()===(null===(Qd=this.zl.cell)||void 0===Qd?void 0:Qd.rw.toString())||(Object(Oc.b)(this.QRc)?(vc=null===(v=this.da.Ob(this.QRc))||void 0===v?void 0:v.cell,void this.YUc("editCommitted",vc),this.QRc=null):(this.hide("selection"),void this.YUc("selection")))};this.onScroll=()=>{this.hide("scroll")};
this.d7j=(vc,md)=>{const Qd=this.zl.cell;if(Object(Oc.c)(vc))this.control.rXk(Qd,this.ota("SyntaxErrorIndication")),this.BEg(),this.bFg();else{this.wsc=vc;var v;this.isValuePreviewEnabled&&(v=this.Koi(this.wsc.repairs));this.yqj&&"editCommitted"!==md?this.Vub("icon"):this.isValuePreviewEnabled?void this.Ckl(v):this.Vub("card")}};this.Vub=vc=>{this.Q2f||this.da.domElement.addEventListener("scroll",this.onScroll);this.BEg();this.bFg();"card"===vc?this.control.ZWk(this.zl.cell,this.wsc,this.ota("FormulaRepairCard"),
this.fYi()):"icon"===vc&&this.control.lVk(this.zl.cell,this.e0j)};this.BEg=()=>{Object(Oc.b)(this.clearContentNotifier)&&!this.jVd&&(this.clearContentNotifier.wFb(this.twa),this.jVd=!0)};this.bFg=()=>{this.dUf&&!this.Ojb&&(this.$.userOperationManager.Kp(this.n3),this.Ojb=!0)};this.n3=(vc,md)=>{0===md.Fq&&170===md.jg.operation.operationName&&this.hide("undo");this.Ojb&&(this.$.userOperationManager.kn(this.n3),this.Ojb=!1)};this.e0j=()=>{this.control.hide("commit");this.Vub("card")};this.ota=vc=>({onCommit:this.onCommit,
onFeedback:this.onFeedback(vc),onDismiss:this.onDismiss,onIgnore:this.onIgnore,onEscape:this.onEscape,onRender:this.onRender,getItemHighlights:this.a_i});this.onCommit=vc=>{const md=this.zl.cell.rw;this.da.setCell({Text:vc.text,Fonts:[],TextRuns:[]},md,0,127,null);this.o0d&&this.Yw.p0d.ttg({Lk:md,cellText:vc.text,committed:!0});this.hide("commit",vc.text);this.da.focus()};this.onDismiss=()=>{this.wsc=null;this.da.focus()};this.onIgnore=()=>{this.Eae("ignore");this.onDismiss()};this.onEscape=()=>{this.Eae("escape");
this.onDismiss()};this.onFeedback=vc=>()=>{const md={};md[Bb.a.MF]=vc;this.$.Dc(802602464,0,19,md)};this.onRender=vc=>{vc&&(this.TA.ud=vc)};this.Epk=vc=>{const md=this.zl.id,Qd=()=>{this.zl.id===md&&void this.YUc(vc,this.zl.cell);this.da.za.Gq(Qd)};this.da.za.Or(Qd)};this.a_i=vc=>{this.WA||S.ULS.sendTraceTag(508347539,0,15,"FormulaRepair.getRepairItemHighlights: formulaHighlightsControl is null");var md=this.WA.R2i(vc.text,[Vc.HighlightKind.Parentheses]);if(!md)return null;const Qd=md.highlightRanges;
var v=md.M0c;md=[];var Qb=0;for(var Dc=0;Dc<v.length;Dc++){const id=v[Dc];md.push({start:Qb,end:Qb+id.text.length,color:id.color});Qb+=id.text.length}vc=vc.repairedFormulaParts;v=[];for(Dc=Qb=0;Qb<vc.length&&Dc<md.length;)v.push({location:{start:Math.max(vc[Qb].location.start,md[Dc].start),end:Math.min(vc[Qb].location.end,md[Dc].end)},type:vc[Qb].type,color:md[Dc].color}),vc[Qb].location.end<md[Dc].end?Qb++:(vc[Qb].location.end>md[Dc].end||Qb++,Dc++);return{coloredParts:v,highlightRanges:Qd}};this.Nh=
()=>{this.hide("edit")};this.wg=(vc,md)=>{vc=md.committed;const Qd=md.TEa;md=md.Lk;const v="keydown"===(null===Qd||void 0===Qd?void 0:Qd.type);!vc||!v||null!==Qd&&void 0!==Qd&&Qd.ctrlKey?v&&void this.YUc(vc?"editCommitted":"editDismissed"):this.QRc=md};this.twa=()=>{this.zl.cell.rw.equals(this.da.ha.oa.activeCell)&&this.hide("clearCell")};this.da=Object(Ba.f)(this.$);this.TA=new Xb(this.$,dc.a.NDf,this.u5g);this.control=new yb(this.$,this.u5g,ra,this.TA);this.da.ha.add_activeCellChanged(this.onActiveCellChanged);
this.da.Rb.qH(this.Nh);this.da.Rb.Uq(this.wg);void Ma.a.Bd(mb.FormulaAssistanceManagerService).then(vc=>{this.WA=vc.WA});this.isValuePreviewEnabled=rc.a.xka();this.yqj=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaRepairIcon",!1)&&"renderFormulaRepairIcon"in Kc;za.EwaSettings.isChangeGateEnabled("OfficeVSO:8873907_FormulaRepairHideCardOnContentClear")&&void Ma.a.resolve(mb.ClearContentNotifierService).then(vc=>{this.clearContentNotifier=vc});za.EwaSettings.isChangeGateEnabled("OfficeVSO:8885555_FormulaRepairHideCardOnUndoAfterCommit")&&
(this.dUf=!0)}Eae(ib){this.hide(ib)&&(this.x_d=!0)}async YUc(ib,xc){xc=void 0===xc?null:xc;var Kc;this.da.isEditing||this.x_d||((xc=null!==xc&&void 0!==xc?xc:null===(Kc=this.da.Ob(null))||void 0===Kc?void 0:Kc.cell,this.zl={active:!1,id:this.zl.id+1,cell:xc},this.da.za.W7())?!Object(Oc.c)(xc)&&xc.hasError&&(this.zl.active=!0,this.Yw.addressable.selected++,Kc=this.pluginScheduler.requester().formulaRepair({formula:this.zl.cell.text},Vc.PluginGroup.Excel,null),Kc=await this.tCe(Kc),Object(Oc.c)(Kc)||
"Done"!==Kc.kind?this.zl.active=!1:this.d7j(Kc.payload,ib)):this.Epk(ib))}async Ckl(ib){let xc;const Kc=new Promise(ra=>{xc=setTimeout(()=>{ra(!0)},100)});ib=Promise.race([Kc,ib]).finally(()=>clearTimeout(xc));await this.tCe(ib)&&this.Vub("card")}async Koi(ib){const xc=Array(ib.length);for(let ra=0;ra<ib.length;ra++){var Kc=this.vBe.Bke({text:ib[ra].text,index:0,length:ib[ra].text.length},2E3,!1);if((Kc=await this.tCe(Kc))&&"Success"===Kc.kind)xc[ra]=Kc.value;else return!1}ib.forEach((ra,jb)=>ra.formulaValue=
xc[jb]);this.control.THa&&Object(Oc.b)(this.control.nAe)&&this.control.nAe(ib);return!0}async tCe(ib){const xc=this.zl.id;ib=await ib;return this.zl.id===xc&&this.zl.active?ib:null}hide(ib,xc){this.zl.active=!1;this.zl.cell=null;this.Q2f&&this.da.domElement.removeEventListener("scroll",this.onScroll);this.Ojb&&(this.$.userOperationManager.kn(this.n3),this.Ojb=!1);(ib=this.control.hide(ib,xc))&&Object(Oc.b)(this.clearContentNotifier)&&(this.clearContentNotifier.q3b(this.twa),this.jVd=!1);return ib}fYi(){const ib=
this.da.ha.oa.activeCell,xc=this.zl.cell.rw;if(ib&&xc&&ib.left!==xc.left)return"below"}}Object(X.a)(yd,"FormulaRepair",null,[]);Object(Ma.b)(mb.FormulaRepairService,{we:"singleton"})(async ib=>{var xc;const Kc=await Ma.a.resolve(mb.EwaControlService,ib),ra=Ma.a.resolve(xa.f,ib),jb=Object(hb.e)(Na.GetServiceTaskFactory.Ne(Kc.ra,448,449,null!==(xc=ib.xa)&&void 0!==xc?xc:0));xc=Ma.a.resolve(mb.FormulaAssistanceManagerService,ib);const vc=Ma.a.resolve(mb.FormulaRepairTelemetryService,ib);ib=Ma.a.resolve(mb.FormulaAssistanceValuePreviewRequesterService,
ib);const [md,Qd,v,Qb]=await Promise.all([ra,jb,vc,ib,xc]);return new yd(Kc,md,Qd,v,Qb)});class Pd{constructor(ib){this.$=ib;this.D8=null;this.S4d=0;this.wg=(xc,Kc)=>{this.Bi();this.Kpj(Kc)&&this.S4d++;this.D8=null};this.da=Ba.f(this.$)}V$d(ib){this.D8=ib;this.registerEvent()}registerEvent(){this.da.cellTextEditBox.WS(this.wg)}Bi(){this.da.cellTextEditBox.zZ(this.wg)}Kpj(ib){return ib.committed&&null!==this.D8&&ib.Lk.equals(this.D8.cell)&&this.D8.repairs.some(xc=>xc.text.toLowerCase().replace(/\s+/g,
"")===ib.cellText.toLowerCase().replace(/\s+/g,""))}}Object(X.a)(Pd,"ManualFormulaRepairTelemetry",null,[]);let re=class{constructor(ib,xc){this.p0d=ib;this.$=xc;this.o0d=rc.a.LGc();this.vYb=rc.a.f2f();this.VZa=rc.a.VZa();this.KQc=!1;this.bDi=this.id=0;this.Gva=null;this.Of={reportName:"FormulaRepair",addressable:{selected:0,committed:0},repairUsage:f(),indicationUsage:f(),iconUsage:f()};this.Of.repairUsage.keptData=this.p0d.qMd();this.vYb&&(this.R4d=new Pd(this.$),this.Of.repairUsage.manualRepair=
this.R4d.S4d);this.repairUsage=this.Of.repairUsage;this.indicationUsage=this.Of.indicationUsage;this.iconUsage=this.Of.iconUsage;this.addressable=this.Of.addressable;this.zpk()}RUc(ib,xc){switch(ib.kind){case "repair":this.YRa=this.repairUsage;this.YRa.show.repairCounts.push(xc);this.MEb="repair";break;case "icon":this.YRa=this.iconUsage;this.MEb="icon";break;case "errorIndication":this.YRa=this.indicationUsage,this.MEb="errorIndication"}this.YRa.show.count++;this.Gva=performance.now();this.VZa&&
this.jce(ib,"seen");this.JXf()}Wwk(ib,xc){if(null!==this.Gva){const Kc=performance.now()-this.Gva;try{this.YRa.hideDurations[ib].push(Kc)}catch(ra){void 0===this.YRa||null===this.YRa?k(`reportHide - activeUsage is undefined or null - exception: ${ra}`):k(`reportHide - Push command failed, kind is ${ib},  exception: ${ra}`)}}else k("reportHide: lastShowTime is null");this.VZa&&("repair"===this.MEb?this.jce({kind:this.MEb,arl:this.KQc?xc:""},ib):this.jce({kind:this.MEb},ib));this.JXf();this.Gva=null}V$d(ib){this.vYb&&
this.R4d.V$d(ib)}zpk(){this.$.ra.Vc(276,ib=>{ib.g6(this.Of)})}jce(ib,xc){S.ULS.sendTraceTag(507273951,1,50,`${JSON.stringify({id:this.bDi++,component:ib,actionType:xc})}`)}JXf(){S.ULS.sendTraceTag(509137429,1,50,`${JSON.stringify({id:this.id++,addressable:this.addressable,repairUsage:this.repairUsage,iconUsage:this.iconUsage,indicationUsage:this.indicationUsage,keptData:this.o0d?this.p0d.qMd():"",manualRepair:this.vYb?this.R4d.S4d:""})}`)}};re=Object(C.__decorate)([Object(Ma.d)(mb.FormulaRepairTelemetryService),
Object(C.__param)(0,Object(mb.KeptTelemetryHandlerService)()),Object(C.__param)(1,Object(mb.EwaControlService)())],re);Object(X.a)(re,"FormulaRepairTelemetry",null,[]);var ue=a(45),He=a(91),bf=a(404),af=a(59),Pe=a(1346);let wf=null;const xf=Ac.a.oK/4,Cf=Ac.a.vT/4,tf=za.EwaSettings.hda()&&za.EwaSettings.isChangeGateEnabled("OfficeVSO:8931924_ColumnWidthCseFailureFix");let Jf=class{constructor(ib){this.$=ib;this.Ij=()=>{wf&&(He.a.vb(wf),wf=null);this.j8&&(this.$.tGc=!1)};this.da=Ba.f(this.$);this.za=
this.da.gridBlockManager;this.rU=!1;this.Nba=this.$.fa.Je;this.Pea={};this.ho={};this.j8=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GlobalStylesSlice1",!1);this.Pua=za.EwaSettings.hda();this.JQ=za.EwaSettings.JQ();this.za.Or(this.Ij);this.IU=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8780264_logFpCseUnattemptedInSingleTag");this.SUb=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8839836_LogUnfreezeAndFreezeAfterFreezeCse");this.Oua=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8775076_FreezeCseWhenRowsColumnsHidden")&&
za.EwaSettings.zUb();this.tTb=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8788453_hideSelectionForFreezePanesCse");this.p2=za.EwaSettings.hda()&&za.EwaSettings.isChangeGateEnabled("OfficeVSO:8771915_enableAsyncFreezePanesCSEOperation");this.HXd=za.EwaSettings.zUb()&&za.EwaSettings.isChangeGateEnabled("OfficeVSO:8778653_enableFreezePanesCseForSheetsWithMergeCells")}dispose(){this.da=this.$=null;this.ho={};this.rU=!1;this.Pea={};this.za.Gq(this.Ij)}wnc(ib,xc,Kc){try{if(this.rU)S.ULS.sendTraceTag(509658009,
0,15,`FreezePanesInstantaneousAction.attemptInstantaneousGridAction command=${ib}, parameter = isProcessing, value=true, reason = AttemptInstantaneousGridAction is still processing, isRow=${xc}`);else if(this.OWd(ib)){const ra=this.za.ZOb();this.Fdk(ib,null===Kc||void 0===Kc?void 0:Kc.Pn,ra)}}catch(ra){this.wRf("FreezePanesInstantaneousAction.AttemptInstantaneousGridAction",ra,ib)}}NSc(){this.Nba=this.$.fa.Je}Fdk(ib,xc,Kc){if(this.NWd(ib,Kc,xc)){this.RPc=performance.now();this.rU=!0;const ra=d(Kc);
this.ho={};this.p2?(this.Qqb(Kc),this.m3a(ib,ra,Kc,xc,new Map,new Map)):this.m3a(ib,ra,Kc,xc)}else this.da.Ce.Oda(!1)}NWd(ib,xc,Kc){var ra,jb;if(!this.MWd(ib))return this.SUb&&Object(Pe.j)("CSE not enabled for command",ib),!1;if(isNullOrUndefined(Kc))return this.IU&&Object(Pe.j)("PaneViewData Null",ib),!1;if(this.SUb&&this.da.rb.gr)return Object(Pe.j)("Freeze on top of Freeze",ib),!1;var vc=this.da;const md=vc.hd;if(this.Oua){const Qd=vc.OXa();if(1!==Qd.top||1!==Qd.left)return Object(Pe.j)("Horizontal/Vertical Scroll",
ib),!1;if(!Object(Pe.i)(vc,Kc,ib))return!1}else if(Kc.VisibleColumns+1!==Kc.FirstScrollableColumn||Kc.VisibleRows+1!==Kc.FirstScrollableRow)return this.IU?Object(Pe.j)("Horizontal/Vertical Scroll",ib):S.ULS.sendTraceTag(507650447,0,50,`FreezePanesInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${ib}, parameter = Scroll present`),!1;for(const Qd of xc){vc=Qd.oe;if(0<(null===(jb=null===(ra=null===vc||void 0===vc?void 0:vc.Content)||void 0===ra?void 0:ra.MergedRanges)||void 0===
jb?void 0:jb.length)){if(!this.HXd)return this.IU?Object(Pe.j)("Merged Cell",ib):S.ULS.sendTraceTag(507650446,0,50,`FreezePanesInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${ib}, parameter = Merged Cell present`),!1;if(!Object(Pe.b)(xc,Qd,Kc,this.da))return this.IU?Object(Pe.j)("Merged Cells Spanblocks",ib):S.ULS.sendTraceTag(507360354,0,50,`FreezePanesInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${ib}, parameter = Merged Cells Spanblocks present`),
!1}if(0<Qd.Ii.count)return this.IU?Object(Pe.j)("Floating Objects",ib):S.ULS.sendTraceTag(507650445,0,50,`FreezePanesInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${ib}, parameter = FO present`),!1;if(Qd.Nf.getHasTable())return this.IU?Object(Pe.j)("Table/PivotTable",ib):S.ULS.sendTraceTag(507650444,0,50,`FreezePanesInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${ib}, parameter = Table present`),!1;if(!this.Oua&&md.wda(Qd.Fd))return this.IU?Object(Pe.j)("Hidden Row/Col",
ib):S.ULS.sendTraceTag(507650443,0,50,`FreezePanesInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${ib}, parameter = Hidden row/col present`),!1}return!0}yea(ib,xc,Kc,ra,jb,vc,md){const Qd=vc?jb.E4a:jb.ZTa;jb=vc?jb.RDa:jb.PLa;const v=vc?"FreezeRow":"FreezeColumn";Kc=Object(Pe.d)(ib,Kc,ra,vc,md);if(!Kc)return S.ULS.sendTraceTag(507569417,0,15,`FreezePanesInstantaneousAction.processFreezePaneBlockAdjustment command=${v}, parameter = isHideRowColumnSuccessful, value=false, reason = "fpConstructionParams failed", `),
!1;if(ib&&0<=Qd){if(Kc.$0b&&!gridRenderer.CanvasRendererGlobals.performModelRowColOperation(ib,Kc.N4b,Qd,"FreezePane",vc))return S.ULS.sendTraceTag(507586704,0,15,`FreezePanesInstantaneousAction.processFreezePaneBlockAdjustment command=${v}, parameter = freezePaneRestructureSuccessful, isRow =${vc}, value=false, reason = "Restructuring was failure", `),!1;if(xc&&ib&&Kc.Z0b)if(gridRenderer.CanvasRendererGlobals.performModelCascadeRowColsOperations(xc,ib,vc?xc.RowNumbers[0]:xc.ColumnNumbers[0],Qd,"FreezePane",
vc,{rowColIndexToEndRangeCascade:jb,skipCascadingBeforeRowColIndex:Kc.skipCascadingBeforeRowColIndex,performDiagonalCascading:Kc.performDiagonalCascading}).isSuccess)S.ULS.sendTraceTag(507576470,0,50,`FreezePanesInstantaneousAction.processFreezePaneBlockAdjustment command=${v}, parameter = freezePaneBlockCascadeOperation, value=true, isRow =${vc}, reason = "BlockCascadeRowColsOperations success", `);else return S.ULS.sendTraceTag(507586703,0,15,`FreezePanesInstantaneousAction.processFreezePaneBlockAdjustment command=${v}, parameter = freezePaneBlockCascadeOperation, value=false, isRow =${vc}, reason = "BlockCascadeRowColsOperations was failure", `),
!1}return!0}Axd(ib,xc,Kc,ra,jb,vc){var md,Qd,v,Qb,Dc,id,Md=Object(Pe.f)(ib,jb,vc,this.Oua?Object(Pe.h)(this.da,jb.FirstScrollableRow,!0).tHa:0);const Sd=Object(Pe.e)(ib,jb,vc,this.Oua?Object(Pe.h)(this.da,jb.FirstScrollableColumn,!1).tHa:0);Md={PLa:Md.PLa,E4a:Md.E4a,RDa:Sd.RDa,ZTa:Sd.ZTa};switch(vc){case 1:if(!this.yea(ib,Kc,jb,vc,Md,!0,!1))return this.Vv(),S.ULS.sendTraceTag(507568152,0,15,`FreezePanesInstantaneousAction.constructFreezePaneBlocks Constructing paneType=${vc} failed, cascadingType=Row`),
null;if(!this.yea(ib,xc,jb,vc,Md,!1,!1))return this.Vv(),S.ULS.sendTraceTag(507568151,0,15,`FreezePanesInstantaneousAction.constructFreezePaneBlocks Constructing paneType=${vc} failed, cascadingType=Col`),null;if(!this.yea(ib,ra,jb,vc,Md,!1,!0))return this.Vv(),S.ULS.sendTraceTag(507568150,0,15,`FreezePanesInstantaneousAction.constructFreezePaneBlocks Constructing paneType=${vc} failed, cascadingType=Diagonal-Col`),null;break;case 2:case 3:case 4:if(!this.yea(ib,Kc,jb,vc,Md,!0,!1))return this.Vv(),
S.ULS.sendTraceTag(507568149,0,15,`FreezePanesInstantaneousAction.constructFreezePaneBlocks Constructing paneType=${vc} failed, cascadingType=Row`),null;if(!this.yea(ib,xc,jb,vc,Md,!1,!1))return this.Vv(),S.ULS.sendTraceTag(507568148,0,15,`FreezePanesInstantaneousAction.constructFreezePaneBlocks Constructing paneType=${vc} failed, cascadingType=Col`),null;break;default:return null}return new Mb.Range(null===(md=ib.RowNumbers)||void 0===md?void 0:md[0],null===(Qd=ib.ColumnNumbers)||void 0===Qd?void 0:
Qd[0],null===(v=ib.RowNumbers)||void 0===v?void 0:v[(null===(Qb=ib.RowNumbers)||void 0===Qb?NaN:Qb.length)-1],null===(Dc=ib.ColumnNumbers)||void 0===Dc?void 0:Dc[(null===(id=ib.ColumnNumbers)||void 0===id?NaN:id.length)-1],!1,!1)}Bxd(ib,xc,Kc,ra,jb,vc){const md=Object(Pe.g)(ra,Kc.FirstScrollableRow,Kc.FirstScrollableColumn);if(!md||!Kc)return S.ULS.sendTraceTag(507576400,0,15,`FreezePanesInstantaneousAction.constructNewFreezePaneBlocksForBlockPair command=${xc}, parameter = getRootBlockPostionOfFP, value=false, reason = "Construction failed", blockPosition= Failed to receive the root of FP ops `),
!1;const Qd=Kc.FirstScrollableRow,v=Kc.FirstScrollableColumn;for(let Dc=1;4>=Dc;Dc++){if(!Object(Pe.a)(ib.destination,Dc,Kc,ra))continue;const id=Object(Pe.c)(ib.destination,Qd,v,Dc,md),Md=this.cY("DestinationModel",ib.destination,xc);var Qb=ib.$7b?this.cY("SourceModel",ib.$7b,xc):null;const Sd=ib.b8b?this.cY("SourceModel",ib.b8b,xc):null,ne=1===Dc?ib.a8b?this.cY("SourceModel",ib.a8b,xc):null:null;if(Qb=this.Axd(Md,Sd,Qb,ne,Kc,Dc))jb.set(Qb,Md),vc.set(Qb,{kk:id,Fd:Qb,QHb:ib.destination}),S.ULS.sendTraceTag(507586701,
0,50,`FreezePanesInstantaneousAction.constructNewFreezePaneBlocksForBlockPair command=${xc}, parameter = isNewBlockConstructionSuccessful, value=true, reason = "Construction Successful", blockPosition=${JSON.stringify(id)}, paneType=${Dc}, `);else return S.ULS.sendTraceTag(507586700,0,15,`FreezePanesInstantaneousAction.constructNewFreezePaneBlocksForBlockPair command=${xc}, parameter = isNewBlockConstructionSuccessful, value=false, reason = "Construction failed", blockPosition=${JSON.stringify(id)}, paneType=${Dc}, `),
!1}return!0}b$b(ib,xc,Kc,ra){if(this.p2&&this.X5("WebServiceResponseReceivedInUpdateBlockCacheWithConstructedBlock",ra,1844679312,void 0))return S.ULS.sendTraceTag(507381976,0,15,'FreezePanesInstantaneousAction.updateBlockCacheWithConstructedBlock command=1844679312, parameter = WebServerResponseReceived , value=false, reason = "Latest server response" '),!1;try{const jb=$c.HelperMethods.Lb();let vc=!0;ib.forEach((md,Qd)=>{if(vc)if(Qd=xc.get(Qd)){var v=this.za.Fh(Qd.QHb.la,Qd.kk);this.tve(md,v);this.za.Ezg(Qd.kk,
Qd.QHb.la)?vc=this.za.j7g(v,md,Qd.kk,this.Nba,Kc):(S.ULS.sendTraceTag(507570071,0,50,'FreezePanesInstantaneousAction.updateBlockCacheWithConstructedBlock command=freezeOrUnfreezeOperation, parameter = primeCacheItem, value=false, reason = "Prime Cache Items failed"'),vc=!1)}else vc=!1});if(!vc)return!1;m("updateBlockCacheWithConstructedBlock",$c.HelperMethods.Lb()-jb,1844679312);return!0}catch(jb){return S.ULS.sendTraceTag(507570070,0,10,`encountered exception in updateBlockCacheWithConstructedBlock : ${jb}`),
!1}}m3a(ib,xc,Kc,ra,jb,vc){ra=void 0===ra?null:ra;try{if(this.X5("WebServiceResponseReceivedInProcessFreezePanesGridAction",Kc,ib,void 0))S.ULS.sendTraceTag(507586699,0,15,`FreezePanesInstantaneousAction.processFreezePanesGridAction command=${ib}, parameter = WebServerResponseReceived , value=false, reason = "Latest server response" `);else{var md=$c.HelperMethods.Lb(),Qd=za.EwaSettings.zYb(),v=[];if(this.p2){v=xc.filter(id=>!id.sI);var Qb=jb;var Dc=vc}else this.Qqb(Kc),v=xc,Qb=new Map,Dc=new Map;
for(const id of v)if(id.destination){if(!this.Bxd(id,ib,ra,Kc,Qb,Dc)){this.Vv();S.ULS.sendTraceTag(507586698,0,15,`FreezePanesInstantaneousAction.processFreezePanesGridAction command=${ib}, parameter = isBlockConstructionForPairSuccessful, value=false, reason = "Construction failed", hashCode = ${id.destination.Yc} , `);return}if(this.p2&&(id.sI=!0,$c.HelperMethods.Lb()-md>Qd)){this.Bme(ib,xc,Kc,ra,Qb,Dc);return}}Qb.size!==Dc.size?S.ULS.sendTraceTag(507576399,0,15,`FreezePanesInstantaneousAction.processFreezePanesGridAction command=${ib}, parameter = processFreezePaneGridOperation, value=false, reason = "Constructed models not matching with constructed panes" `):
(xc=!1,(xc=this.p2?this.b$b(Qb,Dc,ra,Kc):this.b$b(Qb,Dc,ra))?this.sje(ib,ra,Kc)?(S.ULS.sendTraceTag(507360353,0,50,`FreezePanesInstantaneousAction.processFreezePanesGridAction command=${ib}, parameter = processFreezePanesGridAction, value=true, reason = "Freeze Panes CSE operation complete" `),m("ProcessFreezePanesGridAction",$c.HelperMethods.Lb()-md,ib)):(this.A4a(Kc),S.ULS.sendTraceTag(507381975,0,15,`FreezePanesInstantaneousAction.processFreezePanesGridAction command=${ib}, parameter = renderFreezePanesGrid, value=false, reason = "Updating constructing model failed" `)):
(this.A4a(Kc),S.ULS.sendTraceTag(507570069,0,15,`FreezePanesInstantaneousAction.processFreezePanesGridAction command=${ib}, parameter = updateBlockCacheItem, value=false, reason = "Updating constructing model failed" `)))}}catch(id){this.A4a(Kc),this.wRf("FreezePanesInstantaneousAction.ProcessFreezePanesGridAction",id,ib)}}sje(ib,xc,Kc){const ra=$c.HelperMethods.Lb();if(this.p2&&this.X5("WebServiceResponseReceivedInRenderFreezePanesGridInstantaneousActionResults",Kc,1844679312,void 0))return S.ULS.sendTraceTag(507381974,
0,15,'FreezePanesInstantaneousAction.updateBlockCacheWithConstructedBlock command=1844679312, parameter = WebServerResponseReceived , value=false, reason = "Latest server response" '),!1;Kc=Yb.a.create().toString();const jb=this.za.WQ;bf.b(this.$.la,xc,this.Nba,void 0,!0);xc=this.da.hd;this.tTb&&this.da.Ub.Rjb();this.da.wo.L1c(xc,this.da.rb,!0,xf,Cf,this.da.uQ());xc=Object.keys(this.ho);this.za.d2b(xc,Kc,"both",!0);this.tTb&&(this.da.Ub.Swb(),this.da.Ub.wfa({EV:!0,fU:!0}));this.rU=!1;wf=ue.a(this.$).hg.tha(6,
"FreezePanesInstantaneousAction.renderFreezePanesGridInstantaneousActionResults",void 0,pa.a.instance.ia(2188));this.JQ&&Fa.a.Zg(this.za.WQ)&&this.za.MXc(jb,1);this.DKc();m("renderFreezePaneGridInstantaneousActionResults",$c.HelperMethods.Lb()-ra,ib);return!0}A4a(ib){ib.forEach(xc=>{xc.UD=0;xc.oe.PaneViewData=null});this.za.Uxa({Bsa:!0,Csa:"FreezePaneNewCseBlocksDisposed"});this.mVc(ib);this.Vv()}cY(ib,xc,Kc){let ra=this.ho[xc.Yc];if(!ra){const jb=$c.HelperMethods.iG(()=>{ra=xc.TGf()});m(ib,jb,Kc)}return ra}Qqb(ib){for(const xc of ib)ib=
xc.Yc,this.Pea[ib]||(this.Pea[ib]=xc.Eja())}mVc(ib){for(const xc of ib){ib=xc.Yc;const Kc=this.Pea[ib];if(Kc&&!xc.EUc(Kc)){S.ULS.sendTraceTag(509653846,0,15,`FreezePanesInstantaneousAction.restoreBlockModels parameter = isModelRestored, value=false, hashCode=${ib}`);this.Vv();break}}}Bme(ib,xc,Kc,ra,jb,vc){window.setTimeout(()=>{this.m3a(ib,xc,Kc,ra,jb,vc)},0)}v_d(ib){for(const xc of ib)if(xc.oe.Information.Revision>this.Nba)return!0;return!1}X5(ib,xc,Kc,ra){return this.v_d(xc)?(this.Nba=this.$.fa.Je,
this.Vv(),S.ULS.sendTraceTag(509657992,0,50,`FreezePanesInstantaneousAction.abortIfServerResponseReceived command=${Kc}, parameter = ${ib}, value=true, reason = "Server response received before completing client side estimation", isRow=${ra}}`),!0):!1}Vv(){this.ho={};this.rU=!1;this.Pea={};this.da.Ce.Oda(!1)}wRf(ib,xc,Kc){this.Vv();S.ULS.sendTraceTag(509723721,0,10,`${ib} encountered exception ${xc} for command=${Kc}`)}tve(ib,xc){this.ho[xc]=ib}OWd(ib){return-73576432===ib||-806625837===ib||-1564089444===
ib||340334732===ib||1844679312===ib||83934709===ib?!0:!1}MWd(ib){switch(ib){case -806625837:case 340334732:case 1844679312:case -1564089444:case -73576432:return this.Pua;case 83934709:return!1;default:return!1}}DKc(){const ib=performance.now()-this.RPc;this.da.Ce&&this.$.fa&&this.da.Ce.Qdg(ib)}};Jf=Object(C.__decorate)([Object(Ma.d)(mb.FreezePanesInstantaneousActionService),Object(C.__param)(0,Object(mb.EwaControlService)())],Jf);Object(X.a)(Jf,"FreezePanesInstantaneousAction",null,[224]);var dg=
a(31),uf=a(944),lf=a(121),Pf=a(491);class Rf{static getSelection(ib,xc,Kc){var ra=ib.oa;ib=ra.activeCell.clone();ra=ra.activeRange;ra.Oe&&(S.ULS.sendTraceTag(507556643,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top (${ib.top}) and firstUnfreezeCell.Bottom (${ib.bottom}) to equal topLeftRange.Top (${xc.top})`),ib.top=ib.bottom=xc.top);ra.isRow&&(S.ULS.sendTraceTag(507556642,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left (${ib.left}) and firstUnfreezeCell.Right (${ib.right}) to equal topLeftRange.Left (${xc.left})`),
ib.left=ib.right=xc.left);if(za.EwaSettings.isChangeGateEnabled("OfficeVSO:8599861_RowColumnFreezeOnLastBlockFix"))switch(Kc.command){case -73576432:case -1156879868:ib.top===ib.maxRows&&(ib.top=ib.bottom=ib.maxRows-1);break;case -1564089444:case -1929078919:ib.left===ib.maxColumns&&(ib.left=ib.right=ib.maxColumns-1)}return ib}static uVb(ib,xc){if(ib.Iy(xc))return!0;for(const Kc of ib.$p){if(!ib.rb.By(Kc.paneType))continue;const ra=ib.Wg(xc,Kc.paneType),jb=Kc.ul;if(ra&&jb&&Rf.JTb(ra,jb))return!0}return!1}static JTb(ib,
xc){return!ib||xc.topLeft.y>ib.bottomRight.y||xc.topLeft.x>ib.bottomRight.x||xc.bottomRight.y<ib.bottomRight.y||xc.bottomRight.x<ib.bottomRight.x?!1:!0}static ZK(ib,xc,Kc,ra){if(za.EwaSettings.isChangeGateEnabled("OfficeVSO:8581986_FreezePanesPreviewTelemetry")){var jb="FreezePanesCommandHandler.LogFreezePreviewTelemetry: ",vc={};vc.operationType=Pf.a(xc.command);vc.isSuccessful=Kc;vc.preExistingPanes=ib.rb.gr;vc.message=ra?ra:"";jb+=La.a.Nc(vc);S.ULS.sendTraceTag(507556641,0,50,jb)}}static J0a(ib,
xc,Kc,ra,jb){S.ULS.sendTraceTag(507381773,0,50,JSON.stringify({preExistingPanes:ib.rb.gr,message:null!==jb&&void 0!==jb?jb:"",dragOrigin:xc,dragDirection:Kc,eventName:ra}))}static GPb(ib){var xc=ib.OXa();if(za.EwaSettings.isChangeGateEnabled("OfficeVSO:8728140_FreezePanesHiddenRowColFix")){ib=ib.hd;var Kc=Math.max(xc.top,ib.VT(xc.top,!0,!0));xc=Math.max(xc.left,ib.VT(xc.left,!1,!0));return{rowNumber:Kc,columnNumber:xc}}Kc=ib.gQ(!0);ib=ib.gQ(!1);return{rowNumber:Kc>xc.top?Kc:xc.top,columnNumber:ib>
xc.left?ib:xc.left}}}Object(X.a)(Rf,"FreezePanesUtils",null,[]);var Mf=a(138),zf;(function(ib){ib[ib.HORIZONTAL=0]="HORIZONTAL";ib[ib.VERTICAL=1]="VERTICAL";ib[ib.BOTH=2]="BOTH"})(zf||(zf={}));Object(X.b)("FreezePanesPreviewDirection",zf);var df;(function(ib){ib[ib.TOPLEFT=0]="TOPLEFT";ib[ib.BOTTOMRIGHT=1]="BOTTOMRIGHT"})(df||(df={}));Object(X.b)("FreezePanesPreviewPosition",df);class Bf{constructor(ib){this.da=ib}U7h(ib){Bf.bBa||ib===zf.VERTICAL||(Bf.bBa=document.createElement("div"),Bf.bBa.classList.add(dg.a.pyf),
Bf.bBa.role="presentation",this.da.nh.appendChild(Bf.bBa));Bf.Caa||ib===zf.HORIZONTAL||(Bf.Caa=document.createElement("div"),Bf.Caa.classList.add(dg.a.qyf),Bf.Caa.role="presentation",this.da.nh.appendChild(Bf.Caa))}WGd(ib,xc){xc=void 0===xc?df.BOTTOMRIGHT:xc;var Kc=this.da.rb.TE,ra=this.da.rb.UG;var jb=this.da.rb.Gg;const vc=this.da.rb.Vg,{OE:md,Gw:Qd}=this.da.X1(),v=this.da.hd;if(v&&(!za.EwaSettings.isChangeGateEnabled("OfficeVSO:8934120_FailSafeIfNull")||md&&Qd)){var Qb=this.dY(v,md.top,md.left);
xc=this.dY(v,ib.top+xc,ib.left+xc);var Dc=this.dY(v,jb,vc);var id=Qd.x+Qb.Ke-Dc.Ke,Md=Qd.y+Qb.ye-Dc.ye;Qb=this.da.nn;var Sd=this.da.uz;Dc=Sd+xc.ye-Md;0<Kc&&(Kc=this.pta(v,0,0),Dc=ib.top<jb?Sd+xc.ye-Kc.ye:Sd+xc.ye-Kc.ye-Md);jb=Qb+xc.Ke-id;0<ra&&(ra=this.pta(v,0,0),jb=vc>ib.left?Qb+xc.Ke-ra.Ke:Qb+xc.Ke-ra.Ke-id);return{Vjb:jb,mxb:Dc}}}Tub(ib,xc,Kc){Kc=void 0===Kc?df.BOTTOMRIGHT:Kc;ib=this.WGd(ib,Kc);void 0!==ib?this.qVk(ib.Vjb,ib.mxb,xc):sa.Task.Va(!1)}qVk(ib,xc,Kc){this.U7h(Kc);Kc!==zf.BOTH&&Kc!==
zf.HORIZONTAL||!this.fVh(xc)||(Bf.bBa.style.top=$c.HelperMethods.$c(Math.max(xc,this.da.uz)));Kc!==zf.BOTH&&Kc!==zf.VERTICAL||!this.jVh(ib)||(this.da.rtl?(Bf.Caa.style.left="unset",Bf.Caa.style.right=$c.HelperMethods.$c(Math.max(ib,this.da.nn))):(Bf.Caa.style.right="unset",Bf.Caa.style.left=$c.HelperMethods.$c(Math.max(ib,this.da.nn))));sa.Task.Va(!0)}fVh(ib){return za.EwaSettings.isChangeGateEnabled("OfficeVSO:8762407_FreezePanesDragShadowHeadersScrollBarFix")?ib>=this.da.nh.clientHeight-Mf.a.Gt?
(this.wHa(zf.HORIZONTAL),!1):!0:!0}jVh(ib){return za.EwaSettings.isChangeGateEnabled("OfficeVSO:8762407_FreezePanesDragShadowHeadersScrollBarFix")?ib>=this.da.nh.clientWidth-Mf.a.Gt?(this.wHa(zf.VERTICAL),!1):!0:!0}wHa(ib){ib=void 0===ib?zf.BOTH:ib;ib!==zf.HORIZONTAL&&ib!==zf.BOTH||!Bf.bBa||(this.da.nh.removeChild(Bf.bBa),Bf.bBa=null);ib!==zf.VERTICAL&&ib!==zf.BOTH||!Bf.Caa||(this.da.nh.removeChild(Bf.Caa),Bf.Caa=null);return sa.Task.Va(!0)}dY(ib,xc,Kc){return ib.AK(lf.a.Hc(xc,Kc))}pta(ib,xc,Kc){const {rowNumber:ra,
columnNumber:jb}=Rf.GPb(this.da);return this.dY(ib,ra+xc,jb+Kc)}freezePanesRowAndColumnPreview(ib,xc){let Kc=!0,ra=!0,jb=df.TOPLEFT;var vc=this.da.hd;if(!vc)return Rf.ZK(this.da,ib,!1,"sheetProcessedData is not available."),sa.Task.Va(!1);xc=Rf.getSelection(this.da.ha,xc,ib);if(!Rf.uVb(this.da,xc))return Rf.ZK(this.da,ib,!0,"Preview not shown as selection is not in visible area"),sa.Task.Va(!0);switch(ib.command){case -1006176541:var md=this.da.rb.Gg;const v=this.da.rb.Vg,{OE:Qb,Gw:Dc}=this.da.X1();
if(za.EwaSettings.isChangeGateEnabled("OfficeVSO:8934120_FailSafeIfNull")&&(!Qb||!Dc))return sa.Task.Va(!0);const id=this.pta(vc,0,0);var Qd=this.dY(vc,Qb.top,Qb.left);const Md=this.dY(vc,xc.top,xc.left);vc=this.dY(vc,md,v);md=Dc.x+Qd.Ke-vc.Ke;Qd=Dc.y+Qd.ye-vc.ye;if(Md.ye===id.ye&&Md.Ke===id.Ke)return this.M0b(ib);if(Md.ye===id.ye||Md.ye<=id.ye||Md.AE>=vc.AE&&Md.ye<vc.ye+Qd)Kc=!1;if(Md.ye===id.ye&&Md.Ke===id.Ke||Md.Ke<=id.Ke||Md.ND>=vc.ND&&Md.Ke<vc.Ke+md)ra=!1;break;case -1156879868:jb=df.BOTTOMRIGHT;
ra=!1;break;case -1929078919:jb=df.BOTTOMRIGHT;Kc=!1;break;default:return Rf.ZK(this.da,ib,!1,"Unexpected preview Ribbon Command"),sa.Task.Va(!0)}ra&&this.Tub(xc,zf.VERTICAL,jb);Kc&&this.Tub(xc,zf.HORIZONTAL,jb);Rf.ZK(this.da,ib,!0);return sa.Task.Va(!0)}M0b(ib){const {rowNumber:xc,columnNumber:Kc}=Rf.GPb(this.da),ra=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8728140_FreezePanesHiddenRowColFix")?Mb.Range.Hc(xc,Kc):this.da.SXa();this.Tub(ra,zf.HORIZONTAL,df.BOTTOMRIGHT);Rf.ZK(this.da,ib,!0);return sa.Task.Va(!0)}Mbe(ib){const {rowNumber:xc,
columnNumber:Kc}=Rf.GPb(this.da),ra=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8728140_FreezePanesHiddenRowColFix")?Mb.Range.Hc(xc,Kc):this.da.SXa();this.Tub(ra,zf.VERTICAL,df.BOTTOMRIGHT);Rf.ZK(this.da,ib,!0);return sa.Task.Va(!0)}}Object(X.a)(Bf,"FreezePanesPreviewManager",null,[]);var Kf;(function(ib){ib.HORIZONTAL="horizontal";ib.VERTICAL="vertical"})(Kf||(Kf={}));Object(X.b)("FreezePanesDragDirection",Kf);var Vf;(function(ib){ib.HEADER="header";ib.FREEZEPANELINE="freezepaneline"})(Vf||(Vf=
{}));Object(X.b)("FreezePaneDragOrigin",Vf);let sb=class{constructor(ib,xc){this.da=ib;this.lm=xc;this.oha=this.Kga=null;this.DLe=!1;this.lec=this.KRa=this.KPa=this.c0e=this.ANe=null;this.U9a=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8857299_RevertLostPointerCapture");this.aBa=this.tCa=Vf.HEADER;this.kVe="PointerCaptureLost";this.jVe="PointerCancelledTriggered";this.vic=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8833911_MoveFPDragListenersToDOM");this.Ung=()=>{this.h1c(Kf.HORIZONTAL)};this.Tng=
()=>{this.h1c(Kf.HORIZONTAL)};this.xug=()=>{this.h1c(Kf.VERTICAL)};this.wug=()=>{this.h1c(Kf.VERTICAL)};this.Wng=Kc=>{Kc.preventDefault();this.ANe=Kc.clientY;this.lm.startTrackAnimation(Kc,this.aBa===Vf.HEADER?"freeze_pane_header_drag_horizontal":"freeze_pane_line_drag_horizontal");this.N5e(Kf.HORIZONTAL);this.gH||(this.gH=document.createElement("div"),this.gH.classList.add(dg.a.Evi),this.da.nh.appendChild(this.gH));this.lec=this.da.nh.getBoundingClientRect();this.gH.style.display="block";this.gH.style.top=
$c.HelperMethods.isStandardZoomCssSupportedByBrowser?(Kc.clientY-this.lec.top)/this.da.aM+"px":Kc.clientY/this.da.aM-this.lec.top+"px";this.gH.setPointerCapture(Kc.pointerId);this.gH.style.cursor="grabbing";Rf.J0a(this.da,this.aBa,Kf.HORIZONTAL,"FreezePaneDragStarted");this.U9a||this.gH.addEventListener("lostpointercapture",this.Vng);this.vic?(document.addEventListener("pointermove",this.iOc),document.addEventListener("pointerup",this.jOc),document.addEventListener("pointercancel",this.hOc)):(this.gH.addEventListener("pointermove",
this.iOc),this.gH.addEventListener("pointerup",this.jOc),this.gH.addEventListener("pointercancel",this.hOc))};this.zug=Kc=>{this.lm.startTrackAnimation(Kc,this.tCa===Vf.HEADER?"freeze_pane_header_drag_vertical":"freeze_pane_line_drag_vertical");Kc.preventDefault();this.c0e=Kc.clientX;this.N5e(Kf.VERTICAL);this.nH||(this.nH=document.createElement("div"),this.nH.classList.add(dg.a.Hvi),this.da.nh.appendChild(this.nH));this.nH.style.display="block";this.nH.style.left=Kc.clientX/this.da.aM+"px";this.nH.setPointerCapture(Kc.pointerId);
this.nH.style.cursor="grabbing";Rf.J0a(this.da,this.tCa,Kf.VERTICAL,"FreezePaneDragStarted");this.U9a||this.nH.addEventListener("lostpointercapture",this.yug);this.vic?(document.addEventListener("pointermove",this.JPc),document.addEventListener("pointerup",this.KPc),document.addEventListener("pointercancel",this.IPc)):(this.nH.addEventListener("pointermove",this.JPc),this.nH.addEventListener("pointerup",this.KPc),this.nH.addEventListener("pointercancel",this.IPc))};this.iOc=Kc=>{const ra=$c.HelperMethods.$c(this.da.uz),
jb=$c.HelperMethods.$c(Kc.clientY/this.da.aM-this.lec.top/($c.HelperMethods.isStandardZoomCssSupportedByBrowser?this.da.aM:Ac.a.IC)),vc=`calc(100% - ${$c.HelperMethods.$c(Mf.a.Gt)} - 2px)`;this.gH.style.top=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8762407_FreezePanesDragShadowHeadersScrollBarFix")?`clamp(${ra}, ${jb}, ${vc})`:jb;(this.KPa=this.rBi(Kc))?this.XAa.Tub(this.KPa,0):this.XAa.wHa(0)};this.JPc=Kc=>{const ra=this.da.rtl?$c.HelperMethods.$c(Mf.a.Gt):$c.HelperMethods.$c(this.da.nn),jb=
$c.HelperMethods.$c(Kc.clientX/this.da.aM),vc=`calc(100% - ${$c.HelperMethods.$c(this.da.rtl?this.da.nn:Mf.a.Gt)} - 2px)`;this.nH.style.left=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8762407_FreezePanesDragShadowHeadersScrollBarFix")?`clamp(${ra}, ${jb}, ${vc})`:jb;(this.KRa=this.NBi(Kc))?this.XAa.Tub(this.KRa,1):this.XAa.wHa(1)};this.Vng=Kc=>this.U9d(Kc,!0,this.kVe);this.yug=Kc=>this.Gae(Kc,!0,this.kVe);this.hOc=Kc=>this.U9d(Kc,!0,this.jVe);this.IPc=Kc=>this.Gae(Kc,!0,this.jVe);this.KPc=Kc=>
this.Gae(Kc,!1);this.jOc=Kc=>this.U9d(Kc,!1);this.U9d=(Kc,ra,jb)=>{const vc=performance.now();Rf.J0a(this.da,this.aBa,Kf.HORIZONTAL,ra?"FreezePaneDragCancelled":"FreezePaneDragEnded",jb);this.gH.style.display="none";this.vic?(document.removeEventListener("pointermove",this.iOc),document.removeEventListener("pointerup",this.jOc),document.removeEventListener("pointercancel",this.hOc)):(this.gH.removeEventListener("pointermove",this.iOc),this.gH.removeEventListener("pointerup",this.jOc),this.gH.removeEventListener("pointercancel",
this.hOc));this.U9a||this.gH.removeEventListener("lostpointercapture",this.Vng);this.XAa.wHa(0);this.lm.stopTrackAnimation(this.aBa===Vf.HEADER?"freeze_pane_header_drag_horizontal":"freeze_pane_line_drag_horizontal");if(!this.U9a&&ra)return this.KPa=null,!0;if(this.ANe===Kc.clientY)return!0;this.KPa?this.da.$.Dc(-73576432,2,30,{dragProperties:{dragDirection:Kf.HORIZONTAL,dragOrigin:this.aBa,target:this.DHh(this.KPa),dragReleasedTime:vc}}):this.da.$.Dc(83934709,2,30,{dragProperties:{dragDirection:Kf.HORIZONTAL,
dragOrigin:this.aBa,target:null,dragReleasedTime:vc,unfreeze:!0}});this.KPa=null;return!0};this.Gae=(Kc,ra,jb)=>{const vc=performance.now();this.nH.style.display="none";Rf.J0a(this.da,this.tCa,Kf.VERTICAL,ra?"FreezePaneDragCancelled":"FreezePaneDragEnded",jb);this.vic?(document.removeEventListener("pointermove",this.JPc),document.removeEventListener("pointerup",this.KPc),document.removeEventListener("pointercancel",this.IPc)):(this.nH.removeEventListener("pointermove",this.JPc),this.nH.removeEventListener("pointerup",
this.KPc),this.nH.removeEventListener("pointercancel",this.IPc));this.U9a||this.nH.removeEventListener("lostpointercapture",this.yug);this.XAa.wHa(1);this.lm.stopTrackAnimation(this.tCa===Vf.HEADER?"freeze_pane_header_drag_vertical":"freeze_pane_line_drag_vertical");if(this.c0e===Kc.clientX)return!0;if(!this.U9a&&ra)return this.KRa=null,!0;this.KRa?this.da.$.Dc(-1564089444,2,30,{dragProperties:{dragDirection:Kf.VERTICAL,dragOrigin:this.tCa,target:this.CHh(this.KRa),dragReleasedTime:vc}}):this.da.$.Dc(83934709,
2,30,{dragProperties:{dragDirection:Kf.VERTICAL,dragOrigin:this.tCa,target:null,dragReleasedTime:vc,unfreeze:!0}});this.KRa=null;return!0};this.rBi=Kc=>{const {position:ra,area:jb,Off:vc}=this.wBf(Kc);if(!vc||!jb||!ra)return null;if(ra.y-jb.topLeft.y<jb.height/2){Kc=this.da.hd.uyc(vc);Kc=Mb.Range.Hc(Kc.top,Kc.left);if(Kc.equals(vc))return null;const md=this.XAa.WGd(Kc);return void 0!==md&&md.mxb<=this.da.uz?null:Kc}return vc};this.NBi=Kc=>{const {position:ra,area:jb,Off:vc}=this.wBf(Kc);if(!vc||!jb||
!ra)return null;if(ra.x-jb.topLeft.x<jb.width/2){Kc=this.da.hd.mAc(vc);Kc=Mb.Range.Hc(Kc.top,Kc.left);if(Kc.equals(vc))return null;const md=this.XAa.WGd(Kc);return void 0!==md&&md.Vjb<=this.da.nn?null:Kc}return vc};this.XAa=new Bf(this.da)}Ihj(){this.Kga&&this.oha||(this.Kga=Rc.DOMElementExtensions.getElementById(this.da.nh,Bb.a.SDf),this.oha=Rc.DOMElementExtensions.getElementById(this.da.nh,Bb.a.TDf));this.DLe||(this.Kga.addEventListener("pointerdown",this.Wng),this.oha.addEventListener("pointerdown",
this.zug),za.EwaSettings.isChangeGateEnabled("OfficeVSO:8830745_FreezePanesColorChangeOnHover")&&(this.Kga.addEventListener("mouseover",this.Ung),this.Kga.addEventListener("mouseout",this.Tng),this.oha.addEventListener("mouseover",this.xug),this.oha.addEventListener("mouseout",this.wug)),this.DLe=!0)}h1c(ib){const xc=Rc.DOMElementExtensions.getElementsByClassName(this.da.nh,ib===Kf.HORIZONTAL?dg.a.Dyf:dg.a.hzf);for(let Kc=0;Kc<xc.length;Kc++)xc[Kc].classList.toggle(ib===Kf.HORIZONTAL?dg.a.Qvi:dg.a.bxi)}P7g(ib,
xc){ib?(this.Kga.className=dg.a.Fvi,this.aBa=Vf.FREEZEPANELINE):(this.Kga.className=dg.a.ryf,this.aBa=Vf.HEADER);xc?(this.oha.className=dg.a.Gvi,this.tCa=Vf.FREEZEPANELINE):(this.oha.className=dg.a.syf,this.tCa=Vf.HEADER)}dispose(){this.Kga.removeEventListener("pointerdown",this.Wng);this.oha.removeEventListener("pointerdown",this.zug);za.EwaSettings.isChangeGateEnabled("OfficeVSO:8830745_FreezePanesColorChangeOnHover")&&(this.Kga.removeEventListener("mouseover",this.Ung),this.Kga.removeEventListener("mouseout",
this.Tng),this.oha.removeEventListener("mouseover",this.xug),this.oha.removeEventListener("mouseout",this.wug));this.gH&&this.da.nh.removeChild(this.gH);this.nH&&this.da.nh.removeChild(this.nH)}N5e(ib){const xc=this.da.rb;if(xc.gr){var Kc=xc.TE,ra=xc.UG;ib===Kf.HORIZONTAL&&0<Kc?this.da.Ix(Mb.Range.lQ(xc.Gg,xc.Gg,!0),60,"FreezePaneDragAction.adjustScroll"):ib===Kf.VERTICAL&&0<ra&&this.da.Ix(Mb.Range.bY(xc.Vg,xc.Vg,!0),60,"FreezePaneDragAction.adjustScroll")}}wBf(ib){var xc=new Sys.UI.DomEvent(ib);
ib=new Sys.UI.Point(ib.clientX/this.da.aM,ib.clientY/this.da.aM);xc=this.da.ha.r0(ib,xc.target,-1,!0);const Kc=this.da.Wg(xc,this.da.paneType,!0),ra=this.da.pg(this.da.paneType);return{position:uf.a.hA(ra.view.Ci,this.da.domElement.parentNode,ib,this.da.rtl),area:Kc,Off:xc}}DHh(ib){return ib&&ib.top===Ac.a.sf?Object(ba.F)(this.da.hd.uyc(ib)):ib}CHh(ib){return ib&&ib.left===Ac.a.rf?Object(ba.F)(this.da.hd.mAc(ib)):ib}};sb=Object(C.__decorate)([Object(Ma.d)(mb.FreezePaneDragService),Object(C.__param)(0,
Object(mb.GridViewService)()),Object(C.__param)(1,Object(mb.InteractivityTrackerServiceIdentifier)())],sb);Object(X.a)(sb,"FreezePaneDragAction",null,[461,4]);var Gc=a(681);class ad{}Object(X.a)(ad,"FreezePanesCommandParameters",null,[]);var Wd=a(33),je=a(312),Ie=a(300);class Je{constructor(ib){this.freezeOptions=null;this.freezeOptions=ib}getSheetName(){return this.freezeOptions.SheetName}}Object(X.a)(Je,"MacroRecorderSheetPaneFrozenPayload",null,[67]);var $e=a(310),Ib=a(20),Nb,Bc;(function(ib){ib[ib.horizontal=
0]="horizontal";ib[ib.vertical=1]="vertical"})(Bc||(Bc={}));Object(X.b)("Direction",Bc);var Af;(function(ib){ib.DRAG_HANDLE="DRAG_HANDLE";ib.RIBBON="RIBBON"})(Af||(Af={}));Object(X.b)("FreezePanesRequestInitiator",Af);let gf=Nb=class{constructor(ib,xc,Kc,ra,jb){this.$=ib;this.da=Kc;this.Qhb=this.Jee=null;this.BMb=this.lag=this.Lsf=this.ugb=!1;this.Zfa=Ib.a.XD;this.reh=Bb.a.UDf;this.Pgh=Bb.a.VDf;this.fyc=this.HId=this.gta=this.Pua=!1;this.Nzf=this.Ozf=this.Lzf=this.Mzf=0;this.h8=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8683456_FreezePanePreviewRefactor");
this.CGc=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesImprovements",!1);this.RMd=(vc,md,Qd,v)=>{const Qb=this.da.rb,Dc=this.da.TT(),id=Qb.TE,Md=Qb.UG;let Sd=0,ne=0,Ce=0,Ge=0;const Ee=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8528403_FixFreezePaneCalcWhenGridUnderPane");switch(vc.command){case 1844679312:Sd=Qd.top-1;ne=Qd.left-1;Ce=Sd-(md.top-1);Ge=ne-(md.left-1);Ee&&Qb.gr&&(id&&Dc&&Ce>=Dc.bottom-Dc.top+1+id&&(Ce=id+(Qd.top-Dc.top)+1),Md&&Dc&&Ge>=Dc.right-Dc.left+1+Md&&
(Ge=Md+(Qd.left-Dc.left)+1));break;case -73576432:Sd=Qd.top;Ce=Sd-(md.top-1);Ee&&Qb.gr&&id&&Dc&&Ce>=Dc.bottom-Dc.top+1+id&&(Ce=id+(Qd.top-Dc.top)+1);v&&(ne=Qb.Vg-1,Ge=ne-md.left+1,Ee&&Qb.gr&&Md&&Dc&&Ge>=Dc.right-Dc.left+1+Md&&(Ge=Md+(Qb.Vg-Dc.left)+1));break;case -1564089444:ne=Qd.left,Ge=ne-(md.left-1),Ee&&Qb.gr&&Md&&Dc&&Ge>=Dc.right-Dc.left+1+Md&&(Ge=Md+(Qd.left-Dc.left)+1),v&&(Sd=Qb.Gg-1,Ce=Sd-md.top+1,Ee&&Qb.gr&&id&&Dc&&Ce>=Dc.bottom-Dc.top+1+id&&(Ce=id+(Qb.Gg-Dc.top)+1))}return{Gbe:Sd,Fbe:ne,
MId:Ce,LId:Ge}};this.Tmg=()=>{za.EwaSettings.isChangeGateEnabled("OfficeVSO:8593029_RevertFPLinesIfExist")&&(this.h8?this.CWa.wHa():this.tzg());za.EwaSettings.isChangeGateEnabled("OfficeVSO:8927480_FreezePanesRowsAndColumns")&&za.EwaSettings.isChangeGateEnabled("OfficeVSO:8551192_HighlightSelectionPostFreezeOp")&&(this.da.Ub.Swb(),this.da.Ub.wfa());if(this.Qhb){const vc=je.a(Wd.a.zb.me,this.Qhb);Nb.Wz.totalDuration=vc;const md=Nb.Wz;this.Lsf?window.requestIdleCallback?window.requestIdleCallback(()=>
{this.F2e(md);this.H9d(md)}):window.setTimeout(()=>{this.F2e(md);this.H9d(md)},100):this.H9d(md)}Nb.Wz={};this.Qhb=null;this.VPc()};this.CYj=(vc,md)=>{var Qd,v,Qb,Dc;Nb.Wz.EcsOperationDuration=null===(Qd=vc.RequestTelemetryData)||void 0===Qd?void 0:Qd.EcsOperationDuration;Nb.Wz.WfeRequestDuration=null===(v=vc.RequestTelemetryData)||void 0===v?void 0:v.WfeRequestDuration;Nb.Wz.EcsRequestDurations=null===(Qb=vc.RequestTelemetryData)||void 0===Qb?void 0:Qb.EcsRequestDuration;Nb.Wz.isSuccessful=!(0<(null===
(Dc=vc.Errors)||void 0===Dc?void 0:Dc.length));this.Pua&&(Qd=!!vc&&!!vc.RequestTelemetryData,!cc.a(vc)&&md&&md.correlationId&&this.da.Ce.UY(md.correlationId,vc.StateId,Qd?vc.RequestTelemetryData.EcsOperationDuration:0,Qd?vc.RequestTelemetryData.EcsRequestDuration:0,Qd?vc.RequestTelemetryData.WfeRequestDuration:0))};this.J$f=()=>{if(this.Qhb){const vc=je.a(Wd.a.zb.me,this.Qhb);Nb.Wz.lastCacheUpdateDuration=vc}};this.$=ib;this.da=Ba.f(ib);this.gridInstantaneousAction=za.EwaSettings.P0f()?jb:ra;this.zI=
xc.BKb(this.$.domElement,500,null,null);this.ugb=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8406295_AddFreezePanePropsTo8cadq");this.Lsf=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8452940_AddGridContentPropsToFreezePaneTelemtry");this.lag=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8606820_addHasPanesLogTo8cadq");this.BMb=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8561471_EstimatePaneDataFix");this.CWa=new Bf(this.da);this.Pua=za.EwaSettings.hda();this.imi=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8845070_EstimatePaneViewDataCrashFix");
za.EwaSettings.isChangeGateEnabled("OfficeVSO:8508634_PreviewLinesForFreezePanes")&&za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesSlice2",!1)&&(this.Yja=document.getElementById(this.reh),this.d_=document.getElementById(this.Pgh));this.b2f=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8839836_LogUnfreezeAndFreezeAfterFreezeCse");this.gta=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePaneDrag",!1);this.HId=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8797568_FreezePaneDragTelemetry");
this.fyc=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8867299_FreezePaneDragAdditionalTelemetry");this.JQ=za.EwaSettings.JQ()}gd(ib,xc,Kc){let ra=!1;switch(xc){case 1844679312:ra=1!==ib&&!this.da.rb.gr;break;case -73576432:case -1564089444:if(za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePaneDrag",!1)&&za.EwaSettings.isChangeGateEnabled("OfficeVSO:8764078_EnableFPCommandsForDrag")){Kc&&"dragProperties"in Kc&&(ra=!1);break}za.EwaSettings.isChangeGateEnabled("OfficeVSO:8475425_DisableFreezeUpToCommandsWhenSelectionNotCell")&&
(ra=1!==ib);break;case -1006176541:case 179232729:case -1156879868:case -247664224:case -1929078919:ra=!(za.EwaSettings.isChangeGateEnabled("OfficeVSO:8508634_PreviewLinesForFreezePanes")&&za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesSlice2",!1))}this.$.fa.isEditMode||this.$.fa.$b.allowViewCollab||(ra=!0);return ra}executeCommand(ib,xc,Kc){ib=this.da.rb;const ra=this.da.OXa();this.H2(xc);const jb=this.h8?Rf.getSelection(this.da.ha,ra,xc):this.getSelection(ra,xc);!this.CGc||
1844679312!==xc.command&&-73576432!==xc.command&&-1564089444!==xc.command&&83934709!==xc.command||(this.Mzf=this.da.rb.Gg-this.da.rb.ZD,this.Lzf=this.da.rb.Vg-this.da.rb.SA,this.Ozf=this.da.rb.Gg-1,this.Nzf=this.da.rb.Vg-1);switch(xc.command){case 1844679312:return this.setFreezePanes(xc,ra,ib.mj);case 83934709:return this.A5g(xc,ra,Kc);case -73576432:return this.CGc?this.FXc(xc,ra,!1,Kc):za.EwaSettings.isChangeGateEnabled("OfficeVSO:8380523_AlwaysEnableFreezeRowsAndFreezeColumns")?this.uyg(jb,xc.command,
xc.Re)?this.FXc(xc,ra,!1,Kc):sa.Task.Va(!1):this.FXc(xc,ra,ib.mj,Kc);case -1564089444:return this.CGc?this.EXc(xc,ra,!1,Kc):za.EwaSettings.isChangeGateEnabled("OfficeVSO:8380523_AlwaysEnableFreezeRowsAndFreezeColumns")?this.uyg(jb,xc.command,xc.Re)?this.EXc(xc,ra,!1,Kc):sa.Task.Va(!1):this.EXc(xc,ra,ib.mj,Kc);case 340334732:return ib.Axc?sa.Task.Va(!1):this.gKk(xc,ra);case -806625837:return ib.g7a?sa.Task.Va(!1):this.hKk(xc,ra);case -1006176541:return this.h8?this.CWa.freezePanesRowAndColumnPreview(xc,
ra):this.freezePanesRowAndColumnPreview(xc,ra);case -342472547:case 1558501543:case -2036655906:case 1870830702:case -1588000013:return this.h8?this.CWa.wHa():this.tzg();case 179232729:if(this.h8)return this.CWa.M0b(xc);this.da.SF();return this.M0b(xc);case -1156879868:return this.h8?this.CWa.freezePanesRowAndColumnPreview(xc,ra):this.freezePanesRowAndColumnPreview(xc,ra);case -247664224:if(this.h8)return this.CWa.Mbe(xc);this.da.SF();return this.Mbe(xc);case -1929078919:return this.h8?this.CWa.freezePanesRowAndColumnPreview(xc,
ra):this.freezePanesRowAndColumnPreview(xc,ra)}return sa.Task.Va(!1)}Rc(ib,xc){ib=!1;switch(xc.command){case 1844679312:case 340334732:case -806625837:case 1745254833:case 83934709:ib=!0;break;case -73576432:case -1564089444:ib=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8927480_FreezePanesRowsAndColumns");break;case -1006176541:case -342472547:case 179232729:case 1558501543:case -1156879868:case -2036655906:case -247664224:case 1870830702:case -1929078919:case -1588000013:ib=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8508634_PreviewLinesForFreezePanes")&&
za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesSlice2",!1)}return ib}td(){return!1}H2(ib){Hc.AFrameworkApplication.ua.Ab.jE&&this.$.H2&&(1844679312===ib.command||340334732===ib.command||-806625837===ib.command)&&Gc.a.hT(1,2)}uyg(ib,xc,Kc){const ra=this.da.rb;if(!ra.mj||this.gta&&30===Kc||ra.TE&&ra.UG)return!0;switch(xc){case -73576432:return ib.top!==ra.Gg-1;case -1564089444:return ib.left!==ra.Vg-1}return!1}JTb(ib,xc){return!ib||xc.topLeft.y>ib.bottomRight.y||xc.topLeft.x>
ib.bottomRight.x||xc.bottomRight.y<ib.bottomRight.y||xc.bottomRight.x<ib.bottomRight.x?!1:!0}uVb(ib){if(this.da.Iy(ib))return!0;for(const xc of this.da.$p){if(!this.da.rb.By(xc.paneType))continue;const Kc=this.da.Wg(ib,xc.paneType),ra=xc.ul;if(Kc&&ra&&this.JTb(Kc,ra))return!0}return!1}nBe(ib,xc,Kc,ra){const jb=this.da.Wg(ib),vc=this.da.view.visibleArea;return(za.EwaSettings.isChangeGateEnabled("OfficeVSO:8380523_AlwaysEnableFreezeRowsAndFreezeColumns")?this.h8?Rf.uVb(this.da,ib):this.uVb(ib):this.h8?
Rf.JTb(jb,vc):this.JTb(jb,vc))?0>=xc&&0>=Kc?(S.ULS.sendTraceTag(537159582,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create empty freeze pane"),ib=Ba.f(this.$).rtl?1493:1492,xc=Ba.f(this.$).rtl?-2131054257:-1953454131,ib=Pa.a.Cd(1,0,26,ib,0,xc,"FreezePaneA1SelectedErr"),this.Lpf(this.$,ib,ra),!1):!0:(S.ULS.sendTraceTag(537159583,0,50,za.EwaSettings.isChangeGateEnabled("OfficeVSO:8802624_FreezePanesToastForDragOutsideVP")?`FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range=${ib}, rangeViewportArea=${jb?
jb.toString():"null"}, visibleArea=${vc.toString()}, requestInitiator=${ra}`:`FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range=${ib}, rangeViewportArea=${jb?jb.toString():"null"}, visibleArea=${vc.toString()}`),ib=Pa.a.Cd(1,0,26,1491,0,2105967339,"FreezePaneSelectionNotInViewErr"),this.Lpf(this.$,ib,ra),!1)}getSelection(ib,xc){var Kc=this.da.ha.oa;const ra=Kc.activeCell.clone();Kc=Kc.activeRange;Kc.Oe&&(S.ULS.sendTraceTag(537159585,
0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top (${ra.top}) and firstUnfreezeCell.Bottom (${ra.bottom}) to equal topLeftRange.Top (${ib.top})`),ra.top=ra.bottom=ib.top);Kc.isRow&&(S.ULS.sendTraceTag(537159584,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left (${ra.left}) and firstUnfreezeCell.Right (${ra.right}) to equal topLeftRange.Left (${ib.left})`),ra.left=ra.right=ib.left);if(za.EwaSettings.isChangeGateEnabled("OfficeVSO:8599861_RowColumnFreezeOnLastBlockFix"))switch(xc.command){case -73576432:case -1156879868:ra.top===
ra.maxRows&&(ra.top=ra.bottom=ra.maxRows-1);break;case -1564089444:case -1929078919:ra.left===ra.maxColumns&&(ra.left=ra.right=ra.maxColumns-1)}return ra}A5g(ib,xc,Kc){if(this.gta&&Kc&&"dragProperties"in Kc){const ra=Kc.dragProperties,jb=ra.dragDirection;if("horizontal"===jb&&this.da.rb.By(4))return this.da.rb.By(3)?this.EXc(new Ga.a(-1564089444,ib.method,ib.mode,ib.Re,ib.tabName),xc,!1,{dragProperties:{dragDirection:"vertical",dragOrigin:ra.dragOrigin,target:Mb.Range.bY(this.da.rb.Vg-1,this.da.rb.Vg,
!1),unfreeze:!0}}):sa.Task.Va(!0);if("vertical"===jb&&this.da.rb.By(3))return this.da.rb.By(4)?this.FXc(new Ga.a(-73576432,ib.method,ib.mode,ib.Re,ib.tabName),xc,!1,{dragProperties:{dragDirection:"horizontal",dragOrigin:ra.dragOrigin,target:Mb.Range.lQ(this.da.rb.Gg-1,this.da.rb.Gg,!1),unfreeze:!0}}):sa.Task.Va(!0)}this.hud(Kc);return this.Atb(ib,!1,0,0,0,0,xc,null)}setFreezePanes(ib,xc,Kc){if(za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesSlice2",!1)||!Kc){Kc=this.h8?Rf.getSelection(this.da.ha,
xc,ib):this.getSelection(xc,ib);Kc.top===xc.top&&Kc.left===xc.left&&(Kc=Mb.Range.Hc(Kc.top+1,Kc.left));const {Gbe:ra,Fbe:jb,MId:vc,LId:md}=this.RMd(ib,xc,Kc,!1);return this.nBe(Kc,vc,md,Af.RIBBON)?this.Atb(ib,!0,ra,jb,vc,md,xc,Kc):(this.$.Sg(),this.VPc(),sa.Task.Va(!0))}return this.A5g(ib,xc)}nLf(ib,xc){const Kc=this.da.hd;let ra=null;xc===Bc.vertical?ra=Kc.XOb(ib):xc===Bc.horizontal&&(ra=Kc.zQb(ib));if(ra&&ra!==ib)return new Mb.Range(ra.top,ra.left,ra.bottom,ra.right,!1,!1);S.ULS.sendTraceTag(507790169,
0,50,`Could Not get First Scrollable Cell for : ${xc===Bc.horizontal?"horizontal":"vertical"}`);return ib}FGf(ib,xc,Kc){return this.gta&&Kc&&"dragProperties"in Kc?(ib=Kc.dragProperties,xc=ib.dragDirection,{N0d:ib.target,vUd:ib.unfreeze?!1:this.da.rb.By(3)&&"vertical"===xc||this.da.rb.By(4)&&"horizontal"===xc}):{N0d:this.h8?Rf.getSelection(this.da.ha,xc,ib):this.getSelection(xc,ib),vUd:!1}}FXc(ib,xc,Kc,ra){if(Kc)return sa.Task.Va(!1);const {N0d:jb,vUd:vc}=this.FGf(ib,xc,ra),{Gbe:md,Fbe:Qd,MId:v,LId:Qb}=
this.RMd(ib,xc,jb,vc);if(!this.nBe(jb,v,Qb,ra&&"dragProperties"in ra?Af.DRAG_HANDLE:Af.RIBBON))return this.$.Sg(),this.VPc(),sa.Task.Va(!0);this.hud(ra);return this.Atb(ib,!0,md,Qd,v,Qb,xc,this.BMb?this.nLf(jb,Bc.vertical):jb)}hud(ib){var xc;if(this.HId&&this.gta&&ib&&"dragProperties"in ib){ib=ib.dragProperties;const Kc=ib.dragReleasedTime;Nb.Wz.isDrag=!0;Nb.Wz.dragDirection=ib.dragDirection;Nb.Wz.dragOrigin=ib.dragOrigin;Nb.Wz.isUnfreezeFromDrag=null!==(xc=ib.unfreeze)&&void 0!==xc?xc:!1;Kc&&(Nb.Wz.dragReleaseToFreezeApplied=
performance.now()-Kc);this.fyc&&Rf.J0a(this.da,ib.dragOrigin,ib.dragDirection,"FreezePaneRequestSentOnDrag")}}EXc(ib,xc,Kc,ra){if(Kc)return sa.Task.Va(!1);const {N0d:jb,vUd:vc}=this.FGf(ib,xc,ra),{Gbe:md,Fbe:Qd,MId:v,LId:Qb}=this.RMd(ib,xc,jb,vc);if(!this.nBe(jb,v,Qb,ra&&"dragProperties"in ra?Af.DRAG_HANDLE:Af.RIBBON))return this.$.Sg(),this.VPc(),sa.Task.Va(!0);this.hud(ra);return this.Atb(ib,!0,md,Qd,v,Qb,xc,this.BMb?this.nLf(jb,Bc.horizontal):jb)}gKk(ib,xc){let Kc=0;const ra=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8728140_FreezePanesHiddenRowColFix");
ra&&(Kc=Rf.GPb(this.da).columnNumber);return this.Atb(ib,!0,0,ra?Kc:xc.left,0,ra?Kc-xc.left+1:1,xc,null)}hKk(ib,xc){let Kc=0;const ra=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8728140_FreezePanesHiddenRowColFix");ra&&(Kc=Rf.GPb(this.da).rowNumber);return this.Atb(ib,!0,ra?Kc:xc.top,0,ra?Kc-xc.top+1:1,0,xc,null)}Lpf(ib,xc,Kc){this.gta&&za.EwaSettings.isChangeGateEnabled("OfficeVSO:8802624_FreezePanesToastForDragOutsideVP")&&Kc===Af.DRAG_HANDLE?this.tWg(pa.a.instance.ia(2560)):za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesSlice2",
!1)?this.tWg(pa.a.instance.ia(2427)):this.Wi(ib,xc)}tWg(ib){ib=$e.a.Xv.KC.QP(ib,!1);ib.image=1;$e.a.Xv.KC.pz(ib)}Wi(ib,xc){new Sa.a(this.$,xc)}Atb(ib,xc,Kc,ra,jb,vc,md,Qd){var v,Qb,Dc;if(this.CGc&&this.Mzf===jb&&this.Lzf===vc&&this.Ozf===Kc&&this.Nzf===ra)return S.ULS.sendTraceTag(507320256,0,50,"Server request sendFreezePanesRequest is not sent due to the same parameters"),this.gta&&this.fyc&&Nb.Wz.isDrag&&Rf.J0a(this.da,null!==(v=Nb.Wz.dragOrigin)&&void 0!==v?v:"",null!==(Qb=Nb.Wz.dragDirection)&&
void 0!==Qb?Qb:"","FreezePaneRequestNotSent"),sa.Task.Va(!0);this.Jee=ue.a(this.$).pqa(5,"SendFreezePanesRequest","SendFreezePanesRequest");this.ugb&&this.da.za.$t(this.J$f);this.da.h6(this.Tmg);this.zI.o6a();this.da.$_k(xc?"":"UnsetFreezePane");const id=Object(cd.a)(new ad,{SheetName:null===(Dc=this.$.la)||void 0===Dc?void 0:Dc.name,Freeze:xc,FrozenRows:jb,FrozenColumns:vc,FirstRow:Kc,FirstColumn:ra});S.ULS.sendTraceTag(573101852,0,50,`FreezePanesCommandHandler.SendFreezePanesRequest: Freeze=${xc}, FrozenRows=${jb}, FrozenColumns=${vc}, FirstRow=${Kc}, FirstColumn=${ra} `);
const Md=()=>new Je(id),Sd=Yb.a.create().toString();this.ugb&&(Nb.Wz.isFreeze=xc,Nb.Wz.operationType=Pf.a(ib.command),Nb.Wz.frozenRows=jb,Nb.Wz.frozenColumns=vc,Nb.Wz.firstRow=Kc,Nb.Wz.firstColumn=ra,Nb.Wz.referencedBlocksBefore=this.da.za.zAc(),this.lag&&(Nb.Wz.hasPanes=this.da.rb.gr));this.Qhb=Wd.a.zb.me;let ne;this.Pua&&(this.JQ&&(ne=this.$.ma.sa.mc({hla:!0,lka:1})),this.$7k(ib,id,md,Qd,Sd));return aa.a(this.$.userOperationManager,(Ce,Ge,Ee)=>{if(za.EwaSettings.Ra(59)){var Ue=window.performance;
Ue.clearMarks();Ue.mark("FreezePanes request sent")}Ue=this.da.hd;var We=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8633312_TextWidth"),ya=this.da.rb.mj;We=We?ya||!xc:!0;Ue&&We?this.BMb&&ya?this.$.Qw():(Ue=this.nuf(id,Ue,md,Qd),this.S7k(Ue)):this.$.Qw();ya=db.c(Ce,this.CYj);Ue=this.$.ma.sa;Ce=this.ugb?ya:Ce;ya=this.Pua?{setPanes:xc,correlationId:Sd}:xc;We=Ue.$a(9,void 0===ne?null:ne);We.freezeSettings=id;return Ha.h(Ue,"FreezeOrUnfreezePanes",We,Ce,Ge,Ee,ya,0)},Ce=>new oa.a(151,0,Ce,void 0,Md),
ib)}$7k(ib,xc,Kc,ra,jb){S.ULS.sendTraceTag(507577612,0,50,"FreezePanesCommandHandler.triggerFreezePaneCSE triggerFreezePaneCSE Initiated ");const vc=this.da.hd;!this.b2f&&this.da.rb.mj?S.ULS.sendTraceTag(507574365,0,15,`FreezePanesCommandHandler.triggerFreezePaneCSE command=${ib.command}, parameter = ActiveSheetProcessedData, value = null reason = No active sheet processed data`):(this.gridInstantaneousAction.NSc(),window.setTimeout(()=>{this.da.Ce.Oda();var md=this.b2f?`command:${Pf.a(ib.command)}, isFreeze:${xc.Freeze}`:
Pf.a(ib.command);this.da.Ce.ML(23,jb,md);md={Pn:this.nuf(xc,vc,Kc,ra)};this.gridInstantaneousAction.wnc(ib.command,void 0,md);S.ULS.sendTraceTag(507585429,0,50,`FreezePanesCommandHandler.triggerFreezePaneCSE command=${ib.command}, parameter = FreezePaneCSEAttempted, value = Success reason = Initiated FreezePane CSE`)},10))}nuf(ib,xc,Kc,ra){try{S.ULS.shipAssertTag(537159580,1,!!xc,"FreezePaneCommandHandler.EstimatePaneViewDataOnPaneRequest: called with null Sheet Processed Data");if(!ib.Freeze)return null;
const jb=Ie.a();jb.State=1;jb.IsEstimated=!0;let vc=!1,md=!1;const Qd=xc.AK(Mb.Range.Hc(Kc.top,Kc.left));if(null===Qd)return S.ULS.sendTraceTag(507893269,1,50,"EstimatePaneViewDataOnPaneRequest.topLeftAllPanesOffsetData Null"),null;let v=ib.FrozenRows,Qb=ib.FrozenColumns;if(1!==ib.FrozenRows||ib.FrozenColumns)if(ib.FrozenRows||1!==ib.FrozenColumns){const Dc=xc.AK(Mb.Range.Hc(ib.FirstRow+1,ib.FirstColumn+1)),id=xc.AK(Mb.Range.Hc(Kc.top,Kc.left));jb.Width=Dc.Ke-Qd.Ke;jb.Height=Dc.ye-Qd.ye;this.BMb&&
(0>jb.Width?jb.Width=0:jb.Width,0>jb.Height?jb.Height=0:jb.Height);0<ib.FrozenRows&&(jb.AbsoluteTop=Dc.ye,md=!0);0<ib.FrozenColumns&&(jb.AbsoluteLeft=Dc.Ke,vc=!0);v=Dc.AE-id.AE;Qb=Dc.ND-id.ND}else jb.Width=xc.SAc(lf.a.Hc(Kc.top,Kc.left)),ra=Mb.Range.Hc(Kc.top,Kc.left+1),jb.AbsoluteLeft=Qd.Ke+jb.Width,vc=!0;else jb.Height=xc.PAc(lf.a.Hc(Kc.top,Kc.left)),ra=Mb.Range.Hc(Kc.top+1,Kc.left),jb.AbsoluteTop=Qd.ye+jb.Height,md=!0;if(this.imi&&!ra)return S.ULS.sendTraceTag(507316444,0,15,"FreezePanesCommandHandler.estimatePaneViewDataOnPaneRequest, firstUnfreezeCell is null"),
null;md&&(jb.FirstFrozenRow=Kc.top,jb.FirstScrollableRow=ra.top);vc&&(jb.FirstFrozenColumn=Kc.left,jb.FirstScrollableColumn=ra.left);jb.VisibleRows=v;jb.VisibleColumns=Qb;return jb}catch(jb){return S.ULS.sendTraceTag(507316443,0,15,`FreezePanesCommandHandler.estimatePaneViewDataOnPaneRequest, caught exception: ${jb}`),null}}S7k(ib){sa.Task.delay(this.$.ta.GetRangeContentPrefetchDelayInMs).continueWith(()=>{this.$.la&&this.$.fa&&(this.$.fa.R4(Ac.a.Me,"FreezePaneCommandHandler.TriggerDelayActiveItemPaneChange"),
bf.b(this.$.la,ib,-1,void 0,!0))})}VPc(){this.zI.x6a();He.a.vb(this.Jee);this.Jee=null;this.da.yZ(this.Tmg);this.ugb&&this.da.za.yu(this.J$f)}H9d(ib){var xc,Kc;let ra=`FreezePanesCommandHandler.OnFreezePanesUpdateCompleted: duration of FreezePane from operation until allBlockUpdated: ${ib.totalDuration} `;if(this.ugb){var jb=this.YWa();jb&&(jb=this.da.Eb.yAc(Array(jb)),ib.activeCells=jb);ib.referencedBlocksAfter=this.da.za.zAc();ib.enabledExperiments=[];this.Pua&&ib.enabledExperiments.push("cseEnabled");
this.gta&&this.HId&&ib.enabledExperiments.push("freezePanesDrag");za.EwaSettings.isChangeGateEnabled("OfficeVSO:8581986_FreezePanesPreviewTelemetry")&&za.EwaSettings.isChangeGateEnabled("OfficeVSO:8927480_FreezePanesRowsAndColumns")&&ib.enabledExperiments.push("freezePanesNewEntries");za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesSlice2",!1)&&ib.enabledExperiments.push("previewFreezePanes");ra+=La.a.Nc(ib)}this.gta&&this.fyc&&ib.isDrag&&Rf.J0a(this.da,null!==(xc=ib.dragOrigin)&&
void 0!==xc?xc:"",null!==(Kc=ib.dragDirection)&&void 0!==Kc?Kc:"","FreezePaneAppliedOnDrag");S.ULS.sendTraceTag(570949840,0,50,ra)}F2e(ib){let xc=0,Kc=0,ra=0,jb=0;const vc=new Set,md=new Set,Qd=new Set,v=$c.HelperMethods.iG(()=>{var Qb=this.da.za.gGa(this.da.TT(),this.$.la.name);if(Qb)for(var Dc of Qb)if(0!==Dc.em){if(Qb=nd.b(this.da.$,Dc.Fd,!0))for(var id of Qb){Qb=id.type;const Md=id.ll;if(""!==Md||null!=Md)2===Qb?md.add(Md):1===Qb&&Qd.add(Md)}if(Dc.UHb)for(const Md of Dc.UHb)vc.add(Md.Id);id=Dc.Yc;
Dc=Dc.Eja();if(Dc=null===Dc||void 0===Dc?void 0:Dc.Cells)for(const Md of Dc)if(Dc=this.da.za.XKf(id,Md.Row,Md.Col))xc+=Dc.eB?1:0,ra+=Dc.tN?1:0,jb+=Dc.gYa?1:0,Kc+=Dc.Jx?1:0;break}});ib.mergedCells=xc;ib.formulaCells=Kc;ib.conditionalFormatting=ra;ib.coloredCells=jb;ib.tables=md.size;ib.pivotTables=Qd.size;ib.floatingObjects=vc.size;ib.gridContentLogTime=v}YWa(){const ib=this.da.SXa(),xc=this.da.Nyc();return null===ib||null===xc?null:new Mb.Range(ib.top,ib.left,xc.bottom,xc.right,!0,!0)}dY(ib,xc,Kc){return ib.AK(lf.a.Hc(xc,
Kc))}Mbe(ib){const xc=this.da.rb.UG;var {Gw:Kc}=this.da.X1(),ra=this.da.hd;if(null===ra)return this.ZK(ib,!1,"sheetProcessedData is not available."),sa.Task.Va(!1);const jb=this.pta(ra,0,0);ra=this.pta(ra,0,1);Kc=this.da.nn+ra.Ke-(Kc.x+jb.Ke);0<xc&&(Kc=this.da.nn+ra.Ke-jb.Ke);if(null!==this.d_)this.da.rtl?this.d_.style.right=$c.HelperMethods.$c(Kc):this.d_.style.left=$c.HelperMethods.$c(Kc),this.d_.classList.remove(this.Zfa);else return this.ZK(ib,!1,"verticalPreviewBar is null"),sa.Task.Va(!0);this.ZK(ib,
!0);return sa.Task.Va(!0)}M0b(ib){const xc=this.da.rb.TE;var Kc=this.da.hd;if(null===Kc)return this.ZK(ib,!1,"sheetProcessedData is not available."),sa.Task.Va(!1);({Gw:jb}=this.da.X1());const ra=this.pta(Kc,0,0);Kc=this.pta(Kc,1,0);var jb=this.da.uz+Kc.ye-(jb.y+ra.ye);0<xc&&(jb=this.da.uz+Kc.ye-ra.ye);if(null!==this.Yja)this.Yja.style.top=$c.HelperMethods.$c(jb),this.Yja.classList.remove(this.Zfa);else return this.ZK(ib,!1,"horizontalPreviewBar is null"),sa.Task.Va(!0);this.ZK(ib,!0);return sa.Task.Va(!0)}freezePanesRowAndColumnPreview(ib,
xc){let Kc,ra;let jb=!0,vc=!0;const md=this.da.rb.TE,Qd=this.da.rb.UG,v=this.da.rb.Gg,Qb=this.da.rb.Vg,{OE:Dc,Gw:id}=this.da.X1();var Md=this.da.hd;if(null===Md)return this.ZK(ib,!1,"sheetProcessedData is not available."),sa.Task.Va(!1);const Sd=this.pta(Md,0,0);xc=this.getSelection(xc,ib);if(!this.uVb(xc))return this.ZK(ib,!0,"Preview not shown as selection is not in visible area"),sa.Task.Va(!0);var ne=this.dY(Md,Dc.top,Dc.left);const Ce=this.dY(Md,xc.top+0,xc.left+0);var Ge=this.dY(Md,xc.top+1,
xc.left);const Ee=this.dY(Md,xc.top,xc.left+1);Md=this.dY(Md,v,Qb);const Ue=id.x+ne.Ke-Md.Ke;ne=id.y+ne.ye-Md.ye;if(-1006176541===ib.command){Ge=Ce;if(Ce.ye===Sd.ye&&Ce.Ke===Sd.Ke)return this.M0b(ib);if(Ce.ye===Sd.ye||Ce.ye<=Sd.ye||Ce.AE>=Md.AE&&Ce.ye<Md.ye+ne)jb=!1}jb&&(ra=this.da.uz+Ge.ye-ne,0<md&&(ra=xc.top<v?this.da.uz+Ge.ye-Sd.ye:this.da.uz+Ge.ye-Sd.ye-ne));if(-1006176541===ib.command){if(Ge=Ce,Ce.ye===Sd.ye&&Ce.Ke===Sd.Ke||Ce.Ke<=Sd.Ke||Ce.ND>=Md.ND&&Ce.Ke<Md.Ke+Ue)vc=!1}else Ge=Ee;vc&&(Kc=
this.da.nn+Ge.Ke-Ue,0<Qd&&(Kc=Qb>xc.left?this.da.nn+Ge.Ke-Sd.Ke:this.da.nn+Ge.Ke-Sd.Ke-Ue));if(null!==this.Yja&&jb)this.Yja.style.top=$c.HelperMethods.$c(ra),this.Yja.classList.remove(this.Zfa);else if(jb)return this.ZK(ib,!1,"horizontalPreviewBar is null"),sa.Task.Va(!0);if(null!==this.d_&&vc)this.da.rtl?this.d_.style.right=$c.HelperMethods.$c(Kc):this.d_.style.left=$c.HelperMethods.$c(Kc),this.d_.classList.remove(this.Zfa);else if(vc)return this.ZK(ib,!1,"verticalPreviewBar is null"),sa.Task.Va(!0);
-1156879868===ib.command&&this.d_.classList.add(this.Zfa);-1929078919===ib.command&&this.Yja.classList.add(this.Zfa);this.ZK(ib,!0);return sa.Task.Va(!0)}tzg(){this.d_&&(this.d_.style.left=null,this.d_.style.right=null,this.d_.classList.contains(this.Zfa)||this.d_.classList.add(this.Zfa));this.Yja&&(this.Yja.classList.contains(this.Zfa)||this.Yja.classList.add(this.Zfa));return sa.Task.Va(!0)}ZK(ib,xc,Kc){if(za.EwaSettings.isChangeGateEnabled("OfficeVSO:8581986_FreezePanesPreviewTelemetry")){var ra=
"FreezePanesCommandHandler.LogFreezePreviewTelemetry: ",jb={};jb.operationType=Pf.a(ib.command);jb.isSuccessful=xc;jb.preExistingPanes=this.da.rb.gr;jb.message=Kc?Kc:"";ra+=La.a.Nc(jb);S.ULS.sendTraceTag(507655369,0,50,ra)}}pta(ib,xc,Kc){const ra=this.da.OXa(),jb=this.da.gQ(!0),vc=this.da.gQ(!1);return this.dY(ib,(jb>ra.top?jb:ra.top)+xc,(vc>ra.left?vc:ra.left)+Kc)}};gf.Wz={};gf=Nb=Object(C.__decorate)([Object(Ma.d)(mb.FreezePanesCommandHandlerService),Object(C.__param)(0,Object(mb.EwaControlService)()),
Object(C.__param)(1,Object(mb.SharedUIControlsFactoryService)()),Object(C.__param)(2,Object(mb.GridViewService)()),Object(C.__param)(3,Object(mb.GridInstantaneousActionService)()),Object(C.__param)(4,Object(mb.FreezePanesInstantaneousActionService)())],gf);Object(X.a)(gf,"FreezePanesCommandHandler",null,[29]);var Qe;let Aa=Qe=class{constructor(ib,xc){this.da=ib;this.$=xc;this.selectedRanges=[];this.zRd=this.oZc=this.d2=this.YWd=!1;this.kL=()=>{this.da.vtb||this.da.cva()?this.wjb([]):this.wjb(this.da.ha.oa.selectedRanges)};
this.xQf=()=>{this.$.fa.isEditMode?this.XKg():this.ZTf()};this.nRf=()=>{this.ZTf();this.YWd=!0};this.mRf=()=>{this.YWd=!1;this.XKg()};this.ZTf=()=>{this.l$b(this.selectedRanges,!1);this.PRd();this.Sp&&this.k$b(this.Sp.qp,this.Sp.yO,this.Sp.isRow,!1)};this.XKg=()=>{this.l$b(this.selectedRanges,!0);this.Sp&&this.h_a(this.Sp.isRow)&&this.k$b(this.Sp.qp,this.Sp.yO,this.Sp.isRow,!0)};this.d2=za.EwaSettings.ZWd();this.oZc=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8986047_showHideInsertOnEditModeChange");
(this.zRd=za.EwaSettings.XWd())&&this.da.Ub.Klc(this.kL);this.oZc&&this.$.fa.CD(this.xQf)}dispose(){this.zRd&&this.da.Ub.G3b(this.kL);this.oZc&&this.$.fa.xB(this.xQf)}isHeaderInsertAllowed(ib,xc,Kc){return this.ru&&this.ru.isRow===xc&&(this.ru.yO===ib&&this.ru.tZa===Kc||this.ru.z5e===ib&&this.ru.tZa===!Kc)}sTf(ib,xc,Kc,ra){ra?(!this.Sp||this.Sp.yO===xc&&this.Sp.isRow===Kc||this.sTf(this.Sp.qp,this.Sp.yO,this.Sp.isRow,!1),this.Sp={isRow:Kc,yO:xc,qp:ib}):(this.Sp&&this.Sp.yO===xc&&this.Sp.isRow===Kc||
S.ULS.sendTraceTag(507581474,0,15,"HeaderInsert.headerCellHoveredCallback: Got unset hover event for a cell that was not previously hovered."),this.Sp=void 0);this.h_a(Kc)&&!this.bFc(xc,Kc)&&this.k$b(ib,xc,Kc,!0)}headerInsertHitAreaHoveredCallback(ib,xc,Kc,ra){ra?(!this.ru||this.ru.yO===ib&&this.ru.isRow===xc&&this.ru.tZa===Kc||this.headerInsertHitAreaHoveredCallback(this.ru.yO,this.ru.isRow,this.ru.tZa,!1),this.GVk(ib,xc,Kc)):(this.ru&&this.ru.yO===ib&&this.ru.isRow===xc&&this.ru.tZa===Kc||S.ULS.sendTraceTag(507581473,
0,15,"HeaderInsert.headerInsertHitAreaHoveredCallback: Got unset hover event for a hit region that was not previously hovered."),this.PRd())}headerInsertButtonInvokedCallback(ib,xc,Kc){1!==this.da.ha.gf&&this.da.j4();let ra=Kc,jb=this.$Ec(ib,xc,Kc);if(!jb){var vc=-1;this.ru.isRow===xc&&this.ru.yO===ib?vc=this.ru.z5e:S.ULS.sendTraceTag(507355294,0,15,"HeaderInsert.headerInsertButtonInvokedCallback: hoveredHitRegion should be set to the current cell at this point.");if(vc=this.$Ec(vc,xc,!Kc))ra=!Kc,
jb=vc}null!==jb&&void 0!==jb?jb:jb=xc?Mb.Range.lQ(ib,ib):Mb.Range.bY(ib,ib);this.da.$.Dc(ra?xc?-1113896058:1415868706:xc?75170472:-612877076,2,32,{[Bb.a.Usb]:[jb],["skipTableIntersectionChecks"]:!0})}wjb(ib){ib=ib.filter(xc=>xc.isRow!==xc.Oe);if(0!==this.selectedRanges.length||0!==ib.length)this.l$b(this.selectedRanges,!1),this.selectedRanges=ib,this.l$b(this.selectedRanges,!0),this.Sp&&this.h_a(this.Sp.isRow)&&this.k$b(this.Sp.qp,this.Sp.yO,this.Sp.isRow,!0)}g8i(ib){ib?this.nRf():this.mRf()}oRf(ib){ib?
this.nRf():this.mRf()}HVk(ib,xc,Kc){Kc||ib++;Kc=xc?Mb.Range.lQ(ib,ib):Mb.Range.bY(ib,ib);xc=xc?Qe.yXf:Qe.rXf;this.da.Ub.pn(Kc,xc,!1);this.da.Ub.Iq(xc,void 0,void 0,!0)}hcj(ib){this.da.Ub.rl(ib?Qe.yXf:Qe.rXf,!0)}h_a(ib){var xc;if(this.d2&&this.YWd||!this.$.fa.isEditMode||this.da.isEditing)return!1;null!==(xc=this.cD)&&void 0!==xc?xc:this.cD=new kb.SheetProtection(this.$.qa);return!this.cD.ie(ib?64:32)||this.$.Mb.DC?!1:!0}X2c(){0!==this.selectedRanges.length&&this.l$b(this.selectedRanges,!0);this.PRd();
if(this.Sp){const ib=this.Sp;this.Sp=void 0;this.k$b(ib.qp,ib.yO,ib.isRow,this.h_a(ib.isRow))}}GGc(ib,xc,Kc,ra){if(!Kc&&ib===(xc?Ac.a.sf:Ac.a.rf))return!1;if(xc?this.da.rb.Ijb:this.da.rb.CRb){const jb=xc?this.da.rb.Gg:this.da.rb.Vg;if(Kc&&jb===ib||!Kc&&(ib=null!==ra&&void 0!==ra?ra:this.Byc(ib,xc,!0),Qe.lWb(ib,xc)&&jb===ib))return!1}return!0}l$b(ib,xc){ib.forEach(Kc=>{const ra=Kc.isRow;if(this.oZc&&!xc||this.h_a(ra)){var jb=ra?Kc.top:Kc.left,vc=this.KNb(ra,jb);xc&&!this.GGc(jb,ra,!0)||this.Vtb(vc,
jb,!0,xc?0:void 0);Kc=ra?Kc.bottom:Kc.right;jb=Kc===jb?vc:this.KNb(ra,Kc);xc&&!this.GGc(Kc,ra,!1)||this.Vtb(jb,Kc,!1,xc?0:void 0)}})}k$b(ib,xc,Kc,ra){this.Vtb(ib,xc,!0,this.lMd(xc,Kc,!0,ra));this.Vtb(ib,xc,!1,this.lMd(xc,Kc,!1,ra))}XSk(ib,xc,Kc,ra){if(!ra)return!1;ra=this.Byc(ib,xc,!Kc);if(!this.GGc(ib,xc,Kc,ra))return!1;const jb=!!this.bFc(ib,xc);return!jb&&this.Sp&&this.Sp.isRow===xc&&this.Sp.yO===ib||this.$Ec(ib,xc,Kc)||!jb&&Qe.lWb(ra,xc)&&this.bFc(ra,xc)?!0:!1}VSk(ib,xc,Kc,ra){return this.h_a(xc)&&
this.GGc(ib,xc,Kc,ra)&&(!this.bFc(ib,xc)||!!this.$Ec(ib,xc,Kc))}GVk(ib,xc,Kc){const ra=this.Byc(ib,xc,!Kc);this.VSk(ib,xc,Kc,ra)&&(this.Vtb(this.KNb(xc,ib),ib,Kc,1),this.HVk(ib,xc,Kc),this.ru={isRow:xc,yO:ib,z5e:ra,tZa:Kc})}PRd(){if(this.ru){var ib=this.ru.isRow,xc=this.ru.yO,Kc=this.ru.tZa;this.ru=void 0;this.Vtb(this.KNb(ib,xc),xc,Kc,this.lMd(xc,ib,Kc,this.h_a(ib)));this.hcj(ib)}}KNb(ib,xc){if(this.Sp&&this.Sp.isRow===ib&&this.Sp.yO===xc)return this.Sp.qp;ib=ib?this.da.Jbe:this.da.J0b;for(const Kc of ib)if(ib=
Kc.pBi(xc))return ib}lMd(ib,xc,Kc,ra){if(this.ru&&this.ru.yO===ib&&this.ru.isRow===xc&&this.ru.tZa===Kc)return 1;if(this.XSk(ib,xc,Kc,ra))return 0}Vtb(ib,xc,Kc,ra){var jb;ib&&!ib.aSg(xc,Kc,ra)&&(xc=this.Byc(xc,ib.isRow,!Kc),Qe.lWb(xc,ib.isRow)&&(null===(jb=this.KNb(ib.isRow,xc))||void 0===jb?void 0:jb.aSg(xc,!Kc,ra)))}bFc(ib,xc){var Kc;return null===(Kc=this.selectedRanges)||void 0===Kc?void 0:Kc.find(ra=>xc?ra.isRow&&ra.eZd(ib):ra.Oe&&ra.zZa(ib))}$Ec(ib,xc,Kc){return this.selectedRanges.find(ra=>
xc?ra.isRow&&(Kc?ra.top===ib:ra.bottom===ib):ra.Oe&&(Kc?ra.left===ib:ra.right===ib))}Byc(ib,xc,Kc){return this.da.hd.VT(Kc?ib+1:ib-1,xc,Kc)}static lWb(ib,xc){xc=xc?Ac.a.sf:Ac.a.rf;return 0<ib&&ib<=xc}};Aa.yXf=[70,72];Aa.rXf=[71,73];Aa=Qe=Object(C.__decorate)([Object(Ma.d)(mb.HeaderInsertService),Object(C.__param)(0,Object(mb.GridViewService)()),Object(C.__param)(1,Object(mb.EwaControlService)())],Aa);Object(X.a)(Aa,"HeaderInsert",null,[4]);class Fb{constructor(ib,xc){this.selectedRanges=null;this.fRemoveOriginRef=
!1;this.selectedRanges=ib;this.fRemoveOriginRef=xc}}Object(X.a)(Fb,"MacroRecorderImageInCellConvertToFloatingObjectPayload",null,[67]);var Ta=a(177),Eb=a(99);let oc=class{constructor(ib,xc,Kc){this.PVj=ra=>{let jb;!ra||Pa.a.zf(ra.Errors)||Fa.a.Zg(jb=ra.Result)?ra&&Pa.a.zf(ra.Errors)&&S.ULS.sendTraceTag(509142304,0,50,`ImageInCellCommandHandler.onConvertInCellToFloatingE2oSuccess: operation succeeded with errors. Errors: ${Pa.a.pc(ra.Errors)}`):(S.ULS.sendTraceTag(509142305,0,50,"ImageInCellCommandHandler.onConvertInCellToFloatingE2oSuccess: operation succeeded"),
Ta.a(this.$).u3a(3),Eb.a(this.$).XLa(1,jb))};this.OVj=()=>{S.ULS.sendTraceTag(509142303,0,50,"ImageInCellCommandHandler.onConvertInCellToFloatingE2oFailed: operation failed")};this.$=ib;this.da=Ba.f(this.$);this.oWh=xc;this.VCi=Kc;this.iWb=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TransitionFloatingInCellImages",!1);this.YTb=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateReferenceFloatingInCellImages",!1);this.onj=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CellImagesOnObjectUI",
!1)}gd(){return!1}executeCommand(ib,xc){Ia.TaskExtensions.kl();ib=ba.u(this.da.ha.oa.selectedRanges,this.$);const Kc=xc.command;switch(Kc){case 2000316912:xc=this.zif(ib,!0,xc);break;case 1983877126:xc=this.zif(ib,!1,xc);break;case -1125542248:xc=this.popInCellImageToFloatingFromOnObjectUI();break;case 457756232:xc=this.bhk();break;default:return wa.a(Kc)}return xc||sa.Task.Va(!0)}Rc(ib,xc){ib=!1;switch(xc.command){case 457756232:case -1125542248:ib=this.$.isEditMode&&this.iWb&&this.YTb&&this.onj;
break;case 2000316912:case 1983877126:ib=this.$.isEditMode&&this.iWb&&this.YTb}return ib}td(){return!1}popInCellImageToFloatingFromOnObjectUI(){if(!this.$.Ss(null,!1))return sa.Task.Va(!0);this.oWh.fmd();return sa.Task.Va(!0)}bhk(){if(!(new kb.SheetProtection(this.$.qa)).ie(1))return sa.Task.Va(!0);this.VCi.fmd();return sa.Task.Va(!0)}zif(ib,xc,Kc){if(!this.$.Ss(null,!1))return sa.Task.Va(!0);const ra=()=>new Fb(ib,xc);return aa.a(this.$.userOperationManager,(jb,vc,md)=>{var Qd=this.$.ma.sa;jb=db.c(jb,
this.PVj);vc=db.b(vc,this.OVj);const v=Qd.$a(41,null);v.selectedRanges=ib;v.fRemoveOriginRef=xc;return Ha.h(Qd,"ConvertToFloatingE2o",v,jb,vc,md,null,0)},jb=>new oa.a(268,0,jb,void 0,ra),Kc)}};oc=Object(C.__decorate)([Object(Ma.d)(mb.ImageInCellCommandHandlerService),Object(C.__param)(0,Object(mb.EwaControlService)()),Object(C.__param)(1,Object(mb.CellImageToFloatingObjectService)()),Object(C.__param)(2,Object(mb.FloatingObjectToCellImageService)())],oc);Object(X.a)(oc,"ImageInCellCommandHandler",
null,[29]);var Lc=a(927),Jd=a(928);class Ab{constructor(ib,xc,Kc,ra){this.$=ib;this.Uy=xc;this.v7a=Kc;this.peb=ra}showTaskPane(ib,xc,Kc,ra,jb,vc,md,Qd){rc.a.Fj()?void Ma.a.resolve(mb.ReactTaskPaneManagerService,{xa:0}).then(v=>v.PC("NameManagerTaskPane",this.yl(ib,xc,Kc,ra,jb,void 0,vc,md,Qd))):Hd.a.li().then(v=>{v.showTaskPane("NameManagerTaskPane",this.yl(ib,xc,Kc,ra,jb,void 0,vc,md,Qd));return null}).catch(()=>{throw Error("showTaskPane: Error while opening task pane");})}updateTaskPane(ib,xc,
Kc,ra,jb,vc,md,Qd,v){rc.a.Fj()?void Ma.a.resolve(mb.ReactTaskPaneManagerService,{xa:0}).then(Qb=>Qb.updateTaskPane("NameManagerTaskPane",this.yl(ib,xc,Kc,ra,jb,vc,md,Qd,v))):Hd.a.li().then(Qb=>{Qb.updateTaskPane("NameManagerTaskPane",this.yl(ib,xc,Kc,ra,jb,vc,md,Qd,v));return null}).catch(()=>{throw Error("updateTaskPane: Error while opening task pane");})}hideTaskPane(){rc.a.Fj()?void Ma.a.resolve(mb.ReactTaskPaneManagerService,{xa:0}).then(ib=>ib.hideTaskPane("NameManagerTaskPane")):Hd.a.li().then(ib=>
{ib.hideTaskPane("NameManagerTaskPane",2);return null}).catch(()=>{throw Error("hideTaskPane: Error while hiding task pane");})}mT(){this.o1g&&this.o1g()}getTitle(ib,xc){switch(ib){case 1:return pa.a.instance.La(xc?1003:902);case 0:case 2:return pa.a.instance.La(901);default:return""}}yl(ib,xc,Kc,ra,jb,vc,md,Qd,v){Kc={type:"NameManagerTaskPaneProps",activePage:ib,showLoader:md,rangePickerController:Ba.f(this.$).$h.QGa(),callbacks:Kc,items:xc,errors:Qd,updateView:ra,toast:jb,filterCountMap:v};return Object.assign(new Zc.a,
{id:"NameManagerTaskPane",title:this.getTitle(ib,this.ylb(xc)),actionButtonProps:vc,contentProps:Kc,width:320,onOpen:()=>{this.Uy()},onClose:()=>{this.v7a()},preventCloseCallback:Qb=>{this.o1g=Qb;za.EwaSettings.isChangeGateEnabled("OfficeVSO:8720866_XLONameManagerApplyChangesToast")?1===ib?this.peb(xc):Qb():Qb()}})}ylb(ib){return ib&&null===ib[0]?!0:!1}}Object(X.a)(Ab,"NameManagerTaskPane",null,[497]);class Uc{constructor(ib,xc){this.K2g=0;this.RVc=[];this.searchText="";this.Uy=()=>{this.VH.R4e(this.Wnf);
this.VH.EGh(this.r7g);this.VH.zDh(this.mtc);this.VH.au();this.$.Sj(this.rKa)};this.callbacks={onItemClick:Kc=>{this.A8i(Kc)},onItemSave:(Kc,ra,jb,vc,md)=>{this.xRf(Kc,ra,jb,vc,md)},onItemsDelete:Kc=>{Kc&&(this.RVc=Kc,this.VH.mtc(Kc))},onSearch:(Kc,ra)=>{this.searchText=Kc;this.Kmc=ra;if(za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.XLONameManagerFastFollow",!1)){S.ULS.sendTraceTag(507610080,Lc.a.ewa,Jd.a.info,La.a.Nc({isSearching:""!==Kc,sortBy:ra.sortBy,sortOrder:ra.sortOrder,filterBy:ra.filterBy}));
const jb=Zb.filterBy(this.items,ra.filterBy);Kc=Zb.search(jb,Kc);ra=Zb.eQd(Kc,ra.sortBy,ra.sortOrder);this.S4(0,void 0,ra)}else S.ULS.sendTraceTag(507581340,Lc.a.ewa,Jd.a.info,"NameManagerTaskPaneController.callbacks Search functionality is used"),ra=Zb.search(this.items,Kc),this.S4(0,void 0,ra)},onCloseButtonClick:(Kc,ra,jb,vc,md)=>{Zb.dbj(Kc,ra,jb,vc,this.getDefinedNames())?(this.j4b={name:Kc,reference:ra,comment:jb,type:md,runtimeUid:vc,scope:0,topLeft:"",bottomRight:"",isInvalidReference:!1,referenceSheetName:""},
this.toast=this.sBc(pa.a.instance.La(915),pa.a.instance.La(916),()=>{this.xRf(Kc,ra,jb,vc,md)},!0,()=>{this.Aob.mT()}),this.S4(1,this.Vcb(),[this.j4b],null)):this.Aob.mT()}};this.updateView=(Kc,ra)=>{switch(Kc){case 1:case 3:this.S4(Kc,this.Vcb(),[ra]);break;case 0:this.S4(Kc,void 0);break;default:this.S4(Kc,this.Vcb())}};this.Vcb=()=>({label:pa.a.instance.La(903),icon:"CommonControlArrowLeftUseWithBorder_24",onExecute:()=>{this.updateView(0)},onTabKeyDown:()=>{}});this.Wnf=(Kc,ra)=>{this.v2h();(null===
ra||void 0===ra?0:ra.Asj)?this.x$i():this.updateView(this.items?0:4)};this.r7g=(Kc,ra)=>{let jb;Kc=null===ra||void 0===ra?void 0:ra.status;!Kc&&(jb=Zb.gQi(ra),null===jb||void 0===jb?0:jb.s9b)&&(this.toast=this.sBc(jb.s9b,null,null));Kc?this.S4(0,null,this.getDefinedNames(),null===jb||void 0===jb?void 0:jb.qgg):this.S4(1,this.Vcb(),[this.j4b],null===jb||void 0===jb?void 0:jb.qgg)};this.mtc=(Kc,ra)=>{(null===ra||void 0===ra?0:ra.status)&&this.items&&(this.items=this.items.filter(jb=>!this.RVc.includes(jb.runtimeUid)));
this.toast=(null===ra||void 0===ra?0:ra.status)?this.h3i(ra):this.g3i(ra);this.S4(0,null,this.items,null)};this.rKa=(Kc,ra)=>{!ra.Hg&&this.Aob&&this.Aob.hideTaskPane()};this.v7a=()=>{this.VH.luk(this.Wnf);this.VH.kvk(this.r7g);this.VH.ysk(this.mtc);this.VH.Bv();this.$.ro(this.rKa)};this.peb=Kc=>{this.S4(3,this.Vcb(),Kc)};this.$=ib;this.VH=xc;this.da=Ba.f(ib);this.Aob=new Ab(ib,this.Uy,this.v7a,this.peb)}cWk(){this.K2g=0;this.toast={sequenceNumber:0,message:"",actionButtonText:"",onActionButtonClick:null,
autoHide:!1,onCloseButtonClick:null,allowDismiss:!1};this.Kmc={filterBy:void 0,sortOrder:0,sortBy:0};this.Aob.showTaskPane(0,this.getDefinedNames(),this.callbacks,this.updateView,this.toast,!0,void 0,this.filterCountMap);this.VH.Rce(!1)}S4(ib,xc,Kc,ra){this.dci=ib;this.Aob.updateTaskPane(ib,Kc||this.getDefinedNames(),this.callbacks,this.updateView,this.toast,xc,!1,ra,this.filterCountMap);this.j4b=null}A8i(ib){if(ib=Zb.KOi(this.items,ib)){ib=ba.lb(ib.reference.slice(1),this.$.listSeparator,this.$.qa);
const xc=Ba.f(this.$).ha;this.da.oY(ib&&ib.I3&&ib.sheetName?ib.I3:[xc.oa.u7],za.EwaSettings.isChangeGateEnabled("OfficeVSO:8756334_NameManagerSelectionUpdateAfterDiscontinuousSelection")?0:xc.oa.mt,ib.sheetName,null,null,null,null,3,"NameManager.SelectNamedRange",null,null,null,!0)}}x$i(){switch(this.dci){case 0:if(this.items)if(za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.XLONameManagerFastFollow",!1)){var ib=Zb.filterBy(this.items,this.Kmc.filterBy);ib=Zb.search(ib,this.searchText);
ib=Zb.eQd(ib,this.Kmc.sortBy,this.Kmc.sortOrder);this.S4(0,void 0,ib)}else ib=Zb.search(this.items,this.searchText),this.S4(0,void 0,ib);else this.updateView(4);break;case 4:this.updateView(this.items?0:4);break;case 2:this.updateView(this.items?2:4)}}v2h(){(this.items=this.VH.getItems(ib=>ib&&ib.metadata&&ib.metadata.isVisibleToNameManager))&&0!==this.items.length&&(this.items=Zb.eQd(this.items,0,0),za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.XLONameManagerFastFollow",!1)&&(this.filterCountMap=
Zb.Y4h(this.items)));this.items||S.ULS.sendTraceTag(507277521,Lc.a.ewa,Jd.a.error,"NameManagerTaskPaneController.constructDefinedNamesList: DefinedNames is null")}g3i(ib){return ib&&!ib.status&&ib.Htb?Zb.GYc(ib.Htb)?this.sBc(Zb.IHf("delete"),null,null):null:null}h3i(ib){var xc,Kc;if(!ib||!ib.status||ib.Htb)return null;ib=1===(null===(xc=this.RVc)||void 0===xc?void 0:xc.length)?pa.a.instance.La(908):String.format(pa.a.instance.La(909),null===(Kc=this.RVc)||void 0===Kc?void 0:Kc.length);return this.sBc(ib,
pa.a.instance.La(904),()=>{this.$.Dc(-1502853784,fa.a.Hb,12,null)})}getDefinedNames(){return this.items}sBc(ib,xc,Kc,ra,jb){return ib?{sequenceNumber:++this.K2g,message:ib,actionButtonText:xc,onActionButtonClick:Kc,autoHide:void 0===ra?!0:ra,onCloseButtonClick:void 0===jb?null:jb,allowDismiss:!0}:null}xRf(ib,xc,Kc,ra,jb){const vc=Zb.Vil(this.VH.H_d,ib,xc,Kc,jb);this.j4b={name:ib,reference:xc,comment:Kc,type:jb,runtimeUid:ra,scope:0,topLeft:"",bottomRight:"",isInvalidReference:!1,referenceSheetName:""};
0!==vc.length?this.S4(1,this.Vcb(),[this.j4b],vc):this.VH.upsertDefinedName(ib,xc,Kc,ra,tc.a[jb])}}Object(X.a)(Uc,"NameManagerTaskPaneController",null,[]);let Od=class{constructor(ib,xc){this.oaa=null;this.$=ib;this.VH=xc}gd(){return!1}get rQc(){this.oaa||(this.oaa=new Uc(this.$,this.VH));return this.oaa}executeCommand(ib,xc){ib=!1;xc=xc.command;switch(xc){case 1910465940:this.rQc.cWk(),ib=!0}return ib?sa.Task.Va(!0):wa.a(xc)}Rc(ib,xc){switch(xc.command){case 1910465940:return!0;default:return!1}}td(){return!1}};
Od=Object(C.__decorate)([Object(Ma.d)(mb.NameManagerCommandHandlerService),Object(C.__param)(0,Object(mb.EwaControlService)()),Object(C.__param)(1,Object(mb.DefinedNameManagerService)())],Od);Object(X.a)(Od,"NameManagerCommandHandler",null,[29]);var le=a(190);class ge extends le.a{constructor(){super();this.ty=()=>{this.hide()}}L8h(){return{["type"]:"AppLinkProps",["id"]:"LearnMore",["text"]:CommonUiStrings.LearnMore,["handler"]:{["href"]:"https://go.microsoft.com/fwlink/?linkid=2251008",["target"]:"_blank"},
["onExecute"]:null}}showDialog(ib,xc){try{this.uf="OfficePyBlockPythonEditDialog",this.hc=0,this.show({["type"]:"StandardDialogProps",["id"]:this.uf,["headerText"]:ib,["resultHandler"]:this.ty,["titleText"]:xc,["dialogIcon"]:3,["helpLink"]:this.L8h()})}catch(Kc){this.v5c(ib,xc)}}v5c(ib){const xc=new ud.a(!1,!1,!1);xc.hc=0;xc.uf="OfficePyBlockPythonEditLegacyDialog";xc.initializeAndShow(ib,this.kfh,null)}kfh(){this.hide()}}Object(X.a)(ge,"OfficePyBlockPythonEditDialog",le.a,[]);let ze=class{constructor(ib){this.$=
ib}gd(){return!1}executeCommand(ib,xc){ib=!1;xc=xc.command;switch(xc){case 883532127:(new ge).showDialog(CommonUiStrings.OfficePyBlockPythonEditDialogTitle,CommonUiStrings.OfficePyBlockPythonEditDialogMessage),ib=!0}return ib?sa.Task.Va(!0):wa.a(xc)}Rc(ib,xc){switch(xc.command){case 883532127:return za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CoauthOnly",!1);default:return!1}}td(){return!1}};ze=Object(C.__decorate)([Object(Ma.d)(mb.OfficePyUXCommandHandlerService),Object(C.__param)(0,
Object(mb.EwaControlService)())],ze);Object(X.a)(ze,"OfficePyUXCommandHandler",null,[29]);var Le=a(9),nf=a(936);class cf extends nf.a{constructor(ib){super(ib)}oq(){const ib=Object(hb.d)(Ma.a.resolve(mb.SharedUIControlsFactoryService,{xa:this.Cc})),xc=Object(hb.d)(Ma.a.resolve(mb.GridInstantaneousActionService,{xa:this.Cc})),Kc=za.EwaSettings.P0f()?Object(hb.d)(Ma.a.resolve(mb.FreezePanesInstantaneousActionService,{xa:this.Cc})):null;Ia.TaskExtensions.tb(ib,ra=>{ra=ra.result;const jb=Ba.f(this.$);
this.fn([new gf(this.$,ra,jb,xc.result,Kc.result)])},this.$.Aa)}static Ea(ib){ib.ra.zc(116,new cf(ib))}}Object(X.a)(cf,"FreezePanesCommandHandlerFactory",nf.a,[]);var Te=a(430),Wf=a(942);class Hf extends Te.a{constructor(ib){super();this.$=ib;this.ri()}create(){rc.a.Hf()?void Ma.a.Bd(mb.FontServiceManagerService).then(ib=>{this.Uf(Object(Wf.a)(this.$.ra,502,()=>new ld(this.$,ib)))}):this.Uf(Object(Wf.a)(this.$.ra,502,()=>new ld(this.$,null)))}static Ea(ib){ib.ra.zc(503,new Hf(ib))}}Object(X.a)(Hf,
"FontDropdownHelperFactory",Te.a,[]);(()=>{Le.a.wb(ib=>{mb.FreezePanesCommandHandlerService.Oa()||cf.Ea(ib)})})();(()=>{Le.a.wb(ib=>{mb.FontDropdownHelperService.Oa()||Hf.Ea(ib)})})();String(u);String(l);String(t);String(e);String(w);String(z);String(E);String(M);String(G);String(A);String(N);String(K);String(I);String(L);String(J);String(B);String(Y);String(U);String(O);window.___1717508060481_closurehack=u;window.___1717508060481_closurehack=l;window.___1717508060481_closurehack=t;window.___1717508060481_closurehack=
e;window.___1717508060481_closurehack=w;window.___1717508060481_closurehack=z;window.___1717508060481_closurehack=E;window.___1717508060481_closurehack=M;window.___1717508060481_closurehack=G;window.___1717508060481_closurehack=A;window.___1717508060481_closurehack=N;window.___1717508060481_closurehack=K;window.___1717508060481_closurehack=I;window.___1717508060481_closurehack=L;window.___1717508060481_closurehack=J;window.___1717508060481_closurehack=B;window.___1717508060481_closurehack=Y;window.___1717508060481_closurehack=
U;window.___1717508060481_closurehack=O}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.kpae.js.map/c79c1f058d051049a576bc0f9646e315/EwaTS.kpae.js.map