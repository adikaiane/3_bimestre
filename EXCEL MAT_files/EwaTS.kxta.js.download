'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[20],{1096:function(y,r,a){a.d(r,"a",function(){return l});y=a(0);class c{constructor(){this.y9b=this.VSb=null;this.o5d=this.score=this.CYb=0}Rbe(t,e,w){this.score=t.pa(e);++e;this.VSb=t.pa(e)?w.T1(t.pa(e)):null;++e;this.y9b=t.pa(e)?w.T1(t.pa(e)):null;++e;this.CYb=t.pa(e);++e;this.o5d=t.pa(e);++e;return e}}Object(y.a)(c,"TokenStringGeneratorInit",null,[]);class b{constructor(t,e,w,z,E){this.LFa=t;this.count=e;this.Exc=
w;this.lC=z;this.depth=E}}Object(y.a)(b,"ErrorTolerantTrieMatch",null,[]);var f=a(1197),k=a(1350);class x{constructor(t,e,w,z){e=void 0===e?0:e;w=void 0===w?0:w;z=void 0===z?0:z;this.iwh=(void 0===t?null:t)||new k.a;this.p7=e;this.lC=w;this.depth=z}get VO(){return this.iwh}getKey(){return this.VO.rp.toString()+":"+this.p7.toString()}}Object(y.a)(x,"TrieBookmark",null,[]);class d{constructor(t,e){this.gla=t;this.p4d=e}YHj(t){if(null==t)throw Error.argumentNull("prefix");let e={};var w=e[""]=new x;
this.uDc(w,e);for(w=0;w<t.length;++w){const z=t.charCodeAt(w),E={};for(let M in e)this.KHh(z,e[M],E);e=E}return this.z7k(e)}uDc(t,e){if(!(t.lC>=this.p4d)&&(t=new x(f.a.cwd(t.VO),t.p7,t.lC+1,t.depth),t.VO.Nv&f.a.Zza&&(t.p7+=1),this.gla.i7a(t.VO))){t.depth+=1;let w=!0;for(;w;)d.n3c(t,e),this.uDc(t,e),t.p7+=this.gla.vib(t.VO,!0)+(t.VO.Nv&f.a.Zza?1:0),w=this.gla.I9b(t.VO)}}KHh(t,e,w){e.lC+1<=this.p4d&&(e.lC+=1,d.n3c(e,w),--e.lC);e.VO.Nv&f.a.Zza&&(e.p7+=1);if(this.gla.i7a(e.VO)){e.depth+=1;let z=!0;for(;z;)e.VO.e8a===
t?(d.n3c(e,w),this.uDc(e,w)):e.lC+1<=this.p4d&&(e.lC+=1,d.n3c(e,w),this.uDc(e,w),--e.lC),e.p7+=this.gla.vib(e.VO,!0)+(e.VO.Nv&f.a.Zza?1:0),z=this.gla.I9b(e.VO)}}z7k(t){const e=[];for(var w in t){const z=t[w];if(!z.VO.rp)continue;const E=!!(z.VO.Nv&f.a.Zza),M=this.gla.vib(z.VO,!1)+(E?1:0);Array.add(e,new b(z.p7,M,E,z.lC,z.depth))}e.sort((z,E)=>{let M=z.LFa-E.LFa;return M||(M=-(z.count-E.count))?M:M=z.depth-E.depth});if(2>e.length)return e;t=[];for(w=0;w<e.length;)w+=d.J3g(w,e,t);return t}static n3c(t,
e){const w=t.getKey();w in e?(e=e[w],e.lC=Math.min(e.lC,t.lC)):e[w]=new x(f.a.cwd(t.VO),t.p7,t.lC,t.depth)}static J3g(t,e,w){const z=e[t];let E=z.LFa;const M=E+z.count;let G=1,A=z.Exc;for(;t+G<e.length&&e[t+G].LFa<M;){const N=e[t+G];N.LFa>E&&(Array.add(w,new b(E,N.LFa-E,A,z.lC,z.depth)),A=!1);G+=d.J3g(t+G,e,w);E=N.LFa+N.count}E<M&&Array.add(w,new b(E,M-E,A,z.lC,z.depth));return G}}Object(y.a)(d,"ErrorTolerantTrieLookupEngine",null,[662]);class h extends c{constructor(t,e,w){super();this.PVf=this.Zug=
!1;this.guf=null;if(t){var z=0;try{z=this.Rbe(t,z,e);this.Zug=1===t.pa(z);++z;this.PVf=1===t.pa(z);++z;const E=t.pa(z);this.guf=this.D$j(w,E)}catch(E){throw Error.argument("initData");}}}D$j(t,e){return new d(t,e)}}Object(y.a)(h,"FuzzyMatchTokenStringGeneratorInit",c,[]);class n extends c{constructor(t,e){super();this.query=this.name=null;if(t){this.annotations=e.annotations;var w=0;try{w=this.Rbe(t,w,e),this.name=e.ia(t.pa(w)),++w,this.query=e.Cz(t.pa(w))}catch(z){throw Error.argument("initData");
}}}}Object(y.a)(n,"QueryTokenStringGeneratorInit",c,[]);class m extends c{constructor(t,e){super();if(t)try{this.Rbe(t,0,e)}catch(w){throw Error.argument("initData");}}}Object(y.a)(m,"SurfaceStringTokenStringGeneratorInit",c,[]);var u=a(967);class l{constructor(t){this.$3d=t}get VSb(){return this.$3d.VSb}get y9b(){return this.$3d.y9b}get CYb(){return this.$3d.CYb}static create(t,e,w){const {SurfaceStringTokenStringGenerator:z}=a(1551),{QueryTokenStringGenerator:E}=a(1552),{FuzzyMatchTokenStringGenerator:M}=
a(1553);let G=0;try{if(t.pa(G)!==l.rTa)throw Error.argument("initData","Input does not represent a token string generator");++G;const A=t.pa(G);++G;const N=new u.a;N.YFa(t,G,t.count-G);switch(A){case z.NHb:return new z(new m(N,e));case E.NHb:return new E(new n(N,e));case M.NHb:return new M(new h(N,e,w));default:throw Error.argument("initData");}}catch(A){throw Error.argument("initData");}}static B3e(t,e,w,z,E,M){t=t.n6k.getId(e,null);if(0>t)return++M,M;l.C3e(t,w,z,E);return M}static C3e(t,e,w,z){Array.add(z.yve,
t);Array.add(z.t_g,e);++z.Zvb[w]}}l.rTa=1099767983;Object(y.a)(l,"TokenStringGenerator",null,[641])},1173:function(y,r,a){a.d(r,"a",function(){return c});y=a(0);class c{constructor(b){this.Ga=b}get owa(){return this.Ga.owa}get c2k(){return 4!==this.Ga.style}get g2k(){return!0}get trie(){return this.Ga.trie}getId(b,f){if(!this.c2k)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Ga.style){case 0:return this.XSi(b,f);default:throw Error.notImplemented();}}ia(b){if(!this.g2k)throw Error.invalidOperation("String lookup not supported on this string table");
if(0>b||b>=this.owa)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Ga.style){case 0:return this.W1i(b);case 4:return this.V1i(b);default:throw Error.notImplemented();}}XSi(b,f){b=this.Ga.trie.Kbg(b,0,b.length,f);if(!b.succeeded)return-1;if(0>b.kwb||b.kwb>=this.Ga.owa)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Ga.J9b?this.Ga.o2b.fq(this.Ga.J9b+4*b.kwb,4):b.kwb}W1i(b){if(this.Ga.J9b){let f=0;for(;f<this.Ga.owa&&this.Ga.o2b.fq(this.Ga.J9b+
4*f,4)!==b;++f);if(f>=this.Ga.owa)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Ga.trie.dOf(f)}return this.Ga.trie.dOf(b)}V1i(b){const f=this.Ga.o2b.fq(this.Ga.r_g+4*b,4);let k=this.Ga.o2b.fq(this.Ga.s_g+4*b,4);if(0>k||0>f)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");b=Array(f);for(let x=0;x<f;++x)b[x]=(()=>{let d=this.Skk(k);({Bdj:k}=d);return d})().returnValue;return String.fromCharCode.apply(null,b)}Skk(b){let f=
0;for(let k=0;3>k;++k){const x=this.Ga.o2b.pa(this.Ga.Edf+b)^182;++b;f|=(x&127)<<7*k;if(!(x&128))break}return{returnValue:f,Bdj:b}}}Object(y.a)(c,"StringTable",null,[633])},1174:function(y,r,a){a.d(r,"a",function(){return b});y=a(0);var c=a(1197);class b{constructor(f){this.trie=null;this.Edf=this.r_g=this.s_g=this.J9b=0;if(f){this.o2b=f;var k=0;if(f.fq(k,4)!==b.rTa)throw Error.argument("bytes","Input does not represent a string table");k+=4;this.owa=f.fq(k,4);k+=4;this.style=f.fq(k,4);k+=4;switch(this.style){case 0:const x=
1===f.fq(k,4);k+=4;x||(this.J9b=k,k+=4*this.owa);f.fq(k,4);this.trie=this.$$j(f,k+4);break;case 4:this.s_g=k;this.r_g=k+=4*this.owa;k+=4*this.owa;f.fq(k,4);this.Edf=k+4;break;default:throw Error.argument("bytes");}}}$$j(f,k){return new c.a(f,k)}}b.rTa=1025118440;Object(y.a)(b,"StringTableInit",null,[])},1197:function(y,r,a){a.d(r,"a",function(){return d});y=a(0);class c{constructor(h){this.ohg=h;this.succeeded=!1;this.kwb=h?h.kwb:0;this.Jxj=!1;this.length=this.e3k=0}}Object(y.a)(c,"TrieResult",null,
[]);class b{constructor(h,n,m){this.rJa=new c(null);this.yIj=h;this.mYb=n;this.ncg=n+m-1}get result(){return this.rJa}lLf(){let h;return this.mYb<=this.ncg?(h=this.yIj.charAt(this.mYb),++this.mYb,{returnValue:!0,ch:h}):{returnValue:!1,ch:"\x00"}}vhe(h,n,m){h&&(this.rJa.Jxj=!0,this.rJa.e3k=n);this.rJa.length=this.mYb;this.rJa.succeeded=!0;this.rJa.kwb=m;this.mYb!==this.ncg+1&&(this.rJa=new c(this.rJa))}}Object(y.a)(b,"LookUpStringVisitor",null,[639]);var f=a(1350);class k{constructor(){this.cdf=this.dbf=
this.fbf=this.cbf=this.ebf=this.otd=this.ntd=this.qtd=this.mtd=0}}Object(y.a)(k,"TRIESTATS",null,[]);class x{constructor(){this.symbol=this.DZb=0}}Object(y.a)(x,"TrieSymbol",null,[]);class d{constructor(h,n){this.VN=null;this.gLc=this.Kcg=this.Icg=this.Mcg=this.Ecg=this.Lcg=this.Jcg=this.Ncg=this.Fcg=0;this.My=h;if(h.fq(n,4)!==d.rTa)throw Error.argument("Input does not represent a trie");n+=4;this.rcg=1===h.fq(n,4);n+=4;this.pIj=1===h.fq(n,4);n+=4;this.mIj=h.fq(n,4);n+=4;if(h.fq(n,4)){h=n+4;this.VN=
this.Ykk(h);this.Fcg=n=h+d.GSh;this.Ncg=n+=d.xoc*(this.VN.mtd+(this.VN.mtd%2?1:0));this.Jcg=n+=d.xoc*(this.VN.qtd+(this.VN.qtd%2?1:0));this.Lcg=n+=d.xoc*(this.VN.ntd+(this.VN.ntd%2?1:0));this.Ecg=n+=d.xoc*(this.VN.otd+(this.VN.otd%2?1:0));this.Mcg=n+=d.std*this.VN.cbf;this.Icg=n+=d.ttd*this.VN.fbf;this.Kcg=n+=d.ttd*this.VN.dbf;n+=d.ttd*this.VN.ebf;if(n!==h+this.VN.cdf)throw Error.argument("Corrupted trie binary");this.gLc=n}else this.VN=null}Kbg(h,n,m,u){h=new b(h,n,m);this.yah(h,u);return h.result}dOf(h){if(this.rcg)if(h)--h;
else return"";if(!this.VN)throw Error.argument("Invalid trieID");const n=new f.a;n.Nv=0;this.i7a(n);const m=[];for(;;){if(n.Nv&d.Zza)if(h)--h;else return Array.add(m,n.e8a),String.fromCharCode.apply(null,m);const u=!!(n.Nv&d.V5c),l=this.vib(n,!0);if(u||h<l){if(Array.add(m,n.e8a),!this.i7a(n))throw Error.argument("Invalid trieID");}else if(h-=l,!this.I9b(n))throw Error.argument("Invalid trieID");}}yah(h,n){let m=0;this.rcg&&(h.vhe(this.pIj,this.mIj,0),++m);if(this.VN){var u=new f.a;u.Nv=0;if(this.i7a(u))for(;;){var l=
void 0,t=h.lLf();({ch:l}=t);if(!t.returnValue)break;n&&(l=n(l));l=l.toString().charCodeAt(0);for(t=!1;!t;){const e=!!(u.Nv&d.Zza);if(u.e8a===l){if(t=!0,e&&h.vhe(!!(u.Nv&d.tFe),u.t0c,m),!this.i7a(u))return}else if(m+=this.vib(u,!0),!this.I9b(u))return;e&&++m}}}}i7a(h){if(!h.Nv)return this.gye(h),!0;if(!(h.Nv&d.U5c))return!1;h.aka=0;h.rp=h.CHa;this.gye(h);return!0}I9b(h){if(h.Nv&d.V5c)return!1;this.gye(h);return!0}vib(h,n){return h.Nv&d.sFe?h.woc:h.Nv&d.U5c?!n&&h.Nv&d.V5c?this.GNi(h):1:0}GNi(h){h=d.cwd(h);
if(!this.i7a(h))return 0;let n=0;do h.Nv&d.Zza&&++n,n+=this.vib(h,!1);while(this.I9b(h));return n}gye(h){h.Nv||(h.aka=0,h.rp=this.gLc);var n=this.Vsc(this.Fcg,h.rp),m=n.symbol;h.rp+=n.DZb;n=this.My.fq(this.Ecg+d.std*m,d.std);h.e8a=n&65535;h.Nv=n>>16;h.Nv&d.sFe&&(h.woc=this.idi(h));h.Nv&d.tFe&&(n=this.Vsc(this.Ncg,h.rp),m=n.symbol,h.rp+=n.DZb,h.t0c=this.My.fq(this.Mcg+4*m,4));h.Nv&d.Fgh?(h.CHa=this.gLc+((this.My.pa(h.rp)<<8|this.My.pa(h.rp+1))<<8|this.My.pa(h.rp+2)),h.rp+=3):h.Nv&d.Ggh?(h.CHa=h.rp,
h.aka=h.CHa):h.Nv&d.Hgh?(n=this.Vsc(this.Jcg,h.rp),m=n.symbol,h.rp+=n.DZb,h.CHa=this.gLc+this.My.fq(this.Icg+4*m,4)):h.Nv&d.U5c&&(n=this.Vsc(this.Lcg,h.rp),m=n.symbol,h.rp+=n.DZb,h.aka||(h.aka=h.rp),h.aka+=this.My.fq(this.Kcg+4*m,4),h.CHa=h.aka)}Vsc(h,n){const m=new x;let u=0;for(;;){u+=this.My.pa(n);++n;++m.DZb;const l=this.My.fq(h,2);if(u<l)break;m.symbol+=l;u-=l;h+=2;u<<=8}m.symbol+=u;return m}idi(h){let n=this.My.pa(h.rp);192<=n?(n=(n&63)<<15|(this.My.pa(h.rp+1)&127)<<8,n|=this.My.pa(h.rp+2),
h.rp+=3):128<=n?(n=(n&127)<<8|this.My.pa(h.rp+1),h.rp+=2):h.rp+=1;return n}Ykk(h){const n=new k;n.mtd=this.My.fq(h+12,2);n.qtd=this.My.fq(h+14,2);n.ntd=this.My.fq(h+16,2);n.otd=this.My.fq(h+18,2);n.ebf=this.My.fq(h+24,4);n.cbf=this.My.fq(h+28,4);n.fbf=this.My.fq(h+32,4);n.dbf=this.My.fq(h+36,4);n.cdf=this.My.fq(h+40,4);return n}static cwd(h){const n=new f.a;n.e8a=h.e8a;n.Nv=h.Nv;n.woc=h.woc;n.rp=h.rp;n.CHa=h.CHa;n.aka=h.aka;n.t0c=h.t0c;return n}}d.rTa=1654263084;d.GSh=48;d.xoc=2;d.ttd=4;d.std=4;d.Zza=
1;d.V5c=2;d.sFe=4;d.tFe=8;d.U5c=16;d.Ggh=64;d.Hgh=128;d.Fgh=256;Object(y.a)(d,"Trie",null,[640])},1350:function(y,r,a){a.d(r,"a",function(){return c});y=a(0);class c{constructor(){this.t0c=this.aka=this.CHa=this.rp=this.woc=this.Nv=this.e8a=0}}Object(y.a)(c,"TRIESCAN",null,[])},1546:function(y,r,a){r=a(490);a=a(1547);a=a.Di?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);r(a,{insert:"head",Oj:!1});y.exports=a.Fk||{}},1547:function(y,r,a){r=a(489)(!1);r.push([y.i,'.NumberFormatStyleItem{color:#444;font:inherit}.NumberFormatStyleItem input,.NumberFormatStyleItem select{margin-bottom:1.5%}.NumberFormatCategoryList{width:22%;height:50%;margin-bottom:20%;height:65%}.NumberFormatRtlFloat{float:right}.NumberFormatLtrFloat{float:left}.NumberFormatDynamicList{width:70%;height:70%}.NumberFormatDynamicListRtlMargin{margin-right:3%}.NumberFormatDynamicListLtrMargin{margin-left:3%}.NumberFormatDlgFunctionBody{margin:0 13px 10px 13px;width:100%;height:346px}.NumberFormatDlgWidth{width:560px}.NumberFormatDlgBodyWidth{width:560px}.NumberFormatDescriptionItem{height:32%;width:95%;position:relative;top:4%;z-index:-1}.NumberFormatLinkItem{margin-bottom:6px;display:inline-block}.NumberFormatRtlLabelItem{margin-left:2%}.NumberFormatLtrLabelItem{margin-right:2%}.NumberFormatSampleItem{width:100%;background-color:#fff}.NumberFormatDynamicListItemWidth{width:100%;font:inherit}.NumberFormatCategoryListItemWidth{width:100%;font:inherit}.NumberFormatCategoryListItemHeight{max-height:325px}.NumberFormatSymbolItemWidth{width:100%}.NumberFormatItemColorStyle{color:red}.NumberFormatFocusCheckbox{outline:0}.NumberFormatBorderLabel{border:1px gray dashed}.NumberFormatFontLabel{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif}.NumberFormatSelectionBorder{border:1px solid #a9a9a9}',
""]);y.exports=r},1548:function(y,r,a){r=a(490);a=a(1549);a=a.Di?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);r(a,{insert:"head",Oj:!1});y.exports=a.Fk||{}},1549:function(y,r,a){r=a(489)(!1);r.push([y.i,'.ewa-condfmt-dlg-err-label{width:400px;min-height:21px;margin-bottom:-15px;font-size:8pt;color:#d90000}.ewa-condfmt-dlg-header-label{font-weight:700}.ewa-condfmt-dlg-with-label{padding-left:3px;padding-right:3px}.ewa-condfmt-dlg-list{width:auto;width:initial}.ewa-condfmt-dlg-input{width:auto;width:initial;padding-left:3px}.CondtionalFormattingPane{background:#edebe9;height:100%;overflow:hidden;display:flex;flex-direction:column}.CondtionalFormattingPaneHeader{position:relative;overflow:hidden;padding:16px 16px 16px 16px}.CondtionalFormattingPaneBody{flex:auto;position:relative}.CondtionalFormattingPaneTitle{position:relative!important;max-width:230px;display:inline-block;text-overflow:ellipsis;overflow:hidden;height:22px;font-weight:400;background:#edebe9;font-size:16px;color:#252423;font-family:"Segoe UI Semibold","Segoe UI Web",Arial,Verdana,sans-serif}.CondtionalFormattingCloseButton{display:inline-block;padding:0 5px;font-size:16px}',
""]);y.exports=r},1551:function(y,r,a){a.r(r);a.d(r,"SurfaceStringTokenStringGenerator",function(){return b});y=a(0);var c=a(1096);class b extends c.a{constructor(f){super(f);this.Ga=f}apply(f,k,x,d,h,n,m){null==n&&(n=f.HOf(h,k));m=c.a.B3e(f,n,this.Ga.score,x,d,m);return{z9b:n,MHb:m}}}b.NHb=0;Object(y.a)(b,"SurfaceStringTokenStringGenerator",c.a,[])},1552:function(y,r,a){a.r(r);a.d(r,"QueryTokenStringGenerator",function(){return f});y=a(0);var c=a(1096),b=a(934);class f extends c.a{constructor(k){super(k);
this.Ga=k}apply(k,x,d,h,n,m,u){x=this.Ga.query.load(x,null);n=0;let l=null;this.Ga.query.uO===b.Annotations.n$?x&&(l=this.Ga.name):((l=this.Ga.name)&&(l+="_"),l+=this.Ga.annotations.jW(this.Ga.query.uO,x));null!=l&&(n=c.a.B3e(k,l,this.Ga.score,d,h,n));return{z9b:m,MHb:u+n}}}f.NHb=1;Object(y.a)(f,"QueryTokenStringGenerator",c.a,[])},1553:function(y,r,a){a.r(r);a.d(r,"FuzzyMatchTokenStringGenerator",function(){return b});y=a(0);var c=a(1096);class b extends c.a{constructor(f){super(f);this.Ga=f}apply(f,
k,x,d,h,n,m){null==n&&(n=f.HOf(h,k));f=this.Ga.guf.YHj(n);if(this.Ga.Zug)for(const l of f)if(!l.lC&&l.Exc)return{z9b:n,MHb:m};let u=0;for(const l of f)if(l.lC&&!(()=>{let t=this.f8e(l,!0,x,d,u);({ptd:u}=t);return t})().returnValue)return{z9b:n,MHb:m};if(this.Ga.PVf)for(const l of f)if(!(()=>{let t=this.f8e(l,!1,x,d,u);({ptd:u}=t);return t})().returnValue)break;return{z9b:n,MHb:m}}f8e(f,k,x,d,h){let n;k?(k=0,n=f.Exc?1:0):(k=f.Exc?1:0,n=f.count-k);for(let m=0;m<n;++m)if(c.a.C3e(f.LFa+k+m,this.Ga.score,
x,d),++h,0<this.Ga.o5d&&h>=this.Ga.o5d)return{returnValue:!1,ptd:h};return{returnValue:!0,ptd:h}}}b.NHb=2;Object(y.a)(b,"FuzzyMatchTokenStringGenerator",c.a,[])},496:function(y,r,a){a.r(r);var c={};a.r(c);a.d(c,"AccountingFormatMenuCommandHandler",function(){return L});var b={};a.r(b);a.d(b,"AssistanceCommandHandler",function(){return da});var f={};a.r(f);a.d(f,"ConditionalFormattingCommandHandler",function(){return $c});var k={};a.r(k);a.d(k,"NumberFormatCommandHandler",function(){return Pc});var x=
{};a.r(x);a.d(x,"NumberFormatViewModel",function(){return Wc});var d={};a.r(d);a.d(d,"TellMeCommandHandler",function(){return Ji});var h=a(133),n=a(0),m=a(15),u=a(41),l=a(70),t=a(209),e=a(67),w=a(5),z=a(213),E=a(36),M=a(266);class G extends Sys.EventArgs{constructor(P){super();this.obb=P}}Object(n.a)(G,"AccountingFormatMenuDataLoadedEventArgs",Sys.EventArgs,[]);var A=a(61);class N extends u.a{constructor(P,ua){super();this.BSj=()=>{this.raiseEvent("AccountingFormatOptionsDataLoadFailed")};this.CSj=
Xa=>{!E.a.Ls(Xa.Errors)&&Xa.Result?this.raiseEvent("AccountingFormatMenuDataLoaded",new G(Xa.Result)):this.raiseEvent("AccountingFormatOptionsDataLoadFailed")};this.sa=P;this.userOperationManager=ua}aod(P){this.addHandler("AccountingFormatMenuDataLoaded",P)}IGg(P){this.removeHandler("AccountingFormatMenuDataLoaded",P)}$nd(P){this.addHandler("AccountingFormatOptionsDataLoadFailed",P)}HGg(P){this.removeHandler("AccountingFormatOptionsDataLoadFailed",P)}UCj(){this.userOperationManager.enqueueOperation(new z.a(166,
0,(P,ua,Xa)=>{var Pb=this.sa;P=M.c(P,this.CSj);ua=M.b(ua,this.BSj);const hc=Pb.$a(5);return A.h(Pb,"GetAccountingFormatMenuData",hc,P,ua,Xa,null,4)},16),null)}}Object(n.a)(N,"AccountingFormatMenuDataLoader",u.a,[256]);class K{constructor(P){this.Ya=P}jHi(P,ua){return this.PHi(P,ua).wH()}PHi(P,ua){ua=this.Ya.pq(ua);if(P){var Xa=this.Ya.uc();for(let Pb=0;Pb<P.NumberOfMenuItems;++Pb){const hc=this.h5h(Pb.toString(),P.MenuItemLabels[Pb]);Xa.buttons.push(hc)}ua.Zb.push(Xa)}P=this.Ya.uc();Xa=this.e9h();
P.buttons.push(Xa);ua.Zb.push(P);return ua}h5h(P,ua){P=this.Ya.O0(137,"Number.AccountingFormatOptionMenuItem_"+P,443187837,null,1,"None",0,0,P,!1,0);P.label=ua;P.Ap(ua);return P}e9h(){return this.Ya.O0(137,"Number.MoreAccountingFormatOptionsMenuItem",2105621672,null,1,"None",496,0,"3",!1,1594)}}Object(n.a)(K,"AccountingFormatMenuRenderer",null,[254]);var I=a(65);let L=class extends u.a{constructor(P,ua,Xa,Pb,hc,Qc){Pb=void 0===Pb?null:Pb;hc=void 0===hc?null:hc;Qc=void 0===Qc?null:Qc;super();this.R0e=
0;this.obb=null;this.Ew=0;this.menuId=this.QM=null;this.Uig=()=>{this.obb=null;this.Ew=3;this.q$f("OnAccountingFormatMenuDataLoadFailure");this.oma();this.raiseEvent("ek2")};this.Vig=(vd,Nd)=>{this.obb=Nd.obb;this.Ew=2;this.q$f("OnAccountingFormatMenuDataLoadSuccess");this.oma();this.raiseEvent("ek1")};this.frame=w.AccountingFormatMenuCommandHandlerService.Oa()?P.frame:Pb;this.dLb=w.AccountingFormatMenuCommandHandlerService.Oa()?new N(P.ma.sa,P.userOperationManager):hc;this.dLb.aod(this.Vig);this.dLb.$nd(this.Uig);
this.$e=Xa;this.lob=w.AccountingFormatMenuCommandHandlerService.Oa()?new K(ua):Qc;this.Cxk()}aod(P){this.addHandler("ek1",P)}IGg(P){this.removeHandler("ek1",P)}$nd(P){this.addHandler("ek2",P)}HGg(P){this.removeHandler("ek2",P)}dispose(){this.dLb.IGg(this.Vig);this.dLb.HGg(this.Uig);super.dispose()}td(P,ua,Xa){if("PopulateAccountingFormatsMenu"!==ua)return!1;this.menuId=Xa.MenuId;if(2!==this.Ew&&3!==this.Ew)return!1;this.QM=this.QM||this.lob.jHi(this.obb,Xa.MenuId);Xa.MenuItems=this.QM;return!0}gd(){return!1}Rc(P,
ua){return 443187837===ua.command}executeCommand(P,ua,Xa){return 443187837===ua.command?(P={ValidMembers:32,NumberFormat:14},P.NumberFormatOptions=this.obb.NumberFormatOptions[parseInt(Xa[l.a.Wc].toString(),10)],this.$e.formatCells(443187837,P,ua),e.Task.Va(!0)):t.a(ua.command)}Cxk(){this.R0e=Date.now();this.Ew=1;this.dLb.UCj()}q$f(P){const ua=Date.now()-this.R0e;m.ULS.sendTraceTag(537155170,0,50,`AccountingFormatMenuCommandHandler.${P}: AccountingFormat Menu loading time was : ${ua} ms`)}oma(){this.menuId&&
this.frame.Kv(this.menuId)}};L=Object(h.__decorate)([Object(I.d)(w.AccountingFormatMenuCommandHandlerService),Object(h.__param)(0,Object(w.EwaControlService)()),Object(h.__param)(1,Object(w.RibbonControlsService)()),Object(h.__param)(2,Object(w.FormatCellsActionService)())],L);Object(n.a)(L,"AccountingFormatMenuCommandHandler",u.a,[29,238]);var J=a(6),B=a(281),Y=a(55),U=a(7),O=a(83),C=a(1),X=a(151),S=a(26),ea=a(19),Oa=a(257),Ha=a(141);class Za{constructor(){this.correlationId=this.sessionId=this.yhd=
null;this.actionId=0;this.qbb=null}get qe(){return this.yhd?this.yhd:""}set qe(P){this.yhd=P}}Object(n.a)(Za,"AssistanceSearchVariableUrlParameterSet",null,[]);var fa=a(292),la=a(612),ba=a(135);class aa{constructor(){this.LB=!1;this.vJ=!0;this.AXe=this.lyb=null}get isInitialized(){return this.LB}initialize(P,ua){const Xa=!!P&&!!ua;Xa&&(this.lyb=P,this.AXe=ua);this.LB=Xa}wi(P){P||(P=J.AFrameworkApplication.Kb);this.vJ=J.AFrameworkApplication.Gv;Object(ea.d)(Oa.a).execute(ua=>{ua.isFeatureEnabled("mso_sendASmile",
!0).then(Xa=>{this.vJ=J.AFrameworkApplication.Gv&&Xa;(Xa=J.AFrameworkApplication.ua)&&Xa.ax();return null},()=>null)});P.jc(S.a.searchHelp,ba.a.frame,Object(Ha.a)(this,this.cXk,"showSearchResults"))}cXk(P,ua,Xa,Pb,hc){if(1===Xa)return J.AFrameworkApplication.ea.ka("IsFeedbackExperiencesAvailable")||(this.vJ=!1),hc&&"SourceControlId"in hc&&(hc=hc.SourceControlId,("GiveFeedback"===hc||"btnFeedback"===hc||"btnFeedbackPane"===hc||"PptEditingStatusBar.GiveFeedbackPane"===hc||"GiveFeedbackPane"===hc)&&
!this.vJ)?8:la.SessionStatusManager.instance.iYa?8:32;m.ULS.sendTraceTag(4761738,1302,50,"");fa.a.mark(4771);if(this.isInitialized){P=hc.CommandValueId;ua=hc.SourceControlId;hc=Object.assign(new Za,{actionId:S.a.searchHelp,qbb:hc});if(void 0!==P&&null!==P)hc=aa.c4i(P);else if(void 0!==ua&&null!==ua)switch(ua){case "btnFeedback":case "btnFeedbackPane":case "PptEditingStatusBar.GiveFeedbackPane":case "GiveFeedbackPane":case "GiveFeedback":hc.actionId=S.a.giveFeedback;break;case "btnContactSupport":case "ContactSupport":hc.actionId=
S.a.contactSupport;break;case "btnShowTraining":case "Training":hc.actionId=S.a.n7k;break;case "btnWhatsNew":case "WhatsNew":hc.actionId=S.a.vkl}this.lyb.IUk(this.AXe,hc);fa.a.mark(4772);return 32}fa.a.mark(4772);return 8}dispose(){this.lyb&&(this.lyb.dispose(),this.lyb=null)}static get instance(){aa.Wa||(aa.Wa=new aa);return aa.Wa}static c4i(P){const ua=new Za,Xa=P.indexOf("|");ua.sessionId=P.substring(0,Xa);const Pb=P.indexOf("|",Xa+1);ua.correlationId=P.substring(Xa+1,Pb);ua.qe=P.substr(Pb+1);
return ua}}aa.Wa=null;Object(n.a)(aa,"AssistanceActor",null,[4]);var oa=a(32),Na=a(932);class Ia{constructor(){this.yHe=this.ya=this.G8a=null;this.Egd=!1}IUk(P,ua){if(ua.actionId!==S.a.giveFeedback||J.AFrameworkApplication.Gv)if(this.Egd&&!J.AFrameworkApplication.disableWholeAppsForOfficeFeature)this.G8a||(this.G8a=this.yHe()),this.G8a.t7b();else if(ua.actionId===S.a.giveFeedback)this.lUk();else{P=P.uBc(ua);ua=null;try{oa.a.nda(P)&&(ua=Y.a.Rg(P,"_blank","height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no",
"AssistanceDisplayManager:HelpWindow"))}catch(Xa){throw m.ULS.sendTraceTag(4543175,1302,10,"An exception has occured while trying to launch the Online Assistance window: "+Xa.message),Xa;}ua?m.ULS.sendTraceTag(4543177,1302,50,"Window.Open() returned a window when opened with URL {0}",P):m.ULS.sendTraceTag(4543176,1302,15,"Window.Open() returned a null window when opened with URL {0} and help options {1}",P,"height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no")}else m.ULS.sendTraceTag(554295451,
356,15,"ShowFeedbackButton is false, but ShowContent got called, some feedback entry point is still visible")}dispose(){this.G8a&&(this.G8a.dispose(),this.G8a=null)}rTg(P,ua,Xa){Xa&&Na.c(P)?this.Egd=!1:(this.yHe=P,this.Egd=Xa);this.ya=ua}lUk(){J.AFrameworkApplication.Kb.hf(S.a.giveFeedback,2)}static createInstance(P,ua,Xa){Xa=void 0===Xa?null:Xa;const Pb=new Ia;null==Xa?Pb.rTg(P,ua,J.AFrameworkApplication.U8e||ua.ka("HelpTabIsEnabled")):Pb.rTg(P,ua,Xa);return Pb}}Object(n.a)(Ia,"AssistanceDisplayManager",
null,[538,4]);var Sa=a(666);class Pa{constructor(P,ua,Xa,Pb,hc){this.Toa=P;this.arh=ua;this.Wfc=Xa;this.Yih=Pb;this.Ned=hc}get lcid(){return this.Toa}get namespace(){return this.arh}get $0a(){return this.Wfc}get tKh(){return this.Yih}get locale(){return this.Ned}static H3i(P){const ua=P.indexOf(".");return 0<=ua&&ua<P.length&&(P=parseInt(P.substring(0,ua)),!isNaN(P))?P:Pa.qLh}static createInstance(P){return new Pa(J.AFrameworkApplication.lcid,P,Pa.H3i(J.AFrameworkApplication.buildVersion),"WDWAENDUSER,XLWAENDUSER,PPWAENDUSER,ONWAENDUSER",
Sa.a.kN(J.AFrameworkApplication.lcid).name)}}Pa.qLh=16;Object(n.a)(Pa,"AssistanceSearchUrlParameterSet",null,[]);var za=a(284);class wa{constructor(P,ua){P=new za.QueryStringBuilder(P);P.uj("clid",ua.lcid.toString());P.uj("p1",ua.namespace);P.uj("ver",ua.$0a.toString());P.uj("apps",ua.tKh);P.uj("lc",ua.locale);this._url=P.toString()}uBc(P){const ua=new za.QueryStringBuilder(this._url);ua.uj("src","TellMe");ua.uj("query",P.qe);ua.uj("sessionid",P.sessionId);ua.uj("correlationid",P.correlationId);return ua.toString()}static createInstance(P){return new wa(J.AFrameworkApplication.V8e,
P)}}Object(n.a)(wa,"AssistanceSearchUrlProvider",null,[536]);class db{ji(){}init(){J.AFrameworkApplication.SSa&&!J.AFrameworkApplication.suppressHelp&&aa.instance.wi(J.AFrameworkApplication.Kb)}dispose(){aa.instance.dispose()}Ogj(){aa.instance.initialize(Ia.createInstance("XLWAEndUser",J.AFrameworkApplication.ea),wa.createInstance(Pa.createInstance(void 0)))}}Object(n.a)(db,"AssistancePackage",null,[11,12]);class Ba extends db{constructor(){super()}get name(){return"Excel.Assistance"}init(){super.init();
this.Ogj()}}Object(n.a)(Ba,"ExcelAssistancePackage",db,[]);var Ka=a(98);let da=class{constructor(P,ua){this.zh=P;this.$=ua;J.AFrameworkApplication.SSa&&B.a.instance.Qi(new Ba)}gd(){return!1}executeCommand(P,ua,Xa,Pb){C.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback")&&X.b(this.$).Qje();P=Xa[l.a.Wc];if(!C.EwaSettings.isChangeGateEnabled("OfficeVSO:8914608_FallbackToBellyBandFeedback")&&!C.EwaSettings.Ra(221)&&(P&&P===U.a.DSc||7===ua.Re&&Xa.SourceControlId===this.$.Oc+
U.a.Xta))return 2===this.zh.pe(S.a.giveFeedback,2,Xa)?t.a(ua.command):e.Task.Va(!0);if(C.EwaSettings.Ra(221)&&!J.AFrameworkApplication.disableWholeAppsForOfficeFeature&&(2===ua.Re||7===ua.Re||C.EwaSettings.isChangeGateEnabled("OfficeVSO:3009717_EnableTellMeHelpForAgaveHelpPane")&&-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback Tutorials".split(" "),P))){Xa[U.a.wna]=Pb?Pb.enabledInViewModeRibbon:!1;ua=new O.a(-859308420,ua.method,ua.mode,ua.Re,ua.tabName);C.EwaSettings.isChangeGateEnabled("OfficeVSO:8192446_HelpTabTelemetry")&&
Ka.b("HelpTab"+P);if("WhatsNew"===P&&C.EwaSettings.isChangeGateEnabled("OfficeVSO:8898201_HelpTabShipCG"))return Y.a.Rg("https://techcommunity.microsoft.com/t5/excel-blog/bg-p/ExcelBlog"),e.Task.Va(!0);"Tutorials"===P&&(Xa[l.a.Bf]="AssetID=9bc05390-e94c-46af-a5b3-d7c22f6990bb");return this.$.Ia.Gb(ua,Xa)}return C.EwaSettings.isChangeGateEnabled("OfficeVSO:8914608_FallbackToBellyBandFeedback")&&(P&&P===U.a.DSc||7===ua.Re&&Xa.SourceControlId===this.$.Oc+U.a.Xta)?2===this.zh.pe(S.a.giveFeedback,2,Xa)?
t.a(ua.command):e.Task.Va(!0):2===this.zh.pe(S.a.searchHelp,2,Xa)?t.a(ua.command):e.Task.Va(!0)}Rc(P,ua){return J.AFrameworkApplication.SSa?-1376725189===ua.command||-1969051244===ua.command:!1}td(){return!1}};da=Object(h.__decorate)([Object(I.d)(w.AssistanceCommandHandlerService),Object(h.__param)(0,Object(w.ActionManagerService)()),Object(h.__param)(1,Object(w.EwaControlService)())],da);Object(n.a)(da,"AssistanceCommandHandler",null,[29]);var sa=a(2);class mb{constructor(){this.QuickFormatType=
this.Command=0;this.Formula2=this.Formula1=null;this.Value=10;this.Unique=!1;this.TimePeriodType=0;this.StopIfTrue=!1;this.Priority=-1;this.CustomFormat=null}}Object(n.a)(mb,"ConditionalFormattingOptions",null,[]);var Ma=a(10),hb=a(1034),$a=a(179);const Va=(P,ua,Xa,Pb,hc,Qc,vd,Nd)=>{Nd=P.$a(1,void 0===Nd?null:Nd);Nd.entireSheet=ua;Nd.selectedRanges=Xa;return A.h(P,"GetConditionalFormattingRules",Nd,Pb,hc,Qc,vd,4)},xa=(P,ua,Xa,Pb,hc,Qc,vd,Nd,ke)=>{ke=P.$a(9,void 0===ke?null:ke);ke.deleteCommandType=
ua;ke.selectedRanges=Xa;ke.id=Pb;return A.h(P,"DeleteConditionalFormattingRules",ke,hc,Qc,vd,Nd,0)},ia=(P,ua,Xa,Pb,hc,Qc,vd,Nd,ke)=>{ke=P.$a(9,void 0===ke?null:ke);ke.conditionalFormattingOptions=ua;ke.selectedRanges=Xa;ke.activeCell=Pb;return A.h(P,"AddConditionalFormattingRule",ke,hc,Qc,vd,Nd,0)},Z=(P,ua,Xa,Pb,hc,Qc,vd,Nd,ke,Be)=>{Be=P.$a(9,void 0===Be?null:Be);Be.id=ua;Be.conditionalFormattingOptions=Xa;Be.range=Pb;Be.activeCell=hc;return A.h(P,"QuickEditConditionalFormattingRule",Be,Qc,vd,Nd,
ke,0)};var ta=a(44),pa=a(226),Ga=a(172),Ca=a(255),kb=a(1656);const eb=(P,ua,Xa,Pb,hc,Qc)=>{var vd,Nd,ke,Be,Ze,of,Xf,bg,Mg,Jg,F,va,lb,sc,Yc,jd,Ad,Kd,ye,Ne,hf,sf,Gf,Yf;m.ULS.sendTraceTag(537167185,0,50,"GetConditionalFormattingRulesHelper.OnGetConditionalRulesSuccessCallback");if(P&&Ca.a(P)){a:switch(P.Errors[0].MessageId){case -139005925:ua=1;break a;case 1557873584:ua=2;break a;default:ua=0}0!==ua?(m.ULS.sendTraceTag(593589700,0,15,`GetConditionalFormattingRulesHelper.OnGetConditionalRulesSuccessCallback: request ended with expected error: ${P.Errors[0].MessageIdName}.`),
hc(Pb,null,ua)):(Pb=E.a.pc(P.Errors),m.ULS.sendTraceTag(593589699,0,15,`GetConditionalFormattingRulesHelper.OnGetConditionalRulesSuccessCallback: request ended with errors: ${Pb}.`),C.EwaSettings.isChangeGateEnabled("OfficeVSO:8380585_InvestigateConditionalFormattingCriticalError_5")&&Qc&&"InvalidSheetName"===Pb&&m.ULS.sendTraceTag(508071950,0,15,`GetConditionalFormattingRulesHelper.OnGetConditionalRulesSuccessCallback: \
            request ended with errors: ${Pb}. \
            triggerMethod: ${Qc.triggerMethod}. \
            isInputSheetNameValid: ${Qc.psj}. \
            isActiveItemSheetNameValid: ${Qc.Qlj}. \
            onConditionalFormattingRulesChangedCallTimeStamp: ${null!==(Nd=null===(vd=Qc.rVj)||void 0===vd?void 0:vd.getTime())&&void 0!==Nd?Nd:-1}. \
            metadataVersionBeforeLastUpdate: ${Qc.ULj}. \
            lastMetadataVersionNumber: ${Qc.T0d}. \
            lastMetadataVersionNumberUpdateOwner: ${Qc.U0d}. \
            lastMetadataVersionNumberUpdateTimestamp: ${null!==(Be=null===(ke=Qc.V0d)||void 0===ke?void 0:ke.getTime())&&void 0!==Be?Be:-1}. \
            lastRaiseEventStart: ${null!==(of=null===(Ze=Qc.a1d)||void 0===Ze?void 0:Ze.getTime())&&void 0!==of?of:-1}. \
            lastRaiseEventEnd: ${null!==(bg=null===(Xf=Qc.$0d)||void 0===Xf?void 0:Xf.getTime())&&void 0!==bg?bg:-1}. \
            lastDeleteSheetBeforeGoingToServerTimeStamp: ${null!==(Jg=null===(Mg=Qc.G0d)||void 0===Mg?void 0:Mg.getTime())&&void 0!==Jg?Jg:-1}. \
            lastDeleteMetadataVersionNumber: ${Qc.B0d}. \
            lastDeleteMetadataVersionNumberUpdateTimestamp: ${null!==(va=null===(F=Qc.C0d)||void 0===F?void 0:F.getTime())&&void 0!==va?va:-1}. \
            lastDeleteRaiseEventStart: ${null!==(sc=null===(lb=Qc.E0d)||void 0===lb?void 0:lb.getTime())&&void 0!==sc?sc:-1}. \
            lastDeleteRaiseEventEnd: ${null!==(jd=null===(Yc=Qc.D0d)||void 0===Yc?void 0:Yc.getTime())&&void 0!==jd?jd:-1}. \
            lastWorkbookMetadataChangedEventOnDeleteSheetTimeStamp: ${null!==(Kd=null===(Ad=Qc.s1d)||void 0===Ad?void 0:Ad.getTime())&&void 0!==Kd?Kd:-1}. \
            lastDeleteSheetFromClientTimeStamp: ${null!==(Ne=null===(ye=Qc.H0d)||void 0===ye?void 0:ye.getTime())&&void 0!==Ne?Ne:-1}. \
            lastDeleteSetActiveItemTimeStamp: ${null!==(sf=null===(hf=Qc.F0d)||void 0===hf?void 0:hf.getTime())&&void 0!==sf?sf:-1}. \
            isActiveSheetNameValidCalled: ${Qc.V7.CYf}. \
            isActiveSheetNameValidCallTime: ${null!==(Yf=null===(Gf=Qc.V7.BYf)||void 0===Gf?void 0:Gf.getTime())&&void 0!==Yf?Yf:-1}. \
            activeItemSheetNameValid: ${Qc.V7.o1e}. \
            activeItemErrorCode: ${Qc.V7.n1e}. \
            latestWorkbookMetadataValid: ${Qc.V7.H8f}. \
            sheetChangesValid: ${Qc.V7.RTg}. \
            sheetChangesSize: ${Qc.V7.QTg}. \
            deleteOrRenameChangeInfoFound: ${Qc.V7.oBd}. \
            deletedRenamedSheetNameValid: ${Qc.V7.rBd}. \
            deletedRenamedErrorCode: ${Qc.V7.qBd}. \
            activeSheetNameEqualsChangeInfoName: ${Qc.V7.Smd}. \
            isActiveSheetNameValidReturnValue: ${Qc.V7.uUd}. \
            `))}else if(P&&P.Result){vd=P.Result;Nd=vd.Rules.length;Qc=ke=0;for(var Ng of vd.Rules)Ng&&ke++;m.ULS.sendTraceTag(537167184,0,50,`GetConditionalFormattingRulesHelper.ProcessConditionalFormattingResult got ${Nd} rules from server, ${Nd-ke} rules with errors.`);if(1>ke)ua=[];else{Ng=Array(ke);for(const dh of vd.Rules)if(dh){vd=ta.k(ta.i(dh.Range.Ranges),ua.listSeparator,ua,!1,!1,!1);vd=ke={ruleType:0,ruleId:dh.RuleId,ruleName:dh.Name,priority:dh.Priority,stopIfTrue:dh.StopIfTrue,ruleRange:vd,
ruleRangeSheetName:Xa};Nd=dh;switch(Nd.Type){case 0:vd.ruleType=0;vd.colorScaleFormat={};Nd.ColorScaleFormat?(vd.colorScaleFormat.maximumColor=Nd.ColorScaleFormat.MaxPointColor,vd.colorScaleFormat.maximumCFObjectValues={type:Nd.ColorScaleFormat.MaxPointCFValueObject.Type,formula:Nd.ColorScaleFormat.MaxPointCFValueObject.Formula,number:Nd.ColorScaleFormat.MaxPointCFValueObject.Number},vd.colorScaleFormat.minimumColor=Nd.ColorScaleFormat.MinPointColor,vd.colorScaleFormat.minimumCFObjectValues={type:Nd.ColorScaleFormat.MinPointCFValueObject.Type,
formula:Nd.ColorScaleFormat.MinPointCFValueObject.Formula,number:Nd.ColorScaleFormat.MinPointCFValueObject.Number},vd.colorScaleFormat.midpointColor=Nd.ColorScaleFormat.MidPointColor,Nd.ColorScaleFormat.MidPointCFValueObject&&(vd.colorScaleFormat.midpointCFObjectValues={type:Nd.ColorScaleFormat.MidPointCFValueObject.Type,formula:Nd.ColorScaleFormat.MidPointCFValueObject.Formula,number:Nd.ColorScaleFormat.MidPointCFValueObject.Number})):m.ULS.shipAssertTag(537167183,0,!1,"GetConditionalFormattingRulesHelper.SetFormatForRuleType: got null rule.ColorScaleFormat for color scale rule type");
break;case 1:vd.ruleType=1;vd.dataBarFormat={isGradientFill:!1,isLTRDirection:!1,isNegativeValuesFillColorCustom:!1,isNegativeValuesBorderColorCustom:!1,isShowValueEnabled:!1,axisPositionType:0};Nd.DataBarFormat?(vd.dataBarFormat.isGradientFill=Nd.DataBarFormat.IsGradientFill,vd.dataBarFormat.isLTRDirection=Nd.DataBarFormat.IsLTRDirection,vd.dataBarFormat.fillColor=Nd.DataBarFormat.FillColor,vd.dataBarFormat.borderColor=Nd.DataBarFormat.BorderColor,vd.dataBarFormat.isNegativeValuesFillColorCustom=
Nd.DataBarFormat.IsNegativeValuesFillColorCustom,vd.dataBarFormat.negativeValuesFillColor=Nd.DataBarFormat.NegativeValuesFillColor,vd.dataBarFormat.isNegativeValuesBorderColorCustom=Nd.DataBarFormat.IsNegativeValuesBorderColorCustom,vd.dataBarFormat.negativeValuesBorderColor=Nd.DataBarFormat.NegativeValuesBorderColor,vd.dataBarFormat.isShowValueEnabled=Nd.DataBarFormat.IsShowValueEnabled,vd.dataBarFormat.axisColor=Nd.DataBarFormat.AxisColor,vd.dataBarFormat.axisPositionType=Nd.DataBarFormat.AxisPositionType,
vd.dataBarFormat.minBoundCFObjectValues={type:Nd.DataBarFormat.MinBoundCFValueObject.Type,formula:Nd.DataBarFormat.MinBoundCFValueObject.Formula,number:Nd.DataBarFormat.MinBoundCFValueObject.Number},vd.dataBarFormat.maxBoundCFObjectValues={type:Nd.DataBarFormat.MaxBoundCFValueObject.Type,formula:Nd.DataBarFormat.MaxBoundCFValueObject.Formula,number:Nd.DataBarFormat.MaxBoundCFValueObject.Number}):m.ULS.shipAssertTag(537167182,0,!1,"GetConditionalFormattingRulesHelper.SetFormatForRuleType: got null rule.DataBar for color data bar rule type");
break;case 2:vd.ruleType=2;vd.iconSetFormat={isReverseIconsOrder:!1,isIconOnly:!1};if(Nd.IconSetFormat)for(vd.iconSetFormat.isReverseIconsOrder=Nd.IconSetFormat.ReverseOrder,vd.iconSetFormat.isIconOnly=Nd.IconSetFormat.IsIconOnly,m.ULS.shipAssertTag(537167181,0,!!Nd.IconSetFormat.Icons,"GetConditionalFormattingRulesHelper.SetFormatForRuleType: got null rule.IconSetFormat.Icons for icon set rule type"),vd.iconSetFormat.icons=Array(Nd.IconSetFormat.Icons.length),vd.iconSetFormat.conditionalFormattingIconsCustomOptions=
[],Be=0;Be<Nd.IconSetFormat.Icons.length;Be++)vd.iconSetFormat.icons[Be]={index:Nd.IconSetFormat.Icons[Be].Icon,iconSet:Nd.IconSetFormat.Icons[Be].IconSet},vd.iconSetFormat.conditionalFormattingIconsCustomOptions.push({isGreaterEqual:Nd.IconSetFormat.ConditionalFormattingIconsCustomOptions[Be].IsGreaterEqual,Sql:{type:Nd.IconSetFormat.ConditionalFormattingIconsCustomOptions[Be].CFValueObject.Type,formula:Nd.IconSetFormat.ConditionalFormattingIconsCustomOptions[Be].CFValueObject.Formula,number:Nd.IconSetFormat.ConditionalFormattingIconsCustomOptions[Be].CFValueObject.Number}});
else m.ULS.shipAssertTag(537167180,0,!1,"GetConditionalFormattingRulesHelper.SetFormatForRuleType: got null rule.IconSetFormat for icon set rule type");break;case 3:vd.ruleType=3;vd.customFormat={isTextBold:!1,isTextItalic:!1,isTextStrikethrough:!1,isTextUnderlined:!1,isTextDoubleUnderlined:!1};if(Nd.CustomFormat){vd.customFormat.backgroundColor=Nd.CustomFormat.BackgroundColor;vd.customFormat.textColor=Nd.CustomFormat.TextColor;vd.customFormat.isTextBold=Nd.CustomFormat.IsTextBold;vd.customFormat.isTextItalic=
Nd.CustomFormat.IsTextItalic;vd.customFormat.isTextStrikethrough=Nd.CustomFormat.IsTextStrikethrough;vd.customFormat.isTextUnderlined=Nd.CustomFormat.IsTextUnderlined;vd.customFormat.isTextDoubleUnderlined=Nd.CustomFormat.IsTextDoubleUnderlined;if(Nd.CustomFormat.BorderFormat)for(vd.customFormat.borderFormat={},vd.customFormat.borderFormat.lineStyle=Array(4),vd.customFormat.borderFormat.color=Array(4),vd.customFormat.borderFormat.thickness=Array(4),Be=0;4>Be;Be++)vd.customFormat.borderFormat.lineStyle[Be]=
Nd.CustomFormat.BorderFormat.LineStyle[Be],vd.customFormat.borderFormat.color[Be]=Ga.a.GB(pa.a.gI(Nd.CustomFormat.BorderFormat.Color[Be])),vd.customFormat.borderFormat.thickness[Be]=Nd.CustomFormat.BorderFormat.Thickness[Be];Be=vd.customFormat;if(Ze=Nd.CustomFormat.GradientFill)if(!Ze.GradientStops||1>=Ze.GradientStops.length||Ze.Type===kb.a.Path&&2!==Ze.GradientStops.length)m.ULS.shipAssertTag(591663646,0,!1,`GetConditionalFormattingRulesHelper.GetFillGradientProperties: missing gradient stops, length=${Ze.GradientStops?
Ze.GradientStops.length:-1}.`),Ze=null;else{of={isLinearGradient:Ze.Type===kb.a.Linear,degree:Ze.Degree};of.gradientStops=Array(Ze.GradientStops.length);for(Xf=0;Xf<Ze.GradientStops.length;Xf++)of.gradientStops[Xf]=Ga.a.GB(pa.a.gI(Ze.GradientStops[Xf].Color));of.isLinearGradient||(of.radialGradientPosition={},Ze.FillToRight&&1!==Ze.FillToRight?of.radialGradientPosition.isCenter=!0:(of.radialGradientPosition.isCenter=!1,of.radialGradientPosition.isRight=1===Ze.FillToRight,of.radialGradientPosition.isBottom=
1===Ze.FillToBottom));Ze=of}else Ze=null;Be.gradientFill=Ze;Nd.EditOptions&&(vd.editOptions={command:Nd.EditOptions.Command,formula1:Nd.EditOptions.Formula1,formula2:Nd.EditOptions.Formula2,value:Nd.EditOptions.Value,unique:Nd.EditOptions.Unique,timePeriod:Nd.EditOptions.TimePeriodType})}else m.ULS.shipAssertTag(537167179,0,!1,"GetConditionalFormattingRulesHelper.SetFormatForRuleType: got null rule.CustomFormat for custom rule type");break;default:m.ULS.sendTraceTag(537167178,0,10,"GetConditionalFormattingRulesHelper.GetReactRuleType unexpected rule type")}Ng[Qc]=
ke;Qc++}ua=Ng}hc(Pb,ua,0)}else m.ULS.sendTraceTag(593589698,0,10,`GetConditionalFormattingRulesHelper.OnGetConditionalRulesSuccessCallback: failed to get rules from server. Result is null: ${!P}.`)},Yb=P=>{m.ULS.sendTraceTag(593589697,0,50,`GetConditionalFormattingRulesHelper.OnGetConditionalRulesFailed: status = ${P.data.status}, HTTP status = ${P.data.httpStatus}.`)},Gb=(P,ua)=>P.priority-ua.priority;var Mb=a(25),Rb=a(134);class $b extends Sys.EventArgs{constructor(P,ua){super();this.UUd=ua}}Object(n.a)($b,
"ConditionalFormattingSheetProtectionOptionsChangedEventArgs",Sys.EventArgs,[]);var cc=a(33);class fb{constructor(P){this.h3j="OnProtectionOptionsChanged";this.GSj="OnActiveSheetChanging";this.b0a=!1;this.ub=new u.a;this.hsc=this.KJc=this.XJc=this.R4b=0;this.Jqc=null;this.dB=!1;this.UJa=(ua,Xa)=>{Mb.f(this.$).inRangePicker||Mb.f(this.$).nk||!Xa.la||(this.Sef(),this.Slj(Xa.la)?this.ub.raiseEvent("sheetProtectionOptionsChangedEventKey",new $b(!0,!1)):this.zla(this.GSj,Xa.la.sheetName,!1))};this.$_b=
(ua,Xa)=>{Xa.newName!==Xa.oldName&&Xa.newName===this.$.qa.la.name&&this.nbl(Xa.newName);C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CondFormatHandleDeletedRenamedSheet",!1)&&this.tVd()&&(this.dB&&m.ULS.sendTraceTag(507831453,0,50,"Calling onConditionaFormattingRulesChanged(onSheetRenameMethod)"),this.zla("OnSheetRename"))};this.MC=()=>{C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CondFormatHandleDeletedRenamedSheet",!1)&&this.tVd()&&(this.dB&&m.ULS.sendTraceTag(507831452,
0,50,"Calling onConditionaFormattingRulesChanged(onSheetDeletedMethod)"),this.zla("OnSheetDeletedMethod"))};this.fg=()=>{if(C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CondFormatHandleDeletedRenamedSheet",!1))this.tVd()&&this.zla("LatestCFStateIdChanged");else{const {Wlb:ua,Oee:Xa}=this.Wlb();ua&&this.$.la&&this.$.la.sheetName===Xa||this.hsc===this.$.fa.el.ConditionalFormattingRulesStateId||this.zla("LatestCFStateIdChanged")}};this.yd=(ua,Xa)=>{m.ULS.sendTraceTag(537167202,0,50,"ActiveSheetConditionalFormattingRules.OnSessionIdChanged Begin of OnSessionIdChanged");
Xa.nI&&this.zla("OnSessionIdChanged");m.ULS.sendTraceTag(537167201,0,50,"ActiveSheetConditionalFormattingRules.OnSessionIdChanged End of OnSessionIdChanged")};this.Ln=()=>{m.ULS.sendTraceTag(537167200,0,50,"ActiveSheetConditionalFormattingRules.OnLoadOnDemand");this.zla("OnLoadOnDemand")};this.gcl=(ua,Xa,Pb)=>{ua>this.KJc&&(this.KJc=ua,this.Jqc=Xa,this.Lad=void 0===Pb?0:Pb,this.b0a=!0,this.ub.raiseEvent("ConditionalFormattingRulesChangedEventKey"))};this.UYj=(ua,Xa,Pb)=>{this.b0a=!1;Yb(ua,Xa,Pb)};
this.$=P;this.Lad=0;this.$.fa.el&&(this.hsc=this.$.fa.el.ConditionalFormattingRulesStateId);this.dB=C.EwaSettings.isChangeGateEnabled("OfficeVSO:8380585_InvestigateConditionalFormattingCriticalError_5")}get kGf(){return this.Lad}mDh(P){this.ub.addHandler("ConditionalFormattingRulesChangedEventKey",P);this.R4b++;1===this.R4b&&this.jnk();this.zla("OnConditionalFormattingRulesChangedEventRegistered")}msk(P){this.ub.removeHandler("ConditionalFormattingRulesChangedEventKey",P);1>this.R4b||(this.R4b--,
this.R4b||this.a6g())}jGh(P){this.ub.addHandler("sheetProtectionOptionsChangedEventKey",P)}Vuk(P){this.ub.removeHandler("sheetProtectionOptionsChangedEventKey",P)}getConditionalFormattingRules(P){P=void 0===P?null:P;let ua;ua=null;if(!this.b0a)return this.zla("OnInvalidCache"),{returnValue:!1,Hqc:ua};ua=this.I1h(this.Jqc,P);return{returnValue:!0,Hqc:ua}}Sef(){this.KJc=this.XJc;this.Jqc=null;this.b0a=!0;this.Lad=0;this.ub.raiseEvent("ConditionalFormattingRulesChangedEventKey")}dispose(){this.a6g()}UUd(){return this.$.qa?
(new Rb.SheetProtection(this.$.qa)).ie(4):!1}zla(P,ua,Xa){ua=void 0===ua?null:ua;Xa=void 0===Xa?!0:Xa;var Pb,hc,Qc;const vd=cc.a.zb.Jc;if(this.$.fa.yc)if(ua||this.$.qa.la&&this.$.qa.la.sheetName)if(Xa&&!this.UUd())this.ub.raiseEvent("sheetProtectionOptionsChangedEventKey",new $b(!0,!1));else if(Xa={CYf:!1,BYf:new Date,o1e:!1,n1e:0,H8f:!1,RTg:!1,QTg:0,oBd:!1,rBd:!1,qBd:0,Smd:!1,fof:!1,uUd:!1},!C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CondFormatHandleDeletedRenamedSheet",!1)||ua||
this.Rlj(Xa)){++this.XJc;var Nd=this.XJc;this.hsc=this.$.fa.el?this.$.fa.el.ConditionalFormattingRulesStateId:0;var ke=ua||this.$.qa.la.sheetName,Be;this.dB&&(Be={triggerMethod:P,psj:!!ua,Qlj:!(null===(Qc=null===(hc=null===(Pb=null===this||void 0===this?void 0:this.$)||void 0===Pb?void 0:Pb.qa)||void 0===hc?void 0:hc.la)||void 0===Qc||!Qc.sheetName),rVj:vd,ULj:this.$.fa.VLj,T0d:this.$.fa.T0d,U0d:this.$.fa.U0d,V0d:this.$.fa.V0d,a1d:this.$.fa.a1d,$0d:this.$.fa.$0d,G0d:this.$.fa.G0d,B0d:this.$.fa.B0d,
C0d:this.$.fa.C0d,E0d:this.$.fa.E0d,D0d:this.$.fa.D0d,s1d:this.$.fa.s1d,H0d:this.$.fa.H0d,F0d:this.$.fa.F0d,V7:Xa});Va(this.$.ma.sa,!0,this.YPi(ke),Ze=>{this.VYj(Ze,ke,Nd,Be)},this.UYj,null,this.$.ma.sa.mc())}else this.dB&&m.ULS.sendTraceTag(507831456,0,50,"ActiveSheetConditionalFormattingRules, isActiveSheetNameValid() is false");else m.ULS.sendTraceTag(592487841,0,10,"ActiveSheetConditionalFormattingRules.OnConditionaFormattingRulesChanged: Sheets Active Item is null. ActiveItem is null: {0}. ActiveItem.SheetName is null: {1}. Is during application shut down: {2}. Get rules trigger method: {3}.",
!this.$.la,this.$.la?!this.$.la.sheetName:!1,!Sys.Application||Sys.Application.get_isDisposing(),P),this.b0a=!1;else m.ULS.sendTraceTag(592843921,0,10,"ActiveSheetConditionalFormattingRules.OnConditionaFormattingRulesChanged: Session is not active."),this.b0a=!1}VYj(P,ua,Xa,Pb){P&&P.Result&&!Ca.a(P)||(this.b0a=!1);eb(P,this.$,ua,Xa,this.gcl,Pb)}nbl(P){for(const ua of this.Jqc)ua.ruleRangeSheetName=P}I1h(P,ua){if(!P)return null;const Xa=[];ua=ua?ta.i(ua):null;for(const Pb of P)ua&&!ta.a(ta.eb(Pb.ruleRange,
this.$.listSeparator),ua)||Xa.push(Pb);return Xa}jnk(){this.$.qa.VS(this.UJa);this.$.fa.Vk(this.yd);this.$.qa.tqa(this.$_b);this.$.qa.i0(this.MC);this.$.fa.au(this.fg);this.$.fa.LJ(this.Ln);this.dB&&m.ULS.sendTraceTag(507831455,0,50,"loading ActiveSheetConditionalFormattingRules.ts register event handlers. (TimeStamp {0})",cc.a.zb.Jc.getTime())}a6g(){this.$.qa.xZ(this.UJa);this.$.fa.Qk(this.yd);this.$.qa.Axa(this.$_b);this.$.qa.y9(this.MC);this.$.fa.Bv(this.fg);this.$.fa.zL(this.Ln);this.dB&&m.ULS.sendTraceTag(507831454,
0,50,"unloading ActiveSheetConditionalFormattingRules.ts event handlers . (TimeStamp {0})",cc.a.zb.Jc.getTime())}Rlj(P){var ua,Xa,Pb,hc,Qc,vd,Nd,ke,Be,Ze;this.dB&&(P.CYf=!0,P.BYf=cc.a.zb.Jc,P.o1e=!!this.$.qa.la.sheetName,P.n1e=null!==(Xa=null===(ua=this.$.qa.la.sheetName)||void 0===ua?void 0:ua.length)&&void 0!==Xa?Xa:0,P.H8f=!!this.$.fa.el,P.RTg=!(null===(Pb=this.$.fa.el)||void 0===Pb||!Pb.SheetChanges),P.QTg=null!==(vd=null===(Qc=null===(hc=this.$.fa.el)||void 0===hc?void 0:hc.SheetChanges)||void 0===
Qc?void 0:Qc.length)&&void 0!==vd?vd:0,P.oBd=!1,P.rBd=!1,P.qBd=0,P.Smd=!1,P.fof=!1,P.uUd=!1);ua=this.$.qa.la.sheetName;if(!ua)return!1;Xa=null!==(ke=null===(Nd=this.$.fa.el)||void 0===Nd?void 0:Nd.SheetChanges)&&void 0!==ke?ke:[];Nd=null;for(const of of Xa)if(!this.dB||1!==of.Type&&2!==of.Type||(P.oBd=!0,P.rBd=!!of.Name,P.qBd=null!==(Ze=null===(Be=of.Name)||void 0===Be?void 0:Be.length)&&void 0!==Ze?Ze:0,P.Smd=of.Name===ua,Nd=of.Name),(1===of.Type||2===of.Type)&&of.Name===ua)return!1;if(this.dB&&
Nd)for(let of=0,Xf=this.$.qa.count;of<Xf;of++)Nd===this.$.qa.getItem(of).name&&(P.fof=!0);this.dB&&(P.uUd=!0);return!0}tVd(){const {Wlb:P,Oee:ua}=this.Wlb();return!(P&&this.$.la&&this.$.la.sheetName===ua)&&this.hsc!==this.$.fa.el.ConditionalFormattingRulesStateId}Wlb(){let P=!1,ua;const Xa=this.$.fa.el;if(Xa&&Xa.SheetChanges&&this.$.qa){var Pb=Xa.SheetChanges;const hc=this.$.qa.la;if(!hc)return{Wlb:!1,Oee:void 0};for(const Qc of Pb)Pb=128===Qc.Options||131072===Qc.Options,6!==Qc.Type&&7!==Qc.Type||
!Pb||(this.g3j(Xa,hc,Qc),ua=Qc.Name,P=!0)}return{Wlb:P,Oee:ua}}g3j(P,ua,Xa){Xa=this.$.zn.getItemByName(Xa.Name).index;P=P.Sheets[Xa];Xa=1024===(P.Flags&1024);const Pb=!!P.AllowSheetProtectionFeatures&&!!(P.AllowSheetProtectionFeatures&4);Xa=!(16===(P.Flags&16)&&!Xa)||Pb;if(ua=P.Name===ua.sheetName)Xa?(this.Sef(),this.zla(this.h3j,void 0,!1)):this.KJc=this.XJc;this.ub.raiseEvent("sheetProtectionOptionsChangedEventKey",new $b(ua,Xa))}Slj(P){const ua=P.ASa&4;return!!P&&P.Ih&&!ua}YPi(P){return ta.s(P,
"",0,0,0,0)}}Object(n.a)(fb,"ActiveSheetConditionalFormattingRules",null,[]);var Sb=a(1483),kc=a(369);class na{static ejg(P,ua){if(ua&&Ca.a(ua)){const Xa=E.a.pc(ua.Errors);m.ULS.sendTraceTag(578336280,0,50,`OnAddConditionalFormattingRuleSuccess: request ended with errors: ${Xa}.`);na.UVg(P,ua)}Ka.b("ConditionalFormatting_OnAddConditionalFormattingRuleSuccess")}static HSj(P){m.ULS.sendTraceTag(578336279,0,50,`GetConditionalFormattingRulesHelper.OnAddConditionalFormattingRuleFailed: status = ${P.data.status}, HTTP status = ${P.data.httpStatus}.`)}static cXj(P,
ua,Xa){if(Xa&&Ca.a(Xa)){const Pb=E.a.pc(Xa.Errors);m.ULS.sendTraceTag(573686987,0,50,`OnEditConditionalFormattingRuleSuccess: request ended with errors: ${Pb}.`);na.UVg(P,Xa);na.vUk(P,Xa);ua.DAe()}}static bXj(P){m.ULS.sendTraceTag(573686986,0,50,`GetConditionalFormattingRulesHelper.OnEditConditionalFormattingRuleFailed: status = ${P.data.status}, HTTP status = ${P.data.httpStatus}.`)}static UVg(P,ua){ua&&E.a.hi(ua.Errors,na.conditionalFormattingAddRuleInvalidFormula)&&(ua=E.a.Cd(1,1,2221,2222,0,104275673,
"ConditionalFormattingAddRuleInvalidFormula"),new kc.a(P,ua))}static vUk(P,ua){if(ua){let Xa=null;E.a.hi(ua.Errors,na.conditionalFormattingCantApplyRangeOutsidePivotTable)?Xa=E.a.Cd(1,1,2221,2223,0,666127521,"ConditionalFormattingCantApplyRangeOutsidePivotTable"):E.a.hi(ua.Errors,na.conditionalFormattingCantApplyRangeInsidePivotTable)&&(Xa=E.a.Cd(1,1,2221,2224,0,1259721746,"ConditionalFormattingCantApplyRangeInsidePivotTable"));Xa&&new kc.a(P,Xa)}}static Tyg(P){if(P.startsWith("="))return P;var ua=
I.a.Cb(w.CalcManagerService);return ua&&(ua=ua.toXLNumber(P),null!=ua)?ua.toString():`="${P}"`}static brj(P,ua,Xa){let Pb;var hc;if(hc=P.startsWith("="))P=ta.lb(P.substring(1,P.length),ua,Xa),{I3:Pb}=P,hc=P.returnValue;return hc?0<Pb.length&&!(1===Pb.length&&Pb[0].isSingle):!1}static $qj(P,ua,Xa){for(const Pb of ua.qa.items){const hc=Xa.extractReferences(P,Pb.sheetName,ua.workbookContext.WorkbookFileName,!0);if(hc&&hc.Items.some(Qc=>Qc.IsStructRef))return!0}return!1}static getFormulaErrorType(P,ua,
Xa){return P?na.brj(P,ua.listSeparator,ua.qa)||na.$qj(P,ua,Xa)?3:0:1}static getRangeErrorType(P,ua,Xa){if(!P)return 1;ua=ta.lb(P,ua,Xa);({I3:P}=ua);return ua.returnValue&&ta.db(P)?0:2}static getRangeError(P,ua,Xa,Pb){if(!P)return 1;ua=ta.lb(P,ua,Xa);({I3:P}=ua);return ua.returnValue&&ta.db(P)?this.Pwj(Xa,Pb)?6:0:2}static Pwj(P,ua){P=P.getItemByName(ua);if(!P)return!1;ua=P.ASa&4;return!(!P||!P.Ih||ua)}}na.conditionalFormattingAddRuleInvalidFormula=[104275673];na.conditionalFormattingCantApplyRangeOutsidePivotTable=
[666127521];na.conditionalFormattingCantApplyRangeInsidePivotTable=[1259721746];Object(n.a)(na,"ConditionalFormattingRuleEditorHelper",null,[]);var fc=a(13),Cc=a(29);class tc{constructor(P,ua){this.TXd=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CFPaneRuleEditorV2",!1);this.peb=null;this.sz=P;this.$=ua}HO(P,ua,Xa,Pb){Pb=void 0===Pb?null:Pb;Cc.a.Fj()?void I.a.resolve(w.ReactTaskPaneManagerService,{xa:0}).then(hc=>{hc.PC("ConditionalFormattingTaskPane",this.yl(P,ua,Xa,void 0,Pb));this.sz.rog()}):
$a.a.li().then(hc=>{hc.showTaskPane("ConditionalFormattingTaskPane",this.yl(P,ua,Xa,void 0,Pb));this.sz.rog();return null})}QE(P,ua,Xa,Pb,hc,Qc,vd){Pb=void 0===Pb?null:Pb;hc=void 0===hc?null:hc;Qc=void 0===Qc?0:Qc;vd=void 0===vd?null:vd;Cc.a.Fj()?void I.a.resolve(w.ReactTaskPaneManagerService,{xa:0}).then(Nd=>{const ke=this.$.Vb.Uc("UserAction","ConditionalFormattingTPRenderStopwatch");Nd.updateTaskPane("ConditionalFormattingTaskPane",this.yl(P,ua,Xa,Pb,hc,Qc,vd));ke.stop();this.sz.ztg()}):$a.a.li().then(Nd=>
{const ke=this.$.Vb.Uc("UserAction","ConditionalFormattingTPRenderStopwatch");Nd.updateTaskPane("ConditionalFormattingTaskPane",this.yl(P,ua,Xa,Pb,hc,Qc,vd));ke.stop();this.sz.ztg();return null})}AQ(){Cc.a.Fj()?void I.a.resolve(w.ReactTaskPaneManagerService,{xa:0}).then(P=>P.hideTaskPane("ConditionalFormattingTaskPane")):$a.a.li().then(P=>{P.hideTaskPane("ConditionalFormattingTaskPane",2);return null})}mT(){this.peb()}YLa(){Cc.a.Fj()?void I.a.resolve(w.ReactTaskPaneManagerService,{xa:0}).then(P=>
P.setSelectedTaskPane("ConditionalFormattingTaskPane")):$a.a.li().then(P=>{P.setSelectedTaskPane("ConditionalFormattingTaskPane");return null})}showBackButton(){Cc.a.Fj()?void I.a.resolve(w.ReactTaskPaneManagerService,{xa:0}).then(P=>{const ua=Object.assign({},this.Ctd,{actionButtonProps:this.VJd()});P.updateTaskPane("ConditionalFormattingTaskPane",ua)}):void $a.a.li().then(P=>{const ua=Object.assign({},this.Ctd,{actionButtonProps:this.VJd()});P.updateTaskPane("ConditionalFormattingTaskPane",ua)})}yl(P,
ua,Xa,Pb,hc,Qc,vd){Qc=void 0===Qc?0:Qc;vd=void 0===vd?null:vd;P={firstPaneElementId:U.a.Iqc,ruleManagerId:U.a.Ahf,loadingRuleListId:U.a.J1h,ruleListId:U.a.zhf};ua={type:"ConditionalFormattingTaskPaneProps",taskPaneViewType:ua,ruleFilterOption:Xa,rules:void 0===Pb?null:Pb,rule:void 0===hc?null:hc,firstPaneElementId:U.a.Iqc,callbacks:{onRuleFilteringOptionsChange:this.sz.onRuleFilteringOptionsChange,onRuleHoverStateChange:this.sz.onRuleHoverStateChange,setFocusOnToolbarFirstElement:this.sz.setFocusOnToolbarFirstElement,
onRuleDelete:this.sz.onRuleDelete,onRuleDuplicate:this.sz.onRuleDuplicate,changeTaskPaneView:this.sz.g6j,onDeleteRulesByFilter:this.sz.onDeleteRulesByFilter,onRuleAdded:this.sz.onRuleAdded,onRuleEdited:this.sz.onRuleEdited,addNewRuleFromTaskPane:this.sz.addNewRuleFromTaskPane,onEmptyPaneHelpLinkClick:this.sz.onEmptyPaneHelpLinkClick,getFormulaErrorType:Nd=>na.getFormulaErrorType(Nd,this.$,this.Yd),getRangeErrorType:Nd=>na.getRangeErrorType(Nd,this.$.listSeparator,this.$.qa),getRangeError:(Nd,ke)=>
na.getRangeError(Nd,this.$.listSeparator,this.$.qa,ke)},rangePickerController:Mb.f(this.$).$h.QGa(),error:Qc,uiElementsIds:P,notification:vd,colorPickerButtonController:this.sz.colorPickerButtonController,borderMenuController:this.sz.borderMenuController};return this.Ctd=Object(sa.a)(new Sb.a,{contentProps:ua,actionButtonProps:this.VJd(),onOpen:()=>{this.sz.l3()},onClose:()=>{this.sz.zt()},onShow:()=>{this.sz.J2j()},onHide:()=>{this.sz.jL()},width:320,title:fc.a.instance.ia(1299),preventCloseCallback:Nd=>
{this.sz.H2j();this.peb=Nd}})}VJd(){if(this.TXd&&1!==this.sz.aJ)return{label:fc.a.instance.ia(2567),icon:"CommonControlArrowLeftUseWithBorder_24",onExecute:()=>{this.sz.L1j()},onTabKeyDown:()=>{}}}}Object(n.a)(tc,"ConditionalFormattingReactTaskPane",null,[526]);class nb{constructor(P,ua,Xa,Pb,hc){this.iconSetFormat=this.colorScaleFormat=this.dataBarFormat=this.conditionalFormatting=this.range=null;this.range=ua;this.conditionalFormatting=P;this.dataBarFormat=Xa;this.colorScaleFormat=Pb;this.iconSetFormat=
hc}getRange(){return this.range}}Object(n.a)(nb,"MacroRecorderRangeConditionalFormattingCreatedPayload",null,[67]);class tb{constructor(P,ua){this.range=null;this.priority=0;this.range=P;this.priority=ua}getRange(){return this.range}rMf(){return this.priority}}Object(n.a)(tb,"MacroRecorderRangeConditionalFormattingRuleDeletedPayload",null,[67]);var La=a(74),wb=a(429),Wa=a(81),Fa=a(43),Da=a(28),ja=a(397),Qa=a(210),Ob=a(88);const Ub=()=>P=>P;class Zb{constructor(P,ua){this.TXd=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CFPaneRuleEditorV2",
!1);this.KTa=this.P7c=this.lJe=null;this.rZa=this.VEc=!1;this.Iud=[28];this.Ffb=this.Vsb=null;this.B8f=this.z$b=this.aJ=0;this.Jfe=this.pMg=null;this.H2j=()=>{this.F0.QE(this.KTa,0,this.xX)};this.L1j=()=>{m.ULS.sendTraceTag(507314587,0,50,"ConditionalFormattingPaneManager.onMoveToRuleManagerRequestReceived: back button used");this.F0.QE(this.KTa,1,this.xX)};this.Vrg=()=>{this.d$b(!1)};this.mae=Xa=>{2===this.aJ?this.cya({sheetProtectionOptionsChangedEvent:{}}):1===this.aJ&&Xa&&(++this.z$b,this.Jze(this.z$b,
[],3))};this.g6j=Xa=>{1===Xa&&1!==this.aJ&&(this.aJ=1,this.d$b());1!==Xa&&1===this.aJ&&this.c3b();this.TXd&&2===Xa&&2!==this.aJ&&(this.aJ=Xa,this.F0.showBackButton());0===Xa&&this.F0.mT();this.aJ=Xa};this.$_b=(Xa,Pb)=>{this.cya({sheetRenameEvent:{oldSheetName:Pb.oldName,newSheetName:Pb.newName}})};this.MC=(Xa,Pb)=>{this.cya({sheetDeletedEvent:{sheetName:Pb.item.name}})};this.ph=()=>{1!==this.aJ||this.jWd||Mb.f(this.$).inRangePicker||Mb.f(this.$).nk||this.d$b()};this.onRuleFilteringOptionsChange=Xa=>
{this.xX!==Xa&&(m.ULS.sendTraceTag(42824727,0,50,`ConditionalFormattingPaneManager.OnRuleFilteringOptionsChange: filtering option has changed to: ${Xa}`),this.xX=Xa,this.d$b())};this.onRuleHoverStateChange=(Xa,Pb,hc)=>{if(Xa){let Qc;(()=>{let vd=ta.lb(hc,this.$.listSeparator,this.$.qa);({I3:Qc}=vd);return vd})().returnValue?Mb.f(this.$).Ub.HL(ja.a.a7a(La.d(this.$.la),Qc),this.Iud,!0):m.ULS.shipAssertTag(537948622,0,!1,"ConditionalFormattingPaneManager.OnRuleHoverStateChange: Failed to parse range when highlighting rule range")}else Mb.f(this.$).Ub.rl(this.Iud)};
this.onRuleDelete=Xa=>{this.deleteConditionalFormattingRules(61,this.selectedRanges,Xa)};this.onRuleDuplicate=Xa=>{this.aki(Xa)};this.onRuleAdded=Xa=>{const {appliedRange:Pb,I3:hc}=this.hNf(Xa.range,Xa.ruleRangeSheetName,"onRuleAdded");if(Pb){var Qc={};Xa.activeCell?(Qc.FirstRow=Xa.activeCell.row,Qc.FirstColumn=Xa.activeCell.column):(Qc.FirstRow=Pb.Ranges[0].FirstRow,Qc.FirstColumn=Pb.Ranges[0].FirstColumn);var vd=this.B1b(Xa,!0),Nd=()=>new nb(vd,Pb,null,null,null),ke=this.$.ma.sa.mc(),Be=this.oMg(Pb,
hc);m.ULS.sendTraceTag(526930257,0,50,`ConditionalFormattingPaneManager.OnRuleAdded: Adding a new rule with: ${Be}`);wb.a(this.$.userOperationManager,(Ze,of,Xf)=>ia(this.$.ma.sa,this.B1b(Xa,!1),Pb,Qc,M.c(Ze,bg=>{na.ejg(this.$,bg)}),M.b(of,na.HSj),Xf,ke),Ze=>new z.a(105,0,Ze,void 0,Nd),null)}};this.onRuleEdited=Xa=>{let Pb,hc=null,Qc;if(Xa.range)if((()=>{let Ze=ta.lb(Xa.range,this.$.listSeparator,this.$.qa);({I3:Qc,sheetName:hc}=Ze);return Ze})().returnValue)if(ta.db(Qc))m.ULS.shipAssertTag(574410754,
0,!hc||Da.a.equals(hc,Xa.ruleRangeSheetName,!1),"ConditionalFormattingPaneManager.OnRuleEdited: Sheet name was modified in rule range, which is not allowed when editing range"),Pb=ta.x(Xa.ruleRangeSheetName,null,Qc);else{m.ULS.shipAssertTag(557601051,0,!1,"ConditionalFormattingPaneManager.OnRuleEdited: Range is invalid.");return}else{m.ULS.shipAssertTag(574410753,0,!1,"ConditionalFormattingPaneManager.OnRuleEdited: Failed to parse range when editing an existing rule");return}else Pb={},Pb.SheetName=
Xa.ruleRangeSheetName;if(this.$.qa.contains(Pb.SheetName)){var vd={FirstRow:0,FirstColumn:0},Nd=this.$.ma.sa.mc(),ke=null;this.$.oda&&(ke=this.B1b(Xa,!0));var Be=()=>new nb(ke,this.Jfe,null,null,null);if(Xa.range){const Ze=this.oMg(Pb,Qc);m.ULS.sendTraceTag(526930256,0,50,`ConditionalFormattingPaneManager.OnRuleEdited: Editing a rule with: ${Ze}`)}wb.a(this.$.userOperationManager,(Ze,of,Xf)=>Z(this.$.ma.sa,Xa.guid,this.B1b(Xa,!1),Pb,vd,M.c(Ze,bg=>{na.cXj(this.$,this,bg)}),M.b(of,na.bXj),Xf,Nd),Ze=>
new z.a(105,0,Ze,64,Be),null)}else m.ULS.shipAssertTag(557682696,1,!1,"ConditionalFormattingPaneManager.OnRuleEdited: sheet wasn't found, might be renamed or deleted.")};this.onDeleteRulesByFilter=()=>{let Xa,Pb;switch(this.xX){case 0:Xa=60;Pb=this.selectedRanges;break;case 1:Xa=59;Pb=ta.s(this.$.qa.la.name,"",0,0,0,0);break;default:m.ULS.sendTraceTag(590448070,0,10,`ConditionalFormattingPaneManager.OnClearRules with an unknown Rule Filtering: ${this.xX}`);return}this.deleteConditionalFormattingRules(Xa,
Pb,null)};this.yWj=Xa=>{Xa&&Ca.a(Xa)&&(Xa=E.a.pc(Xa.Errors),m.ULS.sendTraceTag(595092188,0,15,`ConditionalFormattingPaneManager.OnRuleDelete: request ended with errors: ${Xa}.`),this.DAe())};this.ZWj=Xa=>{Xa&&Ca.a(Xa)&&(Xa=E.a.pc(Xa.Errors),m.ULS.sendTraceTag(536966945,0,15,`ConditionalFormattingPaneManager.onDuplicateRuleSuccess: request ended with errors: ${Xa}.`),this.DAe())};this.xWj=Xa=>{m.ULS.sendTraceTag(595116629,0,50,`ConditionalFormattingPaneManager.OnDeleteRuleFailure: status = ${Xa.data.status}, HTTP status = ${Xa.data.httpStatus}.`)};
this.YWj=Xa=>{m.ULS.sendTraceTag(536966944,0,50,`ConditionalFormattingPaneManager.onDuplicateRuleFailure: status = ${Xa.data.status}, HTTP status = ${Xa.data.httpStatus}.`)};this.setFocusOnToolbarFirstElement=()=>{$a.a.li().then(Xa=>{Xa.focusTabbedTaskPaneArea();return null})};this.addNewRuleFromTaskPane=()=>{m.ULS.sendTraceTag(573686988,0,50,"ConditionalFormattingPaneManager.AddNewRuleFromTaskPane");this.wWf(this.Ffb)};this.onEmptyPaneHelpLinkClick=()=>{const Xa=new O.a(-859308420,l.a.Hb,this.$.xc,
12,null);this.$.Ia.Gb(Xa,{[l.a.Bf]:"AssetID="+Zb.fdh,["InputMethod"]:l.a.Hb,[l.a.Wc]:U.a.VF,["ShouldCanvasTakeFocus"]:!0})};this.jd=(Xa,Pb)=>{!Pb.Hg&&this.VEc&&this.zt()};this.$=P;this.Ffb=ua;this.F0=new tc(this,this.$);this.rTd=this.$.Vb.Uc("UserAction","ConditionalFormattingTPInitialLoadStopwatch");this.c6=new fb(P);this.xX=this.Lnf=0;this.$.Sj(this.jd)}get colorPickerButtonController(){return this.lJe}get borderMenuController(){return this.P7c}get selectedRanges(){return ta.u(Mb.f(this.$).ha.oa.selectedRanges,
this.$)}get jWd(){return 1===this.xX}clf(P){P=void 0===P?null:P;const ua=Ob.d(I.a.resolve(w.PopulateDynamicHelperService,{xa:0})),Xa=Wa.GetServiceTaskFactory.Ne(this.$.ra,296,468,0),Pb=Ob.d(I.a.resolve(w.CalcManagerService,{xa:0}));Fa.TaskExtensions.tb(Fa.TaskExtensions.jl([ua,Xa,Pb],this.$.Aa),()=>{this.F0.Yd=Pb.result;this.tfj(ua.result,Xa.result);this.wWf(P)},this.$.Aa,3)}l3(){m.ULS.sendTraceTag(42824723,0,50,"ConditionalFormattingPaneManager.OnPaneOpen Begin of OnPaneOpen");this.rZa||(this.Uy(),
this.rZa=!0)}zt(){C.EwaSettings.isChangeGateEnabled("OfficeVSO:8561735_CFTaskpaneUnregisterEventsOnPaneClose")&&this.jL();this.hideTaskPane();this.aJ=0;this.xX=this.Lnf}c3b(){Mb.f(this.$).Ub.pn(null,this.Iud)}Uy(){this.c6.jGh(this.mae);this.c6.mDh(this.Vrg);Mb.f(this.$).ha.ZS(this.ph);this.$.qa.tqa(this.$_b);this.$.qa.i0(this.MC)}d$b(P){if(1===this.aJ)if(void 0!==P&&!P||this.c6.UUd()){++this.z$b;var ua=null;this.jWd||1!==this.c6.kGf?(()=>{let Xa=this.c6.getConditionalFormattingRules(this.jWd?null:
this.selectedRanges.Ranges);({Hqc:ua}=Xa);return Xa})().returnValue&&(this.F8g(),this.Jze(this.z$b,ua,this.c6.kGf)):(this.F8g(),this.hcl())}else this.mae(!0)}F8g(){const P={};P.SheetName=this.selectedRanges.SheetName;P.NamedObjectName=this.selectedRanges.NamedObjectName;P.Ranges=Array(this.selectedRanges.Ranges.length);for(let ua=0;ua<this.selectedRanges.Ranges.length;ua++)P.Ranges[ua]=this.selectedRanges.Ranges[ua];this.Jfe=P}hcl(){if(this.$.fa.yc){var P=this.selectedRanges;Va(this.$.ma.sa,!1,P,
ua=>{eb(ua,this.$,P.SheetName,this.z$b,(Xa,Pb,hc)=>{this.Jze(Xa,Pb,hc)})},Yb,null,this.$.ma.sa.mc())}else m.ULS.sendTraceTag(592843217,0,10,"ConditionalFormattingPaneManager.UpdateConditionalFormattingRulesFromSelection: Session is not active.")}Jze(P,ua,Xa){1===this.aJ&&P>=this.B8f&&(this.F0.QE(this.KTa,this.aJ,this.xX,ua,void 0,Xa),this.pMg=ua,this.B8f=P)}J2j(){m.ULS.sendTraceTag(507618453,0,50,"ConditionalFormattingPaneManager.onPaneExpand Begin of onPaneExpand");this.rZa||(this.Uy(),this.rZa=
!0);this.cya({taskPaneExpandEvent:{}})}jL(){this.rZa&&(this.v7a(),this.c3b(),this.rZa=!1,this.Vsb=null)}g4j(){this.rZa&&(this.Vsb=this.$.Vb.Uc("UserAction","ConditionalFormattingRibbonCommandRenderStopwatch"))}h4j(){this.Vsb=null}v7a(){this.c6.Vuk(this.mae);this.c6.msk(this.Vrg);Mb.f(this.$)&&Mb.f(this.$).ha&&Mb.f(this.$).ha.rV(this.ph);this.$.qa.Axa(this.$_b);this.$.qa.y9(this.MC)}cya(P){2===this.aJ&&this.F0.QE(this.KTa,2,this.xX,void 0,void 0,void 0,P)}deleteConditionalFormattingRules(P,ua,Xa){m.ULS.sendTraceTag(591925914,
0,50,`ConditionalFormattingPaneManager.OnRuleDelete with type: ${P}, id: ${Xa||"empty"}`);const Pb=this.$.ma.sa.mc(),hc=this.ZKi(P,Xa);wb.a(this.$.userOperationManager,(Qc,vd,Nd)=>xa(this.$.ma.sa,P,ua,Xa,M.c(Qc,this.yWj),M.b(vd,this.xWj),Nd,Pb),Qc=>new z.a(221,0,Qc,64,hc),null)}aki(P){const ua=P.guid;ua||m.ULS.sendTraceTag(536966946,0,10,"ConditionalFormattingPaneManager.duplicateConditionalFormattingRule with missing id!");const {appliedRange:Xa}=this.hNf(P.range,P.ruleRangeSheetName,"duplicateConditionalFormattingRule");
if(Xa){var Pb=this.$.ma.sa.mc(),hc=this.B1b(P,!0),Qc=()=>new nb(hc,Xa,P.dataBarFormat,P.colorScaleFormat,P.iconSetFormat);wb.a(this.$.userOperationManager,(vd,Nd,ke)=>{var Be=this.$.ma.sa,Ze=P.ruleRangeSheetName;vd=M.c(vd,this.ZWj);Nd=M.b(Nd,this.YWj);const of=Be.$a(9,null);of.sheetName=Ze;of.id=ua;return A.h(Be,"DuplicateConditionalFormattingRule",of,vd,Nd,ke,Pb,0)},vd=>new z.a(105,0,vd,64,Qc),null)}}ZKi(P,ua){let Xa=-1,Pb=null;this.$.oda&&(ua?1===this.xX?{priority:Xa,range:Pb}=this.WMi(ua):(Xa=
this.lHf(this.pMg,ua),Pb=this.Jfe):Pb=59===P?ta.u([],this.$):this.selectedRanges);return()=>new tb(Pb,Xa)}hNf(P,ua,Xa){let Pb=null,hc;if((()=>{let Qc=ta.lb(P,this.$.listSeparator,this.$.qa);({I3:hc,sheetName:Pb}=Qc);return Qc})().returnValue)if(ta.db(hc)){ua=ta.x(Pb||ua,null,hc);if(this.$.qa.contains(ua.SheetName))return{appliedRange:ua,I3:hc};m.ULS.shipAssertTag(557682697,1,!1,`ConditionalFormattingPaneManager.${Xa}: sheet wasn't found, might be renamed or deleted.`)}else m.ULS.shipAssertTag(557601052,
0,!1,`ConditionalFormattingPaneManager.${Xa}: Range is invalid.`);else m.ULS.shipAssertTag(574410755,0,!1,`ConditionalFormattingPaneManager.${Xa}: Failed to parse range when adding a new rule`)}lHf(P,ua){for(let Xa=0;Xa<P.length;++Xa)if(P[Xa].ruleId===ua)return P=Xa;return 0}WMi(P){({Hqc:Pb}=this.c6.getConditionalFormattingRules());var ua=null;for(var Xa of Pb)Xa.ruleId===P&&(ua=Xa);ua=ta.eb(ua.ruleRange,this.$.listSeparator);var Pb=Array(ua.length);for(Xa=0;Xa<ua.length;++Xa)Pb[Xa]=ta.l(ua[Xa]);
({Hqc:Pb}=this.c6.getConditionalFormattingRules(Pb));Pb.sort(Gb);P=this.lHf(Pb,P);ua=ta.u(ua,this.$);return{priority:P,range:ua}}dispose(){this.$.ro(this.jd);this.$=null;this.hideTaskPane();this.F0=null;this.c6.dispose();this.c6=null}DAe(){1===this.aJ&&this.d$b()}W0i(P){return 1==P.Ranges.length?(P=P.Ranges[0],P.FirstRow===P.LastRow?P.FirstColumn===P.LastColumn?"Single Cell":"Row":P.FirstColumn===P.LastColumn?"Column":"Rectangle"):"Multi"}V0i(P){let ua=null;for(const Xa of P.Ranges){P=ta.G(Xa);const Pb=
Object(Qa.a)(this.$,P);P=null===Pb?"None":Pb.usedRange.contains(P)?"Containing":"Intersecting";ua=null===ua||ua===P?P:"Intersecting"}return null===ua?"None":ua}UNf(P){return 100*Math.ceil(P/100)}oMg(P,ua){const Xa=this.W0i(P);P=this.V0i(P);ua=this.UNf(ta.c(ua));const Pb=this.UNf(Mb.f(this.$).usedRange.bottom);return`rangeType ${Xa} ; tableRelation: ${P} ; numOfCellsInRangeBucket: ${ua} ; usedRangeRowsBucket: ${Pb}`}B1b(P,ua){const Xa=P.options;let Pb=null,hc=Xa.quickFormat?Ub()(Xa.quickFormat):0;
6===hc&&(P.customFormat?(Pb=this.uAi(P),hc=6):(m.ULS.sendTraceTag(540615491,0,15,"ConditionalFormattingPaneManager.PrepareConditionalFormattingOptions: invalid custom format."),hc=0));return Object(sa.a)(new mb,{Command:Ub()(Xa.command),QuickFormatType:hc,CustomFormat:Pb,Formula1:Xa.formula1&&ua?na.Tyg(Xa.formula1):Xa.formula1,Formula2:Xa.formula2&&ua?na.Tyg(Xa.formula2):Xa.formula2,Value:Xa.value||0,Unique:Xa.unique||!1,TimePeriodType:Xa.timePeriod?Ub()(Xa.timePeriod):0,StopIfTrue:P.stopIfTrue||
!1,Priority:P.priority||-1})}uAi(P){const ua={};ua.BackgroundColor=P.customFormat.backgroundColor;ua.PreserveBackgroundColor=P.customFormat.preserveBackgroundColor||!1;P.customFormat.backgroundColorThemeInfo&&(ua.BackgroundColorTheme={},ua.BackgroundColorTheme.ThemeColorIndex=P.customFormat.backgroundColorThemeInfo.index,ua.BackgroundColorTheme.ThemeColorRow=P.customFormat.backgroundColorThemeInfo.row);ua.TextColor=P.customFormat.textColor;ua.PreserveTextColor=P.customFormat.preserveTextColor||!1;
P.customFormat.textColorThemeInfo&&(ua.TextColorTheme={},ua.TextColorTheme.ThemeColorIndex=P.customFormat.textColorThemeInfo.index,ua.TextColorTheme.ThemeColorRow=P.customFormat.textColorThemeInfo.row);ua.IsTextBold=P.customFormat.isTextBold;ua.IsTextItalic=P.customFormat.isTextItalic;ua.IsTextStrikethrough=P.customFormat.isTextStrikethrough;ua.IsTextUnderlined=P.customFormat.isTextUnderlined;ua.IsTextDoubleUnderlined=P.customFormat.isTextDoubleUnderlined;this.tAi(P,ua);return ua}tAi(P,ua){ua.BorderFormat=
{};if(P.customFormat.borderFormat){if(ua.BorderFormat.Position=P.customFormat.borderFormat.position||15,ua.BorderFormat.LineStyle=Ub()(P.customFormat.borderFormat.lineStyle.slice(0,4)),ua.BorderFormat.Color=[Ga.a.np(P.customFormat.borderFormat.color[0]).fS(),Ga.a.np(P.customFormat.borderFormat.color[1]).fS(),Ga.a.np(P.customFormat.borderFormat.color[2]).fS(),Ga.a.np(P.customFormat.borderFormat.color[3]).fS()],ua.BorderFormat.Thickness=[0,0,0,0],ua.BorderFormat.ThemeBorderColor=[null,null,null,null],
P.customFormat.borderFormat.themeColor)for(let Xa=0;Xa<P.customFormat.borderFormat.themeColor.length;Xa++)P.customFormat.borderFormat.themeColor[Xa]&&(ua.BorderFormat.ThemeBorderColor[Xa]={},ua.BorderFormat.ThemeBorderColor[Xa].ThemeColorIndex=P.customFormat.borderFormat.themeColor[Xa].index,ua.BorderFormat.ThemeBorderColor[Xa].ThemeColorRow=P.customFormat.borderFormat.themeColor[Xa].row)}else ua.BorderFormat.Position=15,ua.BorderFormat.LineStyle=[0,0,0,0],ua.BorderFormat.Color=[0,0,0,0],ua.BorderFormat.ThemeBorderColor=
[null,null,null,null],ua.BorderFormat.Thickness=[0,0,0,0]}rog(){this.rTd&&(this.rTd.stop(),this.rTd=null)}ztg(){this.Vsb&&(this.Vsb.stop(),this.Vsb=null)}wWf(P){const ua=P?2:1;P=this.hTi(P);this.VEc?(this.F0.YLa(),2===ua?this.F0.QE(this.KTa,2,this.xX,void 0,P):1!==this.aJ&&this.F0.QE(this.KTa,1,this.xX)):(this.VEc=!0,this.aJ=ua,this.F0.HO(this.KTa,this.aJ,this.xX,P))}hideTaskPane(){this.VEc=!1;this.F0.AQ()}hTi(P){if(!P)return null;const ua=ta.r(Mb.f(this.$).ha.oa.activeCell,this.$);return{guid:null,
addRuleType:P,activeCell:{row:ua.FirstRow,column:ua.FirstColumn},range:ta.k(Mb.f(this.$).ha.oa.selectedRanges,this.$.listSeparator,this.$,!1,!1,!1),ruleRangeSheetName:ua.SheetName}}tfj(P,ua){this.lJe=P.w6h();P.ZNf(!1,!1,!1,!1,!1);this.P7c=ua.LKi();this.cjl(this.P7c.getBorderLineStyleProps())}cjl(P){P.some(ua=>"BorderStyleSolidLine"===ua.key)&&P.some(ua=>"BorderStyleDashedLine"===ua.key)&&P.some(ua=>"BorderStyleDottedLine"===ua.key)||m.ULS.sendTraceTag(540038171,0,10,"ConditionalFormattingPaneManager.VerifyCFBorderLineStyles: CF line styles are missing.")}}
Zb.fdh="fed60dfa-1d3f-4e13-9ecb-f1951ff89d7f";Object(n.a)(Zb,"ConditionalFormattingPaneManager",null,[]);var uc=a(27),Hc=a(536),Dd=a(100),jc;let $c=jc=class{constructor(P,ua){this.oaa=null;this.ub=new u.a;this.Ffb=null;this.uWj=Xa=>{m.ULS.sendTraceTag(537167193,0,50,"ConditionalFormattingCommandHandler.OnDeleteConditionalFormattingSuccessCallback Clear CF rules from ribbon command");Xa&&Ca.a(Xa)&&(Xa=E.a.pc(Xa.Errors),m.ULS.sendTraceTag(589947023,0,15,`ConditionalFormattingCommandHandler.OnDeleteConditionalFormattingSuccessCallback: Clear CF rules request ended with errors: ${Xa}.`))};
this.Okg=()=>{this.oaa&&this.oaa.g4j()};this.Pkg=()=>{this.oaa&&this.oaa.h4j()};this.$=P;this.LHa=ua;jc.Eic=!0;this.pt=Cc.a.pt();this.C3g=C.EwaSettings.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_8836792_AsyncTaskPaneUITiming");this.Ffb=this.GOi()}GOi(){if(J.AFrameworkApplication.ea.ka("IsO365ConsumerHost"))return"HighlightCellsNoBlanks";let P=C.EwaSettings.getStringFeatureGate("Microsoft.Office.Excel.DefaultNewRuleTypeConditionalFormatting","HighlightCellsGT");P in this.Bgf||
(m.ULS.sendTraceTag(507605590,0,15,"ConditionalFormattingCommandHandler.GetDefaultNewRuleType: Invalid rule type"),P="HighlightCellsGT");return P}get Bgf(){jc.$8c||this.hQh();return jc.$8c}get rQc(){this.oaa||(this.oaa=new Zb(this.$,this.Ffb));return this.oaa}gd(){return!1}executeCommand(P,ua,Xa){P=Fa.TaskExtensions.kl();if(this.pt){var Pb=this.$.qa.la;if(Pb&&Pb.name===Hc.a.current.jQ&&Dd.c(this.$.Pf)){Pb=this.$.ra.Tb(237);var hc=Mb.f(this.$);Pb.K8(ua.command,hc.ha.oa.activeCell)}}-300973317===ua.command&&
C.EwaSettings.isChangeGateEnabled("OfficeVSO:8202953_HomeTabCleanUpTelemetry")&&"Home"===ua.tabName&&Ka.b("HomeTabConditionalFormatting");if(-20558303===ua.command)return jc.Eic=!1,this.C3g&&Xa.event&&this.LHa.kq(Xa.event,"test_pane_open_conditional_formatting",[{["itemKey"]:"command",["value"]:hb.a[ua.command]}],["task-pane"]),this.rQc.clf(),P;Pb=Xa[l.a.Wc];if(2063445891===ua.command||454361567===ua.command)Pb=this.Ffb,454361567===ua.command&&C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ColorPickerHighlightWhenEnabled",
!1)&&m.ULS.sendTraceTag(507609410,0,50,"ConditionalFormattingCommandHandler.executeCommand: HighlightWhen clicked"),m.ULS.sendTraceTag(542782275,0,50,"ConditionalFormattingPaneManager.QuickAccessNewRuleFromRibbon");hc=this.VMi(Pb);switch(hc){case 12:case 13:case 8:case 9:case 10:case 11:case 1:case 2:case 4:case 5:case 3:case 7:case 6:case 65:jc.Eic=!1;2063445891!==ua.command&&454361567!==ua.command&&m.ULS.sendTraceTag(573686991,0,50,"ConditionalFormattingPaneManager.QuickAccessNewRuleFromTaskPane");
this.C3g&&Xa.event&&this.LHa.kq(Xa.event,"test_pane_open_conditional_formatting",[{["itemKey"]:"command",["value"]:hb.a[ua.command]}],["task-pane"]);this.rQc.clf(Pb);break;case 59:case 62:this.Lei(hc);break;case 60:case 61:return m.ULS.shipAssertTag(589947025,0,!1,"ConditionalFormattingCommandHandler.ExecuteCommand: Not expecting to execute command of type ConditionalFormattingCommand.DeleteCells or ConditionalFormattingCommand.DeleteRule from the Ribbon"),P;default:this.E6h(hc)}C.EwaSettings.EN()&&
this.$.lza();return P}dispose(){this.ub.dispose()}Rc(P,ua){P=!1;switch(ua.command){case -20558303:case 2063445891:case 454361567:case -300973317:case 97385776:P=this.$.isEditMode}return P}td(){return!1}zHf(){return ta.u(Mb.f(this.$).ha.oa.selectedRanges,this.$)}BXg(){if(jc.YVk){const P=new O.a(-847286761,l.a.Hb,this.$.xc,0,U.a.s9);this.$.Ia.Gb(P,{["InputMethod"]:l.a.Hb,CalloutName:1})}}E6h(P){m.ULS.sendTraceTag(573686989,0,50,"ConditionalFormattingPaneManager.QuickAccessNewRuleNonCustom");this.Okg();
const ua=this.$.ma.sa.mc(),Xa=ta.r(Mb.f(this.$).ha.oa.activeCell,this.$),Pb=this.zHf(),hc=Object(sa.a)(new mb,{Command:P,StopIfTrue:!1}),Qc=()=>new nb(hc,Pb,null,null,null);wb.a(this.$.userOperationManager,(vd,Nd,ke)=>ia(this.$.ma.sa,hc,Pb,Xa,M.c(vd,Be=>{na.ejg(this.$,Be)}),M.b(Nd,()=>{this.Pkg()}),ke,ua),vd=>new z.a(105,0,vd,void 0,Qc),null);this.BXg()}Lei(P){this.Okg();const ua=this.$.ma.sa.mc();let Xa,Pb;59===P?(Pb=ta.u([],this.$),Xa=ta.t(new uc.Range(1,1,Ma.a.sf,Ma.a.rf,!1,!0),this.$)):Pb=Xa=
this.zHf();const hc=()=>new tb(Pb,-1);wb.a(this.$.userOperationManager,(Qc,vd,Nd)=>xa(this.$.ma.sa,P,Xa,null,M.c(Qc,this.uWj),M.b(vd,()=>{this.Pkg()}),Nd,ua),Qc=>new z.a(221,0,Qc,void 0,hc),null);this.BXg()}VMi(P){return this.Bgf[P]}hQh(){jc.$8c={["HighlightCellsGT"]:1,["HighlightCellsLT"]:2,["HighlightCellsBetween"]:3,["HighlightCellsEQ"]:4,["HighlightCellsContains"]:5,["HighlightCellsDate"]:6,["HighlightCellsDupe"]:7,["HighlightCellsNoBlanks"]:65,["TopBottomTop10"]:8,["TopBottomTop10P"]:9,["TopBottomBot10"]:10,
["TopBottomBot10P"]:11,["TopBottomAA"]:12,["TopBottomBA"]:13,["DataBarsGradientFillBlue"]:15,["DataBarsGradientFillGreen"]:16,["DataBarsGradientFillRed"]:17,["DataBarsGradientFillOrange"]:18,["DataBarsGradientFillLightBlue"]:19,["DataBarsGradientFillPurple"]:20,["DataBarsSolidFillBlue"]:21,["DataBarsSolidFillGreen"]:22,["DataBarsSolidFillRed"]:23,["DataBarsSolidFillOrange"]:24,["DataBarsSolidFillLightBlue"]:25,["DataBarsSolidFillPurple"]:26,["ColorScalesGYR"]:28,["ColorScalesRYG"]:27,["ColorScalesGWR"]:29,
["ColorScalesRWG"]:30,["ColorScalesBWR"]:31,["ColorScalesRWB"]:32,["ColorScalesWR"]:35,["ColorScalesRW"]:36,["ColorScalesGW"]:38,["ColorScalesWG"]:37,["ColorScalesGY"]:33,["ColorScalesYG"]:34,["IconSetDirectional3Arrows"]:39,["IconSetDirectional3ArrowsGray"]:40,["IconSetDirectional3Triangles"]:57,["IconSetDirectional4ArrowsGray"]:48,["IconSetDirectional4Arrows"]:47,["IconSetDirectional5ArrowsGray"]:53,["IconSetDirectional5Arrows"]:52,["IconSetShapes3TrafficLights1"]:42,["IconSetShapes3TrafficLights2"]:43,
["IconSetShapes3Signs"]:44,["IconSetShapes4TrafficLights"]:51,["IconSetShapes4RedToBlack"]:49,["IconSetIndicators3Symbols"]:45,["IconSetIndicators3Symbols2"]:46,["IconSetIndicators3Flags"]:41,["IconSetRatings3Stars"]:56,["IconSetRatings4Rating"]:50,["IconSetRatings5Quarters"]:55,["IconSetRatings5Rating"]:54,["IconSetRatings5Boxes"]:58,["ClearRulesClearCells"]:62,["ClearRulesClearSheet"]:59}}static get YVk(){return jc.Eic}};$c.$8c=null;$c.Eic=!1;$c=jc=Object(h.__decorate)([Object(I.d)(w.ConditionalFormattingCommandHandlerService),
Object(h.__param)(0,Object(w.EwaControlService)()),Object(h.__param)(1,Object(w.InteractivityTrackerServiceIdentifier)()),Object(h.__param)(2,Object(w.ReactEnvironmentManagerService)())],$c);Object(n.a)($c,"ConditionalFormattingCommandHandler",null,[29,4]);var ud=a(238),Ud=a(987),ec=a(432);class Db{constructor(P,ua,Xa){this.d_h=(Pb,hc)=>{1===Pb?(Pb=hc.resultLanguageIndex,m.ULS.sendTraceTag(537155167,0,50,`ChangeLocaleDialog.CloseReactChangeLocaleDialog pressing on OK. selected index:${Pb}`),this.numberFormatViewModel.SXc(Pb,
"ChangeLocaleDialog")):m.ULS.sendTraceTag(537155166,0,50,"ChangeLocaleDialog.CloseReactChangeLocaleDialog pressing on Cancel");this.dispose()};this.k3=()=>{this.numberFormatViewModel.Ilb(2,"ChangeLocaleDialog.OnNumberFormatViewModelLoaded")&&(m.ULS.sendTraceTag(537155165,0,50,"ChangeLocaleDialog.OnNumberFormatViewModelLoaded success"),this.y8j())};this.j3=()=>{m.ULS.sendTraceTag(537155164,0,15,"ChangeLocaleDialog.OnNumberFormatViewModelLoaded failure")};this.numberFormatViewModel=ua;this.activeCell=
P;this.numberFormatViewModel.NCa(this.k3);this.numberFormatViewModel.IFb(this.j3);this.selectedIndex=Xa}initialize(){const P=Object(sa.a)(new Ud.a,{Caller:2,NumberFormatCategory:-1});this.numberFormatViewModel.KVa(this.activeCell,P)}dispose(){this.numberFormatViewModel&&(this.numberFormatViewModel.xLa(this.k3),this.numberFormatViewModel.A3b(this.j3))}y8j(){const P={[ec.a.Xs]:"ChangeLocaleDialog",["languageList"]:this.numberFormatViewModel.$g.Locales,["selectedIndex"]:this.selectedIndex,["helpLink"]:this.numberFormatViewModel.Hvg},
ua=new ud.a(!1,!1,!0);ua.hc=1;ua.uf="ChangeLocaleDialog";ua.initializeAndShow(fc.a.instance.ia(2218),this.d_h,P)}}Object(n.a)(Db,"ChangeLocaleDialog",null,[4]);var ic=a(1428);let Pc=class{constructor(P,ua){this.$=P;this.numberFormatViewModel=ua}gd(){return!1}Rc(P,ua){P=!1;switch(ua.command){case 2105621672:case -168056295:case 151715844:P=!0}return P}executeCommand(P,ua,Xa){P=!1;switch(ua.command){case 151715844:P=this.$7j(Xa);break;case 2105621672:case -168056295:if(Cc.a.olb()&&2105621672!==Xa.CommandValueId)return m.ULS.sendTraceTag(508385092,
0,50,"NumberFormatTaskPane opened using Pivot table entry point"),this.$.Dc(-395879625,l.a.Hb,0,Xa);P=this.openNumberFormatDialog(ua,Xa)}return e.Task.Va(P)}td(){return!1}yyc(){let P=null;const ua=Mb.f(this.$).ha.oa.activeCell;ua&&(P=ta.r(ua,this.$));return P}openNumberFormatDialog(P,ua){var Xa;let Pb=null;l.a.Wc in ua&&ua[l.a.Wc]&&(Pb=parseInt(ua[l.a.Wc].toString(),10));const hc=this.yyc();if(!hc)return!1;this.numberFormatViewModel.gVc();ua=null!==(Xa=null===ua||void 0===ua?void 0:ua.onClose)&&void 0!==
Xa?Xa:Qc=>{Qc&&this.numberFormatViewModel.formatCells(this.numberFormatViewModel.Cja(),P)};(new ic.a(this.$,hc,this.numberFormatViewModel,P,Pb,ua)).initialize();return!0}$7j(P){const ua=this.yyc();if(!ua)return!1;this.numberFormatViewModel.gVc();(new Db(ua,this.numberFormatViewModel,P.selectedIndex||0)).initialize();return!0}};Pc=Object(h.__decorate)([Object(I.d)(w.NumberFormatCommandHandlerService),Object(h.__param)(0,Object(w.EwaControlService)()),Object(h.__param)(1,Object(w.NumberFormatViewModelService)())],
Pc);Object(n.a)(Pc,"NumberFormatCommandHandler",null,[29]);class Ed extends Sys.EventArgs{constructor(P,ua){super();this.viewModelData=P;this.activeCell=ua}}Object(n.a)(Ed,"NumberFormatViewModelLoadedEventArgs",Sys.EventArgs,[]);var de=a(327),se=a(12),Fe=a(1345),fe=a(45),Tc=a(283),ed=a(8),pd=a(168),Kb=a(287),rb=a(76),rc=a(58),ld=a(59);class Tb extends u.a{constructor(P){super();this.TYf=C.EwaSettings.isChangeGateEnabled("OfficeVSO:8816021_NewNumberFormatPaneManager");this.k7j=(ua,Xa)=>{E.a.Ls(ua.Errors)?
this.raiseEvent("NumberFormatViewModelFailed"):this.raiseEvent("NumberFormatViewModelLoaded",new Ed(ua.Result,Xa))};this.j7j=()=>{this.raiseEvent("NumberFormatViewModelFailed")};this.$=P}NCa(P){this.addHandler("NumberFormatViewModelLoaded",P)}xLa(P){this.removeHandler("NumberFormatViewModelLoaded",P)}ZEh(P){this.addHandler("NumberFormatViewModelFailed",P)}Qtk(P){this.removeHandler("NumberFormatViewModelFailed",P)}NDj(P,ua,Xa,Pb){Pb=void 0===Pb?!1:Pb;var hc={};hc.a=this.$.ta.UserSessionId;Xa&&(hc.b=
rc.a.Nc(Xa));ua&&(hc.c=rc.a.Nc(ua));ld.logData(6,hc);hc=0;this.TYf&&Pb&&(hc|=64);this.$.userOperationManager.enqueueOperation(new z.a(160,0,(Qc,vd,Nd)=>{var ke=this.$.ma.sa;Qc=M.c(Qc,this.k7j);vd=M.b(vd,this.j7j);var Be=this.TYf?P:null;const Ze=ke.$a(1);Ze.activeCell=P;Ze.numberFormatOptions=ua;Ze.prevNumberFormatOptions=Xa;return A.h(ke,"GetNumberFormatViewModelData",Ze,Qc,vd,Nd,Be,0)},16|hc),null)}}Object(n.a)(Tb,"NumberFormatClientViewModelDataLoader",u.a,[510]);Object(I.b)(w.NumberFormatViewModelService,
{we:"singleton"})(async P=>{const ua=await I.a.resolve(w.EwaControlService,P);P=await I.a.resolve(w.FormatCellsActionService,P);return new Wc(ua,P,new Tb(ua))});class Wc extends u.a{constructor(P,ua,Xa){super();this.xgi=[fc.a.instance.ia(485),fc.a.instance.ia(486),fc.a.instance.ia(487),fc.a.instance.ia(488),fc.a.instance.ia(489),fc.a.instance.ia(490),fc.a.instance.ia(491),fc.a.instance.ia(492),fc.a.instance.ia(493),fc.a.instance.ia(494),fc.a.instance.ia(495),fc.a.instance.La(746)];this.$g=null;this.eqg=
(Pb,hc)=>{(this.$g=hc?hc.viewModelData:null)?this.Zik(hc.activeCell):this.PBg()};this.dqg=()=>{this.PBg()};this.$=P;this.aWh=ua;this.HZb=Xa;this.HZb.NCa(this.eqg);this.HZb.ZEh(this.dqg);this.$.ra.zc(193,this)}NCa(P){this.addHandler("NumberFormatViewModelLoaded",P)}xLa(P){this.removeHandler("NumberFormatViewModelLoaded",P)}IFb(P){this.addHandler("NumberFormatViewModelFailed",P)}A3b(P){this.removeHandler("NumberFormatViewModelFailed",P)}get Hvg(){return"https://go.microsoft.com/fwlink/p/?linkid=2134522"}dispose(){this.HZb.xLa(this.eqg);
this.HZb.Qtk(this.dqg);super.dispose()}formatCells(P,ua){const Xa={};Xa.NumberFormatOptions=P;Xa.ValidMembers=32;Xa.NumberFormat=14;P=Object(sa.a)(new Fe.a,{color:this.$g.Color,sample:this.$g.Sample,UMc:this.$g.NumberFormatString});this.aWh.formatCells(2105621672,Xa,ua,P)}get UMc(){return this.$g.NumberFormatString}tGf(P){return this.xgi[P]}Cja(){return this.Xif(this.$g.NumberFormatOptions)}Xif(P){return Object(sa.a)(new Ud.a,{NumberFormatCategory:P.NumberFormatCategory,DecimalPlaces:P.DecimalPlaces,
IsComma:P.IsComma,NegativeNumberType:P.NegativeNumberType,NegativeCurrencyType:P.NegativeCurrencyType,CurrencyType:P.CurrencyType,DateType:P.DateType,TimeType:P.TimeType,FractionType:P.FractionType,SpecialType:P.SpecialType,CustomType:P.CustomType,LocaleType:P.LocaleType,IsInputCalendar:P.IsInputCalendar,CalendarType:P.CalendarType,IsGannen:P.IsGannen,IsOverrideDataLocale:P.IsOverrideDataLocale,Caller:P.Caller})}gVc(){this.$g=null}KVa(P,ua,Xa){this.HZb.NDj(P,ua,this.$g?this.$g.NumberFormatOptions:
null,void 0===Xa?!1:Xa)}Ilb(P,ua){m.ULS.shipAssertTag(537155107,0,!!this.$g,"NumberFormatViewModel.IsModelLoadedBy: numberFormatViewModelData is null");const Xa=this.Cja().Caller,Pb=Xa===P;Pb||m.ULS.sendTraceTag(537155106,0,15,`NumberFormatViewModel.IsModelLoaddedBy: expected caller in '${ua}' should be ${P} but caller is ${Xa}`);return Pb}SXc(P,ua){const Xa=this.$g.LocaleTags;if(de.a(Xa))m.ULS.shipAssertTag(537155105,0,!1,"NumberFormatViewModel.SetOverrideDataLocaleCookie: localeTags array is null or empty");
else if(Xa.length!==this.$g.Locales.length)m.ULS.shipAssertTag(537155104,0,!1,`NumberFormatViewModel.SetOverrideDataLocaleCookie: length mismatch: localeTags:${Xa.length}. localeNames:${this.$g.Locales.length}.`);else if(0>P||P>=Xa.length)m.ULS.shipAssertTag(537155103,0,!1,`NumberFormatViewModel.SetOverrideDataLocaleCookie: selectedLocaleIndex ${P} is out of range:[0:${Xa.length}]`);else{var Pb=Xa[P];if(Pb){var hc={};se.HelperMethods.OQg(Wc.A9j,Pb,this.$.ta.OverrrideDataLocaleCookieTTLDays,"OverrideDataLocale",
hc);this.$.sendBeaconTraceTag(590878544,50,!0,"NumberFormatViewModel.SetOverrideDataLocaleCookie: setting cookie. caller:{0}. currentDomain:{1}. cookieDomain:{2}. hostNameJsApi:{3}. hostName:{4}. uiHost:{5}. prevDataLocale:{6}. prevCookieVal:{7}. selectedLocaleIndex:{8}. selectedCultureTag:{9}. cookieSetOK:{10}. newCookieVal:{11}.",ua,hc.currentDomain,hc.parentDomain,this.$.ta.HostNameJsApi,this.$.ta.HostName,this.$.ta.UiHost,Xa[0],hc.prevCookieVal,P,Pb,hc.cookieSetOK,hc.newCookieVal);fe.a(this.$).Dt(new Tc.a(ed.a.xy,
5,()=>{const Qc=rb.a(this.$).Kd.activityState;Qc[pd.a.d6]=!0;Qc[Kb.a.Tq]=ed.a.dwd;this.$.Nm.BD("OverrideDataLocale_"+ua.substring(0,1))}))}else m.ULS.shipAssertTag(537155102,0,!1,"NumberFormatViewModel.SetOverrideDataLocaleCookie: selectedCultureTag is null or empty")}}Zik(P){this.raiseEvent("NumberFormatViewModelLoaded",new Ed(this.$g,P))}PBg(){this.raiseEvent("NumberFormatViewModelFailed")}}Wc.A9j="rsOverride";Object(n.a)(Wc,"NumberFormatViewModel",u.a,[499,4]);var Ac=a(663);class nd{}nd.tellMe=
"TellMe";nd.contextMenu="ContextMenu";nd.unknown="Unknown";Object(n.a)(nd,"TellMeScenario",null,[]);class qd{}qd.click="Click";qd.bTb="InteractionBegin";qd.kEc="InteractionEnd";qd.oif="ControlActivated";qd.query="Query";qd.TAg="QueryIndexRecorded";qd.ugf="Clicks";qd.W0e="ActionEvents";qd.pBf="FilteredActionEvents";qd.EPg="SessionContext";qd.latency="Latency";qd.performance="Performance";qd.CIg="RenderedResults";qd.events="Events";qd.Z$h="CreateResultsMenu";qd.t$="UpdateRibbonControls";qd.cAk="ResultsAggregation";
qd.Nx="IssueQuery";qd.i0h="CommandSuggestions";qd.error="Error";qd.p2d="LoadModelData";qd.xMj="ModelDataWaitTime";qd.timedOut="TimedOut";qd.$Gh="AddinQueryCommandReady";qd.UIi="GetAddinEntitlements";qd.FAg="ProviderMRUEvents";qd.dmi="EnableAddinSearchCommands";Object(n.a)(qd,"EventNames",null,[]);class Xd{constructor(P,ua,Xa,Pb,hc,Qc,vd){Xa=void 0===Xa?null:Xa;this.additionalInfo="";this.fmc=-1;this.value=P;this.type=ua;this.subType=void 0===hc?4:hc;this.label=this.qG=Xa;this.groupType=31;this.description=
void 0===Pb?null:Pb;this.score=void 0===Qc?-99999:Qc;this.count=void 0===vd?0:vd}}Object(n.a)(Xd,"ResultBinding",null,[]);class Hd{constructor(P,ua){this.nth=[];this.groupType=void 0===P?31:P;this.displayName=void 0===ua?"":ua}get results(){return this.nth}An(P){P.groupType=this.groupType;Array.add(this.results,P)}iie(P){P=void 0===P?1:P;if(this.results.length>=P)for(let ua=0;ua<P;ua++)Array.removeAt(this.results,this.results.length-1)}}Object(n.a)(Hd,"SimpleResultGroup",null,[539]);class Zc{constructor(P){this.attributes=
null;this.query=P;this.Ri=[]}Xm(P){this.Ri.push(P)}vGg(P){const ua=[];for(const Xa of this.Ri)Xa.groupType!==P&&ua.push(Xa);this.Ri.length!==ua.length&&(this.Ri=ua)}get Xlb(){return!1}}Object(n.a)(Zc,"SimpleResultsUpdatedEventArgs",null,[521]);var Jc=a(386);class gc{constructor(){this.userId=this.email=this.displayName=null}}Object(n.a)(gc,"InsertMentionParameters",null,[]);class dd{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(n.a)(dd,"InsightsParameters",null,
[]);var Bb=a(225),pc=a(24);class wc{constructor(P,ua,Xa,Pb,hc){this.aic=P;this.$hc=ua;this.Hvh=Xa;this.Vnh=Pb;this.SNe=hc}get u4a(){return 4}rX(P,ua){ua=void 0===ua?null:ua;ua=ua.sessionId+"|"+ua.interactionId+"|"+P.qG;if(this.SNe||this.Vnh){let Xa=this.SNe||oa.a.Bna(Object(pc.a)("HelpTooltip"))===oa.a.Bna(P.qG.trim());if(this.Hvh&&2<P.qG.length){const Pb=P.qG;";"===Pb.charAt(0)&&";"===Pb.charAt(Pb.length-1)&&Pb.substring(1,Pb.length-1)===wc.HRd&&(Xa=!0)}P=Xa?Object(pc.a)("HelpButtonTextNoPlaceholder"):
String.format(Object(pc.a)("TextWithQuotation"),P.qG);return this.WEf(ua,oa.a.Ig(P),Xa)}return this.WEf(ua,oa.a.Ig(String.format(Object(pc.a)("TextWithQuotation"),P.qG)),!1)}WEf(P,ua,Xa){return Bb.a(wc.HRd,Xa?this.$hc:this.aic,ua,"OfficeAssistant_16x16x32","A0",oa.a.Ig(P),ua,null,null)}}wc.HRd="bSearchHelp";Object(n.a)(wc,"AssistanceMenuItemFactory",null,[529]);var cd=a(165);class Vd{get u4a(){return 13}rX(){return Vd.uQh()}static uQh(){return Bb.b(Vd.bCf,"798637440",oa.a.Ig(Object(pc.a)("LookupFirstRunExperienceTitle")),
J.AFrameworkApplication.Mz,cd.c("Info_32x32x32"),null,null,oa.a.Ig(Object(pc.a)("LookupFirstRunExperienceTitle")),"Menu32",null,null,oa.a.Ig(Object(pc.a)("LookupFirstRunExperienceDescription")),null,null)}}Vd.bCf="bTellMeFirstRun";Object(n.a)(Vd,"FirstRunMenuItemFactory",null,[529]);class xb{constructor(P,ua){this.qTe=void 0===P?null:P;this.hrh=(void 0===ua?null:ua)||Object(pc.a)("LookupNoResultsDescription")}get u4a(){return 14}rX(P){P=String.format(this.hrh,P.qG);return this.YQh(P)}YQh(P){return Bb.b(xb.uhg,
"798637440",oa.a.Ig(Object(pc.a)("LookupNoResultsTitle")),this.qTe?J.AFrameworkApplication.Mz:null,this.qTe,null,null,oa.a.Ig(Object(pc.a)("LookupNoResultsTitle")),"Menu32",null,null,oa.a.Ig(P),null,null)}}xb.uhg="lookupNoResults";Object(n.a)(xb,"NoCommandsFoundMenuItemFactory",null,[529]);class ub{constructor(P,ua){this.FontWeight=0;this.Text=null;this.FontWeight=P;this.Text=ua}}Object(n.a)(ub,"LabelFormatted",null,[]);class Fc{constructor(){this.currentDocumentPath=J.AFrameworkApplication.ea.Qa("EditDocInClientUrl")}}
Object(n.a)(Fc,"SmartLookupApplicationInterface",null,[]);class xd{}Object(n.a)(xd,"SmartLookupSelection",null,[]);var Ic=a(48);class bd{static get hkj(){return"Insights_16x16x32"}static get sBi(){return"Find_16x16x32"}static get j$j(){return"-Parameterized"}static get Nte(){return"Parameterized"}static get O1c(){return"bTryQuery"}static get Lye(){return"TellMeSuggestion_"}static get X4g(){return"bTryQueryAlternate"}static get Ewe(){return"MenuTellMe"}static get Eak(){const P={},ua=[];Array.add(ua,
{Term:{PeopleType:"Person"}});P.And=ua;return P}static getParameter(P){let ua="",Xa="";if(P)for(let Pb=0;Pb<P.PAf;++Pb)"Type"===P.getFieldName(Pb)?ua=P.bE(Pb):"Value"===P.getFieldName(Pb)&&(Xa=P.bE(Pb));return new Jc.a(ua,Xa)}static zzd(P){P=Object.assign(new dd,{neighborhood:P,mentionStart:0,mentionLength:P.length});return Ic.c(P)}static Alf(P,ua,Xa){P=Object.assign(new gc,{displayName:P,email:ua,userId:Xa});return Ic.c(P)}static Qra(P,ua,Xa){return Ic.c(bd.WNf(P,ua,void 0===Xa?null:Xa,null))}static WNf(P,
ua,Xa,Pb){Xa=void 0===Xa?null:Xa;Pb=void 0===Pb?null:Pb;P=Object.assign(new xd,{neighborhood:P,mentionStart:0,mentionLength:P?P.length:0});return Object.assign(new Fc,{selection:P,userIntent:Pb,entryPoint:ua,launchData:Xa})}static bAk(P,ua){return bd.Qra(P,bd.aLg(ua))}static aLg(P){switch(P){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;case "GenerateDeckFromFile":return 38;default:return 0}}static trj(){return!!J.AFrameworkApplication.ea&&
J.AFrameworkApplication.ea.ka("IsGoLocalEnvironment")}static smb(){const P=J.AFrameworkApplication.ea?J.AFrameworkApplication.ea.Qa("SovereignEnvironmentName"):null;return!!P&&0<P.length}static isEnterpriseUser(){const P=J.AFrameworkApplication.ea?J.AFrameworkApplication.ea.Qa("HostAuthType"):null;return!!P&&"aad"===P.toLowerCase()||"external"===P&&bd.QVd()}static Bre(P){return P.A3k&&!bd.smb()}static zwj(){const P=J.AFrameworkApplication.ea?J.AFrameworkApplication.ea.Qa("UiHostIntegrationType"):
"";return J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FixUnifiedAppsShowSearchInHeader",!1)?!!J.AFrameworkApplication.ea&&("UnifiedUiHostTeams"===P||"TeamsModern"===P)&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",!1):!!J.AFrameworkApplication.ea&&"UnifiedUiHostTeams"===P&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",
!1)}static Are(P){return P.tellMeInSharedHeaderIsEnabled&&P.fetchTokensForSearch&&(P.$8b||P.Z8b||P.FIa)&&!bd.zwj()&&bd.isEnterpriseUser()&&!bd.smb()}static G2(){return J.AFrameworkApplication.ea?J.AFrameworkApplication.Hya||J.AFrameworkApplication.ea.ka("SmartLookupEnableNativePane"):J.AFrameworkApplication.Hya}static Nz(P){return!P||bd.j5f(P.qe)}static j5f(P){return!P||!P.trim().length}static K1c(P){if(!P)return 0;const ua=Math.pow(10,5);return Math.round(P*ua)/ua}static toUtc(P){return P?new Date(P.getUTCFullYear(),
P.getUTCMonth(),P.getUTCDate(),P.getUTCHours(),P.getUTCMinutes(),P.getUTCSeconds(),P.getUTCMilliseconds()):null}static VOd(P){P=new Date(P);return(bd.toUtc(new Date).getTime()-P.getTime())/1E3}static A5f(P){switch(P){case wc.HRd:case Vd.bCf:case "bInsights":case xb.uhg:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "ActionAIFromTellMe":case "LaunchAddinDialogFromTellMe":case "GenerateSlidesFromTellMe":case "QuickActionOnFile":case "SummarizeDeckFromTellMe":case "SummarizeSlidesFromTellMe":case "InsertFunctionParameterized":return!0}return P.startsWith(bd.O1c)||
P.startsWith(bd.Lye)||P.startsWith(bd.X4g)||P.startsWith("PeopleSuggestion")||P.startsWith("FileSuggestion")||P.startsWith("FindInDocumentSuggestion")||P.startsWith("NotesSuggestion")||P.startsWith("OnenoteNotesSuggestion")||P.startsWith("SmartLookupFromTellMe")||P.startsWith("GetHelpFromTellMe")||P.startsWith("GetHelpWithDescriptionFromTellMe")||P.startsWith("AddinSuggestion")||P.startsWith("OfficeScripts")?!0:!1}static KLd(P,ua){const Xa=[];Array.add(Xa,new ub(400,P));Array.add(Xa,new ub(200,ua));
P={};P.parts=Xa;return JSON.stringify(P)}static hGa(P){const ua=P.indexOf("<b0>"),Xa=P.lastIndexOf("</b0>"),Pb=[];Array.add(Pb,new ub(400,P.substring(0,ua)));Array.add(Pb,new ub(600,P.substring(ua+4,Xa)));Array.add(Pb,new ub(400,P.substring(Xa+5,P.length)));P={};P.parts=Pb;return JSON.stringify(P)}static DOf(P){const ua=bd.VOd(P);60>ua?P=Object(pc.a)("TimeSince_SecsAgo"):3600>ua?(P=Math.floor(ua/60),P=String.format(Object(pc.a)("TimeSince_MinsAgo"),P.toString())):86400>ua?(P=Math.floor(ua/3600),P=
String.format(Object(pc.a)("TimeSince_HoursAgo"),P.toString())):172800>ua?P=Object(pc.a)("TimeSince_Yesterday"):(P=new Date(P),P=String.format(Object(pc.a)("TimeSince_Date"),P.localeFormat("MMMM dd, yyyy")));return P}static DMi(P){const ua=Array(P.length);for(let Xa=0;Xa<P.length;Xa++)ua[Xa]=P[Xa].commandId;return ua}static QVd(){if("Dev Box"===J.AFrameworkApplication.ea.Qa("StatusBarEnvironmentNameToUse"))return!0;let P=J.AFrameworkApplication.ea.Qa("UserPrincipalName");P=Na.c(P)?"":oa.a.wm(P);const ua=
J.AFrameworkApplication.ea.Dj("TellMeIntEnabledForFeatureCrew")?J.AFrameworkApplication.ea.Yk("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(ua,P)&&"inner"===J.AFrameworkApplication.ea.Qa("Microsoft365Ring")}static VSi(P){switch(bd.Jzc(P)){case "PowerPoint":return"SaveAsPowerPointPptx_20";case "Word":return"SaveAsWordDocx_20";case "Excel":return"SaveAsExcelXlsx_20";case "Pdf":return"PdfFile_20";case "OneNote":return"OneNote_20";case "Visio":return"visio_20"}return""}static r1i(P){P=
bd.Jzc(P);switch(P){case "PowerPoint":return"pptx";case "Word":return"docx";case "Excel":return"xlsx";default:return P}}static Jzc(P){switch(P.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"PowerPoint";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"Word";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"Excel";
case "pdf":return"Pdf";case "one":case "onepkg":return"OneNote";case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio"}return"Unknown"}static ANi(P){if("word"===P.application.toLowerCase())return"ChatPane";if("powerpoint"===P.application.toLowerCase())return"ChatPPTPane";if("excel"===P.application.toLowerCase())return"Copilot"}static sMi(P){if("excel"===P.application.toLowerCase()||
"powerpoint"===P.application.toLowerCase())return"ShareMenu"}}bd.c3g=9E5;Object(n.a)(bd,"TellMeUtils",null,[]);class yb{constructor(){this.data=this.landingTab=null}}Object(n.a)(yb,"LaunchData",null,[]);var Oc=a(874),kd=a(661);class Rc{constructor(){this.DRa=null;this.cM=[];this.vfd=!0;this.mgc=null;this.K_e=!1;this.oW=null;this.Bfd=[];this.U8c=[];this.T8c=[];this.xld=[];this.Hic=this.jaa=null;this.Cfd=[];this.lcd=this.Gkd=this.Db=null;this.fDb=-1;this.jcc=this.Vad=null}static get instance(){return Rc.Wa||
(Rc.Wa=new Rc)}mKd(){return this.Bfd}hzc(){return this.U8c}sKd(){return this.T8c}kPd(){return this.xld}BMd(){return this.jaa}get F7b(){return this.Hic}set F7b(P){this.Hic=P}nKd(){return this.Cfd}h$b(P,ua,Xa){ua=void 0===ua?"":ua;Xa=void 0===Xa?null:Xa;P?this.jcc=new Oc.a(kd.a.Ef()):ua&&Xa&&this.jcc.add(ua,Xa)}hjb(){return Rc.instance.Ah?Rc.instance.Ah.yR.interactionId:null}get jra(){return this.jcc}set jra(P){this.jcc=P}get gD(){return Rc.instance.Gkd}set gD(P){Rc.instance.Gkd=P}QOd(){return this.Gkd}get actions(){return Rc.instance.cM}set actions(P){Rc.instance.cM=
P}Dz(){return this.Db}kf(){return this.lcd}vsc(){return this.fDb}TLd(){return this.Vad}get Sh(){return Rc.instance.Db}set Sh(P){Rc.instance.Db=P}set Y5c(P){Rc.instance.DRa=P}get ujb(){return Rc.instance.Vad}set ujb(P){Rc.instance.Vad=P}get Ah(){return Rc.instance.lcd}set Ah(P){Rc.instance.lcd=P}get T3(){return Rc.instance.fDb}set T3(P){Rc.instance.fDb=P}static get Unknown(){return Rc.unknown}get OKb(){return this.oW?this.oW.contentType:Rc.unknown}t$(P){const ua=window.performance.now();this.DRa&&
!Na.c(P)&&(this.DRa(P),Rc.instance.Ah.jR(qd.t$,window.performance.now()-ua))}get UYb(){return this.vfd}set UYb(P){this.vfd=P}get oac(){return this.mgc}set oac(P){this.mgc=P}get Dza(){return this.K_e}set Dza(P){this.K_e=P}get wob(){return this.Bfd}set wob(P){this.Bfd=P}get web(){return this.U8c}set web(P){this.U8c=P}get veb(){return this.T8c}set veb(P){this.T8c=P}get axb(){return this.xld}set axb(P){this.xld=P}get WY(){return this.jaa}set WY(P){this.jaa=P}get T5a(){return this.Hic}set T5a(P){this.Hic=
P}get xob(){return this.Cfd}set xob(P){this.Cfd=P}}Rc.Wa=null;Rc.unknown="Unknown";Object(n.a)(Rc,"TellMeActorConstants",null,[]);class Xb{constructor(P){this.Db=P}Hx(){return"ActionAI"}RF(){return 0===this.Db.jm?0:1===this.Db.jm?1:2}Nx(P,ua,Xa,Pb,hc){Xa=void 0===Xa?!1:Xa;hc=void 0===hc?null:hc;Pb=new Zc(P);if(!hc||Array.contains(hc,24))if(this.ESk()||!bd.Nz(P)){hc=new Hd(24);var Qc=bd.Nz(P);Xa&&(Xa=null,bd.G2()&&(Xa=bd.Qra(Qc?"":P.qe,1,Object.assign(new yb,{landingTab:"ActionAI"}))),this.Db.J7?Xa&&
Rc.instance.actions.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",Xa)):(P=[],Xa&&P.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",Xa)),appChrome.api.dispatch(P)));hc.An(new Xd("ActionAIFromTellMe",25,null,null,1));Pb.Xm(hc)}ua.Ll(Pb)}ESk(){return bd.G2()&&this.Db.DEc}}Object(n.a)(Xb,"ActionAIResultsProvider",null,[512]);class dc{}dc.Xdg=0;dc.RRc=10;Object(n.a)(dc,"AppsForOfficeStoreType",null,[]);var Vc=a(125);class yd{constructor(){this.ckd=0}nhk(P,ua){this.ckd=
window.performance.now();this.qac(()=>{const Xa=window.performance.now(),Pb={},hc=J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinUseLocalStoreTypeClass",!0);ua.t5e&&(Pb.callback=Qc=>{P(Qc,dc.Xdg,Xa)},hc&&(Pb.storeType=dc.Xdg),J.AFrameworkApplication.Kb.pe(S.a.trb,2,Pb));ua.u5e&&(Pb.callback=Qc=>{P(Qc,dc.RRc,Xa)},hc?Pb.storeType=dc.RRc:J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",!0)?Pb.storeType=
10:Pb.storeType=dc.RRc,J.AFrameworkApplication.Kb.pe(S.a.trb,2,Pb))},0,()=>{if(Rc.instance.kf())Rc.instance.kf().onError("AddinEntitlementsQuery:QueryEntitlementAsync","Query entitlements timeout after "+(window.performance.now()-this.ckd)+" ms")})}qac(P,ua,Xa){ua=void 0===ua?0:ua;Xa=void 0===Xa?null:Xa;2!==J.AFrameworkApplication.Kb.hf(S.a.trb,1)?(Rc.instance.kf()&&Rc.instance.kf().jR(qd.$Gh,window.performance.now()-this.ckd),P()):ua<yd.$Kj?J.AFrameworkApplication.Rj.Ag(new Vc.a(2,1,yd.fkl,()=>{this.qac(P,
ua+1,Xa)})):Xa&&Xa()}static get instance(){yd.Wa||(yd.Wa=new yd);return yd.Wa}}yd.Wa=null;yd.$Kj=20;yd.fkl=500;Object(n.a)(yd,"AddinEntitlementsQuery",null,[]);class Pd{constructor(){this.description=this.id=this.displayName=null;this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.s0d=this.storeType=this.storeId=this.Ugk=this.iconUrl=null}}Object(n.a)(Pd,"AddinInfo",null,[]);var re=a(104);class ue{constructor(P){this.Mhd=[];this.Db=P;this.dZj=(ua,Xa,
Pb)=>{if(ua){const hc=ua.errorCode;if(Rc.instance.kf()){const Qc={};Qc.StoreType=Xa;Qc.ErrorCode=hc;Qc.AddinCount=ua.value?ua.value.length:0;Rc.instance.kf().jR(qd.UIi,window.performance.now()-Pb,Qc)}if(0===hc&&ua.value){ue.qSa=ue.qSa||{};ua=ua.value;for(const Qc of ua)ua=new Pd,ua.displayName=Qc[0],ua.id=Qc[1],ua.description=Qc[2],ua.targetType=Qc[3],ua.appVersion=4<Qc.length?Qc[4]:"",ua.assetId=5<Qc.length?Qc[5]:"",ua.assetStoreId=6<Qc.length?Qc[6]:"",ua.width=7<Qc.length?Qc[7]:0,ua.height=8<Qc.length?
Qc[8]:0,ua.iconUrl=9<Qc.length?Qc[9]:"",ua.Ugk=10<Qc.length?Qc[10]:"",ua.storeId=11<Qc.length?Qc[11]:"",ua.storeType=12<Qc.length?Qc[12]:"",ua.s0d=this.ZTi(ua),ue.qSa[ua.id]=ua,0<ua.iconUrl.length&&(Xa="AddinIcon_"+ua.id,J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)?this.pLa(Xa,ua.iconUrl):appChrome.addInApi.registerAddinIcon(Xa,ua.iconUrl))}}};yd.instance.nhk(this.dZj,this.Db)}Hx(){return"Add-ins"}RF(){return 0===this.Db.jm?0:
1===this.Db.jm?1:2}Nx(P,ua,Xa,Pb,hc){hc=void 0===hc?null:hc;Xa=new Zc(P);hc&&!Array.contains(hc,27)||bd.Nz(P)||(hc=new Hd(27),hc.displayName=Object(pc.a)("TellMeAddinProviderTitle"),this.qTi(P.qe,hc),Xa.Xm(hc));ua.Ll(Xa)}qTi(P,ua){if((P=this.wEk(P))&&0<P.length){let Xa=0;P.forEach(Pb=>{if(!(3<++Xa)){var hc="AddinSuggestion"+Xa,Qc={};if(J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)){var vd="AddinIcon_"+Pb.id;0>Array.indexOf(this.Mhd,
vd)&&0<Pb.iconUrl.length&&this.pLa(vd,Pb.iconUrl);Qc["default"]=0<=Array.indexOf(this.Mhd,vd)?vd:"AppForOfficeLogo_20"}else Qc["default"]=0<Pb.iconUrl.length?"AddinIcon_"+Pb.id:"AppForOfficeLogo_20";vd=[];vd.push(appChrome.actions.setControlLabel(hc,Pb.displayName));vd.push(appChrome.actions.setControlIconSet(hc,Qc));vd.push(appChrome.actions.setCompoundButtonCommandValueId(hc,Pb.id));vd.push(appChrome.actions.updateCompoundButtonDescription(hc,Pb.description));J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchEnableCommands",
!0)&&(Qc=window.performance.now(),vd.push(appChrome.actions.updateControlEnabledDisabledState(hc,!1)),Rc.instance.kf()&&Rc.instance.kf().jR(qd.dmi,window.performance.now()-Qc));appChrome.api.dispatch(vd);hc=new Xd(hc,27,void 0,void 0,1);hc.additionalInfo=Telemetry.PrivacyRules.GetPrivacyCompliantId(Pb.id,Pb.storeType,Pb.assetId,null,null,Pb.storeId);ua.An(hc)}})}}pLa(P,ua){re.c()&&appChrome.addInApi.registerAddinIcon&&(appChrome.addInApi.registerAddinIcon(P,ua),Array.add(this.Mhd,P))}wEk(P){if(!ue.qSa)return null;
const ua=[],Xa=ue.qSa;for(const hc in Xa){var Pb=Xa[hc];Pb&&ue.jKj(P,Pb)&&Array.add(ua,Pb)}return ua}ZTi(P){return ue.n_k(P.displayName)}static jKj(P,ua){if(!ua.s0d)return!1;for(const Xa of P.split(" ")){P=!1;for(const Pb of ua.s0d)if(Pb.toLowerCase().startsWith(Xa.toLowerCase())){P=!0;break}if(!P)return!1}return!0}static n_k(P){const ua=[];for(const Xa of P.split(" ")){P=0;for(let Pb=0;Pb<Xa.length;Pb++){const hc=Xa.charAt(Pb);hc.toString().toUpperCase()===hc.toString()&&Pb>P&&(Array.add(ua,Xa.substring(P,
Pb)),P=Pb)}Array.add(ua,Xa.substring(P,Xa.length));P&&Array.add(ua,Xa.substring(0,Xa.length))}return ua}}ue.qSa=null;Object(n.a)(ue,"AddinResultsProvider",null,[512]);class He{constructor(P,ua){this.Gih=P;this.Yj=ua}Ll(P){this.Gih.hMk(this.Yj,P)}}Object(n.a)(He,"AggregatorResultsProviderCallback",null,[531]);class bf{constructor(P){this.f5=null;this.Db=P;this.Db.ISa&&(this.f5=null)}Hx(){return"AppsForOffice"}RF(){return 0===this.Db.jm?0:1===this.Db.jm?1:2}Nx(P,ua,Xa,Pb,hc){hc=void 0===hc?null:hc;
Xa=new Zc(P);if(!hc||Array.contains(hc,1))hc=new Hd(1),this.f5.lql(hc,P.qe),Xa.Xm(hc);ua.Ll(Xa)}}Object(n.a)(bf,"AppsForOfficeRecommendationResultsProvider",null,[512]);class af{constructor(P){this.Db=P}Hx(){return"Assistance"}RF(){return 0===this.Db.jm?0:1===this.Db.jm?1:this.Db.u0b?3:2}Nx(P,ua,Xa,Pb,hc){Xa=void 0===Xa?!1:Xa;hc=void 0===hc?null:hc;Pb=new Zc(P);if((!hc||Array.contains(hc,8))&&!bd.Nz(P)){hc=new Hd(8);if(Xa){Xa=oa.a.Bna(Object(pc.a)("HelpTooltip"))===oa.a.Bna(P.qe.trim())?Object(pc.a)("HelpButtonTextNoPlaceholder"):
String.format(Object(pc.a)("TextWithQuotation"),P.qe);const Qc=[];this.Db.EIa&&(this.Db.xse||Qc.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),Xa=this.qLf(P.qe));const vd="||"+P.qe;Qc.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",Xa));Qc.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",vd));appChrome.api.dispatch(Qc);P=new Xd("GetHelpFromTellMe",4,P.qe,null,1)}else P=new Xd("bSearchHelp",4,P.qe,null,1);hc.An(P);hc.displayName=
Object(pc.a)("HelpButtonTitle");Pb.Xm(hc)}ua.Ll(Pb)}eHa(P,ua){ua=void 0===ua?null:ua;const Xa=new Hd(8),Pb=oa.a.Bna(Object(pc.a)("HelpTooltip"))===oa.a.Bna(P.qe.trim())?Object(pc.a)("HelpButtonTextNoPlaceholder"):String.format(Object(pc.a)("TextWithQuotation"),P.qe);for(let Qc=0;Qc<ua.length&&2>Qc;Qc++){var hc=[];let vd="GetHelpWithDescriptionFromTellMe"+(Qc+1).toString(),Nd=4;if(this.Db.X6b)hc.push(appChrome.actions.setControlLabel(vd,Pb)),hc.push(appChrome.actions.setCompoundButtonCommandValueId(vd,
P.qe)),hc.push(appChrome.actions.updateCompoundButtonDescription(vd,this.A3i(ua.length)));else if(this.Db.Y6b){let ke=this.NOf(ua[Qc]);vd="GetHelpFromTellMe"+(Qc+1).toString();this.Db.EIa&&(ke=this.qLf(ke));Nd=9;hc.push(appChrome.actions.setControlLabel(vd,ke));hc.push(appChrome.actions.setButtonCommandValueId(vd,this.y3i(ua[Qc])))}appChrome.api.dispatch(hc);hc=new Xd(vd,Nd,null,null,0);hc.label=this.NOf(ua[Qc]);hc.description=this.x3i(ua[Qc]);Xa.An(hc);if(this.Db.Y6b)break}Xa.displayName=Object(pc.a)("HelpButtonTitle");
return Xa}A3i(P){return 1===P?String.format(Object(pc.a)("SearchResultText"),P):String.format(Object(pc.a)("SearchResultsText"),P)}qLf(P){return this.Db.VZd?bd.KLd(P,Object(pc.a)("HelpScopedButtonText")):P+Object(pc.a)("HelpScopedButtonText")}NOf(P){return P.name?P.name:""}x3i(P){return P.description?P.description:""}y3i(P){return P.id?"AssetID="+P.id:""}}Object(n.a)(af,"AssistanceResultsProvider",null,[512]);var Pe=a(934),wf=a(951),xf=a(363);class Cf{constructor(P,ua){this.Ga=P;this.oIj=ua}isMatch(P,
ua){if(!Object(xf.a)(621,P))throw Error.argument("objToTest","Expected feature bundle");let Xa;return(()=>{let Pb=P.vk(this.Ga.n6);({value:Xa}=Pb);return Pb})().returnValue?this.Ga.uBe.isMatch(Xa,ua):this.oIj}}Object(n.a)(Cf,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[637]);class tf{constructor(P,ua){this.Ga=P;this.g4d=ua}isMatch(P){if(!Object(xf.a)(621,P))throw Error.argument("objToTest","Expected feature bundle");return!!(this.g4d^(()=>P.vk(this.Ga.n6))().returnValue)}}Object(n.a)(tf,"AnnotatedWithAnnotationFilter",
null,[637]);class Jf{constructor(P){this.Ga=P}isMatch(P,ua){if(!Object(xf.a)(624,P))throw Error.argument("objToTest","Expected struct value");return this.Ga.uBe.isMatch(P.sGa(this.Ga.fieldIndex),ua)}}Object(n.a)(Jf,"FieldValueMatchesStructFilter",null,[637]);class dg{constructor(P,ua){P&&(this.fieldIndex=P.pa(0),this.uBe=ua.T1(P.pa(1)))}}Object(n.a)(dg,"FieldValueMatchesStructFilterInit",null,[]);class uf{constructor(P){this.g4d=P}isMatch(P){if(!Object(xf.a)(621,P))throw Error.argument("objToTest",
"Expected feature bundle");return!!(this.g4d^P.TQd)}}Object(n.a)(uf,"HasAnnotationsAnnotationFilter",null,[637]);class lf{constructor(P,ua){this.Ga=P;this.bR=ua}isMatch(P,ua){if(!Object(xf.a)(623,P))throw Error.argument("objToTest","Expected list value");switch(this.bR){case 0:for(const Xa of P.items)if(this.Ga.filter.isMatch(Xa,ua))return!0;return!1;case 1:for(const Xa of P.items)if(!this.Ga.filter.isMatch(Xa,ua))return!1;return!0;default:throw Error.notImplemented();}}}Object(n.a)(lf,"ItemTestListFilter",
null,[637]);class Pf{constructor(P){this.Ga=P}isMatch(P,ua){if(!Object(xf.a)(623,P))throw Error.argument("objToTest","Expected list value");return this.Ga.filter.isMatch(P.items.length,ua)}}Object(n.a)(Pf,"LengthMatchesListFilter",null,[637]);class Rf{constructor(P,ua){this.Ga=P;this.bR=ua}isMatch(P,ua,Xa){Xa=void 0===Xa?null:Xa;let Pb=0===this.bR;for(const hc of this.Ga.uef)if((Pb=hc.isMatch(P,ua,Xa))?1===this.bR:0===this.bR)return Pb;2===this.bR&&(Pb=!Pb);return Pb}}Object(n.a)(Rf,"NonterminalFilter",
null,[637]);class Mf{constructor(P,ua){if(P){var Xa=P.pa(0);this.uef=Array(Xa);for(let Pb=0;Pb<Xa;++Pb)this.uef[Pb]=ua.T1(P.pa(1+Pb))}}}Object(n.a)(Mf,"NonterminalFilterInit",null,[]);class zf{constructor(P,ua){this.Ga=P;this.bR=ua}isMatch(P,ua){if("number"!==typeof P)throw Error.argument("objToTest","Expected number value");let Xa=this.Ga.number;if(this.Ga.query){ua=this.Ga.query.am(null,ua);if("number"!==typeof ua)throw Error.invalidOperation("Query did not return number");Xa+=ua}switch(this.bR){case 0:return P===
Xa;case 1:return P<Xa;case 2:return P<=Xa;case 3:return P>Xa;case 4:return P>=Xa;default:throw Error.notImplemented();}}}Object(n.a)(zf,"NumberFilter",null,[637]);class df{constructor(P,ua){P&&(this.number=P.pa(0),this.query=P.pa(1)?ua.Cz(P.pa(1)):null)}}Object(n.a)(df,"NumberFilterInit",null,[]);class Bf{constructor(P,ua,Xa){this.Gzc=this.vQi;this.jLc=P;this.wcg=ua;this.vcg=Xa}Mud(P){this.wcg=P}vQi(P){if(!P)throw Error.argument("name","Invalid named feature bundle reference");const ua=P.substr(1);
return 1===P.charCodeAt(0)&&ua===this.jLc?this.wcg:this.vcg?this.vcg.Gzc(P):null}}Object(n.a)(Bf,"SimpleNamedFeatureBundleResolver",null,[643]);class Kf{constructor(P){this.Ga=P}isMatch(P,ua){if(!Object(xf.a)(621,P))throw Error.argument("objToTest","Expected feature bundle");P=this.Ga.query.am(null,new Bf(this.Ga.c4c,P,ua));if("boolean"!==typeof P)throw Error.invalidOperation("Query did not return bool");return P}}Object(n.a)(Kf,"PredicateAnnotationFilter",null,[637]);class Vf{constructor(P,ua){P&&
(this.c4c=ua.ia(P.pa(0)),this.query=ua.Cz(P.pa(1)))}}Object(n.a)(Vf,"PredicateAnnotationFilterInit",null,[]);class sb{constructor(P){this.Ga=P}isMatch(P,ua){if("boolean"!==typeof P)throw Error.argument("objToTest","Expected bool value");ua=this.Ga.query.am(null,ua);if("boolean"!==typeof ua)throw Error.invalidOperation("Query did not return bool");return P===ua}}Object(n.a)(sb,"QueryBooleanFilter",null,[637]);class Gc{constructor(P,ua){this.Ga=P;this.bR=ua}isMatch(P,ua){if("number"!==typeof P)throw Error.argument("objToTest",
"Expected integer");ua=this.Ga.query.am(null,ua);if("number"!==typeof ua)throw Error.invalidOperation("Query did not return an enum value");switch(this.bR){case 0:return P===ua;case 1:return 0!==(P&ua);case 2:return P===(P&ua);case 3:return ua===(P&ua);default:throw Error.notImplemented();}}}Object(n.a)(Gc,"QueryEnumFilter",null,[637]);class ad{constructor(P,ua){P&&(this.bHc=1===P.pa(0),this.query=ua.Cz(P.pa(1)))}}Object(n.a)(ad,"QueryEnumFilterInit",null,[]);class Wd{constructor(P,ua){this.Ga=P;
this.bR=ua}isMatch(P,ua){if(!Object(xf.a)(623,P))throw Error.argument("objToTest","Expected list value");ua=this.Ga.query.am(null,ua);if(!Object(xf.a)(623,ua))throw Error.invalidOperation("Query did not return list value");if(P.XN!==ua.XN)return!1;switch(this.bR){case 0:return Pe.Annotations.UNa(Pe.Annotations.zUi(P.XN),P,ua);case 1:for(const Xa of P.items)for(const Pb of ua.items)if(Pe.Annotations.UNa(P.XN,Xa,Pb))return!0;return!1;case 2:for(const Xa of P.items)for(const Pb of ua.items)if(!Pe.Annotations.UNa(P.XN,
Xa,Pb))return!1;return!0;case 3:for(const Xa of ua.items)for(const Pb of P.items)if(!Pe.Annotations.UNa(P.XN,Xa,Pb))return!1;return!0;default:throw Error.notImplemented();}}}Object(n.a)(Wd,"QueryListFilter",null,[637]);class je{constructor(P,ua){this.Ga=P;this.bR=ua}isMatch(P,ua){if("string"!==typeof P)throw Error.argument("objToTest","Expected string");ua=this.Ga.query.am(null,ua);if("string"!==typeof ua)throw Error.invalidOperation("Query did not return string");this.Ga.XUd&&(P=P.toUpperCase(),
ua=ua.toUpperCase());switch(this.bR){case 0:return P===ua;case 1:return 0<=P.indexOf(ua);case 2:return P.startsWith(ua);case 3:return P.endsWith(ua);case 4:return 0<=ua.indexOf(P);case 5:return ua.startsWith(P);case 6:return ua.endsWith(P);default:throw Error.notImplemented();}}}Object(n.a)(je,"QueryStringFilter",null,[637]);class Ie{constructor(P,ua){P&&(this.query=ua.Cz(P.pa(0)),this.XUd=1===P.pa(1))}}Object(n.a)(Ie,"QueryStringFilterInit",null,[]);class Je{constructor(P){this.Ga=P}isMatch(P,ua){if(!Object(xf.a)(624,
P))throw Error.argument("objToTest","Expected struct value");ua=this.Ga.query.am(null,ua);if(!Object(xf.a)(624,ua))throw Error.invalidOperation("Query did not return struct value");return P.isEqual(P)}}Object(n.a)(Je,"QueryStructFilter",null,[637]);class $e{constructor(P){this.Ga=P}isMatch(P,ua){P=this.Ga.query.am(null,ua);if("boolean"!==typeof P)throw Error.invalidOperation("Query did not return bool");return P}}Object(n.a)($e,"QueryWhereConstraintFilter",null,[637]);class Ib{constructor(P){this.Ga=
P}isMatch(P){if("string"!==typeof P)throw Error.argument("objToTest","Expected string");return this.Ga.Yge.test(P)}}Object(n.a)(Ib,"RegexStringFilter",null,[637]);class Nb{constructor(P,ua){P&&(this.Yge=ua.LMf(P.pa(0)))}}Object(n.a)(Nb,"RegexStringFilterInit",null,[]);class Bc{constructor(P,ua){P&&(this.filter=ua.T1(P.pa(0)))}}Object(n.a)(Bc,"SingleFilterFilterInit",null,[]);class Af{constructor(P,ua){P&&(this.query=ua.Cz(P.pa(0)))}}Object(n.a)(Af,"SingleQueryFilterInit",null,[]);class gf{constructor(P){this.Ga=
P}isMatch(P){if("boolean"!==typeof P)throw Error.argument("objToTest","Expected bool value");return P===this.Ga.value}}Object(n.a)(gf,"StoredValueBooleanFilter",null,[637]);class Qe{constructor(P){P&&(this.value=1===P.pa(0))}}Object(n.a)(Qe,"StoredValueBooleanFilterInit",null,[]);class Aa{constructor(P,ua){this.Ga=P;this.bR=ua}isMatch(P){if("number"!==typeof P)throw Error.argument("objToTest","Expected integer");switch(this.bR){case 0:return this.Ga.bHc?this.Ga.value?!!(P&this.Ga.value):!P:P===this.Ga.value;
case 1:return this.Ga.bHc?(P&this.Ga.value)===this.Ga.value:32>P&&(1<<P&this.Ga.value)===this.Ga.value;case 2:return this.Ga.bHc?!!(P&this.Ga.value):32>P&&!!(1<<P&this.Ga.value);default:throw Error.notImplemented();}}}Object(n.a)(Aa,"StoredValueEnumFilter",null,[637]);class Fb{constructor(P){P&&(this.bHc=1===P.pa(0),this.value=P.pa(1))}}Object(n.a)(Fb,"StoredValueEnumFilterInit",null,[]);class Ta{constructor(){this.q$j=null;this.rtd=this.zYa=0}}Object(n.a)(Ta,"WHEREConstraintData",null,[]);class Eb{constructor(P){this.Ga=
P}isMatch(P,ua){if(!Object(xf.a)(Ta,P))throw Error.argument("objToTest","Expected WHERE constraint data");let Xa=-1,Pb=-1;const hc=P.q$j;switch(this.Ga.kud){case 4:Xa=hc.TNb;Pb=hc.tue;break;case 5:Xa=P.zYa;Pb=hc.TNb-P.zYa;break;case 6:Xa=hc.TNb+hc.tue;Pb=P.zYa+P.rtd-Xa;break;case 1:case 2:case 3:let Qc=!1;for(let vd=hc.Pql;vd;vd=vd.next)if(this.Ga.$gl===vd.name){Qc=!0;1===this.Ga.kud?(Xa=vd.TNb,Pb=vd.tue):2===this.Ga.kud?(Xa=P.zYa,Pb=vd.TNb-P.zYa):(Xa=vd.TNb+vd.tue,Pb=P.zYa+P.rtd-Xa);break}if(!Qc)return!1;
break;case 7:Xa=P.zYa;Pb=P.rtd;break;default:throw Error.notImplemented();}return null!==this.Ga.o_k.$rl(hc.AAl,Xa,Pb,Xa,!0,2,ua)}}Object(n.a)(Eb,"SubSreWhereConstraintFilter",null,[637]);class oc{constructor(P,ua){if(P){var Xa=ua.ia(P.pa(0));this.kud=Xa.charCodeAt(0);this.$gl=Xa.substr(1);this.o_k=ua.O_i(P.pa(1))}}}Object(n.a)(oc,"SubSreWhereConstraintFilterInit",null,[]);class Lc{constructor(P){this.Ga=P}isMatch(P,ua,Xa){Xa=void 0===Xa?null:Xa;if(!Object(xf.a)(621,P))throw Error.argument("objToTest",
"Expected feature bundle");if(null==Xa)throw Error.argumentNull("parentTextForSpan");if(this.Ga.V6e&&!this.Ga.V6e.isMatch(P,ua))return!1;if(this.Ga.Mwe){let Pb;if((()=>{let hc=P.vk(this.Ga.UZk);({value:Pb}=hc);return hc})().returnValue){if(!this.Ga.Mwe.isMatch(Pb,ua))return!1}else{let hc,Qc;if(!(()=>{let vd=P.vk(this.Ga.aZg);({value:hc}=vd);return vd})().returnValue||!(()=>{let vd=P.vk(this.Ga.$Yg);({value:Qc}=vd);return vd})().returnValue||0>hc||0>Qc||hc+Qc>Xa.length||!this.Ga.Mwe.isMatch(Xa.substr(hc,
Qc),ua))return!1}}if(this.Ga.uZg){let Pb;if(!(()=>{let hc=P.vk(this.Ga.aZg);({value:Pb}=hc);return hc})().returnValue||!this.Ga.uZg.isMatch(Pb,ua))return!1}if(this.Ga.e9f){let Pb;if(!(()=>{let hc=P.vk(this.Ga.$Yg);({value:Pb}=hc);return hc})().returnValue||!this.Ga.e9f.isMatch(Pb,ua))return!1}return!0}}Object(n.a)(Lc,"TextSpanFilter",null,[637]);class Jd{constructor(P,ua){P&&(this.annotations=ua.annotations,this.aZg=P.pa(0),this.$Yg=P.pa(1),this.UZk=P.pa(2),this.Mwe=P.pa(3)?ua.T1(P.pa(3)):null,this.V6e=
P.pa(4)?ua.T1(P.pa(4)):null,this.uZg=P.pa(5)?ua.T1(P.pa(5)):null,this.e9f=P.pa(6)?ua.T1(P.pa(6)):null)}}Object(n.a)(Jd,"TextSpanFilterInit",null,[]);class Ab{constructor(P,ua){P&&(this.annotations=ua.annotations,this.n6=P.pa(0),this.uBe=P.pa(1)?ua.T1(P.pa(1)):null)}}Object(n.a)(Ab,"ValueFilterAnnotationFilterInit",null,[]);var Uc=a(967);class Od{T1(P,ua){const Xa=P.pa(0),Pb=new Uc.a;Pb.YFa(P,1,P.count-1);switch(Xa){case 1:return new Rf(new Mf(Pb,ua),0);case 2:return new Rf(new Mf(Pb,ua),1);case 3:return new Rf(new Mf(Pb,
ua),2);case 101:return new Ib(new Nb(Pb,ua));case 103:return new je(new Ie(Pb,ua),0);case 104:return new je(new Ie(Pb,ua),1);case 105:return new je(new Ie(Pb,ua),2);case 106:return new je(new Ie(Pb,ua),3);case 107:return new je(new Ie(Pb,ua),4);case 108:return new je(new Ie(Pb,ua),5);case 109:return new je(new Ie(Pb,ua),6);case 201:return new gf(new Qe(Pb));case 202:return new sb(new Af(Pb,ua));case 301:return new zf(new df(Pb,ua),0);case 302:return new zf(new df(Pb,ua),1);case 303:return new zf(new df(Pb,
ua),2);case 304:return new zf(new df(Pb,ua),3);case 305:return new zf(new df(Pb,ua),4);case 401:return new Aa(new Fb(Pb),0);case 402:return new Aa(new Fb(Pb),1);case 403:return new Aa(new Fb(Pb),2);case 404:return new Gc(new ad(Pb,ua),0);case 405:return new Gc(new ad(Pb,ua),1);case 406:return new Gc(new ad(Pb,ua),2);case 407:return new Gc(new ad(Pb,ua),3);case 501:return new Jf(new dg(Pb,ua));case 502:return new Je(new Af(Pb,ua));case 601:return new lf(new Bc(Pb,ua),0);case 602:return new lf(new Bc(Pb,
ua),1);case 603:return new Pf(new Bc(Pb,ua));case 604:return new Wd(new Af(Pb,ua),0);case 605:return new Wd(new Af(Pb,ua),1);case 606:return new Wd(new Af(Pb,ua),2);case 607:return new Wd(new Af(Pb,ua),3);case 701:return new uf(!1);case 702:return new uf(!0);case 703:return new tf(new Ab(Pb,ua),!1);case 704:return new tf(new Ab(Pb,ua),!0);case 705:return new Cf(new Ab(Pb,ua),!1);case 706:return new Cf(new Ab(Pb,ua),!0);case 707:return new Kf(new Vf(Pb,ua));case 901:return new Lc(new Jd(Pb,ua));case 1002:return new $e(new Af(Pb,
ua));case 1001:return new Eb(new oc(Pb,ua));default:throw Error.argument("initData");}}}Object(n.a)(Od,"FilterFactory",null,[619]);var le=a(939);class ge{constructor(P){this.Ga=P}get su(){return this.Ga.su}get uO(){return this.Ga.uO}get c0c(){return this.Ga.c0c}get hFc(){return this.Ga.hFc}load(P,ua){return this.am(P,P?new Bf("root",P,ua):ua)}store(P,ua,Xa){this.ovb(P,ua,P?new Bf("root",P,Xa):Xa,null)}am(P,ua){if(!this.hFc&&!this.Ga.annotations.Blb(this.su,P))throw Error.argument("input","Input value not of expected type");
let Xa=this.Ga.gCf;for(;Xa;)P=Xa.load(P,ua),Xa=Xa.next;return P}ovb(P,ua,Xa,Pb){if(!this.c0c)throw Error.invalidOperation("Attempt to store into query that supports only loading");if(!this.hFc&&!this.Ga.annotations.Blb(this.su,P))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.Ga.annotations.Blb(this.uO,ua))throw Error.argument("rvalue","Rvalue not of expected type");return this.Ga.gCf.store(P,ua,Xa,Pb)}static hgf(P,ua,Xa,Pb){if(Xa===Pb)return ua;if(Pe.Annotations.fy(Xa)&&Pe.Annotations.fy(Pb)){Xa=
Pe.Annotations.Fta(Xa);Pb=Pe.Annotations.Fta(Pb);const hc=new le.a(P,Pb);for(const Qc of ua.items)Array.add(hc.items,ge.hgf(P,Qc,Xa,Pb));return hc}if(Xa===Pe.Annotations.Ofa){if(Pb===Pe.Annotations.N4)return ua;if(Pb===Pe.Annotations.gS)return ua.toString()}else if(Xa===Pe.Annotations.N4){if(Pb===Pe.Annotations.Ofa)return Math.floor(ua);if(Pb===Pe.Annotations.gS)return ua.toString()}else if(Xa===Pe.Annotations.gS){if(Pb===Pe.Annotations.Ofa)return parseInt(ua);if(Pb===Pe.Annotations.N4)return parseFloat(ua)}throw Error.invalidOperation("Type conversion failure in query step");
}}Object(n.a)(ge,"AnnotationQuery",null,[636]);class ze{constructor(){this.uO=this.su=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}Hta(P){if(this.next)return{returnValue:this.next,Cfa:P};if(P){const ua=P.jif;P=P.wzg;return{returnValue:ua,Cfa:P}}return{returnValue:null,Cfa:P}}}Object(n.a)(ze,"AnnotationQueryStep",null,[647]);class Le extends ze{constructor(P){super();this.Ga=P}load(P,ua){ua=this.Ga.query.am(P,ua);if(Pe.Annotations.fy(this.su)){var Xa=Pe.Annotations.Fta(this.su);
let hc=new le.a(this.Ga.annotations,Xa);if(Pe.Annotations.fy(this.Ga.query.uO)){if(P.items.length!==ua.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let Qc=0,vd=P.items.length;Qc<vd;++Qc)Array.add(hc.items,this.Poc(P.items[Qc],ua.items[Qc],Xa===Pe.Annotations.N4))}else for(var Pb of P.items)Array.add(hc.items,this.Poc(Pb,ua,Xa===Pe.Annotations.N4));return hc}if(Pe.Annotations.fy(this.Ga.query.uO)){Pb=new le.a(this.Ga.annotations,this.su);for(Xa of ua.items)Array.add(Pb.items,
this.Poc(P,Xa,this.su===Pe.Annotations.N4));return Pb}return this.Poc(P,ua,this.su===Pe.Annotations.N4)}Poc(P,ua,Xa){P=this.Fdb(P,ua);return Xa?P:Math.floor(P)}}Object(n.a)(Le,"NumericAnnotationQueryStep",ze,[]);class nf extends Le{constructor(P){super(P)}Fdb(P,ua){return P+ua}}Object(n.a)(nf,"AddAnnotationQueryStep",Le,[]);class cf extends ze{constructor(P){super();this.Ga=P}load(P,ua){if(this.su===Pe.Annotations.n$&&this.Ga.query.uO===Pe.Annotations.n$){let hc;if((()=>{let Qc=this.jcf(P);({result:hc}=
Qc);return Qc})().returnValue)return hc}if(Pe.Annotations.fy(this.su)){var Xa=new le.a(this.Ga.annotations,Pe.Annotations.n$);ua=this.Ga.query.am(P,ua);if(Pe.Annotations.fy(this.Ga.query.uO)){if(P.items.length!==ua.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let hc=0,Qc=P.items.length;hc<Qc;++hc)Array.add(Xa.items,this.zJb(ua.items[hc],P.items[hc]))}else for(var Pb of P.items)Array.add(Xa.items,this.zJb(ua,Pb));return Xa}Pb=this.Ga.query.am(P,
ua);if(Pe.Annotations.fy(this.Ga.query.uO)){ua=new le.a(this.Ga.annotations,Pe.Annotations.n$);for(Xa of Pb.items)Array.add(ua.items,this.zJb(Xa,P));return ua}return this.zJb(Pb,P)}}Object(n.a)(cf,"BinaryBooleanAnnotationQueryStep",ze,[]);class Te extends cf{constructor(P){super(P)}jcf(P){return{returnValue:!P,result:!1}}zJb(P,ua){return P&&ua}}Object(n.a)(Te,"AndAnnotationQueryStep",cf,[]);class Wf{constructor(P){P&&(this.annotations=P)}}Object(n.a)(Wf,"AnnotationsOnlyQueryStepInit",null,[]);class Hf extends ze{constructor(P){super();
this.Ga=P}load(P,ua){ua=this.Ga.query.am(P,ua);P=P.clone();Pe.Annotations.fy(this.Ga.query.uO)?Array.addRange(P.items,ua.items):Array.add(P.items,ua);return P}}Object(n.a)(Hf,"AppendAnnotationQueryStep",ze,[]);class ib extends ze{constructor(P){super();this.Ga=P}load(P,ua){if(this.su===Pe.Annotations.QG)return this.executeScript(P,ua);const Xa=new le.a(this.Ga.annotations,Pe.Annotations.QG);for(const Pb of P.items)Array.add(Xa.items,this.executeScript(Pb,ua));return Xa}executeScript(P,ua){const Xa=
new wf.a(this.Ga.annotations);Xa.Ira(P);P=new wf.a(this.Ga.annotations);this.Ga.script.fja(null,new Bf("Input",Xa,new Bf("Output",P,ua)));return P}}Object(n.a)(ib,"ApplyAnnotationQueryStep",ze,[]);class xc extends ze{constructor(P){super();this.Ga=P}load(P,ua){if(this.su===Pe.Annotations.QG){let Pb=this.executeScript(P,ua);(()=>Pb.vk(this.Ga.T6e))().returnValue||new le.a(this.Ga.annotations,Pe.Annotations.QG);return Pb}const Xa=new le.a(this.Ga.annotations,Pe.Annotations.QG);for(const Pb of P.items){let hc=
this.executeScript(Pb,ua),Qc;if((()=>{let vd=hc.vk(this.Ga.T6e);({value:Qc}=vd);return vd})().returnValue)for(const vd of Qc.items)Array.add(Xa.items,vd)}return Xa}executeScript(P,ua){const Xa=new wf.a(this.Ga.annotations);Xa.Ira(P);P=new wf.a(this.Ga.annotations);this.Ga.script.fja(null,new Bf("Input",Xa,new Bf("Output",P,ua)));return P}}Object(n.a)(xc,"ApplyExpandAnnotationQueryStep",ze,[]);class Kc{constructor(P,ua){P&&(this.annotations=ua.annotations,this.script=ua.LWa(P.pa(0)),this.T6e=P.pa(1))}}
Object(n.a)(Kc,"ApplyExpandQueryStepInit",null,[]);class ra{constructor(P,ua){P&&(this.annotations=ua.annotations,this.script=ua.LWa(P.pa(0)))}}Object(n.a)(ra,"ApplyQueryStepInit",null,[]);class jb extends ze{constructor(P){super();this.Ga=P}load(P){if(this.su===Pe.Annotations.QG)return this.uKc(P);const ua=new le.a(this.Ga.annotations,this.Ga.annotations.getAttributeType(this.Ga.n6));for(const Xa of P.items)Array.add(ua.items,this.uKc(Xa));return ua}store(P,ua,Xa,Pb){if(this.su===Pe.Annotations.QG){var hc=
ua,Qc=(()=>{let Nd=this.Hta(Pb);({Cfa:Pb}=Nd);return Nd})().returnValue;Qc&&(hc=Qc.store(Pe.Annotations.yF(this.uKc(P)),ua,Xa,Pb));P.iq(this.Ga.n6,hc)}else{var vd=ua;if(hc=(()=>{let Nd=this.Hta(Pb);({Cfa:Pb}=Nd);return Nd})().returnValue){vd=new le.a(this.Ga.annotations,this.Ga.annotations.getAttributeType(this.Ga.n6));for(Qc of P.items)Array.add(vd.items,this.uKc(Qc));vd=hc.store(vd,ua,Xa,Pb)}ua=vd;if(ua.items.length!==P.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");
for(let Nd=0,ke=P.items.length;Nd<ke;++Nd)Xa=P.items[Nd],Xa.isReadOnly&&(Xa=Xa.clone(),P.items[Nd]=Xa),Xa.iq(this.Ga.n6,ua.items[Nd])}return P}uKc(P){let ua;(()=>{let Xa=P.vk(this.Ga.n6);({value:ua}=Xa);return Xa})().returnValue||(ua=this.Ga.annotations.XJi(this.Ga.n6));return ua}}Object(n.a)(jb,"AttrAnnotationQueryStep",ze,[]);class vc{constructor(P,ua){P&&(this.annotations=ua,this.n6=P.pa(0))}}Object(n.a)(vc,"AttrQueryStepInit",null,[]);class md extends ze{constructor(P){super();this.Ga=P}load(P){const ua=
new wf.a(this.Ga.annotations);ua.Ira(P);return this.Ga.module.execute(ua)}}Object(n.a)(md,"CallModuleAnnotationQueryStep",ze,[]);class Qd{constructor(P,ua){P&&(this.annotations=ua.annotations,this.module=ua.NMd(P.pa(0)))}}Object(n.a)(Qd,"CallModuleQueryStepInit",null,[]);class v extends ze{constructor(P){super();this.Ga=P}load(P,ua){if(Pe.Annotations.fy(this.su)){var Xa=this.Ga.query.am(P,ua);ua=new le.a(this.Ga.annotations,Pe.Annotations.gS);let Qc="string"===typeof Xa;for(var Pb of P.items)if(Qc)Array.add(ua.items,
Pb+Xa);else for(var hc of Xa.items)Array.add(ua.items,Pb+hc);return ua}Pb=this.Ga.query.am(P,ua);if("string"===typeof Pb)return P+Pb;hc=new le.a(this.Ga.annotations,Pe.Annotations.gS);for(Xa of Pb.items)Array.add(hc.items,P+Xa);return hc}}Object(n.a)(v,"ConcatAnnotationQueryStep",ze,[]);class Qb extends ze{constructor(P){super();this.Ga=P}load(P){return ge.hgf(this.Ga.annotations,P,this.su,this.uO)}}Object(n.a)(Qb,"ConvertAnnotationQueryStep",ze,[]);class Dc extends ze{constructor(){super()}load(P){return P.items.length}}
Object(n.a)(Dc,"CountAnnotationQueryStep",ze,[]);class id extends Le{constructor(P){super(P)}Fdb(P,ua){return P/ua}}Object(n.a)(id,"DivideAnnotationQueryStep",Le,[]);class Md extends ze{constructor(P){super();this.Ga=P}load(P,ua){ua=new Bf(this.Ga.c4c,null,ua);for(const Xa of P.items)if(ua.Mud(Xa),this.Ga.query.am(Xa,ua))return!0;return!1}}Object(n.a)(Md,"ExistsAnnotationQueryStep",ze,[]);class Sd extends Le{constructor(P){super(P)}Fdb(P,ua){return Math.pow(P,ua)}}Object(n.a)(Sd,"ExpAnnotationQueryStep",
Le,[]);class ne{constructor(P,ua){P&&(this.jja=ua.ia(P.pa(0)))}}Object(n.a)(ne,"FeatureBundleNameQueryStepInit",null,[]);class Ce extends ze{constructor(P){super();this.Ga=P}load(P){if(Pe.Annotations.fy(this.su)){const ua=new le.a(this.Ga.annotations,this.Ga.annotations.JXa(Pe.Annotations.Fta(this.su),this.Ga.fieldIndex));for(const Xa of P.items)Array.add(ua.items,Xa.sGa(this.Ga.fieldIndex));return ua}return P.sGa(this.Ga.fieldIndex)}store(P,ua,Xa,Pb){if(Pe.Annotations.fy(this.su)){var hc=ua,Qc=(()=>
{let Nd=this.Hta(Pb);({Cfa:Pb}=Nd);return Nd})().returnValue;if(Qc){hc=new le.a(this.Ga.annotations,this.Ga.annotations.JXa(Pe.Annotations.Fta(this.su),this.Ga.fieldIndex));for(var vd of P.items)Array.add(hc.items,vd.sGa(this.Ga.fieldIndex));hc=Qc.store(hc,ua,Xa,Pb)}ua=hc;if(ua.items.length!==P.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");for(let Nd=0,ke=P.items.length;Nd<ke;++Nd)Xa=P.items[Nd],Xa.isReadOnly&&(Xa=Xa.clone(),P.items[Nd]=Xa),Xa.Yoe(this.Ga.fieldIndex,
ua.items[Nd])}else Qc=ua,(vd=(()=>{let Nd=this.Hta(Pb);({Cfa:Pb}=Nd);return Nd})().returnValue)&&(Qc=vd.store(Pe.Annotations.yF(P.sGa(this.Ga.fieldIndex)),ua,Xa,Pb)),P.Yoe(this.Ga.fieldIndex,Qc);return P}}Object(n.a)(Ce,"FieldAnnotationQueryStep",ze,[]);class Ge{constructor(P,ua){P&&(this.annotations=ua,this.fieldIndex=P.pa(0))}}Object(n.a)(Ge,"FieldQueryStepInit",null,[]);class Ee extends ze{constructor(P){super();this.Ga=P}load(P,ua){for(const Xa of P.items)if(this.Ga.filter.isMatch(Xa,ua))return Xa;
throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(P,ua,Xa,Pb){let hc=ua,Qc=-1;for(let Nd=0,ke=P.items.length;Nd<ke;Nd++)if(this.Ga.filter.isMatch(P.items[Nd],Xa)){Qc=Nd;break}if(0>Qc)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const vd=(()=>{let Nd=this.Hta(Pb);({Cfa:Pb}=Nd);return Nd})().returnValue;vd&&(hc=vd.store(Pe.Annotations.yF(P.items[Qc]),ua,Xa,Pb));P.items[Qc]=hc;return P}}Object(n.a)(Ee,"FirstItemMatchingAnnotationQueryStep",
ze,[]);class Ue extends ze{constructor(P){super();this.Ga=P}load(P,ua){ua=new Bf(this.Ga.c4c,null,ua);for(const Xa of P.items)if(ua.Mud(Xa),!this.Ga.query.am(Xa,ua))return!1;return!0}}Object(n.a)(Ue,"ForAllAnnotationQueryStep",ze,[]);class We extends ze{constructor(P){super();this.Ga=P}load(P,ua){P=ua?ua.Gzc(this.Ga.jja):null;if(!P)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ga.jja+'"');return P}store(P,ua,Xa,Pb){P=Xa?Xa.Gzc(this.Ga.jja):null;if(!P)throw Error.invalidOperation('Feature bundle resolution failure: "'+
this.Ga.jja+'"');let hc=ua;const Qc=(()=>{let vd=this.Hta(Pb);({Cfa:Pb}=vd);return vd})().returnValue;Qc&&(hc=Qc.store(P,ua,Xa,Pb));P!==hc&&P.Ira(hc);return P}}Object(n.a)(We,"GetAnnotationQueryStep",ze,[]);class ya{constructor(P,ua){this.blh=P;this.tsh=ua}get jif(){return this.blh}get wzg(){return this.tsh}}Object(n.a)(ya,"AnnotationQueryStoreContinuation",null,[654]);class Cb extends ze{constructor(P){super();this.Ga=P}load(P,ua){return this.Ga.L0c.am(P,ua)?this.Ga.o4g.am(P,ua):this.Ga.Mwc?this.Ga.Mwc.am(P,
ua):P}store(P,ua,Xa,Pb){var hc=this.Ga.L0c.am(P,Xa);this.next&&(Pb=new ya(this.next,Pb));if(hc)return this.Ga.o4g.ovb(P,ua,Xa,Pb);if(this.Ga.Mwc)return this.Ga.Mwc.ovb(P,ua,Xa,Pb);hc=ua;let Qc=null;Pb&&(Qc=Pb.jif,Pb=Pb.wzg);Qc&&(hc=Qc.store(Pe.Annotations.yF(P),ua,Xa,Pb));return hc}}Object(n.a)(Cb,"IfAnnotationQueryStep",ze,[]);class qa{constructor(P,ua){P&&(this.L0c=ua.Cz(P.pa(0)),this.o4g=ua.Cz(P.pa(1)),this.Mwc=P.pa(2)?ua.Cz(P.pa(2)):null)}}Object(n.a)(qa,"IfQueryStepInit",null,[]);class qb{constructor(P,
ua){P&&(this.Xej=ua.Cz(P.pa(0)),this.K6f=ua.Cz(P.pa(1)))}}Object(n.a)(qb,"IndexAndItemQueryStepInit",null,[]);class bc extends ze{constructor(P){super();this.Ga=P}load(P,ua){const Xa=this.Ga.Xej.am(P,ua);ua=this.Ga.K6f.am(P,ua);P=P.clone();if(0>Xa||Xa>P.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(Pe.Annotations.fy(this.Ga.K6f.uO))for(let Pb=0;Pb<ua.items.length;++Pb)Array.insert(P.items,Xa+Pb,ua.items[Pb]);else Array.insert(P.items,Xa,ua);return P}}
Object(n.a)(bc,"InsertAtAnnotationQueryStep",ze,[]);class R extends ze{constructor(P){super();this.Ga=P}load(P,ua){return!(!ua||!ua.Gzc(this.Ga.jja))}}Object(n.a)(R,"IsDefinedAnnotationQueryStep",ze,[]);class cb extends ze{constructor(P){super();this.Ga=P}load(P,ua){ua=this.RPb(P,ua);return P.items[ua]}store(P,ua,Xa,Pb){const hc=this.RPb(P,Xa);let Qc=ua;const vd=(()=>{let Nd=this.Hta(Pb);({Cfa:Pb}=Nd);return Nd})().returnValue;vd&&(Qc=vd.store(Pe.Annotations.yF(P.items[hc]),ua,Xa,Pb));P.items[hc]=
Qc;return P}RPb(P,ua){ua=this.Ga.query.am(P,ua);if(0>ua||ua>=P.items.length)throw Error.invalidOperation("Index out of range in Item store step");return ua}}Object(n.a)(cb,"ItemAnnotationQueryStep",ze,[]);class zb extends ze{constructor(P){super();this.Ga=P}load(P,ua){const Xa=new le.a(this.Ga.annotations,Pe.Annotations.Fta(this.su));for(const Pb of P.items)this.Ga.filter.isMatch(Pb,ua)&&Array.add(Xa.items,Pb);return Xa}}Object(n.a)(zb,"ItemsMatchingAnnotationQueryStep",ze,[]);class V extends ze{constructor(P){super();
this.Ga=P}load(P,ua){ua=this.RPb(P,ua);return P.items[P.items.length-ua-1]}store(P,ua,Xa,Pb){const hc=this.RPb(P,Xa);let Qc=ua;const vd=(()=>{let Nd=this.Hta(Pb);({Cfa:Pb}=Nd);return Nd})().returnValue;vd&&(Qc=vd.store(Pe.Annotations.yF(P.items[P.items.length-hc-1]),ua,Xa,Pb));P.items[P.items.length-hc-1]=Qc;return P}RPb(P,ua){ua=this.Ga.query?this.Ga.query.am(P,ua):0;if(0>ua||ua>=P.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");return ua}}Object(n.a)(V,"LastItemAnnotationQueryStep",
ze,[]);class Ea extends ze{constructor(P){super();this.Ga=P}load(P){if(Pe.Annotations.fy(this.su)){const ua=new le.a(this.Ga.annotations,Pe.Annotations.Ofa);for(const Xa of P.items)Array.add(ua.items,Xa.length);return ua}return P.length}}Object(n.a)(Ea,"LengthAnnotationQueryStep",ze,[]);class pb extends ze{constructor(P){super();this.Ga=P}load(P,ua){if(Pe.Annotations.fy(this.su)){const Xa=new le.a(this.Ga.annotations,Pe.Annotations.n$);for(const Pb of P.items)Array.add(Xa.items,this.Ga.filter.isMatch(Pb,
ua));return Xa}return this.Ga.filter.isMatch(P,ua)}}Object(n.a)(pb,"MatchesAnnotationQueryStep",ze,[]);class Jb extends ze{constructor(P){super();this.Ga=P}load(P,ua){return this.Ga.filter.isMatch(P,ua)}}Object(n.a)(Jb,"MatchesAsListAnnotationQueryStep",ze,[]);class zc extends Le{constructor(P){super(P)}Fdb(P,ua){return P%ua}}Object(n.a)(zc,"ModuloAnnotationQueryStep",Le,[]);class Mc extends Le{constructor(P){super(P)}Fdb(P,ua){return P*ua}}Object(n.a)(Mc,"MultiplyAnnotationQueryStep",Le,[]);class od extends ze{constructor(P){super();
this.Ga=P}load(P){if(Pe.Annotations.fy(this.su)){const ua=new le.a(this.Ga.annotations,Pe.Annotations.n$);for(const Xa of P.items)Array.add(ua.items,!Xa);return ua}return!P}}Object(n.a)(od,"NotAnnotationQueryStep",ze,[]);class Td extends cf{constructor(P){super(P)}jcf(P){return{returnValue:P,result:!0}}zJb(P,ua){return P||ua}}Object(n.a)(Td,"OrAnnotationQueryStep",cf,[]);class Zd extends ze{constructor(P){super();this.Ga=P}load(P,ua){const Xa=this.Ga.Sue.am(P,ua);P=this.Ga.ZJb.am(P,ua);ua=new le.a(this.Ga.annotations,
Pe.Annotations.Ofa);for(let Pb=0;Pb<P;++Pb)Array.add(ua.items,Xa+Pb);return ua}}Object(n.a)(Zd,"RangeAnnotationQueryStep",ze,[]);class xe{constructor(P,ua){P&&(this.annotations=ua.annotations,this.filter=ua.T1(P.pa(0)))}}Object(n.a)(xe,"SingleFilterQueryStepInit",null,[]);class pe{constructor(P,ua){P&&(this.annotations=ua.annotations,this.query=P.pa(0)?ua.Cz(P.pa(0)):null)}}Object(n.a)(pe,"SingleOptionalQueryQueryStepInit",null,[]);class Re{constructor(P,ua){P&&(this.annotations=ua.annotations,this.query=
ua.Cz(P.pa(0)))}}Object(n.a)(Re,"SingleQueryQueryStepInit",null,[]);class pf{constructor(P,ua){P&&(this.annotations=ua.annotations,this.Sue=ua.Cz(P.pa(0)),this.ZJb=P.pa(1)?ua.Cz(P.pa(1)):null)}}Object(n.a)(pf,"StartAndCountOrLengthQueryStepInit",null,[]);class vf extends ze{constructor(P){super();this.Ga=P}load(P,ua){let Xa;({startIndex:ua,length:Xa}=this.mBc(P,ua));const Pb=new le.a(this.Ga.annotations,P.XN);for(let hc=0;hc<Xa;++hc)Array.add(Pb.items,P.items[ua+hc]);return Pb}store(P,ua,Xa,Pb){let hc,
Qc;({startIndex:hc,length:Qc}=this.mBc(P,Xa));var vd=ua;const Nd=(()=>{let ke=this.Hta(Pb);({Cfa:Pb}=ke);return ke})().returnValue;if(Nd){vd=new le.a(this.Ga.annotations,P.XN);for(let ke=0;ke<Qc;++ke)Array.add(vd.items,P.items[hc+ke]);vd=Nd.store(vd,ua,Xa,Pb)}ua=vd;for(Xa=0;Xa<Qc;++Xa)Array.removeAt(P.items,hc);for(let ke=0,Be=ua.items.length;ke<Be;++ke)Array.insert(P.items,hc+ke,ua.items[ke]);return P}mBc(P,ua){let Xa;Xa=this.Ga.Sue.am(P,ua);if(0>Xa)throw Error.invalidOperation("Invalid start index in Sublist() query step");
ua=this.Ga.ZJb?this.Ga.ZJb.am(P,ua):P.items.length-Xa;if(0>ua||Xa+ua>P.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{startIndex:Xa,length:ua}}}Object(n.a)(vf,"SublistAnnotationQueryStep",ze,[]);class Qf extends ze{constructor(P){super();this.Ga=P}load(P,ua){if(Pe.Annotations.fy(this.su)){const Xa=new le.a(this.Ga.annotations,Pe.Annotations.gS);for(let Pb=0,hc=P.items.length;Pb<hc;++Pb)Array.add(Xa.items,this.mOf(P.items[Pb],ua));return Xa}return this.mOf(P,
ua)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}mOf(P,ua){let Xa;({startIndex:ua,length:Xa}=this.mBc(P,ua));return P.substr(ua,Xa)}mBc(P,ua){let Xa;Xa=this.Ga.Sue.am(P,ua);if(0>Xa)throw Error.invalidOperation("Invalid start index in Substring() query step");ua=this.Ga.ZJb?this.Ga.ZJb.am(P,ua):P.length-Xa;if(0>ua||Xa+ua>P.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{startIndex:Xa,length:ua}}}
Object(n.a)(Qf,"SubstringAnnotationQueryStep",ze,[]);class yf extends Le{constructor(P){super(P)}Fdb(P,ua){return P-ua}}Object(n.a)(yf,"SubtractAnnotationQueryStep",Le,[]);class Df extends ze{constructor(P){super();this.Ga=P}load(P){const ua=new le.a(this.Ga.annotations,Pe.Annotations.gS);for(let Xa=0;Xa<P.length;++Xa)Array.add(ua.items,P.charAt(Xa).toString());return ua}}Object(n.a)(Df,"ToCharListAnnotationQueryStep",ze,[]);class pg extends ze{constructor(P){super();this.Ga=P}load(P){const ua=new le.a(this.Ga.annotations,
this.su);Array.add(ua.items,P);return ua}}Object(n.a)(pg,"ToListAnnotationQueryStep",ze,[]);class Zf extends ze{constructor(P){super();this.Ga=P}load(){return this.Ga.value}}Object(n.a)(Zf,"ValueAnnotationQueryStep",ze,[]);class Tg{constructor(P,ua){if(P){var Xa=P.pa(0);P=ua.gVa(Xa,P,1,null,null,null);this.value=P.returnValue;Pe.Annotations.H0a(this.value)}}}Object(n.a)(Tg,"ValueQueryStepInit",null,[]);class Wg{constructor(P,ua){P&&(this.c4c=ua.ia(P.pa(0)),this.query=ua.Cz(P.pa(1)))}}Object(n.a)(Wg,
"VarNameAndQueryQueryStepInit",null,[]);class ph{constructor(P,ua){this.iMe=null;if(P){this.annotations=ua.annotations;var Xa=0;this.su=P.pa(Xa);++Xa;this.uO=P.pa(Xa);++Xa;this.c0c=1===P.pa(Xa);++Xa;this.hFc=1===P.pa(Xa);++Xa;var Pb=P.pa(Xa);++Xa;if(Pb){var hc=Xa,Qc=Xa+Pb,vd=Xa+2*Pb;Xa+=3*Pb;var Nd=P.count-Xa,ke=null;for(let Ze=0;Ze<Pb;++Ze){var Be=Xa+P.pa(vd+Ze);const of=(Ze===Pb-1?Nd:P.pa(vd+Ze+1))-P.pa(vd+Ze),Xf=new Uc.a;Xf.YFa(P,Be,of);Be=ph.eWi(P.pa(Qc+Ze),Xf,ua);Be.su=P.pa(hc+Ze);Be.uO=Ze===
Pb-1?this.uO:P.pa(hc+Ze+1);ke?ke.next=Be:this.iMe=Be;ke=Be}}}}get gCf(){return this.iMe}static eWi(P,ua,Xa){switch(P){case 1:return new We(new ne(ua,Xa));case 2:return new R(new ne(ua,Xa));case 3:return new jb(new vc(ua,Xa.annotations));case 4:return new Ce(new Ge(ua,Xa.annotations));case 5:return new Cb(new qa(ua,Xa));case 6:return new pb(new xe(ua,Xa));case 43:return new Jb(new xe(ua,Xa));case 45:return new ib(new ra(ua,Xa));case 49:return new xc(new Kc(ua,Xa));case 46:return new Zf(new Tg(ua,Xa.annotations));
case 51:return new md(new Qd(ua,Xa));case 52:return new Zd(new pf(ua,Xa));case 53:return new Qb(new Wf(Xa.annotations));case 13:return new cb(new Re(ua,Xa));case 14:return new V(new pe(ua,Xa));case 15:return new Dc;case 18:return new Ee(new xe(ua,Xa));case 16:return new Ue(new Wg(ua,Xa));case 17:return new Md(new Wg(ua,Xa));case 22:return new bc(new qb(ua,Xa));case 24:return new Hf(new Re(ua,Xa));case 26:return new vf(new pf(ua,Xa));case 27:return new zb(new xe(ua,Xa));case 30:return new pg(new Wf(Xa.annotations));
case 31:return new Qf(new pf(ua,Xa));case 32:return new v(new Re(ua,Xa));case 47:return new Ea(new Wf(Xa.annotations));case 48:return new Df(new Wf(Xa.annotations));case 34:return new nf(new Re(ua,Xa));case 35:return new yf(new Re(ua,Xa));case 36:return new Mc(new Re(ua,Xa));case 37:return new id(new Re(ua,Xa));case 38:return new zc(new Re(ua,Xa));case 39:return new Sd(new Re(ua,Xa));case 40:return new Te(new Re(ua,Xa));case 41:return new Td(new Re(ua,Xa));case 42:return new od(new Wf(Xa.annotations));
default:throw Error.argument("currStepInitData");}}}Object(n.a)(ph,"AnnotationQueryInit",null,[]);class Ug{constructor(P){this.Ga=P}execute(P,ua){this.fja(P,P?new Bf("root",P,ua):ua)}fja(P,ua){for(const Xa of this.Ga.commands)ua=Xa.execute(P,ua)}}Object(n.a)(Ug,"AnnotationScript",null,[635]);class fh{constructor(P){this.Ga=P}execute(P,ua){const Xa=this.Ga.Djj.am(P,ua),Pb=this.Ga.r9j.am(P,ua);this.Ga.script.fja(P,new Bf("Input",Xa,new Bf("Output",Pb,ua)));return ua}}Object(n.a)(fh,"ApplyAnnotationScriptCommand",
null,[644]);class rg{constructor(P,ua){P&&(this.Djj=ua.Cz(P.pa(0)),this.r9j=ua.Cz(P.pa(1)),this.script=ua.LWa(P.pa(2)))}}Object(n.a)(rg,"ApplyScriptCommandInit",null,[]);class jh{constructor(P){this.Ga=P}execute(P,ua){const Xa=this.Ga.hme.am(P,ua);this.Ga.WKc.ovb(P,Xa,ua,null);return ua}}Object(n.a)(jh,"AssignAnnotationScriptCommand",null,[644]);class zh{constructor(P){this.Ga=P}execute(P,ua){const Xa=this.Ga.WKc.am(P,ua);P=this.Ga.hme.am(P,ua);Xa!==P&&Xa.Ira(P);return ua}}Object(n.a)(zh,"CopyAnnotationScriptCommand",
null,[644]);class zg{constructor(P){this.Ga=P}execute(P,ua){let Xa=this.Ga.k2d.am(P,ua);if(this.Ga.k2d.c0c){Xa=Pe.Annotations.yF(Xa);var Pb=new Bf(this.Ga.jja,null,ua);for(let hc=0,Qc=Xa.items.length;hc<Qc;++hc){const vd=this.xzf(P,Xa.items[hc],Pb);if(0>this.Ga.pVc)Xa.items[hc]=vd;else{let Nd;if((()=>{let ke=vd.vk(this.Ga.pVc);({value:Nd}=ke);return ke})().returnValue)Xa.items[hc]=Nd;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");}}this.Ga.k2d.ovb(P,
Xa,ua,null)}else{Pb=new Bf(this.Ga.jja,null,ua);for(let hc=0,Qc=Xa.items.length;hc<Qc;++hc)this.xzf(P,Xa.items[hc],Pb)}return ua}xzf(P,ua,Xa){let Pb;0>this.Ga.pVc?Pb=Pe.Annotations.yF(ua):(Pb=new wf.a(this.Ga.annotations),Pb.iq(this.Ga.pVc,ua));Xa.Mud(Pb);this.Ga.MOh.fja(P,Xa);return Pb}}Object(n.a)(zg,"EnumerateAnnotationScriptCommand",null,[644]);class Zg{constructor(P,ua){P&&(this.annotations=ua.annotations,this.jja=ua.ia(P.pa(0)),this.k2d=ua.Cz(P.pa(1)),this.MOh=ua.LWa(P.pa(2)),this.pVc=P.pa(3))}}
Object(n.a)(Zg,"EnumerateScriptCommandInit",null,[]);class ab{constructor(P){this.Ga=P}execute(P,ua){this.Ga.L0c.am(P,ua)?this.Ga.P8k.fja(P,ua):this.Ga.DAf&&this.Ga.DAf.fja(P,ua);return ua}}Object(n.a)(ab,"IfAnnotationScriptCommand",null,[644]);class Ua{constructor(P,ua){P&&(this.L0c=ua.Cz(P.pa(0)),this.P8k=ua.LWa(P.pa(1)),this.DAf=P.pa(2)?ua.LWa(P.pa(2)):null)}}Object(n.a)(Ua,"IfScriptCommandInit",null,[]);class hd{constructor(P,ua){P&&(this.annotations=ua.annotations,this.WKc=ua.Cz(P.pa(0)),this.hme=
ua.Cz(P.pa(1)))}}Object(n.a)(hd,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class qe{constructor(P){this.Ga=P}execute(P,ua){const Xa=this.Ga.hme.am(this.Ga.WKc.am(P,ua),ua);this.Ga.WKc.ovb(P,Xa,ua,null);return ua}}Object(n.a)(qe,"ModifyAnnotationScriptCommand",null,[644]);class Ae{constructor(P){this.Ga=P}execute(P,ua){const Xa=new wf.a(this.Ga.annotations);this.Ga.query&&Xa.Ira(this.Ga.query.am(P,ua));return ua=new Bf(this.Ga.jja,Xa,ua)}}Object(n.a)(Ae,"NewAnnotationScriptCommand",null,[644]);
class ef{constructor(P,ua){P&&(this.annotations=ua.annotations,this.jja=ua.ia(P.pa(0)),this.query=P.pa(1)?ua.Cz(P.pa(1)):null)}}Object(n.a)(ef,"NewScriptCommandInit",null,[]);class Tf{constructor(P){this.Ga=P}execute(P,ua){P=this.Ga.query.am(P,ua);if(this.Ga.query.uO===Pe.Annotations.QG)P.Yrb(this.Ga.n6);else for(const Xa of P.items)Xa.Yrb(this.Ga.n6);return ua}}Object(n.a)(Tf,"RemoveAnnotationScriptCommand",null,[644]);class Nf{constructor(P,ua){P&&(this.annotations=ua.annotations,this.query=ua.Cz(P.pa(0)),
this.n6=P.pa(1))}}Object(n.a)(Nf,"RemoveScriptCommandInit",null,[]);class wg{constructor(P,ua){if(P){var Xa=0,Pb=P.pa(Xa);++Xa;if(Pb){var hc=Xa,Qc=Xa+Pb;Xa+=2*Pb;var vd=P.count-Xa;this.commands=Array(Pb);for(let Nd=0;Nd<Pb;++Nd){const ke=Xa+P.pa(Qc+Nd),Be=(Nd===Pb-1?vd:P.pa(Qc+Nd+1))-P.pa(Qc+Nd),Ze=new Uc.a;Ze.YFa(P,ke,Be);this.commands[Nd]=wg.bWi(P.pa(hc+Nd),Ze,ua)}}}}static bWi(P,ua,Xa){switch(P){case 1:return new jh(new hd(ua,Xa));case 2:return new qe(new hd(ua,Xa));case 3:return new Tf(new Nf(ua,
Xa));case 6:return new Ae(new ef(ua,Xa));case 7:return new zg(new Zg(ua,Xa));case 8:return new ab(new Ua(ua,Xa));case 9:return new zh(new hd(ua,Xa));case 10:return new fh(new rg(ua,Xa));default:throw Error.argument("initData");}}}Object(n.a)(wg,"AnnotationScriptInit",null,[]);var Uf=a(1197);class lg{constructor(P){this.ml=P;this.aH=0}vR(){const P=this.ml.fq(this.aH,4);this.aH+=4;return P}get array(){return this.ml}get offset(){return this.aH}set offset(P){this.aH=P}}Object(n.a)(lg,"ByteArrayReader",
null,[]);class Kg{constructor(){this.My=null;this.Gcg=this.KU=0}pa(P){if(0>P||P>=this.KU)throw Error.argumentOutOfRange("index");return this.My.fq(this.Gcg+4*P,4)}get count(){return this.KU}static V7h(P,ua,Xa){const Pb=new Kg;Pb.My=P;Pb.Gcg=ua;Pb.KU=Xa;return Pb}}Object(n.a)(Kg,"ReadOnlyListOverByteArray",null,[630]);class If{constructor(P,ua){this.ucg=this.tcg=!1;this.mo=this.gla=this.T3d=this.xcg=null;try{this.mo=ua.annotations;const Xa=ua.iGa(P.pa(0)),Pb=new lg(Xa);if(-914743053!==Pb.vR())throw Error.argument("Input does not represent a flat lexicon");
this.tcg=1===Pb.vR();this.ucg=1===Pb.vR();const hc=Pb.vR();Pb.offset+=hc;const Qc=Pb.vR();this.T3d=If.y$j(Pb,Qc,this.mo);const vd=Pb.vR();this.xcg=If.E$j(Pb,vd);const Nd=Pb.vR();this.gla=new Uf.a(Pb.array,Pb.offset);Pb.offset+=Nd}catch(Xa){throw Error.argument("initData");}}get trie(){return this.gla}GLi(P){return"i"===P&&this.ucg?"\u0130":P.toUpperCase()}XUd(){return this.tcg}wJi(P){let ua;ua=new le.a(this.mo,Pe.Annotations.QG);if(1!==P)if(0===P)P=new wf.a(this.mo),Array.add(ua.items,P);else if(P&
1073741824){P=this.xcg[P&-1073741825];for(let Pb=0;Pb<P.length;++Pb){var Xa=P[Pb];Xa=0===Xa?new wf.a(this.mo):this.T3d[Xa-2];Array.add(ua.items,Xa)}}else Array.add(ua.items,this.T3d[P-2]);return{returnValue:!0,rCj:ua}}static y$j(P,ua,Xa){if(ua%4)throw Error.argument("reader");const Pb=Kg.V7h(P.array,P.offset,ua/4);P.offset+=ua;P=[];for(ua=0;ua<Pb.count;){let hc=Xa.gVa(Pe.Annotations.QG,Pb,ua,null,null,null);({g2:ua}=hc);Array.add(P,hc.returnValue)}return P}static E$j(P,ua){ua=P.offset+ua;const Xa=
[];for(;P.offset<ua;){const Pb=P.vR(),hc=Array(Pb);for(let Qc=0;Qc<Pb;++Qc){const vd=P.vR();hc[Qc]=vd}Array.add(Xa,hc)}return Xa}}Object(n.a)(If,"RawFlatLexicon",null,[634]);var hg=a(1173),gh=a(1174);class mc{constructor(P){if(null==P)throw Error.argumentNull("base64String");const ua=P.length;if(ua%4)throw Error.argument("base64String's length must be a multiple of 4");this.KU=.75*ua;this.T0a=Array(Math.ceil(this.KU/4));P.endsWith("==")?this.KU-=2:P.endsWith("=")&&--this.KU;let Xa=0;for(let Pb=0;Pb<
ua;Pb+=4){const hc=mc.TVc[P.charCodeAt(Pb)-43]<<18|mc.TVc[P.charCodeAt(Pb+1)-43]<<12|mc.TVc[P.charCodeAt(Pb+2)-43]<<6|mc.TVc[P.charCodeAt(Pb+3)-43];let Qc=hc>>16&255;this.T0a[Math.floor(Xa/4)]|=Qc<<Xa%4*8;++Xa;Qc=hc>>8&255;this.T0a[Math.floor(Xa/4)]|=Qc<<Xa%4*8;++Xa;Qc=hc&255;this.T0a[Math.floor(Xa/4)]|=Qc<<Xa%4*8;++Xa}}get length(){return this.KU}pa(P){if(0>P||P>=this.KU)throw Error.argumentOutOfRange("i");return this.jGf(P)}fq(P,ua){if(0>P||0>ua||P+ua>this.KU)throw Error.argument("Bad range");let Xa=
0;for(let Pb=0;Pb<ua;++Pb)Xa|=this.jGf(P+Pb)<<8*Pb;return Xa}alk(P,ua){let Xa=0,Pb=0,hc=Math.floor(P/8);for(P%=8;Pb<ua;){const Qc=8-P>ua-Pb?ua-Pb:8-P,vd=this.pa(hc);Xa|=(vd>>P&~(255<<Qc))<<Pb;Pb+=Qc;++hc;P=0}return Xa}jGf(P){return this.T0a[Math.floor(P/4)]>>P%4*8&255}}mc.TVc=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(n.a)(mc,
"ByteArray",null,[]);class sd{constructor(P,ua,Xa){this.vu=P;this.qIj=ua;this.zIj=Xa;this.Ocg=Array(P.b?P.b.length:0);this.D4d=new hg.a(new gh.a(this.iGa(this.vu.s)));this.aR=Array(P.t.length);this.Sih=new Pe.Annotations(this.eGa(0),this)}get annotations(){return this.Sih}get uji(){return this.vu.d}vVi(){if(!(""in this.vu.m))throw Error.argument("name","Unrecognized module");return this.NMd(this.vu.m[""])}iGa(P){if(0>P||!this.vu.b||P>=this.vu.b.length)throw Error.argumentOutOfRange("byteArrayID");
return this.Ocg[P]||(this.Ocg[P]=new mc(this.vu.b[P]))}ia(P){if(1>P||P>=this.vu.t.length)throw Error.argumentOutOfRange("blobID");if(1!==this.vu.t[P])throw Error.argument("blobID","Requested blob is not a string");if(null==this.aR[P]){const ua=this.eGa(P).pa(0);this.aR[P]=this.D4d.ia(ua)}return this.aR[P]}LMf(P){if(1>P||P>=this.vu.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.vu.t[P])throw Error.argument("blobID","Requested blob is not a Regex");if(!this.aR[P]){var ua=this.eGa(P);
const Xa=this.ia(ua.pa(0));ua=1===ua.pa(1);this.aR[P]=new RegExp(Xa,ua?"i":"")}return this.aR[P]}O_i(P){if(1>P||P>=this.vu.t.length)throw Error.argumentOutOfRange("blobID");if(3!==this.vu.t[P])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}NMd(P){if(1>P||P>=this.vu.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.vu.t[P])throw Error.argument("blobID","Requested blob is not an NL module");return this.aR[P]||(this.aR[P]=this.zIj.PVi(this.eGa(P),
this))}Cz(P){if(1>P||P>=this.vu.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.vu.t[P])throw Error.argument("blobID","Requested blob is not an annotation query");return this.aR[P]||(this.aR[P]=new ge(new ph(this.eGa(P),this)))}LWa(P){if(1>P||P>=this.vu.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.vu.t[P])throw Error.argument("blobID","Requested blob is not an annotation script");return this.aR[P]||(this.aR[P]=new Ug(new wg(this.eGa(P),this)))}T1(P){if(1>P||P>=this.vu.t.length)throw Error.argumentOutOfRange("blobID");
if(7!==this.vu.t[P])throw Error.argument("blobID","Requested blob is not a filter");return this.aR[P]||(this.aR[P]=this.qIj.T1(this.eGa(P),this))}uZi(P){if(1>P||P>=this.vu.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.vu.t[P])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.aR[P]||(this.aR[P]=new If(this.eGa(P),this))}eGa(P){const ua=this.vu.n[P];P=(P<this.vu.t.length-1?this.vu.n[P+1]:this.vu.n.length)-ua;if(0>ua||0>P||ua+P>this.vu.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+
ua+","+P+")");const Xa=new Uc.a;Xa.KId(this.vu.n,ua,P);return Xa}}Object(n.a)(sd,"ObjectFetcher",null,[620]);class ie{constructor(P,ua,Xa){if(!P)throw Error.argumentNull("prediction");if(!ua)throw Error.argumentNull("fieldNames");if(!Xa)throw Error.argumentNull("values");if(ua.length!==Xa.length)throw Error.argument("values","fieldNames and values do not have same length");this.lsh=P;this.U0a=ua;this.sYb=Xa}get prediction(){return this.lsh}get PAf(){return this.U0a.length}getFieldName(P){return 0<=
P&&P<this.U0a.length?this.U0a[P]:null}bE(P){return 0<=P&&P<this.sYb.length?this.sYb[P]:null}}Object(n.a)(ie,"PredictionData",null,[]);class te{constructor(P,ua){if(!P)throw Error.argumentNull("predictions");if(!ua)throw Error.argumentNull("tokenAttributes");this.BIj=P;this.MIj=ua}FNd(){return this.BIj}wFf(){return this.MIj}}Object(n.a)(te,"PredictionDataWithTokenAttributes",null,[]);class Ve{constructor(P,ua){this.prediction=null;this.score=0;this.prediction=P;this.score=ua}}Object(n.a)(Ve,"PredictionWithScore",
null,[]);class kf{constructor(P,ua){if(!P)throw Error.argumentNull("predictions");if(!ua)throw Error.argumentNull("attributes");this.msh=P;this.Lbc=ua}FNd(){return this.msh}wFf(){return this.Lbc}}Object(n.a)(kf,"PredictionsWithTokenAttributes",null,[]);class Of{constructor(P,ua,Xa){if(!P)throw Error.argumentNull("attributeName");if(!ua)throw Error.argumentNull("fieldNames");if(!Xa)throw Error.argumentNull("values");if(ua.length!==Xa.length)throw Error.argument("values","fieldNames and values do not have same length");
this.njh=P;this.U0a=ua;this.sYb=Xa}get attributeName(){return this.njh}get PAf(){return this.U0a.length}getFieldName(P){return 0<=P&&P<this.U0a.length?this.U0a[P]:null}bE(P){return 0<=P&&P<this.sYb.length?this.sYb[P]:null}}Object(n.a)(Of,"TokenAttributes",null,[]);var Sf=a(146);class fg{constructor(P,ua,Xa,Pb,hc){this.Mac=0;this.TCe=null;this.Nac=this.Cxb=0;this.U4c=this.k8a=this.a5=this.Dxb=null;this.VCe=0;this.O$a=this.Dr=null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=this.get_current;
this.$$mn=this.moveNext;this.$$rst=this.reset;this.iy=P;this.Lbh=this.Pbh=ua;this.Kbh=this.Nbh=Xa;this.Kac=this.Mbh=Pb;this.Lac=this.Obh=hc}T4c(){this.Nac=0;return this.QCe}QCe(){if(!(this.Nac<this.Kac))return this.RCe;this.Dxb=this.Lbh.items[this.Nac+this.Kbh];this.a5=new wf.a(this.iy.Ga.annotations);1!==this.Kac&&this.iy.Ga.MTb||this.a5.Ira(this.Dxb);if(0<=this.iy.Ga.oMc){(()=>{let P=this.a5.vk(this.iy.Ga.oMc);({value:this.k8a}=P);return P})().returnValue?this.k8a=this.k8a.yF():this.k8a=new le.a(this.iy.Ga.annotations,
Pe.Annotations.QG);this.U4c=this.Lac.items;this.VCe=this.U4c.length;for(this.Mac=0;this.Mac<this.VCe;++this.Mac)this.TCe=this.U4c[this.Mac],Array.add(this.k8a.items,this.TCe);this.a5.iq(this.iy.Ga.oMc,this.k8a)}else 0<=this.iy.Ga.Pte?this.a5.iq(this.iy.Ga.Pte,this.Lac.items[0]):0<=this.iy.Ga.Csd?this.a5.iq(this.iy.Ga.Csd,!0):this.iy.Ga.Y2f?this.Lac.items[0].Uxc((P,ua)=>this.a5.iq(P,ua)):(this.a5.Ira(this.Lac.items[0]),1!==this.Kac&&this.iy.Ga.MTb||((()=>{let P=this.Dxb.vk(this.iy.Ga.KM);({value:this.Cxb}=
P);return P})().returnValue&&this.a5.iq(this.iy.Ga.KM,this.Cxb),(()=>{let P=this.Dxb.vk(this.iy.Ga.HP);({value:this.Cxb}=P);return P})().returnValue&&this.a5.iq(this.iy.Ga.HP,this.Cxb),(()=>this.Dxb.vk(this.iy.Ga.lDa))().returnValue&&this.a5.iq(this.iy.Ga.lDa,this.Cxb)));this.Dr=this.a5;this._state=2;return this.Sbh}RCe(){this._state=3}Rbh(){this.Nac++;return this.QCe}Sbh(){return 1<this.Kac&&this.iy.Ga.MTb?this.RCe:this.Rbh}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new fg(this.iy,
this.Pbh,this.Nbh,this.Mbh,this.Obh)).getEnumerator()}[Symbol.iterator](){return Object(Sf.a)(this.getEnumerator())}moveNext(){if(3===this._state)return!1;this._state?this._state=1:(this._state=1,this.O$a=this.T4c());for(;1===this._state;)this.O$a=this.O$a();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.Dr}}Object(n.a)(fg,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",
null,[4,31,90]);class Pg{constructor(P,ua,Xa){this.nYb=this.Hcg=0;this.Vnb=null;this.E4d=this.a4d=this.Tnb=this.dLc=this.d4d=0;this.fLc=!1;this.s4d=P;this.F4d=ua;this.AIj=Xa}lLf(){null===this.Vnb&&({Q1g:this.Vnb,fVf:this.d4d,length:this.dLc,kzi:P}=this.s4d.IOf(this.F4d.items[this.nYb],this.AIj),this.fLc=P||this.fLc);if(this.Tnb<this.dLc){var P=this.Vnb.charAt(this.d4d+this.Tnb);++this.Tnb;return{returnValue:!0,ch:P}}if(this.nYb===this.F4d.items.length-1)return{returnValue:!1,ch:"\x00"};++this.nYb;
this.Tnb=0;this.Vnb=null;return{returnValue:!0,ch:" "}}vhe(P,ua){this.Tnb===this.dLc&&this.Vnb&&(this.E4d=ua,this.a4d=this.nYb-this.Hcg+1)}Nyk(P){if(0>P||P>=this.F4d.items.length)throw Error.argumentOutOfRange("iToken");this.nYb=this.Hcg=P;this.Vnb=null;this.a4d=this.Tnb=this.dLc=this.d4d=0;this.E4d=-1;this.fLc=!1}QUi(){return{ESh:this.a4d,hAj:this.E4d,gzi:this.fLc}}}Object(n.a)(Pg,"TriePrefixVisitor",null,[639]);class lh{constructor(P){this.Ga=P}execute(P){let ua;if(!(()=>{let Qc=P.vk(this.Ga.Qha);
({value:ua}=Qc);return Qc})().returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Xa;(()=>{let Qc=P.vk(this.Ga.Nqa);({value:Xa}=Qc);return Qc})().returnValue||(Xa=null);const Pb=this.cJi(ua,Xa),hc=Pe.Annotations.yF(P);hc.iq(this.Ga.Qha,Pb);return hc}cJi(P,ua){let Xa=null;const Pb=this.Ga.flatLexicon.trie,hc=new Pg(this,P,ua);let Qc=null;this.Ga.flatLexicon.XUd()&&(Qc=Object(Ha.a)(this.Ga.flatLexicon,this.Ga.flatLexicon.GLi,"getCaseInsensitiveForm"));let vd=0,Nd;
var ke;let Be;for(;vd<P.items.length;){const Ze=P.items[vd];hc.Nyk(vd);Pb.yah(hc,Qc);({ESh:Nd,hAj:ke,gzi:Be}=hc.QUi());if(0<Nd){({rCj:ke}=this.Ga.flatLexicon.wJi(ke));for(let of of this.w9h(P,vd,Nd,ke)){1<Nd&&this.Ga.MTb&&this.d$h(P,ua,vd,Ze,Nd,Be,of);if(!Xa)for(Xa=new le.a(this.Ga.annotations,Pe.Annotations.QG),ke=0;ke<vd;++ke)Array.add(Xa.items,P.items[ke]);Array.add(Xa.items,of)}vd+=Nd}else Xa&&Array.add(Xa.items,Ze),++vd}return Xa||P}d$h(P,ua,Xa,Pb,hc,Qc,vd){if(Qc)Qc=!0;else if(this.Ga.G2f){Qc=
!1;var Nd=-1;for(var ke=0;ke<hc;ke++){const bg=P.items[Xa+ke];let Mg,Jg;if(!(()=>{let F=bg.vk(this.Ga.KM);({value:Mg}=F);return F})().returnValue||!(()=>{let F=bg.vk(this.Ga.HP);({value:Jg}=F);return F})().returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");if(0<ke){if(Mg>Nd+1){Qc=!0;break}if(0>Nd||null===ua||Nd>=ua.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");
if(" "!==ua.charAt(Nd)){Qc=!0;break}}Nd=Mg+Jg}}else Qc=!1;if(Qc){Qc=new Sys.StringBuilder;for(Nd=0;Nd<hc;++Nd){let bg,Mg;({Q1g:ke,fVf:bg,length:Mg}=this.IOf(P.items[Xa+Nd],ua));0<Nd&&Qc.append(" ");Qc.append(ke.substr(bg,Mg))}vd.iq(this.Ga.lDa,Qc.toString())}const Be=P.items[Xa+hc-1];let Ze,of,Xf;(()=>{let bg=Pb.vk(this.Ga.KM);({value:Ze}=bg);return bg})().returnValue&&(()=>{let bg=Be.vk(this.Ga.KM);({value:of}=bg);return bg})().returnValue&&(()=>{let bg=Be.vk(this.Ga.HP);({value:Xf}=bg);return bg})().returnValue?
(vd.iq(this.Ga.KM,Ze),vd.iq(this.Ga.HP,of+Xf-Ze)):(vd.Yrb(this.Ga.KM),vd.Yrb(this.Ga.HP))}w9h(P,ua,Xa,Pb){return new fg(this,P,ua,Xa,Pb)}IOf(P,ua){let Xa,Pb,hc,Qc;if((()=>{let vd=P.vk(this.Ga.lDa);({value:Xa}=vd);return vd})().returnValue)Qc=!0,Pb=0,hc=Xa.length;else{Qc=!1;if(null===ua)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");Xa=ua;if(!(()=>{let vd=P.vk(this.Ga.KM);({value:Pb}=vd);return vd})().returnValue)throw Error.argument("Token missing required Span.StartIndex annotation",
"token");if(!(()=>{let vd=P.vk(this.Ga.HP);({value:hc}=vd);return vd})().returnValue)throw Error.argument("Token missing required Span.Length annotation","token");if(0>Pb||0>hc||Pb+hc>Xa.length)throw Error.argument("Token start/length values out of range","token");}return{Q1g:Xa,fVf:Pb,length:hc,kzi:Qc}}}Object(n.a)(lh,"FlatLexiconNLModule",null,[631]);class Qg{constructor(P,ua){this.Csd=this.oMc=this.Pte=this.lDa=this.HP=this.KM=this.Nqa=this.Qha=0;this.Y2f=this.G2f=this.MTb=!1;this.flatLexicon=
null;this.annotations=ua.annotations;let Xa=0;try{this.Qha=P.pa(Xa),++Xa,this.Nqa=P.pa(Xa),++Xa,this.KM=P.pa(Xa),++Xa,this.HP=P.pa(Xa),++Xa,this.lDa=P.pa(Xa),++Xa,this.Pte=P.pa(Xa),++Xa,this.oMc=P.pa(Xa),++Xa,this.Csd=P.pa(Xa),++Xa,this.MTb=1===P.pa(Xa),++Xa,this.G2f=1===P.pa(Xa),++Xa,this.Y2f=1===P.pa(Xa),++Xa,this.flatLexicon=ua.uZi(P.pa(Xa))}catch(Pb){throw Error.argument("initData");}}}Object(n.a)(Qg,"FlatLexiconNLModuleInit",null,[]);class tg{constructor(){this.bSb=0;this.GGd=null;this.d5b=0}}
Object(n.a)(tg,"FeatureGenStackRec",null,[]);class Dh{constructor(P){this.zxe=Array(P);this.Zvb=Array(P);this.yve=[];this.t_g=[]}}Object(n.a)(Dh,"TokenStringLattice",null,[]);const Gg=(P,ua,Xa)=>{for(let Pb=0;Pb<P.length;Pb++)Xa=ua(Xa,P[Pb]);return Xa},gg=(P,ua)=>{const Xa=Array(P.length);for(let Pb=0;Pb<P.length;Pb++)Xa[Pb]=ua(P[Pb]);return Xa},Hg=(P,ua)=>{ua=Array(Math.min(ua,P.length));for(let Xa=0;Xa<ua.length;Xa++)ua[Xa]=P[Xa];return ua},Lg=(P,ua)=>{const Xa=[];for(const Pb of P)ua(Pb)&&Array.add(Xa,
Pb);return Xa};class qh{constructor(P,ua){this.key=P;this.value=ua}}Object(n.a)(qh,"KeyValuePair",null,[]);const Dg=(P,ua)=>({returnValue:ua in P,value:P[ua]}),mh=P=>{const ua=[];for(let Xa in P){const Pb=new qh(Xa,P[Xa]);Array.add(ua,Pb)}return ua};class Rg{constructor(P){this.HOf=this.k3i;this.Ga=P;this.iLc=this.q4d=this.r4d=0;for(const ua of this.Ga.Nwc)this.r4d=Math.max(this.r4d,ua.kde),this.q4d=Math.max(this.q4d,ua.bde),this.iLc=Math.max(this.iLc,ua.bvb.length)}get UAi(){return this.Ga.n1c.trie}execute(P){if(!P)throw Error.argumentNull("input");
let ua,Xa;({tokens:ua,SAj:Xa}=this.l3i(P));let Pb=null,hc=null,Qc={};if(this.Ga.vUb){ua=Pe.Annotations.yF(ua);for(var vd=0;vd<ua.items.length;++vd)ua.items[vd]=Pe.Annotations.yF(ua.items[vd])}else({IAf:hc,returnValue:Pb}=this.OLf(P,Qc));vd=Array(this.iLc);const Nd=Array(this.iLc);for(var ke=0;ke<Nd.length;++ke)Nd[ke]=new tg;for(ke=-this.r4d;ke<ua.items.length+this.q4d;++ke){let Be=null;this.Ga.vUb&&(Be=ua.items[ke],Qc={},{IAf:hc,returnValue:Pb}=this.OLf(Be,Qc));for(const Ze of this.Ga.Nwc){if(0>ke&&
-ke>Ze.kde||ke>=ua.items.length&&ke-ua.items.length+1>Ze.bde)continue;let of=!0;for(let Xf=0;Xf<Ze.bvb.length;++Xf){const bg=ke+Ze.bvb[Xf];vd[Xf]=bg;if(0>bg?0>this.Ga.lde:bg>=ua.items.length?0>this.Ga.cde:!Xa.Zvb[bg]){of=!1;break}}of&&({Vbi:Pb,Wbi:hc}=this.qkj(Ze,Xa,Pb,hc,Qc,Nd,vd))}this.Ga.vUb&&(Be.iq(this.Ga.Rua?this.Ga.Pcb:this.Ga.Ncb,Pb),this.Ga.Rua&&Be.iq(this.Ga.Ocb,hc))}P=Pe.Annotations.yF(P);this.Ga.vUb?P.iq(this.Ga.Qha,ua):(P.iq(this.Ga.Rua?this.Ga.Pcb:this.Ga.Ncb,Pb),this.Ga.Rua&&P.iq(this.Ga.Ocb,
hc));return P}l3i(P){let ua,Xa;if(!P||!(()=>{let Qc=P.vk(this.Ga.Qha);({value:ua}=Qc);return Qc})().returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Pb;(()=>{let Qc=P.vk(this.Ga.Nqa);({value:Pb}=Qc);return Qc})().returnValue||(Pb="");Xa=new Dh(ua.items.length);const hc=Lg(this.Ga.Bxe,Qc=>!Qc.VSb||Qc.VSb.isMatch(P,null));for(let Qc=0;Qc<ua.items.length;++Qc){const vd=ua.items[Qc];let Nd=null;Xa.zxe[Qc]=Xa.yve.length;let ke=Xa.Zvb[Qc]=0;for(const Be of hc)0<Be.CYb&&
Xa.Zvb[Qc]+ke>=Be.CYb||Be.y9b&&!Be.y9b.isMatch(vd,null)||({z9b:Nd,MHb:ke}=Be.apply(this,vd,Qc,Xa,Pb,Nd,ke))}return{tokens:ua,SAj:Xa}}qkj(P,ua,Xa,Pb,hc,Qc,vd){let Nd=0;Qc[0].bSb=-1;for(Qc[0].GGd=P.OLg;;){const Be=vd[Nd],Ze=0>Be||Be>=ua.Zvb.length?1:ua.Zvb[Be];let of=!1;for(;Qc[Nd].bSb<Ze-1;){++Qc[Nd].bSb;let Xf;var ke=void 0;0>Be?(Xf=this.Ga.lde,ke=1):Be>=ua.zxe.length?(Xf=this.Ga.cde,ke=1):(ke=ua.zxe[Be]+Qc[Nd].bSb,Xf=ua.yve[ke],ke=ua.t_g[ke]);Qc[Nd].d5b=ke*(Nd?Qc[Nd-1].d5b:P.score);let bg;if((()=>
{let Mg=Dg(Qc[Nd].GGd,Xf.toString());({value:bg}=Mg);return Mg})().returnValue){if(Nd===P.bvb.length-1){const Mg=bg;if(Qc[Nd].d5b){let Jg;(()=>{let F=Dg(hc,Mg.toString());({value:Jg}=F);return F})().returnValue||(Jg=-1);0>Jg&&(Xa=Pe.Annotations.yF(Xa),Array.add(Xa.items,Mg));this.Ga.Rua&&(Pb=Pe.Annotations.yF(Pb),0>Jg?Array.add(Pb.items,Qc[Nd].d5b):Pb.items[Jg]+=Qc[Nd].d5b);0>Jg&&(this.Ga.V5f||this.Ga.Rua)&&(hc[Mg.toString()]=Xa.items.length-1)}}else++Nd,Qc[Nd].bSb=-1,Qc[Nd].GGd=bg;of=!0;break}}if(!of&&
(--Nd,0>Nd))break}return{Vbi:Xa,Wbi:Pb}}OLf(P,ua){let Xa,Pb;if((()=>{let hc=P.vk(this.Ga.Rua?this.Ga.Pcb:this.Ga.Ncb);({value:Pb}=hc);return hc})().returnValue)for(let hc=0;hc<Pb.items.length;++hc)ua[Pb.items[hc].toString()]=hc;else Pb=new le.a(this.Ga.annotations,Pe.Annotations.Ofa);if(this.Ga.Rua){if((()=>{let hc=P.vk(this.Ga.Ocb);({value:Xa}=hc);return hc})().returnValue||(Xa=new le.a(this.Ga.annotations,Pe.Annotations.N4)),Xa.items.length!==Pb.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+
this.Ga.annotations.jW(Pe.Annotations.QG,P));}else Xa=null;return{returnValue:Pb,IAf:Xa}}get n6k(){return this.Ga.n1c}k3i(P,ua){let Xa;if((()=>{let Pb=ua.vk(this.Ga.lDa);({value:Xa}=Pb);return Pb})().returnValue)P=Xa;else{let Pb;if(!(()=>{let Qc=ua.vk(this.Ga.KM);({value:Pb}=Qc);return Qc})().returnValue)throw Error.argument("Token is missing Span.StartIndex");let hc;if(!(()=>{let Qc=ua.vk(this.Ga.HP);({value:hc}=Qc);return Qc})().returnValue)throw Error.argument("Token is missing Span.Length");if(0>
Pb||0>hc||Pb+hc>P.length)throw Error.argument("Token indices are out of range");P=P.substr(Pb,hc)}return P}}Object(n.a)(Rg,"NGramNLModule",null,[631,632]);class xg{constructor(P){this.bvb=null;this.score=this.bde=this.kde=0;this.OLg=null;if(P){var ua=0;try{if(P.pa(ua)!==xg.rTa)throw Error.argument("initData","Input does not represent a feature template");++ua;const Xa=P.pa(ua);++ua;this.bvb=Array(Xa);for(let hc=0;hc<Xa;++hc)this.bvb[hc]=P.pa(ua),++ua;this.kde=P.pa(ua);++ua;this.bde=P.pa(ua);++ua;
this.score=P.pa(ua);++ua;let Pb=xg.hDg(P,ua);({dVf:ua}=Pb);this.OLg=Pb.returnValue}catch(Xa){throw Error.argument("initData");}}}static hDg(P,ua){const Xa=P.pa(ua);++ua;const Pb={};for(let Qc=0;Qc<Xa;++Qc){var hc=P.pa(ua);++ua;if(P.pa(ua)){hc=hc.toString();let vd=xg.hDg(P,ua);({dVf:ua}=vd);Pb[hc]=vd.returnValue}else++ua,Pb[hc.toString()]=P.pa(ua),++ua}return{returnValue:Pb,dVf:ua}}}xg.rTa=240803228;Object(n.a)(xg,"FeatureTemplate",null,[642]);var nh=a(1096);class Ah{constructor(P,ua){this.Rua=this.V5f=
this.vUb=!1;this.lDa=this.HP=this.KM=this.Qha=this.Nqa=this.Ocb=this.Pcb=this.Ncb=0;this.n1c=null;this.cde=this.lde=0;this.Nwc=this.Bxe=null;if(P){this.annotations=ua.annotations;var Xa=0;try{this.vUb=1===P.pa(Xa);++Xa;this.V5f=1===P.pa(Xa);++Xa;this.Rua=1===P.pa(Xa);++Xa;this.Ncb=P.pa(Xa);++Xa;this.Pcb=P.pa(Xa);++Xa;this.Ocb=P.pa(Xa);++Xa;this.Nqa=P.pa(Xa);++Xa;this.Qha=P.pa(Xa);++Xa;this.KM=P.pa(Xa);++Xa;this.HP=P.pa(Xa);++Xa;this.lDa=P.pa(Xa);++Xa;this.n1c=this.W$j(ua.iGa(P.pa(Xa)));++Xa;this.lde=
P.pa(Xa);++Xa;this.cde=P.pa(Xa);++Xa;const Pb=P.pa(Xa);++Xa;this.Bxe=Array(Pb);for(let Qc=0;Qc<Pb;++Qc){const vd=P.pa(Xa);++Xa;const Nd=this.n1c.trie,ke=new Uc.a;ke.YFa(P,Xa,vd);this.Bxe[Qc]=this.Z$j(ke,ua,Nd);Xa+=vd}const hc=P.pa(Xa);++Xa;this.Nwc=Array(hc);for(ua=0;ua<hc;++ua){const Qc=P.pa(Xa);++Xa;const vd=new Uc.a;vd.YFa(P,Xa,Qc);this.Nwc[ua]=this.F$j(vd);Xa+=Qc}}catch(Pb){throw Error.argument("initData");}}}W$j(P){return new hg.a(new gh.a(P))}Z$j(P,ua,Xa){return nh.a.create(P,ua,Xa)}F$j(P){return new xg(P)}}
Object(n.a)(Ah,"NGramNLModuleInit",null,[]);class sh{constructor(P){this.Ga=P}execute(P){if(!P)throw Error.argumentNull("input");P=P.clone();this.Ga.script.execute(P,null);return P}}Object(n.a)(sh,"ScriptNLModule",null,[631]);class eg{constructor(P,ua){P&&(this.script=ua.LWa(P.pa(0)))}}Object(n.a)(eg,"ScriptNLModuleInit",null,[]);const th=P=>{P=gg(P,ua=>ua*ua);return Math.sqrt(Gg(P,(ua,Xa)=>ua+Xa,0))},uh=P=>Gg(P,(ua,Xa)=>ua>Xa?ua:Xa,P[0]);class ka{constructor(P){this.Ga=P}execute(P){if(!P)throw Error.argumentNull("input");
var ua=[],Xa=[];this.J_h(P,ua,Xa);this.kHh(ua,Xa);const Pb={};for(let Qc=0;Qc<ua.length;++Qc){var hc=ua[Qc];const vd=this.Ga.LXf.pa(hc);hc=this.Ga.MXf.pa(hc);for(let Nd=0;Nd<hc;++Nd){const ke=this.Ga.pYh.pa(this.Ga.Bef.pa(vd+Nd)),Be=this.Ga.Cef.pa(vd+Nd);let Ze;(()=>{let of=Dg(Pb,ke);({value:Ze}=of);return of})().returnValue||(Ze=0);Pb[ke]=Ze+Xa[Qc]*Be}}Xa=mh(Pb);Xa.sort((Qc,vd)=>{var Nd=Qc.value,ke=vd.value;(Nd=-(Nd>ke?1:Nd<ke?-1:0))||(Nd=Qc.key.localeCompare(vd.key));return Nd});ua=new le.a(this.Ga.annotations,
Pe.Annotations.QG);for(const Qc of Hg(Xa,this.Ga.qKj))Xa=new wf.a(this.Ga.annotations),Xa.iq(this.Ga.sMh,Qc.key),Xa.iq(this.Ga.uMh,Qc.value),Array.add(ua.items,Xa);P.iq(this.Ga.tMh,ua);return P}J_h(P,ua,Xa){let Pb;if((()=>{let hc=P.vk(this.Ga.rMh);({value:Pb}=hc);return hc})().returnValue){let hc;if((()=>{let Qc=Pb.vk(this.Ga.Pcb);({value:hc}=Qc);return Qc})().returnValue){let Qc;if(!(()=>{let vd=Pb.vk(this.Ga.Ocb);({value:Qc}=vd);return vd})().returnValue||hc.items.length!==Qc.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");
this.mqc(hc,Qc,ua,Xa)}if((()=>{let Qc=Pb.vk(this.Ga.wMh);({value:hc}=Qc);return Qc})().returnValue){let Qc;if(!(()=>{let vd=Pb.vk(this.Ga.xMh);({value:Qc}=vd);return vd})().returnValue||hc.items.length!==Qc.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");this.mqc(hc,Qc,ua,Xa)}(()=>{let Qc=Pb.vk(this.Ga.Ncb);({value:hc}=Qc);return Qc})().returnValue&&this.mqc(hc,null,ua,Xa);(()=>{let Qc=Pb.vk(this.Ga.vMh);({value:hc}=Qc);return Qc})().returnValue&&
this.mqc(hc,null,ua,Xa)}}mqc(P,ua,Xa,Pb){for(let Qc=0;Qc<P.items.length;++Qc){let vd;if(P.XN===Pe.Annotations.gS){const Nd=P.items[Qc];(()=>{let ke=Dg(this.Ga.urf,Nd);({value:vd}=ke);return ke})().returnValue||(vd=-1)}else{var hc=P.items[Qc];vd=hc>=this.Ga.L5d&&hc<=this.Ga.TKj?this.Ga.u7d?this.Ga.u7d.pa(hc-this.Ga.L5d)-1:hc-this.Ga.L5d:-1}0<=vd&&(hc=ua?ua.items[Qc]:1,0<hc&&(Array.add(Xa,vd),Array.add(Pb,hc)))}}kHh(P,ua){if(P.length){switch(this.Ga.ohk){case 0:break;case 1:for(var Xa=0;Xa<ua.length;++Xa)ua[Xa]=
1+Math.log(ua[Xa]);break;case 2:Xa=uh(ua);for(let Pb=0;Pb<ua.length;++Pb)ua[Pb]=.5+ua[Pb]/Xa*.5;break;case 3:for(Xa=0;Xa<ua.length;++Xa)ua[Xa]=1;break;default:throw Error.notImplemented();}if(this.Ga.mEc)for(Xa=0;Xa<ua.length;++Xa)ua[Xa]*=this.Ga.mEc.pa(P[Xa]);P=th(ua);for(Xa=0;Xa<ua.length;++Xa)ua[Xa]/=P}}}Object(n.a)(ka,"TfIdfRankerNLModule",null,[631]);class ac{constructor(P,ua){ua=void 0===ua?0:ua;if(!P)throw Error.argumentNull("byteArray");this.kLc=ua;if(604662927!==P.fq(this.kLc+0,4))throw Error.argument("byteArray",
"Input does not represent a compact int array");this._count=P.fq(this.kLc+4,4);this.ccg=P.fq(this.kLc+8,4);this.hIj=P}pa(P){if(0>P||P>=this.count)throw Error.argumentOutOfRange("index");return this.hIj.alk(8*this.kLc+96+P*this.ccg,this.ccg)}get count(){return this._count}}Object(n.a)(ac,"CompactIntArray",null,[630]);const Xc=(P,ua)=>{ua=Array(ua);for(let Qc=0;Qc<ua.length;Qc++){var Xa=Qc,Pb=P.vR(),hc=1===(Pb>>31&1)?-1:1;const vd=Pb&8388607;Pb=Pb>>23&255;256===Pb+1?hc=vd?Number.NaN:1===hc?Number.POSITIVE_INFINITY:
Number.NEGATIVE_INFINITY:Pb?(Pb-=127,hc=hc*Bd(vd,1)*Math.pow(2,Pb)):hc=hc*Bd(vd,0)*Math.pow(2,-126);ua[Xa]=hc}return ua},Bd=(P,ua)=>{let Xa=0;for(let Pb=0;23>Pb;Pb++)Xa+=(P>>22-Pb&1)/Math.pow(2,Pb+1);return ua+Xa};class we{constructor(P,ua){this.u7d=null;this.lig=0;this.MXf=this.LXf=this.mEc=null;this.kig=0;this.Cef=this.Bef=null;this.annotations=ua.annotations;let Xa=0;this.vMh=P.pa(Xa);++Xa;this.Ncb=P.pa(Xa);++Xa;this.wMh=P.pa(Xa);++Xa;this.xMh=P.pa(Xa);++Xa;this.Pcb=P.pa(Xa);++Xa;this.Ocb=P.pa(Xa);
++Xa;this.rMh=P.pa(Xa);++Xa;this.tMh=P.pa(Xa);++Xa;this.sMh=P.pa(Xa);++Xa;this.uMh=P.pa(Xa);++Xa;var Pb=P.pa(Xa);++Xa;var hc=Array(Pb);for(var Qc=0;Qc<Pb;++Qc)hc[Qc]=ua.ia(P.pa(Xa)),++Xa;this.pYh=Uc.a.szd(hc);this.qKj=P.pa(Xa);++Xa;this.ohk=P.pa(Xa);++Xa;Pb=P.pa(Xa);++Xa;this.urf={};for(hc=0;hc<Pb;++hc){Qc=ua.ia(P.pa(Xa));++Xa;const vd=P.pa(Xa);++Xa;this.urf[Qc]=vd}this.L5d=P.pa(Xa);++Xa;this.TKj=P.pa(Xa);++Xa;Pb=P.pa(Xa);++Xa;0<Pb&&(Pb=ua.iGa(P.pa(Xa)),++Xa,this.u7d=this.wQc(new lg(Pb)));++Xa;P=
ua.iGa(P.pa(Xa));this.L$j(P)}wQc(P){return new ac(P.array,P.offset)}L$j(P){try{const ua=new lg(P);this.lig=ua.vR();1===ua.vR()?this.mEc=Uc.a.szd(Xc(ua,this.lig)):this.mEc=null;const Xa=ua.vR();this.LXf=this.wQc(ua);ua.offset+=Xa;const Pb=ua.vR();this.MXf=this.wQc(ua);ua.offset+=Pb;this.kig=ua.vR();const hc=ua.vR();this.Bef=this.wQc(ua);ua.offset+=hc;this.Cef=Uc.a.szd(Xc(ua,this.kig))}catch(ua){throw Error.argument("byteReader");}}}Object(n.a)(we,"TfIdfRankerNLModuleInit",null,[]);class Cd{constructor(P,
ua,Xa,Pb){this.Nbe=P;this.WBf=Xa;this.tokens=Pb;this.W0=ua;this.Ftb=-1;this.UWc=0}}Object(n.a)(Cd,"TokenizerData",null,[]);class Q{constructor(P){this.Ga=P}execute(P){if(!P)throw Error.argumentNull("input");let ua;if(!(()=>{let vd=P.vk(this.Ga.Nqa);({value:ua}=vd);return vd})().returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Xa;(()=>{let vd=P.vk(this.Ga.KM);({value:Xa}=vd);return vd})().returnValue||(Xa=0);let Pb;(()=>{let vd=P.vk(this.Ga.HP);
({value:Pb}=vd);return vd})().returnValue||(Pb=ua.length-Xa);if(0>Xa||Xa>ua.length)throw Error.argument("input","Start index out of range");if(0>Pb||Pb>ua.length)throw Error.argument("input","Length out of range");if(Xa+Pb>ua.length)throw Error.argument("input","Bad start-length range");const hc=new Cd(ua,Xa,Xa+Pb,new le.a(this.Ga.annotations,Pe.Annotations.QG));this.o6k(hc);const Qc=P.isReadOnly?P.clone():P;Qc.iq(this.Ga.Qha,hc.tokens);return Qc}o6k(P){for(;P.W0<P.WBf;){if(this.Ga.QPd){var ua=this.Ga.QPd.Kbg(P.Nbe,
P.W0,P.WBf-P.W0,null);!ua.succeeded&&ua.ohg&&(ua=ua.ohg);if(ua.succeeded){this.bqg(P,ua.length,this.Ga.dQf);P.W0+=ua.length;continue}}ua=P.Nbe.substr(P.W0);let Xa=-1,Pb=-1,hc=-1;for(let Qc=0;Qc<this.Ga.LVc.length;++Qc){const vd=this.Ga.LVc[Qc].exec(ua);vd&&0<vd[1].length&&(0>Xa||vd[0].length>Pb)&&(Xa=Qc,Pb=vd[0].length,hc=vd[1].length)}0<=Xa?(this.bqg(P,hc,this.Ga.bme[Xa]),P.W0+=hc):P.W0+=1}}bqg(P,ua,Xa){if(this.Ga.H4f)Xa!==Q.USh&&(0>P.Ftb&&(P.Ftb=P.W0),P.UWc=P.W0+ua-P.Ftb,Xa===Q.TSh&&(0<=P.Ftb&&
0<P.UWc&&(ua=new wf.a(this.Ga.annotations),ua.iq(this.Ga.KM,P.Ftb),ua.iq(this.Ga.HP,P.UWc),ua.iq(this.Ga.rrd,Q.VSh),ua.iq(this.Ga.Nqa,P.Nbe),Array.add(P.tokens.items,ua)),P.Ftb=-1,P.UWc=0));else{let Pb=new wf.a(this.Ga.annotations);Pb.iq(this.Ga.KM,P.W0);Pb.iq(this.Ga.HP,ua);Pb.iq(this.Ga.rrd,Xa);Array.add(P.tokens.items,Pb)}}}Q.USh="GAP";Q.TSh="EOS_CHUNK";Q.VSh="SENTENCE";Object(n.a)(Q,"TokenizerNLModule",null,[631]);class Ja{constructor(P,ua){this.HP=this.KM=this.rrd=this.Qha=this.Nqa=0;this.H4f=
!1;this.bme=this.LVc=this.dQf=this.QPd=null;if(P){this.annotations=ua.annotations;var Xa=0;try{this.Nqa=P.pa(Xa);++Xa;this.Qha=P.pa(Xa);++Xa;this.rrd=P.pa(Xa);++Xa;this.KM=P.pa(Xa);++Xa;this.HP=P.pa(Xa);++Xa;this.H4f=1===P.pa(Xa);++Xa;var Pb=P.pa(Xa);++Xa;0<Pb&&(this.QPd=ua.NMd(Pb).UAi);this.dQf=P.pa(Xa)?ua.ia(P.pa(Xa)):"";++Xa;const hc=P.pa(Xa);++Xa;this.LVc=Array(hc);this.bme=Array(hc);for(Pb=0;Pb<hc;++Pb)this.LVc[Pb]=new RegExp(ua.ia(P.pa(Xa))),++Xa,this.bme[Pb]=ua.ia(P.pa(Xa)),++Xa}catch(hc){throw Error.argument("initData");
}}}}Object(n.a)(Ja,"TokenizerNLModuleInit",null,[]);class ob{constructor(P){this.Ga=P}execute(P){if(!P)throw Error.argumentNull("input");let ua;if(!(()=>{let Pb=P.vk(this.Ga.u9e);({value:ua}=Pb);return Pb})().returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(var Xa of this.Ga.Cue)ua=Xa.apply(ua);Xa=Pe.Annotations.yF(P);Xa.iq(this.Ga.v9e,ua);return Xa}static vqd(P,ua){const Xa=new Sys.StringBuilder;for(let Pb=0;Pb<P.length;++Pb)Xa.append(ua(P.substr(Pb,
1)));return Xa.toString()}}Object(n.a)(ob,"TransliteratorNLModule",null,[631]);class qc{constructor(P){P&&(this.style=P.pa(0))}apply(P){return ob.vqd(P,ua=>qc.EWh(ua,this.style))}static EWh(P,ua){switch(ua){case 0:return P.toLowerCase();case 1:return"I"===P?"\u0131":P.toLowerCase();case 2:return P.toUpperCase();case 3:return"i"===P?"\u0130":P.toUpperCase();default:throw Error.invalidOperation();}}}qc.sTa=0;Object(n.a)(qc,"ChangeCaseTransliterationStage",null,[638]);class gd{apply(P){return ob.vqd(P,
gd.s7k)}static s7k(P){const ua=P.charCodeAt(0);return 65281<=ua&&65374>=ua?String.fromCharCode(ua-65248):P}}gd.sTa=4;Object(n.a)(gd,"LatinFullWidthToHalfWidthTransliterationStage",null,[638]);class td{constructor(P,ua){P&&(this.Yge=ua.LMf(P.pa(0)),this.pwk=ua.ia(P.pa(1)))}apply(P){return P.replace(this.Yge,this.pwk)}}td.sTa=1;Object(n.a)(td,"RegexReplaceTransliterationStage",null,[638]);class ca{constructor(P,ua){if(P){var Xa=P.pa(0),Pb=ua.ia(P.pa(1)),hc=new ac(ua.iGa(P.pa(2)));P=0>P.pa(3)?null:new ac(ua.iGa(P.pa(3)));
this.Fve={};for(ua=0;ua<Xa;++ua)this.Fve[Pb.charAt(ua).toString()]=Pb.substr(hc.pa(ua),P?P.pa(ua):1)}}apply(P){return ob.vqd(P,ua=>ua in this.Fve?this.Fve[ua]:ua)}}ca.sTa=2;Object(n.a)(ca,"SingleCharSubstitutionsTransliterationStage",null,[638]);class bb{constructor(P,ua){this.v9e=this.u9e=0;this.Cue=null;if(P){this.annotations=ua.annotations;var Xa=0;try{this.u9e=P.pa(Xa);++Xa;this.v9e=P.pa(Xa);++Xa;const Pb=P.pa(Xa);++Xa;this.Cue=Array(Pb);for(let hc=0;hc<Pb;++hc){const Qc=P.pa(Xa);++Xa;const vd=
P.pa(Xa);++Xa;const Nd=new Uc.a;Nd.YFa(P,Xa,vd);Xa+=vd;this.Cue[hc]=this.V$j(Qc,Nd,ua)}}catch(Pb){throw Error.argument("initData");}}}V$j(P,ua,Xa){switch(P){case qc.sTa:return new qc(ua);case td.sTa:return new td(ua,Xa);case ca.sTa:return new ca(ua,Xa);case gd.sTa:return new gd;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(n.a)(bb,"TransliteratorNLModuleInit",null,[]);class Hb{PVi(P,ua){const Xa=P.pa(0),Pb=new Uc.a;Pb.YFa(P,1,P.count-1);
switch(Xa){case 0:return new sh(new eg(Pb,ua));case 2:return new Q(new Ja(Pb,ua));case 3:return new Rg(new Ah(Pb,ua));case 5:return new lh(new Qg(Pb,ua));case 9:return new ob(new bb(Pb,ua));case 10:return new ka(new we(Pb,ua));default:throw Error.notImplemented();}}}Object(n.a)(Hb,"NLModuleFactory",null,[618]);class Vb{constructor(P){this.RSh=";";if(!P)throw Error.argumentNull("resource");this.SY=new sd(P,new Od,new Hb);this.s4d=this.SY.vVi();this.acg=this.SY.annotations.UOb("Text.Text");this.Zbg=
this.SY.annotations.UOb("Classification.Predictions");this.Z3d=this.SY.annotations.UOb("Classification.PredictionString");this.$bg=this.SY.annotations.UOb("Classification.Probability");this.eIj=this.SY.annotations.UOb("NLMod.Tokens");if(0>this.acg||0>this.Zbg||0>this.Z3d||0>this.$bg)throw Error.argument("resourceObj","Resource does not represent a ranker");}pKi(){const P=[];this.GFd(void 0,this.ZFf(P),null);return P}rKi(P,ua){const Xa=[],Pb=[];this.GFd(P,this.ZFf(Xa),(hc,Qc)=>{const vd=this.SY.annotations.OFf(hc),
Nd=[],ke=[];ua&&ua.length&&-1===Array.indexOf(ua,vd)||(hc=this.SY.annotations.getAttributeType(hc),this.Zxg(hc,Qc,Nd,ke),Qc=new Of(vd,Nd,ke),Array.add(Pb,Qc))});return new kf(Xa,Pb)}qKi(P){const ua=[];this.GFd(P,Xa=>{let Pb;if((()=>{let hc=Xa.vk(this.Z3d);({value:Pb}=hc);return hc})().returnValue){let hc;(()=>{let Qc=Xa.vk(this.$bg);({value:hc}=Qc);return Qc})().returnValue&&Array.add(ua,new Ve(Pb,hc))}},null);return ua}GFd(P,ua,Xa){const Pb=new wf.a(this.SY.annotations);Pb.iq(this.acg,P);const hc=
this.s4d.execute(Pb);let Qc;if((()=>{let vd=hc.vk(this.Zbg);({value:Qc}=vd);return vd})().returnValue)for(const vd of Qc.items)ua(vd);if(Xa){let vd;if((()=>{let Nd=hc.vk(this.eIj);({value:vd}=Nd);return Nd})().returnValue)for(const Nd of vd.items)Nd.Uxc(Xa)}}Zxg(P,ua,Xa,Pb){if(Pe.Annotations.fy(P))for(var hc of ua.items)this.Zxg(ua.XN,hc,Xa,Pb);else if(Pe.Annotations.q5g(P)){hc=this.SY.annotations.xLf(P);for(let Qc=0;Qc<hc;Qc++)Array.add(Xa,this.SY.annotations.iOf(P,Qc)),Array.add(Pb,this.SY.annotations.jW(this.SY.annotations.JXa(P,
Qc),ua.sGa(Qc)))}else Array.add(Xa,"VALUE"),Array.add(Pb,this.SY.annotations.jW(P,ua))}ZFf(P){return ua=>{let Xa;(()=>{let Pb=ua.vk(this.Z3d);({value:Xa}=Pb);return Pb})().returnValue&&Array.add(P,this.lYi(Xa))}}lYi(P){const ua=P.indexOf(this.RSh);return 0>ua?P:P.substring(0,ua)}}Object(n.a)(Vb,"Ranker",null,[]);class Ec{constructor(P,ua){this.commandId=P;this.score=ua}}Object(n.a)(Ec,"CommandSuggestion",null,[]);var rd=a(23);class Id{static G2c(P,ua){if(ua&&ua.$k){const Xa={};for(const Pb of P)ua.Cmb(Pb)&&
(Xa[Pb]=appChrome.selectors.getModelType(Pb));Rc.instance.t$(Xa)}}static Z7(P){const ua=Rc.instance.Dz();return!!ua&&ua.$k&&!appChrome.selectors.isControlDisabled(P)}static xnd(P,ua,Xa){if(!(ua&&ua.results&&P&&P.results&&P.results.length))return{returnValue:!1,vnd:P,Wnd:ua};const Pb=[];for(var hc of ua.results)Array.add(Pb,hc.value);hc=0;const Qc=0<ua.results.length?ua.results[0].score:0;for(const vd of P.results)if(vd.score>Xa&&!Array.contains(Pb,vd.value)&&Id.Z7(vd.value)&&(0<Qc&&(vd.score=Qc),
Array.insert(ua.results,hc,vd),hc++),2===hc)break;return 0<hc?(Xa=ua.results.length-5,0<Xa&&ua.iie(Xa),{returnValue:!0,vnd:P,Wnd:ua}):{returnValue:!1,vnd:P,Wnd:ua}}static Enb(P,ua,Xa,Pb){if(Rc.instance.kf()&&P){const hc=[];for(const Qc of P)hc.push(String.format('{{"Id":"{0}","Score":{1}}}',Qc.commandId,Qc.score));P={};P.Suggestions="[{"+hc.join(",")+"}]";P.IsZeroTerm=ua;P.GroupType=Xa;P.Provider=Pb;Rc.instance.kf().jR(qd.i0h,window.performance.now(),P)}}static CXa(P,ua,Xa,Pb,hc,Qc,vd,Nd){var ke;
Xa.EKd&&(ua=Id.ENi(Xa.EKd,ua));var Be=bd.DMi(ua);Id.G2c(Be,Xa);var Ze=[],of=[];Be=[];const Xf=new Hd(vd);vd=16===vd||18===vd||7===vd||4===vd?rd.AFrameworkApplication_AppSettingsManager.ea?rd.AFrameworkApplication_AppSettingsManager.ea.Rd("TellMeMaxRecommendedResultsToReturn",3):3:0===vd||17===vd||25===vd?5:0;var bg=Rc.instance.BMd();const Mg=bd.ANi(Xa),Jg=bd.sMi(Xa),F=null===(ke=null===appChrome||void 0===appChrome?void 0:appChrome.api)||void 0===ke?void 0:ke.getSharedUxSettings();ke=F&&F.hasOwnProperty("commonSettings")?
F.commonSettings():void 0;bd.Nz(P)&&(Xa.a8j&&Xa.Cmb(Mg)&&Id.Z7(Mg)&&!bg.HJb(Mg)&&Ze.push(new Xd(Mg,5,null,null,Nd)),ke&&ke.shouldShowShareMenuForZeroCaseTellMe()&&Xa.Cmb(Jg)&&Id.Z7(Jg)&&!bg.HJb(Jg)&&Ze.push(new Xd(Jg,5,null,null,Nd)));bg=ke&&ke.shouldBlockCommandsForZeroCaseTellMe()&&bd.Nz(P);for(const va of ua)if(!(Id.doj(va.commandId)||bg&&Id.yxj(va.commandId))){ua=Id.J3k(va.commandId);if(Xa.Cmb(va.commandId)&&!ua){if(bd.A5f(va.commandId))continue;ua=null;hc&&Qc&&(ua=hc.AXi(va.commandId,Qc));Id.Z7(va.commandId)?
Array.add(Ze,new Xd(va.commandId,5,ua,null,Nd,va.score)):Array.add(of,new Xd(va.commandId,5,ua,null,Nd,va.score))}else Xa.ISa&&ua&&Pb&&Array.add(Be,va.commandId.substr(21));if(Ze.length+Be.length>=vd)break}Xa=0;for(hc=0;hc<Ze.length&&Xa<vd;hc++,Xa++)Xf.An(Ze[hc]);if(!ke||!ke.shouldHideDisabledButtonsFromTellMe())for(Ze=0;Ze<of.length&&Xa<vd;Ze++,Xa++)Xf.An(of[Ze]);for(of=0;of<Be.length&&Xa<vd;of++,Xa++)Pb.hBl(P,Be[of],Xf);return Xf}static ENi(P,ua){const Xa=[],Pb=[];for(const hc of ua){ua=hc.commandId;
let Qc=hc;hc.commandId in P&&(ua=P[hc.commandId],Qc=new Ec(ua,hc.score));Array.contains(Pb,ua)||(Xa.push(Qc),Pb.push(ua))}return Xa}static doj(P){Id.z$e||(rd.AFrameworkApplication_AppSettingsManager.ea&&rd.AFrameworkApplication_AppSettingsManager.ea.Dj("TellMeControlPredictionBlockList")&&rd.AFrameworkApplication_AppSettingsManager.ea.Yk("TellMeControlPredictionBlockList").forEach(ua=>{Array.add(Id.y$e,ua.toLowerCase())}),Id.z$e=!0);return Array.contains(Id.y$e,P.toLowerCase())}static yxj(P){!Id.B$e&&
rd.AFrameworkApplication_AppSettingsManager.ea&&rd.AFrameworkApplication_AppSettingsManager.ea.Dj("TellMeZeroCaseSuggestionsBlockList")&&(Id.A$e=rd.AFrameworkApplication_AppSettingsManager.ea.Yk("TellMeZeroCaseSuggestionsBlockList"),Id.B$e=!0);return Id.A$e.includes(P.toLowerCase())}static J3k(P){return P.startsWith("btnTellMeOfficeAddIn")}static RTb(P){return 2<P.length&&";"===P.charAt(0)&&";"===P.charAt(P.length-1)&&!!rd.AFrameworkApplication_AppSettingsManager.ea&&(rd.AFrameworkApplication_AppSettingsManager.ea.ka("TellMeCommandHookIsEnabled")||
rd.AFrameworkApplication_AppSettingsManager.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",!1))}}Id.z$e=!1;Id.B$e=!1;Id.y$e=[];Id.A$e=[];Object(n.a)(Id,"CommandResultsUtilityHelper",null,[]);class W{static G2c(P,ua){return Id.G2c(P,ua)}static Z7(P){return Id.Z7(P)}static Enb(P,ua,Xa,Pb){return Id.Enb(P,ua,Xa,Pb)}static CXa(P,ua,Xa,Pb,hc,Qc,vd,Nd){return Id.CXa(P,ua,Xa,Pb,hc,Qc,vd,Nd)}static RTb(P){return Id.RTb(P)}static eHf(P){const ua=new Hd(0);var Xa=P.split(";");
P=Rc.instance.Dz();for(const Pb of Xa)if(0<Pb.length){Xa=Pb.split(":");const hc=2===Xa.length?Xa[0]:Pb;if(!P.Cmb(hc))break;if(1===Xa.length)Xa=new Xd(hc,5,null,null,1),ua.An(Xa);else if(2===Xa.length)Xa=new Xd(hc,5,Xa[1],null,1),ua.An(Xa);else break}return ua}static xnd(P,ua,Xa){return Id.xnd(P,ua,Xa)}}Object(n.a)(W,"CommandResultsUtility",null,[]);class Ra{constructor(P,ua){this.cRe="";this.Bhd=null;this.Chd=!1;this.f5=null;this.ojh=["TellMe.TellMeParamCollection"];this.Db=P;this.dpa=ua;this.Db.ISa&&
(this.f5=null)}get bSc(){if(!this.Bhd&&!this.Chd){let P=null;try{P=window.TellMeModel}catch(ua){if(Rc.instance.kf())Rc.instance.kf().onError("QueryRanker","TellMeModel not found. Exception: "+ua)}if(P){try{this.Bhd=new Vb(P)}catch(ua){if(Rc.instance.kf())Rc.instance.kf().onError("QueryRanker","Exception thrown while loading classifier. Exception: "+ua)}this.Chd=!0}else if(Rc.instance.kf())Rc.instance.kf().onError("QueryRanker","Classifier model not found")}return this.Bhd}Hx(){return"Command"}RF(){return 0===
this.Db.jm?0:1===this.Db.jm?1:2}Nx(P,ua,Xa,Pb,hc){Xa=void 0===Xa?!1:Xa;Pb=void 0===Pb?nd.tellMe:Pb;hc=void 0===hc?null:hc;const Qc=new Zc(P);if((!hc||Array.contains(hc,0))&&!bd.Nz(P)){if(!this.bSc&&this.Chd){if(Rc.instance.kf())Rc.instance.kf().onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.Db.ISa&&this.f5&&this.f5.initialize();if(W.RTb(P.qe)&&(hc=W.eHf(P.qe),0<hc.results.length)){hc.displayName=
"Classifier Debug";Qc.Xm(hc);ua.Ll(Qc);return}hc=P?this.cRe=P.qe:this.cRe;if(J.AFrameworkApplication.ea.ka("TellMeParameterizedQueriesEnabled")){hc=this.nYi(hc);var vd=this.jzc(hc.FNd());hc=hc.wFf()}else hc=this.mYi(hc),vd=this.IMi(hc),hc=[];W.Enb(vd,!1,"Classifier","TFIDF");vd=W.CXa(P,vd,this.Db,this.f5,this.dpa,hc,0,1);0<vd.results.length&&Pb!==nd.contextMenu&&(vd.displayName=Object(pc.a)("TellMeCommandProviderTitle"));Xa||vd.results.length||this.Db.IHa||this.Db.Hya||(P=new Xd("lookupNoResults",
14,P.qe,null,1),vd.An(P));0<vd.results.length&&Qc.Xm(vd);Qc.attributes=hc}ua.Ll(Qc)}FNd(){let P=[];try{P=this.bSc.pKi()}catch(ua){if(Rc.instance.kf())Rc.instance.kf().onError("GetPredictions","Exception: "+ua)}return P}mYi(P){let ua=[];try{ua=this.bSc.qKi(P)}catch(Xa){if(Rc.instance.kf())Rc.instance.kf().onError("GetPredictionsWithScore","Exception: "+Xa)}return ua}nYi(P){try{return this.bSc.rKi(P,this.ojh)}catch(ua){if(Rc.instance.kf())Rc.instance.kf().onError("GetPredictionsWithTokenAttributes",
"Exception: "+ua)}return new kf([],[])}jzc(P){const ua=[];if(P)for(const Xa of P)ua.push(new Ec(Xa,-99999));return ua}IMi(P){const ua=[];if(P)for(const Xa of P)ua.push(new Ec(Xa.prediction,Xa.score));return ua}}Object(n.a)(Ra,"CommandResultsProvider",null,[512]);class nc extends Xd{constructor(P,ua,Xa,Pb,hc){super(P,ua,void 0===hc?null:hc,null,Xa);this.id=Pb}}Object(n.a)(nc,"TryQueryResultBinding",Xd,[]);class yc{constructor(P,ua,Xa,Pb){this.jaa=P;this.nCa=ua;this.l_e=Pb;this.Xmh=Xa;this.Db=Rc.instance.Dz()}Hx(){return"EmptyQuery"}RF(){return 1===
this.Db.jm?1:0}Nx(P,ua,Xa,Pb,hc){Xa=void 0===Xa?!1:Xa;hc=void 0===hc?null:hc;Pb=new Zc(P);if((!hc||Array.contains(hc,5)||Array.contains(hc,6)||Array.contains(hc,4))&&bd.Nz(P)){this.jaa.oGa().length||!this.Xmh||this.l_e||(P=new Hd(6),hc=new Xd(null,13,void 0,void 0,1),P.An(hc),Pb.Xm(P));P=new Hd(4);if(0<this.jaa.oGa().length){P.displayName=Object(pc.a)("TellMeRecentlyUsedTitle");hc=this.jaa.oGa();var Qc=[];for(var vd of hc)Qc.push(vd.Id);Id.G2c(Qc,this.Db);for(var Nd of hc)Id.Z7(Nd.Id)&&P.An(new Xd(Nd.Id,
5,null,null,2));Pb.Xm(P)}if(this.l_e&&0<this.nCa.length&&this.jaa.oGa().length<yc.Aeg){vd=new Hd(5);vd.displayName=Object(pc.a)("TellMeTryQueryTitle");Nd=yc.Aeg-P.results.length;P=[];for(hc=0;hc<this.nCa.length&&hc<Nd;++hc){if(Xa){Qc=bd.Lye+(hc+1);const ke=this.nCa[hc].key,Be=oa.a.replaceAll(ke,'"',"");P.push(appChrome.actions.setControlLabel(Qc,ke));P.push(appChrome.actions.setButtonCommandValueId(Qc,Be));Qc=new nc(ke,7,0,Be,Qc)}else Qc=new nc(this.nCa[hc].key,7,0,this.nCa[hc].value);vd.An(Qc)}0<
P.length&&appChrome.api.dispatch(P);Pb.Xm(vd)}}ua.Ll(Pb)}}yc.Aeg=5;Object(n.a)(yc,"EmptyQueryResultsProvider",null,[512]);class Fd{constructor(P){this.Db=P}Hx(){return"Feedback"}RF(){return 0===this.Db.jm?0:1===this.Db.jm?1:2}Nx(P,ua,Xa,Pb,hc){hc=void 0===hc?null:hc;P=new Zc(P);if(!hc||Array.contains(hc,21))hc=[],hc.push(appChrome.actions.setControlLabel("TellMeFeedback",Object(pc.a)("TellMeFeedbackText"))),appChrome.api.dispatch(hc),hc=new Hd(22),hc.displayName="",hc.An(new Xd("TellMeFeedback",23,
null,null,1)),P.Xm(hc);ua.Ll(P)}}Object(n.a)(Fd,"FeedbackResultsProvider",null,[512]);class $d{constructor(P,ua,Xa,Pb){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=P;this.CommandId=ua;this.CommandValueId=Xa;this.InputText=Pb}}Object(n.a)($d,"FindInDocumentProp",null,[]);class Me{constructor(P){this.hfd=2;this.tQa=[];this.DBa=[];this.Db=P;Me.oca=P.CBf;Me.EBf="FindInDocumentSuggestion";Me.Wwg="FindInDocumentSuggestion3";this.iqh=Object.assign(new yb,{landingTab:"Indoc",
data:null});this.fuh=this.Db.yub||!!J.AFrameworkApplication.ua&&J.AFrameworkApplication.ua.Ab.yub}Hx(){return"FindInDocument"}RF(){return 0===this.Db.jm?0:1===this.Db.jm?1:3===this.Db.jm?this.Db.AYg?2:3:2}Nx(P,ua,Xa,Pb,hc){Xa=void 0===Xa?!1:Xa;hc=void 0===hc?null:hc;const Qc=new Zc(P);if(hc&&!Array.contains(hc,2))ua.Ll(Qc);else if(Array.clear(this.tQa),bd.Nz(P)){if(Xa&&this.tVg()){Xa=new Hd(2);Xa.displayName=Object(pc.a)("TellMeFindInDocProviderTitle");hc=1;Pb="";if(0<this.DBa.length&&!this.Db.Aub)for(var vd of this.DBa)if(""!==
vd.Label.toLowerCase()){if(hc>=this.hfd)break;this.G8g(Xa,vd.Label,vd.CommandValueId,Me.EBf+hc,vd.InputText);hc++}vd="";this.Db.dD?(Qc.Xm(Xa),Xa=new Hd(3),vd=this.Db.eDa?bd.hGa(Object(pc.a)("TellMeOpenFindPaneTextV2Bolded")):Object(pc.a)("TellMeOpenFindPaneTextV2")):vd=Object(pc.a)("TellMeOpenFindPaneText");Pb=this.dHf("");this.G8g(Xa,vd,Pb,Me.Wwg,"");Qc.Xm(Xa)}ua.Ll(Qc)}else vd="",Xa&&(Xa=this.dHf(P.qe),Pb=[],this.Db.EIa?(this.Db.xse&&Pb.push(appChrome.actions.setControlIconSet(Me.oca,{"default":"FindInDocument_20"})),
vd=this.Db.VZd?bd.KLd(P.qe,Object(pc.a)("FindInDocumentScopedButtonText")):P.qe+Object(pc.a)("FindInDocumentScopedButtonText")):this.Db.dD?(vd=this.Db.eDa?bd.hGa(String.format(Object(pc.a)("FindInDocumentScopedButtonTextV2Bolded"),P.qe)):String.format(Object(pc.a)("FindInDocumentScopedButtonTextV2"),P.qe),Pb.push(appChrome.actions.setControlIconSet(Me.oca,{"default":"FindInDocument_20"}))):vd=this.Db.Aub?Object(pc.a)("TellMeOpenFindPaneText"):String.format(Object(pc.a)("TextWithQuotation"),P.qe),
this.Db.J7?(Rc.instance.actions.push(appChrome.actions.setControlLabel(Me.oca,vd)),Rc.instance.actions.push(appChrome.actions.setButtonCommandValueId(Me.oca,Xa))):(Pb.push(appChrome.actions.setControlLabel(Me.oca,vd)),Pb.push(appChrome.actions.setButtonCommandValueId(Me.oca,Xa)),appChrome.api.dispatch(Pb)),this.KRg(vd,Me.oca,Xa,P.qe)),this.Db.AYg?(vd=new Xd(Me.oca,8,P.qe),Xa=new Hd(2),Xa.displayName=Object(pc.a)("TellMeFindInDocProviderTitle"),Xa.An(vd),Qc.Xm(Xa),ua.Ll(Qc)):this.Db.UQi().then(Nd=>
{const ke=new Xd(Me.oca,8,P.qe,null,1);ke.count=Nd;Nd=new Hd(2);Nd.displayName=Object(pc.a)("TellMeFindInDocProviderTitle");Nd.An(ke);Qc.Xm(Nd);ua.Ll(Qc)},Nd=>{Rc.instance.kf().onError("FindInDocumentResultsProvider:issueQuery","Find manager promise rejected: "+Nd);Nd=new Xd(Me.oca,8,P.qe,null,1);const ke=new Hd(2);ke.displayName=Object(pc.a)("TellMeFindInDocProviderTitle");ke.An(Nd);Qc.Xm(ke);ua.Ll(Qc)})}tVg(){return!!this.Db&&this.Db.UYc}G8g(P,ua,Xa,Pb,hc){hc=void 0===hc?null:hc;var Qc=void 0===
Qc?null:Qc;var vd=void 0===vd?-99999:vd;const Nd=[];ua&&Nd.push(appChrome.actions.setControlLabel(Pb,ua));this.Db.dD&&Nd.push(appChrome.actions.setControlIconSet(Pb,{"default":"FindInDocument_20"}));Nd.push(appChrome.actions.setButtonCommandValueId(Pb,Xa));appChrome.api.dispatch(Nd);this.KRg(ua,Pb,Xa,"");P.An(new Xd(Pb,8,hc,Qc,1,vd))}dHf(P){return this.fuh?bd.Qra(P,15,this.iqh):oa.a.Ig(P)}KRg(P,ua,Xa,Pb){this.tVg()&&this.tQa.length<this.hfd&&(P=new $d(P,ua,Xa,Pb),Array.add(this.tQa,P))}bLk(P){for(let ua=
0;ua<this.tQa.length;ua++)if(this.tQa[ua].CommandId===P){const Xa=this.tQa[ua].Label;let Pb=!1;if(0<this.DBa.length){let hc=0;for(const Qc of this.DBa){if(Qc.Label===Xa){Array.removeAt(this.DBa,hc);Pb=!0;break}hc++}}!Pb&&this.DBa.length>=this.hfd-1&&Array.removeAt(this.DBa,1);Array.insert(this.DBa,0,this.tQa[ua])}}}Me.oca=null;Me.EBf=null;Me.Wwg=null;Object(n.a)(Me,"FindInDocumentResultsProvider",null,[512]);class ff{constructor(P){this.Db=P}Hx(){return"Image"}RF(){return 0===this.Db.jm?0:1===this.Db.jm?
1:3===this.Db.jm?3:2}Nx(P,ua,Xa,Pb,hc){hc=void 0===hc?null:hc;Xa=new Zc(P);(!hc||Array.contains(hc,19))&&bd.Nz(P)&&this.Db.dD&&this.eHa(P,Xa,1);ua.Ll(Xa)}eHa(P,ua,Xa,Pb){Pb=void 0===Pb?null:Pb;var hc=[];let Qc;Rc.instance.Dz()&&Rc.instance.Dz().EIa?(Qc=this.Db.VZd?bd.KLd(P.qe,Object(pc.a)("TellMeImageSuggestionScopedButtonTextNoHeader")):P.qe+Object(pc.a)("TellMeImageSuggestionScopedButtonTextNoHeader"),this.Db.xse||hc.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):
Qc=this.Db.dD?bd.Nz(P)?this.Db.eDa?bd.hGa(Object(pc.a)("TellMeImageSuggestionButtonTextV2Bolded")):Object(pc.a)("TellMeImageSuggestionButtonTextV2"):this.Db.eDa?bd.hGa(String.format(Object(pc.a)("TellMeScopedImageSuggestionButtonTextBolded"),P.qe)):String.format(Object(pc.a)("TellMeScopedImageSuggestionButtonText"),P.qe):this.Db.Aub?Object(pc.a)("TellMeImageSuggestionButtonText"):P.qe+Object(pc.a)("TellMeImageSuggestionScopedButtonTextWithHeader");this.Db.J7?(Rc.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",
Qc)),hc=bd.Qra(P.qe,9,Object.assign(new yb,{landingTab:"Image"})),Rc.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",hc))):(hc.push(appChrome.actions.setControlLabel("ImageForSearch",Qc)),P=bd.Qra(P.qe,9,Object.assign(new yb,{landingTab:"Image"})),hc.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",P)),appChrome.api.dispatch(hc));Xa=new Xd("ImageForSearch",12,null,null,Xa);Pb&&(Xa.score=Pb.ConfidenceScore);Pb=new Hd(19,this.Db.Aub?Object(pc.a)("TellMeImageTitleV2"):
Object(pc.a)("TellMeImageTitle"));Pb.An(Xa);ua.Xm(Pb)}}Object(n.a)(ff,"ImageResultsProvider",null,[512]);class jf{constructor(P){this.Db=P}Hx(){return"Insights"}RF(){return 0===this.Db.jm?0:1===this.Db.jm?1:2}Nx(P,ua,Xa,Pb,hc){Xa=void 0===Xa?!1:Xa;hc=void 0===hc?null:hc;Pb=new Zc(P);if(!hc||Array.contains(hc,13))if(this.YSk()||!bd.Nz(P)){hc=new Hd(13);var Qc=""===P.qe.trim(),vd=Qc?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",Nd=new Xd(vd,10,P.qe,null,1);Xa&&(Xa=null,bd.G2()?Qc?Qc=Object(pc.a)("SeeMoreOpenSearchPaneLabel"):
(Qc=this.Db.Aub?Object(pc.a)("SeeMoreResultsButtonTextNonParameteriedV2"):String.format(Object(pc.a)("SeeMoreResultsButtonText"),P.qe),Xa=bd.Qra(P.qe,1)):(Qc=String.format(Object(pc.a)("InsightsButtonText"),P.qe),Xa=bd.zzd(P.qe)),this.Db.J7?(Rc.instance.actions.push(appChrome.actions.setControlLabel(vd,Qc)),Xa&&Rc.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",Xa))):(P=[],P.push(appChrome.actions.setControlLabel(vd,Qc)),Xa&&P.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",
Xa)),appChrome.api.dispatch(P)),Nd.label=Qc);hc.An(Nd);Pb.Xm(hc)}ua.Ll(Pb)}YSk(){return bd.G2()&&this.Db.y3k&&!this.Db.EX}}Object(n.a)(jf,"InsightsResultsProvider",null,[512]);class Lf{constructor(P){this.Db=P}Hx(){return"Learning"}RF(){return 0===this.Db.jm?0:1===this.Db.jm?1:2}Nx(P,ua,Xa,Pb,hc){hc=void 0===hc?null:hc;Xa=new Zc(P);hc&&!Array.contains(hc,21)||!bd.Nz(P)||(hc=[],Pb=this.Db.VBj,hc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",Pb)),Pb=Lf.GRi(Pb),hc.push(appChrome.actions.setControlLabel("LearningForSearch",
Pb)),appChrome.api.dispatch(hc),P=new Xd("LearningForSearch",22,P.qe,null,1),hc=new Hd(21),hc.An(P),Xa.Xm(hc));ua.Ll(Xa)}static GRi(P){const ua=[];Array.add(ua,new ub(600,Object(pc.a)("TellMeLearningButtonTipText")));Array.add(ua,new ub(400,Object(pc.a)("TellMeLearningButtonText")));Array.add(ua,new ub(600,P));Array.add(ua,new ub(400,Object(pc.a)("TellMeLearningButtonPunctuation")));P={};P.parts=ua;return JSON.stringify(P)}}Object(n.a)(Lf,"LearningProvider",null,[512]);var Ef=a(535);class jg{constructor(P,
ua){this.o$a=this.dbb=this.QBa=this.lgc=null;this.iH=!1;this.K$a=P;this.rlh=ua;P&&this.pAf(P)}M1c(){this.K$a.M1c()&&this.pAf(this.K$a)}g2i(P){let ua=[];var Xa=[];P=jg.eQj(P);var Pb="";Array.clear(Xa);for(let hc=0;hc<P.length;hc++){const Qc=P.charAt(hc);-1!==" ".indexOf(Qc)?(Pb.length&&Array.add(Xa,Pb),Pb=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(Qc)?(Pb.length&&Array.add(Xa,Pb),Pb=Qc,Array.add(Xa,Pb),Pb=""):Pb+=Qc}Pb.length&&Array.add(Xa,Pb);for(P=0;P<Xa.length;P++)Pb=this.HMi(Xa[P]),Pb=
this.l4h(Pb),ua=jg.ILj(ua,Pb);return ua=this.VAh(ua)}Jlb(){this.iH||this.M1c();return this.iH}Tsc(P){return this.lgc[P.toString()]}VAh(P){for(let ua=0;ua<P.length;ua++){const Xa=this.QBa[ua];if(P[ua].commandId!==this.Tsc(Xa[0]))throw Error.create("Incorrect Tcid orders with Priors data");let Pb;(Pb=P[ua]).score=Pb.score+Xa[1]}return P}l4h(P){const ua=[];for(var Xa=0;Xa<this.QBa.length;Xa++)ua.push(new Ec(this.Tsc(this.QBa[Xa][0]),-5));Xa=new Ef.a;for(var Pb=0;Pb<P.length;Pb++)Xa.add(this.Tsc(P[Pb][0]));
for(Pb=0;Pb<ua.length;Pb++){const Qc=ua[Pb];for(let vd=0;vd<P.length;vd++){var hc=P[vd];const Nd=this.Tsc(hc[0]);hc=hc[1];if(Nd===Qc.commandId){Qc.score=hc;Xa.remove(Nd);break}}if(!Xa.count)break}return ua}HMi(P){const ua=1>P.length;for(let vd=0;2>=vd;vd++){const Nd=this.o$a;for(const ke in Nd){var Xa=Nd[ke],Pb=P,hc=ke;const Be=hc.length+1,Ze=Array((Pb.length+1)*Be);for(var Qc=0;Qc<=Pb.length;Qc++)Ze[Qc*Be]=Qc;for(Qc=0;Qc<=hc.length;Qc++)Ze[Qc]=Qc;for(Qc=0;Qc<hc.length;Qc++)for(let of=0;of<Pb.length;of++)Ze[(of+
1)*Be+(Qc+1)]=Pb.charAt(of)===hc.charAt(Qc)?Ze[of*Be+Qc]:Math.min(Math.min(Ze[of*Be+(Qc+1)]+1,Ze[(of+1)*Be+Qc]+1),Ze[of*Be+Qc]+1);Pb=Ze[Pb.length*Be+hc.length];if((!Pb||!ua)&&Pb<=vd)return Xa}}return this.dbb}pAf(P){this.lgc=P.MMd();this.QBa=P.OYi();this.dbb=P.S3i();this.o$a=P.aUi();if(this.iH=!!this.lgc&&!!this.QBa&&!!this.o$a&&!!this.dbb)this.iH=0<this.QBa.length&&jg.EUd(this.QBa);this.iH&&(this.iH=0<this.dbb.length&&jg.EUd(this.dbb));this.iH&&(this.o$a=jg.D4i(this.o$a));this.iH||(this.o$a=this.dbb=
this.QBa=this.lgc=null)}z3i(P){P=this.g2i(P);return this.IAi(P,this.rlh)}IAi(P,ua){let Xa=[];for(let Pb=0;Pb<P.length;Pb++)P[Pb].score>=ua&&Xa.push(P[Pb]);Xa.sort((Pb,hc)=>Pb.score<hc.score?1:Pb.score>hc.score?-1:0);0<Xa.length-10&&(Xa=Xa.slice(0,10));return Xa}static ILj(P,ua){if(!P.length)return ua;if(P.length!==ua.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");for(let Xa=0;Xa<P.length;Xa++){if(P[Xa].commandId!==ua[Xa].commandId)throw Error.create("Incorrect CommandId");
let Pb;(Pb=P[Xa]).score=Pb.score+ua[Xa].score}return P}static eQj(P){return oa.a.wm(P)}static EUd(P){for(let ua=0;ua<P.length;ua++)if(2!==P[ua].length)return!1;return!0}static D4i(P){const ua={};for(const hc in P){var Xa=hc,Pb=P[hc];const Qc=Pb;Qc.length&&jg.EUd(Qc)&&(ua[Xa]=Pb)}return ua}}Object(n.a)(jg,"NaiveBayesClassifierModel",null,[]);class Eg{constructor(P,ua){this.f5=null;this.Cld=!1;this.Db=P;this.bCb=new jg(ua,P.dLf);this.Db.ISa&&(this.f5=null)}Hx(){return"NBCommand"}n6f(){return this.Cld}RF(){return 0===
this.Db.jm?0:1===this.Db.jm?1:2}Nx(P,ua,Xa,Pb,hc){Xa=void 0===Xa?!1:Xa;Pb=void 0===Pb?nd.tellMe:Pb;hc=void 0===hc?null:hc;const Qc=new Zc(P);this.Cld=!1;if((!hc||Array.contains(hc,0))&&!bd.Nz(P)){if(W.RTb(P.qe)&&(hc=W.eHf(P.qe),0<hc.results.length)){hc.displayName="Classifier Debug";Qc.Xm(hc);ua.Ll(Qc);return}if(!this.bCb.Jlb()){if(Rc.instance.kf())Rc.instance.kf().onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");
}this.Db.ISa&&this.f5&&this.f5.initialize();hc=this.bCb.z3i(P.qe);W.Enb(hc,!1,"Classifier","NaiveBayesian");hc=W.CXa(P,hc,this.Db,this.f5,null,null,0,1);0<hc.results.length&&Pb!==nd.contextMenu&&(hc.displayName=Object(pc.a)("TellMeCommandProviderTitle"));Xa||hc.results.length||this.Db.IHa||this.Db.Hya||(P=new Xd("lookupNoResults",14,P.qe,null,1),hc.An(P));0<hc.results.length&&(this.Cld=!0,Qc.Xm(hc))}ua.Ll(Qc)}}Object(n.a)(Eg,"NaiveBayesCommandProvider",null,[512]);class bh{constructor(){this.rQa=
null;this.iH=!1;this.M1c()}M1c(){this.iH||(this.rQa=window.NBCRM)&&4===this.rQa.length&&(this.iH=!0);return this.iH}OYi(){return this.iH?this.rQa[1]:null}S3i(){return this.iH?this.rQa[2]:null}aUi(){return this.iH?this.rQa[3][0]:null}MMd(){return this.iH?this.rQa[0][0]:null}}Object(n.a)(bh,"NaiveBayesModelAdapter",null,[548]);var ch=a(66);class Fg{constructor(P){this.Db=P}Hx(){return"OfficeScript"}RF(){return 0===this.Db.jm?0:1===this.Db.jm?1:2}Nx(P,ua){const Xa=new Zc(P);if(!bd.Nz(P)){P=ch.d(P.qe);
var Pb=new Hd(28);Pb.displayName=Object(pc.a)("TellMeOfficeScriptsTitle");Pb=this.alc(P,Fg.O$k,"OfficeScriptsUnhideAllRowsCols","samples-11",Object(pc.a)("TellMeUnhideAllRowsColsTitle"),Pb);Pb=this.alc(P,Fg.nFi,"OfficeScriptsFreezeSelection","samples-12",Object(pc.a)("TellMeFreezeSelectionTitle"),Pb);Xa.Xm(Pb)}ua.Ll(Xa)}alc(P,ua,Xa,Pb,hc,Qc){const vd=[];for(const Nd of ua)if(ch.a(P,Nd)){this.Db.J7?(Rc.instance.actions.push(appChrome.actions.setControlLabel(Xa,hc)),Rc.instance.actions.push(appChrome.actions.setButtonCommandValueId(Xa,
Pb))):(vd.push(appChrome.actions.setControlLabel(Xa,hc)),vd.push(appChrome.actions.setButtonCommandValueId(Xa,Pb)),appChrome.api.dispatch(vd));Qc.An(new Xd(Xa,28,null,null,1));break}return Qc}}Fg.O$k="unhide row rows col cols column columns".split(" ");Fg.nFi=["freeze","selection","pane","panes"];Object(n.a)(Fg,"OfficeScriptsSamplesProvider",null,[512]);var og=a(254),qg;(function(P){P[P.uml=0]="Classifier";P[P.gml=1]="AppsForOffice";P[P.ceh=2]="FindInDocument";P[P.xnl=3]="FindInDocumentScopedSearch";
P[P.Xol=4]="RecentlyUsed";P[P.Kgh=5]="TryQuery";P[P.Empty=6]="Empty";P[P.Ipl=7]="TryCommand";P[P.mch=8]="Assistance";P[P.lch=9]="Answer";P[P.Jdh=10]="Definition";P[P.Rdh=11]="Entity";P[P.Qhh=12]="WolframAnswer";P[P.Eeh=13]="Insights";P[P.People=14]="People";P[P.Document=15]="Document";P[P.Yol=16]="Recommended";P[P.mpl=17]="ServiceClassifier";P[P.npl=18]="ServiceRecommended";P[P.Image=19]="Image";P[P.Notes=20]="Notes";P[P.Leh=21]="Learning";P[P.Feedback=22]="Feedback";P[P.Igh=23]="Template";P[P.ech=
24]="ActionAI";P[P.fch=25]="ActionAICommand";P[P.xgh=26]="SummarizeDeck";P[P.ich=27]="Addin";P[P.gfh=28]="OfficeScript";P[P.kch=29]="AddinStoreEntry";P[P.Formula=30]="Formula";P[P.None=31]="None";P[P.gol=32]="MergedActions";P[P.hol=33]="MergedScopedSearches";P[P.iol=34]="MergedSuggestedSearches"})(qg||(qg={}));Object(n.b)("ResultGroupType",qg);var Bh=a(189);class Jh{constructor(P){this.xD=null;this.kM=-1;this.p5d=14;this.r5d=12;this.attributes=this.qld=this.query=null;this.Xlb=!1;this.lab=[];this.sg=
J.AFrameworkApplication.od;J.AFrameworkApplication.ea&&(this.p5d=J.AFrameworkApplication.ea.Rd("TellMeMaxTermedResults",this.p5d),this.r5d=J.AFrameworkApplication.ea.Rd("TellMeMaxZeroTermResults",this.r5d));this.pE=P}get Ri(){return this.lab}get c2c(){return this.qld}Xm(P){let ua=!1;for(let Xa=0;Xa<this.Ri.length;Xa++)if(31!==this.Ri[Xa].groupType&&this.Ri[Xa].groupType===P.groupType){this.Ond(this.Ri[Xa],P);ua=!0;break}ua||this.Ri.push(P)}Ond(P,ua){for(let Xa=0;Xa<ua.results.length;Xa++)P.An(ua.results[Xa])}vGg(P){const ua=
[];for(const Xa of this.Ri)Xa.groupType!==P&&ua.push(Xa);this.Ri.length!==ua.length&&(this.lab=ua)}Vqk(P){let ua=null,Xa=null,Pb=null;for(let hc=0;hc<P.length;hc++){const Qc=P[hc];if(Qc&&Qc.Ri&&Qc.Ri.length)for(const vd of Qc.Ri)if(17===vd.groupType||18===vd.groupType)ua=vd;else if(0===vd.groupType||16===vd.groupType)Xa=vd,Pb=Qc}ua&&Xa&&0<Xa.results.length&&(17===ua.groupType&&({vnd:Xa,Wnd:ua}=Id.xnd(Xa,ua,this.pE.Dz()?this.pE.Dz().iMi:-.6)),Pb.vGg(Xa.groupType))}GZk(){this.pE&&(new og.a,this.X7b(this.pE.cdg))}$Vb(P,
ua){return this.query.qe.length>this.pE.Dz().ZYi&&this.Quj(P,ua)||this.query.qe.length>this.pE.Dz().$Yi&&this.vxj(P,ua)?!0:!1}vxj(P,ua){return P&&P.length&&ua&&ua.length?-1===ua.toLowerCase().indexOf(P.toLowerCase())?!1:!0:!1}Quj(P,ua){return P&&P.length&&ua&&ua.length?ua.toLowerCase().startsWith(P.toLowerCase()):!1}RAi(P){const ua=[];for(const Xa of this.pE.Dz().dD?this.c2c:this.Ri)P.contains(Xa.groupType)||ua.push(Xa);this.pE.Dz().dD?this.qld=ua:this.lab=ua}cfl(P,ua){const Xa=[];for(const Pb of this.Ri){const hc=
Pb;if(13!==hc.groupType||24!==hc.groupType){const Qc=P[qg[hc.groupType].toLowerCase()];let vd="False";Qc<ua&&(vd="True");hc.displayName=hc.displayName+" ("+vd+": "+Qc+")"}Xa.push(hc)}this.lab=Xa}X7b(P,ua,Xa){ua=void 0===ua?!1:ua;Xa=void 0===Xa?null:Xa;if(this.pE.Dz().dD){if(!ua)for(this.qld=Array(this.Ri.length),ua=0;ua<this.Ri.length;ua++)this.c2c[ua]=this.Ri[ua];this.pE.ndg.X7b(this.Ri,this.c2c,this.query,P,Xa)}else{for(Xa=new og.a;this.Ri.length;){ua=this.Ri.pop();const Pb=qg[ua.groupType].toLowerCase(),
hc=P[Pb];if(Na.c(hc))throw Error.create("GroupId "+Pb+" missed from group SortingOrder");Xa.add(new Jc.a(hc,ua))}Xa.Sc((Pb,hc)=>Pb.key<hc.key?-1:1);for(P=0;P<Xa.count;P++)ua=Xa.pa(P).value,this.Ri.push(ua)}}HZk(){var P=!1;let ua=!1,Xa=!1;for(let hc=0;hc<this.Ri.length;hc++){var Pb=this.Ri[hc];const Qc=Pb.groupType;if(8===Qc||15===Qc||14===Qc){Pb=Pb.results;for(let vd=0;vd<Pb.length;vd++){if(8===Qc&&this.$Vb(this.query.qe,Pb[vd].label)){P=!0;break}if(15===Qc&&this.$Vb(this.query.qe,Pb[vd].label)){ua=
!0;break}if(14===Qc){if(this.$Vb(this.query.qe,Pb[vd].label)||this.$Vb(this.query.qe,Pb[vd].description)){Xa=!0;break}const Nd=Pb[vd].label.split(" ");for(const ke of Nd)if(this.$Vb(this.query.qe,ke)){Xa=!0;break}}}}}P=this.pE.K_i(P,ua,Xa);this.X7b(P)}o2a(P,ua,Xa,Pb,hc,Qc){if(hc===this.xD){var vd=P.data.responseData;hc=null;try{hc=Ic.b(vd)}catch(Jg){Rc.instance.kf().onError("OnSuccessCallBack","Exception occured while deserializing ranker inference response:"+Jg);return}if("RankerResults"in hc&&hc.RankerResults){this.wba();
var Nd=hc.RankerResults,ke=new og.a,Be=new og.a;vd=0;for(var Ze of Nd){Nd=Ze.ProviderId;var of=Ze.Score;vd+=of;ke.add(new Jc.a(Nd,of))}ke.Sc((F,va)=>F.value>va.value?-1:1);of=Qc?Qc.E0i:1E-6;Ze={};Nd={};let Jg=0;for(var Xf=0;Xf<ke.count;Xf++){const F=parseInt(ke.pa(Xf).key),va=ke.pa(Xf).value/vd;1===F&&(Nd.answer=Jg++,Nd.entity=Jg++,Nd.definition=Jg++,Nd.wolframanswer=Jg++,va<of&&(Be.add(9),Be.add(11),Be.add(10),Be.add(12)),Ze.answer=va,Ze.entity=va,Ze.definition=va,Ze.wolframanswer=va);2===F&&(Nd.assistance=
Jg++,va<of&&Be.add(8),Ze.assistance=va);3===F&&(Nd.classifier=Jg++,Nd.serviceclassifier=Jg++,va<of&&(Be.add(0),Be.add(17)),Ze.classifier=va,Ze.serviceclassifier=va);4===F&&(Nd.people=Jg++,va<of&&Be.add(14),Ze.people=va);5===F&&(Nd.document=Jg++,va<of&&Be.add(15),Ze.document=va);6===F&&(Nd.findindocument=Jg++,va<of&&Be.add(2),Ze.findindocument=va);7===F&&(Nd.notes=Jg++,va<of&&Be.add(20),Ze.notes=va);8===F&&(Nd.image=Jg++,va<of&&Be.add(19),Ze.image=va)}ke=new og.a;ke.add("classifier");ke.add("serviceclassifier");
ke.add("appsforoffice");ke.add("addin");ke.add("findindocument");ke.add("assistance");ke.add("document");ke.add("people");ke.add("answer");ke.add("wolframanswer");ke.add("definition");ke.add("entity");ke.add("image");ke.add("template");ke.add("officescript");ke.add("formula");for(Xf=0;Xf<ke.count;Xf++)ke.pa(Xf)in Nd||(Nd[ke.pa(Xf)]=Jg++);Nd.learning=Jg++;Nd.insights=Jg++;Nd.actionai=Jg++;Nd.actionaicommand=Jg++;Nd.feedback=Jg++;Qc&&Qc.ptj&&this.cfl(Ze,of);Qc&&Qc.qtj&&this.RAi(Be);Be={};for(var bg in Ze)Be[bg]=
Ze[bg]*vd;this.X7b(Nd,!0,Be)}if(Qc.uZd&&"Intents"in hc&&hc.Intents){bg=hc.Intents;for(var Mg of bg)if(this.B_d(Mg)&&"Serplet"===Mg.GroupType&&Mg.ConfidenceScore>Mg.ConfidenceThreshold){bg=!1;hc=0;if(Qc.vZd){vd=new Xd("",33);for(Be=0;Be<this.Ri.length;Be++)if((ke=this.Ri[Be].results)&&0<ke.length){hc=Be;vd=ke[0];break}2===vd.groupType&&(bg=!0)}vd=new Hd(13);bg&&Qc.vZd&&(vd=new Hd(13,Object(pc.a)("TellMeWebTitle")));Be=new Xd("SmartLookupFromTellMeQueryTermAtTop",10,this.query.qe,null,0);ke=[];Ze=null;
Ze=bd.G2()?bd.Qra(this.query.qe,1):bd.zzd(this.query.qe);ke.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",Ze));Ze=String.format(Object(pc.a)("SeeMoreResultsButtonTextAtTop"),this.query.qe);ke.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",Ze));appChrome.api.dispatch(ke);vd.An(Be);Be=[];if(bg&&Qc.vZd)for(Be.push(this.Ri[hc]),Be.push(vd),bg=hc+1;bg<this.Ri.length;bg++)(hc=this.Ri[bg].results)&&0<hc.length&&Be.push(this.Ri[bg]);else for(Be.push(vd),
bg=0;bg<this.Ri.length;bg++)(hc=this.Ri[bg].results)&&0<hc.length&&Be.push(this.Ri[bg]);this.lab=Be}}if(Qc.dWb&&!Qc.dD){Mg=bg=-1;for(hc=0;hc<this.Ri.length;hc++)switch(this.Ri[hc].groupType){case 23:bg=hc;break;case 0:case 17:case 2:-1===Mg&&(Mg=hc)}if(-1!==bg){Mg=-1===Mg?0:bg>Mg?Mg+1:Mg;bg=this.Ri[bg];hc=Array(this.Ri.length);vd=0;for(Be=0;Be<hc.length;Be++)Be===Mg?hc[Be]=bg:(23===this.Ri[vd].groupType&&vd++,hc[Be]=this.Ri[vd],vd++);this.lab=hc}}Pb.Ll(this);Pb=Rc.instance.kf();Pb.b9(ua.length,"RankerInference",
P.data.httpStatus.toString(),Math.round(window.performance.now()-Xa),"TellMeRanker",!0,"HttpRequest");this.Xlb&&Pb&&(P=this.query.$Ka,ua=Pb.Rcc,Qc.BIc&&P>ua&&!Qc.dD&&(Pb.j3d(this.query.qe),Pb.Soe(P)))}}B_d(P){if("GroupType"in P&&P.GroupType&&"ConfidenceScore"in P&&"ConfidenceThreshold"in P)return!0;Rc.instance.kf().onError("IsValidIntentGroup","Invalid intents found");return!1}Z1a(P,ua,Xa,Pb,hc){Pb===this.xD&&(this.wba(),Rc.instance.kf().b9(ua.length,"RankerInference",P.data.httpStatus.toString(),
Math.round(window.performance.now()-Xa),"TellMeRanker",!1,"HttpRequest"));hc.Ll(this)}wba(){-1!==this.kM&&(window.clearTimeout(this.kM),this.kM=-1)}IZk(P){let ua;ua=this.pE.Dz().dD?Rc.instance.kf().HOd(this.c2c,this.query.qe):Rc.instance.kf().HOd(this.Ri,this.query.qe);var Xa=this.pE.Dz().D0i;""!==Xa&&(Xa="_"+Xa);let Pb="";this.pE.Dz().JXd&&(Pb="RankerInference"+Xa+",");this.pE.Dz().uZd&&(Pb+="SerpletClassifier");","===Pb.charAt(Pb.length-1)&&(Pb=Pb.substring(0,Pb.length-1));Xa=Rc.instance.kf().xOf(Pb);
const hc=this.xD=Bh.a.create().toString();Xa["Client-Request-Id"]=hc;const Qc=window.performance.now(),vd=this.pE.Dz()?this.pE.Dz().F0i:600;this.wba();this.kM=window.setTimeout(()=>{if(hc===this.xD){this.xD="";this.kM=-1;P.Ll(this);const Nd={Provider:"Ranker"};Nd.QueryID=this.query.$Ka;Rc.instance.kf().jR(qd.timedOut,vd,Nd)}},vd);this.sg.Wn(Rc.instance.kf().yOf(),2,ua,Xa,!1,0,Nd=>{this.o2a(Nd,this.query.qe,Qc,P,hc,this.pE.Dz())},Nd=>{this.Z1a(Nd,this.query.qe,Qc,hc,P)},null,null,!1,4E3,6E3)}E8k(){var P=
0,ua=new og.a,Xa=this.pE.adg,Pb=this.pE.bdg;for(var hc=0;hc<this.Ri.length;hc++){var Qc=this.Ri[hc],vd=qg[Qc.groupType].toLowerCase(),Nd=Xa[vd];P+=Qc.results.length;Qc.results.length>Nd&&(vd=Pb[vd],Na.c(vd)||ua.add(new Jc.a(vd,Qc)))}Pb=!this.query||""===this.query.qe.trim();hc=P-(Pb?this.r5d:this.p5d);if(!(0>=hc)){Pb=window.performance.now();P=P.toString()+" total,"+hc.toString()+" to remove.";if(0<ua.count)for(ua.Sc((ke,Be)=>ke.key>Be.key?-1:1),Qc=0;Qc<ua.count&&0<hc;Qc++){vd=ua.pa(Qc).value;Nd=
qg[vd.groupType].toLowerCase();let ke=vd.results.length-Xa[Nd];ke>hc&&(ke=hc);0<ke&&(vd.iie(ke),P+=Nd+": "+ke.toString()+" results removed.",hc-=ke)}if(0<hc){P+=hc.toString()+" results left after trimming.";ua=new og.a;Xa=this.pE.fdg;for(Qc=0;Qc<this.Ri.length;Qc++)vd=this.Ri[Qc],Nd=Xa[qg[vd.groupType].toLowerCase()],Na.c(Nd)||ua.add(new Jc.a(Nd,vd));ua.Sc((ke,Be)=>ke.key<Be.key?-1:1);for(Xa=0;0<hc;)Qc=ua.pa(Xa++).value,hc>=Qc.results.length?(Array.remove(this.Ri,Qc),P+=qg[Qc.groupType]+": "+Qc.results.length.toString()+
" results force removed.",hc-=Qc.results.length):(Qc.iie(hc),P+=qg[Qc.groupType]+": "+hc.toString()+" results force removed.",hc=0)}Rc.instance.kf()&&(ua={},ua.Message=P,Rc.instance.kf().jR("ShowOptimal",window.performance.now()-Pb,ua))}}}Object(n.a)(Jh,"CombineResultsUpdatedEventArgs",null,[521]);class Rh{constructor(P,ua,Xa,Pb,hc){this.Mgd=this.bid=!1;this.$G=P;this.YQa=[];this.MVe=ua.length;this.Db=Rc.instance.Dz();this.nfc=void 0===Pb?!1:Pb;this.oCa=void 0===hc?"":hc;this.Oab={};for(P=0;P<ua.length;++P)this.Oab[P.toString()]=
Xa?0:ua[P].RF()}hMk(P,ua){ua&&ua.query&&ua.query.$Ka<Rc.instance.vsc()||(this.YQa[P]=ua,this.Mgd?this.bid=!0:(!this.Db||3!==this.Db.jm||3!==this.Oab[P.toString()]||this.Yof())&&this.MHa())}vak(){this.Mgd=!0}cal(){this.Mgd=!1;this.bid&&(this.bid=!1,this.MHa())}Yof(){if(this.YQa.length<this.MVe)return!1;for(let P=0;P<this.MVe;++P)if(!this.YQa[P])return!1;return!0}MHa(){var P=this.Yof();const ua=window.performance.now(),Xa=new Jh(Rc.instance.TLd());Xa.Vqk(this.YQa);for(var Pb=0;Pb<this.YQa.length;++Pb){var hc=
this.YQa[Pb];if(hc&&hc.Ri&&hc.Ri.length&&(Xa.query=hc.query,hc.attributes&&0<hc.attributes.length&&(Xa.attributes=hc.attributes),hc&&hc.Ri&&(P||this.UXh(Pb,this.YQa))))for(const Qc of hc.Ri)Xa.Xm(Qc)}Xa.Ri&&Xa.Ri.length&&(Xa.Xlb=P,this.Db&&this.Db.rye&&Xa.E8k(),this.Db&&this.Db.hwj&&Xa.query.qe&&0<Xa.query.qe.length?Xa.HZk():Xa.GZk(),this.Db&&(this.Db.JXd||this.Db.uZd)&&this.nfc&&Xa.query.qe&&0<Xa.query.qe.length&&Xa.Xlb&&this.oCa!==nd.contextMenu?(3===this.Db.jm&&P||this.$G.Ll(Xa),Xa.IZk(this.$G)):
this.$G.Ll(Xa),P=Rc.instance.kf(),Xa.Xlb&&P&&(Pb=Xa.query.$Ka,hc=P.Rcc,Xa.query.qe&&0<Xa.query.qe.length&&this.nfc&&this.Db.BIc&&this.oCa!==nd.contextMenu&&Pb>hc&&!this.Db.JXd&&!this.Db.dD&&(P.j3d(Xa.query.qe),P.Soe(Pb)),P.jR(qd.cAk,window.performance.now()-ua)))}UXh(P,ua){if(!(this.Oab&&P.toString()in this.Oab)||ua.length<=P||!ua[P])return!1;if(!ua[P].Ri.length)return!0;const Xa=this.Oab[P.toString()];if(0===Xa)return!0;const Pb=this.Oab;for(const Qc in Pb){var hc=Pb[Qc];const vd=Number.parseInvariant(Qc);
if(vd!==P&&hc===Xa&&!(ua.length>vd&&ua[vd]))return!1}return!0}}Object(n.a)(Rh,"ResultsAggregator",null,[]);var hi=a(696);class Ni{constructor(P,ua,Xa,Pb,hc,Qc){this.lastModified=this.size=this.uniqueId=this.spWebUrl=this.url=this.fileType=null;this.fileType=P;this.url=ua;this.spWebUrl=Xa;this.uniqueId=Pb;this.size=hc;this.lastModified=Qc}}Object(n.a)(Ni,"FileInfo",null,[]);class Eh{constructor(P,ua){this.DimensionValue=this.DimensionName=null;this.DimensionName=P;this.DimensionValue=ua}}Object(n.a)(Eh,
"Dimension",null,[]);class ri{constructor(P,ua,Xa,Pb,hc){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=P;this.Query=ua;this.From=Xa;this.Size=Pb;hc&&(this.Filter=hc)}}Object(n.a)(ri,"EntityRequest",null,[]);class Oi{constructor(P){this.QueryString=null;this.QueryString=P}}Object(n.a)(Oi,"Query",null,[]);class Gh{constructor(P,ua){this.Dimensions=this.Name=null;this.Name=P;this.Dimensions=ua}}Object(n.a)(Gh,"Scenario",null,[]);class bi{constructor(P,ua,Xa,Pb){this.Scenario=
this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=P;this.TimeZone=ua;this.Cvid=Xa;this.Scenario=Pb}}Object(n.a)(bi,"SubstrateBody",null,[]);var Ig=a(1348),Ci=a(1349);class ci{constructor(P){this.tCb=this.XBa=this.sgc=this.kAb=this.ICb=0;this.uTe=this.$Ue=this.xD=null;this.ted=0;this.kM=-1;this.XDb="";this.Jad=!1;this.sg=J.AFrameworkApplication.od;this.Db=P;this.Tic=this.JOd();this.dRa=new hi.a;this.qSe=this.Db.rye?3:2;this.Ikd=this.Db.rye&&this.Db.VWg?5:3;this.bmd=this.Db.UYc?2:
3;this.F0e=1;this.Zfc=this.Db.DLf;this.MYe=this.Db.axj;this.hDb=P.VNf;J.AFrameworkApplication.ea&&(this.$Ue=J.AFrameworkApplication.ea.Qa("AppCatalogUrl")+J.AFrameworkApplication.ea.Qa("SearchPersonaPhotoBaseUrl"),this.Jad=this.Db.Vuc||this.Db.EX||this.Db.Xuc);this.Db.EX&&(this.bmd=this.Ikd=5)}Hx(){return"Substrate"}RF(){return 0===this.Db.jm?0:1===this.Db.jm?1:3}Nx(P,ua,Xa,Pb,hc){Pb=void 0===Pb?nd.tellMe:Pb;hc=void 0===hc?null:hc;const Qc=new Zc(P);if(!hc||Array.contains(hc,14)||Array.contains(hc,
15)||Array.contains(hc,20))if(!this.ted||window.performance.now()-this.ted>=bd.c3g)if(Xa=this.dRa.kOf())this.ted=window.performance.now(),Xa.then(vd=>{vd&&""!==vd?(this.XDb=vd,""!==this.xD&&this.jOf(P,Pb,this.XDb,ua,hc)):(Rc.instance.kf().onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),ua.Ll(Qc))},vd=>{Rc.instance.kf().onError("SubstrateResultsProvider:IssueQuery","SubstrateTokenPromise rejected "+vd);ua.Ll(Qc)});else{if(Rc.instance.kf())Rc.instance.kf().onError("SubstrateResultsProvider:IssueQuery",
"undefined token promise");ua.Ll(Qc)}else this.XDb&&""!==this.XDb?this.jOf(P,Pb,this.XDb,ua,hc):(ua.Ll(Qc),Rc.instance.kf().onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else ua.Ll(Qc)}wV(){this.XBa=this.tCb=this.sgc=this.kAb=this.ICb=0}jOf(P,ua,Xa,Pb,hc){this.wV();const Qc=new Zc(P),vd=this.xD=Bh.a.create().toString();this.wba();this.kM=window.setTimeout(()=>{if(vd===this.xD){this.xD="";this.kM=-1;Pb.Ll(Qc);const Be={};Be.Provider=this.Hx();Be.QueryID=P.$Ka;Rc.instance.kf().jR(qd.timedOut,
this.hDb,Be)}},this.hDb);const Nd={"Content-Type":"application/json",Accept:"application/json"};Nd.Authorization="Bearer "+Xa;Nd["X-Office-Version"]=J.AFrameworkApplication.buildVersion;Nd["X-Office-Application"]=J.AFrameworkApplication.ea.Qa("Application");Nd["X-Office-Platform"]="WAC";Nd["X-TellMe-SessionId"]=Rc.instance.hjb();Nd["X-TellMe-Culture"]=J.AFrameworkApplication.uiCulture;Nd["X-TellMe-ProcessSessionId"]=J.AFrameworkApplication.userSessionId;Nd["Client-Request-Id"]=vd;const ke=window.performance.now();
this.sg.Wn(this.a2i(),2,this.b2i(P.qe,this.Db.application,Rc.instance.hjb(),bd.Nz(P)),Nd,!1,0,Be=>{this.o2a(Be,P,Pb,vd,ke,ua,hc)},Be=>{this.Z1a(Be,P,Pb,vd,ke)},null,null,!1,4E3,6E3)}wba(){-1!==this.kM&&(window.clearTimeout(this.kM),this.kM=-1)}o2a(P,ua,Xa,Pb,hc,Qc,vd){Rc.instance.kf().b9(ua.qe.length,this.Tic.join(","),P.data.httpStatus.toString(),Math.round(window.performance.now()-hc),"Substrate",!0,"HttpRequest");const Nd=bd.Nz(ua),ke=new Zc(ua);if(Pb===this.xD){this.wba();P=Ic.b(P.data.responseData);
if(P.Groups){P=P.Groups;for(const Be of P)"People"===Be.Type&&this.Db.$8b&&(vd?Array.contains(vd,14):1)?(P=this.YLf(Be.Suggestions,Nd,Qc),0<P.results.length&&ke.Xm(P)):"File"===Be.Type&&this.Db.Z8b&&(vd?Array.contains(vd,15):1)?(P=this.qLd(Be.Suggestions,Nd,Qc),0<P.results.length&&(this.pGc()&&(Pb=new Xd("GenerateSlidesFromTellMe",30,"",null,1),P.An(Pb)),ke.Xm(P))):"Notes"===Be.Type&&this.Db.FIa&&Qc!==nd.contextMenu&&(vd?Array.contains(vd,20):1)&&(P=this.wLf(Be.Suggestions,Nd,ua),0<P.results.length&&
ke.Xm(P))}Xa.Ll(ke);Rc.instance.kf().b9(ua.qe.length,this.Tic.join(","),"",Math.round(window.performance.now()-hc),"",!0,"Provider")}else Xa.Ll(ke)}wLf(P,ua,Xa){const Pb=new Hd(20);Pb.displayName=Object(pc.a)("TellMeNotesProviderTitle");for(const hc of P)this.Gyj(hc)&&(P=hc.NotesType,P=oa.a.wm(P),P=this.xWi(P,hc.LastModifiedTime,hc.BodyPreview,hc.Subject,ua,Xa,hc))&&(P.groupType=20,Pb.An(P));return Pb}YLf(P,ua,Xa){const Pb=new Hd(14);Pb.displayName=Object(pc.a)("TellMePeopleProviderTitle");for(const Qc of P)if(this.Hyj(Qc)){var hc=
Qc.Id.split("@")[0];P=Qc.EmailAddresses[0];let vd=Qc.Type;if(void 0===vd||null===vd)vd="User";if(hc=this.FXi(vd,Qc.DisplayName,Qc.JobTitle,P,hc,Xa,ua))hc.description=P,P=Qc.JobTitle,"Department"in Qc&&"CompanyName"in Qc&&(P+="@"+Qc.Department+"@"+Qc.CompanyName),hc.additionalInfo=P,Pb.An(hc)}return Pb}qLd(P,ua,Xa){const Pb=new Hd(15);Pb.displayName=Object(pc.a)("TellMeFileProviderTitle");for(const Be of P)if(this.zyj(Be)){var hc=Be.FileName;P=Be.FileExtension;var Qc=hc;hc.length>P.length&&Qc.endsWith(P)&&
(Qc=hc.substr(0,hc.length-P.length-1));var vd=void 0,Nd=0;"DateCreated"in Be&&Be.DateCreated?(Nd=bd.VOd(Be.DateCreated),vd=bd.DOf(Be.DateCreated),vd=String.format(Object(pc.a)("CreatedTimeFormatString"),Be.Author,vd)):vd=Be.Author;var ke=Be.AccessUrl+"?web=1";const Ze=oa.a.bkb(ke);hc=String.format('<a href="{0}">{1}</a>',Ze,oa.a.$l(hc));if(Xa!==nd.contextMenu||oa.a.nda(ke))if(Qc=this.FQi(Qc,Xa===nd.contextMenu?hc:ke,vd,Be.FileExtension,Be.Text,ua))Qc.description=Be.Author,Qc.fmc=Nd,Pb.An(Qc),this.Jad&&
(Nd=Be.AccessUrl,hc=bd.Jzc(P),vd=Be.DateModified?Be.DateModified:Be.DateCreated,ke=Be.Size?Be.Size:Be.FileSize,this.RRk()&&(Nd=Nd.replace(RegExp("%20","g")," "),hc=bd.r1i(P)),P=new Ni(hc,Nd,Be.SPWebUrl,Be.Id,ke,vd),Rc.instance.h$b(!1,Qc.value,P))}return Pb}Z1a(P,ua,Xa,Pb,hc){Pb===this.xD&&(this.wba(),Rc.instance.kf().b9(ua.qe.length,this.Tic.join(","),P.data.httpStatus.toString(),Math.round(window.performance.now()-hc),"Substrate",!1,"HttpRequest"));P=new Zc(ua);Xa.Ll(P)}FXi(P,ua,Xa,Pb,hc,Qc,vd){vd=
vd?this.F0e:this.qSe;if(!window.LPC&&!bd.QVd()||this.ICb===vd)return null;this.ICb+=1;vd="PeopleSuggestion"+this.ICb.toString();var Nd=this.$Ue+"?size=1&accountName="+Pb;P=Object.assign(new Ig.a,{PersonaType:P,Smtp:Pb,ProfilePictureUrl:Nd,AadObjectId:hc});const ke=Object.assign(new Ci.a,{identifiers:P,displayName:ua});P=Qc===nd.contextMenu;this.Db.J7?(Rc.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(vd,ke,ua,Xa)),Qc===nd.contextMenu&&(Xa=bd.Alf(ua,Pb,hc),Rc.instance.actions.push(appChrome.actions.setButtonCommandValueId(vd,
Xa))),Rc.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(vd,P))):(Nd=[],Nd.push(appChrome.actions.setPersonaButtonCoauthor(vd,ke,ua,Xa)),Qc===nd.contextMenu&&(Xa=bd.Alf(ua,Pb,hc),Nd.push(appChrome.actions.setButtonCommandValueId(vd,Xa))),Nd.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(vd,P)),appChrome.api.dispatch(Nd));return new Xd(vd,11,ua,Pb,0)}xWi(P,ua,Xa,Pb,hc,Qc,vd){if(hc&&!this.Db.F5f||this.sgc===this.Zfc||this.tCb===this.Zfc||this.XBa===
this.Zfc)return null;var Nd=null;this.sgc+=1;hc="";const ke=[],Be={};vd.type="Notes";this.uTe=Object.assign(new yb,{landingTab:"Notes",data:vd});Qc=bd.Qra(Qc.qe,33,this.uTe);if("onenotepagepreviews"===P){if(!("ClickthroughUrl"in vd&&vd.ClickthroughUrl)||""===vd.ClickthroughUrl)return null;this.tCb+=1;hc="OnenoteNotesSuggestion"+this.tCb.toString();Be["default"]="SaveAsonetoc2_20";Nd=vd.ClickthroughUrl;ke.push(appChrome.actions.setControlIconSet(hc,Be));ke.push(appChrome.actions.setCompoundButtonCommandValueId(hc,
Nd));Nd=new Xd(hc,19,null,null,0)}else if("stickynote"===P){if(!this.MYe)return null;this.XBa+=1;hc="NotesSuggestion"+this.XBa.toString();Be["default"]="ShowAllNotes_20";ke.push(appChrome.actions.setControlIconSet(hc,Be));ke.push(appChrome.actions.setCompoundButtonCommandValueId(hc,Qc));Nd=new Xd(hc,21,null,null,0)}else if("samsung"===P){if(!this.MYe)return null;this.XBa+=1;hc="NotesSuggestion"+this.XBa.toString();Be["default"]="CategoryCollapsed_20";ke.push(appChrome.actions.setControlIconSet(hc,
Be));ke.push(appChrome.actions.setCompoundButtonCommandValueId(hc,Qc));Nd=new Xd(hc,20,null,null,0)}""!==hc&&(P=bd.DOf(ua),P=String.format(Object(pc.a)("LastModifiedString"),P),Nd.label=Pb,Nd.fmc=bd.VOd(ua),ke.push(appChrome.actions.setControlLabel(hc,Pb)),ke.push(appChrome.actions.updateCompoundButtonDescription(hc,P)),ke.push(appChrome.actions.setControlCustomTooltip(hc,Xa)),appChrome.api.dispatch(ke));return Nd}FQi(P,ua,Xa,Pb,hc,Qc){if(this.kAb===(Qc?this.bmd:this.Ikd)||this.Jad&&"Word"!==bd.Jzc(Pb))return null;
this.kAb+=1;Qc="FileSuggestion"+this.kAb.toString();const vd=[],Nd={};Nd["default"]=bd.VSi(Pb);this.Db.J7?(Rc.instance.actions.push(appChrome.actions.setControlLabel(Qc,P)),Rc.instance.actions.push(appChrome.actions.setControlIconSet(Qc,Nd)),Rc.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(Qc,Xa)),Rc.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(Qc,ua)),Rc.instance.actions.push(appChrome.actions.setControlCustomTooltip(Qc,hc))):(vd.push(appChrome.actions.setControlLabel(Qc,
P)),vd.push(appChrome.actions.setControlIconSet(Qc,Nd)),vd.push(appChrome.actions.updateCompoundButtonDescription(Qc,Xa)),vd.push(appChrome.actions.setCompoundButtonCommandValueId(Qc,ua)),vd.push(appChrome.actions.setControlCustomTooltip(Qc,hc)),appChrome.api.dispatch(vd));return new Xd(Qc,6,P,Xa,0)}JOd(){const P=[];this.Db.$8b&&Array.add(P,"People");this.Db.Z8b&&Array.add(P,"File");this.Db.FIa&&Array.add(P,"Notes");return P}b2i(P,ua,Xa,Pb){var hc=new Oi(P);P=new ri("File",hc,0,Pb?this.bmd:this.Ikd,
null);Pb=new ri("People",hc,0,Pb?this.F0e:this.qSe,bd.Eak);hc=new ri("Notes",hc,0,this.Zfc,null);(this.Db.Vuc||this.Db.Xuc)&&"powerpoint"===ua.toLowerCase()&&(ua="word");ua=new Eh("app",ua.toLowerCase());var Qc=[];Array.add(Qc,ua);ua=new Gh("tellmesearch",Qc);Qc=[];this.Db.Z8b&&Array.add(Qc,P);this.Db.$8b&&Array.add(Qc,Pb);this.Db.FIa&&Array.add(Qc,hc);Xa=new bi(Qc,"UTC",Xa,ua);return Ic.c(Xa)}a2i(){let P=this.Db.H1k;this.Db.FIa&&(P+="?&setflight=NotesFrom3S");""!==this.Db.lOf&&(P=P+"&"+this.Db.lOf);
return P}Hyj(P){return"DisplayName"in P&&"Id"in P&&"EmailAddresses"in P&&!!P.Id&&!!P.EmailAddresses}zyj(P){return"FileExtension"in P&&!!P.FileExtension&&"FileName"in P&&!!P.FileName&&""!==P.FileName&&"AccessUrl"in P&&!!P.AccessUrl&&""!==P.AccessUrl}Gyj(P){return"Id"in P&&!!P.Id&&"NotesType"in P&&!!P.NotesType&&"Subject"in P&&!!P.Subject&&""!==P.Subject}pGc(){return!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",
!1)}RRk(){return!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldPerformFileInfoFixes",!0)}}Object(n.a)(ci,"SubstrateResultsProvider",null,[512]);class di{constructor(){this.Pvb=this.Qvb=this.Ovb=this.KXb=this.Knb=this.Ckb=0}Bzh(P,ua){switch(P){case 1:this.Ckb=ua;break;case 3:this.Knb=ua;break;case 2:this.KXb=ua;break;case 5:this.Ovb=ua;break;case 4:this.Qvb=ua;break;case 6:this.Pvb=ua}}}Object(n.a)(di,"CommandFeatures",null,[]);class Vi{constructor(P){this.TLe=
0;this.haa=P;this.rkh={}}get modelId(){return this.haa}get zzi(){return this.TLe}get gJb(){return this.rkh}Nyh(P,ua,Xa){0===ua?this.TLe=Xa:(this.gJb[P]||(this.gJb[P]=new di),this.gJb[P].Bzh(ua,Xa))}}Object(n.a)(Vi,"CoefficientsModel",null,[]);const Ch=(P,ua)=>Math.pow(10,-ua/(60*Math.LN10/Math.LN2*P));class Pi{constructor(P,ua){this.Fsh=P;this._count=1;this.wPa=new di;this.features.KXb=1+Math.log(this.count)/Math.LN2;this.features.Ckb=P?1/P:0;this.features.Knb=2/Math.pow(2,P);this.features.Ovb=Ch(10,
ua);this.features.Qvb=Ch(2,ua);this.features.Pvb=Ch(1,ua)}get rank(){return this.Fsh}get count(){return this._count}get features(){return this.wPa}Eej(){this._count=this.count+1;this.features.KXb=1+Math.log(this.count)/Math.LN2}Xel(P){const ua=2/Math.pow(2,P);this.features.Ckb=Math.max(this.features.Ckb,P?1/P:0);this.features.Knb=Math.max(this.features.Knb,ua)}Rfl(P){const ua=Ch(10,P),Xa=Ch(2,P);P=Ch(1,P);this.features.Ovb=Math.max(this.features.Ovb,ua);this.features.Qvb=Math.max(this.features.Qvb,
Xa);this.features.Pvb=Math.max(this.features.Pvb,P)}}Object(n.a)(Pi,"CommandModel",null,[]);class Di{constructor(P){this.Tyb=null;if(!P&&Rc.instance.kf())Rc.instance.kf().onError("PredictionEngine","IModelAdapter can't be null");this.K$a=P;this.kgc=this.p2d()}p2d(){const P=this.K$a.qVi(),ua=this.K$a.MMd();if(void 0===P||null===P||void 0===ua||null===ua)return!1;try{window.performance.now();this.Tyb={};for(let Xa=0;Xa<P.length;Xa++){const Pb=P[Xa],hc=ua[Pb[0].toString()].trim(),Qc=Pb[1],vd=0!==Qc?
ua[Pb[2].toString()].trim():"",Nd=Pb[3];hc in this.Tyb||(this.Tyb[hc]=new Vi(hc));this.Tyb[hc].Nyh(vd,Qc,Nd)}}catch(Xa){if(Rc.instance.kf())Rc.instance.kf().onError("LoadModelData","Error Loading Suggestions Model: "+Xa);return!1}return!0}TGi(){const P=this.K$a.oTi(),ua={};if(!P)return ua;let Xa=1;for(let Pb=0;Pb<P.length;Pb++){const hc=P[Pb];hc.Id in ua?(ua[hc.Id].Eej(),ua[hc.Id].Xel(Xa),ua[hc.Id].Rfl(hc.TimeElapsedSinceClick)):ua[hc.Id]=new Pi(Xa,hc.TimeElapsedSinceClick);Xa++}return ua}Jlb(){this.kgc||
(this.kgc=this.p2d());return this.kgc}kYi(){let P=[];if(!this.kgc){if(Rc.instance.kf())Rc.instance.kf().onError("GetPredictedCommands","IModelAdapter returned no data");return P}const ua=this.TGi(),Xa=this.Tyb;for(const hc in Xa){const Qc=Xa[hc],vd=Qc.modelId;let Nd=0;for(const ke in ua){var Pb=ke;const Be=ua[ke].features;(Pb=Pb in Qc.gJb?Qc.gJb[Pb]:null)&&(Nd+=Be.Ckb*Pb.Ckb+Be.Knb*Pb.Knb+Be.KXb*Pb.KXb+Be.Ovb*Pb.Ovb+Be.Qvb*Pb.Qvb+Be.Pvb*Pb.Pvb)}Nd+=Qc.zzi;P.push(new Ec(vd,Nd))}P.sort((hc,Qc)=>hc.score<
Qc.score?1:hc.score>Qc.score?-1:0);0<P.length-10&&(P=P.slice(0,10));return P}}Object(n.a)(Di,"PredictionEngine",null,[]);class Wi{constructor(){this.OXe={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),
"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),
"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),
"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),
"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}jzc(P,ua){return ua&&"word"===ua.application.toLowerCase()&&P in this.OXe?this.OXe[P]:[]}}Object(n.a)(Wi,"SuggestionResultsUtility",null,[]);class Wh{constructor(P,ua,Xa){this.Db=ua;this.bCb=new Di(P);this.jaa=Xa;this.qZe=new Wi}Hx(){return"Suggestion"}RF(){return 0===this.Db.jm?0:1===this.Db.jm?1:2}Nx(P,ua,Xa,Pb,hc){Pb=void 0===Pb?nd.tellMe:
Pb;hc=void 0===hc?null:hc;Xa=new Zc(P);Rc.instance.Dza=!1;if(!hc||Array.contains(hc,16))if(J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.UpdateTellMeSuggestions",!1)&&"powerpoint"===this.Db.application.toLowerCase()||bd.Nz(P)){if(!this.bCb.Jlb()){if(Rc.instance.kf())Rc.instance.kf().onError("CRASH","SuggestionResultsProvider: Found invalid Model data");throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}Date.now();
if(this.pZd()&&0<this.qZe.jzc(Rc.instance.OKb,this.Db).length){const vd=this.qZe.jzc(Rc.instance.OKb,this.Db);hc=[];for(var Qc of vd)this.Db.UYc&&"Find"===Qc||hc.push(new Ec(Qc,0));Rc.instance.Dza=!0}else hc=this.bCb.kYi();Id.Enb(hc,!0,"Recommended","LRE");Qc=[];for(const vd of hc)this.jaa&&this.jaa.HJb(vd.commandId)||Qc.push(vd);P=Id.CXa(P,Qc,this.Db,null,null,null,16,1);0<P.results.length&&Pb!==nd.contextMenu&&(P.displayName=Object(pc.a)("TellMeTryCommandTitle"));0<P.results.length&&Xa.Xm(P)}ua.Ll(Xa)}pZd(){return!!this.Db&&
(this.Db.pZd||this.Db.nzj)}}Object(n.a)(Wh,"SuggestionResultsProvider",null,[512]);class Sh{oTi(){return Rc.instance.hzc()}qVi(){return window.TellMeSuggestionModel}MMd(){return window.CoefficientModelIdMap}}Object(n.a)(Sh,"SuggestionsModelAdapter",null,[547]);class ah{constructor(P){this.Db=P;this.Tic=this.JOd()}Hx(){return"Add-ins"}RF(){return 0===this.Db.jm?0:1===this.Db.jm?1:3}Nx(P,ua){P=new Zc(P);ua.Ll(P)}eHa(P,ua,Xa){let Pb;Pb=this.Db.dD?new Hd(29):new Hd(27);Pb.displayName=Object(pc.a)("TellMeAddinProviderTitle");
Xa&&this.pXk(P.qe,ua,Pb)}pXk(P,ua,Xa){const Pb=[];let hc;hc=this.Db.Ylj?this.Db.dD&&this.Db.eDa?bd.hGa(String.format(Object(pc.a)("TellMeLaunchAddinDialogButtonText_1_Bolded"),P)):String.format(Object(pc.a)("TellMeLaunchAddinDialogButtonText_1"),P):this.Db.Zlj?this.Db.dD&&this.Db.eDa?bd.hGa(String.format(Object(pc.a)("TellMeLaunchAddinDialogButtonText_2_Bolded"),P)):String.format(Object(pc.a)("TellMeLaunchAddinDialogButtonText_2"),P):this.Db.dD&&this.Db.eDa?bd.hGa(String.format(Object(pc.a)("TellMeLaunchAddinDialogButtonText_0_Bolded"),
P)):String.format(Object(pc.a)("TellMeLaunchAddinDialogButtonText_0"),P);this.Db.J7?(Rc.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",hc)),Rc.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",P))):(Pb.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",hc)),Pb.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",P)),appChrome.api.dispatch(Pb));Xa.An(new Xd("LaunchAddinDialogFromTellMe",
29));ua.Xm(Xa)}JOd(){const P=[];this.Db.GEc&&Array.add(P,"Addin");return P}}Object(n.a)(ah,"AddinStoreResultsProvider",null,[512]);class ei{constructor(P){this.Db=P}Hx(){return"Template"}RF(){return 0===this.Db.jm?0:1===this.Db.jm?1:3}Nx(P,ua){P=new Zc(P);ua.Ll(P)}eHa(P,ua,Xa){var Pb=[];let hc;hc=this.Db.dD?this.Db.eDa?bd.hGa(String.format(Object(pc.a)("TellMeTemplateButtonTextV2Bolded"),P.qe)):String.format(Object(pc.a)("TellMeTemplateButtonTextV2"),P.qe):String.format(Object(pc.a)("TellMeTemplateButtonText"),
P.qe);Pb.push(appChrome.actions.setControlLabel("TemplateForSearch",hc));Pb.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",String.format(J.AFrameworkApplication.ea.Qa("TellMeTemplateProviderURL"),J.AFrameworkApplication.uiCulture,P.qe)));appChrome.api.dispatch(Pb);P=new Hd(23);P.displayName=Object(pc.a)("TellMeTemplateProviderTitle");Pb=new Xd("TemplateForSearch",24,null,null,0);Pb.label=Xa[0].Title?Xa[0].Title:"";Pb.description=Xa[0].Description?Xa[0].Description:"";P.An(Pb);
ua.Xm(P)}}Object(n.a)(ei,"TemplateResultsProvider",null,[512]);class Uh{constructor(P,ua,Xa){this.dCa=this.FDb=this.GDb=this.zic=!1;this.xD=null;this.kM=-1;this.Bpa=this.cEb=this.oCa=this.sRa=null;this.hRe=this.nRe=0;this.Db=P;const Pb=bd.G2();this.MAa=ua||[];this.sg=J.AFrameworkApplication.od;this.vYe=P.Sae;this.HDb=P.Rae;this.xic=Pb&&this.Eub();this.yic=Pb&&this.Gub();this.wYe=Pb&&this.Hub();this.Bic=this.Kub();this.Jjd=this.Iub();if((ua=P.Gve&&bd.Are(P))||P.EX)this.sRa=new ci(P),this.zic=P.Z8b;
ua&&(this.GDb=P.$8b,this.FDb=P.FIa,this.dCa=this.zic&&this.Oo("File")||this.GDb&&this.Oo("People")||this.FDb&&this.Oo("Notes"));this.wic=this.GSk();this.JDb=P.u0b;this.Aic=this.fTk();this.Hjd=this.FSk();this.Hab=this.TYc();this.NHe=this.M2i();this.zHe=new af(P);this.toh=new ff(P);this.Fvh=new ei(P);this.Aih=new ah(P);this.hDb=Xa;this.dRa=new hi.a;this.JDb&&(this.zHe=new af(P));P.EX&&(this.Hjd=this.Aic=this.JDb=this.dCa=this.FDb=this.GDb=this.Jjd=this.Bic=this.wYe=this.yic=this.xic=this.HDb=!1,J.AFrameworkApplication.ea&&
this.Oo("File")&&this.LVg()||this.Hab)&&(P=this.dRa.XOd("Search",J.AFrameworkApplication.ea.Qa("TellMeServiceAuthEndpointForSearch")),this.ANb(P,"TellMeService",!0),P=this.dRa.XOd("SmartLookup",J.AFrameworkApplication.ea.Qa("SmartLookupShredderServiceEndpoint")),this.ANb(P,"Shredder",!1));J.AFrameworkApplication.ea&&this.dCa&&this.Oo("File")&&this.LVg()&&(P=this.dRa.XOd("Search",J.AFrameworkApplication.ea.Qa("TellMeServiceAuthEndpointForSearch")),this.ANb(P,"TellMeService",!0))}Oo(P){return Array.contains(this.MAa,
P)?!0:!1}Hx(){return"TellMeService"}RF(){return 0===this.Db.jm?0:1===this.Db.jm?1:this.Oo("Command")||this.Oo("Recommended")?2:3}I2i(P){let ua="";if(!P&&this.Oo("Command")&&this.Db.PXd){ua+="CommandSearch_DLIS,";var Xa=this.Db.F1g;0<Xa.length&&(ua+=Xa+",")}P&&this.Oo("Recommended")&&this.HDb&&(Xa=this.m5i(),0<Xa.length&&(ua+=Xa+","));!P&&this.Oo("Help")&&(P=this.Db.E1g,0<P.length&&(ua+=P+","));this.Db.EX&&this.Bpa&&0<this.Bpa.length&&(ua+="IsRecallEnabled_true,");(this.Db.Vuc||this.Db.Xuc||this.Db.EX)&&
this.dCa&&(ua+="IsGenerateSlidesEnabled_true,");0<ua.length&&(ua=ua.substr(0,ua.length-1));return ua}ANb(P,ua,Xa){const Pb=Xa?this.nRe:this.hRe;if(!Pb||window.performance.now()-Pb>=bd.c3g)if(P)Xa?this.nRe=window.performance.now():this.hRe=window.performance.now(),P.then(hc=>{Xa?this.cEb=hc:(this.Bpa=hc,Rc.instance.F7b=hc)},hc=>{Rc.instance.kf().onError("TellMeServiceProvider:FetchTokenForService_"+ua,"tellMeServiceToken promise rejected: "+hc)});else if(Rc.instance.kf())Rc.instance.kf().onError("TellMeServiceProvider:FetchTokenForService_"+
ua,"undefined token promise")}Nx(P,ua,Xa,Pb,hc){Pb=void 0===Pb?nd.tellMe:Pb;hc=void 0===hc?null:hc;const Qc=new Zc(P);Xa=bd.Nz(P);this.Oo("File")&&(this.dCa||this.Db.EX)&&this.ANb(this.dRa.N2i(),"TellMeService",!0);(this.Oo("File")&&this.Db.EX||this.Oo("ActionAI")&&this.Hab)&&this.ANb(this.dRa.j1i(),"Shredder",!1);var vd=this.dCa&&!!this.cEb;const Nd=this.Db.EX&&!!this.Bpa;var ke=vd||Nd||Xa&&this.Oo("Recommended")&&this.HDb;vd=vd||Nd||!Xa&&(this.vYe&&this.Oo("Command")||this.xic&&this.Oo("Answer")||
this.yic&&this.Oo("Definition")||this.Jjd&&this.Oo("Image")||this.JDb&&this.Oo("Help")||this.Bic&&this.Oo("WolframAnswer")||this.Aic&&this.Oo("Template")||this.Hjd&&this.Oo("Addin"));if(ke||vd)if(this.oCa=Pb,Pb={"Content-Type":"application/json",Accept:"application/json"},Pb["X-Office-Version"]=J.AFrameworkApplication.buildVersion,Pb["X-Office-Application"]=J.AFrameworkApplication.ea.Qa("Application"),Pb["X-Office-Platform"]="WAC",Pb["X-TellMe-SqmUserId"]=J.AFrameworkApplication.ea.Qa("LoggableUserId")||
"",Pb["X-TellMe-SessionId"]=Rc.instance.hjb(),this.cEb&&(Pb.Authorization="Bearer "+this.cEb),this.Bpa&&0<this.Bpa.length&&(Pb["X-TellMe-ShredderToken"]="Bearer "+this.Bpa),ke=this.I2i(Xa),0<ke.length&&(Pb["X-TellMe-Flights"]=ke),ke=[],!Xa&&this.Oo("Answer")&&this.xic&&(hc?Array.contains(hc,9):1)&&Array.add(ke,"Answer"),!Xa&&this.Oo("Command")&&this.vYe&&!Id.RTb(P.qe)&&(hc?Array.contains(hc,17):1)&&Array.add(ke,"Command"),!Xa&&this.Oo("Definition")&&this.yic&&(hc?Array.contains(hc,10):1)&&Array.add(ke,
"Definition"),!Xa&&this.Oo("Help")&&this.JDb&&(hc?Array.contains(hc,8):1)&&Array.add(ke,"Help"),!Xa&&this.Oo("WolframAnswer")&&this.Bic&&(hc?Array.contains(hc,12):1)&&Array.add(ke,"WolframAnswer"),Xa&&this.Oo("Recommended")&&this.HDb&&!Rc.instance.Dza&&(hc?Array.contains(hc,18):1)&&Array.add(ke,"Recommended"),!Xa&&this.Oo("Image")&&this.Jjd&&(hc?Array.contains(hc,19):1)&&Array.add(ke,"Image"),this.cEb&&this.dCa&&(hc?Array.contains(hc,14)||Array.contains(hc,15)||Array.contains(hc,20):1)&&(this.sRa.wV(),
this.zic&&this.Oo("File")&&Array.add(ke,"File"),this.GDb&&this.Oo("People")&&Array.add(ke,"People"),this.FDb&&this.Oo("Notes")&&Array.add(ke,"Notes")),this.Bpa&&0<this.Bpa.length&&this.Db.EX&&(hc?Array.contains(hc,15):1)&&(this.sRa.wV(),this.Oo("File")&&Array.add(ke,"File")),!Xa&&this.Oo("Template")&&this.Aic&&(hc?Array.contains(hc,23):1)&&Array.add(ke,"Template"),!Xa&&this.Oo("Addin")&&this.Hjd&&(hc?Array.contains(hc,27):1)&&Array.add(ke,"Addin"),!Xa&&this.Oo("ActionAI")&&this.Hab&&(hc?Array.contains(hc,
25):1)&&Array.add(ke,"ActionAI"),ke.length){Pb["X-TellMe-SuggestionTypes"]=ke.join(",");Pb["X-TellMe-Culture"]=J.AFrameworkApplication.uiCulture;Pb["X-TellMe-ProcessSessionId"]=J.AFrameworkApplication.userSessionId;var Be=this.xD=Bh.a.create().toString();Pb["Client-Request-Id"]=Be;var Ze=window.performance.now();this.wba();this.kM=window.setTimeout(()=>{if(Be===this.xD){this.xD="";this.kM=-1;ua.Ll(Qc);const of={};of.Provider=this.Hx();of.QueryID=P.$Ka;Rc.instance.kf().jR(qd.timedOut,this.hDb,of)}},
this.hDb);this.sg.Wn(this.NHe,2,this.L2i(P.qe),Pb,!1,0,of=>{this.o2a(of,P,ua,Be,Ze,hc)},of=>{this.Z1a(of,P,ua,Be,Ze)},null,null,!1,4E3,this.Hab?3E4:6E3)}else Rc.instance.kf().onError("IssueQuery","Empty Online Provider List: No online calls by provider"),ua.Ll(Qc);else ua.Ll(Qc)}wba(){-1!==this.kM&&(window.clearTimeout(this.kM),this.kM=-1)}o2a(P,ua,Xa,Pb,hc,Qc){const vd=new Zc(ua);if(Pb===this.xD){this.wba();Rc.instance.kf().b9(ua.qe.length,this.MAa.join(","),P.data.httpStatus.toString(),Math.round(window.performance.now()-
hc),"TellMe",!0,"HttpRequest");Pb=P.data.responseData;P=null;try{P=Ic.b(Pb)}catch(Xf){Rc.instance.kf().onError("OnSuccessCallBack","Exception occured while deserializing response:"+Xf);return}Pb=bd.Nz(ua);if("Groups"in P&&P.Groups){var Nd=P.Groups;this.wxj()&&"powerpoint"===this.Db.application.toLowerCase()&&0==Nd.length&&Nd.push({GroupType:"Recommended",Source:"DlisDnn",Suggestions:[""]});for(var ke of Nd)if("GroupType"in ke&&"Suggestions"in ke&&ke.Suggestions)if("Commands"===ke.GroupType&&(Qc?Array.contains(Qc,
17):1)||"Recommended"===ke.GroupType&&(Qc?Array.contains(Qc,18):1)){var Be=(Nd="Recommended"===ke.GroupType)?"DLIS":"NaiveBayes";"Source"in ke&&ke.Source&&(Be=ke.Source);var Ze=ke.Suggestions;new og.a;var of=[];for(const Xf of Ze)this.xyj(Xf)&&(Ze=Xf.Type,("Command"===Ze||Nd&&"Recommended"===Ze)&&of.push(new Ec(Xf.CommandId,Xf.Score)));Id.Enb(of,!ua.qe.trim().length,ke.GroupType,Be);Be=Rc.instance.BMd();Ze=[];for(const Xf of of)Nd&&Be&&Be.HJb(Xf.commandId)||Ze.push(Xf);of=Id.CXa(ua,Ze,this.Db,null,
null,null,Nd?18:17,0);0<of.results.length&&(this.oCa!==nd.contextMenu&&(of.displayName=Nd?Object(pc.a)("TellMeTryCommandTitle"):Object(pc.a)("TellMeCommandProviderTitle")),vd.Xm(of))}else if("Answer"===ke.GroupType){Ze=ke.Suggestions;Nd=null;of=2147483647;Be="";for(const Xf of Ze)if(this.vyj(Xf))if(Be=Xf.Type,Ze=this.rMf(Be),"Answer"===Be&&this.xic){Nd=this.slf(Be,Xf,ua.qe);break}else Ze&&Ze<of&&(of=Ze,Nd=this.slf(Be,Xf,ua.qe));of=bd.bAk(ua.qe,Be);Nd&&(Qc?Array.contains(Qc,Nd.type):1)&&(Be=[],this.wic?
this.Db.J7?(Rc.instance.actions.push(appChrome.actions.setControlLabel(Nd.value,Nd.qG)),Rc.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(Nd.value,Nd.description)),Rc.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(Nd.value,of))):(Be.push(appChrome.actions.setControlLabel(Nd.value,Nd.qG)),Be.push(appChrome.actions.updateCompoundButtonDescription(Nd.value,Nd.description)),Be.push(appChrome.actions.setCompoundButtonCommandValueId(Nd.value,of)),appChrome.api.dispatch(Be)):
this.Db.J7?(Rc.instance.actions.push(appChrome.actions.setControlLabel(Nd.value,Nd.qG+" - "+Nd.description)),Rc.instance.actions.push(appChrome.actions.setButtonCommandValueId(Nd.value,of))):(Be.push(appChrome.actions.setControlLabel(Nd.value,Nd.qG+" - "+Nd.description)),Be.push(appChrome.actions.setButtonCommandValueId(Nd.value,of)),appChrome.api.dispatch(Be)),of=this.Cai(Nd.type),of.An(Nd),vd.Xm(of))}else"Help"===ke.GroupType&&ke.Suggestions.length&&(Qc?Array.contains(Qc,8):1)?this.JDb&&(Nd=this.zHe.eHa(ua,
ke.Suggestions))&&0<Nd.results.length&&vd.Xm(Nd):"Template"===ke.GroupType&&(Qc?Array.contains(Qc,23):1)?(Nd=ke.Suggestions)&&0<Nd.length&&this.Fvh.eHa(ua,vd,Nd):"Addin"===ke.GroupType&&(Qc?Array.contains(Qc,27):1)?(Nd=ke.Suggestions)&&0<Nd.length&&this.Aih.eHa(ua,vd,Nd):"ActionAI"===ke.GroupType&&(Qc?Array.contains(Qc,25):1)?(of=ke.Suggestions,Nd=[],new Hd(25),of&&1===of.length&&(Be=of[0])&&Be.CommandId&&(of=Be.CommandId,Nd.push(new Ec(of,"Score"in Be?Be.Score:0)),Nd=Id.CXa(ua,Nd,this.Db,null,null,
null,25,0),Nd.displayName=Object(pc.a)("TellMeActionAIProviderTitle"),vd.Xm(Nd))):"Substrate"===ke.GroupType&&this.dCa&&"Type"in ke?"File"===ke.Type&&this.zic&&(Qc?Array.contains(Qc,15):1)?(Nd=this.sRa.qLd(ke.Suggestions,Pb,this.oCa))&&0<Nd.results.length&&(this.pGc()&&(of=new Xd("GenerateSlidesFromTellMe",30,"",null,1),Nd.An(of)),vd.Xm(Nd)):"People"===ke.Type&&this.GDb&&(Qc?Array.contains(Qc,14):1)?(Nd=this.sRa.YLf(ke.Suggestions,Pb,this.oCa))&&0<Nd.results.length&&vd.Xm(Nd):"Notes"===ke.Type&&this.FDb&&
(Qc?Array.contains(Qc,14):1)&&(Nd=this.sRa.wLf(ke.Suggestions,Pb,ua))&&0<Nd.results.length&&vd.Xm(Nd):"Recall"===ke.GroupType&&this.Db.EX&&"Type"in ke&&"IntentService"===ke.Type&&(Qc?Array.contains(Qc,15):1)&&(Nd=this.sRa.qLd(ke.Suggestions,Pb,this.oCa))&&0<Nd.results.length&&(this.pGc()&&(of=new Xd("GenerateSlidesFromTellMe",30,"",null,1),Nd.An(of)),vd.Xm(Nd));else Rc.instance.kf().onError("OnSuccessCallBack","GroupType"in ke?"Invalid group suggestions found for "+ke.GroupType:"Invalid group found")}if(P.Intents){ke=
P.Intents;for(const Xf of ke)this.B_d(Xf)&&("Image"===Xf.GroupType&&Xf.ConfidenceScore>Xf.ConfidenceThreshold&&(Qc?Array.contains(Qc,19):1)?this.toh.eHa(ua,vd,0,Xf):"Commands"===Xf.GroupType&&Xf.ConfidenceScore<Xf.ConfidenceThreshold&&(Qc?Array.contains(Qc,17):1)&&(ke=new Hd(17),vd.Xm(ke)))}Xa.Ll(vd);Rc.instance.kf().b9(ua.qe.length,this.MAa.join(","),"",Math.round(window.performance.now()-hc),"",!0,"Provider")}}Z1a(P,ua,Xa,Pb,hc){const Qc=new Zc(ua);Pb===this.xD&&(this.wba(),Rc.instance.kf().b9(ua.qe.length,
this.MAa.join(","),P.data.httpStatus.toString(),Math.round(window.performance.now()-hc),"TellMe",!1,"HttpRequest"));Xa.Ll(Qc)}rMf(P){switch(P){case "Entity":return this.wYe?3:0;case "Definition":return this.yic?5:0;case "WolframAnswer":return this.Bic?2:0;default:return 0}}slf(P,ua,Xa){switch(P){case "Answer":return new Xd(this.wic?"AnswerForSearch":"AnswerForSearchSingleLine",0,""===ua.Title?Xa:ua.Title,ua.Description,0);case "Entity":return new Xd(this.wic?"AnswerForSearch":"AnswerForSearchSingleLine",
2,""===ua.Title?Xa:ua.Title,ua.Description,0);case "Definition":return new Xd(this.wic?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===ua.Title?Xa:ua.Title,ua.Description,0);case "WolframAnswer":return new Xd("WolframForSearch",3,""===ua.Title?Xa:ua.Title,ua.Description,0);default:return null}}Cai(P){switch(P){case 0:return new Hd(9,Object(pc.a)("TellMeAnswersTitle"));case 2:return new Hd(11,Object(pc.a)("TellMeEntityTitle"));case 1:return new Hd(10,Object(pc.a)("TellMeDefinitionTitle"));case 3:return new Hd(12,
Object(pc.a)("TellMeAnswersTitle"));case 12:return new Hd(19,this.Db.Aub?Object(pc.a)("TellMeImageTitleV2"):Object(pc.a)("TellMeImageTitle"));default:return null}}vyj(P){return"Type"in P&&!!P.Type&&""!==P.Type&&"Description"in P&&!!P.Description&&""!==P.Description}xyj(P){return"Type"in P&&!!P.Type&&""!==P.Type&&"CommandId"in P&&!!P.CommandId&&""!==P.CommandId&&"Score"in P&&!!P.Score}B_d(P){if("GroupType"in P&&P.GroupType&&"ConfidenceScore"in P&&"ConfidenceThreshold"in P)return!0;Rc.instance.kf().onError("IsValidIntentGroup",
"Invalid intents found");return!1}L2i(P){const ua=bd.j5f(P),Xa={};Xa.Query=P;ua&&this.HDb&&(this.Jtj()?Xa.UserActionEvents=Rc.instance.kPd():(Xa.CommandClickedEvents=Rc.instance.hzc(),Xa.CommandActionEvents=Rc.instance.sKd()),Xa.TellMeCommandClickMruEvents=Rc.instance.mKd(),Xa.ContentType=Rc.instance.OKb);this.Aic&&(P={},P.Application=this.Db.application,Xa.TemplateInfo=P);return Ic.c(Xa)}Eub(){return!!this.Db&&this.Db.Eub||!!J.AFrameworkApplication.ua&&J.AFrameworkApplication.ua.Ab.Eub}Gub(){return!!this.Db&&
this.Db.Gub||!!J.AFrameworkApplication.ua&&J.AFrameworkApplication.ua.Ab.Gub}Hub(){return!!this.Db&&this.Db.Hub||!!J.AFrameworkApplication.ua&&J.AFrameworkApplication.ua.Ab.Hub}Kub(){return!!this.Db&&this.Db.Kub||!!J.AFrameworkApplication.ua&&J.AFrameworkApplication.ua.Ab.Kub}Iub(){return!!this.Db&&(this.Db.Iub||this.Db.dD)}GSk(){return!!this.Db&&!this.Db.EIa}fTk(){return!!this.Db&&this.Db.dWb}FSk(){return!!this.Db&&this.Db.$lj&&this.Db.Xlj}TYc(){return!!this.Db&&this.Db.TYc}D5f(){return!!J.AFrameworkApplication.ea&&
J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",!1)}E5f(){return!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}Jtj(){return!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewZeroSearchTermModel",!1)}pGc(){return!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",
!1)}wxj(){return!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.UpdateTellMeSuggestions",!1)}LVg(){return!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FetchTellMeTokensAtBoot",!1)}m5i(){return J.AFrameworkApplication.ea?J.AFrameworkApplication.ea.getStringFeatureGate("Microsoft.Office.SharedOnline.TellMeZeroTermModelName",""):""}M2i(){if(!J.AFrameworkApplication.ea)return"";
if(this.E5f())return J.AFrameworkApplication.ea.Qa("TellMeServiceProdEndpointForSearch");if(this.D5f())return J.AFrameworkApplication.ea.Qa("TellMeServiceEdogEndpointForSearch");if(bd.QVd())return J.AFrameworkApplication.ea.Qa("TellMeServiceIntEndpointForSearch");let P=J.AFrameworkApplication.ea.Qa("TellMeServiceSearchEndpoint");P&&""!==P||(P=J.AFrameworkApplication.D1g);return P}static Olf(P,ua){if(ua)return new Uh(P,["Command","Recommended"],P.uQi);ua=bd.G2()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin ActionAI".split(" "):
"Help WolframAnswer File People Notes Template Addin ActionAI".split(" ");return new Uh(P,ua,P.VNf)}}Object(n.a)(Uh,"TellMeServiceProvider",null,[512]);class gj{constructor(P){this.NQa={};this.NQa[nd.tellMe]=[];this.NQa[nd.contextMenu]=[];this.nfc=void 0===P?!1:P}H6f(P,ua,Xa,Pb,hc){hc=void 0===hc?null:hc;let Qc;var vd=!1;switch(Pb){case nd.contextMenu:Qc=this.NQa[nd.contextMenu];vd=!0;break;default:Qc=this.NQa[nd.tellMe]}ua=new Rh(ua,Qc,vd,this.nfc,Pb);ua.vak();for(let Nd=0;Nd<Qc.length;++Nd){const ke=
window.performance.now(),Be=new He(ua,Nd);vd=Rc.instance.Dz();if(J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.UpdateTellMeSuggestions",!1)&&vd&&"powerpoint"===vd.application.toLowerCase()&&"Suggestion"===Qc[Nd].Hx()){const Ze=this.NQa[nd.tellMe];let of=!1;for(const Xf of Ze)if("NBCommand"===Xf.Hx()&&Xf.n6f()){of=!0;break}if(of)continue}vd&&vd.jPh?window.setTimeout(()=>{Qc[Nd].Nx(P,Be,Xa,Pb,hc);if(Rc.instance.kf()){const Ze={};Ze.Provider=
Qc[Nd].Hx();Ze.QueryID=P.$Ka;Rc.instance.kf().jR(qd.Nx,window.performance.now()-ke,Ze)}},0):(Qc[Nd].Nx(P,Be,Xa,Pb,hc),Rc.instance.kf()&&(vd={},vd.Provider=Qc[Nd].Hx(),vd.QueryID=P.$Ka,Rc.instance.kf().jR(qd.Nx,window.performance.now()-ke,vd)))}ua.cal()}Hx(){return"Aggregator"}n6f(){return!1}RF(){return 0}Nx(P,ua,Xa,Pb,hc){Xa=void 0===Xa?!1:Xa;Pb=void 0===Pb?nd.tellMe:Pb;hc=void 0===hc?null:hc;if(Rc.instance.UYb)this.H6f(P,ua,Xa,Pb,hc);else{const Qc=window.performance.now();Rc.instance.oac.then(()=>
{Rc.instance.kf()&&Rc.instance.kf().jR(qd.xMj,window.performance.now()-Qc);this.H6f(P,ua,Xa,Pb,hc);return!0})}}Ou(P,ua){this.NQa[ua].push(P)}eAh(P){switch(P){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const ua=this.NQa[nd.tellMe];for(const Xa of ua)if("FindInDocument"===Xa.Hx()){Xa.bLk(P);break}}}static createInstance(P,ua,Xa,Pb){const hc=ua.EX;var Qc=Pb&&bd.Bre(ua);const vd=Qc&&ua.Rae&&!hc,Nd=ua.a_d&&!bd.smb()&&!hc,ke=ua.$Xd&&!hc,Be=new gj(Qc);if(ua.ZSk&&
!hc){var Ze=new Lf(ua);Be.Ou(Ze,nd.tellMe)}Ze=ua.$k?J.AFrameworkApplication.ea.ka("TellMeIsSuggestionsForSimplifiedUxEnabled"):J.AFrameworkApplication.ea.ka("TellMeSuggestionsIsEnabled");const of=!Ze&&J.AFrameworkApplication.ea.ka("TellMeFirstRunExperienceIsEnabled");Be.Ou(new yc(P,ua.I9k,of,!1),nd.tellMe);Xa=J.AFrameworkApplication.ua.Ab.B5f?new Eg(ua,new bh):new Ra(ua,Xa);Be.Ou(Xa,nd.contextMenu);(Qc&&ua.Sae||vd)&&Be.Ou(Uh.Olf(ua,!0),nd.tellMe);Be.Ou(Xa,nd.tellMe);Ze&&!hc&&Be.Ou(new Wh(new Sh,ua,
P),nd.tellMe);!ua.tBi||hc||"Word"===ua.application&&ua.DBf||Be.Ou(new Me(ua),nd.tellMe);ua.ISa&&!hc&&(P=new bf(ua),Be.Ou(P,nd.tellMe),Be.Ou(P,nd.contextMenu));!ua.SSa||ua.Y6b||ua.X6b||hc||Be.Ou(new af(ua),nd.tellMe);Pb&&(ua.IHa||bd.G2())&&(P=new jf(ua),Be.Ou(P,nd.tellMe),Be.Ou(P,nd.contextMenu));Qc&&Be.Ou(Uh.Olf(ua,!1),nd.tellMe);Pb&&!ua.Gve&&bd.Are(ua)&&!hc&&(Be.Ou(new ci(ua),nd.tellMe),ua.G1k&&Be.Ou(new ci(ua),nd.contextMenu));Nd&&Be.Ou(new Fd(ua),nd.tellMe);!ua.Iub&&!ua.dD||hc||Be.Ou(new ff(ua),
nd.tellMe);ua.dWb&&!hc&&Be.Ou(new ei(ua),nd.tellMe);ua.DEc&&(Qc=new Xb(ua),Be.Ou(Qc,nd.tellMe),Be.Ou(Qc,nd.contextMenu));Pb&&ua.GEc&&!hc&&Be.Ou(new ue(ua),nd.tellMe);ke&&"Excel"===ua.application&&!hc&&Be.Ou(new Fg(ua),nd.tellMe);return Be}}Object(n.a)(gj,"AggregatorResultsProvider",null,[512]);var ii=a(1198);class Kh{constructor(P,ua,Xa,Pb,hc,Qc){P=void 0===P?"":P;ua=void 0===ua?"":ua;Xa=void 0===Xa?"":Xa;this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=P?P:"";
this.Description=ua?ua:"";this.Type=Xa?Xa:"";this.Score=void 0===Pb?-99999:Pb;this.Age=void 0===hc?-1:hc;this.Count=void 0===Qc?0:Qc}}Object(n.a)(Kh,"Suggestion",null,[]);class ji{constructor(P,ua){this.GroupType=this.Suggestions=null;this.Suggestions=P;this.GroupType=ua}}Object(n.a)(ji,"SuggestionGroup",null,[]);class ki{}ki.help="help";ki.ZIh="answer";ki.commands="commands";ki.qHk="servicecommands";Object(n.a)(ki,"SuggestionGroupType",null,[]);class Zi{constructor(P,ua,Xa){this.i$c=0;this.Hkd=this.CBb=
null;this.Ql=P;this.Wjd=this.q9c=this.Ybd=!1;this.hlh=ua;this.sg=J.AFrameworkApplication.od;this.Db=Xa;this.Rcc=this.Jgd=0}get yR(){return this.Ql.yR}WXc(P){this.Ql.WXc(P)}Qag(){if(this.CBb){var P=0;for(const ua of this.CBb)this.Ql.VGj(ua,P++);this.CBb=null}}beginQuery(P,ua,Xa){this.Ql.JGj(P,ua,Xa)}fKa(P,ua){this.Ql.NNh(P,ua);this.Ybd=!0;this.Wjd=!1}Awa(){this.Ybd=!1;this.q9c||(this.Qag(),this.Ql.atf(this.i$c))}KGj(P,ua){this.Ql.LGj(P,ua)}hVj(P,ua,Xa,Pb,hc){for(const Qc of this.hlh)if(P.startsWith(Qc)){this.Wjd=
!0;break}this.Ql.KEj(P,ua,Xa,Pb,hc)}KVj(P){this.q9c=!1;this.i$c=P;this.Ybd||this.Wjd||(this.Qag(),this.Ql.atf(this.i$c,!1))}JVj(P,ua){this.Ql.OEj(P,ua);this.q9c=!0}gJd(P,ua){if(!P.count)return"";let Xa="";const Pb=Date.now();for(const hc of P)P=(Pb-hc.timeStamp)/1E3,P=bd.K1c(P),0<Xa.length&&(Xa+=";"),Xa+=ua?hc.commandId:hc.controlId,Xa+=":",Xa+=P.toString();return Xa}Bwa(){var P=this.gJd(ii.a.instance.gzb,!1);0<P.length&&this.Ql.HEj(P);P=this.gJd(ii.a.instance.QOa,!0);0<P.length&&this.Ql.iEj(P);P=
this.gJd(ii.a.instance.Rdc,!0);0<P.length&&this.Ql.vFj(P);P=Rc.instance.nKd();0<P.length&&this.Ql.IGj(Ic.c(P))}hHj(P){this.Ql.pEj(P)}b9(P,ua,Xa,Pb,hc,Qc,vd){this.Ql.TFj(P,ua,Xa,Pb,hc,Qc,vd)}c3d(P,ua,Xa,Pb){this.Ql.c3d(P,ua,Xa,Pb)}jR(P,ua,Xa){this.Ql.kFj(P,ua,void 0===Xa?null:Xa)}onError(P,ua,Xa){this.Ql.PY(P,ua,void 0===Xa?null:Xa)}TKk(P){this.CBb=P}f2i(P){const ua=[];if(!P)return ua;for(let Xa=0;Xa<P.length;Xa++){const Pb=qg[P[Xa].groupType].toLowerCase(),hc=[],Qc=P[Xa].results;if(Qc){for(let vd=
0;vd<Qc.length;vd++)"findindocument"===Pb?Array.add(hc,new Kh("","",Pb,Qc[vd].score,Qc[vd].fmc,Qc[vd].count)):Array.add(hc,new Kh(Qc[vd].label,Qc[vd].description,Pb,Qc[vd].score,Qc[vd].fmc,Qc[vd].count));"answer"===Pb||"definition"===Pb||"wolframanswer"===Pb||"entity"===Pb?Array.add(ua,new ji(hc,ki.ZIh)):"classifier"===Pb||"appsforoffice"===Pb?Array.add(ua,new ji(hc,ki.commands)):"serviceclassifier"===Pb?Array.add(ua,new ji(hc,ki.qHk)):"assistance"===Pb?Array.add(ua,new ji(hc,ki.help)):("document"===
Pb||"people"===Pb||"findindocument"===Pb||"notes"===Pb||"image"===Pb||"template"===Pb)&&Array.add(ua,new ji(hc,Pb))}}return ua}HOd(P,ua){const Xa={};Xa.Query=ua;Xa.SuggestionGroups=Ic.c(this.f2i(P));return Ic.c(Xa)}xOf(P){const ua={"Content-Type":"application/json",Accept:"application/json"};ua["X-Office-Version"]=J.AFrameworkApplication.buildVersion;ua["X-Office-Application"]=J.AFrameworkApplication.ea.Qa("Application");ua["X-Office-Platform"]="WAC";ua["X-TellMe-SqmUserId"]=J.AFrameworkApplication.ea.Qa("LoggableUserId")||
"";ua["X-TellMe-SessionId"]=this.Ql.yR.interactionId;ua["X-TellMe-SuggestionTypes"]="Ranker";ua["X-TellMe-Culture"]=J.AFrameworkApplication.uiCulture;ua["X-TellMe-ProcessSessionId"]=J.AFrameworkApplication.userSessionId;ua["X-TellMe-Flights"]=P;ua["X-TellMe-PartialQueryIndex"]=this.Jgd;return ua}o2a(P,ua,Xa){this.b9(ua.length,"RankerLogging",P.data.httpStatus.toString(),Math.round(window.performance.now()-Xa),"TellMeRankerLogging",!0,"HttpRequest")}Z1a(P,ua,Xa){this.b9(ua.length,"RankerLogging",P.data.httpStatus.toString(),
Math.round(window.performance.now()-Xa),"TellMeRankerLogging",!1,"HttpRequest")}yOf(){this.Hkd||(this.Hkd=new Uh(this.Db,null,6E3));return this.Hkd.NHe}j3d(P){const ua=this.HOd(this.CBb,P),Xa=this.xOf("RankerLogging"),Pb=window.performance.now();this.sg.Wn(this.yOf(),2,ua,Xa,!1,0,hc=>{this.o2a(hc,P,Pb)},hc=>{this.Z1a(hc,P,Pb)},null,null,!1,4E3,6E3);this.Jgd++}zyk(){this.Jgd=0}Soe(P){this.Rcc=P}}Object(n.a)(Zi,"InteractionLogger",null,[]);var Lh=a(154);class Fh{constructor(P,ua,Xa,Pb){this.rQf=P;this.groupType=
ua;this.hQd=void 0===Pb?0:Pb;this.A4b=Xa}}Object(n.a)(Fh,"SortingGroup",null,[]);class fi{constructor(P,ua,Xa,Pb){this.order=P;this.ZBc=ua;this.I6i=Xa;this.groupType=Pb}}Object(n.a)(fi,"SortingProp",null,[]);class Qi{constructor(P,ua){this.edg={};this.ddg={};this.Ycg=this.rdg=1;this.Haf(P,ua)}JZk(P,ua,Xa){var Pb=bd.Nz(Xa)?this.edg:this.ddg;Xa=new og.a;for(var hc of ua)ua=Object(Lh.a)(fi,Pb[qg[hc.groupType].toLowerCase()]),Na.c(ua)||Xa.add(new Jc.a(ua,hc));Xa.Sc((vd,Nd)=>vd.key.order<Nd.key.order?
-1:1);Array.clear(P);hc=Rc.instance.QOd();for(ua=0;ua<Xa.count;){Pb=Xa.pa(ua).key.ZBc;var Qc=Xa.pa(ua).value;const vd=new Hd(Xa.pa(ua).key.groupType);Na.c(hc)||hc.Location===nd.contextMenu||(vd.displayName=Xa.pa(ua).key.I6i);for(const Nd of Qc.results)vd.An(Nd);for(Qc=++ua;Qc<Xa.count&&Xa.pa(Qc).key.ZBc===Pb;)this.Ond(vd,Xa.pa(Qc).value),Qc=++ua;P.push(vd)}}xfl(P,ua){this.Ycg=this.rdg=1;this.Haf(P,ua)}Haf(P,ua){this.UYg(P);for(var Xa=0;Xa<P.length;Xa++){const Pb=P[Xa];for(const hc of Pb.A4b)this.Nzh(hc,
Xa,Pb.rQf,Pb.groupType)}this.UYg(ua);for(P=0;P<ua.length;P++){Xa=ua[P];for(const Pb of Xa.A4b)this.Mzh(Pb,P,Xa.rQf,Xa.groupType)}}UYg(P){P.sort((ua,Xa)=>Object(Lh.a)(Fh,ua).hQd>Object(Lh.a)(Fh,Xa).hQd?-1:1)}Nzh(P,ua,Xa,Pb){this.edg[qg[P].toLowerCase()]=new fi(this.rdg++,ua,Xa,Pb)}Mzh(P,ua,Xa,Pb){this.ddg[qg[P].toLowerCase()]=new fi(this.Ycg++,ua,Xa,Pb)}Ond(P,ua){for(let Xa=0;Xa<ua.results.length;Xa++)P.An(ua.results[Xa])}}Object(n.a)(Qi,"BaseGroupingSorter",null,[]);class si{constructor(){this.tLc=
[new Fh("",26,[26]),new Fh("",24,[24]),new Fh(Object(pc.a)("TellMeRecentlyUsedTitleV2"),4,[4,2]),new Fh(Object(pc.a)("TellMeCommandProviderTitle"),7,[18,16,7]),new Fh(Object(pc.a)("TellMeSuggestionsProviderTitle"),34,[15,14,19,3]),new Fh("",13,[13]),new Fh("",22,[22])];this.mLc=[new Fh("",25,[25]),new Fh(Object(pc.a)("TellMeCommandProviderTitle"),32,[17,0,1,8,28]),new Fh(Object(pc.a)("TellMeSuggestedSearchesProviderTitle"),33,[2,19,23,29]),new Fh(Object(pc.a)("TellMePotentialMatchesProviderTitle"),
34,[15,14,20,9,12,10,11,27,30]),new Fh("",13,[13]),new Fh("",22,[22])];this.Acg=new Qi(this.tLc,this.mLc)}X7b(P,ua,Xa,Pb,hc){Pb=void 0===Pb?null:Pb;hc=void 0===hc?null:hc;let Qc=!1;if(Pb){for(const vd of bd.Nz(Xa)?this.tLc:this.mLc)this.Xjk(vd,Pb);Qc=!0}if(hc){for(const vd of bd.Nz(Xa)?this.tLc:this.mLc)this.yfl(ua,vd,hc);Qc=!0}Qc&&this.Acg.xfl(this.tLc,this.mLc);this.Acg.JZk(P,ua,Xa)}Xjk(P,ua){const Xa=new og.a;for(var Pb of P.A4b){const hc=ua[qg[Pb].toLowerCase()];Xa.add(new Jc.a(Na.c(hc)?Number.MAX_VALUE:
hc,Pb))}if(Xa.count){Xa.Sc((hc,Qc)=>hc.key<Qc.key?-1:1);ua=Array(Xa.count);for(Pb=0;Pb<Xa.count;Pb++)ua[Pb]=Xa.pa(Pb).value;P.A4b=ua}}yfl(P,ua,Xa){let Pb=0;for(const hc of ua.A4b)if(qg[hc].toLowerCase()in Xa&&Xa[qg[hc].toLowerCase()])for(const Qc of P)if(Qc.groupType===hc){Pb+=Xa[qg[hc].toLowerCase()];break}ua.hQd=Pb}}Object(n.a)(si,"SimplifiedGroupingSorter",null,[]);class hj{constructor(P){this.cdg={};this.adg={};this.bdg={};this.fdg={};this.y4d={};this.idg=this.OIj=this.FIj=this.HIj=1;this.ndg=
null;this.Fl=P;this.NRh();this.Eck();this.CRh();this.DQh();P.dD&&(this.ndg=new si)}Zt(P){this.cdg[qg[P].toLowerCase()]=this.HIj++}Zv(P,ua){this.adg[qg[P].toLowerCase()]=ua}Kaa(P){this.bdg[qg[P].toLowerCase()]=this.FIj++}HJ(P){this.fdg[qg[P].toLowerCase()]=this.OIj++}Kr(P){this.y4d[qg[P].toLowerCase()]=this.idg++}NRh(){const P=!!this.Fl&&this.Fl.EIa,ua=!!this.Fl&&this.Fl.u0b,Xa=!!this.Fl&&this.Fl.FIa,Pb=!!this.Fl&&this.Fl.a_d&&!bd.smb(),hc=!!this.Fl&&this.Fl.dWb,Qc=!!this.Fl&&this.Fl.GEc,vd=!!this.Fl&&
this.Fl.$Xd,Nd=!!this.Fl&&this.Fl.DEc,ke=!!this.Fl&&this.Fl.LWd;this.Fl&&(this.Fl.Vuc||this.Fl.EX||this.Fl.Xuc)&&this.Zt(26);Nd&&this.Zt(24);this.Zt(4);this.Zt(18);this.Zt(16);this.Zt(7);this.Zt(17);this.Zt(0);this.Zt(1);vd&&this.Zt(28);hc&&this.Zt(23);P||this.Zt(2);P&&!ua||this.Zt(8);this.Zt(15);Xa&&this.Zt(20);this.Zt(14);this.Zt(9);this.Zt(12);this.Zt(10);this.Zt(11);P&&this.Zt(2);P&&!ua&&this.Zt(8);this.Zt(19);Qc&&this.Zt(27);this.Zt(21);this.Zt(13);ke&&this.Zt(30);Pb&&this.Zt(22);this.Zt(31)}Eck(){this.Zv(21,
1);this.Zv(4,3);this.Zv(18,3);this.Zv(16,3);this.Zv(7,3);this.Zv(17,5);this.Zv(0,5);this.Zv(1,1);this.Zv(28,2);this.Zv(2,1);this.Zv(8,2);this.Zv(15,3);this.Zv(14,2);this.Zv(27,3);this.Zv(9,1);this.Zv(12,1);this.Zv(10,1);this.Zv(11,1);this.Zv(19,1);this.Zv(23,1);this.Zv(13,1);this.Zv(24,1);this.Zv(25,1);this.Zv(20,2);this.Zv(22,1);this.Zv(26,1);this.Zv(30,1)}CRh(){this.Kaa(4);this.Kaa(0);this.Kaa(17);this.Kaa(7);this.Kaa(16);this.Kaa(18);this.Kaa(15);this.Kaa(30);this.Kaa(20);this.Kaa(8);this.Kaa(14)}DQh(){this.HJ(14);
this.HJ(10);this.HJ(12);this.HJ(9);this.HJ(11);this.HJ(20);this.HJ(15);this.HJ(30);this.HJ(8);this.HJ(2);this.HJ(1);this.HJ(27);this.HJ(7);this.HJ(18);this.HJ(16);this.HJ(17);this.HJ(0);this.HJ(4)}Jyk(){this.y4d={};this.idg=1}K_i(P,ua,Xa){this.Jyk();const Pb=!!this.Fl&&this.Fl.EIa,hc=!!this.Fl&&this.Fl.u0b,Qc=!!this.Fl&&this.Fl.FIa,vd=!!this.Fl&&this.Fl.a_d&&!bd.smb(),Nd=!!this.Fl&&this.Fl.dWb,ke=!!this.Fl&&this.Fl.GEc,Be=!!this.Fl&&this.Fl.$Xd,Ze=!!this.Fl&&this.Fl.LWd,of=!!this.Fl&&this.Fl.TYc,
Xf=!!this.Fl&&this.Fl.DEc;P=P&&hc;of&&this.Kr(25);this.Kr(4);this.Kr(18);this.Kr(16);this.Kr(7);this.Kr(17);this.Kr(0);this.Kr(1);Xf&&this.Kr(24);Be&&this.Kr(28);Nd&&this.Kr(23);Ze&&this.Kr(30);Pb&&!hc||!P||this.Kr(8);ua&&this.Kr(15);Pb||this.Kr(2);ke&&this.Kr(27);Xa&&this.Kr(14);Pb&&!hc||P||this.Kr(8);ua||this.Kr(15);Qc&&this.Kr(20);Xa||this.Kr(14);this.Kr(9);this.Kr(12);this.Kr(10);this.Kr(11);Pb&&this.Kr(2);Pb&&!hc&&this.Kr(8);this.Kr(19);this.Kr(21);this.Kr(13);vd&&this.Kr(22);return this.y4d}Dz(){return this.Fl}}
Object(n.a)(hj,"GroupsPlacementInfo",null,[]);var li=a(108);class $i{constructor(P,ua,Xa,Pb,hc,Qc){this.groupType=P;this.resultType=ua;this.n1k=Xa;this.ZBc=Pb;this.Qhi=hc;this.resultIndex=Qc}}Object(n.a)($i,"ClickLoggingInfo",null,[]);const xj=P=>{const ua=[];for(;P;)Array.add(ua,"{ContextId:"+P.contextId+", IsGraphNodeContext:"+P.AUb+"}"),P=P.Mob;ua.reverse();return"{"+ua.join(", ")+"}"};class ti{constructor(){this.interactionId=this.sessionId=null}}Object(n.a)(ti,"CorrelationRecord",null,[535]);
class Ei{constructor(P,ua){this.provider=P;this.Tye=ua}}Object(n.a)(Ei,"ExternalResultProvider",null,[]);class Ag{constructor(P,ua){this.Id=null;this.TimeStamp=0;this.Id=P;this.TimeStamp=ua}}Object(n.a)(Ag,"MRUControl",null,[]);var vh;(function(P){P[P.lch=0]="Answer";P[P.Jdh=1]="Definition";P[P.Rdh=2]="Entity";P[P.Qhh=3]="WolframAnswer";P[P.mch=4]="Assistance";P[P.Command=5]="Command";P[P.Document=6]="Document";P[P.Kgh=7]="TryQuery";P[P.ceh=8]="FindInDocument";P[P.Inl=9]="HelpAction";P[P.Eeh=10]=
"Insights";P[P.People=11]="People";P[P.Image=12]="Image";P[P.Anl=13]="FirstRunResult";P[P.xol=14]="NoCommandsFoundResult";P[P.Jgh=15]="TestResult";P[P.hml=16]="AppsForOffice_Installed";P[P.jml=17]="AppsForOffice_Recommandation";P[P.iml=18]="AppsForOffice_Query";P[P.yol=19]="Notes_Onenote";P[P.zol=20]="Notes_Samsung";P[P.Aol=21]="Notes_Sticky";P[P.Leh=22]="Learning";P[P.Feedback=23]="Feedback";P[P.Igh=24]="Template";P[P.ech=25]="ActionAI";P[P.fch=26]="ActionAICommand";P[P.ich=27]="Addin";P[P.gfh=28]=
"OfficeScript";P[P.kch=29]="AddinStoreEntry";P[P.Cnl=30]="GenerateSlides";P[P.xgh=31]="SummarizeDeck";P[P.Formula=32]="Formula";P[P.Unknown=33]="Unknown"})(vh||(vh={}));Object(n.b)("ResultType",vh);var Fi=a(615);class mi{constructor(P,ua){this.Nqh=10;this.mP=[];this.kaa=[];this.pPe=this.oPe=!1;this.fCb=this.eCb="";this.E$a=ua;this.Db=P}oGa(){!this.oPe&&this.Db&&(this.eCb="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.Db.application,this.mP=this.lGf(),this.oPe=!0);return this.mP}WYi(){!this.pPe&&this.Db&&
(this.fCb="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.Db.application,this.kaa=this.lGf(!0),this.pPe=!0);return this.kaa}Rxj(P){return P.startsWith("TellMeUpsell")||"OpenInClientUpsell"===P||"TryOfficeUpsell"===P}xVd(P){return this.xmj(P)||this.Rxj(P)||bd.A5f(P)?!1:!0}zha(P){P=P.ControlId;this.xVd(P)&&(P=this.mie(P),this.ark(P),this.kJj(),Array.insert(this.mP,0,new Ag(P,Date.now())),this.eCb.length&&(P=JSON.stringify(this.mP),Fi.a.instance.setItem(this.eCb,P)))}Ou(P){this.jJj();Array.insert(this.kaa,
0,new Ag(vh[P],Date.now()));this.fCb.length&&(P=JSON.stringify(this.kaa),Fi.a.instance.setItem(this.fCb,P))}lGf(P){P=void 0===P?!1:P;if(!this.mP.length){var ua=P?Fi.a.instance.getItem(this.fCb):Fi.a.instance.getItem(this.eCb);if(!ua||""===ua)return P?this.kaa:this.mP;let Xa=null;try{Xa=JSON.parse(ua)}catch(Pb){this.FYh(P),Xa=null}if(!Xa||!Xa.length||10<Xa.length)return P?this.kaa:this.mP;ua=0;for(const Pb of Xa)if(P||this.Db.Cmb(Pb.Id)&&this.xVd(Pb.Id))if(P?Array.insert(this.kaa,ua++,Pb):Array.insert(this.mP,
ua++,Pb),ua===this.E$a)break}return P?this.kaa:this.mP}HJb(P){P=this.mie(P);for(const ua of this.mP)if(ua.Id===P)return!0;return!1}FYh(P){Fi.a.instance.setItem((void 0===P?0:P)?this.fCb:this.eCb,"")}eoj(P){P=this.mie(P.ControlId);return this.xVd(P)?this.HJb(P):!1}ark(P){if(0<this.mP.length){let ua=0;for(const Xa of this.mP){if(Xa.Id===P){Array.removeAt(this.mP,ua);break}ua++}}}mie(P){return"Excel"===this.Db.application&&P.startsWith("m_excelWebRenderer_ewaCtl_")?P.substr(26,P.length):P}kJj(){this.mP.length===
this.E$a&&Array.removeAt(this.mP,this.mP.length-1)}jJj(){this.kaa.length===this.Nqh&&Array.removeAt(this.kaa,this.kaa.length-1)}xmj(P){P=P.split("|");let ua="";if(6<=P.length)ua=P[0];else if(3<=P.length){if("3"===P[0])return!0;ua=P[1]}return ua.startsWith("WA")}static createInstance(P){let ua=3;J.AFrameworkApplication.ea&&(ua=J.AFrameworkApplication.ea.Rd("TellMeMaxRecommendedResultsToReturn",3));return new mi(P,ua)}}Object(n.a)(mi,"MruControlsManager",null,[533]);class ui{constructor(P){this.CQa=
P}rX(P,ua){let Xa;return P.qG&&(Xa=this.CQa[P.value])?Xa.rX(P,ua):(Xa=this.aHf(P.value))?Xa.rX(Xa.JMj,ua):null}AXi(P,ua){if(P=this.CQa[P])for(const Xa of ua)if(ua=bd.getParameter(Xa),ua.key===P.k$j)return ua.value;return null}CQj(P){(P=this.aHf(P))&&P.AQj()}aHf(P){const ua=P.indexOf(bd.j$j);return 0<ua?this.CQa[P.substring(0,ua)]:null}}Object(n.a)(ui,"ParameterizedCommandManager",null,[532]);class Qh{constructor(P,ua){this.qe=P;this.$Ka=ua}}Object(n.a)(Qh,"TellMeQuery",null,[]);class Xi{constructor(P,
ua){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=P;this.TimeElapsedSinceClick=ua}}Object(n.a)(Xi,"CommandClickedEvent",null,[]);class ij{constructor(P,ua){this.wrh=P;this.fDb=ua}Ll(P){this.wrh(Na.c(P.query)?"":P.query.qe,P.Ri,P.attributes,this.fDb,P.Xlb)}}Object(n.a)(ij,"ResultsUpdatedCallback",null,[531]);class Rd{constructor(P,ua,Xa,Pb,hc){this.CommandId=this.ControlId=null;this.TimeElapsedSinceClick=0;this.TerminalParentControlId=this.CommandSurface=null;this.ControlId=P;this.TimeElapsedSinceClick=
Xa;this.CommandSurface=Pb;this.CommandId=ua;this.TerminalParentControlId=hc}}Object(n.a)(Rd,"UserActionEvent",null,[]);class ve{constructor(P,ua){this.menuModel=P;this.ZKg=ua}}Object(n.a)(ve,"GeneratedMenuModel",null,[]);class Ej{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=null}}Object(n.a)(Ej,"MenuModel",null,[]);class hh{constructor(P,ua,Xa){this.Db=P;this.CQa=ua;this.DRa=Xa}dIi(P,ua,Xa){let Pb=0;const hc=new Ej,Qc=[];let vd="";hc.sections=
[];let Nd=new og.a;const ke=!!this.Db&&this.Db.EIa;var Be=!!this.Db&&this.Db.yub||J.AFrameworkApplication.ua.Ab.yub;for(const of of P){P=0;ke||(Nd=new og.a);const Xf=new og.a;let bg=of.displayName;for(const Mg of of.results){if(0<=Mg.value.indexOf(bd.Nte)){if(Mg.qG){var Ze=this.CQa[Mg.value];if(Ze&&Mg.value.endsWith(bd.Nte)){if("FindParameterized"!==Mg.value&&!Be){const Jg=[];Jg.push(appChrome.actions.setControlLabel(Mg.value,Ze.lKf(Mg)));Jg.push(appChrome.actions.setButtonCommandValueId(Mg.value,
Ze.JMi(Mg)));appChrome.api.dispatch(Jg)}Ze=Mg.value.replace(bd.Nte,"");Nd.remove(Ze)?P--:Xf.add(Ze);Nd.add(Mg.value);P++}}}else switch(Mg.type){case 5:Xf.contains(Mg.value)||(Nd.add(Mg.value),P++);break;case 7:Nd.add(Mg.qG);P++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 25:case 26:case 6:case 19:case 20:case 21:case 27:case 29:case 28:case 30:case 32:case 31:Nd.add(Mg.value),P++}13===of.groupType&&(bg=bd.G2()?0<ua.length?String.format(Object(pc.a)("SeeMoreResultsButtonText"),
ua):Object(pc.a)("SeeMoreResultsButtonTextNonParameteried"):String.format(Object(pc.a)("InsightsButtonText"),ua));21===of.groupType&&(bg=Object(pc.a)("LearningUILiveText"))}Pb+=P;""!==bg&&0<P&&(vd+=" , "+P.toString()+" "+Object(pc.a)("TellMeSectionLiveNotification")+" "+bg+" , ");0<Nd.count&&!ke&&(P=appChrome.api.menuSection(Nd.toArray(),of.displayName,null,qg[of.groupType]),Qc.push(P))}Be=null;0<Pb&&(Be=0<ua.length?1!==Pb?String.format(Object(pc.a)("SearchLiveNotificationForTermedQueryResults"),
Pb,ua):String.format(Object(pc.a)("SearchLiveNotificationForTermedQueryResult"),ua):1!==Pb?String.format(Object(pc.a)("LookupLiveNotificationResultPluralFormText"),Pb):Object(pc.a)("LookupLiveNotificationResultSingularFormText"),ke?(ua=appChrome.api.menuSection(Nd.toArray(),"",null,null),Qc.push(ua)):Be+=vd);Xa&&(this.Db.J7?Rc.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(Be)):appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(Be)));hc.sections=Qc;return new ve(hc,
Pb,[])}static get vDd(){return hh.sLe||(hh.sLe=new ve(Object.assign(new Ej,{sections:[]}),0,[]))}}hh.sLe=null;Object(n.a)(hh,"TellMeMenuDefintionGenerator",null,[]);var Ri;(function(P){P[P.ypl=0]="TellMeControlActivated";P[P.Apl=1]="TellMeQueryExecuted";P[P.Cpl=2]="TellMeResultsRendered";P[P.zpl=3]="TellMeControlDeactivated"})(Ri||(Ri={}));Object(n.b)("PerformanceMarker",Ri);var wi;(function(P){P[P.Epl=0]="TellMeTimeToRender";P[P.Dpl=1]="TellMeSessionLength";P[P.Bpl=2]="TellMeResultTriageTime"})(wi||
(wi={}));Object(n.b)("PerformanceMeasure",wi);class Si{mark(P){window.performance.mark(Ri[P])}measure(P,ua,Xa){try{window.performance.measure(wi[P],Ri[ua],Ri[Xa])}catch(Pb){Rc.instance.kf().onError("TellMePerformance:Measure","error measuring "+wi[P])}}U2d(P,ua,Xa){Rc.instance.kf().c3d(ua,Xa,P,this.aVi(P))}VYh(){var P=[0,1,2,3];for(const ua of P)window.performance.clearMarks(Ri[ua])}clearMeasures(P){for(const ua of P)window.performance.clearMeasures(wi[ua])}aVi(P){let ua=0;(P=this.mJi(P))&&0<P.length&&
(ua=P[P.length-1].duration);return ua}mJi(P){return window.performance.getEntriesByName(wi[P],"measure")}}Object(n.a)(Si,"TellMePerformance",null,[]);class ni{constructor(P){this.Evh=P}f0b(P,ua,Xa){Rc.instance.kf().b9(ua,"QueryIndex",P.data.httpStatus.toString(),Math.round(window.performance.now()-Xa),"QueryIndex",!0,"HttpRequest");P=Ic.b(P.data.responseData);ua=-1;P.Index&&(ua=P.Index);Rc.instance.kf().KGj(ua,this.Evh)}n_b(P,ua,Xa){Rc.instance.kf().b9(ua,"QueryIndex",P.data.httpStatus.toString(),
Math.round(window.performance.now()-Xa),"QueryIndex",!1,"HttpRequest")}YYi(P){if(P&&""!==P.trim()){const Xa=window.performance.now(),Pb=J.AFrameworkApplication.C1g;var ua={};ua.Text=P;ua.IsFileHash="false";ua=Ic.c(ua);J.AFrameworkApplication.od.Wn(Pb,2,ua,{"Content-Type":"application/json",Accept:"application/json"},!1,0,hc=>{this.f0b(hc,P.length,Xa)},hc=>{this.n_b(hc,P.length,Xa)},null,null,!1,4E3,6E3)}}}Object(n.a)(ni,"TellMeQueryIndexCallback",null,[]);class oi{constructor(P,ua,Xa){this.xml=P;
this.ZKg=ua;this.eii=Xa}}Object(n.a)(oi,"GeneratedMenuXml",null,[]);class aj{constructor(P,ua){this.Hcc=P||{};this.dpa=ua}get u4a(){return 5}rX(P,ua){return this.dpa.rX(P,void 0===ua?null:ua)||this.cQh(P.value)}cQh(P){return aj.Usd(P,this.Hcc[P]||null)}static Usd(P,ua){ua=void 0===ua?null:ua;P=String.format('<ClonedControl Id="{0}" ',P);for(const hc in ua){var Xa=hc,Pb=ua[hc];Pb=Pb?oa.a.Ig(Pb.toString()):"";P+=String.format('{0}="{1}" ',Xa,Pb)}return P+"/>"}}Object(n.a)(aj,"CommandMenuItemFactory",
null,[529]);class jj{constructor(){this.Rmh=Object(pc.a)("FindInDocumentText")}get u4a(){return 8}rX(P){var ua=P.qG;P=oa.a.Ig(P.value);const Xa=oa.a.Ig(ua);ua=oa.a.Ig(String.format(this.Rmh,ua));return this.EGi(P,Xa,ua)}EGi(P,ua,Xa){return Bb.a(P,"1540292897",Xa,bd.sBi,null,ua,Xa,null,null)}}Object(n.a)(jj,"FindInDocumentMenuItemFactory",null,[529]);class Gi{constructor(P){this.Foh=(void 0===P?null:P)||Object(pc.a)("InsightsButtonText")}get u4a(){return 10}rX(P){var ua=P.qG;P=bd.G2()?bd.Qra(ua,1):
bd.zzd(ua);ua=String.format(this.Foh,ua);return this.bHi(P,ua)}bHi(P,ua){return Bb.a("bInsights",bd.G2()?"1914896509":"3317204163",oa.a.Ig(ua),bd.hkj,null,oa.a.Ig(P),oa.a.Ig(ua),null,null)}}Object(n.a)(Gi,"InsightsMenuItemFactory",null,[529]);class sj{get u4a(){return 7}rX(P){const ua=Object(Lh.a)(nc,P);return this.lIi(oa.a.Ig(P.value),ua.id)}lIi(P,ua){return Bb.a(ua,"1404166600",P,null,null,P,P,null,null)}}Object(n.a)(sj,"TryQueryMenuItemFactory",null,[529]);class oh{constructor(P){this.OLe=[];this.Db=
P}tQi(P){for(const ua of this.OLe)if(ua.u4a===P)return ua;return null}nLa(P){this.OLe.push(P)}Bnk(P){this.nLa(new aj(this.Db.z3h,P));this.nLa(new xb(this.Db.vhg));this.nLa(new wc(this.Db.yEk,this.Db.xEk,this.Db.I3k,this.Db.Kbj,this.Db.zRk));this.nLa(new Gi);this.nLa(new jj);this.nLa(new Vd);this.nLa(new sj)}}Object(n.a)(oh,"MenuItemFactoryRegistry",null,[]);class Yh{constructor(P,ua){this.Db=P;this.xSe=new oh(this.Db);this.xSe.Bnk(ua)}eIi(P,ua){let Xa=0;const Pb=[],hc=[];for(const vd of P){P=bd.Ewe;
var Qc=[];for(const Nd of vd.results){const ke=this.xSe.tQi(Nd.type).rX(Nd,ua);P=bd.Ewe;Qc.push(ke);if(13===Nd.type||14===Nd.type)P="Menu32";17===Nd.type&&(P="MenuTellMeExtended");Nd.groupType=vd.groupType;hc.push(Object(Lh.a)(Xd,Nd))}Xa=Xa?Xa:Qc.length;Qc=Bb.e("TellMeDropdownControls",Qc);P=Bb.h("TellMeDropdownMenuSection",Qc,P,vd.displayName);Pb.push(P)}ua=Bb.i(Pb,"LookupDropdownMenu");return new oi(ua,Xa,hc)}static get Uuc(){return Yh.tLe||(Yh.tLe=new oi(Bb.i([],"LookupDropdownMenu"),0,[]))}}Yh.tLe=
null;Object(n.a)(Yh,"TellMeXmlGenerator",null,[]);var xi;(function(P){P[P.lpl=0]="Service";P[P.Local=1]="Local";P[P.dol=2]="MRU";P[P.Jgh=3]="TestResult";P[P.Unknown=4]="Unknown"})(xi||(xi={}));Object(n.b)("SubResultType",xi);var Zh=a(90);class bj{constructor(P,ua,Xa,Pb,hc){hc=void 0===hc?null:hc;this.CommandId=null;this.IsEnabled=!1;this.OptionalData=this.SubResultType=this.ResultType=null;this.CommandId=P;this.IsEnabled=ua;this.ResultType=vh[Xa];this.SubResultType=xi[Pb];this.OptionalData=hc?Zh.a.toJSON(hc):
null}}Object(n.a)(bj,"ResultInfo",null,[]);var tj=a(126),$h=a(178);class Fj{constructor(P,ua){this.pOe="TellMeWAC.";this.Qrh=P;this.jwh=void 0===ua?null:ua}cfa(P,ua,Xa){ua=tj.a.Eh(ua);$h.a.cfa(tj.a.Yrc(P,this.Qrh,this.jwh,Xa,ua),this.pOe)}dya(P,ua,Xa){Xa=void 0===Xa?0:Xa;ua=tj.a.Eh(ua);$h.a.dya({name:P,dataFields:ua,durationMs:Xa},this.pOe)}}Object(n.a)(Fj,"TellMeOtelLogger",null,[546]);class cj{constructor(P,ua,Xa,Pb,hc,Qc,vd){this.oP=this.HS=this.vJe=null;this.jy=P;this.kzb=ua;this.bha=Xa;this.jBa=
Pb;this.Noa=hc;this.Pph=Qc;this.oP=vd?vd:new Fj(this.jBa?li.a.Mte:li.a.G0c)}get $k(){return this.jBa}get yR(){return this.bha}WXc(P){this.vJe=P;switch(P){case nd.contextMenu:this.HS=nd.contextMenu;break;default:this.HS=nd.tellMe}}NNh(P,ua){this.bha.interactionId||(this.bha.interactionId=Bh.a.create().toString(),this.D$f(P,!0,ua))}atf(P,ua){this.bha.interactionId&&this.cFj(P,void 0===ua?!0:ua);this.jBa&&appChrome.api.updateTellMeCorrelationId("");this.bha.interactionId=null}D$f(P,ua,Xa){const Pb=this.RP(qd.bTb);
Pb.Culture=this.kzb;Pb.AppName=this.jy;Pb.Context=P;Pb.IsSearchUxEnabled=this.Noa;Pb.IsTellMeInHeaderEnabled=this.Pph;Pb.IsShortCutUsed=Xa;Pb.IsInputFocus=ua;Pb.ContentType=Rc.instance.OKb;this.oP.cfa(qd.bTb,Pb,this.vJe);this.jBa&&appChrome.api.updateTellMeCorrelationId(this.bha.interactionId)}cFj(P,ua){const Xa=this.RP(qd.kEc);Xa.DwellTime=P;Xa.IsInputBlur=ua;this.oP.dya(qd.kEc,Xa)}JGj(P,ua,Xa){let Pb=0;!Xa&&0<P.length&&(Pb=P.trim().split(" ").length);const hc=this.RP(qd.query);hc.Input="!";hc.QueryID=
ua;hc.QueryLength=P.length;hc.IsZeroTerm=Xa;hc.WordsCount=Pb;this.oP.cfa(qd.query,hc,this.HS)}TFj(P,ua,Xa,Pb,hc,Qc,vd){var Nd=null;Nd=void 0===Nd?null:Nd;const ke=this.RP(qd.latency);ke.Culture=this.kzb;ke.QueryLength=P;ke.UiElement=ua;ke.StatusCode=Xa;ke.Service=hc;ke.IsSuccess=Qc;ke.LatencyType=vd;Nd&&(ke.TokenAcquired=Nd);this.oP.dya(qd.latency,ke,Pb)}c3d(P,ua,Xa,Pb){const hc=this.RP(qd.performance);hc.Culture=this.kzb;hc.BeginPerformanceMarker=Ri[P];hc.EndPerformanceMarker=Ri[ua];hc.PerformanceMeasure=
wi[Xa];this.oP.dya(qd.performance,hc,Pb)}VGj(P,ua){if(P.results.length){var Xa=this.RP(qd.CIg);Xa.GroupIndex=ua.toString();Xa.GroupType=qg[P.groupType];16===P.groupType&&(Xa.IsSelectionBased=Rc.instance.Dza);ua=[];var Pb=[],hc=[];for(const Qc of P.results)Xa.ResultType||(Xa.ResultType=vh[Qc.type]),P={},27===Qc.type&&(P.AssetId=Qc.additionalInfo),Pb.push(Id.Z7(Qc.value)),ua.push(Qc.value),hc.push(new bj(Qc.value,Id.Z7(Qc.value),Qc.type,Qc.subType,P));0<ua.length&&(Xa.ResultsList="{"+ua.join(", ")+
"}",Xa.EnableList="{"+Pb.join(", ")+"}",Xa.ResultInfoList=Ic.c(hc));this.oP.cfa(qd.CIg,Xa,this.HS)}}GIi(P,ua){if(4===P)return"MRU";switch(ua){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return vh[ua]}KEj(P,ua,Xa,Pb,hc){const Qc=this.RP(qd.click);Qc.UiElement=P;Qc.ParentUiElement=ua;Qc.CommandId=Xa;Qc.CloseAllMenus=Pb;Qc.ActionType=this.GIi(hc.groupType,hc.resultType);Qc.ResultType=vh[hc.resultType];Qc.SubResultType=
xi[hc.n1k];Qc.GroupType=qg[hc.groupType];Qc.GroupIndex=hc.ZBc.toString();Qc.DisplayIndex=hc.Qhi.toString();Qc.ResultIndex=hc.resultIndex.toString();this.oP.cfa(qd.click,Qc,this.HS)}OEj(P,ua){this.bha.interactionId||(this.bha.interactionId=Bh.a.create().toString(),this.D$f("",!1,ua));ua=this.RP(qd.oif);ua.QueryID=P;this.oP.dya(qd.oif,ua)}Z$f(P,ua,Xa){if(P){if(Xa)for(const Pb in Xa)P[Pb]=Xa[Pb];this.oP.dya(qd.events,P,ua)}}kFj(P,ua,Xa){Xa=void 0===Xa?null:Xa;const Pb=this.RP(qd.events);Pb.Event=P;this.Z$f(Pb,
Math.round(ua),Xa)}PY(P,ua,Xa){Xa=void 0===Xa?null:Xa;const Pb=this.RP(qd.events);Pb.Event=qd.error;Pb.Module=P;Pb.ErrorMessage=ua;Pb.Message=ua;this.Z$f(Pb,Math.round(window.performance.now()),Xa)}HEj(P){const ua=this.RP(qd.ugf);ua.Val=P;ua.ReactUx=this.jBa;this.oP.cfa(qd.ugf,ua,this.HS)}iEj(P){const ua=this.RP(qd.W0e);ua.Val=P;ua.ReactUx=this.jBa;this.oP.cfa(qd.W0e,ua,this.HS)}vFj(P){const ua=this.RP(qd.pBf);ua.Val=P;ua.ReactUx=this.jBa;this.oP.cfa(qd.pBf,ua,this.HS)}IGj(P){const ua=this.RP(qd.FAg);
ua.Val=P;ua.ReactUx=this.jBa;this.oP.cfa(qd.FAg,ua,this.HS)}pEj(P){const ua=this.RP(qd.EPg);ua.Val=P;this.oP.cfa(qd.EPg,ua,this.HS)}LGj(P,ua){const Xa=this.RP(qd.TAg);Xa.QueryIndex=P;ua&&(Xa.CorrelationID=ua);this.oP.dya(qd.TAg,Xa)}RP(P){return{["SessionID"]:this.bha.sessionId,["CorrelationID"]:this.bha.interactionId,["Time"]:(new Date).getTime(),["Event"]:P,["Scenario"]:this.HS}}}Object(n.a)(cj,"UsageLogger",null,[530]);var Mh=a(128),yj=a(1351),cg=a(488);a(1086);a(664);class mf{constructor(P){P=
void 0===P?null:P;this.dpa=this.kd=this.ya=this.oW=this.pW=this.Ve=this.pb=this.mz=this.ofd=this.E0e=this.S_=null;this.OPe=this.m$a=!1;this.W8a=null;this.jBb=this.Noa=!1;this.AAa=this.g9a=this.M$=this.mhc=this.Bec=null;this.Z9a=!1;this.sfd=0;this.O8a=null;this.zSe=0;this.oBb=!1;this.tj=this.GM=this.MAa=null;this.gik=(ua,Xa,Pb,hc,Qc)=>{if(1===Pb)return 32;if(Na.c(Qc))return mf.instance.Ah.onError("TellMeActor:QuickActionOnFileHandler","actiondata comes null"),16;this.kd.RCf();if(ua=Qc.TerminalParentControlId){ua=
this.jra.pa(ua);if(!ua)return 16;Xa=[];Array.add(Xa,ua);if(!this.U8f(Xa))return 8}return 32};this.XHi=()=>{if(!this.jra.count)return 16;const ua=[];for(const Xa of this.jra.values)Array.add(ua,Xa);return this.U8f(ua)?32:8};this.fEc=(ua,Xa,Pb,hc,Qc)=>{if(1===Pb)return 32;if(Na.c(Qc))return mf.instance.Ah.onError("TellMeActor:InsertMention","actiondata comes null"),16;ua=Qc.UILocation;let vd;Qc=Qc.CommandValueId;try{vd=Ic.a(Qc)}catch(Nd){return mf.instance.Ah.onError("TellMeActor:InsertMention","commandValueId is not in proper format"),
16}return Na.c(vd)?(mf.instance.Ah.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):Na.c(this.Bec)?(mf.instance.Ah.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),16):19!==ua?(mf.instance.Ah.onError("TellMeActor:InsertMention","location "+ua+" is unexpected"),16):this.Bec.fEc(vd.displayName,vd.email,vd.userId)?32:(mf.instance.Ah.onError("TellMeActor:InsertMention","mention is not inserted"),16)};this.Lwa=(ua,Xa,Pb,hc,Qc)=>1===Pb?32:Na.c(Qc)?(mf.instance.Ah.onError("TellMeActor:OpenOrInsertUrl",
"actiondata comes null"),16):19===Qc.UILocation?this.gkj(Pb,Qc):this.openUrlInNewTab(ua,Xa,Pb,hc,Qc);this.openFeedback=(ua,Xa,Pb,hc,Qc)=>{if(1===Pb)return 32;if(Na.c(Qc))return mf.instance.Ah.onError("TellMeActor:OpenFeedback","actiondata comes null"),16;this.GM&&window.setTimeout(()=>{this.GM.execute(vd=>{vd.R5a("TellMeSurvey",null)})},mf.Ezi);return 32};this.c9=(ua,Xa,Pb,hc,Qc)=>{Pb=window.performance.now();this.kck(Xa);mf.instance.Ah.TKk(Xa);mf.instance.Sh.$k?(this.AAa=this.ofd.dIi(Xa,ua,Qc),mf.instance.Sh.J7?
(mf.instance.actions.push(appChrome.actions.updateTellMeSearchResults(this.AAa.menuModel,ua,Qc)),appChrome.api.dispatch(mf.instance.actions)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.AAa.menuModel,ua,Qc)),mf.instance.Sh.L3c&&this.Z9a&&(Na.c(mf.instance.gD)||mf.instance.gD.Location!==nd.contextMenu)&&(this.mz.mark(2),this.mz.measure(0,1,2))):this.M$=this.E0e.eIi(Xa,mf.instance.Ah.yR);this.O8a&&this.Ve.Ag(this.O8a);Qc={};Qc.GroupsCount=Xa.length;Qc.QueryID=hc;Qc.QueryLength=
ua.length;mf.instance.Ah.jR(qd.Z$h,window.performance.now()-Pb,Qc)};this.UAj=(ua,Xa,Pb,hc,Qc)=>{if(1===Pb)return 32;if(Na.c(Qc))return mf.instance.Ah.onError("TellMeActor:LaunchAddinStore","actiondata comes null"),16;if(this.ya.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinActionDataRefactor",!1)){ua={};ua.SourceControlId=Qc.SourceControlId;ua.Query=Qc.CommandValueId;Qc=this.pb.pe(S.a.pXb,2,ua);if(32!==Qc)mf.instance.Ah.onError("TellMeActor:LaunchAddinStore","CommonCommands.LaunchAppforOfficeDialog failed. Response: "+
Qc+".");return Qc}return this.pb.pe(S.a.pXb,2,Qc)};this.C1d=(ua,Xa,Pb,hc,Qc)=>{if(1===Pb)return 32;if(Na.c(Qc))return mf.instance.Ah.onError("TellMeActor:LaunchAddin","actiondata comes null"),16;ua=Qc.CommandValueId;if(Na.b(ua))return mf.instance.Ah.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),16;if(!ue.qSa[ua])return mf.instance.Ah.onError("TellMeActor:LaunchAddin","Add-in with assetId "+ua+" doesn't not exist in entitlements"),16;Xa=ue.qSa[ua];Pb={};Pb.solutionId=Xa.id;Pb.version=
Xa.appVersion;Pb.storeType=Xa.storeType;Pb.storeId=Xa.storeId;Pb.assetId=Xa.assetId;Pb.assetStoreId=Xa.assetStoreId;Pb.displayName=Xa.displayName;Pb.targetType=Xa.targetType;Pb.height=Xa.height;Pb.width=Xa.width;Xa=this.pb.pe(S.a.wXf,2,Pb);if(32!==Xa)mf.instance.Ah.onError("TellMeActor:LaunchAddin","CommonCommands.InsertOfficeAddin failed. Response: "+Xa+". AssetId: "+ua);return Xa};this.BZc=()=>{if(!Na.c(this.GM))for(const ua of ii.a.instance.QOa){if("ShowContextMenuWithFloatie"===ua.commandId)return this.GM.execute(Xa=>
{Xa.logActivity("TellMe1TabSwitchCoachMarkActivity",null)}),32;if(ua.commandId&&-1===ua.commandId.indexOf("Tab"))break}return 8};this.tj=P?P:new Rc}hzc(){return this.tj.hzc()}sKd(){return this.tj.sKd()}kPd(){return this.tj.kPd()}mKd(){return this.tj.mKd()}nKd(){return this.tj.nKd()}get OKb(){return this.oW?this.oW.contentType:mf.unknown}BMd(){return this.tj.WY}kf(){return this.tj.kf()}get actions(){return this.tj.actions}set actions(P){this.tj.actions=P}hjb(){return this.tj.hjb()}Dz(){return this.tj.Dz()}TLd(){return this.tj.TLd()}get UYb(){return this.tj.UYb}set vfd(P){this.tj.UYb=
P}get oac(){return this.tj.oac}set mgc(P){this.tj.oac=P}QOd(){return this.tj.QOd()}performance(){return this.mz}get F7b(){return this.tj.T5a}set F7b(P){this.tj.T5a=P}get Dza(){return this.tj.Dza}set Dza(P){this.tj.Dza=P}t$(P){return this.tj.t$(P)}initialize(P,ua,Xa,Pb,hc,Qc,vd,Nd,ke,Be,Ze){ua=void 0===ua?null:ua;Xa=void 0===Xa?null:Xa;Pb=void 0===Pb?null:Pb;hc=void 0===hc?null:hc;Qc=void 0===Qc?null:Qc;vd=void 0===vd?null:vd;Nd=void 0===Nd?null:Nd;ke=void 0===ke?null:ke;Be=void 0===Be?null:Be;Ze=
void 0===Ze?null:Ze;mf.instance.Sh=P;this.Noa=!!J.AFrameworkApplication.ua&&J.AFrameworkApplication.ua.Ab.AZd;mf.instance.Ah=Pb;if(!Pb){Pb=new ti;Pb.sessionId=J.AFrameworkApplication.userSessionId;const of=Sa.a.kN(J.AFrameworkApplication.lcid)||Sa.a.Wkj;mf.instance.Ah=new Zi(new cj(mf.instance.Sh.application,of.name,Pb,mf.instance.Sh.$k,this.Noa,P.tellMeInSharedHeaderIsEnabled,null),mf.instance.Sh.A3h,mf.instance.Sh)}this.dpa=new ui(mf.instance.Sh.parameterData);this.E0e=Xa||new Yh(mf.instance.Sh,
this.dpa);mf.instance.Y5c=vd;this.ofd=this.ofd||new hh(mf.instance.Sh,mf.instance.Sh.parameterData,vd);this.kd=Mh.FocusManager.instance();this.WY=mi.createInstance(mf.instance.Sh);mf.instance.ujb=new hj(P);this.pb=hc||J.AFrameworkApplication.Kb;this.Ve=Qc||J.AFrameworkApplication.Rj;this.pW=ke;this.S_=ua;this.GM=Ze;this.mz=new Si;this.jra=new Oc.a(kd.a.Ef());this.mhc=[];ke?ke.execute(of=>{of.isFeatureEnabled(mf.z3k,!0).then(Xf=>{this.oBb=Xf;this.S_=this.S_||gj.createInstance(this.WY,mf.instance.Sh,
this.dpa,this.oBb);for(const bg of this.mhc)this.S_.Ou(bg.provider,bg.Tye);this.mhc=[];return null})}):(this.oBb=!0,this.S_=this.S_||gj.createInstance(this.WY,mf.instance.Sh,this.dpa,this.oBb));this.ya=Nd;this.M$=Yh.Uuc;this.mgc=new Promise(()=>{});Be&&Be.execute(of=>{this.oW=of})}wi(){this.QBh()}QBh(){this.pb.ef(S.a.tellMe,ba.a.frame,Object(Ha.a)(this,this.tellMe,"tellMe"),96);this.pb.ef(S.a.tellMeCacheAsyncMenuRefresh,ba.a.frame,Object(Ha.a)(this,this.WSh,"cacheAsyncMenuRefreshFunction"),96);this.pb.ef(S.a.tellMeLogCommandExecuted,
ba.a.frame,Object(Ha.a)(this,this.PFj,"logItemExecuted"),96);this.pb.ef(S.a.tellMeLogMenuClose,ba.a.frame,Object(Ha.a)(this,this.QEj,"logControlDeactivation"),96);this.pb.ef(S.a.tellMeLogInputFocus,ba.a.frame,Object(Ha.a)(this,this.LFj,"logInputFocus"),96);this.pb.ef(S.a.tellMeInteractionBegin,ba.a.frame,Object(Ha.a)(this,this.bTb,"interactionBegin"),96);this.pb.ef(S.a.tellMeRestoreFocus,ba.a.frame,Object(Ha.a)(this,this.bTb,"interactionBegin"),96);this.pb.ef(S.a.tellMeLogInputBlur,ba.a.frame,Object(Ha.a)(this,
this.KFj,"logInputBlur"),96);this.pb.ef(S.a.tellMeLogMenuOpen,ba.a.frame,Object(Ha.a)(this,this.NEj,"logControlActivated"),96);this.pb.ef(S.a.tellMeFocusInput,ba.a.frame,Object(Ha.a)(this,this.QDi,"focusSearchBox"),96);this.pb.ef(S.a.tellMeAccessibilityMenuText,ba.a.frame,Object(Ha.a)(this,this.z2h,"constructLiveNotificationForMenu"),96);this.pb.ef(S.a.tellMeTryQuery,ba.a.frame,Object(Ha.a)(this,this.AXf,"insertTryQuery"),96);this.pb.ef(S.a.UBj,ba.a.frame,Object(Ha.a)(this,this.AXf,"insertTryQuery"),
96);this.pb.ef(S.a.iAi,ba.a.frame,this.Lwa,96);this.pb.ef(S.a.jAi,ba.a.frame,this.Lwa,96);this.pb.ef(S.a.kAi,ba.a.frame,this.Lwa,96);this.pb.ef(S.a.lAi,ba.a.frame,this.Lwa,96);this.pb.ef(S.a.mAi,ba.a.frame,this.Lwa,96);this.pb.ef(S.a.T7j,ba.a.frame,this.Lwa,96);this.pb.ef(S.a.U7j,ba.a.frame,this.Lwa,96);this.pb.ef(S.a.V7j,ba.a.frame,this.Lwa,96);this.pb.ef(S.a.Fak,ba.a.frame,this.fEc,96);this.pb.ef(S.a.Gak,ba.a.frame,this.fEc,96);this.pb.ef(S.a.Hak,ba.a.frame,this.fEc,96);this.pb.ef(S.a.tellMeFeedback,
ba.a.frame,this.openFeedback,96);this.pb.ef(S.a.B3k,ba.a.frame,this.Lwa,96);this.pb.ef(S.a.aHh,ba.a.frame,this.C1d,96);this.pb.ef(S.a.bHh,ba.a.frame,this.C1d,96);this.pb.ef(S.a.cHh,ba.a.frame,this.C1d,96);this.pb.ef(S.a.BZc,ba.a.frame,this.BZc,96);this.pb.ef(S.a.TAj,ba.a.frame,this.UAj,96);this.pb.ef(S.a.fik,ba.a.frame,this.gik,96);this.pb.ef(S.a.YHi,ba.a.frame,this.XHi,96)}QDi(P,ua,Xa){if(1===Xa)return 32;this.ISg();P=!1;(mf.instance.Sh.tellMeInSharedHeaderIsEnabled||this.Noa)&&(ua=document.getElementById("SearchButton"))&&
ua.click();if(!mf.instance.Sh.tellMeInSharedHeaderIsEnabled&&this.Noa)for(ua=document.getElementsByClassName("ms-suiteux-search-box"),Xa=0;Xa<ua.length;Xa++){const Pb=ua[Xa].querySelector("input[type=search]");Pb&&(P=Mh.FocusManager.oza(Pb))}else P=Mh.FocusManager.oza($get(mf.instance.Sh.$k?li.a.Mte:li.a.G0c));this.jBb=!0;return P?32:8}AXf(P,ua,Xa,Pb,hc){if(1===Xa)return 32;if(Na.c(hc))return mf.instance.Ah.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.ISg();P=hc.CommandValueId;
ua=mf.instance.Sh.$k?li.a.Mte:li.a.G0c;mf.instance.Sh.$k&&!Na.c(hc.ShouldCanvasTakeFocus)&&(hc.ShouldCanvasTakeFocus=!1);if(P){if(mf.instance.Sh.$k)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(P)),this.MAa=[19],32;if(hc=$get(ua))hc.value=P}return Mh.FocusManager.oza($get(ua))?32:8}ISg(){this.kd.H3(mf.instance.Sh.tellMeInSharedHeaderIsEnabled||this.Noa?mf.instance.Sh.PCc:mf.instance.Sh.MLa,!1)}CIi(P,ua){switch(P){case 0:return String.format(Object(pc.a)("TellMeClassifierCommandAccessibleLabelFormat"),
ua);case 4:return String.format(Object(pc.a)("TellMeRecentlyUsedAccessibleLabelFormat"),ua);case 5:return String.format(Object(pc.a)("TellMeTryQueryAccessibleLabelFormat"),ua);case 7:case 16:return String.format(Object(pc.a)("TellMeTryCommandAccessibleLabelFormat"),ua)}return ua}z2h(P,ua,Xa,Pb,hc){if(1===Xa)return 32;if(Na.c(hc))return mf.instance.Ah.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;P=this.M$?this.M$.ZKg:0;hc.Value=1!==P?String.format(Object(pc.a)("LookupLiveNotificationResultPluralFormText"),
P):Object(pc.a)("LookupLiveNotificationResultSingularFormText");if(this.M$)for(const Qc of this.M$.eii)hc=Object(xf.a)(nc,Qc)?Qc.id:oa.a.replaceAll(Qc.value,'"',""),(hc=$get(hc+"-"+bd.Ewe))&&cg.a.Gk(hc,cg.a.oy,oa.a.Ig(this.CIi(Qc.groupType,hc.innerText)));return 32}WSh(P,ua,Xa,Pb,hc){if(1===Xa)return 32;if(Na.c(hc))return mf.instance.Ah.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.O8a=new Vc.a(2,1,0,()=>{hc[yj.a.Callback]()},97);this.M$&&this.Ve.Ag(this.O8a);
return 32}PFj(P,ua,Xa,Pb,hc){if(1===Xa)return 32;if(Na.c(hc))return mf.instance.Ah.onError("TellMeActor:LogItemExecuted","actiondata comes null"),16;hc.CloseAllMenus&&(P=void 0===hc.ParentControlId||null===hc.ParentControlId?"<NA>":hc.ParentControlId,ua=this.W8a?this.W8a[hc.ControlId]:null,!ua&&this.W8a&&"<NA>"!==P&&(ua=this.W8a[P]),ua||(ua=this.m$a&&this.WY.eoj(hc),ua=this.igi(ua,hc.ControlId),ua=new $i(ua,33,4,-1,-1,-1),mf.instance.Ah.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+
hc.ControlId+" determined group:"+qg[ua.groupType])),mf.instance.Ah.hVj(hc.ControlId,P,hc.CommandId,hc.CloseAllMenus,ua),this.dpa.CQj(hc.ControlId),hc.Location!==nd.contextMenu&&(this.WY.zha(hc),this.WY.Ou(ua.resultType),mf.instance.Sh.UYc&&this.S_.eAh(hc.CommandId)));return 32}QEj(P,ua,Xa,Pb,hc){if(1===Xa)return 32;(new ni(this.hjb())).YYi(this.g9a);P=this.g9a;ua=this.vsc();Xa=mf.instance.Ah.Rcc;if(Na.c(hc))return mf.instance.Ah.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),
16;hc=hc.UILocation;P&&0<P.length&&this.oBb&&bd.Bre(mf.instance.Sh)&&mf.instance.Sh.BIc&&19!==hc&&ua>Xa&&!mf.instance.Sh.dD&&(mf.instance.Ah.j3d(P),mf.instance.Ah.Soe(ua));mf.instance.Ah.zyk();mf.instance.Sh.L3c&&19!==hc&&(this.mz.mark(3),this.mz.measure(1,0,3),this.mz.measure(2,2,3),this.mz.U2d(0,1,2),this.mz.U2d(2,2,3),this.mz.U2d(1,0,3),this.mz.VYh(),this.mz.clearMeasures([0,2,1]));mf.instance.Ah.KVj(window.performance.now()-this.sfd);mf.instance.Sh.$k&&(this.AAa=null,mf.instance.Ah.Awa());this.jBb=
this.Z9a=!1;this.g9a="";return 32}LFj(P,ua,Xa){if(1===Xa)return 32;mf.instance.Ah.fKa(xj(ua),this.jBb);return 32}KFj(P,ua,Xa){if(1===Xa)return 32;mf.instance.Ah.Awa();this.Z9a=!1;return 32}NEj(P,ua,Xa,Pb,hc){if(1===Xa)return 32;mf.instance.gD=null;hc&&(mf.instance.gD=hc);mf.instance.Sh.L3c&&(Na.c(mf.instance.gD)||mf.instance.gD.Location!==nd.contextMenu)&&this.mz.mark(0);mf.instance.Ah.WXc(Na.c(mf.instance.gD)||Na.c(mf.instance.gD.Location)?nd.unknown:mf.instance.gD.Location);mf.instance.Ah.JVj(this.zSe,
this.jBb);this.Z9a||this.Bwa();return 32}bkf(P,ua){const Xa=[],Pb=Date.now();for(const hc of P)P=(Pb-hc.timeStamp)/1E3,P=bd.K1c(P),Array.add(Xa,new Xi(ua?hc.commandId:hc.controlId,P));return Xa}Lbi(P){const ua=[],Xa=Date.now();for(const Pb of P)if(Pb.controlId||"keyboardShortcut"===Pb.commandSurface)P=(Xa-Pb.timeStamp)/1E3,P=bd.K1c(P),Array.add(ua,new Rd(Pb.controlId,Pb.commandId,P,Pb.commandSurface,Pb.K0c));return ua}Lkf(P){var ua=(void 0===P?0:P)?this.WY.WYi():this.WY.oGa();P=[];const Xa=Date.now();
for(const Pb of ua)ua=(Xa-Pb.TimeStamp)/1E3,ua=bd.K1c(ua),Array.add(P,new Xi(Pb.Id,ua));return P}Bwa(){if(!this.Z9a){this.m$a=this.Z9a=!0;if(!this.OPe){this.OPe=!0;const P={};P.IsMLREnabled=mf.instance.Sh.Atj;P.IsReactRibbonEnabled=mf.instance.Sh.$k;P.IsSharedHeaderEnabled=!!J.AFrameworkApplication.ua&&J.AFrameworkApplication.ua.Ab.ms;P.IsSearchUxEnabled=this.Noa;P.IsTellMeInHeaderEnabled=mf.instance.Sh.tellMeInSharedHeaderIsEnabled;P.IsGoLocalEnv=bd.trj();P.IsSovereignEnvironment=bd.smb();P.IsTellMeServiceResultsEnabled=
bd.Bre(mf.instance.Sh);P.IsSubstrateProviderEnabled=bd.Are(mf.instance.Sh);P.ShouldFetchTokens=!!J.AFrameworkApplication.ua&&J.AFrameworkApplication.ua.Ab.F5a;P.IsSerpletEnabled=bd.G2();P.FirstOnClickTimeInMS=Math.round(window.performance.now());P.IsHeaderHidden=J.AFrameworkApplication.hideHeader||J.AFrameworkApplication.hideHeaderEmbedded;P.IsSearchInHeaderHidden=J.AFrameworkApplication.hideSearchInHeaderByUiHost;void 0!==window.performance.timing&&null!==window.performance.timing&&(P.TimeSinceFetchStart=
Math.round(Date.now()-window.performance.timing.fetchStart));P.IsFindWithMatchesEnabled=mf.instance.Sh.DBf;P.HelpShowsTopSearchResult=mf.instance.Sh.Y6b;P.HelpShowsNumberOfMatches=mf.instance.Sh.X6b;J.AFrameworkApplication.ea&&(P.UiHost=J.AFrameworkApplication.ea.Qa("UiHostIntegrationType"));mf.instance.Ah.hHj(JSON.stringify(P))}this.web=this.bkf(ii.a.instance.gzb,!1);this.veb=this.bkf(ii.a.instance.QOa,!0);this.axb=this.Lbi(ii.a.instance.QOa);this.wob=this.Lkf();this.xob=this.Lkf(!0);mf.instance.Ah.Bwa()}}bTb(P,
ua,Xa,Pb,hc){if(1===Xa)return 32;if(Na.c(hc))return mf.instance.Ah.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;this.sfd=window.performance.now();this.Bwa();P=new ij(this.c9,0);mf.instance.T3++;mf.instance.Ah.beginQuery("",mf.instance.T3,this.m$a);this.h$b(!0,null);this.M$=Yh.Uuc;this.AAa=hh.vDd;if(this.S_)mf.instance.actions=[],this.S_.Nx(new Qh("",mf.instance.T3),P,mf.instance.Sh.$k);else mf.instance.Ah.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");
this.O8a&&this.Ve.Ag(this.O8a);return 32}Qea(P,ua,Xa){if(1===Xa)return 32;this.kd.uea(mf.instance.Sh.tellMeInSharedHeaderIsEnabled||this.Noa?mf.instance.Sh.PCc:mf.instance.Sh.MLa,!1);return 32}tellMe(P,ua,Xa,Pb,hc){if(1===Xa)return 32;if(Na.c(hc))return mf.instance.Ah.onError("TellMeActor:TellMe","actiondata comes null"),16;mf.instance.gD=hc;mf.instance.Ah.WXc(Na.c(mf.instance.gD.Location)?nd.unknown:mf.instance.gD.Location);P=mf.instance.gD.Value;mf.instance.Sh.$k||P&&""!==P.trim()?(!this.AAa&&mf.instance.Sh.$k&&
(mf.instance.Ah.fKa(xj(ua),this.jBb),this.Bwa()),this.myi(P,mf.instance.gD.Location),mf.instance.gD.PopulationXML=this.M$.xml):this.m$a?mf.instance.gD.PopulationXML=this.M$.xml:(mf.instance.gD.PopulationXML=Yh.Uuc.xml,this.AAa=hh.vDd,this.g9a="");return 32}myi(P,ua){this.sfd=window.performance.now();mf.instance.Sh.L3c&&ua!==nd.contextMenu&&this.mz.mark(1);mf.instance.Sh.$k&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(P));P&&0<P.trim().length&&(this.m$a=!1);mf.instance.Sh.aoi();
ua=Na.c(ua)?nd.tellMe:ua;if(P!==this.g9a||mf.instance.Sh.$k){mf.instance.T3++;mf.instance.Ah.beginQuery(P,mf.instance.T3,this.m$a);this.h$b(!0,null);const Xa=new Qh(P,mf.instance.T3),Pb=new ij(this.c9,mf.instance.T3);this.M$=Yh.Uuc;this.AAa=hh.vDd;if(this.S_)mf.instance.actions=[],this.S_.Nx(Xa,Pb,mf.instance.Sh.$k,ua,this.MAa),this.MAa=null;else mf.instance.Ah.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.zSe=mf.instance.T3;this.g9a=P}}Hdl(P){if(mf.instance.Sh.$k){var ua=
appChrome.selectors.getActiveControlStates();if(ua=Object(Lh.a)(Object,ua[P.value])){P.label=ua.label;let Xa=null;"description"in ua&&(Xa=ua.description);Xa&&Object.getType(Xa)===String?P.description=Xa:"secondaryText"in ua?P.description=ua.secondaryText:"fullDescriptionLabel"in ua&&(P.description=ua.fullDescriptionLabel)}}}kck(P){this.W8a={};let ua=0,Xa=0;for(const Pb of P){P=0;for(const hc of Pb.results)this.W8a[hc.value]=new $i(hc.groupType,hc.type,hc.subType,ua,P,Xa),P++,Xa++,hc.label||5!==hc.type||
this.Hdl(hc);0<P&&ua++}}openUrlInNewTab(P,ua,Xa,Pb,hc){if(1===Xa)return 32;if(Na.c(hc))return mf.instance.Ah.onError("TellMeActor:OpenUrlInNewTab","actiondata comes null"),16;(P=hc.CommandValueId)&&window.open(P,"_blank");return 32}U8f(P){const ua={};ua.token=this.F7b;ua.files=Ic.c(P);ua.type="MultiFilesDeckGeneration";if(J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFastCards",!1))return this.pb.pe(S.a.jBj,2,ua),!0;P=bd.WNf("",bd.aLg("GenerateDeckFromFile"),
Object.assign(new yb,{landingTab:"All",data:ua}));P=this.pb.pe(S.a.vlj,2,P);return 32!==P?(mf.instance.Ah.onError("LaunchSmartLookupWithFilesData","CommonCommands.InvokeSerplet failed. Response: "+P+"."),!1):!0}gkj(P,ua){if(1===P)return 32;if(Na.c(ua))return mf.instance.Ah.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(Na.c(this.Bec))return mf.instance.Ah.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),16;P=ua.CommandValueId;return Na.c(P)?(mf.instance.Ah.onError("TellMeActor:InsertUrl",
"commandValueId comes null"),16):this.Bec.insertHtmlText(P)?32:(mf.instance.Ah.onError("TellMeActor:InsertUrl","url is not inserted"),16)}igi(P,ua){return ua.startsWith(mf.instance.Sh.$k?bd.Lye:bd.O1c)?5:P?4:"bSearchHelp"===ua||ua.startsWith("GetHelpFromTellMe")?8:"bInsights"===ua||ua.startsWith("SmartLookupFromTellMe")?13:"ActionAIFromTellMe"===ua?24:ua===mf.instance.Sh.CBf?2:0}vsc(){return this.tj.vsc()}Ou(P,ua){this.S_?this.S_.Ou(P,ua):Array.add(this.mhc,new Ei(P,ua))}h$b(P,ua,Xa){return this.tj.h$b(P,
void 0===ua?"":ua,void 0===Xa?null:Xa)}static get instance(){return mf.Wa||(mf.Wa=new mf(Rc.instance))}get Sh(){return this.tj.Sh}set Sh(P){this.tj.Sh=P}set Y5c(P){this.tj.Y5c=P}get ujb(){return this.tj.ujb}set ujb(P){this.tj.ujb=P}get Ah(){return this.tj.Ah}set Ah(P){this.tj.Ah=P}get T3(){return this.tj.T3}set T3(P){this.tj.T3=P}get jra(){return this.tj.jra}set jra(P){this.tj.jra=P}get gD(){return this.tj.gD}set gD(P){this.tj.gD=P}get wob(){return this.tj.wob}set wob(P){this.tj.wob=P}get web(){return this.tj.web}set web(P){this.tj.web=
P}get veb(){return this.tj.veb}set veb(P){this.tj.veb=P}get axb(){return this.tj.axb}set axb(P){this.tj.axb=P}get WY(){return this.tj.WY}set WY(P){this.tj.WY=P}get T5a(){return this.tj.T5a}set T5a(P){this.tj.T5a=P}get xob(){return this.tj.xob}set xob(P){this.tj.xob=P}}mf.Wa=null;mf.z3k="mso_tellMeService";mf.unknown="Unknown";mf.Ezi=500;Object(n.a)(mf,"TellMeActor",null,[]);var Vg=a(174),Hh=a(310),Nh=a(1550),Yi=a(879);class pi{constructor(P,ua,Xa,Pb,hc){P=void 0===P?null:P;ua=void 0===ua?null:ua;
Xa=void 0===Xa?null:Xa;hc=void 0===hc?null:hc;this.K6c=null;this.YGe=!1;this.Smh=this.F8a=null;this.nuh=this.rYe=this.Zih=this.Tmh=!1;this.Hcc=null;this.jjh=null==ua?J.AFrameworkApplication.SSa:ua;this.Goh=null==Xa?J.AFrameworkApplication.IHa:Xa;this.Juh=null==hc?J.AFrameworkApplication.Hya:hc;this.Wnh=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.ka("TellMeHelpOnHelpIsEnabled");this.Ivh=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.ka("TellMeCommandHookIsEnabled");this.tOk(!!J.AFrameworkApplication.ea&&
J.AFrameworkApplication.ea.ka("TellMeIgnoreQueryForHelp"));this.Avh=!!J.AFrameworkApplication.ua&&J.AFrameworkApplication.ua.Ab.cWb;this.Bvh=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.ka("TellMePeopleSuggestionIsEnabled");this.zvh=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.ka("TellMeFileSuggestionIsEnabled");this.Emh=!!J.AFrameworkApplication.ua&&J.AFrameworkApplication.ua.Ab.F5a;this.Cvh=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.ka("TellMeSeeMoreButtonIsEnabledInZeroTerm");
this.guh=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.ka("HelpShowsTopSearchResult");this.Brh=this.Y6b||this.X6b;this.zrh=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.ka("OnlineCommandSuggestionsIsEnabled");this.Arh=this.PXd;this.Jph=!!J.AFrameworkApplication.ea&&this.tellMeInSharedHeaderIsEnabled&&J.AFrameworkApplication.ea.ka("StyledHeaderInLabelIsEnabled");this.vnh=J.AFrameworkApplication.ea?J.AFrameworkApplication.ea.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",
1400):1400;this.Bnh=J.AFrameworkApplication.ea?J.AFrameworkApplication.ea.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;this.rnh=J.AFrameworkApplication.ea?parseFloat(J.AFrameworkApplication.ea.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold","-0.6")):-.6;this.Hph=!!J.AFrameworkApplication.ea&&(J.AFrameworkApplication.ea.ka("SmartLookupNoteSearchIsEnabled")||J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",
!1));this.wph=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTOChatPPTCopilot",!1);this.Uph=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotPaneEnabled",!1);this.Moh=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.isActionAIEnabledInTellMe",!1)&&(this.fzj||this.fuj);this.Hab=!!J.AFrameworkApplication.ea&&
J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceActionAIEnabled",!1);this.hvh=J.AFrameworkApplication.ea?J.AFrameworkApplication.ea.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl","https://substrate.office.com/search/api/v1/suggestions"):"https://substrate.office.com/search/api/v1/suggestions";this.Cnh=J.AFrameworkApplication.ea?J.AFrameworkApplication.ea.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",
""):"";this.huh=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",!1);this.Euh=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",!1);this.luh=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.ka("ShowFindInDocumentInZeroTermSearchBox")||this.dD;this.Rph=!!J.AFrameworkApplication.ea&&(J.AFrameworkApplication.ea.ka("TellMeTemplateProviderIsEnabled")||
J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.iph=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.FormulaProviderEnabled",!1);this.sph=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",!1);this.Dph=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.ka("TellMeIsRuleBasedSortingEnabled")&&
"en-US"===J.AFrameworkApplication.uiCulture;this.Oph=!!J.AFrameworkApplication.ea&&(J.AFrameworkApplication.ea.ka("TellMeFeedbackProviderIsEnabled")||J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",!1));this.Xph=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.ka("TellMeZeroTermContextualCommandSuggestionsEnabled");this.$ih=this.tellMeInSharedHeaderIsEnabled&&!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",
!1);this.Nnh=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",!1);this.Huh=!!J.AFrameworkApplication.ea&&(J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",!1)||"Word"!==J.AFrameworkApplication.ea.Qa("Application"));this.Ljh=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",
!1);this.ywh=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.ka("TellMePerformanceMarkerEnabled");this.Qoh=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",!1);this.Uoh=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1);this.Anh=J.AFrameworkApplication.ea?J.AFrameworkApplication.ea.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",
0):0;this.Qph=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.ka("TellMeNotesSuggestionIsEnabled")||this.C5f;this.Soh=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",!1);this.Toh=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",!1);this.Roh=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",
!1);this.hmh=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMe",!1);this.imh=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMeMVP",!1);this.fmh=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.dyd&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableBumblebeeEntryPointInTellMe",!1);
this.Crh=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.dyd&&J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenCopilotFromTellMe",!1);this.Dvh=this.Pxj&&(this.Rae||this.Sae||this.u0b||this.tellMeInSharedHeaderIsEnabled&&bd.G2()&&!!J.AFrameworkApplication.ea&&(this.Iub||this.Eub||this.Gub||this.Hub||this.Kub||J.AFrameworkApplication.ea.ka("ShowAnswerSearchResults")||J.AFrameworkApplication.ea.ka("ShowDefinitionSearchResults")||J.AFrameworkApplication.ea.ka("ShowEntitySearchResults")||
J.AFrameworkApplication.ea.ka("ShowWolframSearchResults")));this.yih=!!J.AFrameworkApplication.ea&&!J.AFrameworkApplication.ea.ka("AppsForOfficeThirdPartyIsDisabled")&&J.AFrameworkApplication.ea.ka("AppsForOfficeAllowExternalMarketplace")&&J.AFrameworkApplication.ZW;this.zih=!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.ka("AppsForOfficePrivateCatalogIsEnabled");this.chj(P||{});this.aic="2918242107";this.$hc="1454393937";this.CQa={};this.nCa=[];this.A3h=[bd.O1c]}get application(){return this.F8a}get SSa(){return this.jjh}get yEk(){return this.aic}get xEk(){return this.$hc}get CBf(){return this.Smh}get tBi(){return this.Tmh}get IHa(){return this.Goh}get Hya(){return this.Juh}get ISa(){return this.Zih}get Kbj(){return this.Wnh}get I3k(){return this.Ivh}get Pxj(){return!0}get A3k(){return this.Dvh}get zRk(){return this.rYe}tOk(P){this.rYe=
P}get tellMeInSharedHeaderIsEnabled(){return this.Avh}get $8b(){return this.Bvh}get Z8b(){return this.zvh}get fetchTokensForSearch(){return this.Emh}get y3k(){return this.Cvh}get rye(){return!1}get u0b(){return this.Brh}get Rae(){return this.zrh}get Sae(){return this.Arh}get EIa(){return!1}get BIc(){return!1}get VZd(){return this.Jph}get xse(){return this.nuh}get Iub(){return!1}get ZSk(){return!1}get VBj(){return""}get ZYi(){return 4}get $Yi(){return 5}get D0i(){return""}get uQi(){return this.vnh}get VNf(){return this.Bnh}get F0i(){return 1E3}get E0i(){return 1E-6}get H1k(){return this.hvh}get Gve(){return!1}get G1k(){return!1}get hwj(){return this.Dph}get uZd(){return!1}get vZd(){return!1}get qtj(){return!1}get ptj(){return!1}get C5f(){return!1}get F5f(){return!1}get DBf(){return!1}get yub(){return!1}get Eub(){return!1}get Gub(){return!1}get Hub(){return!1}get Kub(){return!1}get Y6b(){return this.guh}get Aub(){return this.huh}get X6b(){return!1}get EKd(){return null}get pZd(){return!1}get UYc(){return this.luh}get DLf(){return 0}get iMi(){return this.rnh}get lOf(){return this.Cnh}get axj(){return this.Hph}get DEc(){return this.Moh}get TYc(){return this.Hab}get dLf(){return-3.9}get dD(){return this.Euh}get dWb(){return this.Rph}get LWd(){return this.iph}get $Xd(){return this.sph}get a_d(){return this.Oph}get eDa(){return this.$ih}get nzj(){return this.Xph}get J7(){return this.Nnh}get AYg(){return this.Huh}get jPh(){return this.Ljh}get L3c(){return this.ywh}get GEc(){return this.Qoh}get $lj(){return this.Uoh}get jm(){return this.Anh}get FIa(){return this.Qph}get Ylj(){return this.Soh}get Zlj(){return this.Toh}get Xlj(){return this.Roh}get t5e(){return this.yih}get u5e(){return this.zih}get EX(){return this.hmh}get Xuc(){return this.imh}get Vuc(){return this.fmh}get fzj(){return this.Uph}get fuj(){return this.wph}get a8j(){return this.Crh}get SQ(){return!!J.AFrameworkApplication.ua&&
J.AFrameworkApplication.ua.Ab.$k}get $k(){return!!J.AFrameworkApplication.ua&&J.AFrameworkApplication.ua.Ab.$k}get Atj(){return!!J.AFrameworkApplication.ua&&J.AFrameworkApplication.ua.Ab.hSk}get vhg(){return cd.c("OfficeAssistant_32x32x32")}UQi(){return Promise.reject("GetFindMatchCount method is not overridden")}Cmb(P){return Array.contains(appChrome.selectors.getVisibleControlIds(),P)}jFc(){return!1}get JXd(){return!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.ka("TellMeModelRankerEnabled")}get E1g(){return J.AFrameworkApplication.ea?
J.AFrameworkApplication.ea.Qa("TellMeServiceHelpClassifierModelName"):""}get PXd(){return!!J.AFrameworkApplication.ea&&J.AFrameworkApplication.ea.ka("TellMeMultiLingualCommandModelEnabled")}get PCc(){return"NoOpHeaderUi"}get z3h(){return this.Hcc}get parameterData(){return this.CQa}get I9k(){return this.nCa}aoi(){if(this.K6c&&!this.YGe&&(this.YGe=!0,this.QSg(this.K6c),this.$k)){var P=Object(ea.a)(Nh.a);P=(new Yi.a(P)).fib(this.K6c.uk);appChrome.api.dispatch(P)}}QSg(){}ngi(P){const ua=[];for(let Xa=
0;Xa<P.length;++Xa)P[Xa].MTk?ua.push(new Jc.a(P[Xa].EIh,bd.X4g+Xa.toString())):ua.push(new Jc.a(P[Xa].standard,bd.O1c+Xa.toString()));return ua}chj(P){const ua={};for(const Xa in P){const Pb=Xa,hc=P[Xa];for(const Qc in hc){const vd=Qc,Nd=hc[Qc];(ua[vd]||(ua[vd]={}))[Pb]=Nd}}this.Hcc=ua}get F1g(){return""}get VWg(){return!1}}Object(n.a)(pi,"TellMeApplicationData",null,[520]);class rf{constructor(P,ua,Xa){this.standard=P;this.EIh=void 0===ua?null:ua;this.MTk=void 0===Xa?!1:Xa}}Object(n.a)(rf,"TryQuerySet",
null,[]);var kj=a(282);class Hi{constructor(){this.QSe=this.RSe=null}get JMj(){return this.QSe}rX(P){this.RSe=P;return null}AQj(){this.QSe=this.RSe}lKf(P){return 8===P.type?String.format(Object(pc.a)("FindInDocumentText"),P.qG):P.qG}JMi(P){return P.qG}}Object(n.a)(Hi,"ParameterizedCommand",null,[]);class lj extends Hi{constructor(){super(...arguments);this.x3k=fc.a.instance.La(1029)}get commandId(){return"InsertFunctionParameterized"}get k$j(){return"InsertFunction"}lKf(P){return String.format(this.x3k,
P.qG)}}Object(n.a)(lj,"InsertFunctionParameterizedCommand",Hi,[]);class Ii extends pi{constructor(P){super();this.F8a="Excel";this.aic="-1376725189";this.$hc="-1386334072";if(J.AFrameworkApplication.ea.ka("TellMeTryQueriesIsEnabled")){var ua=[new rf(fc.a.instance.La(426),"",!1),new rf(fc.a.instance.La(427),"",!1),new rf(fc.a.instance.La(428),"",!1),new rf(fc.a.instance.La(429),"",!1),new rf(fc.a.instance.La(430),"",!1)];this.nCa=this.ngi(ua)}J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.FormulaProviderEnabled",
!1)&&(ua=new lj,this.parameterData[ua.commandId]=ua);this.$=P}get MLa(){return kj.a.E4b}get vhg(){return cd.c("OfficeAssistant_32x32x32")}QSg(P){const ua=J.AFrameworkApplication.ea.ka("TellMeDesktopUpSellIsEnabled"),Xa=J.AFrameworkApplication.Qxj;P=P.uk;P.MacrosUpSellButton=!ua||Xa;P.HeaderFooterUpSellButton=!ua||Xa;P.MacrosUpSellButtonEnterprise=!ua||!Xa;P.HeaderFooterUpSellButtonEnterprise=!ua||!Xa}get C5f(){return J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.NotesSuggestionIsEnabled",
!1)}get F5f(){return J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.ZeroTermNotesSuggestionIsEnabled",!1)}get DLf(){return J.AFrameworkApplication.ea.getIntFeatureGate("Microsoft.Office.Excel.TellMe.NumberOfNotesSuggestionsToShow",2)}get F1g(){return J.AFrameworkApplication.ea.getStringFeatureGate("Microsoft.Office.Excel.TellMe.MultiLanguageModelName","")}get Gve(){return J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.ServiceAADAuthIsEnabled",
!1)}get E1g(){return J.AFrameworkApplication.ea.getStringFeatureGate("Microsoft.Office.Excel.TellMe.HelpClassifierModelName","")}get Iub(){return J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.ShowImageSearchResults",!1)}get PXd(){return J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.MLCModelIsEnabled",!1)}get VWg(){return J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.ShowMoreFileResults",!1)}get BIc(){return J.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.EnableRankerLogging",
!1)}get dLf(){var P=J.AFrameworkApplication.ea.getStringFeatureGate("Microsoft.Office.Excel.TellMe.NBClassifierScoreThreshold","-7.0");P=parseFloat(P);return isNaN(P)?-7:P}get t5e(){return!C.EwaSettings.Ra(174)&&this.$.fa.Kh.get(27)&&this.$.ZW}get u5e(){return this.$.Fe.get(35)}get EKd(){return Cc.a.Hf()?{["FontName_New"]:"FontPicker"}:null}}Object(n.a)(Ii,"ExcelTellMeApplicationData",pi,[]);var Gj=a(684),Yg=a(64),yi;(function(P){P[P.immediate=0]="immediate";P[P.dCe=1]="waitAll";P[P.NAl=2]="synchronizeAndWaitAll";
P[P.OAl=3]="synchronizeAndWaitForRanker"})(yi||(yi={}));Object(n.b)("MenuUpdatePolicy",yi);var mj;(function(P){P[P.none=0]="none";P[P.dCe=1]="waitAll";P[P.E2k=2]="synchronizeFast";P[P.PAl=3]="synchronizeSlow"})(mj||(mj={}));Object(n.b)("ProviderSynchronizationType",mj);class Hj{constructor(P){this.Db=P}Hx(){return"Formula"}RF(){return this.Db.jm===yi.immediate?mj.none:this.Db.jm===yi.dCe?mj.dCe:mj.E2k}Nx(P,ua,Xa,Pb,hc){hc=void 0===hc?null:hc;Xa=new Zc(P);hc&&!Array.contains(hc,qg.Formula)||bd.Nz(P)||
(P=this.alc(P.qe,"InsertFunctionParameterized"),Xa.Xm(P));ua.Ll(Xa)}alc(P,ua){const Xa=new Hd(qg.Formula);Xa.displayName=fc.a.instance.ia(2513);Xa.An(new Xd(ua,vh.Formula,P,null,xi.Local));return Xa}}Object(n.a)(Hj,"FormulaResultsProvider",null,[512]);Object(I.b)(w.TellMeCommandHandlerService,{we:"singleton"})(async P=>{const ua=await I.a.resolve(w.EwaControlService),Xa=P.xa;await Promise.all([Object(Ob.a)(Yg.a.loadScript(J.AFrameworkApplication.ua.Ab.B5f?94:93,4,Xa,void 0,void 0,w.TellMeCommandHandlerService)),
Object(Ob.a)(Yg.a.loadScript(95,4,Xa,void 0,void 0,w.TellMeCommandHandlerService)),J.AFrameworkApplication.disableWholeAppsForOfficeFeature?null:I.a.resolve(Gj.a,P)]);Ji.initData(ua);return new Ji(ua)});class Ji{constructor(P){this.commandUIManager=null;this.iVj=ua=>{this.commandUIManager=ua;Vg.a(this.Ad).OCa(this.vwa)};this.vwa=()=>{this.commandUIManager=this.Ad.ra.Tb(53)};this.Ad=P;this.Ad.ra.Vc(53,this.iVj)}gd(){return!1}executeCommand(P,ua,Xa){P=0;switch(ua.command){case -1642491107:P=S.a.tellMe;
break;case -240091811:P=S.a.tellMeAccessibilityMenuText;break;case -1543335331:P=S.a.tellMeCacheAsyncMenuRefresh;break;case 815990803:P=S.a.tellMeFocusInput;break;case 586156566:P=S.a.tellMeInteractionBegin;break;case -1051173363:P=S.a.tellMeRestoreFocus;break;case 878547493:P=S.a.tellMeLogCommandExecuted;break;case 1024534176:P=S.a.tellMeLogInputBlur;break;case -1991747669:P=S.a.tellMeLogInputFocus;break;case -28797232:P=S.a.tellMeLogMenuClose;break;case -1814078912:P=S.a.tellMeLogMenuOpen;break;
case 1404166600:P=S.a.tellMeTryQuery;break;case -2064212100:P=S.a.tellMeFeedback}let Pb=0;P&&(Pb=J.AFrameworkApplication.Kb.pe(P,2,Xa),this.updateView());m.ULS.sendTraceTag(537151007,0,50,`TellMeCommandHandler.ExecuteCommand: ActionId (${P}) , response (${Pb})`);return P&&2!==Pb?e.Task.Va(!0):t.a(ua.command)}Rc(P,ua){P=!1;switch(ua.command){case -1642491107:case -240091811:case -1543335331:case 815990803:case 586156566:case 878547493:case 1024534176:case -1991747669:case -28797232:case -1814078912:case 1404166600:case -2064212100:P=
!0}return P}td(P,ua,Xa){"PopulateTellMe"===ua&&J.AFrameworkApplication.Kb.pe(S.a.tellMe,2,Xa);return!1}dispose(){!!this.Ad&!!Vg.a(this.Ad)&&Vg.a(this.Ad).e4a(this.vwa);this.commandUIManager=null}updateView(){this.commandUIManager&&this.commandUIManager.h7g("sbTellMe",!1)}static initData(P){P=new Ii(P);mf.instance.initialize(P,null,null,null,null,null,Hh.a.Xv.t$,J.AFrameworkApplication.ea,Object(ea.d)(Oa.a),null,Object(ea.d)(Ac.a));mf.instance.wi();P.LWd&&mf.instance.Ou(new Hj(P),nd.tellMe)}}Object(n.a)(Ji,
"TellMeCommandHandler",null,[29,4]);var zj=a(9),Oh=a(936);class nj extends Oh.a{constructor(P){super(P)}oq(){const P=Object(Ob.d)(I.a.resolve(w.FormatCellsActionService,{xa:this.Cc})),ua=Object(Ob.d)(I.a.resolve(w.RibbonControlsService,{xa:this.Cc}));Fa.TaskExtensions.tb(Fa.TaskExtensions.jl([P,ua],this.Aa),()=>{var Xa=new N(this.$.ma.sa,this.$.userOperationManager);const Pb=new K(ua.result);Xa=new L(null,null,P.result,this.$.frame,Xa,Pb);this.$.ra.zc(191,Xa);this.fn([Xa])},this.$.Aa,3)}static Ea(P){Oh.a.cw(190,
new nj(P))}}Object(n.a)(nj,"AccountingFormatMenuCommandHandlerFactory",Oh.a,[]);class Ki extends Oh.a{constructor(P){super(P)}oq(){void I.a.resolve(w.NumberFormatViewModelService,{xa:this.Cc}).then(P=>{P=new Pc(this.$,P);this.fn([P])})}static Ea(P){Oh.a.cw(189,new Ki(P))}}Object(n.a)(Ki,"NumberFormatCommandHandlerFactory",Oh.a,[]);var qi=window.AssistanceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AssistanceTaskPane",
Title:"Office Assistance",Width:"330"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AssistanceIFrameContainer",IsStretched:"true"}}]}]}]};Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ConditionalFormatting");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.NumberFormat");Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.Assistance");Type.registerNamespace("NLRT");a(1546);(()=>{zj.a.wb(P=>{w.NumberFormatCommandHandlerService.Oa()||Ki.Ea(P);
w.AccountingFormatMenuCommandHandlerService.Oa()||nj.Ea(P)})})();a(1548);Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");Type.registerNamespace("Common.App.Assistance");qi;String(c);String(b);String(f);String(k);String(x);String(d);window.___1717508060484_closurehack=c;window.___1717508060484_closurehack=b;window.___1717508060484_closurehack=f;window.___1717508060484_closurehack=
k;window.___1717508060484_closurehack=x;window.___1717508060484_closurehack=d},934:function(y,r,a){a.r(r);a.d(r,"Annotations",function(){return h});y=a(0);var c=a(363),b=a(951),f=a(939),k=a(1173),x=a(1174);class d{constructor(n,m){this.kBa=!1;this.RY=null;if(!n)throw Error.argumentNull("annotations");if(!n.Emb(m))throw Error.argument("structTypeID","Invalid struct type ID");this.mo=n;this.Unb=this.mo.xLf(m);this.avh=m}get ucb(){return this.mo}get isReadOnly(){return this.kBa}get qna(){return this.avh}sGa(n){if(0>
n||n>=this.Unb)throw Error.argument("iField","Invalid field index");return this.RY&&null!=this.RY[n]?this.RY[n]:this.mo.hOf(this.qna,n)}Yoe(n,m){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>n||n>=this.Unb)throw Error.argument("iField","Invalid field index");if(!this.mo.Blb(this.mo.JXa(this.qna,n),m))throw Error.argument("value","Value is not of the correct type for the specified field");(this.RY||(this.RY=Array(this.Unb)))[n]=m}jW(){const {Annotations:n}=
a(934);let m="[";if(this.RY){let u=!0;for(let l=0;l<this.Unb;++l){if(null==this.RY[l])continue;const t=this.mo.JXa(this.qna,l);if(n.UNa(t,this.RY[l],this.mo.hOf(this.qna,l)))continue;u?u=!1:m+=", ";m+=this.mo.iOf(this.qna,l);m+="=";const e=this.mo.jW(t,this.RY[l]);t===n.gS?(m+='"',m+=b.a.lEd(e),m+='"'):m+=e}}return m+"]"}isEqual(n){const {Annotations:m}=a(934);if(this===n)return!0;if(!n||this.mo!==n.ucb||this.qna!==n.qna)return!1;for(let u=0;u<this.Unb;++u)if(!m.UNa(this.mo.JXa(this.qna,u),this.sGa(u),
n.sGa(u)))return!1;return!0}clone(){const n=new d(this.mo,this.qna);this.RY&&(n.RY=Array.clone(this.RY));return n}yF(){return this.isReadOnly?this.clone():this}A2d(){const {Annotations:n}=a(934);if(!this.isReadOnly&&(this.kBa=!0,this.RY))for(let m=0;m<this.Unb;++m){const u=this.RY[m];null!=u&&n.H0a(u)}}toString(){return this.jW()}}Object(y.a)(d,"StructValue",null,[624,622]);class h{constructor(n,m){if(!n)throw Error.argumentNull("initData");if(!m)throw Error.argumentNull("objectFetcher");this.kIj=
m.uji;let u=0;var l=m.iGa(n.pa(u));++u;this.D4d=new k.a(new x.a(l));this.qmh=n.pa(u);++u;this.ocg=Array(this.nvc);this.iYb=Array(this.nvc);this.oJa=Array(this.nvc);for(l=0;l<this.nvc;++l){this.ocg[l]=m.ia(n.pa(u));++u;this.iYb[l]=n.pa(u);++u;const t=n.pa(u);++u;this.oJa[l]=Array(t);for(let e=0;e<t;++e)this.oJa[l][e]=m.ia(n.pa(u)),++u}this.$uh=n.pa(u);++u;this.odg=Array(this.y8b);this.pLc=Array(this.y8b);this.qLc=Array(this.y8b);this.oLc=Array(this.y8b);for(let t=0;t<this.y8b;++t){this.odg[t]=m.ia(n.pa(u));
++u;l=n.pa(u);++u;this.pLc[t]=Array(l);this.qLc[t]=Array(l);this.oLc[t]=Array(l);for(let e=0;e<l;++e)this.pLc[t][e]=m.ia(n.pa(u)),++u,this.qLc[t][e]=n.pa(u),++u,this.oLc[t][e]=(()=>{let w=this.gVa(this.qLc[t][e],n,u,null,null,null);({g2:u}=w);return w})().returnValue,h.H0a(this.oLc[t][e])}this.mjh=n.pa(u);++u;this.X3d=Array(this.Qcb);this.Y3d=Array(this.Qcb);this.W3d=Array(this.Qcb);for(let t=0;t<this.Qcb;++t)this.X3d[t]=m.ia(n.pa(u)),++u,this.Y3d[t]=n.pa(u),++u,this.W3d[t]=(()=>{let e=this.gVa(this.Y3d[t],
n,u,null,null,null);({g2:u}=e);return e})().returnValue,h.H0a(this.W3d[t])}UOb(n){for(let m=0;m<this.Qcb;++m)if(this.X3d[m]===n)return m;return-1}OFf(n){if(!this.Bmb(n))throw Error.argument("attrID","Invalid attribute ID");return this.X3d[n]}getAttributeType(n){if(!this.Bmb(n))throw Error.argument("attrID","Invalid attribute ID");return this.Y3d[n]}JXa(n,m){if(!this.Emb(n))throw Error.argument("structTypeID","Invalid struct type ID");n=this.qLc[h.z8b(n)];if(0>m||m>=n.length)throw Error.argument("iField",
"Invalid field index");return n[m]}jW(n,m){if(!this.L_d(n))throw Error.argument("typeID","Invalid type ID");if(!this.Blb(n,m))throw Error.argument("value","Value is not of the correct type");switch(n){case h.gS:return m;case h.n$:return m?"True":"False";case h.Ofa:case h.N4:return m.toString();case h.QG:return m.jW();default:if(!h.fy(n)&&h.Q9b(n)){n=h.cEd(n);const t=this.oJa[n].length;switch(this.iYb[n]){case 0:return this.oJa[n][m];case 1:if(m){var u="";for(var l=1;l<t;++l)m&1<<l-1&&(0<u.length&&
(u+=" & "),u+=this.oJa[n][l]);return u}return this.oJa[n][0];case 2:u="";for(l=0;l<t;++l)m&1<<l&&(0<u.length&&(u+=" & "),u+=this.oJa[n][l]);return u;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.iYb[n]);}}else return m.jW()}}L_d(n){switch(n){case h.gS:case h.n$:case h.Ofa:case h.N4:case h.QG:return!0;default:return h.fy(n)?this.L_d(h.Fta(n)):h.Q9b(n)?this.yyj(n):this.Emb(n)}}yyj(n){n=h.cEd(n);return 0<=n&&n<this.ocg.length}Emb(n){n=h.z8b(n);return 0<=n&&n<this.odg.length}Bmb(n){return 0<=
n&&n<this.Qcb}Blb(n,m){if(null==m)return!1;switch(n){case h.gS:return"string"===typeof m;case h.n$:return"boolean"===typeof m;case h.Ofa:return"number"===typeof m;case h.N4:return"number"===typeof m;case h.QG:return Object(c.a)(621,m);default:if(h.fy(n))return Object(c.a)(623,m)&&m.XN===h.Fta(n);if(h.Q9b(n)){if("number"!==typeof m)return!1;n=h.cEd(n);const u=this.oJa[n].length;switch(this.iYb[n]){case 0:return 0<=m&&m<u;case 1:return!(m&-1<<u-1);case 2:return!!m&&!(m&-1<<u);default:throw Error.invalidOperation("Unrecognized enum type flavor "+
this.iYb[n]);}}else return Object(c.a)(624,m)&&m.qna===n}}get Qcb(){return this.mjh}get nvc(){return this.qmh}get y8b(){return this.$uh}XJi(n){if(!this.Bmb(n))throw Error.argument("attrID","Invalid attribute ID");return this.W3d[n]}xLf(n){if(!this.Emb(n))throw Error.argument("structTypeID","Invalid struct type ID");return this.pLc[h.z8b(n)].length}iOf(n,m){if(!this.Emb(n))throw Error.argument("structTypeID","Invalid struct type ID");return this.pLc[h.z8b(n)][m]}hOf(n,m){if(!this.Emb(n))throw Error.argument("structTypeID",
"Invalid struct type ID");n=this.oLc[h.z8b(n)];if(0>m||m>=n.length)throw Error.argument("iField","Invalid field index");return n[m]}gVa(n,m,u,l,t,e){if(!m)throw Error.argumentNull("initData");if(h.fy(n)){var w=m.pa(u);++u;const M=h.Fta(n);var z=new f.a(this,M);for(var E=0;E<w;++E)Array.add(z.items,(()=>{let G=this.gVa(M,m,u,l,t,e);({g2:u}=G);return G})().returnValue);return{returnValue:z,g2:u}}switch(n){case h.gS:return{returnValue:(l||this.D4d).ia(m.pa(u++)),g2:u};case h.n$:return{returnValue:1===
m.pa(u++),g2:u};case h.Ofa:return{returnValue:m.pa(u++),g2:u};case h.N4:return{returnValue:(t||this.kIj)[m.pa(u++)],g2:u};case h.QG:w=m.pa(u++);z=new b.a(this);for(E=0;E<w;++E){let M=m.pa(u);++u;e&&(M=e[M]);z.iq(M,(()=>{let G=this.gVa(this.getAttributeType(M),m,u,l,t,e);({g2:u}=G);return G})().returnValue)}return{returnValue:z,g2:u};default:if(h.Q9b(n))return{returnValue:m.pa(u++),g2:u};if(h.q5g(n)){w=m.pa(u++);z=new d(this,n);for(E=0;E<w;++E){const M=m.pa(u);++u;z.Yoe(M,(()=>{let G=this.gVa(this.JXa(n,
M),m,u,l,t,e);({g2:u}=G);return G})().returnValue)}return{returnValue:z,g2:u}}throw Error.argument("typeID","Invalid type ID");}}static Q9b(n){return 16<=(n&16383)&&16384!==(n&16384)&&32768!==(n&32768)}static q5g(n){return 16<=(n&16383)&&16384===(n&16384)&&32768!==(n&32768)}static fy(n){return 32768===(n&32768)}static zUi(n){if(h.fy(n))throw Error.argument("nonListTypeID","Non-list type ID required");return n|32768}static Fta(n){if(!h.fy(n))throw Error.argument("listTypeID","List type ID required");
return n&-32769}static UNa(n,m,u){switch(n){case h.gS:case h.n$:case h.Ofa:case h.N4:return m===u;case h.QG:return m.isEqual(u);default:return h.fy(n)?m.isEqual(u):h.Q9b(n)?m===u:m.isEqual(u)}}static H0a(n){Object(c.a)(622,n)&&n.A2d()}static yF(n){return Object(c.a)(622,n)?n.yF():n}static cEd(n){return n-16}static z8b(n){return(n&-16385)-16}}h.gS=1;h.n$=2;h.Ofa=3;h.N4=5;h.QG=9;Object(y.a)(h,"Annotations",null,[625])},939:function(y,r,a){a.d(r,"a",function(){return b});y=a(0);var c=a(951);class b{constructor(f,
k){this.kBa=!1;const {Annotations:x}=a(934);if(!f)throw Error.argumentNull("annotations");if(!f.L_d(k))throw Error.argument("memberTypeID","Invalid type ID");if(x.fy(k))throw Error.argument("memberTypeID","Lists of lists are not permitted");this.mo=f;this.Oqh=k;this.Sn=[]}get ucb(){return this.mo}get isReadOnly(){return this.kBa}get XN(){return this.Oqh}get items(){return this.Sn}jW(){const {Annotations:f}=a(934);let k="[";for(let x=0,d=this.items.length;x<d;++x){0<x&&(k+=", ");const h=this.mo.jW(this.XN,
this.items[x]);this.XN===f.gS?(k+='"',k+=c.a.lEd(h),k+='"'):k+=h}return k+"]"}isEqual(f){const {Annotations:k}=a(934);if(this===f)return!0;if(!f||f.ucb!==this.mo||f.XN!==this.XN||f.items.length!==this.items.length)return!1;for(let x=0;x<this.items.length;++x)if(!k.UNa(this.XN,this.items[x],f.items[x]))return!1;return!0}clone(){const f=new b(this.mo,this.XN);Array.addRange(f.items,this.items);return f}yF(){return this.isReadOnly?this.clone():this}A2d(){const {Annotations:f}=a(934);if(!this.isReadOnly){this.kBa=
!0;for(const k of this.items)f.H0a(k)}}toString(){return this.jW()}}Object(y.a)(b,"ListValue",null,[623,622])},951:function(y,r,a){a.d(r,"a",function(){return b});y=a(0);class c{constructor(f,k){this.kDa=f;this.value=k}}Object(y.a)(c,"AttrValuePair",null,[]);class b{constructor(f){this.kBa=!1;if(!f)throw Error.argumentNull("annotations");this.mo=f;this.AI=[]}get ucb(){return this.mo}get isReadOnly(){return this.kBa}get TQd(){return 0<this.AI.length}vk(f){if(!this.mo.Bmb(f))throw Error.argument("attributeID",
"Invalid attribute ID");for(const k of this.AI)if(f===k.kDa)return f=k.value,{returnValue:!0,value:f};return{returnValue:!1,value:null}}iq(f,k){var {Annotations:x}=a(934);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.mo.Bmb(f))throw Error.argument("attributeID","Invalid attribute ID");if(!this.mo.Blb(this.mo.getAttributeType(f),k))throw Error.argument("value","Value is not of the correct type for the specified attribute");x.H0a(k);
for(x=0;x<this.AI.length;++x){const d=this.AI[x];if(f===d.kDa){d.value=k;return}}Array.add(this.AI,new c(f,k))}Yrb(f){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.mo.Bmb(f))throw Error.argument("attributeID","Invalid attribute ID");for(let k=0;k<this.AI.length;++k)if(f===this.AI[k].kDa){Array.removeAt(this.AI,k);break}}Uxc(f){if(!f)throw Error.argumentNull("action");for(const k of this.AI)f(k.kDa,k.value)}clone(){const f=new b(this.mo);
f.Ira(this);return f}Ira(f){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!f)throw Error.argumentNull("other");if(f.ucb!==this.mo)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.AI);f.Uxc((k,x)=>{this.iq(k,x)})}jW(){const {Annotations:f}=a(934);let k="[",x=!0;for(const d of this.AI){x?x=!1:k+=", ";k+=this.mo.OFf(d.kDa);k+="=";const h=this.mo.getAttributeType(d.kDa),n=this.mo.jW(h,d.value);h===f.gS?(k+='"',
k+=b.lEd(n),k+='"'):k+=n}return k+"]"}isEqual(f){const {Annotations:k}=a(934);if(!f)throw Error.argumentNull("other");if(this===f)return!0;if(!f||this.mo!==f.ucb||this.TQd!==f.TQd)return!1;let x=0,d=null,h=!1;f.Uxc((n,m)=>{++x;if(!h){var u=-1;for(let l=0,t=this.AI.length;l<t;++l)if(this.AI[l].kDa===n){u=l;break}0>u?h=!0:(d||(d=Array(this.AI.length)),d[u]=m)}});if(this.AI.length!==x||h)return!1;for(let n=0,m=this.AI.length;n<m;++n)if(!k.UNa(this.mo.getAttributeType(this.AI[n].kDa),this.AI[n].value,
d[n]))return!1;return!0}yF(){return this.isReadOnly?this.clone():this}A2d(){const {Annotations:f}=a(934);if(!this.isReadOnly){this.kBa=!0;for(const k of this.AI)f.H0a(k.value)}}toString(){return this.jW()}static lEd(f){return f.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(y.a)(b,"FeatureBundle",null,[621,622])},967:function(y,r,a){a.d(r,"a",function(){return c});y=a(0);class c{constructor(){this.w4d=null;this.KU=this.C4d=0}KId(b,f,k){if(!b)throw Error.argumentNull("referenceList");
if(0>f||f>b.length)throw Error.argumentOutOfRange("startIndex");if(0>k||k>b.length)throw Error.argumentOutOfRange("length");if(f+k>b.length)throw Error.argument("Invalid start-length range");this.w4d=b;this.C4d=f;this.KU=k}YFa(b,f,k){this.KId(b.w4d,b.C4d+f,k)}pa(b){if(0>b||b>=this.KU)throw Error.argumentOutOfRange("index");return this.w4d[this.C4d+b]}get count(){return this.KU}static szd(b){const f=new c;f.KId(b,0,b.length);return f}}Object(y.a)(c,"ReadOnlyList",null,[630])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.kxta.js.map/7c57a8644302030559ca92a18e09a48e/EwaTS.kxta.js.map