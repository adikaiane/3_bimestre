'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[15],{1566:function(y,r,a){r=a(490);a=a(1567);a=a.Di?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);r(a,{insert:"head",Oj:!1});y.exports=a.Fk||{}},1567:function(y,r,a){r=a(489)(!1);r.push([y.i,".FindDialog .ewa-dlg-body-sectionlabel{margin-bottom:5px}.FindDialog .ewa-dlg-body-fullLine{width:350px}.FindDialog input[type=text]{width:350px}.FindDialog .ReplaceResultLabel{color:#2db932}.FindDialog .ReplaceResultLabelForFindAll{width:358px;height:auto;background:#dff6dd;border-radius:0}.FindDialog .FindUserAlertLabel{color:#d90000;margin-top:16px}.FindDialog .FindUserAlertLabelForFindAll{background:#fde7e9;border-radius:0;height:auto;width:358px}.FindDialog .FindUserInfoLabelForFindAll{border-radius:0;height:auto;width:358px}.FindDialog .FindUserAlertLabelForFindAllWrapper{padding-top:10px;padding-bottom:10px;display:inline-flex}.ewa-dlg-elements-container-ltr .FindDialog .FindUserAlertLabelForFindAllWrapper{padding-left:7px}.ewa-dlg-elements-container-rtl .FindDialog .FindUserAlertLabelForFindAllWrapper{padding-right:7px}.FindDialog .Collapsed{visibility:hidden;height:0}.ewa-dlg-elements-container-ltr .FindDialog .ChevronDivIdRotated{transform:rotate(90deg) scale(1.2)}.ewa-dlg-elements-container-rtl .FindDialog .ChevronDivIdRotated{transform:rotate(270deg) scale(1.2)}.FindDialog .ChevronStart{transform:rotate(180deg) scale(1.2)}.FindDialog .AdvancedOptionsContainer{display:flex;justify-content:space-between}.FindDialog .CollapsedAdvancedOptionsContainer{height:1px}.FindDialog .SearchOptionsContainer{display:flex;align-items:center;margin-bottom:8px;margin-top:8px}.FindDialog .SearchOptionsLabel{margin-top:0;margin-bottom:0;font-size:14px;cursor:pointer;padding-top:1px;padding-bottom:1px}.ewa-dlg-elements-container-ltr .FindDialog .SearchOptionsLabel{margin-left:7px}.ewa-dlg-elements-container-rtl .FindDialog .SearchOptionsLabel{margin-right:7px}.FindDialog .AdvancedOptionsDropdowns{display:flex;justify-content:space-between}.FindDialog .DropdownWithLabel{flex:0 0 50%}.ewa-dlg-elements-container-ltr .FindDialog .DropdownWithLabel{margin-right:2px}.ewa-dlg-elements-container-rtl .FindDialog .DropdownWithLabel{margin-left:2px}.FindDialog .FindAllTableHeader{width:358px;height:28px;background:#e9f5ee;display:block;font-size:12px;color:#252423}.FindDialog .FindAllTableHeader tr{width:inherit;height:inherit;margin:0;padding:0}.FindDialog .FindAllTableHeader th{border-bottom:1px solid #fff;padding-top:5px;padding-bottom:0;margin:0;height:auto}.ewa-dlg-elements-container-ltr .FindDialog .FindAllTableHeader th{text-align:left;padding-left:8px;border-right:1px solid #fff}.ewa-dlg-elements-container-rtl .FindDialog .FindAllTableHeader th{text-align:right;padding-right:8px;border-left:1px solid #fff}.FindDialog .FindAllTableBody{display:block;overflow-y:auto;overflow-x:hidden;height:auto;max-height:168px;width:358px}.FindDialog .FindAllRow:hover{background-color:#f3f3f3}.FindDialog .FindAllRow{width:358px;height:28px;background:#faf9f8;border-bottom:1px solid #fff}.FindDialog .FindAllTableData{font-size:12px;color:#252423;padding-top:5px}.ewa-dlg-elements-container-ltr .FindDialog .FindAllTableData{padding-left:8px;border-right:1px solid #fff}.ewa-dlg-elements-container-rtl .FindDialog .FindAllTableData{padding-right:8px;border-left:1px solid #fff}.FindDialog .FindAllTableDataSheetName{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:67px}.FindDialog .FindAllTableDataCell{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:54px}.FindDialog .FindAllTableDataValue{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:182px}.FindDialog ::-webkit-scrollbar{width:8px;height:auto}.FindDialog ::-webkit-scrollbar-track{background:#faf9f9;border-radius:10px}.FindDialog ::-webkit-scrollbar-thumb{background:#c6c6c6;height:30px;width:8px;border-radius:4px}.ewa-dlg-buttonarea.FindDialog{display:flex;flex-wrap:wrap;justify-content:flex-end;max-width:358px}.FindDialog .ewa-dlg-button{max-width:79px}",
""]);y.exports=r},1568:function(y,r,a){r=a(490);a=a(1569);a=a.Di?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);r(a,{insert:"head",Oj:!1});y.exports=a.Fk||{}},1569:function(y,r,a){r=a(489)(!1);r.push([y.i,".ewr-shareSection-floatingoject-tooltip-container,.ewr-shareSection-tooltip-container{position:absolute;height:20px;display:flex;cursor:pointer;width:auto;border-radius:10px}.ewr-shareSection-tooltip-container{z-index:48}.ewr-shareSection-floatingoject-tooltip-container{z-index:51}.ewr-shareSection-tooltip-hidden{display:none}.ewr-shareSection-tooltip-flyout{position:absolute;height:20px;display:flex;background-color:#217346;overflow:hidden;border-radius:10px;min-width:20px}.ewr-grdcontarea-ltr .ewr-shareSection-tooltip-toggle-leftAndRight{right:0}.ewr-grdcontarea-rtl .ewr-shareSection-tooltip-toggle-leftAndRight{left:0}.ewr-shareSection-tooltip-textContainer{height:20px;display:flex;width:auto;max-width:300px;overflow:hidden;transition:all .1s ease-in}.ewr-shareSection-tooltip-toggle-maxWidth0{max-width:0;transition:all .1s ease-out}.ewr-shareSection-tooltip-close-icon,.ewr-shareSection-tooltip-icon{width:20px;height:20px;overflow:hidden}.ewr-shareSection-tooltip-close-icon{margin-left:-4px;margin-right:2px}.ewr-shareSection-tooltip-text{font-size:10px;color:#fff;margin:4px 2px;padding-left:6px;padding-right:4px;line-height:12px;border-right:1px solid #58a37a;white-space:nowrap}.ewr-shareSection-tooltip-toggle-maxWidth0 .ewr-shareSection-tooltip-text{border-right:none}.ewr-shareSection-highlightDiv-overlay{background-color:#217346;opacity:0;display:block;width:100%;height:100%;transition:all .1s ease-in}.ewr-shareSection-tooltip-toggle-opacity{opacity:.2;transition:all .1s ease-out}",
""]);y.exports=r},1570:function(y,r,a){r=a(490);a=a(1571);a=a.Di?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);r(a,{insert:"head",Oj:!1});y.exports=a.Fk||{}},1571:function(y,r,a){r=a(489)(!1);r.push([y.i,'.ewa-stp-pane{height:100%;display:flex;flex-direction:column;overflow:hidden;background:#edebe9}.ewa-stp-header{position:relative;overflow:hidden;padding:16px;background:#edebe9}.ewa-stp-body{height:100%;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;overflow-y:auto;overflow-x:hidden;background:#edebe9}.ewa-stp-title{height:22px;font-weight:400;position:relative!important;max-width:230px;display:inline-block;text-overflow:ellipsis;overflow:hidden;font-size:16px;font-family:"Segoe UI Semibold","Segoe UI Web Semibold","Arial Semibold","Verdana Semibold","sans-serif Semibold";background:#edebe9;color:#252423}.ewa-stp-close-button{margin:auto;margin-right:0;margin-top:3px}',
""]);y.exports=r},372:function(y,r,a){a.r(r);var c={};a.r(c);a.d(c,"CtrlArrowCommandHandler",function(){return la});var b={};a.r(b);a.d(b,"FindCommandHandler",function(){return Rb});var f={};a.r(f);a.d(f,"GotoCommandHandler",function(){return na});var k={};a.r(k);a.d(k,"ShareSectionCommandHandler",function(){return Ed});var x={};a.r(x);a.d(x,"SmartSelectionCommandHandler",function(){return fe});var d={};a.r(d);a.d(d,"SpellCheckCommandHandler",function(){return Hd});var h={};a.r(h);a.d(h,"ViewportHelpers",
function(){return Zc});var n={};a.r(n);a.d(n,"FindPrefetch",function(){return gc});var m={};a.r(m);a.d(m,"FindOperationsCache",function(){return dd});var u=a(133),l=a(0),t=a(15),e=a(714);class w{constructor(Bb,pc,wc,cd,Vd){this.originCell=this.originRange=null;this.direction=0;this.edgeCell=null;this.shouldExtend=!1;this.originCell=Bb;this.originRange=pc;this.direction=wc;this.edgeCell=cd;this.shouldExtend=Vd}getEdgeCell(){return this.edgeCell}}Object(l.a)(w,"MacroRecorderMoveToEdgePayload",null,
[67]);var z=a(44),E=a(429),M=a(213),G=a(10),A=a(27),N=a(25);const K=(Bb,pc,wc,cd)=>{var Vd=J(Bb.direction);if(Bb.extend&&!pc.isSingle){const xb=pc.UT(Vd)===wc.UT(Vd);let ub=Vd;2===Vd?ub=1:4===Vd&&(ub=3);xb?wc.Sma(ub,pc.kQb(Vd)):wc.Sma(ub,pc.UT(Vd));wc=wc.topLeft}pc=N.f(cd).Ob(wc);if(null===pc||void 0===pc?0:pc.AC)switch(Vd=pc.range.UT(Vd),Bb.direction){case 1:case 3:wc.top=Vd;break;case 4:case 2:wc.left=Vd}return z.r(wc,cd)},I=(Bb,pc,wc)=>{var cd=z.H(Bb);switch(pc){case 1:cd.top=1;break;case 3:cd.bottom=
G.a.sf;break;case 4:cd.left=1;break;case 2:cd.right=G.a.rf}Bb=null;cd=wc.Np("CtrlArrowCommandHandler.TryGetEdgeCellLocally",cd,3===pc||1===pc?2:1,2===pc||3===pc);try{if(!cd.$$mn())return null;let Vd=cd.$$cu();if(Vd.text){if(!cd.$$mn())return null;Vd=cd.$$cu();if(Vd.text)for(;cd.$$mn();){if(!cd.$$cu().text){Bb=Vd.range;break}Vd=cd.$$cu()}else for(;cd.$$mn();)if(Vd=cd.$$cu(),Vd.text){Bb=Vd.range;break}}else for(;cd.$$mn();)if(Vd=cd.$$cu(),Vd.text){Bb=Vd.range;break}const xb=Vd.cell.aB.kk;if(Bb)return z.y(Bb,
wc.$);if(!cd.$$cu()&&Vd&&(1===pc&&!xb.Y||4===pc&&!xb.X))return z.y(Vd.range,wc.$)}finally{cd&&cd.dispose()}return null},L=Bb=>{switch(Bb){case 1:return 16;case 3:return 32;case 4:return 4;case 2:return 8;default:return t.ULS.shipAssertTag(537163588,0,!1,"CtrlArrowCommandHandler.GotoRangePositioningFromDirection: unknown direction"),60}},J=Bb=>{let pc=0;switch(Bb){case 1:pc=1;break;case 3:pc=2;break;case 4:pc=3;break;case 2:pc=4}return pc};var B=a(61);const Y=(Bb,pc,wc,cd,Vd,xb,ub,Fc)=>{Fc=Bb.$a(1,
void 0===Fc?null:Fc);Fc.activeCell=pc;Fc.direction=wc;return B.h(Bb,"GetEdgeCell",Fc,cd,Vd,xb,ub,4)};var U=a(36),O=a(209),C=a(266),X=a(67),S=a(436);class ea{constructor(Bb,pc){this.Qlh=Bb;this.I$c=pc}get direction(){return this.Qlh}get extend(){return this.I$c}sCf(){return 2===this.direction?new ea(4,this.extend):4===this.direction?new ea(2,this.extend):this}}Object(l.a)(ea,"CtrlArrowCommandParams",null,[]);var Oa=a(65),Ha=a(5),Za;let fa,la=Za=class{constructor(Bb){this.$=Bb}gd(){return!1}executeCommand(Bb,
pc){Bb=pc.command;if(!Za.Uzd.Bb(Bb))return O.a(Bb);let wc=Za.Uzd.pa(Bb);const cd=N.f(this.$);Bb=cd.ha;cd.rtl&&(wc=wc.sCf());const Vd=cd.isEditing||cd.nk,xb=Vd?Bb.rangePicker.BJd(!0):Bb.oa.activeRange,ub=Vd?Bb.rangePicker.activeCell:Bb.oa.activeCell,Fc=K(wc,xb,ub.clone(),this.$);let xd=I(Fc,wc.direction,cd);const Ic=z.y(xb,this.$),bd=()=>new w(Fc,Ic,wc.direction,xd,wc.extend);if(xd)return t.ULS.sendTraceTag(537163593,0,50,"CtrlArrowCommandHandler.ExecuteCommand: GetEdgeCell succeeded in client side"),
this.IQf(xd,wc,xb.clone(),ub.clone(),cd),this.$.KBg(new e.a(119,bd())),X.Task.Va(!0);const yb=Oc=>{xd=Oc.Result};return E.a(this.$.userOperationManager,(Oc,kd,Rc)=>Y(this.$.ma.sa,Fc,wc.direction,C.c(yb,Oc,Xb=>{this.a8i(Xb,wc,xb.clone(),ub.clone(),cd)}),kd,Rc,null),Oc=>new M.a(119,0,Oc,16,bd),pc)}Rc(Bb,pc){return Za.Uzd.Bb(pc.command)}td(){return!1}a8i(Bb,pc,wc,cd,Vd){!U.a.Ls(Bb.Errors)&&Bb.Result&&(Bb=Bb.Result,t.ULS.sendTraceTag(537163592,0,50,"CtrlArrowCommandHandler.HandleGetEdgeCellSuccess"),
this.IQf(Bb,pc,wc,cd,Vd))}IQf(Bb,pc,wc,cd,Vd){var xb=z.I(Bb);if(pc.extend){pc=pc.direction;Bb=N.f(this.$);Vd=null;if(!wc.isSingle){var ub=J(pc);if(cd.UT(ub)===wc.UT(ub))switch(Vd=cd.clone(),pc){case 1:case 3:Vd.Kyi(wc);break;case 4:case 2:Vd.gAf(wc)}}Vd||(Vd=wc);Vd.union(xb);Bb.ha.Wo=0;Bb.ha.updateSelection(Vd,null,0,3);ub=!Vd.isRow&&(2===pc||4===pc);const Fc=!Vd.Oe&&(1===pc||3===pc);if((wc.isSingle||!(1!==pc&&3!==pc||cd.top!==wc.top&&cd.bottom!==wc.bottom)||!(4!==pc&&2!==pc||cd.left!==wc.left&&cd.right!==
wc.right))&&(ub||Fc)){wc=Vd;t.ULS.shipAssertTag(537163590,0,wc.contains(cd),"CtrlArrowCommandHandler.GetOppositeEdgeCellOfActiveRange: the active range doesn't contain the active cell");wc.isSingle?cd=wc:(pc=0,cd.top===wc.top?pc=1:cd.bottom===wc.bottom&&(pc=2),ub=0,cd.left===wc.left?ub=3:cd.right===wc.right&&(ub=4),cd=A.Range.Hc(0===pc?cd.top:wc.kQb(pc),0===ub?cd.left:wc.kQb(ub)));if(Vd.Oe||Vd.isRow)cd=xb;Bb.Ix(cd,60,"CtrlArrowCommandHandler.ExtendToEdge",!0)}}else xb=L(pc.direction),Za.$Mj(Bb,Vd,
xb)}static $Mj(Bb,pc,wc){let cd;switch(pc.ha.Wo){case 1:cd=3;break;case 2:cd=1;break;default:cd=0}pc.lj(Bb,null,null,null,wc,"CtrlArrowCommandHandler.MoveToEdge",cd)}};la.Uzd=(fa=new S.a,fa.add(-1297307319,new ea(3,!0)),fa.add(105288353,new ea(1,!0)),fa.add(-403586027,new ea(4,!0)),fa.add(784916030,new ea(2,!0)),fa.add(1713663844,new ea(3,!1)),fa.add(542791952,new ea(1,!1)),fa.add(-2012742350,new ea(4,!1)),fa.add(1324884057,new ea(2,!1)),fa);la=Za=Object(u.__decorate)([Object(Oa.d)(Ha.CtrlArrowCommandHandlerService),
Object(u.__param)(0,Object(Ha.EwaControlService)())],la);Object(l.a)(la,"CtrlArrowCommandHandler",null,[29]);var ba=a(43);class aa{constructor(){this.tJc=!1;this.p8f=this.m0a=null;this.bXb=this.aXb=!1;this.Fva=null}}Object(l.a)(aa,"FindDialogState",null,[515]);var oa=a(13),Na=a(74);class Ia{constructor(Bb,pc){this.selectedRanges=this.findData=null;this.findData=Bb;this.selectedRanges=pc}yta(){return this.findData}}Object(l.a)(Ia,"MacroRecorderFindAllPayload",null,[67]);class Sa extends Ia{constructor(Bb,
pc,wc){super(Bb,pc);this.activeCell=null;this.activeCell=wc}getActiveCell(){return this.activeCell}}Object(l.a)(Sa,"MacroRecorderFindCellPayload",Ia,[]);var Pa=a(674);const za=(Bb,pc,wc,cd,Vd,xb,ub,Fc)=>{const xd=Bb.$a(1);xd.findData=pc;xd.activeCell=wc;xd.selectedRanges=cd;return B.h(Bb,"FindCellV2",xd,Vd,xb,ub,Fc,0)},wa=(Bb,pc,wc,cd,Vd,xb,ub)=>{const Fc=Bb.$a(1);Fc.findData=pc;Fc.selectedRanges=wc;return B.h(Bb,"FindAllV2",Fc,cd,Vd,xb,ub,0)},db=(Bb,pc,wc,cd,Vd,xb,ub,Fc,xd,Ic)=>{const bd=Bb.$a(1);
bd.findData=pc;bd.replaceWith=Vd;bd.activeCell=wc;bd.selectedRanges=cd;bd.isSingle=xb;return B.h(Bb,"ReplaceAll",bd,ub,Fc,xd,Ic,0)};var Ba=a(17),Ka=a(255),da=a(1),sa=a(28),mb=a(201),Ma=a(397),hb=a(45),$a=a(999);class Va{constructor(Bb,pc,wc,cd,Vd){this.selectedRanges=this.activeCell=this.replaceWith=this.findData=null;this.isSingle=!1;this.findData=Bb;this.replaceWith=pc;this.activeCell=wc;this.selectedRanges=cd;this.isSingle=Vd}yta(){return this.findData}getActiveCell(){return this.activeCell}}Object(l.a)(Va,
"MacroRecorderReplaceAllPayload",null,[67]);var xa=a(134),ia=a(92),Z=a(151),ta=a(150),pa=a(88),Ga=a(81);class Ca{constructor(Bb,pc,wc,cd,Vd,xb){this.wka=!1;this.filter=(ub,Fc)=>{if("IsNamedObject"!==ub&&"ReplaceWholeWordOnly"!==ub&&"SearchStrings"!==ub&&"operationTimestamp"!==ub)return Fc};this.findData=Bb;this.stateID=pc;this.IQ=wc;this.activeCell=cd;this.J8j=null!==xb&&void 0!==xb?xb:performance.now();this.wka=Vd}equals(Bb){if(!Bb||this.wka!==Bb.wka||this.stateID!==Bb.stateID||this.IQ!==Bb.IQ||
!this.activeCell.equals(Bb.activeCell))return!1;const pc=JSON.stringify(this.findData,this.filter);Bb=JSON.stringify(Bb.findData,this.filter);return pc===Bb}Bff(Bb){var pc;return new Ca(JSON.parse(JSON.stringify(this.findData)),this.stateID,this.IQ,null!==(pc=null===Bb||void 0===Bb?void 0:Bb.activeCell)&&void 0!==pc?pc:this.activeCell.clone(),void 0!==(null===Bb||void 0===Bb?void 0:Bb.wka)?null===Bb||void 0===Bb?void 0:Bb.wka:this.wka,this.J8j)}}Object(l.a)(Ca,"FindDataParameters",null,[]);var kb=
a(690),eb;(function(Bb){Bb.Info="Info";Bb.Error="Error";Bb.Success="Success";Bb.Warning="Warning"})(eb||(eb={}));Object(l.b)("UserMessageType",eb);class Yb{}Object(l.a)(Yb,"FindResultData",null,[]);class Gb extends $a.a{constructor(Bb,pc,wc,cd,Vd,xb,ub){super(Bb);this.TG=Vd;this.eQ=xb;this.pWa=ub;this.sxc="Selection";this.RBi="Sheet";this.lQj=ia.a.Dg(oa.a.instance.ia(51));this.dAk=ia.a.Dg(oa.a.instance.ia(31));this.cBi=ia.a.Dg(oa.a.instance.Ib(97));this.bBi=ia.a.Dg(oa.a.instance.Ib(98));this.Wvk=
ia.a.Dg(oa.a.instance.Ib(100));this.Xvk=ia.a.Dg(oa.a.instance.Ib(96));this.FIg=ia.a.Dg(oa.a.instance.La(23));this.BVh=ia.a.Dg(oa.a.instance.La(22));this.Vvk=ia.a.Dg(oa.a.instance.ia(63));this.kwk=ia.a.Dg(oa.a.instance.ia(64));this.PGd=ia.a.Dg(oa.a.instance.ia(53));this.XWb=this.M0d=null;this.SGd=(Fc,xd)=>{this.findText=xd.findText;this.h4a=xd.replaceText;this.Yna=xd.withinOption;this.Wza=xd.matchCase;this.Xza=xd.matchEntireCell;this.SearchUp=xd.searchUp;this.vtd();0==Fc&&(this.$.Mb.l_a=!1,this.$.Mb.DC=
!1,this.tV(0,"Cancel"),Z.b(this.$).d_g("FindAndReplaceDialogCorrelation"))};this.Tdk=Fc=>{var xd=Fc.findText;xd&&0!==xd.length&&(Fc=this.PLf(this.IQ(),Fc),"Find"!==Fc.kind&&({WFa:xd}=this.eQ.dne(Fc.dQ),xd?t.ULS.sendTraceTag(507265984,0,50,"FindAndReplaceDialog:prefetchFindText Using cached findAll result."):this.pWa.Sdk(Fc.dQ.findData,this.IQ())))};this.iBi=(Fc,xd,Ic,bd)=>{this.findText=xd.findText;this.h4a=xd.replaceText;this.Yna=xd.withinOption;this.Wza=xd.matchCase;this.Xza=xd.matchEntireCell;
this.SearchUp=xd.searchUp;this.JJk=Ic;this.vtd();if(1==Fc)if(this.operation=1891435765,this.Ejc=149,mb.a.current.DV="Find Next",this.tV(1,"Find Next"),this.KUc(ta.a.findNext),da.EwaSettings.z2()||da.EwaSettings.CY())if(Fc=this.PLf(this.IQ()),"Find"===Fc.kind)Fc.fQ&&(t.ULS.sendTraceTag(507384583,0,50,"FindAndReplaceDialog:findDialogResultHandler Using cached findNext result."),this.Ayg&&({WFa:Ic}=this.eQ.dne(Fc.dQ),Ic||this.pWa.zyg(Fc.dQ.findData)),this.YPf(Fc.fQ,"find-next-cache"));else if(da.EwaSettings.CY()){const {WFa:yb,
fQ:Oc}=this.eQ.dne(Fc.dQ);yb?(t.ULS.sendTraceTag(507384582,0,50,"FindAndReplaceDialog:findDialogResultHandler Using cached findAll result."),this.YPf(Oc,"find-all-cache")):(this.TG.mna("find-next"),this.eQ.set(Fc.dQ,void 0),this.oTb(Ic,bd,Fc.dQ),this.pWa.zyg(Fc.dQ.findData))}else this.TG.mna("find-next"),this.eQ.set(Fc.dQ,void 0),this.oTb(Ic,bd,Fc.dQ);else this.TG.mna("find-next"),this.oTb(Ic,bd);else 2==Fc?(this.operation=788780084,this.Ejc=205,this.tV(2,"Find all"),this.KUc(ta.a.findAll),da.EwaSettings.z2()?
(Fc=this.gkf(this.IQ()),this.oTb(Ic,bd,Fc)):this.oTb(Ic,bd)):3==Fc?(this.KEa(!0),this.operation=1059985902,this.tV(3,"Replace"),this.KUc(ta.a.lwk),this.R3j(Ic,bd)):(this.KEa(!0),this.tV(4,"Replace all"),this.KUc(ta.a.replaceAll),this.Nah(!1,Ic,bd),Ic=this.Foi(),t.ULS.sendTraceTag(509620555,0,50,`FindAndReplaceDialog EstimateReplaceAll count = ${Ic}`))};this.MXj=Fc=>{this.XEk(Fc.Cell)};this.fgl=Fc=>{this.$Sg=Fc;this.U2c(this)};this.zhj=Fc=>{this.setFocusCallback=Fc};this.kXb=()=>{this.$.fa.Je!==G.a.Me&&
this.$.fa.yc&&this.nqj()&&this.JJk(this.dAk,eb.Info)};this.U2c=()=>{const Fc=Gb.TFc(this.$);Fc&&(this.Yna=this.sxc);null!=this.$Sg&&this.$Sg(Fc);this.hv.Fva||(this.hv.Fva=this.sxc);Fc||this.hv.Fva!==this.sxc||(this.hv.Fva=this.RBi);this.Yna||(this.Yna=this.hv.Fva)};this.hv=wc;this.tA=N.f(this.$);this.fc=cd;this.operation=1461300262;this.Ejc=205;this.eIe=null;this.hc=13;this.Ic(1,oa.a.instance.ia(41));this.Ic(2,oa.a.instance.ia(27));this.Ic(3,oa.a.instance.ia(60));this.Ic(4,oa.a.instance.ia(61));this.Aj();
this.Wza=this.hv.aXb;this.Xza=this.hv.bXb;this.SearchUp=this.hv.tJc;this.findText=void 0!=pc?pc:this.hv.m0a;this.h4a=this.hv.p8f;this.U2c(this);this.Yna=this.hv.Fva;this.idb={["withinOption"]:this.Yna,["findText"]:this.findText,["matchCase"]:this.Wza,["matchEntireCell"]:this.Xza,["replaceText"]:this.h4a,["searchUp"]:this.SearchUp,["isFindTab"]:1540292897===cd.command||1891435765===cd.command||788780084===cd.command?!0:!1,["isEditMode"]:this.$.isEditMode,["disableAllButtons"]:!1};this.Ayg=da.EwaSettings.t3f()&&
0<=da.EwaSettings.UEe();this.Ys={["id"]:this.Tc,["updateWithinOptions"]:this.fgl,["initializeFocusCallback"]:this.zhj,["onFindAllRowResultClick"]:this.MXj,["findDialogResultHandler"]:this.iBi,["prefetchFindText"]:this.Tdk,["prefetchFindWhileYouTypeDelayMs"]:this.Ayg?da.EwaSettings.UEe():-1,["isModal"]:!1,["bodyProps"]:this.idb};this.$.Mb.l_a=!0;this.initializeAndShow(this.PGd,this.SGd,this.Ys);this.$.fa&&this.$.fa.qF(this.kXb);Z.b(this.$).vZg("FindAndReplaceDialogCorrelation")}static getInstance(Bb,
pc,wc,cd,Vd,xb,ub){return this.Wa||(this.Wa=new this(Bb,pc,wc,cd,Vd,xb,ub))}cNk(Bb){this.Otb();const pc=Object.assign({},this.idb);pc.isFindTab=1540292897==Bb||1891435765==Bb||788780084==Bb;this.Ys.bodyProps=pc;this.BNa(this.PGd,this.EXa(this.SGd),this.Ys)}zF(){this.$.Mb.l_a=!1;this.$.Mb.DC=!1;this.Mb.N3b(this);this.dispose()}get Tc(){return"FindAndReplaceDialog"}get da(){return this.tA}dispose(){this.Bi();this.da.Ub.pn(null,Gb.oxc);this.$.fa&&this.$.fa.wG(this.kXb);this.$.Mb.l_a=!1;Gb.Wa=null;da.EwaSettings.isChangeGateEnabled("OfficeVSO:8511408_showSharedCustomDialogCrashTelemetry")&&
t.ULS.sendTraceTag(507835858,0,50,"FindAndReplaceDialog.dispose: FindAndReplaceDialog is disposed");super.dispose()}setFocus(){this.setFocusCallback?this.setFocusCallback():t.ULS.sendTraceTag(523245012,0,50,"FindAndReplaceDialog.setFocus: setFocusCallback not initialized")}KUc(Bb){const pc={["FindWithinValue"]:this.Yna,["MatchCase"]:this.Wza,["MatchEntireCell"]:this.Xza,["FindDirection"]:this.SearchUp?"Up":"Down",["NumberOfSelectedRanges"]:this.da.ha.oa.gR,["Location"]:"dialog"};Z.b(this.$).Jd(Bb,
pc,null,!0)}Foi(){if((new xa.SheetProtection(this.$.qa)).Ih)return 0;const Bb=this.findText,pc=this.h4a,wc=!this.Wza;var cd=this.IQ();let Vd=0,xb=0,ub=0;cd=this.da.Np("FindAndReplaceDialog.EstimateReplaceAll",cd?this.da.ha.oa.Ed:z.h());try{for(;cd.$$mn();){const Fc=this.da.Ob(cd.Go.getRange());let xd=!1;ub++;Vd+=(()=>{let Ic=this.puf(Fc,Bb,pc,wc,this.Xza);({estimated:xd}=Ic);return Ic})().returnValue;xd&&(xb+=xb)}}finally{cd&&cd.dispose()}t.ULS.sendTraceTag(509620554,0,50,`EstimateReplaceAll, We could have replaced - ${Vd}, but we only replaced ${xb} out of ${ub} cells. ${xb/
Vd*100}% estimation success. ${100*(Vd-xb)/ub}% noticeable estimation failure`);return xb}KEa(Bb){const pc=Object.assign({},this.idb);pc.disableAllButtons=Bb;this.Ys.bodyProps=pc;this.BNa(this.PGd,this.EXa(this.SGd),this.Ys)}R3j(Bb,pc){this.vtd();const wc=this.yta();this.M0d=wc;t.ULS.sendTraceTag(523882654,0,50,`FindAndReplace Dialog 'Replace' was clicked, MatchCase: ${wc.MatchCase}, MatchEntireCell: ${wc.MatchEntireCell}, , SearchAllSheets: ${wc.SearchAllSheets}.`);const cd=this.findText,Vd=this.h4a,
xb=this.da.Ob(this.da.ha.oa.activeCell);if(xb){var ub=!1,Fc=(()=>{let xd=this.puf(xb,cd,Vd,!this.Wza,this.Xza);({hMa:ub}=xd);return xd})().returnValue;Fc||ub?this.Nah(!0,Bb,pc):(t.ULS.sendTraceTag(523882652,0,50,`FindAndReplace Dialog - current cell does not contain the requested value to replace, finding next cell, MatchCase: ${wc.MatchCase}, MatchEntireCell: ${wc.MatchEntireCell}, , SearchAllSheets: ${wc.SearchAllSheets}.`),Bb(this.zpd(this.kwk,Fc,!0),eb.Error),this.KEa(!1))}else t.ULS.sendTraceTag(523882653,
0,50,"FindAndReplace - failed getting current active cell."),this.KEa(!1)}Nah(Bb,pc,wc){if(this.da){var cd=this.IQ()?this.da.ha.oa.Ed:this.da.ha.oa.activeCell,Vd=z.r(this.da.ha.oa.activeCell,this.$),xb=z.t(cd,this.$),ub=this.$.ma.sa,Fc=this.yta();this.M0d=Fc;var xd=this.h4a;t.ULS.sendTraceTag(523882650,0,50,`WebServiceReplaceAll, isSingle: ${Bb}, MatchCase: ${Fc.MatchCase}, MatchEntireCell: ${Fc.MatchEntireCell}, , SearchAllSheets: ${Fc.SearchAllSheets}.`);var Ic=()=>new Va(Fc,xd,Vd,xb,Bb);E.a(this.$.userOperationManager,
(bd,yb,Oc)=>this.rlj(ub,Fc,Vd,xb,xd,Bb,bd,yb,Oc,pc,wc),bd=>new M.a(148,0,bd,void 0,Ic),this.fc)}else this.KEa(!1)}puf(Bb,pc,wc,cd,Vd){let xb,ub;var Fc=0;ub=xb=!1;if((new xa.SheetProtection(this.$.qa)).Ih)return{returnValue:0,estimated:xb,hMa:ub};if(!Bb)return t.ULS.sendTraceTag(523882649,0,50,"EstimateReplaceSingleCell - currentCell == null"),{returnValue:0,estimated:xb,hMa:ub};if(!sa.a.Zg(Bb.text)){if(Bb.Jx)return t.ULS.sendTraceTag(523882648,0,50,"EstimateReplaceSingleCell - cell has a formula so we can not estimate"),
da.EwaSettings.isChangeGateEnabled("OfficeVSO:4230178_ServerRoundTripIfFormula")&&(ub=!0),{returnValue:0,estimated:xb,hMa:ub};if(da.EwaSettings.isChangeGateEnabled("OfficeVSO:4230178_NoReplaceInCellWithRichValue")&&0!==Bb.cell.richValueType)return t.ULS.sendTraceTag(523882647,0,50,"EstimateReplaceSingleCell - Replace in cells containing RichValues is not supported"),{returnValue:0,estimated:xb,hMa:!0};Fc=Bb.pwb;if(Vd){if(sa.a.equals(Fc,pc,cd))return Bb.text=wc,t.ULS.sendTraceTag(523882646,0,50,"EstimateReplaceSingleCell - matchEntireCell, the replace string is equal to the source string, we estimated the result without formatting (could flicker)"),
{returnValue:1,estimated:!0,hMa:ub};t.ULS.sendTraceTag(523882645,0,50,"EstimateReplaceSingleCell - matchEntireCell, the replace string is not equal to the source string, we should not replace (this could be counted as a good guess or no replacement)");return{returnValue:0,estimated:xb,hMa:ub}}Fc=sa.a.Uhf(Fc,pc,cd);Vd=sa.a.Uhf(Bb.text,pc,cd);if(Gb.e1k(pc))return{returnValue:0,estimated:xb,hMa:!0};Fc===Vd?(pc=sa.a.wsb(Bb.text,pc,wc,cd),Bb.text=pc,t.ULS.sendTraceTag(523882644,0,50,"EstimateReplaceSingleCell - estimation with formatting"),
xb=!0):0<Fc&&(t.ULS.sendTraceTag(523882643,0,50,"EstimateReplaceSingleCell - replacement will happen, but we did not estimate because we do not handle with the formatting (bad guess/no guess)"),xb=!1)}return{returnValue:Fc,estimated:xb,hMa:ub}}rlj(Bb,pc,wc,cd,Vd,xb,ub,Fc,xd,Ic,bd){return db(Bb,pc,wc,cd,Vd,xb,C.c(ub,(yb,Oc)=>{this.Q3j(yb,Oc,Ic,bd)}),Fc,xd,xb)}Q3j(Bb,pc,wc,cd){cd([],"");let Vd=!1;if(!Ka.a(Bb)){let ub="";var xb=Bb.Result;Bb=xb.ReplacedCount;xb=xb.SkippedReplacementsCount;0<xb&&(t.ULS.sendTraceTag(523882642,
0,50,`Invoke Replace, SkippedReplacementCount = ${xb}`),ub=String.format(this.Wvk,Bb.toString(),xb.toString()));xb||(ub=String.format(this.Xvk,Bb.toString()));pc&&0<Bb?(Vd=!0,this.findNext(wc,cd)):Bb||xb?(pc=this.zpd(ub,Bb,pc),wc(pc,pc===ub?eb.Success:eb.Error)):wc(this.zpd(this.Vvk,Bb,pc),eb.Error)}Vd||this.KEa(!1)}findNext(Bb,pc){const wc=this.yta(),cd=this.IQ();let Vd;da.EwaSettings.z2()&&(Vd=new Ca(wc,this.$.fa.Cw,cd,Gb.getActiveCell(this.$),!1));t.ULS.sendTraceTag(523882641,0,50,"FindNext, MatchCase: {1}, MatchEntireCell: {2}, , SearchAllSheets: {3}.",
wc.MatchCase,wc.MatchEntireCell,wc.SearchAllSheets);let xb=null;const ub=Ic=>{Ic.Result&&Gb.pmg(Ic,this.$,this,void 0,Bb,pc);this.KEa(!1)},Fc=()=>{pc([],"");this.KEa(!1);const Ic=Oa.a.Cb(Ha.ViewportTelemetryManagerService);null===Ic||void 0===Ic?void 0:Ic.aO("web-method-error");null===Ic||void 0===Ic?void 0:Ic.Yy("find-next")},xd=(()=>{let Ic=Gb.tLd(this.$,wc,Vd,cd,!1,this,!0,Bb,pc,ub,Fc);({Bn:xb}=Ic);return Ic})().returnValue;E.a(this.$.userOperationManager,xd,Ic=>new M.a(147,0,Ic,16,xb),this.fc)}Aj(){this.da&&
this.da.ha&&this.da.ha.ZS(this.U2c)}Bi(){this.da&&this.da.ha&&this.da.ha.rV(this.U2c)}nqj(){return!!Ba.DOMElementExtensions.getElementById(this.Ld,"findAndReplaceScrollablePane")}oTb(Bb,pc,wc){let cd;if(!da.EwaSettings.z2()){cd=this.yta();if(!cd){t.ULS.sendTraceTag(523882640,0,10,"cannot get find data, cannot call find cell operation");return}if(this.XWb){const xb=sa.a.equals(cd.SearchString,this.XWb.SearchString,!1)&&cd.MatchCase===this.XWb.MatchCase&&cd.MatchEntireCell===this.XWb.MatchEntireCell;
t.ULS.sendTraceTag(523882639,0,50,`FindNext - is find data changed between clicks? sameData=${xb}, stateId=${this.$.fa.Je}`)}this.XWb=cd}const Vd=()=>{this.operation=1891435765;this.Ejc=147};this.ZYa(this.kD,(()=>{let xb=Gb.tLd(this.$,cd,wc,this.IQ(),788780084===this.operation,this,!1,Bb,pc,Vd);({Bn:this.eIe}=xb);return xb})().returnValue,18,da.EwaSettings.isChangeGateEnabled("OfficeVSO:8127880_FixingFindAndReplaceBlockingOps")?!1:this.qda,!1)}get kD(){return this.Ejc}Bn(){return this.eIe}IQ(){return Gb.TFc(this.$)&&
sa.a.equals(this.Yna,this.sxc,!1)}vtd(){this.hv.m0a=this.findText;this.hv.tJc=this.SearchUp;this.hv.aXb=this.Wza;this.hv.bXb=this.Xza;this.hv.Fva=this.Yna;this.hv.p8f=this.h4a}XEk(Bb){const pc=z.H(Bb);if(Bb=this.$.qa.getItemByName(Bb.SheetName))Bb=z.p(pc,Bb),this.da.lj(Bb,pc,null,null,60,{scenario:"find-next",caller:"FindDialog.SelectFindAllRowResult"},void 0,void 0,void 0,void 0,!0)}yta(Bb){const pc={};if(!this.$)return t.ULS.sendTraceTag(523882638,0,15,"FindAndReplaceDialog:EwaControl is null when trying to get find data"),
null;var wc=Gb.getActiveCell(this.$);wc=wc?z.r(wc,this.$):null;!wc||sa.a.Zg(wc.SheetName)?t.ULS.sendTraceTag(523882637,0,15,"could not find sheet name, Sheets/ActiveItem is null."):pc.SheetName=wc.SheetName;Bb?(pc.SearchString=Bb.findText,pc.MatchCase=Bb.matchCase,pc.MatchEntireCell=Bb.matchEntireCell,pc.SearchAllSheets=!this.IQ()&&Bb.withinOption===Gb.txc,pc.SearchUp=Bb.searchUp):(pc.SearchString=this.findText,pc.MatchCase=this.Wza,pc.MatchEntireCell=this.Xza,pc.SearchAllSheets=!this.IQ()&&this.Yna===
Gb.txc,pc.SearchUp=this.SearchUp);pc.ExcludeFormulaResult=!1;return pc}static tLd(Bb,pc,wc,cd,Vd,xb,ub,Fc,xd,Ic,bd,yb){Fc=void 0===Fc?null:Fc;xd=void 0===xd?null:xd;Ic=void 0===Ic?null:Ic;bd=void 0===bd?null:bd;yb=void 0===yb?!1:yb;const Oc=da.EwaSettings.z2()?wc.findData:pc;pc=(pc=da.EwaSettings.z2()?wc.IQ:cd)&&Gb.TFc(Bb);const {cell:kd,range:Rc}=Gb.vGf(Bb,pc);da.EwaSettings.z2()&&ub||(pc=Vd?dc=>{Gb.NXj(dc,Bb,xb,xd)}:dc=>{Gb.pmg(dc,Bb,xb,wc,Fc,xd)},Ic=Ic?yb?C.c(pc,Ic):C.c(Ic,pc):pc);let Xb=bd;da.EwaSettings.z2()&&
!ub&&(ub=Vd?void 0:()=>{Gb.PXj()},Xb=Xb?yb?C.b(ub,Xb):C.b(Xb,ub):ub);sa.a.Zg(Oc.SheetName)&&(Oc.SheetName=kd.SheetName);return{returnValue:(dc,Vc,yd)=>Vd?wa(Bb.ma.sa,Oc,Rc,C.c(dc,Ic),Xb?C.b(Vc,Xb):Vc,yd,Bb):za(Bb.ma.sa,Oc,kd,Rc,C.c(dc,Ic),Xb?C.b(Vc,Xb):Vc,yd,Bb),Bn:Vd?()=>new Ia(Oc,Rc):()=>new Sa(Oc,Rc,kd)}}static vGf(Bb,pc){const wc=N.f(Bb),cd=Gb.getActiveCell(Bb),Vd=z.r(cd,Bb);Bb=pc?z.t(wc.ha.oa.Ed,Bb):z.t(cd,Bb);return{cell:Vd,range:Bb}}static TFc(Bb){Bb=N.f(Bb);if(!Bb)return!1;Bb=Bb.ha.oa;return Bb.vi&&
!Bb.rva()}static PXj(){const Bb=Oa.a.Cb(Ha.ViewportTelemetryManagerService);null===Bb||void 0===Bb?void 0:Bb.aO("web-method-error");null===Bb||void 0===Bb?void 0:Bb.Yy("find-next")}static NXj(Bb,pc,wc,cd){da.EwaSettings.isChangeGateEnabled("OfficeVSO:8511408_showSharedCustomDialogCrashTelemetry")&&t.ULS.sendTraceTag(507835857,0,50,"FindAndReplaceDialog.onFindAllWebMethodSuccess: FindAndReplaceDialog onFindAllWebMethodSuccess called.");if(Ka.a(Bb))t.ULS.shipAssertTag(523882634,0,!1,"FindAndReplaceDialog.OnFindAllWebMethodSuccess: EwaResult contains NonStatusMessages.");
else if(Bb=Bb.Result)if(Bb.Results)if(Bb.Results.length){const Vd=Math.min(Bb.Results.length,1E3);Gb.G7h(Bb,Vd,wc,1E3<Bb.Results.length,cd);Gb.Icj(Bb,Vd,pc)}else cd(null,null);else t.ULS.shipAssertTag(523882632,0,!1,"FindAndReplaceDialog.OnFindAllWebMethodSuccess: findAllResult.Results is null");else t.ULS.shipAssertTag(523882633,0,!1,"FindAndReplaceDialog.OnFindAllWebMethodSuccess: findAllResult is null")}static pmg(Bb,pc,wc,cd,Vd,xb){da.EwaSettings.isChangeGateEnabled("OfficeVSO:8511408_showSharedCustomDialogCrashTelemetry")&&
t.ULS.sendTraceTag(507835856,0,50,"FindAndReplaceDialog.onFindCellWebMethodSuccess: FindAndReplaceDialog onFindCellWebMethodSuccess called.");Ka.a(Bb)?(mb.a.current.SIb("FindEndedWithErrors"),da.EwaSettings.z2()&&(pc=Oa.a.Cb(Ha.ViewportTelemetryManagerService),null===pc||void 0===pc?void 0:pc.aO("web-method-error"),null===pc||void 0===pc?void 0:pc.Yy("find-next"))):(Bb=Bb.Result)&&Bb.SheetRange?(da.EwaSettings.z2()&&cd&&wc&&wc.eQ.exists(cd)&&wc.eQ.set(cd,Bb),(wc=N.f(pc))&&Gb.$Pf(pc,wc,Bb,"server-response")):
(Gb.T7i(wc,pc,Vd,xb),da.EwaSettings.z2()&&cd&&wc&&wc.eQ.delete(cd),pc=Oa.a.Cb(Ha.ViewportTelemetryManagerService),da.EwaSettings.FEc()?null===pc||void 0===pc?void 0:pc.aO("business-logic-success",new kb.a(void 0,void 0,"server-response")):null===pc||void 0===pc?void 0:pc.aO("business-logic-success"),null===pc||void 0===pc?void 0:pc.Yy("find-next"))}gkf(Bb,pc){if(pc=this.yta(pc))return new Ca(pc,this.$.fa.Cw,Bb,Gb.getActiveCell(this.$),!1)}PLf(Bb,pc){Bb=this.gkf(Bb,pc);pc=this.eQ.search(Bb);"NotFound"!==
pc.kind&&t.ULS.sendTraceTag(507562189,0,20,`FindAndReplaceDialog.currentFindIdenticalToPreviousFind: FindNext - duplicate FindNext request - stateId:${Bb.stateID}, findResults exist:${!!pc.fQ}`);return pc}YPf(Bb,pc){this.TG.mna("find-next");Gb.$Pf(this.$,this.da,Bb,pc)}static $Pf(Bb,pc,wc,cd){var Vd,xb;const ub=z.I(wc.SheetRange),Fc=wc.FoundInRichValue;da.EwaSettings.FEc()?null===(Vd=Oa.a.Cb(Ha.ViewportTelemetryManagerService))||void 0===Vd?void 0:Vd.aO("business-logic-success",new kb.a(void 0,void 0,
cd)):null===(xb=Oa.a.Cb(Ha.ViewportTelemetryManagerService))||void 0===xb?void 0:xb.aO("business-logic-success");pc.ha.oa.vi&&pc.ha.oa.Ed.contains(ub)?pc.lj(z.y(pc.ha.oa.Ed,Bb),ub,null,null,60,{scenario:"find-next",caller:"FindDialog.OnFindCellWebMethodSuccess.CellWithinCurrentSelection"},void 0,void 0,void 0,ub,!0):pc.lj(wc.SheetRange,ub,null,null,60,{scenario:"find-next",caller:"FindDialog.OnFindCellWebMethodSuccess.CellOutsideCurrentSelection"},void 0,void 0,void 0,void 0,!0);pc.za.t8(1,Bb.la)&&
mb.a.current.Yy("FindEnded",Bb);sa.a.equals(Bb.la.sheetName,wc.SheetRange.SheetName,!0)&&Gb.Jcj(ub,Bb);Fc&&ub&&(t.ULS.sendTraceTag(523882630,0,50,"FindAndReplaceDialog.gotoFoundCell: FoundInRichValue"),Ha.CardViewManagerService.Oa()?void Oa.a.resolve(Ha.CardViewManagerService,{xa:0}).then(xd=>{xd.J5a(ub.top,ub.left,1,!1,!1)}):Pa.a(Bb,243,242,0,xd=>{xd.J5a(ub.top,ub.left,1,!1,!1)}))}static Icj(Bb,pc,wc){if(pc){var cd=Array(pc);for(let Vd=0;Vd<pc;Vd++){const xb=Bb.Results[Vd].SheetCell;t.ULS.shipAssertTag(523882629,
0,!!xb,"FindAndReplaceDialog.highlightFindAllResults: cell is null");const ub=wc.qa.getItemByName(xb.SheetName);ub&&(cd[Vd]=new Ma.a(z.H(xb),Na.d(ub)))}N.f(wc).Ub.HL(cd,Gb.oxc,!0)}}static Jcj(Bb,pc){N.f(pc).Ub.pn(Bb,Gb.oxc);N.f(pc).Ub.Iq(Gb.oxc);da.EwaSettings.isChangeGateEnabled("OfficeVSO:8440558_FindandReplaceA11yFix")&&Bb&&ba.TaskExtensions.tb(da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)?Object(pa.d)(Oa.a.resolve(Ha.AriaLiveNotifierService,{xa:0})):
Ga.GetServiceTaskFactory.Ne(pc.ra,211,212,0),wc=>{wc=wc.result;let cd=Bb.Gz(!1);da.EwaSettings.isChangeGateEnabled("OfficeVSO:8802090_ScreenReaderFindNextBugFix")&&(cd=String.format(oa.a.instance.Ib(55),Bb.Gz(!1),pc.la.sheetName));wc.setEnabled(!0);wc.readText(cd)},pc.Aa,3)}static T7i(Bb,pc,wc,cd){Bb?1891435765===Bb.operation&&(cd([],""),wc(Bb.lQj,eb.Error),t.ULS.sendTraceTag(523882627,0,50,"FindAndReplaceDialog - Find Next ExcelServerMessageId.NoOccurrencesFound from find dialog")):(Bb=U.a.Cd(1,
2,0,51,0,-1736450117,"NoOccurrencesFound"),hb.a(pc).Zx([Bb]),t.ULS.sendTraceTag(523882628,0,50,"FindAndReplaceDialog - Find Next ExcelServerMessageId.NoOccurrencesFound from shortcut keys"))}static G7h(Bb,pc,wc,cd,Vd){wc=cd?String.format(wc.bBi,1E3):String.format(wc.cBi,pc);cd=[];for(let xb=0;xb<pc;xb++){const ub=Bb.Results[xb].SheetCell,Fc=Bb.Results[xb].Value,xd=ub.SheetName,Ic=z.H(ub).Gz(!1);cd.push({Cell:ub,Value:Fc,SheetName:xd,CellRange:Ic})}Vd(cd,wc)}zpd(Bb,pc,wc){const cd=new xa.SheetProtection(this.$.qa);
if(!wc&&this.M0d.SearchAllSheets){if(cd.wmj)return Bb+this.FIg}else if(cd.Ih)return pc?Bb+this.FIg:this.BVh;return Bb}static e1k(Bb){return Bb.includes("*")||Bb.includes("?")||Bb.includes("~")}static getActiveCell(Bb){return(Bb=N.f(Bb))?Bb.ha.oa.activeCell:Gb.A1}}Gb.txc="Workbook";Gb.A1=A.Range.Hc(1,1);Gb.oxc=[25];Object(l.a)(Gb,"FindAndReplaceDialog",$a.a,[215]);var Mb=a(173);let Rb=class{constructor(Bb,pc,wc,cd){this.TG=pc;this.eQ=wc;this.pWa=cd;this.qBi=[25];this.P2b=!1;this.ORd=()=>{this.P2b&&
(this.da.Ub.rl(this.qBi),this.da.ha.vr(this.ORd),this.P2b=!1)};this.$=Bb;this.da=N.f(Bb);this.Wmh=new aa}get hv(){return this.Wmh}dispose(){this.da&&this.P2b&&(this.da.ha.vr(this.ORd),this.P2b=!1)}gd(Bb,pc){return(1059985902===pc||658167298===pc)&&!this.$.isEditMode}Rc(Bb,pc){if(Bb=1===Bb)switch(pc.command){case 1059985902:case 658167298:case 1891435765:case 788780084:case 1540292897:case -1389126153:case 892787342:break;default:Bb=!1}return Bb}td(){return!1}executeCommand(Bb,pc,wc){Bb=pc.command;
return this.U7i(1891435765===Bb||788780084===Bb||658167298===Bb,-1389126153===Bb,pc,wc)}U7i(Bb,pc,wc,cd){var Vd;let xb=ba.TaskExtensions.kl();this.hv.tJc=pc;if(Bb||1540292897===wc.command){this.da.Q5a(!0);let ub;1540292897===wc.command&&(ub=cd.CommandValueId);this.dBi=Gb.getInstance(this.$,ub,this.hv,wc,this.TG,this.eQ,this.pWa);da.EwaSettings.isChangeGateEnabled("OfficeVSO:8920278_TrackAsyncDialogs")&&(da.EwaSettings.isChangeGateEnabled("OfficeVSO:8781473_checkEventExsistFindCommand")&&void 0===
cd.event&&t.ULS.sendTraceTag(507363536,0,15,"FindCommandHandler.handleFindCommand: properties.event is undefined."),cd.event&&Mb.b(this.$).kq(cd.event.rawEvent?cd.event.rawEvent:cd.event,"dialog-find-and-replace",null,["dialog"]));da.EwaSettings.CY()&&this.pWa.Wdk(this.hv);da.EwaSettings.t3f()&&0<(null===(Vd=this.hv.m0a)||void 0===Vd?void 0:Vd.length)&&this.pWa.Udk(this.hv);this.dBi.cNk(wc.command)}else if(this.hv.m0a){da.EwaSettings.isChangeGateEnabled("OfficeVSO:8511408_showSharedCustomDialogCrashTelemetry")&&
t.ULS.sendTraceTag(507835859,0,50,"FindCommandHandler.handleFindCommand: Find/Replace triggered by some shortcut key.");const ub={};ub.SheetName=this.$.qa.la.sheetName;ub.SearchString=this.hv.m0a;ub.SearchUp=pc;ub.MatchCase=this.hv.aXb;ub.MatchEntireCell=this.hv.bXb;ub.SearchAllSheets=!1;ub.ExcludeFormulaResult=!1;const Fc=788780084===wc.command;let xd=null,Ic;da.EwaSettings.z2()&&(Ic=new Ca(ub,this.$.fa.Cw,!1,Gb.getActiveCell(this.$),!1),Fc||this.TG.mna("find-next"));const bd=()=>{this.da.ha.Vq(this.ORd);
this.P2b=!0};Bb=(()=>{let yb=Gb.tLd(this.$,ub,Ic,this.hv.tJc,Fc,null,!1,null,null,bd,void 0,!0);({Bn:xd}=yb);return yb})().returnValue;xb=E.a(this.$.userOperationManager,Bb,yb=>new M.a(Fc?205:149,0,yb,16,xd),wc)}return xb}};Rb=Object(u.__decorate)([Object(Oa.d)(Ha.FindCommandHandlerService),Object(u.__param)(0,Object(Ha.EwaControlService)()),Object(u.__param)(1,Object(Ha.ViewportTelemetryManagerService)()),Object(u.__param)(2,Object(Ha.FindOperationsCacheService)()),Object(u.__param)(3,Object(Ha.FindPrefetchService)())],
Rb);Object(l.a)(Rb,"FindCommandHandler",null,[29]);var $b=a(242),cc=a(363),fb=a(59),Sb=a(76);class kc extends $a.a{constructor(Bb,pc,wc){super(Bb);this.TG=wc;this.Vna=this.aHa=this.sheetNames=null;this.XQb=!1;this.ejl=(cd,Vd,xb)=>{""===cd&&(cd="A1");kc.S7f=this.aHa=cd;cd=this.$.listSeparator;const ub=this.aHa.split(cd);this.Ark(ub);this.vBh(ub,Vd);this.aHa=ub.join(cd.toString());this.Vna.N_f(ub)?Vd=!0:(this.TG.mna("goto-dialog"),this.XQb=!0,cd=this.Vna.W4g(ub),(Vd=this.Vna.muj(cd))&&this.TG.aO("business-logic-success"),
this.Vna.c3f(cd)&&this.Vna.cQf(cd));if(Vd)return t.ULS.sendTraceTag(537159573,0,50,"GotoDialog.VerifyInputIsValid: parsed range(s) locally. Does contain list separator: "+this.Exd(this.aHa)),this.pke(!0),!0;t.ULS.sendTraceTag(537159572,0,50,"GotoDialog.VerifyInputIsValid: could not parse range(s) locally, calling webservice instead. Does contain list separator: "+this.Exd(this.aHa));this.ZYa(562,this.bSi(this.$,this.aHa,xb),18,da.EwaSettings.isChangeGateEnabled("OfficeVSO:8127875_FixingGoToBlockingOps")?
!0:this.qda,!1);return!1};this.X5i=cd=>{t.ULS.sendTraceTag(537159571,0,50,`GotoDialog.GoToDialogHandler pressing on: ${1===cd?"Ok":"Cancel"}`);const Vd=Oa.a.Cb(Ha.ViewportTelemetryManagerService);0===cd&&this.XQb&&(this.XQb=!1,null===Vd||void 0===Vd?void 0:Vd.aO("business-logic-success"),null===Vd||void 0===Vd?void 0:Vd.Yy("goto-dialog"))};this.mO=()=>{this.pke(!1);this.XQb=!1;const cd=Oa.a.Cb(Ha.ViewportTelemetryManagerService);null===cd||void 0===cd?void 0:cd.aO("web-method-error");null===cd||void 0===
cd?void 0:cd.Yy("goto-dialog")};this.hc=1;this.Vna=pc;Bb={[kc.Xs]:this.Tc,["initialRange"]:kc.S7f||"",["verifyInputIsValid"]:this.ejl};if(this.T4f=!this.$.fa.isNamedObjectViewMode)Bb.isSheetDropdownEnabled=!0,Bb.activeSheetName=this.$.qa.la.name,this.sheetNames=this.ejb(),Bb.sheets=this.sheetNames;this.initializeAndShow(oa.a.instance.ia(76),this.X5i,Bb)}get Tc(){return"GotoDialog"}bSi(Bb,pc,wc){return(cd,Vd,xb)=>{const ub=N.f(Bb),Fc=Bb.ma.sa.mc();return Bb.qa.la?B.x(Bb.ma.sa,pc,Bb.qa.la.name,this.$db(cd,
this.gFf(wc)),C.b(Vd,this.mO),xb,ub,Fc):B.w(Bb.ma.sa,pc,-1,this.$db(cd,this.gFf(wc)),C.b(Vd,this.mO),xb,ub,Fc)}}gFf(Bb){return(pc,wc)=>{let cd=!1;const Vd=!Ka.a(pc);this.pke(Vd);t.ULS.sendTraceTag(537159570,0,50,`GotoDialog.OnWebMethodSuccess: ${Vd?"Succeeded":"Failed"} to parse range(s) on server. Does contain list separator: ${this.Exd(this.aHa)}`);this.XQb=!1;const xb=Oa.a.Cb(Ha.ViewportTelemetryManagerService);if(Vd)t.ULS.shipAssertTag(537159569,0,Object(cc.a)(218,wc),"GotoDialog.OnWebMethodSuccess: the userContext is null or not an IGridView."),
null===xb||void 0===xb?void 0:xb.aO("business-logic-success"),pc=pc.Result,pc=z.n(pc.Ranges[0],pc.SheetName),wc.lj(pc,null,null,null,3,"GotoDialog.OnWebMethodSuccess");else if(null===xb||void 0===xb?void 0:xb.aO("web-method-error"),null===xb||void 0===xb?void 0:xb.Yy("goto-dialog"),Ka.b(pc,-1876101953)||Ka.b(pc,1145860328))Sb.a(this.$).Kd.oF([-1876101953,1145860328]),cd=!0;else{t.ULS.sendTraceTag(537159568,0,10,"GotoDialog.OnWebMethodSuccess: result contains non-status messages");this.hide();return}Bb(cd)}}Exd(Bb){return sa.a.contains(Bb,
this.$.listSeparator.toString(),!0)}pke(Bb){const pc=this.$,wc={};wc.c=pc.fa.isNamedObjectViewMode;wc.b=Bb;wc.a=pc.ta.UserSessionId;fb.logData(35,wc)}Ark(Bb){for(let pc=0;pc<Bb.length;pc++)Bb[pc]=Bb[pc].trim()}vBh(Bb,pc){if(this.T4f&&pc!==this.$.qa.la.name&&!$b.a.any(Bb,wc=>sa.a.contains(wc,"!",!0)))for(let wc=0;wc<Bb.length;wc++)Bb[wc]=`'${pc}'!${Bb[wc]}`}ejb(){const Bb=this.$.qa.items,pc=[];for(const wc of Bb)wc.visible&&!Na.e(wc)&&pc.push(wc.sheetName);return pc}}kc.S7f=null;Object(l.a)(kc,"GotoDialog",
$a.a,[]);let na=class{constructor(Bb,pc,wc){this.TG=wc;this.$=Bb;this.Vna=pc}gd(){return!1}td(){return!1}Rc(Bb,pc){return-1361691601===pc.command}executeCommand(){N.f(this.$).Q5a(!0);new kc(this.$,this.Vna,this.TG);return X.Task.Va(!0)}};na=Object(u.__decorate)([Object(Oa.d)(Ha.GotoCommandHandlerService),Object(u.__param)(0,Object(Ha.EwaControlService)()),Object(u.__param)(1,Object(Ha.ViewportHelpersService)()),Object(u.__param)(2,Object(Ha.ViewportTelemetryManagerService)())],na);Object(l.a)(na,
"GotoCommandHandler",null,[29]);var fc=a(91),Cc=a(310),tc=a(42),nb=a(99),tb=a(211);class La{constructor(Bb,pc,wc,cd,Vd,xb,ub){this.gPe=this.BWd=!1;this.B9d=Fc=>{this.Lf&&this.Lf.Ug&&Fc.ll===this.Lf.ll&&(this.Lf.Ug.paneType!==this.Gxe&&this.Kt&&(this.URd(),this.zte()),this.Kt.H7a(this.floatingObjectId))};this.$=Bb;this.da=N.f(Bb);this.ob=this.da.ha.ob;this.Kt=pc;this.floatingObjectId=wc;this.floatingObjectType=Vd;this.sharedSheetRange=cd;this.floatingObjectManager=nb.a(Bb);this.Lf=null;this.kfa=xb;
this.properties=ub}get bXd(){return this.gPe}get contentType(){return this.kfa}dispose(){this.Lf&&this.Lf.K3b(this.B9d);this.da.ha.mfa.g3b(this);this.N5a(!1);this.Kt.dsb(this.floatingObjectId);this.lj();this.Lf=this.floatingObjectManager=null}UXa(){4===this.contentType?(this.da.ha.mfa.Snd(this),this.yBf(!1)):this.ob.FDa(this.sharedSheetRange,this.floatingObjectId,this.floatingObjectType).continueWith(Bb=>{Bb.result||t.ULS.sendTraceTag(537153821,0,15,`FloatingObjectSharingHighlight.GotoFoAndShowHighlights: Selection of shared FO Failed with FOId = ${this.floatingObjectId}`);
this.da.ha.mfa.Snd(this);this.yBf(!0)})}URd(){this.Lf&&(this.Lf.K3b(this.B9d),this.BWd=!1);this.N5a(!1);this.Kt.dsb(this.floatingObjectId);this.Lf=null}zte(){this.Mxg();this.Lf&&(this.N5a(!0),this.sKb(!1))}eUf(){}FXg(){}lj(){return this.Lf?this.ob.LTa(this.Lf):!1}Exe(){const Bb=this.Kt.NXa(this.floatingObjectId);return Bb?Bb.isFocused:!1}O6b(){if(!this.Lf||this.ob.LJc!=this.Lf)return!1;const Bb=this.Kt.NXa(this.floatingObjectId);return!Bb||Bb.isFocused?!1:Bb.focus()}zk(Bb){if(!this.Lf||this.ob.LJc!=
this.Lf)return!1;const pc=this.Kt.NXa(this.floatingObjectId);return pc&&pc.isFocused?pc.zk(Bb):!1}yBf(Bb){this.Mxg();this.Lf?(Bb&&this.lj(),this.N5a(!0),this.sKb(!0),t.ULS.sendTraceTag(537153819,0,50,`FloatingObjectSharingHighlight.GotoFoAndShowHighlights: Successfully highlighted shared FO with FOId = ${this.floatingObjectId}`)):t.ULS.sendTraceTag(537153820,0,10,`FloatingObjectSharingHighlight.GotoFoAndShowHighlights: Unable to find floating object control of FO with FOId = ${this.floatingObjectId}`)}Mxg(){this.floatingObjectManager&&
(this.Lf=this.floatingObjectManager.fr(tb.a.MA(this.floatingObjectType,this.floatingObjectId)))}N5a(Bb){this.Lf&&this.Lf.I2c&&(this.Lf.I2c(Bb),this.gPe=Bb)}sKb(Bb){if(this.Lf){this.Gxe=this.Lf.Ug.paneType;var pc=this.Lf.get_element();this.Gxe&&pc?(this.Kt.sKb(this.Gxe,pc,this.floatingObjectId,this.contentType,Bb,null,this.properties),this.BWd||(this.Lf.Qlc(this.B9d),this.BWd=!0)):t.ULS.sendTraceTag(523765015,0,10,"FloatingObjectSharingHighlight.createOrUpdateToolTip: Unable to find FO container pane or FO control outer element.")}else t.ULS.sendTraceTag(523765016,
0,10,"FloatingObjectSharingHighlight.createOrUpdateToolTip: Missing floating object control.")}}Object(l.a)(La,"FloatingObjectSharingHighlight",null,[524,4]);var wb=a(41),Wa=a(183),Fa=a(53),Da=a(156),ja=a(435);class Qa extends Sys.EventArgs{constructor(Bb){super();this.rya=Bb}}Object(l.a)(Qa,"ShareSectionEventArgs",Sys.EventArgs,[]);var Ob=a(943),Ub=a(7),Zb=a(32),uc=a(119);class Hc extends wb.a{constructor(Bb,pc,wc,cd,Vd,xb,ub,Fc,xd,Ic){super();this.Df=Da.a.instance;this.FIc=this.gBa=this.Xec=!1;
this.ez=this.Cna=this.Lq=this.Jfa=null;this.q7b=0;this.e7a=this.dza=null;this.QYb=100;this.dJ=this.eJ=!1;this.$U=()=>{this.Iv.disabled||this.dna()};this.ZU=()=>{this.Iv.disabled||this.o4()};this.onFocus=()=>{this.Lq.disabled||(this.dna(),this.Xec=!0)};this.onBlur=()=>{this.Lq.disabled||this.gBa||this.o4()};this.$Uj=()=>{this.ez&&!this.ez.disabled&&this.hide(!0)};this.aVj=()=>{this.ez&&!this.ez.disabled&&(this.dna(),this.gBa=this.Xec=!0)};this.ZUj=()=>{this.ez&&!this.ez.disabled&&(this.gBa=!1)};this.Ok=
bd=>{switch(bd.keyCode){case 13:this.gBa?this.hide(!0):this.o4();this.da.focus();bd.stopPropagation();bd.preventDefault();break;case 27:this.o4();this.da.focus();break;case 9:this.gBa?(this.gBa=!1,this.Lq.focus()):(this.gBa=!0,this.ez.focus()),bd.stopPropagation(),bd.preventDefault()}};this.o4=()=>{this.QYb=Math.max(this.QYb,this.Lq.offsetWidth);window.clearInterval(this.q7b);Ba.DOMElementExtensions.toggleCssClass(this.Jfa,"ewr-shareSection-tooltip-hidden",!1);this.ez&&Ba.DOMElementExtensions.toggleCssClass(this.ez,
"ewr-shareSection-tooltip-hidden",!0);Ba.DOMElementExtensions.toggleCssClass(this.Cna,"ewr-shareSection-tooltip-toggle-maxWidth0",!0);this.raiseEvent("collapseTooltipEvent",new Qa(this.Ixe));this.gBa=this.Xec=this.FIc=!1};this.eJ=da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UpdateHighlightWithCssTransform",!1);this.dJ=da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UpdateHighlightWithCssTransformChange",!1);this.da=Bb;this.svgIconProvider=wc;this.paneType=pc;this.kfa=
cd;this.Iv=xb;this.Ixe=Vd;this.Gf=ub;this.wN=xd;this.Ozd(Fc,Ic)}hDh(Bb){this.addHandler("collapseTooltipEvent",Bb)}isk(Bb){this.removeHandler("collapseTooltipEvent",Bb)}NDh(Bb){this.addHandler("expandTooltipEvent",Bb)}Isk(Bb){this.removeHandler("expandTooltipEvent",Bb)}hEh(Bb){this.addHandler("hideToolTipEvent",Bb)}btk(Bb){this.removeHandler("hideToolTipEvent",Bb)}get isFocused(){return this.Xec&&this.FIc}dispose(){window.clearInterval(this.q7b);this.Sba();super.dispose()}hide(Bb){window.clearInterval(this.q7b);
Ba.DOMElementExtensions.toggleCssClass(this.Iv,"ewr-shareSection-tooltip-hidden",!0);t.ULS.sendTraceTag(525144271,0,50,"ShareTooltipControl.Hide: Hiding tooltip and highlight");Bb&&(this.raiseEvent("hideToolTipEvent",new Qa(this.Ixe)),this.da.$.Dc(876400478,0,8,null),t.ULS.sendTraceTag(524931738,0,50,"ShareTooltipControl.hide: FPS survey got triggered."))}show(Bb){Ba.DOMElementExtensions.toggleCssClass(this.Iv,"ewr-shareSection-tooltip-hidden",!1);Bb?this.o4():this.dna()}H7a(){if(this.Gf&&0!==this.paneType){var Bb=
this.m3i(this.Gf,this.paneType);Bb&&(this.eJ||this.dJ?(this.da.rtl&&(Bb.x*=-1),this.Iv.style.transform=`translate3d(${Bb.x}px, ${Bb.y}px, 0px)`):Ba.DOMElementExtensions.updatePosition(this.Iv,Bb.x,Bb.y,!0,this.da.rtl))}else t.ULS.sendTraceTag(524079517,0,10,`ShareTooltipControl.updateTooltipPosition: Either highlight div is null or pane type is none for sharing type ${this.kfa}.`)}hVd(){return 0===this.kfa||4===this.kfa}isObserverChart(){return 4===this.kfa}SWh(){this.hVd()||(Ba.DOMElementExtensions.Ghe(this.Lq),
this.da.rtl?(this.Lq.appendChild(this.Jfa),this.Lq.appendChild(this.ez),this.Lq.appendChild(this.Cna),this.Iv.dir="rtl"):(this.Lq.appendChild(this.Cna),this.Lq.appendChild(this.ez),this.Lq.appendChild(this.Jfa),this.Iv.dir="ltr"))}focus(){this.Lq.focus();return!0}zk(Bb){return this.isFocused&&Ba.DOMElementExtensions.Ki(this.Lq,Bb)}n3i(){switch(this.kfa){case 0:return oa.a.instance.ia(2265);case 4:return oa.a.instance.ia(2568);case 1:return oa.a.instance.ia(2266);case 2:return oa.a.instance.ia(2267);
default:return""}}Ozd(Bb,pc){const wc=Date.now();window.requestAnimationFrame(()=>{this.Iv.className=this.hVd()?"ewr-shareSection-floatingoject-tooltip-container":"ewr-shareSection-tooltip-container";this.Lq=document.createElement("div");this.Lq.className="ewr-shareSection-tooltip-flyout";this.Lq.tabIndex=0;var cd=null,Vd=!0;this.isObserverChart&&(Vd=!1,this.Lq.style.backgroundColor="#c43e1c",cd=pc?pc[uc.a.$Mc]:null);var xb=this.n3i();this.Lq.setAttribute(Ub.a.oy,cd?`${xb} ${cd}`:xb);this.Iv.appendChild(this.Lq);
this.Cna=document.createElement("div");this.Cna.className="ewr-shareSection-tooltip-textContainer";const ub=document.createElement("span");ub.className="ewr-shareSection-tooltip-text";if(this.isObserverChart){var Fc=pc?pc[uc.a.aNc]:null;cd||Fc?Fc?Zb.a.nda(Fc)?(ub.innerText=`${xb} `,xb=document.createElement("a"),xb.target="_blank",xb.href=Fc,xb.textContent=cd,cd=document.createElement("div"),cd.className=ub.className,document.body.appendChild(cd),Fc=window.getComputedStyle(cd).color,document.body.removeChild(cd),
xb.style.color=Fc,ub.appendChild(xb)):ub.innerText=`${xb} ${cd}`:ub.innerText=`${xb} ${cd}`:ub.innerText=xb}else ub.innerText=xb;Vd||(ub.style.borderRight="0px");this.Cna.appendChild(ub);Vd&&(this.ez=document.createElement("div"),this.ez.className="ewr-shareSection-tooltip-close-icon",this.ez.tabIndex=0,this.ez.setAttribute(Ub.a.oy,oa.a.instance.ia(986)),this.svgIconProvider.hka(Ob.a.YOk,16,16,this.ez,20,20));this.Jfa=document.createElement("div");this.Jfa.className="ewr-shareSection-tooltip-icon";
this.svgIconProvider.hka(Ob.a.ZOk,20,20,this.Jfa,20,20);Ba.DOMElementExtensions.toggleCssClass(this.Jfa,"ewr-shareSection-tooltip-hidden",!0);this.da.rtl?(this.Lq.appendChild(this.Jfa),this.ez&&this.Lq.appendChild(this.ez),this.Lq.appendChild(this.Cna),this.Iv.dir="rtl"):(this.Lq.appendChild(this.Cna),this.ez&&this.Lq.appendChild(this.ez),this.Lq.appendChild(this.Jfa),this.Iv.dir="ltr");this.o4();this.H7a();this.Co();this.FIc=!0;Bb&&(this.dna(),this.q7b=window.setInterval(this.o4,1E4));Vd=Date.now();
t.ULS.sendTraceTag(524931737,0,50,`ShareTooltipControl.createTooltip: successfully highlighted and created tooltip for shareSectionContentType = ${this.kfa}, duration= ${Vd-wc}`)})}Co(){this.Lq&&(this.dza=this.Df.pf(this.Lq),this.dza.Ea("mouseover",this.$U),this.dza.Ea("mouseout",this.ZU),this.dza.Ea("focus",this.onFocus),this.dza.Ea("blur",this.onBlur),this.dza.Ea("keydown",this.Ok));this.ez&&(this.e7a=this.Df.pf(this.ez),this.e7a.Ea("click",this.$Uj),this.e7a.Ea("focus",this.aVj),this.e7a.Ea("blur",
this.ZUj))}Sba(){this.dza&&this.dza.XH();this.e7a&&this.e7a.XH();Ba.DOMElementExtensions.Ghe(this.Iv);Ba.DOMElementExtensions.vh(this.Iv);this.Jfa=this.ez=this.Cna=this.Lq=this.Iv=this.Gf=this.e7a=this.dza=null}dna(){window.clearInterval(this.q7b);Ba.DOMElementExtensions.toggleCssClass(this.Jfa,"ewr-shareSection-tooltip-hidden",!0);this.ez&&Ba.DOMElementExtensions.toggleCssClass(this.ez,"ewr-shareSection-tooltip-hidden",!1);Ba.DOMElementExtensions.toggleCssClass(this.Cna,"ewr-shareSection-tooltip-toggle-maxWidth0",
!1);this.Wcl();this.raiseEvent("expandTooltipEvent",new Qa(this.Ixe));this.FIc=!0}m3i(Bb,pc){let wc=parseInt(Bb.style.left,10);var cd=parseInt(Bb.style.right,10);let Vd=parseInt(Bb.style.top,10);if((this.eJ||this.dJ)&&this.wN){var xb=this.wN.ehb?this.wN.ehb:this.da.Ub.QWa(this.wN.range,pc,!0);xb&&(wc=cd=this.da.Ub.cGb(this.wN,xb.x),Vd=xb.y+this.da.Ub.uGa(this.wN,!1))}if(!cd&&this.da.rtl&&this.hVd()){cd=Bb.offsetWidth;xb=this.da.pg(pc).domElement.offsetWidth;let ub=wc;Bb.parentNode&&(ub+=Bb.parentNode.offsetLeft);
cd=xb-cd-ub}return this.eMd(new Sys.UI.Point(this.da.rtl?cd:wc,Vd),pc,Bb)}eMd(Bb,pc,wc){var cd=this.da.pg(pc).ul;pc=ja.a.pN(pc,cd.topLeft);cd=wc.offsetWidth;wc=wc.offsetHeight;let Vd=0;this.Lq&&Ba.DOMElementExtensions.htb(this.Lq,"ewr-shareSection-tooltip-toggle-leftAndRight")&&(Vd=20);return new Sys.UI.Point(Math.min(Math.max(pc.x,Bb.x-10),Bb.x+cd)+Vd,Math.min(Math.max(pc.y,Bb.y-10),Bb.y+wc))}Wcl(){const Bb=this.da.pg(this.paneType).ul,pc=ja.a.pN(this.paneType,Bb.topLeft);this.QYb=Math.max(this.QYb,
this.Lq.offsetWidth);let wc=parseInt(this.Iv.style.left,10);this.da.rtl&&(wc=parseInt(this.Iv.style.right,10));wc+this.QYb>pc.x+Bb.width?Ba.DOMElementExtensions.toggleCssClass(this.Lq,"ewr-shareSection-tooltip-toggle-leftAndRight",!0):Ba.DOMElementExtensions.toggleCssClass(this.Lq,"ewr-shareSection-tooltip-toggle-leftAndRight",!1);this.H7a()}}Object(l.a)(Hc,"ShareToolTipControl",wb.a,[534,4]);class Dd extends wb.a{constructor(Bb,pc){super();this.rYc=null;this.lfa={};this.Cza=null;this.awb=[];this.hL=
()=>{if(this.$.la&&Na.d(this.$.la)===this.rYc){const wc=this.lfa;for(const cd in wc)this.H7a(cd)}};this.onActiveItemChanged=(wc,cd)=>{if(cd&&cd.la&&cd.Vx){wc=this.lfa;for(const Vd in wc){wc=this.NXa(Vd);if(!wc)break;if(Na.d(cd.la)!==this.rYc){wc.hide(!1);break}if(Na.d(cd.la)!==Na.d(cd.Vx)){wc.show(!0);break}wc.SWh()}}};this.Rtg=(wc,cd)=>{cd&&this.raiseEvent("collapseSharingTooltip",cd)};this.Stg=(wc,cd)=>{cd&&this.raiseEvent("expandSharingTooltip",cd)};this.Ttg=(wc,cd)=>{cd&&this.raiseEvent("closeSharingTooltip",
cd)};this.$=Bb;this.svgIconProvider=pc;this.da=N.f(Bb);Bb.la&&(this.rYc=Na.d(Bb.la));this.wLh()}eDh(Bb){this.addHandler("closeSharingTooltip",Bb)}fsk(Bb){this.removeHandler("closeSharingTooltip",Bb)}gDh(Bb){this.addHandler("collapseSharingTooltip",Bb)}hsk(Bb){this.removeHandler("collapseSharingTooltip",Bb)}MDh(Bb){this.addHandler("expandSharingTooltip",Bb)}Hsk(Bb){this.removeHandler("expandSharingTooltip",Bb)}dispose(){this.Efi();this.h_h();fc.a.vb(this.Cza);this.Cza=null;super.dispose()}sKb(Bb,pc,
wc,cd,Vd,xb,ub){if(0!==Bb&&pc){var Fc=tc.a.Od(this.lfa,wc);if(!Fc){const xd=document.createElement("div");Fc=new Hc(this.da,Bb,this.svgIconProvider,cd,wc,xd,pc,Vd,xb,ub);this.lfa[wc]=Fc;Fc.hDh(this.Rtg);Fc.NDh(this.Stg);Fc.hEh(this.Ttg);window.requestAnimationFrame(()=>{const Ic=this.da.pg(Bb).domElement;Ic.insertBefore(xd,Ic.firstChild)})}Na.d(this.$.la)!==this.rYc?Fc.hide(!1):this.H7a(wc)}}dsb(Bb){const pc=tc.a.Od(this.lfa,Bb);pc&&(delete this.lfa[Bb],pc.dispose())}H7a(Bb){tc.a.Od(this.lfa,Bb)&&
(0>this.awb.indexOf(Bb)&&this.awb.push(Bb),this.Cza=Wa.AsyncMethodContext.Ax(this.updatePosition.bind(this),100,Fa.a.XOk,this.Cza))}NXa(Bb){return tc.a.Od(this.lfa,Bb)}updatePosition(){this.awb&&0<this.awb.length&&(this.awb.forEach(Bb=>{(Bb=tc.a.Od(this.lfa,Bb))&&Bb.H7a()}),this.awb.length=0)}wLh(){this.$&&this.$.qa.mh(this.onActiveItemChanged);this.da&&(this.da.za.xP(this.hL),this.da.za.$t(this.hL),this.da.view.Ks(this.hL))}Efi(){this.$&&this.$.qa.xh(this.onActiveItemChanged);this.da&&(this.da.za.AR(this.hL),
this.da.za.yu(this.hL),this.da.view.xs(this.hL))}h_h(){const Bb=this.lfa;for(const wc in Bb){var pc=Bb[wc];pc.isk(this.Rtg);pc.Isk(this.Stg);pc.btk(this.Ttg);pc.dispose()}this.raiseEvent("closeSharingTooltip");this.lfa=null}}Object(l.a)(Dd,"ShareToolTipControlsManager",wb.a,[525,4]);const jc=[47];class $c{constructor(Bb,pc,wc,cd,Vd){this.Iha=[1,3,2,4];this.rZd=this.kIc=!1;this.Vzf=!0;this.uC={};this.T9d=()=>{this.Tlf()};this.$=Bb;this.da=N.f(Bb);this.Kt=pc;this.rya=wc;this.sharedSheetRange=cd;this.kfa=
Vd;this.sheetRange=new Ma.a(z.I(cd),Na.d(Bb.qa.la));this.MGj()}get bXd(){return this.rZd}get contentType(){return this.kfa}dispose(){this.da&&this.da.ha&&this.da.ha.mfa.g3b(this);this.N5a(!1);this.dsb();this.lj();this.uC=null}UXa(){this.da.TRd();this.lj()&&(this.da.ha.mfa.Snd(this),this.N5a(!0))}URd(){this.URb();this.dsb()}zte(){this.IWg(!1)}eUf(){this.lXg(!1)}FXg(){this.lXg(!0)}lj(){this.da.lj(this.sharedSheetRange,null,null,null,60,"SharingHighlight.GotoRangeAndShowHighlight");return!0}Exe(){const Bb=
this.Kt.NXa(this.rya);return Bb?Bb.isFocused:!1}O6b(){if(!this.C4f())return!1;const Bb=this.Kt.NXa(this.rya);return!Bb||Bb.isFocused?!1:Bb.focus()}zk(Bb){if(!this.C4f())return!1;const pc=this.Kt.NXa(this.rya);return pc&&pc.isFocused?pc.zk(Bb):!1}lXg(Bb){for(const pc in this.uC)Ba.DOMElementExtensions.toggleCssClass(this.uC[pc],"ewr-shareSection-tooltip-toggle-opacity",Bb)}MGj(){if(this.sharedSheetRange&&1==this.contentType){const Bb=this.sharedSheetRange.LastRow-this.sharedSheetRange.FirstRow,pc=
this.sharedSheetRange.LastColumn-this.sharedSheetRange.FirstColumn;pc&&Bb&&t.ULS.sendTraceTag(525144270,0,50,`SharingHighlight.logRangeSize: Shared Range contains cells = ${Bb*pc}.`)}}N5a(Bb){this.sheetRange?Bb?(this.da.Ub.Rtb(this.sheetRange,jc),this.IWg(!0)):this.URb():t.ULS.sendTraceTag(537153814,0,10,"SharingHighlight.ShowOrHideSharingHighlight: Shared Range is null.")}IWg(Bb){this.kIc||(this.da.Ub.Klc(this.T9d),this.kIc=!0);this.da.Ub.Iq(jc,null,null,!0,!0);this.rZd=!0;this.Vzf=Bb;this.Tlf();
Bb&&this.lj()}URb(){this.da.Ub.rl(jc);this.da.Ub.G3b(this.T9d);this.rZd=this.kIc=!1}Tlf(){if(this.sheetRange){var Bb=N.f(this.$).rb.Yh(this.sheetRange.range.topLeft),pc=this.da.Ub.sQ(47,Bb);Bb&&pc.Gf&&Ba.DOMElementExtensions.isVisible(pc.Gf)&&(this.Kt.sKb(Bb,pc.Gf,this.rya,this.kfa,this.Vzf,pc),this.Fck(),this.da.Ub.G3b(this.T9d),this.kIc=!1)}}Fck(){if(this.uC){var Bb=Date.now();for(let wc=0;wc<this.Iha.length;wc++){this.uC[this.Iha[wc].toString()]&&(Ba.DOMElementExtensions.vh(this.uC[this.Iha[wc].toString()]),
this.uC[this.Iha[wc].toString()]=null);var pc=this.da.rb.IYd(this.sheetRange.range,this.Iha[wc]);const cd=this.da.Ub.sQ(47,this.Iha[wc]).Gf;if(!pc||!cd)break;pc=document.createElement("div");pc.className="ewr-shareSection-highlightDiv-overlay";cd.appendChild(pc);this.uC[this.Iha[wc].toString()]=pc}Bb=Date.now()-Bb;t.ULS.sendTraceTag(523765014,0,50,`SharingHighlight.populateOverlayDivElements: Successfully added overlay for shared Range/Table in durationInMS = ${Bb}.`)}}dsb(){if(this.Kt){this.Kt.dsb(this.rya);
const Bb=this.uC;for(const pc in Bb)Ba.DOMElementExtensions.vh(Bb[pc]);this.uC={}}}C4f(){if(!this.da.ha.oa.vi)return!1;let Bb=this.da.ha.oa.activeRange;this.da.ha.oa.rva()&&(Bb=this.da.ha.oa.activeCell);return Bb.equals(z.I(this.sharedSheetRange))?!0:!1}}Object(l.a)($c,"SharingHighlight",null,[524,4]);var ud=a(1366);class Ud extends ud.a{constructor(){super();this.LastColumn=this.LastRow=0}}Object(l.a)(Ud,"SharedSheetRange",ud.a,[]);var ec=a(177);const Db=Ub.a.x3a;class ic{constructor(Bb,pc){this.T2h=
oa.a.instance.ia(2268);this.floatingObjectManager=null;this.Bq=!1;this.XI={};this.YTa=[];this.Isa=this.lgb=!1;this.aDd=0;this.D2=!1;this.cZc=null;this.TVb=this.xTb=!1;this.jhb=0;this.r_b=(wc,cd)=>{cd.control&&cd.control.floatingObject&&0===cd.control.floatingObject.type&&this.cDc(cd.control.floatingObject.id,!1)};this.zmg=(wc,cd)=>{cd.control&&cd.control.floatingObject&&!cd.control.floatingObject.type&&this.cDc(cd.control.floatingObject.id,!0)};this.Fwa=(wc,cd)=>{cd.item&&this.TR&&cd.item.name===
this.TR.name&&(t.ULS.sendTraceTag(524038161,0,50,"ShareSectionGotoAndHighlightManager.onNamedSheetViewModeChanged: Closing all highlight due to named sheet view mode."),this.Vpk())};this.wg=()=>{this.XI&&0<Object.keys(this.XI).length&&(this.aDd++,2==this.aDd&&(this.U3g(),this.lgb=!1))};this.U3g=()=>{this.da.Rb.gq(this.wg);this.Isa&&window.clearInterval(this.jhb);this.da.$.Dc(876400478,0,8,null);t.ULS.sendTraceTag(524931740,0,50,"ShareSectionGotoAndHighlightManager.triggerFPS: FPS survey got triggered.")};
this.onActiveItemPanesChanged=(wc,cd)=>{if(cd&&(wc=cd.Vda,!(this.TVb&&wc||!this.TVb&&!wc)&&this.S4f())){this.D2=!0;this.TVb=!!wc;for(const Vd in this.XI)this.cDc(Vd,!1)}};this.Px=()=>{this.cZc=Wa.AsyncMethodContext.Ax(this.Yjk.bind(this),100,Fa.a.WOk,this.cZc)};this.MPd=()=>{for(const wc in this.XI){const cd=tc.a.Od(this.XI,wc);cd&&this.VPf(cd)}this.xTb&&this.fa&&(this.fa.Av(this.MPd),this.xTb=!1)};this.Akg=(wc,cd)=>{cd&&this.g3b(cd.rya)};this.Bkg=(wc,cd)=>{cd&&(wc=tc.a.Od(this.XI,cd.rya))&&wc.eUf()};
this.hmg=(wc,cd)=>{cd&&(wc=tc.a.Od(this.XI,cd.rya))&&wc.FXg()};this.$=Bb;this.da=N.f(Bb);this.aDd=0;this.Isa=this.lgb=!1;this.Kt=new Dd(Bb,pc);this.floatingObjectManager=nb.a(Bb);this.fa=Bb.fa;if(this.TR=Bb.la)this.TVb=!!this.TR.Pn;this.Co()}dispose(){this.Isa&&window.clearInterval(this.jhb);this.Sba();const Bb=this.XI;for(const pc in Bb)Bb[pc].dispose();this.Kt&&this.Kt.dispose();this.Kt=this.XI=null;fc.a.vb(this.cZc);this.cZc=null;this.YTa.length=0}highlightObserverChart(Bb){const pc=Bb[uc.a.Idf];
let wc=tc.a.Od(this.XI,pc);wc||(wc=new La(this.$,this.Kt,pc,null,0,4,{[uc.a.$Mc]:Bb[uc.a.$Mc],[uc.a.aNc]:Bb[uc.a.aNc]}));this.XI[pc]=wc;wc.UXa()}Z5i(){this.UXa(0)||0!=this.YTa.length||t.ULS.sendTraceTag(537153818,0,10,"ShareSectionGotoAndHighlightManager.GotoAndHighlightChart: Shared chart not found.")}$5i(){this.UXa(1)||0!=this.YTa.length||t.ULS.sendTraceTag(537153817,0,10,"ShareSectionGotoAndHighlightManager.GotoAndHighlightRange: Shared sheet range not found.")}a6i(){this.UXa(2)||0!=this.YTa.length||
t.ULS.sendTraceTag(537153816,0,10,"ShareSectionGotoAndHighlightManager.GotoAndHighlightRange: Shared table not found.")}f6i(){this.vVd(this.$.workbookContext)||t.ULS.sendTraceTag(512356422,0,10,"ShareSectionGotoAndHighlightManager.gotoSheet: Shared sheet not found.")}c6i(){this.vVd(this.$.workbookContext)?Db!==ec.a(this.$).um.Tw&&da.EwaSettings.isChangeGateEnabled("OfficeVSO:8501332_ShareExcelNamedSheetView")&&ec.a(this.$).um.activateRibbonTab(Db):t.ULS.sendTraceTag(508376321,0,10,"ShareSectionGotoAndHighlightManager.gotoNamedSheetView: Shared named sheet view not found.");
this.Bq=!0}Co(){this.Kt&&(this.Kt.eDh(this.Akg),this.Kt.gDh(this.Bkg),this.Kt.MDh(this.hmg));this.floatingObjectManager&&(this.floatingObjectManager.plc(this.r_b),this.floatingObjectManager.olc(this.zmg));this.TR&&this.TR.ue&&this.TR.ue.Vbb(this.Fwa);this.$&&this.$.qa&&this.$.qa.KCa(this.onActiveItemPanesChanged);this.da&&this.da.h6(this.Px)}Sba(){this.Kt&&(this.Kt.fsk(this.Akg),this.Kt.hsk(this.Bkg),this.Kt.Hsk(this.hmg));this.floatingObjectManager&&(this.floatingObjectManager.ZTc(this.r_b),this.floatingObjectManager.YTc(this.zmg));
this.TR&&this.TR.ue&&this.TR.ue.y3b(this.Fwa);this.$&&this.$.qa&&this.$.qa.uLa(this.onActiveItemPanesChanged);this.da&&this.da.yZ(this.Px);this.da&&this.da.Rb&&this.lgb&&(this.da.Rb.gq(this.wg),this.lgb=!1);this.xTb&&this.fa&&this.fa.Av(this.MPd);this.$.WUg=!1;t.ULS.sendTraceTag(508367327,0,50,"ShareSectionGotoAndHighlightManager.detachEvents: Setting the ewaControl shouldPassNavigationIdInOpenWorkbookRequest as false.")}S4f(){return this.$.la&&this.TR&&Na.d(this.$.la)===Na.d(this.TR)}Yjk(){if(this.S4f()){if(this.D2)for(const Bb in this.XI)this.cDc(Bb,
!0);this.D2=!1}}cDc(Bb,pc){(Bb=tc.a.Od(this.XI,Bb))&&(pc?Bb.zte():Bb.URd())}vVd(Bb){if(Bb.NavigationContentFound)return!0;this.YUk(this.T2h);return!1}YUk(Bb){Bb=Cc.a.Xv.KC.QP(Bb,!1);Bb.image=2;Cc.a.Xv.KC.pz(Bb)}UXa(Bb){var pc;const wc=this.$.workbookContext;if(!this.vVd(wc))return!1;Bb=this.fXi(wc,Bb);if(!Bb)return!1;(null===(pc=this.fa)||void 0===pc?0:pc.io)&&this.VPf(Bb);!this.xTb&&this.fa&&(this.fa.Nr(this.MPd),this.xTb=!0);return!0}fXi(Bb,pc){const wc=this.djb(Bb);Bb=this.S0i(Bb,pc,wc);if(!Bb)return t.ULS.sendTraceTag(537153815,
0,10,`ShareSectionGotoAndHighlightManager.GetOrCreateSharingHighlight: Invalid shareSectionContentType = ${pc}.`),null;if(0<=this.YTa.indexOf(Bb))return t.ULS.sendTraceTag(522314690,0,50,"ShareSectionGotoAndHighlightManager.GetOrCreateSharingHighlight: Highlight already closed by user."),null;let cd=tc.a.Od(this.XI,Bb);cd||(cd=0===pc?new La(this.$,this.Kt,Bb,wc,0,0):new $c(this.$,this.Kt,Bb,wc,pc),this.XI[Bb]=cd);return cd}djb(Bb){const pc=new Ud;pc.SheetName=this.$.la.name;pc.FirstRow=Bb.NavigationSharedSectionSharedRange.FirstRow;
pc.FirstColumn=Bb.NavigationSharedSectionSharedRange.FirstColumn;pc.LastRow=Bb.NavigationSharedSectionSharedRange.LastRow;pc.LastColumn=Bb.NavigationSharedSectionSharedRange.LastColumn;return pc}S0i(Bb,pc,wc){switch(pc){case 0:return this.PIf(Bb);case 2:return Bb.NavigationSharedSectionXluid;case 1:return wc.toString();default:return null}}PIf(Bb){Bb=Bb.NavigationSharedSectionXluid;return`${Bb.length}.${Bb.toUpperCase()}`}VPf(Bb){this.$&&!this.TR&&(this.TR=this.$.la);this.TR&&(this.TVb=this.TR.Pn?
!0:!1);this.lgb||(this.da.Rb.Uq(this.wg),this.lgb=!0);this.Isa||(this.jhb=window.setInterval(this.U3g,6E4),this.Isa=!0);t.ULS.sendTraceTag(524931739,0,50,`ShareSectionGotoAndHighlightManager.gotoAndHighlightSharedSection: started highlighting and creating tooltip for shareSectionContentType = ${Bb.contentType}.`);Bb.UXa()}g3b(Bb){const pc=tc.a.Od(this.XI,Bb);pc&&(delete this.XI[Bb],0>this.YTa.indexOf(Bb)&&this.YTa.push(Bb),pc.dispose());0===Object.keys(this.XI).length&&this.Sba()}Vpk(){const Bb=this.XI;
for(const pc in Bb)this.g3b(pc);this.Bq&&(this.Bq=!1,this.Sba())}}Object(l.a)(ic,"ShareSectionGotoAndHighlightManager",null,[514,4]);var Pc=a(684);let Ed=class{constructor(Bb,pc){this.ot=!1;this.jub=new ic(Bb,pc);this.ot=Bb.isMobileMode}Rc(Bb,pc){if(this.ot)return!1;switch(pc.command){case 1321134125:case 1804990828:case 1045473631:return da.EwaSettings.isChangeGateEnabled("OfficeVSO:8096934_ShareExcelSection");case 1200018948:return!0;case -521202831:return da.EwaSettings.isChangeGateEnabled("OfficeVSO:8096933_ShareExcelSheet");
case -368249625:return da.EwaSettings.isChangeGateEnabled("OfficeVSO:8501332_ShareExcelNamedSheetView");default:return!1}}executeCommand(Bb,pc,wc){ba.TaskExtensions.kl();Bb=pc.command;switch(Bb){case 1321134125:this.jub.Z5i();wc=X.Task.Va(!0);break;case 1200018948:this.jub.highlightObserverChart(wc);wc=X.Task.Va(!0);break;case 1804990828:this.jub.$5i();wc=X.Task.Va(!0);break;case 1045473631:this.jub.a6i();wc=X.Task.Va(!0);break;case -521202831:this.jub.f6i();wc=X.Task.Va(!0);break;case -368249625:this.jub.c6i();
wc=X.Task.Va(!0);break;default:wc=O.a(Bb)}return wc}td(){return!1}gd(){return!1}};Ed=Object(u.__decorate)([Object(Oa.d)(Ha.ShareSectionCommandHandlerService),Object(u.__param)(0,Object(Ha.EwaControlService)()),Object(u.__param)(1,Object(Pc.h)())],Ed);Object(l.a)(Ed,"ShareSectionCommandHandler",null,[29]);var de=a(191);const se=(Bb,pc,wc,cd,Vd,xb,ub,Fc)=>{Fc=Bb.$a(1,void 0===Fc?null:Fc);Fc.activeCell=pc;Fc.selectedRange=wc;return B.h(Bb,"GetSelectAllRange",Fc,cd,Vd,xb,ub,4)};var Fe;let fe=Fe=class{constructor(Bb){this.$=
Bb;this.da=N.f(Bb);this.ha=this.da.ha}get activeRange(){return this.da.inRangePicker||this.da.nk?this.ha.rangePicker.BJd(!0).clone():this.ha.oa.activeRange.clone()}gd(){return!1}executeCommand(Bb,pc){let wc=Bb=!1;var cd=null;cd=pc.command;switch(cd){case -2117762619:return this.S$i();case 1941920197:Bb=wc=!0;cd="SelectAll";break;case 2110202177:cd="SelectColumns";Bb=!0;break;case 104573693:cd="SelectRows";wc=!0;break;default:return O.a(cd)}const Vd=this.activeRange;if(Vd.i2f)return X.Task.Va(!0);
const xb=this.da.Eb.dg(Vd,!0),ub=!!xb||1941920197!==pc.command,Fc=!ub&&this.TKh();if(ub||Fc)return Fc?(pc=this.u3c(!0,!0),t.ULS.sendTraceTag(537151697,0,50,"SmartSelectionCommandHandler.ExecuteCommand selecting entire grid")):pc=xb?this.hfl(Bb,wc,xb):this.u3c(Bb,wc),t.ULS.shipAssertTag(509720675,0,null!=cd,"smartSelectionCommandHandler.executeCommand: gotoCaller is null!"),this.da.lj(z.y(pc,this.$),null,null,null,0,cd,3),t.ULS.sendTraceTag(19798168,0,50,"SmartSelectionCommandHandler.ExecuteCommand: command handled on client."),
X.Task.Va(!0);const xd=this.$.ma.sa,Ic=z.r(this.ha.oa.activeCell,this.$),bd=z.y(Vd,this.$);t.ULS.sendTraceTag(19798169,0,50,"SmartSelectionCommandHandler.ExecuteCommand: command sent to server.");return E.a(this.$.userOperationManager,(yb,Oc,kd)=>se(xd,Ic,bd,C.c(yb,Rc=>{Fe.b8i(Rc,this.da)}),Oc,kd,null),yb=>new M.a(165,0,yb,16),pc)}Rc(Bb,pc){switch(pc.command){case 1941920197:case 2110202177:case 104573693:case -2117762619:return!0}return!1}td(){return!1}S$i(){const Bb=this.da.SXa(),pc=this.u3c(!0,
!0);this.da.lj(z.y(pc,this.$),Bb,null,null,60,"SmartSelectionCommandHandler.HandleWidgetSelectAllCommand",3);t.ULS.sendTraceTag(19965127,0,50,"SmartSelectionCommandHandler.HandleWidgetSelectAllCommand");return X.Task.Va(!0)}hfl(Bb,pc,wc){t.ULS.shipAssertTag(537151696,0,!!wc);var cd=this.activeRange;if(!wc)return cd;const Vd=cd.top===wc.usedRange.top&&cd.bottom===wc.usedRange.bottom;cd=cd.right===wc.usedRange.right&&cd.left===wc.usedRange.left;if(Bb&&!Vd||pc&&!cd)return Bb=this.kfl(Bb,pc,wc),2===wc.type&&
Bb.equals(de.a(wc))&&this.ha.oa.vi&&wc.activate({scenario:"namedObject"}),Bb;t.ULS.sendTraceTag(537151695,0,50,`SmartSelectionCommandHandler.UpdateSelectionByNamedTable selecting all grid, allRows = ${Bb}, allColumns = ${pc}`);return this.u3c(Bb,pc)}kfl(Bb,pc,wc){const cd=this.activeRange,Vd=this.sSk(cd,wc,Bb,pc);t.ULS.sendTraceTag(537151694,0,50,`Selecting table, allRows = ${Bb}, allColumns = ${pc}, shouldSelectInnerTable = ${Vd}, isPivotTable = ${1===wc.type}`);wc=Vd?de.a(wc):wc.usedRange;pc&&(cd.right=
wc.right,cd.left=wc.left);Bb&&(cd.top=wc.top,cd.bottom=wc.bottom);return cd}u3c(Bb,pc){t.ULS.sendTraceTag(537151693,0,50,`Selecting grid, allRows = ${Bb}, allColumns = ${pc}`);const wc=this.activeRange;pc&&(wc.left=1,wc.right=G.a.rf);Bb&&(wc.top=1,wc.bottom=G.a.sf);return wc}sSk(Bb,pc,wc,cd){if(2!==pc.type)return!1;pc=de.a(pc);return wc&&cd?pc.contains(Bb)&&!pc.equals(Bb):wc?pc.contains(Bb)&&!(pc.top===Bb.top&&pc.bottom===Bb.bottom):!1}TKh(){const Bb=this.activeRange;--Bb.top;Bb.bottom+=1;--Bb.left;
Bb.right+=1;var pc=Fe.IPi(Bb);Bb.kX();if(!this.da.Ek.contains(Bb))return!1;for(const wc of pc){pc=Fe.SPi(Bb,wc);pc=this.da.Np("SmartSelectionCommandHandler.AreSelectionEdgesEmpty",pc,1);try{for(;pc.$$mn();)if(pc.$$cu().text)return!1}finally{pc&&pc.dispose()}}return!0}static SPi(Bb,pc){Bb=Bb.clone();Bb.tpe(pc,Bb.UT(pc));return Bb}static IPi(Bb){const pc=[];1<=Bb.top&&pc.push(1);Bb.bottom<=G.a.Qz&&pc.push(2);1<=Bb.left&&pc.push(3);Bb.right<=G.a.Ny&&pc.push(4);return pc}static b8i(Bb,pc){if(!U.a.Ls(Bb.Errors)&&
Bb.Result){Bb=Bb.Result;var wc=z.I(Bb);const cd=pc.Ek.contains(wc);wc=wc.equals(new A.Range(1,1,G.a.sf,G.a.rf,!0,!0));t.ULS.sendTraceTag(537151692,0,50,`SmartSelectionCommandHandler.HandleGetSelectAllRangeSuccess: newSelectionInLoadedRange = ${cd}, allGridSelection = ${wc}`);pc.lj(Bb,null,null,null,0,"SmartSelectionComandHandler.HandleGetSelectAllRangeSuccess",3)}}};fe=Fe=Object(u.__decorate)([Object(Oa.d)(Ha.SmartSelectionCommandHandlerService),Object(u.__param)(0,Object(Ha.EwaControlService)())],
fe);Object(l.a)(fe,"SmartSelectionCommandHandler",null,[29]);var Tc=a(327),ed=a(2),pd=a(6);class Kb{}Object(l.a)(Kb,"SpellCheckFeedbackLoopParameters",null,[]);var rb=a(124),rc=a(79);class ld{constructor(Bb,pc,wc){this.kna=this.bX=null;this.tmb=!1;this.LL=this.hrb=this.vqb=this.M2a=this.w6c=null;this.s_j=cd=>{!Ka.a(cd)&&cd.Result?(t.ULS.sendTraceTag(41956352,0,50,"SpellCheckModel.OnGetSpellCheckSupportedLocaleListWebMethodSuccess GetSpellCheckSupportedLocaleList response success"),cd=cd.Result,this.$Zf=
cd.IsCurrentLocaleIdSupported,this.Ww.xue(cd)):(this.Ww.xue(null),t.ULS.sendTraceTag(41956353,0,10,"SpellCheckModel.OnGetSpellCheckSupportedLocaleListWebMethodSuccess GetSpellCheckSupportedLocaleList response error"))};this.r_j=cd=>{cd=rb.a.te(cd.data);t.ULS.sendTraceTag(537151387,0,10,`SpellCheckModel.OnGetSpellCheckSupportedLocaleListWebMethodFailed Errors: [${U.a.pc(cd)}].`);this.Ww.xue(null)};this.q_j=cd=>{this.vqb=this.M2a=null;!Ka.a(cd)&&cd.Result?(cd=cd.Result,this.LL=cd.SpellCheckItems,this.bX.FirstRow=
cd.ActiveBatchEndRow,this.bX.FirstColumn=cd.ActiveBatchEndColumn,t.ULS.sendTraceTag(537151386,0,50,`SpellCheckModel.OnGetSpellCheckInfoWebMethodSuccess OnGetSpellCheckInfoWebMethod response success, SpellCheck cache: ${this.LL.length}`),this.Tg=this.LL[0]):(t.ULS.sendTraceTag(537151385,0,10,"SpellCheckModel.OnGetSpellCheckInfoWebMethodSuccess OnGetSpellCheckInfoWebMethod response error"),this.Tg=null)};this.p_j=cd=>{cd=rb.a.te(cd.data);t.ULS.sendTraceTag(537151384,0,10,`SpellCheckModel.OnGetSpellCheckInfoWebMethodFailed Errors: [${U.a.pc(cd)}].`);
this.Tg=this.vqb=this.M2a=null};this.M5j=(cd,Vd)=>{if(!Ka.a(cd)&&cd.Result)if(t.ULS.sendTraceTag(537151383,0,50,"SpellCheckModel.OnSpellCheckChangeAllWebMethodSuccess OnSpellCheckChangeAllWebMethod response success"),cd=cd.Result,!cd.ReplacedCount)t.ULS.sendTraceTag(537151382,0,10,"SpellCheckModel.OnSpellCheckChangeAllWebMethodSuccess Replace Count equal to 0"),this.Tg=null;else{if(!Vd){this.Ww.VLk(cd.ReplacedCount,this.hrb);Vd=0;cd=[];for(const xb of this.LL)this.Tg.Row===xb.Row&&this.Tg.Column===
xb.Column&&(cd[Vd++]=xb);this.LL=cd;this.WPg();this.pTb()}}else t.ULS.sendTraceTag(537151381,0,10,"SpellCheckModel.OnSpellCheckChangeAllWebMethodSuccess OnSpellCheckChangeAllWebMethodSuccess response error"),this.Tg=null};this.L5j=cd=>{cd=rb.a.te(cd.data);t.ULS.sendTraceTag(537151380,0,10,`SpellCheckModel.OnSpellCheckChangeAllWebMethodFailed Errors: [${U.a.pc(cd)}].`);this.Tg=null};this.$=Bb;this.da=N.f(Bb);this.Iya=wc;this.xDc=[];this.$Zf=!0;this.Ww=pc;this.d8b=[];this.eXf()}get Tg(){return this.w6c}set Tg(Bb){this.w6c=
Bb;this.$Zf?!this.Tg||0!==this.Tg.Type&&1!==this.Tg.Type?this.Ww.fZg(!!this.Tg,this.tmb):ba.TaskExtensions.R0c(this.Ww.A2c(this.tmb,this.kna,A.Range.Hc(this.Tg.Row+1,this.Tg.Column+1)),()=>{this.Ww.fZg(!!this.Tg,this.tmb);return ba.TaskExtensions.E7()},this.$.Aa,11,rc.a.current):t.ULS.sendTraceTag(537151443,0,50,`SpellCheckModel.ActiveSpellCheckItem Current Locale not supported: ${this.Iya}`)}get Xbi(){return this.da?this.da.ha.oa.activeCell:A.Range.Hc(1,1)}get eci(){return this.da?this.da.ha.oa.Ed:
A.Range.Hc(1,1)}qrj(){return!!this.M2a}eXf(){if(this.tmb=this.fxj()){var Bb=this.eci;this.kna=z.t(Bb,this.$);this.bX=z.r(Bb,this.$)}else Bb=this.Xbi,this.kna=z.t(Bb,this.$),this.bX=z.r(Bb,this.$)}ilj(Bb){var pc=this.$.ma.sa,wc=this.s_j,cd=this.r_j;const Vd=pc.$a(1,null);Vd.localeName=Bb;B.h(pc,"GetSpellCheckSupportedLocaleList",Vd,wc,cd,null,null,0)}pTb(){if(Tc.a(this.LL)){var Bb=this.$.ma.sa.mc();this.M2a=Bb.ClientRequestId;var pc=this.$.ma.sa,wc=this.kna,cd=this.bX,Vd=this.Iya,xb=this.xDc,ub=pd.AFrameworkApplication.ea.ka("ProofingWithEditorServiceInboundaryCloudSuggestionsIsEnabled"),
Fc=pd.AFrameworkApplication.ea.ka("IsSubscriptionForProofingUser"),xd=this.q_j,Ic=this.p_j;const bd=pc.$a(1,null);bd.spellCheckRanges=wc;bd.batchStartCell=cd;bd.localeName=Vd;bd.ignoredWords=xb;bd.isCompliant=ub;bd.subscriptionType=Fc;this.vqb=B.h(pc,"GetSpellCheckInfo",bd,xd,Ic,null,Bb,0);t.ULS.sendTraceTag(537151436,0,50,"SpellCheckModel.InvokeGetSpellCheckInfoWebMethod GetSpellCheckInfo RequestSent")}else t.ULS.sendTraceTag(537151437,0,50,"SpellCheckModel.InvokeGetSpellCheckInfoWebMethod SpellCheck Cache Hit"),
this.Tg=this.LL[0]}zlj(Bb,pc){const wc={};this.$.Zk(wc);wc.FirstRow=this.Tg.Row;wc.FirstColumn=this.Tg.Column;let cd,Vd;(()=>{let yb=this.Hoi(pc,Bb);({ine:cd,V3b:Vd}=yb);return yb})();Bb&&(this.hrb=Vd);const xb=this.yta(cd,Bb),ub=this.kna,Fc=this.$.ma.sa,xd=()=>new Va(xb,Vd,wc,ub,!Bb),Ic=this.Tg.StartIndex,bd=this.Tg.StartIndex+this.Tg.Length-1;E.a(this.$.userOperationManager,(yb,Oc,kd)=>{var Rc=Vd,Xb=!Bb;yb=C.c(yb,this.M5j);Oc=C.b(Oc,this.L5j);var dc=!Bb;const Vc=Fc.$a(1,null);Vc.findData=xb;Vc.activeCell=
wc;Vc.selectedRanges=ub;Vc.replaceWith=Rc;Vc.isSingle=Xb;Vc.startIndex=Ic;Vc.endIndex=bd;return B.h(Fc,"SpellCheckChangeAll",Vc,yb,Oc,kd,dc,0)},yb=>new M.a(213,0,yb,void 0,xd),null);t.ULS.sendTraceTag(537151433,0,50,"SpellCheckModel.InvokeSpellCheckChangeAllWebMethod InvokeSpellCheckChangeAll RequestSent")}ylj(){this.M2a&&(t.ULS.sendTraceTag(537151430,0,15,"SpellCheckModel.InvokeSpellCheckCancelWebMethod Cancelling pending SpellCheck request"),B.i(this.$.ma.sa,this.M2a,null,null,null),this.M2a=null);
this.vqb&&(pd.AFrameworkApplication.od.dy(this.vqb.sx),this.vqb=null)}kUd(Bb,pc){pc=void 0===pc?!1:pc;this.Tg&&!pc&&(t.ULS.sendTraceTag(537151427,0,50,"SpellCheckModel.InvokeFeedbackLoopWebMethod SpellCheck FeedbackLoop Item added"),Bb=Object(ed.a)(new Kb,{AppId:"Excel_Online",CritiquePriority:0,LanguageId:this.Iya,OriginalText:this.Tg.InputWord,Suggestions:this.Tg.Suggestions,SuggestionText:this.IOd(Bb),EventId:Bb,TraceId:this.Tg.TraceId,CritiqueTypeId:this.Tg.CritiqueTypeId}),this.d8b.push(Bb));
if(5<this.d8b.length||pc){t.ULS.sendTraceTag(537151426,0,50,`SpellCheckModel.InvokeFeedbackLoopWebMethod SpellCheck FeedbackLoop webmethod invoked with item count ${this.d8b.length}`);pc=this.$.ma.sa;Bb=this.d8b;const wc=pc.$a(1,null);wc.spellCheckFeedbackLoopParametersArray=Bb;B.h(pc,"SpellCheckFeedbackLoop",wc,null,null,null,null,0);this.d8b.length=0}}fVc(Bb){if(!Bb)this.LL=this.w6c=this.kna=this.bX=null;else if(this.LL){for(;1<this.LL.length;)this.LL.pop();this.tmb?(this.bX.FirstRow=this.kna.Ranges[0].FirstRow,
this.bX.FirstColumn=this.kna.Ranges[0].FirstColumn):(this.WPg(),this.kna=z.w(z.H(this.bX),this.$.la))}this.ylj();t.ULS.sendTraceTag(537151395,0,50,`SpellCheckModel.ResetSpellCheckModel SpellCheck Model Reset, keepCurrentSpellCheckItem: ${Bb}`)}yGg(Bb,pc){t.ULS.sendTraceTag(537151392,0,50,`SpellCheckModel.RemoveSpellCheckItems changeAll: ${Bb}, ignoreAll: ${pc}`);Tc.a(this.LL)||(pc&&(this.xDc.includes(this.Tg.InputWord)?t.ULS.sendTraceTag(537151391,0,15,"SpellCheckModel.RemoveSpellCheckItems IgnoreAll words encountered again."):
this.xDc.push(this.Tg.InputWord)),Bb||pc?this.G8k(Bb,pc):this.LL.splice(0,1))}Ioi(Bb,pc,wc){let cd=wc.substring(0,this.Tg.StartIndex);var Vd=wc.substr(this.Tg.StartIndex);Bb=this.IOd(Bb);Vd=pc?sa.a.wsb(wc,this.Tg.InputWord,Bb,!1,pc,!0):cd+sa.a.wsb(Vd,this.Tg.InputWord,Bb,!1,pc);if(!Tc.a(this.LL))for(const ub of this.LL)if(this.Tg.Row===ub.Row&&this.Tg.Column===ub.Column&&this.Tg.StartIndex<ub.StartIndex){let Fc=0;if(pc){var xb=String.format("(^|"+Ub.a.Mfb+"+)({0})(?:(?="+Ub.a.Mfb+")|$)",this.Tg.InputWord);
cd=wc.substring(0,ub.StartIndex);for(xb=new RegExp(xb,"g");xb.exec(cd);)++Fc}else Fc=1;ub.StartIndex+=(Bb.length-this.Tg.InputWord.length)*Fc}return Vd}IOd(Bb){switch(Bb){case 4:case 8:return this.Tg.Suggestions[0];case 5:case 9:return this.Tg.Suggestions[1];case 6:case 10:return this.Tg.Suggestions[2];default:return""}}yta(Bb,pc){Bb={};Bb.SearchString=this.Tg.InputWord;Bb.MatchCase=!0;Bb.MatchEntireCell=!0;Bb.SearchAllSheets=!1;Bb.SearchUp=!1;Bb.ExcludeFormulaResult=!0;Bb.SheetName=this.kna.SheetName;
pc&&(Bb.ReplaceWholeWordOnly=!0,Bb.MatchEntireCell=!1);return Bb}fxj(){return this.da.ha.oa.vi&&!this.da.ha.oa.rva()}Hoi(Bb,pc){let wc,cd;cd=wc=null;if(!this.Tg)return t.ULS.shipAssertTag(537151378,0,!!this.Tg,"SpellCheckModel.EstimateSpellCheckReplaceSingleCell: ActiveSpellCheckItem is null"),{returnValue:!1,ine:wc,V3b:cd};const Vd=N.f(this.$).Ob(A.Range.Hc(this.Tg.Row+1,this.Tg.Column+1));if(!Vd)return t.ULS.sendTraceTag(537151377,0,50,"EstimateReplaceSingleCell - currentCell is null"),{returnValue:!1,
ine:wc,V3b:cd};wc=Vd.text;wc=sa.a.Nob(wc);cd=this.Ioi(Bb,pc,wc);Vd.text=cd;pc&&(cd=this.IOd(Bb));return{returnValue:!0,ine:wc,V3b:cd}}G8k(Bb,pc){if(!Tc.a(this.LL)){var wc=0,cd=0,Vd=[];for(const xb of this.LL)Bb&&!sa.a.equals(this.Tg.InputWord,xb.InputWord,!1)||pc&&!this.xDc.includes(xb.InputWord)?Vd[cd++]=xb:wc++;this.LL=Vd;0<wc&&t.ULS.sendTraceTag(537151374,0,50,`SpellCheckModel.TrimChangeAndIgnoreAllWordsFromCache SpellCheckItems trimmed count ${wc} for ChangeAll: ${Bb}, IgnoreAll: ${pc}`)}}WPg(){this.bX.FirstColumn=
this.Tg.Column+1;this.bX.FirstRow=this.Tg.Row;this.bX.FirstColumn===G.a.Ny-1&&(this.bX.FirstColumn=0,this.bX.FirstRow=this.Tg.Row+1)}}Object(l.a)(ld,"SpellCheckModel",null,[523]);var Tb=a(179),Wc=a(1483),Ac=a(666),nd=a(29);class qd{constructor(Bb,pc){this.$=Bb;this.Ww=pc}HO(){const Bb=this.yl(!0,1,null,null,null,null,0,null,!1,null,!0);nd.a.Fj()?void Oa.a.resolve(Ha.ReactTaskPaneManagerService,{xa:0}).then(pc=>pc.PC("SpellCheckTaskPane",Bb)):Tb.a.li().then(pc=>{pc.showTaskPane("SpellCheckTaskPane",
Bb);return null})}QE(Bb,pc,wc,cd,Vd,xb,ub,Fc,xd,Ic){const bd=this.yl(!1,Bb,pc,wc,cd,Vd,xb,ub,Fc,xd,Ic);nd.a.Fj()?void Oa.a.resolve(Ha.ReactTaskPaneManagerService,{xa:0}).then(yb=>yb.updateTaskPane("SpellCheckTaskPane",bd)):Tb.a.li().then(yb=>{yb.updateTaskPane("SpellCheckTaskPane",bd);return null})}AQ(){nd.a.Fj()?void Oa.a.resolve(Ha.ReactTaskPaneManagerService,{xa:0}).then(Bb=>Bb.hideTaskPane("SpellCheckTaskPane")):Tb.a.li().then(Bb=>{Bb.hideTaskPane("SpellCheckTaskPane",2);return null})}YLa(){nd.a.Fj()?
void Oa.a.resolve(Ha.ReactTaskPaneManagerService,{xa:0}).then(Bb=>Bb.setSelectedTaskPane("SpellCheckTaskPane")):Tb.a.li().then(Bb=>{Bb.setSelectedTaskPane("SpellCheckTaskPane");return null})}yl(Bb,pc,wc,cd,Vd,xb,ub,Fc,xd,Ic,bd){Bb=Bb?{type:"SpellCheckTaskPaneProps",activeTab:1,showLoadingIcon:!0,misspelledWordBoxContent:null,suggestionBoxContent:null,userActionButtons:null,localeInfoContent:null,onMessageButtonExecute:null,previousChangeAllActionInfo:null}:this.Jai(pc,wc,cd,Vd,xb,ub,Fc,xd,Ic,bd);
return Object(ed.a)(new Wc.a,{contentProps:Bb,onOpen:()=>{this.Ww.l3()},onClose:()=>{this.Ww.zt()},width:300,title:oa.a.instance.ia(1298)})}Jai(Bb,pc,wc,cd,Vd,xb,ub,Fc,xd,Ic){let bd=null,yb=null,Oc=null,kd=null,Rc=null,Xb=null,dc=!0;switch(Bb){case 1:({misspelledWordBoxContent:bd,suggestionBoxContent:yb,userActionButtons:Oc,returnValue:dc}=this.c9h(pc,wc));dc=(()=>{let Vc=this.Kkf(Vd,xd);({localeInfoContent:kd}=Vc);return Vc})().returnValue&&dc;break;case 4:({localeInfoContent:kd,returnValue:dc}=
this.Kkf(Vd,xd));break;case 5:Xb=()=>{this.Ww.$Zk()};break;case 2:case 7:case 3:Xb=()=>{this.Ww.gZg()};break;case 8:Xb=()=>{this.Ww.a_k()}}0<xb&&!(()=>{let Vc=qd.l$h(xb,ub);({previousChangeAllActionInfo:Rc}=Vc);return Vc})().returnValue&&t.ULS.sendTraceTag(537151372,0,10,"SpellCheckReactTaskPane.CreateSpellCheckTaskPaneProps Failed to create previous change all information.");dc||(Bb=7);return{type:"SpellCheckTaskPaneProps",showLoadingIcon:Ic,activeTab:Bb,misspelledWordBoxContent:bd,suggestionBoxContent:yb,
userActionButtons:Oc,localeInfoContent:kd,onMessageButtonExecute:Xb,worksheetName:cd,previousChangeAllActionInfo:Rc,showOutOfSyncNotification:Fc,onRecheckExecute:()=>{this.Ww.gZg()}}}c9h(Bb,pc){let wc;var cd;var Vd=cd=wc=null;if(!Bb||!pc)return t.ULS.sendTraceTag(537151371,0,10,"SpellCheckReactTaskPane.CreateMisspelledWordTabData spellCheckItem/spellCheckCellText is null"),{returnValue:!1,misspelledWordBoxContent:wc,suggestionBoxContent:cd,userActionButtons:Vd};wc={misspelledWordType:0===Bb.Type?
0:1,misspelledWordBeginIndex:Bb.StartIndex,misspelledWordEndIndex:Bb.StartIndex+Bb.Length,misspelledWordCellContent:pc};pc=null;cd=0;if(!Tc.a(Bb.Suggestions))for(pc=Array(3),Vd=0;Vd<Bb.Suggestions.length&&3>Vd;Vd++){const xb=Bb.Suggestions[Vd];let ub,Fc;Vd?1===Vd?(ub=5,Fc=9):(ub=6,Fc=10):(ub=4,Fc=8);sa.a.uu(xb)||(pc[cd++]={suggestionText:xb,changeId:ub,changeAllId:Fc})}cd={suggestions:pc,onChangeButtonExecute:xb=>{this.Ww.Jud(!1,xb)},onChangeAllButtonExecute:xb=>{this.Ww.Jud(!0,xb)}};Vd={onIgnoreButtonExecute:()=>
{this.Ww.AVf(!1,0)},onIgnoreAllOrDeleteButtonExecute:()=>{1===Bb.Type?this.Ww.Jud(!1,3):this.Ww.AVf(!0,1)}};return{returnValue:!0,misspelledWordBoxContent:wc,suggestionBoxContent:cd,userActionButtons:Vd}}Kkf(Bb,pc){var wc=null;if(Tc.a(pc))return t.ULS.sendTraceTag(537151370,0,10,"SpellCheckReactTaskPane.CreateLocaleInfoContent supportedLocaleList is null"),{returnValue:!1,localeInfoContent:wc};wc=Ac.a.kN(Bb);Bb={localeId:Bb,localeName:wc?wc.displayName:Bb};const cd=Array(pc.length);let Vd=0;for(let xb=
0;xb<pc.length;xb++)(wc=Ac.a.kN(pc[xb]))&&(cd[Vd++]={localeId:pc[xb],localeName:wc.displayName});wc={currentLocale:Bb,supportedLocaleInfoList:cd,onLanguageChangeExecute:xb=>{this.Ww.ZZk(xb)}};return{returnValue:!0,localeInfoContent:wc}}static l$h(Bb,pc){return pc?{returnValue:!0,previousChangeAllActionInfo:{changeCount:Bb,suggestionApplied:pc}}:{returnValue:!1,previousChangeAllActionInfo:null}}}Object(l.a)(qd,"SpellCheckReactTaskPane",null,[522]);class Xd{constructor(Bb){this.QMa=this.Iya=null;this.jJ=
0;this.m6a=null;this.q_c=0;this.jYd=this.hk=this.YT=this.b_c=!1;this.e8b=null;this.showOutOfSyncNotification=!1;this.Zde=0;this.LG=this.hrb=null;this.Nh=()=>{if(3!==this.FA){var pc=N.f(this.$).Ob(null);pc&&this.gkc&&pc.range.equals(this.gkc)&&(t.ULS.sendTraceTag(537151489,0,50,"SpellCheckManager.OnEditStarted SpellCheckPaneTab set to ResumeSpellCheckTab"),this.FA=2)}};this.Py=()=>{this.$.fa.Je!==G.a.Me&&this.$.fa.yc&&(this.YT=!0)};this.rr=()=>{if(this.$.fa.Je!==G.a.Me&&this.YT&&(this.YT=!1,!this.showOutOfSyncNotification&&
2!==this.FA&&3!==this.FA))if(this.x1<this.EJ)if(t.ULS.sendTraceTag(537151457,0,50,`SpellCheckManager.OnGridConsistent Unexpected SpellCheck Stateid Changed Expected ${this.x1} Active ${this.EJ} StateId`),this.x1=this.EJ,this.q_c=this.fkc,this.OZd)t.ULS.sendTraceTag(537151456,0,15,"SpellCheckManager.OnGridConsistent SpellCheck Stateid Changed while ongoing SpellCheck request"),this.LG.fVc(!1),this.y6b();else if(this.Tg&&1===this.FA){var pc=N.f(this.$).Ob(this.gkc);pc&&this.QMa?(pc=pc.pwb,pc=sa.a.Nob(pc),
sa.a.equals(pc,this.QMa,!0)?(t.ULS.sendTraceTag(537151454,0,50,"SpellCheckManager.OnGridConsistent SpellCheck Cache cleared except for current active SpellCheckItem"),this.LG.fVc(!0)):(t.ULS.sendTraceTag(537151453,0,50,"SpellCheckManager.OnGridConsistent SpellCheck cell content mismatch"),this.FA=2)):(t.ULS.sendTraceTag(537151455,0,50,"SpellCheckManager.OnGridConsistent SpellCheckFormatCell is null"),this.FA=2)}else{if(5===this.jJ||6===this.jJ||8===this.jJ)this.showOutOfSyncNotification=!0,this.updateTaskPane()}else this.x1>
this.EJ&&(t.ULS.sendTraceTag(537151452,0,50,`SpellCheckManager.OnGridConsistent SpellCheck Unexpected StateId's Encountered, Expected ${this.x1} Active ${this.EJ} StateId`),this.x1=this.EJ)};this.Gj=(pc,wc)=>{wc.la?(this.b_c||(this.q_c=wc.la.index,6!==this.FA&&3!==this.FA&&(this.FA=3,t.ULS.sendTraceTag(537151448,0,50,"SpellCheckManager.OnActiveSheetChanged ActiveSpellCheckPaneTab set to ReCheckSpellCheckTab"))),this.b_c=!1):(t.ULS.sendTraceTag(537151449,0,10,"SpellCheckManager.OnActiveSheetChanged Active Sheet is null"),
this.FA=7)};this.jd=(pc,wc)=>{!wc.Hg&&this.hk&&this.zt()};this.$=Bb;this.x1=this.EJ;this.Uij(Bb);this.Tij();this.$.Sj(this.jd)}get Tg(){return this.LG.Tg}get FA(){return this.jJ}set FA(Bb){this.showOutOfSyncNotification=!1;if(4!==this.jJ&&7!==this.jJ||2!==Bb&&3!==Bb)this.jJ=Bb,7!==this.jJ&&4!==this.jJ&&2!==this.jJ&&3!==this.jJ&&5!==this.jJ&&6!==this.jJ&&8!==this.jJ||this.LG.fVc(!1),7===this.jJ&&t.ULS.shipAssertTag(537151567,0,!1,"SpellCheckManager.ActiveSpellCheckPaneTab: Unexpected State encountered"),
this.hk?(this.updateTaskPane(),this.Byk()):this.jYd=!0}get OZd(){return this.LG.qrj()}get EJ(){return this.$.fa.Je}get gkc(){return this.Tg?A.Range.Hc(this.Tg.Row+1,this.Tg.Column+1):null}get fkc(){return this.$.la?this.$.la.index:0}dispose(){this.$.ro(this.jd);this.$=null;this.hideTaskPane()}VLk(Bb,pc){this.Zde=Bb;this.hrb=pc}Byk(){this.Zde=0;this.hrb=null}l3(){this.Mcb();this.jYd?(this.updateTaskPane(),this.jYd=!1):(this.q_c=this.$.qa.la.index,this.m6a&&!this.m6a.IsCurrentLocaleIdSupported&&4!==
this.FA?this.FA=4:this.y6b())}zt(){this.hideTaskPane();this.rtc();this.LG.kUd(12,!0);this.LG.fVc(!1);this.jJ=0}nXk(){this.showTaskPane()}Jud(Bb,pc){t.ULS.sendTraceTag(537151561,0,50,`SpellCheckManager.ChangeButtonClick ${Bb}`);this.OZd?t.ULS.sendTraceTag(537151560,0,10,"SpellCheckManager.ChangeButtonClick SpellCheck in progress"):(N.f(this.$).isEditing&&N.f(this.$).Bu(!0),this.LG.zlj(Bb,pc),this.x1=this.EJ+1,this.LG.kUd(pc),this.LG.yGg(Bb,!1),Bb||this.LG.pTb())}AVf(Bb,pc){t.ULS.sendTraceTag(537151557,
0,50,`SpellCheckManager.IgnoreButtonClick ${Bb}`);this.OZd?t.ULS.sendTraceTag(537151556,0,10,"SpellCheckManager.IgnoreButtonClick SpellCheck in progress"):(N.f(this.$).isEditing&&N.f(this.$).Bu(!0),this.LG.kUd(pc),this.LG.yGg(!1,Bb),this.x1=this.EJ,this.LG.pTb())}ZZk(Bb){N.f(this.$).isEditing&&N.f(this.$).Bu(!0);t.ULS.sendTraceTag(537151553,0,50,"SpellCheckManager.SpellCheckLocaleChanged SpellCheck Locale changed");this.LG=new ld(this.$,this,Bb);this.Iya=Bb;this.m6a.IsCurrentLocaleIdSupported=!0;
this.LG.pTb()}a_k(){t.ULS.sendTraceTag(537151523,0,50,"SpellCheckManager.SpellCheckReCheckCurrentSheetButtonClick SpellCheck Check Current Sheet button Clicked on SpellCheck complete on selected range.");const Bb=A.Range.Hc(1,1);N.f(this.$).ha.updateSelection(Bb,Bb,0);this.y6b()}gZg(){N.f(this.$).isEditing&&N.f(this.$).Bu(!0);t.ULS.sendTraceTag(537151521,0,50,"SpellCheckManager.SpellCheckResumeButtonClick SpellCheck Resume Button Clicked");this.y6b()}$Zk(){N.f(this.$).isEditing&&N.f(this.$).Bu(!0);
t.ULS.sendTraceTag(537151518,0,50,"SpellCheckManager.SpellCheckNextWorkSheetButtonClick SpellCheck NextWorkSheet Button Clicked");const Bb=this.oLf(this.fkc);Bb?(t.ULS.sendTraceTag(537151517,0,50,`SpellCheckManager.SpellCheckNextWorkSheetButtonClick Worksheet Change from ${this.fkc} to ${Bb.index}`),N.f(this.$).j4(),this.b_c=!0,Bb.activate({scenario:"spellChecker"}),N.f(this.$).lj(z.y(A.Range.Hc(1,1),this.$),null,null,null,60,"SpellCheckManager.SpellCheckNextWorkSheetButtonClick"),this.y6b()):(this.b_c=
!1,this.FA=7,t.ULS.sendTraceTag(537151516,0,10,"SpellCheckManager.SpellCheckNextWorkSheetButtonClick SpellCheckSwitchWorksheetTab shown when no next worksheet available."))}xue(Bb){t.ULS.sendTraceTag(537151513,0,50,"SpellCheckManager.SpellCheckSupportedLocaleListReceived SpellCheck SupportedLocaleList Received from Server");Bb&&!Tc.a(Bb.SupportedLocaleList)?(this.m6a=Bb,this.m6a.IsCurrentLocaleIdSupported||(t.ULS.sendTraceTag(537151512,0,15,"SpellCheckManager.SpellCheckSupportedLocaleListReceived ActiveSpellCheckPaneTab set to LanguageErrorTab"),
this.FA=4)):(t.ULS.sendTraceTag(537151511,0,10,"SpellCheckManager.SpellCheckSupportedLocaleListReceived ActiveSpellCheckPaneTab set to SpellCheckErrorTab"),this.FA=7)}fZg(Bb,pc){if(Bb&&this.Tg){Bb=this.oLf(this.fkc);if(0===this.Tg.Type||1===this.Tg.Type){pc=N.f(this.$).Ob(this.gkc);if(!pc){t.ULS.sendTraceTag(537151507,0,10,"SpellCheckManager.SpellCheckModelUpdated SpellFormatCell is null");this.QMa=null;this.FA=7;return}this.QMa=pc.pwb;this.QMa=sa.a.Nob(this.QMa);if(!sa.a.equals(this.QMa.substring(this.Tg.StartIndex,
this.Tg.StartIndex+this.Tg.Length),this.Tg.InputWord,!1)){t.ULS.sendTraceTag(537151506,0,15,"SpellCheckManager.SpellCheckModelUpdated Mismatch in Client and Server Misspelled word");this.FA=2;return}this.FA=1}else this.FA=pc?8:Bb&&this.q_c!==Bb.index?5:6;t.ULS.sendTraceTag(537151505,0,50,`SpellCheckManager.SpellCheckModelUpdated, ActiveSpellCheckPaneTab set to ${this.FA}`)}else t.ULS.sendTraceTag(537151508,0,10,"SpellCheckManager.SpellCheckModelUpdated ActiveSpellCheckPaneTab set to SpellCheckErrorTab"),
this.FA=7}A2c(Bb,pc,wc){pc=Bb?z.G(pc.Ranges[0]):wc;t.ULS.sendTraceTag(537151502,0,50,`SpellCheckManager.UpdateCellSelection SpellCheck cell selection updated: isSpellCheckWithInSelection ${Bb}`);N.f(this.$).ha.updateSelection(pc,wc,0,void 0,void 0,"SpellCheck.UpdateCellSelection");return N.a(N.f(this.$),"SpellCheck.UpdateCellSelection",void 0,60)}Uij(Bb){this.e8b=new qd(Bb,this)}Tij(){this.Iya=this.$.ta.DataCultureTag.toUpperCase();this.LG=new ld(this.$,this,this.Iya);this.LG.ilj(this.Iya)}y6b(){t.ULS.shipAssertTag(537151495,
0,!this.Tg,"SpellCheckManager.SetSpellCheckModel ActiveSpellCheckItem should be null");this.LG.eXf();this.LG.pTb()}Mcb(){this.$.fa.qF(this.Py);this.$.fa.LCa(this.rr);N.f(this.$).Rb.Jp(this.Nh);this.$.qa.mh(this.Gj)}rtc(){this.$.qa&&this.$.qa.xh(this.Gj);var Bb=this.$.fa;Bb&&(Bb.wG(this.Py),Bb.yxa(this.rr));(Bb=N.f(this.$).Rb)&&Bb.zp(this.Nh)}oLf(Bb){let pc=(Bb+1)%this.$.qa.count,wc;for(;pc!==Bb;){wc=this.$.qa.getItem(pc);if(null===wc||void 0===wc?0:wc.visible)return wc;pc=(pc+1)%this.$.qa.count}return null}showTaskPane(){this.hk?
this.e8b.YLa():(this.hk=!0,this.e8b.HO())}updateTaskPane(Bb){this.e8b.QE(this.jJ,this.Tg,this.QMa,this.$.la.sheetName,this.Iya,this.Zde,this.hrb,this.showOutOfSyncNotification,this.m6a?this.m6a.SupportedLocaleList:null,void 0===Bb?!1:Bb);6!==this.jJ||this.showOutOfSyncNotification||ba.TaskExtensions.tb(da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)?Object(pa.d)(Oa.a.resolve(Ha.AriaLiveNotifierService,{xa:0})):Ga.GetServiceTaskFactory.Ne(this.$.ra,211,
212,0),pc=>{pc=pc.result;pc.setEnabled(!0);pc.readText(oa.a.instance.ia(865))},this.$.Aa,3)}hideTaskPane(){this.hk=!1;this.e8b.AQ()}}Object(l.a)(Xd,"SpellCheckManager",null,[513,4]);let Hd=class{constructor(Bb){this.Ww=null;this.$=Bb}gd(){return!1}Rc(Bb,pc){return da.EwaSettings.Ra(264)&&1===Bb&&1570327544===pc.command}executeCommand(Bb,pc){this.Ww||(this.Ww=new Xd(this.$));Bb=ba.TaskExtensions.kl();pc=pc.command;switch(pc){case 1570327544:this.Ww.nXk();break;default:Bb=O.a(pc)}return Bb}td(){return!1}dispose(){this.Ww&&
(this.Ww.dispose(),this.Ww=null);this.$=null}};Hd=Object(u.__decorate)([Object(Oa.d)(Ha.SpellCheckCommandHandlerService),Object(u.__param)(0,Object(Ha.EwaControlService)())],Hd);Object(l.a)(Hd,"SpellCheckCommandHandler",null,[29,4]);let Zc=class{constructor(Bb){this.$=Bb}N_f(Bb){return $b.a.Zg(Bb)}W4g(Bb){if(this.N_f(Bb))return{kind:"Empty"};const pc=this.$.qa.la.sheetName;let wc=sa.a.contains(Bb[0],"!",!0)?Bb[0].split("!")[0]:pc;const cd=[];for(const Vd of Bb){let xb,ub;if((()=>{let Fc=z.kb(Vd,this.$.qa);
({sheetName:xb,range:ub}=Fc);return Fc})().returnValue){wc=z.mb(wc);if(xb?!sa.a.equals(wc,xb,!0):!sa.a.equals(wc,pc,!0))return{kind:"Failure"};cd.push(ub)}else if(Bb=this.$.wc.getItemByName(Vd))(ub=Bb.usedRange)&&cd.push(ub);else return{kind:"Failure"}}t.ULS.sendTraceTag(507617352,0,50,`ViewportHelpers.TryParseGotoRange: Succeeded parsing ${cd.length} ranges.`);return{kind:"Success",U0h:wc,lwg:cd}}cQf(Bb){switch(Bb.kind){case "Success":const pc=Bb.lwg.length-1;N.f(this.$).oY(Bb.lwg,pc,Bb.U0h,null,
null,null,null,3,{scenario:"goto-dialog",caller:"GotoDialog.Commit"});break;case "NovMode":this.$.wc.hya(this.$.wc.getItemByName(Bb.aHa),Bb.scenario)}}muj(Bb){return"Success"===Bb.kind}c3f(Bb){return"NovMode"===Bb.kind||"Success"===Bb.kind}};Zc=Object(u.__decorate)([Object(Oa.d)(Ha.ViewportHelpersService),Object(u.__param)(0,Object(Ha.EwaControlService)())],Zc);Object(l.a)(Zc,"ViewportHelpers",null,[]);var Jc;let gc=Jc=class{constructor(Bb,pc){this.$=Bb;this.eQ=pc}Wdk(Bb){var pc;this.copyPasteInfrastructure||
(this.copyPasteInfrastructure=this.$.ra.Tb(254));const wc=null===(pc=this.copyPasteInfrastructure)||void 0===pc?void 0:pc.H7f;wc&&this.$ne("prefetchLastCopiedString",{SheetName:this.$.la.name,SearchString:wc,MatchCase:Bb.aXb,MatchEntireCell:Bb.bXb,SearchAllSheets:Bb.Fva===Gb.txc,SearchUp:!1,ExcludeFormulaResult:!1})}Udk(Bb){var pc;this.copyPasteInfrastructure||(this.copyPasteInfrastructure=this.$.ra.Tb(254));const wc=null===(pc=this.copyPasteInfrastructure)||void 0===pc?void 0:pc.H7f;wc&&wc===Bb.m0a||
this.$ne("prefetchInitialStringInFindDialog",{SheetName:this.$.la.name,SearchString:Bb.m0a,MatchCase:Bb.aXb,MatchEntireCell:Bb.bXb,SearchAllSheets:Bb.Fva===Gb.txc,SearchUp:!1,ExcludeFormulaResult:!1})}zyg(Bb){Bb.SearchUp?t.ULS.sendTraceTag(507377731,0,50,"FindPrefetch:prefetchFind SearchUp not supported."):this.$ne("prefetchFind",Bb)}Sdk(Bb,pc){this.qGk(Bb,pc)}$ne(Bb,pc){const wc=new Ca(pc,this.$.fa.Cw,!1,Jc.A1,!0);this.eQ.set(wc,void 0);const cd=this.$.ma.sa,Vd=z.t(Jc.A1,this.$);wa(cd,pc,Vd,xb=>
{Jc.LXj(xb,this.eQ,wc,Bb)},()=>{t.ULS.sendTraceTag(507384587,0,15,"FindPrefetch:FindAll prefetch failed.")},null,null)}static LXj(Bb,pc,wc,cd){Ka.a(Bb)?t.ULS.sendTraceTag(507377729,0,10,"onFindAllPrefetchWebMethodSuccess: EwaResult contains NonStatusMessages."):(Bb=Bb.Result,null!==Bb&&void 0!==Bb&&Bb.Results?Bb.Results.length?1E3<Bb.Results.length?t.ULS.sendTraceTag(507261660,0,20,"onFindAllPrefetchWebMethodSuccess: More than 1000 results found."):wc&&pc&&pc.exists(wc)&&pc.set(wc,Bb):t.ULS.sendTraceTag(507377730,
0,50,`onFindAllPrefetchWebMethodSuccess: FindAllPrefetch found nothing, caller:${cd}`):t.ULS.shipAssertTag(507384584,0,!1,`FindAndReplaceDialog.OnFindAllWebMethodSuccess: findAllResult defined:${!!Bb}, Results is defined:${!(null===Bb||void 0===Bb||!Bb.Results)}`))}qGk(Bb,pc){const wc=pc&&Gb.TFc(this.$),{cell:cd,range:Vd}=Gb.vGf(this.$,wc),xb=new Ca(Bb,this.$.fa.Cw,pc,Gb.getActiveCell(this.$),!1);this.eQ.set(xb,void 0);za(this.$.ma.sa,Bb,cd,Vd,ub=>{Jc.OXj(ub,this.eQ,xb)},()=>{t.ULS.sendTraceTag(507265986,
0,15,"FindPrefetch:findCell prefetch failed.")},null,null)}static OXj(Bb,pc,wc){Ka.a(Bb)?t.ULS.sendTraceTag(507265985,0,10,"onFindCellPrefetchWebMethodSuccess: EwaResult contains NonStatusMessages."):(Bb=Bb.Result)&&Bb.SheetRange&&wc&&pc&&pc.exists(wc)&&pc.set(wc,Bb)}};gc.A1=A.Range.Hc(1,1);gc=Jc=Object(u.__decorate)([Object(Oa.d)(Ha.FindPrefetchService),Object(u.__param)(0,Object(Ha.EwaControlService)()),Object(u.__param)(1,Object(Ha.FindOperationsCacheService)())],gc);Object(l.a)(gc,"FindPrefetch",
null,[]);let dd=class{constructor(Bb){this.$=Bb;this.Py=()=>{this.$.fa.Je!==G.a.Me&&this.CBi(this.$.fa.Je)};this.bVc=()=>{da.EwaSettings.CY()?this.HFa=[]:this.nWa.clear()};da.EwaSettings.CY()?this.HFa=[]:this.nWa=new Map;this.$.fa.qF(this.Py);this.$.fa.LJ(this.bVc);this.$.Ul(this.bVc)}dispose(){var Bb,pc,wc,cd,Vd;null===(pc=null===(Bb=this.$)||void 0===Bb?void 0:Bb.fa)||void 0===pc?void 0:pc.wG(this.Py);null===(cd=null===(wc=this.$)||void 0===wc?void 0:wc.fa)||void 0===cd?void 0:cd.zL(this.bVc);null===
(Vd=this.$)||void 0===Vd?void 0:Vd.tm(this.bVc)}exists(Bb){return da.EwaSettings.CY()?"NotFound"!==this.search(Bb).kind:this.nWa.has(Bb)}set(Bb,pc){if(da.EwaSettings.CY()){var wc=this.search(Bb);"NotFound"!==wc.kind?wc.fQ=pc:(wc=this.Ahg(Bb),wc=Bb.wka?{kind:"FindAll",dQ:wc,fQ:pc}:{kind:"Find",dQ:wc,fQ:pc},this.HFa.push(wc))}else this.nWa.set(Bb,pc)}delete(Bb){da.EwaSettings.CY()?(Bb=this.oOg(Bb),void 0!==Bb&&this.HFa.splice(Bb,1)):this.nWa.delete(Bb)}search(Bb){if(da.EwaSettings.CY()){var pc=this.oOg(Bb);
if(void 0!==pc)return this.HFa[pc]}else for(pc of this.nWa){const [wc,cd]=pc;if(Bb.equals(wc))return wc.wka?{kind:"FindAll",dQ:wc,fQ:cd}:{kind:"Find",dQ:wc,fQ:cd}}return{kind:"NotFound",dQ:Bb,fQ:void 0}}dne(Bb){var pc;if(Bb.IQ)return{WFa:!1,fQ:void 0};var wc=Bb.Bff({wka:!0,activeCell:gc.A1});wc=this.search(wc);if("NotFound"===wc.kind)return{WFa:!1,fQ:void 0};if("Find"===wc.kind)return t.ULS.sendTraceTag(507376547,0,10,"FindOperationsCache.searchForNextResultInPrefetch: Found a Find result instead of FindAll"),
{WFa:!1,fQ:void 0};wc=wc.fQ;const cd=null===(pc=null===wc||void 0===wc?void 0:wc.Results)||void 0===pc?void 0:pc.length;if(!cd)return{WFa:!1,fQ:void 0};pc=Bb.activeCell;if(Bb.findData.SearchAllSheets)Bb=this.sEk(wc,pc);else{Bb=wc.Results[0];for(let Vd=0;Vd<cd;Vd++)if(this.O0f(wc.Results[Vd].SheetCell,pc)){Bb=wc.Results[Vd];break}}return Bb?{WFa:!0,fQ:{SheetRange:z.o(Bb.SheetCell),FoundInRichValue:Bb.FoundInRichValue}}:{WFa:!1,fQ:void 0}}sEk(Bb,pc){const wc=Bb.Results.length;var cd=this.$.la.sheetName;
let Vd;for(var xb=0;xb<wc;xb++)if(cd===Bb.Results[xb].SheetCell.SheetName){var ub=xb;break}if(void 0!==ub){for(var Fc;ub<wc;ub++)if(xb=Bb.Results[ub].SheetCell,cd===xb.SheetName){if(this.O0f(xb,pc)){Vd=Bb.Results[ub];break}}else{Fc=ub;break}Vd||(void 0===Fc&&(Fc=0),Vd=Bb.Results[Fc])}else{pc=this.$.qa.activeItemIndex;for(cd=pc+1;cd<this.$.qa.items.length&&!Vd;cd++)for(Fc=0;Fc<wc;Fc++)if(this.$.qa.items[cd].sheetName===Bb.Results[Fc].SheetCell.SheetName){Vd=Bb.Results[Fc];break}if(!Vd){for(cd=0;cd<
pc&&!Vd;cd++)for(Fc=0;Fc<wc;Fc++)if(this.$.qa.items[cd].sheetName===Bb.Results[Fc].SheetCell.SheetName){Vd=Bb.Results[Fc];break}Vd||t.ULS.sendTraceTag(507384588,0,15,"FindOperationsCache.searchForNextResultInPrefetch: Nothing found in findAll cached results")}}return Vd}O0f(Bb,pc){const wc=pc.top-1===Bb.FirstRow&&pc.left-1<Bb.FirstColumn;return pc.top-1<Bb.FirstRow||wc}Ahg(Bb){return da.EwaSettings.CY()&&Bb.wka&&Bb.findData.SearchAllSheets&&void 0!==Bb.findData.SheetName?(Bb=Bb.Bff(),Bb.findData.SheetName=
void 0,Bb):Bb}CBi(Bb){if(da.EwaSettings.CY())this.HFa=this.HFa.filter(pc=>pc.dQ.stateID===Bb);else{const pc=[];for(const wc of this.nWa.keys())wc.stateID!==Bb&&pc.push(wc);for(const wc of pc)this.nWa.delete(wc)}}oOg(Bb){Bb=this.Ahg(Bb);for(let pc=0;pc<this.HFa.length;pc++)if(this.HFa[pc].dQ.equals(Bb))return pc}};dd=Object(u.__decorate)([Object(Oa.d)(Ha.FindOperationsCacheService),Object(u.__param)(0,Object(Ha.EwaControlService)())],dd);Object(l.a)(dd,"FindOperationsCache",null,[4]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Find");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ShareSection");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SpellCheck");Type.registerNamespace("_Ewa");a(1566);a(1568);da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveRequireFromSlices",!1)||a(1570);String(c);String(b);String(f);String(k);String(x);String(d);String(h);String(m);String(n);window.___1717508060490_closurehack=c;window.___1717508060490_closurehack=b;window.___1717508060490_closurehack=f;window.___1717508060490_closurehack=
k;window.___1717508060490_closurehack=x;window.___1717508060490_closurehack=d;window.___1717508060490_closurehack=h;window.___1717508060490_closurehack=m;window.___1717508060490_closurehack=n}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.nav.js.map/096ecccc4e1e860335d46961cf8636d6/EwaTS.nav.js.map