'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[1],{1058:function(y,r,a){a.d(r,"a",function(){return b});y=a(0);r=a(938);var c=a(83);class b extends r.a{constructor(f,k,x){super(f,k);this.es=!0;this.command=x}Hl(f){super.Hl(f);this.businessBar.$.Ia.Gb(new c.a(this.command,f,this.businessBar.$.xc,10,null))}}Object(y.a)(b,"CommandActionBusinessBarEntry",r.a,[])},106:function(y,r,a){function c(H){return H.includes("aadInteractionRequired")||H.includes("sessionRevocation")||
H.includes("blockAccessForTenantRestrictions")||H.includes("revoked")||H.includes("Due to organizational policies, you can't access these resources from this network location")?!0:!1}function b(){return ta.AFrameworkApplication.ea?ta.AFrameworkApplication.ea.ka("WopiTokenRevokedTokenExperiment")&&ta.AFrameworkApplication.ea.ka("ShowTokenRevocationErrorMessage"):!1}function f(){return ta.AFrameworkApplication.ea?ta.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldAttributeGatekeeperCookieMismatch",
!1):!1}async function k(H,ha){if(Object(tf.l)(H.la)){const Ya=H.la.sheetProcessedData;Object(Ee.a)(Ya);return 0<ha.map(Wb=>Sd(Wb,!0)).filter(Wb=>Ya.value.wda(Wb)).length}return!1}function x(H,ha,Ya,Wb){const Sc=new Map;if(0===Wb.size)return Sc;if(!Object(tf.l)(H.la))return Z.ULS.sendTraceTag(507568209,0,15,"Grid.getFormulasPointingToRange Unable to get activeItem."),Sc;if(H.la.sheetId===Ya){const zd=Object(Hd.f)(H);Ya=zd.za.lv();const be=H.la.sheetName;Ya.forEach(oe=>{var Ke;if(oe.la.sheetName===
be){const Xe=zd.$.workbookContext.WorkbookFileName;(oe=null===(Ke=oe.Nf)||void 0===Ke?void 0:Ke.getCalcBlockModel())?d(ha,oe,be,Xe,Wb).forEach(ig=>{const Og=Sc.get(ig.xEe)||new Set;Og.add(ig.Hfh);Sc.set(ig.xEe,Og)}):Z.ULS.sendTraceTag(507597516,0,15,"Grid.getFormulasPointingToRange Unable to get CalcBlockModel.")}})}return Sc}function d(H,ha,Ya,Wb,Sc){const zd=new Set;if(H){var be=ha.getRowNumbers(),oe=ha.getColumnNumbers();be=be[0];oe=oe[0];ha.reset();let Ke=null;for(;Ke=ha.getNextCell();)if(Object(oc.f)(Ke.formula)){const Xe=
H.extractReferences(Ke.formula,Ya,Wb,!0);if(Xe){const ig=new Te.Range(Ke.row+be,Ke.col+oe,Ke.row+be,Ke.col+oe,!1,!1);for(const Og of Xe.Items){const mg=Object(ra.G)(Og.Range);Sc.forEach(ih=>mg.Xe(ih)?zd.add({xEe:ig,Hfh:ih}):null)}}}}else Z.ULS.sendTraceTag(507597515,0,15,"Grid.getInBlockFormulasPointingToRange Unable to get calcManager.");return zd}function h(H){switch(H){case 0:return 1;case 2:return 2;case 1:return 4;default:throw Z.ULS.sendTraceTag(508559903,0,10,`ConvertExtraSpacesTypeToTrimWhitespaceType: Unknown ExtraSpacesPaddingType ${H}`),
Error.argument("illegal ExtraSpacesPaddingType");}}async function n(H,ha,Ya,Wb,Sc){const zd=Object(ra.x)(H.activeItemName,null,ha),{A$d:be,z$d:oe,gbe:Ke}=l();Object(ub.a)(H.userOperationManager,(Xe,ig,Og)=>Bb.E(H.ma.sa,Sc,zd,Wb,Object(Ic.c)(Xe,be),Object(Ic.b)(ig,oe),Og,null),Xe=>new Fc.a(258,0,Xe),null);await Ke;return Ya.length}async function m(H,ha,Ya){const Wb=Object(ra.x)(H.activeItemName,null,ha),Sc=H.ma.sa.mc({hla:!0,lka:1}),{A$d:zd,z$d:be,gbe:oe}=l();Object(ub.a)(H.userOperationManager,(Ke,
Xe,ig)=>se.l(H.ma.sa,Wb,Object(ra.r)(Hd.f(H).ha.oa.activeCell,H),Ya,!1,null,null,!0,!1,Object(Ic.c)(Ke,zd),Object(Ic.b)(Xe,be),ig,null,Sc,null),Ke=>new Fc.a(11,0,Ke),null);await oe;return-1}async function u(H,ha,Ya){const Wb=Object(ra.x)(H.activeItemName,null,ha),{A$d:Sc,z$d:zd,gbe:be}=l(),oe=Ya.reduce((Ke,Xe)=>Ke|Xe,0);Object(ub.a)(H.userOperationManager,(Ke,Xe,ig)=>{var Og=H.ma.sa;Ke=Object(Ic.c)(Ke,Sc);Xe=Object(Ic.b)(Xe,zd);const mg=Og.$a(9,null);mg.ranges=Wb;mg.trimWhitespaceType=oe;return se.h(Og,
"TrimWhitespace",mg,Ke,Xe,ig,null,0)},Ke=>new Fc.a(253,0,Ke),null);({Result:ha}=await be);return ha}function l(){const H=new Cc.a;return{A$d(ha){ha&&eb.a.zf(ha.Errors)?(Z.ULS.sendTraceTag(509617682,0,10,"DataCleansing onOperationSuccess: Ewa result contains error messages after applying"),H.setResult(null)):ha?(Z.ULS.sendTraceTag(537163359,0,20,"DataCleansing onOperationSuccess: Suggestion applied successfully"),H.setResult(ha)):(Z.ULS.sendTraceTag(508424517,0,10,"DataCleansing onOperationSuccess: Ewa result is null after applying"),
H.setResult(null))},z$d(ha){Z.ULS.sendTraceTag(509617681,0,10,`DataCleansing onOperationFailed: Ewa result contains error messages HttpStatus [${ha.data.httpStatus}]`);H.setResult(null)},gbe:Qe.e(H.task)}}function t(H){if(tf.l(H.la))return H.la.sheetId;Z.ULS.sendTraceTag(507070211,0,50,"getActiveSheetId: active item is not a sheet.")}function e(H,ha){var Ya;return null===(Ya=H.qa.items.find(Wb=>tf.l(Wb)&&Wb.sheetId===ha))||void 0===Ya?void 0:Ya.sheetName}function w(H,ha){H=H.qa.items.find(Ya=>tf.l(Ya)&&
Ya.sheetId===ha);pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8994627_DataCleansingMinorCodeImprovements")&&!H&&Z.ULS.sendTraceTag(507064524,0,20,`Sheet.getSheet: sheet not found. sheetId:[${ha}]`);return H}function z(H){if(H){var ha=H.visible;return{isInNamedSheetView:H.ue.Bq,isProtected:H.Ih,sheetId:H.sheetId,sheetName:H.sheetName,isHidden:pd.EwaSettings.isChangeGateEnabled("OfficeVSO:9009903_DataCleansingFixHiddenSheetBug")?!ha:void 0}}}function E(H){if(!H)return!1;H=H.sheetProcessedData;return Object(Ee.d)(H)||
"PartialResult"===(null===H||void 0===H?void 0:H.reason)?!1:!0}function M(){const H=new EventTarget;return{addEventListener:function(ha,Ya,Wb){H.addEventListener(ha,Sc=>{Ya(Sc)},{signal:null===Wb||void 0===Wb?void 0:Wb.signal,once:null===Wb||void 0===Wb?void 0:Wb.once})},dispatchEvent:function(ha,Ya){H.dispatchEvent(new CustomEvent(ha,{detail:Ya}))}}}function G(H){const ha=new Qj.a;ha.hc=4;ta.AFrameworkApplication.ea.ka("IsNewStringEnabled")?(H=CommonUiStrings.AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+
String.format(CommonUiStrings.AppsForOfficeDeveloperManifestUrl,H)+CommonUiStrings.AppsforOfficeLoadManifestUrl,ha.XR(CommonUiStrings.AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,H,qm)):(H=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,H)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl,ha.XR(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,H,qm))}a.r(r);var A={};a.r(A);
a.d(A,"EwaAccessTokenExpirationManager",function(){return Wc});var N={};a.r(N);a.d(N,"AutoAdjustColumnsManager",function(){return wc});var K={};a.r(K);a.d(K,"EwaCoauthManager",function(){return bd});var I={};a.r(I);a.d(I,"RenameFileManager",function(){return xf});var L={};a.r(L);a.d(L,"BlockPrefetcher",function(){return zf});var J={};a.r(J);a.d(J,"BrowserCachedVersionsManager",function(){return Wd});var B={};a.r(B);a.d(B,"CalcInterfaceAdapter",function(){return Bc});var Y={};a.r(Y);a.d(Y,"CalcManager",
function(){return Qb});var U={};a.r(U);a.d(U,"CoreScriptsPrefetcher",function(){return id});var O={};a.r(O);a.d(O,"DataCleansingHostManager",function(){return zh});var C={};a.r(C);a.d(C,"EnrichmentTaskPane",function(){return Tf});var X={};a.r(X);var S={};a.r(S);a.d(S,"ExtendedTooltipsManager",function(){return lg});var ea={};a.r(ea);a.d(ea,"FilteredResultsStatusBarManager",function(){return hg});var Oa={};a.r(Oa);a.d(Oa,"FirstRunExperienceManager",function(){return ie});var Ha={};a.r(Ha);a.d(Ha,"HeaderSnappingFeature",
function(){return kf});var Za={};a.r(Za);a.d(Za,"InProductMessagingManagerFactory",function(){return tg});var fa={};a.r(fa);a.d(fa,"InstantaneousSupportInformationManager",function(){return xg});var la={};a.r(la);a.d(la,"NavigationFailHandler",function(){return nh});var ba={};a.r(ba);a.d(ba,"NetworkConnectionStateManager",function(){return W});var aa={};a.r(aa);a.d(aa,"WiseNextVersionScriptsPrefetcher",function(){return Fg});var oa={};a.r(oa);var Na={};a.r(Na);a.d(Na,"ProactiveSuggestionDebugToolsManager",
function(){return Eh});var Ia={};a.r(Ia);a.d(Ia,"ProactiveSuggestionManager",function(){return ri});var Sa={};a.r(Sa);a.d(Sa,"ReactTaskPaneManager",function(){return Ch});var Pa={};a.r(Pa);a.d(Pa,"SdxManifestPrefetcher",function(){return Di});var za={};a.r(za);a.d(za,"SharedUIControlsFactory",function(){return ui});var wa={};a.r(wa);a.d(wa,"SheetProcessedDataPrefetcher",function(){return Xi});var db={};a.r(db);a.d(db,"StatusBarAggregateManager",function(){return aj});var Ba={};a.r(Ba);a.d(Ba,"ThemesManager",
function(){return xi});var Ka={};a.r(Ka);a.d(Ka,"UnifiedConsentAdapter",function(){return Nh});var da={};a.r(da);a.d(da,"ViewportObserver",function(){return yi});var sa={};a.r(sa);a.d(sa,"ViewportTelemetryManager",function(){return Yc});var mb={};a.r(mb);a.d(mb,"ZoomEventManager",function(){return jd});var Ma={};a.r(Ma);a.d(Ma,"ZoomManager",function(){return Bj});var hb={};a.r(hb);a.d(hb,"FullScreenStatusBarManager",function(){return Oj});var $a={};a.r($a);var Va={};a.r(Va);a.d(Va,"GetObserverChartFromHostAndInsertManager",
function(){return Ld});var xa={};a.r(xa);a.d(xa,"WarmupScheduler",function(){return me});var ia=a(0),Z=a(15),ta=a(6),pa=a(298);class Ga{constructor(){this.XXe=this.kjd=!1;this.n2a=()=>{pa.a.instance.dje(this.n2a);Z.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.i$i()};this.Fsg=()=>{pa.a.instance.cje(this.Fsg);this.XXe||this.kjd||(Z.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.XXe=!0,this.gXk())};const H=ta.AFrameworkApplication.accessTokenTtl;
0>=H||(this.accessTokenTtl=H,Z.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.accessTokenTtl,["NowGetTime"]:(new Date).getTime(),["BootTime"]:ta.AFrameworkApplication.PM}),pa.a.instance.bpd(this.n2a),pa.a.instance.$od(this.Fsg))}i$i(){this.kjd||(ta.AFrameworkApplication.Wy(28),this.kjd=!0,this.fXk())}Jod(){throw Error("Method not implemented.");}AHg(){throw Error("Method not implemented.");}}Object(ia.a)(Ga,"ASessionExpirationManager",null,[]);
var Ca=a(91),kb=a(41),eb=a(36),Yb=a(13),Gb=a(45),Mb=a(283),Rb=a(8),$b=a(89),cc=a(287),fb=a(76),Sb=a(65),kc=a(5),na=a(254),fc=a(141),Cc=a(182),tc=a(154),nb=a(363);class tb{}Object(ia.a)(tb,"Error",null,[]);class La{}Object(ia.a)(La,"NamedResult",null,[]);class wb extends La{}Object(ia.a)(wb,"ErrorInfo",La,[]);var Wa=a(125);class Fa{constructor(H){this.Dr={};this.h5={};this.ish={};this.qag=15;this.XPe=!1;this.Vth=new Date;this.wfc=new Date;this.pbh=()=>{Z.ULS.sendTraceTag(41964821,217,50,Z.ULS.Nc({["Aggregate"]:this.h5,
["Current"]:this.Dr}))};this.Ve=H;this.cjc=new Wa.a(2,2,6E4*this.qag,this.pbh,135,"SL",!1);this.Ve.Ag(this.cjc);this.eij()}eij(){this.h5.RequestGroups=0;this.h5.Requests=0;this.h5.Responses=0;this.h5.Status="Initialized";this.h5.FirstActivity=new Date;this.h5.SessionDuration=0;this.h5.ActivityDuration=0;this.h5.SessionDuration=0;this.Dr.SessionDuration=0;this.h5.ActivityDuration=0;this.Dr.ActivityDuration=0}cTd(H,ha){var Ya=H[ha];Ya=Ya?Ya:0;Ya++;H[ha]=Ya;this.kpe(H)}kpe(H){const ha=new Date;H.ActivityDuration=
+ha-+this.wfc;this.wfc=ha;H.SessionDuration=+this.wfc-+this.Vth;H.LastActivity=this.wfc}U9(H,ha){this.Dr[H]=ha;this.kpe(this.Dr)}Poe(H,ha){this.Dr[H]=ha;this.kpe(this.Dr)}incrementCounter(H){this.cTd(this.Dr,H);this.cTd(this.h5,H);this.cTd(this.ish,H)}flush(){this.XPe||(this.h5.Status=this.Dr.Status,this.pbh(this.cjc),this.Ve.H9(this.cjc,6E4*this.qag))}stop(){Z.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.XPe=!0;this.Ve.Xr(this.cjc)}}Object(ia.a)(Fa,
"SessionLogger",null,[290]);class Da{constructor(H,ha){this.pjc=H;this.hP=ha}get tokens(){return this.pjc}get errors(){return this.hP}}Object(ia.a)(Da,"TokenRefreshArgs",null,[269]);var ja=a(103),Qa=a(612),Ob=a(538),Ub=a(189),Zb=a(136),uc=a(1098),Hc=a(366),Dd=a(256),jc=a(1113),$c=a(672);class ud{constructor(H,ha,Ya,Wb,Sc,zd,be,oe,Ke,Xe,ig){Wb=void 0===Wb?null:Wb;Sc=void 0===Sc?!1:Sc;zd=void 0===zd?null:zd;be=void 0===be?!1:be;oe=void 0===oe?!1:oe;Ke=void 0===Ke?!1:Ke;Xe=void 0===Xe?!1:Xe;ig=void 0===
ig?!1:ig;this.eha=0;this.X_=this.Ik=null;this.pjc=new na.a;this.hP=new na.a;this.Wm=null;this.mBa=!1;this.lEb=this.mEb=null;this.Zxk=()=>{this.BJg()};Object(jc.a)()||(this.Ve=H,this.sVe=ha,this.sVe.execute(Og=>{Og.ik(Zb.a.nSd,Object(fc.a)(this,this.X_j,"onHostResponseReceived"))}),this.DM=Ya,this.d_e=new uc.a("WebServiceCall","TokenRefresh"),this.Ql=Wb||new Fa(H),this.Qth=Sc,this.JS=zd?zd:Qa.SessionStatusManager.instance,this.xLe=be,this.Bdc=oe,this.cuh=Ke,this.duh=Xe,this.pYe=ig,this.C9a=$c.a.getInstance({Fia:"wwrelfc",
featureName:"TokenRefreshManager",Dcb:"Infrastructure"}))}X_j(H){if(H.MessageId!==Zb.a.nSd)Z.ULS.sendTraceTag(39408099,217,15,"Unexpected message.");else{var ha=new na.a,Ya=new na.a;this.Ql.incrementCounter("Responses");var Wb=H.Values.Tokens;if(!Wb||0>=Wb.length)Z.ULS.sendTraceTag(40122317,217,15,"Found no tokens in the dictionary"),Wb=H.Values;this.Ql.U9("Correlation",H.CorrelationId);var Sc="";for(let Ke=0;Ke<Wb.length;Ke++){this.Ql.Poe("Tokens",Wb.length);var zd=Wb[Ke],be=zd;if(be&&be.Name){this.Ql.incrementCounter(be.Name);
var oe=zd;if(oe&&oe.Value)ha.add(oe),this.pjc.add(oe),this.Bdc||this.Ql.U9("Status","Success"),this.xLe&&this.JS&&this.JS.Syk();else{if(this.aVg){oe=zd;zd=Object.assign(new wb,{Name:oe.Name,Errors:[],SPCorrelationId:oe.SPCorrelationId});for(const Xe of oe.Errors)oe=new tb,oe.Id=Xe.Id,oe.Details=Ob.a.Mta(Xe.Details,500),zd.Errors.push(oe)}else zd=this.e0i(zd);Z.ULS.sendTraceTag(39408129,217,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",be.Name,JSON.stringify(zd),this.X_);
Ya.add(zd);this.Bdc||(this.hP.add(zd),Sc=JSON.stringify(zd),this.Ql.U9("Error",JSON.stringify(zd)),this.Ql.U9("Status","Failed"));if(this.xLe)for(const Xe of zd.Errors){if(this.aVg)if(be=28,zd=parseInt(Xe.Id),oe=Xe.Details.toString(),isNaN(zd))be=75;else{switch(zd){case 401:be=78;b()&&c(oe)?be=79:f()&&oe.includes("GatekeeperCookieMismatch")&&(be=81);break;case 403:be=73;b()&&c(oe)?be=79:f()&&oe.includes("GatekeeperCookieMismatch")&&(be=81);break;case 404:ta.AFrameworkApplication.ea&&ta.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdatePermanentErrorList",
!1)&&(be=82);break;case 500:be=74;break;case 503:be=77}28===be&&(be=500<zd?76:72)}else be=this.$Pi(Xe);this.JS&&this.JS.eCh(be)}}}}this.Bdc?(0<Ya.count?this.lEb?this.lEb(new Da(ha,Ya)):Z.ULS.sendTraceTag(512267295,217,15,"Received errors but the promise has completed.TaskId {0}, IsSessionExpired: {1}, IsTokenExpiring: {2}, Error: {3}",this.X_,this.JS.NFc,this.mBa.toString(),Sc):this.mEb?this.mEb(new Da(ha,Ya)):Z.ULS.sendTraceTag(512267294,217,15,"Received valid tokens but the promise has completed. TaskId {0}, IsSessionExpired: {1}, IsTokenExpiring: {2}",
this.X_,this.JS.NFc,this.mBa.toString()),Z.ULS.sendTraceTag(512344162,217,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",ha.count,Ya.count,H.CorrelationId,this.X_)):(0<Ya.count&&""!==Sc?(Wb=Object.assign({},{extendedProperties:new Map}),Wb.extendedProperties.set("Errors",Sc),Wb.extendedProperties.set("RetryCount",this.eha.toString()),Wb.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),Wb.extendedProperties.set("IsTokenExpiring",
this.mBa.toString()),Wb.extendedProperties.set("IsAppShuttingDown",ta.AFrameworkApplication.Sf.toString()),this.Mub?(Wb.extendedProperties.set("SkipAria","false"),Wb.extendedProperties.set("TokenRefreshCorrelationId",H.CorrelationId),this.C9a.Hda({Po:"WACTokenRefresh",errorName:"TokenRefreshFailed",xe:{pXd:!1,isInternal:!1,MJ:Wb}})):ja.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,Wb)):this.Mub?(Sc=Object.assign({},{extendedProperties:new Map}),Sc.extendedProperties.set("SkipAria",
"false"),Sc.extendedProperties.set("TokenRefreshCorrelationId",H.CorrelationId),this.C9a.ala({Po:"WACTokenRefresh",xe:{MJ:Sc}})):ja.Health.instance.recordKpiSuccess("WACTokenRefresh",null),Z.ULS.sendTraceTag(39408130,217,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",ha.count,Ya.count,H.CorrelationId,this.X_),0<Ya.count&&!this.lVb(Ya)?(H=this.DM.ZMf(Ya),H!==this.DM.Rsb&&(this.Ql.Poe("RetryOverride",H),this.Ve.H9(this.Ik,H))):(this.Ql.flush(),this.Ik&&this.Ve.Xr(this.Ik),
this.Wm&&!this.Wm.task.isCompleted?this.Wm.setResult(new Da(ha,Ya)):Z.ULS.sendTraceTag(512267293,217,15,"Received results but the task has completed")))}}e0i(H){if(!H)return null;const ha=Object.assign(new wb,{Name:H.Name,Errors:[],SPCorrelationId:H.SPCorrelationId});for(const Ya of H.Errors)H=new tb,H.Id=Ya.Id,H.Details=Ob.a.Mta(Ya.Details,500),ha.Errors.push(H);return ha}BJg(){Dd.a.tt("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");if(this.eha>=this.DM.Ceg)Z.ULS.sendTraceTag(39408132,
217,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.X_),this.akf(this.Wm,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts");else{var H=Ub.a.create().toString();if(this.Mub){const ha=new Map;ha.set("SkipAria","false");ha.set("TokenRefreshCorrelationId",H);this.C9a.J8({Po:"WACTokenRefresh",Umb:Hc.b.SuccessBased,xe:{extendedProperties:ha}})}else ja.Health.instance.recordKpiUsage("WACTokenRefresh",Hc.b.SuccessBased,"wwrelfc",
null);this.OOg(H)}}OOg(H){const ha={};ha.Tokens=this.DM.tokens;this.cuh&&(ha.AllowAADPopup=this.duh);Z.ULS.sendTraceTag(39408133,217,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.DM.tokens),this.eha+1,H,this.X_);this.sVe.execute(Ya=>{Ya.sendMessage(Zb.a.l7e,ha,H)});this.eha++;this.Ql.incrementCounter("Requests")}akf(H,ha,Ya){const Wb=new na.a;for(let Sc=0;Sc<this.DM.tokens.length;Sc++){const zd=Object.assign(new wb,{Name:this.DM.tokens[Sc],Errors:[Object.assign(new tb,
{Id:ha,Details:Ya})]});Wb.add(zd);this.hP.add(zd)}this.Ve.Xr(this.Ik);this.Ql.U9("Errors",JSON.stringify(this.hP));this.Ql.U9("Status","Failed");H&&!H.task.isCompleted&&H.setResult(new Da(new na.a,this.hP))}gnk(H,ha){ha=void 0===ha?null:ha;Dd.a.tt("ej4if276;fheca743");Dd.a.tt("5d4fi128;abe10395");Dd.a.tt("7db39907;cegi0367;ijicc640");this.d_e.start();this.Ve.lYa&&(Z.ULS.sendTraceTag(508351137,217,15,"Restarting taskmanager, is shutting down {0}",ta.AFrameworkApplication.Sf),this.Ve.w4b());this.mBa=
H;this.X_=Ub.a.create().toString();Z.ULS.sendTraceTag(41755338,217,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.X_,this.mBa);this.eha=0;this.hP.clear();this.pjc.clear();const Ya=new Cc.a;this.Wm=Ya;ha&&ha.R(()=>{const Wb=!!Ya&&!Ya.task.isCompleted;Z.ULS.sendTraceTag(588096223,217,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",this.X_,this.mBa,Wb);Wb&&this.akf(Ya,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});
this.Bdc?this.CJg(this.DM.Ceg).then(Wb=>{this.Wm&&!this.Wm.task.isCompleted&&this.Wm.setResult(Wb);this.lEb=this.mEb=null;this.Ql.U9("Errors",JSON.stringify(this.hP));this.Ql.U9("Status","Success");this.Ql.flush()}).catch(Wb=>{this.Wm&&!this.Wm.task.isCompleted&&this.Wm.setResult(Object(tc.a)(269,Wb));this.lEb=this.mEb=null;this.Ql.U9("Errors",JSON.stringify(this.hP));this.Ql.U9("Status","Failed");this.Ql.flush()}):(this.Ik=new Wa.a(this.DM.priority,2,this.DM.Rsb,this.Zxk,98,Zb.a.l7e,!0),this.Qth&&
this.BJg(),this.Ve.Ag(this.Ik));return this.Wm.task}CJg(H){const ha=this,Ya=Ub.a.create().toString(),Wb=new Promise((Ke,Xe)=>{ha.mEb=Ke;ha.lEb=Xe;this.Mub?(Ke=new Map,Ke.set("SkipAria","false"),Ke.set("TokenRefreshCorrelationId",Ya),this.C9a.J8({Po:"WACTokenRefresh",Umb:Hc.b.SuccessBased,xe:{extendedProperties:Ke}})):ja.Health.instance.recordKpiUsage("WACTokenRefresh",Hc.b.SuccessBased,"wwrelfc",null);ha.OOg(Ya)}),Sc=this,zd=new Promise((Ke,Xe)=>{window.setTimeout(()=>{Xe(Sc.ekf("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},
Sc.DM.Rsb)});let be=H;const oe=this;return new Promise((Ke,Xe)=>{be--;Promise.race([Wb,zd]).then(ig=>{if(this.Mub){const Og=Object.assign({},{extendedProperties:new Map});Og.extendedProperties.set("SkipAria","false");Og.extendedProperties.set("TokenRefreshCorrelationId",Ya);this.C9a.ala({Po:"WACTokenRefresh",xe:{MJ:Og}})}else ja.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Ke(ig)}).catch(ig=>{var Og=oe.DM.Rsb;if(Object(nb.a)(269,ig)&&(ig=Object(tc.a)(269,ig),0<ig.errors.count)){oe.iFj(ig.errors,
Ya);oe.Yt(ig.errors);if(oe.lVb(ig.errors)){Xe(ig);return}const mg=oe.DM.ZMf(ig.errors);mg!==oe.DM.Rsb?(oe.Ql.Poe("RetryOverride",mg),Og=mg):oe.$xj(ig.errors)&&(Og=0)}be?window.setTimeout(()=>{oe.CJg(be).then(Ke).catch(Xe)},Og):(Og=oe.ekf("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),oe.Yt(Og.errors),Xe(Og),Z.ULS.sendTraceTag(512267292,217,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",oe.X_))})})}Yt(H){for(const ha of H)this.hP.add(ha)}$xj(H){if(!H.count)return!1;
H=H.pa(H.count-1);return H.Errors.length?"TIMEOUT"==H.Errors[0].Id:!1}ekf(H,ha){const Ya=new na.a;for(let Wb=0;Wb<this.DM.tokens.length;Wb++){const Sc=this.u7h(this.DM.tokens[Wb],H,ha);Ya.add(Sc)}return new Da(new na.a,Ya)}u7h(H,ha,Ya){return Object.assign(new wb,{Name:H,Errors:[Object.assign(new tb,{Id:ha,Details:Ya})]})}iFj(H,ha){if(H.count){H=H.pa(H.count-1);H=JSON.stringify(H);var Ya=Object.assign({},{extendedProperties:new Map});Ya.extendedProperties.set("Errors",H);Ya.extendedProperties.set("RetryCount",
this.eha.toString());Ya.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());Ya.extendedProperties.set("IsTokenExpiring",this.mBa.toString());Ya.extendedProperties.set("IsAppShuttingDown",ta.AFrameworkApplication.Sf.toString());this.Mub?(Ya.extendedProperties.set("SkipAria","false"),Ya.extendedProperties.set("TokenRefreshCorrelationId",ha),this.C9a.Hda({Po:"WACTokenRefresh",errorName:"TokenRefreshFailed",xe:{MJ:Ya}})):ja.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",
!1,!1,Ya);this.Ql.U9("Error",H);this.Ql.U9("Status","Failed")}}xgk(H){this.d_e.stop();const ha=this.raj(H.result.errors);Z.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!ha,this.X_,this.mBa,this.eha,this.hP.count,0<H.result.errors.count?H.result.errors.pa(0).Name:"",0<H.result.errors.count&&0<H.result.errors.pa(0).Errors.length?H.result.errors.pa(0).Errors[0].Id:
"",0<H.result.errors.count&&0<H.result.errors.pa(0).Errors.length?H.result.errors.pa(0).Errors[0].Details:"");return ha?!1:this.wgk(H.result.tokens)}lVb(H){return this.DM.lVb(H)}wgk(H){for(let ha=0;ha<H.count;ha++){const Ya=H.pa(ha);if("AccessToken"===Ya.Name){const Wb=(new Date).getTime();Ya.Expiry>ta.AFrameworkApplication.accessTokenTtl?(Z.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:Ya.Expiry,["NowGetTime"]:Wb,["BootTime"]:ta.AFrameworkApplication.PM},"PreviousAccessTokenTtl",
ta.AFrameworkApplication.accessTokenTtl),ta.AFrameworkApplication.accessToken=Ya.Value,ta.AFrameworkApplication.accessTokenTtl=Math.floor(Ya.Expiry),ta.AFrameworkApplication.h8a=Wb,ta.AFrameworkApplication.sha=Math.floor(Ya.Expiry)):Z.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:Ya.Expiry,["NowGetTime"]:Wb,["BootTime"]:ta.AFrameworkApplication.PM},"PreviousAccessTokenTtl",ta.AFrameworkApplication.accessTokenTtl)}}return!0}raj(H){let ha=
!1;for(let Ya=0;Ya<H.count;Ya++){ha=!0;const Wb=H.pa(Ya);Z.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2}, SPCorrelationId: {3}",Wb.Name,JSON.stringify(Wb.Errors),this.X_,Wb.SPCorrelationId)}return ha}M5f(H){return H.includes("aadInteractionRequired")||H.includes("sessionRevocation")||H.includes("blockAccessForTenantRestrictions")||H.includes("revoked")||H.includes("Due to organizational policies, you can't access these resources from this network location")?
!0:!1}V0f(H){return H.includes("GatekeeperCookieMismatch")}$Pi(H){let ha=28;const Ya=parseInt(H.Id);H=H.Details.toString();if(isNaN(Ya))ha=75;else{switch(Ya){case 401:ha=78;this.pYe&&this.M5f(H)?ha=79:this.oUg&&this.V0f(H)&&(ha=81);break;case 403:ha=73;this.pYe&&this.M5f(H)?ha=79:this.oUg&&this.V0f(H)&&(ha=81);break;case 404:this.tse&&(ha=82);break;case 500:ha=74;break;case 503:ha=77}28===ha&&(ha=500<Ya?76:72)}return ha}get Mub(){return null!=this.rGe?this.rGe:this.rGe=ta.AFrameworkApplication.ea?
ta.AFrameworkApplication.ea.isChangeGateEnabled("Microsoft.Office.WordOnline.ChangeGate.ShouldUseNewKPIApiForTokenRefresh"):!1}get aVg(){return null!=this.nGe?this.nGe:this.nGe=ta.AFrameworkApplication.ea?ta.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldRefactorProcessingTokenRefreshError",!1):!1}get oUg(){return null!=this.mGe?this.mGe:this.mGe=ta.AFrameworkApplication.ea?ta.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldAttributeGatekeeperCookieMismatch",
!1):!1}get tse(){return null!=this.pGe?this.pGe:this.pGe=ta.AFrameworkApplication.ea?ta.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdatePermanentErrorList",!1):!1}}Object(ia.a)(ud,"TokenRefreshManager",null,[281]);class Ud{constructor(){this.Rsb=ta.AFrameworkApplication.Ikl;this.Ceg=ta.AFrameworkApplication.Gkl;this.tokens=ta.AFrameworkApplication.N5i();this.priority=ta.AFrameworkApplication.vCe;this.FWe=this.iMk();this.lbb=ta.AFrameworkApplication.M5i()}lVb(H){if(this.OTk){var ha=
[];for(const Wb of H)if(Wb.Errors)for(const Sc of Wb.Errors)ha.push(Sc.Id);H=JSON.stringify(ha);if(this.lbb&&0<this.lbb.length)for(var Ya of this.lbb)if(0<Ya.length&&0<=H.indexOf(Ya))return!0}else if(Ya=JSON.stringify(H),this.lbb&&0<this.lbb.length)for(ha of this.lbb)if(0<ha.length&&0<=Ya.indexOf(ha))return!0;return!1}ZMf(H){try{if(H)for(const ha of H)if(ha.Errors)for(const Ya of ha.Errors)if(Ya.Id in this.FWe)return Number.parseInvariant(this.FWe[Ya.Id].toString())}catch(ha){Z.ULS.sendTraceTag(41501720,
217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",ha.toString())}return this.Rsb}iMk(){const H={};try{if(!ta.AFrameworkApplication.JBc()||0>=ta.AFrameworkApplication.JBc().length||""===ta.AFrameworkApplication.JBc()[0])return H;for(const ha of ta.AFrameworkApplication.JBc())0<ha.length&&(H[ha]=ta.AFrameworkApplication.Hkl)}catch(ha){Z.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",ha.toString())}return H}get OTk(){return null!=
this.qGe?this.qGe:this.qGe=ta.AFrameworkApplication.ea?ta.AFrameworkApplication.ea.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ShouldUseErrorsForParsingPermanentErrors"):!1}}Object(ia.a)(Ud,"TokenRefreshPolicy",null,[258]);var ec=a(2),Db=a(78),ic=a(791),Pc=a(33);class Ed{constructor(H,ha){this.I2b=!1;this.correlationID=H;this.Rzd=ha;this.o1c=!1;this.creationTime=Pc.a.zb.Jc}}Object(ia.a)(Ed,"RefreshAccessTokenContext",null,[]);var de=a(58),se=a(61),Fe=a(183),fe=a(53),Tc=a(129),ed=
a(145),pd=a(1),Kb=a(28),rb=a(168),rc=a(38),ld=a(111);class Tb{constructor(H,ha){this.documentVisibilityObserver=null;this.ub=new kb.a;this.zH=null;this.y6a=this.fab=!1;this.ZSc=null;this.Q2b=!1;this.D3d=!0;this.ded=this.fQe=this.zz=this.jEb=!1;this.q_=null;this.b3g=this.Sf=!1;this.RRa=0;this.GRf=()=>{if(this.$.fa.yc)this.dSf(!1);else if(this.D3d){this.D3d=!1;const Ya=fb.a(this.$);Z.ULS.sendTraceTag(537170709,0,50,`EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [${Ya.ek?
Ya.ek.activityName:"None"}] TimeUntilTokenExpirationInMin [${this.z2g()}]`)}};this.yd=(Ya,Wb)=>{this.context&&(Ya=this.$.fa,Wb.nI&&this.context.I2b&&!this.context.o1c?(this.context.o1c=!0,Wb={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},Wb.IsUserActive=Ya.Yf.xp,Wb.RefreshAccessTokenCorrelationID=this.context.correlationID,Wb=de.a.Nc(Wb),Z.ULS.sendTraceTag(537170708,0,50,Wb)):!this.fab||Ya.yc||this.context.Rzd||(Wb={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},
this.zH&&(this.zH.cancel(),Wb.Aborted=!0,Wb.ResetStopRefreshRetriesUntilTokenExpired=!0,this.y6a=!1),Wb.TimeUntilTokenExpirationInMin=this.z2g(),Wb.RefreshAccessTokenCorrelationID=this.context.correlationID,Wb=de.a.Nc(Wb),Z.ULS.sendTraceTag(572019856,0,50,Wb)))};this.jKa=()=>{if(this.context&&this.context.I2b&&!this.context.o1c){var Ya={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};Ya.CreatedForExpired=this.context.Rzd;Ya.RefreshAccessTokenCorrelationID=this.context.correlationID;
Ya.OpenWorkbookErrors=eb.a.pc(this.$.fa.lL);Ya.ExecutionContextErrors=eb.a.pc(fb.a(this.$).Kd.errors);Ya.accesstokenTTL=ta.AFrameworkApplication.accessTokenTtl;Ya=de.a.Nc(Ya);Z.ULS.sendTraceTag(537170707,0,15,Ya)}};this.cSf=()=>{this.y6a=!1;this.dSf(!0)};this.Dae=()=>{this.Q2b&&(this.$.fa.Yf.zLa(this.Dae),this.Q2b=!1);this.HZg()};this.$=H;this.Axe=ha;this.Vge=H.Vb.Pg("WebServiceCall","refreshToken");pa.a.instance.bpd(this.cSf);pa.a.instance.$od(this.GRf);ha=this.$.fa;ha.Vk(this.yd);ha.Dlc(this.jKa);
this.cMj=this.$.ta.MinTokenLifetimeForRegularExpirationPromptInMin;this.eUg=this.$.ta.ShortAccessTokenExpirationPromptSeconds;this.gEg=this.$.ta.RefreshAccessTokenDurationLimitInSec;this.g9g(H.fa.Qvg,ta.AFrameworkApplication.accessTokenTtl);H=JSON.stringify({["AccessTokenTtl"]:ta.AFrameworkApplication.accessTokenTtl,["NowGetTime"]:(new Date).getTime(),["BootTime"]:ta.AFrameworkApplication.PM,["WopiTokenExpiresAfterMinutes"]:ta.AFrameworkApplication.Pza,["WopiTokenTaskItemPriority"]:ta.AFrameworkApplication.vCe});
Z.ULS.sendTraceTag(537170714,217,50,`Initializing EwaAccessTokenExpirationRefreshManager. ${H}`);pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void Sb.a.resolve(kc.DocumentVisibilityObserverService).then(Ya=>{this.documentVisibilityObserver=Ya}):this.$.ra.Vc(291,Ya=>{this.documentVisibilityObserver=Ya})}wKg(){this.y6a=this.fab=this.ded=this.zz=!1;ld.a.Xda=0;ld.a.PU=0;ld.a.QU=0}Hod(H){this.ub.addHandler("SessionExpired",H)}uqa(H){this.ub.addHandler("TokenRefreshed",
H)}lsb(H){this.ub.removeHandler("TokenRefreshed",H)}Jod(){}AHg(){}get yxe(){return this.jEb}get z8(){return this.fQe}get BU(){return this.ded}get context(){return this.q_}get vub(){return this.BU?!1:this.$.fa.Yf.xp?1>ld.a.PU:6>ld.a.QU}get Prb(){return this.fab}ICc(){return pa.a.instance.tI(ta.AFrameworkApplication.accessTokenTtl)}dispose(){pa.a.instance.dje(this.cSf);pa.a.instance.cje(this.GRf);const H=this.$.fa;H&&(H.Qk(this.yd),H.lUc(this.jKa));Ca.a.vb(this.ub);this.documentVisibilityObserver=this.$=
null}z2g(){return this.ICc()?0:(ta.AFrameworkApplication.accessTokenTtl-(new Date).getTime())/6E4}g9g(H,ha){if(0<ha&&!this.ICc()){const Ya=ta.AFrameworkApplication.ea.Rd("AccessTokenExpirationPromptSeconds",ta.AFrameworkApplication.tP),Wb=(ha-H.getTime())/6E4;Z.ULS.shipAssertTag(537170713,0,0<=Wb,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [${ha}] creationTime [${H.getTime()}] tokenLifetimeInMin [${Wb}]`);
Wb<this.cMj?(Z.ULS.sendTraceTag(537170712,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${this.eUg}] tokenLifetimeInMin [${Wb}]`),ta.AFrameworkApplication.tP=this.eUg):ta.AFrameworkApplication.tP!==Ya&&(Z.ULS.sendTraceTag(537170711,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${Ya}] tokenLifetimeInMin [${Wb}]`),ta.AFrameworkApplication.tP=Ya)}}B5h(H){return!this.context||
this.context.I2b||this.context.Rzd!==H?(H=new Ed(Ub.a.create().toString(),H),this.context&&!this.context.o1c&&Z.ULS.sendTraceTag(537170710,0,15,`TokenManager.InitContext: creating new context [${H.correlationID}] although previeous one [${this.context.correlationID}] not used successfully, isPreviousOneRefreshedSuccessfully [${this.context.I2b}] `),this.q_=H,!0):!1}tyk(H){H&&this.zz&&!this.z8&&this.$.fa.Yf.xp&&!this.BU&&(this.zz=!1)}dSf(H){this.tyk(H);if(!(this.fab||this.y6a&&!H||this.zz)&&this.vub){this.fab=
!0;var ha=this.context?this.context.creationTime:null,Ya=this.B5h(H);this.D3d=!0;var Wb=this.$.fa;this.Sf=ta.AFrameworkApplication.Sf;var Sc={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh"};Sc.newContextCreated=Ya;Sc.IsUserActive=Wb.Yf.xp;Sc.IsSessionActive=Wb.yc;Sc.ContainsChangesWorkbookOperations=this.$.userOperationManager.mUa();Sc.isSessionExpired=H;Sc.stopRefreshRetriesUntilTokenExpired=this.y6a;Sc.FailedToRefreshExpiredToken=this.zz;Sc.numOfFailuresWhileUserIsActive=ld.a.PU;
Sc.numOfFailuresWhileUserIsInActive=ld.a.QU;Sc.numOfFailuresWhileOffline=ld.a.Xda;Sc.RefreshAccessTokenCorrelationID=this.context.correlationID;Sc.isShuttingDown=this.Sf;Ya&&ha&&(Sc.TimeInMinFromPreviosContextCreation=Math.round(ed.b(Pc.a.zb,ha)/60));ha=de.a.Nc(Sc);Z.ULS.sendTraceTag(40416199,0,50,ha);if(this.Sf)Z.ULS.sendTraceTag(508126686,0,15,ha);else{this.Vge.start();this.fQe=Wb.Yf.xp;this.zH=new ic.a;this.ACj(H);var zd=this.Axe.gnk(!H,this.zH?this.zH.token:null);zd.continueWith(()=>{this.KYh();
const be=this.Axe.xgk(zd);this.Vge.stop();const oe=this.ICc();if(!be||pd.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&oe){const Ke=zd.result.errors;be&&oe&&this.zzh(Ke);this.H9i(Ke,H)}else this.y6a=!1,this.N9i(zd.result.tokens,H);this.fab=!1},8)}}}zzh(H){const ha=[Object(ec.a)(new tb,{Id:"200",Details:"Expired access token received on successful token request."})];H.add(Object(ec.a)(new wb,{Name:"ExpiredTokenAfterSuccessfulRefresh",Errors:ha}))}ACj(H){H&&(this.$.fa.Yf.xp?
this.HZg():(this.$.fa.Yf.QCa(this.Dae),this.Q2b=!0))}HZg(){this.ZSc=Fe.AsyncMethodContext.Ax(()=>{this.fnk()},1E3*this.gEg,fe.a.Lmk,this.ZSc)}KYh(){this.ZSc&&this.ZSc.cancel();this.Q2b&&(this.$.fa.Yf.zLa(this.Dae),this.Q2b=!1);this.zH=null}fnk(){Z.ULS.sendTraceTag(537170706,0,15,`EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [${this.gEg}]`);this.zH.cancel()}H9i(H,ha){this.y6a=!0;ha&&(this.zz||(this.jEb=this.zz=!0),this.Axe.lVb(H)&&(this.ded=!0));const Ya=
!ha||this.vub&&!ld.a.MYc?40380379:39982555;ha=this.Wjf(ha);ha.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";ha.FailedToRefreshExpiredToken=this.zz;ha.LastErrorIsPermanent=this.BU;if(0<H.count){var Wb=H.pa(0);ha.errorName=Wb.Name;0<Wb.Errors.length&&(ha.ErrorId=Wb.Errors[0].Id,Wb=Wb.Errors[0].Details,ha.ErrorDetails=this.gji(Wb.toString())?"PiiScrubbed":Wb)}ha=de.a.Nc(ha);Z.ULS.sendTraceTag(Ya,0,15,ha);if(0<H.count)for(const Sc of H)if(Sc.Errors)for(const zd of Sc.Errors)"401"===
zd.Id?"GatekeeperCookieMismatch"===zd.Details?this.RRa=2:zd.Details.includes("Due to organizational policies, you can't access these resources from this network location")?this.RRa=1:this.RRa=3:"403"===zd.Id&&(zd.Details.includes("Organizational policy is blocking the request to this endpoint.")?this.RRa=1:this.RRa=4);this.ub.raiseEvent("TokenRefreshed",new Da(null,H))}gji(H){return Kb.a.contains(H,"makes the internet safe for businesses",!0)}Wjf(H){const ha={},Ya=this.$.fa;ha.Name="";ha.IsUserActive=
Ya.Yf.xp;ha.IsSessionActive=Ya.yc;ha.GotDeploymentOrTimedOutError=Ya.G7;ha.TimeInSecFromLastStatefulSuccessfulRequest=Ya.I4;ha.TimeFromLastUserActivityInMs=Ya.Yf.Rvb;ha.calledFromSessionExpiredFlow=H;ha.RefreshTokenDurationInMS=this.Vge.Kc;ha.numOfFailuresWhileUserIsActive=ld.a.PU;ha.numOfFailuresWhileUserIsInActive=ld.a.QU;ha.numOfFailuresWhileOffline=ld.a.Xda;ha.RefreshAccessTokenCorrelationID=this.context.correlationID;ha.accessTokenTTL=ta.AFrameworkApplication.accessTokenTtl;ha.ContainsChangesWorkbookOperations=
this.$.userOperationManager.mUa();ha.IsDocumentHidden=this.documentVisibilityObserver?this.documentVisibilityObserver.isHidden.toString():"Unknown";ha.TimeFromFirstOpenInHr=Math.floor(ed.b(Pc.a.zb,Tc.toUtc(Ya.Qvg))/3600);return ha}N9i(H,ha){this.zz=!1;this.Tfl();this.g9g(new Date,ta.AFrameworkApplication.accessTokenTtl);const Ya=this.$.fa,Wb=!ha&&Ya.Yf.xp,Sc=!this.$.isEditMode&&Ya.Frb;ha=this.Wjf(ha);ha.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";ha.shouldTriggerSilentReloadAfterExpiring=
Wb;ha.WopiTokenTaskItemPriority=ta.AFrameworkApplication.vCe;ha.isDirtyViewSession=Sc;ha=de.a.Nc(ha);Z.ULS.sendTraceTag(39982556,0,15,ha);this.ub.raiseEvent("TokenRefreshed",new Da(H,null));Sc?Ya.Yf.xp&&(Z.ULS.sendTraceTag(537170705,0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),Ya.mId()):Ya.Yf.xp?pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8994066_UpdateNewUserAccessTokenV2")&&Wb&&this.$.isEditMode?
Z.ULS.sendTraceTag(507827846,0,50,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: successful token refresh when user is active."):Wb&&(H=fb.a(this.$).Kd.activityState,H[ld.a.mwb]=!0,H[rb.a.d6]=!0,H[rc.a.Mu]=this.$.isEditMode,H[rc.a.Xmd]=this.$.fa.XHa,Gb.a(this.$).Dt(new Mb.a(Rb.a.Qma,2,null))):Ya.yc&&se.j(this.$.ma.sa,!0,!1,!1,null,null,null,null,null)}Tfl(){void 0!==this.$.fa.workbookContext.WorkbookUri&&null!==this.$.fa.workbookContext.WorkbookUri?(this.$.fa.workbookContext.WorkbookUri=
Db.a.QW(this.$.fa.workbookContext.WorkbookUri,ta.AFrameworkApplication.oH,ta.AFrameworkApplication.accessToken),this.$.fa.workbookContext.WorkbookUri=Db.a.QW(this.$.fa.workbookContext.WorkbookUri,ta.AFrameworkApplication.uP,ta.AFrameworkApplication.accessTokenTtl.toString()),this.$.fa.MPc()):Z.ULS.sendTraceTag(537170704,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");this.$.ta.AccessToken=ta.AFrameworkApplication.accessToken;this.$.ta.AccessTokenValidTo=ta.AFrameworkApplication.accessTokenTtl;
void 0!==this.$.ta.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.ta.DocumentHostInfo.QuerySignatureWithoutVersion&&(this.$.ta.DocumentHostInfo.QuerySignatureWithoutVersion=Db.a.QW(this.$.ta.DocumentHostInfo.QuerySignatureWithoutVersion,ta.AFrameworkApplication.oH,ta.AFrameworkApplication.accessToken),this.$.ta.DocumentHostInfo.QuerySignatureWithoutVersion=Db.a.QW(this.$.ta.DocumentHostInfo.QuerySignatureWithoutVersion,ta.AFrameworkApplication.uP,ta.AFrameworkApplication.accessTokenTtl.toString()));
void 0!==this.$.ta.EmbedConfiguratorUrl&&null!==this.$.ta.EmbedConfiguratorUrl&&(this.$.ta.EmbedConfiguratorUrl=Db.a.QW(this.$.ta.EmbedConfiguratorUrl,ta.AFrameworkApplication.oH,ta.AFrameworkApplication.accessToken),this.$.ta.EmbedConfiguratorUrl=Db.a.QW(this.$.ta.EmbedConfiguratorUrl,ta.AFrameworkApplication.uP,ta.AFrameworkApplication.accessTokenTtl.toString()));this.context.I2b=!0}}Object(ia.a)(Tb,"EwaAccessTokenExpirationRefreshManager",null,[236,237,4]);Object(Sb.b)(kc.AccessTokenManagerService,
{we:"singleton"})(async H=>{H=await Sb.a.resolve(kc.EwaControlService,H);if(ta.AFrameworkApplication.ea.ka("RefreshAccessTokenSilently")){const ha=new ud(ta.AFrameworkApplication.Rj,ta.AFrameworkApplication.Jz(),new Ud);return new Tb(H,ha)}return new Wc(H)});class Wc extends Ga{constructor(H){super();this.ub=new kb.a;this.zz=this.jEb=!1;this.RRa=0;this.$=H}wKg(){}Hod(H){this.ub.addHandler("SessionExpired",H)}uqa(H){this.ub.addHandler("TokenRefreshed",H)}lsb(H){this.ub.removeHandler("TokenRefreshed",
H)}get accessTokenExpiringMessage(){const H=(new Date(this.accessTokenTtl)).format(this.$.ta.ShortTimeFormat);return String.format(Yb.a.instance.Ib(78),H)}get yxe(){return this.jEb}get vub(){return!1}get z8(){return!1}get Prb(){return!1}get BU(){return!1}ICc(){return pa.a.instance.tI(ta.AFrameworkApplication.accessTokenTtl)}dispose(){Ca.a.vb(this.ub);this.$=null}gXk(){this.$.isEditMode&&this.aCc(!1)}fXk(){this.jEb=!0;this.aCc(!0);this.ub.raiseEvent("SessionExpired")}aCc(H){Z.ULS.sendTraceTag(537170715,
0,15,`EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired ${H}, GotDeploymentOrTimedOutError ${this.$.fa.G7}`);const ha=this.$.Mb.qq;H&&ha&&ha.isVisible&&1299163859===ha.error.MessageId&&this.$.Mb.qq.zF();const Ya=this.Cd(H);Gb.a(this.$).Dt(new Mb.a(Rb.a.xy,5,()=>{const Wb=fb.a(this.$),Sc=Wb.Kd.activityState;Sc[$b.a.Haa]=this.$.CHb(this.$.isEditMode);Sc[$b.a.QS]=$b.a.Fob;Sc[cc.a.Tq]=Rb.a.accessTokenExpiringWarning;Wb.Kd.Yt([Ya])}))}Cd(H){return pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8691397_RecategorizeAccessTokenExpiredSilentRefreshDisabled")?
eb.a.Blf():H?eb.a.Azd():this.qai()}qai(){const H=eb.a.Cd(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");H.Description=this.accessTokenExpiringMessage;return H}}Object(ia.a)(Wc,"EwaAccessTokenExpirationManager",Ga,[236,237,4]);var Ac=a(133),nd=a(98),qd=a(126),Xd=a(116),Hd=a(25),Zc=a(7),Jc=a(83),gc=a(70),dd=a(29),Bb=a(368),pc=a(124);let wc=class{constructor(H,ha){this.vrd=this.C9e=this.wrd=0;this.B9e=!1;this.proactiveSuggestionCard=null;this.Heb=this.Ghf=!1;this.sessionCount=this.autoAdjustColumnWidthSettings=
0;this.uH=!1;this.yd=(Ya,Wb)=>{Z.ULS.sendTraceTag(508363741,0,50,"AutoAdjustColumnsManagerService::onSessionIdChanged detected.");Wb.yc?this.initialize():Z.ULS.sendTraceTag(508360707,0,15,"AutoAdjustColumnsManagerService::onSessionIdChanged but session is still not active.");this.$.fa.Qk(this.yd)};this.Q_b=Ya=>{if(eb.a.zf(Ya.Errors)){const Wb=Ya.Errors[0].MessageId;pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8157898_AutoAdjustColumnCheckIsSessionActive")&&-315732528===Wb||Z.ULS.sendTraceTag(508641556,
0,10,`AutoAdjustColumnWidth.onReadRoamingStringSuccess encountered an error. Errors: ${eb.a.pc(Ya.Errors)}.`)}else Ya.Result&&(this.autoAdjustColumnWidthSettings=parseInt(Ya.Result,10),this.Heb=0!==(this.autoAdjustColumnWidthSettings&3),this.sessionCount=(this.autoAdjustColumnWidthSettings&65280)>>8),this.uH=2!==(this.autoAdjustColumnWidthSettings&2),this.B9e||0!==(this.autoAdjustColumnWidthSettings&2)||(0===this.sessionCount&&(this.Heb=!1),this.Nej())};this.S$d=Ya=>{Ya=pc.a.te(Ya.data);Z.ULS.sendTraceTag(508641555,
0,10,`AutoAdjustColumnWidth.onReadWriteRoamingStringFailure: Encountered errors while reading/writing roaming setting. Errors: ${eb.a.pc(Ya)}.`)};this.t0b=Ya=>{eb.a.zf(Ya.Errors)?Z.ULS.sendTraceTag(508641554,0,10,`AutoAdjustColumnWidth.onWriteRoamingStringSuccess: encountered an error. Errors: ${eb.a.pc(Ya.Errors)}`):Ya.Result||Z.ULS.sendTraceTag(508641553,0,10,"AutoAdjustColumnWidth.onWriteRoamingStringSuccess failed to write to roaming service.")};this.x3j=Ya=>{if(eb.a.zf(Ya.Errors))Z.ULS.sendTraceTag(508641552,
0,10,`AutoAdjustColumnWidth.onReadRoamingStringSuccess encountered an error. Errors: ${eb.a.pc(Ya.Errors)}.`);else{var Wb=0;Ya.Result&&(Wb=parseInt(Ya.Result,10));Wb=Wb&-4|this.autoAdjustColumnWidthSettings&3;this.rbh(Wb)}};this.Qkg=()=>{nd.a("AutoAdjustColumnWidthKeepOn");0===(this.autoAdjustColumnWidthSettings&1)&&(this.autoAdjustColumnWidthSettings|=1,this.gDg());this.Heb=!0;this.proactiveSuggestionCard.hide()};this.tVj=()=>{this.Z1h();this.proactiveSuggestionCard.hide()};this.E8j=()=>{nd.a("AutoAdjustColumnWidthHelp");
const Ya=new Jc.a(-859308420,gc.a.Hb,this.$.xc,9,null);this.$.Ia.Gb(Ya,{[gc.a.Bf]:"HelpID=151880",["InputMethod"]:gc.a.Hb,["ShouldCanvasTakeFocus"]:!0,[gc.a.Wc]:Zc.a.VF,[Zc.a.wna]:!0})};this.H_j=()=>{const Ya={};Ya[Zc.a.MF]="AutoAdjustColumnWidth";this.$.Dc(802602464,gc.a.Hb,8,Ya)};this.P6j=()=>{nd.a("AutoAdjustColumnWidthTurnedOff");this.autoAdjustColumnWidthSettings|=2;this.gDg();this.Heb=!0;this.proactiveSuggestionCard.hide();this.uH=!1};this.$=H;this.proactiveSuggestionCard=ha;this.C9e=pd.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.AutoAdjustColumnConfirmThreshold",
3);this.vrd=pd.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.AutoAdjustColumnConfirmSessionCycle",3);this.B9e=0===this.vrd;!pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8157898_AutoAdjustColumnCheckIsSessionActive")||this.$.fa.yc?this.initialize():this.$.fa.Vk(this.yd)}dispose(){this.proactiveSuggestionCard&&this.proactiveSuggestionCard.dispose();this.$=null}initialize(){Z.ULS.shipAssertTag(508641557,0,dd.a.RHa(),"AutoAdjustColumnWidth feature is off");Bb.D(this.$.ma.sa,5,this.Q_b,this.S$d,
null,null)}rbh(H){Bb.K(this.$.ma.sa,5,H.toString(),this.t0b,this.S$d,null,null)}Nej(){if(2!==(this.autoAdjustColumnWidthSettings&2)){var H=this.sessionCount+1;H>=this.vrd&&(H=0);this.rbh(this.autoAdjustColumnWidthSettings&-65281|H<<8)}}gDg(){Bb.D(this.$.ma.sa,5,this.x3j,this.S$d,null,null)}wjg(H){if(0===this.wrd){const ha=[];ha.push(qd.a.Mf("Command",H,Xd.g.String));nd.a("AutoAdjustedColumnWidth",void 0,void 0,ha)}++this.wrd;Z.ULS.shipAssertTag(508641551,0,0===(this.autoAdjustColumnWidthSettings&
2),"AutoAdjustedColumns when AutoAdjustColumnWidthSettings is Off");!this.Heb&&this.wrd>=this.C9e&&this.Y1h()}Y1h(){if(null!=this.proactiveSuggestionCard){nd.a("AutoAdjustColumnWidthDialog");var H=Yb.a.instance.La(858),ha=Yb.a.instance.La(859),Ya=Yb.a.instance.La(860),Wb=Yb.a.instance.La(861),Sc=Yb.a.instance.La(863);this.proactiveSuggestionCard.show(Hd.f(this.$).ha.oa.Ed,H,ha,Ya,Wb,this.Qkg,this.tVj,this.sAc(),void 0,void 0,"WrapText",void 0,void 0,void 0,void 0,!1,!1,Sc,this.H_j);this.Ghf?this.Heb=
!0:this.Ghf=!0}}sAc(){return[{key:"learnMessage",text:Yb.a.instance.La(862),onClick:this.E8j}]}Z1h(){const H=Yb.a.instance.La(864),ha=Yb.a.instance.La(865),Ya=Yb.a.instance.La(866),Wb=Yb.a.instance.La(861);this.proactiveSuggestionCard.show(Hd.f(this.$).ha.oa.Ed,H,ha,Ya,Wb,this.Qkg,this.P6j,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,!1,!1,void 0,void 0)}};wc=Object(Ac.__decorate)([Object(Sb.d)(kc.AutoAdjustColumnsManagerService),Object(Ac.__param)(0,Object(kc.EwaControlService)()),Object(Ac.__param)(1,
Object(kc.ProactiveSuggestionCardService)())],wc);Object(ia.a)(wc,"AutoAdjustColumnsManager",null,[4,572]);var cd=a(32),Vd=a(93),xb=a(439),ub=a(429),Fc=a(213),xd=a(255),Ic=a(266);let bd=class{constructor(H){this.$=H;kc.CoauthManagerService.Oa()&&(ta.AFrameworkApplication.yx=this)}get uWd(){return this.$.workbookContext.FileCoauthorable}get PUb(){return!1}get ROb(){return this.$.fa.WW}get Cqf(){if(this.ROb)return!0;for(const H of this.$.fa.ko)if(!H.SupportsRename)return!1;return!0}};bd=Object(Ac.__decorate)([Object(Sb.d)(kc.CoauthManagerService),
Object(Ac.__param)(0,Object(kc.EwaControlService)())],bd);Object(ia.a)(bd,"EwaCoauthManager",null,[567]);var yb=a(26),Oc=a(1021),kd=a(19),Rc=a(1222);const Xb=Object(kd.c)(Rc.a);var dc=a(1223),Vc=a(1111),yd=a(605),Pd=a(48);const re=H=>{try{return Pd.a(H)}catch(ha){}return null};class ue{constructor(H,ha,Ya,Wb,Sc,zd){this.wW=!1;this.Tk=null;this.Sgd=!1;this.U9e=be=>{const oe=be.SI.task;oe.continueWith(()=>{this.Tk=oe.result;this.Sgd&&(this.Tk.g4(2,null,!0),this.Sgd=!1);this.Tk.wqa((Ke,Xe)=>{2===Xe.type&&
this.zh.hf(yb.a.hWa,2)});this.Tk.rqa((Ke,Xe)=>{2===Xe.newState&&this.zh.hf(yb.a.hWa,2)});2===this.Tk.connectionState&&this.zh.hf(yb.a.hWa,2)})};this.Fpb=be=>{this.wW=!1;const oe=re(be.data.responseData);be.data.state.nG(oe,this.yRe.value)};this.G3j=be=>{5!==be.data.status||this.wW?this.trg(be):(this.wW=!0,this.Fzf(be.data.state,!1))};this.trg=be=>{be.data.state.kO(-1)};this.k2a=be=>{this.wW=!1;const oe=re(be.data.responseData);be.data.state.nG(oe,this.yRe.value);this.Thg()};this.P3j=be=>{5!==be.data.status||
this.wW?this.Crg(be):(this.wW=!0,this.Gzf(be.data.state,!1))};this.Crg=be=>{be.data.state.kO(-1)};this.pb=H;this.sg=ha;this.Syb=Ya;this.yRe=Wb;this.ya=Sc;this.oqh=zd}init(H,ha){ha&&Object(kd.d)(Vc.a).execute(this.U9e)}j7(H){this.Fzf(H,!0)}Fzf(H,ha){const Ya=this.jRh(H.yYg),Wb={};Wb[ue.Whf]=ue.Xhf;this.vJg.Wn(Ya,2,"",Wb,!1,2,this.Fpb,ha?this.G3j:this.trg,H)}Fsa(H){this.Gzf(H,!0)}Gzf(H,ha){const Ya=this.lRh(),Wb={};Wb[ue.Whf]=ue.Xhf;Wb[ue.$$i]=cd.a.Jf(H.DJg);Wb[ue.Y$i]=this.oqh.value.y_h;this.vJg.Wn(Ya,
2,"",Wb,!1,2,this.k2a,ha?this.P3j:this.Crg,H)}lRh(){return this.Faf()}jRh(H){let ha=this.Faf();return ha=Db.a.yk(ha,ue.daj,H?"2":"1")}Faf(){let H=(this.ya.value.appSettings.RenameWebServiceBase||"")+ue.Z$i;H=Db.a.yk(H,ue.aaj,cd.a.Jf(ta.AFrameworkApplication.Uh));this.yx&&this.yx.uWd&&(H=Db.a.yk(H,ue.caj,"1"));return H}Thg(){this.Tk?this.Tk.g4(2,null,!0):this.Sgd=!0}get zh(){return this.pb.value}get vJg(){return this.sg.value}get yx(){return this.Syb.value}static get instance(){return ue.Wa||(ue.Wa=
ue.yca())}static yca(){return new ue(new yd.a(()=>ta.AFrameworkApplication.Kb),new yd.a(()=>ta.AFrameworkApplication.od),new yd.a(()=>ta.AFrameworkApplication.yx),new yd.a(()=>Object(kd.a)(dc.a)),new yd.a(()=>ta.AFrameworkApplication.ea),new yd.a(()=>Object(kd.a)(Xb)))}}ue.Whf="Content-Type";ue.Xhf="application/json; charset=utf-8";ue.Z$i="renamehandler.ashx";ue.aaj="qs";ue.$$i="n";ue.caj="sl";ue.Y$i="X-CoauthLockId";ue.daj="u";ue.Wa=null;Object(ia.a)(ue,"ExecuteRenameFileHandler",null,[]);class He{constructor(){this.kO=
this.nG=null;this.yYg=!1}}Object(ia.a)(He,"ExecuteRefreshFilenameData",null,[]);class bf{constructor(){this.kO=this.nG=this.DJg=null}}Object(ia.a)(bf,"ExecuteRenameFileData",null,[]);class af{constructor(H){this.oc=null;this.F$c=ue.instance;this.GYe=!1;this.LC=()=>{ta.AFrameworkApplication.lva()&&(ue.instance.init(this.oc,ta.AFrameworkApplication.O3b),this.GYe||(ta.AFrameworkApplication.Fsa=Object(fc.a)(this,this.Fsa,"executeRenameFile"),ta.AFrameworkApplication.j7=Object(fc.a)(this,this.j7,"executeRefreshFilename")),
ta.AFrameworkApplication.w5b=Object(fc.a)(this,this.w5b,"sendFileNameAndLocationUpdateNotification"))};this.GYe=H}get name(){return"Common.App.RenameFile.RenameExecutor"}ji(H){this.oc=H}init(){ta.AFrameworkApplication.ea.hr(this.LC)}Fsa(H,ha,Ya){const Wb=new bf;Wb.DJg=H;Wb.nG=ha;Wb.kO=Ya;this.F$c.Fsa(Wb)}j7(H,ha,Ya){const Wb=new He;Wb.nG=H;Wb.kO=ha;Wb.yYg=Ya;this.F$c.j7(Wb)}w5b(){this.F$c.Thg()}dispose(){}}Object(ia.a)(af,"PackageManager",null,[11,12]);var Pe=a(281),wf;let xf=wf=class extends Vd.a{constructor(H,
ha,Ya){super();this.lma=this.oje=this.ZHg=this.Ysc=null;this.cua=()=>{var Wb=this.$.fa.el;if(Wb&&Wb.WorkbookFileName){var Sc=cd.a.nu(Wb.WorkbookFileName),zd=!!Kb.a.compare(this.$.workbookContext.WorkbookFileName,Wb.WorkbookFileName,!1),be=pd.EwaSettings.Ra(465)&&!!Wb.BreadcrumbFolderUrl&&!!Kb.a.compare(this.$.workbookContext.FullDocumentInfo.BreadcrumbFolderUrl,Wb.BreadcrumbFolderUrl,!1);if(zd||be)this.lma={},this.lma.NewFileName=Sc,this.lma.EditDocInClientUrl=Wb.EditDocInClientUrl,this.lma.DirectInvokeDAVUrl=
Wb.DirectInvokeDAVUrl,this.lma.DownloadACopyUrl=Wb.DownloadACopyUrl,pd.EwaSettings.Ra(465)&&Wb.BreadcrumbFolderUrl&&(this.lma.BreadcrumbFolderName=Wb.BreadcrumbFolderName,this.lma.BreadcrumbFolderUrl=Wb.BreadcrumbFolderUrl),Wb=ta.AFrameworkApplication.Kb.pe(yb.a.hWa,2,Sc),this.lma=null,Z.ULS.shipAssertTag(537154064,0,32===Wb,"RenameFileManager.HandleWorkbookMetadataChanged - Workbook Name Update Failed")}};this.vXj=(Wb,Sc,zd)=>{this.ZHg=Sc;this.oje=zd;this.$.Ia.Gb(new Jc.a(1897077126,gc.a.Hb,2,3,
null),{["newFileName"]:Wb})};this.uXj=Wb=>{this.lma?Wb(this.QMf(this.lma),this.yq):dd.a.S3f()&&Object(Oc.b)(this.$.ma.sa,null,null,null,null)};this.k2a=Wb=>{xd.a(Wb)||!Wb.Result?(Wb=wf.LHi(Wb),fb.a(this.$).Kd.oF([-414480287,650565124,-782844485,1223808266,-62451516,1636785843]),this.oje(Wb)):this.ZHg(this.QMf(Wb.Result),this.yq)};this.N3j=()=>{this.oje(5)};this.$=H;this.yq=ha;this.$.fa.au(this.cua);kc.CoauthManagerService.Oa()&&(this.Ysc=Ya)}initialize(){if(dd.a.S3f()){var H=!0;H=void 0===H?!1:H;
Type.registerNamespace("Common.App.Rename.RenameExecutor");Pe.a.instance.Qi(new af(H))}ta.AFrameworkApplication.Fsa=this.vXj;ta.AFrameworkApplication.j7=this.uXj;kc.CoauthManagerService.Oa()||(this.Ysc=ta.AFrameworkApplication.yx,ta.AFrameworkApplication.yx=new bd(this.$))}dispose(){ta.AFrameworkApplication.Fsa=null;ta.AFrameworkApplication.j7=null;this.$.fa.Bv(this.cua);ta.AFrameworkApplication.yx=this.Ysc;this.$=this.Ysc=null;super.dispose()}renameFile(H,ha){const Ya=H.newFileName;if(Ya&&(H=cd.a.nu(this.$.workbookContext.WorkbookFileName),
Kb.a.compare(H,Ya,!1))){const Wb=this.$.ma.sa.mc();ub.a(this.$.userOperationManager,(Sc,zd,be)=>{var oe=this.$.ma.sa;Sc=Ic.c(Sc,this.k2a);zd=Ic.b(zd,this.N3j);const Ke=oe.$a(9,Wb);Ke.newFileName=Ya;return se.h(oe,"RenameFile",Ke,Sc,zd,be,null,0)},Sc=>new Fc.a(134,0,Sc),ha)}}qVd(){return 32===ta.AFrameworkApplication.Kb.hf(yb.a.qia,1)}QMf(H){var ha=this.$.workbookContext;ta.AFrameworkApplication.Wba=H.DownloadACopyUrl;const Ya=pd.EwaSettings.Ra(465)&&!!H.BreadcrumbFolderUrl;Ya&&(ta.AFrameworkApplication.Wh.breadcrumbFolderName=
H.BreadcrumbFolderName,ta.AFrameworkApplication.Wh.breadcrumbFolderUrl=H.BreadcrumbFolderUrl,ha.FullDocumentInfo.BreadcrumbFolderUrl=H.BreadcrumbFolderUrl,ha.FullDocumentInfo.BreadcrumbFolderName=H.BreadcrumbFolderName);ha.FullDocumentInfo.BreadcrumbDocName=H.NewFileName;xb.d(ha,H.NewFileName);ha={};ha.NewName=H.NewFileName;ha.DirectInvokeDavUrl=H.DirectInvokeDAVUrl;ha.EditDocInClientUrl=H.EditDocInClientUrl;Ya&&(ha.BreadcrumbFolderName=H.BreadcrumbFolderName,ha.BreadcrumbFolderUrl=H.BreadcrumbFolderUrl);
ha.OperationResult=0;return ha}static LHi(H){switch(H.Errors[0].MessageId){case -414480287:H=2;break;case 650565124:H=1;break;case 1636785843:H=6;break;case -782844485:H=4;break;default:H=5}return H}};xf=wf=Object(Ac.__decorate)([Object(Sb.d)(kc.RenameFileManagerService),Object(Ac.__param)(0,Object(kc.EwaControlService)()),Object(Ac.__param)(1,Object(kc.HostMessengerService)()),Object(Ac.__param)(2,Object(kc.CoauthManagerService)())],xf);Object(ia.a)(xf,"RenameFileManager",Vd.a,[571,4]);var Cf=a(220),
tf=a(74),Jf=a(80),dg=a(114),uf=a(10),lf=a(12),Pf=a(402);class Rf{constructor(H){this.gva=pd.EwaSettings.Iuj();this.settings=H;pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8963112_LogPrefetchSettings")&&Z.ULS.sendTraceTag(507094729,0,20,`BlockPrefetcherSettings: isPrefetchOverrideEnabled: ${this.gva}, numOfPrefetchRequestsPerPrefetchLimit: ${this.eob()}, horizontalPrefetchedAreaPixels: ${this.$Rb()}, verticalPrefetchedAreaPixels: ${this.dac()}, isPrefetchUsedRangeEnabledAfterTTVR: ${this.nde()}, isPrefetchHorizontallyUsedRangeAroundBufferAreaEnabled: ${this.Dyg()}, isPrefetchVerticallyUsedRangeAroundBufferAreaEnabled: ${this.Kyg()}, isStartPrefetchAfterFirstScrollEnabled: ${this.l8b()}, isPrefetchUsedRangeAfterSwitchSheetEnabled: ${this.qRc()}, prefetchUsedRangeDelayMs: ${this.Jyg()}`)}eob(){return this.gva?
this.settings.MaxNumberOfBlocksToPrefetchPerAttempt:pd.EwaSettings.CRj()}$Rb(){return this.gva?this.settings.HorizontalPrefetchedAreaPixels:pd.EwaSettings.$Rb()}dac(){return this.gva?this.settings.VerticalPrefetchedAreaPixels:pd.EwaSettings.dac()}nde(){return this.gva?this.settings.PrefetchUsedRangeAfterTtvr:pd.EwaSettings.Muj()}Vdk(){return this.Dyg()&&this.Kyg()}Dyg(){return this.gva?this.settings.PrefetchHorizontallyUsedRangeAroundBufferArea:pd.EwaSettings.Kuj()}Kyg(){return this.gva?this.settings.PrefetchVerticallyUsedRangeAroundBufferArea:
pd.EwaSettings.Nuj()}l8b(){return this.gva?this.settings.StartPrefetchAfterFirstScroll:pd.EwaSettings.lxj()}qRc(){return this.gva?this.settings.PrefetchUsedRangeAfterSwitchSheet:pd.EwaSettings.Luj()}Jyg(){return pd.EwaSettings.Mdk()}Vre(){return-1!==this.$Rb()&&-1!==this.dac()}}Object(ia.a)(Rf,"BlockPrefetcherSettings",null,[]);var Mf;let zf=Mf=class{constructor(H,ha,Ya){this.da=H;this.kS=ha;this.TG=Ya;this.Wna=new AbortController;this.XFc=!1;this.ONg=(Wb,Sc)=>{void dg.c(()=>{this.prefetch(Wb)},{priority:"background",
delay:void 0===Sc?0:Sc})};this.wDk=()=>{this.ONg(!1)};this.Ame=()=>{this.ONg(!0,this.settings.Jyg())};this.s$d=Wb=>{if(this.settings.l8b()||this.settings.qRc())Wb=Wb.detail.viewportScenarioContext,this.settings.qRc()&&Object(Pf.e)(Wb)?this.XFc=!0:Object(Pf.d)(Wb)&&this.XFc&&(this.Ame(),this.XFc=!1);this.settings.Vre()&&this.wDk()};pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8838483_PrefetchOnlyHighEndDevices")&&this.isLowEndDevice()||(this.settings=new Rf(this.da.$.ta),this.XFc=this.settings.l8b()?
!0:!1,(this.settings.Vre()||this.settings.l8b()||this.settings.qRc())&&this.kS.O2e(this.s$d,this.Wna.signal,!1),!this.settings.l8b()&&this.settings.nde()&&(this.da.$.fa.ug?this.Ame():this.da.$.fa.Nr(this.Ame)))}prefetch(H){const ha=this.da.$.la;this.Ouj(ha)&&(H=this.yKi(H),H=this.Oei(H),H.length>this.settings.eob()&&(Z.ULS.sendTraceTag(507545357,0,50,`BlockPrefetcher.prefetch Trying to prefetch more than the limit. blocksToPrefetch.length: ${H.length}. maxNumberOfBlocksToPrefetchPerAttempt: ${this.settings.eob()}`),
H.splice(this.settings.eob())),void this.vDk(H,ha))}Kdk(H,ha){let Ya=0;for(let Wb=0;Wb<H.length;Wb++)this.Gxk(H[Wb],ha)&&(Ya++,this.TG.oxk());return Ya}Gxk(H,ha){const Ya=this.da.za,Wb=Ya.Fh(ha,H);let Sc=!1;Ya.ti(Wb)||(Sc=Ya.oJg(H,ha,"PrefetchCachedBufferedBlock"));Z.ULS.sendTraceTag(507569688,0,50,`BlockPrefetcher.requestBlockCacheItem getRange request for block: hashCode ${Wb} is pending? ${Sc}. isBeyondUsedRange? ${this.da.QEc(H).result}`);return Sc}async vDk(H,ha){let Ya=0;for(let Wb=0;Wb<H.length;Wb+=
Mf.jig){const Sc=H.slice(Wb,Wb+Mf.jig);Ya+=await dg.c(()=>this.Kdk(Sc,ha),{priority:"background",delay:Mf.Ldk})}this.yGj(Ya)}Ouj(H){const ha=this.da.$.fa;(H=ha.yc&&H&&tf.i(H)&&!ha.isNamedObjectViewMode)||Z.ULS.sendTraceTag(507569687,0,50,"BlockPrefetcher.isPrefetchingBlocksPossible prefetching is not possible");return H}yKi(H){const ha=this.da.hd,Ya=[];let Wb;if(this.settings.Vre()){let Sc=Jf.f(this.da.hd,this.da.$n,this.da.WGa(),this.settings.$Rb(),this.settings.dac());Wb=this.bPf(ha);this.settings.Vdk()&&
(Sc=Sc.Xe(Wb));Sc&&Ya.push(...Cf.c(Sc,this.da.rb,!1))}H&&this.e4i(Ya,ha,Wb);return Ya}e4i(H,ha,Ya){this.settings.nde()&&(ha=null!==Ya&&void 0!==Ya?Ya:this.bPf(ha),H.push(...Cf.c(ha,this.da.rb,!1)))}bPf(H){H=Jf.j(this.da.usedRange,this.da.rb.Gg,this.da.rb.Vg,this.da.rowsPerBlock,this.da.columnsPerBlock,1,H);H.bottomRight.X=Math.min(H.bottomRight.X,this.settings.eob());H.bottomRight.Y=Math.min(H.bottomRight.Y,this.settings.eob());return H}Oei(H){const ha=uf.a.vKj+1,Ya=new Set,Wb=[];for(const Sc of H)H=
5*Sc.X+Sc.Y*ha*5+Sc.PaneType,Ya.has(H)||(Ya.add(H),Wb.push(Sc));return Wb}isLowEndDevice(){if(!navigator)return!1;const H=navigator.deviceMemory,ha=navigator.hardwareConcurrency;return lf.HelperMethods.isLowEndDevice(H,ha,void 0!==H&&void 0!==ha)}yGj(H){Z.ULS.sendTraceTag(507569686,0,50,`BlockPrefetcher.logPrefetchEnded prefetchedBlocksCount is ${H}`)}};zf.Ldk=100;zf.jig=5;zf=Mf=Object(Ac.__decorate)([Object(Sb.d)(kc.BlockPrefetcherService),Object(Ac.__param)(0,Object(kc.GridViewService)()),Object(Ac.__param)(1,
Object(kc.ViewportObserverService)()),Object(Ac.__param)(2,Object(kc.ViewportTelemetryManagerService)())],zf);Object(ia.a)(zf,"BlockPrefetcher",null,[]);var df=a(170),Bf=a(123),Kf=a(43),Vf=a(64);const sb=RegExp("^.+/(h[a-zA-Z0-9]{16})_(_.+[.js|.css])$"),Gc=(H,ha,Ya)=>{if(pd.EwaSettings.Ra(470))H=ad(H,152),Kf.TaskExtensions.tb(Vf.a.GU(H,4,3),()=>{let Wb;Wb=ResourceHashJson;for(const ig of ha){var Sc=void 0,zd=void 0,be=void 0;a:{var oe=Wb,Ke=ig;Sc=zd=be=null;var Xe=Vf.a.current.Lo(Ke);Xe=(null===Xe||
void 0===Xe?0:Xe.startsWith("http://"))||(null===Xe||void 0===Xe?0:Xe.startsWith("https://"))?Xe:ta.AFrameworkApplication.EE(Xe,0);if(!Xe){Z.ULS.sendTraceTag(559755475,0,10,`ScriptsPrefetcherMethods.GetNewHashResourceUrl: got currentUrl = null. resource is ${Ke}`);Sc={returnValue:!1,newUrl:be,g7d:zd,lle:Sc};break a}const Og=sb.exec(Xe);if(Og&&1<Og.length){if(Ke=Og[1],Sc=Og[2].toLowerCase(),oe=oe[Sc]){"string"===typeof oe?(be=Xe.replace(Ke,Bf.a.e_c(oe)),zd="sha256-"+oe):(be=Xe.replace(Ke,oe.UrlHash),
zd="sha256-"+oe.SriHash);Sc={returnValue:!0,newUrl:be,g7d:zd,lle:Sc};break a}}else Z.ULS.sendTraceTag(508441056,0,50,`ScriptsPrefetcherBase.getNewResourceUrlAndHash: No regex match for URL: ${Xe}`);Sc={returnValue:!1,newUrl:be,g7d:zd,lle:Sc}}Xe=Sc;({newUrl:Sc,g7d:zd,lle:be}=Xe);Xe.returnValue&&(Z.ULS.sendTraceTag(508441088,0,50,`ScriptsPrefetcherBase.prefetchCoreResources: attempting to download ${be}`),Vf.a.Wqb(Sc,void 0,zd))}},Ya,3);else for(const Wb of ha)(Ya=ad(H,Wb))&&Vf.a.Wqb(Ya)},ad=(H,ha)=>
{var Ya=ta.AFrameworkApplication.buildVersion.split(".");const Wb=Ya[0]+Ya[2]+Ya[3];Ya=H.split(".");Ya=Ya[0]+Ya[2]+Ya[3];const Sc=Vf.a.current.Lo(ha);if(!Sc)return Z.ULS.sendTraceTag(508441059,0,10,`ScriptsPrefetcherBase.getVersionResourceUrl: got currentUrl = null. resource is ${ha}, nextContentVersion is ${Ya}`),null;if(pd.EwaSettings.Ra(470)){if(-1!==Sc.indexOf(Wb))return Sc.replace(Wb,Ya);if(-1===Sc.indexOf("x/s/"))return Z.ULS.sendTraceTag(508441058,0,10,`ScriptsPrefetcherMethods.getVersionResourceUrl: currentUrl is neither a versioned nor hashed URL for resource ${ha}. currentUrl: ${Sc}, currentContentVersion: ${Wb}, version: ${H}`),
null;H=Sc.indexOf("x/s/")+4;ha=H+17;return ha>=Sc.length?(Z.ULS.sendTraceTag(508441057,0,10,"ScriptsPrefetcherMethods.GetVersionResourceUrl: searchEndIndex exceeds the length of the currentUrl"),null):Sc.replace(Sc.substring(H,ha),Ya)}return Sc.replace(Wb,Ya)};let Wd=class extends Vd.a{constructor(){super();this.isEnabled=pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BrowserCachedVersionsEnabled",!1);this.njl=[139,151,149,136,137,150];this.cookieName="PLTBrowserCachedVersions";this.B4h=
pd.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BrowserCachedVersionsMaxCookieTTLInDays",365);this.iTh=pd.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BrowserCachedVersionsMaxVersionTTLInMS",2592E6);this.nKj=pd.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BrowserCachedVersionsMaxVersionsInCookie",1);this.g7i=async()=>{this.Tgj();this.VTk()&&await this.pil();this.$Sh();this.yLk()};this.VTk=()=>0<this.vF.cachedVersions.length&&!this.M_d(this.szc());this.Tgj=()=>{if(this.vF=
this.VKi()){if(this.hni()){var H=!this.M_d(this.szc()),ha=this.vF.cachedVersions.length,Ya=this.vF.cachedVersions.map(Wb=>Wb.version).toString();Z.ULS.sendTraceTag(508164067,0,50,`BrowserCachedVersionsManager: Successfully read ${ha} cached versions (last verified at ${this.vF.cacheLastVerifiedAt}). IsNewVersion: ${H} | Cached versions: ${Ya}`)}}else this.vF={cachedVersions:[]}};this.hni=()=>{var H;if(null===(H=this.vF)||void 0===H||!H.cachedVersions)return Z.ULS.sendTraceTag(508164066,0,20,"BrowserCachedVersionsManager: Cookie is corrupt"),
this.PFg(),this.vF={cachedVersions:[]},!1;H=this.vF.cachedVersions.length;this.vF.cachedVersions=this.vF.cachedVersions.filter(ha=>!!ha);H-=this.vF.cachedVersions.length;0<H&&Z.ULS.sendTraceTag(508065487,0,20,`BrowserCachedVersionsManager: Removed ${H} null / undefined cached versions from cachedVersions array`);return!0};this.szc=()=>ta.AFrameworkApplication.buildVersion;this.$Sh=()=>{var H=this.szc();this.M_d(H)||(H={version:H,initiallyCachedAt:Date.now(),resourceUrls:this.J4i(H)},this.Eyh(H))};
this.Eyh=H=>{this.vF.cachedVersions.unshift(H);this.vF.cachedVersions=this.vF.cachedVersions.slice(0,this.nKj)};this.K4i=()=>this.njl;this.M_d=H=>this.vF.cachedVersions.some(ha=>ha.version===H);this.J4i=H=>this.K4i().map(ha=>ad(H,ha)).filter(ha=>!!ha);this.VKi=()=>{const H=df.a.get(this.cookieName);if(H)try{const ha=decodeURIComponent(H),Ya=JSON.parse(ha);Z.ULS.sendTraceTag(508303253,0,20,`BrowserCachedVersionsManager: Cookie found with value ${ha}`);return Ya}catch(ha){Z.ULS.sendTraceTag(508298189,
0,20,"BrowserCachedVersionsManager: Failed to read a cookie")}else Z.ULS.sendTraceTag(508164065,0,20,"BrowserCachedVersionsManager: Cookie was not found");return null};this.yLk=()=>{const H=JSON.stringify(this.vF);Z.ULS.sendTraceTag(508303252,0,20,`BrowserCachedVersionsManager: Setting cookie with value ${H}`);this.PFg();df.a.BB(this.cookieName,H,this.B4h)||Z.ULS.sendTraceTag(508303251,0,15,`BrowserCachedVersionsManager: Failed to set cookie with value ${H}`)};this.PFg=()=>{df.a.remove(this.cookieName)};
this.pil=async()=>{Z.ULS.sendTraceTag(508303250,0,50,"BrowserCachedVersionsManager: Validating cached browser versions");const H={cachedVersions:[]},ha=this.vF.cachedVersions.map(Ya=>this.sil(Ya));try{const Ya=await Promise.all(ha);for(const Wb in Ya)Ya[Wb]&&H.cachedVersions.push(this.vF.cachedVersions[Wb]);H.cacheLastVerifiedAt=Date.now();this.vF=H}catch(Ya){Z.ULS.sendTraceTag(508303249,0,20,`BrowserCachedVersionsManager: Failed to validate cached versions with error ${Ya}`)}};this.sil=async H=>
{if(H.version===this.szc())return!0;const ha=Date.now();if(ha-H.initiallyCachedAt>this.iTh)return Z.ULS.sendTraceTag(508303248,0,20,`BrowserCachedVersionsManager: Evicting outdated version ${H.version} from cache`),!1;var Ya=H.resourceUrls.map(async Sc=>{var zd=await fetch(Sc);if(zd.ok)return zd=(new Date(zd.headers.get("Date"))).getTime()<ha,Z.ULS.sendTraceTag(508303247,0,50,`BrowserCachedVersionsManager: Successfully fetched resource ${Sc} with cache = ${zd} for version ${H.version}`),{url:Sc,success:!0,
Fwj:zd};Z.ULS.sendTraceTag(508303246,0,20,`BrowserCachedVersionsManager: Failed to fetch resource ${Sc} for version ${H.version} with status ${zd.status}`);return{url:Sc,success:!1}}),Wb=await Promise.all(Ya);Ya=H.resourceUrls.length;Wb=Wb.filter(Sc=>Sc.Fwj).length;Z.ULS.sendTraceTag(508303245,0,20,`BrowserCachedVersionsManager: ${Wb} / ${Ya} of resources in version ${H.version} are cached`);return Ya===Wb};void this.g7i()}dispose(){}};Wd=Object(Ac.__decorate)([Object(Sb.d)(kc.BrowserCachedVersionsManagerService),
Object(Ac.__param)(0,Object(kc.EwaControlService)())],Wd);Object(ia.a)(Wd,"BrowserCachedVersionsManager",Vd.a,[]);var je=a(1446),Ie=a(1119),Je=a(172);class $e{}$e.editCell="Edited";$e.dependentCell="Dependents";Object(ia.a)($e,"RecalcPriorityGroupType",null,[]);var Ib=a(1240),Nb=a(308);let Bc=class{constructor(){this.r2=pd.EwaSettings.lFc()}rId(H,ha){H=H.units;var Ya=ha.units;if(H.length!==Ya.length)return Z.ULS.sendTraceTag(508367051,0,15,"CalcInterfaceAdapter.FormattedValueToNumberFormatInformation: can't convert to NumberFormatInformation: units and finalized units don't have the same length!"),
null;ha=[];let Wb=-1;for(let Sc=0;Sc<H.length;Sc++)switch(H[Sc].kind){case Ib.a.blank:ha.push(...Array(Ya[Sc].str.length).fill(" "));break;case Ib.a.string:ha.push(H[Sc].str);break;case Ib.a.rCf:ha.push("");Wb=Sc;break;case Ib.a.general:ha.push(Ya[Sc].str);break;default:Z.ULS.sendTraceTag(508367050,0,15,"CalcInterfaceAdapter.ProcessFormattedValue: unknown FormattedUnitKind!")}if(0>=Wb||""===Ya[Wb].str)return null;Ya={};Ya.Start=ha.slice(0,Wb).join("");Ya.Separator=H[Wb].str;Ya.End=ha.slice(Wb+1,ha.length).join("");
return Ya}HJf(H){switch(H.alignment){case "Center":return 2;case "Left":return 1;case "Right":return 3;default:return Z.ULS.sendTraceTag(508367049,0,10,"CalcInterfaceAdapter.GetHorizontalAlignmentFromFormattedValue: unknown horizontal alignment!"),0}}TIf(H){if(H=H.color){if("String"===Object.getType(H).getName())return Je.a.np(H);if("Number"===Object.getType(H).getName())return null}else return null;Z.ULS.sendTraceTag(508367048,0,10,"CalcInterfaceAdapter.GetFontColorFromFormattedValue: unknown color type!");
return null}snj(H,ha){H=excelOnlineCalc.calc.getCellValueKind(H.rangeDelta.data.value);switch(H){case "number":case "string":case "boolean":case "Blank":case "Error":return!0;case "Rich":return ha.numberOfUnsupportedRichCellTypes++,!1;default:return Z.ULS.shipAssertTag(508367047,0,!1,`CalcInterfaceAdapter.IsCellValueTypeSupported: Unexpected unsupported type ${H}`),!1}}HGf(H){H=excelOnlineCalc.calc.getCellValueKind(H.rangeDelta.data.value);let ha=0;switch(H){case "number":ha=1;break;case "string":ha=
2;break;case "boolean":ha=3;break;case "Error":ha=4;break;case "Blank":ha=0;break;default:Z.ULS.shipAssertTag(508367046,0,!1,`CalcInterfaceAdapter.GetCellValueType: Unexpected unsupported type ${H}`)}return ha}o6h(H){const ha=H.value;switch(H.type){case 2:return void 0===ha||null===ha?"":ha;case 1:return H=parseFloat(ha),isNaN(H)?null:H;case 3:return H=parseFloat(ha),isNaN(H)?null:1===H;case 4:return H=parseFloat(ha),isNaN(H)?null:excelOnlineCalc.calc.errorValue(H);default:return excelOnlineCalc.calc.blankValue}}fPb(H){"kind"in
H&&Z.ULS.shipAssertTag(508367045,0,H.kind!==Ie.a.formula,"CalcInterfaceAdapter.GetCellValueTypeFromParsedEdit: given parsed edit must be a value edit!");H=excelOnlineCalc.numfmt.getValueEditOperKind(H);let ha=0;switch(H){case 0:case 128:ha=0;break;case 1:ha=1;break;case 2:ha=2;break;case 4:ha=3;break;case 8:ha=4;break;case 16:case 32:case 64:case 256:Z.ULS.sendTraceTag(508367044,0,15,`CalcInterfaceAdapter.OperKindToCellValueType: can't convert given OperKind ${H} to a CellValueType`);break;default:Z.ULS.shipAssertTag(508367043,
0,!1,`CalcInterfaceAdapter.OperKindToCellValueType: Unexpected oper kind ${H}`)}return ha}IMf(H,ha){const Ya=this.TAc(ha);var Wb=!(void 0===ha.rangeDelta.data.format||null===ha.rangeDelta.data.format);Z.ULS.shipAssertTag(508367042,0,0===Ya||!Wb,`CalcInterfaceAdapter.GetRecalcInferredFormat: Format inference expected for Edited cell only ${ha.priorityGroup}`);H=Math.max(H.cell.oi,0);Wb&&(Wb=excelOnlineCalc.calc.getCellFormatKind(ha.rangeDelta.data.format.format),"number"===Wb?H=ha.rangeDelta.data.format.format:
"string"===Wb?Z.ULS.sendTraceTag(508367041,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind string"):"Unavailable"===Wb?Z.ULS.sendTraceTag(508367040,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind unavailable"):Z.ULS.shipAssertTag(508367011,0,!1,"CalcInterfaceAdapter.GetRecalcInferredFormat: unknown format kind!"));return H}TAc(H){if(H.priorityGroup===$e.editCell)return 0;if(H.priorityGroup===$e.dependentCell)return 1;Z.ULS.sendTraceTag(508367010,0,10,"CalcInterfaceAdapter.GetRecalcPriorityGroup: unknown priority group!");
return 2}sTi(H){H=this.TAc(H);if(0===H)return 1;if(1===H)return 2;Z.ULS.sendTraceTag(508367009,0,10,"CalcInterfaceAdapter.GetInstantaneousUpdatedCellType: unknown updated cell type!");return 0}NLi(H){return H.rangeDelta.range.column+1}ULi(H){return H.rangeDelta.range.row+1}JMf(H){return this.r2?this.nPd(H.rangeDelta.data.value):H.rangeDelta.data.value.toString()}getCellValueKind(H){return excelOnlineCalc.calc.getCellValueKind(H.rangeDelta.data.value)}ePb(H,ha){var Ya,Wb;if(!this.r2)return null===
(Wb=null===(Ya=null===H||void 0===H?void 0:H.value)||void 0===Ya?void 0:Ya.value)||void 0===Wb?void 0:Wb.toString();H=excelOnlineCalc.calc.readOperToCellValue(ha,H.value);return this.nPd(H)}nPd(H){if(!Object(Nb.c)(H)){if("string"===typeof H)return H;if("number"===typeof H)return String(H);if("boolean"===typeof H)return H?"1":"0";if("kind"in H){if("Error"===H.kind)return String(H.type);if("Blank"===H.kind)return}Z.ULS.shipAssertTag(507646812,0,!1,"CalcInterfaceAdapter.GetValue: unknown cell value type!")}}};
Bc=Object(Ac.__decorate)([Object(Sb.d)(kc.CalcInterfaceAdapterService),Object(Ac.__param)(0,Object(kc.ExcelOnlineCalc)())],Bc);Object(ia.a)(Bc,"CalcInterfaceAdapter",null,[568]);var Af=a(90),gf=a(230),Qe=a(88);class Aa{}Aa.local="Local";Aa.i4k="Thread";Object(ia.a)(Aa,"RecalcServiceCreateMode",null,[]);var Fb=a(191);class Ta{constructor(H){this.iJe=null;this.init(H)}get lia(){return this.iJe}init(H){this.iJe=new gf.a;if(void 0!==H&&null!==H&&void 0!==H.HeadersList&&null!==H.HeadersList&&0<H.HeadersList.length)for(const ha of H.HeadersList)this.lia.ga(ha.Index,
ha.Name)}}Object(ia.a)(Ta,"ColHeadersListData",null,[]);var Eb=a(117),oc=a(159);class Lc{constructor(H,ha){this.sbf=H;this.sheetName=ha;this.L5b=!1}}Object(ia.a)(Lc,"CalcBlockInformation",null,[]);class Jd{constructor(H,ha,Ya,Wb,Sc){this.type=H;this.fullName=ha;this.range=Ya;this.sheetId=Wb;this.attributes=Sc;this.cK=null}}Object(ia.a)(Jd,"CalcNamedObject",null,[]);class Ab{get Ml(){return this.nYe}constructor(){this.nYe=[];this.yze=[];this.Ddb={}}CSg(H,ha){this.nYe[H]=ha}getSheetIndex(H){for(let ha=
1;ha<this.Ml.length;ha++)if(Kb.a.equals(this.Ml[ha].tya.sheetName,H,!1))return ha;return-1}}Object(ia.a)(Ab,"GridCache",null,[]);var Uc=a(874),Od=a(661);class le{constructor(H){this.tya=H;this.Tda=new Uc.a(Od.a.Ef());this.uMc=!1}}Object(ia.a)(le,"SheetInformation",null,[]);var ge=a(1200),ze;(function(H){H[H.initialization=0]="initialization";H[H.contentReady=1]="contentReady";H[H.cellEdit=2]="cellEdit"})(ze||(ze={}));Object(ia.b)("UpdateDataTrigger",ze);class Le{constructor(H){this.hge=null;this.y2d=
this.gge=this.U$d=!1;this.cee=0;this.Vde=this.Xde=this.Yde=this.Wde=-1;this.trueName="TRUE";this.falseName="FALSE";this.instantaneousSupportInformationManager=this.zr=null;this.Bw=this.currentStateId=-1;this.rEa="";this.Kia=null;this.getNameLoc=(ha,Ya)=>this.dHc()?this.mg.pa(this.currentStateId).Ml[0].Tda.Bb(Ya)?(ha=excelOnlineCalc.location.nameLoc(ha,Ya),excelOnlineCalc.util.success(ha)):excelOnlineCalc.util.success(null):(ha=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ha));
this.getContainingTable=ha=>{if(!this.dHc())return ha=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ha);const Ya=ha.range.col,Wb=ha.range.row;var Sc=this.mg.pa(this.currentStateId).Ml[0].Tda,zd=null;for(const be of Sc)if(Sc=be.value,2===Sc.type&&Kb.a.equals(ha.sheet.index.toString(),Sc.sheetId,!0)){const oe=Sc.range;Ya>=oe.left-1&&Ya<=oe.right-1&&Wb<=oe.bottom-1&&Wb>=oe.top-1&&(zd=excelOnlineCalc.location.nameScope(this.documentLoc,Sc.sheetId),zd=excelOnlineCalc.location.nameLoc(zd,
Sc.fullName))}return zd?excelOnlineCalc.util.success(zd):excelOnlineCalc.util.success(null)};this.getStructRefColumn=(ha,Ya)=>{if(!this.dHc()){var Wb=excelOnlineCalc.util.unavailable([2]);return excelOnlineCalc.util.failure(Wb)}Wb=ha.name;var Sc=this.mg.pa(this.currentStateId).Ml[0].Tda;if(Sc.Bb(Wb)){Sc=Sc.pa(Wb);const be=Sc.range;if(2!==Sc.type)return excelOnlineCalc.util.failure(this.czd(5));const oe=Sc.cK?Sc.cK.lia:null;if(!oe)return excelOnlineCalc.util.success(null);for(var zd of oe)if(Kb.a.equals(zd.value,
Ya,!0))return ha=excelOnlineCalc.location.documentLoc(ha.scope.document.path,ha.scope.document.name),ha=excelOnlineCalc.location.sheetIndex(ha,Sc.sheetId),zd=excelOnlineCalc.location.gridRange(be.top-1,zd.key,be.bottom-be.top+1,1),zd=excelOnlineCalc.location.sheetGridRange(ha,zd),Wb=excelOnlineCalc.location.structRefColumnLoc(Wb,zd,!!(Sc.attributes&16),!!(Sc.attributes&8)),excelOnlineCalc.util.success(Wb);return be.right-be.left+1!==oe.count?(Wb=excelOnlineCalc.util.unavailable([17,ha,Ya]),excelOnlineCalc.util.failure(Wb)):
excelOnlineCalc.util.failure(this.czd(0))}return excelOnlineCalc.util.success(null)};this.getStructRefSpecialRef=(ha,Ya)=>{if(!this.dHc())return Ya=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(Ya);var Wb=this.mg.pa(this.currentStateId).Ml[0].Tda;if(Wb.Bb(ha.name)){var Sc=Wb.pa(ha.name);if(2!==Sc.type)return excelOnlineCalc.util.failure(this.czd(5));Wb=!!(Sc.attributes&16);const zd=!!(Sc.attributes&8),be=Wb?1:0,oe=zd?1:0;ha=excelOnlineCalc.location.documentLoc(ha.scope.document.path,
ha.scope.document.name);ha=excelOnlineCalc.location.sheetIndex(ha,Sc.sheetId);Sc=Sc.range;let Ke={};if(1===Ya)Ke=excelOnlineCalc.location.gridRange(Sc.top-be-1,Sc.left-1,Sc.bottom+oe-Sc.top+be+1,Sc.right-Sc.left+1);else if(2===Ya)Ke=excelOnlineCalc.location.gridRange(Sc.top-1,Sc.left-1,Sc.bottom-Sc.top+1,Sc.right-Sc.left+1);else if(3===Ya)if(Wb)Ke=excelOnlineCalc.location.gridRange(Sc.top-2,Sc.left-1,1,Sc.right-Sc.left+1);else return excelOnlineCalc.util.success(null);else if(4===Ya)if(zd)Ke=excelOnlineCalc.location.gridRange(Sc.bottom,
Sc.left-1,1,Sc.right-Sc.left+1);else return excelOnlineCalc.util.success(null);Ya=excelOnlineCalc.location.sheetGridRange(ha,Ke);return excelOnlineCalc.util.success(Ya)}return excelOnlineCalc.util.success(null)};this.getDocumentLoc=(ha,Ya)=>{if((Kb.a.equals(ha,this.documentLoc.path,!0)||!ha)&&Kb.a.equals(Ya,this.documentLoc.name,!0))return excelOnlineCalc.util.success(this.documentLoc);ha=excelOnlineCalc.util.unavailable([0,excelOnlineCalc.location.documentLoc(ha,Ya)]);return excelOnlineCalc.util.failure(ha)};
this.getSheetIndex=(ha,Ya)=>{if(!this.mg.Bb(this.currentStateId)||!this.mg.pa(this.currentStateId).Ml)return Ya=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(Ya);ha=this.mg.pa(this.currentStateId).Ml;for(let Wb=1;Wb<ha.length;Wb++)if(Kb.a.equals(ha[Wb].tya.sheetName,Ya,!0))return excelOnlineCalc.util.success(ha[Wb].tya.sheetId);return excelOnlineCalc.util.success(null)};this.getSheetName=(ha,Ya)=>{if(!this.mg.Bb(this.currentStateId)||!this.mg.pa(this.currentStateId).Ml)return Ya=
excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(Ya);ha=this.mg.pa(this.currentStateId).Ml;for(let Wb=1;Wb<ha.length;Wb++)if(Kb.a.equals(ha[Wb].tya.sheetId,Ya,!0))return excelOnlineCalc.util.success(ha[Wb].tya.sheetName);return excelOnlineCalc.util.success(null)};this.getUserDefinedFuncLoc=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetUserDefinedFuncLoc not implemented in main thread"]);this.getSheetRangeIndexes=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetSheetRangeIndexes not implemented in main thread"]);
this.gqg=()=>{this.setNumberFormats()};this.de=()=>{Z.ULS.sendTraceTag(537170081,0,50,"CalcAsyncEngine.OnWorkbookOpened() called");this.mg=new gf.a;this.currentStateId=this.Bw=-1;this.rEa="";this.ufb=null;this.gge=!1;this.zr&&this.clearCache()};this.Ad=H;this.mg=new gf.a;this.ufb=null;this.documentLoc=excelOnlineCalc.location.documentLoc("",this.Ad.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.Nfa()}dispose(){this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.eUc(this.gqg);
this.Ad&&this.Ad.tm(this.de);this.close()}f$b(H){if(!this.zr)return!1;if(!this.instantaneousSupportInformationManager&&(this.instantaneousSupportInformationManager=Sb.a.Cb(kc.InstantaneousSupportInformationManagerService),!this.instantaneousSupportInformationManager))return Z.ULS.sendTraceTag(537170198,0,50,"CalcAsyncEngine.UpdateData Failed to get instantaneousSupportInformationManager"),!1;2!==H&&(this.currentStateId=this.Ad.fa.Cw,this.currentStateId===uf.a.Me&&(this.currentStateId=this.Ad.fa.Je));
if(1===H&&this.currentStateId<this.Bw)return Z.ULS.sendTraceTag(537170197,0,50,`CalcAsyncEngine::UpdateData() currentStateId:${this.currentStateId} < lastUpdatedStateId:${this.Bw} - ignoring update`),!1;this.ZIk();0!==H&&this.gge||(this.INk(),this.IKk(),this.vLk(),this.setNumberFormats(),this.instantaneousSupportInformationManager.Bod(this.gqg),this.Ad.Ul(this.de),this.gge=!0);this.Hlk();let ha=!1;0===H&&(ha=this.Jhj());if(0!==H||ha)this.OMk()?(this.vNk(H),this.uNk(),this.Bw=this.currentStateId,this.uYh()):
Z.ULS.sendTraceTag(537170196,0,15,`CalcAsyncEngine::UpdateData() for StateId:${this.currentStateId} failed - no Sheets information`);2!==H&&this.resumeRecalc();return!0}evalFormula(H,ha,Ya,Wb){if(!this.zr)return Z.ULS.sendTraceTag(537170195,0,15,"CalcAsyncEngine.EvalFormula: recalc engine is null"),Promise.resolve({});ha=excelOnlineCalc.calc.sheetCellLocation(null!==Ya&&void 0!==Ya?Ya:tf.d(this.Ad.qa.la),ha.top-1,ha.left-1);H=this.zr.evalFormula(this.Ad.fa.Je,H,ha,Wb);this.resumeRecalc();return H}DTh(H,
ha,Ya,Wb){Wb=void 0===Wb?null:Wb;const Sc=tf.d(this.Ad.qa.la);let zd=H.cell.wC-1,be=H.cell.YF-1;var oe=zd,Ke=be;let Xe=null;Wb&&(Xe=excelOnlineCalc.calc.cellLocation(zd,be),zd=Wb.top-1,be=Wb.left-1,oe=Wb.bottom-1,Ke=Wb.right-1);Ya=this.mBe(H,Ya,"SetCell");0>Ya||(Ke=Le.Iba("CalculateFormula.cell",Sc,zd,be,oe,Ke),oe=[],Wb=this.zBc(Sc),ha=excelOnlineCalc.calc.inferredRangeFormulaEdit(Ke,ha,Xe,Wb),oe.push(ha),H=(ha=this.tPd())?String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",
Sc,zd,be,Kb.a.O6e(H.cell.text),Ya,ha.top-1,ha.left-1,ha.bottom-1,ha.right-1):String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",Sc,zd,be,Kb.a.O6e(H.cell.text),Ya,"","","",""),Z.ULS.sendTraceTag(537170180,0,50,H),this.zr.editRangeFormulas(Ya,oe),this.resumeRecalc())}ETh(H,ha){const Ya=[];var Wb=tf.d(this.Ad.qa.la),Sc=this.zBc(Wb);ha=this.mBe(H[0].Rba,ha,"SetCellBatched");if(0>ha)return!1;for(var zd of H){var be=zd.Rba.cell,
oe=be.wC-1;be=be.YF-1;oe=Le.Iba("CalculateFormulaBatched.cell",Wb,oe,be,oe,be);oe=excelOnlineCalc.calc.inferredRangeFormulaEdit(oe,zd.editText,null,Sc);Ya.push(oe)}Sc=this.tPd();zd=H[0].Rba.cell.wC-1;oe=H[0].Rba.cell.YF-1;be=H[H.length-1].Rba.cell.wC-1;H=H[H.length-1].Rba.cell.YF-1;Wb=Sc?String.format("CalcAsyncEngine::CalculateFormulaBatched() for sheet:{0} range:({1},{2},{3},{4}) stateId:{5} viewport:(({6},{7})-({8},{9}))",Wb,zd,oe,be,H,ha,Sc.top-1,Sc.left-1,Sc.bottom-1,Sc.right-1):String.format("CalcAsyncEngine::CalculateFormulaBatched() for sheet:{0} range:({1},{2},{3},{4}) stateId:{5} viewport:(({6},{7})-({8},{9}))",
Wb,zd,oe,be,H,ha,"","","","");Z.ULS.sendTraceTag(508932947,0,50,Wb);this.zr.editRangeFormulas(ha,Ya);this.resumeRecalc();return!0}u1(H,ha,Ya,Wb,Sc){if(!this.zr)return Z.ULS.sendTraceTag(537170179,0,15,"CalcAsyncEngine::EvalFormulaRangeOnClone recalc engine is null"),Promise.reject("RecalcService is null");if(!Ya||!ha)return Z.ULS.sendTraceTag(524120779,0,15,`CalcAsyncEngine::EvalFormulaRangeOnClone inputs are null. originCell null: ${!Ya}, outputColumnRange null: ${!ha}`),Promise.reject("CalcAsyncEngine::EvalFormulaRangeOnClone: null inputs");
Z.ULS.shipAssertTag(537170178,0,Ya.isSingle,"CalcAsyncEngine::EvalFormulaRangeOnClone originCell must be a single cell.");const zd=tf.d(this.Ad.qa.la),be=this.zBc(zd);let oe=null;if(H){oe=[];for(const Xe of H)if(Xe.column!==Ya.left){H=Xe.row-1;var Ke=Xe.column-1;H=Le.Iba("EvalFormulaRangeOnClone.cell",zd,H,Ke,H,Ke);Ke=pd.EwaSettings.isChangeGateEnabled("OfficeVSO:7459428_TypedValueInCloneWrite")?nf(Xe.Qh,Xe.formulaBarText,Xe.oi):excelOnlineCalc.calc.valueCellData(Xe.text,Xe.text,Xe.oi,null);oe.push(excelOnlineCalc.calc.rangeWrite(H,
Ke))}}Ya=excelOnlineCalc.calc.cellLocation(Ya.top-1,Ya.left-1);ha=Le.Iba("EvalFormulaRangeOnClone.outputColumnRange",zd,ha.top-1,ha.left-1,ha.bottom-1,ha.right-1);Sc?(Wb=[excelOnlineCalc.calc.inferredRangeFormulaEdit(ha,Wb,Ya,be)],Sc=this.zr.evalOnClonedModel(oe,Wb,Sc)):(Wb=[excelOnlineCalc.calc.cellFormulaRangeFormulaEdit(ha,Wb,Ya,be)],Sc=this.zr.evalOnClonedModel(oe,Wb,Sc));this.resumeRecalc();return Sc}localizeEnglishFormula(H,ha,Ya){ha=excelOnlineCalc.calc.sheetCellLocation(tf.d(ha),Ya.top-1,
Ya.left-1);return this.zr.localizeEnglishFormula(H,ha)}Vlf(H){let ha=null;try{if(H)if(this.rEa=Hd.f(this.Ad).za.fGa(H),this.currentStateId=H.XMa,this.currentStateId<this.Bw||this.currentStateId===uf.a.Me)Z.ULS.sendTraceTag(537170176,0,50,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() hash:${this.rEa} blockRevision:${this.currentStateId} < lastUpdatedStateId:${this.Bw}`);else{if(this.Ohj(),1===H.kk.PaneType&&this.$fl(H.la),!this.wOh())if(ha=this.Ad.Vb.Uc("ModelUpdate",`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() Block Hash:${this.rEa} StateId:${this.currentStateId}`),
this.ufb=this.mY(H.la.sheetName))if(Hd.f(this.Ad).za.To.YLb(H.Yc)){var Ya=H.Nf;if(Ya){var Wb=Ya.getCalcBlockModel();if(Wb)if(this.pOh(Wb)){this.mg.pa(this.currentStateId).Ddb[this.rEa]=new Lc(Wb,H.la.sheetName);var Sc=H.oe;Sc?this.mAh(Sc.NamedObjects):Z.ULS.sendTraceTag(537170144,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel GetGridBlockContentResponse is null")}else Z.ULS.sendTraceTag(509117971,0,50,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel block is invalid (might be freeze panes removal)");
else Z.ULS.sendTraceTag(537170145,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model for block")}else Z.ULS.sendTraceTag(537170146,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model accessor for block:${this.rEa}`)}else Z.ULS.sendTraceTag(509117972,0,50,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel skipping block update because renderStateInfo doesn't have the block");else{const zd=!!(this.Ad.$d&32),be=this.mg.Bb(this.currentStateId)&&this.mg.pa(this.currentStateId).Ml?
this.mg.pa(this.currentStateId).Ml.length:0;Z.ULS.sendTraceTag(537170147,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel SheetName not found. Number of existing sheets ${be}, scratchPad:${zd}, sheetNameLength:${H.la.sheetName?H.la.sheetName.length:-1} Hash:${H.la.hash}`)}}else Z.ULS.shipAssertTag(537170177,0,!1,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() blockCacheItem is null")}finally{ha&&ha.stop()}}LXa(H){var ha;if(!this.mg.Bb(this.currentStateId))return Z.ULS.sendTraceTag(509646790,
0,15,`CalcAsyncEngine.getTableHeaders: stateId ${this.currentStateId} not found in gridCache`),null;const Ya=null===(ha=this.mg.pa(this.currentStateId))||void 0===ha?void 0:ha.Ml;if(!Ya||!Ya[0])return null;ha=Ya[0].Tda;if(!ha||!ha.Bb(H.name))return Z.ULS.sendTraceTag(509646789,0,15,`CalcAsyncEngine.getTableHeaders: table key found wasn't found in cached named objects list. cached named objects is null: ${null==ha}`),null;H=ha.pa(H.name);if(!H||!H.cK)return null;ha=[];for(const Wb of H.cK.lia)ha.push(Wb.value);
return ha}FTh(H,ha,Ya){var Wb=Hd.f(this.Ad).Ob(H[0].targetRange);ha=this.mBe(Wb,ha,"CopyPaste");if(0>ha)Z.ULS.sendTraceTag(508065925,0,15,`CalcAsyncEngine::CalculateFormulaForCopyPasteBatched(). Revision not valid. targetRevision:${ha}.`);else{Wb=[];for(const Sc of H)H=this.oZi(ha,Ya,Sc.sourceRange,Sc.targetRange),Wb.push(H);this.zr.editRangePaste(ha,Wb);this.resumeRecalc()}}oZi(H,ha,Ya,Wb){const Sc=tf.d(this.Ad.qa.la);ha=ha?tf.d(this.Ad.qa.getItemByName(ha)):Sc;const zd=this.zBc(Sc);Ya=Le.Iba("getRangePasteEdit.srcRange",
ha,Ya.top-1,Ya.left-1,Ya.bottom-1,Ya.right-1);Wb=Le.Iba("getRangePasteEdit.targetRange",Sc,Wb.top-1,Wb.left-1,Wb.bottom-1,Wb.right-1);Wb=excelOnlineCalc.calc.copyPasteRangePasteEdit(Wb,Ya,zd);H=zd?String.format("CalcAsyncEngine::getRangePasteEdit() from sheet:{0} to sheet:{1}, stateId:{2} viewport:(({3},{4})-({5},{6}))",ha,Sc,H,zd.row,zd.column,zd.lastRow,zd.lastColumn):String.format("CalcAsyncEngine::getRangePasteEdit() from sheet:{0} to sheet:{1}, stateId:{2} viewport:(({3},{4})-({5},{6}))",Sc,
H,"","","","");Z.ULS.sendTraceTag(537170142,0,50,H);return Wb}zBc(H){const ha=this.tPd();let Ya=null;ha?Ya=Le.Iba("GetViewport.viewport",H,ha.top-1,ha.left-1,ha.bottom-1,ha.right-1):Z.ULS.sendTraceTag(537170141,0,50,"CalcAsyncEngine::GetViewport() viewportRange is null, calc will use entire sheet...");return Ya}tPd(){const H=Hd.f(this.Ad);let ha=H.Ek;if(Hd.f(this.Ad).rb.mj){ha=H.pg(1).Ek;if(pd.EwaSettings.isChangeGateEnabled("OfficeVSO:5497152_JSCrash_At_CalcAsyncEngine_GetViewportRange")&&!ha)return Z.ULS.sendTraceTag(537170140,
0,15,"CalcAsyncEngine::GetViewportRange viewportRange is null."),null;ha.Sma(1,1);ha.Sma(3,1)}return ha}mBe(H,ha,Ya){let Wb;if(!this.zr||!H)return Z.ULS.sendTraceTag(537170139,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() recalc engine is null:${!this.zr}, modifiedCell is null:${!H}, operation:${Ya}`),-1;const Sc=H.cell.wC-1,zd=H.cell.YF-1;if(H.cell.aB){if(Wb=H.cell.aB.Snc,Wb===uf.a.Me)return Z.ULS.sendTraceTag(537170138,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() BlockRevision unknown for block:${H.cell.aB.Yc}, operation:${Ya}`),
-1}else return Z.ULS.sendTraceTag(537170137,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() GridBlockModelProxy is null cell:(${H.cell.wC},${H.cell.YF}), operation:${Ya}`),-1;if(Wb<this.Bw)return Z.ULS.sendTraceTag(537170136,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${Sc},${zd}) - blockRevision:${Wb} < lastUpdatedStateId:${this.Bw}, operation:${Ya}`),-1;if(Wb<this.currentStateId)return Z.ULS.sendTraceTag(537170135,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${Sc},${zd}) - blockRevision:${Wb} < currentStateId:${this.currentStateId}, operation:${Ya}`),
-1;ha&&!this.U$d&&(this.zr.setOnRecalcResults(ha),this.U$d=!0);return this.Tal()&&!this.f$b(2)?(Z.ULS.sendTraceTag(537170134,0,15,`CalcAsyncEngine.ValidateCalculateFormulaInit: UpdateData failed. operation:${Ya}`),-1):Wb}getFormulaBarText(H,ha,Ya){return ha&&ha.startsWith("'")?ha:H.cell.formulaBarText||Ya.toString()}E$h(H,ha,Ya){let Wb=null;this.ufb=this.mY(Ya);if(this.ecf()&&this.mg.pa(this.Bw).Ddb){const oe=this.mg.pa(this.Bw).Ddb[H];if(null===oe||void 0===oe?0:oe.L5b)Wb=oe.sbf}Ya=this.Omj(Wb,ha,
Ya);const {FRj:Sc,numberOfNonEmptyCells:zd,DRj:be}=this.$0h(Wb,ha,Ya);Z.ULS.sendTraceTag(50671754,0,50,`CalcAsyncEngine::CreateRangeUpdateCommands() completed for Block Hash:${H} StateId:${this.currentStateId} number of formulas ${Sc}, number of non-empty cells ${zd}, number of cells ${be}`)}Omj(H,ha,Ya){let Wb=!1;const Sc=Le.pGf(ha);if(H){const zd=Le.pGf(H);Kb.a.equals(zd,Sc,!1)&&(Wb=!0)}Wb?this.YAh(H,this.Bw,Ya):this.$Ah(ha,Ya);return Wb}ecf(){let H=!1;this.zr&&-1!==this.Bw&&(H=this.zr.stateIdAvailable(this.Bw));
return H&&this.mg.Bb(this.Bw)&&this.Bw<this.currentStateId}$0h(H,ha,Ya){let Wb=0,Sc=0,zd=0,be,oe;for(ha.reset();be=ha.getNextCell();)zd++,(be.value||be.formula)&&Sc++,oc.f(be.formula)&&Wb++,(oe=Ya?H.getCell(be.row,be.col):null)?this.V0h(ha,be,oe):this.ZAh(ha,be);if(Ya)for(H.reset();oe=H.getNextCell();)(be=ha.getCell(oe.row,oe.col))||this.b3e(H,oe);return{FRj:Wb,numberOfNonEmptyCells:Sc,DRj:zd}}vLk(){this.zr.setOnUpdateRequest(()=>{})}uLk(){this.zr.setOnUnresponsive((H,ha,Ya,Wb)=>{this.R6j(H,ha,Ya,
Wb)})}R6j(H,ha,Ya,Wb){Z.ULS.sendTraceTag(537170126,0,15,`CalcAsyncEngine.onUnresponsive: worker thread was unresponsive. timeout:${H}, waitTime:${ha}, timeoutCount:${Ya}, hasBeenClosed:${Wb}.`);Wb&&(this.Uyk(),this.Nfa())}Uyk(){this.de(null,null);this.y2d=this.U$d=!1;this.cee=0;this.Vde=this.Xde=this.Yde=this.Wde=-1}close(){this.zr.close()}clearCache(){this.zr.clearCache()}resumeRecalc(){this.zr.resumeRecalc()}IKk(){this.zr.setA1ReferenceStyle(!0)}Hlk(){if(this.instantaneousSupportInformationManager){var H=
this.instantaneousSupportInformationManager.lkj;const Ya=this.instantaneousSupportInformationManager.okj,Wb=this.instantaneousSupportInformationManager.nkj,Sc=this.instantaneousSupportInformationManager.mkj;var ha=!1;H!==this.Wde&&(ha=!0,this.Wde=H);Ya!==this.Yde&&(ha=!0,this.Yde=Ya);Wb!==this.Xde&&(ha=!0,this.Xde=Wb);Sc!==this.Vde&&(ha=!0,this.Vde=Sc);const zd=[];pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled",!1)&&(ha=excelOnlineCalc.calc.runExperiment("ExceLintExperiment",
null),zd.push(ha),ha=!0);pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnitExperiment",!1)&&(ha=excelOnlineCalc.calc.runExperiment("UnitExperiment",null),zd.push(ha),ha=!0);pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1)&&(ha=excelOnlineCalc.calc.runExperiment("AutocompleteExperiment",null),zd.push(ha),ha=!0);ha&&(H=excelOnlineCalc.calc.recalcServiceConfig(null,H,null,Ya,null,null,null,Wb,zd,Sc),this.zr.reconfigure(H))}}vNk(H){let ha=
null;if(this.mg.Bb(this.currentStateId))try{this.Kia=[],ha=this.Ad.Vb.Uc("ModelUpdate",`CalcAsyncEngine::SetUpdatedRanges() StateId:${this.currentStateId} UpdateTriggerData:${ze[H]}`),Af.a.forEach(this.mg.pa(this.currentStateId).Ddb,(Ya,Wb)=>{Wb.L5b||(this.E$h(Ya,Wb.sbf,Wb.sheetName),Wb.L5b=!0)},null),this.zr.updateRanges(this.currentStateId,this.Kia)}finally{ha&&ha.stop()}else Z.ULS.sendTraceTag(537170122,0,15,`CalcAsyncEngine::SetUpdatedRanges StateId:${this.currentStateId} does not exist in GridCache`)}uNk(){const H=
[],ha=this.ecf();var Ya=ha&&this.mg.pa(this.Bw).Ml&&this.mg.pa(this.Bw).Ml[0]&&this.mg.pa(this.Bw).Ml[0].uMc?this.mg.pa(this.Bw).Ml[0].Tda:null;this.fhf(Ya,this.mg.pa(this.currentStateId).Ml[0].Tda,null,this.Bw,H);this.mg.pa(this.currentStateId).Ml[0].uMc=!0;for(let Wb=1;Wb<this.mg.pa(this.currentStateId).Ml.length;Wb++)Ya=-1,ha&&this.mg.pa(this.Bw).Ml&&(Ya=this.rOd(this.mg.pa(this.currentStateId).Ml[Wb].tya.sheetName,this.Bw)),Ya=-1!==Ya&&this.mg.pa(this.Bw).Ml[Ya].uMc?this.mg.pa(this.Bw).Ml[Ya].Tda:
null,this.fhf(Ya,this.mg.pa(this.currentStateId).Ml[Wb].Tda,this.mg.pa(this.currentStateId).Ml[Wb].tya.sheetId,this.Bw,H),this.mg.pa(this.currentStateId).Ml[Wb].uMc=!0;this.zr.updateNamedObjects(this.currentStateId,H)}fhf(H,ha,Ya,Wb,Sc){if(void 0!==Ya&&null!==Ya){var zd=excelOnlineCalc.calc.undefinedNamesWrite(Ya);Sc.push(zd)}if(H){var be=!1;zd=[];var oe=[];if(ha)for(const Xe of ha){const ig=Xe.value;if(H.Bb(Xe.key)){var Ke=H.pa(Xe.key);Le.OPj(Ke,ig)?be=!0:(Ke=excelOnlineCalc.calc.namedObject(Xe.key,
null),zd.push(Ke),Le.Dnd(Xe.key,ig,oe))}else Le.Dnd(Xe.key,ig,oe)}for(const Xe of H)ha&&ha.Bb(Xe.key)||(H=excelOnlineCalc.calc.namedObject(Xe.key,null),zd.push(H));be&&(ha=excelOnlineCalc.calc.namedObjectsPromote(Ya,Wb),Sc.push(ha));0<zd.length&&(ha=excelOnlineCalc.calc.namedObjectsWrite(Ya,zd),Sc.push(ha));0<oe.length&&(Ya=excelOnlineCalc.calc.namedObjectsWrite(Ya,oe),Sc.push(Ya))}else if(ha){Wb=[];for(oe of ha)Le.Dnd(oe.key,oe.value,Wb);0<Wb.length&&(Ya=excelOnlineCalc.calc.namedObjectsWrite(Ya,
Wb),Sc.push(Ya))}}wOh(){const H=this.mg.pa(this.currentStateId).Ddb[this.rEa];return H?(Z.ULS.sendTraceTag(509117004,0,50,`CalcAsyncEngine::BlockPreviouslyHandled Block Hash:${this.rEa} StateId:${this.currentStateId} previously handled. LastUpdatedStateId: ${this.Bw}. sentToRecalcEngine: ${null===H||void 0===H?void 0:H.L5b}`),!0):!1}pOh(H){return 1===H.getColumnNumbers().length&&H.getColumnNumbers()[0]===Le.m5d+1?!1:!0}Jhj(){let H=!1;Hd.f(this.Ad).za.Ehb(ha=>{ha.state&1&&this.Ad.fa.Je===ha.We.Revision&&
(this.Vlf(ha),H=!0)});return H}Gjf(H,ha){var Ya=H.getRowNumbers(),Wb=H.getColumnNumbers();H=Ya[0]-1;Ya=Ya[Ya.length-1]-1;const Sc=Wb[0]-1;Wb=Wb[Wb.length-1]-1;ha=this.mY(ha);if(!ha){const zd=this.mg.Bb(this.currentStateId)&&this.mg.pa(this.currentStateId).Ml?this.mg.pa(this.currentStateId).Ml.length:0;Z.ULS.sendTraceTag(537170120,0,15,`CalcAsyncEngine::CreateBlockRangeLocation SheetName not found. Number of existing sheets ${zd}`)}return Le.Iba("CreateBlockRangeLocation",ha,H,Sc,Ya,Wb)}YAh(H,ha,Ya){if(Ya=
this.Gjf(H,Ya)){var Wb=Le.Mrc(H.getRowNumbers());H=Le.Mrc(H.getColumnNumbers());ha=excelOnlineCalc.calc.rangePromote(Ya,ha,Wb,H);this.Kia[this.Kia.length]=ha}}$Ah(H,ha){if(ha=this.Gjf(H,ha)){var Ya=Le.Mrc(H.getRowNumbers());H=Le.Mrc(H.getColumnNumbers());H=excelOnlineCalc.calc.rangeWrite(ha,null,Ya,H);this.Kia[this.Kia.length]=H}}V0h(H,ha,Ya){let Wb=null,Sc=0,zd=0;switch(ha.valueType){case 2:Wb=this.oPd(ha);var be=this.oPd(Ya);be=Kb.a.equals(be,Wb,!1);break;case 1:null===ha.value&&null===Ya.value?
be=!0:(Sc=parseFloat(ha.value),be=parseFloat(Ya.value)===Sc);break;default:null===ha.value&&null===Ya.value?be=!0:(zd=parseFloat(ha.value),be=zd===parseFloat(Ya.value))}be&&ha.valueType===Ya.valueType&&ha.ifmt===Ya.ifmt&&ha.formulaType===Ya.formulaType&&Kb.a.equals(Ya.formula,ha.formula,!1)||(void 0!==ha.formula&&null!==ha.formula||void 0!==ha.value&&null!==ha.value||void 0!==ha.text&&null!==ha.text||0!==ha.valueType?this.Ykc(H,ha,Wb,Sc,zd):this.b3e(H,ha))}mAh(H){if(this.Ad.wc&&this.Ad.wc.items)for(let zd=
0;zd<this.Ad.wc.count;zd++){var ha=this.Ad.wc.items[zd];if(2!==ha.type&&3!==ha.type)continue;var Ya=0,Wb=ha.name,Sc=Wb.lastIndexOf("!");if(0<Sc){Ya=Wb.substr(0,Sc);"'"===Ya.charAt(0)&&(Ya=Ya.substr(1,Ya.length-2));Ya=this.rOd(Ya,this.currentStateId);if(-1===Ya){Wb=this.mg.Bb(this.currentStateId)&&this.mg.pa(this.currentStateId).Ml?this.mg.pa(this.currentStateId).Ml.length:0;Z.ULS.sendTraceTag(595096334,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${Wb}`);
continue}Wb=Wb.substr(Sc+1)}Sc=this.mg.pa(this.currentStateId).Ml[Ya].Tda;let be=ha.usedRange;2===ha.type&&(be=Fb.a(ha));if(Sc.Bb(Wb)){if(Ya=Sc.pa(Wb),Ya.range=be,Ya.attributes=ha.attributes,2===Ya.type)if(Wb=ha.z4,!Ya.cK)Ya.cK=new Ta(Wb);else if(Wb)for(const oe of Wb.HeadersList)Ya.cK.lia.ga(oe.Index,oe.Name)}else if(Ya=this.mY(ha.sheetName)){Ya=new Jd(ha.type,ha.name,be,Ya,ha.attributes);if(2===Ya.type)if(ha.z4)Ya.cK=new Ta(ha.z4);else if(ha=Le.vBi(ha.name,H))Ya.cK=new Ta(ha.ColHeadersList);Sc.ga(Wb,
Ya)}else Wb=this.mg.Bb(this.currentStateId)&&this.mg.pa(this.currentStateId).Ml?this.mg.pa(this.currentStateId).Ml.length:0,Z.ULS.sendTraceTag(537170117,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${Wb}`)}}Ykc(H,ha,Ya,Wb,Sc){var zd,be=H.getRowNumbers()[ha.row]-1;H=H.getColumnNumbers()[ha.col]-1;be=Le.Iba("AddRangeUpdateCommand",this.ufb,be,H,be,H);H=null;let oe=ha.formula||ha.text;const Ke=excelOnlineCalc.calc.blankValue;let Xe=null;void 0!==ha.text&&
null!==ha.text||void 0!==ha.value&&null!==ha.value||(Ya="",Xe="This cell contains blanks only",0===ha.formulaType&&(oe=""));0!==(null!==(zd=ha.richValueType)&&void 0!==zd?zd:0)&&pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcCellRichValueType",!1)&&(Xe="This cell contains a rich value");zd=ha.formulaType;switch(ha.valueType){case 2:null!==Ya&&(0===zd&&(H=excelOnlineCalc.calc.valueCellData(oe,Ya,ha.ifmt,Xe)),1===zd&&(H=excelOnlineCalc.calc.cellFormulaCellData(oe,Ya,ha.ifmt,Xe)),2===
zd&&(H=excelOnlineCalc.calc.valueCellData("",Ke,0,"This cell is a part of an array")));break;case 1:isNaN(Wb)?Z.ULS.sendTraceTag(537170116,0,50,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${ha.row},${ha.col}) invalid numeric value`):(0===zd&&(H=excelOnlineCalc.calc.valueCellData(oe,Wb,ha.ifmt,Xe)),1===zd&&(H=excelOnlineCalc.calc.cellFormulaCellData(oe,Wb,ha.ifmt,Xe)),2===zd&&(H=excelOnlineCalc.calc.valueCellData("",Ke,0,"This cell is a part of an array")));break;case 3:isNaN(Sc)?Z.ULS.sendTraceTag(537170115,
0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${ha.row},${ha.col}) invalid boolean value`):(Ya=1===Sc?!0:!1,0===zd&&(H=excelOnlineCalc.calc.valueCellData(oe,Ya,ha.ifmt,Xe)),1===zd&&(H=excelOnlineCalc.calc.cellFormulaCellData(oe,Ya,ha.ifmt,Xe)),2===zd&&(H=excelOnlineCalc.calc.valueCellData("",Ke,0,"This cell is a part of an array")));break;case 4:isNaN(Sc)?Z.ULS.sendTraceTag(537170114,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${ha.row},${ha.col}) invalid error value`):(Ya=excelOnlineCalc.calc.errorValue(Sc),
0===zd&&(H=excelOnlineCalc.calc.valueCellData(oe,Ya,ha.ifmt,Xe)),1===zd&&(H=excelOnlineCalc.calc.cellFormulaCellData(oe,Ya,ha.ifmt,Xe)),2===zd&&(H=excelOnlineCalc.calc.valueCellData("",Ke,0,"This cell is a part of an array")));break;default:H=excelOnlineCalc.calc.valueCellData("",Ke,ha.ifmt,Xe)}H&&(ha=excelOnlineCalc.calc.rangeWrite(be,H,null,null),this.Kia[this.Kia.length]=ha)}ZAh(H,ha){switch(ha.valueType){case 2:this.Ykc(H,ha,this.oPd(ha),null,0);break;case 1:this.Ykc(H,ha,null,parseFloat(ha.value),
0);break;default:this.Ykc(H,ha,null,null,parseFloat(ha.value))}}b3e(H,ha){var Ya=H.getRowNumbers()[ha.row]-1;H=H.getColumnNumbers()[ha.col]-1;Ya=Le.Iba("AddRangeUpdateCommandEmptyCell",this.ufb,Ya,H,Ya,H);ha=excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,ha.ifmt,null);ha=excelOnlineCalc.calc.rangeWrite(Ya,ha,null,null);this.Kia[this.Kia.length]=ha}mY(H){H=this.rOd(H,this.currentStateId);return 0<H?this.mg.pa(this.currentStateId).Ml[H].tya.sheetId:null}rOd(H,ha){if(!this.mg.Bb(ha))return Z.ULS.sendTraceTag(537170113,
0,15,`CalcAsyncEngine.GetSheetInternalIndex StateId:${ha} does not exist in GridCache`),-1;const Ya=this.mg.pa(ha);return Ya.Ml?Ya.getSheetIndex(H):(Z.ULS.sendTraceTag(537170112,0,15,`CalcAsyncEngine.GetSheetInternalIndex sheetsInformation == null for StateId:${ha}`),-1)}OMk(){if(!this.mg.Bb(this.currentStateId)||!this.mg.pa(this.currentStateId).Ml.length)return Z.ULS.sendTraceTag(537170083,0,15,`CalcAsyncEngine::SetSheetNamesAndUsedRanges() No sheets information for StateId:${this.currentStateId} or StateId does not exist in GridCache`),
!1;const H=[];for(let ha=1;ha<this.mg.pa(this.currentStateId).Ml.length;ha++){const Ya=this.mg.pa(this.currentStateId).Ml[ha];Ya&&H.push(Ya.tya)}this.zr.updateSheetNames(this.currentStateId,H);this.zr.updateUnusedCells(this.currentStateId,this.mg.pa(this.currentStateId).yze);return!0}setNumberFormats(){if(this.instantaneousSupportInformationManager){var H=[];for(const ha of this.instantaneousSupportInformationManager.OJa){const Ya=excelOnlineCalc.calc.numberFormat(ha.IfmtIndex,ha.FormatString,ha.Builtin);
H.push(Ya)}this.zr.setNumberFormats(H,!0)}}ZIk(){if(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.Ze){var H=this.Mhj();if(!this.y2d||H)this.instantaneousSupportInformationManager.Ze.TrueValueString&&(this.trueName=this.instantaneousSupportInformationManager.Ze.TrueValueString),this.instantaneousSupportInformationManager.Ze.FalseValueString&&(this.falseName=this.instantaneousSupportInformationManager.Ze.FalseValueString),H=ge.CalcHelper.Jkf(this.instantaneousSupportInformationManager,
H),this.zr.setLocale(H),this.y2d=!0}}INk(){var H=null;if(void 0!==this.Ad.workbookContext.TimeZoneInformation&&null!==this.Ad.workbookContext.TimeZoneInformation){H=null;this.Ad.workbookContext.TimeZoneInformation.StandardDate.Month&&(H=excelOnlineCalc.date.dateTime(this.Ad.workbookContext.TimeZoneInformation.StandardDate.Year,this.Ad.workbookContext.TimeZoneInformation.StandardDate.Month,this.Ad.workbookContext.TimeZoneInformation.StandardDate.Day,this.Ad.workbookContext.TimeZoneInformation.StandardDate.Hour,
this.Ad.workbookContext.TimeZoneInformation.StandardDate.Minute,this.Ad.workbookContext.TimeZoneInformation.StandardDate.Second,this.Ad.workbookContext.TimeZoneInformation.StandardDate.DayOfWeek+1,this.Ad.workbookContext.TimeZoneInformation.StandardDate.Milliseconds,3));let ha=null;this.Ad.workbookContext.TimeZoneInformation.DaylightDate.Month&&(ha=excelOnlineCalc.date.dateTime(this.Ad.workbookContext.TimeZoneInformation.DaylightDate.Year,this.Ad.workbookContext.TimeZoneInformation.DaylightDate.Month,
this.Ad.workbookContext.TimeZoneInformation.DaylightDate.Day,this.Ad.workbookContext.TimeZoneInformation.DaylightDate.Hour,this.Ad.workbookContext.TimeZoneInformation.DaylightDate.Minute,this.Ad.workbookContext.TimeZoneInformation.DaylightDate.Second,this.Ad.workbookContext.TimeZoneInformation.DaylightDate.DayOfWeek+1,this.Ad.workbookContext.TimeZoneInformation.DaylightDate.Milliseconds,3));H=excelOnlineCalc.date.tzData(this.Ad.workbookContext.TimeZoneInformation.Bias,H,this.Ad.workbookContext.TimeZoneInformation.StandardBias,
ha,this.Ad.workbookContext.TimeZoneInformation.DaylightBias)}else Z.ULS.sendTraceTag(537170082,0,15,"CalcAsyncEngine.SetWorkbookProperties: TimeZoneInformation is null");H=excelOnlineCalc.calc.workbookProps(this.Ad.workbookContext.F1904,this.Ad.workbookContext.FDateCompatibility,H);this.zr.setWorkbookProps(H)}Nfa(){const H=pd.EwaSettings.Ra(570)?Aa.local:Aa.i4k,[ha,Ya]=[excelOnlineCalc.x10.PluginSchedulerSingleton.instance(),excelOnlineCalc.x10.GridImportManagerSingleton.instance()];this.hge=Qe.d(excelOnlineCalc.calc.createRecalcService(H,
ha,Ya));this.hge.continueWith(Wb=>{Wb.exception?Z.ULS.sendTraceTag(537170075,0,50,`CalcAsyncEngine.TryInitialize: Calc web worker failed: ${Wb.exception.toString()}`):(Z.ULS.sendTraceTag(537170078,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker is working as expected"),(this.zr=this.hge.result)?this.f$b(0)?this.uLk():Z.ULS.sendTraceTag(537170077,0,15,"CalcAsyncEngine.TryInitialize: UpdateData failed to initialize"):Z.ULS.sendTraceTag(537170076,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker result is null"))})}Mhj(){const H=
this.instantaneousSupportInformationManager.kta;if(!H||this.cee===H.length)return null;this.cee=H.length;return ge.CalcHelper.mkf(H)}Ohj(){if(!(this.mg.Bb(this.currentStateId)&&0<this.mg.pa(this.currentStateId).Ml.length)){this.mg.ga(this.currentStateId,new Ab);this.mg.pa(this.currentStateId).CSg(0,new le(null));var H=this.Ad.qa;for(let Wb=0;Wb<H.count;Wb++){var ha=Object(tc.a)(Eb.a,H.getItem(Wb));if(ha){void 0!==ha.sheetId&&null!==ha.sheetId&&void 0!==ha.name&&null!==ha.name&&ha.sheetId.length&&
ha.sheetName.length||Z.ULS.sendTraceTag(537170074,0,15,`CalcAsyncEngine::InitializeGridForStateId() invalid sheet - index:${Wb} Id:${ha.sheetId} Hash:${ha.hash} NameLength:${ha.name?ha.name.length:-1}`);var Ya=excelOnlineCalc.calc.sheetName(ha.sheetId,ha.name);this.mg.pa(this.currentStateId).CSg(Wb+1,new le(Ya));Ya=ha.usedRange.Zw();Ya=excelOnlineCalc.calc.rangeLocation(0,0,Ya.LastRow,Ya.LastColumn);ha=excelOnlineCalc.calc.unusedCellsUpdate(ha.sheetId,Ya);this.mg.pa(this.currentStateId).yze.push(ha)}else Z.ULS.sendTraceTag(537170073,
0,15,`CalcAsyncEngine.InitializeGridForStateId(): not sheet item for StateId:${this.currentStateId} sheet-index:${Wb}`)}}}$fl(H){if(H instanceof Eb.a){var ha=H.usedRange.Zw();ha=excelOnlineCalc.calc.rangeLocation(0,0,ha.LastRow,ha.LastColumn);ha=excelOnlineCalc.calc.unusedCellsUpdate(H.sheetId,ha);this.mg.pa(this.currentStateId).yze[H.index]=ha}}uYh(){for(const H of this.mg)H.key<this.Bw&&this.mg.remove(H.key)}oPd(H){H=H.value||H.text;if(void 0===H||null===H)H="";return H}Tal(){if(!this.mg.Bb(this.currentStateId))return!1;
let H=!1;Af.a.forEach(this.mg.pa(this.currentStateId).Ddb,(ha,Ya)=>{Ya.L5b||(H=!0)},null);return H}czd(H){const ha={};ha.reason=H;ha.kind=1;return ha}dHc(){return this.mg.Bb(this.currentStateId)&&this.mg.pa(this.currentStateId).Ml&&this.mg.pa(this.currentStateId).Ml[0]&&this.mg.pa(this.currentStateId).Ml[0].Tda?!0:!1}static x6h(H){const ha=[];if(null===H||void 0===H?0:H.lia)for(const Ya of H.lia)H=excelOnlineCalc.calc.columnData(Ya.key,Ya.value),ha.push(H);return ha}static OPj(H,ha){if(H.type!==ha.type||
H.attributes!==ha.attributes||!Kb.a.equals(H.fullName,ha.fullName,!1)||!H.range.equals(ha.range))return!1;if(!H.cK&&!ha.cK)return!0;if(!H.cK||!ha.cK||H.cK.lia.count!==ha.cK.lia.count)return!1;for(const Ya of H.cK.lia){let Wb;if(H=Ya.value)H=ha.cK.lia.Od(Ya.key),{value:Wb}=H,H=H.returnValue;if(!(H&&Wb&&Kb.a.equals(Ya.value,Wb,!1)))return!1}return!0}static Dnd(H,ha,Ya){var Wb=Le.Iba("NamedObject",ha.sheetId,ha.range.top-1,ha.range.left-1,ha.range.bottom-1,ha.range.right-1);if(2===ha.type){const Sc=
!!(ha.attributes&16),zd=!!(ha.attributes&8);ha=Le.x6h(ha.cK);Wb=excelOnlineCalc.calc.namedTableData(Wb,Sc,zd,ha);H=excelOnlineCalc.calc.namedObject(H,Wb)}else Wb=excelOnlineCalc.calc.namedRangeData(Wb),H=excelOnlineCalc.calc.namedObject(H,Wb);Ya.push(H)}static pGf(H){const ha=Sys.Serialization.JavaScriptSerializer.serialize(H.getRowNumbers());H=Sys.Serialization.JavaScriptSerializer.serialize(H.getColumnNumbers());return ha+H}static Mrc(H){let ha=null;if(1<H.length)for(let Ya=1;Ya<H.length;Ya++){let Wb=
0;for(;H[Ya-1]+1+Wb<H[Ya];)ha=ha||[],ha.push(H[Ya-1]+Wb),Wb++}return ha}static vBi(H,ha){if(!ha)return null;for(let Ya=0,Wb=ha.length;Ya<Wb;++Ya)if(Kb.a.equals(H,ha[Ya].Name,!1))return ha[Ya];return null}static Iba(H,ha,Ya,Wb,Sc,zd){const be=(oe,Ke,Xe,ig)=>{(0>Xe||Xe>=ig)&&Z.ULS.sendTraceTag(537170072,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${oe} invalid ${Ke}:${Xe}`)};void 0!==ha&&null!==ha||Z.ULS.sendTraceTag(537170071,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${H} sheetId is null`);
be(H,"top",Ya,Le.Ieg);be(H,"left",Wb,Le.m5d);be(H,"bottom",Sc,Le.Ieg);be(H,"right",zd,Le.m5d);return excelOnlineCalc.calc.sheetRangeLocation(ha,Ya,Wb,Sc,zd)}}Le.Ieg=1048576;Le.m5d=16384;Object(ia.a)(Le,"CalcAsyncEngine",null,[4]);const nf=(H,ha,Ya)=>{switch(H.type){case 2:return excelOnlineCalc.calc.valueCellData(ha,H.value,Ya,null);case 1:return excelOnlineCalc.calc.valueCellData(ha,parseFloat(H.value),Ya,null);case 3:return excelOnlineCalc.calc.valueCellData(ha,1===parseFloat(H.value),Ya,null);
case 4:return excelOnlineCalc.calc.valueCellData(ha,excelOnlineCalc.calc.errorValue(parseFloat(H.value)),Ya,null);default:return excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,Ya,null)}};class cf{constructor(){this.zua=this.Aua=this.pka=this.qka=this.y_a=!1}}Object(ia.a)(cf,"AbsoluteRelativeReferenceInfo",null,[]);var Te=a(27);class Wf{}Wf.lyg="#";Object(ia.a)(Wf,"Operators",null,[]);var Hf=a(1241);class ib{}ib.sheet="Sheet";ib.sheetRange="SheetRange";ib.document="Document";
ib.Jdj="Ident";Object(ia.a)(ib,"TraverseFormulaQualifierTypes",null,[]);var xc=a(1120),Kc=a(1025),ra=a(44),jb=a(67),vc=a(79),md=a(329);class Qd extends Sys.EventArgs{constructor(H){super();this.Lk=H}}Object(ia.a)(Qd,"EditedCellRecalcCompleteEventArgs",Sys.EventArgs,[]);var v;let Qb=v=class extends kb.a{constructor(H,ha){super();this.Rs=ha;this.fu=null;this.rac=!1;this.jle=this.instantaneousSupportInformationManager=this.tmc=this.Swa=null;this.V7d=new Map;this.zTe=null;this.xOc=Ya=>{Z.ULS.sendTraceTag(537170005,
0,50,"CalcManager.OnLocaleInformationAvailable() called");Ya.eUc(this.xOc);Ya.kta.length?this.XNc(Ya,Sys.EventArgs.Empty):(Z.ULS.sendTraceTag(537170004,0,50,"CalcManager.OnLocaleInformationAvailable() - waiting for functions information"),Ya.m4e(this.XNc))};this.XNc=Ya=>{Z.ULS.sendTraceTag(537170003,0,50,"CalcManager.OnFunctionsInfoReady called");Ya.Cie(this.XNc);this.u9k(Ya)};this.onContentReady=()=>{this.fu&&(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.iEc||
jb.Task.delay(0).continueWith(()=>{this.fu.f$b(1)?this.raiseEvent(v.Vvd):Z.ULS.sendTraceTag(508368722,0,15,"CalcManager.onContentReady: calc engine failed to update in the calc model")},0,null,vc.a.current))};this.Kjg=(Ya,Wb)=>{this.fu&&(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.iEc||this.fu.Vlf(Wb.he.block))};Z.ULS.sendTraceTag(537170067,0,50,"Creating CalcManager");this.WEc=!1;this.Qb=H;this.tA=Hd.f(H);this.j8c=null;this.da.aw(this.onContentReady);
this.da.za.Pbb(this.Kjg);this.JWf=new Promise((Ya,Wb)=>{this.pzk=Ya;this.Bhe=Wb});void Sb.a.Bd(kc.InstantaneousSupportInformationManagerService).then(Ya=>{Ya.Ze?(Z.ULS.sendTraceTag(537170066,0,50,"CalcManager.ctor: LocaleInformation already available..."),this.xOc(Ya,Sys.EventArgs.Empty)):(Z.ULS.sendTraceTag(537170065,0,50,"CalcManager.ctor: waiting for LocaleInformation..."),Ya.Bod(this.xOc))});this.J_a=pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8373394_setCellEstimationPrefetch")}kod(H){this.addHandler(v.Jrf,
H)}Nhg(H){this.raiseEvent(v.Jrf,new Qd(H))}wCh(H){this.addHandler(v.Jmd,H)}Crk(H){this.removeHandler(v.Jmd,H)}KMc(H){this.raiseEvent(v.Jmd,H)}yFb(H){this.addHandler(v.Vvd,H)}r3b(H){this.removeHandler(v.Vvd,H)}get mMa(){return this.njd}get C0(){return this.j8c}get da(){return this.tA}get $(){return this.Qb}get EI(){return this.zTe}get localeInfo(){return this.C0?this.C0.config.localeInfo:null}get config(){var H;return null===(H=this.C0)||void 0===H?void 0:H.config}dispose(){Z.ULS.sendTraceTag(537170064,
0,50,"CalcManager.Dispose called");void Sb.a.Bd(kc.InstantaneousSupportInformationManagerService).then(H=>{H.eUc(this.xOc);H.Cie(this.XNc)});this.da&&(this.da.Zz(this.onContentReady),this.da.za&&this.da.za.n3b(this.Kjg),this.tA=null);this.j8c=null;this.WEc=!1;this.J_a&&(Ca.a.vb(this.mMa),this.njd=null)}GTh(H,ha,Ya,Wb){this.fu&&this.fu.DTh(H,ha,Ya,void 0===Wb?null:Wb)}HTh(H,ha){return this.fu?this.fu.ETh(H,ha):!1}evalFormula(H,ha,Ya,Wb){return this.fu?this.fu.evalFormula(H,ha,Ya,Wb):Promise.reject("calc engine not initialized")}u1(H,
ha,Ya,Wb,Sc){return this.fu?this.fu.u1(H,ha,Ya,Wb,Sc):Promise.reject("CalcEngine is null")}localizeEnglishFormula(H,ha,Ya){return this.fu?this.fu.localizeEnglishFormula(H,ha,Ya):Promise.resolve(void 0)}LXa(H){if(!H)return Z.ULS.sendTraceTag(509649312,0,100,"CalcManager.GetTableHeaders: table is null"),null;if(!this.fu)return null;Z.ULS.shipAssertTag(537170059,0,2===H.type,"CalcManager.GetTableHeaders() - ActiveItem is not a table");return this.fu.LXa(H)}d6e(H,ha){if(!ha||2!==H.type)return!1;H=Fb.a(H);
return H.right-H.left+1===ha.length}cGd(H,ha){if(!this.Swa)return this.rac||Z.ULS.sendTraceTag(537170057,0,15,"CalcManager.ExtractReferenceWrappers - parser not initialized"),null;var Ya=this.RJb(Te.Range.Hc(1,1));Ya=this.Swa.parseFormula(excelOnlineCalc.parse.parseLocals(1,Ya.range),H);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(Ya))return Z.ULS.sendTraceTag(537170056,0,10,"CalcManager.ExtractReferenceWrappers - ParseFormula failed"),null;try{const Wb=null!==ha&&void 0!==ha?ha:this.da.ha.oa.activeCell,
Sc=excelOnlineCalc.location.gridCell(Wb.top-1,Wb.left-1),zd=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),be=excelOnlineCalc.location.sheetIndex(zd,this.$.qa.la.sheetId),oe=this.Y$h(Sc,be);this.jle||(this.jle=excelOnlineCalc.util.createResolver(this.X$h()));const Ke=excelOnlineCalc.parse.parseResultHelper.extractReferences(Ya,this.C0.config.localeInfo,!1,oe,this.jle);pd.EwaSettings.Ra(101)&&this.Iel(Ke,H);return Ke}catch(Wb){return Z.ULS.sendTraceTag(537170055,
0,10,`CalcManager.ExtractReferenceWrappers - exception: ${Wb.message}`),null}}H_d(H){if(!this.Swa||!this.tmc)return this.rac||Z.ULS.sendTraceTag(507912481,0,15,this.Swa||this.tmc?this.Swa?"CalcManager.isValidReference - analyzer not initialized":"CalcManager.isValidReference - parser not initialized":"CalcManager.isValidReference - parser and analyzer not initialized"),null;var ha=this.RJb(Te.Range.Hc(1,1));H=this.Swa.parseFormula(excelOnlineCalc.parse.parseLocals(1,ha.range),H);if(!excelOnlineCalc.util.isSuccess(H))return H.reason.kind===
excelOnlineCalc.parse.ReasonKind.NotFormulaString?"notFormulaString":"internalError";ha=this.tmc.checkFormula(excelOnlineCalc.analyze.analyzeLocalsName(ha),H.value);return excelOnlineCalc.util.isSuccess(ha)?ha.value.isWellFormed?"valid":"illFormed":"internalError"}extractLetVariables(H,ha){if(!this.Swa)return this.rac||Z.ULS.sendTraceTag(537170054,0,15,"CalcManager.ExtractLetVariables - parser not initialized"),null;const Ya=this.RJb(Te.Range.Hc(1,1));H=this.Swa.parseFormula(excelOnlineCalc.parse.parseLocals(1,
Ya.range),H);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(H))return Z.ULS.sendTraceTag(537170053,0,10,"CalcManager.ExtractLetVariables - ParseFormula failed"),null;try{return excelOnlineCalc.parse.parseResultHelper.extractLetVariables(H,ha,this.C0.config.localeInfo)}catch(Wb){return Z.ULS.sendTraceTag(537170052,0,10,`CalcManager.ExtractLetVariables - exception: ${Wb.message}`),null}}extractReferences(H,ha,Ya,Wb,Sc,zd){if(!ha)return Z.ULS.sendTraceTag(537170051,0,10,"CalcManager.ExtractReferences - sheetName is null"),
null;if(!Ya)return Z.ULS.sendTraceTag(537170050,0,10,"CalcManager.ExtractReferences - documentName is null"),null;const be=this.cGd(H,Sc);if(!be)return Z.ULS.sendTraceTag(537170049,0,15,"CalcManager.ExtractReferences - ExtractReferenceWrappers returned null"),null;try{return this.V9h(be,ha,Ya,H,Wb,Sc,zd)}catch(oe){return Z.ULS.sendTraceTag(537170048,0,10,`CalcManager.ExtractReferences - exception: ${oe.message}`),null}}RJb(H,ha){ha=void 0===ha?!0:ha;return H&&this.C0?this.C0.tai(this.C0.gci(),H.top-
1,H.left-1,ha):null}lGc(H,ha){H=this.Bja(H);if(!Object(md.c)(H))return null;ha=this.EI.parseEdit(ha,H.value);return excelOnlineCalc.util.isSuccess(ha)?ha.value.kind===Ie.a.formula:null}b_d(H){H=this.Bja(H);return Object(md.c)(H)?"Text"===H.value.valueType:null}j_f(H){H=this.Bja(H);return Object(md.c)(H)?"Date"===H.value.valueType&&!H.value.hasTime:null}Bja(H){if(null==this.EI)return Object(md.a)("Number formatter is null");if(null==this.instantaneousSupportInformationManager)return Object(md.a)("Instantaneous manager is null");
if(this.V7d.has(H))return Object(md.d)(this.V7d.get(H));if("number"===typeof H){var ha=this.ALf(H);if(null==ha)return Object(md.a)(`Invalid ifmt=${H}`);var Ya=ha.FormatString;ha=ha.Builtin}else Ya=H,ha=!1;Ya=this.EI.createFormat(Ya,ha);return excelOnlineCalc.util.isSuccess(Ya)?(this.V7d.set(H,Ya.value),Object(md.d)(Ya.value)):Object(md.a)("Could not create number format")}getWorksheetFuncId(H){return this.localeInfo.getWorksheetFuncId(H)}V9h(H,ha,Ya,Wb,Sc,zd,be){const oe={Items:[]};for(let ig=0;ig<
H.length;ig++){var Ke=H[ig];const Og={};Og.Start=Ke.span.start;Og.End=Ke.span.end;if(Sc||Ke.kind!==Hf.a.func)if(Sc||Ke.kind!==Hf.a.RCj){if(pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8719736_calcFormulaExtractReferencesCrossSheet")&&be&&!Ke.ref.qualifier)continue;if(!this.jji(Ke,ha,Ya))continue;var Xe=new cf;const mg=this.mZi(Ke,ha,Xe,Wb,zd);if(mg){const ih={};ih.Span=Og;ih.Range=mg;ih.IsRangeRef=Xe.y_a;ih.IsAbsoluteFirstRow=Xe.qka;ih.IsAbsoluteFirstColumn=Xe.pka;ih.IsAbsoluteSecondRow=Xe.Aua;ih.IsAbsoluteSecondColumn=
Xe.zua;ih.IsStructRef=Ke.kind===Hf.a.E_g;oe.Items.push(ih)}}else Ke=Ke.ref.value.oper.kind,Xe={},Xe.Span=Og,Xe.IsString=2===Ke,Xe.IsBoolean=4===Ke,Xe.IsNumber=1===Ke,oe.Items.push(Xe);else Og.End=Ke.span.start+Ke.ref.name.length,Ke={},Ke.Span=Og,Ke.IsFunction=!0,Ke.FunctionId=this.getWorksheetFuncId(Wb.substring(Og.Start,Og.End)),oe.Items.push(Ke)}oe.Items.sort((ig,Og)=>ig.Span.Start-Og.Span.Start);return oe}mZi(H,ha,Ya,Wb,Sc){if(H.kind===Hf.a.range)return Ya.y_a=!0,this.xif(H,ha,Ya,Wb);if(H.kind===
Hf.a.namedRange){Ya=H.ref;(H=this.$.wc.getItemByName(Ya.name))||(H=this.$.wc.getItemByName(ha+"!"+Ya.name));if(!(H&&H.sheetName&&H.usedRange&&Kb.a.equals(H.sheetName,ha,!0)))return null;ha=2===H.type?Fb.a(H):H.usedRange;return ra.p(ha,H)}if(H.kind===Hf.a.E_g){const zd=H.ref;zd.name?(Sc=this.$.wc.getItemByName(zd.name))||(Sc=this.$.wc.getItemByName(ha+"!"+zd.name)):Sc=pd.EwaSettings.isChangeGateEnabled("OfficeVSO:7907929_RecognizeTableRangeFromOriginCell")&&Sc?this.da.Eb.dg(Sc):this.da.Eb.dg(this.da.ha.oa.activeCell);
if(!(Sc&&Sc.sheetName&&Sc.usedRange&&Kb.a.equals(Sc.sheetName,ha,!0)))return null;Ya.y_a=!1;return this.xif(H,ha,Ya,Wb)}return null}xif(H,ha,Ya,Wb){H=H.ref;if(H.type){if(H.type===xc.a.column){var Sc=H.startIndex;H=H.endIndex;Ya.pka=Sc.kind===Kc.a.abs;Ya.zua=H.kind===Kc.a.abs;return this.createRange(0,Sc.index,uf.a.sf,H.index,ha)}if(H.type===xc.a.row)return Sc=H.endIndex,Ya.qka=H.startIndex.kind===Kc.a.abs,Ya.Aua=Sc.kind===Kc.a.abs,this.createRange(H.startIndex.index,0,H.endIndex.index,uf.a.rf,ha);
if(H.type===xc.a.cell){Sc=H.row;var zd=H.col;Ya.qka=Ya.Aua=Sc.kind===Kc.a.abs;Ya.pka=Ya.zua=zd.kind===Kc.a.abs;return this.ITa(H.span.end,Wb)&&(Ya=Te.Range.Hc(Sc.index+1,zd.index+1),Ya=this.da.Eb.XNf(Ya))?ra.q(Ya,ha):this.createRange(Sc.index,zd.index,Sc.index,zd.index,ha)}if(H.type===xc.a.range){Sc=H.top;zd=H.left;Wb=H.bottom;H=H.right;const be=Math.min(Sc.index,Wb.index),oe=Math.min(zd.index,H.index),Ke=Math.max(Sc.index,Wb.index),Xe=Math.max(zd.index,H.index);Ya.qka=Sc.kind===Kc.a.abs;Ya.Aua=Wb.kind===
Kc.a.abs;Ya.pka=zd.kind===Kc.a.abs;Ya.zua=H.kind===Kc.a.abs;return this.createRange(be,oe,Ke,Xe,ha)}Z.ULS.sendTraceTag(537170010,0,10,`CalcManager.CovertFormulaRefToRange: Unsupported formula ref type '${H.type}'`);return null}Z.ULS.sendTraceTag(537170011,0,15,"CalcManager.CovertFormulaRefToRange: traverseFormulaRef.Type is null");return null}ITa(H,ha){return ha.length>=H&&0<H&&ha.charAt(H-1)===Wf.lyg}uTh(H,ha,Ya){this.fu&&this.fu.FTh(H,ha,Ya)}ALf(H){return this.instantaneousSupportInformationManager&&
this.instantaneousSupportInformationManager.OJa&&this.instantaneousSupportInformationManager.OJa[H]&&this.EI?this.instantaneousSupportInformationManager.OJa[H]:null}a9i(H){var ha;"number"!==typeof H&&"string"!==typeof H?this.KMc(null):(H=this.Bja(H),Object(md.c)(H)?(H=H.value,Object(Nb.c)(H)||Object(Nb.c)(H.formatString)?this.KMc(null):this.KMc({formatString:H.formatString,builtIn:null!==(ha=H.isBuiltIn)&&void 0!==ha?ha:!1})):this.KMc(null))}toXLNumber(H){if(!this.EI)return null;H=excelOnlineCalc.numfmt.toXLNumber(this.config.mathpack,
this.EI,H);return excelOnlineCalc.util.isSuccess(H)?H.value:null}n7(H,ha,Ya,Wb,Sc,zd,be){if(!H)return Object(md.a)("Null");var oe=excelOnlineCalc.numfmt.renderCallback(Ya,Xe=>gridRenderer.CanvasRendererGlobals.measureTextWidth(Xe,Wb,!0,pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8633312_TextWidth")),zd),Ke=this.EI.renderValue(H,oe);if(!excelOnlineCalc.util.isSuccess(Ke))return Object(md.a)("Finalize");Ya=null;if(zd=excelOnlineCalc.numfmt.isHashesValue(Ke.value)){if(Ke=this.EI.renderHashesValue(Ke.value,
oe),!excelOnlineCalc.util.isSuccess(Ke))return Object(md.a)("Hashes")}else Ya=this.Rs.rId(H,Ke.value);Ke=Ke.value;H=excelOnlineCalc.numfmt.renderedValueToString(Ke);oe=this.Rs.HJf(Ke);Ke=this.Rs.TIf(Ke);return Object(md.d)({text:H,valueType:ha,fontColor:Ke,format:Sc,horizontalAlignment:oe,numFmt:Ya,isHashesValue:zd,cellValue:be})}Iel(H,ha){if(H)for(const Ya of H)Ya.ref.type&&Ya.ref.type===xc.a.cell&&(H=Ya.ref,v.vdk(H,ha)&&(H.span.end+=1,Ya.span.end+=1))}createRange(H,ha,Ya,Wb,Sc){const zd={};zd.FirstRow=
H;zd.FirstColumn=ha;zd.LastRow=Ya;zd.LastColumn=Wb;zd.SheetName=Sc;return zd}jji(H,ha,Ya){var Wb=H.ref.qualifier;if(!Wb)return!0;switch(H.ref.qualifier.type){case ib.sheet:return H=Wb.document,Kb.a.equals(Wb.sheet,ha,!0)&&(!H||Kb.a.equals(H.document,Ya,!0));case ib.sheetRange:return ha=this.$.qa.getItemByName(ha),Ya=this.$.qa.getItemByName(Wb.sheet1),Wb=this.$.qa.getItemByName(Wb.sheet2),!!ha&&!!Ya&&!!Wb&&(Ya.index<=ha.index&&ha.index<=Wb.index||Wb.index<=ha.index&&ha.index<=Ya.index);case ib.document:return Kb.a.equals(Wb.document,
Ya,!0);case ib.Jdj:return Wb=Wb.name,Kb.a.equals(Wb,ha,!0)||Kb.a.equals(Wb,Ya,!0);default:return Z.ULS.sendTraceTag(537170009,0,10,`CalcManager.GetQualifierData: Unsupported formula qualifier type '${Wb.type}'`),!1}}Vpj(){try{void 0!==excelOnlineCalc}catch(H){return!1}try{void 0!==excelOnlineCalc.location}catch(H){return!1}return!0}u9k(H){this.instantaneousSupportInformationManager=H;if(H.OJa.length&&H.kta.length)if(this.Vpj())try{this.j8c=new ge.CalcHelper(this.da.$,this.instantaneousSupportInformationManager),
this.Swa=this.C0.createParser(),this.tmc=this.C0.createAnalyzer(),this.zTe=this.C0.createNumberFormatter(),this.WEc=!0,Z.ULS.sendTraceTag(537170007,0,50,"CalcManager.TryInitializeInternal: calc initialized"),this.fu||(Z.ULS.sendTraceTag(537170006,0,50,"CalcManager creating calc engine"),this.fu=new Le(this.$)),this.pzk()}catch(ha){Z.ULS.sendTraceTag(507533056,0,10,`CalcManager.TryInitializeInternal: Exception while trying to create CalcManager. Exception message is: ${ha.message}`),pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8723645_RejectCalcPromiseOnError")&&
this.Bhe()}else Z.ULS.shipAssertTag(40939861,0,this.rac,"CalcManager.TryInitializeInternal: ExcelOnlineCalc is not loaded, any usage of it causes JS crash. Aborting calc initialization."),this.rac=!0,pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8723645_RejectCalcPromiseOnError")&&this.Bhe();else Z.ULS.sendTraceTag(537170008,0,15,`CalcManager.TryInitializeInternal: IInstantaneousSupportInformationManager locale information missing, cannot initialize calc. number formats count = ${H.OJa.length}, functions info count = ${H.kta.length}`),
pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8723645_RejectCalcPromiseOnError")&&this.Bhe()}Y$h(H,ha){const Ya={allowUnqualifiedCell:!0,wrapCellReferences:!0};Ya.config=this.C0.config;Ya.originGridCell=excelOnlineCalc.util.success(H);Ya.originSheet=excelOnlineCalc.util.success(ha);return Ya}X$h(){const H={};H.config=this.C0.config;H.getNameLoc=this.fu.getNameLoc;H.getContainingTable=this.fu.getContainingTable;H.getStructRefColumn=this.fu.getStructRefColumn;H.getStructRefSpecialRef=this.fu.getStructRefSpecialRef;
H.getDocumentLoc=this.fu.getDocumentLoc;H.getSheetIndex=this.fu.getSheetIndex;H.getSheetName=this.fu.getSheetName;H.getUserDefinedFuncLoc=this.fu.getUserDefinedFuncLoc;H.getSheetRangeIndexes=this.fu.getSheetRangeIndexes;return H}static vdk(H,ha){return ha.length>H.span.end&&ha.charAt(H.span.end)===Wf.lyg}};Qb.Jrf="ECRC";Qb.Jmd="ActiveCellNumberFormatChanged";Qb.Vvd="ClientDataFlushedToWorkerKey";Qb=v=Object(Ac.__decorate)([Object(Sb.d)(kc.CalcManagerService),Object(Ac.__param)(0,Object(kc.EwaControlService)()),
Object(Ac.__param)(1,Object(kc.CalcInterfaceAdapterService)()),Object(Ac.__param)(2,Object(kc.ExcelOnlineCalc)())],Qb);Object(ia.a)(Qb,"CalcManager",kb.a,[569,4]);var Dc=a(993);let id=class extends Vd.a{constructor(H){super();this.Dzk=[139,151,149,136,137,150];this.Tqf=(ha,Ya)=>{ha=Ya.oSj;this.VRk(ha)&&(Z.ULS.sendTraceTag(508441055,0,50,`CoreScriptsPrefetcher.downloadOnVersionChange: ClientVersion: ${ta.AFrameworkApplication.buildVersion}. ServerVersion: ${ha}`),Gc(ha,this.Dzk,this.Aa),this.E8f=ha)};
this.ma=H.ma;this.E8f=ta.AFrameworkApplication.buildVersion;this.ma&&this.ma.ED(this.Tqf)}dispose(){this.ma&&this.ma.xG(this.Tqf);this.ma=null}VRk(H){return!!H&&H!==this.E8f}};id=Object(Ac.__decorate)([Object(Sb.d)(kc.CoreScriptsPrefetcherService),Object(Ac.__param)(0,Object(kc.EwaControlService)())],id);Object(ia.a)(id,"CoreScriptsPrefetcher",Vd.a,[]);var Md=a(397);const Sd=(H,ha)=>{ha=void 0===ha?!1:ha;H=new Te.Range(H.top,H.left,H.bottom,H.right,!1,ha);if(ha&&(1>H.top||H.top>H.maxRows||1>H.bottom||
H.bottom>H.maxRows||H.top>H.bottom||1>H.left||H.left>H.maxColumns||1>H.right||H.right>H.maxColumns||H.left>H.right))throw Z.ULS.sendTraceTag(510247817,0,10,"Range.ValidateRange: range is invalid"),Error.argument("Range.ValidateRange: range is invalid");return H};var ne=a(1060),Ce=a(1117),Ge=a(961),Ee=a(120),Ue=a(987);const We={[0]:[45],[1]:[46]};class ya{constructor(H,ha){this.$=H;this.sessionStorage=ha;this.doUndo=async()=>{await Object(ne.d)(this.$)};this.highlightRangesOnGrid=async(Ya,Wb,Sc)=>
{this.highlightRanges(Ya,Wb,We[Sc])};this.openLearnMore=async()=>{Object(Ce.b)(this.$)};this.openCustomNumberFormat=async()=>new Promise(Ya=>{Object(ne.a)(this.$,Wb=>{Ya(Wb);Z.ULS.sendTraceTag(509617692,0,50,`HostAppCallbacks.openCustomNumberFormat: resolved with "${Wb?"OK":"Cancel"}"`)})});this.openFeedback=async Ya=>{Object(ne.e)(this.$,Ya)};this.sendOtelEvent=async Ya=>{Object(Ge.c)(Ya)};this.containsHiddenCells=Ya=>k(this.$,Ya);this.replaceMultipleStrings=async(Ya,Wb,Sc,zd)=>{Ya=Ya.map(be=>Sd(be,
!1));return n(this.$,Ya,Wb,Sc,{["SheetName"]:this.$.la.sheetName,["MatchCase"]:zd.matchCase,["MatchEntireCell"]:zd.matchEntireCell,["SearchAllSheets"]:!1,["ExcludeFormulaResult"]:!1,["SearchUp"]:!1,["SearchStrings"]:Wb,["ReplaceWholeWordOnly"]:zd.replaceWholeWordOnly})};this.trimWhitespace=async(Ya,Wb)=>{Ya=Ya.map(Sc=>Sd(Sc,!1));return u(this.$,Ya,Wb.map(h))};this.formatCells=async(Ya,Wb)=>{Ya=Ya.map(Sc=>Sd(Sc,!1));Wb={NumberFormatOptions:Object(ec.a)(new Ue.a,{NumberFormatCategory:-1,CustomFormatString:Wb}),
ValidMembers:32,NumberFormat:15};return m(this.$,Ya,Wb)};this.getIgnoredSuggestions=async()=>this.sessionStorage.getIgnoredSuggestions();this.addToIgnoredSuggestions=async Ya=>this.sessionStorage.addToIgnoredSuggestions(Ya);this.getAppliedSuggestions=async()=>this.sessionStorage.getAppliedSuggestions();this.addToAppliedSuggestions=async Ya=>this.sessionStorage.addToAppliedSuggestions(Ya);this.removeFromAppliedSuggestions=async Ya=>this.sessionStorage.removeFromAppliedSuggestions(Ya)}get grid(){return Hd.f(this.$)}highlightRanges(H,
ha,Ya){Ya=void 0===Ya?[45]:Ya;const Wb=this.grid.Ub;Wb.rl(Ya,!1,!0);Wb.pn(null,Ya,!1);if(null===H||void 0===H?0:H.length){const Sc=Md.a.a7a(tf.d(this.$.la),H.map(zd=>Sd(zd,!1)));Wb.HL(Sc,Ya,!0,void 0,!1);ha&&this.aNj(H)}Wb.update(!1)}aNj(H){if(null===H||void 0===H?0:H.length){const ha=this.grid;[H]=H.sort((Ya,Wb)=>Ya.top<Wb.top?-1:Ya.top>Wb.top?1:0);H=Te.Range.Hc(H.top,H.left);ha.Iy(H)||(Z.ULS.sendTraceTag(509617691,0,50,"HostAppCallbacks.moveViewportToRangeIfNeeded moving viewport"),ha.Ix(H,0,"DataCleansing"))}else Z.ULS.sendTraceTag(509617690,
0,10,"HostAppCallbacks.moveViewportToRangeIfNeeded no ranges to move viewport")}}Object(ia.a)(ya,"HostAppCallbacks",null,[]);class Cb{constructor(){this.annotations=[];this.appliedSuggestions=[];this.hostState={isFeedbackAllowed:!1,dataCultureTag:""};this.worksheetState={isInNamedSheetView:!1,isProtected:!1}}}Object(ia.a)(Cb,"DataCleansingHostState",null,[]);var qa=a(925);class qb{get metadata(){return this.M_}set metadata(H){this.M_=H}constructor(H){qa.a.assign(qb,this,H)}static getTypeName(){return"AugLoop_Tablelint_TableLintAnnotationBase"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(H){return qa.a.matchesTypesFor(H,
[qb.getTypeName()])}}qb.H_={T_:qb.getTypeName(),B_:qb.getBaseTypes()};class bc{get metadata(){return this.M_}set metadata(H){this.M_=H}constructor(H){qa.a.assign(bc,this,H)}static getTypeName(){return"AugLoop_Tablelint_TableLintAnnotation"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(H){return qa.a.matchesTypesFor(H,[bc.getTypeName()])}}bc.H_={T_:bc.getTypeName(),B_:bc.getBaseTypes()};class R{get metadata(){return this.M_}set metadata(H){this.M_=
H}constructor(H){qa.a.assign(R,this,H)}static getTypeName(){return"AugLoop_Tablelint_TableLintColumnAnnotation"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(H){return qa.a.matchesTypesFor(H,[R.getTypeName()])}}R.H_={T_:R.getTypeName(),B_:R.getBaseTypes()};class cb{get metadata(){return this.M_}set metadata(H){this.M_=H}constructor(H){qa.a.assign(cb,this,H)}static getTypeName(){return"AugLoop_Tablelint_TableLintWorksheetAggregateAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(H){return qa.a.matchesTypesFor(H,
[cb.getTypeName()])}}cb.H_={T_:cb.getTypeName(),B_:cb.getBaseTypes()};class zb{constructor(H){qa.a.assign(zb,this,H)}static getTypeName(){return"AugLoop_Tablelint_TableLintSuggestion"}static getBaseTypes(){return[]}static typeGuard(H){return qa.a.matchesTypesFor(H,[zb.getTypeName()])}}zb.H_={T_:zb.getTypeName(),B_:zb.getBaseTypes()};class V{constructor(H){qa.a.assign(V,this,H)}static getTypeName(){return"AugLoop_Tablelint_TableLintTextInconsistencySuggestion"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintSuggestion"]}static typeGuard(H){return qa.a.matchesTypesFor(H,
[V.getTypeName()])}}V.H_={T_:V.getTypeName(),B_:V.getBaseTypes()};class Ea{constructor(H){qa.a.assign(Ea,this,H)}static getTypeName(){return"AugLoop_Tablelint_TableLintNumberFormattingInconsistencySuggestion"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintSuggestion"]}static typeGuard(H){return qa.a.matchesTypesFor(H,[Ea.getTypeName()])}}Ea.H_={T_:Ea.getTypeName(),B_:Ea.getBaseTypes()};class pb{constructor(H){qa.a.assign(pb,this,H)}static getTypeName(){return"AugLoop_Tablelint_TableLintDateFormatSuggestion"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintSuggestion"]}static typeGuard(H){return qa.a.matchesTypesFor(H,
[pb.getTypeName()])}}pb.H_={T_:pb.getTypeName(),B_:pb.getBaseTypes()};class Jb{constructor(H){qa.a.assign(Jb,this,H)}static getTypeName(){return"AugLoop_Tablelint_TableLintExtraSpacesSuggestion"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintSuggestion"]}static typeGuard(H){return qa.a.matchesTypesFor(H,[Jb.getTypeName()])}}Jb.H_={T_:Jb.getTypeName(),B_:Jb.getBaseTypes()};class zc{get metadata(){return this.M_}set metadata(H){this.M_=H}constructor(H){qa.a.assign(zc,this,H)}static getTypeName(){return"AugLoop_ExcelCleanData_CleanDataResolverAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(H){return qa.a.matchesTypesFor(H,
[zc.getTypeName()])}}zc.H_={T_:zc.getTypeName(),B_:zc.getBaseTypes()};class Mc{get metadata(){return this.M_}set metadata(H){this.M_=H}constructor(H){qa.a.assign(Mc,this,H)}static getTypeName(){return"AugLoop_ExcelCleanData_ExtraSpacesColumnAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(H){return qa.a.matchesTypesFor(H,[Mc.getTypeName()])}}Mc.H_={T_:Mc.getTypeName(),B_:Mc.getBaseTypes()};class od{get metadata(){return this.M_}set metadata(H){this.M_=H}constructor(H){qa.a.assign(od,
this,H)}static getTypeName(){return"AugLoop_ExcelCleanData_ExtraSpacesTableAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(H){return qa.a.matchesTypesFor(H,[od.getTypeName()])}}od.H_={T_:od.getTypeName(),B_:od.getBaseTypes()};class Td{get metadata(){return this.M_}set metadata(H){this.M_=H}constructor(H){qa.a.assign(Td,this,H)}static getTypeName(){return"AugLoop_ExcelCleanData_RowsIdentityAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(H){return qa.a.matchesTypesFor(H,
[Td.getTypeName()])}}Td.H_={T_:Td.getTypeName(),B_:Td.getBaseTypes()};class Zd{get metadata(){return this.M_}set metadata(H){this.M_=H}constructor(H){qa.a.assign(Zd,this,H)}static getTypeName(){return"AugLoop_ExcelCleanData_DuplicatedRowsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(H){return qa.a.matchesTypesFor(H,[Zd.getTypeName()])}}Zd.H_={T_:Zd.getTypeName(),B_:Zd.getBaseTypes()};class xe{get metadata(){return this.M_}set metadata(H){this.M_=H}constructor(H){qa.a.assign(xe,
this,H)}static getTypeName(){return"AugLoop_ExcelCleanData_UnprintableCharactersColumnAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(H){return qa.a.matchesTypesFor(H,[xe.getTypeName()])}}xe.H_={T_:xe.getTypeName(),B_:xe.getBaseTypes()};class pe{get metadata(){return this.M_}set metadata(H){this.M_=H}constructor(H){qa.a.assign(pe,this,H)}static getTypeName(){return"AugLoop_ExcelCleanData_UnprintableCharactersTableAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(H){return qa.a.matchesTypesFor(H,
[pe.getTypeName()])}}pe.H_={T_:pe.getTypeName(),B_:pe.getBaseTypes()};class Re{get metadata(){return this.M_}set metadata(H){this.M_=H}constructor(H){qa.a.assign(Re,this,H)}static getTypeName(){return"AugLoop_ExcelCleanData_DataOutlierAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(H){return qa.a.matchesTypesFor(H,[Re.getTypeName()])}}Re.H_={T_:Re.getTypeName(),B_:Re.getBaseTypes()};class pf{constructor(H,ha){this.hj=H;this.tjg=ha;this.Kqa=!1;this.$s=new EventTarget;
this.f0g=(Ya,Wb)=>{if(Ya=Wb.annotation)switch(Wb.operationType){case 1:case 2:this.$s.dispatchEvent(new CustomEvent("suggestionsAnnotationReceived",{detail:Ya}));break;case 3:break;default:Z.ULS.sendTraceTag(508560024,306,15,`AnnotationsProvider.suggestionsAnnotationHandler Received unexpected OperationType:${Wb.operationType}`)}else Z.ULS.sendTraceTag(508560025,306,50,"AnnotationsProvider.suggestionsAnnotationHandler suggestionsAnnotation is null.")};this.uzk=(Ya,Wb)=>{if(Ya=Wb.annotation)switch(Wb.operationType){case 1:case 2:this.$s.dispatchEvent(new CustomEvent("resolverAnnotationReceived",
{detail:Ya}));break;case 3:break;default:Z.ULS.sendTraceTag(508560027,306,15,`AnnotationsProvider.resolverAnnotationHandler Received unexpected OperationType:${Wb.operationType}`)}else Z.ULS.sendTraceTag(508560028,306,50,"AnnotationsProvider.resolverAnnotationHandler: resolverAnnotation is null.")};Z.ULS.sendTraceTag(507777624,0,50,"AnnotationsProvider.constructor: AnnotationsProvider is created.");this.hj=H;this.tjg=ha}activateEvents(){this.Kqa?Z.ULS.sendTraceTag(508560026,0,50,"AnnotationsProvider.ActivateEvents: Events are already registered"):
(this.vnk(),this.Kqa=!0)}deactivateEvents(){this.Kqa&&(this.ial(),this.Kqa=!1)}registerSuggestionsAnnotationReceived(H){this.$s.addEventListener("suggestionsAnnotationReceived",ha=>{ha instanceof CustomEvent&&H(null===ha||void 0===ha?void 0:ha.detail)})}registerResolverAnnotationReceived(H){this.$s.addEventListener("resolverAnnotationReceived",ha=>{ha instanceof CustomEvent&&H(null===ha||void 0===ha?void 0:ha.detail)})}ial(){this.hj.unregister("DataCleansing")}vnk(){Z.ULS.sendTraceTag(574482312,0,
50,"AnnotationsProvider.registerCleanDataEvents: activate annotations");const H=this.hj.RT().NV("DataCleansing").LV(this.tjg).activateAnnotation({annotationType:zc.getTypeName(),ls:!0,Rna:this.uzk});pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AugLoop.sendCleanDataAnnotationsInResolver",!1)&&pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RegisterOnlyResolverAnnotation",!1)||(H.activateAnnotation({annotationType:R.getTypeName(),ls:!0,Rna:this.f0g}),H.activateAnnotation({annotationType:od.getTypeName(),
ls:!0,Rna:this.f0g}));pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FindDuplicatedRowsLinter",!1)&&H.activateAnnotation({annotationType:Zd.getTypeName(),ls:!0});pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FindUnprintableCharacters",!1)&&H.activateAnnotation({annotationType:pe.getTypeName(),ls:!0});pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FindDataOutliers",!1)&&H.activateAnnotation({annotationType:Re.getTypeName(),ls:!0});this.hj.register(H.build())}}
Object(ia.a)(pf,"AnnotationsProvider",null,[]);var vf=a(1244),Qf=a(149);class yf{constructor(H,ha){this.$=H;this.Yd=ha}getDependentFormulasSuggestionInfo(H,ha){const Ya=new Set;ha.forEach(Wb=>Ya.add(Sd(Wb)));H=x(this.$,this.Yd,H,Ya);return new Map(Array.from(H.entries(),Wb=>{var [Sc,zd]=Wb;return[Sc.toString(),Array.from(new Set(Array.from(zd,be=>be.toString())))]}))}getDataCulture(){return this.$.dataCultureTag}}Object(ia.a)(yf,"AnnotationsHostCallbacks",null,[]);class Df{constructor(H){this.$=H}readIgnoredSuggestionsString(){return new Promise(H=>
{Bb.C(this.$.ma.sa,9,ha=>{if(eb.a.zf(ha.Errors))Z.ULS.sendTraceTag(507577634,0,10,`RoamingOperations.readIgnoredSuggestions: encountered an error while reading roaming setting. Errors: ${eb.a.pc(ha.Errors)}`),H(null);else{const Ya=ha.Result?JSON.parse(ha.Result):[];Z.ULS.sendTraceTag(507577633,0,20,`RoamingOperations.readIgnoredSuggestions: ignoredSuggestionsIds.size: ${Ya.length}`);H(ha.Result)}},ha=>{this.uZj(ha);H(null)},null,null)})}writeIgnoredSuggestionsString(H){Bb.J(this.$.ma.sa,9,H,ha=>{this.P7j(ha)},
ha=>{this.N7j(ha)},null,null)}uZj(H){({data:H}=H);H=pc.a.te(H);Z.ULS.sendTraceTag(507577632,0,10,`RoamingOperations.onGetIgnoredSuggestionsFromRoamingFailure: encountered errors while reading roaming setting. Errors: ${eb.a.pc(H)}.`)}N7j(H){H=pc.a.te(H.data);Z.ULS.sendTraceTag(507577631,0,10,`RoamingOperations.onWriteRoamingFailed: encountered errors: ${eb.a.pc(H)}.`)}P7j(H){eb.a.zf(H.Errors)||!H.Result?Z.ULS.sendTraceTag(507577630,0,10,`RoamingOperations.onWriteRoamingSuccess: write Failed${eb.a.zf(H.Errors)?
", Encountered some errors. Errors: "+eb.a.pc(H.Errors):""}`):Z.ULS.sendTraceTag(507577629,0,50,"RoamingOperations.onWriteRoamingSuccess: write Succeeded")}}Object(ia.a)(Df,"RoamingOperations",null,[]);class pg{constructor(H,ha,Ya,Wb){this.$=H;this.o0=ha;this.zFd=Ya;this.wmc=Wb;this.ybg=new Set}LQf(){if(pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingFormulasDependencies",!1)&&tf.l(this.$.la)){var H=this.$.la.sheetId,ha=this.o0.sheetAnnotations(H);if(0<ha.length){let Ya=
!1;this.ybg.has(H)||(this.ybg.add(H),Ya=!0);this.logDependentSuggestionsInfo(H,ha,Ya)}}}logDependentSuggestionsInfo(H,ha,Ya){const Wb=this.zFd.annotationsUtils.getSuggestionAffectedRanges(ha);this.zFd.suggestionsTelemetryUtils.logDependentSuggestionsInfo(H,ha,Ya,this.wmc.getDependentFormulasSuggestionInfo(H,Wb))}}Object(ia.a)(pg,"SuggestionDependency",null,[]);var Zf=a(307),Tg=a(1116);class Wg{constructor(H){this.$=H;this.$of=!1;this.localStorage=new Zf.a;this.jyk()}async Pub(H,ha){if(this.$of)Z.ULS.sendTraceTag(509089825,
0,50,"DataCleansingBusinessBar.showBusinessBar: Data cleansing business bar was already shown.");else if(this.HSk()){var Ya=Object(Tg.b)(ha);this.lTa||(this.lTa=await Sb.a.resolve(kc.BusinessBarManagerService,{xa:1}));this.lTa.OUk(Ya.title,Ya.message,Ya.fZc,()=>{Z.ULS.sendTraceTag(508117194,0,20,"DataCleansingBusinessBar.showBusinessBar: Show suggestions was clicked.");this.uHa();this.ZJg();if(pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingBusinessBarOnDifferentSheet",!1)&&
ha.isDifferentThanActiveSheet){var Wb=ha.sheetName,Sc=void 0;Sc=void 0===Sc?Te.Range.Hc(1,1):Sc;Wb=ra.q(Sc,Wb);Object(Hd.f)(null).gotoSheetRangeKeepCurrentSelection(Wb,0,!1,"DataCleansing")}},()=>{Z.ULS.sendTraceTag(507789517,0,20,'DataCleansingBusinessBar.showBusinessBar: "X" button was clicked.');this.Bej();H()});this.$of=!0;Z.ULS.sendTraceTag(509089824,0,20,`DataCleansingBusinessBar.showBusinessBar: Data cleansing business bar with  ${ha.suggestionCount} suggestions.`)}else Z.ULS.sendTraceTag(507789518,
0,20,"DataCleansingBusinessBar.showBusinessBar: Data cleansing business bar should not be shown.")}uHa(){this.lTa&&this.lTa.GH(70)&&this.lTa.removeEntry(70)}HSk(){if(this.localStorage.Tf()){const H=this.localStorage.getItem("CleanDataBBClosedCount");return!H||this.Q1f()||3>parseInt(H,10)}Z.ULS.sendTraceTag(507789516,0,20,"DataCleansingBusinessBar.shouldShowBusinessBar: Local storage is not supported.");return!0}jyk(){this.Q1f()?this.ZJg():Z.ULS.sendTraceTag(507787410,0,20,"DataCleansingBusinessBar.resetBBCloseValuesIfNeeded: Last close was less than 30 days ago.")}Q1f(){if(this.localStorage.Tf()){const H=
this.localStorage.getItem("CleanDataBBClosedDate");if(H){const ha=Date.now()-parseInt(H,10),Ya=2592E6<ha;Z.ULS.sendTraceTag(507787409,0,20,`DataCleansingBusinessBar.isLastCloseAboveCooldown: timeFromLastClose: ${ha}, lastCloseDate: ${H}, isLastCloseAboveCooldown: ${Ya} `);return Ya}}return!1}ZJg(){this.localStorage.Tf()&&(this.localStorage.removeItem("CleanDataBBClosedCount"),this.localStorage.removeItem("CleanDataBBClosedDate"),Z.ULS.sendTraceTag(507789515,0,20,"DataCleansingBusinessBar.resetBBClosedCount"))}Bej(){if(this.localStorage.Tf()){let H=
this.localStorage.getItem("CleanDataBBClosedCount");H=H?(parseInt(H,10)+1).toString():"1";const ha=Date.now().toString();this.localStorage.setItem("CleanDataBBClosedCount",H);this.localStorage.setItem("CleanDataBBClosedDate",ha);Z.ULS.sendTraceTag(507789514,0,20,`DataCleansingBusinessBar.increaseBBClosedCount: new count is: ${H}, new date is: ${ha}`)}}}Object(ia.a)(Wg,"BusinessBar",null,[]);class ph{constructor(H){this.$=H;this.apf=!1}get isEnabled(){return pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingLearnMoreTeachingCallout",
!1)}show(){this.apf||(Z.ULS.sendTraceTag(508887310,0,20,"DataCleansing.showCallout: dispatchShowCalloutCommand."),Object(ne.b)(this.$),this.apf=!0)}}Object(ia.a)(ph,"TeachingCallout",null,[]);var Ug;(function(H){H.None="None";H.ShowBusinessBar="ShowBusinessBar";H.HideBusinessBar="HideBusinessBar"})(Ug||(Ug={}));class fh{constructor(H,ha,Ya){this.$=H;this.o0=ha;this.Gmi=Ya;this.isEnabled=!0;this.fCe=!1;this.businessBar=new Wg(this.$);this.s1g=new ph(this.$)}async h7i(H){this.fCe?this.businessBar.uHa():
await this.O3g(H)}async O3g(H,ha,Ya,Wb){if(this.isEnabled&&!this.fCe){var {action:Sc,businessBarData:zd}=await this.Gmi.getBusinessBarActionAndData(H,ha,Ya,Wb);switch(Sc){case Ug.ShowBusinessBar:zd&&await this.O7k(zd);break;case Ug.HideBusinessBar:this.businessBar.uHa()}}}kpf(){this.businessBar.uHa();this.isEnabled=!1}I1c(){this.s1g.isEnabled&&this.s1g.show()}async O7k(H){this.o0.pauseAugmentationLoop("triggerBusinessBar");await this.businessBar.Pub(()=>{this.ITj()},H);this.fCe=!0}ITj(){this.I1c()}}
Object(ia.a)(fh,"DiscoverabilityManager",null,[]);var rg=a(1245),jh;let zh=jh=class extends kb.a{constructor(H,ha,Ya,Wb){super();this.$=H;this.zFd=Ya;this.Yd=Wb;this.Y2=new Cb;this.l5j=async Sc=>{this.stateChanged();const zd=pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8972534_DataCleansingRefactorSheetOperationsInHostManager")?t(this.$):this.OOb();if(zd){var be=pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8972534_DataCleansingRefactorSheetOperationsInHostManager")?e(this.$,Sc.sheetId):this.getSheetName(Sc.sheetId),
oe;pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8971982_DataCleansingFixBBAppearingInNSVAndProtected")&&(oe=z(w(this.$,Sc.sheetId)));await this.KLb.O3g(zd,Sc.sheetId,be,oe);this.e0g.LQf()}};this.g0j=Sc=>{this.Y2.ignoredSuggestions=Sc;this.stateChanged()};this.cTj=Sc=>{this.Y2.appliedSuggestions=Sc;this.stateChanged()};this.Gj=async(Sc,zd)=>{this.E6g(zd.Vx);this.U_g(zd.la);this.stateChanged();if(Sc=pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8972534_DataCleansingRefactorSheetOperationsInHostManager")?
t(this.$):this.OOb())await this.KLb.h7i(Sc),this.e0g.LQf()};this.Fwa=()=>{this.stateChanged()};this.vv=()=>{this.$.fa.isEditMode?(void this.o0.activateEvents(),this.$.fa.xB(this.vv)):Z.ULS.sendTraceTag(507856794,0,20,"DataCleansingHostManager.onApplicationModeChanged: the workbook is not in edit mode, therefore we don't activate the events.")};this.Q6j=(Sc,zd)=>{Sc=void 0===Sc?"Unknown":Sc;Z.ULS.sendTraceTag(520987272,0,20,`DataCleansingHostManager.onUnrecoverableErrorOccurred: Received augmentation loop session close. ${JSON.stringify({["closeReason"]:vf.a[Sc],
["errorCode"]:zd})}`);pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8892675_RevertOtelEvents")&&Object(Ge.c)(Object(rg.a)(vf.a[Sc],zd));this.Y2.hostState.errorState=zd;this.stateChanged()};this.jea=(Sc,zd)=>{tf.l(zd.item)&&zd.item.Ih!==this.Y2.worksheetState.isProtected&&(Z.ULS.sendTraceTag(509613388,0,50,`DataCleansingHostManager.onSheetOptionsChanged: sheet protection has changed to ${zd.item.Ih}.`),this.stateChanged())};this.Hwa=(Sc,zd)=>{Sc=this.$;Object(Qf.c)(Sc)||pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInEditMode",
!1)&&Sc.isMobileMode?zd=!0:(Sc=zd.worksheetState,zd=!!zd.hostState.errorState||Sc.isInNamedSheetView||Sc.isProtected);zd&&this.KLb.kpf()};Z.ULS.sendTraceTag(507777625,0,50,"DataCleansingHostManager.constructor: DataCleansingHostManager is created.");this.sessionStorage=Ya.getOrCreateSessionStorage(new Df(this.$));this.sessionStorage.registerIgnoredSuggestionsChanged(this.g0j);pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddAppliedIdsToProps",!1)&&this.sessionStorage.registerAppliedSuggestionsChanged(this.cTj);
this.cJh=new ya(this.$,this.sessionStorage);ha=new pf(ha,this.Q6j);this.wmc=new yf(this.$,this.Yd);this.o0=pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8986384_sessionStorageAtAnnotationManager")?Ya.createAnnotationsManger(ha,this.sessionStorage,this.wmc):Ya.createAnnotationsManger(ha);this.o0.registerSheetAnnotationsChanged(this.l5j);ha=Ya.createDiscoverabilityEngine(this.o0,this.sessionStorage);this.KLb=new fh(this.$,this.o0,ha);this.$.fa.isEditMode?void this.o0.activateEvents():this.$.fa.CD(this.vv);
H.zn.mh(this.Gj);this.U_g(this.$.la);this.Llc(this.Hwa);this.$.cvd(()=>{this.stateChanged()});this.e0g=new pg(H,this.o0,Ya,this.wmc)}Llc(H){this.addHandler(jh.Zue,H)}OHg(H){this.removeHandler(jh.Zue,H)}k3k(){this.o0.pauseAugmentationLoop("taskPaneClosed");this.KLb.I1c()}o3k(){this.KLb.kpf();this.o0.resumeAugmentationLoop("taskPaneOpened")}dispose(){this.$.zn.xh(this.Gj);this.$.fa.xB(this.vv);this.E6g(this.$.la);super.dispose()}get state(){this.Y2.annotations=this.o0.allAnnotations();if(tf.l(this.$.la))if(pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8972534_DataCleansingRefactorSheetOperationsInHostManager"))this.Y2.worksheetState=
z(this.$.la);else{const H=this.$.la.Ih,ha=this.$.la.sheetId,Ya=this.$.la.sheetName;this.Y2.worksheetState.isInNamedSheetView=this.$.la.ue.Bq;this.Y2.worksheetState.isProtected=H;this.Y2.worksheetState.sheetId=ha;this.Y2.worksheetState.sheetName=Ya}this.Y2.hostState.isFeedbackAllowed=this.$.isFeedbackEnabled;pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AugLoop.TableLint_EnableDateFormat",!1)&&(this.Y2.hostState.dataCultureTag=this.$.dataCultureTag);return this.Y2}stateChanged(){this.raiseEvent(jh.Zue,
this.state)}U_g(H){tf.l(H)&&(H.ue.Vbb(this.Fwa),H.Ybb(this.jea))}E6g(H){tf.l(H)&&(H.ue.y3b(this.Fwa),H.pUc(this.jea))}OOb(){if(tf.l(this.$.la))return this.$.la.sheetId;Z.ULS.sendTraceTag(507510927,0,50,"DataCleansingHostManager.getActiveSheetId: active item is not a sheet.")}getSheetName(H){var ha;return null===(ha=this.$.qa.items.find(Ya=>tf.l(Ya)&&Ya.sheetId===H))||void 0===ha?void 0:ha.sheetName}};zh.Zue="scek";zh=jh=Object(Ac.__decorate)([Object(Sb.d)(kc.DataCleansingHostManagerService),Object(Ac.__param)(0,
Object(kc.EwaControlService)()),Object(Ac.__param)(1,Object(kc.AugmentationLoopManagerService)()),Object(Ac.__param)(2,Object(kc.ExcelCleanDataService)()),Object(Ac.__param)(3,Object(kc.CalcManagerService)())],zh);Object(ia.a)(zh,"DataCleansingHostManager",kb.a,[]);var zg=a(267),Zg=a(306),ab=a(282),Ua=a(17),hd=a(960),qe=a(20),Ae=a(684);const ef=qe.a.Dui;let Tf=class extends zg.a{constructor(H,ha){let Ya=document.getElementById(H.Oc+Zc.a.stf);Ya||(Ya=hd.a("div",H.Oc+Zc.a.stf,"cui-taskpane"));super(Ya);
this.cS=0;this.d8a=!1;this.jd=()=>{this.dA(!1)};this.$=H;this.taskPaneManager=ha;Zg.a(H).hl(this);this.$.Sj(this.jd);this.isVisible=!1}xqa(H){this.addHandler("EnrichmentTaskPaneVilibilityChanged",H)}Bxa(H){this.removeHandler("EnrichmentTaskPaneVilibilityChanged",H)}eFh(H){this.addHandler("EnrichmentTaskPaneOnFocus",H)}Stk(H){this.removeHandler("EnrichmentTaskPaneOnFocus",H)}get isVisible(){return super.isVisible}set isVisible(H){super.isVisible=H;this.raiseEvent("EnrichmentTaskPaneVilibilityChanged")}get ij(){return this.isVisible}get tf(){return ab.a.bni}get Q6a(){return 10}get gs(){return ef}get titleText(){return pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8207038_EnrichmentTaskPaneHeaderFix")?
ta.AFrameworkApplication.ea.ka("IsNewStringEnabled")?CommonUiStrings.EnrichmentPaneTitle:CommonUIStrings.l_EnrichmentPaneTitle:"Enrichment"}get cL(){return 300}get isResizable(){return!1}get ud(){return this.domElement}get height(){return this.taskPaneManager.v0c.offsetHeight}get OG(){return this.taskPaneManager.dib(this.ud,this.titleText,this.cL,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.cL)}GQ(){return this.d8a}v2(){return this.d8a}dispose(){this.$&&
this.$.ro(this.jd);this.taskPaneManager=this.$=null;super.dispose()}Nj(H,ha){ha||this.raiseEvent("EnrichmentTaskPaneOnFocus");return!ha}zk(H){return Ua.DOMElementExtensions.Ki(this.ud,H)}Hm(){}fo(){}dA(H){(this.isVisible=this.d8a=H)?this.taskPaneManager.PC("EnrichmentTaskPane",this.OG):this.taskPaneManager.hideTaskPane("EnrichmentTaskPane");H||(Hd.f(this.$).Nj(!0,!1),this.$.Sg())}};Tf=Object(Ac.__decorate)([Object(Sb.d)(kc.EnrichmentTaskPaneService),Object(Ac.__param)(0,Object(kc.EwaControlService)()),
Object(Ac.__param)(1,Object(kc.ReactTaskPaneManagerService)()),Object(Ac.__param)(2,Object(Ae.b)()),Object(Ac.__param)(3,Object(kc.CommonUIStringsService)())],Tf);Object(ia.a)(Tf,"EnrichmentTaskPane",zg.a,[563,4,229,24]);var Nf=a(545),wg=a(325);Object(Sb.b)(kc.ExcelCleanDataService,{we:"singleton"})(async H=>{await Object(wg.loadChunkWithDynamicScriptLoader)("excelCleanData",{xa:H.xa});H=window.excelCleanData.ExcelCleanDataGlobal;H.init(new Nf.a);Z.ULS.shipAssertTag(507777623,0,!!H,"Failed to initialize ExcelCleanDataGlobal");
return H});var Uf=a(39);let lg=class{constructor(H,ha){this.$=H;this.shortcutKeyManager=ha;this.isMac=Uf.a.isMac}dispose(){this.$=null}D$b(){this.L$k&&(this.MS[0].title=this.MS[2].title=this.Vwb(void 0),this.MS[1].title=this.p$b(void 0),this.MS[1].shortcut=this.isMac?this.shortcutKeyManager.Ji(192):this.shortcutKeyManager.Ji(154));var H=this.aPd(this.MS[1]);const ha=this.aPd(this.MS[2]);H=[appChrome.actions.setControlCustomTooltip(this.MS[0].commandId,this.aPd(this.MS[0])),appChrome.actions.setControlCustomTooltip(this.MS[1].commandId,
H),appChrome.actions.setControlCustomTooltip(this.MS[2].commandId,ha)];appChrome.api.dispatch(H)}get L$k(){this.MS||(this.MS=[],this.MS.push(this.uzd("Undo",this.Vwb(2),Yb.a.instance.La(765),this.isMac?this.shortcutKeyManager.Ji(191):this.shortcutKeyManager.Ji(153))),this.MS.push(this.uzd("Redo",this.p$b(2),Yb.a.instance.La(766),this.isMac?this.shortcutKeyManager.Ji(192):this.shortcutKeyManager.Ji(154))),this.MS.push(this.uzd("UndoRedo",this.Vwb(2),"",this.isMac?this.shortcutKeyManager.Ji(191):this.shortcutKeyManager.Ji(153))));
return this.MS}uzd(H,ha,Ya,Wb){return{commandId:H,title:ha,description:Ya,shortcut:Wb,Zaj:Wb?!0:!1}}aPd(H){let ha;ha=H.title;H.Zaj&&(ha+=" "+H.shortcut);"UndoRedo"!==H.commandId&&(ha+="\n\n"+H.description);return ha}Vwb(H){switch(H){case 1:case 0:return H=Yb.a.instance.La(81);case 3:return H=Yb.a.instance.La(84);case 2:return H=Yb.a.instance.La(83);case 4:return H=Yb.a.instance.La(82);default:return H=Yb.a.instance.La(81)}}p$b(H){switch(H){case 1:case 0:return H=Yb.a.instance.La(78);case 2:return H=
Yb.a.instance.La(80);case 4:return H=Yb.a.instance.La(79);default:return H=Yb.a.instance.La(78)}}};lg=Object(Ac.__decorate)([Object(Sb.d)(kc.ExtendedTooltipsService),Object(Ac.__param)(0,Object(kc.EwaControlService)()),Object(Ac.__param)(1,Object(kc.ShortcutKeyManagerService)())],lg);Object(ia.a)(lg,"ExtendedTooltipsManager",null,[4]);var Kg=a(1061),If=a(87);let hg=class extends kb.a{constructor(H){super();this.statusBarManager=null;this.tooltip=this.Vmb="";this.isVisible=!1;this.T8b=-1;this.sheetName=
null;this.Hj=()=>{this.i$b();this.$.fa.Av(this.Hj)};this.rr=()=>{this.i$b();this.$.fa.yxa(this.rr)};this.zng=()=>{this.i$b(!0);this.$.fa.yxa(this.zng)};this.K3j=ha=>{if(this.isVisible&&this.Vmb){ha=this.da.Eb.dg(ha);var Ya=this.$.qa.la;if(ha?ha.hasAutoFilter&&ha.XSa:Ya&&0===Ya.CB&&Ya.hasAutoFilter&&Ya.XSa)this.z6b(Yb.a.instance.ia(2421),!0,ha?this.$Od(ha.name):this.ZOd()),this.Yp()}};this.X_b=()=>{this.i$b()};this.$=H;this.da=Hd.f(this.$);this.ha=this.da.ha;this.oa=this.ha.oa;this.ha.Vq(this.X_b);
this.$.ra.Vc(29,ha=>{this.statusBarManager=ha;ha.FJ(this)});this.$.fa.ug?this.i$b():this.$.fa.Nr(this.Hj)}Js(H){this.addHandler("FilteredResultsStateChangedEventKey",H)}vs(H){this.removeHandler("FilteredResultsStateChangedEventKey",H)}Yp(){this.Wj("QueryFilteredResultsButton")&&this.raiseEvent("FilteredResultsStateChangedEventKey")}Opc(){this.isVisible&&this.Vmb&&(this.z6b(null,!1,null),this.Yp())}Pcl(H,ha){this.T8b=H;this.sheetName=ha}z6b(H,ha,Ya){this.Vmb=H;this.isVisible=ha;this.tooltip=Ya}zya(H,
ha,Ya){Ya=void 0===Ya?-1:Ya;null!==H&&H.HasFilters?(this.Pcl(ha?Ya:-1,this.$.qa.la.name),Ya=new Te.Range(H.FirstRow+1,H.FirstColumn+1,H.LastRow+1,H.LastColumn+1,!1,!1),Ya=ha?this.da.Eb.dg(Ya):void 0,this.z6b(this.Vmb=String.format(Yb.a.instance.Ib(233),H.NumRowsFiltered,H.LastRow-H.FirstRow),!0,ha?this.$Od(null===Ya||void 0===Ya?void 0:Ya.name):this.ZOd()),this.Yp()):(Z.ULS.sendTraceTag(507852319,0,50,"FilteredResultsStatusBarManager: EwaResult is null. All filters of that object will be cleared"),
this.Opc())}i$b(H){H=void 0===H?!1:H;if(!this.da.isEditing&&!this.da.nk){var ha=!1,Ya=this.$.qa.la,Wb=this.da.Eb.dg(this.oa.activeCell);if(Wb&&(H||Wb.objectId!==this.T8b))if(this.T8b=Wb.objectId,this.sheetName=Ya.name,Wb.hasAutoFilter&&Wb.XSa)this.z6b(Yb.a.instance.ia(2421),!0,this.$Od(Wb.name)),ha=!0;else{this.Opc();return}else if(!Wb&&Ya&&0===Ya.CB){if(!this.sheetName||0<this.T8b||H||Ya.name!==this.sheetName)this.sheetName=Ya.name,Ya.hasAutoFilter&&Ya.XSa?Ya.bD&&(this.z6b(Yb.a.instance.ia(2421),
!0,this.ZOd()),ha=!0):this.Vmb&&this.Opc();this.T8b=-1}ha&&this.Yp()}}Wj(){return pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowFilteredResultsInStatusBar",!1)}vq(H,ha){if("QueryFilteredResultsButton"!==H)return!1;ha[Kg.a.Visible]=this.isVisible;ha[Kg.a.LabelText]=this.Vmb;window.setTimeout(()=>{appChrome.api.dispatch(appChrome.actions.setControlCustomTooltip(If.a.IGd,this.tooltip))},0);return!0}dispose(){this.$&&this.ha.vr(this.X_b);this.statusBarManager&&(this.statusBarManager.OI(this),
this.statusBarManager=null);this.$=null;super.dispose()}$Od(H){return Yb.a.instance.ia(2422)+`${H?": "+H:""}`}ZOd(){return Yb.a.instance.ia(2423)}};hg=Object(Ac.__decorate)([Object(Sb.d)(kc.FilteredResultsStatusBarManagerService),Object(Ac.__param)(0,Object(kc.EwaControlService)())],hg);Object(ia.a)(hg,"FilteredResultsStatusBarManager",kb.a,[4,360,217]);const gh=Object(kd.b)("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"),mc=Object(kd.c)(gh);class sd{constructor(H){this.$=H}get gqd(){return"Excel"}get campaignId(){return"aed9de6b-d4e7-4878-988a-9dfec66fed9e"}get version(){return 1}get currentVersion(){return 0}get Noj(){return this.isEnabled()&&
pd.EwaSettings.Ra(295)}get $_a(){return this.isEnabled()&&pd.EwaSettings.Ra(297)}get xmb(){return pd.EwaSettings.Ra(296)}get ECi(){return null}get ufg(){return 24}get KLg(){return 4E3}get J4b(){return this.$.ta.WebServiceBase||""}isEnabled(){if(ta.AFrameworkApplication.ea?ta.AFrameworkApplication.ea.ka("IsAnonymousUser"):1)return!1;const H=ta.AFrameworkApplication.tc?Object(tc.a)(String,ta.AFrameworkApplication.tc.AudienceGroup):"";return"Unknown"!==H&&"Automation"!==H}}Object(ia.a)(sd,"FirstRunExperienceLauncherSettings",
null,[661]);let ie=class{constructor(H){this.eCf=Object(kd.a)(mc);this.sCi=new sd(H);this.Wse()}Wse(){this.eCf&&this.eCf.Wse(this.sCi)}};ie=Object(Ac.__decorate)([Object(Sb.d)(kc.FirstRunExperienceService),Object(Ac.__param)(0,Object(kc.EwaControlService)())],ie);Object(ia.a)(ie,"FirstRunExperienceManager",null,[561]);var te=a(241),Ve=a(1243);let kf=class{constructor(H,ha){this.r0a=1;this.aqa=[];this.active=!1;this.Vz=()=>{const Ya=this.da.ePd();if(!(0>=Ya||Ya===this.r0a)){var Wb=!1,Sc=[],zd=[];for(var be=
this.aqa.length-1;0<=be;be--){var oe=this.aqa[be];if(this.dPd(oe)>Ya||oe.bottom<Ya)Sc.push(oe),this.aqa.splice(be,1),Wb=!0}for(be=this.je.rangeList.length-1;0<=be;be--){oe=this.je.rangeList[be];const Ke=this.dPd(oe);Ke<=Ya&&oe.bottom>=Ya&&!(Ke<=this.r0a&&oe.bottom>=this.r0a)&&oe.eua&&(zd.push(oe),Wb=!0)}if(Wb){oe=this.da.J0b;for(const Ke of oe)for(const Xe of Ke)for(const ig of Xe)this.VXh(ig,Sc,zd)}else Z.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");
this.r0a=Ya}};this.Qng=(Ya,Wb)=>{Wb.isRow||Wb.ipd(this.MCc)};this.Rng=(Ya,Wb)=>{Wb.isRow||(this.je.rangeList.length||this.deactivate(),Wb.ije(this.MCc))};this.MCc=(Ya,Wb)=>{if(this.ie())this.activate();else if(Ya=this.active,this.deactivate(),!Ya){Z.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlock: detected an opportunity for bailing out");return}(Wb=Wb.qp)&&this.oue(Wb)};this.$qg=(Ya,Wb)=>{!this.da.Au&&(this.ie()?this.activate():(Ya=this.active,this.deactivate(),Ya||
Z.ULS.sendTraceTag(537157651,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),Wb=Wb.qp)&&(pd.EwaSettings.QYd()?this.oue(Wb):(Ya=Ve.a(Wb.wRd),this.oue(Wb)&&Wb.nRg(Ya)))};this.onActiveItemChanged=()=>{this.da.rb.gr?this.deactivate():this.activate()};this.je=H;this.da=ha;this.$=ha.$;H.Tod(this.$qg);ha.dEh(this.Qng);ha.eEh(this.Rng);this.$.qa.mh(this.onActiveItemChanged);this.$.wc.mh(this.onActiveItemChanged);this.X7e(Ya=>{Ya.ipd(this.MCc)});this.ie()&&(this.activate(),
this.Vz(this,null))}dispose(){this.deactivate();this.da&&(this.je.Yie(this.$qg),this.da.Zsk(this.Qng),this.da.$sk(this.Rng),this.$.qa.xh(this.onActiveItemChanged),this.$.wc.xh(this.onActiveItemChanged),this.X7e(H=>{H.ije(this.MCc)}));this.da=this.je=this.aqa=null}j1c(H,ha,Ya){if(!tf.b(this.$.la)||this.$.fa.isNamedObjectViewMode||this.da.rb.g7a)return ha&&Z.ULS.sendTraceTag(509166923,0,50,"HeaderSnappingFeature.toggleHeaderSnapping: Header snapping should be disabled in named object view or in top row frozen."),
!0;const Wb=Ya.ZOf();if(!Wb)return Z.ULS.sendTraceTag(508368917,0,15,`HeaderSnappingFeature.toggleHeaderSnapping: HeaderNumbers should have been initialized, isActivate=${ha}, headerViewBlock.hashCode=${Ya.hashCode}`),!1;var Sc=Wb.length;if(Wb[Sc-1]<H.left)return!1;var zd=lf.HelperMethods.tF(new te.a(Wb),0,Sc,H.left,lf.HelperMethods.gO);if(0>zd)return!1;const be=H.E2g,oe=H.I9e;Sc=Math.min(be.length+zd,Sc);let Ke=0;if(!oe)return Z.ULS.sendTraceTag(509220160,0,10,"HeaderSnappingFeature.toggleHeaderSnapping: autoFilterDatas should be initialized."),
!1;for(;zd<Sc;zd++){const Xe=Wb[zd],ig=oe[Ke];ha?(Ya.updateCellText(zd,be[Ke]),Ya.updateCellAlignment(zd,!0),ig&&(Ya.activateCellAutoFilter(zd,ig),this.jAh(H,Ke,Xe)),pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8161977_fixHeaderSnappingAutoFilterNone")&&Ya.b8g(zd,!0)):(Ya.updateCellText(zd,Te.Range.dK(Xe)),Ya.updateCellAlignment(zd,!1),Ya.deactivateCellAutoFilter(zd),pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8161977_fixHeaderSnappingAutoFilterNone")&&Ya.b8g(zd,!1),this.Tji(Xe));ha&&Ya.pKk();
Ke++}Ya.Jl("HeaderSnappingFeature::toggleHeaderSnapping");H.g6a=ha;return!0}jAh(H,ha,Ya){void Sb.a.Bd(kc.ContextMenuManagerService).then(Wb=>{Wb.fxc.U_j(H,ha,Ya)})}Tji(H){void Sb.a.Bd(kc.ContextMenuManagerService).then(ha=>{ha.fxc.V_j(H)})}VXh(H,ha,Ya){if(H.CUh()){for(var Wb=ha.length-1;0<=Wb;Wb--)this.j1c(ha[Wb],!1,H)&&(Z.ULS.sendTraceTag(509166921,0,50,"HeaderSnappingFeature.checkTablesForSnapping: Table deactivation succeeded"),ha.splice(Wb,1));for(ha=Ya.length-1;0<=ha;ha--)Wb=Ya[ha],this.j1c(Wb,
!0,H)&&(Z.ULS.sendTraceTag(509166919,0,50,"HeaderSnappingFeature.checkTablesForSnapping: Table activation succeeded"),this.aqa.push(Wb))}else Z.ULS.sendTraceTag(509166922,0,15,"HeaderSnappingFeature.checkTablesForSnapping: headerViewBlock can't be snapped")}oue(H){var ha=H.ZOf();if(!ha)return Z.ULS.sendTraceTag(508368916,0,15,`HeaderSnappingFeature.snapHeadersAfterGetRange: HeaderNumbers should have been initialized, headerViewBlock.hashCode=${H.hashCode}`),!1;const Ya=ha[0];ha=ha[ha.length-1];const Wb=
this.U3i(Ya,ha);let Sc=!1;for(let zd=this.aqa.length-1;0<=zd;zd--){const be=this.aqa[zd];ha>=be.left&&Ya<=be.right&&(this.j1c(be,!1,H),this.aqa.splice(zd,1),Sc=!0)}for(let zd=0,be=Wb.length;zd<be;zd++)this.j1c(Wb[zd],!0,H)&&(this.aqa.push(Wb[zd]),Sc=!0);return Sc}activate(){this.ie()&&!this.active&&(this.da.view.Ks(this.Vz),this.active=!0)}deactivate(){this.active&&(this.da.view.xs(this.Vz),this.active=!1)}ie(){return tf.b(this.$.la)&&!this.$.fa.isNamedObjectViewMode&&0>=this.da.rb.TE&&0<this.je.rangeList.length}X7e(H){const ha=
this.da.J0b;for(const Ya of ha)for(const Wb of Ya)for(const Sc of Wb)H(Sc)}U3i(H,ha){const Ya=[];if(!this.active)return Ya;this.r0a=this.da.ePd();for(let Wb=this.je.rangeList.length-1;0<=Wb;Wb--){const Sc=this.je.rangeList[Wb];Sc.bottom>=this.r0a&&this.dPd(Sc)<=this.r0a&&Sc.left>=H&&Sc.right<=ha&&Sc.eua&&Ya.push(Sc)}return Ya}dPd(H){const ha=this.da.Eb.dg(H);return ha&&this.je.d1f(H,ha.usedRange.topLeft)?H.top+1:H.top}};kf=Object(Ac.__decorate)([Object(Sb.d)(kc.HeaderSnappingFeatureService),Object(Ac.__param)(0,
Object(kc.TableManagerService)()),Object(Ac.__param)(1,Object(kc.GridViewService)())],kf);Object(ia.a)(kf,"HeaderSnappingFeature",null,[4]);var Of=a(1056),Sf=a(257),fg=a(144),Pg=a(430),lh=a(73),Qg=a(942);Object(Sb.b)(kc.InProductMessagingService,{we:"singleton"})(async()=>{const H=Object(kd.f)(Of.a),ha=()=>{Object(kd.d)(Sf.a).execute(Ya=>{void Ya.isFeatureEnabled("MsoPremiumBadge",!0).then(Wb=>{!Wb&&Ya.isFreemiumUpsellEnabled()&&H.m2d();return null})})};lh.a.Eg.ms?fg.a.get_instance().Mg(16,()=>{ha()}):
ha();return H});class tg extends Pg.a{constructor(H){super();this.XSd=null;this.$=H;this.ri()}create(){const H=Object(Qg.a)(this.$.ra,361,()=>this.v8h());this.Uf(H)}v8h(){this.XSd=Object(kd.f)(Of.a);lh.a.Eg.ms?fg.a.get_instance().Mg(16,()=>{this.jXf()}):this.jXf();return this.XSd}jXf(){Object(kd.d)(Sf.a).execute(H=>{H.isFeatureEnabled("MsoPremiumBadge",!0).then(ha=>{!ha&&H.isFreemiumUpsellEnabled()&&this.XSd.m2d();return null})})}static Ea(H){H.ra.zc(362,new tg(H))}}Object(ia.a)(tg,"InProductMessagingManagerFactory",
Pg.a,[]);var Dh=a(1122),Gg=a(258),gg=a(689);class Hg extends Sys.EventArgs{constructor(){super()}}Object(ia.a)(Hg,"NumberFormatsUpdatedEventArgs",Sys.EventArgs,[]);var Lg=a(57),qh=a(42),Dg=a(752);class mh{constructor(H){this.data=H}}Object(ia.a)(mh,"NumberFormatDataHolder",null,[]);var Rg;let xg=Rg=class extends kb.a{constructor(H){super();this.l1d=uf.a.Me;this.Etd=null;this.rxb=this.vJc=!1;this.Wig=(ha,Ya)=>{var Wb;(ha=Hd.f(this.$))&&(Ya=null!==(Wb=Ya.cell)&&void 0!==Wb?Wb:ha.Ob(null))&&this.Fna(Ya.cell.oi,
!0)};this.QYj=ha=>{this.isActive()&&(eb.a.Ls(ha.Errors)||!ha.Result?(ha=ha.Errors?ha.Errors.map(Ya=>JSON.stringify(Ya)).join(","):"None",Z.ULS.sendTraceTag(537155726,0,50,`GetCategoryFromServer failed, ignoring - server errors: ${ha}`)):(ha=ha.Result,Z.ULS.sendTraceTag(537155725,0,50,`Updating number format category cache, format index = ${ha.Index}, category = ${ha.Category}`),this.qLk(ha.Index,ha.Category),this.raiseEvent(Rg.xud,new Dh.a(ha.Index,ha.Category),this)))};this.refresh=()=>{Z.ULS.sendTraceTag(537155722,
0,50,"InstantaneousSupportInformationManager.Refresh: start refresh");this.dpc();this.isActive()&&this.fa.$b.allowEdits&&(this.rxb||this.lr&&!(this.fa.Cw>this.l1d)?this.v4c():(Z.ULS.sendTraceTag(537155721,0,50,"InstantaneousSupportInformationManager.Refresh: getting instantaneous support information."),this.nMd=gg.a(this.$.ma.sa,this.lr?this.lr.Digest:"",this.zZj,this.yZj,null,null)),Z.ULS.sendTraceTag(537155720,0,50,"InstantaneousSupportInformationManager.Refresh: getting functions info."),this.gJf())};
this.ing=ha=>{Z.ULS.sendTraceTag(537155716,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListFailed failed, status = ${ha.data.status}, HTTP status = ${ha.data.httpStatus}.`);this.jXa=null};this.bZ=()=>{this.rxb=!1;this.fa.wG(this.bZ);this.O4a(this.vJc?Rg.$qe:Rg.w7d)};this.yd=(ha,Ya)=>{Z.ULS.sendTraceTag(537155715,0,50,"InstantaneousSupportInformationManager.OnSessionIdChanged called");Gg.a(Ya)&&this.O4a(Rg.$qe)};this.fg=()=>{Z.ULS.sendTraceTag(537155714,0,50,"InstantaneousSupportInformationManager.OnWorkbookMetadataChanged called");
3!==this.$.workbookContext.CalcMode&&this.G7d(0===this.$.workbookContext.CalcMode)};this.de=()=>{Z.ULS.sendTraceTag(537155713,0,50,"InstantaneousSupportInformationManager.OnWorkbookOpened called");this.O4a(Rg.$qe);3!==this.$.workbookContext.CalcMode&&this.G7d(0===this.$.workbookContext.CalcMode)};this.qZj=(ha,Ya,Wb)=>{Z.ULS.sendTraceTag(537155712,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess called.");this.jXa=null;this.isActive()?ha.StateId===uf.a.Me?(Z.ULS.sendTraceTag(537155682,
0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: no session, waiting for session."),this.v4c()):!ha.Result||this.z5&&this.z5.length?this.O4a(Rg.w7d):this.urg(ha,Ya,Wb):Z.ULS.sendTraceTag(537155683,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: manager is inactive, skipping.")};this.urg=ha=>{this.z5=ha.Result;Z.ULS.sendTraceTag(537155681,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListSuccess refreshing functions info list, returned ${this.z5?
this.z5.length:-1} functions.`);ha=!1;if(this.z5){for(const Ya of this.z5)Ya&&(this.eEf[Ya.NameUI.toLocaleUpperCase()]=Ya.FunctionIndex.toString(),Ya.NameUI!==Ya.NameDataStrings&&(this.eEf[Ya.NameDataStrings.toLocaleUpperCase()]=Ya.FunctionIndex.toString(),ha=!0),this.IFi.ga(Ya.FunctionIndex,Ya.NameUI));this.raiseEvent(Rg.VId,Sys.EventArgs.Empty,this)}ha&&Z.ULS.sendTraceTag(537155680,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess NameDataStrings functions names were used.")};
this.zZj=ha=>{if(this.isActive())if(Z.ULS.shipAssertTag(537155679,0,!!this.$,"null ewaControl"),this.vJc=!1,this.l1d=ha.StateId,this.l1d===uf.a.Me)this.vJc=!0,this.v4c();else{if(ha.Result){var Ya=this.lr;this.lr=ha.Result;Z.ULS.sendTraceTag(537155678,0,50,`InstantaneousSupportInformation updated, new result digest: ${this.lr.Digest}.`);ha=[];if(Ya)ha=Rg.sVi(Ya.NumberFormats,this.lr.NumberFormats);else for(Ya=0;Ya<this.lr.NumberFormats.length;Ya++)this.TMc.ga(Ya,this.lr.NumberFormats[Ya].NumberFormatCategory);
for(const Wb of ha)this.TMc.ga(Wb,this.lr.NumberFormats[Wb].NumberFormatCategory);this.raiseEvent(Rg.Y7d,new Hg(ha),this);this.raiseEvent(Rg.l$f)}this.O4a(Rg.w7d)}};this.yZj=ha=>{this.isActive()&&(10===ha.data.status?Z.ULS.sendTraceTag(537155677,0,50,"Instantaneous support information request cancelled."):(Z.ULS.sendTraceTag(21311555,0,10,`Failed to update instantaneous support information, status = ${ha.data.status}, HTTP status = ${ha.data.httpStatus}.`),this.vJc=!0,this.v4c()))};Z.ULS.sendTraceTag(537155737,
0,50,"InstantaneousSupportInformationManager ctor start");this.fa=H.fa;this.$=H;this.lr=this.jXa=this.nMd=this.H2b=null;this.TMc=new gf.a;this.bPb=new gf.a;this.z5=[];this.IFi=new gf.a;this.eEf={};this.fa.Vk(this.yd);this.$.Ul(this.de);Hd.f(this.$).ha.JCa(this.Wig);this.fa.au(this.fg);this.O4a(Rg.GVf);Z.ULS.sendTraceTag(537155736,0,50,"InstantaneousSupportInformationManager ctor end")}Bod(H){this.addHandler(Rg.Y7d,H)}eUc(H){this.removeHandler(Rg.Y7d,H)}YCh(H){this.addHandler(Rg.xud,H)}$rk(H){this.removeHandler(Rg.xud,
H)}m4e(H){this.addHandler(Rg.VId,H)}Cie(H){this.removeHandler(Rg.VId,H)}MEh(H){this.addHandler(Rg.l$f,H)}get Ze(){return this.lr?this.lr.LocaleInformation:null}get OJa(){return this.lr?this.lr.NumberFormats:[]}get kta(){this.z5&&this.z5.length||this.gJf();return this.z5}get lkj(){return this.lr&&void 0!==this.lr.InstantaneousCalcWebWorkerPrecisionSamplingRate&&null!==this.lr.InstantaneousCalcWebWorkerPrecisionSamplingRate?this.lr.InstantaneousCalcWebWorkerPrecisionSamplingRate:Rg.Gdi}get okj(){return this.lr&&
void 0!==this.lr.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate&&null!==this.lr.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate?this.lr.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate:Rg.Kdi}get nkj(){return this.lr&&void 0!==this.lr.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate&&null!==this.lr.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate?this.lr.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate:Rg.Jdi}get mkj(){return this.lr&&void 0!==this.lr.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate&&
null!==this.lr.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate?this.lr.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate:Rg.Idi}get $Sb(){return this.lr?this.lr.InstantaneousCalcWebWorkerRenderingTimeLimitInMs:Rg.Hdi}get iEc(){return null!==this.Etd?this.Etd:!1}q9k(H){let ha;if(!H)return{returnValue:!0,category:"General"};let Ya;ha="";if(!(()=>{let Wb=this.Fna(H,!1);({category:Ya}=Wb);return Wb})().returnValue)return{returnValue:!1,category:ha};ha=this.T3h(Ya);return{returnValue:!0,
category:ha}}T3h(H){let ha="";switch(H){case 0:ha="General";break;case 1:ha="Number";break;case 2:ha="Currency";break;case 3:ha="Accounting";break;case 4:ha="Date";break;case 5:ha="Time";break;case 6:ha="Percentage";break;case 7:ha="Fraction";break;case 8:ha="Scientific";break;case 9:ha="Text";break;case 10:ha="Special";break;case 11:ha="Custom"}return ha}Fna(H,ha){let Ya,Wb=(()=>{let Sc=this.TMc.Od(H,0);({value:Ya}=Sc);return Sc})().returnValue;!Wb&&0<H&&this.$&&(Z.ULS.sendTraceTag(537155735,0,50,
`InstantaneousSupportInformationManager.TryGetNumberFormatCategory: failed to get category from numberFormatIndexToCategoryCache ${H}`),this.ILi(H),ha&&(Ya=this.HLi(H),Wb=!0),Dg.a(H,this.$.bJ)&&(Ya=6));return{returnValue:Wb,category:Ya}}Vqj(H){let ha=0;if((()=>{let Ya=this.Fna(H,!0);({category:ha}=Ya);return Ya})().returnValue)return 6===ha;Z.ULS.sendTraceTag(537155733,0,50,`InstantaneousSupportInformationManager.IsFormatInPercentageCategory: failed to get category from format index ${H}`);return!1}fEi(H){this.fa.yc&&
(Z.ULS.sendTraceTag(537155730,0,50,"InstantaneousSupportInformationManager.ForceRefreshFunctionInfo: Forcing refresh of functions"),this.jXa=se.o(this.$.ma.sa,{FilterType:0},Ic.c(this.urg,H),this.ing,null,null,null))}mDf(){this.O4a(Rg.GVf)}w7h(){return Object(Nb.c)(this.Ze.ErrorNames)?(Z.ULS.shipAssertTag(508699781,0,!1,"ErrorNames undefined"),this.FOi()):this.Ze.ErrorNames.map((H,ha)=>excelOnlineCalc.calc.errorTypeName(ha+1,H))}FOi(){const H=[],ha=Object.keys(uf.a.errorNames);for(let Ya=0;Ya<ha.length;Ya++){const Wb=
excelOnlineCalc.calc.errorTypeName(Ya+1,ha[Ya]);Wb&&H.push(Wb)}return H}G7d(H){this.Etd=H}ILi(H){if(this.bPb&&this.$){var ha;if(!(()=>{let Wb=this.bPb.Od(H);({value:ha}=Wb);return Wb})().returnValue||ha.isCompleted){Z.ULS.sendTraceTag(537155728,0,50,`Getting number format category for format index: ${H}`);var Ya=gg.c(this.$.ma.sa,H,this.QYj,null,null,null);Ya&&this.bPb.ga(H,Ya)}}else Z.ULS.sendTraceTag(537155729,0,15,"GetCategoryFromServerAsync called on disposed InstantaneousSupportInformationManager instance, skipping")}HLi(H){return 1<=
H&&8>=H?1:9<=H&&12>=H?2:13===H||14===H?6:15===H?8:17===H|18===H?7:19===H?4:16===H||20<=H&&29>=H||31===H?11:30===H?9:32<=H&&35>=H?3:0}isActive(){const H=void 0===this.fa||null===this.fa,ha=!H&&this.fa.yc;Z.ULS.sendTraceTag(537155727,0,50,`InstantaneousSupportInformationManager.IsActive: instantaneous support information manager active:${ha} - sessionStateManager IsNullOrUndefined: ${H}`);return ha}qLk(H,ha){this.TMc.ga(H,ha)}dispose(){Ca.a.vb(this.H2b);this.H2b=null;this.dpc();for(const H of this.bPb){const ha=
H.value;ha&&!ha.isCompleted&&ta.AFrameworkApplication.od.dy(ha.sx)}this.bPb=null;this.fa&&(this.fa.Qk(this.yd),this.rxb&&this.fa.wG(this.bZ),this.rxb=!1,this.fa.Bv(this.fg));this.fa=null;this.$&&Hd.f(this.$)&&Hd.f(this.$).ha&&(Hd.f(this.$).ha.wxa(this.Wig),this.$.tm(this.de));this.$=null;super.dispose()}isFeatureEnabled(H){try{switch(H){case "LocaleLongDateFormat":return pd.EwaSettings.Ra(184);case "GetLocaleDayNames":return pd.EwaSettings.Ra(185);case "OfficeVSO:3657744_CalcFixForDateFormat":return pd.EwaSettings.isChangeGateEnabled("OfficeVSO:3657744_CalcFixForDateFormat");
case "OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero":return pd.EwaSettings.isChangeGateEnabled("OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero");case "CalcAutocompleteExperiment":return pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1);case "CalcWebWorker":return!0;case "CalcPreventSpillingHack":return pd.EwaSettings.isChangeGateEnabled("OfficeVSO:7504597_calcPreventSpillingHack");case "CalcDynamicArrayOperators":return pd.EwaSettings.Ra(101);
default:return H.startsWith("OfficeVSO:")?pd.EwaSettings.isChangeGateEnabled(H):!1}}catch(ha){return Z.ULS.sendTraceTag(537155724,0,15,`InstantaneousSupportInformation.IsFeatureEnabled(${H}): feature parsing failed, returning false. Exception: ${ha.toString()}.`),!1}}O4a(H){this.isActive()&&this.fa.$b.allowEdits?(Ca.a.vb(this.H2b),this.H2b=null,this.H2b=Lg.a.instance.create(this.refresh,H,fe.a.pkj)):Z.ULS.sendTraceTag(537155723,0,50,`InstantaneousSupportInformationManager.ScheduleRefresh: won't schedule refresh. Edit permission: AllowEdits ${void 0!==
this.fa&&null!==this.fa&&void 0!==this.fa.$b&&null!==this.fa.$b?this.fa.$b.allowEdits:!1}, IsEditMode ${void 0===this.fa||null===this.fa?!1:this.$.fa.isEditMode}`)}gJf(){Z.ULS.sendTraceTag(537155719,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync called.");this.jXa?Z.ULS.sendTraceTag(537155718,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync already running, skipping."):this.isActive()?this.z5&&this.z5.length||(this.jXa=se.o(this.$.ma.sa,{FilterType:0},this.qZj,
this.ing,null,null,null)):Z.ULS.sendTraceTag(537155717,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync session is not yet active, skipping.")}v4c(){this.rxb||(this.rxb=!0,this.fa.qF(this.bZ))}dpc(){this.dy(this.nMd);this.dy(this.jXa);this.jXa=this.nMd=null}dy(H){H&&!H.isCompleted&&this.$.ma.sa.swb(H.sx)}static sVi(H,ha){if(!H||!H.length)return[];if(!ha||!ha.length){var Ya=Array(H.length);for(var Wb=0;Wb<H.length;++Wb)Ya[Wb]=H[Wb].IfmtIndex;return Ya}Ya=new gf.a;for(var Sc of H)Ya.ga(Sc.IfmtIndex,
new mh(Sc));H=[];for(Wb of ha)Sc=Ya.Od(Wb.IfmtIndex),{value:ha}=Sc,Sc.returnValue&&ha.data.FormatString===Wb.FormatString||H.push(Wb.IfmtIndex);return H}};xg.Y7d="isim0";xg.xud="isim1";xg.VId="isim2";xg.l$f="isim3";xg.GVf=100;xg.$qe=1E3;xg.w7d=3E5;xg.Gdi=.001;xg.Kdi=.1;xg.Jdi=.2;xg.Idi=.001;xg.Hdi=50;xg=Rg=Object(Ac.__decorate)([Object(Sb.d)(kc.InstantaneousSupportInformationManagerService),Object(Ac.__param)(0,Object(kc.EwaControlService)())],xg);Object(ia.a)(xg,"InstantaneousSupportInformationManager",
kb.a,[560,4]);let nh=class{constructor(H){this.t$d=ha=>{this.YIg(ha.detail.viewportScenarioContext,"eventHandler")};H.P2e(this.t$d,(new AbortController).signal)}YIg(H,ha){try{Z.ULS.sendTraceTag(1851881062,1,15,`NavigationFailHandler.onNavigationFailed: from ${ha}, context = ${this.Okf(H)}`)}catch(Ya){Z.ULS.sendTraceTag(507590041,1,15,`NavigationFailHandler.onNavigationFailed: from ${ha}, exception = ${Ya.message}`)}}Okf(H){const ha=H.targetRange;return JSON.stringify({name:H.name,targetRange:null===
ha||void 0===ha?void 0:ha.toString(),requiredViewportStateIdStateId:H.$Uc})}};nh=Object(Ac.__decorate)([Object(Sb.d)(kc.NavigationFailHandlerService),Object(Ac.__param)(0,Object(kc.ViewportObserverService)())],nh);Object(ia.a)(nh,"NavigationFailHandler",null,[]);class Ah{}Ah.SCj=3;Ah.connected=0;Object(ia.a)(Ah,"ConnectionStateConstants",null,[]);class sh{constructor(H,ha,Ya){var Wb;this.type=0;this.startTime=null;this.blockedOperationsCount=this.durationMs=0;this.blockedActions=null;this.blockedUserOperationsWhileToastShown=
this.durationUntilToastShownMs=0;this.toastRaiser=null;this.wasUserActiveOnPIEnd=this.wasUserActiveOnPIStart=this.hasTabbedOut=this.isToastShown=!1;this.durationUntilUserInactive=-1;this.isTaskPaneCollapsed=this.isTaskPaneShown=this.isDialogShown=!1;this.Ljg=(zd,be)=>{this.blockedOperationsCount++;zd=`${be.componentName}_${be.actionName}_${be.details})`;this.blockedActions[zd]=this.blockedActions[zd]?this.blockedActions[zd]+1:1;this.isToastShown&&this.blockedUserOperationsWhileToastShown++};this.Fae=
zd=>{this.durationUntilUserInactive=Tc.getElapsedSeconds(this.startTime,Pc.a.zb.Jc);zd.jje(this.Fae)};this.iR=()=>{this.hasTabbedOut=!0};this.Gla=(zd,be)=>{be.nwg!==this.type||this.isToastShown||(this.durationUntilToastShownMs=ed.a(Pc.a.zb,this.startTime),this.toastRaiser=be.toastRaiser,this.isToastShown=!0)};this.startTime=H;this.durationUntilToastShownMs=0;this.blockedActions={};this.isToastShown=Ya;if(null===(Wb=ha.fa)||void 0===Wb?0:Wb.Yf)this.wasUserActiveOnPIStart=ha.fa.Yf.xp;this.Aj(ha);this.isDialogShown=
0<ha.Mb.iZ;let Sc=null;dd.a.Fj()?void Sb.a.resolve(kc.ReactTaskPaneManagerService,{xa:1}).then(zd=>{Sc=zd}):Sc=ha.ra.Tb(183);this.isTaskPaneShown=!!Sc&&Sc.isVisible&&!Sc.isCollapsed;this.isTaskPaneCollapsed=!!Sc&&Sc.isVisible&&Sc.isCollapsed}KQg(){this.durationMs=ed.a(Pc.a.zb,this.startTime)}F$d(H){var ha;this.KQg();Gb.a(H).B3b(this.Ljg);Gb.a(H).hg.mUc(this.Gla);pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void Sb.a.resolve(kc.DocumentVisibilityObserverService).then(Ya=>
{Ya.fsb(this.iR)}):H.ra.Vc(291,Ya=>{Ya.fsb(this.iR)});if(null===(ha=H.fa)||void 0===ha?0:ha.Yf)H.fa.Yf.jje(this.Fae),this.wasUserActiveOnPIEnd=H.fa.Yf.xp}Aj(H){Gb.a(H).Elc(this.Ljg);this.isToastShown?this.toastRaiser="Immediate":Gb.a(H).hg.Kod(this.Gla);pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void Sb.a.resolve(kc.DocumentVisibilityObserverService).then(ha=>{this.hasTabbedOut=ha.isHidden;ha.j6(this.iR)}):H.ra.Vc(291,ha=>{this.hasTabbedOut=
ha.isHidden;ha.j6(this.iR)});this.wasUserActiveOnPIStart&&H.fa.Yf.g5e(this.Fae)}}Object(ia.a)(sh,"PartialInteractivityData",null,[]);var eg=a(1248);class th extends sh{constructor(H,ha,Ya,Wb,Sc,zd){super(H,ha,Wb);this.swappedOffline=this.swappedByOffline=!1;this.lastFailedRequestToOnlineTimeGapSec=this.longestDurationBetweenFailedRequestsSec=this.averageDurationBetweenFailedRequestsSec=0;this.errorDataDuringConnectivityIssuesMode=this.disconnectionSource=null;this.failedRequests=[];this.triggeringRequest=
null;this.type=4;this.swappedOffline=Ya;this.disconnectionSource=Enum.toString(eg.a,Sc);this.triggeringRequest=zd}xVj(H,ha){this.swappedByOffline=ha;this.F$d(H)}CJk(H){this.errorDataDuringConnectivityIssuesMode=H}Vlk(H){10>this.failedRequests.length&&(H=H+"_"+Tc.getElapsedSeconds(this.startTime,Pc.a.zb.Jc).toString(),this.failedRequests.push(H))}}Object(ia.a)(th,"ConnectivityIssuesData",sh,[]);var uh=a(162),ka=a(143),ac=a(142);class Xc{}Xc.fki="DuringWork";Xc.connectivityIssues="ConnectivityIssues";
Xc.offline="Offline";Object(ia.a)(Xc,"UnavailabilityTypes",null,[]);var Bd=a(59);class we{constructor(H){this.sJc=this.data=null;this.jGd=0;this.Nhf=null;this.Vkg=(ha,Ya)=>{Ya.DJ?(this.data=new th(Pc.a.zb.Jc,this.$,5===Ya.una,0!==Ya.una,this.$.Cg.disconnectionSource,this.Nhf),this.sJc=this.$.Cg.x8f,this.jGd=1,this.$.ma.Cg.MGh(this.tr),uh.a(this.$).mod(this.ZMg)):(this.data.xVj(this.$,5===Ya.una),this.$.ma.Cg.XHg(this.tr),this.data.lastFailedRequestToOnlineTimeGapSec=Tc.getElapsedSeconds(this.sJc,
Pc.a.zb.Jc),pd.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_7pzab_ConnectivityIssues")?Bd.sendUTRTraceTagUnavailabilityDuration(557682689,0,50,Xc.connectivityIssues,this.data.durationMs,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",de.a.Nc(this.data)):Z.ULS.sendTraceTag(557682689,0,50,`ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: ${de.a.Nc(this.data)}`),this.data&&
this.data.isToastShown&&ja.Health.instance.recordQosError(ka.a.sZh,[ac.a.iKc],!0,!1,!1,!1,null),uh.a(this.$).xie(this.ZMg),this.data=null)};this.ZMg=(ha,Ya)=>{this.data.CJk(Ya.sK)};this.tr=(ha,Ya)=>{this.data.Vlk(Ya.context.methodName);ha=Pc.a.zb.Jc;Ya=Tc.getElapsedSeconds(this.sJc,ha);this.sJc=ha;Ya>this.data.longestDurationBetweenFailedRequestsSec&&(this.data.longestDurationBetweenFailedRequestsSec=Ya);this.jGd++;this.data.averageDurationBetweenFailedRequestsSec=this.oTh(Ya)};this.Skg=(ha,Ya)=>
{this.Nhf=Ya.C8k};this.$=H;Gb.a(this.$).hg.Z3e(this.Vkg);this.$.Cg.Y3e(this.Skg)}dispose(){this.$&&(Gb.a(this.$).hg.WGg(this.Vkg),this.$.Cg&&this.$.Cg.VGg(this.Skg));this.data&&this.$.ma.Cg.XHg(this.tr);this.$=null}oTh(H){const ha=this.jGd-1;return(this.data.averageDurationBetweenFailedRequestsSec*(ha-1)+H)/ha}}Object(ia.a)(we,"ConnectivityIssuesTelemetryManager",null,[4]);var Cd=a(1451),Q=a(1247),Ja=a(1246);class ob{constructor(H){this.XLg=null;this.S0d=this.N5d=this.IZb=this.JZb=0;this.Sre=!1;this.kxd=
this.e6a=this.TZc=this.Iob=null;this.yxd=0;this.DFk=()=>{if(12E4>this.$.fa.Yf.Rvb)for(const ha of this.TZc)ha.runTest();else this.fve("UserInactive")};this.txk=ha=>{ha=Sys.Serialization.JavaScriptSerializer.serialize(ha);Z.ULS.sendTraceTag(388821830,0,50,ha)};this.Hwk=ha=>{if(ha){var Ya=this.kxd[ha.testIteration.toString()];Ya?Ya.push(ha):(Ya=[ha],this.kxd[ha.testIteration.toString()]=Ya);if(Ya.length===this.XLg.length){Ya=Sys.Serialization.JavaScriptSerializer.serialize(Ya);if(this.$&&this.$.Cg){if(ha.EstimatedLatency=
this.$.Cg.R9e,this.$.Cg.R9e>this.$.IA.ExcelRountripThresholdMs){Z.ULS.sendTraceTag(570712144,0,50,`Periodic ping tests results when network is slow: ${Ya}, consequtive slow ping iteration #: ${this.yxd++}`);return}}else Z.ULS.sendTraceTag(537155209,0,50,"EwaControl/ConnectivityObserver is null when conducting slow connection speed tests");Z.ULS.sendTraceTag(570712142,0,50,`Periodic ping tests results: ${Ya}`);this.yxd=1}}};this.Zi=(ha,Ya)=>{ha=Ya.context.methodName;if(ha===uf.a.sQb||ha===uf.a.PGa)this.IZb++,
ha=Date.now(),this.LRk(ha)&&(this.IZb=0,this.S0d=ha,this.i0k())};this.Fla=()=>{this.Hue("OnThrottledUserActivity")};this.iR=()=>{this.fve("OnDocumentHidden")};this.tE=()=>{this.Hue("OnDocumentUnhidden")};this.$=H;if(this.Tre=this.KXh())this.XLg=[Ja.a.V4c],this.yxd=1,this.kxd={},this.$.fa.Yf.QCa(this.Fla),pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void Sb.a.resolve(kc.DocumentVisibilityObserverService).then(ha=>{ha.j6(this.iR);ha.h0(this.tE)}):
this.$.ra.Vc(291,ha=>{ha.j6(this.iR);ha.h0(this.tE)})}dispose(){this.$&&(this.Sre&&this.$.ma&&0<this.Iob.length&&this.$.ma.xG(this.Zi),this.Tre&&(this.fve("Dispose"),this.$.fa.Yf.zLa(this.Fla)))}Mfj(){pd.EwaSettings.Ra(199)&&this.eek();this.Tre&&this.fek()}mgj(){this.IZb=this.JZb;this.S0d=0;var H={};if(!this.Iob){this.Iob=[];const ha=Q.a.kJd(this.txk,"InitSampleMeasurement",this.$);for(const Ya of ha)H[Ya.iSd]=Ya.baseUrl,this.Iob.push(Ya)}H=Sys.Serialization.JavaScriptSerializer.serialize(H);Z.ULS.sendTraceTag(537155210,
0,50,`Init Network measurement: numberOfRequestToWaitPerNetworkMeasurement: ${this.JZb}, numberOfRequestFromTheLastNetworkMeasurement: ${this.IZb}, testParams: ${H} `);0<this.Iob.length&&this.$.ma.ED(this.Zi)}i0k(){for(const H of this.Iob)H.runTest()}Hue(H){this.e6a&&this.e6a.en||(Z.ULS.sendTraceTag(537155208,0,50,`NetworkMeasurement.StartConnectionSpeedTest: starting ping tests. caller: ${H}`),this.e6a=Lg.a.instance.fK(this.DFk,5E3,fe.a.jZk),this.e6a.fU())}fve(H){this.e6a&&this.e6a.en&&(Z.ULS.sendTraceTag(537155207,
0,50,`NetworkMeasurement.StopConnectionSpeedTest: stopping ping tests. caller: ${H}`),this.e6a.cancel())}LRk(H){return this.IZb>=this.JZb&&H-this.S0d>this.N5d}KXh(){return ob.MLg(this.$.ta.SlowNetworkMeasurementsSamplePercentage)}eek(){this.JZb=this.$.ta.NumberOfRequestToWaitPerNetworkMeasurement;this.N5d=1E3*this.$.ta.MinTimeBetweenNetworkMeasurementInSec;const H=this.$.ta.NetworkMeasurementsSamplePercentage;0<this.JZb&&0<this.N5d&&(this.Sre=ob.MLg(H))&&this.mgj()}fek(){if(!this.TZc){this.TZc=[];
const H=Q.a.kJd(this.Hwk,"PrepareAndInitSlowNetworkTests.ConnectionSpeedTest",this.$,[Ja.a.V4c]);for(const ha of H)this.TZc.push(ha);this.$.fa.Yf.xp&&this.Hue("PrepareAndInitSlowNetworkTests")}}static MLg(H){return 100*Math.random()<H}}Object(ia.a)(ob,"NetworkMeasurement",null,[4]);var qc=a(156),gd=a(617);class td{constructor(H){this._count=0;this.sessionID=this.allOfflinePartialInteractivitiesDataInSession=null;this.allOfflinePartialInteractivitiesDataInSession=[];this.sessionID=H}get count(){return this._count}get V0(){return this.allOfflinePartialInteractivitiesDataInSession[this.allOfflinePartialInteractivitiesDataInSession.length-
1]}ncl(){this.V0&&this.V0.KQg()}JAh(H){this.allOfflinePartialInteractivitiesDataInSession.push(H);this._count++}}Object(ia.a)(td,"OfflinePartialInteractivitiesDataForLog",null,[]);class ca extends sh{constructor(H,ha,Ya){super(H,ha,Ya);this.timeFromLastOffline=0;this._errorDataDuringOfflineMode=null;this.timeFromLastOffline=-1;this.type=5}lNk(H){this.timeFromLastOffline=H}DJk(H){this._errorDataDuringOfflineMode=H}}Object(ia.a)(ca,"OfflinePartialInteractivityData",sh,[]);class bb{constructor(H,ha){this.G1a=
this.V0=null;this.dee=-1;this.fOb=null;this.s8f=jb.Task.delay(0);this.Bpb=(Ya,Wb)=>{Wb.DJ?this.v2j(Wb.una):this.w2j()};this.Gla=(Ya,Wb)=>{5===Wb.nwg&&this.yhb()};this.$Mg=(Ya,Wb)=>{this.V0.DJk(Wb.sK)};this.yhb=()=>{this.G1a.ncl();this.PCk(bb.Wbe,Sys.Serialization.JavaScriptSerializer.serialize(this.G1a))};this.ixk=Ya=>{if(Ya=Ya.result)this.Eah=!0,Z.ULS.sendTraceTag(576811915,0,50,`OfflineModeTelemetryManager.ReportOfflinePartialInteractivityDataFromIDB: Previous session's offline partial interactivy data: ${Ya}`)};
this.nqk=()=>{this.Eah&&(this.$?Kf.TaskExtensions.tb(this.indexedDB.mBd(bb.Wbe),()=>{Z.ULS.sendTraceTag(537155204,0,50,"OfflineModeTelemetryManager.RemoveDataFromIDB: Previous session's offline partial interactivy data successfuly removed from IDB.")},this.$.Aa):Z.ULS.sendTraceTag(537155203,0,10,"OfflineModeTelemetryManager.RemoveDataFromIDB: EwaControl is null when attempting to remove offline mode data stored in IDB."))};this.L1a=()=>{if(this.G1a&&0<this.G1a.count){const Ya=Sys.Serialization.JavaScriptSerializer.serialize(this.G1a);
Z.ULS.sendTraceTag(560791644,0,50,`OfflineModeTelemetryManager.OnBeforeUnload: This session's offline partial interactivy data: ${Ya}`)}};this.$=H;this.indexedDB=ha;this.Eah=!1;this.indexedDB.Tf()&&(this.indexedDB.initialize(bb.KYa,bb.LYa),this.Bwk(),this.G1a=new td(this.$.ta.UserSessionId),Gb.a(this.$).hg.Cod(this.Bpb));this.Rn=qc.a.instance.SP();this.Rn.Ea("beforeunload",this.L1a)}dispose(){this.$&&Gb.a(this.$)&&Gb.a(this.$).hg.Qie(this.Bpb);Ca.a.vb(this.fOb);this.$=this.fOb=null}v2j(H){this.V0=
new ca(Pc.a.zb.Jc,this.$,0!==H);this.V0.lNk(-1!==this.dee?window.performance.now()-this.dee:-1);this.G1a.JAh(this.V0);Gb.a(this.$).hg.Kod(this.Gla);this.yhb();this.fOb=Lg.a.instance.fK(this.yhb,bb.dDi,fe.a.yhb);uh.a(this.$).mod(this.$Mg)}w2j(){this.V0.F$d(this.$);this.yhb();Ca.a.vb(this.fOb);this.fOb=null;this.dee=window.performance.now();Gb.a(this.$).hg.mUc(this.Gla);uh.a(this.$).xie(this.$Mg);this.Jwk()}PCk(H,ha){this.$?this.s8f=Kf.TaskExtensions.tb(this.s8f,()=>{this.indexedDB.Qxa(new gd.a(H,ha))},
this.$.Aa):Z.ULS.sendTraceTag(537155205,0,15,"OfflineModeTelemetryManager.SaveToIndexedDBSequential: EwaControl is null when attempting to write to IDB")}Bwk(){const H=this.$.Aa;Kf.TaskExtensions.tb(Kf.TaskExtensions.tb(this.indexedDB.zta(bb.Wbe),this.ixk,H),this.nqk,H)}Jwk(){if(this.V0){const H=Sys.Serialization.JavaScriptSerializer.serialize(this.V0);pd.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_71qb3_Offline")?Bd.sendUTRTraceTagUnavailabilityDuration(560791645,
0,50,Xc.offline,this.V0.durationMs,"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",H):Z.ULS.sendTraceTag(560791645,0,50,`OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: ${H}`)}this.V0&&this.V0.isToastShown&&ja.Health.instance.recordQosError(ka.a.ehl,[ac.a.iKc],!0,!1,!1,!1,null)}}bb.KYa="NetworkAvailability";bb.LYa="NetworkAvailabilityData";bb.Wbe="partialInteractivityData";
bb.dDi=3E3;Object(ia.a)(bb,"OfflineModeTelemetryManager",null,[4]);var Hb=a(1466);const Vb=H=>{H.isSuccess||(H=Sys.Serialization.JavaScriptSerializer.serialize(H),Z.ULS.sendTraceTag(509669840,0,10,H))};class Ec{constructor(H,ha){this.hwa=this.V6d=this.Oig=null;this.$=H;pd.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&Uf.a.Yg||(this.Oig=new bb(H,ha));pd.EwaSettings.Ra(199)&&(this.V6d=new ob(this.$),this.V6d.Mfj());pd.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&
Uf.a.Yg||(this.hwa=new Cd.NetworkConnectionHealthChecker(this.$));this.q2h=new we(this.$);pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.1CdnDarkTestEnabled",!1)&&(H=this.$,ha=pd.EwaSettings.getStringFeatureGate("Microsoft.Office.Excel.1CdnDarkTestTargetUrl",""),""!==ha&&(new Hb.a(H,"1CDN",ha,Vb,"runOneCdnNetworkTest")).runTest())}dispose(){Ca.a.vb(this.Oig);Ca.a.vb(this.V6d);Ca.a.vb(this.hwa);Ca.a.vb(this.q2h);this.$=null}}Object(ia.a)(Ec,"NetworkConnectionTelemetryManager",null,[4]);
class rd extends sh{constructor(H,ha,Ya,Wb){super(H,ha,Ya);this.wasInteruptedByOfflineMode=!1;this.type=Wb;this.wasInteruptedByOfflineMode=!1}Bpb(){this.wasInteruptedByOfflineMode=!0}}Object(ia.a)(rd,"SilentReopenData",sh,[]);class Id{constructor(H){this.xfa=null;this.ftg=(ha,Ya)=>{this.dtg(Ya,3)};this.lpg=(ha,Ya)=>{this.dtg(Ya,2)};this.$=H;this.hg=Gb.a(this.$).hg;this.hg.z4e(this.lpg);this.hg.mGh(this.ftg)}dispose(){this.hg.sHg(this.lpg);this.hg.Wuk(this.ftg);this.xfa=this.hg=this.$=null}dtg(H,ha){H.DJ?
this.xfa=new rd(Pc.a.zb.Jc,this.$,0!==H.una,ha):(5===H.una&&(this.xfa.wasInteruptedByOfflineMode=!0),3!==H.una&&2!==H.una||Z.ULS.sendTraceTag(537155202,0,10,"SilentReopenPartialInteractivityTelemetryManager.OnSilentReopen: BackToWork/DuringWork partial interactivity has been swapped to DuringWork/BackToWork."),this.xfa.F$d(this.$),2===ha?pd.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_8dtae_B2W")?Bd.sendUTRTraceTagUnavailabilityDurationJson(571289604,0,50,Xc.offline,
this.xfa.durationMs,this.xfa):Z.ULS.sendTraceTag(571289604,0,50,de.a.Nc(this.xfa)):pd.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_6w9lg_DuringWork")?Bd.sendUTRTraceTagUnavailabilityDurationJson(542782150,0,50,Xc.fki,this.xfa.durationMs,this.xfa):Z.ULS.sendTraceTag(542782150,0,50,de.a.Nc(this.xfa)),this.xfa=null)}}Object(ia.a)(Id,"SilentReopenPartialInteractivityTelemetryManager",null,[4]);let W=class extends kb.a{constructor(H,ha,Ya){Ya=void 0===Ya?!0:Ya;super();this.Y9=
this.Qqc=this.H1a=this.Dya=this.X5a=null;this.Qgg=0;this.mTc=this.Urb=this.Vrb=!1;this.Sgg=this.documentVisibilityObserver=null;this.iBa=!1;this.YSd=this.Ffa=0;this.AVb=!1;this.hYg=0;this.Fre=!1;this.j$=null;this.Ypg=()=>{Z.ULS.sendTraceTag(537155219,0,50,"NetworkConnectionStateManager.OnNetworkDownEvent: Network down.");this.bMc(1,!1)};this.tE=()=>{this.Kua||this.$Xb?window.setTimeout(()=>{this.vxe()},this.Qgg):this.vxe();this.documentVisibilityObserver.wLa(this.tE);this.AVb=!1};this.wg=()=>{Z.ULS.sendTraceTag(537155218,
0,50,`NetworkConnectionStateManager.OnEditEnded: Edit ended. IsInOfflineMode:${this.$Xb}, IsInDuringWorkSilentReopenMode:${this.VKc&&!this.iBa}`);this.$Xb&&this.b1e();this.VKc&&!this.iBa&&this.Z0e();Hd.f(this.$).cellTextEditBox.gq(this.wg);this.Vrb=this.Urb=!1};this.$pg=()=>{Z.ULS.sendTraceTag(537155213,0,50,"NetworkConnectionStateManager.OnNetworkResumedEvent: network was resumed.");this.bMc(1,!0);this.Urb&&!this.Vrb&&Hd.f(this.$).cellTextEditBox.gq(this.wg);this.Urb=!1};this.Fla=(Wb,Sc)=>{this.YSd=
this.Ffa;this.Ffa=Sc.V0c};this.etg=()=>{this.$&&(this.mTc||(fb.a(this.$).N1(Rb.a.vKa).KDh(this.kqg),this.$.Ul(this.de),this.mTc=!0),this.iBa=this.Hmj(),this.bMc(2,!1))};this.kqg=()=>{var Wb=fb.a(this.$).ek;const Sc=Wb.CKh();Wb=Wb.gx.Kd.errors.map(zd=>zd.MessageIdName);Z.ULS.sendTraceTag(545842889,0,50,`NetworkConnectionStateManager.OnOpenWebMethodErrorUserAlertExecuting: IsStateUnrecoverable:${Sc}, IsB2W:${this.iBa}, Errors: ${de.a.Nc(Wb)}`);Sc&&(this.X5a?(this.iBa=!1,this.inf(),this.h2c()):this.Dya&&
(this.jnf(),this.h2c()))};this.de=()=>{this.$?(Z.ULS.sendTraceTag(541193955,0,50,"NetworkConnectionStateManager.OnWorkbookOpened: Workbook opened."),this.iBa=!1,this.Y9&&this.Y9.en&&(Ca.a.vb(this.Y9),this.Y9=null),this.j$&&this.j$.en&&(Ca.a.vb(this.j$),this.j$=null),this.bMc(2,!0),this.h2c()):Z.ULS.sendTraceTag(537155212,0,10,"NetworkConnectionStateManager.OnWorkbookOpened: bug monitoring: EwaControl is null.")};this.Tkg=()=>{this.Dfg(!0)};this.Ukg=()=>{this.Dfg(!1)};this.lic=Ah.SCj;this.txd=Ah.connected;
this.$=H;this.Cg=H.ma.Cg;Ya&&(this.Sgg=new Ec(H,ha));pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void Sb.a.resolve(kc.DocumentVisibilityObserverService).then(Wb=>{this.documentVisibilityObserver=Wb}):this.$.ra.Vc(291,Wb=>{this.documentVisibilityObserver=Wb});this.Qgg=this.$.ta.ExcelNetworkCheckAfterTabActivationDelayMs;this.Cg.G4e(this.Ypg);this.Cg.HFb(this.$pg);this.Cg.Y3e(this.Tkg);this.Cg.oDh(this.Ukg);new Id(this.$,this);this.Fbg=
this.$.ta.LongInactivityTimePeriodSeconds;this.$.fa.TFb(this.etg);this.$.fa.Yf.QCa(this.Fla);this.hYg=this.$.ta.SilentReopenDuringWorkDelayMs}get npj(){return this.iBa}get $Xb(){return!(this.lic&1)}get VKc(){return!(this.lic&2)}get Kua(){return!!(this.txd&2)}dispose(){this.Cg&&(this.Cg.xHg(this.Ypg),this.Cg.z3b(this.$pg),this.Cg.VGg(this.Tkg),this.Cg.osk(this.Ukg));this.AVb&&this.documentVisibilityObserver&&(this.documentVisibilityObserver.wLa(this.tE),this.AVb=!1);this.$&&(this.mTc&&this.h2c(),this.$.fa&&
(this.$.fa.qUc(this.etg),this.$.fa.Yf&&this.$.fa.Yf.zLa(this.Fla)));this.j$&&(this.j$.dispose(),this.j$=null);Ca.a.vb(this.Sgg);this.$=null;super.dispose()}ZJj(){this.Fre=!0}Z0e(){this.Dya||(this.Dya=Gb.a(this.$).hg.tha(3,"NetworkConnectionStateManager.ActivateDuringWorkSilentReopenPartialInteractivity"))}Hmj(){if(this.Fre)return this.Fre=!1,!0;const H=this.Ffa>this.Fbg||this.YSd>this.Fbg&&10>this.Ffa;Z.ULS.sendTraceTag(537155223,0,50,`NetworkConnectionStateManager.IsBackToWorkSilentReopen: Inactivity duration: Time from last activity:${this.Ffa}, Time gap between last two activities: ${this.YSd}. return value:${H}`);
return H}vxk(){this.j$=Lg.a.instance.create(()=>{ja.Health.instance.recordQosError(ka.a.oZk,[ac.a.iKc],!0,!0,!1,!1,null)},6E3,"ReportLongSilentReopenBackToWorkVeto",void 0,!0)}Pxh(){this.Dya||this.Y9?Z.ULS.sendTraceTag(542782155,0,10,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Trying to activate during-work partial interactivity when we are already in this partial interactivity or there is a running timer that's going to do it soon."):this.Y9=Lg.a.instance.create(()=>
{this.$?this.Dya?Z.ULS.sendTraceTag(537155221,0,15,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Tried to activate SilentReopenDuringWork PI when there is already an DuringWorkSilentReopen partial interactivity object"):Hd.f(this.$).isEditing?(this.Urb||(Hd.f(this.$).cellTextEditBox.Uq(this.wg),Z.ULS.sendTraceTag(541893722,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Registered OnEditEnded while during-work silent reopen")),this.Vrb=!0,Z.ULS.sendTraceTag(537155220,
0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Need to init during-work silent reopen partial interactivity but the user is during a cell edit. Registered to OnEditEnded event.")):this.Z0e():Z.ULS.sendTraceTag(537155222,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: EwaControl is null")},this.hYg,fe.a.XXk,void 0,!0)}Dfg(H){this.txd=this.tbf(2,H,!0);this.I5e()}bMc(H,ha){this.lic=this.tbf(H,ha,!1);this.I5e()}tbf(H,ha,Ya){Ya=Ya?this.txd:this.lic;
return ha?Ya|H:Ya&~H}vxe(){const H=!!this.H1a,ha=!!this.X5a,Ya=!!this.Dya,Wb=!!this.Qqc;this.$Xb&&!H?this.Oxh():!this.$Xb&&H&&this.edi();!this.VKc||ha||Ya?this.VKc||(ha?this.inf():(Ya||this.Y9&&this.Y9.en)&&this.jnf()):this.iBa?this.Nxh():this.Y9||this.Pxh();this.Kua&&!Wb?this.P2g(!0):!this.Kua&&Wb&&this.P2g(!1)}Oxh(){this.$?this.H1a?Z.ULS.sendTraceTag(537155215,0,15,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Tried to activate offline PI when there is already an offline partial interactivity object"):
Hd.f(this.$).isEditing?(this.Vrb||(Hd.f(this.$).cellTextEditBox.Uq(this.wg),Z.ULS.sendTraceTag(537155217,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Registered OnEditEnded during offline mode")),this.Urb=!0,Z.ULS.sendTraceTag(537155216,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Turned offline while user is editing a cell, registered to OnEditEnded event.")):this.b1e():Z.ULS.sendTraceTag(537155214,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: EwaControl is null")}b1e(){this.H1a||
(this.H1a=Gb.a(this.$).hg.tha(5,"NetworkConnecStateManager.ActivateOfflinePartialInteractivity"))}edi(){this.H1a&&(Ca.a.vb(this.H1a),this.H1a=null)}inf(){this.X5a&&(Ca.a.vb(this.X5a),this.X5a=null);this.j$&&this.j$.en&&this.j$.cancel();this.j$=null}jnf(){this.Dya&&(Ca.a.vb(this.Dya),this.Dya=null);this.Y9&&(Ca.a.vb(this.Y9),this.Y9=null);this.Vrb&&!this.Urb&&Hd.f(this.$).cellTextEditBox.gq(this.wg);this.Vrb=!1}Nxh(){this.X5a||(this.X5a=Gb.a(this.$).hg.tha(2,"NetworkConnectionStateManager.ActivateLongInactivitySilentReopenPartialInteractivity",
void 0,Yb.a.instance.ia(2190)));this.vxk()}P2g(H){H?(this.Qqc=Gb.a(this.$).hg.tha(4,"NetworkConnectionStateManager.ConnectivityIssues"),this.vhk()):(Ca.a.vb(this.Qqc),this.Qqc=null)}vhk(){if(this.$&&this.$.ma){const H=this.$.ma.sa.mc();se.J(this.$.ma.sa,null,null,null,H)}}h2c(){fb.a(this.$).N1(Rb.a.vKa).vs(this.kqg);this.$.tm(this.de);this.mTc=!1}I5e(){this.documentVisibilityObserver||Z.ULS.sendTraceTag(537155211,0,15,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: Document visibility observer is null while it shouldn't be.");
this.documentVisibilityObserver&&this.documentVisibilityObserver.isHidden?this.AVb||(this.documentVisibilityObserver.h0(this.tE),this.AVb=!0,Z.ULS.sendTraceTag(541193954,0,50,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: tabbed out user, will update the partial interactivity state when the user will be back.")):this.vxe()}};W=Object(Ac.__decorate)([Object(Sb.d)(kc.NetworkConnectionStateManagerService),Object(Ac.__param)(0,Object(kc.EwaControlService)()),Object(Ac.__param)(1,
Object(kc.IndexedDBService)())],W);Object(ia.a)(W,"NetworkConnectionStateManager",kb.a,[558,4]);var Ra=a(137),nc=a(243);const yc=()=>{let H=ta.AFrameworkApplication.ea.Qa("ClientManifestUrl");if(H)return H;H=(ta.AFrameworkApplication.ea.appSettings.StaticContentHost+"_layouts/Resources/{lcid}/clientManifest.exp.js").replace("{lcid}",ta.AFrameworkApplication.uiCulture||"en-US");return ta.AFrameworkApplication.ea.appSettings.ClientManifestUrl=H},Fd=H=>{const ha="_layouts/App_Scripts/EwaTS.js _layouts/App_Scripts/MicrosoftAjaxDS.js _layouts/App_Scripts/{lcid}/Ewa.Strings.Wac.js _layouts/App_Scripts/gridRenderer.min.js _layouts/App_Scripts/EwaTS.tm.js _layouts/App_Scripts/EwaTS.tmcore.js _layouts/App_Scripts/EwaTS.cuixas.js _layouts/App_Scripts/EwaTS.vrd.js _layouts/App_Scripts/EwaTS.vrs.js _layouts/App_Scripts/EwaTS.frd.js _layouts/App_Scripts/EwaTS.frs.js _layouts/App_Scripts/EwaTS.pid.js _layouts/App_Scripts/EwaTS.pi.js _layouts/App_Scripts/EwaTS.htmlsanitization.js _layouts/App_Scripts/EwaTS.rt.js _layouts/App_Scripts/EwaTS.augmentationloop.js _layouts/app_scripts/EwaTS.acc.js _layouts/App_Scripts/EwaTS.cl.js".split(" ");
pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PrefetchAdditionalBootResources",!1)&&ha.push("_layouts/App_Scripts/EwaTS.bootCommon.js","_layouts/App_Scripts/EwaTS.otherCommon.js","_layouts/App_Scripts/excel-boot.min.js","_layouts/App_Scripts/excelOnline.min.js","_layouts/App_Scripts/jquery.js","_layouts/App_Scripts/jquery.signalr.min.js","_layouts/App_Scripts/EwaTS.licensecheck.js","_layouts/App_Scripts/EwaTS.policycheck.js","_layouts/App_Scripts/common.min.js","_layouts/App_Scripts/appChrome.min.js",
"_layouts/App_Scripts/appChromeLazy.min.js","_layouts/App_Scripts/runtime.min.js","_layouts/App_Scripts/common50.min.js","_layouts/App_Scripts/uiSlice20.min.js","_layouts/App_Scripts/uiFabricLazy.min.js","_layouts/App_Scripts/{lcid}/excel-uiSlice20-sprite.min.js","_layouts/App_Scripts/{lcid}/excel-app-mlr-sprite.min.js","_layouts/App_Scripts/{lcid}/common-intl.min.js");return[...ha,"_layouts/Resources/{lcid}/EwrDefault.css","_layouts/Resources/{lcid}/excelframe.css"].map(Ya=>{var Wb=ta.AFrameworkApplication.ea.Qa("Lcid")||
"1033";Wb=null===Ya||void 0===Ya?void 0:Ya.replace("{lcid}",Wb);Ya.includes(uf.a.ewaBasePrefix)&&(Ya=Wb,Ya=Wb=pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SupportPrefetchingDifferentFolders",!1)&&H.ewaBaseFolder?Ya.replace(uf.a.ewaBasePrefix,`${H.ewaBaseFolder}/${uf.a.ewaBasePrefix}`):Ya,Wb=pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SupportPrefetchingDifferentBundles",!1)&&H.ewaBasePrefix?Ya.replace(uf.a.ewaBasePrefix,H.ewaBasePrefix):Ya);return Wb})},$d=()=>ta.AFrameworkApplication.buildVersion.replace("16.0.",
"16.").replace(/\./g,""),Me=H=>{var ha;H=nc.a(H);H=null===(ha=null===H||void 0===H?void 0:H.HGa())||void 0===ha?void 0:ha.connectionType;ha=["bluetooth","cellular"];ha=!!H&&ha.includes(H);Z.ULS.sendTraceTag(507795356,0,15,`isMeteredConnection: connection type: ${H} | isMeteredConnection: ${ha}`);return ha},ff=H=>({ewaBasePrefix:H.AlternateEwaBasePrefix,ewaBaseFolder:H.AlternateEwaBaseFolder}),jf=(H,ha)=>{ha=void 0===ha?[]:ha;const Ya={},Wb=$d();var Sc=Object.keys(H).sort();for(const zd of Sc){Sc=
H[zd];if(ha.includes(Sc))continue;if(Ya[Sc])continue;if(Sc===Wb)break;const [be,oe]=zd.split("_");Ya[Sc]={ring:be,stage:oe}}return Object.values(Ya)},Lf=H=>`${H.ring}_${H.stage}`;class Ef{static get instance(){return Ef.Wa||(Ef.Wa=new Ef)}constructor(){this.gB="LocalStoragePrefetchCache";this.k$f="XLOPLTPrefetchCache";this.jLj=pd.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MaxVisitsToCache",0);this.veg=pd.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MaxPrefetchedVersionsToCache",
0);this.Tpj=pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EvictExpiredVersions",!1);this.hLj=pd.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MaxVersionTTLInDays",0);this.pYi=()=>this.JI.versions;this.SAh=H=>{this.JI.versions=this.JI.versions.filter(ha=>ha.version!==H.version);this.JI.versions.unshift(H);this.Zoi();this.Rxa()};this.ode=H=>this.pYi().some(ha=>ha.version===H);this.ymk=()=>{const H={time:Date.now(),version:$d()},ha=this.JI.lastVisits.some(Wb=>Wb.version===H.version),
Ya=this.JI.versions.some(Wb=>Wb.version===H.version);this.JI.lastVisits.unshift(H);this.JI.lastVisits=this.JI.lastVisits.slice(0,this.jLj);this.Rxa();Z.ULS.sendTraceTag(507656337,0,15,`${this.gB}.recordVisit: new visit recorded. version: ${H.version}, seen before: ${ha}, is prefetched: ${Ya}`)};this.hUi=()=>this.JI.lastLookAheadApiRequestTime;this.gmk=()=>{this.JI.lastLookAheadApiRequestTime=Date.now();this.Rxa()};this.oYi=()=>{const H={versions:[],lastVisits:[]};if(!this.$1f)return H;const ha=this.localStorage.pXa(this.k$f);
if(!ha)return Z.ULS.sendTraceTag(507795398,0,15,`${this.gB}.getPrefetchCache: key does not exist in local storage.`),H;try{const Ya=JSON.parse(ha);Z.ULS.sendTraceTag(507795397,0,50,`${this.gB}.getPrefetchCache: successfully read and deserialized local storage item. JSON: ${ha}`);return Ya}catch(Ya){return Z.ULS.sendTraceTag(507795396,0,15,`${this.gB}.getPrefetchCache: read but failed to deserialize local storage item. JSON: ${ha}`),H}};this.Rxa=()=>{if(this.$1f){const H=JSON.stringify(this.JI);this.localStorage.s6b(this.k$f,
H)}};this.Roi=()=>{const H=$d();this.ode(H)&&(this.hrk(H),Z.ULS.sendTraceTag(507795395,0,15,`${this.gB}.evictCurrentVersionFromCacheIfNeeded: evicting current version ${H} from prefetched versions array.`),this.Rxa())};this.hrk=H=>{this.ode(H)?(this.JI.versions=this.JI.versions.filter(ha=>ha.version!==H),this.Rxa()):Z.ULS.sendTraceTag(507795394,0,15,`${this.gB}.removePrefetchedVersion: prefetched version ${H} does not exist.`)};this.Soi=()=>{if(this.Tpj){var H=Date.now(),ha=[];this.JI.versions.forEach((Ya,
Wb)=>{Ya.time+864E5*this.hLj<H&&ha.push(...this.JI.versions.splice(Wb,1))});if(0<ha.length){const Ya=JSON.stringify(ha);Z.ULS.sendTraceTag(507790351,0,15,`${this.gB}.evictExpiredVersions: evicting versions from the cache (expired). Versions: ${Ya}`);this.Rxa()}}};this.Zoi=()=>{if(this.JI.versions.length>this.veg){var H=this.JI.versions.splice(this.veg,this.JI.versions.length);H=JSON.stringify(H);Z.ULS.sendTraceTag(507795399,0,15,`${this.gB}.evictVersionsBeyondLimit: evicting versions from the cache (beyond limit). Versions: ${H}`);
this.Rxa()}};this.localStorage=new Zf.a;this.$1f=this.localStorage.Tf();this.JI=this.oYi();this.Roi();this.Soi();this.ymk()}}Object(ia.a)(Ef,"LocalStoragePrefetchCache",null,[]);const jg=async H=>{const ha=JSON.stringify(H);Z.ULS.sendTraceTag(507564318,0,15,`getLookAheadApiResponse: sending LookAhead API request: ${ha}`);H=await fetch(`${ta.AFrameworkApplication.ea.Qa("WebServiceBase")}/afhs/AppPrefetchResources.ashx`,H);if(!H.ok)throw Error(`Request has failed with status code ${H.status}`);Z.ULS.sendTraceTag(507353303,
0,15,`getLookAheadApiResponse: LookAhead API succeeded with status code ${H.status}`);H=await H.text();return JSON.parse(H)},Eg=(H,ha)=>{ha=Fd(ha).map(Ya=>Ya.toLocaleLowerCase());return{AppName:"Excel",currentClientManifestUrl:yc(),FilesToPrefetch:JSON.stringify(ha),OverrideRing:H.ring,OverrideStage:H.stage}};var bh;(function(H){H[H.Unknown=0]="Unknown";H[H.AppInteractive=1]="AppInteractive";H[H.AppVisuallyReady=2]="AppVisuallyReady";H[H.IntervalPrefetch=3]="IntervalPrefetch"})(bh||(bh={}));Object(ia.b)("PrefetchTrigger",
bh);class ch extends Vd.a{constructor(H){super();this.$=H;this.T4h=[139,151,149,136,137,150];this.eHh=[6,7,21,55,56,49,50,57,26,37,9,32,3,8];this.aTh=pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8912305_NextVersionScriptsPrefetcherCacheFix");this.UXf=pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8912306_NextVersionScriptsPrefetcherIntervalTriggerEnabled");this.Eyg=36E5;this.mtj=pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8912314_NextVersionScriptsPrefetcherMeteredConnectionSupportEnabled");this.$2a=
-1;this.Xcd=void 0;this.Fyg=()=>{this.jRb(bh.AppVisuallyReady)};this.Ydk=()=>{this.jRb(bh.IntervalPrefetch)};this.n_i=()=>this.T4h.concat(this.eHh);this.jRb=ha=>{ha=void 0===ha?bh.Unknown:ha;this.$Gc()||(this.Lil(),Z.ULS.sendTraceTag(508441096,0,15,`LegacyNextVersionScriptsPrefetcher.handlePrefetching: prefetching PLT resources (trigger: ${ha})`),(this.aTh?fetch("https://c4-excel-15.cdn.office.net/x/s/_layouts/App_Scripts/excel-boot.min.js",{cache:"no-store"}):fetch("https://c4-excel-15.cdn.office.net/x/s/_layouts/App_Scripts/excel-boot.min.js")).then(Ya=>
Ya.text()).then(Ya=>{if(Ya){var Wb=Ya.length,Sc=Ya.indexOf('BUILD_NUMBER: "'),zd=Sc+15+16;0>Sc||zd>=Wb?(Z.ULS.sendTraceTag(508441092,0,15,`extractBuildVersionFromCdnFileContent: indices are out of bounds (start: ${Sc}, end: ${zd}, length: ${Wb})`),Ya=null):Ya=Ya.substring(Sc+15,zd)}else Z.ULS.sendTraceTag(508441093,0,15,"extractBuildVersionFromCdnFileContent: cdnFileText is either null or empty"),Ya=null;return Ya}).then(Ya=>{Ya&&(Gc(Ya,this.n_i(),this.Aa),this.SLk(Ya))}).catch(Ya=>{Z.ULS.sendTraceTag(508441094,
0,15,`LegacyNextVersionScriptsPrefetcher.handlePrefetching: method has failed with error: ${Ya}`)}))};this.Lil=()=>{var ha=df.a.get(Zc.a.Ece);if(ha){ha=decodeURIComponent(ha);const {versionDuringPrefetch:Ya,prefetchedVersion:Wb,timeStamp:Sc}=JSON.parse(ha);Ya&&Wb&&Sc?Z.ULS.sendTraceTag(508441091,0,20,`LegacyNextVersionScriptsPrefetcher.validatePrefetchCookie: cookie found with prefetchedVersion = ${Wb}, versionDuringPrefetch = ${Ya}, timeStamp = ${Sc}`):Z.ULS.sendTraceTag(508164096,0,20,"LegacyNextVersionScriptsPrefetcher.validatePrefetchCookie: Cookie is corrupt")}df.a.remove(Zc.a.Ece)};
this.SLk=ha=>{const Ya=ta.AFrameworkApplication.buildVersion,Wb=(new Date).getTime();ha=JSON.stringify({versionDuringPrefetch:Ya,prefetchedVersion:ha,timeStamp:Wb});Z.ULS.sendTraceTag(508441090,0,20,`LegacyNextVersionScriptsPrefetcher.setPrefetchCookie: setting cookie with value ${ha}`);df.a.BB(Zc.a.Ece,ha,14)||Z.ULS.sendTraceTag(508441089,0,15,`LegacyNextVersionScriptsPrefetcher.setPrefetchCookie: failed to set cookie with value ${ha}`)};this.ltj=ha=>{const Ya=pd.EwaSettings.getStringFeatureGate("Microsoft.Office.Excel.NextVersionScriptsPrefetcherMeteredConnectionTypes",
"");return!!ha&&Ya.includes(ha)};this.$Gc=()=>{var ha;if(!this.mtj)return!1;if(void 0===this.Xcd){var Ya=nc.a(this.$);Ya=null===(ha=null===Ya||void 0===Ya?void 0:Ya.HGa())||void 0===ha?void 0:ha.connectionType;ha=this.ltj(Ya);Z.ULS.sendTraceTag(507892502,0,15,`LegacyNextVersionScriptsPrefetcher.isMeteredConnection: connection type: ${Ya} | isMeteredConnection: ${ha}`);this.Xcd=ha}return this.Xcd};this.fa=H.fa;H.ta.IsProduction&&(this.Fyg(),this.UXf&&0<this.Eyg&&(this.$2a=window.setInterval(this.Ydk,
this.Eyg)))}dispose(){this.fa&&this.fa.Av(this.Fyg);this.UXf&&-1<this.$2a&&window.clearInterval(this.$2a);this.fa=null}}Object(ia.a)(ch,"LegacyNextVersionScriptsPrefetcher",Vd.a,[559]);Object(Sb.b)(kc.NextVersionScriptsPrefetcherService,{we:"singleton"})(async H=>{H=await Sb.a.resolve(kc.EwaControlService,{xa:H.xa});if(pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NextVersionScriptsPrefetcherWiseSupport",!1))H=new Fg(H);else{const ha=!!ta.AFrameworkApplication.ea.Qa("SovereignEnvironmentName");
H=pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8964389_PLTCoreResourcesPrefetchEnabled")&&!ha?new ch(H):null}return H});class Fg extends Vd.a{constructor(H){super();this.OY=0;this.gB="NextVersionScriptsPrefetcher";this.doi=pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnsureVersionIsPrefetchedValidations",!1);this.PKg=pd.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.LookAheadRestPeriodInMinutes",0);this.s2f=pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SupportMultiStagePrefetching",
!1);this.$2a=-1;this.onInterval=()=>this.jRb("intervalPrefetch");this.jRb=ha=>{Z.ULS.sendTraceTag(507795393,this.OY,15,`${this.gB}.handlePrefetching: executing via trigger: ${ha}`);void this.p9i(ha)};this.ioj=()=>{if(0===this.PKg)return!1;const ha=this.localStorage.hUi();return void 0===ha?!1:Date.now()-ha<6E4*this.PKg};this.p9i=async ha=>{if(this.ioj())Z.ULS.sendTraceTag(507262853,this.OY,15,`${this.gB}.handlePrefetchingInternal: cooldown period is active (prefetching skipped).`);else{var Ya={ring:"2",
stage:"1"};await this.Byg(Ya,ha);if(this.s2f)if(this.ovc){var Wb=[Lf({ring:"1",stage:"1"}),Lf(Ya)];Ya=Object.entries(this.ovc).filter(Sc=>{[Sc]=Sc;return Wb.includes(Sc)}).map(Sc=>{[,Sc]=Sc;return Sc});Ya=jf(this.ovc,Ya).map(Sc=>this.Byg(Sc,ha));await Promise.all(Ya)}else Z.ULS.sendTraceTag(507017352,this.OY,15,`${this.gB}.handlePrefetchingInternal: this.environmentNameToVersionMap is undefined`)}};this.Byg=async(ha,Ya)=>{let Wb;Z.ULS.sendTraceTag(507017351,this.OY,15,`${this.gB}.prefetchFromEnvironment: Prefetch started: ${JSON.stringify({environment:ha,
trigger:Ya})}`);try{Wb=await this.L4i(ha)}catch(Sc){ha=JSON.stringify({error:Sc.message,trigger:Ya,environment:ha});Z.ULS.sendTraceTag(507564322,this.OY,15,`${this.gB}.prefetchFromEnvironment: getVersionToPrefetchMetadata has failed: ${ha}`);return}try{this.Wil(Wb)}catch(Sc){ha=JSON.stringify({error:Sc.message,versionToPrefetch:Wb,trigger:Ya,environment:ha});Z.ULS.sendTraceTag(507564321,this.OY,15,`${this.gB}.prefetchFromEnvironment: validateVersionToPrefetch has failed: ${ha}`);return}try{this.coi(Wb,
Ya)}catch(Sc){ha=JSON.stringify({error:Sc.message,versionToPrefetch:Wb,trigger:Ya,environment:ha});Z.ULS.sendTraceTag(507564320,this.OY,15,`${this.gB}.prefetchFromEnvironment: ensureVersionIsPrefetched has failed: ${ha}`);return}ha=JSON.stringify({versionToPrefetch:Wb,trigger:Ya,environment:ha});Z.ULS.sendTraceTag(507564319,this.OY,15,`${this.gB}.prefetchFromEnvironment: successfully prefetched from environment: ${ha}`)};this.L4i=async ha=>{ha=Eg(ha,this.yyg);ha={method:"POST",headers:{platform:"Web"},
body:JSON.stringify(ha),cache:"no-store"};this.localStorage.gmk();ha=await jg(ha);const Ya={version:ha.prefetchedVersion,environment:{ring:ha.prefetchedRing,stage:ha.prefetchedStage},clientManifestUrl:ha.clientManifestUrl,resourceDictionary:this.Q$j(ha)};this.s2f&&!this.ovc&&(this.ovc=this.C$j(ha));return Ya};this.Wil=ha=>{if(!ha.version)throw Error("versionToPrefetchMetadata.version is null");if(!ha.environment)throw Error("versionToPrefetchMetadata.environment is null");if(!ha.environment.ring)throw Error("versionToPrefetchMetadata.environment.ring is null");
if(!ha.environment.stage)throw Error("versionToPrefetchMetadata.environment.stage is null");if(!ha.resourceDictionary)throw Error("versionToPrefetchMetadata.resourceDictionary is null");if(pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PrefetchAdditionalBootResources",!1)&&!ha.clientManifestUrl)throw Error("versionToPrefetchMetadata.clientManifestUrl is null");};this.coi=(ha,Ya)=>{if(this.doi){if(ha.version===this.Vzd){Z.ULS.sendTraceTag(507795360,this.OY,15,`${this.gB}.ensureVersionIsPrefetched: version to prefetch is the current version (${this.Vzd}). Skipping prefetching.`);
return}if(this.localStorage.ode(ha.version)){Z.ULS.sendTraceTag(507795359,this.OY,15,`${this.gB}.ensureVersionIsPrefetched: version ${ha.version} is already prefetched. Skipping prefetching.`);return}}this.aek(ha,Ya)};this.aek=(ha,Ya)=>{var Wb=Object.keys(ha.resourceDictionary).length;Z.ULS.sendTraceTag(507795358,this.OY,15,`${this.gB}.prefetchVersionResources: prefetching ${Wb} resources of version ${ha.version}`);this.Ndk(ha.clientManifestUrl);Wb=Fd(this.yyg);for(const Sc of Wb)(Wb=ha.resourceDictionary[Sc.toLowerCase()])||
Z.ULS.sendTraceTag(507556486,this.OY,15,`${this.gB}.prefetchVersionResources: resource ${Sc} was not found in the resource dictionary of version ${ha.version}`),this.mde(Sc,Wb);ha={version:ha.version,ring:ha.environment.ring,stage:ha.environment.stage,time:Date.now(),trigger:Ya,versionDuringPrefetch:this.Vzd};this.localStorage.SAh(ha)};this.mde=(ha,Ya)=>{var Wb=Ra.a.MO,Sc=Wb.lastIndexOf("/");0<=Sc&&Sc<Wb.length&&(Wb=Wb.substring(0,Sc+1));const zd=yc();null===zd||void 0===zd||!zd.includes("https://res")||
null!==Wb&&void 0!==Wb&&Wb.includes("https://res")||(Sc=Wb.indexOf("/",9),Wb=Wb.substring(Sc+1,Wb.length),Sc=zd.indexOf("officeonline/"),Wb=zd.substring(0,Sc+13)+Wb);Sc=`${Wb}${Ya.UrlHash}_${ha}`;Z.ULS.sendTraceTag(507795357,this.OY,50,`${this.gB}.prefetchResource: prefetching ${ha} from url ${Sc}`);Vf.a.Wqb(Sc,void 0,Ya.SriHash)};this.Q$j=ha=>{ha=ha.clientManifestUrlEntriesSerialized;const Ya=JSON.parse(ha);if(!Ya)throw Error(`Failed to parse dictionary of resources to prefetch. Dictionary: ${ha})`);
return Ya};this.C$j=ha=>{ha=ha.ringStageBuildMap;const Ya=JSON.parse(ha);if(!Ya)throw Error(`Failed to parse environment name to version map. Map: ${ha})`);return Ya};this.Ndk=ha=>{pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PrefetchAdditionalBootResources",!1)&&(Z.ULS.sendTraceTag(507545171,this.OY,50,`${this.gB}.prefetchResource: prefetching clientManifestUrl from url ${ha}`),Vf.a.Wqb(ha))};this.Whj=()=>{const ha=6E4*pd.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.PrefetchIntervalInMinutes",
60);this.$2a=window.setInterval(this.onInterval,ha)};this.localStorage=Ef.instance;this.$Gc=Me(H);this.Vzd=$d();this.yyg=ff(H.ta);this.$Gc||(this.jRb("appVisuallyReady"),this.Whj())}dispose(){!this.$Gc&&-1<this.$2a&&window.clearInterval(this.$2a)}}Object(ia.a)(Fg,"WiseNextVersionScriptsPrefetcher",Vd.a,[559]);const og=Object(kd.b)("Common.App.PenMinutesManager.IPenMinutesManager"),qg=Object(kd.c)(og);var Bh=a(708),Jh=a(178);class Rh{constructor(H){this.S0a=this.v4d=this.V0a=this.hLc=0;this.n4d=this.Xcg=
null;this.UOc=ha=>{"pen"!==ha.pointerType||this.V0a||(this.V0a=Math.floor(this.gLb()/1E3),this.V0a<=this.hLc&&(this.V0a=this.hLc),this.v4d=0)};this.Ela=()=>{this.LRf()};this.nRb=(ha,Ya)=>{0!==Ya.newState&&this.LRf()};this.tGj=()=>{0<this.S0a&&this.gPg(this.S0a);this.S0a=0};H?(this.rLc=H,this.gLb=Date.now,this.Y9h(),this.Gok()):Z.ULS.sendTraceTag(520955213,209,10,"Can not initialize PenMinutesManager because TaskManager is null")}HLk(){this.Xcg="Office.Excel.Online.Data.Activity.PenMinutes"}Gok(){window.document.body.addEventListener("pointerenter",
this.UOc);window.document.body.addEventListener("pointerleave",this.Ela);Object(kd.d)(Bh.a).execute(H=>{H.Q4e(this.nRb)})}LRf(){const H=Math.ceil(this.gLb()/1E3);this.V0a&&H>this.hLc&&(this.v4d=H,this.S0a+=this.v4d-this.V0a);this.hLc=H;this.V0a=0}Y9h(){this.n4d=new Wa.a(4,2,6E4,this.tGj);this.rLc.Ag(this.n4d)}gPg(H){const ha={name:this.Xcg,dataFields:[]};(H=qd.a.Mf("PenInputSec",H.toString(),Xd.g.Int64))&&ha.dataFields.push(H);Jh.a.sendActivityEvent(ha)}dispose(){0<this.S0a&&this.gPg(this.S0a);this.rLc.Xr(this.n4d)}}
Object(ia.a)(Rh,"PenMinutesManager",null,[602]);class hi{constructor(){this.Ngd=this.oc=null}get name(){return"Common.App.PenMinutesManager"}ji(H){this.oc=H;const ha=ta.AFrameworkApplication.Rj;this.oc.register(602,"Common.App.PenMinutesManager.IPenMinutesManager").Lc().Qc(()=>new Rh(ha))}init(){this.Ngd=Object(kd.a)(qg)}dispose(){this.Ngd&&this.Ngd.dispose()}static main(){Pe.a.instance.Qi(new hi)}}Object(ia.a)(hi,"PenMinutesManagerPackage",null,[11,12]);Object(Sb.b)(kc.PenMinutesManagerService,{we:"singleton"})(()=>
{Type.registerNamespace("Common.App.PenMinutesManager");hi.main();const H=Object(kd.a)(qg);H.HLk();return H});var Ni=a(138);let Eh=class{constructor(H){H.kY(ha=>{void ha.O1(1).then(()=>{const Ya=document.createElement("div"),Wb=Object(Hd.f)(H).nh;appChrome.renderProactiveSuggestionDebugPane(Ya,Wb,Ni.a.Gt)})});void Sb.a.resolve(kc.RecognizedTableGridHighlighterService,{xa:1})}};Eh=Object(Ac.__decorate)([Object(Sb.d)(kc.ProactiveSuggestionDebugToolsManagerService),Object(Ac.__param)(0,Object(kc.EwaControlService)())],
Eh);Object(ia.a)(Eh,"ProactiveSuggestionDebugToolsManager",null,[]);let ri=class extends kb.a{constructor(){super()}oye(H,ha){Z.ULS.sendTraceTag(537154185,0,50,`ProactiveSuggestionManager.TriggerProactiveSuggestion: proactive suggestion was triggered. Range: ${H}, TriggerType: ${ha}`);if(pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",!1))switch(ha){case 0:this.raiseEvent("pssort",void 0,H);break;case 1:this.raiseEvent("psfilter",void 0,H);break;
case 2:this.raiseEvent("pscrttbl",void 0,H)}}};ri=Object(Ac.__decorate)([Object(Sb.d)(kc.ProactiveSuggestionManagerService)],ri);Object(ia.a)(ri,"ProactiveSuggestionManager",kb.a,[557]);var Oi=a(1483),Gh=a(94),bi=a(179);class Ig{constructor(){this.onResizeMiddleContainer=this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=this.middleContainer=null}}Object(ia.a)(Ig,"TaskPaneGroupAppProps",
null,[]);class Ci{constructor(){this.type="ExcelLegacyTaskPaneWacInfraProps";this.isSharedRuntime=!1;this.feedbackTaskPaneProps=this.getContent=null}}Object(ia.a)(Ci,"ExcelLegacyTaskPaneWacInfraProps",null,[]);var ci=a(56),di=a(46),Vi=a(345);Object(Sb.b)(kc.ReactTaskPaneManagerService,{we:"singleton"})(async H=>{H=await Sb.a.resolve(kc.EwaControlService,H);return Ch.Ea(H)});class Ch extends kb.a{constructor(H,ha){super();this.isVisible=!1;this.rei=500;this.J6b=[];this.xmf=this.y9c=null;this.Gag=pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8975558_LogPaneOpenAndUpdateTime");
this.C9d=()=>{this.kKg()};this.y0c=new Set;this.y0c.add("FieldListTaskPane");this.y0c.add("PivotTableSettingsTaskPane");this.y0c.add("SlicerSettingsTaskPane");this.Qb=ha;Zg.a(this.$).hl(this);this.w0c=H;this.Jwc={};this.X8b={};this.LGe=new Set;this.qwe=qc.a.instance.pf(this.ud);this.qwe.Ea("focusin",this.C9d);this.Yij()}get $(){return this.Qb}get hkc(){return this.LGe}get TUa(){return this.y9c}get isCollapsed(){return!this.TUa}dispose(){Zg.a(this.$).XC(this);const H=this.Jwc;for(const ha in H)({key:ha,
value:H[ha]}).value();this.X8b=this.LGe=this.Jwc=null;this.qwe.XH();this.w0c=this.qwe=null;super.dispose()}dib(H,ha,Ya,Wb,Sc,zd,be,oe,Ke,Xe,ig,Og,mg,ih,ai,Dj,Ai){Ke=void 0===Ke?Ch.mCj:Ke;Xe=void 0===Xe?Ch.lCj:Xe;ig=void 0===ig?null:ig;Og=void 0===Og?null:Og;mg=void 0===mg?!1:mg;ih=void 0===ih?!1:ih;ai=void 0===ai?null:ai;Dj=void 0===Dj?!1:Dj;const Ui=Object(ec.a)(new Ci,{getContent:()=>H});Ui.isSharedRuntime=mg;return Object(ec.a)(new Oi.a,{hideHeader:ih,contentProps:Ui,title:ha,titleTag:ai,width:Ya,
location:2,onOpen:Sc,onClose:zd,onShow:be,onHide:oe,iconUrl:ig,iconId:Og,enableResize:Wb,minResizeWidth:Ke,maxResizeWidth:Xe,showResizeChatButton:Dj,onCloseButtonTabKeyDown:Bi=>{pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8039664_TaskpaneCloseShiftTab")&&(Bi.shiftKey&&Bi.keyCode===Gh.a.JB&&!Wb?void bi.a.li().then(qk=>{1>=qk.selectors.getTabbedTaskPaneCount()&&Ai(Bi);return null}):Bi.keyCode!==Gh.a.JB||Bi.shiftKey||Ai(Bi))}})}PC(H,ha,Ya){pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8098320_SDXPreloadFix")&&
this.J6b.indexOf(H)&&(this.J6b[H]=!0);void bi.a.li().then(Wb=>{const Sc=this.Gag?this.$.Vb.Uc("UserAction",`OpenTaskPane:${null!==Ya&&void 0!==Ya?Ya:H}`):null;this.hkc.has(H)?Wb.setSelectedTaskPane(H):Wb.showTaskPane(H,ha);null===Sc||void 0===Sc?void 0:Sc.stop();return null})}Mzd(H,ha){this.J6b[H]=!1;void bi.a.li().then(Ya=>{Ya.initializeHiddenSharedRuntimeTaskPane(H,ha);const Wb=this.$.domElement;Wb.addEventListener("scroll",function zd(){0!=Wb.scrollLeft&&(Wb.scrollLeft=0,Wb.removeEventListener("scroll",
zd))})})}updateTaskPane(H,ha,Ya){pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8098320_SDXPreloadFix")&&this.J6b.indexOf(H)&&!this.J6b[H]||void bi.a.li().then(Wb=>{const Sc=this.Gag?this.$.Vb.Uc("UserAction",`UpdateTaskPane:${null!==Ya&&void 0!==Ya?Ya:H}`):null;Wb.updateTaskPane(H,ha);null===Sc||void 0===Sc?void 0:Sc.stop();return null})}setSelectedTaskPane(H){void bi.a.li().then(ha=>{ha.setSelectedTaskPane(H);return null})}hideTaskPane(H){void bi.a.li().then(ha=>{ha.hideTaskPane(H,Ch.l3k);return null})}get ud(){return this.w0c}get ij(){return this.isVisible}get tf(){return ab.a.swe}Nj(H,
ha){return ha?!1:(this.zOg(),!0)}zk(H){return Ua.DOMElementExtensions.Ki(this.ud,H)}Hm(){this.$.frame.hh.Bp(this.tf)}fo(){}focusResizeHandle(){void bi.a.li().then(H=>{H.focusResizeHandle();return null})}focusTabbedTaskPaneArea(){void bi.a.li().then(H=>{H.focusTabbedTaskPaneArea();return null})}Yij(){bi.a.li().then(H=>{const ha=new Ig;ha.onOpen=Ya=>{this.isVisible=!0;this.hkc.add(Ya)};ha.onClose=Ya=>{this.isVisible=0<H.selectors.getTabbedTaskPaneCount();Z.ULS.sendTraceTag(537014371,0,50,`Closing of ${Ya} TaskPane`);
this.isVisible||this.UCf();delete this.X8b[Ya];this.hkc.delete(Ya);this.ixa()};ha.onShow=(Ya,Wb)=>{this.y9c=Ya;this.kKg();1!==Wb&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.PBk()},0)});this.ixa()};ha.onHide=(Ya,Wb,Sc)=>{this.y9c=null;Sc&&1!==Wb&&this.UCf();this.ixa()};ha.setFocusCallback=(Ya,Wb)=>{Wb&&(this.X8b[Ya]=Wb)};ha.onResizeStart=()=>{};ha.onResizeEnd=()=>{this.ixa();Z.ULS.sendTraceTag(537014369,0,50,`Resizing of ${this.TUa} TaskPane`)};H.renderTaskPaneGroups(null,this.w0c,
ha);return null})}UCf(){Hd.f(this.$).setFocus()}ixa(){pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8980577_GridAdjustmentPostTakePaneTrigger")&&(jb.Task.delay(this.rei).continueWith(()=>{this.$.ixa(Vi.a.BGa("ResetContentAreaMargin"))}),Z.ULS.sendTraceTag(507609505,0,50,"TaskPane.onContentAreaResize"))}PBk(){if(this.X8b[this.TUa]){const H=this.X8b[this.TUa];H&&H(null,null)}else this.y0c.has(this.TUa)||this.zOg()}zOg(){bi.a.li().then(H=>{if(!pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8215527_InconsistentTaskPaneBorderFix")&&
1<H.selectors.getTabbedTaskPaneCount())H.focusTabbedTaskPaneArea();else{const ha=Ua.DOMElementExtensions.Fz(this.ud.querySelectorAll(Ua.DOMElementExtensions.$D));ha?ha.focus():pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8215527_InconsistentTaskPaneBorderFix")&&1<H.selectors.getTabbedTaskPaneCount()&&H.focusTabbedTaskPaneArea()}return null})}kKg(){this.$.domElement.scrollLeft=0;Uf.a.qva&&window.requestAnimationFrame(()=>{this.$.domElement.scrollLeft=0;window.setTimeout(()=>{this.$.domElement.scrollLeft=
0},0)})}get v0c(){return this.w0c}C7h(H,ha){let Ya=H.Tb(77);Ya||(Ya=di.a(ci.a,5,H,77),Ya.SetScriptLoadFlavor(1));ha&&Ya.Q3e(ha);let Wb=null;const Sc=()=>{Ya.create();Wb()};this.Jwc["77"]=Wb=()=>{Ya.yie(Sc);delete this.Jwc["77"]};Ya.nod(Sc)}static Ea(H){const ha=Ch.PRh(H.Oc);Ch.eMh(H,ha);return new Ch(ha,H)}static PRh(H){const ha=document.createElement("div");ha.id=H+Zc.a.p1g;ha.classList.add(qe.a.Xjl);return ha}static eMh(H,ha){H.isMobileMode&&ha.setAttribute("aria-hidden","true");let Ya;(Ya=document.getElementById("FarPaneRegion"))?
Ya.appendChild(ha):Z.ULS.shipAssertTag(509097620,11,!1,`FarPaneRegion is not found, regionComposerRoot found=${!!document.getElementById("regionComposerRoot")}`)}}Ch.mCj=300;Ch.lCj=950;Ch.l3k=2;Object(ia.a)(Ch,"ReactTaskPaneManager",kb.a,[556,24,4]);var Pi;let Di=Pi=class{constructor(H){this.S8e=null;this.H4j=ha=>{Z.ULS.sendTraceTag(508421248,0,50,`DMS call to get SDX list succeeds with status ${ha.data.httpStatus}.`);this.SRf(ha.data.responseData)};this.G4j=ha=>{200<=ha.data.httpStatus&&300>ha.data.httpStatus?
(Z.ULS.sendTraceTag(508421219,0,50,`DMS call to get SDX list succeeds with status ${ha.data.httpStatus}.`),this.SRf(ha.data.responseData)):Z.ULS.sendTraceTag(508421218,0,15,`DMS call to get SDX list fails with status ${ha.data.httpStatus}.`)};H=H.ta.SdxManifestPrefetchAssetIds;""!==H&&(this.S8e=H.split(";").map(ha=>ha.toLowerCase()),this.$dk())}$dk(){const H=Ub.a.create().toString();Z.ULS.sendTraceTag(508421250,0,50,`Start calling DMS to retrieve the list of SDXs to prefetch (dmsActivityId = ${H}).`);
ta.AFrameworkApplication.od.Wn(Vf.a.current.pO.SdxDmsUrl,2,Pi.kai(),Pi.lai(H),!1,4,this.H4j,this.G4j,null)}nmi(){return pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.OEP.UseSdx1CdnUrl",!1)||Vf.a.current.pO.ForceUseSdx1Cdn}SRf(H){try{const ha=JSON.parse(H).Packages,Ya=this.nmi()?Vf.a.current.pO.Sdx1CdnUrl:Vf.a.current.pO.SdxCdnUrl;for(const Wb of ha)if(this.S8e.includes(Wb.AssetId.toLowerCase())){const Sc=String.format(Ya,Wb.AssetId,Wb.FFN,Wb.Version,"en-us");Vf.a.Wqb(Sc,!1,null,!0)}window.prefetchedDmsResponse=
H}catch(ha){Z.ULS.sendTraceTag(508421249,0,15,`Failed to parse DMS response: "${H.substring(0,40)}...".`)}}static kai(){const H=Object(tc.a)(String,ta.AFrameworkApplication.tc.AudienceGroup)||"";var ha=ta.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExcelApiUndo25Bump",!1)?"1.25":ta.AFrameworkApplication.ea.isChangeGateEnabled("OfficeVSO:8722614_RichApiUndoExcelApiUndoBump1_24")?"1.24":"1.19";const Ya=dd.a.isReactRibbonEnabled()?"1.2":"1.1";ha=[{Name:"addincommands",
Version:"1.2"},{Name:"augloopsharedsession",Version:"1.1"},{Name:"bindingevents",Version:"1.1"},{Name:"biplatvisualrichapi",Version:"1.8"},{Name:"cdnurlsupport",Version:"1.1"},{Name:"compressedfile",Version:"1.1"},{Name:"customfunctions",Version:"1.9"},{Name:"customfunctionsruntime",Version:"1.4"},{Name:"datafrompicture",Version:"1.1"},{Name:"delayforcelledit",Version:"1.1"},{Name:"dialogapi",Version:"1.2"},{Name:"dialogorigin",Version:"1.2"},{Name:"documentevents",Version:"1.1"},{Name:"excelapi",
Version:"1.17"},{Name:"excelapionline",Version:"1.1"},{Name:"excelapiundo",Version:ha},{Name:"file",Version:"1.1"},{Name:"firstpartyauthentication",Version:"1.1"},{Name:"identityapi",Version:"1.3"},{Name:"keyboardshortcuts",Version:"1.1"},{Name:"matrixbindings",Version:"1.1"},{Name:"matrixcoercion",Version:"1.1"},{Name:"navigationpanesdx",Version:"1.2"},{Name:"numberformatting",Version:"1.2"},{Name:"pdffile",Version:"1.1"},{Name:"pivot",Version:"1.6"},{Name:"pivottablenativegrouping",Version:"1.2"},
{Name:"ribbonapi",Version:Ya},{Name:"richapiruntime",Version:"1.2"},{Name:"richapiruntimeflag",Version:"1.2"},{Name:"selection",Version:"1.1"},{Name:"settings",Version:"1.1"},{Name:"sharedruntime",Version:"1.1"},{Name:"sharedruntimeinternal",Version:"1.2"},{Name:"tablebindings",Version:"1.1"},{Name:"tablecoercion",Version:"1.1"},{Name:"tablestyle",Version:"1.1"},{Name:"textbindings",Version:"1.1"},{Name:"textcoercion",Version:"1.1"},{Name:"webauth",Version:"1.1"}];ta.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AgaveAuthContextApiEnabled",
!1)&&ha.push({Name:"nestedappauth",Version:"1.1"});return JSON.stringify({Context:{Hosts:["Workbook"],ReactNativeVersion:"0.0.0.0",Channel:"DevMain",Capabilities:ha,Ring:"Automation"===H?"Dogfood":H,Platform:"Web",Locales:[ta.AFrameworkApplication.uiCulture],ClientId:ta.AFrameworkApplication.ea.Qa("LoggableUserId")},SyncId:0})}static lai(H){return{"Content-Type":"application/json",DMSActivityId:H}}};Di=Pi=Object(Ac.__decorate)([Object(Sb.d)(kc.SdxManifestPrefetcherService),Object(Ac.__param)(0,Object(kc.EwaControlService)())],
Di);Object(ia.a)(Di,"SdxManifestPrefetcher",null,[]);var Wi=a(222);class Wh extends Vd.a{constructor(H,ha,Ya,Wb,Sc){Sc=void 0===Sc?null:Sc;super();this.fGb=null;this.S2f=!1;this.tE=()=>{this.sTb&&Z.ULS.sendTraceTag(537153858,0,50,`ActionAggregator<${this.pYb}>.OnDocumentUnhidden: Start. IsActionOngoing: ${this.bZa}, AggregatedActionParams not null: ${this.sTb}`);this.gUd()};this.zxh=H;this.Axh=ha;this.documentVisibilityObserver=Ya;this.pYb=Wb;this.bS=Sc;Ya&&this.documentVisibilityObserver.h0(this.tE)}get bZa(){return this.S2f}get sTb(){return!!this.fGb}Pwg(H){Z.ULS.sendTraceTag(537153864,
0,50,`ActionAggregator<${this.pYb}>.PerformThrottledAction: Start. IsActionOngoing: ${this.bZa}, AggregatedActionParams not null: ${this.sTb}`);this.fGb=this.Axh.Y5e(H,this.fGb);this.gUd()}dispose(){this.documentVisibilityObserver&&this.documentVisibilityObserver.wLa(this.tE);super.dispose()}ZRg(H){this.S2f=H}UBi(){Z.ULS.sendTraceTag(537153862,0,50,`ActionAggregator<${this.pYb}>.FinishedCallback: Start. IsActionOngoing: ${this.bZa}, AggregatedActionParams not null: ${this.sTb}`);this.ZRg(!1);this.gUd()}gUd(){if(!this.g7b()){var H=
this.fGb;this.fGb=null;this.ZRg(!0);Z.ULS.sendTraceTag(537153857,0,50,`ActionAggregator<${this.pYb}>.InternalPerformAction: Calling PerformAction.`);Kf.TaskExtensions.tb(this.zxh.Lwg(H),()=>{this.UBi()},Wi.a.none,0,this.bS)}}g7b(){return!this.sTb||this.bZa?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.isHidden?(Z.ULS.sendTraceTag(593376846,0,50,`ActionAggregator<${this.pYb}>.ShouldThrottle: Not Calling PerformAction as document is hidden.`),!0):!1}}Object(ia.a)(Wh,"ActionAggregator",
Vd.a,[580,4]);var Sh=a(155),ah=a(16),ei=a(52);class Uh extends kb.a{constructor(H){super();this.fB=this.dI=null;this.QZa=!1;this.ex=null;this.lQk=Uf.a.Yg;this.Tog=ha=>{const Ya=ha.Ha.keyCode;return Ya===Gh.a.vo?this.nXj():Ya===Gh.a.JB&&ha.Ha.shiftKey?this.ryi(this.dI):!1};this.Qug=ha=>{if(!this.QZa||ha.Ha.keyCode!==Gh.a.iW)return!1;Uh.mUf();jb.Task.delay(1).jw(()=>{this.fB.focus();return!0},0,this.Aa);return!0};this.A7j=()=>{document.activeElement&&document.activeElement.id===this.fB.id||(Uh.mUf(),
jb.Task.delay(1).jw(()=>{this.fB.focus();return!0},0,this.Aa))};this.vmg=()=>{this.G3g(this.fB)};this.Sog=ha=>{ha.stopPropagation();ha.preventDefault();this.QZa&&(this.QZa=!1)};this.$=H;(H=this.$.fa.$b)&&Z.ULS.sendTraceTag(39350791,0,50,`EmbedViewFocusControl: PermissionSet = ${H.YDa}; InWebPart = '${H.inWebPart?"Classic":"Non Classic"}', InEmbedView = '${H.inEmbedView?"True (+Modern)":"False (not Modern)"}'`);H&&(H.inWebPart||H.inEmbedView)?Z.ULS.sendTraceTag(537153856,0,15,`EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '${H.inWebPart?
"Classic":"Non Classic"}', InEmbedView = '${H.inEmbedView?"True (+Modern)":"False (not Modern)"}'`):(this.I7h(),this.G8h(),Sh.a.instance.va(ah.a.nd,this.$.domElement,this.Qug));this.$.ra.zc(238,this)}CEh(H){this.addHandler("KBIS",H)}vtk(H){this.removeHandler("KBIS",H)}dispose(){this.dI&&ei.a.removeHandler(this.dI,ah.a.focus,this.vmg);this.ex&&this.ex.detach("focus");this.fB&&(ei.a.removeHandler(this.fB,ah.a.focus,this.Sog),ei.a.removeHandler(this.fB,ah.a.blur,Uh.onBlur),Sh.a.instance.Ua(ah.a.nd,this.fB,
this.Tog));Sh.a.instance.Ua(ah.a.nd,this.$.domElement,this.Qug);this.ex=this.fB=this.dI=this.$=null;super.dispose()}I7h(){this.lQk?(this.dI=document.documentElement,this.ex=qc.a.instance.SP(document.parentWindow),this.ex.Ea("focus",this.A7j)):(this.dI=Uh.ikf(),document.body.insertBefore(this.dI,document.body.childNodes[0]),ei.a.addHandler(this.dI,ah.a.focus,this.vmg))}G8h(){this.fB=Uh.ikf();this.fB.id=Zc.a.tsf;this.fB.setAttribute(Zc.a.oy,Yb.a.instance.ia(863));document.body.appendChild(this.fB);
ei.a.addHandler(this.fB,ah.a.focus,this.Sog);ei.a.addHandler(this.fB,ah.a.blur,Uh.onBlur);Sh.a.instance.va(ah.a.nd,this.fB,this.Tog)}ryi(H){this.G3g(H);return!1}nXj(){this.QZa=!0;Hd.f(this.$).focus();Hd.f(this.$).ha.cRf();this.raiseEvent("KBIS");return!0}G3g(H){this.QZa?this.QZa=!1:(this.QZa=!0,H&&H.focus())}static ikf(){const H=document.createElement("div");H.tabIndex=0;return H}static mUf(){document.body.classList.add(qe.a.hvf)}static onBlur(){document.body.classList.remove(qe.a.hvf)}}Object(ia.a)(Uh,
"EmbedViewFocusControl",kb.a,[581,4]);var gj=a(72),ii=a(620);class Kh extends kb.a{constructor(H,ha){super();this.B4b=this.nLd=this.DPb=this.xW=null;this.Mfc=!1;this.VJe=null;this.Jua=this.kfe=!1;this.fZj=(Ya,Wb,Sc)=>{Z.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+Sc);this.B4b&&this.B4b.stop();this.xW=null;this.raiseEvent("GetFieldInfoListContextOperationFailed")};this.gZj=Ya=>{xd.a(Ya)||(this.B4b&&this.B4b.stop(),this.Mfc=!1,(this.xW=Ya.Result)&&0<this.xW.length&&
Z.ULS.sendTraceTag(25264351,0,50,`Retrieved ${this.xW.length} rich value field list context for autocomplete`),this.b$a=!0,this.kSc())};this.b$a=!1;this.Qb=H;this.eec=-1;this.je=ha;this.kfe=pd.EwaSettings.isChangeGateEnabled("OfficeVSO:6395797_raiseFieldInfoLoadedEventOnEmptyResults");this.Jua=pd.EwaSettings.Jua()}ood(H){this.addHandler("FieldInfoListContextLoaded",H)}zie(H){this.removeHandler("FieldInfoListContextLoaded",H)}aEh(H){this.addHandler("GetFieldInfoListContextOperationFailed",H)}Wsk(H){this.removeHandler("GetFieldInfoListContextOperationFailed",
H)}get sWd(){return this.b$a}get QDj(){return this.Mfc}get bEf(){return this.eec}get cAd(){return this.VJe}get $(){return this.Qb}get Yr(){return this.xW}get CQi(){return!!this.DPb}dispose(){this.Qb=null;this.cVc();super.dispose()}Fib(H,ha,Ya,Wb){Wb=void 0===Wb?null:Wb;if(H){this.Ytd();this.apc();var Sc=null,zd=!1;if(!Wb&&(()=>{let be=this.n9k(H,ha,Ya);({mqb:zd,Yr:Sc}=be);return be})().returnValue)if(this.kfe||this.SQg(Sc),this.Mfc=!0,this.xW=Sc,this.kfe){if(!zd){this.b$a=!0;this.kSc();return}}else if(this.xW&&
0<this.xW.length&&(this.b$a=!0,this.kSc()),!zd)return;this.$7g(H,Wb,ha,Ya,!1)}}$7g(H,ha,Ya,Wb,Sc){if(this.$.fa.yc){this.$.Vb&&(this.B4b=this.$.Vb.Uc("WebServiceCall","GetRichValueFieldInfoListContext"));this.DPb=null;var zd=this.$.ma.sa.mc(),be=this.$.ma.sa,oe=this.gZj,Ke=this.fZj;const Xe=be.$a(1,null);Xe.selectedRange=H;Xe.richValueKeyPath=ha;Xe.singleColumn=Ya;Xe.searchForRange=Wb;Xe.calculateMajorityDataType=Sc;this.DPb=se.h(be,"GetRichValueFieldListContextList",Xe,oe,Ke,null,zd,4)}else this.xW=
null}cVc(){this.xW=null;this.b$a=!1;this.Ytd();this.apc();this.DPb=null;this.eec=-1}Ytd(){Kh.mIb(this.DPb)}apc(){Kh.mIb(this.nLd)}kSc(){this.raiseEvent("FieldInfoListContextLoaded")}jt(H){H=ra.I(H);--H.left;--H.right;return this.je.jt(H)}eXa(H){H.FirstColumn=H.FirstColumn;H.LastColumn=H.LastColumn;H.FirstRow=H.FirstRow;H.LastRow=H.LastRow;this.apc();this.nLd=null;return ub.a(this.$.userOperationManager,(ha,Ya,Wb)=>Bb.k(this.$.ma.sa,H,Ic.c(ha,Sc=>{this.pZj(Sc)}),Ic.b(Ya,Ya,Sc=>{this.oZj(Sc)}),Wb,null),
ha=>new Fc.a(264,0,ha,80),null)}oZj(H){H=pc.a.te(H.data);Z.ULS.sendTraceTag(525336847,0,10,`FieldInfoManager.OnGetFullTableRangeFailure - Webservice call failed with Errors: ${eb.a.pc(H)}`)}pZj(H){if(xd.a(H))-315732528!==H.Errors[0].MessageId&&Z.ULS.sendTraceTag(525336846,0,10,`FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call failed with Unexpected error : ${eb.a.pc(H.Errors)}`);else if(H&&H.Result){H=H.Result;var ha=H.HasHeaderRow;ha=new ii.AutofilterRange(H.TableRange.FirstRow+(ha?
1:0)+1,H.TableRange.FirstColumn+1,H.TableRange.LastRow+1,H.TableRange.LastColumn+1,null,null,null,0,ha);this.eec=H.TableRange.FirstColumn;(H=this.iAg(!1,!0,ha))||Z.ULS.sendTraceTag(525336844,0,50,"FieldInfoManager.OnGetFullTableRangeSuccess - fieldInfoListContextList is null");this.SQg(H)}else Z.ULS.sendTraceTag(525336845,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call returned no result")}n9k(H,ha,Ya){let Wb,Sc;Sc=null;Wb=!1;if(H.SheetName!==this.$.fa.la.sheetName)return{returnValue:!1,
mqb:Wb,eXa:!1,Yr:Sc};let zd;this.eec=-1;if(Ya){zd=this.jt(H);if(!zd||!zd.eua)return{returnValue:!1,mqb:Wb,eXa:!1,Yr:Sc};var be=this.Jua?(be=Hd.f(this.$).Eb.bNf(zd))&&0<be.size:(be=Hd.f(this.$).Eb.cNf(zd))&&0<be.count;this.VJe=zd;if(pd.EwaSettings.isChangeGateEnabled("OfficeVSO:5167298_ObtainFullRangeOfTableForPopulatingInsertDataDropdownCorrectly")&&be)return--H.FirstColumn,--H.LastColumn,this.nLd=this.eXa(H),{returnValue:!0,mqb:Wb,eXa:!0,Yr:Sc};zd.top+=1;zd.right=ra.I(H).right-1}else zd=new ii.AutofilterRange(H.FirstRow+
1,H.FirstColumn+1,H.LastRow+1,H.LastColumn+1,null,null,null,0,!1);if(zd.top>zd.bottom||zd.left>zd.right)return{returnValue:!0,mqb:Wb,eXa:!1,Yr:Sc};H=Hd.f(this.$);var oe=H.rb.width,Ke=H.rb.height;be=H.view.visibleArea;oe=new gj.a(be.x-oe,be.y-Ke,be.width+oe,be.height+Ke);Ke=H.Wg(zd);if(!be||!Ke||!H.FHc(zd))return{returnValue:!1,mqb:Wb,eXa:!1,Yr:Sc};oe.contains(Ke)||(Wb=!0);Sc=this.iAg(ha,Ya,zd);return{returnValue:!0,mqb:Wb,eXa:!1,Yr:Sc}}SQg(H){H&&Z.ULS.sendTraceTag(25264348,0,50,`Retrieved ${H.length} rich value field contexts from block cache`);
this.Mfc=!0;(this.xW=H)&&0<this.xW.length&&(this.b$a=!0,this.kSc())}iAg(H,ha,Ya){let Wb;Wb=null;const Sc=Ya.clone();if(ha)for(let zd=Ya.right,be=0;zd>=Ya.left;--zd){if(Sc.left=zd,Sc.right=zd,ha=this.wIf(Sc,!0,Ya.left)){Wb||(Wb=[]);Wb[be]=ha;if(H)break;++be}}else if(H=this.wIf(Sc,!1))Wb=[],Wb[0]=H;return Wb}wIf(H,ha,Ya){Ya=void 0===Ya?0:Ya;var Wb=null;let Sc=[];if(this.Jua){var zd=Hd.f(this.$).Eb.bNf(H);if(!zd||0>=zd.size)return Wb;Sc=Array(zd.size);let oe=0;zd.forEach(Ke=>{const Xe={};Xe.Name=Ke.Value;
Xe.RefersToDotFunction=Ke.RefersToDotFunction;Sc[oe]=Xe;++oe})}else{var be=Hd.f(this.$).Eb.cNf(H);if(!be||0>=be.count)return Wb;Sc=Array(be.count);Wb=0;for(zd of be.values)be={},be.Name=zd,Sc[Wb]=be,++Wb}zd="";be=-1;0<H.top&&ha&&(H=new Te.Range(H.top-1,H.left,H.top-1,H.left,!1,!1),null!=Hd.f(this.$).Ob(H)&&null!=Hd.f(this.$).Ob(H).originalText&&(zd=Hd.f(this.$).Ob(H).originalText),be=H.left-Ya);Wb={};Wb.ColumnName=zd;Wb.ColumnIndex=be;Wb.FieldInfoDataList=Sc;return Wb}static mIb(H){H&&ta.AFrameworkApplication.od.dy(H.sx)}}
Object(ia.a)(Kh,"FieldInfoManager",kb.a,[579,4]);class ji extends Kh{constructor(H,ha,Ya,Wb){super(H,ha);this.ngb=null;this.omg=()=>{this.zie(this.omg);if(this.Yr&&this.Yr.length&&this.qX){var Sc=this.qX.CKd("autoFilterRichFieldList"),zd=window.document.getElementById(this.ngb);Sc.sfa(null,zd,this,null,!0)}};this.ujh=Ya;this.qX=Wb}get MM(){return this.ujh}PQi(H,ha){this.ngb=ha;Z.ULS.sendTraceTag(537153825,0,100,`FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col (${H.FirstRow}, ${H.FirstColumn}, ${H.LastRow}, ${H.LastColumn})`);
this.$7g(H,null,!0,!1,!0)}}Object(ia.a)(ji,"FilterInfoManager",Kh,[578,579,4]);var ki=a(1123),Zi=a(1249);class Lh{}Lh.Fsi="ewa-sharedUi-launchButton";Lh.Gsi="ewa-sharedUi-launchButtonClick";Lh.Hsi="ewa-sharedUi-launchButtonText";Lh.Isi="ewa-sharedUi-launchButtonWithText";Lh.Jsi="ewa-sharedUi-launchButtonWithTextClick";Object(ia.a)(Lh,"SharedUIControlsClassNames",null,[]);a(610);var Fh=a(309),fi=a(286),Qi=a(334),si=a(71),hj=a(330);class li extends zg.a{constructor(H,ha,Ya,Wb,Sc,zd,be,oe,Ke,Xe){super(document.createElement("div"));
this.g8f=null;this.Jte=!1;this.zoom=this.Mc=this.d9b=this.U5a=null;this.$U=()=>{this.raiseEvent("OnObjectButtonMouseOver")};this.ZU=()=>{this.raiseEvent("OnObjectButtonMouseOut")};this.RXk=()=>{this.e1e()};this.Hd=ig=>{this.raiseEvent(this.i1b,ig);this.Mqb();return!0};this.RWj=ig=>{100<ed.a(Pc.a.zb,this.g8f)&&this.GQd(new Sys.UI.Point(Math.round(ig.clientX),Math.round(ig.clientY)))};this.VU=ig=>{si.g(ig.Ha,!1);return!1};this.zoom=Xe;this.Y6=this.Df.zUa();this.set_visible(!1);this.sIc=Sc;this.i1b=
zd;this.HMc=H;this.Zpc=ha;this.Mc=Ke;this.sIc&&(this.U5a=Lg.a.instance.create(this.RXk,3E4,"OnObjectButton.ShyTimerFired",!1,!1));H&&this.domElement.classList.add(H);this.oTa=document.createElement("div");this.domElement.appendChild(this.oTa);Ya&&this.oTa.classList.add(Ya);this.Fze(Wb);be&&(this.d9b=document.createElement("div"),this.domElement.appendChild(this.d9b),this.d9b.classList.add(oe),this.d9b.innerText=be,this.domElement.style.padding="3px",Fh.a.instance.va(ah.a.Sd,this.domElement,this.VU));
this.odb=new Qi.a(this.domElement,7);fi.a.instance.va(ah.a.click,this.domElement,this.Hd);pd.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&Fh.a.instance.va(ah.a.Sd,this.domElement,this.VU);H=ig=>{si.g(ig)};this.Dd.Ea("mouseup",H);this.Dd.Ea("click",H);this.Dd.Ea("dblclick",H)}i6(H){this.addHandler(this.i1b,H)}Lea(H){this.get_events().removeHandler(this.i1b,H)}VEh(H){this.addHandler("OnObjectButtonMouseOver",H)}Mtk(H){this.get_events().removeHandler("OnObjectButtonMouseOver",
H)}UEh(H){this.addHandler("OnObjectButtonMouseOut",H)}Ltk(H){this.get_events().removeHandler("OnObjectButtonMouseOut",H)}Fze(H){H&&this.Mc.vl(this.oTa,H)}x2c(H){this.oTa&&H&&this.oTa.setAttribute("title",H)}Obl(H,ha,Ya){var Wb=16,Sc=16;Wb=void 0===Wb?0:Wb;Sc=void 0===Sc?0:Sc;this.Mc.HH(this.oTa);H?H.hka(ha,16,16,this.oTa,Wb,Sc,void 0,Ya):Z.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")}Pbl(H,ha){H&&(this.d9b.innerText=H);this.domElement.title=
ha}dispose(){this.get_isInitialized()&&(this.hide(),this.Dd.XH(),Ca.a.xd([this.Y6,this.odb]),fi.a.instance.Ua(ah.a.click,this.domElement,this.Hd),Fh.a.instance.Ua(ah.a.Sd,this.domElement,this.VU),this.U5a&&this.U5a.dispose(),super.dispose())}m4b(){this.Zpc&&this.domElement.classList.remove(this.Zpc);this.HMc&&this.domElement.classList.add(this.HMc)}Mqb(){this.HMc&&this.domElement.classList.remove(this.HMc);this.Zpc&&this.domElement.classList.add(this.Zpc);this.Ggb()}Ggb(){this.sIc&&(this.U5a.cancel(),
this.e_g(),this.setOpacity(1));this.set_visible(!0)}Xo(H,ha,Ya,Wb,Sc){Sc=void 0===Sc?!1:Sc;H=this.zoom.zoomManager.sh(H);ha=this.zoom.zoomManager.sh(ha);this.zoom.zoomManager.QXc(this.domElement);this.domElement.style.top=lf.HelperMethods.$c(ha);this.domElement.style.left=this.domElement.style.right="";ha=H;Sc&&(ha=H-this.domElement.offsetWidth);hj.c(this.domElement.style,Ya,lf.HelperMethods.$c(ha));this.set_visible(!0);this.setOpacity(1);this.sIc&&(this.Jte=!1,this.V_k(),this.U5a.Cv())}hide(){this.m4b();
this.set_visible(!1);this.sIc&&(this.e_g(),this.U5a.cancel())}xDd(){this.Dd.Ea("mouseover",this.$U,!0);this.Dd.Ea("mouseout",this.ZU,!0)}V_k(){this.Y6.Vp("mousemove")||this.Y6.Ea("mousemove",this.RWj)}e_g(){this.Y6.Vp("mousemove")&&this.Y6.detach("mousemove")}GQd(H){if(this.domElement.parentNode){var ha=lf.HelperMethods.isStandardZoomCssSupportedByBrowser?Ua.DOMElementExtensions.getBoundingClientRect({element:this.domElement,di:!0}):Sys.UI.DomElement.getBounds(this.domElement);const Ya=new Sys.UI.Point(Math.round(ha.x+
ha.width),Math.round(ha.y+ha.height));ha=Math.abs(Ya.x-H.x);H=Math.abs(Ya.y-H.y);H=ha>H?ha:H;this.Jte?this.setOpacity(li.TTh(H)):100>=H&&this.e1e()}}e1e(){this.Jte=!0;this.U5a.cancel()}setOpacity(H){Uf.a.setOpacity(this.domElement,H);this.g8f=Pc.a.zb.Jc}static TTh(H){return 100>=H?1:250<=H?0:.01*(100-(H-100)/150*100)}}Object(ia.a)(li,"OnObjectButton",zg.a,[593,489,4]);var $i=a(1062);const xj=Lh.Hsi;class ti extends Vd.a{constructor(H,ha,Ya,Wb,Sc,zd,be,oe,Ke,Xe){Xe=void 0===Xe?"":Xe;super();this.GHa=
null;this.NUf=!1;this.Mc=this.fMc=this.gMc=null;this.buttons={};this.Auf={};this.zoom=Ke;this.$=H;this.svgIconProvider=ha;this.RUj=Ya;this.NSd=Wb;this.MSd=Sc;this.altText=zd;this.i1b=be;this.Mc=oe;this.buttonText=Xe}get zoomManager(){return this.zoom.zoomManager}get Kz(){return this.zoomManager.Aqa(uf.a.r2j)}get uIb(){return uf.a.q2j}get buttonWidth(){return this.zoomManager.Aqa(uf.a.s2j)}dispose(){this.hii();this.$=null;super.dispose()}getButton(H,ha){return this.nta(H,void 0===ha?!0:ha)}nta(H,ha){const Ya=
H.toString();Ya in this.buttons||this.I8h(H,void 0===ha?!0:ha);return this.buttons[Ya]}Xo(H,ha,Ya,Wb,Sc,zd){Sc=void 0===Sc?!0:Sc;zd=void 0===zd?!1:zd;this.hide();if(this.$.fa.isNamedObjectViewMode&&tf.i(this.$.la)){var be=Hd.f(this.$).Yea.domElement;const oe=H+this.buttonWidth-be.scrollWidth;be=ha+this.buttonWidth-be.scrollHeight;H=0<oe?H-oe:H;ha=0<be?ha-be:ha}this.nta(Wb,Sc).Xo(H,ha,Ya,this.$,zd)}hide(){const H=this.buttons;for(const ha in H)H[ha].hide()}xDd(H,ha){!this.NUf&&(ha=this.buttons[ha.toString()])&&
(this.gMc=(Ya,Wb)=>{H(Wb,!0)},ha.VEh(this.gMc),this.fMc=(Ya,Wb)=>{H(Wb,!1)},ha.UEh(this.fMc),this.NUf=!0,ha.xDd())}I8h(H,ha){this.GHa=String.format(this.NSd===qe.a.Ovc?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',cd.a.$l(this.NSd),cd.a.$l(this.MSd),"{0}");var Ya=String.format(this.GHa,cd.a.$l(this.altText));ha=new li(""===this.buttonText?Lh.Fsi:Lh.Isi,""===this.buttonText?Lh.Gsi:Lh.Jsi,
qe.a.H0,Ya,ha,this.i1b,this.buttonText,xj,this.Mc,this.zoom);Ya=(Wb,Sc)=>{this.RUj(Sc,H)};ha.i6(Ya);this.buttons[H.toString()]=ha;this.Auf[H.toString()]=Ya;Ya=Hd.f(this.$).pg(H);Ya.domElement.insertBefore(ha.domElement,Ya.domElement.firstChild)}hii(){for(const H of $i.a(this.buttons)){const ha=this.buttons[H];ha.Lea(this.Auf[H]);Ca.a.vb(ha);delete this.buttons[H];this.gMc&&ha.Mtk(this.gMc);this.fMc&&ha.Ltk(this.fMc)}}domElement(H){return this.nta(H).domElement}Ggb(H){this.nta(H).Ggb()}B$b(H,ha,Ya){Ya=
void 0===Ya?!0:Ya;this.GHa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',cd.a.$l(this.NSd),cd.a.$l(this.MSd),"{0}");H=String.format(this.GHa,cd.a.$l(H));this.nta(ha,Ya).Fze(H)}G7a(H,ha,Ya){this.nta(Ya,!1).Pbl(H,ha)}X7g(){var H=void 0===H?!1:H;this.GHa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',"{0}",cd.a.$l(this.MSd),"{1}");const ha=String.format(this.GHa,void 0,cd.a.$l(void 0));
this.nta(void 0,H).Fze(ha)}Y2c(H,ha,Ya){this.nta(Ya,!1).Obl(this.svgIconProvider,H,ha)}x2c(H,ha){this.nta(ha,!1).x2c(H)}}Object(ia.a)(ti,"OnObjectLaunchButton",Vd.a,[576,4]);var Ei=a(105);class Ag extends Ei.a{constructor(H,ha){super(H);this.GXb=null;this.Nhi=()=>{this.display()};this.$ej=Math.max(1,ha)}dispose(){Ca.a.vb(this.GXb);this.GXb=null;super.dispose()}o6a(){Ca.a.vb(this.GXb);this.GXb=Lg.a.instance.create(this.Nhi,this.$ej,fe.a.UDj)}x6a(){Ca.a.vb(this.GXb);this.hide()}}Object(ia.a)(Ag,"LoadingIndicatorBehavior",
Ei.a,[592,4]);class vh extends Ag{constructor(H,ha,Ya,Wb){super(H,ha);this.FXb=null;this.Rlh=Ya;this.Sbj=Wb;this.aAh()}dispose(){this.FXb=null;super.dispose()}display(){this.Rlh(this.FXb)}hide(){this.Sbj(this.FXb)}aAh(){this.FXb=document.createElement("div");this.domElement.appendChild(this.FXb)}}Object(ia.a)(vh,"ShimmerLoadingIndicatorBehavior",Ag,[]);var Fi=a(60);class mi extends Ag{constructor(H,ha,Ya,Wb,Sc,zd){Wb=void 0===Wb?null:Wb;Sc=void 0===Sc?null:Sc;zd=void 0===zd?0:zd;super(H,ha);this.dkb=
this.G0a=null;this.dkb=Ya;this.EDc=Wb||Vf.a.current.Lo(104);this.h$f=zd;this.jAd=Sc;this.$zh()}dispose(){this.G0a=null;super.dispose()}display(){Ua.DOMElementExtensions.setVisible(this.G0a,!0)}hide(){Ua.DOMElementExtensions.setVisible(this.G0a,!1)}$zh(){this.G0a=document.createElement("div");this.G0a.classList.add(Fi.a.Rri);const H=document.createElement("div");H.classList.add(Fi.a.Sri);this.jAd&&""!=this.jAd&&H.classList.add(this.jAd);const ha=0===this.h$f?"":Yb.a.instance.ia(this.h$f),Ya=String.format('<div class="'+
Fi.a.Tri+'">{0}</div>',ha);this.EDc?this.dkb.vl(H,`<img src="${this.EDc}" alt="${ha}" title="${ha}"/>`+Ya):this.dkb.vl(H,Ya);this.G0a.appendChild(H);this.domElement.appendChild(this.G0a)}}Object(ia.a)(mi,"SpinnerLoadingIndicatorBehavior",Ag,[]);Object(Sb.b)(kc.SharedUIControlsFactoryService)(async H=>{const [ha,Ya]=await Promise.all([Sb.a.resolve(kc.HtmlSanitizationHelperService,{xa:H.xa}),Sb.a.resolve(kc.ZoomService)]);return new ui(ha,Ya)});class ui{constructor(H,ha){this.dkb=H;this.zoom=ha}gzd(H,
ha,Ya){return new ki.a(H,ha,Ya)}Trc(H,ha,Ya,Wb,Sc,zd,be,oe,Ke,Xe){return new Zi.a(H,ha,Ya,Wb,Sc,zd,be,oe,Ke,Xe)}BKb(H,ha,Ya,Wb,Sc){return new mi(H,ha,this.dkb,Ya,Wb,void 0===Sc?0:Sc)}mNd(H){return H.ra.Tb(238)||new Uh(H)}pKb(H,ha,Ya,Wb,Sc,zd,be,oe){return new ti(H,ha,Ya,Wb,Sc,zd,be,this.dkb,this.zoom,void 0===oe?"":oe)}fkf(H,ha){return new Kh(H,ha)}F7h(H,ha,Ya,Wb){return new ji(H,ha,Ya,Wb)}jjf(H,ha,Ya,Wb){return new Wh(H,ha,Ya,Wb)}}Object(ia.a)(ui,"SharedUIControlsFactory",null,[552]);var Qh=a(485);
let Xi=class{constructor(H,ha,Ya){var Wb,Sc;this.$=H;this.da=ha;this.TG=Ya;this.$7d=3;this.vig=100;this.jd=()=>{this.TG.j4a({abortReason:"workbookClosed"})};Ya.j4a({success:!1,entriesCount:this.ewb,abortReason:"notStarted",sheetCount:null===(Sc=null===(Wb=this.$.qa)||void 0===Wb?void 0:Wb.items)||void 0===Sc?void 0:Sc.length});this.Cme();this.$.Sj(this.jd)}Cme(){window.requestIdleCallback?window.requestIdleCallback(()=>this.Iyg()):dg.f(()=>{this.Iyg()},this.$.Aa,100)}Iyg(){if(this.qQk()){var H=this.$.qa.items,
ha=this.$.zn.activeItemIndex;0>ha&&(Z.ULS.sendTraceTag(507635023,0,50,"SheetProcessedDataProvider.prefetchSheetProcessedData: active item index is unknown, using 0 instead..."),ha=0);var Ya=this.kNh;if(0===H.length||Ya===H.length)Z.ULS.sendTraceTag(507635022,0,15,`SheetProcessedDataProvider.prefetchSheetProcessedData: there are ${Ya}/${H.length} available spds, nothing to prefetch.`),this.TG.j4a({success:!0,entriesCount:this.ewb});else{Z.ULS.sendTraceTag(507635021,0,50,`SheetProcessedDataProvider.prefetchSheetProcessedData: there are ${Ya}/${H.length} available spds, searching for unavailable SPD to prefetch...`);
Ya=ha-1;ha+=1;for(var Wb;0<=Ya||ha<H.length;){if(0<=Ya){var Sc=H[Ya];if(E(Sc)){Wb=Sc.sheetName;break}--Ya}if(ha<H.length){Sc=H[ha];if(E(Sc)){Wb=Sc.sheetName;break}ha+=1}}null==Wb?(this.TG.j4a({success:!0,entriesCount:this.ewb}),Z.ULS.sendTraceTag(507635020,1,50,"SheetProcessedDataProvider.prefetchSheetProcessedData: done prefetching.")):this.da.Vxk(Wb).then(()=>{this.Cme()}).catch(zd=>{--this.$7d;const be=Qh.a.isExpectedError(zd);Z.ULS.sendTraceTag(507635019,0,50,`SheetProcessedDataProvider.prefetchSheetProcessedData: unable to prefetch SPD, error='${zd.message}', isExpected=${be}. Remaining attempts=${this.$7d}...`);
0<this.$7d?this.Cme():this.TG.j4a({success:!1,entriesCount:this.ewb,abortReason:"failedAttemptsLimit"})})}}}qQk(){let H=!0,ha;--this.vig;0>this.vig&&(ha="iterationLimit",H=!1);this.loi&&(ha="maxEntriesExceeded",H=!1);H||(this.TG.j4a({success:!1,entriesCount:this.ewb,abortReason:ha}),Z.ULS.sendTraceTag(507635018,0,50,`SheetProcessedDataProvider.shouldAttemptPrefetch: unable to prefetch all SPDs, reason=${ha}`));return H}get loi(){return 1E3<=this.ewb}get ewb(){var H=this.$.qa.items;let ha=0;for(const Ya of H)H=
Ya.sheetProcessedData,Object(Ee.d)(H)&&(ha+=H.value.E1a);return ha}get kNh(){let H=0;const ha=this.$.qa.items;for(const Ya of ha)H+=Object(Ee.d)(Ya.sheetProcessedData)?1:0;return H}};Xi=Object(Ac.__decorate)([Object(Sb.d)(kc.SheetProcessedDataPrefetcherService),Object(Ac.__param)(0,Object(kc.EwaControlService)()),Object(Ac.__param)(1,Object(kc.GridViewService)()),Object(Ac.__param)(2,Object(kc.ViewportTelemetryManagerService)())],Xi);Object(ia.a)(Xi,"SheetProcessedDataPrefetcher",null,[]);var ij=
a(242),Rd=a(128),ve=a(606);class Ej extends kb.a{constructor(H,ha,Ya,Wb){super();this.value=null;this.$=Wb;this.w0d=H;this.vA=ha;this.Bqh=Ya}FDh(H){this.addHandler("EnabledStateChanged",H)}get isEnabled(){return this.vA}set isEnabled(H){H!==this.vA&&(this.vA=H,dd.a.oj(this.$)&&appChrome.api.dispatch(appChrome.actions.toggleButton("Toggle"+this.w0d.replace(" ","")+"Button",H)),this.raiseEvent("EnabledStateChanged"))}get isVisible(){return this.isEnabled&&!!this.value}get Yi(){return this.value?String.format(Yb.a.instance.Ib(79),
this.w0d,this.value):this.w0d}get TKc(){return this.Bqh}}Object(ia.a)(Ej,"StatusBarAggregateControl",kb.a,[594]);class hh extends kb.a{constructor(H){super();this.controls=new qh.a(!1);this.bHe=null;this.nBg=()=>{this.raiseEvent("AggregatesChanged")};this.$=H;this.zha(0,415,"Average",!0);this.zha(1,416,"Count",!0);this.zha(2,417,"NumericalCount",!1);this.zha(3,418,"Minimum",!1);this.zha(4,419,"Maximum",!1);this.zha(5,420,"Sum",!0)}DCh(H){this.addHandler("AggregatesChanged",H)}Jrk(H){this.removeHandler("AggregatesChanged",
H)}get ncb(){return this.bHe||hh.ysf}set ncb(H){H=H||hh.ysf;H!==this.ncb&&(this.nMa(0,H.Average),this.nMa(1,H.Count),this.nMa(2,H.NumericalCount),this.nMa(3,H.Minimum),this.nMa(4,H.Maximum),this.nMa(5,H.Sum),this.bHe=H,this.nBg())}dispose(){Ca.a.xd(this.controls.values);this.controls.clear();super.dispose()}nGa(H){return this.controls.getItem(H)}Tyh(H,...ha){H=this.nGa(H.toString());for(const Ya of ha)this.controls.add(Ya,H)}zha(H,ha,Ya,Wb){ha=new Ej(Yb.a.instance.La(ha),Wb,Ya,this.$);ha.FDh(this.nBg);
this.controls.add(H.toString(),ha)}nMa(H,ha){this.nGa(H.toString()).value=ha}static get ysf(){hh.LAa||(hh.LAa={},hh.LAa.Average=hh.LAa.Count=hh.LAa.NumericalCount=hh.LAa.Minimum=hh.LAa.Sum=null);return hh.LAa}}hh.LAa=null;Object(ia.a)(hh,"StatusBarAggregateControlCollection",kb.a,[]);var Ri=a(401),wi=a(4),Si=a(209),ni;const oi=[{ocb:0,name:"Average",b7a:-1015637685,pcb:1,Lhb:!0},{ocb:1,name:"Count",b7a:1957769939,pcb:3,Lhb:!1},{ocb:2,name:"NumericalCount",b7a:-1292677035,pcb:2,Lhb:!1},{ocb:3,name:"Minimum",
b7a:405783320,pcb:5,Lhb:!0},{ocb:4,name:"Maximum",b7a:1210824414,pcb:4,Lhb:!0},{ocb:5,name:"Sum",b7a:1265371067,pcb:9,Lhb:!0}];let aj=ni=class{constructor(H,ha){this.statusBarManager=void 0===ha?null:ha;this.Dyc=this.t2c=this.u2c=this.s2c=null;this.dnb=new qh.a(!0);this.H1g=0;this.i5g=Ya=>{const Wb=this.ha.oa.activeCell.clone(),Sc=ra.e(this.ha.oa.selectedRanges);var zd=this.$.la;const be=null===zd||void 0===zd?void 0:zd.sheetId,oe=null===zd||void 0===zd?void 0:zd.hash,Ke=this.$.fa.Je,Xe=this.$.fa.Cw;
zd=this.$.listSeparator;const ig=ra.k(ra.M(Sc),zd,this.$,!1),Og=`=${this.Yd.config.localeInfo.getWorksheetFuncName(485)}({0}${zd}5${zd}{1})`;Promise.all(oi.map(mg=>this.Yd.evalFormula(String.format(Og,mg.pcb,ig),Wb,void 0,mg.Lhb?excelOnlineCalc.calc.evalFormulaFormatAggregate():excelOnlineCalc.calc.evalFormulaFormatKnown(0)))).then(mg=>{var ih;const ai=this.ha.oa.selectedRanges,Dj=this.ha.oa.activeCell,Ai=null===(ih=this.$.la)||void 0===ih?void 0:ih.sheetId;if(ra.Y(Sc,ai)&&Wb.equals(Dj)&&be===Ai){ih=
[];for(var Ui of mg.entries()){[,mg]=Ui;if(void 0===(null===mg||void 0===mg?void 0:mg.formatted)||!excelOnlineCalc.util.isSuccess(mg.formatted)||!excelOnlineCalc.util.isSuccess(mg.value)){this.mWc();return}mg=this.Yd.EI.renderValue(mg.formatted.value,excelOnlineCalc.numfmt.renderInfiniteWidth);if(!excelOnlineCalc.util.isSuccess(mg)){this.mWc();return}if(pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8759742_ExcelOnlineCalcEs2015")&&excelOnlineCalc.numfmt.isHashesValue(mg.value)){this.mWc();return}mg=
excelOnlineCalc.numfmt.renderedValueToString(mg.value);ih.push(mg)}Ui={};for(var Bi of oi)Ui[Bi.name]="";Bi=ih[1];mg=ih[2];if(1<+Bi&&(Ui.Count=Bi,0<+mg))for(const qk of oi.entries()){const [rj,gl]=qk;Ui[gl.name]=ih[rj]}this.D6b(Ui);this.H3k(Ui,Bi,Ke,Xe,Sc,Wb,be,oe,Ya)}}).catch(mg=>{Z.ULS.sendTraceTag(537151266,0,10,`TryToCalculateAggregatesUsingCalc: in catch, reason fields: ${JSON.stringify(mg)}, reason message: ${String(mg)}, stack: ${null!==mg&&"object"===typeof mg?mg.stack:void 0}`);this.mWc()})};
this.Nd=()=>{this.N6g()};this.onBlockCacheItemChanged=(Ya,Wb)=>{Ya=Wb.he.hash;Wb=Wb.he.block;const Sc=Wb.bca;if(Wb.state&4&&Sc&&Sc!==this.dnb.getItem(Ya)){this.dnb.add(Ya,Sc);var zd=(Ya=Wb.Nf)?Hd.e(Ya.getRowNumbers(),Ya.getColumnNumbers()):null;ij.a.any(this.ha.oa.selectedRanges,be=>be.ld(zd))&&this.N6g()}};this.qr=(Ya,Wb)=>{this.dnb.remove(Wb.he.hash)};this.de=()=>{this.$.ra.Vc(29,Ya=>{this.statusBarManager=Ya;Ya.FJ(this);Z.ULS.sendTraceTag(537151265,0,50,"StatusBarAggregateManager.OnWorkbookOpened: after AddFeatureRootUser")})};
this.yd=(Ya,Wb)=>{!Ya.yc&&Gg.b(Wb)&&this.statusBarManager&&(this.statusBarManager.OI(this),this.statusBarManager=null,Z.ULS.sendTraceTag(537151264,0,50,"StatusBarAggregateManager.OnSessionIdChanged: after RemoveFeatureRootUser"))};this.p4k=()=>{let Ya;const Wb=this.ha.oa.selectedRanges;(()=>{let Sc=this.t9k(Wb);({Qoc:Ya}=Sc);return Sc})().returnValue?this.D6b(Ya):this.nJg()};this.nJg=()=>{var Ya;const Wb=ra.e(this.ha.oa.selectedRanges),Sc=this.ha.oa.activeCell.clone(),zd=null===(Ya=this.$.la)||void 0===
Ya?void 0:Ya.sheetId;this.Cdg(Sc,Wb,be=>{var oe;const Ke=this.ha.oa.selectedRanges,Xe=this.ha.oa.activeCell,ig=null===(oe=this.$.la)||void 0===oe?void 0:oe.sheetId;ra.Y(Wb,Ke)&&Sc.equals(Xe)&&zd===ig&&this.D6b(be.Result)})};this.initData(H);H.Ia.yha(this);this.A6e=pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AlwaysTestCalcResult",!1);this.$=H;this.da=Hd.f(this.$);this.yba=ta.AFrameworkApplication.od;this.vj=Pc.a.zb;this.UCa=new hh(this.$);this.$.fa.Vk(this.yd);this.$.Ul(this.de);this.ha.Vq(this.Nd);
this.ha.add_activeCellChanged(this.Nd);this.za.$t(this.onBlockCacheItemChanged);this.za.xP(this.qr);for(const Ya of oi)this.sNk(Ya.ocb,Ya.name,Ya.b7a);this.statusBarManager&&this.statusBarManager.FJ(this);void Sb.a.resolve(kc.CalcManagerService,{xa:1}).then(Ya=>this.Yd=Ya);void Sb.a.Bd(kc.InstantaneousSupportInformationManagerService).then(Ya=>this.instantaneousSupportInformationManager=Ya)}Js(H){this.UCa.DCh(H)}vs(H){this.UCa.Jrk(H)}get ncb(){return this.UCa.ncb}D6b(H){this.UCa.ncb=H}get za(){return this.da.za}get ha(){return this.da.ha}dispose(){this.$&&
(this.$.fa.Qk(this.yd),this.$.tm(this.de),this.ha.vr(this.Nd),this.ha.remove_activeCellChanged(this.Nd),this.za.yu(this.onBlockCacheItemChanged),this.za.AR(this.qr),this.Dcf());this.statusBarManager&&(this.statusBarManager.OI(this),this.statusBarManager=null);Ca.a.xd([this.s2c,this.u2c,this.t2c,this.UCa]);this.$=this.UCa=this.t2c=this.u2c=this.s2c=null;this.dnb&&(this.dnb.clear(),this.dnb=null)}vq(H,ha){return this.nGa(H)&&this.wMf(H,ha)?!0:!1}wMf(H,ha){const Ya=this.nGa(H);if(!Ya)return!1;const Wb=
Ya.Yi;if(H.endsWith("Label"))ha.Visible=Ya.isVisible,dd.a.oj(this.$)?ha.LabelText=Wb:ha.Value=Wb;else if(H.endsWith("Button"))ha.LabelText=Wb,ha.On=Ya.isEnabled,Rd.FocusManager.instance().fm(ve.AFrame.rZ);else return!1;return!0}Wj(){return!0}gd(){return!1}executeCommand(H,ha){H=this.nGa(ha.command);if(!H)return Si.a(ha.command);H.isEnabled=!H.isEnabled;this.TEj(H.TKc,H.isEnabled);return jb.Task.Va(!0)}Rc(H,ha){return!!this.nGa(ha.command)}td(){return!1}Cdg(H,ha,Ya){var Wb=this.$;this.Dcf();if(this.$.fa.yc){var Sc=
Wb.ma.sa;H=ra.r(H,Wb);ha=ra.u(ha,Wb);Wb=Sc.$a(1,null);Wb.activeCell=H;Wb.selectedRanges=ha;this.Dyc=se.h(Sc,"GetStatusBarAggregates",Wb,Ya,null,null,null,0)}}t9k(H){let ha,Ya=ni.h5g(H);({Qoc:ha}=Ya);return{returnValue:Ya.returnValue||this.yKh(H)&&this.vKh(H),Qoc:ha}}H3k(H,ha,Ya,Wb,Sc,zd,be,oe,Ke){const Xe=this.A6e?1:.05,ig=this.A6e?1E3:20;if(Ke||!(this.H1g>ig||Math.random()>Xe))this.H1g++,this.Cdg(zd,Sc,Og=>{var mg,ih,ai,Dj;if(!xd.a(Og)){var Ai=this.ha.oa.selectedRanges,Ui=this.ha.oa.activeCell,Bi=
null===(mg=this.$.la)||void 0===mg?void 0:mg.sheetId;mg=Og.StateId;if(ra.Y(Sc,Ai)&&zd.equals(Ui)&&be===Bi&&Ya===this.$.fa.Je&&Wb===this.$.fa.Cw&&Ya===mg){var qk=Og.Result;mg={};const Jm={};Bi=!0;for(var rj of oi){var gl=qk[rj.name],$l=H[rj.name];const Km=gl===$l;mg[rj.name]=Km;Jm[rj.name]=[gl.length,$l.length];Bi&&(Bi=Km)}({category:Ui}=this.instantaneousSupportInformationManager?this.instantaneousSupportInformationManager.q9k(null!==(Dj=null===(ai=null===(ih=this.da.Ob(Ui))||void 0===ih?void 0:ih.cell)||
void 0===ai?void 0:ai.oi)&&void 0!==Dj?Dj:0):{category:"uninitialized"});ih=Ai.length;Ai=ra.c(Ai);ai=this.da.MSf()||this.da.LSf();rj=this.da.rb;Dj=rj.L0b;rj=Jf.c(zd,rj.Gg,rj.Vg,this.da.rowsPerBlock,this.da.columnsPerBlock,this.da.hd);rj=rj.X+"_"+rj.Y+"_"+rj.PaneType;qk=qk.Count;gl=H.Count;$l=this.da.Eb.yAc(Sc);Og=`StatusBarAggregateManager.testCalcResult: allCorrect: ${Bi}, ${JSON.stringify(mg)}, numberFormatCategory: ${Ui}, resLength(server,calc): ${JSON.stringify(Jm)}, stateId: ${Ya}, latestSuccessfulStateId: ${Wb}, prevSheetId: ${be}, prevSheetHash: ${oe}, numOfRanges: ${ih}, numOfCells: ${Ai}, prevActiveCell: ${zd}, prevSelectedRanges: ${Sc.join(";")}, sheetHasHidden: ${ai}, panesState: ${Dj}, blockPositionString: ${rj}, ReportCalcState: ${Og.ReportCalcState}, CalcComplete: ${Og.CalcComplete}, serverCount: ${qk}, calcCount: ${gl}, calcCountUnfiltered: ${ha}, enumeratorCount: ${$l}, forceTestResult: ${Ke}`;
Z.ULS.sendTraceTag(520426510,0,50,Og);Bi||Ke||window.setTimeout(()=>{this.i5g(!0)},100)}}})}yKh(H){const ha=this.da.Ek;return!!ha&&ij.a.all(H,Ya=>ha.contains(Ya))&&ij.a.all(H,Ya=>!this.da.hd.wda(Ya))}vKh(H){if(500<ra.c(H))return!1;const ha=this.vj.me;H=this.da.Hba("StatusBarAggregateManager.AreAllCellsEmpty",H);try{for(let Ya=0;H.$$mn();Ya++)if(H.$$cu().WL||!(Ya%25)&&100<ed.c(this.vj,ha))return!1}finally{H&&H.dispose()}return!0}nGa(H){return this.UCa.nGa(H)}sNk(H,ha,Ya){this.UCa.Tyh(H,"Query"+ha+
"Label","Query"+ha+"Button",Ya.toString())}N6g(){var H;if(this.$.$d&4&&!this.da.isEditing&&!this.da.nk){var ha;(()=>{let Ya=ni.h5g(this.ha.oa.selectedRanges);({Qoc:ha}=Ya);return Ya})().returnValue?this.D6b(ha):(this.D6b(null),(null===(H=this.Yd)||void 0===H?0:H.WEc)?this.oDk():this.s2c=Fe.AsyncMethodContext.Ax(this.p4k,500,fe.a.y0k,this.s2c))}}oDk(){this.t2c=Fe.AsyncMethodContext.Ax(()=>this.i5g(!1),10,fe.a.z0k,this.t2c)}mWc(){this.u2c=Fe.AsyncMethodContext.Ax(this.nJg,500,fe.a.x0k,this.u2c)}Dcf(){this.Dyc&&
(this.yba.dy(this.Dyc.sx),this.Dyc=null)}TEj(H,ha){const Ya={};Ya.a=this.$.ta.UserSessionId;Ya.b=H;Ya.c=ha;Bd.logData(29,Ya)}initData(H){const ha=Ri.a.xha;for(const Ya of oi)ha(Ya.b7a,dd.a.oj(H)?wi.a.Pe|8192:wi.a.Pe,0,0)}static h5g(H){return{returnValue:1===H.length&&H[0].isSingle,Qoc:null}}};aj=ni=Object(Ac.__decorate)([Object(Sb.d)(kc.StatusBarAggregateManagerService),Object(Ac.__param)(0,Object(kc.EwaControlService)()),Object(Ac.__param)(1,Object(Ae.g)())],aj);Object(ia.a)(aj,"StatusBarAggregateManager",
null,[555,4,360,217,29]);var jj=a(365),Gi=a(969),sj=a(226);class oh{constructor(){this.Nvh=[];this.Ovh=[]}get T6a(){return this.Nvh}get $1g(){return this.Ovh}get Ot(){return this.e4k}SBh(H,ha){this.T6a.push(H);this.$1g.push(ha)}TBh(H,ha){this.e4k={W5d:H,K4d:ha}}}Object(ia.a)(oh,"ThemeInfoCache",null,[]);var Yh=a(40);let xi=class{constructor(H){this.T6a=this.aW=null;this.rGc=!1;this.Rwe=null;this.QLc=new Set;this.Kvb=this.Bdd=!1;this.zNb=0;this.y_j=ha=>{this.rGc=!1;if(!ha||xd.a(ha))Z.ULS.sendTraceTag(556656004,
0,15,`ThemesManager: The obtained result has errors, [Error: ${ha?eb.a.pc(ha.Errors):"(no result)"}]`),this.eLg();else if(this.zNb=0,ha=ha.Result){null!==this.aW&&this.l1h(ha);this.aW=new oh;this.T6a=ha.ThemeColors;this.Rwe=[];for(var Ya=0;10>Ya;Ya++)this.Rwe.push(Gi.a.EGa(sj.a.gI(this.T6a[Ya])));for(Ya=0;6>Ya;Ya++)for(let Wb=0;10>Wb;Wb++){const Sc=Je.a.Rea(Je.a.WZ(this.T6a[10*Ya+Wb])),zd=Gi.a.tVi(Ya,Wb,this.Rwe[Wb],this.T6a[Wb]);this.aW.SBh(Sc,zd)}this.aW.TBh(ha.MinorFont,ha.MajorFont);this.Kvb=
!1;dd.a.Hf()&&(pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8768685_FixCommonUiStringsCrash")&&!jj.a.Bcb&&jj.a.SSb(),jj.a.KDj([ha.MajorFont,ha.MinorFont]));pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NewDefaultTemplate",!1)&&pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NewOfficeDefaultThemeSurvey",!1)&&"Aptos Narrow"===ha.MinorFont&&(ha=Yh.a.instance.Dja(),27E4>ha?window.setTimeout(()=>{this.$.Dc(-569754003,-1,0,null)},27E4-ha):this.$.Dc(-569754003,-1,0,null));this.Bdd=
!1;this.oma()}else Z.ULS.sendTraceTag(556656003,0,10,"ThemesManager: The obtained ThemeInfo is null")};this.x_j=()=>{this.rGc=!1;this.eLg()};this.eLg=()=>{3>this.zNb?(this.zNb++,Z.ULS.sendTraceTag(509669709,0,50,`ThemesManager::retryFetchThemeInfo - Retry fetchThemeInfo API count = ${this.zNb}`),this.CFa(null,!0)):(this.zNb=0,Z.ULS.sendTraceTag(509669708,0,15,"ThemesManager::retryFetchThemeInfo - Maximum retry count for fetchThemeInfo API has reached."))};this.R_b=()=>{this.aW&&(Z.ULS.sendTraceTag(537150473,
0,50,"ThemesManager: OnReloadCache"),this.Kvb=!0,this.CFa(null,!0))};this.yd=(ha,Ya)=>{this.aW&&(Z.ULS.sendTraceTag(537150472,0,50,"ThemesManager: OnSessionIdChanged"),Ya.nI&&(this.Bdd=!0))};this.de=(ha,Ya)=>{Ya.Hg&&lf.HelperMethods.VYc(this.$)&&this.CFa(null,!0)};this.FI=()=>{this.QLc.clear()};this.$=H;this.$.fa.LJ(this.R_b);this.$.fa.Vk(this.yd);this.$.Ia.GFb(this.FI);this.$.Ul(this.de)}dispose(){var H,ha,Ya,Wb,Sc,zd,be;null===(ha=null===(H=this.$)||void 0===H?void 0:H.fa)||void 0===ha?void 0:ha.zL(this.R_b);
null===(Wb=null===(Ya=this.$)||void 0===Ya?void 0:Ya.fa)||void 0===Wb?void 0:Wb.Qk(this.yd);null===(zd=null===(Sc=this.$)||void 0===Sc?void 0:Sc.Ia)||void 0===zd?void 0:zd.x3b(this.FI);null===(be=this.$)||void 0===be?void 0:be.tm(this.de)}get Lvb(){return!this.aW||this.Kvb?null:this.aW.T6a}get Z1g(){return!this.aW||this.Kvb?null:this.aW.$1g}get Ot(){return!this.aW||this.Kvb?null:this.aW.Ot}get J5f(){return this.Bdd}CFa(H,ha){if(this.$.isEditMode||(void 0===ha?0:ha)||this.$.$b.allowTypingAndFormulaEntry)if(!this.aW||
this.J5f||this.Kvb)if(H&&""!==H&&this.QLc.add(H),!this.rGc){this.rGc=!0;H=this.$.ma.sa;ha=this.y_j;var Ya=this.x_j;const Wb=H.$a(1,null);se.h(H,"GetThemeInfo",Wb,ha,Ya,null,null,4)}}getThemeColor(H){let ha,Ya=-1;ha=-1;if(!this.Lvb)return Z.ULS.sendTraceTag(537150475,0,10,"ThemesManager: ThemeColorsList is null"),{returnValue:!1,themeIndex:-1,kNa:ha};for(let Wb=0;Wb<this.Lvb.length;Wb++)if(H===this.Lvb[Wb]){Ya=Wb;break}if(-1!==Ya)return ha=Math.floor(Ya/10),{returnValue:!0,themeIndex:Ya%10,kNa:ha};
Z.ULS.sendTraceTag(537150474,0,10,"ThemesManager: Couldn't find theme color in cache.");return{returnValue:!1,themeIndex:-1,kNa:ha}}oma(){for(const H of this.QLc)this.$.frame.Kv(H);this.QLc.clear()}l1h(H){const ha=this.aW.Ot.K4d;this.aW.Ot.W5d===H.MinorFont&&ha===H.MajorFont||Z.ULS.sendTraceTag(512230155,0,50,"ThemesManager.compareThemeInfoCache: Theme Fonts are updated")}};xi=Object(Ac.__decorate)([Object(Sb.d)(kc.ThemesManagerService),Object(Ac.__param)(0,Object(kc.EwaControlService)())],xi);Object(ia.a)(xi,
"ThemesManager",null,[554,4]);var Zh=a(731);const bj=Object(kd.c)(Zh.a);var tj=a(971);class $h{static kLi(H){try{return caches.open($h.nIe).then(ha=>ha.match(H))}catch(ha){return Promise.reject(null)}}static jGa(H,ha){try{return $h.kLi(H).then(Ya=>Ya&&Number.parseInvariant(Ya.headers.get("cachedTime"))>Date.now()-ha?Promise.resolve(Ya.text().toLocaleString()):Promise.reject("Not found")).catch(()=>Promise.reject("Cache returned undefined"))}catch(Ya){return Promise.reject(null)}}static store(H,ha){try{return caches.open($h.nIe).then(Ya=>
{Ya.put(H,ha).then(()=>!0);return!1}).catch(()=>Promise.resolve(!1))}catch(Ya){return Promise.resolve(!0)}}static T0k(H,ha){const Ya={};Ya.body=ha;const Wb={};Wb.cachedTime=Date.now().toString();Ya.headers=Wb;ha=new Response(ha,Ya);$h.store(H,ha).then(()=>!0)}}$h.nIe="ConsentState";Object(ia.a)($h,"CacheManager",null,[]);class Fj{constructor(){this.message=null;this.httpStatusCode=0}}Object(ia.a)(Fj,"HttpRequstToPromiseRejectData",null,[]);class cj{constructor(H){this.P5=H}V2(H,ha,Ya,Wb,Sc,zd){Jh.a.sendTelemetryEvent({name:"Office.Online."+
H,dataFields:[{name:"EventMessage",string:ha},{name:"FormFactor",string:this.P5.formFactor},{name:"CorrelationId",string:this.P5.correlationId},{name:"AccountType",string:this.P5.accountType},{name:"OSVersion",string:this.P5.osVersion},{name:"AppId",string:this.P5.appId},{name:"ConsentSurface",string:"AppStart"},{name:"ConsentLanguage",string:this.P5.consentLanguage},{name:"EventCode",string:Ya},{name:"Region",string:this.P5.region},{name:"ModelType",string:Wb},{name:"ModelId",string:Sc},{name:"Platform",
string:this.P5.os},{name:"ReConsentReason",string:""},{name:"ConsentType",string:zd}]})}}Object(ia.a)(cj,"TelemetryLogger",null,[]);var Mh=a(239);class yj{constructor(H,ha,Ya){this.Pkh="https://consent.config.office.com/consentcheckin/v1.0/consents";this.ya=H;this.sg=ha;this.uCa=Ya;this.KW=new cj(Ya)}Cia(H,ha){return new Promise((Ya,Wb)=>{const Sc=this.ya.Rd("UCNoticeCheckinCallTimeoutMs",5E3);let zd=this.ya.Qa("UCNoticeCheckinStateUrl");zd&&zd.length||(zd=this.Pkh);this.sg.f0(zd,1,null,this.lXa(H),
null,!1,0,be=>{try{if(void 0===be||null===be||void 0===be.data||null===be.data||void 0===be.data.responseData||null===be.data.responseData){this.KW.V2("UnifiedConsent.ConsentGetFailed","CheckInApi : Invalid response","711",null,null,null);const Ke=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}","UnifiedConsent.ConsentGetFailed");Wb(this.Hz(Ke,be))}else if(be.data.httpStatus!==Mh.a.nA){this.KW.V2("UnifiedConsent.ConsentGetFailed",
"CheckInApi : HTTP failure",be.data.httpStatus.toString(),null,null,null);const Ke=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",be.data.httpStatus,"UnifiedConsent.ConsentGetFailed");Wb(this.Hz(Ke,be))}else{var oe=ha(be.data.responseData);if(oe)Ya(oe);else{this.KW.V2("UnifiedConsent.ConsentGetFailed","CheckInApi : Consent values are empty","712",null,null,null);const Ke=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",
"UnifiedConsent.ConsentGetFailed");Wb(this.Hz(Ke,be))}}}catch(Ke){this.KW.V2("UnifiedConsent.ConsentGetFailed","CheckInApi : Unexpected failure","713",null,null,null),oe=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",Ke,"UnifiedConsent.ConsentGetFailed"),Wb(this.Hz(oe,be))}},be=>{this.KW.V2("UnifiedConsent.ConsentGetFailed","CheckInApi : Error in service call ",be.data.httpStatus.toString(),null,null,null);const oe=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, request - {1}",
be.data.httpStatus,"UnifiedConsent.ConsentGetFailed");Wb(this.Hz(oe,be))},null,void 0,void 0,2500,Sc)})}Hz(H,ha){const Ya=new Fj;Ya.message=H;Ya.httpStatusCode=ha&&ha.data?ha.data.httpStatus:-1;return Ya}lXa(H){const ha={};ha["Accept-Language"]=this.uCa.consentLanguage;ha.consentsurface="AppStart";ha.platform="Web";ha.formfactor=Uf.a.AY?"Mobile":"Desktop";ha["x-Cid"]=this.uCa.correlationId;ha.Authorization="Bearer "+H;return ha}}Object(ia.a)(yj,"HttpRequestToPromiseUtility",null,[]);var cg=a(104);
class mf{constructor(){this.accountType="MSA";this.modelType=null;this.appEnv=0;this.emailId=this.deviceId=this.consentLanguage=this.appVersion=this.appId=this.appName=null;this.formFactor="Unknown";this.token=this.region=this.osVersion=this.os=null;this.useCache=!1;this.correlationId=this.userId=null;this.isDarkMode=!1}}Object(ia.a)(mf,"WebSdkAdapterProps",null,[]);class Vg{constructor(H,ha,Ya,Wb){this.JNe=this.loa=this.haa=this.I5=null;this.B$j=Sc=>{if(void 0===Sc||null===Sc)return this.KW.V2(Vg.cQa,
"Checkin response undefined or null","705",this.I5,this.haa,this.loa),null;try{const {Ws:zd}=Pd.d(Sc);return zd}catch(zd){this.KW.V2(Vg.cQa,"Checkin response parse error : "+zd.message,"706",this.I5,this.haa,this.loa)}return null};this.E8a=Wb;this.ya=H;this.qjh=Ya;this.sg=ha;this.uCa=this.getDimensions();this.KW=new cj(this.uCa)}gWg(){"MSA"===(this.ya.Qa("HostAuthType")||"").toUpperCase()&&$h.jGa(this.uCa.userId,this.ya.Rd("UCNoticeCheckinCacheTimeMs",862E5)).then(()=>{this.KW.V2(Vg.cQa,"CacheFound",
"701",this.I5,this.haa,this.loa);return{}}).catch(()=>{this.qjh.execute(H=>{H.ey("Consent",Vg.rvh).then(ha=>{ha.IsSuccess?(this.KW.V2(Vg.cQa,"CheckInTokenSuccess","702",this.I5,this.haa,this.loa),this.bNi(ha.Token).then(Ya=>{this.rVi(Ya);this.I5&&""!==this.I5&&H.ey("Consent",Vg.tvh).then(Wb=>{Wb.IsSuccess?(this.KW.V2(Vg.cQa,"WebTokenSuccess","703",this.I5,this.haa,this.loa),this.jWk(Wb,this.I5)):this.KW.V2(Vg.cQa,"WebTokenFailed : "+Wb.ErrorMessage,Wb.ErrorCode,this.I5,this.haa,this.loa);return{}});
return{}})):this.KW.V2(Vg.cQa,"CheckInTokenFailed : "+ha.ErrorMessage,ha.ErrorCode,this.I5,this.haa,this.loa);return{}})})})}bNi(H){this.JNe=new yj(this.ya,this.sg,this.uCa);return this.JNe.Cia(H,this.B$j).then(ha=>Promise.resolve(ha),ha=>Promise.reject("Error while getting result"+ha))}rVi(H){for(const ha of H.consentValues)if(ha.needConsent&&!ha.maxPromptsReached){this.haa=ha.id;this.loa=ha.consentType;this.I5=ha.modelType;return}$h.T0k(this.uCa.userId,Pd.c(H))}jWk(H,ha){if(cg.a("showConsentNotice")){const Ya=
document.createElement("div");document.body.appendChild(Ya);appChrome.api.showConsentNotice(this.ZOi(H.Token,ha),Ya)}else this.KW.V2(Vg.cqh,"1JS : ShowConsentNotice API not found","704",this.I5,this.haa,this.loa)}ZOi(H,ha){const Ya=this.uCa;Ya.token=H;Ya.modelType=ha;return Ya}getDimensions(){const H=this.QDc(this.ya.Qa("SessionStartInfoJson"));return Object.assign(new mf,{emailId:this.ya.Qa("UserPrincipalName"),userId:this.ya.Qa("LoggableUserId"),accountType:"AAD"===(this.ya.Qa("HostAuthType")||
"").toUpperCase()?"AAD":"MSA",appId:this.ya.Qa("OfficeApplicationId"),appVersion:this.ya.Qa("appVersion"),appName:"Application"in H?H.Application:"",appEnv:this.E8a,consentLanguage:this.ya.Qa("UICulture")||"en-US",formFactor:Uf.a.AY?"Mobile":"Desktop",os:"Os"in H?H.Os:"",osVersion:"OsVersion"in H?H.OsVersion:"",region:this.ya.Qa("region"),correlationId:Ub.a.create().toString(),isDarkMode:this.ya.ka("DarkModeIsOn"),useCache:!0})}QDc(H){let ha={};try{ha=Pd.b(H)}catch(Ya){}return ha}}Vg.tvh="https://consentservice.microsoft.com/web";
Vg.rvh="https://consentservice.microsoft.com/checkin";Vg.cqh="UnifiedConsent.ConsentGetFailed";Vg.cQa="UnifiedConsent.AuthTokenStatus";Object(ia.a)(Vg,"ConsentNoticeManager",null,[617]);class Hh{constructor(){this.oc=null}get name(){return"Common.App.ConsentNoticeDialog"}ji(H){this.oc=H;H.register(Vg,"Common.App.ConsentNoticeDialog.ConsentNoticeManager").as("Common.App.ConsentNoticeDialog.IConsentNoticeManager").Lc().Qc(()=>new Vg(ta.AFrameworkApplication.ea,ta.AFrameworkApplication.od,Object(kd.d)(tj.b),
ta.AFrameworkApplication.environment))}init(){Object(kd.a)(bj)}dispose(){}static main(){Pe.a.instance.Qi(new Hh)}}Object(ia.a)(Hh,"ConsentNoticeDialogPackage",null,[11,12]);let Nh=class{constructor(){Type.registerNamespace("Common.App.ConsentNoticeDialog");Hh.main();Object(kd.d)(Zh.a).execute(H=>H.gWg())}};Nh=Object(Ac.__decorate)([Object(Sb.d)(kc.UnifiedConsentNoticeService)],Nh);Object(ia.a)(Nh,"UnifiedConsentAdapter",null,[]);class Yi{constructor(H,ha){this.viewportScenarioContext=H;this.ona=ha}dispose(){var H;
null===(H=this.ona)||void 0===H?void 0:H.hza("dispose")}Dla(H){var ha;null===(ha=this.ona)||void 0===ha?void 0:ha.hza("navigationStart",H)}kR(){var H;null===(H=this.ona)||void 0===H?void 0:H.hza("scrollEnd")}Zig(H){var ha;null===(ha=this.ona)||void 0===ha?void 0:ha.hza("activeItemChanged",H)}Hug(){var H;null===(H=this.ona)||void 0===H?void 0:H.hza("viewportReachedRequiredStateId")}}Object(ia.a)(Yi,"ViewportObservedScenario",null,[]);var pi=a(710);const rf={navigationStart:"navigationStarted",scrollEnd:"unexpected",
viewportReachedRequiredStateId:"unexpected",activeItemChanged:"unexpected",zoomOrSizeChange:"idle",dispose:"disposed"},kj={idle:rf,navigationStarted:{navigationStart:"abortNavigationAndStartNew",scrollEnd:"scrollEnded",viewportReachedRequiredStateId:"navigationStarted",activeItemChanged:"abortNavigationAndStartActiveItemChange",zoomOrSizeChange:"navigationStarted",dispose:"disposed"},scrollEnded:{navigationStart:"abortNavigationAndStartNew",scrollEnd:"unexpected",viewportReachedRequiredStateId:"navigationEnd",
activeItemChanged:"abortNavigationAndStartActiveItemChange",zoomOrSizeChange:"scrollEnded",dispose:"disposed"},navigationEnd:rf,abortNavigationAndStartNew:rf,abortNavigationAndStartActiveItemChange:rf,unexpected:rf,disposed:{navigationStart:"disposed",scrollEnd:"disposed",viewportReachedRequiredStateId:"disposed",activeItemChanged:"disposed",zoomOrSizeChange:"disposed",dispose:"disposed"}},Hi={navigationStart:"unexpected",scrollEnd:"unexpected",viewportReachedRequiredStateId:"unexpected",activeItemChanged:"activeItemChangeStarted",
zoomOrSizeChange:"idle",dispose:"disposed"},lj={idle:Hi,activeItemChangeStarted:{navigationStart:"duringActiveItemChange",scrollEnd:"unexpected",viewportReachedRequiredStateId:"navigationEnd",activeItemChanged:"abortNavigationAndStartActiveItemChange",zoomOrSizeChange:"activeItemChangeStarted",dispose:"disposed"},duringActiveItemChange:{navigationStart:"abortNavigationAndStartNew",scrollEnd:"duringActiveItemChange",viewportReachedRequiredStateId:"navigationEnd",activeItemChanged:"abortNavigationAndStartActiveItemChange",
zoomOrSizeChange:"duringActiveItemChange",dispose:"disposed"},navigationEnd:Hi,abortNavigationAndStartNew:Hi,abortNavigationAndStartActiveItemChange:Hi,unexpected:Hi,disposed:{navigationStart:"disposed",scrollEnd:"disposed",viewportReachedRequiredStateId:"disposed",activeItemChanged:"disposed",zoomOrSizeChange:"disposed",dispose:"disposed"}},Ii=new Yi({name:"ViewportObserverState.idle"});class Gj{constructor(H){var {Dla:ha,M_b:Ya,r$d:Wb}=H;this.zmi=()=>{const Sc=this.lw.viewportScenarioContext;this.lw.dispose();
this.lw=Ii;this.M_b(Sc)};this.gxh=Sc=>{this.J0e(Sc);this.lw=new Yi(Sc,new pi.a("idle",kj,this.cM));this.lw.Dla(Sc)};this.fxh=Sc=>{this.J0e(Sc);this.lw=new Yi(Sc,new pi.a("idle",lj,this.cM));this.lw.Zig(Sc)};this.J0e=Sc=>{this.r$d(Sc);this.lw.dispose()};this.lw=Ii;this.Dla=ha;this.M_b=Ya;this.r$d=Wb;this.cM={abortNavigationAndStartNew:this.gxh,abortNavigationAndStartActiveItemChange:this.fxh,navigationEnd:this.zmi}}dispose(){this.lw.dispose();this.lw=Ii}get lw(){return this.nlh}set lw(H){H!==Ii&&this.Dla(H.viewportScenarioContext);
this.nlh=H}get wlb(){return this.lw===Ii}asg(H){this.wlb&&(this.lw=new Yi(H,new pi.a("idle",kj,this.cM)));this.lw.Dla(H)}onActiveItemChanging(H){this.wlb&&(this.lw=new Yi(H,new pi.a("idle",lj,this.cM)));this.lw.Zig(H)}mPc(H){this.lw.kR();this.s6f(H)&&this.lw.Hug();return this.lw.viewportScenarioContext}e3(H){this.s6f(H)&&this.lw.Hug()}s6f(H){return void 0!==this.lw.viewportScenarioContext.$Uc&&H>=this.lw.viewportScenarioContext.$Uc}}Object(ia.a)(Gj,"ViewportObserverState",null,[]);class Yg{constructor(H){this.da=
H}Etj(H){if(!H)return!0;H.kX();return this.nvj(H)?this.da.q8(H,!1):!0}nvj(H){if(!pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationFailHandlerService",!1))return!this.da.rb.GHc(H);const ha=this.da.rb.GHc(H);H=null==this.iLj().Xe(H);return!ha&&!H}iLj(){let H;if(pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8971503_ScopeNavigationValidationToMasterPane_V2")){var ha=this.da.rb.Mzc(1,this.da.hd);H=ha.top;ha=ha.left}else H=this.da.hd.gQ(!0),ha=this.da.hd.gQ(!1);const Ya=this.da.hd.Uka(!0),
Wb=this.da.hd.Uka(!1);return new Te.Range(H,ha,Ya,Wb,!0,!0)}}Object(ia.a)(Yg,"NavigationResultValidator",null,[]);let yi=class{constructor(H){this.da=H;this.$s=M();this.Rpg=(ha,Ya)=>{this.oxb.asg(this.Nnd(Ya))};this.Wqg=(ha,Ya)=>{this.oxb.asg(this.Nnd(Ya))};this.Q1a=()=>{};this.onActiveItemChanging=(ha,Ya)=>{ha=Object(Pf.a)(Ya.scenario);this.oxb.onActiveItemChanging(this.Nnd(ha))};this.qk=()=>{};this.mPc=()=>{const ha=this.oxb.mPc(this.da.Mza);this.$s.dispatchEvent("ScrollEnd",{viewportScenarioContext:ha})};
this.e3=(ha,Ya)=>{Ya.SHa&&this.oxb.e3(Ya.Mza)};this.M_b=ha=>{Object(Pf.d)(ha)||Object(Pf.f)(ha)||this.fPj.Etj(ha.targetRange)||this.Uik(ha);this.OBg(ha,"complete")};this.Vik=ha=>{this.$s.dispatchEvent("NavigationStart",{viewportScenarioContext:ha})};this.Tik=ha=>{this.OBg(ha,"aborted")};Z.ULS.sendTraceTag(507606538,0,50,"ViewportObserver.ctor");this.fPj=new Yg(H);this.oxb=new Gj({Dla:this.Vik,M_b:this.M_b,r$d:this.Tik});H.hod(this.Q1a);H.$.DD(this.qk);H.$.zn.VS(this.onActiveItemChanging);H.sod(this.e3);
H.view.XEh(this.Rpg);H.view.IFh(this.Wqg);H.view.W4e(this.mPc)}Q2e(H,ha){this.$s.addEventListener("NavigationStart",H,{signal:ha})}P2e(H,ha){this.$s.addEventListener("NavigationFail",H,{signal:ha})}nBh(H,ha){this.$s.addEventListener("ScrollEnd",H,{signal:ha,once:!0})}O2e(H,ha,Ya){this.$s.addEventListener("NavigationEnd",H,{signal:ha,once:Ya})}dispose(){this.da.uie(this.Q1a);this.da.$.vG(this.qk);this.da.$.zn.xh(this.onActiveItemChanging);this.da.Eie(this.e3);this.da.view.Otk(this.Rpg);this.da.view.puk(this.Wqg);
this.da.view.FHg(this.mPc);this.oxb.dispose()}Uik(H){this.$s.dispatchEvent("NavigationFail",{viewportScenarioContext:H})}OBg(H,ha){this.$s.dispatchEvent("NavigationEnd",{viewportScenarioContext:H,navigationEndReason:ha})}Nnd(H){return void 0!==H.$Uc?H:Object.assign({},H,{$Uc:this.da.$.fa.Je})}};yi=Object(Ac.__decorate)([Object(Sb.d)(kc.ViewportObserverService),Object(Ac.__param)(0,Object(kc.GridViewService)())],yi);Object(ia.a)(yi,"ViewportObserver",null,[]);var mj=a(768);class Hj{constructor(){this.defaultRate=
this.defaultCount=this.total=0;this.defaultCountByReason={"ActivateItem-with-SheetCtor":0,"ActivateItem-with-BootFromCache":0,"ActivateItem-with-OpenWorkbook":0,"ActivateItem-with-HttpError":0,"ActivateItem-with-InternalServerError":0,"ActivateItem-with-OnLoadOnDemandOccurred":0,"ActivateItem-with-PartialResult":0,NewSheet:0,NullActiveItem:0,NotReceivedFromOpenWorkbook:0,PartialResult:0};this.prefetchInfo={success:!1,entriesCount:0,abortReason:void 0,maxEntries:void 0}}get reportName(){return"SPD"}}
Object(ia.a)(Hj,"SheetProcessedDataSessionEndsReport",null,[582]);class Ji{constructor(){this.maxUsedRow=this.maxUsedColumn=0;this.isRowMaxPixelExceeded=!1}get reportName(){return"Viewport"}}Object(ia.a)(Ji,"ViewportSessionEndsReport",null,[582]);class zj{constructor(){this.hitCount=this.total=0;this.missCountByReason={};this.firstScrollSheetMissCount=this.sheetOnBootMissCount=0}}Object(ia.a)(zj,"BlockCacheAccessesTelemetry",null,[]);class Oh{constructor(){this.sessionBoot=new zj;this.postSessionBoot=
new zj;this.duringScroll=new zj;this.blockCacheSize=this.numOfUsedPrefetchedBlocks=this.numOfPrefetchedBlocks=this.accessedBlocksDistinctCount=0}get reportName(){return"BlockCacheAccess"}}Object(ia.a)(Oh,"BlockCacheAccessSessionEndsReport",null,[582]);class nj{constructor(){this.distinctCount=this.count=0;this.skeletonBlocksCounter={}}get reportName(){return"SkeletonCounter"}}Object(ia.a)(nj,"SkeletonCounterSessionEndsReport",null,[582]);var Ki=a(173),qi=a(495);class P extends kb.a{constructor(){super();
this.x1b=[];this.SRj()}dispose(){var H;null===(H=this.Rwg)||void 0===H?void 0:H.disconnect();super.dispose()}TEh(H){this.addHandler(P.X5d,H)}Ktk(H){this.removeHandler(P.X5d,H)}Hel(H){this.x1b.push({PPc:H,timestamp:performance.now()})}SRj(){var H;if(null===(H=PerformanceObserver.supportedEntryTypes)||void 0===H?0:H.includes("long-animation-frame"))try{this.Rwg=new PerformanceObserver(ha=>{for(const Ya of ha.getEntries())this.Tfi(Ya)}),this.Rwg.observe({type:"long-animation-frame"})}catch(ha){Z.ULS.sendTraceTag(507799641,
345,10,`observeLongAnimationFrame: observe({ type: "long-animation-frame" }) failed with: ${ha}`)}}Tfi(H){const ha=[],Ya=H.startTime;H=Ya+H.duration;let Wb=0;for(let Sc=0;Sc<this.x1b.length;++Sc){const zd=this.x1b[Sc],be=zd.timestamp;if(be>=Ya&&be<=H){ha.push({UHj:Ya,THj:H,PPc:zd.PPc});Wb=Sc+1;break}if(be>Ya){Wb=Sc;break}}this.x1b=this.x1b.slice(Wb);0<ha.length&&this.raiseEvent(P.X5d,{nMj:ha})}}P.X5d="mbdek";Object(ia.a)(P,"ScrollMissingBlocksDetector",kb.a,[4]);var ua=a(690);class Xa{constructor(H,
ha,Ya,Wb,Sc,zd,be,oe){this.Km=zd;this.context=be;this.kS=oe;this.Xd=!1;this.Wna=new AbortController;this.$4d=()=>{this.mark("scroll-end")};this.s$d=Ke=>{Ke=Ke.detail.navigationEndReason;this.d_a&&this.Yy(Ke)};this.da=H;this.scenario=Wb;this.tTd=ha;this.NR=Sc;this.S1j=Ya;this.mark("start",void 0,null===be||void 0===be?void 0:be.timestamp);this.e3=this.kS?(Ke,Xe)=>{Xe.SHa&&(Ke=Xe.Mza,-1===Ke?this.mark("skeleton-blocks",void 0,Xe.timestamp):this.KSa(Ke)||this.mark("stale-blocks",new ua.a(Ke),Xe.timestamp))}:
(Ke,Xe)=>{Xe.SHa&&(Ke=Xe.Mza,this.KSa(Ke)?this.yYb(Xe.timestamp):-1===Ke?this.mark("skeleton-blocks",void 0,Xe.timestamp):0<=Ke&&this.mark("stale-blocks",new ua.a(Ke),Xe.timestamp))};this.da.sod(this.e3)}get scenario(){return this.HS}set scenario(H){this.HS=H}get jWc(){return Object(qi.j)(this.scenario)}set jWc(H){const ha=Object(qi.i)(this.scenario);if(""===H)this.scenario=ha;else if(Object(qi.b)(ha))this.scenario={scenario:ha,caller:H};else throw Error(`Adding secondary scenario to ${ha} is not supported since it is not defined as E2E scenario`);
}get d_a(){return!this.Xd}get T2d(){return 50}dispose(){this.Xd=!0;this.kS||this.da.Eie(this.e3)}gPj(H){var ha,Ya;Object(Pf.c)(H)&&H.caller&&(this.jWc=H.caller);null===(ha=this.kS)||void 0===ha?void 0:ha.nBh(this.$4d,this.Wna.signal);null===(Ya=this.kS)||void 0===Ya?void 0:Ya.O2e(this.s$d,this.Wna.signal,!0)}KSa(H){return pd.EwaSettings.IY()?H>=this.tTd&&0<=H:H>=this.tTd}Yy(H,ha,Ya){var Wb;this.mark("end",void 0,Ya);this.log(H,ha);pd.EwaSettings.IY()?(this.kS&&this.w3c(H),this.dispose()):this.w3c(H);
null===(Wb=this.S1j)||void 0===Wb?void 0:Wb.call(this);this.Km.M3c&&!this.Km.CXd&&(H=this.Km.markers,ha=H[H.length-1],Z.ULS.shipAssertTag(507557020,0,!!ha,"NavigationOperationLatencyTelemetry.scenarioEnd: endMark is undefined!"),this.Km.measure({from:H[0],TL:ha,c1a:Object(qi.i)(this.scenario)}))}mark(H,ha,Ya){(H=this.Km.mark(H,this.scenario,ha,Ya))&&this.F_b(H,ha)}F_b(H){this.Km.M3c&&performance.mark(H.name,{startTime:H.timestamp})}log(H,ha){H=JSON.stringify(this.Eta(H,ha));this.kS?Z.ULS.sendTraceTag(507570122,
0,50,`NavigationOperationLatencyTelemetry.log: ${H}`):Z.ULS.sendTraceTag(356298771,0,this.T2d,`NavigationOperationLatencyTelemetry.log: ${H}`)}Eta(H,ha){return{scenario:this.scenario,endReason:H,endDetails:ha,initialStateId:this.tTd,duration:this.Km.duration.toFixed(4),skeletonDuration:this.Km.skeletonDuration.toFixed(4),staleDuration:this.Km.staleDuration.toFixed(4),isMarkersMaxLengthReached:this.Km.CXd}}yYb(H){this.Yy("complete",void 0,H)}}Object(ia.a)(Xa,"NavigationOperationLatencyTelemetry",null,
[627]);class Pb{constructor(H,ha,Ya){this.name=H;this.timestamp=ha;this.context=Ya}toJSON(){return{n:this.name,t:this.timestamp.toFixed(4),c:this.context}}}Object(ia.a)(Pb,"NavigationMark",null,[]);class hc{constructor(H){this.markers=[];this.M3c=!(void 0===H?0:H)&&!!performance.measure}get CXd(){return this.markers.length>=hc.cKj}get duration(){return this.endTime-this.startTime}get skeletonDuration(){return this.markers.reduce((H,ha,Ya)=>{Ya=this.markers[Ya-1];return"skeleton-blocks"===(null===
Ya||void 0===Ya?void 0:Ya.name)?H+(ha.timestamp-Ya.timestamp):H},0)}get staleDuration(){return this.markers.reduce((H,ha,Ya)=>{Ya=this.markers[Ya-1];return"stale-blocks"===(null===Ya||void 0===Ya?void 0:Ya.name)?H+(ha.timestamp-Ya.timestamp):H},0)}get startTime(){return this.markers[0].timestamp}get endTime(){return this.markers[this.markers.length-1].timestamp}mark(H,ha,Ya,Wb){if(!this.CXd)return this.jk(H,Ya,Wb)}kYa(H){return void 0!==this.qxc(H)}measure(H){var {from:ha,TL:Ya,c1a:Wb}=H,Sc;H=Object(qi.f)(ha)?
this.qxc(ha):ha;const zd=Object(qi.f)(Ya)?this.qxc(Ya):Ya;if(H&&zd){var be=null!==Wb&&void 0!==Wb?Wb:`${H.name}->${zd.name}`;if(this.M3c)try{var oe=null===(Sc=performance.measure(be,H.name,zd.name))||void 0===Sc?void 0:Sc.duration;void 0===oe&&Z.ULS.sendTraceTag(507536290,0,15,"NavigationLatencyTracker.measure: performance.measure returned undefined!")}catch(Ke){Z.ULS.sendTraceTag(507367692,0,15,`NavigationLatencyTracker.measure: performance.measure threw an error,! msg=${null===Ke||void 0===Ke?void 0:
Ke.message}, fromMark=${H.name}, toMark=${zd.name}, measurementName=${be}`)}return null!==oe&&void 0!==oe?oe:zd.timestamp-H.timestamp}}qxc(H){for(let ha=this.markers.length-1;0<=ha;ha--)if(this.markers[ha].name===H)return this.markers[ha]}jk(H,ha,Ya){H=this.markers.push(new Pb(H,null!==Ya&&void 0!==Ya?Ya:performance.now(),ha));return this.markers[H-1]}}hc.cKj=50;Object(ia.a)(hc,"NavigationLatencyTracker",null,[]);class Qc extends hc{constructor(){super(...arguments);this.yIa=!1;this.Pna=[];this.Ujd=
this.tfd=this.Vjd=0}get skeletonDuration(){return this.Vjd}get missingBlocksDuration(){return this.tfd}get skeletonAndMissingBlocksDuration(){return this.Ujd}rbi(){let H=!1,ha=void 0;for(let Ya=0;Ya<this.markers.length;Ya++){const Wb=this.markers[Ya];switch(Wb.name){case "missing-blocks-start":H?(this.Pna.push(new Pb("skeleton-and-missing-blocks-start",Wb.timestamp)),H=!1):this.Pna.push(Wb);break;case "missing-blocks-end":"missing-blocks-start"===(null===ha||void 0===ha?void 0:ha.name)&&this.Pna.push(Wb);
break;case "only-missing-blocks-end":"only-missing-blocks-start"===(null===ha||void 0===ha?void 0:ha.name)&&this.Pna.push(Wb);break;case "skeleton-blocks":H||(H=!0,this.Pna.push(Wb));break;default:Wb.name!==(null===ha||void 0===ha?void 0:ha.name)&&(H=!1,this.Pna.push(Wb))}"start"!==Wb.name&&"scroll-end"!==Wb.name&&(ha=Wb)}return this.Pna}cUh(){let H=this.Pna[0];for(let ha=1;ha<this.Pna.length;++ha){const Ya=this.Pna[ha];if("start"!==Ya.name&&"scroll-end"!==Ya.name){switch(H.name){case "missing-blocks-start":case "only-missing-blocks-start":this.tfd+=
Ya.timestamp-H.timestamp;break;case "skeleton-and-missing-blocks-start":this.Ujd+=Ya.timestamp-H.timestamp;break;case "skeleton-blocks":this.Vjd+=Ya.timestamp-H.timestamp}H=Ya}}}jk(H,ha,Ya){Ya=null!==Ya&&void 0!==Ya?Ya:performance.now();H=new Pb(H,Ya,ha);this.markers.splice(this.fTi(Ya),0,H);return H}fTi(H){for(let ha=this.markers.length-1;0<=ha;ha--)if(this.markers[ha].timestamp<=H)return ha+1;return 0}}Object(ia.a)(Qc,"ScrollLatencyTracker",hc,[]);class vd extends Xa{constructor(H,ha,Ya,Wb,Sc,zd){super(H,
ha,Ya,"scroll",Wb,new Qc(!!zd),Sc,zd);this.SYb=new P;this.HR={HWf:0,GWf:0,Zme:0,Nme:0,Qme:0,Vme:0};this.$4d=()=>{if(!this.yIa){this.mark("scroll-end");this.yIa=!0;var be=this.da.view,oe=be.t6.y-this.HR.HWf;0<oe?this.HR.Nme=oe:0>oe&&(this.HR.Zme=Math.abs(oe));be=be.t6.x-this.HR.GWf;0<be?this.HR.Vme=be:0>be&&(this.HR.Qme=Math.abs(be))}};this.Sqg=(be,oe)=>{for(const Ke of oe.nMj)be=Ke.PPc?"only-missing-blocks-end":"missing-blocks-end",this.mark(Ke.PPc?"only-missing-blocks-start":"missing-blocks-start",
void 0,Ke.UHj),this.mark(be,void 0,Ke.THj)};this.Rqg=(be,oe)=>{this.SYb.Hel(oe.T2f)};this.da.FFh(this.Rqg);this.SYb.TEh(this.Sqg);H=this.da.view;this.HR.HWf=H.t6.y;this.HR.GWf=H.t6.x}get yIa(){return this.Km.yIa}set yIa(H){this.Km.yIa=H}dispose(){this.rii();super.dispose()}yYb(H){this.yIa?this.Yy("complete",void 0,H):this.mark("content")}Eta(H,ha){const Ya=this.Km.rbi();this.Km.cUh();return Object.assign({},super.Eta(H,ha),{missingBlocksDuration:this.Km.missingBlocksDuration.toFixed(4),skeletonAndMissingBlocksDuration:this.Km.skeletonAndMissingBlocksDuration.toFixed(4),
userExperienceMarks:Ya})}rii(){var H,ha;this.da.muk(this.Rqg);null===(H=this.SYb)||void 0===H?void 0:H.Ktk(this.Sqg);null===(ha=this.SYb)||void 0===ha?void 0:ha.dispose();this.SYb=void 0}w3c(){const H=this.NR.ScrollLatency;H.duration+=this.Km.duration;H.skeletonDuration+=this.Km.skeletonDuration;H.skeletonAndMissingBlocksDuration+=this.Km.skeletonAndMissingBlocksDuration;H.missingBlocksDuration+=this.Km.missingBlocksDuration;this.HR.Zme>H.maxScrollDistance.maxScrollUpDistancePx&&(H.maxScrollDistance.maxScrollUpDistancePx=
this.HR.Zme);this.HR.Nme>H.maxScrollDistance.maxScrollDownDistancePx&&(H.maxScrollDistance.maxScrollDownDistancePx=this.HR.Nme);this.HR.Qme>H.maxScrollDistance.maxScrollLeftDistancePx&&(H.maxScrollDistance.maxScrollLeftDistancePx=this.HR.Qme);this.HR.Vme>H.maxScrollDistance.maxScrollRightDistancePx&&(H.maxScrollDistance.maxScrollRightDistancePx=this.HR.Vme)}}Object(ia.a)(vd,"ScrollOperationLatencyTelemetry",Xa,[]);class Nd{constructor(H){var {dra:ha,Rva:Ya,Yta:Wb}=H;this.dra=ha;this.Rva=Ya;this.Yta=
Wb}toJSON(){return{logic:this.dra.toFixed(4),endOfLogicToGoto:this.Rva.toFixed(4),"goto":this.Yta.toFixed(4)}}}Object(ia.a)(Nd,"GotoDurationInformation",null,[]);class ke extends hc{get bQf(){if(!this.kYa("end"))return Z.ULS.sendTraceTag(507574408,0,15,"GotoLatencyTracker.gotoOperationDuration: operation hasn't ended yet!"),new Nd({dra:0,Rva:0,Yta:0});if(this.kYa("web-method-error")){var H=this.measure({from:"start",TL:"web-method-error"}),ha=this.measure({from:"web-method-error",TL:"end"});return new Nd({dra:H,
Rva:0,Yta:ha})}if(this.kYa("business-logic-success")&&this.kYa("goto-start")){H=this.measure({from:"start",TL:"business-logic-success"});ha=this.measure({from:"business-logic-success",TL:"goto-start"});const Ya=this.measure({from:"goto-start",TL:"end"});return new Nd({dra:H,Rva:ha,Yta:Ya})}if(this.kYa("business-logic-success"))return H=this.measure({from:"start",TL:"business-logic-success"}),ha=this.measure({from:"business-logic-success",TL:"end"}),new Nd({dra:H,Rva:0,Yta:ha});if(this.kYa("goto-start"))return H=
this.measure({from:"start",TL:"goto-start"}),ha=this.measure({from:"goto-start",TL:"end"}),new Nd({dra:0,Rva:H,Yta:ha});H=this.measure({from:"start",TL:"end"});return new Nd({dra:0,Rva:0,Yta:H})}mSh(){return 0<=this.markers.findIndex(H=>Object(qi.a)(H.name))}}Object(ia.a)(ke,"GotoLatencyTracker",hc,[]);let Be=0;class Ze extends Xa{constructor(H,ha,Ya,Wb,Sc,zd,be){super(H,ha,Ya,Wb,Sc,new ke(!!be),zd,be);this.MWc=!1;this.wsg=()=>{this.KSa(this.da.Mza)&&this.yYb()}}get T2d(){return 20}dispose(){this.MWc&&
(this.da.ha.z9(this.wsg),this.MWc=!1);super.dispose()}mark(H,ha,Ya){Object(qi.a)(H)&&this.Km.mSh()?this.Yy("aborted","MultipleBusinessLogicMarks"):super.mark(H,ha,Ya)}F_b(H,ha){super.F_b(H,ha);"business-logic-success"===H.name&&(Z.ULS.shipAssertTag(507556764,0,!this.MWc,"SetFocusOnGotoOperationLatencyTelemetry.onMarkAdded: selectionEndedBlockingRegistered is true"),this.da.ha.Qaa(this.wsg),this.MWc=!0)}Eta(H,ha){return Object.assign({},super.Eta(H,ha),{gotoOperationDuration:this.Km.bQf,marks:this.Km.markers})}w3c(H){"complete"===
H&&pd.EwaSettings.IY()&&pd.EwaSettings.lzj()&&this.O5h()}O5h(){if(3E4<=Be)Z.ULS.sendTraceTag(507274262,0,50,"GotoOperationLatencyTelemetry.createAndUpdateGotoReport: data reached the limit");else if(Be++,pd.EwaSettings.IY()&&this.kS){var H=Object(qi.i)(this.scenario),ha=this.Uej(H,this.jWc);-1===ha&&(ha=this.rAh(H,this.jWc));this.sAh(ha)}}Uej(H,ha){for(let Ya=0;Ya<this.NR.gotoScenarioLatency.Names.length;Ya++)if(this.NR.gotoScenarioLatency.Names[Ya]===H&&this.NR.gotoScenarioLatency.SecondaryScenarios[Ya]===
ha)return Ya;return-1}sAh(H){this.NR.gotoScenarioLatency.Durations[H].push(Math.round(this.Km.duration));const ha=this.Km.bQf;this.NR.gotoScenarioLatency.BusinessLogicDuration[H].push(ha.dra);this.NR.gotoScenarioLatency.LogicToGotoDuration[H].push(ha.Rva);this.NR.gotoScenarioLatency.GotoDuration[H].push(ha.Yta)}rAh(H,ha){this.NR.gotoScenarioLatency.Names.push(H);this.NR.gotoScenarioLatency.SecondaryScenarios.push(ha);this.NR.gotoScenarioLatency.Durations.push([]);this.NR.gotoScenarioLatency.BusinessLogicDuration.push([]);
this.NR.gotoScenarioLatency.LogicToGotoDuration.push([]);this.NR.gotoScenarioLatency.GotoDuration.push([]);return this.NR.gotoScenarioLatency.Names.length-1}}Object(ia.a)(Ze,"GotoOperationLatencyTelemetry",Xa,[]);class of extends Xa{constructor(H,ha,Ya,Wb,Sc,zd,be,oe){super(H,ha,Ya,Wb,Sc,new hc(!!oe),zd,oe);this.lm=be;this.N4c=1;this.hWb=this.wlb=!1;this.M$i=()=>{const Ke=performance.now()-this.Km.startTime;Z.ULS.sendTraceTag(507511395,0,15,`ZoomOperationLatencyTelemetry.handleTimeout: timeout occurred after ${Ke}ms!`);
this.b1c=void 0;this.Yy("aborted","timeout")};this.B2a=this.da.aM;this.b1c=window.setTimeout(this.M$i,1E4);zd.bof&&(this.hWb=this.lm.startTrackAnimation(zd.event,"viewport_zoom"))}get T2d(){return 20}get Jbh(){return this.Fxa>this.B2a?"zoom-in":"zoom-out"}get MYf(){return 3<=this.N4c}get x_f(){return 1===this.N4c}dispose(){this.b1c&&(window.clearTimeout(this.b1c),this.b1c=void 0);this.hWb&&(Z.ULS.sendTraceTag(507384452,0,50,"ZoomOperationLatencyTelemetry.dispose: aborting animation tracking"),this.hWb=
!1,pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8925676_ZoomSmoothnessDiscardNonAnimationOps")?this.lm.stopTrackAnimation("viewport_zoom",!this.MYf):this.lm.stopTrackAnimation("viewport_zoom"));super.dispose()}F_b(H,ha){super.F_b(H,ha);if(this.Km.M3c){var Ya=this.Km.markers;(Ya=Ya[Ya.length-2])&&H&&this.Km.measure({from:Ya,TL:H})}"zoom-level-set"===H.name?(this.Fxa=null===ha||void 0===ha?void 0:ha.aM,Z.ULS.shipAssertTag(507543945,0,!!this.Fxa,`ZoomOperationLatencyTelemetry.onMarkAdded: zoomLevel is ${this.Fxa}!`)):
"rezoom"===H.name?(this.wlb=!1,this.N4c++):"zoom-idle"===H.name&&(this.wlb=!0,this.KSa(this.da.Mza)&&(this.Km.kYa("zoom-blocks-updated")?this.Yy("complete",void 0,H.timestamp):this.yYb(H.timestamp)),this.hWb&&(this.hWb=!1,this.lm.stopTrackAnimation("viewport_zoom")))}KSa(H){return super.KSa(H)&&this.Fxa?this.Fxa===this.da.Mjl:!1}yYb(H){Z.ULS.shipAssertTag(507511424,0,!!this.Fxa,`ZoomOperationLatencyTelemetry.markWhenAllTheBlocksInViewportAreUpdated: zoom level not set! requiredZoomLevel=${this.Fxa}`);
this.mark("zoom-blocks-updated",void 0,H);this.wlb&&this.Yy("complete",void 0,H)}Eta(H,ha){var Ya;H=Object.assign({},super.Eta(H,ha),{zoomType:this.Jbh,caller:this.context.caller,delayed:this.context.bof,isDiscrete:this.x_f,isAnimation:this.MYf,zoomCount:this.N4c,startZoom:this.B2a,endZoom:this.Fxa,isStandardZoomCssSupportedByBrowser:lf.HelperMethods.isStandardZoomCssSupportedByBrowser});(ha=this.Km.measure({from:"start",TL:"zoom-blocks-updated",c1a:"zoomDuration"}))&&(H.duration=ha.toFixed(4));ha=
this.x_f?ha:this.Km.measure({from:"rezoom",TL:"zoom-blocks-updated",c1a:"lastRezoomDuration"});H.lastRezoomDuration=ha;H.lastRezoomBreakdown={immediate:this.Km.measure({from:"zoom-immediate-start",TL:"zoom-immediate-end",c1a:"zoomImmediate"}),debounceDelay:this.Km.measure({from:"zoom-immediate-end",TL:"zoom-content-area-start",c1a:"zoomDebounceDelay"}),renderBlocks:null!==(Ya=this.Km.measure({from:"zoom-content-area-start",TL:"zoom-blocks-updated",c1a:"zoomRenderBlocks"}))&&void 0!==Ya?Ya:this.Km.measure({from:"zoom-content-area-start",
TL:"end",c1a:"zoomRenderBlocks"})};return H}w3c(H){"complete"===H&&this.Fxa&&(H=this.NR.zoomScenarioLatency[this.Jbh])&&(H.count++,H.duration+=this.Km.duration,H.skeletonDuration+=this.Km.skeletonDuration,H.staleDuration+=this.Km.staleDuration)}}Object(ia.a)(of,"ZoomOperationLatencyTelemetry",Xa,[]);class Xf extends Ze{Eta(H,ha){var Ya,Wb,Sc=this.Km.qxc("business-logic-success");Sc=null!==(Wb=null===(Ya=null===Sc||void 0===Sc?void 0:Sc.context)||void 0===Ya?void 0:Ya.SEi)&&void 0!==Wb?Wb:"unknown";
return Object.assign({},super.Eta(H,ha),{foundCellSource:Sc})}}Object(ia.a)(Xf,"FindOperationLatencyTelemetry",Ze,[]);class bg{constructor(H,ha,Ya){this.da=H;this.kS=ha;this.bXc=Ya;this.Wna=new AbortController;this.Dla=Wb=>{Wb=Wb.detail.viewportScenarioContext;this.qTk(Wb)&&this.K0e(Wb);this.tT.gPj(Wb)};this.kS.Q2e(this.Dla,this.Wna.signal)}dispose(){this.Wna.abort()}mna(H){this.K0e(H)}p1h(H){var ha,Ya;null!==(ha=this.tT)&&void 0!==ha&&ha.d_a?(null===(Ya=this.tT)||void 0===Ya?void 0:Ya.scenario)===
H&&this.tT.Yy("complete"):Z.ULS.sendTraceTag(507270422,0,15,`ViewportOperationTelemetryManager.completeEndToEndScenario: trying to end the scenario ${H}, without any "in progress" scenario`)}aO(H,ha){var Ya;null!==(Ya=this.tT)&&void 0!==Ya&&Ya.d_a&&Object(qi.e)(this.tT.scenario,H)&&this.tT.mark(H,ha)}K0e(H){var ha;(null===(ha=this.tT)||void 0===ha?0:ha.d_a)&&this.tT.Yy("aborted");this.X_k(H)}mfl(H){this.bXc=H}X_k(H){Z.ULS.shipAssertTag(507570112,0,void 0===this.tT||!this.tT.d_a,"ViewportOperationTelemetryManager.startNewScenario: expecting no running operation, but operation is still running");
Object(Pf.d)(H)?this.tT=new vd(this.da,this.da.$.fa.Cw,void 0,this.bXc,H,this.kS):pd.EwaSettings.FEc()&&Object(Pf.b)(H)?this.tT=new Xf(this.da,this.da.$.fa.Cw,void 0,H.name,this.bXc,H,this.kS):Object(Pf.c)(H)?this.tT=new Ze(this.da,this.da.$.fa.Cw,void 0,H.name,this.bXc,H,this.kS):Z.ULS.sendTraceTag(507549210,0,10,`ViewportOperationTelemetryManager.startNewScenario: unhandled scenario ${H.name}!`)}qTk(H){var ha,Ya;return!(null===(ha=this.tT)||void 0===ha?0:ha.d_a)||(null===(Ya=this.tT)||void 0===
Ya?void 0:Ya.scenario)!==H.name}}Object(ia.a)(bg,"ViewportOperationTelemetryManager",null,[]);class Mg{constructor(){this.docId=this.host=this.applicationMode=this.browserVersion=this.browser="";this.hwConcurrency=this.deviceMemory=0;this.isLowEndDevice=this.areNavigatorApisSupported=!1}get reportName(){return"SessionInfo"}}Object(ia.a)(Mg,"SessionInfoSessionEndsReport",null,[582]);class Jg{constructor(){this.maxScrollLeftDistancePx=this.maxScrollRightDistancePx=this.maxScrollDownDistancePx=this.maxScrollUpDistancePx=
0}get reportName(){return"MaxScrollDistance"}}Object(ia.a)(Jg,"MaxScrollDistanceSessionEndsReport",null,[]);var F=a(927),va=a(928);class lb{constructor(){this.missingBlocksDuration=this.skeletonAndMissingBlocksDuration=this.skeletonDuration=this.duration=0;var H;try{var ha=null===(H=PerformanceObserver.supportedEntryTypes)||void 0===H?void 0:H.includes("long-animation-frame")}catch(Ya){pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8851611_handleExceptionInSupportedEntryTypes")&&Z.ULS.sendTraceTag(507310616,
F.a.ewa,va.a.warning,`ScrollOperationLatencySessionEndsReport.isMissingBlocksSupported: exception: ${Ya}`),ha=!1}this.isMissingBlocksSupported=ha;this.isScrollEndEventSupportedByBrowser=lf.HelperMethods.isScrollEndEventSupportedByBrowser;this.maxScrollDistance=new Jg}get reportName(){return"scrollOperationLatency"}}Object(ia.a)(lb,"ScrollOperationLatencySessionEndsReport",null,[]);class sc{constructor(){this.ScrollLatency=new lb;this.gotoScenarioLatency={Names:[],SecondaryScenarios:[],Durations:[],
BusinessLogicDuration:[],LogicToGotoDuration:[],GotoDuration:[]};this.zoomScenarioLatency={}}get reportName(){return"NavigationOperationsLatency"}}Object(ia.a)(sc,"NavigationOperationsLatencySessionEndsReport",null,[582]);let Yc=class{constructor(H,ha,Ya){this.$=H;this.da=ha;this.kS=Ya;this.Wna=new AbortController;this.t_f=lf.HelperMethods.xlb&&pd.EwaSettings.$oj();this.dxk=2E3;this.Q5f=pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8917735_removeTrackingScrollAnimation");this.PUc=null;this.MVb=!1;
this.Dla=Wb=>{Wb=Wb.detail.viewportScenarioContext;Object(Pf.d)(Wb)&&this.Q1j(Wb)};this.Q1j=Wb=>{this.eL?this.E_c("gotoOperationInProgress"):(!this.MVb&&this.Q5f&&(this.MVb=Ki.b(this.$).startTrackAnimation(Wb.event,"viewport_scroll")),this.jai(Wb))};this.kR=()=>{this.E_c("scrollEnd");this.$.fa.io&&!this.eL&&this.GV&&(this.GV.$4d(),this.GV.KSa(this.da.Mza)&&this.GV.Yy("complete"))};this.$rg=()=>{pd.EwaSettings.IY()||this.GV.dispose();this.GV=void 0};this.v$d=()=>{var Wb;pd.EwaSettings.IY()||(null===
(Wb=this.eL)||void 0===Wb?void 0:Wb.dispose());this.eL=void 0};this.de=()=>{pd.EwaSettings.Cbi()?(this.xWf(),pd.EwaSettings.IY()&&this.gac.mfl(this.t1a)):this.e3e()};this.onViewportChange=()=>{this.PUc=Fe.AsyncMethodContext.Ax(()=>{this.Rje()},this.dxk,fe.a.Rje,this.PUc)};this.e3=(Wb,Sc)=>{-1===Sc.yG&&Sc.SHa&&this.afl(Sc.hashCode)};this.xWf();this.$.Ul(this.de);this.t_f&&this.da.VFb(this.onViewportChange);pd.EwaSettings.IY()&&(this.gac=new bg(this.da,Ya,this.t1a));this.kS.Q2e(this.Dla,this.Wna.signal);
this.da.view.W4e(this.kR);this.da.sod(this.e3)}dispose(){this.$.tm(this.de);this.Wna.abort();this.da.view.FHg(this.kR);pd.EwaSettings.IY()&&this.gac.dispose();this.t_f&&this.da.L3b(this.onViewportChange);Ca.a.xd([this.PUc,this.GV,this.eL]);this.PUc=null;this.da.Eie(this.e3);this.eL=this.GV=this.da=this.$=null;this.MVb=!1}get iac(){return this.CLa.viewport}get VTg(){return this.CLa.sheetProcessedData}get msd(){return this.CLa.iOh}get gYk(){return this.CLa.fYk}get t1a(){return this.CLa.dPj}get rwj(){return!!this.GV}SUc(H){if(this.da.hd.isValid){if(this.iac.maxUsedRow<
H.bottom){this.iac.maxUsedRow=H.bottom;const ha=this.da.Uta();this.iac.isRowMaxPixelExceeded=!!ha&&this.da.$va(ha.ye,!0)}this.iac.maxUsedColumn<H.right&&(this.iac.maxUsedColumn=H.right)}}cJg(H){var ha=this.VTg;ha.total+=1;const Ya=Object(Ee.e)(H);ha.defaultCount+=Ya?1:0;ha.defaultRate=ha.defaultCount/ha.total;Ya&&(ha.defaultCountByReason[H.Gfb]+=1);ha=Object(Ee.d)(H);ha||(Z.ULS.sendTraceTag(507574417,0,10,`ViewportTelemetryManager.reportSheetProcessedDataAccess: spd miss, reason=${H.reason}`),Z.ULS.shipAssertTag(507574416,
0,!!H.reason,`ViewportTelemetryManager.reportSheetProcessedDataAccess: spd.reason is ${H.reason}!`));Z.ULS.shipAssertTag(507574415,0,null==this.$.la||null!=this.$.la.sheetProcessedData,`SheetProcessedDataProvider.getActiveSheetProcessedData: invalid SPD availability state! activeItem=${this.$.la?"not null":"null"}, isHit=${ha}`)}j4a(H){var {success:ha,entriesCount:Ya,abortReason:Wb,maxEntries:Sc,sheetCount:zd}=H;H=this.VTg;null!=ha&&(H.prefetchInfo.success=ha);null!=Ya&&(H.prefetchInfo.entriesCount=
Ya);if(null!=Wb){const be=H.prefetchInfo.abortReason;"workbookClosed"!==Wb||"notScheduled"!==be&&"notStarted"!==be?"workbookClosed"!==Wb&&(H.prefetchInfo.abortReason=Wb):H.prefetchInfo.abortReason=`${be}-workbookClosed`}null!=Sc&&(H.prefetchInfo.maxEntries=Sc);null!=zd&&(H.prefetchInfo.sheetCount=zd);Z.ULS.sendTraceTag(507574414,0,50,`ViewportTelemetryManager.reportSheetProcessedDataPrefetch: success=${ha}, entriesCount=${Ya}, abortReason=${Wb}, maxEntries=${Sc}`)}Hje(H,ha,Ya){var Wb,Sc;const zd=
null!==(Sc=null===(Wb=this.$.la)||void 0===Wb?void 0:Wb.hash)&&void 0!==Sc?Sc:"";!this.TTg&&zd&&(this.TTg=zd);Wb=this.msd;this.$.fa.io?(this.rwj&&(!this.fCf&&zd&&(this.fCf=zd),this.Cze(Wb.duringScroll,H,Ya)),this.Cze(Wb.postSessionBoot,H,Ya)):this.Cze(Wb.sessionBoot,H,Ya);Wb.accessedBlocksDistinctCount+="WasNeverCached"===Ya?1:0;Wb.numOfUsedPrefetchedBlocks+=ha?1:0}oxk(){this.msd.numOfPrefetchedBlocks+=1}mna(H){pd.EwaSettings.IY()&&this.gac.mna(Object(Pf.a)(H));if(this.$.fa.io)switch(H){case "switch-sheet":case "insert-sheet":case "find-next":case "goto-dialog":this.I0e(H);
this.E_c("switchSheet|insertSheet|findNext");Z.ULS.shipAssertTag(507549212,0,!0,`ViewportTelemetryManager.gotoNavigationStart: scenario=${H} got an invalid context = ${void 0}!`);pd.EwaSettings.FEc()&&"find-next"===H?this.eL=new Xf(this.da,this.$.fa.Cw,this.v$d,H,this.t1a,void 0):this.eL=new Ze(this.da,this.$.fa.Cw,this.v$d,H,this.t1a,void 0);break;default:Z.ULS.shipAssertTag(507574413,0,!1,`ViewportTelemetryManager.navigationStart: Unexpected scenario name: ${H}`)}}$na(H){var ha;const Ya=!!this.GV,
Wb="zoom"===(null===(ha=this.eL)||void 0===ha?void 0:ha.scenario);ha=this.eL&&"zoom"!==this.eL.scenario;(Ya||ha)&&this.I0e("zoom");Wb?this.eL.mark("rezoom"):this.eL=new of(this.da,this.$.fa.Cw,this.v$d,"zoom",this.t1a,H,Ki.b(this.$));return this.eL}aO(H,ha){pd.EwaSettings.IY()&&this.gac.aO(H,ha);this.eL?Object(qi.e)(this.eL.scenario,H)&&this.eL.mark(H,ha):Z.ULS.sendTraceTag(507574412,0,50,`ViewportTelemetryManager.navigationMark: Marking ${H} for an invalid / non-existing scenario`)}Yy(H){var ha;
pd.EwaSettings.IY()&&this.gac.p1h(H);switch(H){case "find-next":case "goto-dialog":null===(ha=this.eL)||void 0===ha?void 0:ha.Yy("complete");break;default:Z.ULS.shipAssertTag(507574411,0,!1,`ViewportTelemetryManager.scenarioEnd: Unexpected scenario name: ${H}`)}}Cze(H,ha,Ya){var Wb,Sc,zd;H.total+=1;H.hitCount+=ha?1:0;ha||(ha=null!==(Sc=null===(Wb=this.$.la)||void 0===Wb?void 0:Wb.hash)&&void 0!==Sc?Sc:"",H.sheetOnBootMissCount+=ha===this.TTg?1:0,H.firstScrollSheetMissCount+=ha===this.fCf?1:0,H.missCountByReason[Ya]=
(null!==(zd=H.missCountByReason[Ya])&&void 0!==zd?zd:0)+1)}jai(H){this.GV?this.GV.yIa&&(this.GV.Yy("aborted"),this.E_c("aborted"),this.GV=new vd(this.da,this.$.fa.Cw,this.$rg,this.t1a,H)):this.GV=new vd(this.da,this.$.fa.Cw,this.$rg,this.t1a,H)}E_c(H){this.Q5f&&this.MVb&&(Z.ULS.sendTraceTag(507574410,0,50,`ViewportTelemetryManager.stopTrackAnimationIfRunning: reason: ${H}`),Ki.b(this.$).stopTrackAnimation("viewport_scroll"));this.MVb=!1}R$h(){this.CLa={viewport:new Ji,sheetProcessedData:new Hj,iOh:this.f6h(),
fYk:new nj,dPj:new sc,jAl:this.rai()}}f6h(){const H=new Oh;H.blockCacheSize=this.da.gridBlockManager.zoc;return H}rai(){var H,ha,Ya=this.$.ta;const Wb=new Mg;if(navigator){const oe=navigator.deviceMemory;Wb.deviceMemory=oe;if(pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8950897_AddHardwareConcurrencyToXLENC2")){const Ke=navigator.hardwareConcurrency,Xe=void 0!==oe&&void 0!==Ke;Wb.areNavigatorApisSupported=Xe;Wb.hwConcurrency=Ke;Wb.isLowEndDevice=lf.HelperMethods.isLowEndDevice(oe,Ke,Xe)}}else Wb.deviceMemory=
-1;const {browser:Sc,version:zd,returnValue:be}=lf.HelperMethods.f8b(Ya.BrowserNameAndVersion);be&&(Wb.browser=Sc,Wb.browserVersion=zd);Wb.host=Ya.HostName;Wb.docId=Ya.DocumentHostInfo.ServerDocId;Ya=Pd.b(ta.AFrameworkApplication.ea.appSettings.SessionStartInfoJson.toString());Wb.applicationMode=null!==(ha=Ya&&(null===(H=Ya.ApplicationModeExtended)||void 0===H?void 0:H.toString()))&&void 0!==ha?ha:"";return Wb}e3e(){this.$.ra.Vc(276,H=>{for(const ha in this.CLa)this.CLa[ha]&&H.g6(this.CLa[ha])})}xWf(){this.R$h();
this.e3e();this.hgj()}hgj(){this.pgj()}pgj(){this.j4a({success:!1,entriesCount:0,abortReason:"notScheduled",maxEntries:1E3})}Rje(){const H=this.da.HXh();0<H.size&&Z.ULS.sendTraceTag(507574409,0,50,`ViewportTelemetryManager.reportMissingBlocks: found ${H.size} missing blocks ${JSON.stringify(Array.from(H))}`)}afl(H){let ha=!1;const Ya=this.gYk;Ya.skeletonBlocksCounter[H]?Ya.skeletonBlocksCounter[H]+=1:(Ya.skeletonBlocksCounter[H]=1,ha=!0);Ya.count+=1;ha&&(Ya.distinctCount+=1)}I0e(H){var ha,Ya;null===
(ha=this.eL)||void 0===ha?void 0:ha.Yy("aborted",`abortedBy:${H}`);null===(Ya=this.GV)||void 0===Ya?void 0:Ya.Yy("aborted",`abortedBy:${H}`)}};Yc=Object(Ac.__decorate)([Object(Sb.d)(kc.ViewportTelemetryManagerService),Object(Ac.__param)(0,Object(kc.EwaControlService)()),Object(Ac.__param)(1,Object(kc.GridViewService)()),Object(Ac.__param)(2,Object(kc.ViewportObserverService)())],Yc);Object(ia.a)(Yc,"ViewportTelemetryManager",null,[550]);let jd=class extends kb.a{constructor(){super()}k5e(H){this.addHandler("ZCIEK",
H)}YHg(H){this.removeHandler("ZCIEK",H)}npd(H){this.addHandler("ZCUIK",H)}nje(H){this.removeHandler("ZCUIK",H)}Ijk(){this.raiseEvent("ZCIEK")}Hjk(){this.raiseEvent("ZCUIK")}Jjk(){this.raiseEvent("ZCEK")}};jd=Object(Ac.__decorate)([Object(Sb.d)(kc.ZoomEventManagerService)],jd);Object(ia.a)(jd,"ZoomEventManager",kb.a,[549]);var Ad=a(580),Kd=a(650),ye=a(49),Ne=a(177),hf=a(150),sf=a(99),Gf=a(358),Yf=a(151),Ng=a(433);class dh{constructor(H,ha){this.ukb=this.XDc=0;this.qpc=null;this.t0f=!1;this.$=H;this.zoomManager=
ha;this.t0f=H.$Ic}orj(){return Hd.f(this.$).isEditing?(Z.ULS.sendTraceTag(537149795,0,50,"PinchToZoomAdapter.IsGesturePossible A cell is being edited -> don't allow pinch"),!1):this.$.Mb.DC?(Z.ULS.sendTraceTag(537149794,0,50,"PinchToZoomAdapter.IsGesturePossible A modal dialog is opened -> don't allow pinch"),!1):!0}IYj(H){this.qpc=new Sys.UI.Point(Math.round(H.aGa.center.x),Math.round(H.aGa.center.y));this.XDc=this.zoomManager.zoom;this.ukb=H.aGa.scale;const ha={["InitialZoom"]:this.XDc,["Location"]:"canvas",
["InputMethod"]:H.Yb};Yf.b(this.$).Jd(hf.a.gbk,ha);Z.ULS.sendTraceTag(537149793,0,50,`PinchToZoomAdapter.OnGestureStart starting gesture. center (${this.qpc.x},${this.qpc.y}), initial zoom ${this.XDc}, initial scale ${this.ukb}`);this.aob(H,"onGestureStart");return!0}HYj(H){if(!this.ukb)return Z.ULS.shipAssertTag(537149792,0,!1,"PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be 0"),this.aob(H,"OnGestureEvent"),!0;if(!isFinite(this.ukb))return Z.ULS.sendTraceTag(537149791,0,15,`PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be infinite. initialPinchScale=${this.ukb}`),
this.aob(H,"OnGestureEvent"),!0;const ha=H.aGa.scale/this.ukb*this.XDc;this.zoomManager.Gbh(ha,this.qpc);Z.ULS.sendTraceTag(537149790,0,50,`PinchToZoomAdapter.OnGestureEvent processing gesture. New zoom ${ha}. Current scale ${H.aGa.scale}`);this.aob(H,"OnGestureEvent");return!0}GYj(H){this.zoomManager.Hbh();Z.ULS.sendTraceTag(537149789,0,50,"PinchToZoomAdapter.OnGestureEnd end of gesture");this.aob(H,"OnGestureEnd")}FYj(H){Z.ULS.sendTraceTag(537149788,0,50,"PinchToZoomAdapter.OnGestureCancel gesture canceled");
this.aob(H,"OnGestureCancel")}aob(H,ha){var Ya,Wb,Sc;this.t0f&&(Z.ULS.sendTraceTag(536990857,0,50,`PinchToZoomAdapter.markGestureEventAsHandled - Invoked from ${ha},        eventArgs non-null: ${isNullOrUndefined(H)}, gestureData non-null: ${isNullOrUndefined(null===H||void 0===H?void 0:H.aGa)},        srcEvent non-null: ${isNullOrUndefined(null===(Ya=null===H||void 0===H?void 0:H.aGa)||void 0===Ya?void 0:Ya.srcEvent)}`),null===(Sc=null===(Wb=null===H||void 0===H?void 0:H.aGa)||void 0===Wb?void 0:
Wb.srcEvent)||void 0===Sc?void 0:Sc.preventDefault())}}Object(ia.a)(dh,"PinchToZoomAdapter",null,[574]);var vg=a(998),zi=a(115);class Vh extends kb.a{constructor(H,ha){super();this.statusBarManager=null;this.PDf=!1;this.zoomManager=ha;this.$=H;this.$.ra.Vc(29,Ya=>{this.statusBarManager=Ya;Ya.FJ(this)})}Js(H){this.addHandler("Zoom",H)}vs(H){this.removeHandler("Zoom",H)}Yp(){const H=dd.a.Kmb(this.$)?"QueryZoomComboBoxValue":"QueryZoomStatus";this.Wj(H)&&this.raiseEvent("Zoom")}vq(H,ha){switch(H){case "QueryZoomStatus":return this.E9i(ha);
case "QueryZoomComboBoxValue":return this.D9i(ha);default:return!1}}Wj(H){switch(H){case "QueryZoomStatus":return dd.a.Z4(this.$);case "QueryZoomComboBoxValue":return dd.a.Kmb(this.$)&&dd.a.Z4(this.$);default:return!1}}dispose(){this.statusBarManager&&(this.statusBarManager.OI(this),this.statusBarManager=null);this.$=null;super.dispose()}CPf(H){H=this.n5i(H);if(!H)return null;H=H.getElementsByClassName("cui-ctl-mediumlabel");return 1!==H.length?(Z.ULS.shipAssertTag(537149764,0,!1,"ZoomStatusBarManager.GetZoomUIElement Cannot find zoom label element"),
null):H[0]}D9i(H){if(!this.$)return!1;const ha=zi.a().zxb;H[vg.a.Value]=ha;return!0}E9i(H){if(!this.$)return!1;const ha=this.zoomManager.zxb;let Ya=!1;if(dd.a.oj(this.$))Kb.a.equals(appChrome.selectors.getControlLabel(If.a.zoomStatusBarMenuOpen),ha,!1)||(Ya=!0);else{const Wb=this.CPf("HandleQueryZoomStatusCommand");Wb?Kb.a.equals(H.LabelText.toString(),ha,!1)||(Wb.innerText="",Ya=!0):Ya=!0}Ya&&this.QKk(H,ha);return!0}QKk(H,ha){H.LabelText=ha;dd.a.oj(this.$)&&(H.Visible=!0)}n5i(H){var ha=Ua.DOMElementExtensions.getElementById(this.$.domElement,
"m_excelWebRenderer_ewaCtl_zoomLevel-Medium14");if(!ha)return ha=(ha=this.$.fa.$b)?ha.inEmbedView:!1,Uf.a.ot||ha||Z.ULS.sendTraceTag(537149763,0,15,`ZoomStatusBarManager.GetZoomBaseElement Cannot find zoom label. Called from ${H}`),null;this.PDf||(this.PDf=!0,Z.ULS.sendTraceTag(537149762,0,50,`ZoomManager.GetZoomBaseElement - Zoom label was found first time. Called from ${H}`));return ha}}Object(ia.a)(Vh,"ZoomStatusBarManager",kb.a,[4,360,217]);var Ij=a(31),rk=a(186);let Bj=class extends Kd.a{constructor(H,
ha){super(H,Ij.a.jNb);this.Axb=this.VIa=this.dXb=null;this.iXb=-1;this.s0f=!1;this.Hgl=pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseDelayDuringPinchZoom",!1);this.RPj=pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8991028_NoOpIfSameZoomLevel");this.Nd=()=>{this.iXb=-1};this.Wdg=Object(rk.a)(Ya=>{Ya.d_a&&Ya.mark("zoom-idle")},200);Z.ULS.sendTraceTag(537149785,0,50,"AppZoom feature is Enabled.");this.Bxb=new Vh(H,this);this.hbk()&&(Z.ULS.sendTraceTag(537149784,0,50,"ZoomManager.ZoomManager Attaching pinch to zoom events"),
this.OLh());this.Axb=ha}dispose(){this.Bxb&&(Ca.a.vb(this.Bxb),this.Bxb=null);this.Axb&&(this.Axb=null);this.s0f&&this.pgi();super.dispose()}Gbh(H,ha){H=this.rWa(H);if(Hd.f(this.$).rtl){const Ya=Math.round(Ua.DOMElementExtensions.getBounds({element:this.$.Wf}).width*(lf.HelperMethods.isStandardZoomCssSupportedByBrowser?uf.a.IC:this.zoom));this.dXb=new Sys.UI.Point(Ya-ha.x,ha.y)}else this.dXb=ha;this.r5a(H,{delay:this.Hgl,pLb:"default"},"ZoomWithPinch")}Iac(){return!0}Q4c(H,ha,Ya){var Wb=Uf.a.isMac?
.07:.15;H=this.zoom+(H?Wb:-Wb);H=this.rWa(H);Hd.f(this.$).rtl?(Wb=Math.round(Ua.DOMElementExtensions.getBounds({element:this.$.Wf}).width*(lf.HelperMethods.isStandardZoomCssSupportedByBrowser?uf.a.IC:this.zoom)),this.VIa=new Sys.UI.Point(Wb-ha.x,ha.y)):this.VIa=ha;ha=this.zoom;this.r5a(H,{delay:!0,pLb:"default"},"ZoomWithMouse",Ya);Ya={["InitialZoom"]:ha,["FinalZoom"]:H,["Location"]:"canvas"};Yf.b(this.$).Jd(hf.a.Rll,Ya)}Hbh(){this.dXb=null}R4c(H,ha){this.r5a(this.rWa(H),{delay:!1},ha?"ZoomWithDropDownFromRibbon":
"ZoomWithDropDown")}Ibh(H){isNaN(H)?Z.ULS.sendTraceTag(537149783,0,15,"ZoomManager.ZoomToSelectionForFollowAlongInExcelLive: Invalid zoom value was provided"):this.r5a(this.rWa(H),{delay:!1},"ZoomToLevelInExcelLive")}S4c(H,ha){this.r5a(this.rWa(H),{delay:!0,pLb:ha?"default":"fast"},ha?"ZoomWithShortcuts":"ZoomWithButtons")}nNf(H,ha){const Ya=Hd.f(this.$).rtl,[Wb,Sc]=this.sNd(Ya),[zd,be]=this.sPd(H,Sc);return this.VIa?(H=this.SMd(this.VIa,H,ha,Sc,Wb,"ZoomWithMouse"),this.VIa=null,H):this.dXb?this.SMd(this.dXb,
H,ha,Sc,Wb,"ZoomWithPinch"):Hd.f(this.$).ha.ob.isFloatingObjectSelected?this.Qll(H,ha,Sc,Wb,zd,be,Hd.f(this.$).rtl):this.Sll(H,ha,Sc,Wb,zd,be,Hd.f(this.$).rtl)}eOg(H,ha,Ya){if(H){Z.ULS.sendTraceTag(537149782,0,50,`Zoom To: (${H.x} ${H.y}) (new top-left) from zoom:${ha} to zoom:${Ya}`);H=new ye.a(H.x,H.y);Ya=Hd.f(this.$);const [,Wb]=this.sNd(Ya.rtl),[Sc,zd]=this.sPd(ha,Wb);Ya.Q5e(H,Sc,zd,{name:"ApplicationZoom"})}else Z.ULS.sendTraceTag(537149781,0,50,`Zooming top-left: from zoom:${ha} to zoom:${Ya}`)}zoomFitToScreen(){const H=
this.zoom;var ha=Hd.f(this.$).rtl;const [Ya,Wb]=this.sNd(ha),[Sc,zd]=this.sPd(H,Wb);var be=Hd.f(this.$).ha.ob.isFloatingObjectSelected;(ha=be?this.NIf(this.Ypb,Sc,zd,!1):this.uNf(this.Ypb,Wb,Ya,Sc,zd,ha,!1))?(ha=Math.min(Sc/(ha.width+100),zd/(ha.height+100)),ha=this.BCi(ha),this.r5a(ha,{delay:!0,pLb:"default"},"ZoomWithFitToScreen"),be?Hd.f(this.$).ha.ob.LTa(Hd.f(this.$).ha.ob.Wb,!1):(be=ra.y(Hd.f(this.$).ha.oa.activeRange,this.$),Hd.f(this.$).lj(be,null,null,null,3,"ZoomManager.ZoomFitToScreen")),
this.iXb=H,this.s0f||this.ILh()):Z.ULS.sendTraceTag(537149780,0,15,`ZoomManager.ZoomFitToScreen: Bounds found to be null with FloatingObjectSelected: ${be}`)}zoomFitToScreenUndo(){this.r5a(this.iXb,{delay:!1},"ZoomWithFitToScreen")}lse(){return-1!==this.iXb}ILh(){const H=Hd.f(this.$);H&&(H.ha.Vq(this.Nd),H.KJ(this.Nd))}pgi(){const H=Hd.f(this.$);H&&(H.ha.vr(this.Nd),H.xL(this.Nd))}BCi(H){H=Math.min(H,uf.a.kLj);H=Math.max(H,uf.a.eMj);return Math.round(100*H)/100}r5a(H,ha,Ya,Wb){var Sc;if(this.O4c()){var zd=
Hd.f(this.$).view.visibleArea.toString();H=this.rWa(H);var be=tf.d(this.$.qa.la);be||(be=Kd.a.whg);Hd.f(this.$).Ce.ML(5,Gf.a.M4c,Ya);var oe=null===(Sc=Sb.a.Cb(kc.ViewportTelemetryManagerService))||void 0===Sc?void 0:Sc.$na({name:"zoom",caller:Ya,bof:ha.delay,timestamp:null===Wb||void 0===Wb?void 0:Wb.timeStamp,isStandardZoomCssSupportedByBrowser:lf.HelperMethods.isStandardZoomCssSupportedByBrowser,event:Wb});this.RPj&&this.zoom===H?oe&&(oe.mark("zoom-level-set",new ua.a(this.$.fa.Cw,H)),oe.mark("zoom-blocks-updated"),
this.Wdg(oe)):(Hd.f(this.$).Ce.UY(Gf.a.M4c,this.$.fa.Je),Z.ULS.sendTraceTag(537149779,0,50,`ZoomManager.SetNewZoomLevel Setting zoom ${H} to sheet ${be} origin ${Ya} prevZoom ${this.zoom}`),this.MNk(be,H),this.Axb.Jjk(),this.c8k(Ya,oe),this.p8k(ha),this.iXb=-1,Ng.b(this.$,Ya),H=Hd.f(this.$).view.visibleArea.toString(),Z.ULS.sendTraceTag(537149778,0,50,`ZoomManager.SetNewZoomLevel OldGridVisibleArea: ${zd}, NewGridVisibleArea: ${H}, IsShyRibbonActive: ${this.$.H2}`),oe&&this.Wdg(oe))}}cNi(H){return(H=
lf.HelperMethods.aE(this.$.Wf,this.$.domElement,H))?H:new Sys.UI.Point(0,0)}sNd(H){const ha=this.cNi(H);H=this.GSi(ha,H);return[ha,H]}sPd(H,ha){const Ya=Ua.DOMElementExtensions.getBounds({element:this.$.Wf});return[lf.HelperMethods.isStandardZoomCssSupportedByBrowser?Math.round(Ya.width-ha.x*H):Math.round((Ya.width-ha.x)*H),lf.HelperMethods.isStandardZoomCssSupportedByBrowser?Math.round(Ya.height-ha.y*H):Math.round((Ya.height-ha.y)*H)]}GSi(H,ha){ha=lf.HelperMethods.aE(Hd.f(this.$).domElement,this.$.domElement,
ha);return ha?(H=new Sys.UI.Point(Math.round(ha.x-H.x),Math.round(ha.y-H.y)),H):new Sys.UI.Point(0,0)}Sll(H,ha,Ya,Wb,Sc,zd,be){return(be=this.uNf(H,Ya,Wb,Sc,zd,be))?this.gMf(be,H,ha,Ya,Wb,Sc,zd):null}uNf(H,ha,Ya,Wb,Sc,zd,be){be=void 0===be?!0:be;var oe=ra.L(Hd.f(this.$).ha.oa.selectedRanges);if(be&&(oe=oe.Xe(ra.L(Hd.f(this.$).BBc())),!oe))return Z.ULS.sendTraceTag(537149777,0,50,"ZoomManager.GetSelectedRangeBounds No range inside the viewport is selected."),null;const Ke=Hd.f(this.$).Ob(oe.topLeft);
oe=Hd.f(this.$).Ob(oe.bottomRight);if(!Ke||!oe)return Z.ULS.sendTraceTag(537149776,0,15,"ZoomManager.GetSelectedRangeBounds Cannot get cells for top-left or bottom-right of the selected range. Will zoom top-left"),null;H=Ke.cell.wC===oe.cell.wC&&Ke.cell.YF===oe.cell.YF?this.LLi(H,oe,ha,Ya,Wb,zd):this.J3i(H,Ke,oe,ha,Ya,Wb,zd);return H?be?this.oCf(H,Wb,Sc):H:(Z.ULS.sendTraceTag(537149775,0,15,"ZoomManager.GetSelectedRangeBounds got null bounds"),null)}oCf(H,ha,Ya){if(0>H.x||H.x>ha)H.x=0;if(0>H.y||H.y>
Ya)H.y=0;H.x+H.width>ha&&(H.width=ha-H.x);H.y+H.height>Ya&&(H.height=Ya-H.y);return H}J3i(H,ha,Ya,Wb,Sc,zd,be){ha=Hd.f(this.$).getCellBounds(ha.cell);if(!ha)return null;const oe=Hd.f(this.$).getCellBounds(Ya.cell);if(!oe)return null;let Ke=Sc.x;be&&(Ke=0,ha.x=Math.round(zd/H)-ha.x-Math.round(ha.width),oe.x=Math.round(zd/H)-oe.x-Math.round(oe.width));H=new Sys.UI.Bounds(Math.round((ha.x-Wb.x)*H)-Ke,Math.round((ha.y-Wb.y)*H-Sc.y),Math.round((oe.x+oe.width-ha.x)*H),Math.round((oe.y+oe.height-ha.y)*H));
Ya=Ya.cell.getRange();Z.ULS.sendTraceTag(537149774,0,50,`ZoomManager.GetTwoCellsBoundsWithZoom - a range with more than 1 cell was selected. Will zoom to range: (t:${Ya.top}, b:${Ya.bottom}, r:${Ya.right}, l:${Ya.left}) in bounds (${H.x}, ${H.y}, ${H.width}, ${H.height})`);return H}LLi(H,ha,Ya,Wb,Sc,zd){const be=Hd.f(this.$).getCellBounds(ha.cell);if(!be)return null;let oe=Wb.x;zd&&(oe=0,be.x=Math.round(Sc/H)-be.x-Math.round(be.width));H=new Sys.UI.Bounds(Math.round((be.x-Ya.x)*H)-oe,Math.round((be.y-
Ya.y)*H-Wb.y),Math.round(be.width*H),Math.round(be.height*H));ha=ha.cell.getRange();Z.ULS.sendTraceTag(537149773,0,50,`ZoomManager.GetCellBoundsWithZoom - single cell was selected. Will zoom to cell: (t:${ha.top}, l:${ha.left}) in bounds (${H.x}, ${H.y}, ${H.width}, ${H.height})`);return H}Qll(H,ha,Ya,Wb,Sc,zd){const be=this.NIf(H,Sc,zd);return be?this.gMf(be,H,ha,Ya,Wb,Sc,zd):null}gMf(H,ha,Ya,Wb,Sc,zd,be){H=new Sys.UI.Point(this.OMf(zd,H.x,H.width),this.OMf(be,H.y,H.height));return this.SMd(H,ha,
Ya,Wb,Sc)}OMf(H,ha,Ya){return H===Ya?(Z.ULS.sendTraceTag(537149772,0,50,"ZoomManager.GetRelativePointCoordinate returning size/2 since the bounds are the same as the grid bounds"),H/2):H*ha/(H-Ya)}NIf(H,ha,Ya,Wb){Wb=void 0===Wb?!0:Wb;const Sc=Hd.f(this.$).ha.ob.Wb.domElement;var zd=lf.HelperMethods.aE(Sc,Hd.f(this.$).domElement,Hd.f(this.$).rtl);if(!zd)return Z.ULS.sendTraceTag(537149771,0,50,"ZoomManager.GetFloatingObjectBounds got null for floatingObjectPointOnGrid"),null;const be=Hd.f(this.$).WGa();
zd=new Sys.UI.Point(Math.round((zd.x-be.topLeft.x)*H),Math.round((zd.y-be.topLeft.y)*H));H=new Sys.UI.Bounds(zd.x,zd.y,Math.round(Sc.offsetWidth*H),Math.round(Sc.offsetHeight*H));return Wb?this.oCf(H,ha,Ya):H}Xhg(){this.Bxb.Yp()}ZQj(H){"ZoomToLevelInExcelLive"===H?this.Axb.Ijk():this.Axb.Hjk()}SMd(H,ha,Ya,Wb,Sc,zd){zd=void 0===zd?"":zd;var be=Hd.f(this.$).rtl?0:Sc.x;Sc="ZoomWithPinch"===zd||"ZoomWithMouse"===zd?new Sys.UI.Point(H.x-be-Math.round(Wb.x*ha),H.y-Sc.y-Math.round(Wb.y*ha)):H;Sc=new Sys.UI.Point(Math.round(Sc.x/
ha),Math.round(Sc.y/ha));Z.ULS.shipAssertTag(537149770,0,!!ha,"Original zoom level must be different than 0");be=Ya/ha;Sc=new Sys.UI.Point(Math.round(Sc.x*(1-1/be)),Math.round(Sc.y*(1-1/be)));"ZoomWithMouse"===zd||"ZoomWithPinch"===zd?(Sc.x+=Math.round((Wb.x-Hd.f(this.$).nn)*(be-1)),Sc.y+=Math.round((Wb.y-Hd.f(this.$).uz)*(be-1))):(be=Math.round(Wb.x*(Ya-ha)),0<be&&Sc.x>be&&(Sc.x+=be),ha=Math.round(Wb.y*(Ya-ha)),0<ha&&Sc.y>ha&&(Sc.y+=ha));"ZoomWithMouse"===zd&&(H.x||(Sc.x=0),H.y||(Sc.y=0));H=Hd.f(this.$).WGa();
return new Sys.UI.Point(Sc.x+H.topLeft.x,Sc.y+H.topLeft.y)}OLh(){const H=[];Object(kd.d)(Ad.a).execute(ha=>{0===ha.ZRi()&&ha.Qnk(document.body,new dh(this.$,this),H)})}hbk(){return this.O4c()&&(Uf.a.Wp&&Uf.a.VHa(67)||this.$.$Ic)}MNk(H,ha){Ng.a(this.$)?this.Zpe(H,ha,this.NCe,uf.a.czg):this.Zpe(H,ha,this.zoomPerSheetId,this.Ypb)}Zpe(H,ha,Ya,Wb){Ya.remove(H);ha!==Wb&&Ya.add(H,ha)}c8k(H,ha){null===ha||void 0===ha?void 0:ha.mark("zoom-immediate-start");this.xSg();this.$.ixa(Vi.a.BGa("TriggerImmediateZoomOperations"));
this.igl();this.ZQj(H);null===ha||void 0===ha?void 0:ha.mark("zoom-immediate-end")}igl(){this.bZd()?this.$.Sg():this.Bxb.Yp();const H=this.Bxb.CPf("UpdateZoomStatusBar");H&&(H.innerText=this.zxb)}bZd(){const H=Ne.a(this.$);return H?H.um.Tw===(dd.a.sIa(this.$)?Zc.a.x3a:this.$.Oc+Zc.a.Gle):!1}p8k(H){Hd.f(this.$).Nll(H);this.BHh()}BHh(){const H=sf.a(this.$);if(H)for(const ha of Hd.f(this.$).za.lv()){if(!ha){Z.ULS.sendTraceTag(537149768,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - cacheItem is null");
continue}if(!ha.Ak)continue;const Ya=ha.Ii;if(Ya)for(let Wb=0;Wb<Ya.count;Wb++)if(2===Ya.Mh(Wb).type){const Sc=H.fr(Ya.Mh(Wb).Fh());Sc?(Sc.Gna(!1),Z.ULS.sendTraceTag(537149766,0,50,`ZoomManager.AdjustSlicersToZoom - Slicer zoomed to zoom ${this.zoom}`)):Z.ULS.sendTraceTag(537149767,0,50,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - control is null")}}else Z.ULS.sendTraceTag(537149769,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - floatingObjectManager is null")}};Bj=Object(Ac.__decorate)([Object(Sb.d)(kc.ZoomManagerService),
Object(Ac.__param)(0,Object(kc.EwaControlService)()),Object(Ac.__param)(1,Object(kc.ZoomEventManagerService)())],Bj);Object(ia.a)(Bj,"ZoomManager",Kd.a,[]);var hl=a(972),Tj=a(945),uj=a(1063);let Oj=class extends kb.a{constructor(H){super();this.i7=this.Rhb=this.statusBarManager=null;this.sSb=this.EVb=!1;this.Pug=()=>{const ha=this.xbf();window.innerHeight>=ha&&!this.EVb?(this.EVb=!0,this.Yp()):this.EVb&&window.innerHeight<ha&&(this.EVb=!1,this.Yp())};this.I9d=()=>{this.Yp();uj.a.ida||(Z.ULS.sendTraceTag(507566092,
0,50,"FullScreenStatuBarManager.OnFullScreenChangeEventHandler:  exit fullscreen mode"),this.sSb=!1)};this.$=H;this.$.Ia.yha(this);this.$.ra.Vc(29,ha=>{this.statusBarManager=ha;ha.FJ(this)});this.ExcelFullScreenCalloutSettings=JSON.parse(ta.AFrameworkApplication.ea.Qa("ExcelFullScreenCalloutSettings"));this.XLj=6E4*this.ExcelFullScreenCalloutSettings.AppUsageTimeInMinutes;this.i7=document.getElementById("MainApp");this.Rhb=this.I9d;$addHandler(this.i7,uj.a.PId,this.Rhb);$addHandler(window,ah.a.resize,
this.Pug);pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ToggleFullScreenRibbon",!1)&&this.rVk()}Js(H){this.addHandler("FullScreenChangedEventKey",H)}vs(H){this.removeHandler("FullScreenChangedEventKey",H)}Yp(){this.Wj("QueryFullScreen")&&(pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ToggleFullScreenRibbon",!1)&&this.bZd()&&this.$.Sg(),this.raiseEvent("FullScreenChangedEventKey"))}vq(H,ha){switch(H){case "QueryFullScreen":return ha[hl.a.On]=uj.a.ida,ha[Tj.a.customTooltip]=
uj.a.ida?Yb.a.instance.ia(2409):Yb.a.instance.ia(2408),pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8740765_TogglingOfFullScreenIcons")&&(ha[Tj.a.IconSet]=uj.a.ida?{"default":"FullScreenMinimize_16"}:{"default":"FullScreenMaximize_16"}),!0;default:return!1}}Wj(){return dd.a.QWd()?!0:!1}dispose(){this.statusBarManager&&(this.statusBarManager.OI(this),this.statusBarManager=null);$removeHandler(this.i7,uj.a.PId,this.Rhb);$removeHandler(window,ah.a.resize,this.Pug);this.i7=this.$=null;super.dispose()}Rc(H,
ha){switch(ha.command){case -1912752143:return!0;default:return!1}}xbf(){const H=screen.height;return H-this.ExcelFullScreenCalloutSettings.ScreenSizeDelta*H}gd(H,ha){switch(ha){case -1912752143:return H=this.xbf(),this.EVb&&!this.sSb||window.innerHeight>=H&&!this.sSb?!0:!1;default:return!1}}td(){return!1}executeCommand(H,ha,Ya){switch(ha.command){case -1912752143:return"share"===Ya.triggeredBy&&Z.ULS.sendTraceTag(507118166,0,50,"RibbonCommand.toggleFullScreen is triggered by Share dialog. Exiting fullscreen mode."),
this.T5k(),this.Yp(),jb.Task.Va(!0);default:return Si.a(ha.command)}}T5k(){uj.a.ida?(uj.a.exitFullscreen(),this.sSb=!1):(Z.ULS.sendTraceTag(507533057,0,15,`FullScreenStatuBarManager.OnFullScreenChangeEventHandler:  enter fullscreen mode, winow height: ${window.innerHeight}, ribbon mode: ${appChrome.selectors.getRibbonMode()}`),uj.a.requestFullscreen(this.i7),this.sSb=!0)}rVk(){setTimeout(()=>{(window.innerHeight<=this.ExcelFullScreenCalloutSettings.MaxWindowInnerHeight||screen.height/window.innerHeight<
this.ExcelFullScreenCalloutSettings.MaxRatioOfScreenToWindowHeight)&&this.sVk()},this.XLj)}bZd(){const H=Ne.a(this.$);return H?H.um.Tw===(dd.a.sIa(this.$)?Zc.a.x3a:this.$.Oc+Zc.a.Gle):!1}sVk(){const H=new Jc.a(-847286761,gc.a.Hb,0,0,null);this.$.Ia.Gb(H,{["InputMethod"]:gc.a.Hb,CalloutName:22})}};Oj=Object(Ac.__decorate)([Object(Sb.d)(kc.FullScreenStatusBarManagerService),Object(Ac.__param)(0,Object(kc.EwaControlService)())],Oj);Object(ia.a)(Oj,"FullScreenStatusBarManager",kb.a,[4,217,29]);const ik=
Object(kd.b)("Common.App.DisplayFileInfo.DisplayFileInfo"),jk=Object(kd.c)(ik);var wh=a(135),oj=a(1023),Bg=a(24),T=a(1250);class gb{constructor(H){this.buildVersion=this.userSessionId=null;this.x3c=(ha,Ya,Wb,Sc,zd)=>{if(1===Wb)return 32;zd[oj.a.SecondaryLabel]=this.userSessionId;zd[oj.a.Visible]=!0;return 32};this.Lbl=(ha,Ya,Wb,Sc,zd)=>{if(1===Wb)return 32;zd[oj.a.SecondaryLabel]=this.buildVersion;zd[oj.a.Visible]=!0;return 32};this.Bcl=(ha,Ya,Wb,Sc,zd)=>{var be,oe,Ke;if(1===Wb)return 32;zd[oj.a.Value]=
this.aOf();zd[Tj.a.Yi]=this.aOf();zd[oj.a.LinkInfo]={["linkText"]:null!==(be=this.pRi())&&void 0!==be?be:"",["linkUrl"]:null!==(oe=this.tPi())&&void 0!==oe?oe:""};(null===(Ke=ta.AFrameworkApplication.ea)||void 0===Ke?0:Ke.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_8983740_FileMenuHeaderBugFixEnabled"))||(zd[oj.a.Visible]=!0);return 32};this.Ncl=(ha,Ya,Wb,Sc,zd)=>{var be,oe,Ke,Xe;if(1===Wb)return 32;zd[T.a.FileLocationProps]={["breadcrumbBrandName"]:null!==(be=ta.AFrameworkApplication.Wh.breadcrumbBrandName)&&
void 0!==be?be:"",["breadcrumbBrandUrl"]:null!==(oe=ta.AFrameworkApplication.Wh.breadcrumbBrandUrl)&&void 0!==oe?oe:"",["breadcrumbFolderName"]:null!==(Ke=ta.AFrameworkApplication.Wh.breadcrumbFolderName)&&void 0!==Ke?Ke:"",["breadcrumbFolderUrl"]:null!==(Xe=ta.AFrameworkApplication.Wh.breadcrumbFolderUrl)&&void 0!==Xe?Xe:""};return 32};this.zh=H}pRi(){return ta.AFrameworkApplication.Wh.breadcrumbFolderName&&0<ta.AFrameworkApplication.Wh.breadcrumbFolderName.length?ta.AFrameworkApplication.Wh.breadcrumbFolderName:
ta.AFrameworkApplication.Wh.breadcrumbBrandName&&0<ta.AFrameworkApplication.Wh.breadcrumbBrandName.length?ta.AFrameworkApplication.Wh.breadcrumbBrandName:Object(Bg.a)("Online")}aOf(){return ta.AFrameworkApplication.Wh.breadcrumbBrandName&&0<ta.AFrameworkApplication.Wh.breadcrumbBrandName.length||ta.AFrameworkApplication.Wh.breadcrumbFolderName&&0<ta.AFrameworkApplication.Wh.breadcrumbFolderName.length?Object(Bg.a)("SaveAssuranceStatusWithFolder"):Object(Bg.a)("SaveAssuranceStatusGeneric")}tPi(){return ta.AFrameworkApplication.Wh.breadcrumbFolderUrl&&
0<ta.AFrameworkApplication.Wh.breadcrumbFolderUrl.length?ta.AFrameworkApplication.Wh.breadcrumbFolderUrl:ta.AFrameworkApplication.Wh.breadcrumbBrandUrl&&0<ta.AFrameworkApplication.Wh.breadcrumbBrandUrl.length?ta.AFrameworkApplication.Wh.breadcrumbBrandUrl:""}wi(){var H,ha;this.userSessionId=null!==(H=ta.AFrameworkApplication.userSessionId)&&void 0!==H?H:"";this.buildVersion=null!==(ha=ta.AFrameworkApplication.buildVersion)&&void 0!==ha?ha:"";this.zh.ef(yb.a.gBg,wh.a.frame,this.x3c,96);this.zh.ef(yb.a.MAg,
wh.a.frame,this.Lbl,96);this.zh.ef(yb.a.queryDocLocationInfo,wh.a.frame,this.Bcl,96);this.zh.ef(yb.a.SAg,wh.a.frame,this.Ncl,96)}}Object(ia.a)(gb,"DisplayFileInfo",null,[614]);class Lb{constructor(){this.oc=null}get name(){return"Common.App.DisplayFileInfo"}ji(H){this.oc=H;this.oc.register(gb,"Common.App.DisplayFileInfo.DisplayFileInfo").Lc().Qc(()=>new gb(ta.AFrameworkApplication.Kb))}init(){Object(kd.a)(jk).wi()}dispose(){}static main(){Pe.a.instance.Qi(new Lb)}}Object(ia.a)(Lb,"DisplayFileInfoPackage",
null,[11,12]);Object(Sb.b)(kc.FileMenuInfoManagerService,{we:"singleton"})(()=>{Type.registerNamespace("Common.App.DisplayFileInfo");Lb.main();return Object(kd.a)(jk)});class fd{constructor(H){this.Rjc=this.Qjc=this.Sjc=null;this.Bt=H}dispose(){this.Bt.YL(Zb.a.BHa);this.Bt=null}get Vah(){return encodeURI(this.Sjc)}set Vah(H){this.Sjc=H}get Tah(){return this.Qjc}set Tah(H){this.Qjc=H}get Uah(){return this.Rjc}set Uah(H){this.Rjc=H}xpk(H){this.Bt.nl(Zb.a.BHa);this.Bt.ik(Zb.a.BHa,H)}ard(H){const ha=
{};ha.Url=this.BDd(H);H=new Date;H=`CorrelationId:${Ub.a.create().toString()} tCreate:${H.getTime()} `;this.Bt.sendMessage(Zb.a.u7e,ha,H);Z.ULS.sendTraceTag(507025314,0,50,`getWopiInfoHelper.AskHostToResolveUrl: Postmessage sent, CorrelationInfo: ${H}`)}Myj(H){const ha=`${H.CorrelationId} tResponseSent:${H.SendTime} tResponseReceived:${H.Values.m_ReceivedTime} tDone:${(new Date).getTime()}`;Z.ULS.sendTraceTag(507025313,0,50,`GetWopiInfoHelper.OnWopiInfoReceivedFromHost: Postmessage received, correlationInfo: ${ha}`);
if(H.MessageId!==Zb.a.BHa)return Z.ULS.sendTraceTag(50436067,0,10,`ExternalLinksManager.OnWopiInfoReceivedFromHost: Bad message type: ${H.MessageId}`),!1;if(!this.SAd(H.Values.Url))return Z.ULS.sendTraceTag(50436096,0,10,"GetWopiInfoHelper.OnWopiInfoReceivedFromHost: Original string is null or empty"),!1;const Ya=H.Values.Error;if(null!=Ya)return H=JSON.stringify(Ya.Details),Z.ULS.sendTraceTag(507291800,0,10,`GetObserverChartFromHostAndInsertManager.OnWopiInfoReceivedFromHost: Error, Id: ${Ya.Id}, Details: ${H}}`),
!1;Z.ULS.sendTraceTag(507291799,0,50,`GetObserverChartFromHostAndInsertManager.OnWopiInfoReceivedFromHost: Postmessage success, correlationInfo: ${ha}`);this.Sjc=H.Values.WopiSrc;this.Qjc=H.Values.AccessToken;this.Rjc=H.Values.AccessTokenExpiry;return this.Sjc&&this.Qjc&&this.Rjc?!0:(Z.ULS.sendTraceTag(507291798,0,10,"GetObserverChartFromHostAndInsertManager.OnWopiInfoReceivedFromHost: One or more received values are null or empty."),!1)}BDd(H){return H?H.replace(RegExp("#","g"),"%23"):H}SAd(H){return H?
H.replace(RegExp("%23","g"),"#"):H}}Object(ia.a)(fd,"GetWopiInfoHelper",null,[575,4]);let Ld=class extends fd{constructor(H,ha){super(ha);this.eXg=!0;this.yPf=!1;this.Nae=zd=>{super.Myj(zd)?this.YOg():this.lfh()};this.RYj=zd=>{xd.a(zd)?Z.ULS.sendTraceTag(507062090,0,10,"onGetChartBlobDataSuccess - Webservice call getObserverChartFromHostAndInsert failed with non-ignorable errors"):(zd=zd.Result)?(zd=this.$.qa.getItemByName(zd.SheetName),zd)?zd.visible&&(Z.ULS.sendTraceTag(507253891,0,50,"onGetChartBlobDataSuccess - change active sheet to the one with OCO"),
zd.activate({scenario:"EditLinkedChart"})):Z.ULS.sendTraceTag(507253892,0,15,"onGetChartBlobDataSuccess: Cannot find the sheet with observer chart on it."):Z.ULS.sendTraceTag(507253893,0,15,"onGetChartBlobDataSuccess - no OCO focus area available")};this.tr=(zd,be)=>{eb.a.hi(be.errors,[-1151687439])&&(Z.ULS.sendTraceTag(507101971,0,50,"onWebMethodError - receive lostHostConnectionOnOcoUpdate error from the WebMethodError event"),fb.a(this.$).Kd.Mpc([-1151687439]),this.eXg&&(zd=eb.a.Cd(1,2,2602,2603,
0,-1151687439,"lostHostConnectionOnOcoUpdate"),Gb.a(this.$).Zx([zd]),this.eXg=!1))};this.yPf=pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GetWopiFromGraphApi",!1);ha=cd.a.Zg(H.ta.ObserverChartHostDocumentUrl);const Ya=cd.a.Zg(H.ta.ObserverChartHostPKey),Wb=cd.a.Zg(H.ta.ObserverChartHostServiceUrl),Sc=cd.a.Zg(H.ta.ObserverChartHostWACCluster);ha||Ya||Wb||Sc?Z.ULS.sendTraceTag(507359235,0,10,`GetObserverChartFromHostAndInsertManager.ctor: One or more of the required URL params are empty,
         isObserverChartHostFileUrlEmpty: ${ha};
         isObserverChartHostPKeyEmpty: ${Ya};
         isObserverChartHostServiceUrlEmpty: ${Wb};
         isObserverChartHostWACClusterEmpty: ${Sc};`):(this.$=H,this.VRj=H.ta.ObserverChartHostDocumentUrl,pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditLinkedChartKeepSafe",!1)&&(Z.ULS.sendTraceTag(507101972,0,50,"constructor - Register to the WebMethodError event"),H.ma.yP(this.tr)),this.yPf?(Z.ULS.sendTraceTag(507025344,0,50,"GetObserverChartFromHostAndInsertManager - send web request to ECS server to get wopi info via graph API"),this.YOg()):(Z.ULS.sendTraceTag(507025315,0,
50,"GetObserverChartFromHostAndInsertManager - Register hostWopiInfoFromUrl event for PostMessage"),this.xpk(this.Nae),this.ard(this.VRj)))}YOg(){this.$.userOperationManager.enqueueOperation(new Fc.a(613,0,(H,ha,Ya)=>{var Wb=this.$.ma.sa,Sc=this.$.ta.ObserverChartHostPKey,zd=this.$.ta.ObserverChartHostWACCluster,be=this.$.ta.ObserverChartHostServiceUrl,oe=this.Vah,Ke=this.Tah,Xe=this.Uah,ig=this.$.ta.ObserverChartHostDocumentUrl;H=Ic.c(H,this.RYj);const Og=Wb.$a(1,null);Og.pKey=Sc;Og.hostServiceWACCluster=
zd;Og.hostServiceUrl=be;Og.wopiSrcUrl=oe;Og.wopiAccessToken=Ke;Og.wopiAccessTokenTTL=Xe;Og.hostDocumentUrl=ig;return se.h(Wb,"GetObserverChartFromHostAndInsert",Og,H,ha,Ya,null,0)},64),null)}lfh(){if(pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditLinkedChartKeepSafe",!1)){Z.ULS.sendTraceTag(507062089,0,50,"OnFailGetWopiInfo - Got invaid wopi info for the PPT file, prepare show the error dialog and close the session");const H=eb.a.Cd(1,0,2599,2600,0,-436512083,"lostHostConnectionOnOcoSessionLaunch");
Gb.a(this.$).Zx([H])}}};Ld=Object(Ac.__decorate)([Object(Sb.d)(kc.GetObserverChartFromHostAndInsertManagerService),Object(Ac.__param)(0,Object(kc.EwaControlService)()),Object(Ac.__param)(1,Object(kc.HostMessengerService)())],Ld);Object(ia.a)(Ld,"GetObserverChartFromHostAndInsertManager",fd,[]);class ce{constructor(H,ha,Ya){this.identifier=H;this.id=Ya}getId(){return this.id}}Object(ia.a)(ce,"WarmupServiceTask",null,[]);let me=class{constructor(H){this.en=!1;this.$=H}};me=Object(Ac.__decorate)([Object(Sb.d)(kc.WarmupSchedulerService),
Object(Ac.__param)(0,Object(kc.EwaControlService)())],me);Object(ia.a)(me,"WarmupScheduler",null,[]);const Oe=Object(kd.b)("Common.App.InProductMessaging.InProductMessagingUIManager"),Ye=Object(kd.c)(Oe),Ff=Object(kd.b)("Common.App.InProductMessaging.InProductMessagingActor"),ag=Object(kd.c)(Ff),ug=Object(kd.c)(Of.a),Xg=Object(kd.b)("Common.App.InProductMessaging.IDependencyDownloader"),rh=Object(kd.c)(Xg),Xh=Object(kd.b)("Common.IInProductMessagingUIWrapper"),ck=Object(kd.c)(Xh);var vi=a(469);class Mj extends vi.a{constructor(H){super(H)}get WJb(){return!1}createElement(){const H=
document.createElement("link");H.setAttribute("rel","stylesheet");H.setAttribute("type","text/css");H.setAttribute("href",this.Xy);return H}Yyd(){return null}qTc(){this.element.setAttribute("href","");this.element.setAttribute("href",this.zE.Xy)}}Object(ia.a)(Mj,"CssResource",vi.a,[]);var dk=a(664),Nj=a(340);class Li{constructor(){this.ihc=this.Vdc=null}gDj(){this.Vdc||(Z.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),this.Vdc=jb.Task.WAA(Li.nDj(),Li.cDj()),this.Vdc.continueWith(H=>
{Z.ULS.sendTraceTag(21030599,324,10,"{0}",cd.a.hLd(H.exception))},5));return this.Vdc}jDj(){if(!this.ihc)try{Z.ULS.sendTraceTag(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage"),this.ihc=jb.Task.WAA(Li.JDd(Nj.a.create(ta.AFrameworkApplication.ea.Qa("DimeUrl"),null,null))),this.ihc.continueWith(H=>{Z.ULS.sendTraceTag(39978391,324,10,"{0}",cd.a.hLd(H.exception))},5)}catch(H){Z.ULS.sendTraceTag(594874951,324,10,"{0}",cd.a.hLd(H))}return this.ihc}static nDj(){var H=Li.uBc("inproductmessaging.js");
H=Nj.a.create(H,null,null);return Li.JDd(H)}static cDj(){var H=Li.uBc("inproductmessaging.css");H=new Mj(H);return Li.JDd(H)}static uBc(H){return Ra.a.tJb(String.format("ipm/{0}",H))}static JDd(H){dk.a.usa(H);return H.Anb}}Object(ia.a)(Li,"DependencyDownloader",null,[599]);class Aj{}Aj.u9j="inProductMessagingOverlayDiv";Aj.Kbk="PlayButtonImage";Aj.rwk="ReplayButtonImage";Object(ia.a)(Aj,"Constants",null,[]);class dj{constructor(){this.BYe=this.PSe=this.CHe=!0;this.swk=this.Lbk=null;this.rOj=!1;this.locale=
null;this.w5g={}}get M9e(){return this.CHe}set M9e(H){this.CHe=H}get Cfg(){return this.PSe}set Cfg(H){this.PSe=H}get PWg(){return this.BYe}set PWg(H){(this.BYe=H)&&this.MLk()}MLk(){this.E3e(Aj.Kbk,this.Lbk);this.E3e(Aj.rwk,this.swk)}E3e(H,ha){ha&&(this.w5g[H]=ha)}}Object(ia.a)(dj,"FirstRunExperienceUISettings",null,[597]);class xh{constructor(){this.completed=this.Ppk=!1}}Object(ia.a)(xh,"FirstRunExperienceViewData",null,[595]);var kk=a(214);class Fk{constructor(H,ha,Ya){this.rCi=(Wb,Sc,zd,be,oe)=>
{2===zd&&this.Iec.sBj(oe);return 32};this.Ugi=(Wb,Sc,zd,be,oe)=>{2===zd&&this.Iec.lBj(oe);return 32};this.rej=(Wb,Sc,zd)=>2===zd?this.Iec.f6d():32;this.qej=(Wb,Sc,zd)=>2===zd?this.Iec.c6d():32;this.pb=H;this.dh=ha;this.Iec=Ya}wi(){this.pb.ef(yb.a.tCi,wh.a.frame,this.rCi,64);this.pb.jc(yb.a.dCf,wh.a.frame,this.rej);this.pb.jc(yb.a.cCf,wh.a.frame,this.qej);this.pb.jc(yb.a.Tgi,wh.a.frame,this.Ugi);this.pb.jc(yb.a.RIg,wh.a.frame,kk.ActionManager.Lg);this.pb.jc(yb.a.Twk,wh.a.frame,kk.ActionManager.Lg);
this.pb.jc(yb.a.Uwk,wh.a.frame,kk.ActionManager.Lg);this.dh&&this.dh.ax()}}Object(ia.a)(Fk,"InProductMessagingActor",null,[]);class Gk{constructor(){this.nFg=this.FKg=this.m1g=this.bKc=this.instance=null}}Object(ia.a)(Gk,"DimeExperienceUISettings",null,[]);var Hk=a(540);class Ik{constructor(H,ha,Ya,Wb,Sc){this.eyc=!1;this.GLb=null;this.pb=H;this.ARa=ha;this.Khc=Ya;this.fM=Wb;this.h7c=Sc}Nhj(H){cg.b("getHeaderApi")?(H.R5f()&&appChrome.getHeaderApi().then(ha=>{ha.updateAnonymousStatus(!0);return null}),
H.isFeatureEnabled("MsoPremiumBadge",!0).then(ha=>{const Ya=H.isFreemiumUpsellEnabled();Ya&&(appChrome.getHeaderApi().then(Wb=>{Wb.updatePremiumStatus(ha,Ya);return null}),H.oLa("MsoPremiumBadge",Wb=>{appChrome.getHeaderApi().then(Sc=>{Sc.updatePremiumStatus(Wb.isEnabled,Ya);return null})}));return null})):Z.ULS.sendTraceTag(593859840,324,10,"getHeaderApi not available")}sBj(H){this.Khc.gDj().continueWith(()=>{this.ARa.EXk(H)})}lBj(H){let ha="gopremium",Ya=null,Wb=()=>{};H?(H.experience&&""!==Object(tc.a)(String,
H.experience)&&(ha=Object(tc.a)(String,H.experience)),H.onTaskComplete&&(Wb=H.onTaskComplete),H.campaignId&&""!==Object(tc.a)(String,H.campaignId)&&(Ya=Object(tc.a)(String,H.campaignId))):Z.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");this.F1d(ha,Wb,Ya)}F1d(H,ha,Ya){Ya=void 0===Ya?null:Ya;if(this.eyc&&this.GLb){const Wb={};Wb.experience=H||"gopremium";Wb.campaignId=Ya||Hk.b(this.fM,this.h7c,Object(tc.a)(String,Wb.experience),!0);this.pb.hf(yb.a.RIg,2);Z.ULS.sendTraceTag(51675403,
324,50,"Launching Freemium Upsell dialog: "+Wb.experience);try{const Sc=Object.assign(new Gk,{instance:this.GLb,bKc:Wb,m1g:ha||(()=>{}),FKg:zd=>{Z.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+zd.status)},nFg:()=>{Z.ULS.sendTraceTag(51675406,324,10,"Dime launch error");this.eyc=!1;this.GLb=null}});this.ARa.pVk(Sc)}catch(Sc){Z.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+Sc.message),this.eyc=!1,this.GLb=null,this.pb.pe(yb.a.AOb,2,{["experience"]:Wb.experience})}}else Z.ULS.sendTraceTag(39978392,
324,10,"FreemiumUpsellDialogDependencies not loaded"),this.pb.pe(yb.a.AOb,2,{["experience"]:H})}m2d(){this.Khc.jDj().continueWith(()=>{try{var H=cd.a.wm(ta.AFrameworkApplication.uiCulture);const Wb=Hk.c(this.fM);if(Wb){var ha={};ha.partnerId=Wb;ha.language=H;ha.sessionId=ta.AFrameworkApplication.userSessionId;ha.authHint=ta.AFrameworkApplication.ea.Qa("UserPrincipalName");var Ya=ta.AFrameworkApplication.ea.Qa("Puid")||"";""!==Ya&&(H={},H.puid=Ya,ha.userInfo=H);this.GLb=new Dime(ha);this.eyc=!0;Z.ULS.sendTraceTag(592721856,
324,50,"Dime initialized")}else Z.ULS.sendTraceTag(51675409,324,15,"App not supported")}catch(Wb){Z.ULS.sendTraceTag(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+Wb.message)}},3)}f6d(){return this.ARa.f6d()}c6d(){return this.ARa.c6d()}}Object(ia.a)(Ik,"InProductMessagingUIManager",null,[598]);class $g{constructor(){this.i_e=0;this.w$a=Array(5);this.w$a[0]=10;this.w$a[1]=15;this.w$a[2]=50;this.w$a[3]=100;this.w$a[4]=200}Init(H){this.i_e=H}SendTrace(H,ha){Z.ULS.sendTraceTag(34182235,
this.i_e,this.w$a[H],"{0}",ha)}}Object(ia.a)($g,"DefaultNetworkingManager",null,[646]);var Hl=a(331);class Jk{constructor(H){this.kd=H}EXk(H){H&&(InProductMessaging.Networking.NetworkingMgr=new $g,InProductMessaging.Networking.NetworkingMgr.Init(387),InProductMessaging.Init(H.PWg,H.Cfg,H.M9e,H.rOj,H.locale,Object(fc.a)(this,this.JWj,"onDismissFirstRunExperience"),H.w5g),this.p5a(Aj.u9j,!0))}pVk(H){if(H&&H.instance&&H.bKc){let ha=document.getElementById("wacDimeContainer");ha||(ha=document.createElement("div"),
ha.id="wacDimeContainer",document.body.appendChild(ha));ta.AFrameworkApplication.ea.ka("DimeFocusManagerIsEnabled")&&this.p5a("wacDimeContainer",!1);H.bKc.parentElementId="wacDimeContainer";H.instance.launch(H.bKc,H.m1g).then(Ya=>{this.b3b();document.body.removeChild(ha);H.FKg(Ya)}).catch(Ya=>{this.b3b();document.body.removeChild(ha);H.nFg(Ya)})}else throw Error.argument("DimeExperienceUISettings");}p5a(H,ha){if(this.kd&&H&&(H=document.getElementById(H),this.Bhj(H),H=this.kd.lY("InProductMessagingFocusId"))){const Ya=
this.kd.currentScope;Ya&&"InProductMessagingFocusId"===Ya.name||this.kd.H3("InProductMessagingFocusId",!1);ha&&this.wDg(H.scope)}}Bhj(H){var ha=!1;ha=void 0===ha?!0:ha;const Ya=this.kd.ql("InProductMessagingFocusId");Ya.parent=ve.AFrame.p0;const Wb=new Hl.DOMFocusListing(()=>H);Wb.V2b=ha;Wb.Lr(3);Wb.Lr(2);Wb.Lr(4);ha=this.kd.jTa(()=>H,Ya,Wb);ha.tTc();ha.Lda=!0;ha.Leb=!0}wDg(H){H.$w(Rd.FocusManager.instance().waa);H.$w(Rd.FocusManager.instance().xaa);H.bindAction(Rd.FocusManager.instance().waa,yb.a.dCf);
H.bindAction(Rd.FocusManager.instance().xaa,yb.a.cCf)}b3b(){this.kd&&(this.kd.uea("InProductMessagingFocusId"),this.kd.X3a("InProductMessagingFocusId"))}JWj(H,ha){this.b3b();H=Object.assign(new xh,{completed:H,Ppk:ha});ta.AFrameworkApplication.Kb.pe(yb.a.qCi,2,H)}f6d(){const H=document.activeElement,ha=this.kd.fY();return H&&ha&&ha.Li&&H===ha.Li.fB?(ha.Li.HB(H),ha.YYb()?32:8):4}c6d(){const H=document.activeElement,ha=this.kd.fY();return H&&ha&&ha.Li&&H===ha.Li.dI?(ha.Li.HB(H),ha.uob()?32:8):4}}Object(ia.a)(Jk,
"InProductMessagingUIWrapper",null,[596]);class sk{constructor(){this.oc=null}get name(){return"Common.App.InProductMessaging"}ji(H){H.register(Li,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").Lc().Qc(()=>new Li);H.register(Jk,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").Lc().Qc(()=>new Jk(Rd.FocusManager.instance()));H.register(Ik,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").Lc().Qc(()=>
new Ik(ta.AFrameworkApplication.Kb,Object(kd.a)(ck),Object(kd.a)(rh),ta.AFrameworkApplication.ua.Ab.gi,ta.AFrameworkApplication.ua.Ab.rwa));H.register(Fk,"Common.App.InProductMessaging.InProductMessagingActor").Lc().Qc(()=>new Fk(ta.AFrameworkApplication.Kb,ta.AFrameworkApplication.ua,Object(kd.a)(ug)));H.register(dj,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").Lc().Qc(()=>new dj);H.register(xh,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").Lc().Qc(()=>
new xh);this.oc=H}init(){Object(kd.a)(ag).wi();ta.AFrameworkApplication.ea.hr(()=>{ta.AFrameworkApplication.ua.Ab.ms&&fg.a.get_instance().Mg(15,()=>{Object(kd.d)(Sf.a).execute(H=>{Object(kd.a)(Ye).Nhj(H)})});ta.AFrameworkApplication.ea.ka("FreemiumUpsellShowDialogIsEnabled")&&Hk.a()&&1!==ta.AFrameworkApplication.ua.Ab.gi&&Object(kd.d)(Sf.a).execute(H=>{H.isFeatureEnabled("MsoPremiumBadge",!0).then(ha=>{!ha&&H.isFreemiumUpsellEnabled()&&Object(kd.a)(Ye).m2d();return null})})})}dispose(){}static main(){Pe.a.instance.Qi(new sk)}}
Object(ia.a)(sk,"InProductMessagingPackage",null,[11,12]);var il=a(663);class jl{constructor(H,ha,Ya,Wb,Sc){this.BXa=zd=>{let be=!1,oe=null;try{if(0<zd.data.responseData.length){const Ke=Object(tc.a)(Object,Pd.a(zd.data.responseData)),Xe=Ke?Ke[this.wA.gqd]:null;Xe&&(oe=Object(tc.a)(Object,Pd.a(Xe.toString())))}be=!0}catch(Ke){this.Kta(null)}be&&this.BAb&&this.BAb(zd.data,oe)};this.Kta=zd=>{this.xAb&&this.xAb(zd?zd.data:null)};this.udk=zd=>{this.rVe&&this.rVe(zd?zd.data:null)};this.axa=zd=>{this.NCb&&
this.NCb(zd?zd.data:null)};this.wA=H;this.BAb=ha;this.xAb=Ya;this.rVe=void 0===Wb?null:Wb;this.NCb=void 0===Sc?null:Sc}JFd(H){const ha=new Sys.StringBuilder(this.wA.J4b);ha.append("RoamingServiceHandler.ashx?action=");ha.append("getFirstRunExperienceSettings");ha.append("&");ha.append(this.JNd(H));ha.append("&");ha.append(ta.AFrameworkApplication.Uh);ta.AFrameworkApplication.od.Wn(ha.toString(),1,null,null,!0,2,this.BXa,this.Kta,null)}vwc(H){var ha=new Sys.StringBuilder(this.wA.J4b);ha.append("RoamingServiceHandler.ashx?action=");
ha.append("saveFirstRunExperienceSettings");ha.append("&");ha.append(ta.AFrameworkApplication.Uh);ha=ha.toString();H=Pd.c(H);ta.AFrameworkApplication.od.Wn(ha,2,H,null,!0,4,this.udk,this.axa,null)}JNd(H){const ha=new Sys.StringBuilder("requestedsettings=");for(let Ya=0;Ya<H.count;Ya++)ha.append(H.pa(Ya)),Ya<H.count-1&&ha.append(";");return ha.toString()}}Object(ia.a)(jl,"FirstRunExperienceRequestHandler",null,[]);var Il=a(248);class tk{constructor(){this.oAb=this.Wdc=this.wA=null;this.BXa=(H,ha)=>
{H=H?+H.I6-+H.KK:-1;H>this.wA.KLg?Z.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",H,this.wA.KLg):ha?this.UTk(ha)?(Z.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.wA.ufg),this.Xse()):(this.cCd(!1),Z.ULS.sendTraceTag(51675537,306,
100,"Current user has already seen this version of the FRE. No further action required.")):(Z.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.Xse())};this.Kta=H=>{this.cCd(!1);Z.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",H?H.httpStatus:-1)};this.axa=H=>{Z.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",
H?H.httpStatus:-1)};this.SXj=H=>{if(H){var ha=H.detail;H=H.type;var Ya=this.wA&&this.wA.campaignId?this.wA.campaignId.split("-")[0]:null;if("FRELaunchedEvent"===H||Ya&&ha&&ha.id&&-1!==ha.id.indexOf(Ya)){if("FRELaunchedEvent"===H||ha&&ha.success)Z.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.aNg(this.wA.currentVersion);window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.oAb,!0),window.removeEventListener("FRELaunchedEvent",
this.oAb,!0))}}}}Wse(H){H?(this.wA=H,this.ktj()&&(Z.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),H=new na.a,H.add(this.wA.gqd),this.Wdc=new jl(this.wA,this.BXa,this.Kta,null,this.axa),this.Wdc.JFd(H)),(this.wA.xmb||ta.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.Xse()):Z.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}ktj(){try{if(this.wA.xmb)return!0;
if(!ta.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||ta.AFrameworkApplication.ea.ka("IsAnonymousUser"))return!1;if(this.wA.Noj||this.wA.$_a||ta.AFrameworkApplication.ea.ka("IsO365ConsumerHost"))return!0;const H=ta.AFrameworkApplication.ea.Qa("FlightId");return-1!==(H?H.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(H){Z.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",H?H.toString():null)}return!1}aNg(H){const ha=
{},Ya={};Ya.FREDisplayedDate=(new Date).toUTCString();Ya.VersionDisplayed=H;Ya.RemindMeLater=!1;ha[this.wA.gqd]=Pd.c(Ya);Z.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.Wdc&&this.Wdc.vwc(ha)}Xse(){this.cCd(!0);var H=Object(kd.f)(il.a);H?this.yWg(H):(Z.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),ta.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",
!0)&&((H=Object(kd.d)(il.a))?H.execute(ha=>{this.yWg(ha)}):Z.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}yWg(H){if(H){var ha=this.wA.ECi;ha&&Dd.a.UN(ha);Z.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",ha);H.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.oAb=this.SXj,window.addEventListener("FGWebSurfaceEvent",this.oAb,!0),window.addEventListener("FRELaunchedEvent",this.oAb,
!0)):(Z.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.aNg(this.wA.currentVersion))}else Z.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}UTk(H){if("RemindMeLater"in H&&"FREDisplayedDate"in H){if("true"===H.RemindMeLater.toString()&&(+new Date-+new Date(H.FREDisplayedDate.toString()))/36E5>this.wA.ufg)return!0}else if(ta.AFrameworkApplication.ea.ka("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in H&&H.VersionDisplayed<this.wA.currentVersion)return Z.ULS.sendTraceTag(528262853,
306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}cCd(H){ta.AFrameworkApplication.ea.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&Il.a.dispatch("FREDecisionEvent",{["show"]:H})}}Object(ia.a)(tk,"FirstRunExperienceLauncher",null,[577]);class uk{constructor(){this.oc=null}get name(){return"Common.App.FirstRunExperienceLauncher"}ji(H){this.oc=H;this.oc.register(577,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").Lc().Qc(()=>
new tk)}init(){}dispose(){}static main(){Pe.a.instance.Qi(new uk)}}Object(ia.a)(uk,"FirstRunExperienceLauncherPackage",null,[11,12]);var pj=a(9);class Kk extends Pg.a{constructor(H){super();this.$=H;this.ri()}create(){const H=Object(Qg.a)(this.$.ra,311,()=>new ie(this.$));this.Uf(H)}static Ea(H){H.ra.zc(312,new Kk(H))}}Object(ia.a)(Kk,"FirstRunExperienceManagerFactory",Pg.a,[]);var vk=a(630),Lk=a(679);class Mk extends vk.a{constructor(H){super(1);this.Moa=!1;this.ckg=()=>{this.refresh()};this.dkg=
()=>{this.refresh()};this.da=Hd.f(H);this.da.Rb.Jp(this.dkg);this.da.Rb.Uq(this.ckg);this.refresh()}get YN(){return this.ULc(this.Moa)}fqe(H){this.Moa!==H&&(this.Moa=H,this.g2b())}get name(){return Lk.a.cellEdit}dispose(){this.da.Rb.zp(this.dkg);this.da.Rb.gq(this.ckg);this.da=null;super.dispose()}g2b(){this.ufe(this.Moa)}refresh(){this.fqe(!this.da.isEditing)}}Object(ia.a)(Mk,"CellEditSafeStatePublisher",vk.a,[]);class Mi{constructor(H,ha){this.handler=null;this.Vee=H;this.YN=ha}}Object(ia.a)(Mi,
"SafeStatePublisherState",null,[]);var Nk=a(749);const Zj=H=>H?`${H.Current} / ${H.Pending} @${H.SuspensionStartTimestamp}`:null,Pj=H=>(null===H||void 0===H?void 0:H.SuspensionStartTimestamp)&&H.Pending>H.Current;class Ih extends kb.a{constructor(H,ha){super();this.q8f=null;this.BJc=!1;this.G_b=(Ya,Wb)=>{3===Wb.hfg&&this.BJc&&Z.ULS.sendTraceTag(520480204,0,15,"ClientStateMonitor.onMergeDidntOccur: Aborted merge occurred after another aborted merge.");this.BJc=!0;this.k2b()};this.SLa=[];this.nob=H;
this.Uwa=ha;if(this.fUb=pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",!1))this.Uwa.Ubb(this.gKa.bind(this)),this.nob.B4e(this.G_b)}get Ral(){return this.SLa.filter(H=>0!==H.YN).map(H=>H.Vee.name)}Jlc(H){this.addHandler(Ih.J4a,H)}oUc(H){this.removeHandler(Ih.J4a,H)}qLa(H,ha){const Ya=new Mi(H,ha);this.SLa.push(Ya);ha=(Wb,Sc)=>{Ya.YN=Sc.YN;this.k2b()};H.Jlc(ha);Ya.handler=ha;this.k2b()}pze(H){let ha=null;for(const Ya of this.SLa)if(Ya.Vee===H){this.G6g(Ya);ha=
Ya;break}ha&&(H=this.SLa.indexOf(ha),-1!==H&&this.SLa.splice(H,1),this.k2b())}dispose(){for(const H of this.SLa)this.G6g(H);this.SLa=[];this.fUb&&(this.Uwa.jsb(this.gKa.bind(this)),this.nob.tHg(this.G_b));super.dispose()}Eyc(){const H=nl.Eyc(this.SLa.map(ha=>ha.YN));return this.BJc&&1===H?2:H}G6g(H){H.Vee.oUc(H.handler)}k2b(){const H=this.Eyc();H!==this.q8f&&(this.raiseEvent(Ih.J4a,new Nk.a(H)),this.q8f=H)}gKa(H,ha){H=ha.nla;(ha=!Pj(H))||(ha=this.IAj,ha=(null===H||void 0===H?void 0:H.SuspensionStartTimestamp)!==
(null===ha||void 0===ha?void 0:ha.SuspensionStartTimestamp));ha&&(this.BJc=!1);this.IAj=H;this.k2b()}}Ih.J4a="SSC";Object(ia.a)(Ih,"ClientStateMonitor",kb.a,[]);class ek extends vk.a{constructor(H,ha){ha=void 0===ha?null:ha;super(1);this.Moa=!1;this.f3=()=>{this.refresh()};this.jlg=()=>{this.refresh()};this.$=H;this.NNe=ha||fb.a(H).N1(Rb.a.idle);fb.a(H).jod(this.jlg);this.ikb.Js(this.f3);this.refresh()}get YN(){return this.ULc(this.Moa)}fqe(H){H!==this.Moa&&(this.Moa=H,this.g2b())}get name(){return Lk.a.ikb}get ikb(){return this.NNe}dispose(){fb.a(this.$).VTc(this.jlg);
this.ikb.vs(this.f3);this.NNe=null;super.dispose()}g2b(){this.ufe(this.Moa)}refresh(){this.fqe(1===this.ikb.yz||fb.a(this.$).ek===this.ikb)}}Object(ia.a)(ek,"IdleActivitySafeStatePublisher",vk.a,[]);class ak extends Vd.a{constructor(){super()}gd(){return!1}executeCommand(){return jb.Task.Va(!0)}Rc(H,ha){return 1905775613===ha.command}td(){return!1}}Object(ia.a)(ak,"ToggleMergeSuspensionSafeState",Vd.a,[29]);class Uj extends kb.a{constructor(H,ha){super();this.statusBarManager=null;this.j7d=!1;this.gKa=
(Ya,Wb)=>{Ya=`${Wb.nla.Current===Wb.nla.Pending?"\u26ad":"\u26ae"}${Wb.nla.Current}`;Kb.a.equals(this.zMc,Ya,!1)||(this.zMc=Ya,this.Yp())};this.m2a=(Ya,Wb)=>{Ya=0==Wb.YN;this.j7d!==Ya&&(this.j7d=Ya,this.Yp())};this.mergeSuspensionManager=ha;this.mergeSuspensionManager.Uwa.Ubb(this.gKa);this.zMc="";Ri.a.xha(1905775613,wi.a.Ac,0,1);this.Ia=H.Ia;this.v9b=new ak;H.ra.Vc(29,Ya=>{this.mergeSuspensionManager&&(this.statusBarManager=Ya,Ya.FJ(this),this.mergeSuspensionManager.ora.Jlc(this.m2a))});this.Ia.yha(this.v9b)}Js(H){this.addHandler(Uj.H5d,
H)}vs(H){this.removeHandler(Uj.H5d,H)}Yp(){this.raiseEvent(Uj.H5d)}Wj(H){return H===Uj.thk&&!!this.mergeSuspensionManager}vq(H,ha){if(!this.Wj(H))return!1;this.mergeSuspensionManager&&(ha.LabelText=this.zMc,ha.On=this.j7d);return!0}dispose(){this.v9b&&(this.Ia.bsb(this.v9b),this.v9b.dispose(),this.v9b=null);this.mergeSuspensionManager&&(this.mergeSuspensionManager.Uwa.jsb(this.gKa),this.mergeSuspensionManager.ora.oUc(this.m2a),this.mergeSuspensionManager=null);this.statusBarManager&&(this.statusBarManager.OI(this),
this.statusBarManager=null);this.zMc=null;super.dispose()}}Uj.H5d="MSMSC";Uj.thk="QueryMergeSuspensionStatus";Object(ia.a)(Uj,"MergeSuspensionIndicatorManager",kb.a,[360,217,4]);var wk=a(1110);class kl extends Sys.EventArgs{constructor(H){super();this.nIa=H}}Object(ia.a)(kl,"TogglePendingMergeBlockedByClientEventArgs",Sys.EventArgs,[]);class Jj{}Object(ia.a)(Jj,"SuspensionState",null,[]);class bk extends Jj{constructor(H){super();this.n6e=!1;this.n6e=H}}Object(ia.a)(bk,"ReadyForPendingMergeState",
Jj,[]);const fk=new Jj,lk=new Jj,Ok=new bk(!1),am=new bk(!0);var Pk=a(1109);class ll extends Pk.a{constructor(H,ha,Ya){super(H);this.xIh=ha;this.GYk=Ya}}Object(ia.a)(ll,"ReadyForPendingMergesUpdatedEventArgs",Pk.a,[]);class ej extends kb.a{constructor(H,ha,Ya){super();this.gKa=(Wb,Sc)=>{Wb=this.getState();const zd=this.O8;this.O8=Sc.nla;Sc=this.getState();this.uGj(Wb,Sc,zd);this.raiseEvent(ej.D5d);this.RBf(Wb,Sc)};this.m2a=(Wb,Sc)=>{Wb=this.getState();this.YN=Sc.YN;Sc=this.getState();this.RBf(Wb,
Sc)};this.G_b=(Wb,Sc)=>{4===Sc.hfg&&(Z.ULS.sendTraceTag(520480203,0,50,"MergeSuspensionStateHandler.onMergeDidntOccur: Retry DoPendingMerge after bailout. Current merge counter: {0}, Response merge counter: {1}",Zj(this.O8),Zj(Sc.O8)),this.ZBg(this.getState(),!0))};this.fUb=pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",!1);this.ora=H;this.ora.Jlc(this.m2a);this.Uwa=ha;this.Uwa.Ubb(this.gKa);this.nob=Ya;this.nob.B4e(this.G_b);this.O8=Object(ec.a)(new wk.a,{Pending:0,
Current:0,SuspensionStartTimestamp:null});this.YN=this.Nfj()}Nfj(){return Object(nb.a)(Ih,this.ora)?Object(tc.a)(Ih,this.ora).Eyc():1}Nlc(H){this.addHandler(ej.wxe,H)}rUc(H){this.removeHandler(ej.wxe,H)}JFh(H){this.addHandler(ej.dge,H)}quk(H){this.removeHandler(ej.dge,H)}SEh(H){this.addHandler(ej.D5d,H)}Jtk(H){this.removeHandler(ej.D5d,H)}yjk(){this.rfe(this.getState()===lk)}dispose(){this.ora.oUc(this.m2a);this.ora=null;this.Uwa.jsb(this.gKa);this.Uwa=null;this.nob.tHg(this.G_b);this.nob=null;super.dispose()}IMd(){return Object(ec.a)(new wk.a,
{Current:this.O8.Current,Pending:this.O8.Pending,SuspensionStartTimestamp:this.O8.SuspensionStartTimestamp})}getState(){return Pj(this.O8)?0==this.YN?am:this.fUb&&1==this.YN?Ok:lk:fk}RBf(H,ha){H!==ha&&(ha===lk?this.rfe(!0):H===lk&&this.rfe(!1));this.ZBg(ha)}ZBg(H,ha){H instanceof bk&&this.raiseEvent(ej.dge,new ll(this.O8,H.n6e||!this.fUb,void 0===ha?!1:ha))}uGj(H,ha,Ya){H===fk&&ha!==fk?(H=ha===lk,ha=ha===Ok,Z.ULS.sendTraceTag(252760283,0,50,`MergeSuspensionStateHandler.LogPendingMergesStatusChanged: Pending changes exist. IsBlocking: ${ha} publisher: ${ha||
H?this.ora.Ral.join(","):""} counter: ${Zj(this.O8)} isBlockingAllMerges: ${H}`)):H!==fk&&ha===fk&&Z.ULS.sendTraceTag(252760284,0,50,`MergeSuspensionStateHandler.LogPendingMergesStatusChanged: No pending changes. counter: ${Zj(Ya)}`)}rfe(H){this.raiseEvent(ej.wxe,new kl(H))}}ej.wxe="TPMBBC";ej.dge="RFPMU";ej.D5d="MCC";Object(ia.a)(ej,"MergeSuspensionStateHandler",kb.a,[]);class vj extends kb.a{constructor(H){super();this.faa=null;this.AJc=0;this.MYb=(ha,Ya)=>{(null===Ya||void 0===Ya?0:Ya.nla)&&this.e2a(Ya.nla,
vj.rCe)};this.hXc=()=>{this.pKg();this.NBg(this.faa,vj.yyk)};this.s9d=(ha,Ya)=>{Ya.committed&&this.faa.SuspensionStartTimestamp&&Z.ULS.sendTraceTag(17318084,0,50,`PendingMergeMonitor.OnEditCellEnded: committed with counter ${Zj(this.faa)}`)};this.pKg();this.$=H;this.$.fa.Vk(this.hXc);this.$.fa.LJ(this.hXc);Hd.f(this.$).Rb.Uq(this.s9d);this.$.ra.Vc(292,ha=>{ha.Ubb(this.MYb);Z.ULS.sendTraceTag(588276809,0,50,"PendingMergeMonitor initialized")})}Ubb(H){this.addHandler("MCU",H)}jsb(H){this.removeHandler("MCU",
H)}get O8(){return this.faa}e2a(H,ha){ha=void 0===ha?"":ha;const Ya=this.faa.Current<H.Current||this.faa.Pending<H.Pending;if(H.SuspensionStartTimestamp&&this.AJc!==H.SuspensionStartTimestamp){if(this.AJc>H.SuspensionStartTimestamp){Ya&&Z.ULS.sendTraceTag(553736149,0,50,`PendingMergeMonitor.OnMergeCounterReceivedFromServer: skipping a higher stale counter received via ${ha}. S: ${vj.LYb(H)}, C: ${vj.LYb(this.faa)}`);return}Ya||Z.ULS.sendTraceTag(553736148,0,50,`PendingMergeMonitor.OnMergeCounterReceivedFromServer: recovering from a potentially stale counter. S: ${vj.LYb(H)}, C: ${vj.LYb(this.faa)}`)}else if(!Ya)return;
this.faa=H;this.NBg(H,ha)}dispose(){this.$.fa.Qk(this.hXc);this.$.fa.zL(this.hXc);Hd.f(this.$).Rb.gq(this.s9d);const H=this.$.ra.Tb(292);H&&H.jsb(this.MYb);super.dispose()}NBg(H,ha){ha=void 0===ha?"":ha;Pj(H)&&H.SuspensionStartTimestamp>this.AJc&&(Z.ULS.sendTraceTag(537155416,0,50,`PendingMergeMonitor.RaiseMergeCounterUpdated: Merge suspension requested. MergeCounter: ${Zj(H)}, Origin: ${ha}`),this.AJc=H.SuspensionStartTimestamp);this.raiseEvent("MCU",new Pk.a(H))}pKg(){Z.ULS.sendTraceTag(588276808,
0,50,`PendingMergeMonitor.ResetMergeCounter : Last counter was ${vj.LYb(this.faa)}`);this.faa=Object(ec.a)(new wk.a,{Pending:0,Current:0,SuspensionStartTimestamp:null})}static LYb(H){return H?`(${H.Current}/${H.Pending} @${H.SuspensionStartTimestamp})`:"null"}}vj.rCe="PMM.RTC";vj.Fuc="PMM.EwaResult";vj.yyk="PMM.resetMergeCounter";Object(ia.a)(vj,"PendingMergeMonitor",kb.a,[]);class Qk{}Object(ia.a)(Qk,"ClientRevisions",null,[]);const bm=(H,ha,Ya,Wb,Sc,zd,be)=>{be=H.$a(1,void 0===be?null:be);be.suspensionStartTimestamp=
ha;return se.h(H,"KeepBlockingPendingMerges",be,Ya,Wb,Sc,zd,0)};class gk extends kb.a{constructor(H,ha,Ya,Wb){super();this.lVa=null;this.GWb=0;this.HWb=this.Pmb=null;this.lrg=(Sc,zd)=>{this.lVa.mMh(zd.nla,zd.xIh,zd.GYk)};this.j0b=(Sc,zd)=>{zd.nIa?this.N_k():this.A_c()};this.qpg=()=>{this.GWb=0};this.bPg=()=>{const Sc=this.Rda.IMd();bm(this.sa,null!=Sc.SuspensionStartTimestamp?Sc.SuspensionStartTimestamp:0,null,()=>{this.M0j(Sc)},null,null,this.sa.mc())};this.aOa=(Sc,zd)=>{if(zd){zd.gGb.MergeCount=
this.Rda.IMd();const {min:be,max:oe}=Hd.f(this.$).aMj();pd.EwaSettings.isChangeGateEnabled("OfficeVSO:5524817_LogOnMergeRaceCondition2")?zd.gGb.ClientRevisions=Object(ec.a)(new Qk,{Min:be,Max:oe,MaxFromBlockCache:Hd.f(this.$).za.Deg}):zd.gGb.ClientRevisions=Object(ec.a)(new Qk,{Min:be,Max:oe})}};this.$=H;this.Jcb=Ya;this.Rda=ha;this.Rda.JFh(this.lrg);this.Rda.Nlc(this.j0b);this.Rda.SEh(this.qpg);this.$.ma.WFb(this.aOa);this.sa=this.$.ma.sa;this.yke=this.$.ta.MergeSuspensionRequestThrottlingTimeInMs;
this.bAj=this.$.ta.KeepBlockingPendingMergesRequestIntervalMs;this.lVa=Wb;Z.ULS.sendTraceTag(588276807,0,50,"RequestController initialized")}dispose(){this.$.ma.M3b(this.aOa);this.A_c();this.Rda.quk(this.lrg);this.Rda.rUc(this.j0b);this.Rda.Jtk(this.qpg);this.Rda=null;super.dispose()}N_k(){this.A_c();if(this.Zof()){const H=this.Rda.IMd();Z.ULS.sendTraceTag(537155414,0,50,`RequestController.StartKeepBlockingPendingMergesTimer: Prevented starting StartKeepBlockingPendingMergesTimer because of repeated failure in counter ${Zj(H)} fail count: ${this.GWb}`)}else this.HWb=
this.Jcb.create(this.bPg,this.yke,fe.a.HWb),this.Pmb=this.Jcb.fK(this.bPg,this.bAj,fe.a.Pmb)}A_c(){this.Pmb&&(this.HWb.cancel(),this.Pmb.cancel(),this.Pmb=this.HWb=null)}M0j(H){let ha;ha=" fail count: "+this.GWb;this.GWb++;this.Zof()&&this.A_c();Z.ULS.sendTraceTag(542229773,0,10,`RequestController.OnKeepBlockingPendingMergesRequestFailed: request failed ${Zj(H)}${ha}`)}Zof(){return this.GWb>gk.FKj}}gk.FKj=5;Object(ia.a)(gk,"RequestController",kb.a,[]);class Jl extends Sys.EventArgs{constructor(H,
ha){super();this.hfg=H;this.O8=ha}}Object(ia.a)(Jl,"MergeDidntOccurEventArgs",Sys.EventArgs,[]);class hk extends kb.a{get bZa(){return 0<this.Qae}constructor(H,ha,Ya,Wb,Sc){Ya=void 0===Ya?null:Ya;Wb=void 0===Wb?null:Wb;Sc=void 0===Sc?null:Sc;super();this.zJc=null;this.Qae=0;this.documentVisibilityObserver=null;this.C7f=!1;this.SLc=null;this.sa=H;this.yke=ha.ta.MergeSuspensionRequestThrottlingTimeInMs;const zd=ha.ta.GetRangeContentPrefetchDelayForMergeInMs;this.Qw=()=>{ha.GNg(zd)};this.vj=Ya||Pc.a.zb;
this.W9g=0;this.bS=Wb;this.$La=Sc;pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void Sb.a.resolve(kc.DocumentVisibilityObserverService).then(be=>{this.documentVisibilityObserver=be}):ha.ra.Vc(291,be=>{this.documentVisibilityObserver=be})}B4e(H){this.addHandler(hk.E5d,H)}tHg(H){this.removeHandler(hk.E5d,H)}get isDocumentHidden(){return!!this.documentVisibilityObserver&&this.documentVisibilityObserver.isHidden}mMh(H,ha,Ya){this.g7b(H,ha,void 0===
Ya?!1:Ya)?(new Cc.a).setResult(!0):(ha=this.Jak(H,ha),this.zJc=H,this.Qae++,ha.continueWith(()=>{this.NWj()},0,Wi.a.none,this.bS))}Jak(H,ha){this.W9g=this.vj.Qna;this.C7f=ha;Z.ULS.sendTraceTag(554767493,0,50,`DoPendingMergeSender.performDoPendingMergeInternal: Sending DoPendingMerge ${H.Current} / ${H.Pending} @${H.SuspensionStartTimestamp}. allowSelectionAdjustment: ${ha}`);this.isDocumentHidden||this.Qw();return this.JFk(ha,H)}g7b(H,ha,Ya){Ya=void 0===Ya?!1:Ya;if(this.$La&&!ha&&!this.$La.mxj())return Z.ULS.sendTraceTag(523317956,
0,50,"DoPendingMergeSender.shouldThrottle: We can't retrieve selection and selection adjustments are disallowed."),!0;if(!this.zJc||H.SuspensionStartTimestamp>this.zJc.SuspensionStartTimestamp)return this.bZa&&Z.ULS.sendTraceTag(523551556,0,50,`DoPendingMergeSender.shouldThrottle: Allowing request for new suspension while previous is ongoing, new counter: ${H.Current} / ${H.Pending} @${H.SuspensionStartTimestamp}`),!1;if(this.bZa)return!0;if(Ya)return!1;Ya=this.zJc;const Wb=this.vj.Qna-this.W9g<this.yke;
ha=this.C7f===ha;return(H||Ya?H&&Ya?H.Current===Ya.Current&&H.Pending===Ya.Pending&&H.SuspensionStartTimestamp===Ya.SuspensionStartTimestamp:!1:!0)&&Wb&&ha}JFk(H,ha){const Ya=this.sa.mc(),Wb=()=>{Z.ULS.sendTraceTag(588276806,0,10,`DoPendingMergeSender.sendDoPendingMergeRequest: request failed ${ha.Current} / ${ha.Pending} @${ha.SuspensionStartTimestamp}`)};return this.$La?this.$La.VBk(this.kPi(H,Wb,Ya)):this.Mbf(null,!0,void 0,Wb,Ya)}kPi(H,ha,Ya){return(Wb,Sc,zd)=>{let be=void 0;Z.ULS.shipAssertTag(523317955,
0,null!=Wb||H,"!allowSelectionAdjustment requires a non-null initialViewportState.");be=this.OWj.bind(this);Sc&&(be=Ic.c.call(null,oe=>{const Ke=oe.Result;let Xe=null===Ke||void 0===Ke?void 0:Ke.AdjustedViewportState;3===(null===Ke||void 0===Ke?void 0:Ke.MergeResultState)&&(Xe=void 0);Sc(Xe,oe.StateId)},be));zd&&(ha=Ic.b.call(null,zd,ha));return this.Mbf(Wb,H,be,ha,Ya)}}Mbf(H,ha,Ya,Wb,Sc){var zd=this.sa;Sc=zd.$a(1,void 0===Sc?null:Sc);Sc.viewportState=H;Sc.allowViewAdjustment=ha;return se.h(zd,"DoPendingMerge",
Sc,Ya,Wb,null,null,0)}OWj(H){var ha=H.Result;void 0!=ha&&(ha=ha.MergeResultState,2!==ha&&(this.SLc=[ha,H.MergeCount]))}Rik(H,ha){this.raiseEvent(hk.E5d,new Jl(H,ha))}NWj(){this.Qae--;if(this.SLc){const H=this.SLc;this.SLc=null;this.Rik(...H)}}}hk.E5d="MDO";Object(ia.a)(hk,"DoPendingMergeSender",kb.a,[612,613]);class Rk{constructor(H){this.divergenceOnResponse=this.adjustedDidntChangeWithDivergence=this.editBoxDivergence=this.differentSheetAdjust=this.parallel=this.errors=this.nonContinuous=this.divergenceOnViewportReady=
this.adjusted=this.adjustedDidntChange=0;this.nej=void 0===H?!1:H}get reportName(){return this.nej?"SelectionAdjustInHiddenDocument":"SelectionAdjust"}}Object(ia.a)(Rk,"SelectionAdjustSessionEndsReport",null,[582]);class Sk{constructor(H,ha,Ya,Wb,Sc,zd){this.Qb=H;this.dM=ha;this.iha=Ya;this.lRa=Wb;this.JGe=Sc;this.zS=zd}get activeCell(){return this.dM}get selectedRanges(){return this.iha}get mt(){let H=!1;if(null===this.zS||void 0===this.zS)H=!0;else if(this.zS>=this.selectedRanges.length||!this.selectedRanges[this.zS].contains(this.activeCell))Z.ULS.sendTraceTag(521200010,
0,50,`SelectionState.indexOfActiveRange: the index of the adjusted active range has changed. indexOfActiveRange: ${this.zS}, selectedRangesLength: ${this.selectedRanges.length}`),H=!0;H&&(this.zS=this.PTh());return this.zS}get activeRange(){return 0>this.mt?this.activeCell:this.selectedRanges[this.mt]}get sheetName(){return this.lRa}get activeItemName(){return this.JGe}get Heh(){return 1===this.selectedRanges.length}jah(H){const ha=this.selectedRanges.map(Ya=>this.k9k(Ya,this.JGe));for(const Ya of ha)if(Ya)for(const Wb of Ya)if(Wb.Ak&&
Wb.We.Revision<H)return!1;return!0}D5k(){var H;return{SheetName:this.sheetName,ActiveCell:null===(H=this.activeCell)||void 0===H?void 0:H.toString(),TopLeft:void 0,SelectedRanges:ra.u(this.selectedRanges,this.Qb)}}toString(){var H,ha;return`active cell: ${null!==(ha=null===(H=this.activeCell)||void 0===H?void 0:H.toString())&&void 0!==ha?ha:"null"} selection: ${this.selectedRanges.map(Ya=>{var Wb;return null!==(Wb=null===Ya||void 0===Ya?void 0:Ya.toString())&&void 0!==Wb?Wb:"null"}).join(",")}`}equals(H){return H?
this.activeCell.equals(H.activeCell)&&ra.Y(this.selectedRanges,H.selectedRanges)&&this.sheetName===H.sheetName:!1}PTh(){for(const H of this.selectedRanges.entries()){const [ha,Ya]=H;if(null===Ya||void 0===Ya?0:Ya.contains(this.activeCell))return ha}return-1}k9k(H,ha){var Ya;const Wb=Hd.f(this.Qb).za.gGa(H,ha);Wb||Z.ULS.sendTraceTag(522803340,0,50,`SelectionState.tryGetBlockCacheItemsFromRange: no items found. range: ${null!==(Ya=null===H||void 0===H?void 0:H.toString())&&void 0!==Ya?Ya:"null"} ; activeItemNameIsDefined: ${!!ha}`);
return Wb}}Object(ia.a)(Sk,"SelectionState",null,[]);var kh=a(959);class ml{constructor(H){this.t_c=0;this.JM=this.IK=null;this.cHe=new Rk;this.dHe=new Rk(!0);this.ON=0;this.K3k=!1;this.dMj=1E4;this.de=()=>{this.zlf()};this.Ij=()=>{this.ord(!0,!1)};this.epb=()=>{this.ord(!1,!1)};this.$=H;this.da=Hd.f(this.$);this.da.za.Or(this.Ij);this.da.za.$t(this.epb);this.da.za.S3e(this.epb);this.da.za.qqa(this.epb);this.$.Ul(this.de);this.zlf()}VBk(H){let ha=null,Ya=null;const Wb=()=>{this.NSj()};this.GYf()?
(this.UW.parallel++,Z.ULS.sendTraceTag(526390086,0,15,`SelectionAdjustManager.runRequestWithSelectionAdjust: Skipping parallel request. Current adjustedSelection is defined : ${!!this.JM}`)):(ha=(Sc,zd)=>{this.OSj(Sc,zd)},Ya=this.RLk());return null===H||void 0===H?void 0:H(Ya,ha,Wb)}mxj(){return!this.GYf()&&this.w7().Heh}RLk(){var H;Z.ULS.shipAssertTag(525135961,0,0===this.ON,"SelectionAdjustManager.setPreRequestState: unexpected state");this.JM&&(this.UW.errors++,Z.ULS.sendTraceTag(526960090,0,10,
`SelectionAdjustManager.setPreRequestState: About to ignore a defined Adjusted selection: ${this.JM.toString()}`));this.JM=null;this.IK=this.w7();let ha=null;const Ya=null===(H=this.IK)||void 0===H?void 0:H.D5k();Ya&&(ha={ActiveSheetName:this.IK.sheetName,SheetViewportStateChanges:[Ya]});this.ON=1;return ha}NSj(){Z.ULS.shipAssertTag(525135960,0,1===this.ON,"SelectionAdjustManager.onAdjustedRequestFailed: unexpected state");this.UW.errors++;this.ON=2;this.Vr()}OSj(H,ha){try{Z.ULS.shipAssertTag(525135959,
0,1===this.ON,"SelectionAdjustManager.onAdjustedSelectionReady: unexpected state"),this.t_c=ha,ha=2,this.IK?H?(this.JM=this.WPk(H))?(ha=7,this.IK.equals(this.JM)?this.IK.equals(this.w7())?(this.UW.adjustedDidntChange++,ha=4):(this.UW.adjustedDidntChangeWithDivergence++,ha=5):this.IK.sheetName!=this.JM.sheetName?(this.UW.differentSheetAdjust++,ha=10):this.IK.equals(this.w7())||(this.UW.divergenceOnResponse++,ha=6,this.MIg())):this.UW.errors++:(this.UW.errors++,Z.ULS.sendTraceTag(537155412,0,15,`SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted returned null, initialSelection: ${this.IK.toString()}`)):
(this.UW.errors++,Z.ULS.sendTraceTag(537155413,0,10,`SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted selection results returned when not waiting for them, adjusted:  ActiveCell: ${null===H||void 0===H?void 0:H.ActiveCell}`)),this.ON=ha}catch(Ya){this.ON=12,Z.ULS.sendTraceTag(525135958,0,10,`SelectionAdjustManager.OnAdjustedSelectionReady: caught Exception ${Ya}`)}finally{7!=this.ON?this.Vr():this.ord(!1,!0)}}dispose(){this.da.za.Gq(this.Ij);this.da.za.yu(this.epb);this.da.za.NGg(this.epb);
this.da.za.esb(this.epb);this.$.tm(this.de)}GYf(){return 1===this.ON||7===this.ON}WPk(H){let ha;if(!(()=>{let zd=ra.kb(H.ActiveCell,this.$.qa);({range:ha}=zd);return zd})().returnValue)return Z.ULS.sendTraceTag(537155411,0,10,`SelectionAdjustManager.sheetViewportStateToSelectionState: Unable to extract active cell ${H.ActiveCell}`),null;let Ya=[];const Wb=this.$.la,Sc=!!Wb&&2===Wb.CB;if(H.SelectedRanges)Ya=ra.i(H.SelectedRanges.Ranges);else if(!Sc)return Z.ULS.sendTraceTag(522826913,0,10,`SelectionAdjustManager.sheetViewportStateToSelectionState: SelectedRanges is null, active sheet exists: ${!!Wb}`),
null;return new Sk(this.$,ha,Ya,H.SheetName,this.IK.activeItemName,this.IK.mt)}w7(){const H=this.$.la;if((null===H||void 0===H?0:H.activeCell)&&H.selectedRanges&&H.sheetName)return new Sk(this.$,H.activeCell,H.selectedRanges,H.sheetName,this.$.activeItemName,H.mt);Z.ULS.sendTraceTag(525135957,0,15,`SelectionAdjustManager.getCurrentSelection: invalid activeItem. activeItem null: ${!H}, activeCell null: ${!(null===H||void 0===H?0:H.activeCell)}, selectedRanges null: ${!(null===H||void 0===H?0:H.selectedRanges)}, sheetName null: ${!(null===
H||void 0===H?0:H.sheetName)}`);return null}zlf(){this.$.ra.Vc(276,()=>{const H=nc.a(this.$);H.g6(this.cHe);H.g6(this.dHe)})}ord(H,ha){var Ya;if(this.wvj(H))if(8===this.ON)Z.ULS.sendTraceTag(523106438,0,15,"SelectionAdjustManager.attemptAdjustSelection: skipping as was already adjusted");else{ha&&Z.ULS.sendTraceTag(524039250,0,50,"SelectionAdjustManager.attemptAdjustSelection: viewport ready on response");try{Z.ULS.shipAssertTag(525135956,0,7===this.ON,"SelectionAdjustManager.attemptAdjustSelection: unexpected state"),
this.IK.equals(this.w7())?(null===(Ya=this.da)||void 0===Ya?0:Ya.isEditing)?(this.UW.editBoxDivergence++,this.ON=11):(H=0,H=this.JM.mt,-1==H?(this.UW.errors++,Z.ULS.sendTraceTag(522826912,0,10,"SelectionAdjustManager.attemptAdjustSelection: invalid indexOfActiveRange")):(this.UW.adjusted++,this.ON=8,this.da.ha.VI(this.JM.selectedRanges,H,this.JM.activeCell,0,void 0,"SelectionAdjust"))):(this.UW.divergenceOnViewportReady++,this.MIg(),this.ON=9)}catch(Wb){this.ON=12,Z.ULS.sendTraceTag(525135955,0,10,
`SelectionAdjustManager.attemptAdjustSelection: caught Exception ${Wb}`)}finally{this.Vr()}}}wvj(H){if(!this.JM)return!1;if(!this.IK)return Z.ULS.sendTraceTag(537155409,0,10,`SelectionAdjustManager.attemptAdjustSelection: initialSelection is null while adjustedSelection isn't null, adjustedSelection: ${this.JM.toString()}`),!1;if(Hd.f(this.$).za.Deg<this.t_c)return!1;if(H||this.K3k)Z.ULS.sendTraceTag(528590295,0,15,"SelectionAdjustManager.attemptAdjustSelection: got to blockCacheConsistent while pending for selection adjust");
else if(!this.IK.jah(this.t_c)||!this.JM.jah(this.t_c))return!1;return!0}Vr(){this.IK=this.JM=null;this.ON=0}MIg(){const H=this.w7();Z.ULS.sendTraceTag(537155408,0,50,`SelectionAdjustManager.ReportDivergence: initial: ${this.IK.toString()} current: ${H?H.toString():""} adjusted: ${this.JM.toString()} sheetSameBetweenInitialAndAdjusted: ${this.IK.sheetName===this.JM.sheetName} sheetSameBetweenInitialAndCurrent: ${this.IK.sheetName===(H?H.sheetName:null)}`)}get UW(){return kh.a.pI(this.dMj)?this.dHe:
this.cHe}}Object(ia.a)(ml,"SelectionAdjustManager",null,[611,4]);class nl extends Vd.a{constructor(H,ha,Ya){Ya=void 0===Ya?null:Ya;super();this.OOa=this.KDc=this.jkb=this.Vdb=null;this.$=H;this.V$a=new vj(H);this.$La=new ml(this.$);this.lVa=new hk(this.$.ma.sa,this.$,void 0,void 0,this.$La);this.lgj(H,Ya);this.Zoa=new ej(this.OOa,this.V$a,this.lVa);this.tke=new gk(H,this.Zoa,ha,this.lVa);pd.EwaSettings.Ra(230)&&(this.KDc=new Uj(H,this));Z.ULS.sendTraceTag(588276810,0,50,"MergeSuspensionManager created")}Nlc(H){this.Zoa.Nlc(H)}rUc(H){this.Zoa&&
this.Zoa.rUc(H)}get ora(){return this.OOa}get Uwa(){return this.V$a}get Rda(){return this.Zoa}qLa(H,ha){this.OOa.qLa(H,ha)}pze(H){this.OOa.pze(H)}e2a(H,ha){this.V$a.e2a(H,void 0===ha?"":ha)}dispose(){this.KDc&&(this.KDc.dispose(),this.KDc=null);this.$La&&this.$La.dispose();this.lVa.dispose();this.tke&&(this.tke.dispose(),this.tke=null);this.Zoa&&(this.Zoa.dispose(),this.Zoa=null);this.V$a.dispose();this.V$a=null;this.OOa.dispose();this.OOa=null;this.Vdb&&(this.Vdb.dispose(),this.Vdb=null);this.jkb&&
(this.jkb.dispose(),this.jkb=null);this.$=null;super.dispose()}g2b(){this.Zoa.yjk()}static Eyc(H){let ha=0;for(const Ya of H){if(2==Ya)return 2;1==Ya&&(ha=1)}return ha}lgj(H,ha){this.OOa=new Ih(this.lVa,this.V$a);ha?Object(nb.a)(ek,ha)?this.qLa(ha,Object(tc.a)(ek,ha).YN):Object(nb.a)(Mk,ha)?this.qLa(ha,Object(tc.a)(Mk,ha).YN):this.qLa(ha,0):(this.Vdb=new Mk(H),this.jkb=new ek(H),this.qLa(this.Vdb,this.Vdb.YN),this.qLa(this.jkb,this.jkb.YN))}}Object(ia.a)(nl,"MergeSuspensionManager",Vd.a,[591,4]);
class Tk extends Pg.a{constructor(H){super();this.Ad=H;this.ri()}create(){Z.ULS.sendTraceTag(537155419,0,50,"MergeSuspensionFactory.Create");this.Uf(this.Ad.ra.Tb(343)||this.Ad.ra.zc(343,new nl(this.Ad,Lg.a.instance)))}static Ea(H){Z.ULS.sendTraceTag(537155418,0,50,"MergeSuspensionFactory.Attach");H.ra.zc(344,new Tk(H))}}Object(ia.a)(Tk,"MergeSuspensionFactory",Pg.a,[]);class ol extends Pg.a{constructor(H){super();this.$=H;this.ri()}create(){this.lnk(()=>Ch.Ea(this.$))}static Ea(H){H.ra.zc(50,new ol(H))}lnk(H){H=
Object(Qg.a)(this.$.ra,183,H);this.Uf(H)}}Object(ia.a)(ol,"TaskPaneManagerFactory",Pg.a,[]);const Kl=Object(kd.b)("Common.App.Rename.IRenamedFileChecker"),Ll=Object(kd.c)(Kl),Ml=Object(kd.b)("Common.App.Rename.IRenameFlyoutActor"),pl=Object(kd.c)(Ml),cm=Object(kd.b)("Common.App.Rename.IRenameDialogActor"),xk=Object(kd.c)(cm);var Uk=a(537);const ql=Object(kd.b)("Common.ISessionStatus");var rl=a(700);const sl=Object(kd.b)("Common.App.Rename.RenameDialogFactory"),Nl=Object(kd.c)(sl);var Qj=a(190);class tl{constructor(H,
ha,Ya){this.WWg=this.XWg=this.YWg=!1;this.HXg=!H&&!ha;this.IXg=!H&&!Ya;this.HXg||this.IXg||(this.YWg=!H,this.XWg=!ha,this.WWg=!Ya)}}Object(ia.a)(tl,"RenameDisabledDialogInfo",null,[]);class Vj extends Qj.a{constructor(H,ha,Ya,Wb,Sc){super();this.Kwe=[];this.PAb=new tl(H,ha,Ya);this.uEb=Wb;this.hBb=Sc;this.uf="RenameDisabledDialog";this.hc=0;this.Ic(1,Object(Bg.a)("DialogClose"));this.hNk();this.Gvk()}hNk(){if(this.PAb.HXg){let H;H=this.uEb?this.hBb?Object(Bg.a)("RenameFileRenameReadOnlyRecommended"):
Object(Bg.a)("RenameFileRenameNotEveryoneSupportsRename"):Object(Bg.a)("RenameFileRenameDisabledCoauthFull");this.GXg(H)}else this.PAb.IXg?this.GXg(Object(Bg.a)("RenameFileRenameDisabledPermissionFull")):this.Zzh();this.gqa(this.Kwe)}GXg(H){Array.add(this.Kwe,H)}Zzh(){const H=[];this.PAb.YWg||Array.add(H,Object(Bg.a)("RenameFileRenameDisabledSignIn"));this.PAb.XWg||Array.add(H,Object(Bg.a)("RenameFileRenameDisabledPermission"));this.PAb.WWg||Array.add(H,Object(Bg.a)("RenameFileRenameDisabledCoauth"));
0<H.length&&Array.add(this.Kwe,H)}}Object(ia.a)(Vj,"ReactRenameDisabledDialogBase",Qj.a,[]);class ul extends Vj{constructor(H,ha,Ya,Wb,Sc){super(H,ha,Ya,Wb,Sc)}Gvk(){this.oob(Object(Bg.a)("RenameFileRenameDisabledTitle"),null,null,null,null,null)}}Object(ia.a)(ul,"RenameDisabledDialog",Vj,[]);class Vk{constructor(H,ha,Ya){this.lQa=0;this.qia=(Wb,Sc,zd,be,oe)=>{if(1===zd)return this.pb.hf(yb.a.renameFile,1);Wb=cd.a.nu(this.toa.gp);oe=(0,oe.getNewDocumentTitle)();oe.length>this.lQa&&(oe=oe.substr(0,
this.lQa));if(32!==this.pb.pe(yb.a.renameFile,2,oe))return this.T4(Wb),8;this.T4(oe);this.kd.uea(ve.AFrame.rAd,!1);return 32};this.pb=H;this.toa=ha;this.kd=Ya}initialize(H){if(!this.pb||!this.toa)return!1;this.lQa=H;this.wi();return!0}wi(){this.pb.jc(yb.a.qia,wh.a.frame,this.qia)}T4(H){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(H))}static mMd(){return new Vk(ta.AFrameworkApplication.Kb,ta.AFrameworkApplication.Wh,Rd.FocusManager.instance())}}Object(ia.a)(Vk,"ReactRenameUIHandler",
null,[664]);var vl=a(706),Th=a(108),Wk=a(618),wl=a(875),Cj=a(488),mk=a(55);class Xk{constructor(H,ha,Ya,Wb,Sc,zd,be,oe,Ke,Xe,ig){this._initialized=!1;this._element=null;this.lQa=0;this.ejd=this.Nbd=!1;this.pb=H;this.F7c=ha;this.yf=Ya;this.gF=Wb;this.toa=Sc;this.sXe=zd;this.dic=be;this.VIe=oe;this.Jga=Ke;this.e$a=Xe;this.Mcd=ig}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(H,ha,Ya){if(!(this.pb&&this.toa&&this.sXe&&this.dic&&this.VIe&&ha)||0>=H)return!1;this._element=
ha;this._element.title=Ya;this._element.setAttribute(Cj.a.Ae,Cj.a.HA);this._element.setAttribute("Unselectable","on");this.lQa=H;this.Yz();return this._initialized=!0}Yz(){this.F7c&&(this.F7c.va(ah.a.blur,this._element,Object(fc.a)(this,this.onBlur,"onBlur")),this.F7c.va(ah.a.paste,this._element,Object(fc.a)(this,this.onPaste,"onPaste")));this.yf.va(ah.a.nd,this._element,Object(fc.a)(this,this.onKeyDown,"onKeyDown"));this.gF.va(ah.a.Sd,this._element,Object(fc.a)(this,this.onPointerDown,"onPointerDown"));
this.gF.va(ah.a.Lj,this._element,Object(fc.a)(this,this.sj,"onPointerUp"))}onBlur(){this.isActive&&!this.Nbd&&(this.VIe(this._element),this.Tgf(),this.NAd(!1));return this.Nbd=!1}onPaste(){Z.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(H){return this.isActive?this.Q0j(H):this.R0j(H)}Q0j(H){let ha=!1;switch(H.Ha.keyCode){case Sys.UI.Key.enter:this.Tgf();this.NAd(this.e$a||this.Mcd);ha=!0;break;case Sys.UI.Key.esc:this.ole(),this.NAd(this.e$a||this.Mcd),
ha=!0}return ha}R0j(H){let ha=!1;switch(H.Ha.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.r4g(this.Mcd),this.isActive&&this.dic(this._element),ha=!0}return ha}onPointerDown(){this.isActive||(this.r4g(!1),this.isActive&&(this._element.focus(),this.dic(this._element),this.ejd=!0));return!1}sj(){return this.ejd?(this.dic(this._element),this.ejd=!1,!0):!1}bmb(){return 32===this.pb.hf(yb.a.renameFile,1)}Tgf(){const H=cd.a.nu(this.toa.gp);let ha=this._element.innerText.trim();ha.length>this.lQa&&
(ha=ha.substr(0,this.lQa));ha!==H&&""!==ha?32!==this.pb.pe(yb.a.renameFile,2,ha)?this.ole():this.T4(ha):this.ole()}ole(){this.T4(cd.a.nu(this.toa.gp))}T4(H){this._initialized&&(this._element.innerText=H,this.sXe())}r4g(H){this.bmb()?this.isActive||(H&&(this.Nbd=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(Cj.a.Ae,Cj.a.Uqd),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,
Th.a.Irf),this.Jga&&this.Jga.execute(ha=>{ha.aCg(!0)}),H&&this._element.focus(),Z.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.pb.hf(yb.a.Uub,2)}NAd(H){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(Cj.a.Ae,Cj.a.HA);Sys.UI.DomElement.removeCssClass(this._element,Th.a.Irf);this.Jga&&this.Jga.execute(ha=>{ha.aCg(!1)});H&&(this._element.blur(),this._element.focus())}static CE(){Wk.a.CE(ta.AFrameworkApplication.isRtl)}static mMd(){return new Xk(ta.AFrameworkApplication.Kb,
wl.a.instance,Sh.a.instance,Fh.a.instance,ta.AFrameworkApplication.Wh,Xk.CE,mk.a.UEk,mk.a.hZh,Object(kd.d)(vl.a),Uf.a.mi,Uf.a.Yg)}}Object(ia.a)(Xk,"RenameUIHandler",null,[664]);class Rj{static get instance(){return ta.AFrameworkApplication.ua.Ab.ms?Rj.Wa||(Rj.Wa=Vk.mMd()):Rj.Wa||(Rj.Wa=Xk.mMd())}}Rj.Wa=null;Object(ia.a)(Rj,"RenameUIHandlerFactory",null,[]);var xl=a(202);class nk{constructor(){this.wPj=this.qPj=this.$bi=null}}Object(ia.a)(nk,"RenameMruEntryProperties",null,[]);var ok=a(793),Ol=a(249),
Yk;(function(H){H[H.unknown=-1]="unknown";H[H.success=0]="success";H[H.Ozl=1]="renameInvalidFileName";H[H.Nzl=2]="renameInCoauthNotSupported";H[H.Pzl=3]="renameNotSupportedInViewMode";H[H.tzl=4]="permissionDenied";H[H.hAl=5]="serverCommunicationFailure";H[H.Srl=6]="fileNameTooLong"})(Yk||(Yk={}));Object(ia.b)("CommonOperationResult",Yk);class Zk{constructor(H,ha){this.fileNameCandidate=H;this.disableFailedActionDialog=void 0===ha?!1:ha}}Object(ia.a)(Zk,"RenameActionData",null,[]);class wj{constructor(H,
ha,Ya,Wb,Sc,zd,be,oe,Ke,Xe,ig,Og){this.TSb=()=>Rj.instance.initialize(ta.AFrameworkApplication.bxc,ta.AFrameworkApplication.oVa,ta.AFrameworkApplication.pje||Object(Bg.a)("RenameFileTooltip"))?32:8;this.Uub=()=>{const mg=this.Xgl(),ih=this.Awh();Z.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",this.x$a,ih,mg,this.uEb);new ul(this.x$a,!ih,!mg,this.uEb,
this.hBb());return 32};this.renameFile=(mg,ih,ai,Dj,Ai)=>{if(1===ai)return this.bmb();if(!ta.AFrameworkApplication.Fsa)return 8;if(8===this.bmb())return this.zh.hf(yb.a.Uub,2),8;this.Wea&&this.Wea.Q2c(!1);Z.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");mg=!1;Ai instanceof Zk&&(mg=Ai.disableFailedActionDialog,Ai=Ai.fileNameCandidate);ta.AFrameworkApplication.Fsa(Ai,Object(fc.a)(this,this.k2a,"onRenameFileSuccess"),mg?this.rTj:this.O3j);ta.AFrameworkApplication.tvk=!0;return 32};this.rTj=mg=>
{Z.ULS.sendTraceTag(507655632,203,15,"OnAutoRenameFileFailure: {0}",{["Result"]:null!==mg&&void 0!==mg?mg:-1});this.Wea&&this.Wea.Q2c(!0)};this.O3j=mg=>{Z.ULS.sendTraceTag(507655631,203,15,"OnRenameFileFailure: {0}",{["Result"]:null!==mg&&void 0!==mg?mg:-1});const ih=new Qj.a;ih.hc=0;switch(mg){case 1:Z.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");ih.Cya(Object(Bg.a)("RenameFileInvalidNameTitle"),Object(Bg.a)("RenameFileInvalidName"),null);break;case 6:Z.ULS.sendTraceTag(38114564,
203,50,"OnRenameFileFailure: FileNameTooLong");ih.Cya(Object(Bg.a)("RenameFileInvalidNameTitle"),Object(Bg.a)("RenameFileNameTooLong"),null);break;default:Z.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:null!==mg&&void 0!==mg?mg:-1}),ih.Cya(Object(Bg.a)("RenameFileGenericErrorTitle"),Object(Bg.a)("RenameFileGenericError"),null)}ta.AFrameworkApplication.Jz().execute(ai=>{ai.sendMessage(Zb.a.gAi,{["FailureMessage"]:Yk[mg]})});this.UKg();this.Wea&&this.Wea.Q2c(!0)};this.Xmk=
(mg,ih,ai)=>{if(1===ai)return this.bmb();if(!ta.AFrameworkApplication.j7)return 8;ta.AFrameworkApplication.j7(Object(fc.a)(this,this.Fpb,"onRefreshFilenameSuccess"),Object(fc.a)(this,this.dPc,"onRefreshFilenameFailure"),!1);return 32};this.kMc=(mg,ih,ai,Dj,Ai)=>{if(1===ai)return ta.AFrameworkApplication.ea.ka("UiHostSupportsMoveToFolder")?this.bmb():8;if(2===ai){if(!ta.AFrameworkApplication.w5b)return ja.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",
!1,!1,null),8;if(!Ai)return ja.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(Ai.isCrossSiteMove)if(Ai.updatedDocumentUrl)if(mg=Ai.updatedDocumentUrl.toLowerCase(),ih=ta.AFrameworkApplication.ea.ka("UiHostSupportsDocRebootFeatures"),ai=ta.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),ih&&ta.AFrameworkApplication.TQ&&ai){const Ui={rebootMode:"1"};Ui.documentUrl=mg;Ui.reason=ok.a.saveAs;ja.Health.instance.recordKpiSuccess("MoveToFolder",
null);ta.AFrameworkApplication.Jz().execute(Bi=>{Bi.sendMessage(Zb.a.g1,Ui)})}else if(!ta.AFrameworkApplication.TQ&&ai)ja.Health.instance.recordKpiSuccess("MoveToFolder",null),mk.a.Rg(mg,mk.a.h_(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return ja.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else ja.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else ta.AFrameworkApplication.j7(Object(fc.a)(this,this.Fpb,"onRefreshFilenameSuccess"),
Object(fc.a)(this,this.dPc,"onRefreshFilenameFailure"),!1),ta.AFrameworkApplication.w5b(),ja.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32};this.JPe=H;this.pb=ha;this.Syb=Ya;this.rD=Wb;this.x$a=Sc;this.Awh=zd;this.uEb=be;this.B_e=oe;this.Vsh=Ke;this.hBb=Xe;this.ya=ig;this.Ush=Og;this.$Qa=new yd.a(()=>this.V_i())}wi(){ta.AFrameworkApplication.ua&&ta.AFrameworkApplication.ua.Ab.ms||this.zh.jc(yb.a.TSb,wh.a.frame,this.TSb);this.zh.jc(yb.a.Uub,wh.a.frame,this.Uub);this.zh.jc(yb.a.renameFile,
wh.a.frame,this.renameFile);this.zh.ef(yb.a.hWa,wh.a.frame,this.Xmk,64);this.zh.ef(yb.a.kMc,wh.a.frame,this.kMc,64);this.zh.jc(yb.a.S8,wh.a.frame,Object(fc.a)(this,this.S8,"moveToFolder"));(ta.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||ta.AFrameworkApplication.ua&&(ta.AFrameworkApplication.ea.ka("PostMessageEmbedded")||ta.AFrameworkApplication.ea.ka("IsJsApi"))&&ta.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",
!0))&&ta.AFrameworkApplication.Jz().execute(H=>{H.nl(Zb.a.Tfg);H.ik(Zb.a.Tfg,wj.xlk);H.nl(Zb.a.CGd);H.ik(Zb.a.CGd,wj.vlk)})}bmb(){return 0===this.Ush.PMf()?32:8}Xgl(){return this.yx?this.uEb?this.yx.Cqf:this.yx.ROb:!0}V_i(){return this.ya.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIconsWithStrings",!1)?Ol.a.instance.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"):null}k2a(H,ha){H?0!==H.OperationResult?this.aRf(H.OperationResult):(this.hGk(ha,H.NewName),
this.ybl(H,Object(fc.a)(ta.AFrameworkApplication.ua.Ab,ta.AFrameworkApplication.ua.Ab.t8g,"updateOpenInClientDocumentUrl")),ta.AFrameworkApplication.ea.ka("DocumentNameInJewelInfoMenuIsEnabled")&&ta.AFrameworkApplication.ua.ax(),this.Vsh.M6g()):this.aRf(5);this.Wea&&this.Wea.Q2c(!0)}hGk(H,ha){const Ya={};Ya.NewName=ha;H.sendMessage(Zb.a.CGd,Ya)}ybl(H,ha){this.Kbl(H);ta.AFrameworkApplication.gpf=H.DirectInvokeDavUrl;ha=ha(H.EditDocInClientUrl);const Ya=new nk;Ya.wPj=this.rD.gp;Ya.$bi=ha;Ya.qPj=H.EditDocInClientUrl;
this.zh.pe(yb.a.renameMostRecentlyUsedFileEntry,2,Ya)}aRf(H){switch(H){case 1:H=new Qj.a,H.hc=0,H.XR(Object(Bg.a)("RenameFileInvalidNameTitle"),Object(Bg.a)("RenameFileInvalidName"),null),this.UKg()}}Kbl(H){this.rD.gp=wj.vJh(this.rD.gp,H.NewName);H.BreadcrumbFolderName&&(this.rD.breadcrumbFolderName=H.BreadcrumbFolderName);H.BreadcrumbFolderUrl&&(this.rD.breadcrumbFolderUrl=H.BreadcrumbFolderUrl);this.B_e(H.NewName)}S8(H,ha,Ya,Wb,Sc){var zd,be;if(1===Ya)return ta.AFrameworkApplication.ea.ka("UiHostSupportsMoveToFolder")?
32:8;if(2===Ya){const oe={};H=ta.AFrameworkApplication.TQ;ha=ta.AFrameworkApplication.ea.ka("UiHostSupportsDocRebootFeatures");H=(!H||H&&ha)&&ta.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);oe.supportsCrossSiteMove=H;Sc&&Sc.MoveButtonClickedTime&&(oe.moveStartTime=Sc.MoveButtonClickedTime.getTime());H={};if(null===(zd=ta.AFrameworkApplication.ea)||void 0===zd?0:zd.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SuperPickerIntegrationForCreateACopyAndMove",
!1))H.titleText=Object(Bg.a)("PickerMoveTitle");ta.AFrameworkApplication.ea.ka("DarkModeSupportInMoveFilePickerEnabled")&&Object(cg.a)("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(H.theme="Dark");if(null===(be=ta.AFrameworkApplication.ea)||void 0===be?0:be.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_8833612_SuperPickerCustomizationForMoveToFolderEnabled"))oe.pickerCustomization=H;ta.AFrameworkApplication.Jz().execute(Ke=>{Ke.sendMessage(Zb.a.S8,oe)});
Z.ULS.sendTraceTag(507302554,306,50,"Move File Picker opened");if(Sc&&Sc.MoveButtonClickedTime){if(zd=xl.a.ip())Sc=(new Date).getTime()-Sc.MoveButtonClickedTime.getTime(),zd.set("MovePostDuration",Sc.toString());ja.Health.instance.recordKpiUsage("MoveToFolder",Hc.b.FailureBased,"smartfio",zd)}return 32}return 8}HTk(H,ha){return H&&ha?H!==this.rD.breadcrumbFolderName||ha!==this.rD.breadcrumbFolderUrl:!1}Fpb(H,ha){H&&(H.NewName!==cd.a.nu(this.rD.gp)||this.HTk(H.BreadcrumbFolderName,H.BreadcrumbFolderUrl))&&
this.k2a(H,ha)}dPc(){}UKg(){this.B_e(cd.a.nu(this.rD.gp))}get zh(){return this.pb.value}get Wea(){return this.$Qa.value}get yx(){return this.Syb.value}static get instance(){return wj.Wa||(wj.Wa=wj.yca())}static yca(){return new wj(ta.AFrameworkApplication.lva,new yd.a(()=>ta.AFrameworkApplication.Kb),new yd.a(()=>ta.AFrameworkApplication.yx),ta.AFrameworkApplication.Wh,ta.AFrameworkApplication.limitedEdit,()=>ta.AFrameworkApplication.userCanRename,ta.AFrameworkApplication.O3b,Object(fc.a)(Rj.instance,
Rj.instance.T4,"updateTitle"),Object(kd.a)(Ll),()=>ta.AFrameworkApplication.isReadOnlyRecommended,ta.AFrameworkApplication.ea,Object(kd.a)(Xb))}static vJh(H,ha){H=cd.a.x7(H);return ha+H}static xlk(H){const ha=H.Values.isMoveSuccessful;Z.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",ha);ha?ta.AFrameworkApplication.Kb.pe(yb.a.kMc,2,H.Values):ja.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static vlk(H){ta.AFrameworkApplication.Kb.pe(yb.a.renameFile,
2,H.Values.NewName)}}wj.Wa=null;Object(ia.a)(wj,"RenameActor",null,[]);a(695);class Pl{}Object(ia.a)(Pl,"ActivityEventName",null,[]);class Ql{}Ql.compatMode="CompatMode";Object(ia.a)(Ql,"ActivityEventReason",null,[]);class yl{constructor(H,ha){this.pb=H;this.i9a=ha}wi(){this.pb.jc(yb.a.xXg,wh.a.frame,Object(fc.a)(this,this.XWk,"showRenameDialogAction"))}XWk(H,ha,Ya){H=32;if(1===Ya)return Qa.SessionStatusManager.instance.iYa||ta.AFrameworkApplication.n8?8:32;2===Ya&&(32!==this.pb.hf(yb.a.renameFile,
1)?(this.pb.hf(yb.a.Uub,2),H=8):32===this.pb.hf(yb.a.x7b,1)?this.pb.hf(yb.a.x7b,2):this.i9a.value.create().Hse());return H}}Object(ia.a)(yl,"RenameDialogActor",null,[653]);var Rl=a(238);class Sj{constructor(H,ha,Ya){this.dialog=null;this.pb=H;this.rD=ha;this.Odc=Ya}VZi(){const H={};H.nameInputProps={["type"]:"AppInputProps",["id"]:Sj.uCd,["label"]:Object(Bg.a)("RenameDialogLabel"),["value"]:cd.a.nu(this.rD.gp),["maxLength"]:this.Odc};return H}Hse(){const H={["id"]:"RenameDialog",["bodyControls"]:this.VZi()};
this.dialog=new Rl.a(!1,!1,!0);this.dialog.hc=1;this.dialog.uf="RenameDialog";this.dialog.initializeAndShow(Object(Bg.a)("RenameDialogTitle"),Object(fc.a)(this,this.svk,"renameDialogHandler"),H)}svk(H,ha){ha&&1===H&&ha[Sj.uCd]&&(H=cd.a.nu(this.rD.gp),ha=(ha[Sj.uCd]||"").trim(),ha!==H&&""!==ha&&this.pb.pe(yb.a.renameFile,2,ha))}}Sj.uCd="txtDocumentName";Object(ia.a)(Sj,"RenameDialog",null,[665]);class yk{constructor(H){this.toa=null;this.Odc=0;this.pb=H;this._initialized=!1}initialize(H,ha){this.toa=
H;this.Odc=ha;this._initialized=!0}create(){return this._initialized?new Sj(this.pb,this.toa,this.Odc):null}}Object(ia.a)(yk,"RenameDialogFactory",null,[652]);var zl=a(95);class Wj{constructor(H,ha){this.pb=H;this.kd=ha}wi(){this.pb.jc(yb.a.x7b,wh.a.frame,Object(fc.a)(this,this.YWk,"showRenameFlyoutAction"))}XUh(){return cg.d("setDocumentTitleFlyoutOpened")&&ta.AFrameworkApplication.ua.Ab.ms}YWk(H,ha,Ya){if(1===Ya)return this.XUh()?32:8;ta.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DocumentInlineRenameEnabled",
!1)&&ta.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FileMenuRedesignIsEnabled",!1)&&ta.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?(this.kd.H3(ve.AFrame.rAd,!1),appChrome.getHeaderApi().then(Wb=>{Wb.focusDocumentTitle()})):appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}zBh(){Wj.Swj&&ta.AFrameworkApplication.Zua&&zl.TaskManager.instance.Ag(new Wa.a(5,1,5E3,()=>{32===
this.pb.hf(yb.a.x7b,1)&&this.kd&&this.kd.currentScope.name===ve.AFrame.yX&&(nd.a("RenameFloatieShownOnNewDocumentLoad",!0),this.pb.hf(yb.a.x7b,2))}))}static get Swj(){Wj.kfc&&null!=Wj.kfc||(Dd.a.tt("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),Wj.kfc=ta.AFrameworkApplication.ea?ta.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return Wj.kfc}}Wj.kfc=null;Object(ia.a)(Wj,"RenameFlyoutActor",null,
[651]);class $k{constructor(H,ha,Ya,Wb,Sc){this.y_h=null;this.Syb=Sc;this.KPe=Ya;this.JPe=Wb;this.Fwh=H;this.hBb=ha}get yx(){return this.Syb.value}PMf(){if(!this.JPe())return 5;if(this.hBb())return 1;if(this.yx){if(this.KPe&&!this.yx.Cqf)return 3;if(!this.KPe&&!this.yx.ROb)return 4}return this.Fwh()?0:2}}Object(ia.a)($k,"RenameProps",null,[650]);var Xj=a(113);class qj{constructor(H,ha,Ya,Wb,Sc,zd){this.vA=!1;this.qed=new Xj.a;this.q9a=ha;this.tS=Ya;this.qkh=Wb;this.ya=Sc;this.cZe=zd}enable(){this.vA||
(this.M6g(),this.Wue(),this.vA=!0)}generateKey(H,ha,Ya){return String.format("{0}/{1}/{2}",Ya,H,ha)}VTi(){const H=cd.a.nu(this.q9a().gp);return this.generateKey(this.q9a().breadcrumbFolderName,this.q9a().breadcrumbFolderUrl,H)}WTi(H,ha,Ya){return H&&ha?this.generateKey(H,ha,Ya):Ya}Pgi(H,ha,Ya){return H&&H!==this.q9a().breadcrumbFolderName||ha&&ha!==this.q9a().breadcrumbFolderUrl?!0:Ya!==cd.a.nu(this.q9a().gp)}M6g(){const H=this.VTi();this.qed.ga(H,new Date)}pce(H){this.SRk(H)&&this.U0e(H)}SRk(H){const ha=
this.qkh();return ha?this.cZe&&this.cZe.PUb||!ha.uWd||!ta.AFrameworkApplication.j7?(this.h_g(H),this.vA=!1):!0:!1}jtg(H,ha,Ya,Wb){const Sc=this.Pgi(H,ha,Ya),zd=this.WTi(H,ha,Ya);H=(()=>this.qed.Od(zd))().returnValue;Sc&&!H&&(this.bRf(Wb),Z.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.a3d));Sc||this.qed.ga(zd,this.tS())}}Object(ia.a)(qj,"ARenamedFileChecker",null,[589]);class fj extends qj{constructor(H,ha,Ya,Wb,Sc,zd,be,oe){super(H,ha,Ya,Wb,Sc,zd);this.VRf=(Ke,Xe)=>{Xe&&Xe.sZb&&
Xe.xSj&&(Xe.gmb("BreadcrumbDocName")||Xe.gmb("BreadcrumbFolderName")||Xe.gmb("BreadcrumbFolderUrl")||Xe.gmb("DirectInvokeDAVUrl")||Xe.gmb("EditDocInClientUrl"))&&(Z.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.a3d),this.pce(Xe))};this.kWe=Sc;this.Tsh=be;this.joh=oe}get a3d(){return"RenamedFileCheckerUsingSettingsRefresh"}Wue(){this.kWe.Iod(this.VRf)}h_g(){this.kWe.zHg(this.VRf)}U0e(H){if(H&&H.sZb){const ha=H.sZb;this.jtg(ha.Qa("BreadcrumbFolderName"),ha.Qa("BreadcrumbFolderUrl"),
ha.Qa("BreadcrumbDocName"),H)}}bRf(H){const ha={OperationResult:0,classId:1};H=H.sZb;ha.BreadcrumbFolderName=H.Qa("BreadcrumbFolderName");ha.BreadcrumbFolderUrl=H.Qa("BreadcrumbFolderUrl");ha.DirectInvokeDavUrl=H.Qa("DirectInvokeDAVUrl");ha.EditDocInClientUrl=H.Qa("EditDocInClientUrl");H=H.Qa("BreadcrumbDocName");ha.NewName=ta.AFrameworkApplication.REa?H:cd.a.nu(H);this.joh.execute(Ya=>{this.qlj(ha,Ya)})}qlj(H,ha){this.Tsh().k2a(H,ha)}}Object(ia.a)(fj,"RenamedFileCheckerUsingSettingsRefresh",qj,[]);
class al extends qj{constructor(H,ha,Ya,Wb,Sc,zd,be,oe,Ke,Xe){super(H,Ya,Wb,Sc,zd,Ke);this.dDb=this.Ijc=null;this.bsh=ha;this.pb=be;this.Ve=oe;Xe&&Xe.execute(ig=>{this.wpk(ig)})}get a3d(){return"RenamedFileCheckerUsingTask"}wpk(H){this.Ijc=H;this.Ijc.Q4e(Object(fc.a)(this,this.nRb,"handleVisibilityChange"))}nRb(H,ha){!this.vA||0!==ha.newState&&1!==ha.newState||this.dDb||(this.Wue(),this.pce(this.dDb))}Wue(){this.dDb=new Wa.a(3,2,this.bsh(),Object(fc.a)(this,this.pce,"performRenameFileCheckTick"),
89);this.Ve.Ag(this.dDb)}h_g(H){this.Ve.Xr(H)}U0e(H){this.Ijc&&2===this.Ijc.yql?this.Iqk(H):ta.AFrameworkApplication.j7(Object(fc.a)(this,this.Fpb,"onRefreshFilenameSuccess"),Object(fc.a)(this,this.dPc,"onRefreshFilenameFailure"),!0)}Iqk(H){this.Ve.Xr(H);this.dDb=null}Fpb(H){H&&this.jtg(H.BreadcrumbFolderName,H.BreadcrumbFolderUrl,H.NewName,null)}bRf(){this.pb.hf(yb.a.hWa,2)}dPc(){}}Object(ia.a)(al,"RenamedFileCheckerUsingTask",qj,[]);class Sl{constructor(){this.ya=this.oc=null;this.LC=()=>{const H=
ta.AFrameworkApplication.ua.Ab.ms;ta.AFrameworkApplication.lva()&&Rj.instance.initialize(ta.AFrameworkApplication.bxc,H?null:ta.AFrameworkApplication.oVa,H?null:ta.AFrameworkApplication.pje||Object(Bg.a)("RenameFileTooltip"))&&(this.oc.register($k,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Qc(()=>new $k(()=>ta.AFrameworkApplication.userCanRename,()=>ta.AFrameworkApplication.isReadOnlyRecommended,ta.AFrameworkApplication.O3b,ta.AFrameworkApplication.lva,new yd.a(()=>ta.AFrameworkApplication.yx))).Lc(),
wj.instance.wi(),this.ya.ka("RenameDialogIsEnabled")&&(Object(kd.a)(Nl).initialize(ta.AFrameworkApplication.Wh,ta.AFrameworkApplication.bxc),Object(kd.a)(xk).wi()),Object(kd.a)(pl).wi(),ta.AFrameworkApplication.O3b&&Object(kd.a)(Ll).enable(),Object(kd.a)(pl).zBh())}}get name(){return"Common.App.RenameFile"}ji(H){this.oc=H;this.ya=ta.AFrameworkApplication.ea;this.oc.register(yl,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Qc(()=>new yl(ta.AFrameworkApplication.Kb,
Object(kd.e)(sl))).Lc();this.oc.register(yk,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Qc(()=>new yk(ta.AFrameworkApplication.Kb)).Lc();this.oc.register(589,"Common.App.Rename.IRenamedFileChecker").Qc(()=>this.P$h()).Lc();this.oc.register(Wj,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Qc(()=>new Wj(ta.AFrameworkApplication.Kb,Rd.FocusManager.instance())).Lc()}P$h(){if(this.ya.ka("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const H=
Object(kd.f)(rl.a);if(H&&H.R3f)return new fj(()=>H.Rd("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>ta.AFrameworkApplication.Wh,()=>new Date,()=>ta.AFrameworkApplication.yx,H,Object(kd.f)(ql),()=>wj.instance,Object(kd.d)(Uk.a))}return new al(()=>this.ya.Rd("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.ya.Rd("RenamedFileCheckerPingIntervalInMs",12E4),()=>ta.AFrameworkApplication.Wh,()=>new Date,()=>ta.AFrameworkApplication.yx,ta.AFrameworkApplication.ea,ta.AFrameworkApplication.Kb,ta.AFrameworkApplication.Rj,
Object(kd.f)(ql),Object(kd.d)(Bh.a))}init(){this.ya.hr(this.LC)}dispose(){}}Object(ia.a)(Sl,"PackageManager",null,[11,12]);var dm=a(263),Al=a(81),Bl=a(259);class pk extends Pg.a{constructor(H){super();this.Lzd=this.renameFileManager=null;this.$=H;this.ri()}create(){if(!this.Lzd){const H=Bl.a.jfb(this.Aa,"Task","IRenameFileManager",pd.EwaSettings.Og()?null:Bd.telemetryManager());this.Lzd=H.task;const ha=kc.HostMessengerService.Oa()?Object(Qe.d)(Sb.a.resolve(kc.HostMessengerService,{xa:this.Cc})):Al.GetServiceTaskFactory.create(this.$.ra,
137,this.Aa,this.Cc),Ya=Object(Qe.d)(Sb.a.resolve(kc.CommonUIStringsService,{xa:this.Cc})),Wb=kc.CoauthManagerService.Oa()?Object(Qe.d)(Sb.a.resolve(kc.CoauthManagerService)):dm.a.Va(null);Kf.TaskExtensions.tb(Kf.TaskExtensions.jl([Ya,ha,Wb],this.Aa),()=>{const Sc=new xf(this.$,ha.result,Wb.result);this.$.ra.zc(120,Sc);H.setResult(Sc)},this.Aa,3)}this.Lzd.continueWith(H=>{this.Uf(H.result)})}dispose(){Ca.a.vb(this.renameFileManager);this.$=this.renameFileManager=null;super.dispose()}static Ea(H){H.ra.zc(119,
new pk(H))}}Object(ia.a)(pk,"RenameFileManagerServiceFactory",Pg.a,[]);var Tl=a(1112);class Ul extends Pg.a{constructor(){super();this.ri()}create(){this.Uf(new Tl.a)}}Object(ia.a)(Ul,"CommonUIJsServiceFactory",Pg.a,[]);var em=a(1224),Vl=a(1208);class gi{}Object(ia.a)(gi,"LokiTokenResult",null,[]);class bl{constructor(H){this.ygc=H}AMd(){const H=this.LUi();return H?bl.o_a?new Promise((ha,Ya)=>{this.ygc.continueWith(()=>{this.ygc.fi||this.ygc.Ng?Ya(Error.create("Error downloading auth library")):this.ygc.result.ey("Loki",
H).then(Wb=>{Wb=ta.AFrameworkApplication.ea.ka("ForceLokiFallbackToACLPTokenIsEnabled")?this.OUi():Wb.IsSuccess&&Wb.Token?Object.assign(new gi,{isSuccess:!0,token:Wb.Token,errorMessage:null}):Object.assign(new gi,{isSuccess:!1,token:null,errorMessage:JSON.stringify(Wb)});ha(Wb);return Wb})})}):Promise.resolve(Object.assign(new gi,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new gi,{isSuccess:!1,token:null,
errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",Vl.a.QFf())}))}OUi(){const H=ta.AFrameworkApplication.ea.Qa("LokiUserDataSignature")||"";return Object.assign(new gi,{isSuccess:!0,token:H,errorMessage:null})}LUi(){let H=null;const ha=Vl.a.Jyc();2===ha?H=ta.AFrameworkApplication.ea.Qa("LokiAADAppId"):1===ha&&(H=ta.AFrameworkApplication.ea.Qa("LokiMSAAppId"));return H}static get o_a(){return ta.AFrameworkApplication.ea.ka("IsO365CommercialHost")||ta.AFrameworkApplication.ea.ka("IsO365ConsumerHost")}}
Object(ia.a)(bl,"LokiTokenManager",null,[603]);var Wl=a(613);class cl{get name(){return"Common.App.LivePersonaUtils"}init(){Object(kd.a)(em.a)}dispose(){}ji(H){H.register(bl,"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").Lc().Qc(()=>new bl(Wl.a.Jq(Object(kd.d)(tj.b))))}static main(){Pe.a.instance.Qi(new cl)}}Object(ia.a)(cl,"LivePersonaUtilsPackage",null,[11,12]);const fm=Object(kd.b)("Common.App.SaveStatus.SaveStatusUIHandler"),Xl=Object(kd.c)(fm),Yl=Object(kd.b)("Common.App.SaveStatus.ReactSaveStatusUIHandler"),
Cl=Object(kd.c)(Yl),zk=Object(kd.b)("Common.App.SaveStatus.SaveStatusPostMessageHandler"),Dl=Object(kd.c)(zk);var dl=a(1225);class El{constructor(H){this.tpa=this.kpa=this.fha=this.taa=null;this.hbd=this.m9a=this.kdc=this.oec=this.SQe=this.LB=this.jP=!1;this.Rhd=this.jRe=null;this.$Qe=0;this.ya=this.yBb=null;this.Q$=H;this.oA=3;this.$Ab=this.hBa=!0}initialize(H,ha,Ya){this.taa=this.aOd(H,ha);this.fha=Object(Bg.a)("SavingStatus");this.kpa=Object(Bg.a)("ReadOnlyStatus");this.tpa=Object(Bg.a)("ReviewModeStatus");
this.Q$&&this.Q$.execute(Wb=>{Wb.Dod(Object(fc.a)(this,this.A$b,"updateToSavingStatus"))});this.LB=!0;this.ya=Ya;this.kdc=this.ya.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIcons",!1);this.m9a=this.ya.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIconsWithStrings",!1);return!0}Lna(H,ha){this.jP=H;this.oA=ha;this.a_(this.hBa)}a_(H){!this.hBa&&H&&(this.yBb=new Date);this.hBa=H;this.hbd=!1;H=null;3===this.oA&&(H=this.hBa?this.taa:this.fha);
this.m9a&&this.oec&&(this.taa=Object(Bg.a)("SavedStatus"));this.Kpf(H)}Q2c(H){!this.$Ab&&H&&(this.yBb=new Date);this.$Ab=H;this.hbd=!1;H=null;3===this.oA&&(H=this.$Ab?this.taa:this.fha);this.Kpf(H)}aOd(H,ha){return H?String.format(Object(Bg.a)("SavedToStatus"),Object(Bg.a)("OneDriveName")):ha&&ha.length?String.format(Object(Bg.a)("SavedToStatus"),ha):Object(Bg.a)("SavedStatus")}A$b(){this.a_(!1)}LMd(){switch(this.oA){case 1:return this.kpa;case 2:return this.tpa;default:return null}}getMode(){if(3!==
this.oA)switch(this.oA){case 1:return"ReadOnly";case 2:return"ReviewOnly";default:return null}return this.hbd?"FailedToSave":this.hBa&&this.$Ab?"Saved":"Saving"}fpj(H){return this.SQe===this.jP&&this.$Qe===this.oA&&this.jRe===H}bCd(H){appChrome.getHeaderApi().then(ha=>{ha.updateDocumentTitleStatus(this.jP,H,this.LMd(),this.yBb,this.hBa&&this.$Ab,this.kdc||this.m9a?ha.getHeaderSaveStatusIconProps(this.getMode(),!1):null);"Saved"===this.getMode()&&this.m9a&&(this.Rid&&(window.clearTimeout(this.Rid),
this.Rid=null),this.Tid&&(window.clearTimeout(this.Tid),this.Tid=null),this.Rid=window.setTimeout(()=>{ha.updateDocumentTitleStatus(this.jP,H,this.LMd(),this.yBb,this.hBa,this.kdc||this.m9a?ha.getHeaderSaveStatusIconProps(this.getMode(),!0):null)},500),this.oec&&(this.Tid=window.setTimeout(()=>{ha.updateDocumentTitleStatus(!0,H,this.LMd(),this.yBb,this.hBa,this.kdc||this.m9a?ha.getHeaderSaveStatusIconProps(this.getMode(),!0):null)},3E3)));this.oec=!0;return null});this.Rhd=null}Kpf(H){this.LB&&cg.c()&&
!this.fpj(H)&&(!this.oec&&this.ya.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.bCd(H):mk.a.i4b()?(this.Rhd&&Z.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.Rhd=window.requestIdleCallback(()=>{this.bCd(H)})):window.requestAnimationFrame(()=>{this.bCd(H)}),this.SQe=this.jP,this.jRe=H,this.$Qe=this.oA)}}Object(ia.a)(El,"ReactSaveStatusUIHandler",null,[608]);class Ak{constructor(H,ha){this.yq=
null;this.taa=Object(Bg.a)("SavedStatus");this.fha=Object(Bg.a)("SavingStatus");this.kpa=Object(Bg.a)("ReadOnlyStatus");this.tpa=Object(Bg.a)("ReviewModeStatus");this.yec=ha;this.Q$=H;this.oA=3;this.YBa=!0}Yz(){this.Q$&&this.Q$.execute(H=>{H.Dod(Object(fc.a)(this,this.A$b,"updateToSavingStatus"))});this.yec.execute(H=>{this.yq=H})}Lna(H,ha){this.oA=ha;3===ha?this.a_(this.YBa):2===ha?this.Qye(this.tpa):this.Qye(this.kpa)}A$b(){this.a_(!1)}a_(H){this.YBa=H;this.Qye(this.YBa?this.taa:this.fha)}Qye(H){this.yq&&
this.yq.sendMessage(Zb.a.m$k,this.A2h(H))}A2h(H){const ha={};ha.StatusText=H;return ha}}Object(ia.a)(Ak,"SaveStatusPostMessageHandler",null,[608]);var yg=a(131),el=a(69);class Bk{constructor(H,ha,Ya,Wb){this.tpa=this.kpa=this.fha=this.taa=null;this.jQa=0;this.BJ=this.Qid=this.yOa=this.i7c=this.xRa=null;this.Ee=H;this.Jga=ha;this.Q$=Ya;this.Rk=Wb;this.aPe=!0;this.jP=!1;this.oA=3;this.YBa=!0}initialize(H,ha){if(!this.Ee)return!1;this.taa=this.aOd(H,ha);this.fha=Object(Bg.a)("SavingStatus");this.kpa=
Object(Bg.a)("ReadOnlyStatus");this.tpa=Object(Bg.a)("ReviewModeStatus");this.Yz();return!0}aOd(H,ha){return H?String.format(Object(Bg.a)("SavedToStatus"),Object(Bg.a)("OneDriveName")):ha&&ha.length?String.format(Object(Bg.a)("SavedToStatus"),ha):Object(Bg.a)("SavedStatus")}Yz(){this.Jga&&this.Jga.execute(H=>{H.xFh(Object(fc.a)(this,this.Hlf,"createStatusAndModeElements"));H.qFh(Object(fc.a)(this,this.zVk,"showHideSaveStatusElement"));H.K6k&&this.Hlf(null,null)});this.Q$&&this.Q$.execute(H=>{H.Dod(Object(fc.a)(this,
this.A$b,"updateToSavingStatus"))})}kA(){this.BJ&&this.Ee&&this.Ee.XL(this.BJ)}zVk(H,ha){this.Lna("true"===ha,this.oA)}Lna(H,ha){this.jP=H;this.oA=ha;this.i7c&&(this.i7c.style.display=this.jP||3===this.oA||!this.xRa?"none":"");this.yOa&&(this.yOa.style.display=this.jP||3===this.oA?"none":"",this.yOa.innerText=1===this.oA?this.kpa:this.tpa,this.yOa.title=1===this.oA?Object(Bg.a)("ReadOnlyStatusTooltip"):Object(Bg.a)("ReviewModeStatusTooltip"));this.Qid&&(this.Qid.style.display=this.jP||1===this.oA||
!this.xRa&&!this.yOa?"none":"");this.BJ&&(this.BJ.style.display=this.jP||1===this.oA?"none":"",this.a_(this.YBa),this.BJ.title=Object(Bg.a)("SaveStatusTooltip"))}Hlf(H,ha){H=document.getElementById(Th.a.uTf);ha&&ha.Dkl||!H||""===this.taa||""===this.fha||""===this.kpa||""===this.tpa||(this.xRa=document.getElementById(Th.a.doc),this.i7c=Th.a.iEa(H,"BreadcrumbAppModeDash","-",null,!1),this.yOa=Th.a.iEa(H,"BreadcrumbAppModeStatus",1===this.oA?this.kpa:this.tpa,null,!1),this.y7g(this.yOa),this.Qid=Th.a.iEa(H,
"BreadcrumbSaveStatusDash","-",null,!1),this.BJ=Th.a.iEa(H,"BreadcrumbSaveStatus",this.taa,null,!1),this.y7g(this.BJ),this.Lna(this.jP,this.oA))}A$b(){this.a_(!1)}a_(H){this.YBa=H;this.ffl(this.YBa?this.taa:this.fha)}ffl(H){!this.BJ||3!==this.oA&&2!==this.oA||(this.aPe&&!this.YBa?(this.jQa=this.BJ.offsetWidth<this.jQa?this.jQa:this.BJ.offsetWidth,this.xbl(this.fha),this.aPe=!1):this.BJ.innerText=H)}y7g(H){H.style.direction=this.Rk?"rtl":"ltr";H.style.width="auto";H.style.textAlign=this.Rk?"right":
"left";H.style.display=this.jP?"none":"";H.setAttribute("Unselectable","on")}xbl(H){this.BJ&&(this.BJ.style.width="",this.BJ.innerText=H,this.jQa=this.BJ.offsetWidth<this.jQa?this.jQa:this.BJ.offsetWidth,H=yg.a.Ez(this.BJ),this.BJ.style.width=this.jQa-el.a.GI(H.paddingLeft)-el.a.GI(H.paddingRight)+1+"px")}}Object(ia.a)(Bk,"SaveStatusUIHandler",null,[608]);var D=a(107);class ma{constructor(){this.Sid=this.Dhd=this.$Qa=this.oc=null;this.LC=()=>{const H=ta.AFrameworkApplication.ea,ha=!!ta.AFrameworkApplication.ua.Ab&&
4===ta.AFrameworkApplication.ua.Ab.gi;if(H.ka("WordEditorAutoSaveImprovementIsEnabled")||H.ka("PptEditorSaveStatusInHeaderEnabled")||ha&&H.ka("SimplifiedReactRibbonUxIsEnabled")||H.ka("ExcelSaveStatusInHeaderEnabled")||H.ka("VisioSaveStatusInHeaderEnabled"))ta.AFrameworkApplication.ea.ka("PostMessageEmbedded")&&ta.AFrameworkApplication.hideHeaderEmbedded?(this.Sid=Object(kd.a)(Dl))&&this.Sid.Yz():ta.AFrameworkApplication.ua.Ab.p5f||ta.AFrameworkApplication.hideHeader||(ta.AFrameworkApplication.ua.Ab.ms?
(this.Dhd=Object(kd.a)(Cl))&&this.Dhd.initialize(H.ka("IsSkyDrive"),H.Qa("HostNameToIncludeInSavedStatus"),ta.AFrameworkApplication.ea):(this.$Qa=Object(kd.a)(Xl))&&this.$Qa.initialize(H.ka("IsSkyDrive"),H.Qa("HostNameToIncludeInSavedStatus")))}}get name(){return"Common.App.SaveStatus"}ji(H){this.oc=H;ta.AFrameworkApplication.ea.ka("PostMessageEmbedded")&&ta.AFrameworkApplication.hideHeaderEmbedded?this.oc.register(Ak,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Lc().Qc(()=>
new Ak(Object(kd.d)(dl.a),Object(kd.d)(Uk.a))):ta.AFrameworkApplication.ua.Ab.p5f||(ta.AFrameworkApplication.ua.Ab.ms?this.oc.register(El,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Lc().Qc(()=>new El(Object(kd.d)(dl.a))):this.oc.register(Bk,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Lc().Qc(()=>new Bk(D.EventHandlerManager.instance,Object(kd.d)(vl.a),Object(kd.d)(dl.a),ta.AFrameworkApplication.isRtl)))}init(){ta.AFrameworkApplication.ea.hr(this.LC)}dispose(){this.$Qa&&
this.$Qa.kA()}}Object(ia.a)(ma,"PackageManager",null,[11,12]);var vb=a(1484);class lc{constructor(H,ha){this.qXe=this.vcd=!1;this.qKa=(Ya,Wb)=>{(null===Wb||void 0===Wb?0:Wb.$H)&&eb.a.SKh([Wb.$H])&&(this.a5b=!0)};this.Ln=()=>{this.a5b=!1};this.yd=(Ya,Wb)=>{Gg.b(Wb)&&this.Lna(!0);this.a5b=!1};this.de=()=>{this.hU=this.$.hU;this.Lna()};this.Xrg=()=>{this.a_()};this.Zqg=()=>{this.hU=this.$.hU};this.P8d=()=>{Hd.f(this.$).za.Gq(this.P8d);this.hU=this.$.hU};this.Wea=ha;this.$=H;this.$.userOperationManager.Kp(this.Zqg);
this.$.Ul(this.de);this.$.fa.XFh(this.Xrg);this.$.fa.Vk(this.yd);this.$.Clc(this.qKa);this.$.fa.LJ(this.Ln);this.Lna()}get MAj(){return this.$.fa?this.$.fa.f1d:!1}get hU(){return this.vcd}set hU(H){H?this.vcd=!0:Hd.f(this.$)&&Hd.f(this.$).za&&(Hd.f(this.$).za.W7()?this.vcd=!1:Hd.f(this.$).za.Or(this.P8d));this.a_()}get a5b(){return this.qXe}set a5b(H){this.qXe=H;this.a_()}dispose(){this.$&&(this.$.tm(this.de),this.$.kUc(this.qKa),this.$.userOperationManager&&this.$.userOperationManager.kn(this.Zqg),
this.$.fa&&(this.$.fa.Fuk(this.Xrg),this.$.fa.Qk(this.yd),this.$.fa.zL(this.Ln)),Hd.f(this.$)&&Hd.f(this.$).za&&Hd.f(this.$).za.Gq(this.P8d))}Lna(H){H=!this.$.isEditMode||(void 0===H?!1:H);this.Wea.Lna(H,this.$.isEditMode?3:1);this.a_()}a_(){this.$.isEditMode&&this.Wea.a_(!this.hU&&!this.MAj&&!this.a5b)}}Object(ia.a)(lc,"SaveStatusManager",null,[4]);class Nc extends Pg.a{constructor(H){super();this.Ad=H;this.ri()}create(){const H=Ol.a.instance;Object(kd.d)(vb.a).execute(ha=>{const Ya=new lc(this.Ad,
ha);H.register(lc,"Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager").Lc().Qc(()=>Ya);ha=Object(Qg.a)(this.Ad.ra,300,()=>H.resolve("Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager"));this.Uf(ha)})}static Ea(H){H.ra.zc(299,new Nc(H))}}Object(ia.a)(Nc,"SaveStatusFactory",Pg.a,[]);var wd=a(677),Yd=a(493),ee=a(437),ae=a(1226);class he{x$h(H,ha){if(H&&!(1>H.length)&&ha){var Ya=Object.assign(new ee.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.L7h(H,Ya.ControlList);
ha.push(Ya)}}L7h(H,ha){const Ya=Object.assign(new wd.a,{ExternalId:"ContextCoauthors",LabelText:Object(Bg.a)("PresenceMenuSectionTitle"),Menu:Object.assign(new Yd.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(ha,Ya);ha=Object.assign(new ee.a,{Title:"",ControlList:[]});Array.add(Ya.Menu.MenuSectionList,ha);this.a$h(H,ha.ControlList)}a$h(H,ha){for(let Ya=0;Ya<H.length;Ya++){const Wb=Object.assign(new ae.a,{ExternalId:String.format("CoauthorPersona_{0}",
Ya),Command:"336231556",DisplayName:H[Ya].userName,LabelText:H[Ya].userName,ImageBackColor:H[Ya].color,PersonaId:H[Ya].email,IsAnonymous:H[Ya].isAnonymous});Array.add(ha,Wb)}}}Object(ia.a)(he,"PresenceContextMenuSectionBuilder",null,[606]);const De=Object(kd.b)("CommonUI.IBusinessBarEntryFactory");var Se=a(1227),qf=a(670);class kg{constructor(H,ha,Ya,Wb){this.hIe=this.G$=this.Ik=this.oJ=this.jga=null;this.JMh=()=>{this.Jic.x9e()};this.ty=Sc=>{1===Sc?(qf.a.tea(),this.showDialog(Object(Bg.a)("AuthenticationLostSigninInProgressMessage")),
ta.AFrameworkApplication.Kb.hf(yb.a.H1d,2)):(this.Pub(),ta.AFrameworkApplication.Kb.hf(yb.a.Mcf,2))};this.kSh=()=>{this.mhi();ta.AFrameworkApplication.Kb.hf(yb.a.Lcf,2)};this.Jic=H;this.ouh=Wb;this.Jic.QHa&&(this.Ik=new Wa.a(3,2,5E3,this.JMh,2),ta.AFrameworkApplication.Rj.Ag(this.Ik),this.wi(ha,Ya));this.Jic.uFb(()=>{this.ujg()});this.Jic.Obb(()=>{this.vjg()})}get businessBar(){return this.G$||(this.G$=Object(kd.f)(Se.a))}get Qaf(){return this.hIe||(this.hIe=Object(kd.f)(De))}wi(H,ha){const Ya=ta.AFrameworkApplication.Kb;
Ya.ef(yb.a.authenticationLost,wh.a.frame,H,96);Ya.ef(yb.a.y9e,wh.a.frame,ha,96);Ya.jc(yb.a.Lcf,wh.a.frame,kk.ActionManager.nCd);Ya.jc(yb.a.Mcf,wh.a.frame,kk.ActionManager.nCd);Ya.jc(yb.a.H1d,wh.a.frame,kk.ActionManager.nCd)}ujg(){this.showDialog(Object(Bg.a)("AuthenticationLostMessage"));ta.AFrameworkApplication.Kb.hf(yb.a.authenticationLost,2)}vjg(){this.s3k();ta.AFrameworkApplication.Kb.hf(yb.a.y9e,2)}s3k(){this.oJ&&(this.oJ.hide(),this.oJ.dispose(),this.oJ=null);this.jga&&this.businessBar&&(ta.AFrameworkApplication.Sf||
this.businessBar.removeEntry(this.jga),this.jga.dispose(),this.jga=null)}showDialog(H){Ca.a.vb(this.oJ);this.oJ=new Qj.a;this.ouh||(this.oJ.ov=!1,this.oJ.hc=0);this.oJ.Ic(1,Object(Bg.a)("SignIn"));this.oJ.XR(Object(Bg.a)("DefaultDialogTitle"),H,this.ty)}Pub(){this.businessBar&&this.Qaf&&(this.jga=this.Qaf.create(Object(Bg.a)("AuthenticationLostTitle"),Object(Bg.a)("AuthenticationLostMessage"),null),this.jga.closeable=!0,this.jga.addButton(Object(Bg.a)("SignIn"),kg.iSh,""),this.jga.mT=this.kSh,this.businessBar.pz(this.jga,
!1))}mhi(){this.Ik&&(ta.AFrameworkApplication.Rj.Xr(this.Ik),this.Ik=null)}dispose(){this.Ik=this.oJ=this.jga=null}static iSh(){qf.a.tea();ta.AFrameworkApplication.Kb.hf(yb.a.H1d,2)}}Object(ia.a)(kg,"SignOutResponseUI",null,[4]);class $f{get name(){return"Common.App.UI"}ji(H){H.register(he,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").Lc()}init(){}dispose(){Ca.a.vb($f.T5);$f.T5=null}static main(){Pe.a.instance.Qi(new $f)}}$f.T5=null;Object(ia.a)($f,
"CommonAppUIPackage",null,[11,12]);var Cg=a(180),sg=a(738);class ng extends sg.a{constructor(){super()}dispose(){Cg.WacAirSpace.BUd()&&Cg.WacAirSpace.g1c()}animate(H,ha,Ya,Wb,Sc){ha&&Cg.WacAirSpace.KV(H.element,ha);Cg.WacAirSpace.animate(H,Wb,Sc);Ya&&Cg.WacAirSpace.Zpk(H.element,Ya)}}Object(ia.a)(ng,"AnimationManager",sg.a,[4]);var eh=a(122);class yh extends Pg.a{constructor(H){super();this.$=H;this.ri()}create(){ta.AFrameworkApplication.ea.ka("RefreshAccessTokenSilently")?this.Uf(this.z7h()):this.Uf(this.$.ra.Tb(38)||
this.$.ra.zc(38,new Wc(this.$)))}z7h(){var H=this.$.ra.Tb(38);if(H)return H;H=new ud(ta.AFrameworkApplication.Rj,ta.AFrameworkApplication.Jz(),new Ud);return this.$.ra.zc(38,new Tb(this.$,H))}static Ea(H){H.ra.zc(39,new yh(H))}}Object(ia.a)(yh,"AccessTokenExpirationManagerFactory",Pg.a,[]);var Ph=a(1228),Yj=a(1229),Kj;(function(H){H[H.generalException=0]="generalException";H[H.invalidArgument=1]="invalidArgument";H[H.Chg=2]="notAllowed";H[H.xmc=3]="apiNotAvailable";H[H.Pal=4]="unresolvedPendingRequest";
H[H.timeout=5]="timeout";H[H.mnd=6]="adalTimeout";H[H.S$b=7]="userNotSignedIn";H[H.Zwb=8]="userAborted";H[H.jYg=9]="silentSignInFailed";H[H.Bkb=10]="invalidResourceUrl";H[H.Akb=11]="invalidGrant";H[H.Khf=12]="connectionLost";H[H.bqc=13]="clientError";H[H.serverError=14]="serverError"})(Kj||(Kj={}));Object(ia.b)("ErrorCodes",Kj);a(1489);class sm{constructor(H,ha){this.requestCallback=this.requestParameters=null;this.requestParameters=H;this.requestCallback=ha}}Object(ia.a)(sm,"OutstandingRequest",
null,[]);class Ti{}Ti.XPj="AADSTS50058";Ti.Bkb="AADSTS50001";Ti.SPj="AADSTS65001";Ti.kQj="AADSTS70011";Ti.Zwb="13002";Ti.$ck="Popup Window is null";Ti.Zck="Popup Window closed";Ti.mnd="Token renewal operation failed due to timeout";Ti.m6k="tokenRevoked";Object(ia.a)(Ti,"WopiHostErrorType",null,[]);var Fl=a(609),Lm=a(686),Mm=a(1488);class tm{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(ia.a)(tm,"WopiIdentityInfo",null,[373]);class um{constructor(H,
ha,Ya){this.expiration=this.authority=this.accessToken=null;this.accessToken=H;this.authority=ha;this.expiration=Ya}}Object(ia.a)(um,"WopiIdentityToken",null,[372]);var Nm=a(1022);class gm{constructor(H){this._initialized=!1;this.C3j=ha=>{let Ya=null;try{const Sc=ha.Values.RequestId,zd=ha.Values.AuthToken,be=ha.Values.IdentityType,oe=ha.Values.TokenExpiration;let Ke=null,Xe=null;const ig=this.cqb[Sc];if("undefined"!==typeof ig&&ig){var Wb=[];Array.add(Wb,{name:"CorrelationId",string:ig.requestParameters.correlationId});
Jh.a.sendTelemetryEvent({name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:Wb});Ya=ig.requestCallback;delete this.cqb[Sc];"undefined"!==typeof zd&&zd&&zd.length?Xe=new um(zd,be,oe):Ke=Kj[this.MJj(ha)];Wb="getAccessToken_"+Sc;Wb in this.G_c&&(this.G_c[Wb].stop(),delete this.G_c[Wb]);Ya(Xe,Ke)}else Z.ULS.sendTraceTag(37856066,344,10,Pd.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:Sc}))}catch(Sc){ha=ha.Values.RequestId,ha in this.cqb&&delete this.cqb[ha],
this.CKc(),Z.ULS.sendTraceTag(37856067,344,10,Pd.c({["error"]:Sc.message,["stack"]:Sc.stack})),Ya&&Ya(null,"generalException")}};this.cqb={};this.G_c={};this.YV=ta.AFrameworkApplication.ua.KE;this.mSd=H}IVa(H){this._initialized||(H.nl(Zb.a.cyg),H.ik(Zb.a.cyg,this.C3j),this._initialized=!0)}getAccessToken(H,ha,Ya){Ya=void 0===Ya?null:Ya;this.UN(H,ha);return new Promise((Wb,Sc)=>{if(this.AUd(ha))if(ha in this.cqb)Sc("unresolvedPendingRequest");else{var zd=window.setTimeout(()=>{Z.ULS.sendTraceTag(37856032,
344,10,Pd.c({["error"]:"Request timeout.",["callerId"]:ha}));Sc("timeout")},12E4);this.NOb(H,ha,Ya,(be,oe)=>{window.clearTimeout(zd);be?Wb(be):(Z.ULS.sendTraceTag(37856033,369,15,Pd.c({["error"]:Kj[oe]})),Sc(oe))})}else Z.ULS.sendTraceTag(37856034,344,10,Pd.c({["error"]:"Caller is not allowed."})),Sc("notAllowed")})}getPrimaryIdentityInfo(H){return new Promise((ha,Ya)=>{this.AUd(H)?this.AYi((Wb,Sc)=>{Wb?ha(Wb):(Z.ULS.sendTraceTag(37856064,369,10,Pd.c({["error"]:Sc.toString()})),Ya(Sc))}):(Z.ULS.sendTraceTag(37856065,
344,10,Pd.c({["error"]:"Caller is not allowed."})),Ya("notAllowed"))})}getAuthContext(H){return new Promise((ha,Ya)=>{const Wb=this.getAuthContextSync(H);Wb?ha(Wb):Ya("notAllowed")})}getAuthContextSync(H){if(this.AUd(H)){const ha=new Mm.a;ha.upn=ta.AFrameworkApplication.ea.Qa("UserPrincipalName");ha.userId=ta.AFrameworkApplication.ea.Qa("LoggableUserId");ha.authority=ta.AFrameworkApplication.ea.Qa("HostAuthAuthority");ha.tenantId=ta.AFrameworkApplication.ea.Qa("TenantId");ha.isAnonymous=ta.AFrameworkApplication.ea.ka("IsAnonymousUser");
ha.supportsAuthToken=this.idj(H);H=ta.AFrameworkApplication.ea.Qa("HostAuthType");ha.hostPageSupportsAuth=Fl.a.hostPageSupportsAuth;ha.authenticationApiEnabled=Object(Nm.a)();ha.authorityType="aad"===H.toLowerCase()?2:"msa"===H.toLowerCase()?1:0;return ha}Z.ULS.sendTraceTag(40751647,344,10,Pd.c({["error"]:"Caller is not allowed."}));return null}idj(H){const ha=Fl.a.hostPageSupportsAuth,Ya=ta.AFrameworkApplication.ea.Qa(ta.AFrameworkApplication.fW);return"teams"===(null===Ya||void 0===Ya?void 0:Ya.toLowerCase())||
Uf.a.CIa?ha&&Fl.a.w1g?Array.contains(Fl.a.w1g,H.toLowerCase()):!1:ha}NOb(H,ha,Ya,Wb){var Sc=[];Array.add(Sc,{name:"CallerId",string:ha});Array.add(Sc,{name:"CorrelationId",string:H.correlationId});Jh.a.sendTelemetryEvent({name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:Sc});Sc=Lm.a.create().toString();const zd="getAccessToken_"+Sc,be=this.YV.Uc("ComponentAttach",zd);this.G_c[zd]=be;const oe={};oe.RequestId=Sc;oe.Resource=H.resource;oe.Scope=H.scope;oe.IdentityType=
ta.AFrameworkApplication.ea.Qa("HostAuthType");oe.Upn=ta.AFrameworkApplication.ea.Qa("UserPrincipalName");oe.SilentLogin=H.silentLogin;oe.Claims=H.options;oe.CorrelationId=H.correlationId;oe.ClientId=ha;Ya&&(oe.AddinName=Ya.AddinName,oe.AddinTrustId=Ya.AddinTrustId);this.mSd.execute(Ke=>{this.IVa(Ke);Ke.sendMessage(Zb.a.getAuthToken,oe)});this.cqb[Sc]=new sm(H,Wb)}AYi(H){const ha=ta.AFrameworkApplication.ea.Qa("UserName"),Ya=ta.AFrameworkApplication.ea.Qa("UserPrincipalName"),Wb=ta.AFrameworkApplication.ea.Qa("LoggableUserIdSpace"),
Sc=new tm;Sc.email=Ya;Sc.displayName=ha;switch(Wb){case "OrgIdPuid":Sc.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":Sc.authority="MicrosoftAccount";break;default:Sc.authority=Wb}H(Sc,null)}AUd(H){var ha=ta.AFrameworkApplication.L5i();H=H.toLowerCase();for(const Ya of ha)if(H===Ya.toLowerCase())return!0;ha=Fl.a.fqd;for(const Ya in ha)if(H===ha[Ya].toLowerCase())return!0;return!1}MJj(H){H=H.Values.Error;this.CKc();Z.ULS.sendTraceTag(39068821,344,50,Pd.c({["error"]:H}));
return H?-1<H.indexOf(Ti.XPj)?9:-1<H.indexOf(Ti.$ck)||-1<H.indexOf(Ti.Zck)?12:-1<H.indexOf(Ti.Bkb)?10:-1<H.indexOf(Ti.Zwb)?8:-1<H.indexOf(Ti.kQj)||-1<H.indexOf(Ti.SPj)||H===Ti.m6k?11:-1<H.indexOf(Ti.mnd)?6:0:13}UN(H,ha){H=this.Jmk(H.resource);Z.ULS.sendTraceTag(39921882,344,50,Pd.c({["callerId"]:ha,["resource"]:H}))}CKc(){Z.ULS.sendTraceTag(39068822,344,50,Pd.c({["userAgent"]:window.navigator.userAgent}))}Jmk(H){return(H?H:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}
Object(ia.a)(gm,"WopiIdentityManager",null,[370]);class hm{constructor(){this.oc=null;this.LC=()=>{try{Object(kd.a)(Yj.b)}catch(H){Z.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+H)}}}get name(){return"Common.App.WopiIdentity"}ji(H){this.oc=H;H.register(gm,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").Lc().Qc(()=>new gm(Object(kd.d)(Uk.a)))}init(){ta.AFrameworkApplication.ea&&ta.AFrameworkApplication.ea.hr(this.LC)}dispose(){}static main(){Pe.a.instance.Qi(new hm)}}
Object(ia.a)(hm,"WopiIdentityPackage",null,[11,12]);const Om=Object(kd.b)("Common.App.FloatPane.IFloatPaneFactory"),Pm=Object(kd.c)(Om),Qm=Object(kd.b)("Common.App.FloatPane.IFloatPaneActor"),vm=Object(kd.c)(Qm);class im{constructor(H,ha,Ya){this.mRa=null;this.n7b=()=>{this.mRa=null;Z.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.oMe.display()};this.hVk=(Wb,Sc,zd,be,oe)=>Wb!==yb.a.n7b?2:1===zd?32:2===zd&&oe?(Z.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",
oe),oe?this.aFg():(this.mRa?(Z.ULS.sendTraceTag(23674914,207,50,"Hide float pane via removing show task!"),this.Ve.Xr(this.mRa)):(Z.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.oMe.remove(null)),this.mRa=null),32):8;this.Ve=H;this.pb=ha;this.oMe=Ya.create()}aFg(){this.mRa?Z.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(Z.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),this.mRa=new Wa.a(2,1,3E4,this.n7b,
67),this.Ve.Ag(this.mRa))}uL(){this.pb.jc(yb.a.n7b,wh.a.frame,this.hVk)}}Object(ia.a)(im,"FloatPaneActor",null,[604]);var Rm=a(884),Sm=a(165);class wm{constructor(H,ha,Ya,Wb,Sc){this.Ged=this.KAb=this.Ghc=this.mpa=this.GW=this.pA=this.X7c=this.BS=this.zCb=this.LBb=this.MBb=this.nad=null;this.k1j=()=>{const zd=this.ya.Rd("O365AdPaneShowingDuration",60);this.Hrc();this.BS.style.display="block";this.BS.style.height=this.GW.height+"px";this.KAb=new Wa.a(2,1,1E3*zd,Object(fc.a)(this,this.hide,"hide"),
67);this.Ve.Ag(this.KAb);this.bGg()};this.j1j=()=>{Z.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.bGg();this.GW=null};this.org=()=>{Z.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1};this.onClose=()=>{this.KAb&&this.Ve.Xr(this.KAb);this.hide();return!0};this.Ve=ha;this.ya=H;this.xo=Ya;this.oc=Sc;this.fM=Wb}Hrc(){this.BS=document.createElement("div");this.BS.className=String.format("{0} {1}",
"WACFloatPane","WACFloatPaneFadeIn");this.BS.style.width=this.GW.width+"px";(this.Ged=this.HWi(this.fM))?(this.mpa=document.createElement("a"),this.mpa.setAttribute(Cj.a.Ae,Cj.a.cu),this.xo.va(ah.a.click,this.mpa,this.org),this.mpa.href=this.Ged,this.mpa.target="_blank",this.mpa.appendChild(this.GW),this.BS.appendChild(this.mpa)):this.BS.appendChild(this.GW);this.pA=document.createElement("a");this.pA.setAttribute(Cj.a.Ae,Cj.a.HA);this.pA.className="StandardButton WACFloatPaneCloseButton";this.pA.title=
Object(Bg.a)("Close");this.pA.tabIndex=-1;this.X7c=Sm.a(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",!0,null);this.X7c.setAttribute(Cj.a.Ae,Cj.a.cu);this.pA.appendChild(this.X7c);this.xo.va(ah.a.click,this.pA,this.onClose);this.BS.appendChild(this.pA);this.zCb.appendChild(this.BS)}ZSi(H){const ha=this.ya.ka("O365PromotionHasStarted");switch(H){case 2:return Ra.a.VDa(String.format("adppt{0}.png",ha?"sale":""));case 1:return Ra.a.VDa(String.format("adxls{0}.png",
ha?"sale":""));case 3:return Ra.a.VDa(String.format("addoc{0}.png",ha?"sale":""))}return null}HWi(H){const ha=this.ya.Qa("O365AdPaneRedirectedURL");switch(H){case 1:return String.format(ha,"Excel");case 2:return String.format(ha,"PowerPoint");case 3:return String.format(ha,"Word")}return null}hide(H){this.KAb=null;this.BS&&!this.Ghc&&((void 0===H?0:H)?Z.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):Z.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),
this.BS.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.BS.style.height="0px",this.Ghc=new Wa.a(2,1,1E3,Object(fc.a)(this,this.remove,"remove"),67),this.Ve.Ag(this.Ghc))}remove(){this.BS&&this.zCb&&(this.mpa&&this.xo.Ua(ah.a.click,this.mpa,this.org),this.xo.Ua(ah.a.click,this.pA,this.onClose),this.zCb.removeChild(this.BS),this.BS=null);this.Ghc=null}display(){if(this.nad=Object(kd.f)(Rm.a))if(this.zCb=this.nad.container){var H=this.ZSi(this.fM);H?(Z.ULS.sendTraceTag(23674908,
207,50,"Begin downloading image from server: {0}.",H),this.GW=document.createElement("img"),this.GW.className="WACFloatPaneImage",this.MBb=this.k1j,ei.a.addHandler(this.GW,ah.a.load,this.MBb),this.LBb=this.j1j,ei.a.addHandler(this.GW,ah.a.error,this.LBb),this.GW.src=H):Z.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else Z.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else Z.ULS.sendTraceTag(23674905,207,50,
"The IFloatPaneContainer is not registered and the float pane can't be shown.")}bGg(){this.MBb&&this.GW&&ei.a.removeHandler(this.GW,ah.a.load,this.MBb);this.MBb=null;this.LBb&&this.GW&&ei.a.removeHandler(this.GW,ah.a.error,this.LBb);this.LBb=null}dispose(){this.hide()}}Object(ia.a)(wm,"FloatPane",null,[626]);class jm{constructor(H,ha,Ya,Wb,Sc){this.Ve=ha;this.ya=H;this.xo=Ya;this.oc=Sc;this.fM=Wb}create(){return new wm(this.ya,this.Ve,this.xo,this.fM,this.oc)}}Object(ia.a)(jm,"FloatPaneFactory",null,
[605]);class km{constructor(){this.oc=null}get name(){return"Common.App.FloatPane"}get u0f(){return ta.AFrameworkApplication.ea.ka("O365AdvertisementIsEnabled")&&ta.AFrameworkApplication.ea.ka("IsShowAdvertisementPaneEnabled")}init(){this.u0f&&(Z.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),Object(kd.a)(vm).aFg(),Z.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),Object(kd.a)(vm).uL())}ji(H){this.oc=H;this.u0f&&(this.oc.register(jm,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").Qc(()=>
new jm(ta.AFrameworkApplication.ea,ta.AFrameworkApplication.Rj,fi.a.instance,ta.AFrameworkApplication.ua.Ab.gi,this.oc)).Lc(),this.oc.register(im,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").Qc(()=>new im(ta.AFrameworkApplication.Rj,ta.AFrameworkApplication.Kb,Object(kd.a)(Pm))).Lc())}dispose(){}static main(){Pe.a.instance.Qi(new km)}}Object(ia.a)(km,"FloatPanePackage",null,[11,12]);const Tm=Object(kd.b)("Common.App.DisplayEnvironmentName.DisplayEnvironmentName"),
Um=Object(kd.c)(Tm);class lm{constructor(H,ha){this.Yzb=null;this.Gcl=(Ya,Wb,Sc,zd,be)=>{if(1===Sc)return 32;be[oj.a.Value]=this.Yzb;be[Tj.a.Yi]=this.Yzb;be[oj.a.Visible]=!0;return 32};this.pb=H;this.ya=ha}wi(){(this.Yzb=this.ya.Qa("StatusBarEnvironmentNameToUse"))&&""!==this.Yzb&&this.pb.ef(yb.a.RAg,wh.a.frame,this.Gcl,96)}}Object(ia.a)(lm,"DisplayEnvironmentName",null,[]);class mm{constructor(){this.oc=null}get name(){return"Common.App.DisplayEnvironmentName"}ji(H){this.oc=H;this.oc.register(lm,
"Common.App.DisplayEnvironmentName.DisplayEnvironmentName").Lc().Qc(()=>new lm(ta.AFrameworkApplication.Kb,ta.AFrameworkApplication.ea))}init(){Object(kd.a)(Um).wi()}dispose(){}static main(){Pe.a.instance.Qi(new mm)}}Object(ia.a)(mm,"DisplayEnvironmentNamePackage",null,[11,12]);var xm=a(232),Zl=a(174);class nm extends xm.a{constructor(H){super();this.uE=()=>{this.TYa()};this.vwa=()=>{this.TYa()};this.$=H}dispose(){this.$&&Zl.a(this.$)&&(Zl.a(this.$).e4a(this.vwa),this.$.fa.xB(this.uE));this.$=null;
super.dispose()}vji(){ta.AFrameworkApplication.lva()&&!this.TYa()&&(Zl.a(this.$).OCa(this.vwa),this.$.fa.CD(this.uE))}TYa(){return this.$.isEditMode&&(ta.AFrameworkApplication.oVa||lh.a.Eg.ms)?(Zl.a(this.$).e4a(this.vwa),Kf.TaskExtensions.tb(Al.GetServiceTaskFactory.create(this.$.ra,119,this.Aa,1),H=>{H.result.initialize()},this.Aa,3),!0):!1}static main(){pj.a.wb(H=>{kc.RenameFileManagerService.Oa()||(new nm(H)).vji()})}}Object(ia.a)(nm,"FileOpSliceDownloaderBootStraper",xm.a,[]);var Ck=a(100),Vm=
a(536);class ym{constructor(H){this.E1=null;this.ubg=new Set;this.s5f=!1;this.K8=(ha,Ya)=>{if(!this.ubg.has(ha)){var Wb=[];if(Ya){const Sc=Hd.f(this.$).Eb.dg(Ya,!1);if(!Sc){1!==Ya.top||1!==Ya.left||this.s5f||(Wb.push(qd.a.Mf("IsTableOnA1","false",Xd.g.Boolean)),nd.a("MsFormsTableUsage",void 0,void 0,Wb),this.s5f=!0);return}if(1!==Sc.usedRange.top||1!==Sc.usedRange.left)return}Ya=Bd.resolveRibbonCommandName(ha);Wb.push(qd.a.Mf("Command",Ya,Xd.g.String));nd.a("MsFormsTableUsage",void 0,void 0,Wb);this.ubg.add(ha)}};
this.dAe=(ha,Ya)=>{if(!this.$.fa.Kh.get(61)||Ck.j(this.$.Pf))Ck.j(this.$.Pf)&&Ya&&Ya.item.name===this.E1.jQ&&this.L9e();else if(this.$.qa.Bl(this.E1.sOb)){const Wb={};Wb.SheetName=this.E1.sOb;Wb.NamedObjectName=this.E1.sOb;Wb.FirstColumn=0;Wb.FirstRow=0;Wb.LastColumn=0;Wb.LastRow=2;const Sc=be=>{if(!Ck.j(this.$.Pf)){if(null===be||void 0===be?0:be.Result)this.$.workbookContext.MsFormId=be.Result[0][0],this.E1.jQ=be.Result[1][0],be=be.Result[2][0],this.PR(!!this.$.workbookContext.MsFormId&&this.Fyj(be),
1024),this.L9e();Ck.c(this.$.Pf)&&(Ya?Z.ULS.sendTraceTag(537155357,0,50,`Created MsForm successfully, Form Id:${cd.a.qz(this.$.workbookContext.MsFormId).toString()}`):Z.ULS.sendTraceTag(537155356,0,50,`Reopening workbook that is connected to MsForm, Form Id:${cd.a.qz(this.$.workbookContext.MsFormId).toString()}`));Ck.c(this.$.Pf)&&!Ya&&Z.ULS.sendTraceTag(537155355,0,50,`reopening workbook that is connected to MsForm, Form Id:${cd.a.qz(this.$.workbookContext.MsFormId).toString()}`);!Ck.c(this.$.Pf)&&
Ya||this.PR(!0,2048)}},zd=this.$.ma.sa.mc();this.$.userOperationManager.rK(new Fc.a(159,0,(be,oe,Ke)=>se.s(this.$.ma.ZY,Wb,!1,Ic.c(be,Sc),oe,Ke,null,zd),16))}else Ya||this.PR(!0,2048)};this.M1j=(ha,Ya)=>{Ya&&Ya.item.name===this.E1.sOb&&(this.PR(!1,1024),this.PR(!0,2048))};this.$=H}v9k(){this.E1=Vm.a.current;this.dAe(null,null);this.$.qa.sqa(this.dAe);this.$.qa.i0(this.M1j)}dispose(){this.$.qa.zxa(this.dAe)}Fyj(H){if(!H)return!0;const ha=RegExp("-","g"),Ya=this.$.workbookContext.MsFormDocUrl.toLowerCase();
return Ya.includes(H.toLowerCase())||Ya.includes(H.toLowerCase().replace(ha,""))?!0:!1}L9e(){Ck.c(this.$.Pf)&&this.E1.jQ&&this.$.qa.la&&this.$.qa.la.name!==this.E1.jQ&&this.$.qa.Bl(this.E1.jQ)&&this.$.qa.getItemByName(this.E1.jQ).activate({scenario:"msForm"})}PR(H,ha){this.$.workbookContext.Options=lf.HelperMethods.OV(H,this.$.workbookContext.Options,ha)}}Object(ia.a)(ym,"MsFormInfoUpdatingService",null,[656,4]);class om extends Pg.a{constructor(H){super();this.msFormInfoUpdatingService=null;this.$=
H;this.ri()}create(){this.Uf(Object(Qg.a)(this.$.ra,237,()=>this.msFormInfoUpdatingService||(this.msFormInfoUpdatingService=new ym(this.$))));this.msFormInfoUpdatingService.v9k()}static Ea(H){H.ra.zc(236,new om(H))}}Object(ia.a)(om,"MsFormInfoUpdatingServiceFactory",Pg.a,[]);var zm=a(1490),Am=a(1114);class Dk{}Dk.z4k=864E5;Dk.PGh=3;Dk.ySj=144E5;Object(ia.a)(Dk,"AddinConstantsNum",null,[]);var Lj=a(948),Bm=a(1057),Ek=a(1024);class Cm{constructor(H,ha,Ya,Wb){this.ea=(Wb=void 0===Wb?null:Wb)?Wb:ta.AFrameworkApplication.ea;
this.$bd=2;this.NYa=H;this.Bwh=ha;this.Vb=Ya}get qua(){return this.$bd}get Ygl(){return this.Bwh}tle(H){if(this.ea.ka("AgaveSupportsLiveIdSpoofing")){var ha=(new Date).getTime();this.NYa(H,this.qua,{["ak0"]:ha})}else if(Ek.a.pSk(H)){ha=String.format(ta.AFrameworkApplication.ua.Ab.fR+"AddinServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}","laststoreupdate",ta.AFrameworkApplication.ua.Ab.gi,this.Ygl,ta.AFrameworkApplication.Uh);const Ya=ta.AFrameworkApplication.od;let Wb=null;this.Vb&&(Wb=this.Vb.Uc("ComponentAttach",
Bm.a[H]+Am.a[this.qua]));Ya.Wn(ha,1,null,null,!0,4,Sc=>{this.t7j(H,Sc.data.responseData);Wb&&Wb.stop()},Sc=>{Z.ULS.sendTraceTag(17438153,220,50,"GetLastUpdate request failed with {0}.",Sc.data.httpStatus);this.Gpb(H,1,"request failed");Wb&&Wb.stop()},null)}else Ek.a.kSf(H)?(ha=Ek.a.pFf(H),this.NYa(H,this.qua,{["ak0"]:ha})):this.ea.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&(this.eI?this.Gpb(H,1,"no local timestamp"):this.NYa(H,this.qua,null))}t7j(H,ha){if(ha&&""!==
ha)if(ha=Sys.Net.XMLDOM(ha)){Ek.a.vNa(Lj.a.s5e,((new Date).getTime()+Dk.ySj).toString(),H);let Ya=ha.getElementsByTagName("update");Ya&&Ya.length||(Ya=ha.getElementsByTagName("o:update"));Ya&&0<Ya.length?(ha=Date.parse(Ya[0].firstChild.nodeValue),Ek.a.pFf(H)<ha||Ek.a.kSf(H)?this.NYa(H,this.qua,{["ak0"]:ha}):this.Gpb(H,1,"outdate timestamp in reponse")):this.Gpb(H,2,"no timestamp in response")}else this.Gpb(H,1,"response data is invalid");else this.Gpb(H,1,"no responseData")}Gpb(H,ha,Ya){this.eI&&
this.NYa(H,this.qua,{["AddinServiceUserState"]:ha,["DiagnosticInfo"]:Ya})}get eI(){return this.ea.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&this.ea.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}}Object(ia.a)(Cm,"AddinCommandsAnonymousAPIInitializer",null,[645]);class Gl{constructor(H,ha,Ya){this.$bd=Ya;this.NYa=H;this.Xi=ha}get qua(){return this.$bd}tle(H){let ha=null;this.Xi&&(ha=this.Xi.Uc("ComponentAttach",Bm.a[H]+Am.a[this.qua]));if(null==
this.ese(H)?0:this.ese(H)){const Ya=(new Date).getTime()-Dk.PGh*Dk.z4k;this.NYa(H,this.qua,{["ak0"]:Ya})}ha&&ha.stop()}}Object(ia.a)(Gl,"AddinCommandsInitializerBase",null,[645]);class Dm extends Gl{constructor(H,ha){super(H,ha,5)}ese(){return!0}}Object(ia.a)(Dm,"AddinCommandsInitializer",Gl,[]);class Em extends Gl{constructor(H,ha){super(H,ha,1)}ese(H){try{const ha=Lj.a.IIf()+H;return Boolean.parse(this.mLi(ha)||"false")}catch(ha){Z.ULS.sendTraceTag(17306844,220,50,"LocalStorage is not allowed, {0}.",
ha.toString())}return null}mLi(H){const ha=localStorage;return void 0!==ha&&null!==ha?ha.getItem(H):null}}Object(ia.a)(Em,"AddinCommandsLocalCacheInitializer",Gl,[]);var Wm=a(666);class pm{constructor(H,ha){ha=void 0===ha?null:ha;this.Vb=H;this.ea=ha?ha:ta.AFrameworkApplication.ea}get appUILocale(){return Wm.a.kN(ta.AFrameworkApplication.lcid).name}Pgj(){const H=this.UJd();if(H)if(this.ea.ka("OcpsIsEnabled"))Object(kd.d)(Sf.a).execute(ha=>{ha.isFeatureEnabled("ConnectedServices",!0).then(Ya=>{for(const Wb of H){if(!Ya&&
0===Wb.key){this.eI&&this.Z3g(0,Wb.value,{["AddinServiceUserState"]:3,["DiagnosticInfo"]:"connected services is off"});continue}const Sc=this.IEf(Wb.value);Sc&&Sc.tle(Wb.key)}return null})});else for(const ha of H){const Ya=this.IEf(ha.value);Ya&&Ya.tle(ha.key)}}ule(H,ha,Ya){Ya&&Ya[Lj.a.pSa]?(Ya[Lj.a.k6]=H,Ya[Lj.a.j0]=ha,this.vee(yb.a.Ama,Ya),Ek.a.vNa(Lj.a.pSa,Ya[Lj.a.pSa].toString(),H)):this.eI?this.Z3g(H,ha,Ya):this.ea.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&
0===H&&(Ya={},Ya[Lj.a.k6]=H,Ya[Lj.a.j0]=ha,this.vee(yb.a.sB,Ya))}IEf(H){let ha=null;switch(H){case 1:ha=new Em(Object(fc.a)(this,this.ule,"retrieveAddinFlagCompleted"),this.Vb);break;case 2:ha=new Cm(Object(fc.a)(this,this.ule,"retrieveAddinFlagCompleted"),this.appUILocale,this.Vb,this.ea);break;case 5:ha=new Dm(Object(fc.a)(this,this.ule,"retrieveAddinFlagCompleted"),this.Vb)}return ha}Z3g(H,ha,Ya){0===H&&Ya&&Ya[Lj.a.Xlc]&&(Ya[Lj.a.k6]=H,Ya[Lj.a.j0]=ha,Z.ULS.sendTraceTag(508829835,220,50,"AddinServiceUserState: {0}, addinCommandsInitFlagInfo: {1}",
Ya[Lj.a.Xlc].toString(),JSON.stringify(Ya)),this.vee(yb.a.sB,Ya))}get eI(){return this.ea.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&this.ea.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}}Object(ia.a)(pm,"AddinCommandsInitializerHost",null,[]);var fl=a(615),Fm=a(290),Gm=a(399);let qm;class Hm extends Qj.a{constructor(H,ha){super();this.SIe=ta.AFrameworkApplication.ea.ka("IsNewStringEnabled")?CommonUiStrings.AppsforOfficeDeveloperModeCheckboxLabel:
CommonUIStrings.l_AppsforOfficeDeveloperModeCheckboxLabel;this.JLe=ta.AFrameworkApplication.ea.ka("IsNewStringEnabled")?CommonUiStrings.AppsforOfficeDeveloperModeHelpUrlText:CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrlText;this.KLe=ta.AFrameworkApplication.ea.ka("IsNewStringEnabled")?CommonUiStrings.AppsforOfficeDeveloperModeHelpUrl:CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrl;this.uCb=!1;this.gHb=()=>{this.hide();this.uCb&&G(this.O$)};this.CUj=()=>{fl.a.instance.getItem("optedIntoAddinDeveloperMode")?
(fl.a.instance.removeItem("optedIntoAddinDeveloperMode"),this.uCb=!1):(fl.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.uCb=!0)};this.O$=H;qm=ha}showDialog(H,ha){try{this.uf=void 0===this.uf||null===this.uf?Fm.a.l2b(Gm.a.b5).toString():this.uf,this.show({["type"]:"StandardDialogProps",["id"]:this.uf,["dialogIcon"]:3,["headerText"]:H,["titleText"]:ha,["resultHandler"]:this.gHb,["messageAreaLink"]:this.M$h(),["permanentDismissCheckbox"]:this.I$h(),["renderMicrosoftLogoInHeader"]:!1})}catch(Ya){this.v5c(H,
ha)}}M$h(){return{["type"]:"AppLinkProps",["id"]:"WACDialogExtraLink",["text"]:this.JLe,["handler"]:{["href"]:this.KLe,["target"]:"_blank"},["onExecute"]:null}}I$h(){return{["type"]:"AppCheckboxProps",["id"]:"WACDialogOptInCheckbox",["label"]:this.SIe,["onExecute"]:this.CUj}}v5c(H,ha){const Ya=new Rl.a(!1,!1,!1);Ya.hc=1;Ya.uf=Fm.a.l2b(Gm.a.b5).toString();Ya.wj=String.format(this.R1(),ha,this.KLe,this.JLe,this.SIe);Ya.initializeAndShow(H,this.jfh,{optInCheckbox:!1})}jfh(H,ha){1==H&&ha.optInCheckbox&&
(fl.a.instance.getItem("optedIntoAddinDeveloperMode")?(fl.a.instance.removeItem("optedIntoAddinDeveloperMode"),this.uCb=!1):(fl.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.uCb=!0,G(this.O$)))}R1(){return"<div style='height:100px;width:400px;border:none;'><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>"}}Object(ia.a)(Hm,"AppsForOfficeDeveloperModeOptInDialog",Qj.a,[]);var Xm=a(436);class Im extends pm{constructor(H){super(H.Vb);
this.O$=this.Azb=null;this.uBa=new Zf.a;this.bhe=ha=>{1===ha&&this.O$&&this.IEg()};this.$=H;zm.a.Wjb=zm.a.rzf}get appUILocale(){return this.$.ta.UICultureTag}T4g(){this.Pgj();this.N9k()}UJd(){const H=new Xm.a;this.$.fa.Kh.get(27)&&(H.ga(0,2),""!==ta.AFrameworkApplication.ea.Qa("HostInstallAddIns")&&H.ga(16,5));this.$.fa.Kh.get(33)&&H.ga(1,1);pd.EwaSettings.Ra(52)&&H.ga(8,1);this.$.Fe.get(35)&&H.ga(10,5);return H}vee(H,ha){this.nni(()=>{const Ya=new Jc.a(H,0,this.$.xc,0,null);this.$.Ia.Gb(Ya,ha)})}nni(H){(ha=>
{ha=this.$.ra.Tb(ha);return!!ha&&di.d(ha)})(198)?this.$.ra.Vc(198,ha=>{H(ha)}):H(null)}N9k(){this.O$=ta.AFrameworkApplication.ea.Qa("DevAddinManifestFileUrl");this.Azb=ta.AFrameworkApplication.ea.Qa("DevAddinManifestGuid");var H=ta.AFrameworkApplication.ea.Qa("IsDevAddinTest");if(this.O$&&this.Azb&&H){H="true"===H;var ha=this.uBa.getItem("optedIntoAddinDeveloperMode");const Ya=this.uBa.getItem(this.Azb);ha||H&&ta.AFrameworkApplication.ea.ka("SuppressDeveloperAddinDialogs")?!ta.AFrameworkApplication.disableWholeAppsForOfficeFeature&&
(Ya||H&&ta.AFrameworkApplication.ea.ka("SuppressDeveloperAddinDialogs"))?this.IEg():(H=new Qj.a,H.hc=4,ta.AFrameworkApplication.ea.ka("IsNewStringEnabled")?(ha=CommonUiStrings.AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUiStrings.AppsForOfficeDeveloperManifestUrl,this.O$)+CommonUiStrings.AppsforOfficeLoadManifestUrl,H.XR(CommonUiStrings.AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,ha,this.bhe)):(ha=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+
String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.O$)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl,H.XR(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,ha,this.bhe))):(H=new Hm(this.O$,this.bhe),H.hc=0,ta.AFrameworkApplication.ea.ka("IsNewStringEnabled")?H.showDialog(CommonUiStrings.AppsforOfficeNotOptedIntoAddinDeveloperModeTitle,CommonUiStrings.AppsforOfficeNotOptedIntoAddinDeveloperModeMessage):H.showDialog(CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeTitle,
CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeMessage))}}IEg(){if(kc.DdaFacadeService.Oa())void Sb.a.resolve(kc.DdaFacadeService,{xa:1}).then(H=>{H.Cf.validateAndCacheNewDevAddinManifest(this.O$);this.uBa.setItem(this.Azb,"true")});else{const H=Al.GetServiceTaskFactory.create(this.$.ra,106,this.$.Aa,1);Kf.TaskExtensions.tb(H,()=>{H.result.Cf.validateAndCacheNewDevAddinManifest(this.O$);this.uBa.setItem(this.Azb,"true")},this.$.Aa,3)}}}Object(ia.a)(Im,"AddinCommandsInitService",pm,[607]);
class rm extends Pg.a{constructor(H){super();this.addinCommandsInitService=null;this.yd=()=>{Z.ULS.sendTraceTag(537170701,0,50,`AddinCommandsInitServiceFactory.OnSessionIdChanged: isSessionActive ${this.$.fa.yc}, isEditMode ${this.$.isEditMode} , showCommandUI [${!!(this.$.$d&16384)}] `);this.addinCommandsInitService.T4g();this.$.fa.Qk(this.yd)};this.$=H;this.ri()}create(){this.$.ra.Vc(53,()=>{this.Uf(Object(Qg.a)(this.$.ra,202,()=>this.addinCommandsInitService||(this.addinCommandsInitService=new Im(this.$))));
this.$.fa.yc?(Z.ULS.sendTraceTag(537170702,0,50,`AddinCommandsInitServiceFactory.Create: calling TryInitializeAddinCommands, isEditMode: [${this.$.isEditMode}], showCommandUI [${!!(this.$.$d&16384)}] `),this.addinCommandsInitService.T4g()):this.$.fa.Vk(this.yd)})}static Ea(H){H.ra.zc(201,new rm(H))}}Object(ia.a)(rm,"AddinCommandsInitServiceFactory",Pg.a,[]);Type.registerNamespace("Common.App.InProductMessaging");sk.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");uk.main();(()=>
{pj.a.wb(()=>{pj.a.wb(H=>{kc.FirstRunExperienceService.Oa()||Kk.Ea(H)})})})();(()=>{pj.a.wb(()=>{kc.InProductMessagingService.Oa()||pj.a.wb(tg.Ea)})})();pj.a.wb(Tk.Ea);(()=>{pj.a.wb(H=>{dd.a.Fj()||ol.Ea(H)})})();Type.registerNamespace("Common.App.Rename");Pe.a.instance.Qi(new Sl,7);(()=>{pj.a.wb(H=>{kc.RenameFileManagerService.Oa()||pk.Ea(H)})})();pd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveRequireFromSlices",!1)||a(647);(()=>{pj.a.wb(H=>{H.ra.zc(203,new Ul)})})();Type.registerNamespace("Common.App.LivePersonaUtils");
cl.main();Type.registerNamespace("Common.App.SaveStatus");Pe.a.instance.Qi(new ma);(()=>{pj.a.wb(H=>{Nc.Ea(H)})})();a(1485);Type.registerNamespace("CAUI");$f.main();eh.a.ds.zc(141,new ng);pd.EwaSettings.isChangeGateEnabled("OfficeVSO:8719582_RemoveVarsFromSlices")||a(1487);(()=>{pj.a.wb(H=>{kc.AccessTokenManagerService.Oa()||yh.Ea(H)})})();Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=Ph.a;Type.registerNamespace("Common.App.WopiIdentity");
hm.main();Type.registerNamespace("Common.App.FloatPane");km.main();Type.registerNamespace("Common.App.DisplayEnvironmentName");mm.main();nm.main();pj.a.wb(om.Ea);pj.a.wb(rm.Ea);String(A);String(N);String(I);String(L);String(J);String(je);String(B);String(Y);String(K);String(Dc);String(U);String(O);String(C);String(X);String(S);String(ea);String(Oa);String(Ha);String(Za);String(fa);String(la);String(ba);String(aa);String(oa);String(Na);String(Ia);String(Sa);String(Pa);String(za);String(wa);String(db);
String(Ba);String(Ka);String(da);String(mj);String(sa);String(mb);String(Ma);String(hb);String($a);String(Va);String(xa);window.___1717508060495_closurehack=A;window.___1717508060495_closurehack=N;window.___1717508060495_closurehack=I;window.___1717508060495_closurehack=L;window.___1717508060495_closurehack=J;window.___1717508060495_closurehack=je;window.___1717508060495_closurehack=B;window.___1717508060495_closurehack=Y;window.___1717508060495_closurehack=K;window.___1717508060495_closurehack=Dc;
window.___1717508060495_closurehack=U;window.___1717508060495_closurehack=O;window.___1717508060495_closurehack=C;window.___1717508060495_closurehack=X;window.___1717508060495_closurehack=S;window.___1717508060495_closurehack=ea;window.___1717508060495_closurehack=Oa;window.___1717508060495_closurehack=Ha;window.___1717508060495_closurehack=Za;window.___1717508060495_closurehack=fa;window.___1717508060495_closurehack=la;window.___1717508060495_closurehack=ba;window.___1717508060495_closurehack=aa;
window.___1717508060495_closurehack=oa;window.___1717508060495_closurehack=Na;window.___1717508060495_closurehack=Ia;window.___1717508060495_closurehack=Sa;window.___1717508060495_closurehack=Pa;window.___1717508060495_closurehack=za;window.___1717508060495_closurehack=wa;window.___1717508060495_closurehack=db;window.___1717508060495_closurehack=Ba;window.___1717508060495_closurehack=Ka;window.___1717508060495_closurehack=da;window.___1717508060495_closurehack=mj;window.___1717508060495_closurehack=
sa;window.___1717508060495_closurehack=mb;window.___1717508060495_closurehack=Ma;window.___1717508060495_closurehack=hb;window.___1717508060495_closurehack=$a;window.___1717508060495_closurehack=Va;window.___1717508060495_closurehack=xa},1116:function(y,r,a){function c(h){const n=k.a.instance,m=x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingBusinessBarOnDifferentSheet",!1)&&h.isDifferentThanActiveSheet;d.ULS.sendTraceTag(507302410,0,20,`BusinessBarContent.getBusinessBarStrings: using strings of ${m?
"differentSheet":"activeSheet"} with ${h.suggestionCount} suggestions.`);const u=x.EwaSettings.isChangeGateEnabled("OfficeVSO:8992386_DataCleansingBusinessBarUseNewStrings");return m?{title:u?String.format(n.Ib(254),h.sheetName):String.format(n.Ib(248),h.sheetName),message:u?String.format(n.Ib(255),h.suggestionCount):String.format(n.Ib(249),h.suggestionCount,h.sheetName),fZc:u?String.format(n.Ib(256),h.sheetName):String.format(n.Ib(250),h.sheetName)}:{title:n.ia(u?2609:2481),message:String.format(n.Ib(u?
253:241),h.suggestionCount),fZc:n.ia(u?2610:2474)}}function b(){return x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingBusinessBarLearnMoreLinkEnabled",!1)}function f(){return"Error"}a.d(r,"b",function(){return c});a.d(r,"c",function(){return b});a.d(r,"a",function(){return f});var k=a(13),x=a(1),d=a(15)},1118:function(y,r,a){a.d(r,"a",function(){return x});y=a(0);var c=a(15),b=a(6),f=a(55),k=a(39);class x{static JFf(d,h){switch(d){case 3:return x.h5i(h);case 2:return x.vXi(h);
case 1:return x.nQi(h)}return""}static h5i(d){switch(d){case 1:return b.AFrameworkApplication.ea.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return b.AFrameworkApplication.ea.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static vXi(d){switch(d){case 1:return b.AFrameworkApplication.ea.appSettings.WildFireAdjustLinkPptWac.toString();case 2:return b.AFrameworkApplication.ea.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static nQi(d){switch(d){case 1:return b.AFrameworkApplication.ea.appSettings.WildFireAdjustLinkExcelWac.toString();
case 2:return b.AFrameworkApplication.ea.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static Zae(d,h,n){if(k.a.mi||k.a.zq)window.setTimeout(()=>{x.bEg(n,x.xPf())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(x.r7e(n),d,0,!1)}static yZh(d,h,n,m){h&&m&&m();x.Zae(d,h,n)}static xPf(){return k.a.mi?1:k.a.zq?2:k.a.d0a?3:k.a.isMac?4:0}static get RUb(){return"zh-CN"===window.navigator.language}static bEg(d,h){1===h?(c.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),
d=x.JFf(d,h),8<k.a.cSb?f.a.Rg(d,void 0,void 0,"RedirectToAppStore"):f.a.YX(d)):document.hidden||(x.RUb?(d=b.AFrameworkApplication.ea.appSettings.WildFireUrlChinaStoreAndroid.toString())?(c.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),f.a.YX(d)):c.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(c.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(x.JFf(d,h),null,null)))}static r7e(d){switch(d){case 3:return 5;
case 2:return 3;case 1:return 1;default:return 0}}static get vse(){return(k.a.d0a||k.a.isMac)&&k.a.Wp}static aGf(d){switch(d){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static Vsj(d){return(d=x.NTi(d))&&""!==d?Boolean.parse(d):!1}static Tpe(d){x.KKk(d)}static NTi(d){try{return localStorage.getItem(d)}catch(h){return c.ULS.sendTraceTag(18416668,306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+h.message),
null}}static KKk(d){try{localStorage.setItem(d,"true")}catch(h){c.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+h.message)}}}x.gYh="ChromeExtensionBarDismiss";Object(y.a)(x,"WildFireUtilities",null,[])},1200:function(y,r,a){a.r(r);a.d(r,"CalcHelper",function(){return l});y=a(0);var c=a(15),b=a(242),f;(function(t){t[t.paren=0]="paren";t[t.lead=1]="lead";t[t.intern=2]="intern";t[t.trail=3]="trail";t[t.undefined=4]="undefined"})(f||(f={}));Object(y.b)("CurrencyFormatOption",
f);var k;(function(t){t[t.none=-1]="none";t[t.mdy=0]="mdy";t[t.dmy=1]="dmy";t[t.ymd=2]="ymd";t[t.myd=3]="myd";t[t.dym=4]="dym";t[t.ydm=5]="ydm"})(k||(k={}));Object(y.b)("DateOrderOption",k);class x{constructor(t,e){({CalcHelper:t}=a(1200));e&&(e.Ze||c.ULS.shipAssertTag(537169942,0,!1,"LocaleHolder constructor - locale information is not available"));this.uqh=t.Jkf(e,t.mkf(e.kta));this.vqh=excelOnlineCalc.calc.localeInfoFromData(this.localeData)}get localeInfo(){return this.vqh}get localeData(){return this.uqh}}
Object(y.a)(x,"LocaleHolder",null,[]);var d=a(1242),h=a(64),n=a(1),m=a(28),u=a(66);class l{constructor(t,e){this.$=t;(this.qv=e)||c.ULS.shipAssertTag(537170070,0,!1,"CalcHelper constructor - IInstantaneousSupportInformationManager is not available");e=n.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")?n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelOnlineCalcWP5",!1)?h.a.current.Lo(79):h.a.current.Lo(77):h.a.current.Lo(78);this.logger=new d.a;this.documentLoc=
excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.cEj=new x(t,this.qv);excelOnlineCalc.config.initCalc(this.logger,this.qv?w=>this.qv.isFeatureEnabled(w):()=>!1,e);this.hz=excelOnlineCalc.config.calcConfig(this.cEj.localeInfo)}get config(){return this.hz}gci(){if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")){if(!this.$.qa)return c.ULS.shipAssertTag(537170069,0,!1,"CalcHelper.CurrentSheetIndex() - this.ewaControl.Sheets is null"),
0;const t=this.$.qa.la;return t?t.index:(c.ULS.shipAssertTag(537170068,0,!1,"CalcHelper.CurrentSheetIndex() - sheet is null"),0)}return this.$.qa.la.index}createParser(){const t={};t.config=this.config;return excelOnlineCalc.parse.createParser(t)}createAnalyzer(){const t={};t.config=this.config;return excelOnlineCalc.analyze.createAnalyzer(t)}createNumberFormatter(){const t=excelOnlineCalc.numfmt.createFormatGlobals(this.config,(e,w)=>excelOnlineCalc.calc.getTime(this.config,e,w,"Estimation"));return excelOnlineCalc.numfmt.createNumberFormatter(t)}tai(t,
e,w,z){if(!z)return{range:{row:e,col:w},sheet:{document:this.documentLoc,index:t}};e=excelOnlineCalc.location.gridCell(e,w);t=excelOnlineCalc.location.sheetIndex(this.documentLoc,t);return excelOnlineCalc.location.sheetGridCell(t,e)}static Jkf(t,e){e=void 0===e?null:e;const w=t.w7h(),z=t.Ze.TrueValueString,E=t.Ze.FalseValueString,M=t.Ze.DecimalSeparator.toString(),G=t.Ze.ListSeparator.toString(),A=t.Ze.ColumnSeparator.toString(),N=t.Ze.RowSeparator.toString(),K=t.Ze.ThousandsDataArray,I=t.Ze.ThousandSeparator.toString(),
L=t.Ze.Lcid,J=t.Ze.Country,B=t.Ze.DigitsNumber,Y=t.Ze.ExpSeparatedBySpace,U=t.Ze.FractionSeparator.toString(),O=t.Ze.PercentSeparatedBySpace,C=m.a.gpc(Enum.toString(f,t.Ze.CurrencyFormat)),X=t.Ze.CurrencySymbolLead,S=t.Ze.CurrencySeparatedBySpace,ea=t.Ze.CurrencySymbolString,Oa=t.Ze.DigitsCurrency,Ha=-1===t.Ze.DateOrder?"MDY":u.e(Enum.toString(k,t.Ze.DateOrder)),Za=t.Ze.DateSeparator.toString(),fa=t.Ze.DateAlternativeSeparator.toString(),la=t.Ze.Year4Digits,ba=t.Ze.Month2Digits,aa=t.Ze.Day2Digits,
oa=t.Ze.LongDateFormat,Na=t.Ze.TimeSeparator.toString(),Ia=t.Ze.TimeAltSeparator,Sa=t.Ze.Hour2Digits,Pa=t.Ze.Use24HourClock,za=t.Ze.AmPmSeparatedBySpace,wa=[t.Ze.AmString,t.Ze.PmString],db=t.Ze.DayNameShortArray,Ba=t.Ze.DayNameLongArray,Ka=t.Ze.MonthNameShortArray,da=t.Ze.MonthNameLongArray,sa=t.Ze.PictureSpecialArray,mb=b.a.map(("\x00"+t.Ze.PictureSingleString).split(""),Ga=>"\x00"===Ga?null:Ga),Ma=t.Ze.PictureColorArray,hb=t.Ze.PictureDbnumArray,$a=t.Ze.RowLetter.toString(),Va=t.Ze.ColumnLetter.toString(),
xa=t.Ze.LeftBrace.toString(),ia=t.Ze.RightBrace.toString(),Z=t.Ze.LeftBracket.toString(),ta=t.Ze.RightBracket.toString(),pa=l.x1i(t.Ze);return excelOnlineCalc.calc.localeData(e,w,z,E,$a,Va,xa,ia,Z,ta,M,G,A,N,K,I,L,J,B,Y,U,O,C,X,S,ea,Oa,Ha,Za,fa,la,ba,aa,oa,Na,Ia,Sa,Pa,za,wa,db,Ba,Ka,da,sa,mb,Ma,hb,pa,t.Ze.SysDateFormatString,t.Ze.SysTimeFormatString)}static mkf(t){const e=[];if(!t)return e;for(const w of t)t=null,w.IsDynamicUdf||(t=excelOnlineCalc.calc.worksheetFunctionName(w.FunctionIndexInServer,
w.NameUI)),t&&e.push(t);return e}static x1i(t){const e=Array(6);e[1]="#"+t.AllStructRefString;e[3]="#"+t.HeadersStructRefString;e[2]="#"+t.DataStructRefString;e[4]="#"+t.TotalsStructRefString;e[5]="#"+t.ThisRowStructRefString;return e}}Object(y.a)(l,"CalcHelper",null,[])},1231:function(y,r,a){a.d(r,"a",function(){return k});y=a(0);var c=a(15),b=a(55),f=a(78);a=a(938);class k extends a.a{constructor(x,d){super(x,d);c.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");
this.title="";this.message=k.m_message;this.Uca=!0}get linkText(){return k.Scg}YU(x){super.YU(x);b.a.openWindow(4,f.a.Uzc(k.Rcg))}Oy(x){super.Oy(x);k.c4d&&k.c4d(null)}static initialize(x,d,h,n){c.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");k.m_message=x;k.Scg=d;k.Rcg=h;k.c4d=n}}k.m_message=null;k.Scg=null;k.Rcg=null;k.c4d=null;Object(y.a)(k,"WacGdprNoticeBusinessBarEntry",a.a,[])},1232:function(y,r,a){a.d(r,"a",function(){return c});y=a(0);class c{}c.Muf="ewa-bb";
c.hpi="ewa-bb-content";c.ipi="ewa-bb-entry";c.jpi="ewa-bb-entry-body";c.Nuf="ewa-bb-entry-button";c.Ouf="ewa-bb-entry-button-holder";c.lpi="ewa-bb-entry-close";c.mpi="ewa-bb-entry-icon";c.npi="ewa-bb-entry-link";c.opi="ewa-bb-entry-message";c.ppi="ewa-bb-entry-title";c.qpi="ewa-bb-icon";c.rpi="ewa-bb-react";Object(y.a)(c,"BusinessBarClassNames",null,[])},1233:function(y,r,a){a.d(r,"a",function(){return c});y=a(0);a=a(938);class c extends a.a{constructor(b,f){super(b,f);this.es=!0;this.title=c.C$;
this.message=c.B$}get actionButton(){return c.d5}Hl(b){super.Hl(b);(b=c.j_)&&b(null)}static initialize(b,f,k,x){c.C$=b;c.B$=f;c.d5=k;c.j_=x}}c.C$=null;c.B$=null;c.d5=null;c.j_=null;Object(y.a)(c,"AutomaticSensitivityLabelBusinessBarEntry",a.a,[])},1234:function(y,r,a){a.d(r,"a",function(){return c});y=a(0);a=a(938);class c extends a.a{constructor(b,f){super(b,f);this.es=!0;this.title=c.C$;this.message=c.B$}get actionButton(){return c.d5}Hl(b){super.Hl(b);(b=c.j_)&&b(null)}static initialize(b,f,k,
x){c.C$=b;c.B$=f;c.d5=k;c.j_=x}}c.C$=null;c.B$=null;c.d5=null;c.j_=null;Object(y.a)(c,"RecommendedSensitivityLabelBusinessBarEntry",a.a,[])},1235:function(y,r,a){a.d(r,"a",function(){return k});y=a(0);r=a(1058);var c=a(1116),b=a(1117),f=a(15);class k extends r.a{constructor(x,d,h){super(x,d,h);k.d5&&k.j_&&(this.es=!0);this.title=k.C$;this.message=k.B$;this.Uca=Object(c.c)()}get actionButton(){return k.d5}static initialize(x,d,h,n,m){k.C$=x;k.B$=d;k.d5=h;k.j_=n;k.b6c=m}Hl(x){super.Hl(x);k.j_&&k.j_(null)}Oy(x){super.Oy(x);
k.b6c&&k.b6c(null)}YU(x){super.YU(x);f.ULS.sendTraceTag(507561158,0,50,"DataCleansingBusinessBarEntry.onLinkClick was triggered.");Object(b.b)(this.businessBar.$)}}k.C$=null;k.B$=null;k.d5=null;k.j_=null;k.b6c=null;Object(y.a)(k,"DataCleansingBusinessBarEntry",r.a,[])},1236:function(y,r,a){a.d(r,"a",function(){return c});y=a(0);a=a(938);class c extends a.a{constructor(b,f){super(b,f);this.es=!0;this.title=c.C$;this.message=c.B$}get actionButton(){return c.d5}Hl(b){super.Hl(b);(b=c.j_)&&b(null)}static initialize(b,
f,k,x){c.C$=b;c.B$=f;c.d5=k;c.j_=x}}c.C$=null;c.B$=null;c.d5=null;c.j_=null;Object(y.a)(c,"MandatorySensitivityLabelBusinessBarEntry",a.a,[])},1237:function(y,r,a){a.d(r,"a",function(){return c});y=a(0);a=a(938);class c extends a.a{constructor(b,f){super(b,f);this.es=!0;this.title=c.m_title;this.message=c.m_message}get actionButton(){return c.Snb}Hl(b){super.Hl(b);c.pJa&&c.pJa(null)}static initialize(b,f,k,x){c.m_title=b;c.m_message=f;c.Snb=k;c.pJa=x}}c.m_title=null;c.m_message=null;c.Snb=null;c.pJa=
null;Object(y.a)(c,"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",a.a,[])},1238:function(y,r,a){a.d(r,"a",function(){return c});y=a(0);a=a(938);class c extends a.a{constructor(b,f){super(b,f);c.Snb&&c.pJa&&(this.es=!0);this.title=c.m_title;this.message=c.m_message}get actionButton(){return c.Snb}Hl(b){super.Hl(b);c.pJa&&c.pJa(null)}static initialize(b,f,k,x){c.m_title=b;c.m_message=f;c.Snb=k;c.pJa=x}}c.m_title=null;c.m_message=null;c.Snb=null;c.pJa=null;Object(y.a)(c,"SensitivityApplicationSetLabelErrorBusinessBarEntry",
a.a,[])},1243:function(y,r,a){a.d(r,"a",function(){return c});const c=b=>{const f=Array(b.length);for(let k=0,x=b.length;k<x;k++)f[k]=b[k].cloneNode(!0);return f}},1246:function(y,r,a){a.d(r,"a",function(){return c});y=a(0);class c{}c.V4c="b-ring_Apc_Trans";c.xch="cdn_static_resource_ewa_image";Object(y.a)(c,"ResourceHosts",null,[])},1247:function(y,r,a){a.d(r,"a",function(){return f});y=a(0);var c=a(58),b=a(1466);class f{static kJd(k,x,d,h){h=void 0===h?null:h;f.wMc||(f.wMc=Array.isArray(c.a.Xj(d.ta.NetworkMeasurementUrlList))?
c.a.Xj(d.ta.NetworkMeasurementUrlList):null);const n=[];for(let m=0;m<f.wMc.length;m++){const u=f.wMc[m];let l=u.key;l||(l=u.Key);if(h&&!h.includes(l))continue;let t=u.value;t||(t=u.Value);l&&t&&n.push(new b.a(d,l,t,k,x))}return n}}f.wMc=null;Object(y.a)(f,"NetworkConnectionHelpers",null,[])},1422:function(y,r,a){a.r(r);a.d(r,"BusinessBarControl",function(){return Wa});y=a(0);var c=a(15),b=a(94),f=a(155),k=a(16),x=a(91),d=a(32),h=a(39),n=a(17);r=a(267);var m=a(1232),u=a(7),l=a(306),t=a(1233),e=a(938),
w=a(1446),z=a(1058);class E extends z.a{constructor(Fa,Da,ja){super(Fa,Da,ja)}Oy(Fa){super.Oy(Fa)}}Object(y.a)(E,"EditAttemptReadOnlyBusinessBarEntry",z.a,[]);var M=a(45);class G extends e.a{constructor(Fa,Da,ja,Qa){super(Fa,Da);this.error=ja;this.options=Qa;this.error&&this.options&2&&(this.message=this.error.Description);this.error&&this.options&1&&(this.title=this.error.Caption);this.es=!(Qa&4)}Hl(Fa){super.Hl(Fa);this.error.Appearance&=-33;M.a(this.businessBar.$).Zx([this.error])}}Object(y.a)(G,
"ErrorBusinessBarEntry",e.a,[]);var A=a(83);class N extends G{constructor(Fa,Da,ja,Qa,Ob){super(Fa,Da,ja,Qa);this.command=Ob;this.c2=!0}d3(Fa){super.d3(Fa);this.businessBar.$.Ia.Gb(new A.a(this.command,Fa,this.businessBar.$.xc,10,null))}}Object(y.a)(N,"ErrorAndCommandBusinessBarEntry",G,[]);var K=a(13);class I{constructor(Fa,Da,ja,Qa,Ob,Ub,Zb,uc,Hc,Dd,jc){this.Fed=this.kP=this.gga=this.nW=0;this.Ujh=Fa;this.titleId=Da;this.zM=ja;this.loh=Zb;this.GAb=d.a.qz(Hc);this.pmh=Hc;this.iIe=uc;this.moh=Dd;
jc&&(this.Fed=jc);0!==Qa&&(this.nW=Qa);0!==Ob&&(this.gga=Ob);0!==Ub&&(this.kP=Ub)}get kKc(){return 0===this.Fed?"":I.ia(this.Fed)}get title(){return I.ia(this.titleId)}get message(){return I.ia(this.zM)}get messageId(){return this.zM}get iconName(){return this.moh}get yDa(){return this.Ujh}get actionButton(){return I.ia(this.nW)}get CSa(){return I.ia(this.gga)}get link(){return I.ia(this.kP)}get gs(){return this.loh}get businessBarType(){return this.iIe}get hash(){return this.GAb}get alt(){const {BusinessBarControl:Fa}=
a(1422);switch(this.gs){case Fa.wsa:return I.ia(26);case Fa.hy:return I.ia(25);case Fa.nj:return I.ia(24);default:return I.ia(0)}}get nFa(){return this.pmh}set businessBarType(Fa){this.iIe=Fa}static ia(Fa){return K.a.instance.ia(Fa)}}Object(y.a)(I,"EwaBusinessBarEntry",null,[]);class L extends I{constructor(Fa,Da,ja,Qa,Ob,Ub,Zb,uc,Hc){super(Fa,0,Da,ja,Qa,Ob,Ub,Zb,uc,Hc)}get title(){return""}}Object(y.a)(L,"EwaNoTitleBusinessBarEntry",I,[]);var J=a(71),B=a(1),Y=a(70);class U extends e.a{constructor(Fa,
Da){super(Fa,Da);this.c2=this.es=!0;this.Uca=this.Zpj=B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.WebWorkbookLinkNewTaskPaneEnabled",!1)}Hl(Fa){super.Hl(Fa);this.set_visible(!1);this.businessBar.$.AL();this.businessBar.$.Ia.Gb(new A.a(1038998010,Fa,this.businessBar.$.xc,10,null))}d3(Fa){super.d3(Fa);this.businessBar.$.Ia.Gb(new A.a(-722953877,Fa,this.businessBar.$.xc,10,null))}YU(Fa){super.YU(Fa);Fa=new A.a(-859308420,Y.a.Hb,this.businessBar.$.xc,12,null);this.businessBar.$.Ia.Gb(Fa,
{[Y.a.Bf]:"AssetID="+u.a.lAf,["InputMethod"]:Y.a.Hb,[Y.a.Wc]:u.a.VF,["ShouldCanvasTakeFocus"]:!0})}Oy(Fa){this.businessBar.removeEntry(55);J.g(Fa)}}Object(y.a)(U,"ExternalLinksEnableContentBusinessBarEntry",e.a,[]);class O extends e.a{constructor(Fa,Da){super(Fa,Da);this.es=!0;this.c2=!1}Hl(Fa){super.Hl(Fa);this.businessBar.$.Ia.Gb(new A.a(-722953877,Fa,this.businessBar.$.xc,10,null))}Oy(Fa){this.businessBar.removeEntry(5);J.g(Fa)}}Object(y.a)(O,"ExternalLinksShowErrorBusinessBarEntry",e.a,[]);var C=
a(12);class X extends e.a{constructor(Fa,Da,ja){super(Fa,Da);this.pYa=ja;this.es=!0}Hl(Fa){super.Hl(Fa);C.HelperMethods.r3(this.businessBar.$.bJ,this.pYa,this.businessBar.$.ZL)}}Object(y.a)(X,"HelpButtonBusinessBarEntry",e.a,[]);class S extends e.a{constructor(Fa,Da,ja){super(Fa,Da);this.pYa=ja;this.Uca=!0}YU(Fa){super.YU(Fa);C.HelperMethods.r3(this.businessBar.$.bJ,this.pYa,this.businessBar.$.ZL)}}Object(y.a)(S,"HelpTextBusinessBarEntry",e.a,[]);class ea extends e.a{constructor(Fa,Da,ja,Qa){super(Fa,
Da);this.pYa=ja;this.command=Qa;this.Uca=!0;this.es=1461300262!==Qa}Hl(Fa){super.Hl(Fa);this.businessBar.$.Ia.Gb(new A.a(this.command,Fa,this.businessBar.$.xc,10,null))}YU(Fa){super.YU(Fa);const Da=new A.a(-859308420,Fa,this.businessBar.$.xc,12,null);this.businessBar.$.Ia.Gb(Da,{[Y.a.Bf]:"HelpID="+this.pYa,["InputMethod"]:Fa,[Y.a.Wc]:u.a.VF,[u.a.wna]:!0})}}Object(y.a)(ea,"HelpTextTaskPaneAndCommandBusinessBarEntry",e.a,[]);class Oa extends e.a{constructor(Fa,Da){super(Fa,Da);this.c2=this.es=!0}Hl(Fa){super.Hl(Fa);
this.set_visible(!1);this.businessBar.$.AL();this.businessBar.$.Ia.Gb(new A.a(-1081442996,Fa,this.businessBar.$.xc,10,null))}d3(Fa){super.d3(Fa);this.businessBar.$.Ia.Gb(new A.a(1702917262,Fa,this.businessBar.$.xc,10,null))}Oy(Fa){this.businessBar.removeEntry(59);J.g(Fa)}}Object(y.a)(Oa,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",e.a,[]);var Ha=a(1236);class Za extends e.a{constructor(Fa,Da){super(Fa,Da);(this.policyManager=Fa.$.ra.Tb(274))?(this.message=this.policyManager.aRc,this.title=
this.policyManager.title,this.Uca=!0):c.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered.")}get linkText(){return this.policyManager.linkText}YU(Fa){super.YU(Fa);(Fa=this.policyManager.g1j)&&Fa(null)}}Object(y.a)(Za,"PolicyBusinessBarEntry",e.a,[]);var fa=a(1234),la=a(1238),ba=a(1237);a(665);var aa=a(98),oa=a(26);class Na extends e.a{constructor(Fa,Da){super(Fa,Da);this.es=!0;this.title=""}Hl(Fa){super.Hl(Fa);aa.c(oa.a.oPj);
window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")}}Object(y.a)(Na,"UnsupportedBrowserBusinessBarEntry",e.a,[]);var Ia=a(1231),Sa=a(141),Pa=a(1209),za=a(1118),wa=a(1435),db=a(24);class Ba{constructor(){this.e7c=new wa.a;this.c7c=new wa.a;this.b7c=new wa.a;this.HPh(this.e7c);this.GPh(this.c7c);this.FPh(this.b7c);this.Ibd=new wa.a;this.Hbd=new wa.a;this.Gbd=new wa.a;this.hSh(this.Ibd);this.gSh(this.Hbd);this.fSh(this.Gbd);this.A8c=new wa.a;this.aQh(this.A8c);this.dSa(this.A8c);
this.dSa(this.b7c);this.dSa(this.c7c);this.dSa(this.e7c);this.dSa(this.Hbd);this.dSa(this.Ibd);this.dSa(this.Gbd)}Y1i(Fa,Da){switch(Fa){case 1:return this.P5i(Da);case 2:return this.AJi(Da)}return za.a.vse?this.A8c:null}HPh(Fa){Fa.add("Headline",Object(db.a)("WildFireWordBizBarHeadline"));Fa.add("UseAppButton",Object(db.a)("WildFireBizBarUseAppButtonText"));Fa.add("CallToAction",Object(db.a)("WildFireWordBizBarAndroidCallToAction"))}GPh(Fa){Fa.add("Headline",Object(db.a)("WildFirePPTBizBarHeadline"));
Fa.add("UseAppButton",Object(db.a)("WildFireBizBarUseAppButtonText"));Fa.add("CallToAction",Object(db.a)("WildFirePPTBizBarAndroidCallToAction"))}FPh(Fa){Fa.add("Headline",Object(db.a)("WildFireExcelBizBarHeadline"));Fa.add("UseAppButton",Object(db.a)("WildFireBizBarUseAppButtonText"));Fa.add("CallToAction",Object(db.a)("WildFireExcelBizBarAndroidCallToAction"))}hSh(Fa){Fa.add("Headline",Object(db.a)("WildFireWordBizBarHeadline"));Fa.add("UseAppButton",Object(db.a)("WildFireBizBarUseAppButtonText"));
Fa.add("InstallButton",Object(db.a)("WildFireBizBarInstallButtonText"));Fa.add("OpenAppButton",Object(db.a)("WildFireBizBarOpenAppButtonText"));Fa.add("CallToAction",Object(db.a)("WildFireWordBizBarIPadCallToAction"));Fa.add("OverlayBig","Get the Word app");Fa.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");Fa.add("OverlaySmallSplit1","Discover Word");Fa.add("OverlaySmallSplit2","designed for the iPad.");Fa.add("SkipButton","Skip for now")}aQh(Fa){Fa.add("Headline",
"Get the Office Online extension for Chrome");Fa.add("UseAppButton","Get the extension");Fa.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}gSh(Fa){Fa.add("Headline",Object(db.a)("WildFirePPTBizBarHeadline"));Fa.add("UseAppButton",Object(db.a)("WildFireBizBarUseAppButtonText"));Fa.add("InstallButton",Object(db.a)("WildFireBizBarInstallButtonText"));Fa.add("OpenAppButton",Object(db.a)("WildFireBizBarOpenAppButtonText"));Fa.add("CallToAction",Object(db.a)("WildFirePPTBizBarIPadCallToAction"));
Fa.add("OverlayBig","Get the PowerPoint app");Fa.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");Fa.add("OverlaySmallSplit1","Discover PowerPoint");Fa.add("OverlaySmallSplit2","designed for the iPad.");Fa.add("SkipButton","Skip for now")}fSh(Fa){Fa.add("Headline",Object(db.a)("WildFireExcelBizBarHeadline"));Fa.add("UseAppButton",Object(db.a)("WildFireBizBarUseAppButtonText"));Fa.add("InstallButton",Object(db.a)("WildFireBizBarInstallButtonText"));Fa.add("OpenAppButton",
Object(db.a)("WildFireBizBarOpenAppButtonText"));Fa.add("CallToAction",Object(db.a)("WildFireExcelBizBarIPadCallToAction"))}dSa(Fa){Fa.add("Corporation","Microsoft Corporation")}P5i(Fa){switch(Fa){case 3:return this.Ibd;case 2:return this.Hbd;case 1:return this.Gbd}return null}AJi(Fa){switch(Fa){case 3:return this.e7c;case 2:return this.c7c;case 1:return this.b7c}return null}static get instance(){Ba.Wa||(Ba.Wa=new Ba);return Ba.Wa}}Ba.Wa=null;Object(y.a)(Ba,"WildFireStringFactory",null,[]);var Ka=
a(6),da=a(55);class sa{constructor(Fa,Da,ja,Qa,Ob,Ub){this.qgd=null;this._id=Fa;this.ahd=Da;this.Dnh=void 0===Ob?null:Ob;this.aBb=Qa;this.pDb=void 0===Ub?null:Ub;this.xOa=null;this.ebb=ja;this.UDb=Ba.instance.Y1i(Da,Fa)}Jjf(){this.xOa=new Pa.a(this.title,this.message,null);this.xOa.addButton(this.Yaf,Object(Sa.a)(this,this.Sjg,"onButtonOneClick"),"");this.ebb&&this.xOa.pBh(this.bbf,Object(Sa.a)(this,this.Tjg,"onButtonTwoClick"));this.xOa.mT=Object(Sa.a)(this,this.Bpf,"dismissBar");this.xOa.image=
3;this.xOa.id=16;this.xOa.closeable=!0}get title(){return this.UDb.pa("Headline")}get message(){return this.UDb.pa("CallToAction")}get Qgl(){return this.ebb}get Yaf(){return this.ebb?this.UDb.pa("InstallButton"):this.UDb.pa("UseAppButton")}get bbf(){return this.ebb?this.UDb.pa("OpenAppButton"):""}Sjg(){this.ebb?this.ikj():this.Fgl()}Tjg(){this.ebb&&this.W7j()}get openUrl(){this.qgd||(this.qgd=this.Dnh());return this.qgd}ikj(){c.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");
this.aBb&&this.pDb&&this.pDb();za.a.bEg(this._id,this.ahd)}W7j(){this.openUrl&&(c.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.aBb&&this.pDb&&this.pDb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(za.a.r7e(this._id),this.openUrl,0,!1))}Fgl(){za.a.vse?this.nSh():(c.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),za.a.Tpe("BizBarClicked"),1!==this.ahd&&2!==this.ahd||za.a.yZh(this.openUrl,this.aBb,this._id,this.pDb))}nSh(){this.aBb?c.ULS.sendTraceTag(17571974,
323,50,"ChromeExtBannerClicked"):c.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");da.a.YX(Ka.AFrameworkApplication.ea.appSettings.WildFireChromeExtensionUrl.toString())}shi(){this.aBb?c.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):c.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");za.a.Tpe(za.a.gYh)}Bpf(){za.a.vse?this.shi():(za.a.Tpe(za.a.aGf(this._id)),c.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static Fbi(){const Fa=Ka.AFrameworkApplication.ua.Ab,
Da=new sa(Fa.gi,za.a.xPf(),8<h.a.cSb,1===Fa.rwa,()=>Fa.hw,Fa.rCk());c.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return Da}}Object(y.a)(sa,"WildFireBusinessBar",null,[]);class mb extends e.a{constructor(Fa,Da){super(Fa,Da);this.eOa=sa.Fbi();this.es=!0;this.c2=this.eOa.Qgl;this.title=this.eOa.title;this.message=this.eOa.message}get actionButton(){return this.eOa.Yaf}get CSa(){return this.eOa.bbf}Hl(Fa){super.Hl(Fa);this.eOa.Sjg(null)}d3(Fa){super.d3(Fa);this.eOa.Tjg(null)}Oy(Fa){super.Oy(Fa);
this.eOa.Bpf(null)}}Object(y.a)(mb,"WildFireMobileAppBusinessBarEntry",e.a,[]);var Ma=a(282),hb=a(28),$a=a(206),Va=a(162),xa=a(40),ia=a(189),Z=a(1239),ta=a(150),pa=a(5),Ga=a(65);class Ca extends e.a{constructor(Fa,Da,ja,Qa){super(Fa,Da);this.fL=Ga.a.Cb(pa.OfficeScriptsCommandManagerService);c.ULS.shipAssertTag(512276321,0,!!this.fL);this.id=ia.a.create();this.$=ja;this.title=K.a.instance.ia(2282);this.message="";this.eve=K.a.instance.ia(2278);this.gah=K.a.instance.ia(2279);this.eah=K.a.instance.ia(2280);
this.Rhf=K.a.instance.ia(2281);this.update(Qa)}update(Fa){this.scriptLink=Fa.scriptLink;this.runStatus=Fa.runStatus;this.buttonText=Fa.buttonText||"";this.wEj(Fa.clickId);this.myk();"preparing"===this.runStatus?(this.iya(0),this.message=String.format(K.a.instance.Ib(208),this.buttonText),this.es=!0,this.zCa=this.eve,this.dJb=this.Upa=this.Jpb):"running"===this.runStatus?(this.iya(0),this.message=String.format(K.a.instance.Ib(207),this.buttonText),this.es=!0,this.zCa=this.eve,this.dJb=this.Upa=this.Jpb):
"succeeded"===this.runStatus?(this.iya(0),this.message=String.format(K.a.instance.Ib(210),this.buttonText),"true"===Fa.hasLogs?(this.es=!0,this.zCa=this.eah,this.Upa=this.Bug,this.c2=!0,this.Lpd=this.gah,this.Mpd=this.Cug):(this.es=!0,this.zCa=this.gah,this.Upa=this.Cug)):"runFailed"===this.runStatus?(this.iya(1),this.message=String.format(K.a.instance.Ib(209),this.buttonText),this.gkb=Wa.wsa,"true"===Fa.hasLogs?(this.es=!0,this.zCa=this.eah,this.Upa=this.Bug,"false"===Fa.isOwner&&(this.c2=!0,this.Lpd=
this.Rhf,this.Mpd=this.Wkg)):"false"===Fa.isOwner&&(this.es=!0,this.zCa=this.Rhf,this.Upa=this.Wkg)):"fetchFailed"===this.runStatus?(this.iya(1),this.gkb=Wa.wsa,this.message=K.a.instance.ia(2284)):"canceled"===this.runStatus?(this.iya(0),this.gkb=Wa.hy,this.message=String.format(K.a.instance.Ib(212),this.buttonText)):"alreadyRunning"===this.runStatus?(this.iya(5),this.gkb=Wa.hy,this.message=String.format(K.a.instance.Ib(211),this.buttonText),this.es=!0,this.zCa=this.eve,this.dJb=this.Upa=this.Jpb):
"initializing"===this.runStatus&&(this.iya(0),this.gkb=Wa.nj,this.message=K.a.instance.ia(2283))}get gs(){return this.gkb}get actionButton(){return this.zCa}get CSa(){return this.Lpd}Hl(Fa){super.Hl(Fa);this.Upa&&this.Upa()}d3(Fa){super.d3(Fa);this.CSa&&this.Mpd()}Oy(Fa){super.Oy(Fa);this.dJb&&this.dJb()}myk(){this.message="";this.gkb=Wa.nj;this.es=!1;this.zCa="";this.Upa=void 0;this.c2=!1;this.Lpd="";this.Mpd=void 0;this.hideCloseButton=!1;this.dJb=void 0}Jpb(){const Fa=ia.a.create().toString();
this.fL.c7i(Fa);this.BKc(-2186799,Fa)}Bug(){const Fa=ia.a.create().toString();this.fL.b7i(Fa);this.BKc(1036446140,Fa)}Cug(){const Fa=ia.a.create();if(this.scriptLink){const Da=new Z.b(this.scriptLink);this.fL.WRf(this.id.toString(),JSON.stringify(Da),Fa)}this.BKc(-585097204,Fa.toString())}Wkg(){const Fa=ia.a.create().toString();this.fL.a7i(Fa);this.BKc(-639858579,Fa)}wEj(Fa){aa.a(ta.a.fSj,void 0,void 0,[{name:"id",string:this.id.toString()},{name:"hasScriptLink",bool:!!this.scriptLink},{name:"runStatus",
string:this.runStatus},{name:"clickId",string:Fa},{name:"hasButtonText",bool:!!this.buttonText&&""!==this.buttonText}])}BKc(Fa,Da){aa.d(Fa,void 0,void 0,void 0,void 0,void 0,[{name:"id",string:this.id.toString()},{name:"hasScriptLink",bool:!!this.scriptLink},{name:"runStatus",string:this.runStatus},{name:"clickId",string:Da}])}}Object(y.a)(Ca,"OfficeScriptsRunStatusBusinessBarEntry",e.a,[]);var kb=a(57),eb=a(29);class Yb extends z.a{constructor(Fa,Da,ja,Qa,Ob,Ub){super(Fa,Da,ja);kb.a.instance.create(()=>
{this.showCallout(Da,Qa)},Ob,Ub,!0,!0)}showCallout(Fa,Da){if(this.businessBar&&this.businessBar.w2(Fa.yDa)&&this.g6e()){Fa=new A.a(-847286761,0,this.businessBar.$.xc,0,null);var ja={};ja.CalloutName=Da;B.EwaSettings.isChangeGateEnabled("OfficeVSO:6947554_RetrieveBusinessBarButtonElementChange")?ja.Target=this.wja():ja.Target=eb.a.vVb()?this.domElement.getElementsByTagName("button")[0]:this.nW.domElement;this.businessBar.$.Ia.Gb(Fa,ja)}}g6e(){return!0}}Object(y.a)(Yb,"CalloutBusinessBarEntry",z.a,
[]);class Gb extends Yb{constructor(Fa,Da,ja,Qa,Ob,Ub){super(Fa,Da,ja,Qa,Ob,Ub)}g6e(){if(!B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!0))return!0;if(!this.businessBar)return!1;const Fa=Ga.a.Cb(pa.OptimizeWorkbookManagerService);return Fa&&Fa.gWc?!1:!0}}Object(y.a)(Gb,"OptimizeWorkbookCalloutBusinessBarEntry",Yb,[]);var Mb=a(20),Rb=a(19),$b=a(663),cc=a(116),fb=a(126),Sb=a(125);class kc extends e.a{constructor(Fa,Da,ja){super(Fa,
Da);this.update(ja)}update(Fa){this.title=Fa.title?Fa.title:"";this.message=Fa.message?Fa.message:"";const Da=this.m4h(Fa.businessBarType);this.iya(Da);this.hideCloseButton=!!Fa.hideCloseButton;if(B.EwaSettings.isChangeGateEnabled("OfficeVSO:7958899_LogMsFormsDataSyncBizBarShown")){const ja=[];ja.push(fb.a.Mf("Reason",Fa.reason,cc.g.String));ja.push(fb.a.Mf("Type",Da.toString(),cc.g.String));aa.a("MsFormsDataSyncBizBarShown",void 0,void 0,ja)}B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormsDataSyncFGSurveyEnabled",
!1)&&Object(Rb.d)($b.a).execute(ja=>{Ka.AFrameworkApplication.Rj.Ag(new Sb.a(5,1,2E4,()=>{ja.logActivity("ExcelFormsDataSync",null)}))})}m4h(Fa){switch(Fa){case "error":return 1;case "blocked":return 2;case "severeWarning":return 3;case "success":return 4;case "warning":return 5;default:return 0}}}Object(y.a)(kc,"MsFormsDataSyncStatusBusinessBarEntry",e.a,[]);class na extends e.a{constructor(Fa,Da,ja,Qa){super(Fa,Da);this.c2=this.es=!0;this.xfk=ja;this.CIh=Qa}Hl(Fa){super.Hl(Fa);this.businessBar.$.Ia.Gb(new A.a(this.xfk,
Fa,this.businessBar.$.xc,10,null))}d3(Fa){super.Hl(Fa);this.businessBar.$.Ia.Gb(new A.a(this.CIh,Fa,this.businessBar.$.xc,10,null))}}Object(y.a)(na,"DualCommandActionsBusinessBarEntry",e.a,[]);var fc=a(1235),Cc=a(438),tc=a(114);class nb extends e.a{constructor(Fa,Da){super(Fa,Da);this.es=!0}Hl(Fa){super.Hl(Fa);void Ga.a.resolve(pa.DataRefreshManagerService,{xa:1}).then(Da=>{B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConfirmActiveContent",!1)?Da.EAg(()=>{this.businessBar.$.Ia.Gb(new A.a(-1995709983,
Fa,this.businessBar.$.xc,10,null))}):(Da.EAg(),this.businessBar.$.Ia.Gb(new A.a(-1995709983,Fa,this.businessBar.$.xc,10,null)),this.businessBar.removeEntry(74))})}}Object(y.a)(nb,"ExternalConnectionsEnableContentRefreshOnOpenBusinessBarEntry",e.a,[]);var tb=a(1116);class La extends e.a{constructor(Fa,Da,ja){super(Fa,Da);this.pYa=u.a.ybk;this.Uca=!0;this.command=ja;1461300262!==this.command&&(this.es=!0)}Hl(Fa){super.Hl(Fa);this.set_visible(!1);this.businessBar.$.AL();this.businessBar.$.Ia.Gb(new A.a(this.command,
Fa,this.businessBar.$.xc,10,null))}YU(Fa){super.YU(Fa);const Da=new A.a(-859308420,Y.a.Hb,this.businessBar.$.xc,12,null);this.businessBar.$.Ia.Gb(Da,{[Y.a.Bf]:"AssetID="+this.pYa,["InputMethod"]:Fa,[Y.a.Wc]:u.a.VF,["ShouldCanvasTakeFocus"]:!0})}Oy(Fa){this.businessBar.set_visible(!1);J.g(Fa)}}Object(y.a)(La,"AutoRefreshDisabledBusinessBarEntry",e.a,[]);class wb extends e.a{constructor(Fa,Da,ja){super(Fa,Da);this.update(ja)}update(Fa){const Da=Fa.entryToAdd;this.title=Da.title;this.message=Da.message;
this.LHb=Da.LHb;this.es=!0;this.Oy=ja=>{super.Oy(ja);Da.mT(null)}}get actionButton(){return this.LHb.text}Hl(Fa){super.Hl(Fa);(Fa=this.LHb.handler)&&Fa(null);this.LHb.Dhi&&this.Oy(null)}}Object(y.a)(wb,"SharedBusinessBarEntry",e.a,[]);class Wa extends r.a{constructor(Fa,Da){super(Da);this.bDf=n.DOMElementExtensions.$D+",div";this.T0=Array(79);this.GOe=this.ep=!1;this.h3=ja=>{if(ja.Ha.keyCode===b.a.JB){var Qa=this.ud.querySelectorAll(this.bDf);const Ob=n.DOMElementExtensions.Fz(Qa);Qa=n.DOMElementExtensions.A7(Qa);
return n.DOMElementExtensions.n5a(ja.Ha,Ob,Qa)}return!1};this.Qb=Fa;this.set_visible(!1);f.a.instance.va(k.a.nd,this.ud,this.h3);l.a(Fa).hl(this)}get tf(){return Ma.a.jtd}get ud(){return this.domElement}get ij(){return this.get_visible()}get $(){return this.Qb}Nj(Fa,Da){B.EwaSettings.isChangeGateEnabled("OfficeVSO:7627987_BizBarA11yFocusFix")?Da||n.DOMElementExtensions.setFocus(n.DOMElementExtensions.Fz(this.ud.querySelectorAll(this.bDf))):Da||n.DOMElementExtensions.setFocus(this.domElement.firstChild);
return!Da}zk(Fa){return n.DOMElementExtensions.Ki(this.ud,Fa)}Hm(){}fo(){}dispose(){this.ep||(f.a.instance.Ua(k.a.nd,this.ud,this.h3),x.a.xd(this.T0),this.T0=Array(79),this.Qb=null,super.dispose(),this.ep=!0)}w2(Fa){if(!this.get_visible())return!1;Fa=this.T0[Fa];return!!Fa&&Fa.isVisible}aKd(Fa){return this.w2(Fa)?this.T0[Fa].wja():null}GH(Fa){return!!this.T0[Fa]}Gwb(Fa,Da){if(Fa=this.T0[Fa])Fa.update(Da),Fa.Mbl()}pz(Fa,Da,ja,Qa){ja=void 0===ja?null:ja;Qa=void 0===Qa?null:Qa;Object(tc.d)(()=>{this.szh(Fa,
Da,ja,Qa)},this.Qb.Aa)}szh(Fa,Da,ja,Qa){ja=void 0===ja?null:ja;Qa=void 0===Qa?null:Qa;let Ob=!1;if(!this.GOe){var Ub=eb.a.vVb()?`${m.a.Muf} ${m.a.rpi}`:m.a.Muf;this.addCssClass(Ub);this.GOe=!0}if(this.GH(Fa))ja=this.T0[Fa].get_visible();else{this.set_visible(!0);Ub=Wa.GPf(this.$)[Fa];this.T0[Fa]=this.QP(Fa,Da,ja,Qa);ja=!1;Ob=!0;Qa="";let Zb=0;Da&&(Qa=Da.MessageIdName,Zb=Da.MessageId);const uc=Ub.nFa,Hc=xa.a.instance.Dja();c.ULS.sendTraceTag(537170258,0,50,`BusinessBarControl.AddEntry of type: ${Fa}, time from app interactive: ${Hc}`);
B.EwaSettings.isChangeGateEnabled("OfficeVSO:7232357_AvoidBsqmReportingForSuccessBizBars")&&4===Ub.businessBarType||Va.a(this.$).Jje(Ub.hash,Qa,Zb,0,!0,1,Da,uc)}ja||!w.BusinessBarManager.DBc().includes(Fa)&&!Ob||(this.T0[Fa].set_visible(!0),this.$.AL())}removeEntry(Fa){return this.xqk(Fa)}Hhe(){x.a.xd(this.T0);this.T0=Array(79);this.set_visible(!1)}xqk(Fa){if(!this.GH(Fa))return!1;x.a.vb(this.T0[Fa]);this.T0[Fa]=null;this.domElement.hasChildNodes()||this.set_visible(!1);this.$.AL();return!0}QP(Fa,
Da,ja,Qa){ja=void 0===ja?null:ja;Qa=void 0===Qa?null:Qa;const Ob=Wa.GPf(this.$)[Fa],Ub=!!(this.$.$d&64),Zb=this.$.emb();switch(Fa){case 23:Fa=Zb?new z.a(this,Ob,617689800):new e.a(this,Ob);break;case 2:case 4:case 25:case 26:case 36:case 35:Fa=new e.a(this,Ob);break;case 12:case 29:case 30:case 31:case 32:case 57:Fa=Ub?new z.a(this,Ob,-8805455):new e.a(this,Ob);break;case 34:Fa=Ub?new na(this,Ob,-8805455,-104572626):new e.a(this,Ob);break;case 22:Fa=new E(this,Ob,-8805455);break;case 46:case 45:Fa=
Ub?new N(this,Ob,Da,0,-8805455):new G(this,Ob,Da,0);break;case 11:case 43:case 7:case 0:case 1:case 3:case 33:Fa=new G(this,Ob,Da,0);break;case 19:Fa=new e.a(this,Ob);break;case 47:Fa=new G(this,Ob,Da,0);break;case 6:case 14:Fa=new X(this,Ob,Da.HelpTopicId);break;case 67:case 65:Fa=new S(this,Ob,Da.HelpTopicId);break;case 73:Fa=new S(this,Ob,Cc.a.nyg);break;case 72:Fa=new E(this,Ob,-1698025133);break;case 37:Fa=new S(this,Ob,u.a.Hci);break;case 38:Fa=new e.a(this,Ob);break;case 71:Fa=new e.a(this,
Ob);break;case 68:Fa=new E(this,Ob,924877417);break;case 16:Fa=new e.a(this,Ob);Fa.title=d.a.$l(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);Fa.message=d.a.$l(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);break;case 18:Fa=new z.a(this,Ob,-1762562205);Fa.hideCloseButton=!0;break;case 20:Fa=new mb(this,Ob);break;case 21:case 56:Fa=new e.a(this,Ob);break;case 28:Fa=new e.a(this,Ob);break;case 24:Fa=new Na(this,Ob);break;case 27:Fa=new Za(this,Ob);break;case 39:Fa=new Ia.a(this,
Ob);break;case 40:Fa=new t.a(this,Ob);break;case 41:Fa=new fa.a(this,Ob);break;case 42:Fa=new Ha.a(this,Ob);break;case 48:Fa=new e.a(this,Ob);break;case 49:Fa=new e.a(this,Ob);break;case 50:Fa=new e.a(this,Ob);break;case 51:Fa=new e.a(this,Ob);break;case 52:Fa=new e.a(this,Ob);break;case 53:Fa=new ba.a(this,Ob);break;case 54:Fa=new la.a(this,Ob);break;case 55:Fa=new U(this,Ob);break;case 5:Fa=new O(this,Ob);break;case 58:Fa=new z.a(this,Ob,-1753056834);Da?(Da=Da.Directive,hb.a.uu(Da)||"&nbsp;"===
Da||(Fa.message=Da)):ja&&(Fa.message=ja);break;case 59:Fa=new Oa(this,Ob);break;case 60:Fa=new e.a(this,Ob);break;case 63:Fa=new S(this,Ob,u.a.aRj);break;case 61:Fa=new ea(this,Ob,u.a.wNh,-8805455);break;case 44:Fa=new La(this,Ob,-1193102612);break;case 76:Fa=new La(this,Ob,1461300262);break;case 77:Fa=new La(this,Ob,1461300262);break;case 78:Fa=new La(this,Ob,1723441034);break;case 66:Fa=new ea(this,Ob,u.a.Tkk,1461300262);break;case 62:Fa=new Gb(this,Ob,515196233,13,3E5,"OptimizeWorkbookManager.ShowBusinessBarTeachingCallout");
Fa.message=ja;break;case 70:Fa=new fc.a(this,Ob,-1190551534);break;case 64:Fa=new Ca(this,Ob,this.$,Qa);break;case 69:Fa=new kc(this,Ob,Qa);break;case 74:Fa=new nb(this,Ob);break;case 75:Fa=new wb(this,Ob,Qa);break;default:Fa=new G(this,Ob,Da,7)}Fa.Jjf();return Fa}static GPf(Fa){const Da=Fa.emb();Fa=$a.a.Tua()?261:260;const ja=B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.WebWorkbookLinkNewTaskPaneEnabled",!1);return Wa.Paf||(Wa.Paf=[new I(0,276,277,278,0,0,Wa.wsa,1,"BB_UnableToRefreshLock"),
new I(1,276,277,278,0,0,Wa.wsa,1,"BB_UnableToRefreshLockExpected"),new I(2,268,269,0,0,0,Wa.hy,5,"BB_WorkbookAlmostTooLarge"),new I(3,270,271,272,0,0,Wa.wsa,1,"BB_WorkbookTooLarge"),new I(4,259,Fa,0,0,0,Wa.hy,5,"BB_ExternalWorkbookLinksDisabled"),new I(5,263,262,264,0,0,Wa.wsa,5,"BB_ExternalWorkbookLinksShowError","Warning_MessageBar_16"),new I(6,265,266,267,0,0,Wa.nj,0,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),new I(7,251,252,253,0,0,Wa.nj,5,"BB_UnsupportedFeatures"),new I(8,0,0,0,0,0,Wa.nj,0,
"BB_CollabDataAndDataStringsLocaleMismatch"),new I(9,0,0,0,0,0,Wa.nj,0,"BB_CollabDataStringsLocaleMismatch"),new I(10,0,0,0,0,0,Wa.nj,0,"BB_CollabDataLocaleMismatch"),new I(11,279,280,281,0,0,Wa.wsa,1,"BB_LastGenericStatusError"),new I(12,282,283,284,0,0,Wa.hy,5,"BB_ScratchPadWarning"),new I(13,285,286,287,0,0,Wa.wsa,1,"BB_AuthenticationLost"),new I(14,288,289,290,0,0,Wa.hy,5,"BB_OdfCompatibilityIssues"),new I(15,0,575,0,0,0,Wa.hy,5,"BB_PivotChartInteractivityMissingWarning"),new I(16,0,0,0,0,0,Wa.nj,
2,"BB_WorkbookIsIrmProtected"),new I(17,0,0,0,0,0,Wa.nj,0,"BB_BIFeatureNotAvailable"),new I(18,291,292,287,0,0,Wa.hy,5,"BB_AnonymousCreateMode"),new I(19,254,255,0,0,0,Wa.hy,5,"BB_UnsupportedInteractiveReportEditing"),new I(20,0,0,0,0,0,Wa.nj,0,"BB_MobileAppCampaignBizBar"),new I(21,297,298,0,0,0,Wa.nj,0,"BB_TransientServerCommunicationFailures"),new I(22,1643,1654,1655,0,0,Wa.nj,5,"BB_EditAttemptInReadOnly"),new I(23,1643,Da?2348:1654,Da?2349:0,0,0,Wa.nj,5,"BB_EditAttemptInReadOnlyNoEditPermissions"),
new I(24,0,C.HelperMethods.gbl(),1632,0,0,Wa.nj,3,"BB_UnsupportedBrowser"),new I(25,300,301,0,0,0,Wa.nj,2,"BB_ReadOnlyPermissions"),new I(26,302,303,0,0,0,Wa.nj,2,"BB_DocumentIsIrmProtectedWarning"),new I(27,0,0,0,0,0,Wa.hy,5,"BB_PolicyWarningMessage"),new I(28,1285,299,0,0,0,Wa.nj,0,"BB_WorkingOnIt"),new I(29,1643,1641,1642,0,0,Wa.nj,2,"BB_PasswordProtectedWorkbookLockedForEdit"),new I(30,1656,1657,1658,0,0,Wa.nj,5,"BB_WorkbookIsReadOnlyRecommended"),new I(31,1643,1659,1660,0,0,Wa.nj,5,"BB_WorkbookHasPasswordToModify"),
new I(32,1643,1661,1664,0,0,Wa.nj,3,"BB_LegacySharedWorkbookEditWarning"),new I(33,1651,1662,253,0,0,Wa.nj,5,"BB_LegacyConnectionsWarning"),new I(34,1643,1960,1961,1962,0,Wa.nj,0,"BB_TooManyLoadBlockingFloatingObjects"),new I(35,1652,1653,0,0,0,Wa.nj,2,"BB_GroupedSlicers"),new I(36,313,314,0,0,0,Wa.hy,5,"BB_ThirdPartyAddinDisabled"),new I(37,1789,1790,0,0,1791,Wa.nj,5,"BB_FinanceLinkedEntityDisclaimerBar"),new I(38,1818,1819,0,0,0,Wa.hy,5,"BB_WolframDeprecationAlertBar"),new I(39,0,0,0,0,0,Wa.nj,
0,"BB_WacGdprNotice"),new I(40,0,0,0,0,0,Wa.nj,0,"BB_AutomaticSensitivityLabel"),new I(41,0,0,0,0,0,Wa.nj,0,"BB_RecommendedSensitivityLabel"),new I(42,0,0,0,0,0,Wa.nj,0,"BB_MandatorySensitivityLabel"),new I(43,315,316,317,0,0,Wa.nj,0,"BB_LocalStorageDisabled"),new I(44,632,633,2511,0,1319,Wa.nj,0,"BB_AutoRefreshDisabled"),new I(45,1014,1012,1016,1314,0,Wa.nj,4,"BB_CorruptedFileRepaired"),new I(46,1015,1013,1016,1314,0,Wa.nj,5,"CorruptedOdsFileRepaired"),new I(47,273,274,275,0,0,Wa.hy,5,"BB_MinorVersionLimitReached"),
new I(48,304,305,0,0,0,Wa.hy,5,"BB_SensitivityApplicationGenericError"),new I(49,306,308,0,0,0,Wa.hy,5,"BB_SensitivityApplicationTooLargeFileError"),new I(50,307,308,0,0,0,Wa.hy,5,"BB_SensitivityApplicationLabelNotSupportedError"),new I(51,309,310,0,0,0,Wa.hy,5,"BB_SensitivityApplicationLabelDisabledError"),new I(52,311,312,0,0,0,Wa.hy,5,"BB_SensitivityApplicationMandatoryConflictError"),new I(53,0,0,0,0,0,Wa.hy,5,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new I(54,0,0,0,0,0,Wa.hy,
5,"BB_SensitivityApplicationSetLabelError"),new I(55,ja?2470:2119,ja?2468:2120,ja?2469:2121,2124,ja?2467:0,Wa.nj,5,"BB_ExternalWorkbookLinksPromptEnableContent","Warning_MessageBar_16",ja?2512:0),new I(56,297,298,0,0,0,Wa.nj,0,"BB_NetworkDown"),new I(57,318,319,320,0,0,Wa.nj,2,"BB_DefaultToViewDueToCogs"),new I(58,1815,1816,1817,0,0,Wa.nj,1,"BB_RefreshLinkedEntityErrorBar"),new I(59,1792,1793,1794,1795,0,Wa.nj,1,"BB_LinkedEntitiesUntrustedImagesDisabled"),new L(60,250,0,0,0,Wa.nj,5,"BB_CanvasHealth"),
new I(61,1017,1018,1314,0,1019,Wa.nj,5,"BB_MismatchedFileFormatConverted"),new I(62,2238,0,2240,0,0,Wa.nj,5,"BB_OptimizeWorkbook"),new I(63,321,322,0,0,323,Wa.nj,0,"BB_NovModePostDepreciation"),new I(64,0,0,0,0,0,Wa.nj,0,"BB_OfficeScriptsRunning"),new I(65,2214,2215,0,0,2217,Wa.nj,0,"BB_PowerQueryRefreshDataSourceNotSupported"),new I(66,324,325,0,0,326,Wa.nj,5,"BB_ReadOnlyPivotTable"),new I(67,2214,2216,0,0,2217,Wa.nj,0,"BB_PowerQueryRefreshHostNotSupported"),new I(68,1057,h.a.mHc?1059:1058,1056,
0,0,Wa.nj,4,"BB_RefreshPageAfterEnablingTheExtension"),new I(69,0,0,0,0,0,Wa.nj,0,"BB_MsFormsDataSyncStatus"),new I(70,0,0,0,0,2485,Wa.hy,5,"BB_DataCleansingSuggestions",Object(tb.a)()),new L(71,2324,0,0,0,Wa.nj,4,"BB_EditInMiniWAC","EditExcel_16"),new I(72,2326,2327,2325,0,0,Wa.hy,5,"BB_PowerQueryUnsupportedTeams"),new I(73,2326,2328,0,0,2217,Wa.hy,5,"BB_PowerQueryEnableThirdPartyCookies"),new I(74,2487,2488,2489,0,0,Wa.hy,5,"BB_ExternalConnectionsEnableContentRefreshOnOpen"),new I(75,0,0,0,0,0,
Wa.hy,5,"BB_ApplicationNotification"),new I(76,0,2604,0,0,1319,Wa.nj,0,"BB_PivotTableAutoRefreshDisabled"),new I(77,2605,2606,0,0,1319,Wa.nj,0,"BB_PivotTableAutoRefreshDisabledDueToExpandOverlap"),new I(78,2607,2608,1995,0,1319,Wa.nj,0,"BB_PivotTableAutoRefreshDisabledDueToSheetProtection")])}}Wa.wsa=Mb.a.Vri;Wa.hy=Mb.a.Xri;Wa.nj=Mb.a.Wri;Wa.Paf=null;Object(y.a)(Wa,"BusinessBarControl",r.a,[24])},1442:function(y,r,a){a.d(r,"a",function(){return Oa});y=a(0);var c=a(15),b=a(39),f=a(91),k=a(16),x=a(154),
d=a(363);r=a(93);var h=a(10),n=a(85),m=a(5),u=a(65),l=a(674);class t{constructor(Ha,Za){this.helpId=this.helpText=this.imageAltText=this.urlValue=this.longDescription=this.convertToDomainName=this.cardViewManager=null;this.$=Za;this.parentElement=Ha}Z5h(){const Ha=this.$5h();m.CardViewManagerService.Oa()?void u.a.resolve(m.CardViewManagerService,{xa:0}).then(Za=>{this.cardViewManager=Za;Za.lWg(this.parentElement,Ha)}):l.a(this.$,243,242,0,Za=>{this.cardViewManager=Za;Za.lWg(this.parentElement,Ha)})}PTf(){this.cardViewManager&&
this.cardViewManager.Sjb(-1,-1,this.parentElement)}$5h(){const Ha={layoutId:"AutoDetectTooltip"};Ha.description=this.longDescription;Ha.convertToDomainName=this.convertToDomainName;Ha.longDescription=this.longDescription;Ha.urlValue=this.urlValue;Ha.imageAltText=this.imageAltText;Ha.helpText=this.helpText;Ha.helpId=this.helpId;return Ha}}Object(y.a)(t,"AutoDetectCardManager",null,[]);var e=a(31),w=a(241),z=a(32),E=a(286),M=a(20),G=a(64);class A extends r.a{constructor(Ha,Za,fa){super();this.Hd=la=>
{if(la.sc.id===this.qVa.firstChild.id){la=this.E9e;const ba={};ba.Id=la.$Gb;this.Zm.Wxd(ba,!0,la);this.qVa.removeChild(this.qVa.firstChild);return!0}return!1};this.E9e=Ha;this.Zm=Za;this.qVa=document.createElement("div");this.qVa.className="clip16x16";this.GHa=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',z.a.$l("autodetectid"+this.E9e.left),M.a.ZEd,G.a.Lh(11));fa.vl(this.qVa,this.GHa);Ha=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");
E.a.instance.va(k.a.click,Ha,this.Hd)}get domElement(){return this.qVa}dispose(){if(this.qVa){const Ha=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");E.a.instance.Ua(k.a.click,Ha,this.Hd)}super.dispose()}static get pSh(){return"clip16x16"}}Object(y.a)(A,"AutoDetectColumnHeaderButton",r.a,[]);var N=a(1),K=a(1243),I=a(12),L=a(25),J=a(230);class B extends r.a{constructor(Ha,Za,fa){super();this.Mc=null;this.$=Ha;this.da=L.f(Ha);this.Zm=Za;this.Mc=fa;this.zwd=new J.a}dispose(){super.dispose()}Khi(Ha){for(const Za of this.da.oX)for(const fa of Za){const la=
fa,ba=la.$T,aa=K.a(la.wRd);this.Pyh(Ha,aa,ba);la.nRg(aa)}}Pyh(Ha,Za,fa){if(Za.length){var la=fa.length;fa[la-1]<Ha.left||(fa=I.HelperMethods.tF(new w.a(fa),0,la,Ha.left,I.HelperMethods.gO),0>fa||!(Za=Za[fa]))||(this.da.rtl?Za.classList.add(e.a.Tui):Za.classList.add(e.a.Sui),this.zwd.Bb(Ha.left)||this.zwd.add(Ha.left,new A(Ha,this.Zm,this.Mc)),Ha=this.zwd.pa(Ha.left).domElement,!Za.getElementsByClassName(A.pSh).length&&this.SZk(Za)&&Za.appendChild(Ha))}}SZk(Ha){const Za=parseInt(Ha.style.width,10);
var fa=document.querySelector(".ewrch-col-cellsel")?"bold":"normal";fa=B.P7h(fa);Ha=gridRenderer.CanvasRendererGlobals.measureTextWidth(this.Mc.T_i(Ha.firstChild.innerHTML),fa,!0,N.EwaSettings.isChangeGateEnabled("OfficeVSO:8633312_TextWidth"));return 18.4<Za-(Za/2+Ha/2)?!0:!1}static P7h(Ha){return`${"normal"} ${"normal"} ${Ha} ${"10pt"}/${"normal"} ${'"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif'}`}}Object(y.a)(B,"AutoDetectColumnHeaderManager",r.a,[]);var Y=a(502),U=a(27),O=a(74),C=a(134),
X=a(17),S=a(13),ea=a(98);class Oa extends r.a{constructor(Ha,Za,fa,la,ba){super();this.isMac=b.a.isMac;this.vbb=-1;this.gsc=null;this.qEa=-1;this.u0a=this.iJc=this.Ete=this.RIa=this.F9e=!1;this.t0=null;this.ph=()=>{this.PHa&&this.da&&this.QZ()};this.jd=()=>{this.Dy()};this.Hd=()=>{this.sUa();L.f(this.$).Nj(!0,!1)};this.eKa=(oa,Na)=>{Na?(this.U6g(this.gsc),this.zXg()):(oa=[29],this.da.Ub.rl(oa),this.da.Ub.pn(null,oa),this.t0&&this.t0.PTf())};this.qk=()=>{this.Mlb()&&this.fl.hide();1===this.da.ha.gf&&
this.QZ()};this.nB=()=>{const oa=this.da.ha.gf;this.da.ha.oa.activeCell&&1===oa&&this.QZ()};this.onKeyUp=oa=>this.aKc?this.RIa?!1:17===oa.Ha.keyCode&&this.Ete?(this.u0a?(this.zXg(),this.Dsb()):this.gRg(),!0):!1:this.RIa=!1;this.onKeyDown=oa=>{if(!this.aKc)return this.RIa=!1;this.Ete=!1;this.RIa=oa.ctrlKey;switch(oa.Ha.keyCode){case 27:return this.u0a?(this.eKa(null,!1),this.Dsb()):this.t0&&(this.t0.PTf(),this.gRg()),!0;case 13:if(this.u0a)return this.u0a=!1,this.sUa(),!0;break;case 17:return this.Ete=
!0}return!1};const {AutoDetectActionButton:aa}=a(1494);this.$=Ha;this.aHb=N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AutoDetectRichTooltip",!1);Za||c.ULS.sendTraceTag(537166983,0,15,"AutoDetectManager: SVG icons are enabled, but svgIconProvider is null");this.Zm=la;la.n1b();this.fl=new aa(Ha,Za,this.Hd,fa,"");this.NMh=new B(this.$,la,ba);this.da=L.f(this.$);this.da.ha.ZS(this.ph);this.da.Rb.zFb(this.ph);this.da.aw(this.nB);Ha.Sj(this.jd);Ha.DD(this.qk);this.gridBlockManager=
Object(x.a)(8,this.da.za);this.Jy=Ha.frame.hD;this.QZ()}get ud(){return this.fl.domElement(1)}get aKc(){const Ha=this.fl.domElement(Oa.Nna);return Ha?X.DOMElementExtensions.isVisible(Ha):!1}get PHa(){return this.$.isEditMode&&N.EwaSettings.Ra(128)&&N.EwaSettings.Ra(131)&&(new C.SheetProtection(this.$.qa)).Ih?!1:-1!==this.qEa}dispose(){this.da&&this.da.ha.rV(this.ph);if(this.$){const Ha=this.$;Ha.ro(this.jd);Ha.vG(this.qk);L.f(Ha).Zz(this.nB)}f.a.vb(this.fl);this.Jy=this.$=this.da=this.fl=null;super.dispose()}Dy(){this.eKa(null,
!1);this.vbb=-1;this.fl.hide();this.N$k();this.u0a=!1}Dsb(){this.fl.getButton(Oa.Nna).m4b();this.u0a=!1}gRg(){this.fl.getButton(Oa.Nna).Mqb();this.U6g(this.gsc);this.u0a=!0;N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)?void u.a.Bd(m.AriaLiveNotifierService).then(Ha=>{Ha.L3(S.a.instance.ia(1751))}):this.$.ra.Vc(211,Ha=>{Ha.L3(S.a.instance.ia(1751))})}onAutoDetectUIShown(){if(this.PHa&&-1!==this.vbb)this.Zm.onAutoDetectUIShown()}OMh(Ha){var Za=new U.Range(1===
Ha.top?1:Ha.top-1,Ha.left,Ha.bottom,Ha.right,!0,!1);Za=this.da.getRangeInformation(Za);for(const fa of Za)if(Object(d.a)(Y.AutoDetectRange,fa)&&this.aFc(Ha,!1,fa))return!0;return!1}sUa(){if(this.PHa&&-1!==this.vbb){this.fl.getButton(Oa.Nna).Mqb();var Ha={};Ha.Id=this.qEa;Ha.StringId=null;this.Zm.Wxd(Ha,!0,this.gsc);c.ULS.sendTraceTag(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");ea.a("AssistedAutoConvertMenuConvertClicked",void 0,void 0,[{name:"Domain",int64:this.qEa}]);
this.qEa=-1}}cLi(){let Ha=S.a.instance.ia(1747);if(-1!==this.qEa){Ha+=" ";try{Ha+=this.Zm.PWb(this.qEa.toString())}catch(Za){c.ULS.sendTraceTag(537166982,0,10,`AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain ${this.qEa}`)}}Ha+=" ";return Ha=this.aHb?Ha+S.a.instance.ia(1750):Ha+S.a.instance.ia(this.isMac?1749:1748)}zXg(){this.aHb&&(this.t0||(this.t0=new t(this.ud,this.$),this.t0.convertToDomainName=S.a.instance.ia(1752),this.t0.urlValue="https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",
this.t0.imageAltText=S.a.instance.ia(1754),this.t0.helpId="HID_DataTypes_Wolfram",this.t0.helpText=S.a.instance.ia(1753)),this.t0.longDescription=this.Zm.Hxe(this.vbb.toString()),this.t0.Z5h())}aFc(Ha,Za,fa){if((new U.Range(fa.top,fa.left,fa.bottom===h.a.sf?fa.bottom:fa.bottom+1,fa.right,!0,!1)).ld(Ha)){if(Za){if(fa&&fa.$Gb!==this.vbb){this.vbb=fa.$Gb;Ha=fa.$Gb.toString();Za=this.aHb?"":this.Zm.Hxe(Ha);const la=this.Zm.Ddj(Ha);this.fl.Uwb(this.Zm.PWb(Ha),Za,la,Oa.Nna)}this.qEa=fa.$Gb;this.gsc=fa}return!0}return!1}QZ(){if(this.Zm){var Ha=
this.da.ha.gf;if(this.gridBlockManager&&this.gridBlockManager.WQd){var Za=this.da.ha.oa.activeCell,fa=!this.gridBlockManager.ft(Za),la=this.da.getRangeInformation(this.da.Ek);for(const ba of la)if(Object(d.a)(Y.AutoDetectRange,ba))switch(la=ba,la.Def){case 3:if(this.aFc(Za,!0,la)){if(1!==Ha||fa){this.Dy();return}c.ULS.sendTraceTag(537166981,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.nhe();this.fl.cna(Za,this.eKa);this.F9e||(this.F9e=!0,this.onAutoDetectUIShown());
return}break;case 2:case 1:N.EwaSettings.QYd()&&c.ULS.sendTraceTag(507016458,0,15,`AutoDetectManager.ShowOrHideButtonOnGrid entered LinkedEntityClassifierTrigger ${2===la.Def?"Load":"Paste"}`);if(N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.LoadClassifier",!1)||N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.PasteClassifier",!1))N.EwaSettings.QYd()&&c.ULS.sendTraceTag(507016457,0,15,"AutoDetectManager.ShowOrHideButtonOnGrid called displayColumnHeaderButton"),
this.NMh.Khi(la);break;default:c.ULS.sendTraceTag(537166980,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}}this.Dy()}}U6g(Ha){const Za=[29];this.da.Ub.pn(Ha,Za);this.da.Ub.Iq(Za)}Mlb(){return this.$.fa.isNamedObjectViewMode&&O.f(this.$.la)}nhe(){this.aHb&&!this.iJc&&this.Jy&&(this.Jy.Vy(k.a.nd,this.$.domElement,this.onKeyDown,!0),this.Jy.Vy(k.a.Ye,this.$.domElement,this.onKeyUp,!0),this.iJc=!0)}N$k(){this.aHb&&this.iJc&&this.Jy&&(this.Jy.fz(k.a.nd,this.$.domElement,
this.onKeyDown,!0),this.Jy.fz(k.a.Ye,this.$.domElement,this.onKeyUp,!0),this.iJc=!1)}static get Nna(){return 1}static wNi(Ha){return S.a.instance.ia(1808)+n.a.space+Ha}}Object(y.a)(Oa,"AutoDetectManager",r.a,[])},1446:function(y,r,a){a.r(r);a.d(r,"BusinessBarManager",function(){return C});y=a(133);r=a(0);var c=a(15),b=a(6),f=a(91),k=a(39),x=a(41),d=a(93),h;(function(X){X[X.unableToRefreshLock=0]="unableToRefreshLock";X[X.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";X[X.workbookAlmostTooLarge=
2]="workbookAlmostTooLarge";X[X.workbookTooLarge=3]="workbookTooLarge";X[X.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";X[X.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";X[X.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";X[X.unsupportedFeatures=7]="unsupportedFeatures";X[X.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";X[X.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";
X[X.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";X[X.lastGenericStatusError=11]="lastGenericStatusError";X[X.scratchPadWarning=12]="scratchPadWarning";X[X.authenticationLost=13]="authenticationLost";X[X.odfCompatibilityIssues=14]="odfCompatibilityIssues";X[X.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";X[X.workbookIsIrmProtected=16]="workbookIsIrmProtected";X[X.biFeatureNotAvailable=17]="biFeatureNotAvailable";X[X.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";
X[X.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";X[X.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";X[X.transientServerCommunicationFailures=21]="transientServerCommunicationFailures";X[X.editAttemptInReadOnly=22]="editAttemptInReadOnly";X[X.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";X[X.unsupportedBrowser=24]="unsupportedBrowser";X[X.readOnlyPermissions=25]="readOnlyPermissions";X[X.documentIsIrmProtectedWarning=26]=
"documentIsIrmProtectedWarning";X[X.policyWarningMessage=27]="policyWarningMessage";X[X.workingOnIt=28]="workingOnIt";X[X.passwordProtectedWorkbookLockedForEdit=29]="passwordProtectedWorkbookLockedForEdit";X[X.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";X[X.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";X[X.legacySharedWorkbookEditWarningBB=32]="legacySharedWorkbookEditWarningBB";X[X.legacyConnectionsBB=33]="legacyConnectionsBB";X[X.tooManyLoadBlockingFloatingObjectsBB=
34]="tooManyLoadBlockingFloatingObjectsBB";X[X.groupedSlicersBB=35]="groupedSlicersBB";X[X.thirdPartyAddinDisabled=36]="thirdPartyAddinDisabled";X[X.financeLinkedEntityDisclaimerBar=37]="financeLinkedEntityDisclaimerBar";X[X.wolframDeprecationAlertBar=38]="wolframDeprecationAlertBar";X[X.wacGdprNotice=39]="wacGdprNotice";X[X.automaticSensitivityLabel=40]="automaticSensitivityLabel";X[X.recommendedSensitivityLabel=41]="recommendedSensitivityLabel";X[X.mandatorySensitivityLabel=42]="mandatorySensitivityLabel";
X[X.localStorageDisabled=43]="localStorageDisabled";X[X.autoRefreshDisabled=44]="autoRefreshDisabled";X[X.corruptedFileRepaired=45]="corruptedFileRepaired";X[X.corruptedOdsFileRepaired=46]="corruptedOdsFileRepaired";X[X.minorVersionLimitReached=47]="minorVersionLimitReached";X[X.sensitivityApplicationGenericError=48]="sensitivityApplicationGenericError";X[X.sensitivityApplicationTooLargeFileError=49]="sensitivityApplicationTooLargeFileError";X[X.sensitivityApplicationLabelNotSupportedError=50]="sensitivityApplicationLabelNotSupportedError";
X[X.sensitivityApplicationLabelDisabledError=51]="sensitivityApplicationLabelDisabledError";X[X.sensitivityApplicationMandatoryConflictError=52]="sensitivityApplicationMandatoryConflictError";X[X.sensitivityApplicationMinorVersionLimitReachedError=53]="sensitivityApplicationMinorVersionLimitReachedError";X[X.sensitivityApplicationSetLabelError=54]="sensitivityApplicationSetLabelError";X[X.promptEnableExternalLinks=55]="promptEnableExternalLinks";X[X.networkDown=56]="networkDown";X[X.defaultToViewDueToCogs=
57]="defaultToViewDueToCogs";X[X.refreshLinkedEntityErrorBar=58]="refreshLinkedEntityErrorBar";X[X.promptEnableLinkedEntitiesUntrustedImages=59]="promptEnableLinkedEntitiesUntrustedImages";X[X.canvasHealth=60]="canvasHealth";X[X.mismatchedFileFormatConverted=61]="mismatchedFileFormatConverted";X[X.optimizeWorkbook=62]="optimizeWorkbook";X[X.novModePostDepreciation=63]="novModePostDepreciation";X[X.officeScriptsRunning=64]="officeScriptsRunning";X[X.powerQueryRefreshDataSourceNotSupported=65]="powerQueryRefreshDataSourceNotSupported";
X[X.readOnlyPivotTable=66]="readOnlyPivotTable";X[X.powerQueryRefreshHostNotSupported=67]="powerQueryRefreshHostNotSupported";X[X.refreshPageAfterEnablingTheExtension=68]="refreshPageAfterEnablingTheExtension";X[X.msFormsDataSyncStatus=69]="msFormsDataSyncStatus";X[X.dataCleansingSuggestions=70]="dataCleansingSuggestions";X[X.editInMiniWAC=71]="editInMiniWAC";X[X.powerQueryUnsupportedTeams=72]="powerQueryUnsupportedTeams";X[X.powerQueryEnableThirdPartyCookies=73]="powerQueryEnableThirdPartyCookies";
X[X.externalConnectionsEnableContentRefreshOnOpen=74]="externalConnectionsEnableContentRefreshOnOpen";X[X.applicationNotification=75]="applicationNotification";X[X.pivotTableAutoRefreshDisabled=76]="pivotTableAutoRefreshDisabled";X[X.pivotTableAutoRefreshDisabledDueToExpandOverlap=77]="pivotTableAutoRefreshDisabledDueToExpandOverlap";X[X.pivotTableAutoRefreshDisabledDueToSheetProtection=78]="pivotTableAutoRefreshDisabledDueToSheetProtection";X[X.count=79]="count"})(h||(h={}));Object(r.b)("EwaBusinessBarEntryType",
h);var n=a(7),m=a(1233);class u extends Sys.EventArgs{constructor(X,S,ea){ea=void 0===ea?null:ea;super();this.yDa=X;this.hCd=S;this.data=ea}}Object(r.a)(u,"BusinessBarEntryDisplayChangedEventArgs",Sys.EventArgs,[]);var l=a(1236),t=a(1234),e=a(1238);a(1237);var w=a(1231),z=a(746),E=a(43),M=a(794),G=a(36),A=a(1),N=a(25),K=a(68),I=a(76),L=a(1118),J=a(65),B=a(5),Y=a(1235),U=a(88),O;let C=O=class extends d.a{constructor(X,S){S=void 0===S?!X.eka:S;super();this.ub=new x.a;this.fX=null;this.p$c=[];this.mNc=
()=>{this.$.ma.QHa?this.removeEntry(13):this.lh(13,null)};this.Zi=(ea,Oa)=>{for(let Ha=0,Za=O.DBc().length;Ha<Za;Ha++)ea=O.DBc()[Ha],this.removeEntry(ea);ea=[500,502,503];Oa.context&&0<Oa.context.communicationErrorRetryCount&&ea.includes(Oa.context.K0d)&&(A.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.ServerCommunicationBBTimeoutInMs",0)&&!this.GH(21)?c.ULS.sendTraceTag(507359372,0,20,"OnWebMethodSuccess: webMethod failed initially, but succeeded before timeout, hence no business bar was shown"):
c.ULS.sendTraceTag(537170240,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),this.bbb&&(window.clearTimeout(this.bbb),this.bbb=null),this.removeEntry(21));this.wwk()};this.tr=(ea,Oa)=>{var Ha;ea=this.LAi(Oa.errors);let Za=[];for(let la=0,ba=ea.length;la<ba;++la){const aa=ea[la];if(1===aa.Type&&aa.Appearance&32)Za=this.f$i(aa,Za);else if(Oa.oHk){c.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");
var fa=(null===(Ha=Oa.context)||void 0===Ha?0:Ha.stopwatch)?Oa.context.stopwatch.Kc:-1;5E3>fa?c.ULS.sendTraceTag(537170208,0,50,`OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = ${fa}ms).`):b.AFrameworkApplication.hxj()||this.iCh(aa,Oa.context.methodName)}fa=[...O.DBc()];for(let oa=0,Na=Za.length;oa<Na;++oa){const Ia=Za[oa];this.lh(Ia,aa);Array.remove(fa,Ia)}for(let oa=0,Na=fa.length;oa<Na;++oa)this.removeEntry(fa[oa])}};
this.yd=(ea,Oa)=>{this.jd(ea,Oa)};this.jd=()=>{const ea=this.$.fa;ea.yc||ea.Hg()||(this.Hhe(),this.p$c.length=0)};this.de=(ea,Oa)=>{this.$.fa.Hg()&&!Oa.DY||this.cWf(Oa.DY)};this.o0b=()=>{const ea=this.$.userOperationManager.rBc();ea&&ea.operation.flags&1&&this.EWg()};this.Eng=()=>{this.EWg()};this.fg=()=>{this.Udf();this.RWg()};this.uE=()=>{if(this.$.Ika&&this.$.fa.Hg()&&this.$.fa.yc)if(this.$.fa.isEditMode)this.removeEntry(45),this.removeEntry(12),this.removeEntry(29),this.removeEntry(30),this.removeEntry(31),
this.removeEntry(32),this.removeEntry(34),this.removeEntry(22),this.removeEntry(57);else{const ea=B.ExternalLinksManagerService.Oa()?J.a.Cb(B.ExternalLinksManagerService):this.$.ra.Tb(331);ea&&ea.NX||this.removeEntry(55);this.removeEntry(5)}};this.$=X;this.qcb=S;this.bbb=null;a(1491);this.yLh();b.AFrameworkApplication.od&&b.AFrameworkApplication.od.mFb(this);this.wbb=Array(79);for(let ea=0;79>ea;ea++)this.wbb[ea]=null;this.vj=M.EcmaDateClock.instance;this.B7f=this.vj.Jc.getTime();S&&(S=X.ma,S.yP(this.tr),
S.ED(this.Zi),S.uFb(this.mNc),S.Obb(this.mNc),X.fa.Vk(this.yd),X.fa.au(this.fg),X.Ul(this.de),X.Sj(this.jd),X.fa.CD(this.uE),X.userOperationManager.Kp(this.o0b),A.EwaSettings.Ra(158)&&X.fa.Kh.get(45)&&b.AFrameworkApplication.ea.ka("SupportsPolicies")||this.HRf(),this.cWf(K.c(X)))}HRf(){G.a.Ls(this.$.fa.lL)&&this.tr(this,new z.a(this.$.fa.lL,null,!1,-1,-1,-1,-1,"",-1,"",-1))}RCh(X){this.ub.addHandler("bBarAttachedOrDetached",X)}get qDd(){return this.p$c}get domElement(){return this.fX?this.fX.domElement:
null}dispose(){if(this.$){const X=this.$,S=X.ma;S.sV(this.tr);S.xG(this.Zi);S.RTc(this.mNc);S.m3b(this.mNc);X.fa.Qk(this.yd);X.fa.Bv(this.fg);X.tm(this.de);X.ro(this.jd);X.fa.xB(this.uE);X.userOperationManager.kn(this.o0b);N.f(X).Rb.zp(this.Eng)}f.a.vb(this.fX);this.$=this.fX=null;super.dispose()}Zmj(X){switch(X){case 4:case 5:case 11:case 55:case 59:case 7:case 37:case 38:case 71:return!0;default:return!1}}uBh(X){switch(X.id){case 16:break;default:return}this.lh(75,null,null,null,{entryToAdd:X})}lh(X,
S,ea,Oa,Ha){ea=void 0===ea?null:ea;Oa=void 0===Oa?null:Oa;Ha=void 0===Ha?null:Ha;if(!this.$.isMobileMode||this.Zmj(X))this.qcb&&!this.GH(X)&&(this.wbb[X]=this.vj.Qna,this.fX.pz(X,S,Oa,Ha),this.ub.raiseEvent("bBarAttachedOrDetached",new u(X,!0,ea))),S&&32===S.Appearance&&I.a(this.$).Kd.jla(S)}DWg(X,S,ea,Oa){c.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");w.a.initialize(X,S,ea,Oa);this.lh(39,null)}kUk(X,S,ea,Oa){m.a.initialize(X,S,ea,Oa);this.lh(40,null)}VWk(X,S,ea,Oa){t.a.initialize(X,
S,ea,Oa);this.lh(41,null)}OUk(X,S,ea,Oa,Ha){Y.a.initialize(X,S,ea,Oa,Ha);this.lh(70,null)}ZVk(X,S,ea,Oa){l.a.initialize(X,S,ea,Oa);this.lh(42,null)}eXk(X,S,ea,Oa){e.a.initialize(X,S,ea,Oa);this.lh(54,null)}removeEntry(X){this.qcb&&(A.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170251,0,50,`Removing entry from BB: ${Enum.toString(h,X)}`),this.wbb[X]=null,this.fX.removeEntry(X)&&this.ub.raiseEvent("bBarAttachedOrDetached",new u(X,!1)))}w2(X){return this.qcb?
this.fX.w2(X):!1}GH(X){return this.qcb?this.fX.GH(X):!1}Hob(){c.ULS.sendTraceTag(537170248,0,50,"Network disconnect notification received from the app")}oZb(){c.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");this.removeEntry(21)}yLh(){const {BusinessBarControl:X}=a(1422);if(this.qcb&&!this.fX){N.f(this.$).Rb.Jp(this.Eng);var S=document.getElementById(this.$.Oc+n.a.lSh);this.fX=new X(this.$,S)}}Hhe(){this.qcb&&
this.fX.Hhe()}wwk(){if(A.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){const S=this.vj.Qna;if(3E5<=S-this.B7f){this.B7f=S;for(let ea=0;79>ea;ea++){var X=this.wbb[ea];if(X&&(X=S-X,3E5<=X)){const Oa=Enum.toString(h,ea);c.ULS.sendTraceTag(537170241,0,50,`${"OnWebMethodSuccess"}: entry [${Oa}] was activated but not turned off for ${X} Millis`)}}}}}LAi(X){const S=[];for(const ea of X)switch(ea.MessageId){case -113742550:const Oa=[757111532,2113407564,1393475740,1911608588,
104919273,-689453604,157762400,-949523941];(this.$.fa.isNamedObjectViewMode||G.a.hi(X,Oa))&&S.push(-113742550)}return G.a.rO(X,S)}f$i(X,S){switch(X.MessageId){case 2113407564:const ea=G.a.tdb([1821390342,-943219229,-502303485,1437034227]);for(let Oa=0;Oa<ea.length;Oa++)ea[Oa].HelpTopicId=X.HelpTopicId,ea[Oa].HelpDescription=X.HelpDescription,this.p$c.push(ea[Oa])}switch(X.MessageId){case -395951567:this.lh(6,X);break;case 1643490758:this.lh(4,X);break;case -907264831:this.lh(5,X);break;case 757111532:case 2113407564:this.lh(7,
X);break;case 2010656511:this.lh(15,X);break;case 1321660996:this.$.Umf=!0;this.lh(8,X);break;case 526339737:this.$.Umf=!0;this.lh(9,X);break;case -407088521:this.lh(10,X);break;case 1756116017:this.lh(14,X);break;case -1703455218:this.lh(17,X);break;case 1393475740:this.lh(25,X);break;case -949523941:this.lh(26,X);break;case 1779381952:S.push(44);break;case 478104620:S.push(76);break;case 615671810:S.push(77);break;case 1393011299:S.push(78);break;case 1421575100:this.lh(45,X);break;case 613676060:this.lh(46,
X);break;case 1233668252:this.lh(61,X);break;case 1911608588:X=!!(this.$.$d&64);!this.$.fa.Hg()&&X&&S.push(29);break;case 1544494907:break;case -655555355:S.push(this.h_d()?1:0);break;case -1221382671:S.push(2);break;case 1662282929:S.push(3);break;case 104919273:this.$.fa.Hg()||S.push(30);break;case -689453604:X=!!(this.$.$d&64);this.$.fa.WSf=!0;!this.$.fa.Hg()&&X&&S.push(31);break;case 157762400:this.$.fa.PGc=!0;!this.$.fa.Hg()&&this.$.$d&64&&!this.$.isEditMode&&S.push(32);break;case -1125398042:!this.$.fa.Hg()&&
this.$.$d&64&&!this.$.isEditMode&&S.push(34);break;case -73730134:!this.$.fa.Hg()&&this.$.$d&64&&S.push(33);break;case -293349236:S.push(65);break;case 1580811823:S.push(67);break;case -37299333:break;case 136737622:S.push(47);break;case -1780327030:this.lh(55,X);break;case -113742550:this.lh(57,X);break;case -260312420:this.$.fa.Hg()||S.push(66);break;case 784737213:this.$.fa.Hg()||S.push(70);break;case -156954846:this.lh(74,X);break;default:this.lh(11,X)}return S}Egj(){if(b.AFrameworkApplication.ea.ka("WildFireExcelBizBar")&&
!L.a.Vsj(L.a.aGf(1))&&(k.a.zq||k.a.mi))if(A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",!1))void J.a.resolve(B.CommonUIStringsService,{xa:1}).then(()=>this.lh(20,null));else{const X=Object(U.d)(J.a.resolve(B.CommonUIStringsService,{xa:1}));E.TaskExtensions.tb(X,()=>{this.lh(20,null)},this.Aa,3)}}Rfj(X){X||3!==this.$.workbookContext.WorkbookNovType||this.lh(63,null)}get fbl(){return b.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UnsupportedBrowserVersionSoftBlockIsEnabled",
!1)}Bgj(){this.fbl&&k.a.myj&&this.lh(24,null)}cWf(X){(!X&&!this.$.printingEnabled||this.$.Fe.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&(c.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),this.lh(16,null));this.Egj();this.Udf();this.RWg();this.Rfj(X);this.Bgj()}Udf(){this.$.workbookContext.Options&32768&&this.fVk()}fVk(){this.wbb[37]||this.lh(37,null)}PXk(){this.wbb[38]||this.lh(38,null)}RWg(){this.$.workbookContext.Options&
524288&&this.lh(59,null)}vte(X,S){this.lh(58,X,null,S)}Ukc(X,S){var ea=null,Oa=null;ea=void 0===ea?null:ea;Oa=void 0===Oa?null:Oa;S=void 0===S?null:S;this.fX.GH(X)?this.fX.Gwb(X,S):this.lh(X,null,ea,Oa,S)}EWg(){this.$.$d&8&&this.lh(12,null)}h_d(){const X=B.AccessTokenManagerService.Oa()?J.a.Cb(B.AccessTokenManagerService):this.$.ra.Tb(38);return X?X.yxe:!1}iCh(X,S){const ea=A.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.ServerCommunicationBBTimeoutInMs",0);this.GH(21)||-1387426400===X.MessageId||
this.bbb||(this.bbb=window.setTimeout(()=>{this.o5k(X,S)},ea))}o5k(X,S){c.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");const ea={};ea.FailedMethod=S;this.lh(21,X,ea);this.bbb=null}static DBc(){return O.e6e||(O.e6e=[0,1,2,3,44,76,77,78])}aKd(X){return this.fX.aKd(X)}};C.e6e=null;C=O=Object(y.__decorate)([Object(J.d)(B.BusinessBarManagerService),Object(y.__param)(0,Object(B.EwaControlService)())],C);Object(r.a)(C,"BusinessBarManager",d.a,
[570,4,140])},1451:function(y,r,a){a.r(r);a.d(r,"NetworkConnectionHealthChecker",function(){return e});y=a(0);var c=a(2),b=a(15),f=a(494),k=a(36),x=a(12),d=a(307);class h{constructor(){this.scenario=null;this.timeElapsed=0;this.isNewSession=!1;this.rawData=null}}Object(y.a)(h,"ConnectionErrorLogInfo",null,[]);var n=a(1246),m=a(1247);class u{constructor(w){this.pSd=[n.a.xch,n.a.V4c];this.An=(z,E)=>{this.xV[E]=z;this.Taj()&&this.mxk("OnNetworkDownImmediatePing"===z.caller)};this.hwa=w;this.$=w.$;this.xV=
{}}ZAj(){const w=m.a.kJd(this.An,"OnNetworkDownImmediatePing",this.$,this.pSd);for(const z of w)z.runTest()}Taj(){for(const w of this.pSd)if(void 0===this.xV[w]||null===this.xV[w])return!1;return!0}mxk(w){const z=this.$.Cg.vda;w&&this.$0k(z);for(var E of this.pSd)this.xV[E]=Sys.Serialization.JavaScriptSerializer.serialize(this.xV[E]);w=Date.now();E=this.hwa.WOd(e.nZb).returnValue;const M=this.hwa.WOd(e.M5b).returnValue;this.xV.isOfflineMode=z;this.xV.networkDownBBAge=-1===E?E:w-E;this.xV.transientServerCommunicationFailuresBBAge=
-1===M?M:w-M;this.hwa.businessBar?(this.xV.isNetworkDownBBShown=this.hwa.businessBar.GH(56).toString(),this.xV.isServerErrorBBShown=this.hwa.businessBar.GH(21).toString()):(this.xV.isNetworkDownBBShown="unknown",this.xV.isServerErrorBBShown="unknown");b.ULS.sendTraceTag(537155224,0,50,`ConnectionHealthTestsRunner.ReportPingResults: ${Sys.Serialization.JavaScriptSerializer.serialize(this.xV)}`)}$0k(w){const {NetworkConnectionHealthChecker:z}=a(1451),E={};for(const M of Object.keys(this.xV)){const G=
this.xV[M];E[G.testName]=G.isSuccess}E.isOfflineMode=w;this.hwa.rve(z.sxd,Sys.Serialization.JavaScriptSerializer.serialize(E))}}Object(y.a)(u,"ConnectionHealthTestsRunner",null,[]);var l=a(65),t=a(5);class e{constructor(w){this.businessBar=this.$mb=null;this.JTj=(z,E)=>{E.hCd?this.LTj(E):this.KTj(E)};this.Zi=(z,E)=>{z=E.context.methodName;this.$mb&&z===this.$mb&&(b.ULS.sendTraceTag(537155230,0,50,`NetworkConnectionHealthChecker.OnWebMethodSuccess: Failed web method "${this.$mb}" has now succeeded. Querying local storage for BB showings.`),
this.Inb(e.M5b,!0),this.$mb=null);this.Jag(!1);this.Oqc=!1};this.tr=(z,E)=>{k.a.hi(E.errors,[-1387426400])&&!this.Oqc&&(this.Oqc=!0,this.SUg()&&window.performance.mark(e.Nig),(new u(this)).ZAj())};this.Iag=()=>{this.Jag(!0);this.Inb(e.nZb,!1);this.Inb(e.M5b,!1)};this.hKa=()=>{this.Inb(e.nZb,!0)};this.$=w;this.ma=this.$.ma;this.localStorage=new d.a;this.Oqc=!1;this.$.fa.Nr(this.Iag);this.ma.Cg.HFb(this.hKa);this.ma.ED(this.Zi);void l.a.Bd(t.BusinessBarManagerService).then(async z=>{this.businessBar=
z;z.RCh(this.JTj)});this.ma.yP(this.tr)}dispose(){this.$&&(this.$.fa&&this.$.fa.Av(this.Iag),this.ma&&(this.ma.Cg.z3b(this.hKa),this.ma.sV(this.tr),this.ma.xG(this.Zi)))}LTj(w){const z={};z.Timestamp=Date.now().toString();switch(w.yDa){case 21:this.$mb=w.data.FailedMethod;z.FailedMethod=this.$mb;this.rve(e.M5b,JSON.stringify(z));break;case 56:this.rve(e.nZb,JSON.stringify(z))}}KTj(w){switch(w.yDa){case 21:this.Inb(e.M5b,!0);break;case 56:this.Inb(e.nZb,!0)}}rve(w,z){try{this.localStorage.Tf()&&this.localStorage.setItem(w,
z)}catch(E){b.ULS.sendTraceTag(537155231,0,15,`NetworkConnectionHealthChecker.StoreDataInLocalStorage: Failed to set item to local storage. reason: ${E.message||"Unknown"}`)}}WOd(w){if(this.localStorage.Tf()&&(w=this.localStorage.pXa(w))&&"null"!==w){var z=JSON.parse(w);w=parseInt(z.Timestamp,10);z=Sys.Serialization.JavaScriptSerializer.serialize(z);return{returnValue:w,rawData:z}}return{returnValue:-1,rawData:null}}Jag(w){if(this.localStorage.Tf()){const z=this.localStorage.pXa(e.sxd);if(z&&"null"!==
z){let E=-1;this.Oqc&&(E=this.yPi(e.Nig,e.pSj));b.ULS.sendTraceTag(537155229,0,50,`NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: Ping Results: ${Sys.Serialization.JavaScriptSerializer.serialize(z)}, Period offline: ${E}, New session: ${w}`);this.localStorage.removeItem(e.sxd)}}}yPi(w,z){if(!this.SUg())return-1;window.performance.measure(z,w);w=window.performance.getEntriesByName(z);return w.length&&w[w.length-1]?w[w.length-1].duration:(b.ULS.sendTraceTag(537155228,0,10,`NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: measure name ${z} returned no measures.`),
-1)}Inb(w,z){try{let E;const M=(()=>{let G=this.WOd(w);({rawData:E}=G);return G})().returnValue;if(-1!==M){const G=Object(c.a)(new h,{timeElapsed:Date.now()-M,scenario:w,isNewSession:!z,rawData:E});b.ULS.sendTraceTag(537155227,0,50,`NetworkConnectionHealthChecker.LogNetworkIssueBBShown: ${JSON.stringify(G)}`)}this.localStorage.removeItem(w)}catch(E){b.ULS.sendTraceTag(537155226,0,15,`NetworkConnectionHealthChecker.LogNetworkIssueBBShown: Failed to get item from local storage. reason: ${E.message||
"Unknown"}`)}}SUg(){return x.HelperMethods.Nsd&&f.a.gTa}}e.nZb="NetworkDownBBShown";e.M5b="ServerCommunicationFailureBBShown";e.sxd="ConnectionHealthPingRsults";e.Nig="offMoStMa";e.pSj="offMoDuMea";Object(y.a)(e,"NetworkConnectionHealthChecker",null,[4])},1466:function(y,r,a){a.d(r,"a",function(){return x});y=a(0);var c=a(15),b=a(284);class f{constructor(d,h){this.testName=null;this.startTimeMs=0;this.isSuccess=!1;this.caller=this.errorStatusCode=this.errorMessage=null;this.reqTotalDurationMs=0;this.browserResourceTiming=
null;this.testIteration=0;this.testName=d;this.caller=h;this.reset()}reset(){this.isSuccess=!1;this.startTimeMs=-1;this.errorStatusCode=this.errorMessage="";this.reqTotalDurationMs=-1;this.browserResourceTiming=null}}Object(y.a)(f,"NetworkTestResult",null,[]);var k=a(707);class x{constructor(d,h,n,m,u){this.url="";this.qkb=!1;this.RL=-1;this.testIteration=0;this.baseUrl=n;this.Kkg=m;this.iSd=h;this.result=new f(h,u)}runTest(){try{if(this.qkb)return c.ULS.sendTraceTag(537155206,0,50,`NetworkTestReq.RunTest: a test for the host ${this.iSd} is already mid way, not starting a new one.`),
!1;this.reset();this.qkb=!0;this.result.startTimeMs=Date.now();const d=new b.QueryStringBuilder(this.baseUrl);d.Oaa("tid",this.result.startTimeMs.toString());this.url=d.toString();this.BFk();this.testIteration++;this.result.testIteration=this.testIteration;return!0}catch(d){return this.NNb("Exeption: "+d.message),!1}}reset(){this.url="";this.result.reset();this.qkb=!1;this.RL=-1}clearTimeout(){-1!==this.RL&&(window.clearTimeout(this.RL),this.RL=-1)}BFk(){try{const d=new XMLHttpRequest;d.onreadystatechange=
()=>{4===d.readyState&&(200===d.status?this.TBi():this.NNb(`Error when downloading resource. status code: ${d.status}, status text: ${d.statusText}`,d.status.toString()))};d.onerror=()=>{this.NNb(`Client error when attempting to download resource. status code: ${d.status}, response: ${d.statusText}`)};this.RL=window.setTimeout(()=>{this.RL=-1;this.NNb("Request timeout")},1E4);d.open("GET",this.url,!0);d.send(null)}catch(d){this.NNb("Exeption: "+d.message)}}TBi(){this.qkb&&(this.result.reqTotalDurationMs=
Date.now()-this.result.startTimeMs,this.clearTimeout(),this.result.browserResourceTiming=k.a(this.url),this.result.isSuccess=!0,this.Bqc())}NNb(d,h){h=void 0===h?null:h;this.qkb&&(this.clearTimeout(),this.result.errorMessage=d,this.result.isSuccess=!1,this.result.errorStatusCode=h,this.Bqc())}Bqc(){this.qkb=!1;this.Kkg&&this.Kkg(this.result,this.iSd)}}Object(y.a)(x,"NetworkTestReq",null,[])},1485:function(y,r,a){r=a(490);a=a(1486);a=a.Di?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);r(a,{insert:"head",
Oj:!1});y.exports=a.Fk||{}},1486:function(y,r,a){r=a(489)(!1);r.push([y.i,'.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media (forced-colors:active){.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}',
""]);y.exports=r},1487:function(y,r,a){function c(aa,oa,Na,Ia,Sa,Pa){this.ID=aa;this.type=oa;this.jll=Na;this.vll=Ia;this.kll=Sa;this.wll=Pa}function b(aa,oa){this.value=aa;this.contextId=oa}function f(aa,oa,Na,Ia,Sa,Pa,za,wa){this.type=aa;this.Y0=oa;this.startTime=null==Na||void 0==Na.value?new b(Na,null):Na;this.endTime=null==Ia||void 0==Ia.value?new b(Ia,null):Ia;this.a$=null==Sa||void 0==Sa.value?new b(Sa,null):Sa;this.FVa=null==Pa||void 0==Pa.value?new b(Pa,null):Pa;this.pFg=za;this.operationType=
wa}function k(){}function x(aa,oa){this.ID=aa;this.s7f=oa}function d(){this.i_=[];this.kub=this.nub=null;this.H9=5E3;this.oub=0;this.Kqc=[];this.ofb=-1;this.Fwe=0}function h(){this.Index=0;this.Data=[];this.Pac=!1}function n(aa,oa,Na,Ia,Sa,Pa){this.abc(aa,oa,Na,Ia,Sa,Pa)}function m(aa,oa,Na,Ia,Sa,Pa){this.abc(aa,oa,Na,Ia,Sa,Pa)}function u(){this.Vwa=[];this.nE=[];this.tcb=[];this.Fnb=this.S2a=this.ESa=0;this.duration=this.startTime=null;this.U7d=0;this.ogb={};this.Ucb=-1;this.Yeb=0;this.hob=this.qob=
-1}function l(aa,oa,Na,Ia){G(Ia)&&(Ia="relative"==aa.style.position);var Sa=0;switch(oa){case 1:Sa=Na?parseInt(Ia?aa.style.marginRight.replace("px",""):aa.style.right.replace("px","")):parseInt(Ia?aa.style.marginLeft.replace("px",""):aa.style.left.replace("px",""));break;case 2:Sa=parseInt(Ia?aa.style.marginTop.replace("px",""):aa.style.top.replace("px",""));break;case 3:Sa=parseInt(aa.style.height.replace("px",""));break;case 4:Sa=parseInt(aa.style.width.replace("px",""));break;case 5:Sa=N(aa);break;
case 6:Sa=parseInt(aa.scrollTop);break;case 7:Sa=parseInt(aa.scrollLeft);break;case 8:Sa=I(aa)}return Sa}function t(aa){return aa*aa*aa}function e(aa){return 3*aa*aa*(1-aa)}function w(aa){return 3*aa*(1-aa)*(1-aa)}function z(aa){return(1-aa)*(1-aa)*(1-aa)}function E(aa,oa,Na,Ia,Sa){return 0*z(Sa)+oa*w(Sa)+Ia*e(Sa)+1*t(Sa)}function M(aa){return"object"==typeof aa&&aa instanceof Array}function G(aa){return null==aa||void 0==aa}function A(aa,oa){null!=document.body.style.opacity?aa.style.opacity=oa:
aa.style.filter=1==oa?"":"alpha(opacity="+String(100*oa)+")"}function N(aa){if(null!=document.body.style.opacity)return aa=aa.style.opacity,null!=aa&&""!=aa?parseFloat(aa):1;aa=aa.style.filter;return null!=aa&&""!=aa?parseInt(aa.replace("alpha(opacity=","").replace(")",""))/100:1}function K(aa,oa){oa="rotate("+oa+"deg)";null!=document.body.style.msTransform?aa.style.msTransform=oa:null!=document.body.style.webkitTransform?aa.style.webkitTransform=oa:null!=document.body.style.m6d?aa.style.m6d=oa:null!=
document.body.style.a8d?aa.style.a8d=oa:null!=document.body.style.transform&&(aa.style.transform=oa)}function I(aa){if(null!=document.body.style.msTransform)var oa=aa.style.msTransform;else null!=document.body.style.webkitTransform?oa=aa.style.webkitTransform:null!=document.body.style.m6d?oa=aa.style.m6d:null!=document.body.style.a8d?oa=aa.style.a8d:null!=document.body.style.transform&&(oa=aa.style.transform);if(!oa)return 0;oa=oa.replace("rotate(","");oa=oa.replace("deg)","");return parseFloat(oa)}
a.r(r);a.d(r,"WacAnimation",function(){return L});a.d(r,"WacCurve",function(){return c});a.d(r,"WacCurveType",function(){return J});a.d(r,"WacCurveID",function(){return B});a.d(r,"g_AnimationCurves",function(){return Y});a.d(r,"WacIntWrapper",function(){return b});a.d(r,"WacKeyFrame",function(){return f});a.d(r,"g_numAnimationAttributes",function(){return U});a.d(r,"AnimRelativeTo",function(){return O});a.d(r,"WacKeyframeType",function(){return C});a.d(r,"g_AnimationContextVariables",function(){return X});
a.d(r,"WacAnimation_ContextVariableManager",function(){return k});a.d(r,"WacAnim",function(){return x});a.d(r,"g_WacAnimations",function(){return S});a.d(r,"g_WacAnimationEngine",function(){return ea});a.d(r,"g_WacAnimationLogging",function(){return Oa});a.d(r,"g_WacAnimationThrottleFPS",function(){return Ha});a.d(r,"g_WacAnimationThrottleNumInstance",function(){return Za});a.d(r,"WacAnimationEngine",function(){return d});a.d(r,"g_WacRadix",function(){return fa});a.d(r,"WacAnimation_State",function(){return h});
a.d(r,"WacAnimation_Object",function(){return n});a.d(r,"WacAnimationUnit",function(){return m});a.d(r,"WacAnimationTelemetry",function(){return u});a.d(r,"g_WacAnimationTelemetry",function(){return la});a.d(r,"g_LastAnimationData",function(){return ba});a.d(r,"GetCurrentAttributeCssValue",function(){return l});a.d(r,"Bezier1",function(){return t});a.d(r,"Bezier2",function(){return e});a.d(r,"Bezier3",function(){return w});a.d(r,"Bezier4",function(){return z});a.d(r,"CalculateBezier",function(){return E});
a.d(r,"IsArrayCheck",function(){return M});a.d(r,"IsNullOrUndef",function(){return G});a.d(r,"SetCssOpacity",function(){return A});a.d(r,"GetCssOpacity",function(){return N});a.d(r,"SetCssRotation",function(){return K});a.d(r,"GetCssRotation",function(){return I});var L={},J={Instant:0,$ac:1,Linear:2,WG:3},B={Instant:0,$ac:1,Linear:2,Sm:3,ZEe:4,iFe:5,oEe:6,pEe:7,Xac:8,qEe:9,q8a:10,QDe:11,PDe:12,ODe:13,RDe:14,SDe:15,TDe:16,UDe:17,VDe:18,DEe:19,WEe:20,wEe:21},Y=Array(22);Y[B.Instant]=new c(B.Instant,
J.Instant,0,0,0,0);Y[B.$ac]=new c(B.$ac,J.$ac,0,0,0,0);Y[B.Linear]=new c(B.Linear,J.Linear,0,0,0,0);Y[B.Sm]=new c(B.Sm,J.WG,0,0,0,1);Y[B.ZEe]=new c(B.ZEe,J.WG,1,0,1,1);Y[B.iFe]=new c(B.iFe,J.WG,0,0,.42,1);Y[B.oEe]=new c(B.oEe,J.WG,.83,0,1,1);Y[B.pEe]=new c(B.pEe,J.WG,0,0,.58,1);Y[B.Xac]=new c(B.Xac,J.WG,.42,0,.58,1);Y[B.qEe]=new c(B.qEe,J.WG,.1,.25,.75,.9);Y[B.q8a]=new c(B.q8a,J.WG,.1,.9,.2,1);Y[B.QDe]=new c(B.QDe,J.WG,.1,.9,.2,1);Y[B.PDe]=new c(B.PDe,J.WG,.9,.1,.2,1);Y[B.ODe]=new c(B.ODe,J.WG,.4,
0,0,1);Y[B.RDe]=new c(B.RDe,J.WG,.13,.21,.1,.7);Y[B.SDe]=new c(B.SDe,J.WG,.02,.33,.38,.77);Y[B.TDe]=new c(B.TDe,J.WG,.57,.17,.95,.75);Y[B.UDe]=new c(B.UDe,J.WG,0,.19,.07,.72);Y[B.VDe]=new c(B.VDe,J.WG,0,0,.95,.37);Y[B.DEe]=new c(B.DEe,J.WG,.66,0,.34,1);Y[B.WEe]=new c(B.WEe,J.WG,.8,0,.2,1);Y[B.wEe]=new c(B.wEe,J.WG,.8,0,.2,1);f.prototype={type:0,Y0:0,startTime:new b(0,null),endTime:new b(0,null),a$:new b(0,null),FVa:new b(0,null),pFg:0,operationType:0};var U=8;L.ze={c5:1,iJ:2,Height:3,Width:4,Opacity:5,
P5c:6,O5c:7,bpl:8};var O={Initial:0,rg:1,Absolute:2},C={tn:0,Add:1};L.Ixb={Oac:0};var X=Array(1);X[L.Ixb.Oac]=new b(0,L.Ixb.Oac);L.wml=k;k.prototype={};k.prototype.SetContextVariable=function(aa,oa){X[L.Ixb[aa]].value=oa};L.ID={cDe:0,kDe:1,mDe:2,oDe:3,nDe:4,lDe:5,hDe:6,jDe:7,fDe:8,iDe:9,gDe:10,dDe:11,rDe:12,aDe:13,qDe:14,bDe:15,pDe:16,vDe:17,xDe:18,uDe:19,wDe:20,tDe:21,PEe:22,REe:23,NEe:24,QEe:25,OEe:26,TEe:27,cFe:28,oFe:29,qFe:30,pFe:31,rFe:32,bFe:33,eDe:34,sDe:35,KEe:36,ZDe:37,YDe:38,OFe:39,PFe:40,
NFe:41};var S=Array(42);S[L.ID.cDe]=new x(L.ID.cDe,[new f(L.ze.Opacity,B.Instant,0,0,null,1,O.rg,C.tn)]);S[L.ID.kDe]=new x(L.ID.kDe,[new f(L.ze.Opacity,B.Linear,0,0,null,0,O.Absolute,C.tn),new f(L.ze.Opacity,B.Linear,0,50,null,1,O.rg,C.tn)]);S[L.ID.mDe]=new x(L.ID.mDe,[new f(L.ze.c5,B.Sm,0,167,null,0,O.rg,C.Add),new f(L.ze.iJ,B.Sm,0,167,null,0,O.rg,C.Add)]);S[L.ID.oDe]=new x(L.ID.oDe,[new f(L.ze.Height,B.Sm,0,167,null,0,O.rg,C.Add),new f(L.ze.Width,B.Sm,0,167,null,0,O.rg,C.Add)]);S[L.ID.nDe]=new x(L.ID.nDe,
[new f(L.ze.Opacity,B.Linear,0,0,null,0,O.Absolute,C.tn),new f(L.ze.Opacity,B.Linear,0,167,null,1,O.rg,C.tn)]);S[L.ID.lDe]=new x(L.ID.lDe,[new f(L.ze.Opacity,B.Linear,0,167,null,0,O.rg,C.tn)]);S[L.ID.hDe]=new x(L.ID.hDe,[new f(L.ze.c5,B.Sm,0,100,null,0,O.rg,C.Add),new f(L.ze.iJ,B.Sm,0,100,null,0,O.rg,C.Add)]);S[L.ID.jDe]=new x(L.ID.jDe,[new f(L.ze.Height,B.Sm,0,100,null,0,O.rg,C.Add),new f(L.ze.Width,B.Sm,0,100,null,0,O.rg,C.Add)]);S[L.ID.fDe]=new x(L.ID.fDe,[new f(L.ze.Opacity,B.Linear,0,100,null,
1,O.rg,C.tn)]);S[L.ID.iDe]=new x(L.ID.iDe,[new f(L.ze.Opacity,B.Linear,0,0,null,0,O.Absolute,C.tn),new f(L.ze.Opacity,B.Linear,0,100,null,1,O.rg,C.tn)]);S[L.ID.gDe]=new x(L.ID.gDe,[new f(L.ze.Opacity,B.Linear,0,100,null,0,O.rg,C.tn)]);S[L.ID.dDe]=new x(L.ID.dDe,[new f(L.ze.c5,B.Sm,0,267,null,0,O.rg,C.Add),new f(L.ze.iJ,B.Sm,0,267,null,0,O.rg,C.Add)]);S[L.ID.rDe]=new x(L.ID.rDe,[new f(L.ze.Height,B.Sm,0,267,null,0,O.rg,C.Add),new f(L.ze.Width,B.Sm,0,267,null,0,O.rg,C.Add)]);S[L.ID.aDe]=new x(L.ID.aDe,
[new f(L.ze.Opacity,B.Linear,0,267,null,1,O.rg,C.tn)]);S[L.ID.qDe]=new x(L.ID.qDe,[new f(L.ze.Opacity,B.Linear,0,0,null,0,O.Absolute,C.tn),new f(L.ze.Opacity,B.Linear,0,267,null,1,O.rg,C.tn)]);S[L.ID.bDe]=new x(L.ID.bDe,[new f(L.ze.Opacity,B.Linear,0,267,null,0,O.rg,C.tn)]);S[L.ID.pDe]=new x(L.ID.pDe,[new f(L.ze.P5c,B.Sm,0,267,null,0,O.rg,C.Add),new f(L.ze.O5c,B.Sm,0,267,null,0,O.rg,C.Add)]);S[L.ID.vDe]=new x(L.ID.vDe,[new f(L.ze.c5,B.Sm,0,750,null,0,O.rg,C.Add),new f(L.ze.iJ,B.Sm,0,750,null,0,O.rg,
C.Add)]);S[L.ID.xDe]=new x(L.ID.xDe,[new f(L.ze.Height,B.Sm,0,750,null,0,O.rg,C.Add),new f(L.ze.Width,B.Sm,0,750,null,0,O.rg,C.Add)]);S[L.ID.uDe]=new x(L.ID.uDe,[new f(L.ze.Opacity,B.Linear,0,750,null,1,O.rg,C.tn)]);S[L.ID.wDe]=new x(L.ID.wDe,[new f(L.ze.Opacity,B.Linear,0,0,null,0,O.Absolute,C.tn),new f(L.ze.Opacity,B.Linear,0,750,null,1,O.rg,C.tn)]);S[L.ID.tDe]=new x(L.ID.tDe,[new f(L.ze.P5c,B.Sm,0,1E3,null,0,O.rg,C.Add),new f(L.ze.O5c,B.Sm,0,1E3,null,0,O.rg,C.Add)]);S[L.ID.PEe]=new x(L.ID.PEe,
[new f(L.ze.c5,B.Sm,0,367,null,0,O.rg,C.Add),new f(L.ze.iJ,B.Sm,0,367,null,0,O.rg,C.Add)]);S[L.ID.REe]=new x(L.ID.REe,[new f(L.ze.Height,B.Sm,0,367,null,0,O.rg,C.Add),new f(L.ze.Width,B.Sm,0,367,null,0,O.rg,C.Add)]);S[L.ID.NEe]=new x(L.ID.NEe,[new f(L.ze.Opacity,B.Linear,0,367,null,1,O.rg,C.tn)]);S[L.ID.QEe]=new x(L.ID.QEe,[new f(L.ze.Opacity,B.Linear,0,0,null,0,O.Absolute,C.tn),new f(L.ze.Opacity,B.Linear,0,367,null,1,O.rg,C.tn)]);S[L.ID.OEe]=new x(L.ID.OEe,[new f(L.ze.Opacity,B.Linear,0,367,null,
0,O.rg,C.tn)]);S[L.ID.TEe]=new x(L.ID.TEe,[new f(L.ze.P5c,B.Linear,0,X[L.Ixb.Oac],null,0,O.rg,C.Add),new f(L.ze.O5c,B.Linear,0,X[L.Ixb.Oac],null,0,O.rg,C.Add)]);S[L.ID.cFe]=new x(L.ID.cFe,[new f(L.ze.Opacity,B.Linear,0,0,null,1,O.rg,C.tn),new f(L.ze.Opacity,B.Linear,0,50,null,0,O.rg,C.tn)]);S[L.ID.oFe]=new x(L.ID.oFe,[new f(L.ze.c5,B.Sm,0,433,null,0,O.rg,C.Add),new f(L.ze.iJ,B.Sm,0,433,null,0,O.rg,C.Add)]);S[L.ID.qFe]=new x(L.ID.qFe,[new f(L.ze.Opacity,B.Linear,0,0,null,0,O.Absolute,C.tn),new f(L.ze.Opacity,
B.Linear,0,50,null,1,O.rg,C.tn),new f(L.ze.iJ,B.Sm,0,0,null,40,O.rg,C.Add),new f(L.ze.iJ,B.Sm,0,100,null,0,O.rg,C.Add)]);S[L.ID.pFe]=new x(L.ID.pFe,[new f(L.ze.iJ,B.Instant,0,0,null,32,O.rg,C.Add),new f(L.ze.iJ,B.Instant,0,100,null,32,O.rg,C.Add),new f(L.ze.iJ,B.Sm,101,350,null,0,O.rg,C.Add),new f(L.ze.Height,B.Instant,0,0,null,0,O.Absolute,C.Add),new f(L.ze.Height,B.Instant,0,100,null,0,O.Absolute,C.Add),new f(L.ze.Height,B.Sm,101,350,null,0,O.rg,C.Add),new f(L.ze.Opacity,B.Instant,0,0,null,0,O.Absolute,
C.tn),new f(L.ze.Opacity,B.Instant,0,100,null,1,O.rg,C.tn)]);S[L.ID.rFe]=new x(L.ID.rFe,[new f(L.ze.iJ,B.Sm,0,267,null,32,O.rg,C.Add),new f(L.ze.Height,B.Sm,0,267,null,0,O.Absolute,C.Add),new f(L.ze.Opacity,B.Linear,0,0,null,1,O.Initial,C.tn),new f(L.ze.Opacity,B.Linear,0,267,null,0,O.Absolute,C.tn)]);S[L.ID.bFe]=new x(L.ID.bFe,[new f(L.ze.Opacity,B.Linear,0,0,null,0,O.Absolute,C.tn),new f(L.ze.Opacity,B.Linear,0,100,null,0,O.Absolute,C.tn),new f(L.ze.Opacity,B.Linear,101,267,null,1,O.rg,C.tn)]);
S[L.ID.eDe]=new x(L.ID.eDe,[new f(L.ze.c5,B.q8a,0,300,null,0,O.rg,C.Add),new f(L.ze.iJ,B.q8a,0,300,null,0,O.rg,C.Add)]);S[L.ID.sDe]=new x(L.ID.sDe,[new f(L.ze.Height,B.q8a,0,300,null,0,O.rg,C.Add),new f(L.ze.Width,B.q8a,0,300,null,0,O.rg,C.Add)]);S[L.ID.KEe]=new x(L.ID.KEe,[new f(L.ze.c5,B.Xac,0,750,null,0,O.rg,C.Add),new f(L.ze.iJ,B.Xac,0,750,null,0,O.rg,C.Add)]);S[L.ID.ZDe]=new x(L.ID.ZDe,[new f(L.ze.Opacity,B.Linear,0,0,null,0,O.Absolute,C.tn),new f(L.ze.Opacity,B.Linear,0,200,null,0,O.Absolute,
C.tn),new f(L.ze.Opacity,B.Sm,201,500,null,1,O.rg,C.tn)]);S[L.ID.YDe]=new x(L.ID.YDe,[new f(L.ze.c5,B.Linear,0,0,null,0,O.Absolute,C.Add),new f(L.ze.iJ,B.Linear,0,0,null,0,O.Absolute,C.Add),new f(L.ze.c5,B.Linear,0,200,null,0,O.Absolute,C.Add),new f(L.ze.iJ,B.Linear,0,200,null,0,O.Absolute,C.Add),new f(L.ze.c5,B.Sm,201,267,null,0,O.rg,C.Add),new f(L.ze.iJ,B.Sm,201,267,null,0,O.rg,C.Add)]);S[L.ID.OFe]=new x(L.ID.OFe,[new f(L.ze.c5,B.Sm,0,267,null,0,O.rg,C.Add),new f(L.ze.iJ,B.Sm,0,267,null,0,O.rg,
C.Add)]);S[L.ID.PFe]=new x(L.ID.PFe,[new f(L.ze.Opacity,B.Linear,0,0,null,0,O.Absolute,C.tn),new f(L.ze.Opacity,B.Linear,0,267,null,1,O.rg,C.tn)]);S[L.ID.NFe]=new x(L.ID.NFe,[new f(L.ze.Opacity,B.Linear,0,267,null,0,O.rg,C.tn)]);var ea=null,Oa=-1!=window.location.search.indexOf("AnimationLogging=1"),Ha=0,Za=3;window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||
function(aa){window.setTimeout(aa,16)}}();L.State=h;L.Object=n;d.prototype={i_:[],nub:null,kub:null,H9:5E3,oub:0,Kqc:[],ofb:-1,Fwe:0};d.prototype.HEe=function(){ea.kFe()};d.prototype.Neh=function(){ea.kFe();ea.mFe()};d.prototype.jgh=function(){null==this.nub&&null==this.kub&&0==this.oub&&(this.nub=window.requestAnimationFrame(d.prototype.HEe),ea.jFe(),this.oub=0,la.Start())};d.prototype.mFe=function(){la.lgh();ea.lFe();null!=this.nub&&(this.nub=null);this.oub=0;this.Kqc=[];this.i_=[]};d.prototype.R5c=
function(aa){this.i_[this.oub++]=aa};d.prototype.S5c=function(aa){for(var oa=0;oa<this.i_.length;oa++)this.i_[oa]==aa&&(this.Jfh(aa),this.i_[oa]=null)};d.prototype.kFe=function(){var aa=!1,oa=null;ea.lFe();for(var Na=0;Na<this.i_.length;Na++)null!=this.i_[Na]&&(G(oa)&&(oa=this.i_[Na].currentTime),this.ofb=Na,this.i_[Na].kgh(),aa=!0);this.ofb=-1;aa&&!G(oa)&&la.hch(new Date-oa);aa?(ea.jFe(),window.requestAnimationFrame(d.prototype.HEe)):this.mFe()};d.prototype.JDe=function(aa,oa){if(null==aa.id||""==
aa.id){var Na="tempAnimID_"+String(this.Fwe);this.Fwe++;aa.id=Na}aa=aa.id+"_"+String(oa);Na=this.Kqc[aa];if(G(Na)||Na==this.ofb||null==this.i_[Na])this.Kqc[aa]=this.ofb;else if(aa=this.i_[Na],aa.Y0.SetAttribute(oa,null),null!=aa.o7){oa=this.i_[this.ofb];var Ia=aa.o7,Sa=aa.extraData,Pa=oa.o7,za=oa.extraData;oa.o7=null==Pa?function(){Ia(Sa)}:function(){Ia(Sa);Pa(za)};oa.extraData=null;aa.o7=null}};d.prototype.Jfh=function(aa){if(M(aa.element))for(var oa=aa.element.length,Na=0;Na<oa;Na++){var Ia=aa.element[Na];
0==Ia.id.indexOf("tempAnimID_")&&null==Ia.id}else Ia=aa.element,0==Ia.id.indexOf("tempAnimID_")&&null==Ia.id};d.prototype.lFe=function(){null!=this.kub&&(window.clearTimeout(this.kub),this.kub=null)};d.prototype.jFe=function(){this.kub=window.setTimeout(d.prototype.Neh,this.H9)};var fa=10;h.prototype={Index:0,Data:[],Pac:!1};h.prototype.SetAttribute=function(aa,oa){var Na=this.zEe(aa);-1==Na?(Na=this.Data.length,this.Index+=aa*Math.pow(fa,Na),this.Data[Na]=oa):this.Data[Na]=oa};h.prototype.lOa=function(aa){aa=
this.zEe(aa);return-1==aa?null:this.Data[aa]};h.prototype.zEe=function(aa){for(var oa=0,Na=this.Index;0!=Na;){if(Na%fa==aa)return oa;Na=Math.floor(Na/fa);oa++}return-1};h.prototype.SetAnimateRight=function(aa){this.Pac=aa};n.prototype={Xpd:-1,delay:0,element:null,GNb:null,o7:null,extraData:null,Gcb:null,vVf:0,obf:null};n.prototype.abc=function(aa,oa,Na,Ia,Sa,Pa){if(G(Na))throw"Argument Error: element cannot be null.";if(M(Na)&&!M(Ia)||!M(Na)&&M(Ia))throw"Argument Error: element and finalState counts do not match";
this.Xpd=aa;this.delay=oa;this.element=Na;this.GNb=Ia;this.o7=Sa;this.extraData=Pa;this.Gcb=[];this.vVf=0;this.obf=X};n.prototype.$O=function(aa){return null==aa.contextId?aa.value:this.obf[aa.contextId].value};n.prototype.RunAnimation=function(){if(-1!=this.Xpd&&null!=this.element){this.keh();for(var aa=this.Gcb.length,oa=0;oa<aa;oa++)this.Gcb[oa].R5c()}};n.prototype.keh=function(){for(var aa=S[this.Xpd],oa=null,Na=aa.s7f.length,Ia,Sa=0;Sa<Na;Sa++){var Pa=aa.s7f[Sa],za=this.deh(Pa),wa;if(null!=za)if(za.a$.SetAttribute(Pa.type,
this.$O(Pa.a$)),za.Y0.SetAttribute(Pa.type,Pa.Y0),M(this.element)){var db=this.element.length;for(wa=0;wa<db;wa++)if(Ia=this.Yac(Pa,wa),G(Ia)){za.Y0.SetAttribute(Pa.type,null);break}else za.C4[wa].SetAttribute(Pa.type,Ia)}else Ia=this.Yac(Pa,-1),G(Ia)?za.Y0.SetAttribute(Pa.type,null):za.C4.SetAttribute(Pa.type,Ia);else{za=new m(this.element,this.$O(Pa.startTime)+this.delay,this.$O(Pa.endTime)-this.$O(Pa.startTime),null,null,this.GNb.Pac);za.a$.SetAttribute(Pa.type,this.$O(Pa.a$));za.Y0.SetAttribute(Pa.type,
Pa.Y0);if(M(this.element))for(db=this.element.length,wa=0;wa<db;wa++)if(null==za.C4&&(za.C4=Array(this.element.length)),null==za.C4[wa]&&(za.C4[wa]=new h),Ia=this.Yac(Pa,wa),G(Ia)){za.Y0.SetAttribute(Pa.type,null);break}else za.C4[wa].SetAttribute(Pa.type,Ia);else null==za.C4&&(za.C4=new h),Ia=this.Yac(Pa,-1),G(Ia)?za.Y0.SetAttribute(Pa.type,null):za.C4.SetAttribute(Pa.type,Ia);if(null==oa||oa.delay+oa.duration<=za.delay+za.duration)oa=za;this.Gcb[this.vVf++]=za}}null!=oa&&(oa.o7=this.o7,oa.extraData=
this.extraData)};n.prototype.deh=function(aa){for(var oa=this.Gcb.length,Na=0;Na<oa;Na++){var Ia=this.Gcb[Na];if(Ia.delay==this.$O(aa.startTime)+this.delay&&Ia.duration==this.$O(aa.endTime)-this.$O(aa.startTime))return Ia}return null};n.prototype.Yac=function(aa,oa){var Na=null;if(!G(this.$O(aa.FVa)))switch(aa.pFg){case 0:Na=M(this.element)?this.element[oa]:this.element;Na=null==this.$O(aa.a$)?l(Na,aa.type,this.GNb.Pac):this.$O(aa.a$);Na=0==aa.operationType?this.$O(aa.FVa)*Na:this.$O(aa.FVa)+Na;break;
case 1:oa=(M(this.element)?this.GNb[oa]:this.GNb).lOa(aa.type);G(oa)||(Na=0==aa.operationType?this.$O(aa.FVa)*oa:this.$O(aa.FVa)+oa);break;case 2:Na=this.$O(aa.FVa)}return Na};m.prototype={element:null,delay:0,duration:0,a$:null,R2a:null,C4:null,Y0:null,o7:null,extraData:null,startTime:null,fGd:!1,oGb:!1,Q3a:!1};m.prototype.abc=function(aa,oa,Na,Ia,Sa,Pa){this.element=aa;this.delay=oa;this.duration=Na;this.o7=Ia;this.extraData=Sa;this.a$=new h;this.C4=this.R2a=null;this.Y0=new h;this.startTime=null;
this.fGd=!1;this.oGb=Pa;this.Q3a=!1};m.prototype.R5c=function(){null==ea&&(ea=new d);null==ea.nub&&ea.jgh();"relative"==this.element.style.position&&(this.Q3a=!0);this.startTime=new Date;this.currentTime=new Date;ea.R5c(this)};m.prototype.S5c=function(){ea.S5c(this)};m.prototype.kgh=function(){this.currentTime=new Date;var aa=Number(this.currentTime)-Number(this.startTime);if(!(aa<this.delay)){aa-=this.delay;for(var oa=!0,Na=!this.fGd,Ia=U,Sa=1;Sa<=Ia;Sa++){var Pa=this.Y0.lOa(Sa);if(!G(Pa))if(Pa=
this.vfh(aa,this.duration,Pa),M(this.element))for(var za=this.element.length,wa=0;wa<za;wa++){var db=this.element[wa];var Ba=this.a$.lOa(Sa);var Ka=this.C4[wa];Ka=Ka.lOa(Sa);G(Ba)&&(null==this.R2a&&(this.R2a=Array(this.element.length)),G(this.R2a[wa])&&(this.R2a[wa]=new h),Ba=this.R2a[wa].lOa(Sa),G(Ba)&&(Ba=l(db,Sa,this.oGb,this.Q3a),this.R2a[wa].SetAttribute(Sa,Ba)));Ba+=Pa*(Ka-Ba);aa>=this.duration||1<Pa?Ba=Ka:oa=!1;Na&&ea.JDe(db,Sa);this.hFe(Sa,db,Ba)}else Ba=this.a$.lOa(Sa),Ka=this.C4,Ka=Ka.lOa(Sa),
G(Ba)&&(Ba=l(this.element,Sa,this.oGb,this.Q3a),this.a$.SetAttribute(Sa,Ba)),Ba+=Pa*(Ka-Ba),aa>=this.duration||1<Pa?Ba=Ka:oa=!1,Na&&ea.JDe(this.element,Sa),this.hFe(Sa,this.element,Ba)}this.fGd=!0;oa&&(this.S5c(),null!=this.o7&&(la.coa("calling fnishfunc"),this.o7(this.extraData)))}};m.prototype.vfh=function(aa,oa,Na){var Ia=0;Na=Y[Na];switch(Na.type){case 0:Ia=1;break;case 1:Ia=aa<oa?0:1;break;case 2:Ia=aa/oa;break;case 3:Ia=E(Na.jll,Na.vll,Na.kll,Na.wll,aa/oa)}return Ia};m.prototype.hFe=function(aa,
oa,Na){la.ogb[oa.id]=!0;switch(aa){case 1:this.ogh(oa,Na);break;case 2:this.tgh(oa,Na);break;case 3:this.ngh(oa,Na);break;case 4:this.ugh(oa,Na);break;case 5:this.pgh(oa,Na);break;case 6:this.sgh(oa,Na);break;case 7:this.rgh(oa,Na);break;case 8:this.qgh(oa,Na)}};m.prototype.ogh=function(aa,oa){this.oGb?this.Q3a?aa.style.marginRight=String(oa)+"px":aa.style.right=String(oa)+"px":this.Q3a?aa.style.marginLeft=String(oa)+"px":aa.style.left=String(oa)+"px";Oa&&la.coa("element: "+aa.id+", "+(this.oGb?"right":
"left")+": "+String(oa)+", timestamp: "+String(Number(new Date)))};m.prototype.tgh=function(aa,oa){this.Q3a?aa.style.marginTop=String(oa)+"px":aa.style.top=String(oa)+"px";Oa&&la.coa("element: "+aa.id+", top: "+String(aa.style.top)+", timestamp: "+String(Number(new Date)))};m.prototype.ngh=function(aa,oa){aa.style.height=String(oa)+"px";Oa&&la.coa("element: "+aa.id+", height: "+String(aa.style.height)+", timestamp: "+String(Number(new Date)))};m.prototype.ugh=function(aa,oa){aa.style.width=String(oa)+
"px";Oa&&la.coa("element: "+aa.id+", width: "+String(aa.style.width)+", timestamp: "+String(Number(new Date)))};m.prototype.pgh=function(aa,oa){A(aa,oa);Oa&&la.coa("element: "+aa.id+", opacity: "+String(oa)+", timestamp: "+String(Number(new Date)))};m.prototype.sgh=function(aa,oa){aa.scrollTop=oa;Oa&&la.coa("element: "+aa.id+", scrollTop: "+oa+", timestamp: "+String(Number(new Date)))};m.prototype.rgh=function(aa,oa){aa.scrollLeft=oa;Oa&&la.coa("element: "+aa.id+", scrollLeft: "+oa+", timestamp: "+
String(Number(new Date)))};m.prototype.qgh=function(aa,oa){K(aa,oa);Oa&&la.coa("element: "+aa.id+", rotateZ: "+oa+", timestamp: "+String(Number(new Date)))};u.prototype={Vwa:null,nE:null,M6e:5,tcb:null,ESa:0,S2a:0,Fnb:0,startTime:null,duration:null,U7d:0,ogb:null,Ucb:-1,Yeb:0,qob:-1,hob:-1};u.prototype.Start=function(){this.startTime=new Date;this.Fnb=this.S2a=0;this.ogb={}};u.prototype.lgh=function(){this.duration=Number(new Date)-Number(this.startTime);this.U7d=ea.oub;this.Xch();this.Fnb=this.S2a=
0};u.prototype.hch=function(aa){this.Vwa[this.S2a++]=aa};u.prototype.coa=function(aa){this.nE[this.Fnb++]=aa};u.prototype.Ych=function(){var aa=0,oa=Number.MAX_VALUE,Na=Number.MIN_VALUE,Ia=0,Sa=0,Pa="",za="",wa=new Date,db="",Ba=this.duration;G(Ba)&&(Ba=Number(wa)-Number(this.startTime));if(Oa&&0<this.Fnb)for(var Ka=this.Fnb,da=0;da<Ka;da++)0!=da&&(Pa+="<br/>"),Pa+=this.nE[da];if(0<this.S2a){aa=this.S2a;for(da=0;da<aa;da++)this.Vwa[da]<oa&&(oa=this.Vwa[da]),this.Vwa[da]>Na&&(Na=this.Vwa[da]),Ia+=
this.Vwa[da],0!=da&&(za+=", "),za+=this.Vwa[da];1<aa&&(Ia/=aa-1);Ia=Math.round(100*Ia)/100;for(da=0;da<aa;da++)Ka=this.Vwa[da]-Ia,Ka*=Ka,Sa+=Ka;1<aa&&(Sa/=aa-1);Sa=Math.sqrt(Sa);Sa=Math.round(100*Sa)/100;aa=this.S2a/Ba*1E3;aa=Math.round(aa)}for(var sa in this.ogb)db+=sa,db+=",";if(-1==this.qob||aa<this.qob)this.qob=aa;if(-1==this.hob||aa>this.hob)this.hob=aa;0==this.Yeb?(this.Yeb++,this.Ucb=aa):(da=this.Ucb*this.Yeb,this.Yeb++,this.Ucb=(da+aa)/this.Yeb);da=Array(12);da[0]=Ba;da[1]=aa;da[2]=oa;da[3]=
Na;da[4]=Ia;da[5]=Sa;da[6]=za;da[7]=Pa;da[8]=this.U7d;da[9]=Number(this.startTime);da[10]=Number(wa);da[11]=db;return da};u.prototype.Xch=function(){var aa=this.Ych();ba=aa;this.mgh(aa)};u.prototype.mgh=function(aa){this.tcb[this.ESa]=aa;this.ESa++;this.ESa%=this.M6e};u.prototype.GetRecentAnimationStats=function(){for(var aa=[],oa=0,Na=la.ESa;Na<la.M6e;Na++)null!=la.tcb[Na]&&(aa[oa]=la.tcb[Na],oa++);for(Na=0;Na<la.ESa;Na++)null!=la.tcb[Na]&&(aa[oa]=la.tcb[Na],oa++);return aa};u.prototype.GetAnimationSqmStats=
function(){var aa=[];aa[0]=0>la.Ucb?0:la.Ucb;aa[1]=0>la.qob?0:la.qob;aa[2]=0>la.hob?0:la.hob;return aa};var la=new u,ba=null;L.Telemetry=la},1491:function(y,r,a){r=a(490);a=a(1492);a=a.Di?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);r(a,{insert:"head",Oj:!1});y.exports=a.Fk||{}},1492:function(y,r,a){r=a(489)(!1);r.push([y.i,".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb.ewa-bb-react{background-color:#f5f5f5}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:700}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-button-holder,.ewa-bb-entry-link,.ewa-bb-entry-message,.ewa-bb-entry-title{vertical-align:middle}.ewa-nov2-ltr .ewa-bb-entry-close,.ewa-root-ltr .ewa-bb-entry-close{right:2px}.ewa-nov2-ltr .ewa-bb-content,.ewa-root-ltr .ewa-bb-content{margin-right:26px}.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-nov2-ltr .ewa-bb-entry-link,.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-root-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-nov2-rtl .ewa-bb-entry-close,.ewa-root-rtl .ewa-bb-entry-close{left:2px}.ewa-nov2-rtl .ewa-bb-content,.ewa-root-rtl .ewa-bb-content{margin-left:26px}.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-nov2-rtl .ewa-bb-entry-link,.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-root-rtl .ewa-bb-entry-link{margin-right:8px}",
""]);y.exports=r},1494:function(y,r,a){a.r(r);a.d(r,"AutoDetectActionButton",function(){return x});y=a(0);r=a(93);var c=a(1442),b=a(64),f=a(13),k=a(25);class x extends r.a{constructor(d,h,n,m,u){super();this.$=d;this.xH=m.pKb(d,h,n,"",b.a.Lh(11),u,"AutoDetectPointerDown",f.a.instance.ia(1808)+"...")}get Kz(){return this.xH.Kz}dispose(){this.xH.dispose();this.$=null;super.dispose()}domElement(d){return this.xH.domElement(d)}getButton(d){return this.xH.getButton(d,!1)}Uwb(d,h,n,m){this.xH.G7a(c.a.wNi(d),
h,m);this.xH.Y2c(n,h,m)}cna(d,h){const n=k.f(this.$),m=n.rb.Yh(d);d=n.Wg(d,m);const u=n.pg(m).ul;if(d&&0<=d.x&&0<=d.y&&u.width>d.width+160){let l=d.bottomRight.x+this.Kz,t=d.topLeft.y+this.Kz,e=!1;l+160>u.bottomRight.x&&(l=d.topLeft.x-this.Kz,e=!0);if(t<u.topLeft.y+this.Kz){if(n.rb.g7a){this.hide();return}t=u.topLeft.y+this.Kz}this.xH.xDd(h,m);this.Xo(l,t,n.rtl,m,e)}else this.hide()}Xo(d,h,n,m,u){this.xH.Xo(d,h,n,m,!1,u)}hide(){this.xH.hide()}}Object(y.a)(x,"AutoDetectActionButton",r.a,[])},938:function(y,
r,a){a.d(r,"a",function(){return J});y=a(0);var c=a(2),b=a(15),f=a(91),k=a(286),x=a(16),d=a(155),h=a(179),n=a(6),m=a(94);r=a(267);var u=a(1232),l=a(20),t=a(7),e=a(376),w=a(64),z=a(17),E=a(71),M=a(13),G=a(25),A=a(92),N=a(1115),K=a(1),I=a(114),L=a(29);class J extends r.a{constructor(B,Y){super(document.createElement("div"));this.q9f=this.x6e=this.V0e=this.gqc=this.Yka=this.gga=this.nW=this.MD=null;this.Uca=this.c2=this.es=this.hideCloseButton=!1;this.WUj=U=>{this.Oy(U)};this.bVj=U=>{13===U.keyCode&&
this.Oy(U)};this.u8d=U=>{this.Hl(U.Yb);return!0};this.A8d=U=>{this.d3(U.Yb);return!0};this.uOc=U=>{this.YU(U.Yb?U.Yb:0);return!0};this.XUj=U=>{this.Oy(U.Ha);return!0};this.Efh=U=>{U=void 0===U?null:U;this.Hl(U.inputMethod?U.inputMethod:0);return!0};this.Ffh=U=>{U=void 0===U?null:U;this.d3(U.inputMethod?U.inputMethod:0);return!0};this.G$=B;this.fv=Y;this.Lrd=Y.yDa.toString();this.title=Y.title;this.message=Y.message;this.set_visibilityMode(1)}get yDa(){return this.fv.yDa}get businessBar(){return this.G$}get actionButton(){return this.fv?
this.fv.actionButton:""}get CSa(){return this.fv?this.fv.CSa:""}get linkText(){return this.fv?this.fv.link:""}get kKc(){return this.fv?this.fv.kKc:""}get gs(){return this.fv?this.fv.gs:""}get alt(){return this.fv?this.fv.alt:""}iya(B){this.fv.businessBarType=B}dispose(){f.a.xd([this.gqc,this.nW,this.gga]);this.es&&this.nW&&(k.a.instance.Ua(x.a.click,this.nW.domElement,this.u8d),d.a.instance.$Z(this.domElement,this.V0e));this.c2&&this.gga&&(k.a.instance.Ua(x.a.click,this.gga.domElement,this.A8d),d.a.instance.$Z(this.domElement,
this.x6e));this.Uca&&this.Yka&&(k.a.instance.Ua(x.a.click,this.Yka,this.uOc),d.a.instance.$Z(this.domElement,this.q9f));this.Yka=this.MD=this.G$=this.gga=this.nW=null;super.dispose()}update(){}Mbl(){this.dlf(!0)}Jjf(){this.dlf(!1)}G$h(){const B=this.businessBar.$.Vb.Pg("DOMUpdate","ReactBusinessBar");B.start();this.message=A.a.Dg(this.message);this.title=A.a.Dg(this.title);h.a.JMd().then(Y=>{Y.initializeMessageBarInStore();const U=Object(c.a)(new N.a,{messageTitle:this.title,message:this.message,
isMultiline:!1,messageBarType:this.fv.businessBarType,dismissButtonAriaLabel:M.a.instance.ia(10),closeable:K.EwaSettings.isChangeGateEnabled("OfficeVSO:8549880_BizBarCloseIconChange")?!this.hideCloseButton:void 0});this.hideCloseButton||(U.onDismiss=this.XUj);this.Uca&&(U.linkProps=Object.assign({},{["type"]:"AppLinkProps",["text"]:this.linkText,["onExecute"]:this.uOc},K.EwaSettings.isChangeGateEnabled("OfficeVSO:8717551_AriaLabelForBusinessBarLinks")&&0<this.kKc.length?{["aria-label"]:this.kKc}:
{}));this.es&&(U.firstActionButtonProps={["type"]:"AppButtonProps",["label"]:this.actionButton,["onExecute"]:this.Efh});this.c2&&(U.secondActionButtonProps={["type"]:"AppButtonProps",["label"]:this.CSa,["onExecute"]:this.Ffh});K.EwaSettings.isChangeGateEnabled("OfficeVSO:7445369_IconFunctionalityReactBizBars")&&this.fv.iconName&&(U.messageBarIconProps={["iconName"]:this.fv.iconName});Y.createNewMessageBarWithCallback(this.domElement,U,()=>{n.AFrameworkApplication.ea.ka("Fluent2StyleIsEnabled")&&(this.domElement.classList.add("VNextBusinessBarEntry"),
this.domElement.classList.add("WACBusinessBarEntry"));this.domElement.classList.add("ReactBusinessBarEntry");Object(I.e)(()=>{var O,C;return null===(C=null===(O=this.businessBar)||void 0===O?void 0:O.domElement)||void 0===C?void 0:C.appendChild(this.domElement)});B.stop();b.ULS.sendTraceTag(509657951,0,50,`React Business Bar created for ${this.fv.nFa} in: ${B.Kc} milliSeconds.`)});return null},Y=>{b.ULS.sendTraceTag(524075914,0,10,`React BusinessBar for ${this.fv.nFa} could not be initialized. ${Y}`);
return null})}P9h(B){const Y=this.businessBar.$.Vb.Pg("DOMUpdate","LegacyBusinessBar");Y.start();B||(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var U=this.businessBar.$.Oc;B=U+"ewaBusinessBarEntryBody"+this.Lrd;const O=U+"ewaBusinessBarEntryTitle"+this.Lrd;var C=U+"ewaBusinessBarEntryIcon"+this.Lrd;this.domElement.className=u.a.ipi;z.DOMElementExtensions.HH(this.domElement);U=document.createElement("div");U.className=u.a.jpi;U.id=B;var X=document.createElement("div");
X.className=u.a.hpi;var S=document.createElement("a");S.className=u.a.qpi;S.title=this.alt;var ea=document.createElement("span");ea.classList.add(l.a.$vd);ea.classList.add(u.a.mpi);ea.id=C;this.gs.length&&(C=document.createElement("img"),C.classList.add(this.gs),C.src=w.a.Lh(0),ea.appendChild(C));S.appendChild(ea);X.appendChild(S);S=document.createElement("span");S.classList.add(u.a.ppi);S.id=O;S.innerText=A.a.Dg(this.title);X.appendChild(S);S=document.createElement("span");S.classList.add(u.a.opi);
S.id="message";S.innerText=A.a.Dg(this.message);X.appendChild(S);S=document.createElement("a");S.id="link";S.href="#";S.className=u.a.npi;S.innerText=A.a.Dg(this.linkText);X.appendChild(S);S=document.createElement("span");S.classList.add(u.a.Ouf);ea=document.createElement("button");ea.type="button";ea.id="action";ea.className=u.a.Nuf;ea.innerText=A.a.Dg(this.actionButton);S.appendChild(ea);X.appendChild(S);S=document.createElement("span");S.classList.add(u.a.Ouf);ea=document.createElement("button");
ea.type="button";ea.id="altAction";ea.className=u.a.Nuf;ea.innerText=A.a.Dg(this.CSa);S.appendChild(ea);X.appendChild(S);U.appendChild(X);X=document.createElement("a");X.className=u.a.lpi;X.tabIndex=0;X.setAttribute("role","button");S=document.createElement("span");S.id="close";S.classList.add(l.a.H0);ea=document.createElement("img");ea.classList.add(l.a.$Ed);ea.src=w.a.Lh(13);ea.alt=M.a.instance.ia(793);ea.title=M.a.instance.ia(793);ea.setAttribute("role","button");S.appendChild(ea);X.appendChild(S);
U.appendChild(X);this.domElement.appendChild(U);z.DOMElementExtensions.FG(this.domElement,t.a.Lqa,O,B);this.Yka=$get("link",this.domElement);z.DOMElementExtensions.setVisible(this.Yka,this.Uca);this.Uca&&(k.a.instance.va(x.a.click,this.Yka,this.uOc),this.q9f=d.a.instance.uZ(this.Yka,this.uOc,m.a.vo,m.a.Iza));this.nW=new e.a(z.DOMElementExtensions.getElementById(this.domElement,"action"));this.nW.isVisible=this.es;this.gga=new e.a(z.DOMElementExtensions.getElementById(this.domElement,"altAction"));
this.gga.isVisible=this.c2;this.es&&(k.a.instance.va(x.a.click,this.nW.domElement,this.u8d),this.V0e=d.a.instance.uZ(this.nW.domElement,this.u8d,m.a.vo,m.a.Iza),this.c2&&(k.a.instance.va(x.a.click,this.gga.domElement,this.A8d),this.x6e=d.a.instance.uZ(this.nW.domElement,this.A8d,m.a.vo,m.a.Iza)));this.MD=$get("close",this.domElement);this.gqc=this.Df.pf(this.MD);this.gqc.Ea("click",this.WUj);this.gqc.Ea("keydown",this.bVj);z.DOMElementExtensions.setVisible(this.MD,!this.hideCloseButton);Y.stop();
b.ULS.sendTraceTag(508387361,0,50,`Legacy Business Bar created for ${this.fv.nFa} in: ${Y.Kc} milliSeconds.`)}dlf(B){L.a.vVb()?this.G$h():this.P9h(B)}Hl(){b.ULS.sendTraceTag(21517968,0,50,`BusinessBar [${this.fv.hash}]: BusinessBarEntry.OnActionClick() for EntryName ${this.fv.nFa}`);G.f(this.businessBar.$).Bu(!0)}d3(){b.ULS.sendTraceTag(537170257,0,50,`BusinessBar [${this.fv.hash}]: BusinessBarEntry.OnAltActionClick() for EntryName ${this.fv.nFa}`);G.f(this.businessBar.$).Bu(!0)}YU(){b.ULS.sendTraceTag(537170256,
0,50,`BusinessBar [${this.fv.hash}]: BusinessBarEntry.OnLinkClick() for EntryName ${this.fv.nFa}`);G.f(this.businessBar.$).Bu(!0)}Oy(B){b.ULS.sendTraceTag(21517971,0,50,`BusinessBar [${this.fv.hash}]: BusinessBarEntry.OnCloseClick() for EntryName ${this.fv.nFa}`);this.set_visible(!1);this.businessBar.removeEntry(this.yDa);E.g(B)}wja(){return L.a.vVb()?this.domElement.getElementsByTagName("button")[0]:this.nW.domElement}}Object(y.a)(J,"BusinessBarEntry",r.a,[])},993:function(y,r,a){a.r(r);a.d(r,"ConvertToLinkedEntityManager",
function(){return Fa});y=a(133);r=a(0);var c=a(19),b=a(257),f=a(15),k=a(91),x=a(242),d=a(6),h=a(32),n=a(1027),m=a(144),u=a(41),l=a(20),t=a(7),e=a(177),w=a(1442),z=a(1195),E=a(189),M=a(666),G=a(399),A=a(61);const N=(Da,ja,Qa,Ob,Ub,Zb,uc,Hc,Dd,jc,$c)=>{$c=Da.$a(1,void 0===$c?null:$c);$c.selectedRanges=ja;$c.isChangeObject=Qa;$c.isFloodgateEnabled=Ob;$c.isStarterData=Ub;$c.starterDataDomainId=Zb;return A.h(Da,"GetDataSelectorPaneData",$c,uc,Hc,Dd,jc,4)};var K=a(141),I=a(960),L=a(1112);class J{}J.ydj=
"EnrichmentContentFrame";J.width=320;Object(r.a)(J,"EnrichmentConstants",null,[]);class B{constructor(Da){this.messageType=0;this.messageType=Da}}Object(r.a)(B,"EnrichmentResponseMessage",null,[]);class Y extends B{constructor(Da,ja){super(Da);this.messageContent=null;this.messageContent=ja}}Object(r.a)(Y,"EnrichmentResponseMessageWithContent",B,[]);class U extends Y{constructor(Da,ja,Qa){super(Da,ja);this.telemetryJson=null;this.telemetryJson=Qa}}Object(r.a)(U,"EnrichmentResponseMessageWithContentAndTelemetryData",
Y,[]);var O=a(606),C=a(16),X=a(128),S=a(52),ea=a(94),Oa=a(155),Ha=a(48),Za=a(78),fa=a(135),la=a(932),ba=a(26),aa=a(24);class oa{constructor(Da,ja,Qa,Ob,Ub){this.pA=this.Vm=this.eOe=this.cOe=this.uA=this.kz=null;this.LB=!1;this.Jog=Zb=>{Zb=Zb.Ha.keyCode;return Zb===Sys.UI.Key.enter||Zb===Sys.UI.Key.space?(this.hqc(),!0):!1};this.cog=()=>{};this.kOc=()=>{};this.dog=Zb=>{Zb=Zb.rawEvent;if(!this.uA||-1!==this.uA.src.indexOf(Zb.origin)){try{var uc=Ha.a(Zb.data)}catch(Hc){return}if(!la.c(uc.messageType))switch(uc.messageType){case 2:this.lRc(new U(1,
Ha.c(this.cOe),this.eOe));break;case 1:this.lRc(new Y(0,this.rJi()));break;case 3:this.kz&&this.kz.selectEntity(uc.messageContent);break;case 5:this.kz&&this.kz.ZYb(uc.messageContent);break;case 8:this.kz&&(uc=Ha.a(uc.messageContent),0<uc.DomainId?this.kz.cne(uc.Query,uc.TelemetryJson,uc.DomainId,uc.DomainIdString):this.kz.searchEntity(uc.Query,uc.TelemetryJson));break;case 6:this.kz&&this.kz.cancelSearch();break;case 11:uc=Ha.a(uc.messageContent);uc=oa.Rrc("keydown","f6",ea.a.ibc,!0,!1,uc,!0,!1);
this.uA&&this.uA.dispatchEvent(uc);break;case 12:if(Ha.a(uc.messageContent).keyCode===ea.a.iW&&(uc=oa.Rrc("keydown","esc",ea.a.iW,!0,!1,!1,!1,!1),this.uA&&(this.uA.dispatchEvent(uc),this.hide(),this.kz)))this.kz.onPaneClosed();break;case 13:this.kz&&this.kz.n5b(uc.messageContent);break;case 14:this.kz&&this.kz.Rub(uc.messageContent);break;case 15:this.kz&&this.kz.z7b(uc.messageContent);break;case 16:this.kz&&(uc=Ha.a(uc.messageContent),this.kz.WYa(uc.DomainId,uc.DomainIdString))}}};this.xo=Da;this.yf=
ja;this.Aga=Qa;this.kd=Ob;this.pb=Ub;this.NAa=Oa.a.kt(ea.a.QNa,0)}get wub(){return!0}get JMb(){return d.AFrameworkApplication.ea.Qa("EnrichmentPaneUrl")}dispose(){this.wub&&this.pA&&(this.xo.Ua(C.a.click,this.pA,Object(K.a)(this,this.uwa,"onClosePaneClick")),this.yf.Ua(C.a.Ye,this.pA,this.Jog));this.pA=null;this.uA&&(this.ual(),this.uA.parentNode.removeChild(this.uA),this.uA=null);this.kd.ql("EnrichmentPaneId").$w(this.NAa)}show(Da,ja,Qa){this.kz=Da;this.LB||(this.Vm=this.Hrc(),this.Ple.appendChild(this.Vm),
this.fok(),this.pb.jc(ba.a.Hff,fa.a.frame,Object(K.a)(this,this.L7i,"handleEscapeKeyAction")),this.mqe(),this.LB=!0);this.uA.src=this.JMb&&this.JMb.length?this.JMb+"?culture="+ja.market+"&appName="+ja.applicationName+"&themeId="+ja.themeId+"&featuresBitMask="+ja.featuresBitMask:oa.fig;this.cOe=ja;this.eOe=Qa;this.showInternal()}S2c(Da,ja){Da=new U(2,Da,ja);this.lRc(Da)}mqe(){const Da=this.kd.ql("EnrichmentPaneId");Da.parent=O.AFrame.Ynb;this.xo.Ikc("EnrichmentPaneId",this.Vm);Da.bindAction(this.NAa,
ba.a.Hff)}cRg(){if(this.uA){X.FocusManager.oza(this.uA.contentWindow);const Da=new U(4,null,null);this.lRc(Da)}}uwa(){this.hqc();return!0}hqc(){this.hide();if(this.kz)this.kz.onPaneClosed()}Hrc(){const Da=I.a("div","EnrichmentPaneId","EnrichmentPane");this.wub&&Da.appendChild(this.d8h());this.Rhj(Da);return Da}d8h(){const Da=I.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),ja=I.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle");ja.innerText=Object(aa.a)("EnrichmentPaneTitle");
ja.title=Object(aa.a)("EnrichmentPaneTitle");const Qa=L.a.yb("CloseEnrichmentPane","EnrichmentPaneCloseButton",Object(aa.a)("Close"),"ClosePaneGlyph_16x16x32",!1);this.xo.va(C.a.click,Qa,Object(K.a)(this,this.uwa,"onClosePaneClick"));this.yf.va(C.a.Ye,Qa,this.Jog);Da.appendChild(ja);Da.appendChild(Qa);this.pA=Qa;return Da}Rhj(Da){this.uA=I.b("iframe","","EnrichmentFrame");Da.appendChild(this.uA);this.uA.id=J.ydj;this.uA.setAttribute("role","presentation")}fok(){S.a.addHandler(this.uA,"load",this.cog);
S.a.addHandler(this.uA,"error",this.kOc);$addHandler(window,"message",this.dog)}ual(){S.a.removeHandler(this.uA,"load",this.cog);S.a.removeHandler(this.uA,"error",this.kOc);$removeHandler(window,"message",this.dog)}fdi(){this.uA.src=oa.fig}hide(){this.hideInternal();this.fdi()}L7i(Da,ja,Qa){if(1!==Qa&&(this.hide(),this.kz))this.kz.onPaneClosed();return 32}rJi(){return Ha.c([2,1,3,5,8,6])}lRc(Da){Da=Ha.c(Da);this.uA.contentWindow.postMessage(Da,Za.a.getOrigin(this.JMb))}static Rrc(Da,ja,Qa,Ob,Ub,Zb,
uc,Hc){ja={};ja.keyCode=Qa;ja.ctrlKey=uc;ja.shiftKey=Zb;ja.altKey=Hc;ja.bubbles=Ob;ja.cancelable=Ub;return new KeyboardEvent(Da,ja)}}oa.fig="about:blank";Object(r.a)(oa,"EnrichmentPane",null,[688,4]);var Na=a(1);class Ia extends oa{constructor(Da){super(d.AFrameworkApplication.ua.JE,d.AFrameworkApplication.ua.hD,d.AFrameworkApplication.ua.Wya,d.AFrameworkApplication.ua.hh,d.AFrameworkApplication.Kb);this.taskPane=Da;this.taskPane.eFh(this.cRg)}get Ple(){return this.taskPane.ud}showInternal(){this.taskPane.isVisible||
this.taskPane.dA(!0)}hideInternal(){this.taskPane.dA(!1)}get wub(){return!Na.EwaSettings.isChangeGateEnabled("OfficeVSO:8207038_EnrichmentTaskPaneHeaderFix")}dispose(){this.taskPane&&(this.taskPane.Stk(this.cRg),this.taskPane=null);super.dispose()}}Object(r.a)(Ia,"EnrichmentTaskPaneWrapper",oa,[]);class Sa{constructor(Da){this.sD=null;this.yoa=Da}gBj(Da,ja){this.sD=Da;this.yoa&&this.yoa.show(this,ja,null)}S2c(Da,ja){this.yoa&&this.yoa.S2c(Da,ja)}QRd(){this.yoa&&this.yoa.hide()}dispose(){this.yoa&&
(this.yoa.dispose(),this.yoa=null)}selectEntity(Da){return this.sD?this.sD.selectEntity(Da):!1}searchEntity(Da,ja){this.sD&&this.sD.searchEntity(Da,ja)}cne(Da,ja,Qa,Ob){this.sD&&this.sD.cne(Da,ja,Qa,Ob)}ZYb(Da){return this.sD?this.sD.ZYb(Da):!1}onPaneClosed(){if(this.sD)this.sD.onPaneClosed()}cancelSearch(){this.sD&&this.sD.cancelSearch()}n5b(Da){this.sD&&this.sD.n5b(Da)}Rub(Da){this.sD&&this.sD.Rub(Da)}z7b(Da){this.sD&&this.sD.z7b(Da)}WYa(Da,ja){this.sD&&this.sD.WYa(Da,ja)}}Object(r.a)(Sa,"EnrichmentManager",
null,[686,4]);class Pa extends Sa{constructor(Da){super(Da)}dispose(){super.dispose()}}Object(r.a)(Pa,"ExcelEnrichmentManager",Sa,[]);var za=a(13);class wa{constructor(Da){this.campaignId=this.commentQuestion=null;this.isZeroBased=!1;this.ratingValuesAscending=this.ratingQuestion=this.aditionalDataRequested=null;this.showPrompt=this.showEmailRequest=!1;this.surveyType=0;this.title=null;this.campaignId=Da;this.commentQuestion=za.a.instance.Ib(199);this.isZeroBased=!1;this.aditionalDataRequested=["EmailAddress"];
this.ratingQuestion=za.a.instance.Ib(195);this.ratingValuesAscending=[za.a.instance.Ib(196),za.a.instance.Ib(197),za.a.instance.Ib(198)];this.showPrompt=!1;this.showEmailRequest=!0;this.surveyType=4;this.title=za.a.instance.Ib(194)}}Object(r.a)(wa,"FloodgateSurvey",null,[]);var db=a(27),Ba=a(70),Ka=a(492),da=a(44),sa=a(429),mb=a(213),Ma=a(83),hb=a(36),$a=a(266),Va=a(25);class xa{constructor(){this.market=this.appCorrelationId=this.sessionId=this.anid=this.applicationVersion=this.applicationName=null;
this.featuresBitMask=this.themeId=0;this.disambiguationJson=this.uiLanguage=null}}Object(r.a)(xa,"EnrichmentMessageContentAppProperties",null,[]);class ia{constructor(Da,ja,Qa,Ob,Ub){this.NEa=this.wpf=!1;this.utb=this.Mua=!0;this.w0b=this.a7b=!1;this.$ub=null;this.sQc=0;this.nB=()=>{(this.utb||this.NEa)&&2!==this.sQc&&(this.w0b||this.G1d(!1))};this.yd=()=>{f.ULS.sendTraceTag(537166944,0,15,"Session ID changed while ambiguous linked entities are present")};this.QVj=Zb=>{hb.a.zf(Zb.Errors)?(Zb=hb.a.pc(Zb.Errors),
Zb.includes("OperationSucceededWithAlert")?f.ULS.sendTraceTag(537166942,0,50,"Convert to Linked Entity failed with an alert"):f.ULS.sendTraceTag(36975687,0,10,`Failed to Convert to Linked Entity. errors: ${Zb}`)):Zb.Result&&(this.$.fa.Qk(this.yd),this.$.fa.Vk(this.yd),Zb=Zb.Result,this.$ub=Zb.SkydanceFeatureBitmask,this.k6d(Zb),this.a7b=!0)};this.ph=()=>{(this.utb||this.NEa)&&this.G1d(!1)};this.ZNc=(Zb,uc)=>{hb.a.zf(Zb.Errors)?f.ULS.sendTraceTag(36975688,0,10,`Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: ${hb.a.pc(Zb.Errors)}`):
Zb.Result&&(Zb=Zb.Result,Zb.DisambiguationJson?(this.a7b=!1,this.hSg(uc),this.$ub=Zb.SkydanceFeatureBitmask,uc=Zb.DisambiguationJson,f.ULS.sendTraceTag(537166940,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.w0b=!1,this.Q8f(uc)):f.ULS.sendTraceTag(537166941,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null"))};this.aZj=(Zb,uc)=>{hb.a.zf(Zb.Errors)?(uc=hb.a.pc(Zb.Errors),f.ULS.sendTraceTag(36975689,
0,10,`Failed to retrieve disambiguation data for search. errors: ${uc}`)):Zb.Result&&(Zb=Zb.Result,Zb.DisambiguationJson?(this.hSg(uc),this.$ub=Zb.SkydanceFeatureBitmask,uc=Zb.DisambiguationJson,f.ULS.sendTraceTag(537166938,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.w0b=!0,this.Q8f(uc)):f.ULS.sendTraceTag(537166939,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null"))};
this.K1j=Zb=>{hb.a.zf(Zb.Errors)?(Zb=hb.a.pc(Zb.Errors),f.ULS.sendTraceTag(36975690,0,10,`Failed to move to the next ambiguous Linked Entity. errors: ${Zb}`),this.utb=!0):Zb.Result&&(Zb=Zb.Result,this.$ub=Zb.SkydanceFeatureBitmask,this.k6d(Zb),this.a7b=!0)};this.O4j=Zb=>{if(hb.a.zf(Zb.Errors)){const uc=hb.a.pc(Zb.Errors);f.ULS.sendTraceTag(36975691,0,10,`Failed to select Linked Entity for Disambiguation.. errors: ${uc}`)}Zb.Result?(this.k6d(Zb.Result),this.a7b=!0):this.QDa()};this.rsg=Zb=>{hb.a.zf(Zb.Errors)?
(Zb=hb.a.pc(Zb.Errors),f.ULS.sendTraceTag(36975692,0,15,`Failed to retrieve data for searching in Disambiguation Pane.  Error id names: ${Zb}`)):Zb.Result?this.bvc.S2c(Zb.Result,null):(f.ULS.sendTraceTag(537166927,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),this.QDa())};this.y0j=Zb=>{hb.a.zf(Zb.Errors)?(Zb=hb.a.pc(Zb.Errors),f.ULS.sendTraceTag(537166926,0,15,`Failed to insert starter data table. Error id names: ${Zb}`)):this.QDa()};
this.$=Da;this.da=Va.f(this.$);this.da.ha.ZS(this.ph);this.da.aw(this.nB);this.Utf=Ob;this.Zm=Ub;Da=new Ia(ja);this.bvc=new Pa(Da);Object(c.d)(b.a).execute(Zb=>{Zb.isFeatureEnabled("mso_sendASmile",!0).then(uc=>{this.Mua=uc;return null})})}dispose(){this.$&&(this.da.ha.rV(this.ph),this.da.Zz(this.nB))}selectEntity(Da){const ja=da.r(this.da.ha.oa.activeCell,this.$),Qa=()=>new Ka.a;sa.a(this.$.userOperationManager,(Ob,Ub,Zb)=>{var uc=this.$.ma.sa;Ob=$a.c(Ob,this.O4j);const Hc=uc.$a(9,null);Hc.activeCell=
ja;Hc.selectionIndex=Da;return A.h(uc,"SelectLinkedEntityForDisambiguation",Hc,Ob,Ub,Zb,null,4)},Ob=>new mb.a(109,0,Ob,void 0,Qa),null);return!0}searchEntity(Da,ja,Qa,Ob,Ub){Qa=void 0===Qa?!1:Qa;Ob=void 0===Ob?0:Ob;Ub=void 0===Ub?null:Ub;f.ULS.sendTraceTag(38846755,0,50,`ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: ${ja}`);const Zb=da.r(this.da.ha.oa.activeCell,this.$);sa.a(this.$.userOperationManager,(uc,Hc,Dd)=>{var jc=this.$.ma.sa,$c=this.Mua,ud=Qa,Ud=Ob,ec=
Ub;uc=$a.c(uc,this.rsg);const Db=jc.$a(1,null);Db.searchCell=Zb;Db.searchQuery=Da;Db.isFloodgateEnabled=$c;Db.isStarterData=ud;Db.starterDataDomainId=Ud;Db.starterDataDomainIdString=ec;return A.h(jc,"LinkedEntitySearch",Db,uc,Hc,Dd,null,4)},uc=>new mb.a(110,0,uc,16),null)}ZYb(Da){const ja=da.r(this.da.ha.oa.activeCell,this.$);this.utb=!1;sa.a(this.$.userOperationManager,(Qa,Ob,Ub)=>{var Zb=this.$.ma.sa;Qa=$a.c(Qa,this.K1j);const uc=Zb.$a(1,null);uc.activeCell=ja;uc.isBackward=Da;return A.h(Zb,"MoveToNextAmbiguousLinkedEntity",
uc,Qa,Ob,Ub,null,4)},Qa=>new mb.a(111,0,Qa,16),null);return!0}onPaneClosed(){this.NEa=!1;this.wpf=!0;this.sQc=0;this.w0b=!1}cancelSearch(){const Da=this.Cne();Da&&sa.a(this.$.userOperationManager,(ja,Qa,Ob)=>{var Ub=this.$.ma.sa;ja=$a.c(ja,this.rsg);const Zb=Ub.$a(9,null);Zb.activeCell=Da;return A.h(Ub,"CancelSearchLinkedEntity",Zb,ja,Qa,Ob,null,4)},ja=>new mb.a(112,0,ja,16),null)}n5b(Da){f.ULS.sendTraceTag(537166977,0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane");
this.QDa();if(Da&&Da.length)if(Da=JSON.parse(Da))if(null==Da.domainId)f.ULS.sendTraceTag(537166946,0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");else{var ja={};ja.Id=Da.domainId;ja.StringId=Da.stringId;this.Zm.convertToLinkedEntity(ja)}else f.ULS.sendTraceTag(537166947,0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");else f.ULS.sendTraceTag(537166976,0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane")}Rub(Da){const ja=
new Ma.a(-859308420,Ba.a.Hb,this.$.xc,9,null);this.$.Ia.Gb(ja,{[Ba.a.Bf]:"HelpID="+Da,["InputMethod"]:Ba.a.Hb,["ShouldCanvasTakeFocus"]:!0,[Ba.a.Wc]:t.a.VF})}z7b(Da){z.a.R5a(new wa(Da))}WYa(Da,ja){const Qa=this.Cne();Qa&&sa.a(this.$.userOperationManager,(Ob,Ub,Zb)=>{var uc=this.$.ma.sa;Ob=$a.c(Ob,this.y0j);const Hc=uc.$a(1,null);Hc.cell=Qa;Hc.starterDataDomainId=Da;Hc.starterDataDomainIdString=ja;return A.h(uc,"InsertStarterDataTable",Hc,Ob,Ub,Zb,null,4)},Ob=>new mb.a(259,0,Ob,1),null)}G1d(Da){this.launchOrCloseDisambiguationPane(Da)}launchDisambiguationPaneForSearch(){f.ULS.sendTraceTag(36975685,
0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted");const Da=this.jFk();Da&&sa.a(this.$.userOperationManager,(ja,Qa,Ob)=>N(this.$.ma.sa,Da,!0,this.Mua,!1,null,$a.c(ja,this.aZj),Qa,Ob,1),ja=>new mb.a(114,0,ja,16),null)}launchLinkedEntityDataTypeSelectorPane(Da,ja){sa.a(this.$.userOperationManager,(Qa,Ob,Ub)=>{var Zb=this.$.ma.sa;Qa=$a.c(Qa,this.ZNc);const uc=Zb.$a(1,null);uc.selectedRanges=Da;uc.letyDomainId=ja;return A.h(Zb,"GetDataTypeSelectorData",
uc,Qa,Ob,Ub,2,4)},Qa=>new mb.a(233,0,Qa,16),null)}aBj(Da,ja){Da&&sa.a(this.$.userOperationManager,(Qa,Ob,Ub)=>N(this.$.ma.sa,Da,!1,!1,!0,ja,$a.c(Qa,this.ZNc),Ob,Ub,2),Qa=>new mb.a(257,0,Qa,16),null)}hSg(Da){Da&&(this.sQc=Da)}Q8f(Da){var ja=new Ma.a(-90814711,Ba.a.Hb,0,10,null);this.$.Ia.Gb(ja,null);this.NEa?this.bvc.S2c(Da,null):(ja=3,null!=this.$ub?ja=this.$ub:f.ULS.shipAssertTag(537166937,0,!1,"SkydanceFeatureBitmask was not set"),(Da=this.XPi(Da,ja))||f.ULS.sendTraceTag(537166936,0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),
this.Utf||f.ULS.sendTraceTag(537166935,0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),this.bvc.gBj(this.Utf,Da),this.NEa=!0)}QDa(){this.NEa&&(f.ULS.sendTraceTag(537166934,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),this.bvc.QRd(),this.NEa=!1,this.sQc=0,this.w0b=!1)}k6d(Da){var ja=Da.Row+1;Da=Da.Column+1;0>ja||0>Da?(f.ULS.sendTraceTag(537166933,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane"),this.QDa(),
this.$.fa.Qk(this.yd)):(ja=new db.Range(ja,Da,ja,Da,!0,!1),this.da.ha.updateSelection(ja,ja,60),this.utb=!0)}XPi(Da,ja){const Qa=new xa;Qa.applicationVersion=d.AFrameworkApplication.buildVersion;Qa.applicationName="ExcelWac";Qa.anid="00000000-0000-0000-0000-000000000000";Qa.sessionId=d.AFrameworkApplication.userSessionId;Qa.appCorrelationId=E.a.create().toString();var Ob=M.a.kN(d.AFrameworkApplication.lcid);Ob=Ob?Ob.name:null;Qa.uiLanguage=Ob;Qa.market=this.qzc(Ob);Qa.themeId=0;Qa.disambiguationJson=
Da;ja<=G.a.b5?Qa.featuresBitMask=ja:f.ULS.sendTraceTag(537166932,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties");return Qa}qzc(Da){Da=Da.split("-");return Da[Da.length-1]}launchOrCloseDisambiguationPane(Da){const ja=this.da.ha.oa.activeCell;if(this.Cne()&&ja)if(this.da.Eb.wTb(ja)){if((!this.wpf||Da||this.a7b)&&!this.da.isEditing){Da&&(this.utb=!0);var Qa=da.t(ja,this.$);sa.a(this.$.userOperationManager,(Ob,Ub,Zb)=>N(this.$.ma.sa,Qa,!1,this.Mua,!1,null,$a.c(Ob,
this.ZNc),Ub,Zb,1),Ob=>new mb.a(114,0,Ob,16),null)}}else this.QDa();else this.QDa()}Vmk(){if(this.NEa){var Da=this.da.ha.oa.activeCell;if(Da){var ja=da.t(Da,this.$);sa.a(this.$.userOperationManager,(Qa,Ob,Ub)=>N(this.$.ma.sa,ja,!1,this.Mua,!1,null,$a.c(Qa,this.ZNc),Ob,Ub,1),Qa=>new mb.a(114,0,Qa,16),null)}else this.QDa()}}Cne(){const Da=this.da.ha.oa;return Da.rva()?da.r(Da.activeCell,this.$):null}jFk(){const Da=this.da.ha.oa;return Da.rva()?da.t(Da.activeCell,this.$):null}}Object(r.a)(ia,"ConvertToLinkedEntityDisambiguationPane",
null,[4]);var Z=a(2),ta=a(285),pa=a(1493),Ga=a(64),Ca=a(943);class kb{constructor(Da,ja,Qa){this.t9f=2;this.s9f="Size64by48";this.$=Da;this.Ya=ja;this.Zm=Qa}fHi(Da,ja){var {ConvertToLinkedEntityManager:Qa}=a(993);this.jdl();ja=this.Ya.pq(ja).wH();let Ob=0,Ub=0,Zb=!1;for(var uc of Da.Categories){const Hc=this.OHi(uc,Ob);Hc&&(Ub===Qa.tnb&&(Zb=!0),ja.MenuSectionList.push(Hc),++Ob);++Ub}Zb&&Ob<=Qa.u9f&&ja.MenuSectionList.splice(Qa.tnb,1);Qa=this.Ya.uc().loc();uc=Ga.a.Lh(11);for(const Hc of Da.LongButtons)this.Zm.dTk(Hc)&&
this.lBh(Qa,Hc,uc);0<Qa.ControlList.length&&ja.MenuSectionList.push(Qa);return ja}lBh(Da,ja,Qa){if(ja){var Ob="Data.ConvertToLinkedEntityMenuItem_"+ja.Name,Ub=this.Zm.i1(ja.DomainId);Ub&&(ja=Object(Z.a)(new ta.a,{Id:Ob,ExternalId:Ob,Command:"-1662108744",LabelText:ja.Name,Alt:ja.SuperTip,Visible:!0,MenuItemId:a(993).ConvertToLinkedEntityManager.dgb(ja.DomainId),Image16by16:Qa,Image16by16Class:this.Zdj(Ub.FontLocator)}),Da.ControlList.push(ja))}}HHi(Da,ja){return Object(Z.a)(new pa.a,{Id:a(993).ConvertToLinkedEntityManager.wrf+
Da.toString(),ExternalId:a(993).ConvertToLinkedEntityManager.wrf+Da.toString(),MenuItemId:a(993).ConvertToLinkedEntityManager.UCd+Da.toString(),Command:"-1203788282",QueryCommand:"QueryLinkedEntityGalleryButtons",Icon:this.kVf(ja.FontLocator),LabelText:ja.Name,PreviewIconStyle:{["root"]:{["width"]:24,["min-width"]:24,["height"]:24}},Alt:this.RKd(ja)})}PMh(Da){switch(Da){case "Animal":return Ca.a.MIh;case "Apple":return Ca.a.OJh;case "Atom":return Ca.a.vLh;case "Beaker":return Ca.a.GNh;case "Bridge":return Ca.a.kPh;
case "Cat":return Ca.a.SVh;case "City":return Ca.a.nYh;case "Constellation":return Ca.a.u2h;case "Dog":return Ca.a.oji;case "Finance":return Ca.a.yNh;case "GradCap":return Ca.a.g6i;case "HumanAnatomy":return Ca.a.vdj;case "LocationPointer":return Ca.a.fEj;case "Map":return Ca.a.u8j;case "MedicineNeedle":return Ca.a.sLj;case "Mountain":return Ca.a.LMj;case "Movie":return Ca.a.bNj;case "Music":return Ca.a.qOj;case "OuterSpace":return Ca.a.j9j;case "Planet":return Ca.a.Jbk;case "Satellite":return Ca.a.nCk;
case "WolframGeneric":return Ca.a.bBk;default:return Ca.a.o4h}}Zdj(Da){if("PowerBIRibbon"!==Da)return l.a.ZEd;switch(Da){case "AnimalRibbon":return l.a.Yti;case "AppleRibbon":return l.a.Zti;case "AtomRibbon":return l.a.$ti;case "BeakerRibbon":return l.a.aui;case "BridgeRibbon":return l.a.bui;case "CenterMapRibbon":return l.a.cui;case "CityRibbon":return l.a.dui;case "CurrencyRibbon":return l.a.eui;case "ExerciseRibbon":return l.a.fui;case "FinanceRibbon":return l.a.Vxf;case "FirstAidRibbon":return l.a.gui;
case "GlobeLightningRibbon":return l.a.hui;case "GradCapRibbon":return l.a.iui;case "HumanAnatomyRibbon":return l.a.jui;case "LeafRibbon":return l.a.kui;case "LocationPointerRibbon":return l.a.mui;case "MapRibbon":return l.a.Txf;case "MountainRibbon":return l.a.nui;case "MovieRibbon":return l.a.oui;case "MusicRibbon":return l.a.pui;case "NotablePeopleRibbon":return l.a.qui;case "OuterSpaceRibbon":return l.a.rui;case "PartlySunnyWeatherRibbon":return l.a.sui;case "PowerBIRibbon":return l.a.Uxf;case "SatelliteRibbon":return l.a.tui;
case "WolframGenericRibbon":return l.a.lui;case "YogaRibbon":return l.a.vui;default:return l.a.Sxf}}kVf(Da){switch(Da){case "AnimalRibbon":return"AnimalExcelDataTypes_24";case "AppleRibbon":return"AppleExcelDataTypes_24";case "AtomRibbon":return"AtomExcelDataTypes_24";case "BeakerRibbon":return"BeakerExcelDataTypes_24";case "BridgeRibbon":return"BridgeExcelDataTypes_24";case "CenterMapRibbon":return"CenterMapExcelDataTypes_24";case "CityRibbon":return"CityExcelDataTypes_24";case "CurrencyRibbon":return"CurrencyExcelDataTypes_24";
case "ExerciseRibbon":return"ExerciseExcelDataTypes_24";case "FinanceRibbon":return"Bank_32";case "FirstAidRibbon":return"FirstAidExcelDataTypes_24";case "GlobeLightningRibbon":return"GlobeLightning_24";case "GradCapRibbon":return"GradCapExcelDataTypes_24";case "HumanAnatomyRibbon":return"HumanAnatomyExcelDataTypes_24";case "LeafRibbon":return"LeafExcelDataTypes_24";case "LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";case "MapRibbon":return"OpenMap_24";case "MountainRibbon":return"MountainExcelDataTypes_24";
case "MovieRibbon":return"MovieExcelDataTypes_24";case "MusicRibbon":return"MusicExcelDataTypes_24";case "NotablePeopleRibbon":return"NotablePeopleExcelDataTypes_24";case "OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";case "PartlySunnyWeatherRibbon":return"PartlySunnyWeatherExcelDataTypes_24";case "PowerBIRibbon":return"DataProtectionExcelDataTypes_24";case "SatelliteRibbon":return"SatelliteExcelDataTypes_24";case "WolframGenericRibbon":return"Lightning_24";case "YogaRibbon":return"YogaExcelDataTypes_24";
default:return"ConvertToEntity_20"}}OHi(Da,ja){ja=this.Ya.gK("ConvertToLinkedEntitySection_"+ja,this.t9f,this.s9f);var Qa=!1;for(var Ob of Da.DomainIds){const Ub=this.Zm.i1(Ob);if(!Ub||Ub.DomainBlocked||!Ub.ShowInRibbon)continue;Qa=Ub.Name;const Zb=a(993).ConvertToLinkedEntityManager.dgb(Ob);ja.GJ("Data.ConvertToLinkedEntityMenuItem_"+Zb,-1203788282,"QueryLinkedEntityGalleryIcon",void 0,Zb,this.kVf(Ub.FontLocator),void 0,void 0,this.RKd(Ub),Qa);Qa=!0}if(!Qa)return null;Ob=ja.koc(!0);ja=this.Ya.uc();
ja.title=Da.Name;Da=ja.loc();Da.ControlList.push(Ob);return Da}jdl(){this.t9f=5;this.s9f="Size112by64"}RKd(Da){return Da.RibbonTooltipHeader?Da.RibbonTooltipHeader+"\n\n"+Da.RibbonTooltip:Da.RibbonTooltip}}Object(r.a)(kb,"ConvertToLinkedEntityMenuRenderer",null,[660]);var eb=a(58),Yb=a(368),Gb=a(124),Mb=a(98);class Rb{constructor(Da,ja){this.oRd=this.pRd=!1;this.Q_b=Qa=>{f.ULS.sendTraceTag(537166680,0,50,"OnReadRoamingStringSuccess called.");this.pRd=!0;if(hb.a.zf(Qa.Errors))f.ULS.sendTraceTag(537166679,
0,10,`OnReadRoamingStringSuccess encountered an error. Errors: ${hb.a.pc(Qa.Errors)}`);else{var Ob=0,Ub=[],Zb=!1;try{if(!Qa.Result)return;const uc=Qa.Result;if(!uc){f.ULS.sendTraceTag(537166678,0,50,"OnReadRoamingStringSuccess - Received an empty roamingXml.");return}Ub=this.O$j(uc);if(!Ub||!Ub.length)return;Ob=Ub.length;this.KLj(Ub);this.OLa.fKg();f.ULS.sendTraceTag(537166677,0,50,`OnReadRoamingStringSuccess MruCount:${this.OLa.Irb.length}`);if(Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5199912_LinkedEntityMruWolfram")){for(const Hc of this.OLa.Irb)if(1===
(Hc.Id&1048320)>>8){Zb=!0;break}f.ULS.sendTraceTag(537166676,0,50,`OnReadRoamingStringSuccess MruWolframAvailable:${Zb}`)}}finally{f.ULS.sendTraceTag(537166675,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${Ob} data types.`),Mb.a("ReadRecentlyUsedLinkedDataTypes",void 0,void 0,[{name:"MruCount",int64:Ob},{name:"MruWolframAvailable",bool:Zb}])}this.oRd&&(this.qbh(this.OLa.Irb),this.oRd=!1)}};this.t0b=Qa=>{f.ULS.sendTraceTag(537166674,0,50,"OnWriteRoamingStringSuccess called.");hb.a.zf(Qa.Errors)?
f.ULS.sendTraceTag(537166673,0,10,`OnWriteRoamingStringSuccess encountered an error. Errors: ${hb.a.pc(Qa.Errors)}`):Qa.Result&&(Qa.Result||f.ULS.sendTraceTag(537166672,0,15,"OnWriteRoamingStringSuccess - Failed to write to the roaming service."))};this.T_b=(Qa,Ob,Ub)=>{Qa=Gb.a.te(Qa.data);f.ULS.sendTraceTag(537166671,0,10,`OnRoamingOperationFailure: Encountered errors for ${Ub}. Errors: ${hb.a.pc(Qa)}.`)};this.$=Da;this.OLa=ja}EZi(){!this.pRd&&this.$.fa.yc&&(f.ULS.sendTraceTag(537166691,0,50,"GetRecentlyUsedLinkedDataTypesFromRoamingService - Invoking the GetRecentlyUsedDataTypes operation."),
Yb.D(this.$.ma.sa,0,this.Q_b,this.T_b,null,null))}qbh(Da){Da&&Da.length?this.pRd?(Da=this.gHk(Da))?(f.ULS.sendTraceTag(537166688,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Invoking the WriteRecentlyUsedDataTypes operation."),Yb.K(this.$.ma.sa,0,Da,this.t0b,this.T_b,null,null)):f.ULS.sendTraceTag(537166689,0,15,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Created an empty serialized string."):this.oRd=!0:f.ULS.sendTraceTag(537166690,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Tried writing an empty list of data types.")}gHk(Da){if(!Da||
!Da.length)return f.ULS.sendTraceTag(537166687,0,15,"SerializeRecentlyUsedLinkedDataTypes - Received an empty list of data types."),null;var ja=[];for(const Qa of Da)Da={},Da.Id=Qa.Id,Qa.StringId&&(Da.StringId=Qa.StringId),ja.push(Da);ja="<DataTypes>"+eb.a.Nc(ja)+"</DataTypes>";return 1906<ja.length?(f.ULS.sendTraceTag(537166686,0,15,"SerializeRecentlyUsedLinkedDataTypes - Exceeded the MaxSize for ridExcelRecentlyUsedLinkedDataTypes."),null):ja}O$j(Da){if(!Da)return f.ULS.sendTraceTag(537166685,0,
15,"ParseRecentlyUsedLinkedDataTypes - Received an empty roamingXml."),null;if(!Da.startsWith("<DataTypes>")||!Da.endsWith("</DataTypes>"))return f.ULS.sendTraceTag(537166684,0,15,"ParseRecentlyUsedLinkedDataTypes - Received a string without a prefix/postfix."),null;Da=Da.substring(11,Da.length-12);if(!Da)return f.ULS.sendTraceTag(537166683,0,15,"ParseRecentlyUsedLinkedDataTypes - Created an empty substring."),null;let ja=[];try{ja=eb.a.Xj(Da)}catch(Qa){return f.ULS.sendTraceTag(537166682,0,10,`ParseRecentlyUsedLinkedDataTypes - Encountered an exception. Message: ${Qa.message}`),
null}f.ULS.sendTraceTag(537166681,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${ja.length} data types.`);return ja}KLj(Da){const ja=this.OLa.Irb,Qa=this.OLa.Dlk;if(ja.length!==Qa){for(let Ob=0;Ob<Da.length&&ja.length<Qa;++Ob){const Ub=Da[Ob];this.OLa.i1(Ub)&&!ja.includes(Ub)&&ja.push(Ub)}this.OLa.Irb=ja}}}Object(r.a)(Rb,"LinkedDataTypeRoamingHandler",null,[]);var $b=a(73),cc=a(81),fb=a(114),Sb=a(43),kc=a(57),na=a(33),fc=a(255),Cc=a(28),tc=a(113),nb=a(88),tb=a(65),La=a(5),wb=a(684),Wa;let Fa=Wa=
class extends u.a{constructor(Da,ja,Qa,Ob,Ub,Zb,uc){super();this.g5f=this.QZd=this.U_d=this.vYd=this.uYd=this.AHc=null;this.zZb=this.SQd=0;this.Mva=null;this.SUd=!1;this.OId=this.tq=this.Mle=null;this.Ew=0;this.QM=null;this.fYa=8;this.Std=this.r9f=this.q0f=this.$pb=!1;this.FKa=this.hFf=this.tBf=null;this.Ird=0;this.aNh=5;this.znc=3E4;this.K3g=!1;this.Pqa=null;this.$Ea=Array(5);this.J6g=this.xze=!1;this.GLg=this.h2d=0;this.Mc=this.uSe=null;this.TXg=!0;this.yd=(Hc,Dd)=>{Dd.yc&&!Dd.RVb&&this.showUntrustedImageBusinessBarIfNecessary()};
this.g_j=Hc=>{if(Hc.Result){var Dd=Hc.Result;if(Dd&&Dd.length){f.ULS.sendTraceTag(537166922,0,50,`OnGetRichDataClassificationLabelsSuccess: Received ${Dd.length} labels`);var jc=cc.GetServiceTaskFactory.Ne(this.$.ra,274,275,0);Sb.TaskExtensions.tb(jc,()=>{jc.result.xrd(Dd,2)||f.ULS.sendTraceTag(537166921,0,10,"OnGetRichDataClassificationLabelsSuccess - Failed to apply the policy label.")},this.$.Aa,3)}}else f.ULS.sendTraceTag(537166923,0,50,"OnGetRichDataClassificationLabelsSuccess: Received no result")};
this.fg=()=>{this.$8k();this.L8i(this.$.fa.el.LinkedEntityAsyncRefreshStateId);this.b$i(this.$.fa.el.RichDataClassificationLabelStateId)};this.iXj=()=>{this.xze=!0;this.tq&&this.tq.Vmk()};this.tZj=Hc=>{if(Hc&&!fc.a(Hc))try{Hc.Result.HasUntrustedImageUrl&&(this.businessBar.lh(59,null),this.J6g=!0)}catch(Dd){f.ULS.sendTraceTag(574718945,0,10,`ConvertToLinkedEntityManager.OnGetHasUntrustedImageUrlsFromServerSuccess: GetHasUntrustedImageUrls encountered exception ${Dd}.`)}};this.O8f=()=>{if(!this.r9f&&
this.dUb()&&!this.XVd())if(Mb.a("DataTabActive"),$b.a.Eg.vU)if(document.querySelector("#ConvertToLinkedEntityGallery-previewExpandButton")){var Hc=this.Frc();if(Hc){var Dd={};Dd.InputMethod=Ba.a.Hb;Dd.CalloutName=8;Dd.Target="[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]";this.$.Ia.Gb(Hc,Dd);this.r9f=!0}else f.ULS.sendTraceTag(537166880,0,10,"RibbonCommandInfo is null for LinkedEntityGalleryCallout")}else f.ULS.sendTraceTag(537166881,0,10,"Could not locate anchor for the LinkedEntityGalleryCallout");
else f.ULS.sendTraceTag(537166882,0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityGalleryCallout() - Attempted to launch linked entity gallery callout but callout not enabled")};this.RVj=Hc=>{hb.a.zf(Hc.Errors)||this.raiseEvent("LinkedEntityConverted")};this.V5j=()=>{Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)?void tb.a.Bd(La.AriaLiveNotifierService).then(Hc=>{Hc.readText(za.a.instance.ia(1813))}):this.$.ra.Vc(211,Hc=>{Hc.readText(za.a.instance.ia(1813))})};
this.de=(Hc,Dd)=>{f.ULS.sendTraceTag(537166867,0,50,"ConvertToLinkedEntityManager.OnWorkbookOpened called");Dd.DY?f.ULS.sendTraceTag(537166865,0,15,"ConvertToLinkedEntityManager.OnWorkbookOpened called while rendering cached content"):(this.$.isEditMode?this.cef():this.xyk(),this.xze&&this.Vsf())};this.DZj=Hc=>{this.Qpc();if(Hc.Result){var Dd=Hc.Result;Hc=Dd.DomainDataArray;if(this.Mva=Dd.Ribbon){var jc={};jc.Name=za.a.instance.ia(1803);jc.DomainIds=this.DU;this.Mva.Categories.splice(Wa.tnb,0,jc)}0<
Dd.MaximumCellsToConvert&&(this.uSe=Dd.MaximumCellsToConvert);this.Ew=2;Dd=!1;if(Hc){f.ULS.sendTraceTag(39949271,0,50,`OnGetLinkedEntityServiceDomainsSuccess: Received ${Hc.length} domains`);this.x0a||(this.x0a=[]);jc=za.a.instance.ia(1800);const $c=za.a.instance.ia(1802);for(const ud of Hc)ud.DomainId?(this.x0a.push(ud),ud.DomainBlocked?(Hc=!!ud.DomainId.StringId,f.ULS.sendTraceTag(537166861,0,50,`Domain: ${Hc?ud.DomainId.Id.toString():ud.Name} is telemetry only, do not show in menu (Has String ID: ${Hc})`)):
(this.h1.ga(Wa.dgb(ud.DomainId),ud),ud.Name===jc||268435456===ud.DomainId.Id?this.tBf=ud.DomainId.Id.toString():ud.Name===$c||536870912===ud.DomainId.Id?this.hFf=ud.DomainId.Id.toString():268435712===ud.DomainId.Id&&ud.ShowInRibbon&&(this.Std=!0),Dd=!0)):f.ULS.sendTraceTag(537166862,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.")}Dd||(this.x0a=null);this.w7g();this.Mle.EZi();this.K3g||(this.W8k(),this.K3g=!0)}else this.x0a=null,this.Ew=3,-1<this.fYa&&window.setTimeout(()=>{this.n1b()},
100*(8-this.fYa)),f.ULS.sendTraceTag(537166863,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");this.Uge();this.Gkf();this.Std&&this.Y1f&&fb.f(this.O8f,this.$.Aa,500)};this.CZj=Hc=>{Hc=Gb.a.te(Hc.data);f.ULS.sendTraceTag(34415007,0,15,`OnGetLinkedEntityServiceDomainsFailure [Errors: ${hb.a.pc(Hc)}].`);this.x0a=null;this.Ew=3;this.$pb=!0;this.Uge()};this.onContentReady=()=>{this.j5g()&&this.da.Zz(this.onContentReady);this.TXg&&this.$.workbookContext.Options&1048576&&(this.businessBar.PXk(),
this.TXg=!1)};this.qk=()=>{this.Qpc()};this.h1j=Hc=>{if(fc.a(Hc)){if(Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",!1))void tb.a.resolve(La.BusinessBarManagerService,{xa:0}).then(jc=>{let $c=null;if(null===Hc||void 0===Hc?0:Hc.Errors)$c=Hc.Errors[0];jc.vte($c,null)});else{const jc=Object(nb.d)(tb.a.resolve(La.BusinessBarManagerService,{xa:0}));Sb.TaskExtensions.tb(jc,()=>{let $c=null;if(null===Hc||void 0===Hc?0:Hc.Errors)$c=Hc.Errors[0];jc.result.vte($c,null)},
this.$.Aa,3)}f.ULS.sendTraceTag(537166800,0,15,`ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: ${hb.a.pc(Hc.Errors)}].`);const Dd=hb.a.rO(Hc.Errors,[-1100324317,-2133389873],"ConvertToLinkedEntityManager:OnLinkedEntityTryAutoRefreshSuccessCore");this.$.fa.ur(Dd)}};this.Ltd=()=>{f.ULS.sendTraceTag(537166796,0,50,`ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a ${this.znc} millisecond interval`);
this.hYf("Periodic auto-refresh check",this.WTj,this.VTj)};this.WTj=Hc=>{fc.a(Hc)?(f.ULS.sendTraceTag(537166795,0,15,`ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: ${hb.a.pc(Hc.Errors)}].`),++this.Ird):this.Ird=0;k.a.vb(this.FKa);this.Ird>=this.aNh?(f.ULS.sendTraceTag(537166794,0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh"),
this.FKa=null):(f.ULS.sendTraceTag(537166793,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext"),this.FKa=kc.a.instance.create(this.Ltd,this.znc,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck"))};this.VTj=Hc=>{Hc=Gb.a.te(Hc.data);x.a.Zg(Hc)?f.ULS.sendTraceTag(537166791,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):f.ULS.sendTraceTag(537166792,0,15,`OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: ${hb.a.pc(Hc)}].`);
k.a.vb(this.FKa);this.FKa=kc.a.instance.create(this.Ltd,this.znc,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")};this.o2j=Hc=>{Hc=!!Hc.Result&&Hc.Result;f.ULS.sendTraceTag(537166790,0,50,`OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = ${Hc.toString()}`);Hc?(f.ULS.sendTraceTag(537166789,0,50,`OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = ${na.a.zb.me.m-this.SQd} ms, retry count = ${this.zZb}`),this.n1b()):this.o_c()};this.n2j=()=>{f.ULS.sendTraceTag(537166788,
0,15,"OnNotifyFeatureLicensingStatusFailed");this.o_c()};this.eZj=Hc=>{Hc.Result?(Hc=Hc.Result)?(this.hie(),this.businessBar.vte(null,Hc)):f.ULS.sendTraceTag(537166725,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result"):f.ULS.sendTraceTag(537166726,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result")};this.$=Da;this.businessBar=Zb;this.svgIconProvider=Qa;this.Mc=uc;this.x0a=[];this.DU=[];this.da=Va.f(this.$);this.uCc=-1;this.Ysj=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");
this.Y1f=Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityGalleryTeachUIEnabled",!1);this.h1=new tc.a;this.lob=new kb(Da,ja,this);Ob&&(this.tq=new ia(Da,Ob,Ub,this,this));this.$.Ul(this.de);e.a(this.$)&&e.a(this.$).LIk(this);this.cef();this.$.fa.au(this.fg);Na.EwaSettings.Ra(123)&&Na.EwaSettings.Ra(131)&&(this.j5g()||this.da.aw(this.onContentReady));this.$.DD(this.qk);this.$.fa.Vk(this.yd);this.showUntrustedImageBusinessBarIfNecessary();this.Mle=new Rb(this.$,this)}dispose(){this.$.fa.Bv(this.fg);
this.$.fa.Qk(this.yd);!this.Pqa&&Na.EwaSettings.Ra(123)&&Na.EwaSettings.Ra(131)&&this.da.Zz(this.onContentReady);this.tq&&this.tq.dispose();this.$.vG(this.qk);this.$.tm(this.de);k.a.vb(this.FKa)}IEh(Da){this.addHandler("LinkedEntityConverted",Da)}Btk(Da){this.removeHandler("LinkedEntityConverted",Da)}get Dlk(){return 5}get Irb(){return this.DU}set Irb(Da){this.DU=Da}selectEntity(Da){return this.tq?this.tq.selectEntity(Da):!1}searchEntity(Da,ja){this.tq&&this.tq.searchEntity(Da,ja)}cne(Da,ja,Qa,Ob){this.tq&&
this.tq.searchEntity(Da,ja,!0,Qa,Ob)}ZYb(Da){return this.tq?this.tq.ZYb(Da):!1}onPaneClosed(){if(this.tq)this.tq.onPaneClosed()}cancelSearch(){this.tq&&this.tq.cancelSearch()}n5b(Da){this.tq&&this.tq.n5b(Da)}Rub(Da){this.tq&&this.tq.Rub(Da)}z7b(Da){this.tq&&this.tq.z7b(Da)}WYa(Da,ja){this.tq&&this.tq.WYa(Da,ja)}b$i(Da){if(this.$.isEditMode&&this.GLg!==Da&&d.AFrameworkApplication.ea.ka("SupportsPolicies")){this.GLg=Da;f.ULS.sendTraceTag(537166925,0,50,"HandleRichDataClassificationLabelStateIdChanged - Getting rich data classification labels");
Da=this.$.ma.sa;var ja=this.g_j;const Qa=Da.$a(1,null);A.h(Da,"GetRichDataClassificationLabels",Qa,ja,null,null,null,4)}}Vsf(){this.$.userOperationManager.enqueueOperation(new mb.a(589,0,(Da,ja,Qa)=>{var Ob=this.$.ma.sa;Da=$a.c(Da,this.iXj);const Ub=Ob.$a(1,null);return A.h(Ob,"LinkedEntitiesEnableUntrustedImages",Ub,Da,ja,Qa,null,0)},80),null)}showUntrustedImageBusinessBarIfNecessary(){this.xze||this.J6g||!this.$.fa.yc||this.VFk()}VFk(){this.$.userOperationManager.enqueueOperation(new mb.a(588,0,
(Da,ja,Qa)=>{var Ob=this.$.ma.sa;Da=$a.c(Da,this.tZj);const Ub=Ob.$a(1,null);return A.h(Ob,"GetHasUntrustedImageUrls",Ub,Da,ja,Qa,null,4)},80),null)}get BYb(){return this.$Ea.length}get nLj(){return this.uSe}p4h(Da){(Da=this.sji(Da))?this.convertToLinkedEntity(Da):f.ULS.sendTraceTag(537166920,0,10,"Could not convert key into domain ID")}convertToLinkedEntity(Da){f.ULS.sendTraceTag(34415004,0,50,`ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: ${Da.Id}].`);
if(this.da){var ja=this.da.ha.oa.Ed,Qa=ja.Xe(this.da.uja);this.SUd&&this.aCh(Da);if(Qa){Qa=this.da.Eb.rIa(Qa);if(!this.uSf(Da)&&this.r3f(Da.Id)){f.ULS.sendTraceTag(537166918,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data");if($b.a.Eg.vU){ja=this.eKd();if(!ja){f.ULS.sendTraceTag(537166917,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Qa=this.Frc();if(!Qa){f.ULS.sendTraceTag(537166916,0,50,"RibbonCommandInfo is null for blankCellConvert");
return}var Ob={["InputMethod"]:Ba.a.Hb,CalloutName:3};Ob.Target=ja;Ob.RibbonButtonLabel=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?this.tLg(Da):this.PWb(Da.Id.toString());Ob.ExampleEntities=this.jzf(Da);this.$.Ia.Gb(Qa,Ob);return}f.ULS.sendTraceTag(537166915,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.r3f(Da.Id)&&!Da.StringId)this.launchLinkedEntityDataTypeSelectorPane(Wa.dgb(Da));
else{if(Qa){f.ULS.sendTraceTag(537166914,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range");if(Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LaunchStarterDataForBlankCell",!1)&&this.f2k(Da)){ja=da.u(this.da.ha.oa.selectedRanges,this.$);this.tq.aBj(ja,Da);return}if($b.a.Eg.vU){ja=this.eKd();if(!ja){f.ULS.sendTraceTag(537166913,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Qa=this.Frc();if(!Qa){f.ULS.sendTraceTag(537166912,
0,50,"RibbonCommandInfo is null for blankCellConvert");return}Ob={["InputMethod"]:Ba.a.Hb,CalloutName:2};Ob.Target=ja;Ob.RibbonButtonLabel=this.tLg(Da);Ob.ExampleEntities=this.jzf(Da);Ob.BlankCellResourceId=this.gOh(Da);Ob.HasBlankCellWalkthrough=this.iaj(Da);Ob.ServiceDomain=Da.Id;this.$.Ia.Gb(Qa,Ob);return}f.ULS.sendTraceTag(537166883,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.Wxd(Da,!1,ja)}}}else f.ULS.shipAssertTag(537166919,
0,!1,"grid view should not be null")}convertToLinkedEntityFromAutoDetect(){this.Pqa&&this.Pqa.sUa()}onAutoDetectUIShown(){sa.a(this.$.userOperationManager,(Da,ja,Qa)=>{var Ob=this.$.ma.sa;const Ub=Ob.$a(1,null);return A.h(Ob,"OnAutoDetectUIShown",Ub,Da,ja,Qa,null,4)},Da=>new mb.a(230,0,Da,80),null)}Wxd(Da,ja,Qa){const Ob=da.t(Qa,this.$),Ub=()=>new Ka.a;sa.a(this.$.userOperationManager,(Zb,uc,Hc)=>{var Dd=this.$.ma.sa;Zb=$a.c(Zb,this.RVj,this.V5j,this.tq.QVj);const jc=Dd.$a(1,null);jc.selectedRanges=
Ob;jc.domainId=Da;jc.autodetect=ja;return A.h(Dd,"ConvertToLinkedEntity",jc,Zb,uc,Hc,null,4)},Zb=>new mb.a(115,0,Zb,void 0,Ub),null)}aCh(Da){if(this.SUd){var ja={};ja.Id=Da.Id;Da.StringId&&(ja.StringId=Da.StringId);if(!(0<this.DU.length&&this.DU[0].Id===ja.Id&&this.DU[0].StringId===ja.StringId)){Da=!1;this.DU.splice(0,0,ja);for(let Qa=1;Qa<this.DU.length;++Qa)if(this.DU[Qa].Id===ja.Id&&this.DU[Qa].StringId===ja.StringId){this.DU.splice(Qa,1);Da=!0;break}for(;5<this.DU.length;)this.DU.pop();this.Mva.Categories[Wa.tnb].DomainIds=
this.DU;this.fKg();Da||this.Mle.qbh(this.DU)}}}convertLinkedEntityToText(){f.ULS.sendTraceTag(34719501,0,50,"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted");if(this.da){var Da=da.t(this.da.ha.oa.Ed,this.$);sa.a(this.$.userOperationManager,(ja,Qa,Ob)=>{var Ub=this.$.ma.sa;const Zb=Ub.$a(1,null);Zb.selectedRanges=Da;return A.h(Ub,"ConvertLinkedEntityToText",Zb,ja,Qa,Ob,null,4)},ja=>new mb.a(116,0,ja),null)}else f.ULS.shipAssertTag(537166879,0,!1,"grid view should not be null")}refreshLinkedEntitiesInRange(){f.ULS.sendTraceTag(537166878,
0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange() - refresh attempted");if(Va.f(this.$)){this.$.isEditMode||f.ULS.sendTraceTag(537166876,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange(): Refreshing selection during view mode");this.hie();var Da=da.u(this.da.ha.oa.selectedRanges,this.$);sa.a(this.$.userOperationManager,(ja,Qa,Ob)=>{var Ub=this.$.ma.sa;const Zb=Ub.$a(1,null);Zb.selectedRanges=Da;return A.h(Ub,"RefreshLinkedEntitiesInRange",Zb,ja,Qa,Ob,null,4)},ja=>new mb.a(248,
0,ja),null)}else f.ULS.shipAssertTag(537166877,0,!1,"grid view should not be null")}dTk(Da){Da=this.i1(Da.DomainId);if(!Da||Da.DomainBlocked||!Da.HasCuratedData)return!1;if(this.Ysj){for(const ja of this.h1)if(ja.value.DomainId.Id===Da.DomainId.Id&&ja.value.ShowInRibbon)return!0;return!1}return Da.ShowInRibbon}wRk(Da){return 2!==this.Ew||!this.$Ea[Da]}launchDisambiguationPaneForSearch(){this.tq&&this.tq.launchDisambiguationPaneForSearch()}td(Da,ja,Qa){if("PopulateConvertToLinkedEntityMenu"!==ja)return!1;
this.OId=Qa.MenuId;if(0===this.Ew||3===this.Ew)return this.nck(),!0;if(!this.Mva)return f.ULS.sendTraceTag(537166873,0,10,"PopulateMenu: Encountered null ribbon section info"),!1;if(!this.h1)return f.ULS.sendTraceTag(537166872,0,10,"PopulateMenu: Encountered null domain collection"),!1;this.QM=this.QM||this.lob.fHi(this.Mva,Qa.MenuId);Qa.MenuItems=this.QM;return this.SUd=!0}nck(){-1===this.uCc&&(this.n1b(),this.uCc=window.setInterval(()=>{this.n1b()},2E3))}n1b(){if(this.$.fa.yc&&2!==this.Ew){this.fYa--;
f.ULS.sendTraceTag(537166870,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted.");this.Ew=1;var Da=this.$.ma.sa,ja=this.DZj,Qa=this.CZj;const Ob=Da.$a(1,null);A.h(Da,"GetLinkedEntityMetadata",Ob,ja,Qa,null,null,4)}}XVd(){return this.$.isEditMode&&2!==this.Ew&&(0<=this.fYa||!this.$pb)}kAe(Da){d.AFrameworkApplication.Sf?f.ULS.sendTraceTag(537166869,0,50,"UpdatePreviewGalleryVisibility bailed out on shutting down."):e.a(this.$)?(this.Odl(),Da&&this.$.Sg()):f.ULS.sendTraceTag(537166868,
0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.")}xyk(){this.zZb=0;this.fYa=8;this.$pb=!1;this.Ew=this.uCc=0;this.x0a=this.Mva=null;this.Qpc();for(let Da=0;Da<this.BYb;++Da)this.$Ea[Da]=null;this.dUb()&&this.kAe(!0)}Qpc(){this.QM=null}dUb(){const Da=t.a.Drb,ja=e.a(this.$);return!!ja&&ja.um.Tw===Da}w7g(){if(this.Mva){let Qa=0;var Da=-1,ja=-1;let Ob=0,Ub=0,Zb=0,uc=0;const Hc=[null,null,null,null,null];for(const Dd of this.Mva.Categories){let jc=!1;for(const $c of Dd.DomainIds){const ud=
this.i1($c);ud&&!ud.DomainBlocked&&ud.ShowInRibbon&&(Qa<this.BYb?(this.$Ea[Qa]=$c,Ub===Wa.tnb&&(-1===Da&&(Da=Qa),ja=Qa,uc=ja-Da+1),++Qa):Qa===this.BYb&&Ob<uc&&Ub!==Wa.tnb&&(Hc[Ob]=$c,++Ob),jc=!0)}jc&&++Zb;++Ub}if(-1<Da&&Zb<=Wa.u9f){for(;ja>=Da;--ja)this.$Ea.splice(ja,1);for(Da=0;Da<uc;++Da)this.$Ea.splice(Qa+Da,0,Hc[Da])}for(;Qa<this.BYb;)this.$Ea[Qa]=null,++Qa}}j5g(){const Da=Va.f(this.$).za,ja=this.da.ha.gf;if(Da&&Da.WQd&&1===ja&&this.da.ha.oa.activeCell){if(Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",
!1))void tb.a.resolve(La.SharedUIControlsFactoryService,{xa:1}).then(Qa=>{this.Pqa=new w.a(this.$,this.svgIconProvider,Qa,this,this.Mc)});else{const Qa=Object(nb.d)(tb.a.resolve(La.SharedUIControlsFactoryService,{xa:1}));Sb.TaskExtensions.tb(Qa,()=>{this.Pqa=new w.a(this.$,this.svgIconProvider,Qa.result,this,this.Mc)},this.$.Aa,3)}return!0}return!1}dBj(){this.tq&&this.tq.G1d(!0)}launchLinkedEntityDataTypeSelectorPane(Da){if(this.tq)if(Da=this.yCd(Da))if(Da.DomainId.StringId)f.ULS.sendTraceTag(537166855,
0,10,"Domain with a string ID used when launching Data Type Selector pane");else{var ja=da.u(this.da.ha.oa.selectedRanges,this.$);this.tq.launchLinkedEntityDataTypeSelectorPane(ja,Da.DomainId.Id)}else f.ULS.sendTraceTag(537166856,0,10,"Unknown domain used when launching Data Type Selector pane")}y2h(Da){const ja=this.Ydj(Da),Qa=h.a.$l(this.PWb(Da));Da=h.a.$l(this.Hxe(Da));return Wa.MGi(ja,Ga.a.Lh(11),Qa,Da)}Hxe(Da){try{return this.Kqf(parseInt(Da,10)).Description}catch(ja){}return za.a.instance.ia(1797)}PWb(Da){try{return this.Kqf(parseInt(Da,
10)).Name}catch(ja){}return za.a.instance.ia(1783)}tLg(Da){try{return this.i1(Da).Name}catch(ja){}return this.PWb(Da.Id.toString())}gOh(Da){try{return this.i1(Da).BlankCellResourceId}catch(ja){}return null}iaj(Da){try{return this.i1(Da).HasBlankCellWalkthrough}catch(ja){}return!1}uSf(Da){try{const ja=Wa.dgb(Da);if(this.h1.Bb(ja))return this.h1.pa(ja).HasCuratedData}catch(ja){}return!1}f2k(Da){try{return this.i1(Da).SupportsStarterData}catch(ja){}return!1}r3f(Da){return 268435968===Da}eKd(){return 2===
e.a(this.$).FZ?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]"}Frc(){return new Ma.a(-847286761,Ba.a.Hb,this.$.xc,0,t.a.s9)}Gkf(){if(this.dUb()&&!this.XVd()&&!this.q0f&&Na.EwaSettings.Ra(387)&&this.uSf({Id:268435968,StringId:null}))if(f.ULS.sendTraceTag(537166819,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - tried to launch first org data teaching callout"),$b.a.Eg.vU){const Qa=this.eKd();if(Qa){var Da=this.Frc();if(Da){var ja={["InputMethod"]:Ba.a.Hb,
CalloutName:6};ja.Target=Qa;ja.ShouldCanvasTakeFocus=!0;this.$.Ia.Gb(Da,ja);this.q0f=!0}else f.ULS.sendTraceTag(537166817,0,10,"RibbonCommandInfo is null for firstOrgData")}else f.ULS.sendTraceTag(537166818,0,10,"CalloutAnchorElement is null for firstOrgData")}else f.ULS.sendTraceTag(537166816,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - Attempted to launch firstOrgData callout, teaching callout not enabled")}Ddj(Da){Da=this.yCd(Da);return Da?this.lob.PMh(Da.SubdomainFontLocator):
(f.ULS.sendTraceTag(537166815,0,10,"ConvertToLinkedEntityManager.IconFromDomainFontLocator: Requested domain that doesn't exist in collection"),null)}aFc(Da){return this.Pqa?this.Pqa.OMh(Da):!1}eKi(){return this.Pqa?this.Pqa.cLi():""}BPi(Da,ja){const Qa=this.VVf(Da);if(0>Qa)f.ULS.sendTraceTag(537166813,0,10,`Unexpected menuItemKey for dynamic preview gallery button: ${Da}`);else if(Da=(Da=this.Lqf(Da))?this.i1(Da):null)ja[n.a.GalleryButtonProps]=this.lob.HHi(Qa,Da),ja[n.a.Alt]=this.lob.RKd(Da)}fKg(){this.w7g();
this.dUb()&&this.kAe(!0);this.Qpc()}Ydj(Da){return Da===this.tBf?l.a.Vxf:Da===this.hFf?l.a.Txf:l.a.Sxf}jzf(Da){try{return this.i1(Da).ExampleEntities}catch(ja){}return za.a.instance.ia(1805)}Uge(){(0>this.fYa||this.$pb)&&f.ULS.sendTraceTag(537166811,0,15,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(2===this.Ew||0>this.fYa||this.$pb)&&window.clearInterval(this.uCc);this.XVd()?this.OId&&this.$.frame.Kv(this.OId):this.kAe(this.dUb())}qc(Da){return this.$.Oc+Da}Odl(){var Da=
!0;const ja=Array(this.BYb),Qa=e.a(this.$)?e.a(this.$).um:null;if(Qa){for(let Ob=0;Ob<ja.length;++Ob)this.wRk(Ob)?ja[Ob]=!0:Da=ja[Ob]=!1;Qa.sSg(["ConvertToLinkedEntityGallery"],Da);if(!Da)for(Da=0;Da<ja.length;++Da)ja[Da]&&Qa.sSg([this.APi(Da)],!0)}else f.ULS.sendTraceTag(537166809,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null")}i1(Da){const ja=Wa.dgb(Da);if(this.h1.Bb(ja))return this.h1.pa(ja);f.ULS.sendTraceTag(592729218,0,15,`No domain data for domain ID ${Da.Id} (Has String ID: ${!!Da.StringId})`);
return null}APi(Da){return"ConvertToLinkedEntityPreview"+Da.toString()}bAe(){m.a.get_instance().Mg(10,()=>{this.Gkf();this.Std&&this.Y1f&&fb.f(this.O8f,this.$.Aa,500)})}jCc(Da,ja){switch(Da){case "QueryLinkedEntityGalleryButtons":if(!ja[n.a.InnerHTML]){Da=ja[Ba.a.Wc].toString();const Qa=Cc.a.equals(Da,za.a.instance.ia(1800),!0)||Cc.a.equals(Da,za.a.instance.ia(1801),!0),Ob=Cc.a.equals(Da,za.a.instance.ia(1802),!0);Qa||Ob||this.BPi(Da,ja)}break;case "QueryLinkedEntityMenuGalleryButtons":ja[n.a.InnerHTML]||
(ja[n.a.InnerHTML]=this.y2h(ja[Ba.a.Wc]))}return ja}sji(Da){var ja=this.Lqf(Da);if(ja)return ja;if(ja=this.yCd(Da))return ja.DomainId;f.ULS.sendTraceTag(537166805,0,10,`Could not convert key into domain: ${Da}`);return null}Kqf(Da){const ja={};ja.Id=Da;return this.i1(ja)}yCd(Da){return this.h1.Bb(Da)?this.h1.pa(Da):null}VVf(Da){if(!Da.startsWith(Wa.UCd))return-1;const ja=parseInt(Da.substr(Wa.UCd.length),10);return isNaN(ja)?(f.ULS.sendTraceTag(537166802,0,10,`Unexpected index in preview gallery button key: ${Da}`),
-1):ja}Lqf(Da){Da=this.VVf(Da);return 0>Da?null:this.$Ea[Da]}hYf(Da,ja,Qa){if(this.h1&&this.h1.count){f.ULS.sendTraceTag(537166801,0,50,`ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. (${Da})`);var Ob=this.$.ma.sa.mc();this.$.fa.yc&&(Da=this.$.ma.sa,ja=$a.c(this.h1j,ja),Ob=Da.$a(1,void 0===Ob?null:Ob),A.h(Da,"LinkedEntityTryAutoRefresh",Ob,ja,Qa,null,null,0))}}W8k(){this.hYf("Auto-refresh on load",null,null)}$8k(){this.h1&&this.h1.count&&(this.FKa?f.ULS.sendTraceTag(537166799,0,50,
"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one"):this.$.fa.el.HasAutoRefreshableLinkedEntityDomainsEver?(f.ULS.sendTraceTag(537166797,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context"),this.FKa=kc.a.instance.create(this.Ltd,this.znc,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")):
f.ULS.sendTraceTag(537166798,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created"))}o_c(){if(this.$.fa.yc&&null!=this.AHc&&null!=this.uYd&&null!=this.vYd&&null!=this.U_d&&null!=this.QZd)if(++this.zZb,12>=this.zZb){1===this.zZb&&(this.SQd=na.a.zb.me.m,f.ULS.sendTraceTag(537166752,0,50,"StartLinkedEntityDelayedHandshake - starting handshake."));const Da=this.$.ma.sa.mc();
Yb.A(this.$.ma.sa,this.uCj,this.vCj(),this.o2j,this.n2j,null,Da)}else f.ULS.sendTraceTag(537166751,0,15,`StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration ${na.a.zb.me.m-this.SQd} ms`),this.$pb=!0,this.Uge()}cef(){if(this.$.isEditMode)if(null!=this.AHc)this.o_c();else{var Da=na.a.zb.me.m,ja=[];Object(c.d)(b.a).execute(Qa=>{Qa.isFeatureEnabled("ExcelPowerBiPro",!1).then(Ob=>{f.ULS.sendTraceTag(537166747,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPro"} takes ${na.a.zb.me.m-
Da} Millisecond.`);f.ULS.sendTraceTag(537166746,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPro"}] isEnabled=[${Ob}]`);return this.AHc=Ob}).then(()=>{ja.push(Qa.isFeatureEnabled("ExcelWolframAlpha",!1).then(Ob=>{f.ULS.sendTraceTag(590960588,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelWolframAlpha"} takes ${na.a.zb.me.m-Da} Millisecond.`);f.ULS.sendTraceTag(537166743,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelWolframAlpha"}] isEnabled=[${Ob}]`);
return this.U_d=Ob}))}).then(()=>{ja.push(Qa.isFeatureEnabled("ExcelDisableStockGeographyDataTypes",!1).then(Ob=>{f.ULS.sendTraceTag(537166741,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelDisableStockGeographyDataTypes"} takes ${na.a.zb.me.m-Da} Millisecond.`);f.ULS.sendTraceTag(537166740,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelDisableStockGeographyDataTypes"}] isEnabled=[${Ob}]`);Mb.a("SatoriStockGeographyLicensingRestrictions",void 0,void 0,[{name:"IsRestrictedByLicense",
bool:Ob}]);this.g5f=Ob&&Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StockGeographyLicensingCheck",!1);return Ob}))}).then(()=>{ja.push(Qa.isFeatureEnabled("StockHistory",!1).then(Ob=>{f.ULS.sendTraceTag(537166739,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"StockHistory"} takes ${na.a.zb.me.m-Da} Millisecond.`);f.ULS.sendTraceTag(537166738,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"StockHistory"}] isEnabled=[${Ob}]`);return this.QZd=Ob}))}).then(()=>
{ja.push(Qa.isFeatureEnabled("ExcelPowerBiFree",!1).then(Ob=>{f.ULS.sendTraceTag(537166736,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiFree"} takes ${na.a.zb.me.m-Da} Millisecond.`);f.ULS.sendTraceTag(537166735,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiFree"}] isEnabled=[${Ob}]`);return this.uYd=Ob}))}).then(()=>{ja.push(Qa.isFeatureEnabled("ExcelPowerBiPremiumPerUser",!1).then(Ob=>{f.ULS.sendTraceTag(537166734,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPremiumPerUser"} takes ${na.a.zb.me.m-
Da} Millisecond.`);f.ULS.sendTraceTag(537166733,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPremiumPerUser"}] isEnabled=[${Ob}]`);return this.vYd=Ob}))}).then(()=>{Promise.all(ja).then(()=>{this.o_c()})})})}}get uCj(){return"ExcelPowerBiPro ExcelWolframAlpha StockHistory ExcelPowerBiFree ExcelPowerBiPremiumPerUser ExcelDisableStockGeographyDataTypes".split(" ")}vCj(){return[this.AHc,this.U_d,this.QZd,this.uYd,this.vYd,this.g5f]}hie(){this.businessBar&&this.businessBar.w2(58)&&
this.businessBar.removeEntry(58)}L8i(Da){if(this.h2d!==Da&&this.businessBar)if(this.h2d=Da){Da=this.$.ma.sa;var ja=this.eZj;const Qa=Da.$a(1,null);A.h(Da,"GetErrorMessageForLinkedDataTypeRefresh",Qa,ja,null,null,null,4)}else this.hie()}static MGi(Da,ja,Qa,Ob){Da=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"></span>',Da,ja,Ob);Qa=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}</p></div>',
Qa);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}</div>',Da,Qa)}static dgb(Da){return Da.StringId?Da.Id.toString()+"."+Da.StringId:Da.Id.toString()}};Fa.wrf="ConvertToLinkedEntityPreview";Fa.UCd="PreviewGalleryButtonIndex.";Fa.tnb=0;Fa.u9f=2;Fa=Wa=Object(y.__decorate)([Object(tb.d)(La.ConvertToLinkedEntityManagerService),Object(y.__param)(0,Object(La.EwaControlService)()),Object(y.__param)(1,Object(La.RibbonControlsService)()),Object(y.__param)(2,Object(wb.h)()),
Object(y.__param)(3,Object(La.EnrichmentTaskPaneService)()),Object(y.__param)(4,Object(La.ReactTaskPaneManagerService)()),Object(y.__param)(5,Object(La.BusinessBarManagerService)()),Object(y.__param)(6,Object(La.HtmlSanitizationHelperService)())],Fa);Object(r.a)(Fa,"ConvertToLinkedEntityManager",u.a,[564,565,4,566])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.pi.js.map/161b7afd202c85377cd359a0eb90faed/EwaTS.pi.js.map