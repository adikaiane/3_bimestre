'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[16],{442:function(y,r,a){a.r(r);var c={};a.r(c);a.d(c,"EwaNotificationFocusManager",function(){return G});var b={};a.r(b);a.d(b,"RemediationArea",function(){return Ia});a.d(b,"FileOptimizationManager",function(){return Sa});var f={};a.r(f);a.d(f,"FormulaRemediationManager",function(){return Ka});var k={};a.r(k);a.d(k,"OptimizeWorkbookManager",function(){return ta});var x={};a.r(x);a.d(x,"ShowCalloutCommandHandler",
function(){return Xb});var d={};a.r(d);a.d(d,"TableIntelligenceDarkActivationManager",function(){return dc});var h={};a.r(h);a.d(h,"TableIntelligenceManager",function(){return Vf});var n=a(133),m=a(0),u=a(2),l=a(15),t=a(306),e=a(282),w=a(104),z=a(1336),E=a(65),M=a(5);let G=class{constructor(sb){this.Asd=this.QHd=null;this.o8c=this.isFocused=!1;this.$=sb}dispose(){}get ud(){return null}get ij(){return this.o8c}get tf(){return e.a.F7d}Nj(sb,Gc){Gc||this.isFocused||!this.QHd||this.QHd();return!Gc}zk(sb){return sb===
document.activeElement&&this.isFocused}Hm(){this.isFocused=!0}fo(){this.isFocused&&this.Asd&&(this.Asd(),this.isFocused=!1)}XWf(){l.ULS.shipAssertTag(537169939,0,w.b("initializeNotificationFocusManagement"),"EwaNotificationFocusManager.InitializeFocusActions: initializeNotificationFocusManagement Api doesnt exist in AppChrome");const sb=Object(u.a)(new z.a,{onFirstActionableAppear:()=>{t.a(this.$).hl(this);this.o8c=!0},onLastActionableDisappear:()=>{t.a(this.$).XC(this);this.o8c=!1},onFocus:()=>{this.isFocused=
!0},onBlur:()=>{this.isFocused=!1}});appChrome.initializeNotificationFocusManagement(sb).then(Gc=>{this.QHd=()=>{Gc.focus()};this.Asd=()=>{Gc.blur()};return null})}};G=Object(n.__decorate)([Object(E.d)(M.EwaNotificationFocusManagerService),Object(n.__param)(0,Object(M.EwaControlService)())],G);Object(m.a)(G,"EwaNotificationFocusManager",null,[223,4,24]);var A=a(93),N=a(431),K;(function(sb){sb[sb.Consent=0]="Consent";sb[sb.IndeterminateProgress=1]="IndeterminateProgress";sb[sb.DeterminateProgress=
2]="DeterminateProgress";sb[sb.Error=3]="Error";sb[sb.Completed=4]="Completed"})(K||(K={}));var I=a(92);class L extends N.a{constructor(sb,Gc){super(sb);Gc.initializeCallbacks=this.initializeCallbacks.bind(this);sb=Object.assign({},{[L.Xs]:this.Tc,["hideCloseButton"]:!0},Gc,{dialogDescription:I.a.Dg(Gc.initialDialogDescription),dialogTitle:I.a.Dg(Gc.initialDialogTitle)});this.Zf=Gc.initialDialogState;this.initializeAndShow("",this.BLb,sb);this.l9g()}get Tc(){return"UserConsentBasedProgressDialog"}hide(sb){sb&&
super.hide()}dispose(){super.dispose();window.onbeforeunload=null}ahj(sb,Gc){this.rug=sb;this.qug=Gc}Dwb(sb){this.Zf=sb.dialogState;this.tcl(this.jdi(sb));this.l9g()}jdi(sb){sb.dialogDescription&&(sb.dialogDescription=I.a.Dg(sb.dialogDescription));sb.dialogTitle&&(sb.dialogTitle=I.a.Dg(sb.dialogTitle));return sb}initializeCallbacks(sb){this.tcl=sb}l9g(){window.onbeforeunload=this.Zf===K.DeterminateProgress||this.Zf===K.IndeterminateProgress?sb=>{sb.preventDefault();return sb.returnValue=!0}:null}BLb(sb){1===
sb?(this.Zf===K.Consent&&this.rug&&this.rug(),this.Zf===K.Error&&this.hide(!0)):2!==sb&&0!==sb||this.Zf!==K.Consent||(this.hide(!0),this.qug&&this.qug(),this.dispose())}}Object(m.a)(L,"UserConsentBasedProgressDialog",N.a,[]);var J=a(13),B=a(190),Y=a(70),U=a(7),O=a(179),C=a(1483),X;(function(sb){sb[sb.OptimizationConsent=0]="OptimizationConsent";sb[sb.OptimizationSummary=1]="OptimizationSummary"})(X||(X={}));var S=a(29);class ea{constructor(){this.closeTaskPane=()=>{S.a.Fj()?void E.a.resolve(M.ReactTaskPaneManagerService,
{xa:0}).then(sb=>{sb.hideTaskPane("WorkbookOptimizationTaskPane")}):void O.a.li().then(sb=>{sb.hideTaskPane("WorkbookOptimizationTaskPane",2)})};this.hk=!1}nte(sb,Gc){S.a.Fj()?void E.a.resolve(M.ReactTaskPaneManagerService,{xa:0}).then(ad=>{this.hk?(ad.updateTaskPane("WorkbookOptimizationTaskPane",this.ifb(X.OptimizationSummary,Gc,sb)),ad.focusTabbedTaskPaneArea(2)):ad.PC("WorkbookOptimizationTaskPane",this.ifb(X.OptimizationSummary,Gc,sb))}):void O.a.li().then(ad=>{if(this.hk)ad.updateTaskPane("WorkbookOptimizationTaskPane",
this.ifb(X.OptimizationSummary,Gc,sb)),ad.focusTabbedTaskPaneArea(2);else return ad.showTaskPane("WorkbookOptimizationTaskPane",this.ifb(X.OptimizationSummary,Gc,sb)),null})}oWk(sb){S.a.Fj()?void E.a.resolve(M.ReactTaskPaneManagerService,{xa:0}).then(Gc=>{Gc.PC("WorkbookOptimizationTaskPane",this.ifb(X.OptimizationConsent,void 0,sb))}):void O.a.li().then(Gc=>{Gc.showTaskPane("WorkbookOptimizationTaskPane",this.ifb(X.OptimizationConsent,void 0,sb));return null})}l3(){this.hk=!0}zt(){this.hk=!1}ifb(sb,
Gc,ad){sb={type:"WorkbookOptimizationTaskPaneProps",taskPaneState:sb,summariesList:Gc,hostAppCallbacks:ad};return Object(u.a)(new C.a,{contentProps:sb,onOpen:()=>{this.l3()},onClose:()=>{this.zt()},width:320,title:J.a.instance.ia(2563)})}}Object(m.a)(ea,"WorkbookOptimizationTaskPaneController",null,[830]);var Oa=a(1);class Ha extends A.a{constructor(sb){super();this.d8j=Gc=>{this.$.Dc(802602464,Y.a.Hb,12,{[U.a.MF]:"WorkbookOptimizationTaskPane",tsl:Gc})};this.C8j=()=>{this.$.Dc(-1112508866,Y.a.Hb,
12,{})};this.onLearnMoreLinkClick=()=>{l.ULS.sendTraceTag(507353219,0,50,"FileOptimizationUIController.onLearnMoreLinkClick: learn more link clicked")};this.$=sb}dispose(){var sb;this.Yld=this.$=null;null===(sb=this.x$)||void 0===sb?void 0:sb.dispose();this.x$=null;super.dispose()}dfj(sb,Gc,ad){switch(sb){case "NotStarted":this.$Mi(Gc,ad);break;case "Skipped":this.aNi(Gc,ad)}}fXg(){this.iUk()}tZc(sb){switch(sb){case "NotStarted":case "Skipped":case "Automatic":this.hUk()}}pWk(sb){this.jUk(sb)}Sel(sb){switch(sb){case "Formulas":sb=
{dialogState:K.IndeterminateProgress,progressDescription:J.a.instance.ia(2596)};break;default:sb={dialogState:K.IndeterminateProgress,progressDescription:J.a.instance.ia(2598)}}this.x$.Dwb(sb)}iUk(){this.x$?this.Dwb(K.IndeterminateProgress):this.gXf(!1)}hUk(){var sb,Gc;(null===(Gc=null===(sb=this.x$)||void 0===sb?void 0:sb.Mb)||void 0===Gc?0:Gc.rda)&&this.Dwb(K.Error)}jUk(sb){this.Dwb(K.Completed);const Gc=Oa.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.UCBPDialogCompletedStateTimeoutMs",
2E3);setTimeout(()=>{this.x$.hide(!0);this.x$.dispose();this.x$=null;this.nte(sb)},Gc)}$Mi(sb,Gc){this.gXf(!0);this.x$.ahj(sb,()=>{this.x$=null;this.HUk(sb,Gc)})}aNi(sb,Gc){this.yCe.oWk({onOptimizeNowClick:sb,onDontShowAgainClick:()=>{this.yCe.closeTaskPane();Gc()},onLearnMoreLinkClick:this.onLearnMoreLinkClick})}gXf(sb){this.x$||(sb=this.ROi(sb),this.x$=new L(this.$,sb))}get yCe(){this.Yld||(this.Yld=new ea);return this.Yld}HUk(sb,Gc){l.ULS.sendTraceTag(507363655,0,50,"FileOptimizationUIController.showConfirmationDialog: User denied consent in optmization dialog.");
var ad=J.a.instance.ia(2590),Wd=J.a.instance.ia(2591),je=J.a.instance.ia(2592),Ie=J.a.instance.ia(2593);const Je=new B.a;Je.hc=1;Je.Ic(1,je);Je.Ic(0,Ie);Je.Ni(ad,Wd,0,$e=>{1===$e?sb():Gc()})}ROi(sb){return sb?{initialDialogState:K.Consent,initialDialogTitle:J.a.instance.ia(2580),initialDialogDescription:J.a.instance.ia(2581),okButtonLabel:J.a.instance.ia(2582),cancelButtonLabel:J.a.instance.ia(2583),knowMoreLinkLabel:J.a.instance.ia(2584)}:{initialDialogState:K.IndeterminateProgress,initialDialogTitle:J.a.instance.ia(2585),
initialDialogDescription:J.a.instance.ia(2586),knowMoreLinkLabel:J.a.instance.ia(2584),progressDescription:J.a.instance.ia(2597)}}Dwb(sb){let Gc;switch(sb){case K.IndeterminateProgress:Gc={dialogState:K.IndeterminateProgress,dialogTitle:J.a.instance.ia(2585),dialogDescription:J.a.instance.ia(2586),progressDescription:J.a.instance.ia(2597)};break;case K.Error:Gc={dialogState:K.Error,dialogTitle:J.a.instance.ia(2587),dialogDescription:J.a.instance.ia(2588),okButtonLabel:J.a.instance.ia(2589),progressDescription:J.a.instance.ia(2594)};
break;case K.Completed:Gc={dialogState:K.Completed,progressDescription:J.a.instance.ia(2595)}}this.x$.Dwb(Gc)}nte(sb){this.yCe.nte({openFeedback:this.d8j,onRevertLinkClick:this.C8j},sb)}}Object(m.a)(Ha,"FileOptimizationUIController",A.a,[]);const Za={$fa:"NotStarted",J5c:["Formulas"]},fa={$fa:"Automatic"};var la=a(124),ba=a(36),aa=a(711),oa=a(679),Na=a(197),Ia;(Ia||(Ia={})).Formulas="Formulas";Object(m.b)("RemediationArea",Ia);let Sa=class extends A.a{constructor(sb,Gc){super();this.$=sb;this.MDf=
Gc;this.hZd=!0;this.U2b=new Map;this.MZj=ad=>{(this.oea=ad.Result)?this.Mil(this.oea.J5c)?(l.ULS.sendTraceTag(507363658,0,50,`FileOptimizationManager.onGetOptimizationMetadataSuccess: OptimizationStage: ${this.oea.$fa}.
       RemediationArea: ${this.oea.J5c}.`),this.eAg(this.oea.$fa)):"OptimizationNotRequired"!==this.oea.$fa&&"Completed"!==this.oea.$fa&&this.m3c(this.oea.$fa,"Completed"):l.ULS.sendTraceTag(507363660,0,10,"FileOptimizationManager.onGetOptimizationMetadataSuccess: optimizationMetadata is null. Exiting optimization flow.")};this.m3c=(ad,Wd)=>{ad!==Wd&&(fa.$fa=Wd,this.wPg(je=>{var Ie;je=null===(Ie=je.Result)||void 0===Ie?void 0:Ie.$fa;ad===je?(l.ULS.sendTraceTag(507330767,0,10,"FileOptimizationManager.onUpdateOptimizationStageSuccess: optimizationStage not updated."),
this.Osa.tZc(ad)):(this.oea.$fa=je,this.eAg(this.oea.$fa))},fa,je=>{je=(null===je||void 0===je?0:je.data)?la.a.te(je.data):null;l.ULS.sendTraceTag(507332164,0,10,`FileOptimizationManager.onUpdateOptimizationStageFailure: ${ba.a.pc(je)}`);this.Osa.tZc(ad)},ad))};this.wfh=()=>new Promise(async(ad,Wd)=>{this.hZd=!1;this.m2k();const je=this.$.fa.workbookContext.CalcMode;0===je?ad():(this.Ftd=je,this.setCalculationMode(0).then(ad,Wd))});this.vKg=()=>new Promise(async(ad,Wd)=>{this.hZd=!0;this.fAk();this.Ftd&&
(this.setCalculationMode(this.Ftd).then(ad,Wd),this.Ftd=null);ad()});this.setCalculationMode=ad=>new Promise(async(Wd,je)=>{const Ie=this.$.Dc(-988468372,Y.a.Hb,8,{[Y.a.Wc]:ad});Ie?Ie.continueWith(Je=>{!Na.a(Je)&&Je.result?Wd():je(Error("Failed to set calculation mode."))}):Wd()});this.initialize()}dispose(){var sb;void this.vKg();null===(sb=this.iAb)||void 0===sb?void 0:sb.dispose();this.$=this.MDf=this.iAb=null;super.dispose()}get Osa(){this.iAb||(this.iAb=new Ha(this.$));return this.iAb}initialize(){const sb=
!this.$.fa.WW&&!Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FOMMockAmIAlone",!1),Gc=this.$.isEditMode;sb||!Gc?l.ULS.sendTraceTag(507363661,0,50,`FileOptimizationManager.initialize: Exiting optimization flow. areCoauthorsPresent: ${sb}, isEditMode: ${Gc}`):this.ZWi()}ZWi(){this.wPg(this.MZj,Za)}eAg(sb){switch(sb){case "NotStarted":case "Skipped":this.k4i(sb);break;case "Automatic":void this.ljj()}}k4i(sb){this.Osa.dfj(sb,()=>{l.ULS.sendTraceTag(507363656,0,50,"FileOptimizationManager.OnUserConsentGiven: User provided consent.");
this.Osa.fXg();this.m3c(sb,"Automatic")},()=>{l.ULS.sendTraceTag(507363657,0,50,`FileOptimizationManager.OnUserConsentDenied: User denied consent in the OptimizationStage: ${sb}.`);let Gc;switch(sb){case "Skipped":Gc="OptimizationNotRequired";break;default:Gc="Skipped"}this.m3c(sb,Gc)})}async ljj(){var sb;try{this.iAb||this.Osa.fXg();await this.wfh();for(const Gc of this.oea.J5c){if(2===(null===(sb=this.U2b.get(Gc))||void 0===sb?void 0:sb.status))continue;const ad=await this.RZi(Gc);if(ad)try{this.Osa.Sel(Gc);
const Wd=await ad.Lpk();this.U2b.set(Gc,Wd)}catch(Wd){l.ULS.sendTraceTag(507332163,0,10,`FileOptimizationManager.initiateAutomaticOptimization: ${null===Wd||void 0===Wd?void 0:Wd.message}`),this.U2b.set(Gc,{status:3,Kve:null})}}if(this.kqj()){const Gc=this.UZi();this.Osa.pWk(Gc);this.m3c("Automatic","Completed")}else this.Osa.tZc("Automatic")}catch(Gc){l.ULS.sendTraceTag(507332162,0,10,`FileOptimizationManager.initiateAutomaticOptimization: ${null===Gc||void 0===Gc?void 0:Gc.message}`),this.Osa.tZc("Automatic")}finally{await this.vKg()}}async RZi(sb){switch(sb){case Ia.Formulas:return Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaRemediation",
!1)?await this.MDf(0):null;default:return null}}Mil(sb){if(!sb||0===sb.length)return l.ULS.sendTraceTag(507360341,0,50,"FileOptimizationManager.validateRemediationArea: No remediation area."),!1;for(const Gc of sb)if(void 0!==Ia[Gc])return!0;return!1}kqj(){return Array.from(this.U2b.values()).every(sb=>2===(null===sb||void 0===sb?void 0:sb.status)||1===(null===sb||void 0===sb?void 0:sb.status))}UZi(){return Array.from(this.U2b.values()).filter(sb=>null===sb||void 0===sb?void 0:sb.Kve).map(sb=>null===
sb||void 0===sb?void 0:sb.Kve)}m2k(){this.Oxa=new aa.a(this.$,oa.a.eAi,()=>this.hZd,2)}fAk(){var sb;null===(sb=this.Oxa)||void 0===sb?void 0:sb.dispose();this.Oxa=null}wPg(sb,Gc,ad,Wd){setTimeout(()=>{const je={};je.Result=null!==Gc&&void 0!==Gc?Gc:Wd;sb?sb(je):ad&&ad(null)},1E3)}};Sa=Object(n.__decorate)([Object(E.d)(M.FileOptimizationManagerService),Object(n.__param)(0,Object(M.EwaControlService)()),Object(n.__param)(1,Object(M.FormulaRemediationManagerService)({CU:!0}))],Sa);Object(m.a)(Sa,"FileOptimizationManager",
A.a,[]);var Pa=a(684),za=a(61),wa=a(266),db=a(662),Ba=a(213);let Ka=class{constructor(sb,Gc){this.$=sb;this.pluginScheduler=Gc;this.W9={};this.$Pc=new Map;this.A1h=0;this.Umj=Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BrokenFormulasTelemetry",!1);this.I3g=Oa.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.FormulaRemediationTranspilationChunkSize",250);this.Lpk=()=>new Promise(async(ad,Wd)=>{try{ad(await this.mjj())}catch(je){Wd(Error("FormulaRemediationManager.remediate: "+
(null===je||void 0===je?void 0:je.message)))}});this.mjj=()=>new Promise(async(ad,Wd)=>{try{await this.Vhj();if(!this.W9||0===Object.keys(this.W9).length){const Ie=await this.getSheetsWithIncompatibleFormulas();for(const Je of Ie)this.W9[Je.SheetId]={zej:Je.NoOfUniqueFormulas,Xrb:0}}await this.Mpk();const je=this.TZi();ad({status:this.SZi(),Kve:je})}catch(je){(null===je||void 0===je?0:je.message)&&l.ULS.sendTraceTag(507332165,0,10,`FormulaRemediationManager.initiateAutomaticRemediation: ${je.message}`),
Wd(Error("Automatic remediation failed."))}});this.Mpk=async()=>{for(const ad of Object.keys(this.W9))2!==this.W9[ad].Xrb&&await this.Npk(ad).then(()=>{this.W9[ad].Xrb=2;this.Aqd()}).catch(Wd=>{l.ULS.sendTraceTag(507314977,0,10,`FormulaRemediationManager.remediateFormulas: ${Wd.message}`);this.W9[ad].Xrb=3;this.Aqd()});this.Aqd()};this.Npk=ad=>new Promise(async(Wd,je)=>{try{const Ie=await this.getUniqueIncompatibleFormulas(ad),Je=await this.K7k(Ie);await this.commitRemediatedFormulas(ad,Je);Wd()}catch(Ie){je(Ie)}});
this.getSheetsWithIncompatibleFormulas=()=>new Promise((ad,Wd)=>{const je=Je=>{(Je=Je.Result)?ad(Je):Wd(Error("onGetSheetsWithIncompatibleFormulasSuccess: data is null."))},Ie=Je=>{Je=(null===Je||void 0===Je?0:Je.data)?la.a.te(Je.data):null;Wd(Error(`onGetSheetsWithIncompatibleFormulasFailure: ${ba.a.pc(Je)}`))};this.$.userOperationManager.enqueueOperation(new Ba.a(1046,0,(Je,$e,Ib)=>{var Nb=this.$.ma.sa,Bc=db.IncompatibilityType.gMove;Je=wa.c(Je,je);$e=wa.b($e,Ie);const Af=Nb.$a(1,null);Af.IncompatibilityType=
Bc;return za.h(Nb,"GetSheetsWithIncompatibleFormulas",Af,Je,$e,Ib,null,4)},16),null)});this.getUniqueIncompatibleFormulas=ad=>new Promise((Wd,je)=>{const Ie=$e=>{var Ib;$e=null===(Ib=$e.Result)||void 0===Ib?void 0:Ib.UniqueFormulas;isNullOrUndefined($e)?je(Error("onGetUniqueIncompatibleFormulasSuccess: data is null.")):Wd($e)},Je=$e=>{$e=(null===$e||void 0===$e?0:$e.data)?la.a.te($e.data):null;je(Error(`onGetUniqueIncompatibleFormulasFailure: ${ba.a.pc($e)}`))};this.$.userOperationManager.enqueueOperation(new Ba.a(1047,
0,($e,Ib,Nb)=>{var Bc=this.$.ma.sa,Af=db.IncompatibilityType.gMove,gf=this.W9[ad].zej;$e=wa.c($e,Ie);Ib=wa.b(Ib,Je);const Qe=Bc.$a(1,null);Qe.IncompatibilityType=Af;Qe.sheetId=ad;Qe.offset=0;Qe.pageSize=gf;return za.h(Bc,"GetUniqueIncompatibleFormulas",Qe,$e,Ib,Nb,null,4)},16),null)});this.K7k=ad=>new Promise((Wd,je)=>{let Ie=[],Je=Math.ceil(ad.length/this.I3g);for(;0<ad.length;){const $e=ad.splice(0,this.I3g);this.J7k($e).then(Ib=>{Ib=Ib.map(Nb=>({OriginalFormula:Nb.originalFormula,TranspiledFormula:Nb.remediatedFormula}));
Ie=[...Ie,...Ib];1>--Je&&Wd(Ie)}).catch(Ib=>{je(Error(`transpileFormulas: ${null===Ib||void 0===Ib?void 0:Ib.message}`))})}});this.commitRemediatedFormulas=(ad,Wd)=>new Promise((je,Ie)=>{const Je=Nb=>{if(Nb=Nb.Result){for(let Bc=0;Bc<Nb.length;Bc++)this.zLk(Wd[Bc].TranspiledFormula,Nb[Bc]);je()}else Ie(Error("onCommitRemediatedFormulasSuccess: data is null."))},$e=Nb=>{Nb=(null===Nb||void 0===Nb?0:Nb.data)?la.a.te(Nb.data):null;Ie(Error(`FormulaRemediationManager.onCommitRemediatedFormulasFailure: ${ba.a.pc(Nb)}`))},
Ib=this.Z0i(ad);this.$.userOperationManager.enqueueOperation(new Ba.a(1048,0,(Nb,Bc,Af)=>{var gf=this.$.ma.sa;Nb=wa.c(Nb,Je);Bc=wa.b(Bc,$e);const Qe=gf.$a(33,null);Qe.sheetName=Ib;Qe.RemediatedFormulas=Wd;return za.h(gf,"CommitRemediatedFormulas",Qe,Nb,Bc,Af,null,0)}),null)});this.TZi=()=>{const ad=Array.from(this.$Pc.values()).reduce((Wd,je)=>Wd+je,0);return 0===ad?null:{primaryText:String.format(J.a.instance.Ib(251),this.$Pc.size),secondaryText:String.format(J.a.instance.Ib(252),ad)}};this.Vhj=
()=>new Promise(async(ad,Wd)=>{try{const je={payload:{incompatibilityType:db.IncompatibilityType.gMove}};await this.pluginScheduler.eventEmitter().FormulaTranspilerInitEvent(je).then(()=>{ad()})}catch(je){Wd(Error("FormulaRemediationManager.initializeIncompatibilityType: "+(null===je||void 0===je?void 0:je.message)))}});this.Q7j=ad=>{ad.Result&&l.ULS.sendTraceTag(507883930,0,50,"FormulaRemediationManager.onbrokenFormulasTelemetrySuccess: broken formula found")};this.Umj&&this.BEj()}dispose(){this.pluginScheduler=
this.$=null}Z0i(sb){var Gc;const ad=this.$.qa.items.find(Wd=>Wd.sheetId===sb);return null!==(Gc=null===ad||void 0===ad?void 0:ad.name)&&void 0!==Gc?Gc:void 0}SZi(){let sb=!0,Gc=!0;for(const ad in this.W9)2===this.W9[ad].Xrb?Gc=!1:3===this.W9[ad].Xrb&&(sb=!1);return sb?2:Gc?3:1}Aqd(){Object.values(this.W9).every(sb=>0!==sb.Xrb)}async J7k(sb){const Gc={formulaBatch:[]};for(const ad of sb)Gc.formulaBatch.push({formula:ad.Formula,refMode:ad.RefMode,originCell:{sheetName:"",firstRow:ad.FirstCellRow,firstColumn:ad.FirstCellColumn}});
sb=await this.pluginScheduler.requester().getTranspiledFormulas(Gc,db.PluginGroup.Excel,(this.A1h++).toString());if("Done"!==sb.kind)throw Error("Some Exception occurred at the FormulaTranspilerPlugin");return sb.payload.transpiledFormulas}BEj(){var sb=this.$.ma.sa,Gc=this.Q7j;const ad=sb.$a(1,null);za.h(sb,"BrokenFormulasTelemetry",ad,Gc,null,null,null,4)}zLk(sb,Gc){var ad;this.$Pc.set(sb,(null!==(ad=this.$Pc.get(sb))&&void 0!==ad?ad:0)+Gc)}};Ka=Object(n.__decorate)([Object(E.d)(M.FormulaRemediationManagerService),
Object(n.__param)(0,Object(M.EwaControlService)()),Object(n.__param)(1,Object(Pa.f)())],Ka);Object(m.a)(Ka,"FormulaRemediationManager",null,[806]);var da=a(19),sa=a(257),mb=a(43);const Ma=(sb,Gc,ad,Wd,je,Ie,Je)=>{Je=sb.$a(1,void 0===Je?null:Je);Je.sheetName=Gc;return za.h(sb,"EvaluateSheetOptimizableContent",Je,ad,Wd,je,Ie,4)};var hb=a(83),$a=a(25),Va=a(48),xa=a(154);class ia{constructor(sb,Gc){this.sessionID=null;this.uvg=ad=>{if(ad){let Wd=Va.d(ad.data);({Ws:ad}=Wd);if(Wd.returnValue&&(ad=Object(xa.a)(Object,
ad))&&"OptimizeWorkbookTaskPane"===ad.Origin)if(this.sessionID!==ad.SessionId)l.ULS.sendTraceTag(509748062,0,10,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(ad.Event){case "CoauthorsDetected":this.O8j.EUk();l.ULS.sendTraceTag(508117312,0,50,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - Coauth error dialog shown.");break;default:l.ULS.sendTraceTag(509748060,
0,10,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - Unhandled Event.")}}};this.O8j=sb;this.sessionID=Gc}initialize(){window.addEventListener("message",this.uvg,!1)}dispose(){window.removeEventListener("message",this.uvg,!1)}}Object(m.a)(ia,"OptimizeWorkbookTaskPaneListener",null,[]);var Z=a(88);let ta=class extends A.a{constructor(sb){super();this.businessBar=null;this.cAb=2;this.vCb=-1;this.gWc=!1;this.y0b=null;this.xCc=!1;this.rXj=Gc=>{this.$&&((Gc=Gc.Result)?
Gc.HasSignificantOptimizableContent?(l.ULS.sendTraceTag(539870352,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Operation completed with significant optimizable content"),Oa.EwaSettings.isChangeGateEnabled("OfficeVSO:8234692_8093480_EnableDisableBizBarOnCoauthEvent")&&this.$.fa.Dha(this.wE),Gc.OptimizableRangesOrPercentage&&(this.vCb=Gc.OptimizableRangesOrPercentage),0>=this.vCb&&0!==this.cAb&&(l.ULS.sendTraceTag(512349446,0,50,"OptimizeWorkbookManager.OptimizableRangesOrPercentage Range count or percentage must return valid value"),
this.cAb=0),Oa.EwaSettings.isChangeGateEnabled("OfficeVSO:8234692_8093480_EnableDisableBizBarOnCoauthEvent")&&!Gc.Completed?l.ULS.sendTraceTag(508170697,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Operation was marked as not complete"):this.Pub()):l.ULS.sendTraceTag(537154764,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Operation completed without significant optimizable content"):l.ULS.sendTraceTag(537154763,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Null result object"))};this.b4j=
(Gc,ad,Wd)=>{(Gc=Gc.Result)?Gc.HasSignificantOptimizableContent?(l.ULS.sendTraceTag(512304643,0,50,"OptimizeWorkbookManager.onRetrieveSuccess: Operation completed with significant optimizable content"),this.gWc=!0,this.lXk(ad,Wd)):l.ULS.sendTraceTag(512304644,0,50,"OptimizeWorkbookManager.onRetrieveSuccess: Operation completed without significant optimizable content"):l.ULS.sendTraceTag(512304645,0,50,"OptimizeWorkbookManager.onRetrieveSuccess: Null result object")};this.wE=(Gc,ad)=>{Gc=1<ad.U9g;
this.xCc||Gc?this.xCc&&Gc&&(this.businessBar&&this.businessBar.w2(62)&&(l.ULS.sendTraceTag(508170695,0,50,"OptimizeWorkbookManager.onUserListChanged: Hide the business bar"),this.uHa()),this.$.fa.A9(this.wE)):(this.Pub(),this.xCc=!0,l.ULS.sendTraceTag(508170696,0,50,"OptimizeWorkbookManager.onUserListChanged: Show the business bar"))};this.$=sb;this.I_k();this.gWc=!1;this.dki=Oa.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.SlowOperationDurationThreshold",2E3);this.y0b=new ia(this,this.$.fa.sessionId)}dispose(){this.uHa();
Oa.EwaSettings.isChangeGateEnabled("OfficeVSO:8234692_8093480_EnableDisableBizBarOnCoauthEvent")&&this.$.fa.A9(this.wE);this.$=this.businessBar=null;this.aqf();super.dispose()}Zij(){this.y0b&&this.y0b.initialize()}aqf(){this.y0b&&this.y0b.dispose()}uHa(){this.businessBar&&this.businessBar.w2(62)&&this.businessBar.removeEntry(62)}I_k(){Object(da.d)(sa.a).execute(sb=>{sb.isFeatureEnabled("ExcelOptimizeCellTableBigHammer",!1).then(Gc=>{if(Gc){var ad=this.$.ma.sa,Wd=this.cAb,je=this.rXj;const Ie=ad.$a(1,
null);Ie.businessBarMessageType=Wd;za.h(ad,"EvaluateOptimizableContentV2",Ie,je,null,null,null,4)}return Gc})})}Pub(){this.xCc=!0;const sb=Object(Z.d)(E.a.resolve(M.BusinessBarManagerService,{xa:1}));mb.TaskExtensions.tb(sb,()=>{const Gc=sb.result;Gc&&(Gc.lh(62,null,null,this.bLi()),this.businessBar=Gc)},this.$.Aa,3)}bLi(){switch(this.cAb){default:return J.a.instance.ia(2239);case 1:return String.format(J.a.instance.La(720),this.vCb);case 2:return String.format(J.a.instance.La(721),this.vCb)}}Mfa(sb,
Gc,ad){if(Gc&&Gc.RequestTelemetryData&&!(Gc.RequestTelemetryData.EcsOperationDuration<this.dki)&&this.businessBar&&this.businessBar.w2(62)&&!this.gWc){var Wd=ad?ad:this.$.la.sheetName;if(6===sb||7===sb||8===sb||9===sb)this.evaluateSheetOptimizableContent(Wd,sb,Gc.RequestTelemetryData.EcsOperationDuration);else{const je=()=>{$a.f(this.$).za.Gq(je);this.evaluateSheetOptimizableContent(Wd,sb,Gc.RequestTelemetryData.EcsOperationDuration)};$a.f(this.$).za.Or(je)}}}evaluateSheetOptimizableContent(sb,Gc,
ad){Ma(this.$.ma.sa,sb,Wd=>{this.b4j(Wd,Gc,ad)},null,null,null)}lXk(sb,Gc){const ad=new hb.a(-847286761,Y.a.Hb,this.$.xc,0,null),Wd={CalloutName:18};Wd.Target=this.businessBar.aKd(62);Wd.Operation=sb;Wd.Duration=Gc;this.$.Ia.Gb(ad,Wd)}EUk(){const sb=new B.a;sb.hc=0;sb.Ni(J.a.instance.La(874),J.a.instance.La(875),0)}};ta=Object(n.__decorate)([Object(E.d)(M.OptimizeWorkbookManagerService),Object(n.__param)(0,Object(M.EwaControlService)())],ta);Object(m.a)(ta,"OptimizeWorkbookManager",A.a,[805]);var pa=
a(1524),Ga=a(1144),Ca=a(1145),kb=a(182);class eb{constructor(sb){this.DI=null;this.$=sb}show(){const sb=this.kGa();l.ULS.shipAssertTag(537169938,0,!!sb,"EwaReactCallout.Show: Cannot retrieve the Callout Parameters");O.a.QF().then(Gc=>{if(Oa.EwaSettings.isChangeGateEnabled("OfficeVSO:8871116_Fix_CalloutDismissIssue")&&this.DI)l.ULS.sendTraceTag(507294338,0,15,"EwaReactCallout.Show: attempting to add callout when one is already present. Returning without adding new callout.");else{const ad=Gc.callout(sb);
this.DI=Gc.addNotification(ad)}},Gc=>{l.ULS.sendTraceTag(537169936,0,15,`EwaReactCallout.Show: Failed to GetNotificationsAPIAsync: ${Gc}`);return null})}dismiss(){this.DI&&O.a.QF().then(sb=>{sb.removeNotification(this.DI);return this.DI=null})}D7a(sb){O.a.QF().then(Gc=>{Gc.updateNotification(this.DI,Gc.callout(Object.assign(new Ga.a,sb)))},Gc=>{l.ULS.sendTraceTag(522782336,0,15,`EwaReactCallout.Update: Failed to GetNotificationsAPIAsync: ${Gc}`);return null})}}Object(m.a)(eb,"EwaReactCallout",null,
[831]);class Yb{static cmb(sb){return!!(sb&1)}static ZHc(sb){return!!(sb&2)}static V9g(sb){return!!(sb&Yb.Yej)}}Yb.Yej=6;Object(m.a)(Yb,"EwaReactCalloutModeUtil",null,[]);class Gb{constructor(){this.kK=0;this.OIa=null;this.H8b=!0}}Object(m.a)(Gb,"EwaReactShowOrDismissCalloutMetadata",null,[]);var Mb=a(58),Rb=a(129),$b=a(617);class cc{constructor(sb,Gc,ad){this.indexedDB=null;this.$=sb;this.TJ=Gc;this.zTa=ad}o2d(){const sb=new kb.a,Gc=new Gb;mb.TaskExtensions.tb(this.MMb(),ad=>{ad.result?mb.TaskExtensions.tb(this.indexedDB.zta(this.TJ),
Wd=>{if(Wd=Wd.result){Wd=Mb.a.Xj(Wd);if(!Wd){this.AAf(sb);return}if(Yb.cmb(this.zTa)){const je=Wd.NumberOfDisplays;Gc.kK=je?Number.parseLocale(je):0}Yb.ZHc(this.zTa)&&(Wd=Wd.LastDisplay,Gc.OIa=Wd?new Date(Number.parseLocale(Wd)):null)}sb.setResult(Gc)},this.$.Aa):this.AAf(sb)},this.$.Aa,3);return sb.task}sme(sb){const Gc=new kb.a;mb.TaskExtensions.tb(this.MMb(),ad=>{ad.result||Gc.setResult(!1);ad={};Yb.cmb(this.zTa)&&(ad.NumberOfDisplays=sb.kK.toString());Yb.ZHc(this.zTa)&&(ad.LastDisplay=Rb.toTimestamp(sb.OIa).m.toString());
ad=Mb.a.Nc(ad);mb.TaskExtensions.tb(this.indexedDB.Qxa(new $b.a(this.TJ,ad)),Wd=>{Gc.setResult(Wd.result)},this.$.Aa,3)},this.$.Aa,3)}MMb(){const sb=new kb.a;this.indexedDB?sb.setResult(!0):void E.a.resolve(M.IndexedDBService,{xa:1}).then(Gc=>{Gc.Tf()?(Gc.initialize("Callouts","EwaCallouts"),this.indexedDB=Gc,sb.setResult(!0)):(l.ULS.sendTraceTag(573609248,0,50,"EwaReactShowOrDismissCalloutIndexedDBLoaderSaver.EnsureIndexedDB: IndexedDb is not supported."),sb.setResult(!1))});return sb.task}AAf(sb){const Gc=
new Gb;Gc.H8b=!1;sb.setResult(Gc)}}Object(m.a)(cc,"EwaReactShowOrDismissCalloutIndexedDBLoaderSaver",null,[841]);class fb{constructor(sb,Gc,ad,Wd,je,Ie){this.Gdb=Gc;this.Idb=ad;this.zTa=Wd;this.TJ=je;this.localStorage=Ie;this.$=sb}o2d(){const sb=new kb.a,Gc=new Gb;if(Yb.cmb(this.zTa)){let ad=0;Gc.H8b=(()=>{let Wd=this.m9k();({Yda:ad}=Wd);return Wd})().returnValue&&Gc.H8b;Gc.kK=ad}sb.setResult(Gc);return sb.task}sme(sb){const Gc=new kb.a;var ad=!0;if(Yb.cmb(this.zTa)){const Wd=this.qGf();Wd&&(ad=Number.parseLocale(Wd),
ad=this.U9k((ad&~this.Idb|sb.kK<<this.Gdb).toString()))}Gc.setResult(ad)}m9k(){var sb;return(sb=this.qGf())?(sb=(Number.parseLocale(sb)&this.Idb)>>this.Gdb,l.ULS.sendTraceTag(537169932,0,50,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver - Callout ${this.TJ} already appeared. Found the callout in storage.`),{returnValue:!0,Yda:sb}):{returnValue:!1,Yda:0}}U9k(sb){try{if(!this.localStorage.Tf())return!1;try{return this.localStorage.setItem("CalloutIds",sb),!0}catch(Gc){l.ULS.sendTraceTag(537169931,
0,15,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.TrySaveCalloutIdsToCache: Failed to set item to cache. reason: ${Gc.message||"Unknown"}`)}}catch(Gc){l.ULS.sendTraceTag(537169930,0,15,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.TrySaveCalloutIdsToCache: Got Exception when trying to save calloutIds to cache. e.Message: ${Gc.message}`)}return!1}qGf(){try{if(!this.localStorage.Tf())return l.ULS.sendTraceTag(537169929,0,50,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.GetCalloutIdsFromCache: Local storage is not supported and display count (if any) won't be saved for ${this.TJ}.`),
null;const sb=this.localStorage.getItem("CalloutIds");return sb?sb:(l.ULS.sendTraceTag(537169928,0,15,"EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.GetCalloutIdsFromCache: item doesn't exist in local storage"),"0")}catch(sb){return l.ULS.sendTraceTag(537169927,0,15,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.GetCalloutIdsFromCache: Got Exception when trying to get calloutIds. e.Message: ${sb.message}`),null}}}Object(m.a)(fb,"EwaReactShowOrDismissCalloutLocalStorageLoaderSaver",null,
[841]);var Sb=a(150),kc=a(198),na=a(151),fc=a(688);class Cc extends eb{constructor(sb,Gc,ad,Wd,je,Ie,Je,$e,Ib,Nb,Bc,Af,gf,Qe,Aa,Fb,Ta,Eb,oc){Nb=void 0===Nb?!1:Nb;Bc=void 0===Bc?!1:Bc;Af=void 0===Af?!1:Af;gf=void 0===gf?!1:gf;Qe=void 0===Qe?!1:Qe;Aa=void 0===Aa?!0:Aa;Fb=void 0===Fb?!1:Fb;Ta=void 0===Ta?null:Ta;Eb=void 0===Eb?!1:Eb;oc=void 0===oc?!1:oc;super(sb);this.kK=0;this.SBd=this.Nse=this.w4c=this.Fah=!1;this.Vqg=()=>{this.lEc()};this.n8c=Gc;this.fZc=ad;this.thi=Wd;this.fw=je;this.Uu=Ie;this.localStorage=
Ib;this.m8c=Je;this.l8c=$e;this.xCj=Nb;this.VRd=Bc;this.xhi=Af;this.setInitialFocus=gf;this.useCoachmark=Qe;this.fWc=!1;this.FKk=Aa;this.PYb=this.KMd();this.Hdb=Ta;this.Nse=Eb;this.hasDynamicSizing=Fb;this.SBd=oc}get gcb(){return{}}NDe(){}dXa(){return 1}HKd(){return 0}get Yda(){return 1}get kfk(){return!0}get TJ(){return this.n8c}get Idb(){return this.m8c}get Gdb(){return this.l8c}show(){mb.TaskExtensions.tb(this.xya(),sb=>{sb.result&&this.Tse()},this.$.Aa)}U$f(){na.b(this.$).Jd(Sb.a.Vvf,this.gPf("dismiss"),
void 0,!0)}ebg(){na.b(this.$).Jd(Sb.a.Vvf,this.gPf("show"),void 0,!0)}kGa(){var sb=Object(u.a)(new pa.a,{label:this.thi,onExecute:()=>{this.NDe();this.U$f();this.w4c=!0;this.lEc()}});let Gc=null;this.VRd||(Gc=Object(u.a)(new pa.a,{label:this.fZc,onExecute:()=>{this.w4c=!0;this.ebg();const Wd=kc.c({["InputMethod"]:Y.a.Hb},this.gcb);this.$.Ia.Gb(this.ribbonCommandInfo,Wd);this.lEc()}}));const ad=this.SBd||this.VRd?sb:Gc;sb=this.VRd?null:this.SBd?Gc:sb;return Object(u.a)(new Ga.a,{target:this.Qta(),
content:this.Uu,title:this.fw,primaryButtonProps:ad,secondaryButtonProps:sb,showCloseIcon:this.Nse,preventLightDismiss:!this.xCj,hasDynamicSizing:this.hasDynamicSizing,calloutProps:Object(u.a)(new Ca.a,{onDismiss:()=>{this.lEc()},directionalHint:this.Hdb,preventDismissOnScroll:!0,preventDismissOnResize:!this.xhi,isBeakVisible:this.FKk,setInitialFocus:this.setInitialFocus}),useTeachingStyles:!0,hasFocusableControls:!0,useCoachmark:this.useCoachmark})}lEc(){this.Fah=!0;const sb=E.a.Cb(M.PrintPreviewManagerService);
sb&&sb.ouk(this.Vqg);(this.kfk&&this.w4c||this.Nse)&&this.c5g(!0);this.w4c||l.ULS.sendTraceTag(537169935,0,50,`EwaReactShowOrDismissCallout - Callout ${this.TJ} was dismissed without user interaction`);this.dismiss()}xya(){const sb=new kb.a;this.nka()?mb.TaskExtensions.tb(this.PYb.o2d(),Gc=>{var ad=this.dXa();Gc=Gc.result;if(Gc.H8b)if(this.kK=Gc.kK,Yb.cmb(ad)&&(this.fWc||Gc.kK>=this.Yda))l.ULS.sendTraceTag(573609250,0,50,`EwaReactShowOrDismissCallout - Callout ${this.TJ} already appeared. Found the callout in storage.`),
this.fWc=!0,sb.setResult(!1);else{if(Yb.ZHc(ad)&&Gc.OIa&&(ad=Rb.getElapsedSeconds(Gc.OIa,new Date),(Gc=this.HKd())||l.ULS.shipAssertTag(537169933,0,!1,`GetCooldownPeriodInSeconds returned 0 callout ${this.TJ} with mode RestrictedBycooldown`),ad<Gc)){sb.setResult(!1);return}ad=!this.DI&&!!this.Qta()&&!fc.a(this.$);sb.setResult(ad)}else sb.setResult(!1),l.ULS.sendTraceTag(537169934,0,50,`EwaReactShowOrDismissCallout.ShouldShowCallout: Failed to retrieve metadata for callout ${this.TJ}.`)},this.$.Aa):
sb.setResult(!1);return sb.task}nka(){return!0}Qta(){if(document.querySelector(this.uR))return this.uR;if(document.querySelector(this.tR))return this.tR;if(document.querySelector(this.YQ))return this.YQ;l.ULS.shipAssertTag(592528907,0,!1,`EwaReactShowOrDismissCallout.GetTargetObject: Cannot retrieve the Callout Target Object, Callout: ${this.TJ}`);return null}c5g(sb){sb=void 0===sb?!1:sb;this.fWc=!0;const Gc=new Gb;Gc.kK=sb?this.Yda:this.kK+1;Gc.OIa=new Date;this.PYb.sme(Gc)}Tse(){this.fWc=!0;this.c5g();
l.ULS.sendTraceTag(593494082,0,50,`EwaReactShowOrDismissCallout - Showing ${this.TJ} callout, current number of displayes: ${this.kK}`);void E.a.Bd(M.PrintPreviewManagerService).then(sb=>{this.Fah||sb.HFh(this.Vqg)});super.show()}KMd(){const sb=this.dXa();return Yb.V9g(sb)?new cc(this.$,this.TJ,sb):new fb(this.$,this.Gdb,this.Idb,sb,this.TJ,this.localStorage)}gPf(sb){return{["selection"]:sb,["callout"]:this.TJ,["Location"]:"floatie",["displayCount"]:this.kK}}}Object(m.a)(Cc,"EwaReactShowOrDismissCallout",
eb,[]);var tc=a(307),nb=a(10);const tb='[id="'+nb.a.SZg+'"]';class La extends Cc{constructor(sb,Gc,ad,Wd,je,Ie,Je,$e,Ib,Nb){super(sb,Gc,null,ad,Wd,je,Ie,Je,new tc.a,$e,!0,!0,Ib,!1,!1,void 0,Nb)}get uR(){return tb}get tR(){return tb}get YQ(){return tb}get ribbonCommandInfo(){return new hb.a(-847286761,Y.a.Hb,this.$.xc,0,null)}nka(){return!(this.$.isMobileMode||this.$.fa.$b.inEmbedView||this.$.fa.$b.inWebPart)}}Object(m.a)(La,"ZoomTeachingCallout",Cc,[]);class wb extends La{constructor(sb){super(sb,
"AdjustZoomTeachingCallout",J.a.instance.La(694),null,J.a.instance.La(693),2,1,!1,!0,2)}}Object(m.a)(wb,"AdjustZoomTeachingCallout",La,[]);class Wa extends Cc{constructor(sb){super(sb,"ConditionalFormattingManageRulesTeachingCallout",J.a.instance.La(643),J.a.instance.La(644),J.a.instance.La(641),J.a.instance.La(642),2,1,new tc.a)}get uR(){return"[data-unique-id=Ribbon-ConditionalFormatting]"}get tR(){return'[data-unique-id="RibbonOverflowMenu"]'}get YQ(){return'[id="m_excelWebRenderer_ewaCtl_Styles.CondFmt-Large"]'}get ribbonCommandInfo(){return new hb.a(-20558303,
Y.a.Hb,this.$.xc,0,null)}}Object(m.a)(Wa,"ConditionalFormattingManageRulesTeachingCallout",Cc,[]);var Fa;(function(sb){sb[sb.overrideBrowserShortcuts=0]="overrideBrowserShortcuts";sb[sb.conditionalFormattingManageRules=1]="conditionalFormattingManageRules";sb[sb.linkedEntityBlankCellConvert=2]="linkedEntityBlankCellConvert";sb[sb.linkedEntityNoCuratedData=3]="linkedEntityNoCuratedData";sb[sb.linkedEntityFirstOrganizationData=6]="linkedEntityFirstOrganizationData";sb[sb.adjustZoomTeachingCallout=7]=
"adjustZoomTeachingCallout";sb[sb.linkedEntityGallery=8]="linkedEntityGallery";sb[sb.fixedFreezePane=9]="fixedFreezePane";sb[sb.phoneticTeachingCallout=10]="phoneticTeachingCallout";sb[sb.powerQueryCallout=11]="powerQueryCallout";sb[sb.tableAIConvertToTableCallout=12]="tableAIConvertToTableCallout";sb[sb.optimizeWorkbookBusinessBarCallout=13]="optimizeWorkbookBusinessBarCallout";sb[sb.tableInNewWorkbook=14]="tableInNewWorkbook";sb[sb.formulaByExampleCurtainLifterCallout=15]="formulaByExampleCurtainLifterCallout";
sb[sb.dataCleansing=16]="dataCleansing";sb[sb.optimizeWorkbookSlowOperationsCallout=18]="optimizeWorkbookSlowOperationsCallout";sb[sb.excelLiveWebEntryPointCallout=20]="excelLiveWebEntryPointCallout";sb[sb.functionDialog=21]="functionDialog";sb[sb.fullScreen=22]="fullScreen";sb[sb.length=23]="length";sb[sb.gotoCtrlClick=24]="gotoCtrlClick"})(Fa||(Fa={}));Object(m.b)("EwaCalloutName",Fa);var Da=a(42);class ja extends La{constructor(sb){super(sb,"FixedFreezePaneTeachingCallout",J.a.instance.La(647),
J.a.instance.La(645),J.a.instance.La(646),65536,16,!0,!1,8)}dXa(){return 0}}Object(m.a)(ja,"FixedFreezePaneTeachingCallout",La,[]);var Qa=a(103),Ob=a(64),Ub=a(28),Zb=a(1171);class uc extends Zb.a{constructor(sb){super("TextAboveImage");this.imageHeight=this.imageWidth=this.image=this.paragraphs=null;this.paragraphs=sb.paragraphs;this.image=sb.image;this.imageWidth=sb.imageWidth;this.imageHeight=sb.imageHeight}}Object(m.a)(uc,"TextAboveImage",Zb.a,[]);class Hc{constructor(sb,Gc){this.imageHeight=this.imageWidth=
this.image=this.paragraphs=null;this.paragraphs=sb;this.image=Gc}}Object(m.a)(Hc,"TextAboveImageCustomProps",null,[]);var Dd=a(1170),jc=a(366);class $c extends eb{constructor(sb){super(sb);this.CPg=0;this.V5a=this.target=null;this.K3c=!1;this.Uu=this.fw=null;this.jsd=0}dU(sb,Gc,ad,Wd,je,Ie){if(!this.Mo()){switch(Wd){case "DataTypes_PBI":this.jsd=1;break;default:this.jsd=0}this.target=sb;this.fw=String.format(J.a.instance.La(676),Gc);this.Uu=String.format(J.a.instance.La(677),ad);this.CPg=Ie;this.MHk(Wd,
je)}}MHk(sb,Gc){const ad=!!this.$.ta&&Ub.a.equals(this.$.ta.UICultureTag,"en-us",!0);this.K3c=Gc&&ad;Gc&&!ad?this.V5a="BlankCell":sb?this.V5a=sb:(l.ULS.sendTraceTag(537169926,0,15,"LinkedEntityBlankCellConvertTeachingCallout.SetActionButtonAndSidePaneId: Callout BlankCellResourceId was null"),this.V5a="BlankCell")}show(){l.ULS.shipAssertTag(537169925,0,!!this.target&&!!this.Uu&&!!this.fw,"LinkedEntityBlankCellConvertTeachingCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");
this.Mo()||(l.ULS.sendTraceTag(537169924,0,50,"LinkedEntityBlankCellConvertTeachingCallout.Show() - Showing LinkedEntityBlankCellConvertTeachingCallout callout."),super.show())}Mo(){return!!this.DI}kGa(){const sb=Object(u.a)(new pa.a,{label:J.a.instance.La(682),ariaDescription:J.a.instance.La(683),onExecute:()=>{l.ULS.sendTraceTag(537169923,0,50,'LinkedEntityBlankCellConvertTeachingCallout - clicked "Got it" button');this.dismiss()}}),Gc=Object(u.a)(new pa.a,{label:this.K3c?J.a.instance.La(680):J.a.instance.La(678),
ariaDescription:this.K3c?J.a.instance.La(681):J.a.instance.La(679),onExecute:()=>{l.ULS.sendTraceTag(537169922,0,50,'LinkedEntityBlankCellConvertTeachingCallout - clicked "'+(this.K3c?"Try sample data":"Learn more")+'" button');var Ie=new Map;Ie.set("Domain",this.CPg.toString());Qa.Health.instance.recordKpiUsage("LinkedEntityBlankCellCalloutActionUsed",jc.b.FailureBased,"ropari",Ie);Ie=new hb.a(-859308420,Y.a.Hb,this.$.xc,9,null);this.$.Ia.Gb(Ie,{[Y.a.Bf]:"HelpID="+this.V5a,["InputMethod"]:Y.a.Hb,
["ShouldCanvasTakeFocus"]:!0,[Y.a.Wc]:U.a.VF});this.dismiss()}});var ad=!!this.$&&!!this.$.frame&&!!this.$.frame.jI&&this.$.frame.jI.oU;switch(this.jsd){case 1:var Wd=ad?128:125;break;default:Wd=ad?127:122}Wd=Object(u.a)(new Dd.a(Ob.a.current.Lo(Wd)),{alt:J.a.instance.Ib(184)});const je=this.Uu.split("\n\n");ad=Object(u.a)(new Hc(je,Wd),{imageWidth:280,imageHeight:ad?142:192});ad=new uc(ad);return Object(u.a)(new Ga.a,{target:this.target,content:ad,title:this.fw,primaryButtonProps:Gc,secondaryButtonProps:sb,
showCloseIcon:!0,calloutProps:Object(u.a)(new Ca.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!0,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!0})}}Object(m.a)($c,"LinkedEntityBlankCellConvertTeachingCallout",eb,[]);class ud extends Cc{constructor(sb){super(sb,"LinkedEntityFirstOrganizationDataCallout",J.a.instance.La(672),J.a.instance.La(674),J.a.instance.La(670),J.a.instance.La(671),8192,13,new tc.a,
void 0,void 0,!0,!0);this.target=null;this.V5a="DataTypes_PBI"}get uR(){return this.target.toString()}get tR(){return this.target.toString()}get YQ(){return'[id="'+this.$.Oc+'Ribbon.Data.LinkedEntity"]'}get ribbonCommandInfo(){return new hb.a(-859308420,Y.a.Hb,this.$.xc,9,null)}get gcb(){return{[Y.a.Bf]:"HelpID="+this.V5a,["ShouldCanvasTakeFocus"]:!0,[Y.a.Wc]:U.a.VF}}dU(sb){this.Mo()||(this.target=sb,this.V5a="DataTypes_PBI")}Mo(){return!!this.DI}nka(){l.ULS.shipAssertTag(537169921,0,!!this.target,
"LinkedEntityFirstOrganizationDataTeachingCallout.InternalShouldShowCallout(): Cannot retrieve the callout target. InitializeCalloutProperties should be called before InternalShouldShowCallout");return!this.Mo()}}Object(m.a)(ud,"LinkedEntityFirstOrganizationDataTeachingCallout",Cc,[]);class Ud extends Cc{constructor(sb){super(sb,"LinkedEntityGalleryTeachingCallout","",J.a.instance.La(682),J.a.instance.La(684),J.a.instance.La(685),49152,14,new tc.a,void 0,!0,!0,!0,!0);this.target=null;this.Hdb=5}get Yda(){return 2}get uR(){return this.target.toString()}get tR(){this.Hdb=
7;return"[data-unique-id=Ribbon-ConvertToLinkedEntityGallery]"}get YQ(){return""}get ribbonCommandInfo(){return new hb.a(-847286761,Y.a.Hb,this.$.xc,0,U.a.Drb)}show(){l.ULS.shipAssertTag(537169920,0,!!this.target,"LinkedEntityGalleryTeachingCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");this.Mo()||(l.ULS.sendTraceTag(558690322,0,50,"LinkedEntityGalleryTeachingCallout.Show() - LinkedEntityGalleryTeachingCallout Coachmark was shown."),super.show())}dU(sb){this.Mo()||
(this.target=sb)}Mo(){return!!this.DI}nka(){l.ULS.shipAssertTag(537168099,0,!!this.target,"LinkedEntityGalleryTeachingCallout.InternalShouldShowCallout(): Cannot retrieve the callout target. InitializeCalloutProperties should be called before InternalShouldShowCallout");return!this.Mo()}}Object(m.a)(Ud,"LinkedEntityGalleryTeachingCallout",Cc,[]);var ec=a(12);class Db extends eb{constructor(sb){super(sb);this.Uu=this.fw=this.target=null}dU(sb,Gc,ad){this.Mo()||(this.target=sb,this.fw=String.format(J.a.instance.Ib(186),
Gc),this.Uu=String.format(J.a.instance.Ib(188),ad))}show(){l.ULS.shipAssertTag(537168098,0,!!this.target&&!!this.Uu&&!!this.fw,"LinkedEntityNoCuratedDataTeachingCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");this.Mo()||(l.ULS.sendTraceTag(537168097,0,50,"LinkedEntityNoCuratedDataTeachingCallout.Show() - Showing LinkedEntityNoCuratedDataTeachingCallout callout."),super.show())}Mo(){return!!this.DI}kGa(){const sb=Object(u.a)(new pa.a,{label:J.a.instance.ia(1806),
ariaDescription:J.a.instance.ia(1807),onExecute:()=>{l.ULS.sendTraceTag(537168096,0,50,'LinkedEntityNoCuratedDataTeachingCallout - clicked "Learn how" button');Qa.Health.instance.recordKpiUsage("LinkedEntityNoCuratedDataCalloutActionUsed",jc.b.FailureBased,"ropari",null);ec.HelperMethods.Rg("https://go.microsoft.com/fwlink/?linkid=2134990",void 0,void 0,"NoCuratedDataCallout.NoCuratedDataFWLink");this.dismiss()}});var Gc=Object(u.a)(new Dd.a(Ob.a.current.Lo(this.$&&this.$.frame&&this.$.frame.jI&&
this.$.frame.jI.oU?129:126)),{alt:J.a.instance.Ib(189)});Gc=Object(u.a)(new Hc([this.Uu],Gc),{imageWidth:280,imageHeight:142});Gc=new uc(Gc);return Object(u.a)(new Ga.a,{target:this.target,content:Gc,title:this.fw,primaryButtonProps:sb,showCloseIcon:!0,calloutProps:Object(u.a)(new Ca.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!0,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!0})}}Object(m.a)(Db,
"LinkedEntityNoCuratedDataTeachingCallout",eb,[]);var ic=a(178);class Pc extends eb{constructor(sb){super(sb);this.Uu=this.fw=null}dU(sb){this.Mo()||(this.target=sb,this.oIk())}show(){l.ULS.shipAssertTag(526234880,0,!!this.target&&!!this.Uu&&!!this.fw,"OptimizeWorkbookBusinessBarCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");this.Mo()||(l.ULS.sendTraceTag(526234851,0,50,"OptimizeWorkbookBusinessBarCallout.Show() - Showing OptimizeWorkbookBusinessBarCallout callout."),
ic.a.sendTelemetryEvent({name:"Office.Excel.Online.OptimizeWorkbook.BigHammerBusinessBarCalloutShown"}),super.show())}Mo(){return!!this.DI}kGa(){return Object(u.a)(new Ga.a,{target:this.target,title:this.fw,content:this.Uu,showCloseIcon:!0,calloutProps:Object(u.a)(new Ca.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!1,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!1})}oIk(){let sb=-1,Gc=0;const ad=
E.a.Cb(M.OptimizeWorkbookManagerService);ad&&(sb=ad.vCb,Gc=ad.cAb);switch(Gc){default:this.fw=J.a.instance.La(722);this.Uu=J.a.instance.La(725);break;case 1:this.fw=String.format(J.a.instance.La(723),sb);this.Uu=J.a.instance.La(726);break;case 2:this.fw=String.format(J.a.instance.La(724),sb),this.Uu=J.a.instance.La(726)}}}Object(m.a)(Pc,"OptimizeWorkbookBusinessBarCallout",eb,[]);var Ed=a(170);class de extends Cc{constructor(sb,Gc,ad,Wd,je,Ie,Je,$e,Ib){$e=void 0===$e?!1:$e;super(sb,void 0===Ib?"OverrideBrowserShortcutsTeachingCallout":
Ib,Gc,ad,Wd,je,Ie,Je,new tc.a,$e)}get uR(){return"[data-unique-id=Help]"}get tR(){return"[data-unique-id=pivotOverflowButton]"}get YQ(){return'[id="'+this.$.Oc+'Ribbon.Help-title"]'}get ribbonCommandInfo(){return new hb.a(-1018439626,Y.a.Hb,this.$.xc,0,U.a.s9)}nka(){return!Ed.a.get(U.a.R6b)}}Object(m.a)(de,"OverrideBrowserShortcutsTeachingCallout",Cc,[]);class se extends de{constructor(sb,Gc,ad,Wd,je,Ie,Je,$e){super(sb,Gc,ad,Wd,je,Ie,Je,void 0===$e?!1:$e,"OverrideBrowserShortcutsTeachingCalloutOptInByDefault")}get ribbonCommandInfo(){return new hb.a(-901364793,
Y.a.Hb,this.$.xc,0,U.a.s9)}get gcb(){return{[U.a.sbe]:!1}}}Object(m.a)(se,"OverrideBrowserShortcutsTeachingCalloutOptInByDefault",de,[]);var Fe=a(55);class fe extends Cc{constructor(sb,Gc,ad,Wd,je,Ie,Je,$e,Ib,Nb,Bc,Af,gf,Qe,Aa,Fb,Ta,Eb,oc){super(sb,Gc,ad,Wd,je,Ie,$e,Ib,Nb,void 0===Bc?!1:Bc,void 0===Af?!1:Af,void 0===gf?!1:gf,void 0===Qe?!1:Qe,void 0===Aa?!1:Aa,void 0===Fb?!0:Fb,void 0===Ta?!1:Ta,void 0===Eb?null:Eb,void 0===oc?!1:oc);this.learnMoreUrl=null;this.learnMoreUrl=Je}t8j(){try{Fe.a.YX(this.learnMoreUrl)}catch(sb){}}NDe(){null!=
this.learnMoreUrl&&this.t8j()}}Object(m.a)(fe,"EwaReactShowOrLearnMoreCallout",Cc,[]);const Tc='[id="'+nb.a.SZg+'"]';class ed extends fe{constructor(sb){super(sb,"PhoneticTeachingCallout",J.a.instance.La(695),J.a.instance.La(698),J.a.instance.La(697),J.a.instance.La(696),"https://go.microsoft.com/fwlink/?linkid=2194045",131072,17,new tc.a,void 0,void 0,void 0,void 0,void 0,void 0,!0,3,!0)}get uR(){return Tc}get tR(){return Tc}get YQ(){return Tc}get ribbonCommandInfo(){return new hb.a(1455037301,Y.a.Hb,
this.$.xc,0,null)}U$f(){l.ULS.sendTraceTag(545837391,1,50,"PhoneticTeachingCallout - click learn more")}ebg(){l.ULS.sendTraceTag(545837390,1,50,"PhoneticTeachingCallout - click show")}}Object(m.a)(ed,"PhoneticTeachingCallout",fe,[]);var pd=a(177);class Kb extends Cc{constructor(sb,Gc,ad,Wd,je,Ie){super(sb,Gc,J.a.instance.La(708),J.a.instance.La(707),J.a.instance.La(703),ad,Wd,je,new tc.a,!0,!1,void 0,void 0,void 0,!0,!0);this.Hdb=5;this.yTa=Ie}get Yda(){return 2}get uR(){return 1===pd.a(this.$).FZ?
"[data-unique-id=Ribbon-Refresh]":"[data-unique-id=Ribbon-RefreshAll]"}get tR(){return"[data-unique-id=Connections_MLR"}nka(){return this.yTa}get YQ(){return'[id="'+this.$.Oc+'Ribbon.Data.RefreshAll"]'}get ribbonCommandInfo(){return new hb.a(-859308420,Y.a.Hb,this.$.xc,9,null)}get gcb(){return{[Y.a.Bf]:"HelpID=PowerQuery_Refresh",["ShouldCanvasTakeFocus"]:!0,[Y.a.Wc]:U.a.VF}}b7b(){return this.xya()}show(){this.Qta()?super.show():l.ULS.sendTraceTag(509677597,0,10,"PowerQueryRefreshTeachingCalloutBase.Show: Target object is null.")}}
Object(m.a)(Kb,"PowerQueryRefreshTeachingCalloutBase",Cc,[]);class rb extends Kb{constructor(sb){super(sb,"PowerQueryRefreshFromTableTeachingCallout",J.a.instance.La(705),3145728,20,Oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7111771_PowerQueryRefreshWeb"))}}Object(m.a)(rb,"PowerQueryRefreshFromTableTeachingCallout",Kb,[]);class rc extends Cc{constructor(sb){super(sb,"QueriesTaskPaneTeachingCallout",J.a.instance.La(702),J.a.instance.La(701),J.a.instance.La(849),J.a.instance.La(850),12582912,22,
new tc.a,!0,void 0,void 0,void 0,void 0,!0,!0);this.Hdb=5;this.yTa=Oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7095227_PowerQueryTaskPaneGroupsOperations")}get Yda(){return 2}get uR(){return"[data-unique-id=Ribbon-OpenQueriesTaskPane]"}get tR(){return"[data-unique-id=Connections_MLR]"}get YQ(){return'[id="'+this.$.Oc+'Ribbon.Data.Queries"]'}b7b(){return this.xya()}show(){this.Qta()?super.show():l.ULS.sendTraceTag(537168092,0,10,"QueriesTaskPaneTeachingCallout.Show: Target object is null.")}nka(){return this.yTa}get ribbonCommandInfo(){return new hb.a(1156885807,
Y.a.Hb,this.$.xc,0,U.a.Drb)}}Object(m.a)(rc,"QueriesTaskPaneTeachingCallout",Cc,[]);var ld=a(492),Tb=a(689),Wc=a(255);class Ac extends Kb{constructor(sb){super(sb,"PowerQueryAuthenticatedRefreshTeachingCallout",J.a.instance.La(706),805306368,28,Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1))}}Object(m.a)(Ac,"PowerQueryAuthenticatedRefreshTeachingCallout",Kb,[]);class nd extends Cc{constructor(sb){super(sb,"PowerQueryClearAllPermissionsTeachingCallout",
J.a.instance.La(708),J.a.instance.La(701),J.a.instance.La(852),J.a.instance.La(853),3,32,new tc.a,!0,!1,void 0,void 0,void 0,!0,!0);this.Hdb=5;this.yTa=Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryClearAllCredentialTaskPane",!1)}get Yda(){return 2}get uR(){return"[data-unique-id=Ribbon-OpenQueriesTaskPane]"}get tR(){return"[data-unique-id=Connections_MLR]"}get YQ(){return'[id="'+this.$.Oc+'Ribbon.Data.Queries"]'}b7b(){return this.xya()}show(){this.Qta()?super.show():l.ULS.sendTraceTag(508687132,
0,10,"PowerQueryClearAllPermissionsTeachingCallout.Show: Target object is null.")}nka(){return this.yTa}get ribbonCommandInfo(){return new hb.a(-859308420,Y.a.Hb,this.$.xc,9,null)}get gcb(){return{[Y.a.Bf]:"HelpID=PowerQuery_Refresh",["ShouldCanvasTakeFocus"]:!0,[Y.a.Wc]:U.a.VF}}}Object(m.a)(nd,"PowerQueryClearAllPermissionsTeachingCallout",Cc,[]);class qd{constructor(sb){this.wSf=this.YSf=!1;this.xya=!0;this.c_j=Gc=>{if(Gc&&!Wc.a(Gc))try{const ad=Gc.Result,Wd=ad.QueryGroups;if(0<ad.Queries.length||
0<Wd.length)this.YSf=!0,this.wSf=ad.PowerQueryDataSources?ad.PowerQueryDataSources.includes("Excel.CurrentWorkbook")||ad.PowerQueryDataSources.includes("OData.Feed"):!1,void this.FVk()}catch(ad){l.ULS.sendTraceTag(537168095,0,10,`PowerQueryCallout.OnGetQueriesSuccess: QueryInfoList retrieval encountered exception ${ad}.`)}};this.bOc=()=>{l.ULS.sendTraceTag(537168094,0,15,"PowerQueryCallout.OnGetQueriesFailure")};this.$=sb;this.KAg=new rc(sb);this.powerQueryClearAllPermissionsCallout=new nd(sb);this.jde=
Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)?new Ac(sb):new rb(sb)}show(){this.xya&&this.WFk()}WFk(){this.$.userOperationManager.enqueueOperation(new Ba.a(587,0,(sb,Gc,ad)=>Tb.d(this.$.ma.sa,wa.c(sb,this.c_j),wa.b(Gc,this.bOc),ad,null),80,()=>new ld.a),null)}async FVk(){await Z.c(this.KAg.b7b())&&this.YSf?this.KAg.show():await Z.c(this.jde.b7b())&&(this.jde instanceof Ac||this.wSf)?this.jde.show():await Z.c(this.powerQueryClearAllPermissionsCallout.b7b())&&
this.powerQueryClearAllPermissionsCallout.show();this.xya=!1}}Object(m.a)(qd,"PowerQueryCallout",null,[831]);class Xd extends eb{constructor(sb){super(sb);this.t7d=this.$xd=this.Uu=this.fw=this.target=null}dU(sb,Gc,ad){this.Mo()||(this.target=sb,this.$xd=Gc,this.t7d=ad,this.fw=J.a.instance.La(710),this.Uu=J.a.instance.La(711))}show(){l.ULS.shipAssertTag(537168091,0,!!this.target&&!!this.Uu&&!!this.fw&&!!this.$xd&&!!this.t7d,"TableAIConvertToTableCallout.Show() - Cannot retrieve the Callout Parameters, Initialize should be called before show");
this.Mo()||(l.ULS.sendTraceTag(0,0,50,"TableAIConvertToTableCallout.Show() - Showing TableAIConvertToTableCallout callout."),super.show())}Mo(){return!!this.DI}kGa(){const sb=Object(u.a)(new pa.a,{label:J.a.instance.La(712),ariaDescription:J.a.instance.La(714),onExecute:()=>{l.ULS.sendTraceTag(0,0,50,'TableAIConvertToTableCallout - clicked "Format as table" button');this.$xd();this.dismiss()}}),Gc=Object(u.a)(new pa.a,{label:J.a.instance.La(713),ariaDescription:J.a.instance.La(715),onExecute:()=>
{l.ULS.sendTraceTag(0,0,50,'TableAIConvertToTableCallout - clicked "No thanks" button');this.t7d();this.dismiss()}});return Object(u.a)(new Ga.a,{target:this.target,content:this.Uu,title:this.fw,primaryButtonProps:sb,secondaryButtonProps:Gc,showCloseIcon:!0,calloutProps:Object(u.a)(new Ca.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!0,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!1,hasFocusableControls:!0})}}Object(m.a)(Xd,
"TableAIConvertToTableCallout",eb,[]);var Hd=a(193),Zc=a(663);class Jc{constructor(sb){this.L7k=sb}show(){Object(da.d)(Zc.a).execute(sb=>{sb.logActivity(this.L7k,null)})}}Object(m.a)(Jc,"EwaLppCallout",null,[831]);var gc=a(44);class dd extends Jc{constructor(sb){super("ExcelTableInNewWorkbook");this.DVd=this.V_a=!1;this.createTable=()=>{const Gc=gc.y(new Hd.a(1,1,8,3,nb.a.sf,nb.a.rf),this.$),ad={};ad.TableRange=Gc;ad.HasHeader=!1;this.$.Dc(71074531,Y.a.Hb,9,ad)};this.tlf=()=>{this.createSampleTable("0")};
this.ulf=()=>{this.createSampleTable("2")};this.vlf=()=>{this.createSampleTable("1")};this.$=sb;(this.V_a=Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableInNewWorkbook",!1))&&window.addEventListener("ExcelCreateSampleTable",this.createTable,!0);if(this.DVd=Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateSampleTableCallout",!1))window.addEventListener("ExcelCreateSampleTableBlank",this.tlf,!0),window.addEventListener("ExcelCreateSampleTableContact",this.ulf,!0),
window.addEventListener("ExcelCreateSampleTableToDo",this.vlf,!0)}dispose(){this.V_a&&window.removeEventListener("ExcelCreateSampleTable",this.createTable,!0);this.DVd&&(window.removeEventListener("ExcelCreateSampleTableBlank",this.tlf,!0),window.removeEventListener("ExcelCreateSampleTableContact",this.ulf,!0),window.removeEventListener("ExcelCreateSampleTableToDo",this.vlf,!0))}createSampleTable(sb){const Gc={};Gc[Y.a.Wc]=sb;this.$.Dc(1371713064,Y.a.Hb,9,Gc)}}Object(m.a)(dd,"TableInNewWorkbookCallout",
Jc,[]);var Bb=a(1288);class pc extends eb{constructor(sb){super(sb);this.CZc=5E3;this.fw=Bb.a.Title;this.currentState=0}mFa(sb,Gc){Bb.c.get(this.currentState).includes(sb)&&(6===sb?window.requestAnimationFrame(()=>this.lvc(sb,Gc)):this.lvc(sb,Gc))}y$b(sb){this.target=sb}show(){super.dismiss();this.lKg();super.show()}dismiss(){this.mFa(0);window.clearTimeout(this.wFg);super.dismiss()}kGa(){return Object(u.a)(new Ga.a,{target:this.target,title:this.fw,content:this.Uu,showCloseIcon:!0,calloutProps:{setInitialFocus:!1,
preventDismissOnResize:!0,preventDismissOnScroll:!0,preventDismissOnLostFocus:!0,isBeakVisible:!0,directionalHint:12,onDismiss:void 0},useTeachingStyles:!1,hasFocusableControls:!1})}update(){this.lKg();super.D7a({message:this.Uu})}lvc(sb,Gc){const ad=Bb.b.get(sb);this.Ibl(this.nji(sb)?`${ad}${Gc}`:ad);this.currentState=sb;0!=this.currentState?(this.update(),this.show()):this.dismiss()}nji(sb){switch(sb){case 5:case 6:case 8:return!0;default:return!1}}lKg(){window.clearTimeout(this.wFg);this.wFg=window.setTimeout(()=>
this.dismiss(),this.CZc)}Ibl(sb){this.Uu=sb}}Object(m.a)(pc,"FormulaByExampleCurtainLifterCallout",eb,[]);var wc=a(130),cd=a(1117);class Vd extends Cc{constructor(sb){super(sb,"DataCleansingTeachingCallout",wc.a.ia(2477),wc.a.ia(2478),wc.a.ia(2476),wc.a.ia(2479),16777216,24,new tc.a,!0,!1,!1,!1,!0,!0,!0,5,!0,!0);this.Spd="[data-unique-id=Data]";this.E6e="[data-unique-id=Ribbon-DataCleansingTaskPane]";this.I6e="[data-unique-id=pivotOverflowButton]";this.G6e="[data-unique-id=Ribbon-DataCalculationTools_MLR]"}get uR(){return document.querySelector(this.G6e)?
this.G6e:document.querySelector(this.E6e)?this.E6e:document.querySelector(this.Spd)?this.Spd:this.I6e}get tR(){return this.I6e}get YQ(){return this.Spd}get gcb(){return cd.a}get ribbonCommandInfo(){return new hb.a(-859308420,Y.a.Hb,this.$.xc,12,null)}}Object(m.a)(Vd,"DataCleansingTeachingCallout",Cc,[]);var xb=a(126);class ub extends eb{constructor(sb){super(sb);this.Uu=this.fw=this.target=null;this.duration=0}dU(sb,Gc,ad){this.Mo()||(this.target=sb,this.fw=this.BLi(Gc),this.Uu=J.a.instance.La(737),
this.operation=Gc,this.duration=ad)}show(){l.ULS.shipAssertTag(512304648,0,!!this.target&&!!this.Uu&&!!this.fw,"OptimizeWorkbookSlowOperationsCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");this.Mo()||(l.ULS.sendTraceTag(512304647,0,50,"OptimizeWorkbookSlowOperationsCallout.Show() - Showing OptimizeWorkbookSlowOperationsCallout callout."),ic.a.sendTelemetryEvent({name:"Office.Excel.Online.OptimizeWorkbook.BigHammerSlowOperationsCalloutShown",dataFields:xb.a.Eh({["Operation"]:this.operation,
["Duration"]:this.duration})}),super.show())}Mo(){return!!this.DI}kGa(){return Object(u.a)(new Ga.a,{target:this.target,title:this.fw,content:this.Uu,showCloseIcon:!0,calloutProps:Object(u.a)(new Ca.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!1,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!1})}BLi(sb){switch(sb){case 0:return J.a.instance.La(727);case 1:return J.a.instance.La(728);case 2:return J.a.instance.La(729);
case 3:return J.a.instance.La(730);case 4:return J.a.instance.La(731);case 5:return J.a.instance.La(732);case 6:return J.a.instance.La(733);case 7:return J.a.instance.La(734);case 8:return J.a.instance.La(735);case 9:return J.a.instance.La(736);default:return""}}}Object(m.a)(ub,"OptimizeWorkbookSlowOperationsCallout",eb,[]);class Fc extends Cc{constructor(sb){super(sb,"FunctionDialogTeachingCallout",void 0,J.a.instance.La(763),J.a.instance.La(760),J.a.instance.La(761),1073741824,30,new tc.a,!0,!0,
!1,!1,!0,!0,!0,5,!0)}dU(sb){this.Tpd=`[id=${"CellEdit"===sb?this.$.Oc+U.a.vOb:"InsertFunction"}]`}dXa(){return 1}get uR(){return this.Tpd}get tR(){return this.Tpd}get YQ(){return this.Tpd}get ribbonCommandInfo(){return null}}Object(m.a)(Fc,"FunctionDialogTeachingCallout",Cc,[]);class xd extends Jc{constructor(sb){super("ExcelLiveWebEntryPointCallout");this.MZa=!1;this.mZg=()=>{this.$.Dc(327119921,Y.a.Hb,9,null)};this.$=sb;(this.MZa=Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelLiveWebEntryPointCalloutEnabled",
!1))&&window.addEventListener("TryCoEditInTeams",this.mZg,!0)}dispose(){this.MZa&&window.removeEventListener("TryCoEditInTeams",this.mZg,!0)}}Object(m.a)(xd,"ExcelLiveWebEntryPointCallout",Jc,[]);class Ic extends eb{constructor(sb){super(sb);this.n8c="FullScreenTeachingCallout";this.m8c=4;this.l8c=34;this.fw=J.a.instance.La(1004);this.Uu=J.a.instance.La(1005);this.yTa=Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ToggleFullScreenRibbon",!1);this.localStorage=new tc.a;this.PYb=this.KMd();
this.kK=0}get TJ(){return this.n8c}get Idb(){return this.m8c}get Gdb(){return this.l8c}get tR(){return"[id=ToggleFullScreenButton]"}get uR(){return"[id=ToggleFullScreenButton]"}get YQ(){return"[id=ToggleFullScreenButton]"}dXa(){return 3}HKd(){return 86400}get Yda(){return 3}kGa(){return Object(u.a)(new Ga.a,{target:this.Qta(),content:this.Uu,title:this.fw,showCloseIcon:!0,preventLightDismiss:!1,hasDynamicSizing:!1,calloutProps:Object(u.a)(new Ca.a,{onDismiss:()=>{this.dismiss()},directionalHint:6,
preventDismissOnScroll:!1,preventDismissOnResize:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0,setInitialFocus:!1,gapSpace:0}),useTeachingStyles:!0,hasFocusableControls:!1,useCoachmark:!1})}Mo(){return!!this.DI}nka(){return this.yTa&&!this.Mo()}show(){this.Qta()&&mb.TaskExtensions.tb(this.xya(),sb=>{sb.result&&this.Tse()},this.$.Aa)}xya(){const sb=new kb.a;this.nka()?mb.TaskExtensions.tb(this.PYb.o2d(),Gc=>{var ad=this.dXa();Gc=Gc.result;Gc.H8b?(this.kK=Gc.kK,Yb.cmb(ad)&&Gc.kK>=this.Yda?sb.setResult(!1):
Yb.ZHc(ad)&&Gc.OIa&&Rb.getElapsedSeconds(Gc.OIa,new Date)<this.HKd()?sb.setResult(!1):(ad=!this.DI&&!!this.Qta(),sb.setResult(ad))):sb.setResult(!1)},this.$.Aa):sb.setResult(!1);return sb.task}Tse(){const sb=new Gb;sb.kK=this.kK+1;sb.OIa=new Date;this.PYb.sme(sb);super.show()}Qta(){return document.querySelector(this.uR)?this.uR:document.querySelector(this.tR)?this.tR:document.querySelector(this.YQ)?this.YQ:null}KMd(){const sb=this.dXa();return Yb.V9g(sb)?new cc(this.$,this.TJ,sb):new fb(this.$,this.Gdb,
this.Idb,sb,this.TJ,this.localStorage)}}Object(m.a)(Ic,"FullScreenTeachingCallout",eb,[]);class bd extends Cc{constructor(sb){super(sb,"GotoCtrlClickTeachingCallout",null,"Got it","Consider using Ctrl + Click","Press Ctrl and click on a reference inside the formula to go to that reference",16,36,new tc.a,void 0,!0,void 0,void 0,void 0,void 0,void 0,7,!0)}get uR(){return this.OJd()}get tR(){return this.OJd()}get YQ(){return this.OJd()}OJd(){return`[id="${this.$.Oc+U.a.Afb}"]`}get ribbonCommandInfo(){return new hb.a(1455037301,
Y.a.Hb,this.$.xc,0,null)}}Object(m.a)(bd,"GotoCtrlClickTeachingCallout",Cc,[]);class yb{constructor(sb){this.$=sb;this.WB=new Da.a(!1)}aXi(sb){if(!this.WB.Bb(Fa[sb]))switch(sb){case 0:this.u5h(sb);break;case 2:this.WB.add(Fa[sb],new $c(this.$));break;case 3:this.WB.add(Fa[sb],new Db(this.$));break;case 6:this.WB.add(Fa[sb],new ud(this.$));break;case 1:this.WB.add(Fa[sb],new Wa(this.$));break;case 7:this.WB.add(Fa[sb],new wb(this.$));break;case 8:this.WB.add(Fa[sb],new Ud(this.$));break;case 9:this.WB.add(Fa[sb],
new ja(this.$));break;case 13:this.WB.add(Fa[sb],new Pc(this.$));break;case 10:this.WB.add(Fa[sb],new ed(this.$));break;case 11:this.WB.add(Fa[sb],new qd(this.$));break;case 12:this.WB.add(Fa[sb],new Xd(this.$));break;case 14:this.WB.add(Fa[sb],new dd(this.$));break;case 15:this.WB.add(Fa[sb],new pc(this.$));break;case 16:this.WB.add(Fa[sb],new Vd(this.$));break;case 18:this.WB.add(Fa[sb],new ub(this.$));break;case 20:this.WB.add(Fa[sb],new xd(this.$));break;case 21:this.WB.add(Fa[sb],new Fc(this.$));
break;case 22:this.WB.add(Fa[sb],new Ic(this.$));break;case 24:this.WB.add(Fa[sb],new bd(this.$));break;default:return null}return this.WB.getItem(Fa[sb])}u5h(sb){this.WB.add(Fa[sb],new se(this.$,J.a.instance.La(640),J.a.instance.La(637),J.a.instance.La(638),J.a.instance.La(639),16,4,!0))}}Object(m.a)(yb,"EwaCalloutFactory",null,[]);var Oc=a(73),kd=a(67),Rc=a(149);let Xb=class{constructor(sb){this.$=sb;this.Mpi=new yb(this.$)}gd(){return!1}td(){return!1}Rc(sb,Gc,ad){sb=ad.CalloutName;this.wTk=Oa.EwaSettings.isChangeGateEnabled("OfficeVSO:6189760_SuppressTeachingCalloutForLiveMeetings")&&
Object(Rc.c)(this.$)&&!this.gnj(sb);return!!Gc&&-847286761===Gc.command&&Oc.a.Eg.vU&&!this.wTk}gnj(sb){return this.$.Mx&&9===sb}executeCommand(sb,Gc,ad){sb=ad.CalloutName;if(Gc=this.Mpi.aXi(sb)){switch(sb){case 2:Gc.dU(ad.Target,ad.RibbonButtonLabel,ad.ExampleEntities,ad.BlankCellResourceId,ad.HasBlankCellWalkthrough,ad.ServiceDomain);break;case 3:Gc.dU(ad.Target,ad.RibbonButtonLabel,ad.ExampleEntities);break;case 6:Gc.dU(ad.Target);break;case 8:Gc.dU(ad.Target);break;case 13:Gc.dU(ad.Target);break;
case 15:return Gc.y$b(ad.Target),Gc.mFa(ad.NewState,ad.Reason),kd.Task.Va(!0);case 12:Gc.dU(ad.Target,ad.ConvertToTableCallback,ad.NoThanksCallback);break;case 18:Gc.dU(ad.Target,ad.Operation,ad.Duration);break;case 21:Gc.dU(ad.Trigger)}Gc.show();return kd.Task.Va(!0)}return kd.Task.Va(!1)}};Xb=Object(n.__decorate)([Object(E.d)(M.ShowCalloutCommandHandlerService),Object(n.__param)(0,Object(M.EwaControlService)())],Xb);Object(m.a)(Xb,"ShowCalloutCommandHandler",null,[29]);let dc=class{constructor(sb){this.S6e=
!1;this.eD=sb;Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableGridHighlights",!1)&&void E.a.resolve(M.RecognizedTableGridHighlighterService,{xa:1});Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligence.ExcelTableSummaryWorkflow",!1)&&void E.a.resolve(M.AugmentationLoopManagerService).then(Gc=>{Gc.register(Gc.RT().NV("TableIntelligenceDarkActivationManager").LV(()=>{}).build());Gc.Iea("TableIntelligenceDarkActivationManager",{Rna:()=>{},jTb:()=>{},ls:!0,
annotationType:"AugLoop_ExcelAdvancedTableMetadata_ExcelTableSummary"})});this.eD.Jbb("Valid",()=>{this.S6e||(l.ULS.sendTraceTag(526979921,0,15,"Received annotation with interpretations"),this.S6e=!0)})}};dc=Object(n.__decorate)([Object(E.d)(M.TableIntelligenceDarkActivationManagerService),Object(n.__param)(0,Object(M.TableIntelligenceManagerService)()),Object(n.__param)(1,Object(M.EwaControlService)())],dc);Object(m.a)(dc,"TableIntelligenceDarkActivationManager",null,[804]);var Vc=a(189),yd=a(724),
Pd=a(367);class re extends yd.a{constructor(){super();this.requestId=null;this.H_=Object.assign(new Pd.a,{T_:re.getTypeName(),B_:re.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableai_ExcelRangeMetadata"}static getBaseTypes(){return["AugLoop_ExcelTableAi_ExcelRecognizedTableNew","AugLoop_Core_Annotation"]}}Object(m.a)(re,"ExcelRangeMetadata",yd.a,[]);var ue=a(1465);class He extends ue.a{constructor(){super();this.value=null;this.type=0;this.H_=Object.assign(new Pd.a,{T_:He.getTypeName(),
B_:He.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableai_ExtendedExcelCell"}static getBaseTypes(){return["AugLoop_Excel_ExcelCell","AugLoop_Core_GridCell"]}}Object(m.a)(He,"ExtendedExcelCell",ue.a,[]);var bf=a(1064);class af extends bf.a{constructor(){super();this.mergeCellAddresses=this.requestId=this.cells=this.range=null;this.H_=Object.assign(new Pd.a,{T_:af.getTypeName(),B_:af.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableai_RangeDataSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(m.a)(af,"RangeDataSignal",bf.a,[]);var Pe=a(1258),wf=a(113),xf=a(41);class Cf extends Sys.EventArgs{constructor(sb){super();this.LSc=sb}}Object(m.a)(Cf,"RecognizedTableUpdateEventArgs",Sys.EventArgs,[]);var tf=a(27),Jf=a(397);class dg{constructor(sb,Gc,ad,Wd,je){this.analyzedRange=sb;this.interpretations=Gc;this.tableName=ad;this.id=Wd;this.RSf=je}}Object(m.a)(dg,"RecognizedTable",null,[]);class uf{constructor(sb,Gc,ad){this.classification=sb;this.aggregations=Gc;this.headerReferences=ad}}
Object(m.a)(uf,"TableField",null,[]);var lf=a(1259);const Pf=sb=>{var Gc=new Jf.a(Rf(sb.range),sb.range.worksheetId);var ad=sb.interpretations;var Wd=[];if(ad&&ad.length)for(const Fb of ad){b:switch(Fb.orientation.toLowerCase()){case "columnmajor":ad=2;break b;case "rowmajor":ad=1;break b;default:l.ULS.sendTraceTag(537151256,0,50,"Invalid value for table orientaion."),ad=0}const Ta=ad;if(0===Ta)l.ULS.sendTraceTag(537151257,0,50,"Invalid value for table orientaion. Skipping current interpretation.");
else{ad=lf.a;var je=Rf(Fb.location),Ie=Fb.confidence,Je=Fb.headerRowCount,$e=Fb.headerColumnCount;var Ib=Fb.fields;var Nb=[];if(Ib)for(const Eb of Ib){Ib=Nb;var Bc=Ib.push;c:switch(Eb.classification.toLowerCase()){case "dimension":var Af=1;break c;case "measure":Af=2;break c;default:l.ULS.sendTraceTag(537151255,0,50,"Invalid value %s for field classification."),Af=0}var gf=Eb.aggregations;var Qe=[];if(gf)for(const oc of gf)switch(oc.toLowerCase()){case "sum":Qe.push(0);break;case "count":Qe.push(1);
break;case "average":Qe.push(2);break;case "min":Qe.push(3);break;case "max":Qe.push(4);break;case "distinctcount":Qe.push(5);break;case "stddev":Qe.push(6);break;case "variance":Qe.push(7);break;default:l.ULS.sendTraceTag(537151254,0,50,"Invalid value for aggregation type.")}gf=Qe;var Aa=Eb.headerReferences;Qe=[];if(Aa)for(const oc of Aa)Aa=new tf.Range(oc.top,oc.left,oc.top,oc.left,!1,!1),Qe.push(Aa);Bc.call(Ib,new uf(Af,gf,Qe))}ad=new ad(je,Ie,Je,$e,Ta,Nb);Wd.push(ad)}}return new dg(Gc,Wd,sb.tableName,
sb.id,sb.hasMergedcells)},Rf=sb=>new tf.Range(sb.top,sb.left,sb.bottom,sb.right,!1,!1);var Mf=a(1098);class zf{constructor(sb,Gc){this.e4c=0;this.WC=new Map;this.iUd=!1;this.eD=sb;this.hj=Gc;Oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7748219_LogE2ELatency")&&(this.Kuc=new Mf.a("WebServiceCall","TableIntelligenceQueryManagerE2ELatency"),this.Kuc.start(),this.F_c=!0);this.eD.Jbb("Valid",this.e7j.bind(this));this.eD.Jbb("Invalid",this.B0j.bind(this));Oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7408706_QueryManagerCoauthVersionChecking")&&
this.hj.Myh(this.dVj.bind(this))}yXa(sb,Gc,ad){if(!this.WC)return l.ULS.sendTraceTag(521025344,306,10,"Recognized table is null"),[];let Wd=Gc;Oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7408706_QueryManagerCoauthVersionChecking")&&void 0!==ad&&this.e4c>ad&&(l.ULS.sendTraceTag(509681793,306,50,`getRecognizedTables: maxRevisions: ${ad}, versionChanges: ${this.e4c}`),Wd=Gc^4);return this.WC.has(sb.sheetId)?(Gc=this.WC.get(sb.sheetId).filter(je=>je.table.analyzedRange.range.ld(sb.range)&&(Wd&je.metadataState)==
je.metadataState),l.ULS.sendTraceTag(509681792,306,50,`getRecognizedTables: foundRecords: ${Gc.length}`),Gc):[]}e7j(sb,Gc){if(this.WC){if(!this.iUd){Oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7748219_LogE2ELatency")&&this.F_c&&(this.Kuc.stop(),l.ULS.sendTraceTag(509089223,0,15,"Elapsed time since annotation invalidation: {0}",this.Kuc.Kc),this.F_c=!1);for(const ad of this.WC){const [Wd,je]=ad;je.every(Ie=>4===Ie.metadataState)?this.WC.delete(Wd):this.WC.set(Wd,je.filter(Ie=>4!==Ie.metadataState))}this.iUd=
!0}sb=Gc.LSc;this.WC.has(sb.analyzedRange.sheetId)||this.WC.set(sb.analyzedRange.sheetId,[]);this.WC.get(sb.analyzedRange.sheetId).push({table:sb,metadataState:2});this.e4c=0}else l.ULS.sendTraceTag(521025315,306,10,"Recognized table is null")}B0j(sb,Gc){this.iUd=!1;Oa.EwaSettings.isChangeGateEnabled("OfficeVSO:7748219_LogE2ELatency")&&!this.F_c&&(this.Kuc.start(),this.F_c=!0);sb=Gc.LSc;if(!this.WC)l.ULS.sendTraceTag(521025314,306,10,"Recognized table is null");else if(this.WC.has(sb.analyzedRange.sheetId))for(const ad of this.WC.get(sb.analyzedRange.sheetId))ad.table.id===
Gc.LSc.id&&(ad.metadataState=4)}dVj(){this.e4c++}}Object(m.a)(zf,"TableIntelligenceQueryManager",null,[815]);class df{}Object(m.a)(df,"RecognizedTableLog",null,[]);class Bf{}Object(m.a)(Bf,"Interpretation",null,[]);class Kf{constructor(sb){this.WC=new Map;this.vmc=void 0;this.qGb=new Set;this.XZb=void 0;this.eD=sb}Qeh(){this.XZb?l.ULS.shipAssertTag(522303246,306,!1,"LogXlimRecognizedTables should not be called twice."):(this.XZb=this.bpb.bind(this),this.eD.Jbb("Valid",this.XZb))}OGj(sb){sb=this.sanitize(sb);
l.ULS.sendTraceTag(521233111,306,50,`${JSON.stringify(sb)}`)}bpb(sb,Gc){sb=Gc.LSc;Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.qGb&&this.WC?(this.qGb.has(sb.id)||(this.cCh(sb),this.qGb.add(sb.id)),this.vmc||(this.vmc=window.setTimeout(this.Jwa.bind(this),2E3))):l.ULS.sendTraceTag(522303245,306,15,`AnnotationId set or recognized table store is null. annotationIdSet = ${!!this.qGb}, recognizedTableStore = ${!!this.WC}`))}Jwa(){for(const sb of this.WC){const [,
Gc]=sb;l.ULS.sendTraceTag(521233110,306,50,JSON.stringify(Gc))}window.clearTimeout(this.vmc);this.qGb=this.vmc=void 0;this.WC.clear();this.WC=void 0;this.eD.jrk(this.XZb);this.XZb=void 0}cCh(sb){const Gc=sb.analyzedRange.sheetId;this.WC.has(Gc)||this.WC.set(Gc,[]);this.WC.get(Gc).push(this.sanitize(sb))}sanitize(sb){const Gc=[];for(const ad of sb.interpretations){let Wd=0,je=0;for(const Ie of ad.fields)1===Ie.classification?Wd++:2===Ie.classification&&je++;Gc.push({confidence:ad.confidence,headerRowCount:ad.headerRowCount,
headerColumnCount:ad.headerColumnCount,orientation:ad.orientation,measureCount:je,dimensionCount:Wd})}return{interpretations:Gc,range:{top:sb.analyzedRange.range.top,bottom:sb.analyzedRange.range.bottom,left:sb.analyzedRange.range.left,right:sb.analyzedRange.range.right},isTable:!!sb.tableName,annotationId:sb.id}}}Object(m.a)(Kf,"RecognizedTableLogger",null,[]);let Vf=class extends xf.a{constructor(sb,Gc){super();this.e0f=this.d0f=!1;this.instantaneousSupportInformationManager=null;this.lge=void 0;
this.Abg=!1;this.Kxi=(ad,Wd)=>{var je;if(1===Wd.operationType){const Je=Wd.annotation;if(Je){l.ULS.sendTraceTag(537151251,306,50,`TableIntelligenceManager::ExcelRangeMetadataHandler called for requestID = ${Je.requestId}`);ad=Pf(Je);Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(null===(je=this.lge)||void 0===je?void 0:je.OGj(ad));var Ie=null;(()=>{let $e=this.Kte.Od(Je.requestId);({value:Ie}=$e);return $e})().returnValue?(this.Kte.remove(Je.requestId),
Ie(ad)):l.ULS.sendTraceTag(537151250,306,10,`TableIntelligenceManager::ExcelRangeMetadataHandler Callback not found for requestId = ${Je.requestId}`)}else l.ULS.sendTraceTag(537151252,306,10,"TableIntelligenceManager::ExcelRangeMetadataHandler excelRangeMetadata is null.")}};this.hj=sb;this.$=Gc;this.Kte=new wf.a;Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.lge=new Kf(this));this.hj.register(this.hj.RT().NV("TableIntelligence").LV(()=>{}).build())}Hja(){this.K6a||
(this.K6a=new zf(this,this.hj));return this.K6a}async kVi(sb,Gc){if(Oa.EwaSettings.isChangeGateEnabled("OfficeVSO:6648526_LimitCellsInSignal")&&1E4<sb.range.gu)return l.ULS.sendTraceTag(520501002,306,15,`Signal with range size of ${sb.range.gu} exceeds limit of ${1E4}`),4;this.Kxh();if(this.kvj(sb.range))return await this.jZi(sb,Gc);l.ULS.sendTraceTag(537151253,306,15,"Range is not completely contained within the viewport");return 2}Nyd(sb){return(Gc,ad)=>{this.Mfk(this.O4d(sb),ad)}}Jbb(sb,Gc){var ad,
Wd;(null===(Wd=null===(ad=this.$)||void 0===ad?void 0:ad.qa)||void 0===Wd?0:Wd.count)&&100<this.$.qa.count?l.ULS.sendTraceTag(520720838,306,15,`TableIntelligenceManager::addRecognizedTableAnnotationCallback Exceeded max sheet count threshold. SheetCount ${this.$.qa.count}`):(this.e0f||(this.hj.Iea("TableIntelligence",{ls:!0,annotationType:yd.a.getTypeName(),dO:this.Nyd("New"),Rna:this.Nyd("Valid"),jTb:this.Nyd("Invalid")}),this.e0f=!0),this.bBh(sb,Gc),this.Dij())}jrk(sb){this.removeHandler(this.O4d("Valid"),
sb)}bBh(sb,Gc){this.addHandler(this.O4d(sb),Gc)}Jnk(){this.hj.Iea("TableIntelligence",{annotationType:re.getTypeName(),ls:!1,dO:this.Kxi})}Kxh(){this.d0f||(this.d0f=!0,this.Jnk())}Mfk(sb,Gc){1===Gc.operationType&&((Gc=Gc.annotation)?(Gc=Pf(Gc),this.raiseEvent(sb,new Cf(Gc))):l.ULS.sendTraceTag(523772681,306,10,"TableIntelligenceManager::processAndRaiseExcelRecognizedTableAnnotationReceivedEvent ExcelRecognizedTable is null."))}O4d(sb){return`${"RecognizedTableUpdate"}_${sb}`}async jZi(sb,Gc){l.ULS.sendTraceTag(537151248,
306,15,"On-Demand Metadata Triggered");const ad=sb.range,Wd=$a.f(this.$).Np("TableIntelligence",ad,1),je=[],Ie=[];let Je=0;const $e=Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1);this.instantaneousSupportInformationManager||(this.instantaneousSupportInformationManager=await E.a.resolve(M.InstantaneousSupportInformationManagerService));for(;Wd.$$mn();){const Ib=Wd.$$cu();if(!Ib)continue;if(0===Ib.Qh.type&&Ub.a.uu(Ib.Qh.value))continue;Ib.AC&&Ib.range&&Ie.push(Object(u.a)(new Pe.a,
{worksheetId:sb.sheetId,left:Ib.range.left-1,top:Ib.range.top-1,right:Ib.range.right-1,bottom:Ib.range.bottom-1}));const Nb=Ib.range.top-1,Bc=Ib.range.left-1;let Af=null,gf;({category:gf}=this.instantaneousSupportInformationManager.Fna(Ib.cell.oi,!0));Ib.text!=Ib.Qh.value&&(Af=Ib.text,$e&&Je++);je.push(Object.assign(new He,{row:Nb,column:Bc,value:Ib.Qh.value,type:Ib.Qh.type,displayText:Af,Wyl:gf}))}$e&&l.ULS.sendTraceTag(526260166,306,50,`TableIntelligenceManager::getRangeDataFromGrid requests non-null displayText: ${Je}, number of values: ${je.length}, range size: ${ad.height} rows by ${ad.width} columns`);
if(0<je.length)return this.C$h(je,sb,Ie,Gc),Ie.length?5:0;l.ULS.sendTraceTag(537151247,306,15,"All cells in range were empty");return 3}C$h(sb,Gc,ad,Wd){var je=Gc.range;je=Object(u.a)(new Pe.a,{top:je.top,left:je.left,bottom:je.bottom,right:je.right,worksheetId:Gc.sheetId});Gc=Vc.a.create().toString();sb=Object(u.a)(new af,{cells:sb,range:je,mergeCellAddresses:ad,requestId:Gc});this.hj.qvb(sb,"TableIntelligence");this.Kte.add(Gc,Wd)}kvj(sb){const Gc=$a.f(this.$);if(Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",
!1)){const ad=Gc.TT();l.ULS.sendTraceTag(520501001,306,50,`viewportWidth: ${ad.width}, viewportHeight: ${ad.height}`)}return Gc.za.t8(4,this.$.la)&&!!Gc.Ob(sb.topLeft)&&!!Gc.Ob(sb.bottomLeft)&&!!Gc.Ob(sb.topRight)&&!!Gc.Ob(sb.bottomRight)}Dij(){var sb;!this.Abg&&Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.Abg=!0,null===(sb=this.lge)||void 0===sb?void 0:sb.Qeh())}};Vf=Object(n.__decorate)([Object(E.d)(M.TableIntelligenceManagerService),Object(n.__param)(0,
Object(M.AugmentationLoopManagerService)()),Object(n.__param)(1,Object(M.EwaControlService)())],Vf);Object(m.a)(Vf,"TableIntelligenceManager",xf.a,[4,803]);String(c);String(b);String(f);String(k);String(x);String(d);String(h);window.___1717508060500_closurehack=c;window.___1717508060500_closurehack=b;window.___1717508060500_closurehack=f;window.___1717508060500_closurehack=k;window.___1717508060500_closurehack=x;window.___1717508060500_closurehack=d;window.___1717508060500_closurehack=h}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.pid.js.map/20005950ff635ce82d093cea3db9f305/EwaTS.pid.js.map