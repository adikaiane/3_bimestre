'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[37],{1544:function(y,r,a){r=a(490);a=a(1545);a=a.Di?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);r(a,{insert:"head",Oj:!1});y.exports=a.Fk||{}},1545:function(y,r,a){r=a(489)(!1);r.push([y.i,".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}",""]);y.exports=r},801:function(y,r,a){a.r(r);y={};a.r(y);a.d(y,"ResizeCommandHandler",function(){return fa});r=a(1454);
var c=a(133),b=a(0),f=a(15),k=a(189),x=a(491),d=a(44),h=a(429),n=a(213),m=a(134),u=a(43),l=a(255),t=a(1),e=a(266),w=a(63),z=a(25);class E{constructor(ta,pa){this.isRow=!1;this.autoFitRange=null;this.isRow=ta;this.autoFitRange=pa}}Object(b.a)(E,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[67]);class M{constructor(ta){this.resizeParameters=null;this.resizeParameters=ta}}Object(b.a)(M,"MacroRecorderSheetRowsColumnsResizedPayload",null,[67]);var G=a(154),A=a(431),N=a(70),K=a(12),I=a(28),L=a(13),
J=a(10);class B{constructor(ta){this.OCd=ta}Hif(ta){ta=K.HelperMethods.WQc(ta);return Math.max(0,Math.min(B.Feg,ta))}tif(ta){return this.Gbk(ta)}R_h(ta){return Math.round(this.OCd*ta+2*this.cIf()+1)}Gbk(ta){return Math.max(0,Math.min(B.heg,(Math.max(0,Math.min(J.a.DLc,ta))-2*this.cIf()-1)/this.OCd))}cIf(){return Math.floor(Math.max((this.OCd+3)/4,2))}qAc(ta,pa){return pa?ta?B.Feg:J.a.j5d:ta?B.heg:J.a.DLc}}B.Feg=409;B.heg=255;Object(b.a)(B,"ResizeHeadersConverter",null,[]);class Y extends A.a{constructor(ta,
pa){super(ta);this.Fca=(Ga,Ca)=>{Ga=this.kMd(Ga,Ca);return this.fJd(Ga)};this.$yk=(Ga,Ca)=>{var kb=this.XVb=Ca[Y.Toj];1===Ga?(Ga=Ca[Y.bYk],kb=this.dPf(Ga,kb),f.ULS.shipAssertTag(537153996,0,kb!==Y.oka,`ResizeHeadersDialogHandler - invalid size input, size = ${Ga}`),Ga=kb!==this.sTd,f.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",this.isRow,this.XVb,kb,Ga),Ga&&this.G5h(kb)):f.ULS.sendTraceTag(537153994,
0,50,`ResizeHeadersDialog Cancel button pressed, isRow = ${this.isRow}.`)};this.isRow=2040891415===pa.command;this.da=z.f(this.$);this.hVc=new B(this.$.workbookContext.DxDigitNormal);this.sTd=this.QTh();ta=this.i4h(this.sTd);pa=this.k4h(this.sTd);this.dialogTitle=L.a.instance.ia(this.isRow?478:479);ta=this.qN(ta,pa);this.initializeAndShow(this.dialogTitle,this.$yk,ta);f.ULS.sendTraceTag(537153997,0,50,`ResizeHeaders React Dialog opened, isRow = ${this.isRow}.`)}get Tc(){return"ResizeHeadersDialog"}get XVb(){return Y.UPe}set XVb(ta){Y.UPe=
ta}qN(ta,pa){return{[Y.CQ]:this.Tc,[Y.bwj]:this.isRow,[Y.Kgj]:ta,[Y.Jgj]:pa,[Y.msj]:this.XVb,[Y.iMd]:this.Fca}}QTh(){const ta=this.JIi();try{return this.VNi(ta)}finally{ta&&ta.dispose()}}G5h(ta){const pa={};pa.SheetMultiRange=d.u(this.da.ha.oa.selectedRanges,this.$);Y.Dpe(pa,this.isRow,ta);this.$.Dc(this.isRow?745189930:-445963340,N.a.Hb,8,{["resizeRowColumnParameters"]:pa})}dPf(ta,pa){return I.a.uda(ta)?pa?this.h4h(ta):this.j4h(ta):Y.oka}j4h(ta){return Math.floor(parseFloat(ta))}h4h(ta){ta=parseFloat(ta);
return 0>ta?Y.oka:ta?this.isRow?K.HelperMethods.Qbk(ta):this.hVc.R_h(ta):0}k4h(ta){return ta===Y.oka?"":this.isRow?this.hVc.Hif(ta).toString():this.hVc.tif(ta).toFixed(2)}i4h(ta){return ta===Y.oka?"":ta.toString()}VNi(ta){if(!ta||!ta.$$mn()||!ta.Go)return Y.oka;var pa=Object(G.a)(818,ta.Go);if(!pa)return Y.oka;for(pa=this.isRow?pa.fka:pa.OYa;ta.$$mn();){const Ga=Object(G.a)(818,ta.Go);if(Ga&&(this.isRow?Ga.fka:Ga.OYa)!==pa)return Y.oka}return pa}JIi(){const ta=[];for(const Ga of this.da.ha.oa.selectedRanges){const Ca=
Ga.clone();var pa=this.da.pg(this.da.rb.Yh(Ca));pa=Ca.Xe(pa.Ek);if(!pa)return null;this.isRow?Ca.right=Ca.left=pa.left:Ca.top=Ca.bottom=pa.top;ta.push(Ca)}return ta.length?this.da.Hba("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",ta):null}kMd(ta,pa){if(!I.a.uda(ta))return 1;ta=this.dPf(ta,pa);return 0!==ta||this.da.hd.Zbf(this.da.ha.oa.selectedRanges,this.isRow)?this.Nyj(ta)?0:2:3}fJd(ta){let pa="";switch(ta){case 0:pa="";break;case 1:pa=L.a.instance.ia(767);break;case 2:pa=String.format(L.a.instance.Ib(99),
0,this.qAc(this.XVb));break;case 3:pa=L.a.instance.ia(768)}return pa}Nyj(ta){return 0<=ta&&ta<=this.qAc(!1)}qAc(ta){return this.hVc.qAc(ta,this.isRow)}static Dpe(ta,pa,Ga){if(pa){ta.ColumnWidth=Y.oka;ta.RowHeight=Ga;for(const Ca of ta.SheetMultiRange.Ranges)Ca.FirstColumn=0,Ca.LastColumn=0}else{ta.RowHeight=Y.oka;ta.ColumnWidth=Ga;for(const Ca of ta.SheetMultiRange.Ranges)Ca.FirstRow=0,Ca.LastRow=0}}}Y.CQ="id";Y.bwj="isRow";Y.Kgj="initialSizeInPx";Y.Jgj="initialSizeInDefaultUnits";Y.msj="isInitialUnitsDefaultUnits";
Y.iMd="getInputErrorIfInvalid";Y.bYk="size";Y.Toj="isDefaultUnits";Y.oka=-1;Y.UPe=!0;Object(b.a)(Y,"ResizeHeadersDialog",A.a,[]);var U=a(61);const O=(ta,pa,Ga,Ca,kb,eb,Yb=null)=>{Yb=ta.$a(41,Yb);Yb.resizeRowColumnParameters=pa;return U.h(ta,"ResizeRowsColumns",Yb,Ga,Ca,kb,eb,0)};var C=a(81),X=a(329),S=a(36),ea=a(369),Oa=a(98),Ha=a(5),Za=a(65);let fa=class{constructor(ta,pa,Ga,Ca){this.Y3j=(kb,eb)=>{if(!l.a(kb)&&eb){const Yb=!!kb&&!!kb.RequestTelemetryData;z.f(this.$).Ce.UY(eb,kb.StateId,Yb?kb.RequestTelemetryData.EcsOperationDuration:
0,Yb?kb.RequestTelemetryData.EcsRequestDuration:0,Yb?kb.RequestTelemetryData.WfeRequestDuration:0)}};this.gVj=(kb,eb)=>{Ha.TableSuggestionManagerService.Oa()?void Za.a.resolve(Ha.TableSuggestionManagerService,{xa:1}).then(Yb=>{Yb.c4g(eb)}):u.TaskExtensions.tb(C.GetServiceTaskFactory.Ne(this.$.ra,534,535,1),Yb=>{Yb.result.c4g(eb)},this.$.Aa,3)};this.$=ta;this.$e=pa;this.gridInstantaneousAction=Ga;this.grid=z.f(this.$);this.YQb=Ca}gd(ta,pa){ta=!0;switch(pa){case -445963340:case 1391094586:ta=this.ie(8);
break;case 745189930:case 146338636:ta=this.ie(16)}return!ta}executeCommand(ta,pa,Ga){var Ca=z.f(this.$),kb=pa.command;ta=k.a.create().toString();var eb=u.TaskExtensions.kl();switch(kb){case 1391094586:case 146338636:eb=1391094586===kb;(ta=Ga.autoFitRanges)&&ta.Ranges&&ta.Ranges.length||(ta=d.u(Ca.ha.oa.selectedRanges,this.$));eb=this.Fii(eb?1:0,ta,pa);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:eb=-445963340===kb||-706918724===kb||369708605===
kb;var Yb=t.EwaSettings.vlb()||t.EwaSettings.hIa(),Gb=t.EwaSettings.zGc();(Yb&&-706918724===kb||Gb&&1051390410===kb)&&Ca.Ce.ML(18,ta,x.a(kb));if(-445963340===kb||745189930===kb){var Mb=x.a(pa.command);Ca.Ce.ML(16,ta,Mb);var Rb=Ga.resizeRowColumnParameters}else{Ga=t.EwaSettings.T5f()&&(369708605===kb||1542466017===kb)&&Ga.rangeToUnhide?[Ga.rangeToUnhide]:Ca.ha.oa.selectedRanges;Ca=0;Yb=!1;Gb="";let fb=!1;const Sb=t.EwaSettings.BUb();Sb&&(Gb=x.a(pa.command),Yb=1<Ga.length?!0:!1);for(var $b of Ga){if(Sb&&
this.YQb){var cc=this.grid.za.OT($b);this.YQb.pnd(cc,Gb)}if(-706918724===kb||369708605===kb)cc=$b.right-$b.left+1,Ca+=0<cc?cc:-1*cc;else if(1542466017===kb||1051390410===kb)fb=!0,Ca+=$b.bottom-$b.top+1}Sb&&this.YQb&&(this.YQb.h3e(Ca,Gb),this.YQb.h2e(Gb,fb,Ca,Ga[0],pa.command));if(369708605===kb||1542466017===kb){if(f.ULS.sendTraceTag(520938758,0,50,`ResizeCommandHandler.doResize: Unhide Rows/Columns NumberOfRanges=${Ca}, isDiscontinuous=${Yb}`),t.EwaSettings.isChangeGateEnabled("OfficeVSO:8373854_LogUnhideButtonClickOnNoHiddenRangePresent")){Ca=
$b=!1;Yb=this.grid.hd;for(Rb of Ga)if($b=Rb.isRow&&Yb.pva(Rb),Ca=Rb.Oe&&Yb.yZa(Rb),$b||Ca)break;$b||Ca||f.ULS.sendTraceTag(508061769,0,50,"ResizeCommandHandler.doResize: unhide Rows/Columns clicked when no hidden range in selected range")}}else-706918724!==kb&&1051390410!==kb||f.ULS.sendTraceTag(520938757,0,50,`ResizeCommandHandler.doResize: hide Rows/Columns NumberOfRanges=${Ca}, isDiscontinuous=${Yb}`);kb=369708605===kb||1542466017===kb?-2:0;Rb={};Rb.SheetMultiRange=d.u(Ga,this.$);if(eb)for(Mb of Rb.SheetMultiRange.Ranges)Mb.FirstRow=
0,Mb.LastRow=0;else for(const kc of Rb.SheetMultiRange.Ranges)kc.FirstColumn=0,kc.LastColumn=0;Rb.RowHeight=eb?-1:kb;Rb.ColumnWidth=eb?kb:-1}eb=this.Yii(Rb,pa,ta,eb);break;case 957527587:case 2040891415:t.EwaSettings.isChangeGateEnabled("OfficeVSO:8202953_HomeTabCleanUpTelemetry")&&"Home"===pa.tabName&&Oa.b("HomeTabFormat"),new Y(this.$,pa)}return eb}Rc(ta,pa,Ga,Ca){if(ta=!!Ga&&!!Ca&&1===Ca.DH)switch(pa.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;
default:ta=!1}return ta}td(){return!1}MFj(ta){f.ULS.sendTraceTag(537154004,0,50,`ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: ${Object(X.c)(ta)}. Reason: ${Object(X.c)(ta)?void 0:ta.reason}.`)}ie(ta){return(new m.SheetProtection(this.$.qa)).ie(ta)}Fii(ta,pa,Ga){const Ca=this.$.ma.sa.mc(),kb=0===ta,eb=()=>new E(kb,pa);return h.a(this.$.userOperationManager,(Yb,Gb,Mb)=>{var Rb=this.$.ma.sa;Yb=e.c(Yb,this.gVj);var $b={Pnj:!kb,Grd:pa};const cc=Rb.$a(41,Ca);cc.isRow=kb;cc.autoFitRanges=
pa;return U.h(Rb,"AutoFit",cc,Yb,Gb,Mb,$b,0)},Yb=>new n.a(135,0,Yb,void 0,eb),Ga)}Yii(ta,pa,Ga,Ca){const kb=pa.command,eb=z.f(this.$),Yb=d.i(ta.SheetMultiRange.Ranges);if(t.EwaSettings.isChangeGateEnabled("OfficeVSO:7428186_HideLastRowCol")){var Gb=-706918724===kb||-445963340===kb&&0===ta.ColumnWidth,Mb=eb.hd;if((1051390410===kb||745189930===kb&&0===ta.RowHeight||Gb)&&!Mb.Zbf(Yb,!Ca))return this.Jhi(Ca),u.TaskExtensions.kl()}let Rb;Gb=(t.EwaSettings.vlb()||t.EwaSettings.hIa())&&-706918724===kb;Mb=
t.EwaSettings.zGc()&&1051390410===kb;let $b=void 0;if(745189930===kb||-445963340===kb||Gb||Mb)f.ULS.shipAssertTag(537154002,0,this.$.activeItemName===ta.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!"),Gb||Mb?(this.gridInstantaneousAction.NSc(),$b=()=>{eb.Ce.Oda();this.gridInstantaneousAction.wnc(kb,!Ca)}):(Rb=this.$e.ete(eb,Yb,Ca?ta.ColumnWidth:ta.RowHeight,!Ca),this.MFj(Rb),Object(X.c)(Rb)&&eb.Ce.LO(Ga,w.BasicTelemetryCalculator.zN));const cc=this.$.ma.sa.mc({hla:!0,
lka:3});Gb=(Sb,kc,na)=>{this.$.Qw();d.k(Yb,",",this.$,!1);return O(this.$.ma.sa,ta,e.c(Sb,this.Y3j),kc,e.a(na,()=>{window.setTimeout(()=>{$b&&$b()},0)}),Ga,cc)};const fb=()=>new M(ta);return Rb&&Object(X.c)(Rb)?h.a(this.$.userOperationManager,Gb,Sb=>new n.a(136,0,Sb,64,fb),pa):h.a(this.$.userOperationManager,Gb,Sb=>new n.a(136,0,Sb,void 0,fb),pa)}Jhi(ta){ta=S.a.Cd(1,0,ta?769:771,ta?770:772,0,ta?-2037763134:503471870,ta?"HideAllColumnsError":"HideAllRowsError");new ea.a(this.$,ta)}};fa=Object(c.__decorate)([Object(Za.d)(Ha.ResizeCommandHandlerService),
Object(c.__param)(0,Object(Ha.EwaControlService)()),Object(c.__param)(1,Object(Ha.FormatCellsActionService)()),Object(c.__param)(2,Object(Ha.GridInstantaneousActionService)()),Object(c.__param)(3,Object(Ha.GridActionTelemetryManagerService)())],fa);Object(b.a)(fa,"ResizeCommandHandler",null,[29]);var la=a(9);c=a(430);var ba=a(20),aa=a(72),oa=a(7),Na=a(31);class Ia{}Object(b.a)(Ia,"ResizeClassNames",null,[]);var Sa=a(653),Pa=a(16),za=a(39),wa=a(242),db=a(150),Ba=a(27),Ka=a(64),da=a(17),sa=a(71);A=
a(105);var mb=a(330),Ma=a(151),hb=a(433),$a=a(45),Va=a(115),xa=a(173);class ia extends A.a{constructor(ta,pa){super(pa.domElement);this.Loa=this.EKg=!1;this.Xq=this.SWb=this.u6a=null;this.Gke=!0;this.YHc=!1;this.$m=this.offset=0;this.aU=this.Jxa=this.Avb=null;this.Bbj="headerResizeTooltip";this.K4=this.l3d=null;this.Jrd=this.ZPa=this.Ksb=!1;this.xvg=this.Zpb=J.a.YYa;this.sac=!1;this.XHc=t.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ResizeHeaderUXModernization",!1);this.Z3f=t.EwaSettings.isChangeGateEnabled("OfficeVSO:8511759_RemoveResizeTooltip");
this.gZa=t.EwaSettings.gZa();this.uIa=t.EwaSettings.uIa();this.I0g=t.EwaSettings.isChangeGateEnabled("OfficeVSO:8991381_synchronouslyUpdateResizeHighlight");this.d2=t.EwaSettings.LQ()&&t.EwaSettings.ZWd();this.z_a=t.EwaSettings.z_a();this.UHc=t.EwaSettings.UHc();this.ZYd=!1;this.lre=!0;this.SWj=Ga=>{Ga=Va.a().Qf(Ga);this.Jrd&&this.Odj(Ga);if((Ga.Ha.type.includes("touch")||Ga.Ha.button===Sys.UI.MouseButton.leftButton)&&this.vIa){sa.g(Ga.Ha);this.jtf();Ga=this.Zpb;var Ca=Ga!==this.$m;this.Xq&&!Ca&&
this.sac&&(this.nf.removeRowColFromModel(this.Xq.nbb,this.Xq.sLa),this.nf.Hna(this.grid.ha.oa.selectedRanges),this.nf.Jl("HeaderResizeBehavior::onDocumentMouseUp"));if(this.u6a&&Ca&&Ga!==J.a.YYa){Ga=this.grid;var kb=this.XMf(Ga);Ca={};Ca.SheetMultiRange=d.u(kb,Ga.$);ia.Dpe(Ca,this.isRow,this.$m);kb=this.Xq?this.Xq.nbb:-1;const eb=Ca.SheetMultiRange.Ranges[0],Yb=ia.Dka()&&0===this.$m?20:50;f.ULS.sendTraceTag(509694147,2,Yb,`HeaderResizeBehavior.OnDocumentMouseUp: cellAbsoluteIndex=${kb}, isResizingHiddenHeader=${this.ZPa}, headerViewBlockHashCode=${this.nf.hashCode},
          rangeFirstRow=${eb.FirstRow}, rangeFirstColumn=${eb.FirstColumn}, rangeLastRow=${eb.LastRow}, rangeLastColumn=${eb.LastColumn},`);this.Omi(Ca);Ga.F2k=!0}else this.ph(null,null),this.ITc();this.sac=this.ZPa=!1;this.gZa&&this.Upc("onDocumentMouseUp")}};this.Nng=Ga=>{this.Loa?(this.ZPa&&!this.sac&&(this.Qzh(),this.nf.Jl("HeaderResizeBehavior::onHeaderResizeChanged")),this.YHc||this.Eij(),Ga=new Sys.UI.DomEvent(Ga),Ga=Sa.a.create(Pa.a.fTa,this.domElement,Ga,2),Ga=Va.a().Qf(Ga),this.Ong(Ga.clientPoint),
this.lre&&(this.lre=!1,this.nf.lUg()&&(this.nf.eKh(),this.r1f=!0))):f.ULS.sendTraceTag(521480320,2,50,`HeaderResizeBehavior.onHeaderResizeChanged: Reached during no resize mode. cellAbsoluteIndex = ${this.Xq?this.Xq.nbb:-1}, isRow = ${this.isRow}`)};this.Png=Ga=>{Ga=new Sys.UI.DomEvent(Ga);Ga=Sa.a.create(Pa.a.fTa,this.domElement,Ga,2);this.SWj(Ga)};this.S_j=Ga=>{var Ca;if(ia.Dka()&&!this.Xq){Ga=!!this.nf;const kb=null===(Ca=this.nf)||void 0===Ca?void 0:Ca.hashCode;f.ULS.sendTraceTag(508368662,2,15,
`HeaderResizeBehavior.onHeaderResizeTouchStart: cellBeingResized is not set and we don't know which cell needs to be resized. this.isRow=${this.isRow}, isViewBlockSet=${Ga}, this.viewBlock.hashCode=${kb}`)}else this.dKa(Ga,this.Xq,!1)};this.Hw=()=>{this.ITc()};this.ph=()=>{if((3===N.a.Hb||za.a.ot)&&this.grid.ha.oa.vi){var Ga=this.grid.ha.oa.Ed;if(!(!Ga.isRow&&!Ga.Oe||!this.domElement||Ga.isRow&&this.isRow&&!this.nf.$T.includes(Ga.top)||Ga.Oe&&!this.isRow&&!this.nf.$T.includes(Ga.left))){var Ca=this.grid.Wg(Ga,
this.nf.Wl.paneType);if(Ca){var kb=this.isRow?Ga.bottom:Ga.right;(this.Xq=this.nf.Ex(Ba.Range.Hc(Ga.bottom,Ga.right)))?(this.K4||this.ibi(),Ga.isRow&&this.isRow?(this.eYc(!0,"onSelectionEnded"),this.K4.style.top=Ca.bottomRight.y-this.K4.offsetHeight/2+"px"):Ga.isRow||this.isRow||(this.eYc(!0,"onSelectionEnded"),mb.c(this.K4.style,this.grid.rtl,Ca.bottomRight.x-this.K4.offsetWidth/2+"px"))):f.ULS.sendTraceTag(522826880,2,ia.Dka?15:50,`HeaderResizeBehavior.onSelectionEnded: Cell being resized is undefined. Couldn't create touch resizer. Absolute index ${kb}, is row ${this.isRow}`)}}}};
this.bV=(Ga,Ca)=>{t.EwaSettings.isChangeGateEnabled("OfficeVSO:6385697_HeaderResize_LogOnPartialInteractivityStatusChanged")&&f.ULS.sendTraceTag(521787422,2,50,`HeaderResizeBehavior.onPartialInteractivityStatusChanged: was called. isActivated ${Ca.DJ}`);Ca.DJ&&this.lIb()};this.nf=pa;this.isRow=pa.isRow;this.rtl=pa.Wl.rtl;this.grid=ta;this.AKj=this.isRow?J.a.j5d:J.a.DLc;this.wbj=L.a.instance.ia(436);this.Fbj=L.a.instance.ia(435);this.zbj=L.a.instance.ia(437);Ma.a(this.grid.$,Ga=>{this.l3d=Ga.tX(db.a.hzk,
!1)});this.grid.ha.ZS(this.ph);this.grid.ha.vqa(this.Hw);this.grid.aw(this.ph);$a.a(this.grid.$).hg.Cha(this.bV)}get vIa(){return this.Loa}get q4a(){var ta,pa;return null!==(pa=null===(ta=this.Xq)||void 0===ta?void 0:ta.sLa)&&void 0!==pa?pa:-1}get izk(){this.Mni();return ia.Lsb}P_j(ta){t.EwaSettings.z_a()&&!this.vIa&&this.Jyj(ta.sLa)&&this.nf.fYc(ta.sLa,!1)}T_j(ta,pa){this.z_a&&(this.UHc?this.jSk(ta):!this.vIa)&&this.nf.fYc(ta.sLa,pa)}dKa(ta,pa,Ga){var Ca,kb=new Sys.UI.DomEvent(ta);kb=Sa.a.create(Pa.a.fTa,
this.domElement,kb,2);kb=Va.a().Qf(kb);this.Uyg(pa,kb.clientPoint.x,kb.clientPoint.y,!1,Ga,ta);this.d2&&(null===(Ca=Za.a.Cb(Ha.HeaderInsertService))||void 0===Ca?void 0:Ca.oRf(!0));ta=this.wte();this.VEf(this.u6a,ta,!0);this.Ksb||(ta=this.domElement.ownerDocument.body,ta.addEventListener("pointermove",this.Nng),ta.addEventListener("pointerup",this.Png),this.Ksb=!0)}O_j(ta,pa,Ga){this.Uyg(pa,ta.clientX,ta.clientY,!0,Ga,ta);ta=this.grid;pa=this.XMf(ta);pa=d.u(pa,ta.$);this.XHc?ta.Ub.rl([this.isRow?
51:52]):ta.Ub.rl([this.isRow?13:14]);ta.Ub.wfa();this.ITc();ta.$.Dc(this.isRow?146338636:1391094586,N.a.Hb,30,{["autoFitRanges"]:pa})}dispose(){this.Upc("dispose");this.grid.ha&&(this.grid.ha.rV(this.ph),this.grid.ha.tma(this.Hw));this.grid.Zz(this.ph);$a.a(this.grid.$)&&$a.a(this.grid.$).hg.Mea(this.bV);this.Ksb&&(this.Ksb=!1);this.K4&&(ia.Dka()?this.BGg("dispose"):(this.Upc(""),this.K4=null));this.EKg&&(da.DOMElementExtensions.vh(ia.Lsb),ia.Lsb=null);this.nf=null;super.dispose()}Mni(){if(!ia.Lsb){document.getElementById(ia.DKg);
this.EKg=!0;var ta=ia.Lsb=document.createElement("div");this.grid.$.frame.yja().appendChild(ta);ta.id=ia.DKg;ta.className=Na.a.Csi;da.DOMElementExtensions.setVisible(ta,!1)}}jSk(ta){if(this.vIa)return!1;if(ta.sLa+1<this.nf.$T.length)return!0;const pa=this.nf.isRow;if(pa?this.grid.rb.Ijb:this.grid.rb.CRb){const Ga=pa?this.grid.rb.Gg:this.grid.rb.Vg;ta=this.grid.hd.VT(ta.nbb+1,pa,!0);if(ia.lWb(ta,pa)&&Ga===ta)return!1}return!0}Jyj(ta){return-1<=ta?!0:!1}jtf(){var ta;if(this.Ksb){const pa=this.domElement.ownerDocument.body;
pa.removeEventListener("pointermove",this.Nng);pa.removeEventListener("pointerup",this.Png);this.Ksb=!1}this.Loa=!1;t.EwaSettings.z_a()&&this.nf.fYc(this.Xq.sLa,!1);this.ork();hb.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation");this.d2&&(null===(ta=Za.a.Cb(Ha.HeaderInsertService))||void 0===ta?void 0:ta.oRf(!1))}tAk(){this.XHc?this.ZYd?(this.ZYd=!1,this.grid.Ub.rl(this.isRow?[49,51]:[50,52])):this.grid.Ub.rl(this.isRow?[51]:[52]):this.grid.Ub.rl([this.isRow?13:14]);this.grid.Ub.wfa()}Qzh(){this.nf.addRowColToModel(this.Xq.nbb-
1,this.Xq.sLa);this.sac=!0}Ong(ta){if(this.Loa){var pa=this.isRow,Ga=pa?ta.y-this.u6a.y:(this.rtl?-1:1)*(ta.x-this.u6a.x),Ca=this.Zpb;Ca!==J.a.YYa&&(pa?ta.y-this.SWb.y:(this.rtl?-1:1)*(ta.x-this.SWb.x))&&(0<this.$m||0<Ca+Ga)&&Ca+Ga<=this.AKj&&(this.$m=this.wte(Ga),this.VEf(ta,this.$m,!1),this.$m>=ia.tTf?(this.Gke=!0,this.Xq.setCellExtent(this.$m)):this.Gke&&(this.Gke=!1,this.Xq.setCellExtent(ia.tTf)),Ga=this.xvg+Math.max(Ga,-this.Zpb+ia.SBc),da.DOMElementExtensions.Pwb(this.Xq.nf.domElement,!pa,Ga),
this.Xq.nf.jIk(Ga),this.SWb=new Sys.UI.Point(ta.x,ta.y),this.eYc(!1,"onHeaderResizeChangedInternal"))}}eYc(ta,pa){var Ga;da.DOMElementExtensions.setVisible(this.K4,ta);ia.Dka()&&f.ULS.sendTraceTag(508150752,2,50,`HeaderResizeBehavior.setTouchResizerVisible: called with visible: ${ta}. caller:${pa} isRow: ${this.isRow}, blockHash: ${null===(Ga=this.nf)||void 0===Ga?void 0:Ga.hashCode}`)}kXa(){return this.Xq?this.ZPa?ia.Pbj:this.Xq.kXa():J.a.YYa}VEf(ta,pa,Ga){this.Z3f||(this.aU&&Ga&&(f.ULS.sendTraceTag(537154051,
2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),this.uGg()),this.aU||Ga||f.ULS.sendTraceTag(537154050,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead"),this.l3d&&this.l3d(()=>({["Location"]:"canvas"})),this.aU?this.cFf(pa):(this.aU=document.createElement("div"),this.aU.id=this.Bbj,this.cFf(pa),this.aU.className=Na.a.Hri,pa=document.getElementById(this.grid.$.Oc+
oa.a.hgg),pa.insertBefore(this.aU,pa.firstChild),ta=Va.a().B7(ta),this.aU.style.left=(this.rtl?Math.max(ta.x-this.aU.offsetWidth,0):ta.x-Math.max(ta.x+this.aU.offsetWidth-pa.offsetWidth,0)).toString()+"px",this.aU.style.top=(ta.y-this.aU.offsetHeight).toString()+"px"))}uGg(){this.Z3f||(da.DOMElementExtensions.vh(this.aU),this.aU=null)}cFf(ta){var pa=new B(this.grid.$.workbookContext.DxDigitNormal);pa=this.isRow?pa.Hif(ta).toFixed(2):pa.tif(ta).toFixed(2);this.aU.innerText=`${this.isRow?this.wbj:this.Fbj} ${pa} (${ta.toString()} ${this.zbj})`}Uyg(ta,
pa,Ga,Ca,kb,eb){this.Loa=!0;this.ZPa=kb;this.Xq=ta;this.mbg("prepareResizeOperation");this.YHc=!1;this.u6a=this.SWb=new Sys.UI.Point(pa,Ga);ta=this.Xq.getRange();this.Jxa=kb?this.AHh(ta):ta;this.Zpb=this.kXa();this.xvg=this.isRow?this.Xq.nf.NM:this.Xq.nf.OM;kb={["IsResizingHiddenHeader"]:this.ZPa,["IsAutoFitting"]:Ca,["NumberOfSelectedRanges"]:this.grid.ha.oa.gR,["Location"]:"canvas",["ResizeRange"]:this.Jxa,["ResizedCellAbsoluteIndex"]:this.Xq.nbb,["HeaderViewBlockHashCode"]:this.nf.hashCode};Ma.b(this.grid.$).Jd(db.a.Zyk,
kb);this.grid.BTk&&(Ca=Ca?"header_resize_autofit":"header_resize_start",xa.b(this.grid.$).kq(eb,Ca,void 0));this.offset=this.Xq.XGa();this.$m=this.Zpb;this.$m!==J.a.YYa&&hb.c(this.grid.$,!1,"HeaderResizeBehavior:prepareResizeOperationInternal")}AHh(ta){return this.isRow?new Ba.Range(ta.top-1,ta.left,ta.top-1,ta.right,!1,!0):new Ba.Range(ta.top,ta.left-1,ta.bottom,ta.left-1,!1,!0)}XMf(ta){const pa=this.Jxa,Ga=ta.ha.oa.selectedRanges;if(ta.ha.oa.XLb(pa))if(this.isRow){if(wa.a.all(Ga,Ca=>Ca.isRow))return Ga}else if(wa.a.all(Ga,
Ca=>Ca.Oe))return Ga;return[pa]}wte(ta=0){const pa=this.grid;var Ga=this.nf.Wl.paneType;var Ca=this.isRow?3===Ga?[3,2]:[1,4]:4===Ga?[2,4]:[1,3];const kb=Math.max(Math.max(this.Zpb,0)+ta,0);this.XHc?0===ta?ta=[this.isRow?51:52]:(this.ZYd=!0,ta=[this.isRow?49:50]):ta=[this.isRow?13:14];pa.Ub.pn(new Ba.Range(1,1,J.a.sf,J.a.rf,!1,!0),ta,!1);if(this.uIa){Ga=new Map;for(var eb of Ca)Ca=pa.pg(eb),Ca=this.isRow?new aa.a(Ca.ul.topLeft.x,this.offset,Ca.aq.x,kb):new aa.a(this.offset,Ca.ul.topLeft.y,kb,Ca.aq.y),
Ga.set(eb,Ca);pa.Ub.Iq(ta,null,null,this.I0g,!0,Ga)}else eb=pa.WUi(Ga,this.isRow),eb=this.isRow?new aa.a(0,this.offset,eb,kb):new aa.a(this.offset,0,kb,eb),pa.Ub.Iq(ta,eb,Ca,this.I0g?!0:void 0);return kb}Upc(ta){this.Jxa=this.u6a=this.SWb=null;if(this.Avb){const pa=this.Avb.parentNode;if(pa)for(pa.removeChild(this.Avb);this.Avb.firstChild;)pa.appendChild(this.Avb.firstChild);this.Avb=null}ia.Dka()?this.Xq&&(this.Xq=null,this.mbg("clearResizeState::"+ta)):this.Xq=null;this.lre=!0;this.Loa=!1}ork(){this.YHc=
!1;this.uGg();this.r1f&&(this.nf.Pqk(),this.r1f=!1);da.DOMElementExtensions.setVisible(ia.Lsb,!1);this.eYc(!1,"removeResizeArtifacts");this.tAk()}Eij(){this.YHc=!0;const ta=this.izk;da.DOMElementExtensions.setVisible(ta,!0);ta.style.cursor=this.XHc?this.isRow?"ns-resize":"ew-resize":this.isRow?Na.a.$vf:Na.a.Tuf;this.wte()}Omi(ta){this.grid.$.Dc(this.isRow?745189930:-445963340,N.a.Hb,30,{["resizeRowColumnParameters"]:ta})}ibi(){const ta=document.createElement("div");ta.className=Na.a.ati;const pa=
document.createElement("div");pa.className=ba.a.H0;ta.appendChild(pa);const Ga=document.createElement("img");Ga.src=Ka.a.Lh(0);Ga.className=this.isRow?ba.a.Bsi:ba.a.wsi;pa.appendChild(Ga);this.nf.JA.domElement.parentNode.insertBefore(ta,this.nf.JA.domElement);ta.addEventListener("pointerdown",this.S_j);da.DOMElementExtensions.setVisible(ta,!1);this.K4=ta}mbg(ta){ia.Dka()&&!this.Xq&&f.ULS.sendTraceTag(508368661,2,20,`HeaderResizeBehavior.logUndefinedCellBeingResized: Cell being resized is undefined. caller: ${ta}`)}ITc(){ia.Dka()&&
!this.Xq||this.Upc("removeResizer");this.BGg("removeResizer")}BGg(ta){var pa,Ga,Ca,kb;if(this.K4){const eb=null===(Ca=null===(Ga=null===(pa=this.nf)||void 0===pa?void 0:pa.JA)||void 0===Ga?void 0:Ga.domElement)||void 0===Ca?void 0:Ca.parentNode;ia.Dka()&&eb?eb.removeChild(this.K4):this.nf.JA.domElement.parentNode.removeChild(this.K4);this.K4=null;ia.Dka()&&f.ULS.sendTraceTag(508150751,2,50,`HeaderResizeBehavior.removeTouchResizer: Touch resized removed. Was called from caller:${ta}.isRow: ${this.isRow}, blockHash: ${null===
(kb=this.nf)||void 0===kb?void 0:kb.hashCode}, is flowContainer define: ${!!eb}`)}}lIb(){this.Loa&&(this.Ong(this.u6a),this.jtf(),this.ITc(),this.sac=this.ZPa=!1)}Odj(ta){(ta=ta.Ha.rawEvent)&&ta.detail===ia.DEk&&(ta.type===Pa.a.wt?(this.Loa=!1,this.Jrd=!0):ta.type===Pa.a.$N&&(this.Loa=!0,this.Jrd=!1))}static h8h(ta,pa){return new ia(ta,pa)}static Dpe(ta,pa,Ga){if(pa){ta.ColumnWidth=-1;ta.RowHeight=Ga;for(const Ca of ta.SheetMultiRange.Ranges)Ca.FirstColumn=0,Ca.LastColumn=0}else{ta.RowHeight=-1;ta.ColumnWidth=
Ga;for(const Ca of ta.SheetMultiRange.Ranges)Ca.FirstRow=0,Ca.LastRow=0}}static Dka(){return t.EwaSettings.isChangeGateEnabled("OfficeVSO:8257683_JSCrash_during_touch_resizeV2")}static lWb(ta,pa){pa=pa?J.a.sf:J.a.rf;return 0<ta&&ta<=pa}}ia.SBc=1;ia.tTf=1;ia.Pbj=0;ia.DKg="ewa-rszrbg";ia.DEk=2;ia.Lsb=null;Object(b.a)(ia,"HeaderResizeBehavior",A.a,[826]);class Z extends c.a{constructor(){super();this.ri()}create(){this.Uf(ia.h8h)}static Ea(ta){ta.ra.zc(136,new Z)}}Object(b.a)(Z,"HeaderResizeBehaviorFactory",
c.a,[]);a(1544);(()=>{la.a.wb(ta=>{Z.Ea(ta)})})();String(r);String(y);window.___1717508060509_closurehack=r;window.___1717508060509_closurehack=y}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.rsz.js.map/51c1cb4ce81f13cc418048afc44ae83c/EwaTS.rsz.js.map