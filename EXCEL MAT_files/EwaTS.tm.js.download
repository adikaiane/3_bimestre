'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1098:function(y,r,a){a.d(r,"a",function(){return k});y=a(0);var c=a(15);class b{}Object(y.a)(b,"ExtraInfo",null,[]);class f{}Object(y.a)(f,"PerfOperation",null,[]);class k{constructor(x,d){this.sJ=this.Vn=null;this.Nq=x;this.Rl=d}get en(){return!!this.Vn}get Kc(){return this.Vn?(new Date).getTime()-this.Vn.getTime():0}get id(){throw Error.notImplemented();}start(){this.Vn=new Date;return this.sJ=null}stop(){this.Vn&&
c.ULS.sendTraceTag(4257028,200,50,"Stopwatch stopped: {0}",{["Operation"]:this.Nq,["Target"]:this.Rl,["StartTime"]:this.Vn.toUTCString(),["DurationInMilliseconds"]:this.Kc})}reset(){this.stop();this.sJ=this.Vn=null}Zg(x){return!x||""===x}}Object(y.a)(k,"Stopwatch",null,[92,93])},1099:function(y,r,a){a.d(r,"a",function(){return m});y=a(0);var c=a(15);r=a(952);var b=a(605),f=a(6),k=a(16),x=a(125);class d{constructor(u,l,t,e){this.origin=u;this.data=l;this.source=t;this.Ha=void 0===e?null:e}}Object(y.a)(d,
"MessageEventArgs",null,[]);class h{constructor(u,l){this.Eaa=null;this.r1b=t=>this.BW?this.BW(new d(t.origin,t.data,t.source,t.Ha)):!1;this.yEb=u;this.Ve=l;this.BW=null}get G4(){return this.yEb.value}get $I(){return this.Ve.value}TSa(u,l){this.BW=u;this.Eaa=this.r1b;this.G4.addHandler(k.a.message,this.Eaa,l)}hVa(){this.BW=null;this.G4.removeHandler(k.a.message,this.Eaa)}MHa(u,l){const t=new x.a(0,1,1,()=>{u(l)},7);this.$I.Ag(t)}nTb(u,l){const t=new x.a(0,1,1,()=>{u(l)},7);this.$I.Ag(t)}static get instance(){return h.yca()}static yca(){return new h(new b.a(()=>
f.AFrameworkApplication.G4),new b.a(()=>f.AFrameworkApplication.Rj))}}Object(y.a)(h,"MessageEventHandler",null,[188]);var n=a(973);class m extends r.a{constructor(u,l,t){super(u,l,(void 0===t?null:t)||h.instance,m.MSb)}static MSb(){n.a.sendTraceTag=m.D5b;n.a.debugAssertTag=m.jLb}static D5b(u,l,t,...e){c.ULS.sendTraceTag.apply(null,[u,204,m.CKb(l),t].concat(e))}static jLb(){}static CKb(u){switch(u){case 0:return 200;case 1:return 100;case 2:return 50;case 4:return 15;case 3:return 10;default:return 100}}}
m.Q1b="wdPreviousSession";m.RKb="wdUserSession";Object(y.a)(m,"CommonCrossDocumentMessenger",r.a,[])},1124:function(y,r,a){a.d(r,"a",function(){return c});y=a(0);class c{}c.TCd="stid";c.RCd="iid";c.SCd="DynamicImageProvider.aspx";c.CZ="RequestStartTime";c.isEwaJsSplitEnabled="IsEwaJsSplitEnabled";c.i_a="IsJsSelfProfilerOnBootEnabled";Object(y.a)(c,"WebServiceConstants",null,[])},1210:function(y,r,a){a.r(r);a.d(r,"RenderingFidelityTracker",function(){return m});y=a(133);r=a(0);var c=a(15),b=a(103),
f=a(93),k=a(12),x=a(430);class d extends x.a{constructor(u){super();this.$=u;this.ri()}create(){const {RenderingFidelityTracker:u}=a(1210);let l=this.$.ra.Tb(462);l||(l=this.$.ra.zc(462,new u));this.Uf(l)}}Object(r.a)(d,"RenderingFidelityTrackerFactory",x.a,[]);var h=a(40);x=a(5);var n=a(65);let m=class extends f.a{constructor(){super();this.iMj=3E4;this.dwb={};this.IBe={};this.x$e={};b.Health.instance.addQosPillar("Fidelity")}static Ea(u){u.ra.zc(463,new d(u))}C6e(u,l,t,e){if(!(h.a.instance.Dja()<
this.iMj)){var w=k.HelperMethods.iG(()=>{var z=gridRenderer.CanvasRendererGlobals.analyzeLowRenderingFidelity(l),E=Object.keys(z),M=this.x$e[u];for(var G=0;G<E.length;G++){var A=E[G];this.IBe[A]||(null===M||void 0===M?0:M[A])&&this.dwb[A]&&(this.dwb[A]-=M[A])}this.x$e[u]=z;for(G=0;G<E.length;G++)if(M=E[G],!this.IBe[M])if(A=z[M],this.dwb[M]&&(A+=this.dwb[M]),gridRenderer.CanvasRendererGlobals.hasRenderingFidelityThresholdExceeded(M,A)){this.IBe[M]=!0;z=gridRenderer.CanvasRendererGlobals.getErrorTypeForRenderingFidelityProblem(M);
E=gridRenderer.CanvasRendererGlobals.getVetoForRenderingFidelityProblem(M);G=!("ThickBorder"===M||"MediumBorder"===M);z&&E&&G&&b.Health.instance.recordQosError(z,[E],!1,!0,!0,!1,null);c.ULS.sendTraceTag(527472324,0,50,"Session Vetoed because of : { key:"+M+", isHC:"+t+", scaleFactor:"+e+"}");break}else this.dwb[M]=A});1<w&&c.ULS.sendTraceTag(527472323,1,50,`RenderingFidelityTracker.AnalyzeModelForLowFidelity: Duration for AnalyzeModelForLowFidelity the model, duration=${w}`)}}};m=Object(y.__decorate)([Object(n.d)(x.RenderingFidelityTrackerService)],
m);Object(r.a)(m,"RenderingFidelityTracker",f.a,[588,4])},1257:function(y,r,a){a.d(r,"a",function(){return b});y=a(0);var c=a(15);class b{static tUa(f){f=new Date(f);return c.ULS.vhf([b.Xzh(f.getUTCFullYear()),"-",b.Fbb(f.getUTCMonth()+1),"-",b.Fbb(f.getUTCDate()),"T",b.Fbb(f.getUTCHours()),":",b.Fbb(f.getUTCMinutes()),":",b.Fbb(f.getUTCSeconds()),".",b.J2e(f.getUTCMilliseconds()),"Z"])}static Xzh(f){return 1E3>f?"0"+b.J2e(f):f.toString()}static J2e(f){return 100>f?"0"+b.Fbb(f):f.toString()}static Fbb(f){return 10>
f?"0"+f:f.toString()}}Object(y.a)(b,"UlsUtils",null,[])},288:function(y,r,a){function c(ab){switch(!0){case ab.eB:return wa.MergedCell;case ab.tN:return wa.edh;case ab.Jx:return wa.Formula;case ab.hasAutoFilter:return wa.AutoFilter;case ab.Qja:return wa.PivotFilter;case !!ab.SQc:return wa.PivotTable;case ab.dua:return wa.Comment;case ab.Gjb:return wa.Sparkline;case ab.jYa:return wa.InCellImage;case ab.hasRichText:return wa.Pfh;default:return""}}function b(ab){if(Yb.get(ab))return Yb.get(ab);var Ua=
ab.replace(/-.*/g,()=>"");Ua=Yb.get(Ua);return null!==Ua&&void 0!==Ua?Ua:ab.startsWith("ooux")?"ooux":"other"}a.r(r);var f={};a.r(f);a.d(f,"AppUnloadTelemetryManager",function(){return Za});var k={};a.r(k);a.d(k,"DocumentVisibilityObserver",function(){return aa});var x={};a.r(x);a.d(x,"FontTelemetryManager",function(){return za});var d={};a.r(d);a.d(d,"GridActionTelemetryManager",function(){return db});var h={};a.r(h);a.d(h,"EwaHostMessenger",function(){return Ga});var n={};a.r(n);a.d(n,"InteractivityTrackerService",
function(){return cc});var m={};a.r(m);a.d(m,"PageLoadEngagementInfo",function(){return wb});var u={};a.r(u);a.d(u,"ServiceWorkerRegistrationManager",function(){return Qa});var l={};a.r(l);a.d(l,"TelemetryManager",function(){return gc});var t={};a.r(t);a.d(t,"ValidationTelemetryManager",function(){return cd});var e={};a.r(e);a.d(e,"VirtualGetRangeTelemetryManager",function(){return Vd});var w=a(133),z=a(0),E=a(15),M=a(1248),G=a(58),A=a(33),N=a(145),K=a(156),I=a(1),L=a(307);class J{constructor(ab,
Ua){this.hadConnectivityIssuesDuringUnload=this.wasOfflineDuringUnload=!1;this.timestamp=0;this.dataLossInfo=null;this.wasDataLostDuringUnload=!1;this.inactivityDurationBeforeUnloadSeconds=0;this.workbookHashedId=null;this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=!1;this.wacSessionId=null;this.timeFromLastStatusCode0=this.timeFromLastDisconnectionStart=this.timeFromLastConnectivity=0;this.wasUpdatedOnBeforeUnload=this.wasUpdatedOnUnload=!1;this.lastSilentReopenEndTime=
this.lastSilentReopenStartTime=this.disconnectionSource=null;this.workbookHashedId=ab;this.wasUpdatedOnUnload=this.wasDataLostDuringUnload=this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=!1;this.wacSessionId=Ua}q9b(){return G.a.Nc(this)}}Object(z.a)(J,"AppUnloadInfo",null,[]);var B=a(930),Y=a(118),U=a(676);class O{constructor(ab){this.lostOperationsCount=0;this.mostCommonOperationName=null;this.mostCommonOperationCount=0;this.dataLossReason=null;this.lostOperationsCount=
ab.Uff+ab.z5g;this.dataLossReason=ab.Qbf;this.kTh(ab.eBe)}kTh(ab){const Ua=new B.a(U.a.wQ());let hd=0,qe=0;for(const Ae of ab)Ua.Bb(Ae)||Ua.ga(Ae,0),ab=Ua.ga(Ae,Ua.pa(Ae)+1),ab>hd&&(hd=ab,qe=Ae);hd>this.mostCommonOperationCount&&(this.mostCommonOperationName=Y.a(qe),this.mostCommonOperationCount=hd)}}Object(z.a)(O,"DataLossInfo",null,[]);var C=a(68),X=a(48),S=a(5),ea=a(65),Oa=a(227),Ha;let Za=Ha=class{constructor(ab){this.hqd="AppUnloadInfo";this.Rn=this.$=this.workbookHashedId=this.FD=null;this.gHe=
this.FKe=!1;this.Yf=null;this.OVf=0;this.Fla=(Ua,hd)=>{this.OVf=hd.V0c};this.uug=(Ua,hd)=>{hd.eBe.length&&this.$.gU&&(this.FD.dataLossInfo=new O(hd),this.FD.wasDataLostDuringUnload=!0,this.itb())};this.Hj=()=>{this.Une();this.$.fa.Av(this.Hj)};this.L1a=()=>{var Ua;if(S.AppUnloadTelemetryManagerService.Oa()){const hd=S.DdaFacadeService.Oa()?null===(Ua=ea.a.Cb(S.DdaFacadeService))||void 0===Ua?void 0:Ua.OEc():!!Oa.a(this.$)&&Oa.a(this.$).OEc();this.$.nIc()?this.dialogPromptedOnUnload=!0:hd?this.apiBeforeCloseNotificationEnabledOnUnload=
!0:this.dialogPromptedOnUnload=!1}this.FD.wasUpdatedOnBeforeUnload=!0;this.FD.inactivityDurationBeforeUnloadSeconds=this.Yf.Rvb<Ha.aLj?this.OVf:this.Yf.Rvb;this.p8g()};this.l0b=()=>{this.FD.wasUpdatedOnUnload=!0;this.p8g();Sys.Application.remove_unload(this.l0b)};this.tPc=()=>{this.FD.lastSilentReopenStartTime=A.a.zb.Jc;this.FD.lastSilentReopenEndTime=null;this.itb();this.$.Ul(this.d0b)};this.d0b=()=>{this.FD.lastSilentReopenEndTime=A.a.zb.Jc;this.itb();this.$.tm(this.d0b)};this.localStorage=new L.a;
this.localStorage.Tf()&&(this.$=ab,this.workbookHashedId=C.a(this.$),this.FD=new J(this.workbookHashedId,this.$.ta.UserSessionId),this.Rn=K.a.instance.SP(),this.Rn.Ea("beforeunload",this.L1a),this.$.userOperationManager.GGh(this.uug),this.Yf=this.$.fa.Yf,this.Yf.QCa(this.Fla),Sys.Application.add_unload(this.l0b),this.$.fa.TFb(this.tPc),S.AppUnloadTelemetryManagerService.Oa()?this.Une():ab.fa.ug?this.Une():this.$.fa.Nr(this.Hj))}get dialogPromptedOnUnload(){return this.FKe}set dialogPromptedOnUnload(ab){this.FKe=
ab;this.FD?(this.FD.dialogPromptedOnUnload=ab,this.itb()):this.localStorage.Tf()&&E.ULS.sendTraceTag(537151058,0,10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.Tf()}`)}get apiBeforeCloseNotificationEnabledOnUnload(){return this.gHe}set apiBeforeCloseNotificationEnabledOnUnload(ab){this.gHe=ab;this.FD?(this.FD.apiBeforeCloseNotificationEnabledOnUnload=ab,this.itb()):this.localStorage.Tf()&&E.ULS.sendTraceTag(537151057,0,
10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.Tf()}`)}dispose(){this.$&&this.$.userOperationManager&&this.$.userOperationManager.mvk(this.uug);this.Yf&&(this.Yf.zLa(this.Fla),this.Yf=null);this.Rn.XH();this.$=this.Rn=null}p8g(){this.qNk();this.itb()}qNk(){this.FD.wasOfflineDuringUnload=this.$.Cg.vda;this.FD.timeFromLastConnectivity=N.a(A.a.zb,this.$.Cg.y8f);this.FD.timeFromLastDisconnectionStart=N.a(A.a.zb,this.$.Cg.GAj);
this.FD.disconnectionSource=Enum.toString(M.a,this.$.Cg.disconnectionSource);this.FD.hadConnectivityIssuesDuringUnload=this.$.Cg.Kua;this.FD.timeFromLastStatusCode0=N.a(A.a.zb,this.$.Cg.x8f)}itb(){this.FD.timestamp=Date.now();this.localStorage.s6b(this.hqd,this.FD.q9b())}Une(){const ab=this.localStorage.pXa(this.hqd);if(ab)try{const Ua=G.a.Xj(ab);this.localStorage.cGg(this.hqd);const hd=this.gJj(Ua);E.ULS.sendTraceTag(574677456,0,50,hd)}catch(Ua){E.ULS.sendTraceTag(537151056,0,15,`AppUnloadTelemetryManager.SendLogFromLocalStorage: Exception message: ${Ua.message}`)}else E.ULS.sendTraceTag(574677457,
0,50,"AppUnloadTelemetryManager.SendLogFromLocalStorage: No previous app-unload information")}gJj(ab){const Ua={};Ua.WACSessionID=ab.wacSessionId;Ua.wasRefreshed=this.RXh(ab,this.$.ta.MaxAppReloadDurationIndicatingRefresh);Ua.closedWithDialogConfirmation=ab.dialogPromptedOnUnload;Ua.wasOfflineDuringUnload=ab.wasOfflineDuringUnload;Ua.TimeFromLastConnectivityMs=ab.timeFromLastConnectivity;Ua.TimeFromLastDisconnectionStart=ab.timeFromLastDisconnectionStart;Ua.wasDataLostDuringUnload=ab.wasDataLostDuringUnload;
Ua.DataLossInfo=ab.dataLossInfo;Ua.flushedOnUnload=ab.wasUpdatedOnUnload;Ua.flushedOnBeforeUnload=ab.wasUpdatedOnBeforeUnload;Ua.InactivityDurationBeforeUnload=ab.inactivityDurationBeforeUnloadSeconds;Ua.DisconnectionSource=ab.disconnectionSource;Ua.hadConnectivityIssuesDuringUnload=ab.hadConnectivityIssuesDuringUnload;Ua.TimeFromLastStatusCode0=ab.timeFromLastStatusCode0;Ua.LastSilentReopenStartTime=ab.lastSilentReopenStartTime;Ua.LastSilentReopenEndTime=ab.lastSilentReopenEndTime;I.EwaSettings.isChangeGateEnabled("OfficeVSO:5144186_LogBeforeCloseNotificationApiStatusOnUnload")&&
(Ua.ApiBeforeCloseNotificationEnabledOnUnload=ab.apiBeforeCloseNotificationEnabledOnUnload);return X.c(Ua)}RXh(ab,Ua){const hd=window.performance.timing.navigationStart-ab.timestamp;(ab=this.workbookHashedId===ab.workbookHashedId&&hd<Ua)&&E.ULS.sendTraceTag(537151055,0,50,"AppUnloadTelemetryManager.CheckRefresh: Session is after refresh");return ab}static Ea(ab){S.AppUnloadTelemetryManagerService.Oa()||ab.fa.$b.inWebPart||ab.ra.zc(410,new Ha(ab))}};Za.aLj=10;Za=Ha=Object(w.__decorate)([Object(ea.d)(S.AppUnloadTelemetryManagerService),
Object(w.__param)(0,Object(S.EwaControlService)())],Za);Object(z.a)(Za,"AppUnloadTelemetryManager",null,[232,4]);var fa=a(91),la=a(41),ba=a(129);let aa=class extends la.a{constructor(){super();this.jP=!1;this.MQe=this.LQe=null;this.o9d=()=>{this.c8g()};this.C$d=()=>{fa.a.vb(this.Y6);fa.a.vb(this.Rn)};this.Y6=K.a.instance.zUa();this.Rn=K.a.instance.SP();this.Y6.Ea("visibilitychange",this.o9d);this.Rn.Ea("pagehide",this.C$d);this.c8g()}get isHidden(){return this.jP}get M7f(){return this.LQe}get rJc(){return this.MQe}j6(ab){this.addHandler("ekdh",
ab)}fsb(ab){this.removeHandler("ekdh",ab)}h0(ab){this.addHandler("ekduh",ab)}wLa(ab){this.removeHandler("ekduh",ab)}pI(ab){return this.isHidden?!0:this.rJc?ba.getElapsedMilliseconds(this.rJc,A.a.zb.Jc)<ab:!1}dispose(){fa.a.vb(this.Y6);fa.a.vb(this.Rn);super.dispose()}c8g(){this.jP="hidden"===window.document.visibilityState;this.isHidden?(this.raiseEvent("ekdh"),this.LQe=A.a.zb.Jc):(this.raiseEvent("ekduh"),this.MQe=A.a.zb.Jc)}};aa=Object(w.__decorate)([Object(ea.d)(S.DocumentVisibilityObserverService)],
aa);Object(z.a)(aa,"DocumentVisibilityObserver",la.a,[655,4]);var oa=a(13),Na=a(25),Ia=a(31),Sa=a(330),Pa;let za=Pa=class{constructor(ab,Ua){this.xnf=!1;this.Anf=null;this.Nd=()=>{var hd;this.RBk();S.FontTelemetryManagerService.Oa()?null===(hd=this.da)||void 0===hd?void 0:hd.ha.qV(this.Nd):Na.f(this.$).ha&&Na.f(this.$).ha.qV(this.Nd)};this.Gj=(hd,qe)=>{var Ae,ef;qe.la&&!this.Hwe.has(qe.la.name)&&(this.Hwe.add(qe.la.name),S.FontTelemetryManagerService.Oa()?(null===(Ae=this.da)||void 0===Ae?void 0:
Ae.ha.qV(this.Nd),null===(ef=this.da)||void 0===ef?void 0:ef.ha.YS(this.Nd)):Na.f(this.$).ha&&(Na.f(this.$).ha.qV(this.Nd),Na.f(this.$).ha.YS(this.Nd)))};this.$=ab;this.da=Ua;this.I1g=new Set;this.Hwe=new Set;this.$.qa&&this.$.qa.la&&this.Hwe.add(this.$.qa.la.name);this.$.qa.mh(this.Gj);S.FontTelemetryManagerService.Oa()?this.da.ha.YS(this.Nd):Na.f(this.$).ha.YS(this.Nd)}dispose(){this.da=this.$=null}RBk(){this.Anf||this.vTh();var ab=Na.f(this.$);const Ua=[];for(var hd of ab.z7()){ab=hd.domElement.getElementsByClassName(Ia.a.Uui);
for(let Ae=ab.length-1;0<=Ae;Ae--){var qe=ab[Ae].firstChild;(qe=qe?Sa.b(qe.currentStyle):"")&&!Ua.includes(qe)&&Ua.push(qe)}}this.xnf||(hd=oa.a.instance.La(281).split(","),Ua.push(...hd),this.xnf=!0);for(const Ae of Ua)Ae&&!this.I1g.has(Ae)&&(this.zFj(Ae),this.I1g.add(Ae))}zFj(ab){this.UUh(ab)}vTh(){this.Anf=Pa.wGa("monospace");Pa.wGa("sans-serif");Pa.wGa("serif")}UUh(ab){Pa.wGa(`${ab},${"monospace"}`);Pa.wGa(`${ab},${"sans-serif"}`);Pa.wGa(`${ab},${"serif"}`)}static Ea(ab){if(I.EwaSettings.Ra(61)){const Ua=
new Pa(ab,null);ab.ra.zc(210,Ua)}}static wGa(ab){const Ua=document.createElement("div"),hd=document.createElement("div");Ua.style.cssText="position: absolute; overflow: auto; visibility: hidden;";Pa.aNk(hd,ab);document.body.appendChild(Ua);Ua.appendChild(hd);hd.innerText="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890~!@#$%^&*()-+";ab=hd.offsetWidth+"x"+hd.offsetHeight;document.body.removeChild(hd.parentNode);return ab}static aNk(ab,Ua){ab.style.cssText="display: inline; visibility: hidden;";
ab.style.fontSize="100px";ab.style.fontWeight="normal";ab.style.fontStyle="normal";ab.style.letterSpacing="normal";ab.style.lineHeight="normal";ab.style.whiteSpace="nowrap";ab.style.fontFamily=Ua}};za=Pa=Object(w.__decorate)([Object(ea.d)(S.FontTelemetryManagerService),Object(w.__param)(0,Object(S.EwaControlService)()),Object(w.__param)(1,Object(S.GridViewService)())],za);Object(z.a)(za,"FontTelemetryManager",null,[4]);const wa={MergedCell:"MergedCell",edh:"ConditionalFormat",Comment:"Comment",Formula:"Formula",
AutoFilter:"AutoFilter",PivotFilter:"PivotFilter",PivotTable:"PivotTable",Sparkline:"Sparkline",InCellImage:"InCellImage",Pfh:"RichText"};let db=class{constructor(ab){this.jd=()=>{const Ua=JSON.stringify(this.xgf),hd=JSON.stringify(this.wgf);E.ULS.sendTraceTag(508929763,0,50,`GridActionTelemetryManager.onWorkBookClosing: {"commandNameToRowColCount": ${Ua}}`);E.ULS.sendTraceTag(508826823,0,50,`GridActionTelemetryManager.onWorkBookClosing: {"commandNameToComplexCellInfo": ${hd}}`)};this.$=ab;this.xgf=
[];this.wgf=[];I.EwaSettings.BUb()&&this.$.Sj(this.jd)}dispose(){this.$=null}h3e(ab,Ua){this.xgf.push({commandName:Ua,rowColCount:ab.toString()})}pnd(ab,Ua){if(ab&&0!==ab.length){var hd=[];const qe={};for(const Ae of ab)Ae.pnj()&&(ab=c(Ae),""!==ab&&(qe[ab]=qe[ab]?qe[ab]+1:1));for(const Ae of Object.keys(qe))hd.push({cellType:Ae,count:qe[Ae]});0!==hd.length&&this.wgf.push({commandName:Ua,complexCellTypes:hd})}}h2e(ab,Ua,hd,qe,Ae){const ef=Na.f(this.$);var Tf=I.EwaSettings.hIa()?I.EwaSettings.Ule():
I.EwaSettings.c5d(),Nf=ef.gridBlockManager.ZOb(1554436520===Ae||1051390410===Ae?Tf:0,674605324===Ae||-706918724===Ae?Tf:0);Ae=[];Tf=!1;"UnhideColumn"!==ab&&"UnhideRow"!==ab&&"insertColumns"!==ab&&"insertRows"!==ab||(Tf=!0);for(const If of Nf){{Nf=If.Fd;var wg=qe,Uf=hd,lg=Ua,Kg=Tf;let hg=null;if(wg&&Nf||!I.EwaSettings.isChangeGateEnabled("OfficeVSO:7990966_GridActionTelemetryBlockRangeFix"))Kg?Nf.ld(wg)&&(hg=Nf,lg?hg.top=hg.bottom-Uf+1:hg.left=hg.right-Uf+1):Nf.ld(wg)||(hg=Nf,lg?hg.bottom=hg.top+Uf-
1:hg.right=hg.left+Uf-1);Nf=hg}Nf&&(Nf=ef.za.OT(Nf))&&(Ae=[...Ae,...Nf])}this.pnd(Ae,ab+"Cascade")}};db=Object(w.__decorate)([Object(ea.d)(S.GridActionTelemetryManagerService),Object(w.__param)(0,Object(S.EwaControlService)())],db);Object(z.a)(db,"GridActionTelemetryManager",null,[666,4]);var Ba=a(19),Ka=a(1223),da=a(1099),sa=a(6),mb=a(249),Ma=a(112),hb=a(136),$a=a(234),Va=a(268),xa=a(73),ia=a(83),Z=a(28),ta=a(162),pa=a(952);Object(ea.b)(S.HostMessengerService,{we:"singleton"})(async ab=>{const Ua=
await ea.a.resolve(S.EwaControlService,ab),hd=window.parent,qe=I.EwaSettings.isChangeGateEnabled("OfficeVSO:5135167_PostMessageOriginFixup")?Ua.ta.DocumentHostInfo.PostMessageOrigin||pa.a.sH:sa.AFrameworkApplication.t1b||pa.a.sH,Ae=sa.AFrameworkApplication.ea.ka("HostSendReadyToAcceptPostMessage");mb.a.instance.register(Ga,"Microsoft.Office.Excel.WebUI.Client.PostMessage.EwaHostMessenger").as("Postmessage.IHostPostmessenger").Lc().Qc(()=>new Ga(Ua,hd,qe,Ae));return Object(Ba.a)(Ka.a)});class Ga extends da.a{constructor(ab,
Ua,hd){super(Ua,hd);this.ub=new Ma.a;this.adj=qe=>{if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:3449424_AgaveValidateHost")){const Ae=qe.Values.m_Origin;sa.AFrameworkApplication.wopiHostOriginFromPostMessage||(sa.AFrameworkApplication.wopiHostOriginFromPostMessage=Ae)}switch(qe.MessageId){case hb.a.lSd:ta.a(this.$).sRf(qe);break;case hb.a.w2d:Va.a.ltas(null);break;case hb.a.rDc:this.Z_j();break;case hb.a.oSd:this.Y_j(qe)}};this.$=ab;hd!==pa.a.sH&&this.pH(hd);this.Cij();this.Hhj();ab=this.adj;this.ik(hb.a.lSd,
ab);this.ik(hb.a.w2d,ab);this.ik(hb.a.rDc,ab);this.ik(hb.a.oSd,ab)}dispose(){this.$=null;super.dispose()}Cij(){this.nl(hb.a.Vbf);this.nl(hb.a.lSd);this.nl(hb.a.rDc);this.nl(hb.a.oSd);this.bSa(hb.a.w2d);this.nl(hb.a.nSd)}Hhj(){this.SS("App_EwrWorkbookNotSupportedCancelResponse");this.SS(hb.a.yCa);this.SS(hb.a.g1);this.SS("App_CloseTab");this.SS(hb.a.b8a);this.SS(hb.a.c8a);this.SS(hb.a.DUf);this.SS(hb.a.nDc);this.SS("App_ModifyURLState")}Z_j(){const ab={};ab.hostMessageReceived=(new Date).getTime();
E.ULS.sendTraceTag(537162883,0,50,"EwaHostMessenger.OnHostUnload");sa.AFrameworkApplication.rIc=!0;ab.appUnloadStart=(new Date).getTime();ab.sendBeaconFlight=sa.AFrameworkApplication.ea.ka("SendBeaconOnShuttingDownRequestsEnabled");ab.sendBeaconSupported=xa.a.bya();xa.a.s7e();ab.appUnloadEnd=(new Date).getTime();ab.appMessageSent=(new Date).getTime();this.sendMessage(hb.a.nJh,ab)}Y_j(ab){E.ULS.sendTraceTag(537162882,0,50,"EwaHostMessenger.OnHostSwitchMode");ab.Values&&"NewMode"in ab.Values&&Z.a.equals(ab.Values.NewMode,
$a.a.edit,!0)&&!this.$.isEditMode&&(E.ULS.sendTraceTag(537162881,0,50,`EwaHostMessenger.OnHostSwitchMode: Switching to ${ab.Values.NewMode}`),ab=new ia.a(-8805455,0,1,0,null),this.$.Ia.Gb(ab))}}Object(z.a)(Ga,"EwaHostMessenger",da.a,[609,201,4]);var Ca=a(16),kb=a(40);const eb="context-menu floatie task-pane context-menu-auto-filter context-menu-auto-filter-items context-menu-pivot-page-filter context-menu-pivot-page-filter-items context-menu-pivot-drop-down context-menu-pivot-drop-down-filter-items dialog header-cell-hover".split(" "),
Yb=new Map;[{name:"keyboard_selection",actions:new Set("move_down move_left move_right move_up extend_down extend_left extend_right extend_up cell_text_move_down cell_text_move_left cell_text_move_right cell_text_move_up cell_text_extend_down cell_text_extend_left cell_text_extend_right cell_text_extend_up formulaBar_extend_left formulaBar_extend_right formulaBar_extend_down formulaBar_extend_up formulaBar_move_right formulaBar_move_down formulaBar_move_left formulaBar_move_up commit_down commit_right formulaBar_commit_down formulaBar_commit_right cell_text_commit_right cell_text_commit_down".split(" "))},
{name:"cell_edit",actions:new Set("commit_down_end_edit commit_right_end_edit formulaBar_commit_down_end_edit formulaBar_commit_right_end_edit cell_text_commit_down_end_edit cell_text_commit_right_end_edit cell_text_edit_end cell_text_edit_type cell_text_edit_typing cell_text_start_edit cell_text_start_edit_replace formulaBar_start_edit_replace formulaBar_start_edit formulaBar_end_edit_ok_cancel_btn cell_text_end_edit_ok_cancel_btn formulaBar_end_edit_sheet_changed cell_text_end_edit_sheet_changed move_down_end_edit move_left_end_edit move_right_end_edit move_up_end_edit extend_down_end_edit extend_left_end_edit extend_right_end_edit extend_up_end_edit cell_text_move_down_end_edit cell_text_move_left_end_edit cell_text_move_right_end_edit cell_text_move_up_end_edit cell_text_extend_down_end_edit cell_text_extend_left_end_edit cell_text_extend_right_end_edit cell_text_extend_up_end_edit cell_text_active_cell_selection_change_entire_row_end_edit formulaBar_active_cell_selection_change_entire_row_end_edit cell_text_active_cell_selection_change_entire_column_end_edit formulaBar_active_cell_selection_change_entire_column_end_edit cell_text_active_cell_selection_change_right_click_end_edit formulaBar_active_cell_selection_change_right_click_end_edit cell_text_active_cell_selection_change_end_edit formulaBar_active_cell_selection_change_end_edit formulaBar_edit_type formulaBar_move_left_end_edit formulaBar_move_down_end_edit formulaBar_extend_left_end_edit formulaBar_move_right_end_edit formulaBar_move_up_end_edit formulaBar_extend_up_end_edit formulaBar_extend_right_end_edit formulaBar_extend_down_end_edit".split(" "))},
{name:"active_cell_selection",actions:new Set("cell_text_active_cell_selection_change_entire_row formulaBar_active_cell_selection_change_entire_row cell_text_active_cell_selection_change_entire_column formulaBar_active_cell_selection_change_entire_column cell_text_active_cell_selection_change_right_click formulaBar_active_cell_selection_change_right_click cell_text_active_cell_selection_change formulaBar_active_cell_selection_change".split(" "))},{name:"headers",actions:new Set(["header_resize_start",
"header_resize_autofit"])},{name:"scroll_animation",actions:new Set(["viewport_scroll"])},{name:"zoom_animation",actions:new Set(["viewport_zoom"])},{name:"drag_animation",actions:new Set("drag_range_insert drag_range_replace drag_table_row_rearrange drag_table_column_rearrange drag_row_insert drag_row_replace drag_column_insert drag_column_replace drag_pivot_replace drag_pivot_row_rearrange drag_pivot_column_rearrange".split(" "))},{name:"async_ui",actions:new Set(eb)},{name:"freeze_pane_drag_animation",
actions:new Set(["freeze_pane_header_drag_vertical","freeze_pane_header_drag_horizontal","freeze_pane_line_drag_vertical","freeze_pane_line_drag_horizontal"])}].forEach(ab=>{ab.actions.forEach(Ua=>{Yb.set(Ua,ab.name)})});class Gb{constructor(ab){this.$=ab}getAppState(){const ab=kb.a.instance.Dja();return-1===ab?"boot":3E4>ab?"postboot":"steady"}isChangeGateEnabled(ab){return I.EwaSettings.isChangeGateEnabled(ab)}getBooleanFeatureGate(ab,Ua){return I.EwaSettings.getBooleanFeatureGate(ab,Ua)}getCurrentAppInfo(){return{appState:this.getAppState(),
appInfoProperties:[{key:"coauthCount",value:this.$.fa.ko.length.toString()}]}}sendBeaconTraceTag(ab,Ua,hd,qe){this.$.sendBeaconTraceTag(ab,Ua,hd,qe)}getActionBucket(ab){return b(ab)}getAppInfoForReport(){return`${"maxCoauthCount"}: ${this.$.fa.fLj}`}logSlowActionsHandler(){return""}logAsyncActionHandler(){return""}}Object(z.a)(Gb,"InteractivityTrackerCallbacks",null,[]);var Mb=a(325);const Rb=[{actionName:"header-cell-hover-default",slowActionThreshold:100}],$b=async(ab,Ua)=>Object(Mb.loadChunkWithDynamicScriptLoader)("interactivity",
Ua);Object(ea.b)(S.InteractivityTrackerServiceIdentifier,{we:"singleton"})(async ab=>{const Ua=await ea.a.resolve(S.EwaControlService,ab);await $b(Ua,ab);ab=interactivity.InteractivityTrackerFactoryGlobal.create();return new cc(Ua,ab)});class cc{constructor(ab,Ua){this.lm=void 0===Ua?null:Ua;cc.KGc?E.ULS.sendTraceTag(537155545,0,50,"InteractivityTrackerService: instance was already created once. skipping initialization."):(this.initialize(ab),cc.KGc=!0)}initialize(ab){E.ULS.sendTraceTag(555360983,
0,15,"InteractivityTrackerService: starting InteractivityTracker");this.lm?(I.EwaSettings.p_d()&&cc.a0c.push(Ca.a.$qa),cc.a0c.push("mouseup"),cc.a0c.push("touchstart"),ab={events:cc.a0c,durationThresholdInMs:cc.durationThresholdInMs,callbacks:new Gb(ab),allowAsyncUIContextReporting:I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AllowAsyncUIContextReporting",!1)},I.EwaSettings.isChangeGateEnabled("OfficeVSO:8843901_TrackAsyncUI")&&(ab.asyncUiTracking={slowUiEventThresholdMs:I.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.SlowUIEventThresholdMs",
500),asyncUiEventTimeoutMs:I.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.AsyncUIEventTimeoutMs",3E4),slowActionTimeoutOverrides:I.EwaSettings.isChangeGateEnabled("OfficeVSO:9019886_OverrideSlowActionThresholdValue")?Rb:[]},I.EwaSettings.isChangeGateEnabled("OfficeVSO:8880204_RemoveAllowedAsyncUiNamesList")||(ab.asyncUiTracking.allowedAsyncUiNames=[...eb])),ab.periodicReportIntervalMs=6E4,ab.animationTracking={chunkDurationMs:100,minFramesPerChunk:3,animationTimeoutMs:5E3},I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InteractivityTimelineEnabled",
!1)&&(ab.timeline={reportDelayMs:I.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.InteractivityTimelineReportDelayMs",1E3),runSlowActionsPassiveTestEnabled:I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RunSlowActionsPassiveTestEnabled",!1),reporters:[{type:"long-animation-frame"}]}),ab=this.lm.start(ab),ab.started?E.ULS.sendTraceTag(537155543,0,50,"InteractivityTrackerService: InteractivityTracker started"):E.ULS.sendTraceTag(537155542,0,15,"InteractivityTrackerService InteractivityTracker start failed: "+
ab.failureReason)):E.ULS.sendTraceTag(537155541,0,15,"InteractivityTrackerService: InteractivityTracker not created")}kq(ab,Ua,hd,qe){if(this.lm)return this.lm.trackInteraction(ab,Ua,hd,qe);E.ULS.sendTraceTag(524326924,0,50,`InteractivityTrackerService.TrackInputEventPerf: interactivityTracker not initialized. Discarding userAction: ${Ua}`)}B3g(ab,Ua,hd){this.lm?this.lm.trackAsyncUi(ab,Ua,hd,void 0):E.ULS.sendTraceTag(507282888,0,50,"InteractivityTrackerService.TrackAsyncUiEvent: interactivityTracker not initialized.")}Flf(){return this.lm?
this.lm.createActionsRetriever():(E.ULS.sendTraceTag(537155539,0,15,"InteractivityTrackerService.CreateSlowActionsRetriever: interactivityTracker not initialized."),null)}dispose(){this.lm&&(this.lm.stop(),this.lm=null)}addContext(ab,Ua,hd){this.lm?this.lm.addContext(ab,Ua,hd):E.ULS.sendTraceTag(509445952,0,15,"InteractivityTrackerService.addContext: interactivityTracker not initialized.")}startTrackAnimation(ab,Ua){return this.lm?cc.KGc?this.lm.startTrackAnimation(ab,Ua):(E.ULS.sendTraceTag(507847813,
0,50,"InteractivityTrackerService.startTrackAnimation: trying startTrackAnimation but interactivityTrackerService instance was no created."),!1):(E.ULS.sendTraceTag(508343192,0,50,"InteractivityTrackerService.startTrackAnimation: interactivityTracker not initialized."),!1)}stopTrackAnimation(ab,Ua){this.lm?I.EwaSettings.isChangeGateEnabled("OfficeVSO:8500180_checkIfInteractivityServiceExistsBeforeStartTracking")&&!cc.KGc?E.ULS.sendTraceTag(507847812,0,50,"InteractivityTrackerService.startTrackAnimation: trying stopTrackAnimation but interactivityTrackerService instance was no created."):
this.lm.stopTrackAnimation(ab,Ua):E.ULS.sendTraceTag(508343191,0,50,"InteractivityTrackerService.endTrackAnimation: interactivityTracker not initialized.")}getStatus(){return this.lm?this.lm.getStatus():(E.ULS.sendTraceTag(507069959,0,50,"InteractivityTrackerService.getStatus: interactivityTracker not initialized."),null)}}cc.durationThresholdInMs=100;cc.a0c="click mousedown contextmenu keypress keydown dblclick touchend".split(" ");cc.KGc=!1;Object(z.a)(cc,"InteractivityTrackerService",null,[155]);
var fb=a(2),Sb=a(150),kc=a(57),na=a(53);class fc{constructor(){this.order=0;this.componentName=this.name=null;this.timeFromNavigationStart=0}}Object(z.a)(fc,"ActionData",null,[]);class Cc{constructor(){this.hasBlockedActions=!1;this.blockedActions=[]}}Object(z.a)(Cc,"BlockedEngagementInfo",null,[]);class tc extends fc{constructor(){super();this.inputMethod=null;this.isCommand=!1}}Object(z.a)(tc,"SuccessfulActionData",fc,[]);class nb{constructor(){this.successfulActions=[]}}Object(z.a)(nb,"SuccessfulEngagementInfo",
null,[]);var tb=a(45),La;let wb=La=class{constructor(ab){this.kWa=new Set;this.F8b=null;this.iCf=this.X_g=!1;this.Rpb=(Ua,hd)=>{this.sHb.hasBlockedActions=!0;Ua=this.sHb.blockedActions.length;const qe=hd.details?hd.actionName+"_"+hd.details:hd.actionName;hd=Object(fb.a)(new fc,{order:Ua+1,name:qe,componentName:hd.componentName,timeFromNavigationStart:hd.timeFromNavigationStart});this.sHb.blockedActions.push(hd)};this.qm=()=>{tb.a(this.$).B3b(this.Rpb);this.AEj();this.F8b=kc.a.instance.create(()=>
{this.SXb()},La.K1k,na.a.SXb)};this.jd=()=>{this.SXb()};this.sfe=()=>{this.$.Dc(2009315810,-1,0,null);this.Wre=!1};this.sHb=new Cc;this.sHb.hasBlockedActions=!1;this.svb=new nb;this.wAi();this.$=ab;this.$.fa.Yv(this.qm);this.$.Sj(this.jd);this.N1k=0;this.Wre=!1;I.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")&&(this.Rif=new Promise(Ua=>{this.A4h=Ua}));tb.a(this.$).Elc(this.Rpb)}dispose(){this.$.ro(this.jd);fa.a.vb(this.F8b);this.$=this.F8b=null}vmk(ab,Ua,
hd){if(void 0!==ab&&null!==ab&&Ua){var qe=this.svb.successfulActions.length+1,Ae="InputMethod"in Ua?Ua.InputMethod:"",ef="IsCommand"in Ua&&Ua.IsCommand;if(this.syj(ab,Ua,Ae,ef)){++this.N1k===La.Sgl?(this.Wre=!0,this.Vak=kc.a.instance.create(this.sfe,5E3,na.a.sfe)):this.Wre&&this.Vak.Cv();if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")){const Tf=!ef&&ab;this.iCf||Tf===Sb.a.rah||Tf===Sb.a.sah||Tf===Sb.a.mah||Tf===Sb.a.nah||(this.iCf=!0,this.A4h(void 0))}qe>
La.meg||(ab=Object(fb.a)(new tc,{order:qe,name:ab,componentName:"Location"in Ua?Ua.Location:"",timeFromNavigationStart:hd,inputMethod:Ae,isCommand:ef}),this.svb.successfulActions.push(ab),1===qe?this.xFj():qe===La.meg&&this.SXb())}}}AEj(){E.ULS.sendTraceTag(254546634,0,50,`${X.c(this.sHb)}`)}xFj(){kb.a.instance.Dja()>La.MAi?E.ULS.sendTraceTag(537154758,0,50,`First user interaction was filtered: ${X.c(this.svb.successfulActions[0])}`):E.ULS.sendTraceTag(254563592,0,50,`${X.c(this.svb.successfulActions[0])}`)}SXb(){!this.X_g&&
this.svb.successfulActions.length&&(this.X_g=!0,fa.a.vb(this.F8b),this.F8b=null,this.$.sendBeaconTraceTag(254559496,50,!1,X.c(this.svb)))}wAi(){this.kWa.add(Sb.a.Mmd);this.kWa.add(Sb.a.Hne);this.kWa.add(Sb.a.Ide);this.kWa.add(Sb.a.Yyg);this.kWa.add(Sb.a.$yg);this.kWa.add(Sb.a.bzg)}syj(ab,Ua,hd,qe){hd=!hd||"unknown"===hd;const Ae="IsSystemInitiated"in Ua&&Ua.IsSystemInitiated;Ua="NoReporting"in Ua&&Ua.NoReporting;const ef=this.kWa.has(ab);ab=Z.a.equals(ab,Sb.a.IWc,!0)&&hd;return!Ae&&!Ua&&!ef&&!ab&&
!(qe&&hd)}};wb.meg=10;wb.MAi=6E4;wb.K1k=12E4;wb.Sgl=25;wb=La=Object(w.__decorate)([Object(ea.d)(S.PageLoadEngagementInfoService),Object(w.__param)(0,Object(S.EwaControlService)())],wb);Object(z.a)(wb,"PageLoadEngagementInfo",null,[]);var Wa=a(1210),Fa=a(10),Da=a(39),ja;let Qa=ja=class{constructor(){this.P9i=async()=>{I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseServiceWorker",!1)?await this.register():await this.unregister()};this.init().then(()=>{E.ULS.sendTraceTag(507654145,0,
50,"ServiceWorkerRegistrationManager.init: Initialization complete")}).catch(ab=>{E.ULS.sendTraceTag(507654144,0,15,`ServiceWorkerRegistrationManager.init: Initialization failed: ${ab}`)})}async init(){Da.a.xPh&&navigator.serviceWorker.getRegistrations?(kb.a.instance.tg("ServiceWorkerSupported"),navigator.serviceWorker.controller&&kb.a.instance.tg("ServiceWorkerControlled"),await this.P9i(),this.aOh()):kb.a.instance.tg("ServiceWorkerNotSupported")}async register(){try{const ab=await navigator.serviceWorker.register(`${Fa.a.vHk}`);
E.ULS.sendTraceTag(507795410,0,15,`ServiceWorkerRegistrationManager.register: Registration succeeded. workerState = ${ab.active?"active":ab.waiting?"waiting":ab.installing?"installing":"none"}, scope = ${ab.scope}`)}catch(ab){E.ULS.sendTraceTag(507795409,0,15,`ServiceWorkerRegistrationManager.register: call to serviceWorker.register failed: ${ab}`)}}async unregister(){try{const ab=await navigator.serviceWorker.getRegistrations();for(const Ua of ab)await Ua.unregister()?E.ULS.sendTraceTag(507795408,
0,15,"ServiceWorkerRegistrationManager.unregister: Unregistration succeeded"):E.ULS.sendTraceTag(507795407,0,10,"ServiceWorkerRegistrationManager.unregister: Unregistration failed")}catch(ab){E.ULS.sendTraceTag(507795406,0,50,`ServiceWorkerRegistrationManager.unregister: call to serviceWorker.unregister failed: ${ab}`)}}static g$i(ab){try{const Ua=Date.now(),hd=JSON.parse(ab.data).serviceWorkerTime;E.ULS.sendTraceTag(507606657,0,50,`ServiceWorkerRegistrationManager.handleServiceWorkerHeartbeatMessage: delta between sending message from SW to processing message in main thread: ${Ua-
hd}`)}catch(Ua){E.ULS.sendTraceTag(507606656,0,10,`ServiceWorkerRegistrationManager.handleServiceWorkerHeartbeatMessage: failed: ${Ua}`)}}static h$i(ab){I.EwaSettings.isChangeGateEnabled("OfficeVSO:8617694_HandleServiceWorkerHeartbeat")&&ab.data.includes("heartbeat")?ja.g$i(ab):E.ULS.sendTraceTag(507795405,0,50,`ServiceWorkerRegistrationManager.handleServiceWorkerMessage: ${ab.data}`)}aOh(){navigator.serviceWorker.addEventListener("message",ja.h$i)}};Qa=ja=Object(w.__decorate)([Object(ea.d)(S.ServiceWorkerRegistrationManagerService)],
Qa);Object(z.a)(Qa,"ServiceWorkerRegistrationManager",null,[]);var Ob=a(546);class Ub{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=
this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(z.a)(Ub,"BrowserInfo",null,[]);class Zb{constructor(){this.Version=this.Name=null}}Object(z.a)(Zb,"PluginInfo",null,[]);class uc{static JFj(){if(sa.AFrameworkApplication.ea.ka("LogBrowserInfoIsEnabled")){var ab=uc.YFi();try{const Ua=JSON.stringify(ab);E.ULS.sendTraceTag(6903563,102,50,Ua)}catch(Ua){E.ULS.sendTraceTag(6903564,102,15,
Ua.message)}}else E.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static VXi(){const ab=window.navigator.plugins;if(!ab||!ab.length)return null;const Ua=[];for(let hd=0;hd<ab.length;hd++){const qe=ab[hd].name,Ae=ab[hd].version;Array.add(Ua,Object.assign(new Zb,{Name:qe,Version:Ae}))}return Ua}static YFi(){const ab=new Ub,Ua=new Sys.StringBuilder;uc.Gx(hd=>{ab.DocElemClientHeight=hd},()=>document.documentElement.clientHeight,Ua);uc.Gx(hd=>{ab.DocElemClientWidth=hd},
()=>document.documentElement.clientWidth,Ua);uc.Gx(hd=>{ab.DocElemOffsetHeight=hd},()=>document.documentElement.offsetHeight,Ua);uc.Gx(hd=>{ab.DocElemOffsetWidth=hd},()=>document.documentElement.offsetWidth,Ua);uc.Gx(hd=>{ab.ScreenAvailHeight=hd},()=>window.screen.availHeight,Ua);uc.Gx(hd=>{ab.ScreenAvailWidth=hd},()=>window.screen.availWidth,Ua);uc.Gx(hd=>{ab.ScreenWidth=hd},()=>window.screen.width,Ua);uc.Gx(hd=>{ab.ScreenHeight=hd},()=>window.screen.height,Ua);uc.Gx(hd=>{ab.ScreenLogicalXdpi=hd},
()=>window.screen.logicalXDPI,Ua);uc.Gx(hd=>{ab.ScreenLogicalYdpi=hd},()=>window.screen.logicalYDPI,Ua);uc.Gx(hd=>{ab.ScreenDeviceXdpi=hd},()=>window.screen.deviceXDPI,Ua);uc.Gx(hd=>{ab.ScreenDeviceYdpi=hd},()=>window.screen.deviceYDPI,Ua);uc.Gx(hd=>{ab.WinInnerHeight=hd},()=>window.self.innerHeight,Ua);uc.Gx(hd=>{ab.WinInnerWidth=hd},()=>window.self.innerWidth,Ua);uc.Gx(hd=>{ab.WinOuterHeight=hd},()=>window.self.outerHeight,Ua);uc.Gx(hd=>{ab.WinOuterWidth=hd},()=>window.self.outerWidth,Ua);uc.Gx(hd=>
{ab.WinOrientation=hd},()=>window.self.orientation,Ua);uc.Gx(hd=>{ab.WinDevicePixelRatio=hd},()=>window.self.devicePixelRatio,Ua);uc.Gx(hd=>{ab.SupportsTouch=hd},()=>Da.a.d0c,Ua);uc.Gx(hd=>{ab.NavAppName=hd},()=>window.navigator.appName,Ua);uc.Gx(hd=>{ab.NavAppVersion=hd},()=>window.navigator.appVersion,Ua);uc.Gx(hd=>{ab.NavLanguage=hd},()=>window.navigator.browserLanguage||window.navigator.language,Ua);uc.Gx(hd=>{ab.NavUserAgent=hd},()=>window.navigator.userAgent,Ua);uc.Gx(hd=>{ab.NavPlatform=hd},
()=>window.navigator.platform,Ua);sa.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.WordOnline.SkipLoggingPluginsEnabled",!1)||uc.Gx(hd=>{ab.NavPlugins=hd},uc.VXi,Ua);uc.Gx(hd=>{ab.CalculatedDevicePixelRatio=hd},()=>uc.devicePixelRatio,Ua);ab.Error=Ua.toString();return ab}static get devicePixelRatio(){const ab=window.devicePixelRatio;return isNaN(ab)?window.screen.deviceXDPI/window.screen.logicalXDPI:ab}static Gx(ab,Ua,hd){try{const qe=Ua();ab(qe)}catch(qe){hd.isEmpty()||hd.append(" | "),
hd.append(qe.message||"null")}}}Object(z.a)(uc,"BrowserInfoLogger",null,[]);var Hc=a(78),Dd=a(494),jc=a(1098);class $c{Pg(ab,Ua){return new jc.a(ab,Ua)}Uc(ab,Ua){ab=this.Pg(ab,Ua);ab.start();return ab}}Object(z.a)($c,"DefaultStopwatchBuilder",null,[852]);class ud{constructor(){this.QAa=new $c}Pg(ab,Ua){return this.QAa.Pg(ab,Ua)}Uc(ab,Ua){return this.QAa.Uc(ab,Ua)}}Object(z.a)(ud,"StopwatchBuilder",null,[852]);var Ud=a(141),ec=a(363),Db=a(7),ic=a(1124),Pc=a(1257),Ed;(function(ab){ab[ab.actions=0]=
"actions";ab[ab.correlationStart=1]="correlationStart";ab[ab.reorderSheetOp=2]="reorderSheetOp";ab[ab.formatCellOp=3]="formatCellOp";ab[ab.copyOp=4]="copyOp";ab[ab.pasteOp=5]="pasteOp";ab[ab.getNumberViewModelDataOp=6]="getNumberViewModelDataOp";ab[ab.instantaneousSetData=7]="instantaneousSetData";ab[ab.immediateSetData=8]="immediateSetData";ab[ab.dependentCellsCalc=9]="dependentCellsCalc";ab[ab.dependentCellsGraphStat=10]="dependentCellsGraphStat";ab[ab.dependentCellsGraphSectionStat=11]="dependentCellsGraphSectionStat";
ab[ab.getRangeContentPrefetchFailures=12]="getRangeContentPrefetchFailures";ab[ab.gridBlockUpdates=13]="gridBlockUpdates";ab[ab.browserAppStart=14]="browserAppStart";ab[ab.linkedObjects=15]="linkedObjects";ab[ab.longFrames=16]="longFrames";ab[ab.task=17]="task";ab[ab.conflictInEditing=18]="conflictInEditing";ab[ab.incomingPresenceData=19]="incomingPresenceData";ab[ab.editorTableDelay=20]="editorTableDelay";ab[ab.presenceStartup=21]="presenceStartup";ab[ab.presenceDelete=22]="presenceDelete";ab[ab.editorEvent=
23]="editorEvent";ab[ab.editorTime=24]="editorTime";ab[ab.gridScreenReaderOps=25]="gridScreenReaderOps";ab[ab.sendPresenceToService=26]="sendPresenceToService";ab[ab.IME=27]="IME";ab[ab.freezePaneFloatingObjects=28]="freezePaneFloatingObjects";ab[ab.customizeStatusBar=29]="customizeStatusBar";ab[ab.clientWebRequests=30]="clientWebRequests";ab[ab.showCommentTaskPane=31]="showCommentTaskPane";ab[ab.applyThreadedCommentChange=32]="applyThreadedCommentChange";ab[ab.upgradeLegacyCommentsChange=33]="upgradeLegacyCommentsChange";
ab[ab.findNextOrPreviousComment=34]="findNextOrPreviousComment";ab[ab.goto=35]="goto";ab[ab.launchOfficeAddInDialog=36]="launchOfficeAddInDialog";ab[ab.richApiInvocation=37]="richApiInvocation";ab[ab.fxLibrary=38]="fxLibrary";ab[ab.embeddedApiSession=39]="embeddedApiSession";ab[ab.numberFormattingCalculator=40]="numberFormattingCalculator";ab[ab.requestDataAfterSend=41]="requestDataAfterSend";ab[ab.floatingObjectsStopwatchData=42]="floatingObjectsStopwatchData";ab[ab.copy=43]="copy";ab[ab.paste=44]=
"paste";ab[ab.dragDrop=45]="dragDrop";ab[ab.clearCopyState=46]="clearCopyState";ab[ab.webWorkerRecalcStats=47]="webWorkerRecalcStats";ab[ab.dataValidationEditOpenDialog=48]="dataValidationEditOpenDialog";ab[ab.dataValidationEditSubmitRule=49]="dataValidationEditSubmitRule";ab[ab.customSort=50]="customSort";ab[ab.namedSheetViewUserAction=51]="namedSheetViewUserAction";ab[ab.namedSheetViewTeachingCallout=52]="namedSheetViewTeachingCallout";ab[ab.namedSheetViewTeachingDialog=53]="namedSheetViewTeachingDialog";
ab[ab.namedSheetViewOptionsDialog=54]="namedSheetViewOptionsDialog";ab[ab.namedSheetViewTempViewSaveDialog=55]="namedSheetViewTempViewSaveDialog";ab[ab.temporaryViewStartedDataRestore=56]="temporaryViewStartedDataRestore";ab[ab.temporaryViewFetchedVersion=57]="temporaryViewFetchedVersion";ab[ab.raiseEventsAndGenerateBlockRequests=58]="raiseEventsAndGenerateBlockRequests";ab[ab.launchMakerCodeEditor=59]="launchMakerCodeEditor"})(Ed||(Ed={}));Object(z.b)("UsageTable",Ed);var de=a(491),se=a(552),Fe=
a(735),fe=a(794),Tc=a(796),ed=a(312),pd=a(122),Kb=a(132);class rb extends Sys.EventArgs{constructor(){super();this.nPj=0;this.operation="DOMUpdate";this.sender=this.target=null}}Object(z.a)(rb,"CalculatedAverageUpdatedEventArgs",Sys.EventArgs,[]);class rc{constructor(ab,Ua){this.jme=void 0===Ua?1:Ua;this.total=ab}get average(){return this.total/this.jme}c0h(ab){return new rc(this.total+ab.total,this.jme+ab.jme)}static JQh(ab,Ua){return`${ab}_${Ua}`}}Object(z.a)(rc,"StopwatchAverage",null,[]);var ld=
a(103),Tb;(function(ab){ab[ab.longFrame=0]="longFrame";ab[ab.longGetRange=1]="longGetRange";ab[ab.longJsTask=2]="longJsTask";ab[ab.viewportCalculationLoops=3]="viewportCalculationLoops"})(Tb||(Tb={}));Object(z.b)("UtrKpiVeto",Tb);class Wc{static yBc(ab){return Enum.toString(Tb,ab)}}Wc.ONa="UTR";Object(z.a)(Wc,"KpiConstants",null,[]);class Ac{}Ac.g$g="UTRVetoName";Ac.Y9g="UTRErrorName";Ac.c$g="UTROperationName";Ac.V3c="UTRDuration";Ac.e$g="UTREndedInPhase";Ac.gBe="UTRMessage";Ac.f$g="UtrUnavailabilityType";
Ac.operationName="OperationName";Ac.duration="Duration";Ac.message="Message";Object(z.a)(Ac,"UtrAdditionalData",null,[]);class nd{}nd.xjl="VetoLike";nd.zrf="E2EOperationPerf";nd.Qxk="RequestPerf";nd.A$k="UnavailabilityDurations";Object(z.a)(nd,"UtrTypes",null,[]);class qd{$3b(ab,Ua,hd){hd=void 0===hd?null:hd;I.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(hd=hd?{extendedProperties:hd}:null,ab=Wc.yBc(ab),ld.Health.instance.recordKpiImpliedFailure("UTR_Veto_"+ab,Ua,!1,!0,"",
hd))}K5b(ab,Ua,hd,qe,Ae,ef){ef[Wc.ONa]=nd.xjl;ef[Ac.g$g]=Wc.yBc(qe);ef[Ac.Y9g]=Ae;E.ULS.sendTraceTag(ab,Ua,hd,G.a.Nc(ef));delete ef[Wc.ONa];delete ef[Ac.g$g];delete ef[Ac.Y9g]}}Object(z.a)(qd,"UtrKpiVetoReporter",null,[]);var Xd=a(366);class Hd{oke(ab,Ua){Ua=void 0===Ua?null:Ua;I.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||ld.Health.instance.recordKpiUsage("UTR_Veto_Usage_"+Wc.yBc(ab),Xd.b.FailureBased,"",Ua)}$3b(ab,Ua,hd){hd=void 0===hd?null:hd;I.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||
(ab=Wc.yBc(ab),ld.Health.instance.recordKpiFailure("UTR_Veto_Usage_"+ab,Ua,!1,!0,this.p5h(hd)))}p5h(ab){return ab?{extendedProperties:ab}:null}}Object(z.a)(Hd,"UtrKpiVetoUsageReporter",null,[]);class Zc{Z3b(ab,Ua,hd){hd=void 0===hd?null:hd;I.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||ld.Health.instance.recordKpiImpliedSuccess("UTR_Perf_E2EOperation_"+ab,"",{extendedProperties:hd,durationMs:Ua})}c4b(ab,Ua,hd){hd=void 0===hd?null:hd;I.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||
(Ua?ld.Health.instance.recordKpiImpliedSuccess("UTR_Perf_Request_"+ab,"",{extendedProperties:hd}):ld.Health.instance.recordKpiImpliedFailure("UTR_Perf_Request_"+ab,"",!1,!1,"",{extendedProperties:hd}))}F5b(ab,Ua,hd,qe,Ae,ef,Tf,...Nf){Tf=String.format(Tf,...Nf);Nf={};Nf[Wc.ONa]=nd.zrf;Nf[Ac.c$g]=qe;Nf[Ac.e$g]=Ae;Nf[Ac.V3c]=ef;Nf[Ac.gBe]=Tf;E.ULS.sendTraceTag(ab,Ua,hd,G.a.Nc(Nf))}G5b(ab,Ua,hd,qe,Ae,ef,Tf){const Nf={};Nf[Wc.ONa]=nd.zrf;Nf[Ac.c$g]=qe;Nf[Ac.e$g]=Ae;Nf[Ac.V3c]=ef;Nf[Ac.gBe]=Tf;E.ULS.sendTraceTag(ab,
Ua,hd,G.a.Nc(Nf))}J5b(ab,Ua,hd,qe,Ae,ef){this.RSg(ef,qe,Ae);E.ULS.sendTraceTag(ab,Ua,hd,G.a.Nc(ef));this.dfi(ef)}I5b(ab,Ua,hd,qe,Ae,ef,...Tf){ef=String.format(ef,...Tf);Tf={};this.RSg(Tf,qe,Ae,ef);E.ULS.sendTraceTag(ab,Ua,hd,G.a.Nc(Tf))}H5b(ab,Ua,hd,qe){qe[Wc.ONa]=nd.Qxk;E.ULS.sendTraceTag(ab,Ua,hd,G.a.Nc(qe));delete qe[Wc.ONa]}RSg(ab,Ua,hd,qe){qe=void 0===qe?null:qe;ab[Wc.ONa]=nd.A$k;ab[Ac.f$g]=Ua;ab[Ac.V3c]=hd;qe&&(ab[Ac.gBe]=qe)}dfi(ab){delete ab[Wc.ONa];delete ab[Ac.f$g];delete ab[Ac.V3c]}}Object(z.a)(Zc,
"UtrOperationPerfReporter",null,[]);var Jc;let gc=Jc=class extends la.a{constructor(ab,Ua,hd,qe,Ae,ef,Tf,Nf){hd=void 0===hd?null:hd;qe=void 0===qe?null:qe;Ae=void 0===Ae?null:Ae;ef=void 0===ef?null:ef;Tf=void 0===Tf?null:Tf;Nf=void 0===Nf?!1:Nf;super();this.Qxi=[Db.a.M$e,Db.a.Juf,Db.a.Kuf,Db.a.SDc,Db.a.vKc,Db.a.PDj,Db.a.renderCachedContent,Db.a.renderServerContent,Db.a.Zrc,Db.a.SCk,Db.a.oNg,Db.a.pNg,Db.a.dHk];this.iDb=this.cPa=this.K$b=this.$wb=this.ZRe=this.S9e=this.W$a=this.fZe=null;this.Gwg=this.K$e=
!1;this.b$g=this.$9g=this.d$g=this.Cke=this.Cah=null;this.Irg=(wg,Uf)=>{for(wg=0;wg<Uf.entries.length;wg++){const hg=Uf.entries[wg];hg.url=Hc.a.removeParameter(hg.url,sa.AFrameworkApplication.oH);var lg=Hc.a.wZ(hg.url);!I.EwaSettings.Ra(426)&&this.Evj(hg.url,lg)&&(hg.behavior=1);if("img"===hg.Cu.initiatorType&&lg.endsWith(ic.a.SCd)){var Kg=Hc.a.W1(hg.url,ic.a.RCd),If=Hc.a.W1(hg.url,ic.a.TCd);hg.Z0=`${hg.Z0}imageID=${Kg}, imgStateID=${If}`}"css"===hg.Cu.initiatorType&&"responseStatus"in hg.Cu&&(Kg=
`responseStatus=${hg.Cu.responseStatus}`,hg.Z0=hg.Z0?`${hg.Z0},${Kg}`:Kg);Kg=hg.Cu.transferSize;let gh;If=hg.Cu.decodedBodySize;void 0!==Kg&&null!==Kg&&void 0!==If&&null!==If?gh=0===Kg&&0<If:void 0!==Kg&&null!==Kg&&(gh=0===Kg);kb.a.instance.jBh(lg,Math.round(hg.Cu.fetchStart),Math.round(hg.Cu.responseEnd),gh,this.c5f);Z.a.contains(lg,Db.a.richTextEditor,!0)&&(lg=Kb.TextEditorTelemetry.instance,lg.JJ(Db.a.xzk,Math.round(hg.Cu.fetchStart)),lg.JJ(Db.a.zzk,Math.round(hg.Cu.responseEnd)))}};this.iR=()=>
{const wg=this.Bfa;for(const Uf in wg)wg[Uf].h=!0};I.EwaSettings.Og()?(this.$=ab,this.wfj()):(this.userSessionId=qe,this.Kra=Ae=Ae||new Fe.a,this.vj=ef||A.a.zb,this.j_g=Tf||this,this.c5f=Nf,this.Zsc=Ae.uJa());I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?I.EwaSettings.Og()?(this.df=Ua,this.df.j6(this.iR)):void ea.a.resolve(S.DocumentVisibilityObserverService).then(wg=>{this.df=wg;this.df.j6(this.iR)}):(this.df=new aa,this.df.j6(this.iR),
(I.EwaSettings.Og()?ab.ra:hd).zc(291,this.df));I.EwaSettings.Og()&&this.init()}wfj(){this.userSessionId=this.$.ta.UserSessionId;this.Kra=new Fe.a;this.Zsc=this.Kra.uJa();this.vj=A.a.zb;this.j_g=this;this.c5f=!0}init(){this.H2d(Jc.n7d,this.Zsc);E.ULS.sendTraceTag(524166239,0,50,"TelemetryManager: Activating BrowserResourceTiming Telemetry logs");this.I$f();this.h1g();this.$wg();this.A$f();this.sBf();this.axg();this.WWf();Jc.pQg(this.$)}get ymf(){return this.cPa||Jc.n7d}get nve(){return this.S9e=this.S9e||
{}}get IQc(){return this.W$a||"undefined"===typeof Stw?this.W$a:this.W$a=Stw.swpc}get zbg(){return this.ZRe=this.ZRe||{}}get HLa(){return this.iDb||(this.iDb=Object(Ba.d)(Ob.a))}get Z9g(){return this.$9g||(this.$9g=new qd)}get S7a(){return this.d$g||(this.d$g=new Zc)}get a$g(){return this.b$g||(this.b$g=new Hd)}get Bfa(){return this.fZe||(this.fZe={})}get omf(){return this.$wb||this.Zsc}q6a(ab,Ua,hd,qe,Ae){Ae=void 0===Ae?null:Ae;if(this.Bfa[hd])throw Error.invalidOperation("The specified stopwatchId is already in use.");
this.Bfa[hd]=this.Jlf(ab,Ua,hd,qe,Ae)}EVa(ab,Ua){const hd=this.Bfa[ab];hd&&(this.khf(hd,Ua),this.Bbl(hd),delete this.Bfa[ab])}KTc(ab){delete this.Bfa[ab]}KZg(ab,Ua){this.$wb||this.AZg(ab,Ua)}Nue(){this.KZg(Jc.aQd,this.vj.me)}IDd(ab,Ua){Ua=void 0===Ua?!1:Ua;if(this.$wb){if(this.cPa===Jc.Abe||this.cPa===Jc.aQd){const hd=Dd.a.instance;hd.userSessionId=this.userSessionId;if(this.cPa===Jc.Abe){this.K$e||(this.hJa(ab.m,Object(Ud.a)(hd,hd.Tlk,"recordContentFetchEnd")),this.K$e=!0);if(Ua){this.Gwg||(this.hJa(ab.m,
Object(Ud.a)(hd,hd.jmk,"recordPerceivedContentDisplayed")),this.Gwg=!0);return}this.hJa(ab.m,Object(Ud.a)(hd,hd.Slk,"recordContentDisplayed"))}else this.cPa===Jc.aQd&&(Ua=this.Bfa[this.K$b])&&this.hJa(ed.a(ab,Ua.s),Object(Ud.a)(hd,hd.bmk,"recordInteractivityContentDisplayed"),!1)}this.EVa(this.K$b,ab);this.K$b=this.cPa=this.$wb=null}}hJa(ab,Ua,hd){hd=void 0===hd?!0:hd;Dd.a.z0&&Object(ec.a)(Tc.PerformanceClock,A.a.zb)&&hd&&(ab+=window.performance.timing.navigationStart);Ua(ab)}zma(ab){return de.a(ab)}nE(ab,
Ua,hd){hd=void 0===hd?!1:hd;try{if(this.zbg[Ed[ab]]=!0,hd){var qe=E.ULS,Ae=qe.sendTraceTag;const Gd={};let Sg=null;switch(ab){case 0:Sg="Actions";var ef=Ua.a;null!=ef&&(Gd.Id=ef);var Tf=null==Ua.b?null:Ua.b;null!=Tf&&(Gd.Operation=Tf);var Nf=Ua.c;null!=Nf&&(Gd.Target=Nf);var wg=null==Ua.d?null:Ua.d.toString();null!=wg&&(Gd.StartTime=wg);var Uf=null==Ua.e?null:Ua.e.toString();null!=Uf&&(Gd.Duration=Uf);var lg=Ua.f;null!=lg&&(Gd.CorrelationId=lg);var Kg=Ua.g;null!=Kg&&(Gd.ParentAction=Kg);var If=null==
Ua.h?null:Ua.h.toString();null!=If&&(Gd.DocumentHidden=If);break;case 1:Sg="CorrelationStart";var hg=Ua.a;null!=hg&&(Gd.CorrelationId=hg);var gh=Ua.b;null!=gh&&(Gd.UserSessionId=gh);var mc=Ua.c;null!=mc&&(Gd.UserAction=mc);break;case 2:Sg="ReorderSheetOp";var sd=Ua.a;null!=sd&&(Gd.UserSessionId=sd);var ie=null==Ua.b?null:Ua.b.toString();null!=ie&&(Gd.IsDragReorder=ie);var te=null==Ua.c?null:Ua.c.toString();null!=te&&(Gd.DocumentUp=te);var Ve=null==Ua.d?null:Ua.d.toString();null!=Ve&&(Gd.OldIndex=
Ve);var kf=null==Ua.e?null:Ua.e.toString();null!=kf&&(Gd.NewIndex=kf);var Of=null==Ua.f?null:Ua.f.toString();null!=Of&&(Gd.TotalSheets=Of);break;case 3:Sg="FormatCellOp";var Sf=Ua.a;null!=Sf&&(Gd.UserSessionId=Sf);var fg=null==Ua.b?null:Ua.b.toString();null!=fg&&(Gd.TaskId=fg);var Pg=null==Ua.c?null:Ua.c.toString();null!=Pg&&(Gd.NumberOfRanges=Pg);var lh=Ua.d;null!=lh&&(Gd.Ranges=lh);var Qg=Ua.e;null!=Qg&&(Gd.ActiveCell=Qg);var tg=null==Ua.f?null:Ua.f.toString();null!=tg&&(Gd.ActionId=tg);var Dh=
Ua.g;null!=Dh&&(Gd.CommandParameters=Dh);var Gg=Ua.h;null!=Gg&&(Gd.UserActionStopwatchId=Gg);break;case 4:Sg="CopyOp";var gg=Ua.a;null!=gg&&(Gd.UserSessionId=gg);var Hg=null==Ua.b?null:Ua.b.toString();null!=Hg&&(Gd.IsChrome=Hg);var Lg=null==Ua.c?null:Ua.c.toString();null!=Lg&&(Gd.IsIE=Lg);var qh=null==Ua.d?null:Ua.d.toString();null!=qh&&(Gd.IsFromUI=qh);var Dg=null==Ua.e?null:Ua.e.toString();null!=Dg&&(Gd.IsCopyInLoadedRange=Dg);var mh=null==Ua.f?null:Ua.f.toString();null!=mh&&(Gd.IsRepeatedCopy=
mh);var Rg=null==Ua.g?null:Ua.g.toString();null!=Rg&&(Gd.IsClipboarAccessSupported=Rg);var xg=null==Ua.h?null:Ua.h.toString();null!=xg&&(Gd.IsClipboarAccessInstallationSupported=xg);var nh=null==Ua.i?null:Ua.i.toString();null!=nh&&(Gd.RibbonCommand=nh);var Ah=null==Ua.j?null:Ua.j.toString();null!=Ah&&(Gd.CutCopyPasteFlags=Ah);var sh=null==Ua.k?null:Ua.k.toString();null!=sh&&(Gd.IsDrag=sh);var eg=null==Ua.l?null:Ua.l.toString();null!=eg&&(Gd.IsIeBeforeAlowDenyPopUp=eg);var th=Ua.m;null!=th&&(Gd.IsPasteMatchCopy=
th);var uh=Ua.n;null!=uh&&(Gd.WaitMessageInClipboard=uh);var ka=null==Ua.o?null:Ua.o.toString();null!=ka&&(Gd.CallCount=ka);break;case 5:Sg="PasteOp";var ac=Ua.a;null!=ac&&(Gd.UserSessionId=ac);var Xc=null==Ua.b?null:Ua.b.toString();null!=Xc&&(Gd.IsChrome=Xc);var Bd=null==Ua.c?null:Ua.c.toString();null!=Bd&&(Gd.IsIE=Bd);var we=null==Ua.d?null:Ua.d.toString();null!=we&&(Gd.IsCopyActive=we);var Cd=null==Ua.e?null:Ua.e.toString();null!=Cd&&(Gd.IsFromUI=Cd);var Q=null==Ua.f?null:Ua.f.toString();null!=
Q&&(Gd.IsClipboarAccessSupported=Q);var Ja=null==Ua.g?null:Ua.g.toString();null!=Ja&&(Gd.IsClipboarAccessInstallationSupported=Ja);var ob=null==Ua.h?null:Ua.h.toString();null!=ob&&(Gd.RibbonCommand=ob);var qc=null==Ua.i?null:Ua.i.toString();null!=qc&&(Gd.CutCopyPasteFlags=qc);var gd=Ua.j;null!=gd&&(Gd.WaitMessageInClipboard=gd);var td=Ua.k;null!=td&&(Gd.PopupDialog=td);var ca=Ua.l;null!=ca&&(Gd.SimplePopupMessage=ca);var bb=Ua.m;null!=bb&&(Gd.DialogCloseButton=bb);var Hb=Ua.n;null!=Hb&&(Gd.UserPressedInstallLink=
Hb);var Vb=null==Ua.o?null:Ua.o.toString();null!=Vb&&(Gd.CallCount=Vb);break;case 6:Sg="GetNumberViewModelDataOp";var Ec=Ua.a;null!=Ec&&(Gd.UserSessionId=Ec);var rd=Ua.b;null!=rd&&(Gd.NumberFormatOptionsPreviousOutputJson=rd);var Id=Ua.c;null!=Id&&(Gd.NumberFormatOptionsNewInputJson=Id);break;case 7:Sg="InstantaneousSetData";var W=Ua.a;null!=W&&(Gd.Id=W);var Ra=null==Ua.b?null:Ua.b.toString();null!=Ra&&(Gd.WasEmpty=Ra);var nc=null==Ua.c?null:Ua.c.toString();null!=nc&&(Gd.ValueNotChanged=nc);var yc=
Ua.d;null!=yc&&(Gd.Source=yc);var Fd=null==Ua.e?null:Ua.e.toString();null!=Fd&&(Gd.ProcessingCompleted=Fd);break;case 8:Sg="ImmediateSetData";var $d=Ua.a;null!=$d&&(Gd.ClientStopwatchId=$d);var Me=Ua.b;null!=Me&&(Gd.Operation=Me);var ff=Ua.c;null!=ff&&(Gd.Parameters=ff);var jf=null==Ua.d?null:Ua.d.toString();null!=jf&&(Gd.WasUpdatedByImmediate=jf);var Lf=null==Ua.e?null:Ua.e.toString();null!=Lf&&(Gd.areHtmlElementsEqualClientComparison=Lf);var Ef=null==Ua.f?null:Ua.f.toString();null!=Ef&&(Gd.WasDecisionMadeByHtmlComparison=
Ef);var jg=null==Ua.g?null:Ua.g.toString();null!=jg&&(Gd.IsNumeric=jg);var Eg=null==Ua.h?null:Ua.h.toString();null!=Eg&&(Gd.IsDateTime=Eg);var bh=null==Ua.i?null:Ua.i.toString();null!=bh&&(Gd.HasCurrencySymbol=bh);var ch=null==Ua.j?null:Ua.j.toString();null!=ch&&(Gd.HasPercentSymbol=ch);var Fg=null==Ua.k?null:Ua.k.toString();null!=Fg&&(Gd.IsFunc=Fg);var og=null==Ua.l?null:Ua.l.toString();null!=og&&(Gd.DiffInWrappingWhitespace=og);var qg=Ua.m;null!=qg&&(Gd.ImmediatePattern=qg);var Bh=null==Ua.n?null:
Ua.n.toString();null!=Bh&&(Gd.TextAlignmentMatch=Bh);var Jh=null==Ua.o?null:Ua.o.toString();null!=Jh&&(Gd.FontColorMatch=Jh);var Rh=null==Ua.p?null:Ua.p.toString();null!=Rh&&(Gd.FormulaTextMatch=Rh);var hi=null==Ua.q?null:Ua.q.toString();null!=hi&&(Gd.isFormula=hi);var Ni=Ua.r;null!=Ni&&(Gd.FormulaText=Ni);var Eh=Ua.s;null!=Eh&&(Gd.InstantaneousPattern=Eh);var ri=null==Ua.t?null:Ua.t.toString();null!=ri&&(Gd.AreHtmlInnerTextElementsEqualClientComparison=ri);var Oi=Ua.u;null!=Oi&&(Gd.HtmlComparisonDecision=
Oi);break;case 9:Sg="DependentCellsCalc";var Gh=Ua.a;null!=Gh&&(Gd.CalcStatus=Gh);var bi=null==Ua.b?null:Ua.b.toString();null!=bi&&(Gd.SuccessfullyCalculatedRanges=bi);var Ig=null==Ua.c?null:Ua.c.toString();null!=Ig&&(Gd.RangesSkipped=Ig);var Ci=null==Ua.d?null:Ua.d.toString();null!=Ci&&(Gd.TotalErrors=Ci);var ci=null==Ua.e?null:Ua.e.toString();null!=ci&&(Gd.Partial=ci);var di=null==Ua.f?null:Ua.f.toString();null!=di&&(Gd.Canceled=di);var Vi=null==Ua.g?null:Ua.g.toString();null!=Vi&&(Gd.Aggregate=
Vi);var Ch=null==Ua.h?null:Ua.h.toString();null!=Ch&&(Gd.Unknown=Ch);var Pi=null==Ua.i?null:Ua.i.toString();null!=Pi&&(Gd.UnavailableData=Pi);var Di=null==Ua.j?null:Ua.j.toString();null!=Di&&(Gd.Cycle=Di);var Wi=null==Ua.k?null:Ua.k.toString();null!=Wi&&(Gd.NotImplemented=Wi);var Wh=null==Ua.l?null:Ua.l.toString();null!=Wh&&(Gd.InvalidInput=Wh);var Sh=null==Ua.m?null:Ua.m.toString();null!=Sh&&(Gd.AreDepCells=Sh);break;case 10:Sg="DependentCellsGraphStat";var ah=null==Ua.a?null:Ua.a.toString();null!=
ah&&(Gd.ParsedFormulas=ah);var ei=null==Ua.b?null:Ua.b.toString();null!=ei&&(Gd.GraphNodes=ei);var Uh=null==Ua.c?null:Ua.c.toString();null!=Uh&&(Gd.GraphArcs=Uh);var gj=null==Ua.d?null:Ua.d.toString();null!=gj&&(Gd.AnalyzedBlocks=gj);var ii=null==Ua.e?null:Ua.e.toString();null!=ii&&(Gd.IterationId=ii);var Kh=Ua.f;null!=Kh&&(Gd.UniqueId=Kh);var ji=null==Ua.g?null:Ua.g.toString();null!=ji&&(Gd.Aborted=ji);break;case 11:Sg="DependentCellsGraphSectionStat";var ki=null==Ua.a?null:Ua.a.toString();null!=
ki&&(Gd.IterationId=ki);var Zi=Ua.b;null!=Zi&&(Gd.BlockHash=Zi);var Lh=Ua.c;null!=Lh&&(Gd.Functions=Lh);var Fh=Ua.d;null!=Fh&&(Gd.Operators=Fh);var fi=null==Ua.e?null:Ua.e.toString();null!=fi&&(Gd.CrossDocRefs=fi);var Qi=null==Ua.f?null:Ua.f.toString();null!=Qi&&(Gd.CrossSheetRefs=Qi);var si=null==Ua.g?null:Ua.g.toString();null!=si&&(Gd.ErrRefs=si);var hj=null==Ua.h?null:Ua.h.toString();null!=hj&&(Gd.LargeRanges=hj);var li=null==Ua.i?null:Ua.i.toString();null!=li&&(Gd.NameRefs=li);var $i=null==Ua.j?
null:Ua.j.toString();null!=$i&&(Gd.ParserErrors=$i);var xj=null==Ua.k?null:Ua.k.toString();null!=xj&&(Gd.RowRefs=xj);var ti=null==Ua.l?null:Ua.l.toString();null!=ti&&(Gd.ColumnRefs=ti);var Ei=null==Ua.m?null:Ua.m.toString();null!=Ei&&(Gd.TableRefs=Ei);var Ag=Ua.n;null!=Ag&&(Gd.UniqueId=Ag);var vh=null==Ua.o?null:Ua.o.toString();null!=vh&&(Gd.UnreachableReferences=vh);break;case 12:Sg="GetRangeContentPrefetchFailures";var Fi=Ua.a;null!=Fi&&(Gd.UserSessionId=Fi);var mi=Ua.b;null!=mi&&(Gd.ClientStopwatchId=
mi);var ui=null==Ua.c?null:Ua.c.toString();null!=ui&&(Gd.StateId=ui);break;case 13:Sg="GridBlockUpdates";var Qh=Ua.a;null!=Qh&&(Gd.UserSessionId=Qh);var Xi=Ua.b;null!=Xi&&(Gd.CorrelationId=Xi);var ij=Ua.c;null!=ij&&(Gd.Operation=ij);var Rd=null==Ua.d?null:Ua.d.toString();null!=Rd&&(Gd.PerformanceType=Rd);var ve=Ua.e;null!=ve&&(Gd.BlockHash=ve);var Ej=null==Ua.f?null:Ua.f.toString();null!=Ej&&(Gd.DurationInMs=Ej);break;case 14:Sg="BrowserAppStart";var hh=null==Ua.a?null:Pc.a.tUa(Ua.a.getTime());null!=
hh&&(Gd.ScriptExecutionStart=hh);var Ri=Ua.b;null!=Ri&&(Gd.UserSessionId=Ri);var wi=Ua.c;null!=wi&&(Gd.ClockMechanism=wi);var Si=null==Ua.d?null:Ua.d.toString();null!=Si&&(Gd.ScreenDPI=Si);var ni=null==Ua.e?null:Ua.e.toString();null!=ni&&(Gd.NavigationToScriptExecutionDelta=ni);break;case 15:Sg="LinkedObjects";var oi=Ua.a;null!=oi&&(Gd.ChildId=oi);var aj=Ua.b;null!=aj&&(Gd.ParentId=aj);var jj=Ua.c;null!=jj&&(Gd.ChildTable=jj);var Gi=Ua.d;null!=Gi&&(Gd.ParentTable=Gi);break;case 16:Sg="LongFrames";
var sj=null==Ua.a?null:Pc.a.tUa(Ua.a.getTime());null!=sj&&(Gd.StartTime=sj);var oh=null==Ua.b?null:Ua.b.toString();null!=oh&&(Gd.DurationInMs=oh);break;case 17:Sg="Task";var Yh=Ua.a;null!=Yh&&(Gd.StopwatchId=Yh);var xi=null==Ua.b?null:Ua.b.toString();null!=xi&&(Gd.Status=xi);var Zh=null==Ua.c?null:Ua.c.toString();null!=Zh&&(Gd.CreateTime=Zh);var bj=null==Ua.d?null:Ua.d.toString();null!=bj&&(Gd.TaskId=bj);break;case 18:Sg="ConflictInEditing";var tj=Ua.a;null!=tj&&(Gd.OtherUserState=tj);var $h=Ua.b;
null!=$h&&(Gd.UserSessionId=$h);var Fj=null==Ua.c?null:Pc.a.tUa(Ua.c.getTime());null!=Fj&&(Gd.ConflictTime=Fj);break;case 19:Sg="IncomingPresenceData";var cj=Ua.a;null!=cj&&(Gd.UserSessionId=cj);var Mh=Ua.b;null!=Mh&&(Gd.UserId=Mh);var yj=null==Ua.c?null:Ua.c.toString();null!=yj&&(Gd.Disconnected=yj);var cg=null==Ua.d?null:Pc.a.tUa(Ua.d.getTime());null!=cg&&(Gd.ReceivedTime=cg);break;case 20:Sg="EditorTableDelay";var mf=Ua.a;null!=mf&&(Gd.UserSessionId=mf);var Vg=Ua.b;null!=Vg&&(Gd.UserId=Vg);var Hh=
null==Ua.c?null:Ua.c.toString();null!=Hh&&(Gd.Received=Hh);var Nh=null==Ua.d?null:Ua.d.toString();null!=Nh&&(Gd.DurationInMs=Nh);var Yi=null==Ua.e?null:Ua.e.toString();null!=Yi&&(Gd.NotAloneAtLogTime=Yi);var pi=null==Ua.f?null:Pc.a.tUa(Ua.f.getTime());null!=pi&&(Gd.Time=pi);break;case 21:Sg="PresenceStartup";var rf=Ua.a;null!=rf&&(Gd.UserSessionId=rf);var kj=null==Ua.b?null:Ua.b.toString();null!=kj&&(Gd.EverReceived=kj);var Hi=null==Ua.c?null:Ua.c.toString();null!=Hi&&(Gd.NotAloneOnOpen=Hi);var lj=
null==Ua.d?null:Ua.d.toString();null!=lj&&(Gd.NotAloneAtLogTime=lj);var Ii=null==Ua.e?null:Ua.e.toString();null!=Ii&&(Gd.EditorCount=Ii);var Gj=null==Ua.f?null:Ua.f.toString();null!=Gj&&(Gd.WorkbookOpenToFirstReceivedInMs=Gj);break;case 22:Sg="PresenceDelete";var Yg=Ua.a;null!=Yg&&(Gd.UserSessionId=Yg);var yi=Ua.b;null!=yi&&(Gd.UserId=yi);var mj=Ua.c;null!=mj&&(Gd.Context=mj);var Hj=Ua.d;null!=Hj&&(Gd.Reason=Hj);var Ji=null==Ua.e?null:Pc.a.tUa(Ua.e.getTime());null!=Ji&&(Gd.Time=Ji);break;case 23:Sg=
"EditorEvent";var zj=Ua.a;null!=zj&&(Gd.UserSessionId=zj);var Oh=Ua.b;null!=Oh&&(Gd.UserId=Oh);var nj=Ua.c;null!=nj&&(Gd.Context=nj);var Ki=null==Ua.d?null:Pc.a.tUa(Ua.d.getTime());null!=Ki&&(Gd.Time=Ki);break;case 24:Sg="EditorTime";var qi=Ua.a;null!=qi&&(Gd.UserSessionId=qi);var P=Ua.b;null!=P&&(Gd.UserId=P);var ua=null==Ua.c?null:Ua.c.toString();null!=ua&&(Gd.DurationInMs=ua);break;case 25:Sg="GridScreenReaderOps";var Xa=Ua.a;null!=Xa&&(Gd.UserSessionId=Xa);var Pb=Ua.b;null!=Pb&&(Gd.CommandTaskId=
Pb);var hc=null==Ua.c?null:Ua.c.toString();null!=hc&&(Gd.CommandId=hc);var Qc=null==Ua.d?null:Ua.d.toString();null!=Qc&&(Gd.ClientSideOnly=Qc);var vd=null==Ua.e?null:Ua.e.toString();null!=vd&&(Gd.DurationInMS=vd);var Nd=null==Ua.f?null:Ua.f.toString();null!=Nd&&(Gd.ReachedMaxReadoutCells=Nd);var ke=null==Ua.g?null:Ua.g.toString();null!=ke&&(Gd.RequstedCellCount=ke);var Be=null==Ua.h?null:Ua.h.toString();null!=Be&&(Gd.NonEmptyCellCount=Be);var Ze=null==Ua.i?null:Ua.i.toString();null!=Ze&&(Gd.Succeeded=
Ze);var of=null==Ua.j?null:Ua.j.toString();null!=of&&(Gd.Canceled=of);var Xf=Ua.k;null!=Xf&&(Gd.ErrorType=Xf);break;case 26:Sg="SendPresenceToService";var bg=Ua.a;null!=bg&&(Gd.UserSessionId=bg);var Mg=null==Ua.b?null:Ua.b.toString();null!=Mg&&(Gd.TotalCount=Mg);var Jg=null==Ua.c?null:Ua.c.toString();null!=Jg&&(Gd.SendCount=Jg);break;case 27:Sg="IME";var F=Ua.a;null!=F&&(Gd.UserSessionId=F);break;case 28:Sg="FreezePaneFloatingObjects";var va=Ua.a;null!=va&&(Gd.UserSessionId=va);var lb=null==Ua.b?
null:Ua.b.toString();null!=lb&&(Gd.ObjectType=lb);var sc=Ua.c;null!=sc&&(Gd.ObjectID=sc);var Yc=null==Ua.d?null:Ua.d.toString();null!=Yc&&(Gd.SpannedPanesCount=Yc);break;case 29:Sg="CustomizeStatusBar";var jd=Ua.a;null!=jd&&(Gd.UserSessionId=jd);var Ad=Ua.b;null!=Ad&&(Gd.UIControlName=Ad);var Kd=null==Ua.c?null:Ua.c.toString();null!=Kd&&(Gd.IsControlVisible=Kd);break;case 30:Sg="ClientWebRequests";var ye=Ua.a;null!=ye&&(Gd.Path=ye);var Ne=Ua.b;null!=Ne&&(Gd.ProxyStopwatchId=Ne);var hf=Ua.c;null!=
hf&&(Gd.RequestStatus=hf);var sf=null==Ua.d?null:Ua.d.toString();null!=sf&&(Gd.ResponseSizeInBytes=sf);var Gf=Ua.e;null!=Gf&&(Gd.ClientRequestId=Gf);var Yf=null==Ua.f?null:Ua.f.toString();null!=Yf&&(Gd.StateId=Yf);break;case 31:Sg="ShowCommentTaskPane";var Ng=Ua.a;null!=Ng&&(Gd.UserSessionId=Ng);var dh=null==Ua.b?null:Ua.b.toString();null!=dh&&(Gd.IsFromKeyboardShortcut=dh);var vg=null==Ua.c?null:Ua.c.toString();null!=vg&&(Gd.IsShowPane=vg);var zi=null==Ua.d?null:Ua.d.toString();null!=zi&&(Gd.ShowForDeepLink=
zi);var Vh=null==Ua.e?null:Ua.e.toString();null!=Vh&&(Gd.DeepLinkFound=Vh);break;case 32:Sg="ApplyThreadedCommentChange";var Ij=Ua.a;null!=Ij&&(Gd.UserSessionId=Ij);var rk=null==Ua.b?null:Ua.b.toString();null!=rk&&(Gd.Operation=rk);var Bj=Ua.c;null!=Bj&&(Gd.CommentId=Bj);var hl=null==Ua.d?null:Ua.d.toString();null!=hl&&(Gd.CommentsCount=hl);break;case 33:Sg="UpgradeLegacyCommentsChange";var Tj=Ua.a;null!=Tj&&(Gd.UserSessionId=Tj);var uj=null==Ua.b?null:Ua.b.toString();null!=uj&&(Gd.OperationSuccessful=
uj);break;case 34:Sg="FindNextOrPreviousComment";var Oj=Ua.a;null!=Oj&&(Gd.UserSessionId=Oj);var ik=null==Ua.b?null:Ua.b.toString();null!=ik&&(Gd.Succeeded=ik);break;case 35:Sg="Goto";var jk=Ua.a;null!=jk&&(Gd.UserSessionId=jk);var wh=null==Ua.b?null:Ua.b.toString();null!=wh&&(Gd.IsSucceeded=wh);var oj=null==Ua.c?null:Ua.c.toString();null!=oj&&(Gd.IsNOVMode=oj);break;case 36:Sg="LaunchOfficeAddInDialog";var Bg=Ua.a;null!=Bg&&(Gd.UserSessionId=Bg);var T=Ua.b;null!=T&&(Gd.SourceId=T);var gb=Ua.c;null!=
gb&&(Gd.SourceLabel=gb);var Lb=Ua.d;null!=Lb&&(Gd.Flight=Lb);var fd=Ua.e;null!=fd&&(Gd.Experiment=fd);var Ld=Ua.f;null!=Ld&&(Gd.UICultureTag=Ld);var ce=null==Ua.g?null:Ua.g.toString();null!=ce&&(Gd.UICultureTagLcid=ce);var me=null==Ua.h?null:Ua.h.toString();null!=me&&(Gd.WacHostId=me);break;case 37:Sg="RichApiInvocation";var Oe=Ua.a;null!=Oe&&(Gd.UserSessionId=Oe);var Ye=null==Ua.b?null:Ua.b.toString();null!=Ye&&(Gd.Succeeded=Ye);var Ff=Ua.c;null!=Ff&&(Gd.ErrorType=Ff);var ag=Ua.d;null!=ag&&(Gd.ResultInfo=
ag);var ug=Ua.e;null!=ug&&(Gd.Source=ug);break;case 38:Sg="FxLibrary";var Xg=Ua.a;null!=Xg&&(Gd.EntityName=Xg);var rh=null==Ua.b?null:Ua.b.toString();null!=rh&&(Gd.EntryPoint=rh);var Xh=null==Ua.c?null:Ua.c.toString();null!=Xh&&(Gd.Action=Xh);var ck=null==Ua.d?null:Ua.d.toString();null!=ck&&(Gd.InsertLocation=ck);break;case 39:Sg="EmbeddedApiSession";var vi=Ua.a;null!=vi&&(Gd.UserSessionId=vi);break;case 40:Sg="NumberFormattingCalculator";var Mj=Ua.a;null!=Mj&&(Gd.Id=Mj);var dk=Ua.b;null!=dk&&(Gd.CounterName=
dk);var Nj=Ua.c;null!=Nj&&(Gd.Values=Nj);break;case 41:Sg="RequestDataAfterSend";var Li=Ua.a;null!=Li&&(Gd.ClientStopwatchId=Li);var Aj=Ua.b;null!=Aj&&(Gd.RequestStatus=Aj);var dj=null==Ua.c?null:Ua.c.toString();null!=dj&&(Gd.SendDuration=dj);var xh=null==Ua.d?null:Ua.d.toString();null!=xh&&(Gd.RequestId=xh);break;case 42:Sg="FloatingObjectsStopwatchData";var kk=Ua.a;null!=kk&&(Gd.StopMessage=kk);var Fk=null==Ua.b?null:Ua.b.toString();null!=Fk&&(Gd.Type=Fk);var Gk=Ua.c;null!=Gk&&(Gd.GUID=Gk);var Hk=
null==Ua.d?null:Ua.d.toString();null!=Hk&&(Gd.Pane=Hk);var Ik=null==Ua.e?null:Ua.e.toString();null!=Ik&&(Gd.IsAboveGrid=Ik);var $g=Ua.f;null!=$g&&(Gd.StartCorrelation=$g);var Hl=Ua.g;null!=Hl&&(Gd.LoadImageCorrelation=Hl);var Jk=null==Ua.h?null:Ua.h.toString();null!=Jk&&(Gd.SkippedGetEffectsExtents=Jk);var sk=null==Ua.i?null:Ua.i.toString();null!=sk&&(Gd.Version=sk);break;case 43:Sg="Copy";var il=Ua.a;null!=il&&(Gd.UserSessionId=il);var jl=Ua.b;null!=jl&&(Gd.Trigger=jl);var Il=Ua.c;null!=Il&&(Gd.RibbonCommandName=
Il);var tk=Ua.d;null!=tk&&(Gd.SourceItem=tk);var uk=null==Ua.e?null:Ua.e.toString();null!=uk&&(Gd.SourceRangeCellCount=uk);var pj=Ua.f;null!=pj&&(Gd.ClientSideStopwatchId=pj);var Kk=Ua.g;null!=Kk&&(Gd.CopyOperationId=Kk);var vk=null==Ua.h?null:Ua.h.toString();null!=vk&&(Gd.IsAsync=vk);var Lk=null==Ua.i?null:Ua.i.toString();null!=Lk&&(Gd.IsFromCache=Lk);var Mk=null==Ua.j?null:Ua.j.toString();null!=Mk&&(Gd.IsSuccessiveCopy=Mk);var Mi=null==Ua.k?null:Ua.k.toString();null!=Mi&&(Gd.IsSelectionAllowed=
Mi);var Nk=null==Ua.l?null:Ua.l.toString();null!=Nk&&(Gd.IsSuccess=Nk);var Zj=null==Ua.m?null:Ua.m.toString();null!=Zj&&(Gd.IsExpectedError=Zj);var Pj=Ua.n;null!=Pj&&(Gd.ExpectedErrorReason=Pj);var Ih=Ua.o;null!=Ih&&(Gd.ErrorMessage=Ih);var ek=null==Ua.p?null:Ua.p.toString();null!=ek&&(Gd.ClientSideCopyTimeInMs=ek);var ak=null==Ua.q?null:Ua.q.toString();null!=ak&&(Gd.TotalTimeInMs=ak);var Uj=null==Ua.r?null:Ua.r.toString();null!=Uj&&(Gd.PlainTextPayloadSize=Uj);var wk=Ua.s;null!=wk&&(Gd.CopyPasteTargetType=
wk);var kl=null==Ua.t?null:Ua.t.toString();null!=kl&&(Gd.ShadowWorkbookPayloadSize=kl);var Jj=null==Ua.u?null:Ua.u.toString();null!=Jj&&(Gd.HtmlPayloadSize=Jj);var bk=null==Ua.v?null:Ua.v.toString();null!=bk&&(Gd.HtmlSizeExceedsLimit=bk);var fk=null==Ua.w?null:Ua.w.toString();null!=fk&&(Gd.CopyTotalSizeExceedsLimit=fk);var lk=null==Ua.x?null:Ua.x.toString();null!=lk&&(Gd.ErrorReason=lk);var Ok=Ua.y;null!=Ok&&(Gd.ErrorName=Ok);var am=null==Ua.z?null:Ua.z.toString();null!=am&&(Gd.IsSucceededWithAlert=
am);var Pk=null==Ua.ba?null:Ua.ba.toString();null!=Pk&&(Gd.EncounteredDeploymentErrors=Pk);var ll=null==Ua.bb?null:Ua.bb.toString();null!=ll&&(Gd.ShadowWorkbookSizeExceedsLimit=ll);var ej=Ua.bc;null!=ej&&(Gd.CopyPasteTargetName=ej);var vj=Ua.bd;null!=vj&&(Gd.CCPSliceName=vj);var Qk=Ua.be;null!=Qk&&(Gd.SyncClipboardItemsKeys=Qk);var bm=Ua.bf;null!=bm&&(Gd.AsyncClipboardItemsKeys=bm);var gk=Ua.bg;null!=gk&&(Gd.CopyPasteHandlerName=gk);var Jl=Ua.bh;null!=Jl&&(Gd.SucceededPopulatingSystemClipboardSync=
Jl);var hk=Ua.bi;null!=hk&&(Gd.SucceededPopulatingSystemClipboardAsync=hk);var Rk=Ua.bj;null!=Rk&&(Gd.Location=Rk);var Sk=Ua.bk;null!=Sk&&(Gd.CopyContextId=Sk);var kh=null==Ua.bl?null:Ua.bl.toString();null!=kh&&(Gd.ServerRequestTimeInMs=kh);var ml=null==Ua.bm?null:Ua.bm.toString();null!=ml&&(Gd.EcsOperationDuration=ml);var nl=null==Ua.bn?null:Ua.bn.toString();null!=nl&&(Gd.EcsRequestDuration=nl);var Tk=null==Ua.bo?null:Ua.bo.toString();null!=Tk&&(Gd.WfeRequestDuration=Tk);var ol=null==Ua.bp?null:
Ua.bp.toString();null!=ol&&(Gd.OriginalSourceRangesCountExceedsLimit=ol);var Kl=null==Ua.bq?null:Ua.bq.toString();null!=Kl&&(Gd.UploadToClipServiceAttempted=Kl);var Ll=null==Ua.br?null:Ua.br.toString();null!=Ll&&(Gd.FloatingObjectType=Ll);var Ml=null==Ua.bs?null:Ua.bs.toString();null!=Ml&&(Gd.IsCopyWithAsyncClipboardAPI=Ml);break;case 44:Sg="Paste";var pl=Ua.a;null!=pl&&(Gd.UserSessionId=pl);var cm=Ua.b;null!=cm&&(Gd.Trigger=cm);var xk=Ua.c;null!=xk&&(Gd.RibbonCommandName=xk);var Uk=null==Ua.d?null:
Ua.d.toString();null!=Uk&&(Gd.PasteTypeFlagValue=Uk);var ql=Ua.e;null!=ql&&(Gd.PasteOperationId=ql);var rl=Ua.f;null!=rl&&(Gd.CopyOperationId=rl);var sl=Ua.g;null!=sl&&(Gd.ClientSideStopwatchId=sl);var Nl=Ua.h;null!=Nl&&(Gd.OriginalDestinationRange=Nl);var Qj=Ua.i;null!=Qj&&(Gd.ExpandDestinationRange=Qj);var tl=Ua.j;null!=tl&&(Gd.SourceItem=tl);var Vj=null==Ua.k?null:Ua.k.toString();null!=Vj&&(Gd.SourceRangeCellCount=Vj);var ul=null==Ua.l?null:Ua.l.toString();null!=ul&&(Gd.IsSuccess=ul);var Vk=null==
Ua.m?null:Ua.m.toString();null!=Vk&&(Gd.IsExpectedError=Vk);var vl=Ua.n;null!=vl&&(Gd.ClipboardFormatReadTimeInMs=vl);var Th=Ua.o;null!=Th&&(Gd.ClipboardFormatReadStatus=Th);var Wk=null==Ua.p?null:Ua.p.toString();null!=Wk&&(Gd.ClipboardReadPermissionPromptShown=Wk);var wl=null==Ua.q?null:Ua.q.toString();null!=wl&&(Gd.AsyncApiReadTimedOut=wl);var Cj=Ua.r;null!=Cj&&(Gd.ExpectedErrorReason=Cj);var mk=Ua.s;null!=mk&&(Gd.ErrorMessage=mk);var Xk=null==Ua.t?null:Ua.t.toString();null!=Xk&&(Gd.TotalTimeInMs=
Xk);var Rj=null==Ua.u?null:Ua.u.toString();null!=Rj&&(Gd.PlainTextPayloadSize=Rj);var xl=null==Ua.v?null:Ua.v.toString();null!=xl&&(Gd.ShadowWorkbookPayloadSize=xl);var nk=null==Ua.w?null:Ua.w.toString();null!=nk&&(Gd.HtmlPayloadSize=nk);var ok=Ua.x;null!=ok&&(Gd.CopyPasteTargetType=ok);var Ol=null==Ua.y?null:Ua.y.toString();null!=Ol&&(Gd.IsLastCopyWasExternal=Ol);var Yk=null==Ua.z?null:Ua.z.toString();null!=Yk&&(Gd.IsClipboardDataContainShadowWorkbook=Yk);var Zk=null==Ua.ba?null:Ua.ba.toString();
null!=Zk&&(Gd.IsShadowWorkbookParsedSuccessfully=Zk);var wj=Ua.bb;null!=wj&&(Gd.ActiveSelectionType=wj);var Pl=Ua.bc;null!=Pl&&(Gd.PasteResult=Pl);var Ql=null==Ua.bd?null:Ua.bd.toString();null!=Ql&&(Gd.ErrorReason=Ql);var yl=Ua.be;null!=yl&&(Gd.ErrorName=yl);var Rl=null==Ua.bf?null:Ua.bf.toString();null!=Rl&&(Gd.IsSucceededWithAlert=Rl);var Sj=null==Ua.bg?null:Ua.bg.toString();null!=Sj&&(Gd.IsAfterCut=Sj);var yk=null==Ua.bh?null:Ua.bh.toString();null!=yk&&(Gd.EncounteredDeploymentErrors=yk);var zl=
null==Ua.bi?null:Ua.bi.toString();null!=zl&&(Gd.IsCrossSession=zl);var Wj=null==Ua.bj?null:Ua.bj.toString();null!=Wj&&(Gd.ShadowWorkbookSizeExceedsLimit=Wj);var $k=null==Ua.bk?null:Ua.bk.toString();null!=$k&&(Gd.ClipboardContainXLOPayload=$k);var Xj=Ua.bl;null!=Xj&&(Gd.CopyPasteTargetName=Xj);var qj=Ua.bm;null!=qj&&(Gd.ChromeExtensionId=qj);var fj=Ua.bn;null!=fj&&(Gd.PayloadOrigin=fj);var al=Ua.bo;null!=al&&(Gd.PayloadType=al);var Sl=Ua.bp;null!=Sl&&(Gd.CCPSliceName=Sl);var dm=Ua.bq;null!=dm&&(Gd.ClipboardItemsKeys=
dm);var Al=Ua.br;null!=Al&&(Gd.CopyPasteHandlerName=Al);var Bl=null==Ua.bs?null:Ua.bs.toString();null!=Bl&&(Gd.IsSourceItemOriginSameSession=Bl);var pk=Ua.bt;null!=pk&&(Gd.Location=pk);var Tl=Ua.bu;null!=Tl&&(Gd.ExternalAppSource=Tl);var Ul=Ua.bv;null!=Ul&&(Gd.PasteContextId=Ul);var em=null==Ua.bw?null:Ua.bw.toString();null!=em&&(Gd.ServerRequestTimeInMs=em);var Vl=null==Ua.bx?null:Ua.bx.toString();null!=Vl&&(Gd.IndicationDisplayScheduled=Vl);var gi=Ua.by;null!=gi&&(Gd.PasteIndicationDisplayStatus=
gi);var bl=null==Ua.bz?null:Ua.bz.toString();null!=bl&&(Gd.PasteRecoveryUIDisplayed=bl);var Wl=null==Ua.ca?null:Ua.ca.toString();null!=Wl&&(Gd.IsFromPasteRecoveryUI=Wl);var cl=null==Ua.cb?null:Ua.cb.toString();null!=cl&&(Gd.EcsOperationDuration=cl);var fm=null==Ua.cc?null:Ua.cc.toString();null!=fm&&(Gd.EcsRequestDuration=fm);var Xl=null==Ua.cd?null:Ua.cd.toString();null!=Xl&&(Gd.WfeRequestDuration=Xl);var Yl=null==Ua.ce?null:Ua.ce.toString();null!=Yl&&(Gd.OriginalSourceRangesCountExceedsLimit=Yl);
var Cl=Ua.cf;null!=Cl&&(Gd.PasteRecoveryUndoStopwatchId=Cl);var zk=null==Ua.cg?null:Ua.cg.toString();null!=zk&&(Gd.PasteRecoveryUndoTimeInMs=zk);var Dl=null==Ua.ch?null:Ua.ch.toString();null!=Dl&&(Gd.PasteCSEPerformed=Dl);var dl=null==Ua.ci?null:Ua.ci.toString();null!=dl&&(Gd.CSEStatus=dl);var El=null==Ua.cj?null:Ua.cj.toString();null!=El&&(Gd.IsFromEnterShortcut=El);var Ak=null==Ua.ck?null:Ua.ck.toString();null!=Ak&&(Gd.pasteDestinationHasMergedCells=Ak);var yg=Ua.cl;null!=yg&&(Gd.ArtSourceItemType=
yg);var el=null==Ua.cm?null:Ua.cm.toString();null!=el&&(Gd.IsPasteWithAsyncClipboardAPI=el);var Bk=null==Ua.cn?null:Ua.cn.toString();null!=Bk&&(Gd.IsPasteWithChromiumExtension=Bk);var D=null==Ua.co?null:Ua.co.toString();null!=D&&(Gd.PasteDestinationHasFilter=D);var ma=null==Ua.cp?null:Ua.cp.toString();null!=ma&&(Gd.PasteDestinationFilterActive=ma);var vb=null==Ua.cq?null:Ua.cq.toString();null!=vb&&(Gd.PasteDestinationHasHiddenRows=vb);var lc=null==Ua.cr?null:Ua.cr.toString();null!=lc&&(Gd.PasteDestinationHasHiddenColumns=
lc);break;case 45:Sg="DragDrop";var Nc=Ua.a;null!=Nc&&(Gd.UserSessionId=Nc);var wd=Ua.b;null!=wd&&(Gd.Trigger=wd);var Yd=Ua.c;null!=Yd&&(Gd.RibbonCommandName=Yd);var ee=Ua.d;null!=ee&&(Gd.OperationId=ee);var ae=Ua.e;null!=ae&&(Gd.ClientSideStopwatchId=ae);var he=Ua.f;null!=he&&(Gd.SourceRange=he);var De=Ua.g;null!=De&&(Gd.DestinationRange=De);var Se=Ua.h;null!=Se&&(Gd.CutCopyType=Se);var qf=null==Ua.i?null:Ua.i.toString();null!=qf&&(Gd.IsShiftKeyDown=qf);var kg=null==Ua.j?null:Ua.j.toString();null!=
kg&&(Gd.IsDragInsert=kg);var $f=null==Ua.k?null:Ua.k.toString();null!=$f&&(Gd.IsSuccess=$f);var Cg=null==Ua.l?null:Ua.l.toString();null!=Cg&&(Gd.IsExpectedError=Cg);var sg=Ua.m;null!=sg&&(Gd.ExpectedErrorReason=sg);var ng=Ua.n;null!=ng&&(Gd.ErrorMessage=ng);var eh=null==Ua.o?null:Ua.o.toString();null!=eh&&(Gd.TotalTimeInMs=eh);var yh=Ua.p;null!=yh&&(Gd.ErrorName=yh);var Ph=null==Ua.q?null:Ua.q.toString();null!=Ph&&(Gd.IsSucceededWithAlert=Ph);var Yj=Ua.r;null!=Yj&&(Gd.CopyPasteTargetType=Yj);var Kj=
null==Ua.s?null:Ua.s.toString();null!=Kj&&(Gd.EncounteredDeploymentErrors=Kj);var sm=null==Ua.t?null:Ua.t.toString();null!=sm&&(Gd.IsHeaderDrag=sm);break;case 46:Sg="ClearCopyState";var Ti=Ua.a;null!=Ti&&(Gd.UserSessionId=Ti);var Fl=Ua.b;null!=Fl&&(Gd.ClientSideStopwatchId=Fl);var Lm=Ua.c;null!=Lm&&(Gd.Trigger=Lm);var Mm=null==Ua.d?null:Ua.d.toString();null!=Mm&&(Gd.IsClearClipboard=Mm);var tm=null==Ua.e?null:Ua.e.toString();null!=tm&&(Gd.IsExplicit=tm);var um=null==Ua.f?null:Ua.f.toString();null!=
um&&(Gd.IsSuccess=um);var Nm=Ua.g;null!=Nm&&(Gd.ErrorMessage=Nm);var gm=Ua.h;null!=gm&&(Gd.ErrorName=gm);var hm=null==Ua.i?null:Ua.i.toString();null!=hm&&(Gd.TotalTimeInMs=hm);var Om=Ua.j;null!=Om&&(Gd.CopyPasteTargetType=Om);break;case 47:Sg="WebWorkerRecalcStats";var Pm=null==Ua.a?null:Ua.a.toString();null!=Pm&&(Gd.SuccessCount=Pm);var Qm=null==Ua.b?null:Ua.b.toString();null!=Qm&&(Gd.FailureCount=Qm);var vm=null==Ua.c?null:Ua.c.toString();null!=vm&&(Gd.ValueTypeMismatchCount=vm);var im=null==Ua.d?
null:Ua.d.toString();null!=im&&(Gd.CellValueMismatchCount=im);var Rm=null==Ua.e?null:Ua.e.toString();null!=Rm&&(Gd.IfmtMismatchCount=Rm);var Sm=null==Ua.f?null:Ua.f.toString();null!=Sm&&(Gd.FormattedTextMismatchCount=Sm);var wm=null==Ua.g?null:Ua.g.toString();null!=wm&&(Gd.CellValueStringMismatchCount=wm);var jm=null==Ua.h?null:Ua.h.toString();null!=jm&&(Gd.CellValueNumberMismatchCount=jm);var km=null==Ua.i?null:Ua.i.toString();null!=km&&(Gd.CellValueBooleanMismatchCount=km);var Tm=null==Ua.j?null:
Ua.j.toString();null!=Tm&&(Gd.CellValueBlankMismatchCount=Tm);var Um=null==Ua.k?null:Ua.k.toString();null!=Um&&(Gd.CellValueErrorMismatchCount=Um);var lm=null==Ua.l?null:Ua.l.toString();null!=lm&&(Gd.FormattedTextStringMismatchCount=lm);var mm=null==Ua.m?null:Ua.m.toString();null!=mm&&(Gd.FormattedTextNumberMismatchCount=mm);var xm=null==Ua.n?null:Ua.n.toString();null!=xm&&(Gd.FormattedTextBooleanMismatchCount=xm);var Zl=null==Ua.o?null:Ua.o.toString();null!=Zl&&(Gd.FormattedTextBlankMismatchCount=
Zl);var nm=null==Ua.p?null:Ua.p.toString();null!=nm&&(Gd.FormattedTextErrorMismatchCount=nm);var Ck=null==Ua.q?null:Ua.q.toString();null!=Ck&&(Gd.StringMismatchCount=Ck);var Vm=null==Ua.r?null:Ua.r.toString();null!=Vm&&(Gd.NumericMismatchCount=Vm);var ym=null==Ua.s?null:Ua.s.toString();null!=ym&&(Gd.ErrorMismatchCount=ym);var om=null==Ua.t?null:Ua.t.toString();null!=om&&(Gd.StringValuesCount=om);var zm=null==Ua.u?null:Ua.u.toString();null!=zm&&(Gd.NumericValuesCount=zm);var Am=null==Ua.v?null:Ua.v.toString();
null!=Am&&(Gd.BooleanValuesCount=Am);var Dk=null==Ua.w?null:Ua.w.toString();null!=Dk&&(Gd.BlankValuesCount=Dk);var Lj=null==Ua.x?null:Ua.x.toString();null!=Lj&&(Gd.ErrorValuesCount=Lj);var Bm=null==Ua.y?null:Ua.y.toString();null!=Bm&&(Gd.NumericValuesDiffAverage=Bm);var Ek=Ua.z;null!=Ek&&(Gd.NumericEvaluatedValuesMismatchSamples=Ek);var Cm=Ua.ba;null!=Cm&&(Gd.NumericFormattedTextMismatchSamples=Cm);var Gl=Ua.bb;null!=Gl&&(Gd.NumericMismatchSamples=Gl);var Dm=Ua.bc;null!=Dm&&(Gd.CellValueTypeMismatchSamples=
Dm);var Em=Ua.bd;null!=Em&&(Gd.IfmtMismatchSamples=Em);var Wm=Ua.be;null!=Wm&&(Gd.BlockHashCode=Wm);break;case 48:Sg="DataValidationEditOpenDialog";var pm=Ua.a;null!=pm&&(Gd.ServerCommand=pm);var fl=null==Ua.b?null:Ua.b.toString();null!=fl&&(Gd.SubDialogOpened=fl);var Fm=Ua.c;null!=Fm&&(Gd.SubDialogButtonClicked=Fm);var Gm=null==Ua.d?null:Ua.d.toString();null!=Gm&&(Gd.DialogOpened=Gm);var qm=Ua.e;null!=qm&&(Gd.RuleType=qm);var Hm=Ua.f;null!=Hm&&(Gd.ConditionType=Hm);var Xm=null==Ua.g?null:Ua.g.toString();
null!=Xm&&(Gd.LowerBoundaryFilled=Xm);var Im=null==Ua.h?null:Ua.h.toString();null!=Im&&(Gd.UpperBoundaryFilled=Im);var rm=null==Ua.i?null:Ua.i.toString();null!=rm&&(Gd.IgnoreBlank=rm);var H=null==Ua.j?null:Ua.j.toString();null!=H&&(Gd.InCellDropdown=H);var ha=null==Ua.k?null:Ua.k.toString();null!=ha&&(Gd.ShowInputMessage=ha);var Ya=null==Ua.l?null:Ua.l.toString();null!=Ya&&(Gd.InputTitleFilled=Ya);var Wb=null==Ua.m?null:Ua.m.toString();null!=Wb&&(Gd.InputMessageFilled=Wb);var Sc=null==Ua.n?null:Ua.n.toString();
null!=Sc&&(Gd.ShowErrorAlert=Sc);var zd=null==Ua.o?null:Ua.o.toString();null!=zd&&(Gd.AlertBlocking=zd);var be=null==Ua.p?null:Ua.p.toString();null!=be&&(Gd.AlertTitleFilled=be);var oe=null==Ua.q?null:Ua.q.toString();null!=oe&&(Gd.AlertMessageFilled=oe);var Ke=Ua.r;null!=Ke&&(Gd.StopWatchId=Ke);break;case 49:Sg="DataValidationEditSubmitRule";var Xe=Ua.a;null!=Xe&&(Gd.RuleType=Xe);var ig=Ua.b;null!=ig&&(Gd.ConditionType=ig);var Og=null==Ua.c?null:Ua.c.toString();null!=Og&&(Gd.LowerBoundaryFilled=Og);
var mg=null==Ua.d?null:Ua.d.toString();null!=mg&&(Gd.UpperBoundaryFilled=mg);var ih=null==Ua.e?null:Ua.e.toString();null!=ih&&(Gd.IgnoreBlank=ih);var ai=null==Ua.f?null:Ua.f.toString();null!=ai&&(Gd.InCellDropdown=ai);var Dj=null==Ua.g?null:Ua.g.toString();null!=Dj&&(Gd.ShowInputMessage=Dj);var Ai=null==Ua.h?null:Ua.h.toString();null!=Ai&&(Gd.InputTitleFilled=Ai);var Ui=null==Ua.i?null:Ua.i.toString();null!=Ui&&(Gd.InputMessageFilled=Ui);var Bi=null==Ua.j?null:Ua.j.toString();null!=Bi&&(Gd.ShowErrorAlert=
Bi);var qk=null==Ua.k?null:Ua.k.toString();null!=qk&&(Gd.AlertBlocking=qk);var rj=null==Ua.l?null:Ua.l.toString();null!=rj&&(Gd.AlertTitleFilled=rj);var gl=null==Ua.m?null:Ua.m.toString();null!=gl&&(Gd.AlertMessageFilled=gl);var $l=null==Ua.n?null:Ua.n.toString();null!=$l&&(Gd.ClearAllPressed=$l);var Jm=Ua.o;null!=Jm&&(Gd.ActionStatus=Jm);var Km=Ua.p;null!=Km&&(Gd.Error=Km);var cn=Ua.q;null!=cn&&(Gd.StopWatchId=cn);var dn=null==Ua.r?null:Ua.r.toString();null!=dn&&(Gd.InsertDropdownButton=dn);break;
case 50:Sg="CustomSort";var en=Ua.a;null!=en&&(Gd.RangeType=en);var fn=null==Ua.b?null:Ua.b.toString();null!=fn&&(Gd.HasHeaders=fn);var gn=null==Ua.c?null:Ua.c.toString();null!=gn&&(Gd.SortTopToBottom=gn);var hn=null==Ua.d?null:Ua.d.toString();null!=hn&&(Gd.ColumnCount=hn);var jn=null==Ua.e?null:Ua.e.toString();null!=jn&&(Gd.RowCount=jn);var kn=null==Ua.f?null:Ua.f.toString();null!=kn&&(Gd.RangeLimitExceeded=kn);var ln=null==Ua.g?null:Ua.g.toString();null!=ln&&(Gd.CaseSensitive=ln);var mn=null==Ua.h?
null:Ua.h.toString();null!=mn&&(Gd.GetSortInfoDuration=mn);var nn=null==Ua.i?null:Ua.i.toString();null!=nn&&(Gd.LevelCount=nn);var on=null==Ua.j?null:Ua.j.toString();null!=on&&(Gd.SortOnValuesCount=on);var pn=null==Ua.k?null:Ua.k.toString();null!=pn&&(Gd.SortOnCellColorCount=pn);var qn=null==Ua.l?null:Ua.l.toString();null!=qn&&(Gd.SortOnFontColorCount=qn);var rn=null==Ua.m?null:Ua.m.toString();null!=rn&&(Gd.SortOnIconCount=rn);var sn=null==Ua.n?null:Ua.n.toString();null!=sn&&(Gd.CustomOrderCount=
sn);var tn=null==Ua.o?null:Ua.o.toString();null!=tn&&(Gd.AvgCellColorCount=tn);var un=null==Ua.p?null:Ua.p.toString();null!=un&&(Gd.MaxCellColorCount=un);var vn=null==Ua.q?null:Ua.q.toString();null!=vn&&(Gd.AvgFontColorCount=vn);var wn=null==Ua.r?null:Ua.r.toString();null!=wn&&(Gd.MaxFontColorCount=wn);var xn=null==Ua.s?null:Ua.s.toString();null!=xn&&(Gd.AvgIconsCount=xn);var yn=null==Ua.t?null:Ua.t.toString();null!=yn&&(Gd.MaxIconsCount=yn);var zn=null==Ua.u?null:Ua.u.toString();null!=zn&&(Gd.Executed=
zn);break;case 51:Sg="NamedSheetViewUserAction";var An=Ua.a;null!=An&&(Gd.UserSessionId=An);var Bn=Ua.b;null!=Bn&&(Gd.UserActionName=Bn);var Cn=null==Ua.c?null:Ua.c.toString();null!=Cn&&(Gd.UserActionSource=Cn);var Dn=Ua.d;null!=Dn&&(Gd.UserActionData=Dn);var En=Ua.e;null!=En&&(Gd.OtherData=En);break;case 52:Sg="NamedSheetViewTeachingCallout";var Fn=Ua.a;null!=Fn&&(Gd.UserSessionId=Fn);var Gn=null==Ua.b?null:Ua.b.toString();null!=Gn&&(Gd.TeachingCalloutSequence=Gn);var Hn=null==Ua.c?null:Ua.c.toString();
null!=Hn&&(Gd.TeachingCalloutIndex=Hn);var In=null==Ua.d?null:Ua.d.toString();null!=In&&(Gd.UserActionName=In);var Jn=Ua.e;null!=Jn&&(Gd.UserActionData=Jn);var Kn=null==Ua.f?null:Ua.f.toString();null!=Kn&&(Gd.DurationInMs=Kn);break;case 53:Sg="NamedSheetViewTeachingDialog";var Ln=Ua.a;null!=Ln&&(Gd.UserSessionId=Ln);var Mn=Ua.b;null!=Mn&&(Gd.UserActionName=Mn);var Nn=Ua.c;null!=Nn&&(Gd.ButtonClicked=Nn);var On=null==Ua.d?null:Ua.d.toString();null!=On&&(Gd.DurationInMs=On);var Pn=null==Ua.e?null:Ua.e.toString();
null!=Pn&&(Gd.IsNewTeachingDialog=Pn);break;case 54:Sg="NamedSheetViewOptionsDialog";var Qn=Ua.a;null!=Qn&&(Gd.UserSessionId=Qn);var Rn=null==Ua.b?null:Ua.b.toString();null!=Rn&&(Gd.OptionsAction=Rn);var Sn=Ua.c;null!=Sn&&(Gd.OptionsActionData=Sn);var Tn=Ua.d;null!=Tn&&(Gd.OptionsOtherData=Tn);var Un=null==Ua.e?null:Ua.e.toString();null!=Un&&(Gd.DurationInMs=Un);break;case 55:Sg="NamedSheetViewTempViewSaveDialog";var Vn=Ua.a;null!=Vn&&(Gd.UserSessionId=Vn);var Wn=Ua.b;null!=Wn&&(Gd.TriggeredFrom=
Wn);var Xn=Ua.c;null!=Xn&&(Gd.ButtonClicked=Xn);var Yn=null==Ua.d?null:Ua.d.toString();null!=Yn&&(Gd.NameUpdated=Yn);var Zn=null==Ua.e?null:Ua.e.toString();null!=Zn&&(Gd.DurationInMs=Zn);break;case 56:Sg="TemporaryViewStartedDataRestore";var $n=Ua.a;null!=$n&&(Gd.UserSessionId=$n);var ao=null==Ua.b?null:Ua.b.toString();null!=ao&&(Gd.CountOfTempViews=ao);break;case 57:Sg="TemporaryViewFetchedVersion";var bo=Ua.a;null!=bo&&(Gd.UserSessionId=bo);var co=null==Ua.b?null:Ua.b.toString();null!=co&&(Gd.NumberOfBytes=
co);break;case 58:Sg="RaiseEventsAndGenerateBlockRequests";var eo=null==Ua.a?null:Ua.a.toString();null!=eo&&(Gd.ReturnContentStatus=eo);var fo=null==Ua.b?null:Ua.b.toString();null!=fo&&(Gd.CacheState=fo);var go=null==Ua.c?null:Ua.c.toString();null!=go&&(Gd.FromXhrCallback=go);var ho=null==Ua.d?null:Ua.d.toString();null!=ho&&(Gd.AreGeneralErrorsPresent=ho);var io=Ua.e;null!=io&&(Gd.BlockCacheItemHash=io);var jo=Ua.f;null!=jo&&(Gd.StopwatchId=jo);var ko=Ua.g;null!=ko&&(Gd.BlockCacheItemProcessingStopwatchId=
ko);var lo=null==Ua.h?null:Ua.h.toString();null!=lo&&(Gd.StateId=lo);var mo=null==Ua.i?null:Ua.i.toString();null!=mo&&(Gd.IsHighPriority=mo);var no=null==Ua.j?null:Ua.j.toString();null!=no&&(Gd.CalcComplete=no);var oo=null==Ua.k?null:Ua.k.toString();null!=oo&&(Gd.EditedCellsUpdatedByCse=oo);var po=null==Ua.l?null:Ua.l.toString();null!=po&&(Gd.DependentCellsUpdatedByCse=po);var qo=null==Ua.m?null:Ua.m.toString();null!=qo&&(Gd.Revision=qo);var ro=null==Ua.n?null:Ua.n.toString();null!=ro&&(Gd.SheetProcessedDataVersion=
ro);var so=null==Ua.o?null:Ua.o.toString();null!=so&&(Gd.RefCount=so);var to=null==Ua.p?null:Ua.p.toString();null!=to&&(Gd.ExistsInView=to);var uo=null==Ua.q?null:Ua.q.toString();null!=uo&&(Gd.ContentSource=uo);break;case 59:Sg="LaunchMakerCodeEditor";var vo=Ua.a;null!=vo&&(Gd.SessionId=vo);var wo=Ua.b;null!=wo&&(Gd.Command=wo);var xo=null==Ua.c?null:Ua.c.toString();null!=xo&&(Gd.IsPreviewGallery=xo);var yo=Ua.d;null!=yo&&(Gd.MenuItemId=yo);var zo=Ua.e;null!=zo&&(Gd.ScriptId=zo);var Ao=Ua.f;null!=
Ao&&(Gd.ShareId=Ao);var Bo=null==Ua.g?null:Ua.g.toString();null!=Bo&&(Gd.IsOwner=Bo);var Co=null==Ua.h?null:Ua.h.toString();null!=Co&&(Gd.PublishedScriptCount=Co);var Do=null==Ua.i?null:Ua.i.toString();null!=Do&&(Gd.RecentScriptCount=Do);var Eo=null==Ua.j?null:Ua.j.toString();null!=Eo&&(Gd.WorkbookScriptCount=Eo)}Gd.Table=Sg;var Jo=Sys.Serialization.JavaScriptSerializer.serialize(Gd);Ae.call(qe,3704927,0,50,Jo)}}catch(Gd){E.ULS.sendTraceTag(3704928,0,10,`Error when serializing usage table: ${ab} exception: ${Gd}`)}}EMb(ab,
Ua,hd){if(this.IQc){const qe=this.W$a[ab+Ua];qe&&(qe.e=hd,this.MGd(qe));delete this.W$a[ab+Ua]}}J2d(ab,Ua){Ed[ab]in this.zbg||this.nE(ab,Ua)}$wg(){this.vj.appStart&&this.AZg(Jc.Abe,this.vj.appStart)}qHj(ab){const Ua={};Ua.a=ab.i;Ua.b=ab.o;Ua.c=ab.t;Ua.d=ed.a(ab.s,ab.p||this.vj.appStart);Ua.e=ed.a(ab.e,ab.s);Ua.f=ab.c;Ua.g=ab.a;Ua.h=ab.h;this.nE(0,Ua,this.auj(Ua.b,Ua.c))}auj(ab,Ua){return["CommandTask","QueuedTask","Task"].includes(ab)&&!this.Qxi.includes(Ua)?!1:!0}Gbb(ab,Ua,hd,qe,Ae){if(ab&&Ua){const ef=
{};ef.a=ab;ef.b=Ua;ef.c=hd.toString();ef.d=qe.toString();this.nE(15,ef,void 0===Ae?!0:Ae)}}PKc(ab,Ua,hd,qe){const Ae={};ab&&(Ae.c=ed.a(ab,this.vj.appStart));Ae.b=Ua;Ae.a=hd;Ae.d=qe;this.nE(17,Ae)}dispose(){this.HLa.execute(ab=>{ab.deactivate(!0);ab.Fsk(this.Irg)});this.df&&this.df.fsb(this.iR);super.dispose()}uPd(){return this.Cah=this.Cah||new ud}Jlf(ab,Ua,hd,qe,Ae){const ef={};ef.o=ab;ef.t=Ua;ef.p=void 0===Ae?null:Ae;ef.s=(void 0===qe?null:qe)||this.vj.me;this.FTd(ef,void 0===hd?null:hd);return ef}khf(ab,
Ua){ab&&(ab.e=(void 0===Ua?null:Ua)||this.vj.me,ab.i=ab.i||this.Kra.uJa(),ab.c=ab.c||this.omf,ab.a=ab.a||this.ymf,ab.h=void 0!==ab.h&&null!==ab.h?ab.h:this.df?this.df.isHidden:!1,this.MGd(ab))}C3d(ab){const Ua=ab.context;ab.duration>Jc.eki&&(Ua.methodName===Fa.a.sQb||Ua.methodName===Fa.a.PGa)&&this.NUc(1,Jc.kZi);if("GetSessionStatus"!==Ua.methodName){const hd={};hd.a=Ua.methodName;hd.b=Ua.stopwatch.id;hd.c=ab.l4b;hd.d=ab.responseSize;hd.e=Ua.STa;hd.f=ab.Ge?ab.Ge.StateId:Fa.a.Yye;this.nE(30,hd,!0);
this.Gbb(hd.b,ab.Ge.ServerCorrelationId,"clientWebRequests","ServerActions")}}vve(){if(this.IQc){const ab=this.W$a.LoadingUIShownSplashScreen;ab&&kb.a.instance.$Kk(ab.s)}}NUc(ab,Ua,hd){this.Z9g.$3b(ab,Ua,void 0===hd?null:hd)}Oje(ab){this.a$g.oke(ab,null)}Pje(ab,Ua){this.a$g.$3b(ab,Ua,null)}Z3b(ab,Ua,hd){this.S7a.Z3b(ab,Ua,void 0===hd?null:hd)}c4b(ab,Ua,hd){this.S7a.c4b(ab,Ua,void 0===hd?null:hd)}F5b(ab,Ua,hd,qe,Ae,ef,Tf,...Nf){this.S7a.F5b(ab,Ua,hd,qe,Ae,ef,Tf,...Nf)}G5b(ab,Ua,hd,qe,Ae,ef,Tf){this.S7a.G5b(ab,
Ua,hd,qe,Ae,ef,Tf)}J5b(ab,Ua,hd,qe,Ae,ef){this.S7a.J5b(ab,Ua,hd,qe,Ae,ef)}I5b(ab,Ua,hd,qe,Ae,ef,...Tf){this.S7a.I5b(ab,Ua,hd,qe,Ae,ef,...Tf)}K5b(ab,Ua,hd,qe,Ae,ef){this.Z9g.K5b(ab,Ua,hd,qe,Ae,ef)}H5b(ab,Ua,hd,qe){this.S7a.H5b(ab,Ua,hd,qe)}MGd(ab){this.j_g.qHj(ab)}axg(){if(this.IQc){Stw.swpc=null;const ab=this.IQc;for(const Ua in ab)this.FTd(ab[Ua])}}sBf(){const ab=window[se.a.namespace];if(ab){const Ua=ab[se.a.lgf];Ua&&(delete ab[se.a.lgf],Ua.forEach(hd=>{this.FTd(hd);this.MGd(hd)}))}}Evj(ab,Ua){if("about:blank"===
ab||"renamehandler.ashx"===Ua&&"2"===Hc.a.$r(ab,"u"))return!0;for(ab=0;ab<this.Cke.length;ab++)if(Ua.endsWith(this.Cke[ab]))return!0;return!1}I$f(){this.HLa.execute(ab=>{ab.ji(Jc.ZMh,0);ab.HDh(this.Irg);ab.activate()})}A$f(){const ab={};ab.a=new Date(fe.EcmaDateClock.instance.appStart.m);ab.b=this.userSessionId;ab.c=this.vj.C2g;ab.d=Jc.wdi*uc.devicePixelRatio;ab.e=A.a.zb.appStart.m;this.nE(14,ab,!0);this.hJa(A.a.zb.appStart.m,Object(Ud.a)(Dd.a.instance,Dd.a.instance.Jlk,"recordAppInitStart"))}AZg(ab,
Ua){this.$wb=this.Kra.uJa();this.K$b=this.Kra.uJa();this.cPa=ab;this.q6a("UserAction",ab,this.K$b,Ua);this.H2d(ab,this.$wb)}h1g(){const ab=window[se.a.namespace];ab&&!Jc.Ojf&&(ab[se.a.U_k]=(Ua,hd)=>this.Jlf(Ua,hd),ab[se.a.xmi]=Ua=>{this.khf(Ua)},Jc.Ojf=!0)}Bbl(ab){const Ua=rc.JQh(ab.o,ab.t),hd=new rc(ed.a(ab.e,ab.s)),qe=Ua in this.nve?this.nve[Ua].c0h(hd):hd;this.nve[Ua]=qe;if(hd===qe||hd.average!==qe.average)ab=Object(fb.a)(new rb,{operation:ab.o,target:ab.t,nPj:qe.average,sender:this}),this.raiseEvent(Ua,
ab)}H2d(ab,Ua){const hd={};hd.a=Ua;hd.b=this.userSessionId;hd.c=ab;this.nE(1,hd,!0)}WWf(){this.Cke=[Fa.a.Qpk,Fa.a.getSessionStatus,Fa.a.PGa,Fa.a.N_h,Fa.a.vXh,Fa.a.Qwb,Fa.a.xAc,Fa.a.getObjectMetadata,Fa.a.LWi,Fa.a.setRichTextCell,Fa.a.TGa,Fa.a.wgl,Fa.a.pollSessionStatus,Fa.a.M1i,Fa.a.z_i,Fa.a.rTi]}FTd(ab,Ua){ab.i=(void 0===Ua?null:Ua)||this.Kra.uJa();ab.a=this.ymf;ab.c=this.omf;ab.h=this.df?this.df.isHidden:!1}static Ea(ab){const Ua=new Jc(ab,null,ab.ra,ab.ta.UserSessionId,void 0,void 0,void 0,!0);
Ua.H2d(Jc.n7d,Ua.Zsc);E.ULS.sendTraceTag(507282755,0,50,"TelemetryManager: Activating BrowserResourceTiming Telemetry logs");Ua.I$f();Ua.h1g();Ua.$wg();Ua.A$f();Ua.sBf();Ua.axg();Ua.WWf();Jc.pQg(ab);pd.a.ds.zc(41,Ua)}static pQg(ab){const Ua=uc.devicePixelRatio;1<Ua&&ab.$b.bA(!0,2<=Ua?8388608:4194304)}};gc.n7d="UnassignedUserAction";gc.Abe="PageLoad";gc.aQd="GridUpdateOperation";gc.eki=5E3;gc.kZi="MoreThan_5000_Ms";gc.wdi=96;gc.ZMh=30;gc.Ojf=!1;gc=Jc=Object(w.__decorate)([Object(ea.d)(S.TelemetryManagerService),
Object(w.__param)(0,Object(S.EwaControlService)()),Object(w.__param)(1,Object(S.DocumentVisibilityObserverService)())],gc);Object(z.a)(gc,"TelemetryManager",la.a,[584,585,586,587]);var dd=a(211),Bb=a(99);class pc{constructor(ab,Ua,hd){this.Xil=ab;this.x1=Ua;this.name=hd}}Object(z.a)(pc,"Validation",null,[]);var wc;let cd=wc=class{constructor(ab){this.apb=()=>{this.Mwg(this.yCf)};this.Ij=()=>{this.Mwg(this.jOh)};this.$=ab;this.jOh=[];this.yCf=[];Na.f(this.$).za.Or(this.Ij);Na.f(this.$).za.M3e(this.apb)}znd(ab,
Ua,hd,qe,Ae){if(ab&&qe){const ef=dd.a.MA(Ua,hd);this.Hkc(()=>!!Bb.a(ab).fr(ef),qe.StateId,Ae)}}Hkc(ab,Ua,hd){this.mCh(this.yCf,ab,Ua,hd)}mCh(ab,Ua,hd,qe){ab&&Ua&&hd!==Fa.a.Me&&ab.push(new pc(Ua,hd,qe))}Mwg(ab){if(ab){var Ua=[];for(const hd of ab){if(hd.x1===this.$.fa.Je)try{hd.Xil()||E.ULS.sendTraceTag(537151010,0,15,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation result is false. Validation Name: [${hd.name}]`)}catch(qe){E.ULS.sendTraceTag(537151009,0,10,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation has caused an exception to be thrown. Validation Name: [${hd.name}]. Exception: [${qe}]`)}Ua.push(hd)}for(const hd of Ua)Ua=
ab.indexOf(hd),0<=Ua&&ab.splice(Ua,1)}else E.ULS.shipAssertTag(537151011,0,!!ab,"ValidationTelemetryManager.PerformAndRemoveValidations: Validation list is null")}dispose(){Na.f(this.$)&&Na.f(this.$).za&&(Na.f(this.$).za.Gq(this.Ij),Na.f(this.$).za.nie(this.apb));this.$=null}static Ea(ab){const Ua=new wc(ab);ab.ra.zc(277,Ua)}};cd=wc=Object(w.__decorate)([Object(ea.d)(S.ValidationTelemetryManagerService),Object(w.__param)(0,Object(S.EwaControlService)())],cd);Object(z.a)(cd,"ValidationTelemetryManager",
null,[583,4]);let Vd=class{constructor(ab){this.i3a=void 0;this.Tdg=()=>{this.O$g(!0)};this.Sdg=()=>{this.O$g(!1)};this.bZ=(Ua,hd)=>{hd.t8d!==Fa.a.Me&&(this.i3a=hd.DPj===Fa.a.Me?this.$.fa.Cw:hd.t8d)};this.u_c=new Map;ab.fa.qF(this.bZ);this.da=Na.f(ab);this.$=ab}Rdg(ab){this.u_c.set(this.$.fa.Cw,ab);this.Pzh()}O$g(ab){if(void 0!==this.i3a&&this.u_c.has(this.i3a)){const Ua=this.u_c.get(this.i3a);this.AGj(Ua,this.i3a,ab);this.u_c.delete(this.i3a)}else this.zGj(this.i3a);this.Kqk()}AGj(ab,Ua,hd){E.ULS.sendTraceTag(507623310,
1,20,`VirtualGetRangeTelemetryManager.logPrefetchResult. PrefetchResult is ${hd} for the operation with the details OpName ${ab} and stateId ${Ua}`)}zGj(ab){E.ULS.sendTraceTag(507623309,1,20,`VirtualGetRangeTelemetryManager.logPrefetchErrorForStateId. currentStateID ${ab} is not present in StateIdToOperationData`)}Pzh(){this.da.wo.IGh(this.Tdg);this.da.wo.HGh(this.Sdg)}Kqk(){this.da.wo.ovk(this.Tdg);this.da.wo.nvk(this.Sdg)}};Vd=Object(w.__decorate)([Object(ea.d)(S.VirtualGetRangeTelemetryManagerService),
Object(w.__param)(0,Object(S.EwaControlService)())],Vd);Object(z.a)(Vd,"VirtualGetRangeTelemetryManager",null,[573]);var xb=a(281);class ub{get name(){return"Common.App.BrowserInfoLogger"}ji(){}init(){uc.JFj()}dispose(){}static main(){xb.a.instance.Qi(new ub)}}Object(z.a)(ub,"BrowserInfoLoggerPackage",null,[11,12]);const Fc=Object(Ba.c)(Ob.a);class xd{constructor(ab){this.V6c=ab}y_f(ab){if(!this.V6c)return!0;ab=Hc.a.$Ld(ab);if(!ab)return!1;ab=ab.toLowerCase();for(let Ua=0;Ua<this.V6c.length;Ua++)if(ab.endsWith(this.V6c[Ua]))return!0;
return!1}}Object(z.a)(xd,"DomainAllowListManager",null,[]);class Ic{constructor(ab,Ua){this.Z0=null;this.Zkd=ab;this.url=Ua}get OAe(){return Hc.a.wZ(this.url)}get Cu(){return this.Zkd}pxe(){const ab={},Ua=this.Cu;ab.a=this.OAe;ab.b=this.round(Ua.navigationStart);ab.c=this.round(Ua.unloadEventStart);ab.d=this.round(Ua.unloadEventEnd);ab.e=this.round(Ua.redirectStart);ab.f=this.round(Ua.redirectEnd);ab.g=this.round(Ua.fetchStart);ab.h=this.round(Ua.domainLookupStart);ab.i=this.round(Ua.domainLookupEnd);
ab.j=this.round(Ua.connectStart);ab.k=this.round(Ua.connectEnd);ab.l=void 0!==Ua.secureConnectionStart&&null!==Ua.secureConnectionStart?this.round(Ua.secureConnectionStart):0;ab.m=this.round(Ua.requestStart);ab.n=this.round(Ua.responseStart);ab.o=this.round(Ua.responseEnd);ab.q=this.round(Ua.domInteractive);ab.r=this.round(Ua.domContentLoadedEventStart);ab.s=this.round(Ua.domContentLoadedEventEnd);ab.t=this.round(Ua.domComplete);ab.u=this.round(Ua.loadEventStart);ab.v=this.round(Ua.loadEventEnd);
ab.w=this.Z0;return ab}round(ab){return Math.round(1E3*ab)/1E3}}Object(z.a)(Ic,"PerformanceTimingEntry",null,[]);const bd=(ab,Ua)=>{var hd,qe;const Ae={};let ef=null;switch(ab){case 0:ef="ResourceTiming";ab=Ua.a;null!=ab&&(Ae.Url=ab);ab=Ua.b;null!=ab&&(Ae.InitiatorType=ab);ab=null==Ua.c?null:Ua.c.toString();null!=ab&&(Ae.RedirectStart=ab);ab=null==Ua.d?null:Ua.d.toString();null!=ab&&(Ae.RedirectEnd=ab);ab=null==Ua.e?null:Ua.e.toString();null!=ab&&(Ae.FetchStart=ab);ab=null==Ua.f?null:Ua.f.toString();
null!=ab&&(Ae.DomainLookupStart=ab);ab=null==Ua.g?null:Ua.g.toString();null!=ab&&(Ae.DomainLookupEnd=ab);ab=null==Ua.h?null:Ua.h.toString();null!=ab&&(Ae.ConnectStart=ab);ab=null==Ua.i?null:Ua.i.toString();null!=ab&&(Ae.ConnectEnd=ab);ab=null==Ua.j?null:Ua.j.toString();null!=ab&&(Ae.SecureConnectionStart=ab);ab=null==Ua.k?null:Ua.k.toString();null!=ab&&(Ae.RequestStart=ab);ab=null==Ua.l?null:Ua.l.toString();null!=ab&&(Ae.ResponseStart=ab);ab=null==Ua.m?null:Ua.m.toString();null!=ab&&(Ae.ResponseEnd=
ab);ab=Ua.n;null!=ab&&(Ae.CustomText=ab);ab=null==Ua.o?null:Ua.o.toString();null!=ab&&(Ae.DecodedBodySize=ab);ab=null==Ua.p?null:Ua.p.toString();null!=ab&&(Ae.EncodedBodySize=ab);ab=null==Ua.q?null:Ua.q.toString();null!=ab&&(Ae.TransferSize=ab);Ua=null!==(qe=null===(hd=Ua.r)||void 0===hd?void 0:hd.toString())&&void 0!==qe?qe:null;null!=Ua&&(Ae.responseStatus=Ua);break;case 1:ef="PerformanceTiming",hd=Ua.a,null!=hd&&(Ae.Url=hd),hd=null==Ua.b?null:Ua.b.toString(),null!=hd&&(Ae.NavigationStart=hd),hd=
null==Ua.c?null:Ua.c.toString(),null!=hd&&(Ae.UnloadEventStart=hd),hd=null==Ua.d?null:Ua.d.toString(),null!=hd&&(Ae.UnloadEventEnd=hd),hd=null==Ua.e?null:Ua.e.toString(),null!=hd&&(Ae.RedirectStart=hd),hd=null==Ua.f?null:Ua.f.toString(),null!=hd&&(Ae.RedirectEnd=hd),hd=null==Ua.g?null:Ua.g.toString(),null!=hd&&(Ae.FetchStart=hd),hd=null==Ua.h?null:Ua.h.toString(),null!=hd&&(Ae.DomainLookupStart=hd),hd=null==Ua.i?null:Ua.i.toString(),null!=hd&&(Ae.DomainLookupEnd=hd),hd=null==Ua.j?null:Ua.j.toString(),
null!=hd&&(Ae.ConnectStart=hd),hd=null==Ua.k?null:Ua.k.toString(),null!=hd&&(Ae.ConnectEnd=hd),hd=null==Ua.l?null:Ua.l.toString(),null!=hd&&(Ae.SecureConnectionStart=hd),hd=null==Ua.m?null:Ua.m.toString(),null!=hd&&(Ae.RequestStart=hd),hd=null==Ua.n?null:Ua.n.toString(),null!=hd&&(Ae.ResponseStart=hd),hd=null==Ua.o?null:Ua.o.toString(),null!=hd&&(Ae.ResponseEnd=hd),hd=null==Ua.p?null:Ua.p.toString(),null!=hd&&(Ae.DomLoading=hd),hd=null==Ua.q?null:Ua.q.toString(),null!=hd&&(Ae.DomInteractive=hd),hd=
null==Ua.r?null:Ua.r.toString(),null!=hd&&(Ae.DomContentLoadedEventStart=hd),hd=null==Ua.s?null:Ua.s.toString(),null!=hd&&(Ae.DomContentLoadedEventEnd=hd),hd=null==Ua.t?null:Ua.t.toString(),null!=hd&&(Ae.DomComplete=hd),hd=null==Ua.u?null:Ua.u.toString(),null!=hd&&(Ae.LoadEventStart=hd),hd=null==Ua.v?null:Ua.v.toString(),null!=hd&&(Ae.LoadEventEnd=hd),Ua=Ua.w,null!=Ua&&(Ae.CustomText=Ua)}Ae.Table=ef;return Sys.Serialization.JavaScriptSerializer.serialize(Ae)};var yb=a(54),Oc=a(171);class kd{constructor(ab,
Ua,hd){this.yD=ab;this.NAe=this;this.unh=(void 0===Ua?null:Ua)||(()=>window.location.href);this.c$c=new xd(void 0===hd?null:hd)}run(){if(kd.z0(window.performance))try{const Ae=this.unh();if(kd.hwh.exec(Ae)&&this.c$c.y_f(Ae)){var ab=new Ic(window.performance.timing,Ae);Dd.a.instance.Olk(ab.Cu.fetchStart);Dd.a.instance.Plk(ab.Cu.navigationStart);Dd.a.instance.HYb(yb.a.WEi,"connectStart","requestStart");Dd.a.instance.HYb(yb.a.dFi,"requestStart","responseStart");Dd.a.instance.HYb(yb.a.gFi,"responseStart",
"responseEnd");this.NAe.nE(1,ab.pxe());this.yD.Jk(yb.a.XFa,ab.Cu.fetchStart);this.yD.Jk(yb.a.aFi,ab.Cu.domainLookupStart);this.yD.Jk(yb.a.$Ei,ab.Cu.domainLookupEnd);this.yD.Jk(yb.a.YEi,ab.Cu.connectStart);this.yD.Jk(yb.a.hFi,ab.Cu.secureConnectionStart);this.yD.Jk(yb.a.XEi,ab.Cu.connectEnd);this.yD.Jk(yb.a.eFi,ab.Cu.requestStart);this.yD.Jk(yb.a.zOb,ab.Cu.responseStart);this.yD.Jk(yb.a.bFi,ab.Cu.responseEnd-ab.Cu.responseStart);this.yD.Jk(yb.a.fFi,ab.Cu.responseStart-ab.Cu.requestStart);var Ua=0,
hd=0,qe=0;(()=>{let ef=this.A9k(Ae);({transferSize:Ua,CDd:hd,TAd:qe}=ef);return ef})().returnValue&&(this.yD.Jk(yb.a.iFi,Ua),this.yD.Jk(yb.a.ZEi,qe),this.yD.Jk(yb.a.cFi,hd));this.yD.Jk(yb.a.yOb,ab.Cu.navigationStart)}}catch(Ae){E.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",Ae)}}A9k(ab){let Ua,hd,qe;qe=hd=Ua=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:Ua,CDd:hd,TAd:qe};ab=
window.performance.getEntriesByName(ab,"navigation");if(void 0===ab||null===ab||1!==ab.length)return{returnValue:!1,transferSize:Ua,CDd:hd,TAd:qe};ab=ab[0];var Ae=ab.transferSize;void 0!==Ua&&null!==Ua&&(Ua=Ae);Ae=ab.decodedBodySize;void 0!==Ae&&null!==Ae&&(qe=Ae);ab=ab.encodedBodySize;void 0!==ab&&null!==ab&&(hd=ab);return{returnValue:!0,transferSize:Ua,CDd:hd,TAd:qe}}nE(ab,Ua){E.ULS.sendTraceTag(4551815,306,50,bd(ab,Ua))}static get instance(){return kd.Wa||(kd.Wa=new kd(Oc.a.instance,null,sa.AFrameworkApplication.ea.ka("PerfTimingLoggerFilterDomainsIsEnabled")?
sa.AFrameworkApplication.ea.Yk("ResourceLoggerDomainAllowList"):null))}static z0(ab){return!(void 0===ab||null===ab)&&!(void 0===ab.timing||null===ab.timing)}}kd.Wa=null;kd.hwh=RegExp("^https?://.*","i");Object(z.a)(kd,"PerformanceTimingLogger",null,[610]);var Rc=a(154);class Xb{constructor(ab,Ua){this.Z0=null;this.Zkd=ab;this.behavior=Ua;this.url=this.Cu.name}get OAe(){return 2===this.behavior?this.url:Hc.a.wZ(this.url)}get Cu(){return this.Zkd}pxe(){const ab={},Ua=this.Cu;ab.a=this.OAe;ab.b=Ua.initiatorType;
ab.c=this.round(Ua.redirectStart);ab.d=this.round(Ua.redirectEnd);ab.e=this.round(Ua.fetchStart);ab.f=this.round(Ua.domainLookupStart);ab.g=this.round(Ua.domainLookupEnd);ab.h=this.round(Ua.connectStart);ab.i=this.round(Ua.connectEnd);ab.j=void 0!==Ua.secureConnectionStart&&null!==Ua.secureConnectionStart?this.round(Ua.secureConnectionStart):0;ab.k=this.round(Ua.requestStart);ab.l=this.round(Ua.responseStart);ab.m=this.round(Ua.responseEnd);ab.o=this.round(Xb.Jta(Ua,"decodedBodySize"));ab.p=this.round(Xb.Jta(Ua,
"encodedBodySize"));ab.q=this.round(Xb.Jta(Ua,"transferSize"));ab.n=this.Z0;ab.r=Xb.Jta(Ua,"responseStatus")||0;return ab}round(ab){return Math.round(1E3*ab)/1E3}static Jta(ab,Ua){return ab[Ua]}}Object(z.a)(Xb,"ResourceTimingEntry",null,[629]);var dc=a(202),Vc=a(90);class yd{constructor(ab,Ua,hd){this.ZYe=!1;this.lHe=ab;this.Ric=void 0===Ua?null:Ua;this.eAa={};this.Zjh=void 0===hd?100:hd;this.ZGe=sa.AFrameworkApplication&&sa.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableAdvancedNetworkLogging",
!1)}T8k(ab){var Ua=ab.name.toLowerCase();const hd=Hc.a.Kca(Ua);this.LKg(hd,Ua)&&(hd in this.eAa?E.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",hd):(Ua={},Ua.starttime=ab.startTime,Ua.workerstart=ab.workerStart,Ua.redirectstart=ab.redirectStart,Ua.redirectend=ab.redirectEnd,Ua.fetchstart=ab.fetchStart,Ua.domainlookupstart=ab.domainLookupStart,Ua.domainlookupend=ab.domainLookupEnd,Ua.connectstart=ab.connectStart,Ua.secureconnectionstart=ab.secureConnectionStart,
Ua.connectend=ab.connectEnd,Ua.requeststart=ab.requestStart,Ua.responsestart=ab.responseStart,Ua.responseend=ab.responseEnd,Ua.iscached=this.K5f(ab),Ua.nexthopprotocol=ab.nextHopProtocol,Ua.encodedsize=Xb.Jta(ab,"encodedBodySize"),Ua.decodedsize=Xb.Jta(ab,"decodedBodySize"),this.eAa[hd]=Ua))}U8k(ab){var Ua=ab.name.toLowerCase();const hd=Hc.a.Kca(Ua);this.Czk(hd,Ua)&&(hd in this.eAa?E.ULS.sendTraceTag(508925201,306,50,"AppStaticResourceManager: file downloaded multiple times for filename: {0}",hd):
(Ua={},Ua.starttime=ab.startTime,Ua.workerstart=ab.workerStart,Ua.redirectstart=ab.redirectStart,Ua.redirectend=ab.redirectEnd,Ua.fetchstart=ab.fetchStart,Ua.domainlookupstart=ab.domainLookupStart,Ua.domainlookupend=ab.domainLookupEnd,Ua.connectstart=ab.connectStart,Ua.secureconnectionstart=ab.secureConnectionStart,Ua.connectend=ab.connectEnd,Ua.requeststart=ab.requestStart,Ua.responsestart=ab.responseStart,Ua.responseend=ab.responseEnd,Ua.iscached=this.K5f(ab),Ua.nexthopprotocol=ab.nextHopProtocol,
Ua.encodedsize=Xb.Jta(ab,"encodedBodySize"),Ua.decodedsize=Xb.Jta(ab,"decodedBodySize"),Ua.it=ab.initiatorType,Ua.ress=ab.responseStart,Ua.cs=ab.connectStart,Ua.ce=ab.connectEnd,Ua.dls=ab.domainLookupStart,Ua.dle=ab.domainLookupEnd,Ua.rs=ab.redirectStart,Ua.re=ab.redirectEnd,Ua.reqs=ab.requestStart,Ua.scs=ab.secureConnectionStart,this.eAa[hd]=Ua))}LKg(ab,Ua){if(this.lHe)return Array.contains(this.lHe,ab);if(this.Ric)for(ab=Hc.a.tQ(Ua),Ua=0;Ua<this.Ric.length;Ua++)if(this.Ric[Ua]&&ab.endsWith(this.Ric[Ua]))return!0;
return!1}Czk(ab,Ua){return this.LKg(ab,Ua)?ab.endsWith(".js")||ab.endsWith(".css"):!1}K5f(ab){try{const Ua=Xb.Jta(ab,"transferSize");if(void 0!==Ua&&null!==Ua)return!Ua;E.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return ab.responseEnd-ab.fetchStart<this.Zjh}catch(Ua){E.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",Ua.message)}return!1}tmk(){if(Vc.a.Zg(this.eAa))E.ULS.sendTraceTag(575931855,
306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else if(sa.AFrameworkApplication.ea.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.StaticResourceMetricsForKpiLogOnlyOnce",!1)&&this.ZYe)E.ULS.sendTraceTag(507581086,306,15,"Static Resource Metrics already logged in KPI");else{var ab=sa.AFrameworkApplication.flightId?sa.AFrameworkApplication.flightId.split(";"):[],Ua=Object.assign({},{extendedProperties:dc.a.ip()});Ua.extendedProperties.set("Flights",X.c(ab));this.SFj(Ua,
this.eAa,ld.Health.instance);this.ZYe=!0}}JJd(ab){var Ua,hd;let qe=0,Ae=0,ef=0,Tf=0,Nf=0;const wg=this.eAa;for(const Kg in wg){var Uf=Kg,lg=wg[Kg];Uf.endsWith(".js")&&(lg=Object(Rc.a)(Object,lg),lg.responseend<ab&&(qe+=1,Ae+=lg.decodedsize,Tf+=lg.encodedsize,ef+=lg.iscached?0:lg.encodedsize,Uf=Uf.toLowerCase(),this.ZGe&&((null===(hd=null===(Ua=sa.AFrameworkApplication.ea)||void 0===Ua?void 0:Ua.Qa("Slice1Name"))||void 0===hd?0:hd.toLowerCase().endsWith(Uf))?Nf|=1:Uf.endsWith(".common.js")||Uf.endsWith(".othercommon.js")||
Uf.endsWith(".ext.js")?Nf|=2:Uf.endsWith("common50.min.js")&&(Nf|=4))))}ab={};ab.filesLoaded=qe;ab.decodedBytes=Ae;ab.transferredBytes=ef;ab.encodedBytes=Tf;this.ZGe&&(ab.lazyChunksLoaded=Nf);return ab}SFj(ab,Ua,hd){if(Ua){var qe=0,Ae=0,ef=0,Tf=0,Nf=0,wg=0,Uf=0,lg=0,Kg=0,If=0,hg=0;for(const mc in Ua){var gh=Ua[mc];try{const sd=Object(Rc.a)(Object,gh);if(!sd)continue;const ie=sd.iscached?Boolean.parse(sd.iscached.toString()):!1,te=sd.fetchstart?this.parseFloat(sd.fetchstart.toString()):0,Ve=(sd.responseend?
this.parseFloat(sd.responseend.toString()):0)-te,kf=sd.encodedsize?this.parseFloat(sd.encodedsize.toString()):0,Of=sd.decodedsize?this.parseFloat(sd.decodedsize.toString()):0;qe+=Ve;Tf+=kf;Uf+=Of;If++;ie?(ef+=Ve,wg+=kf,Kg+=Of,hg++):(Ae+=Ve,Nf+=kf,lg+=Of)}catch(sd){E.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",sd.message)}}ab.extendedProperties.set("StaticResources",X.c(Ua));ab.extendedProperties.set("TotalResourceDownloadLatency",qe.toString());
ab.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",Ae.toString());ab.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",ef.toString());ab.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",Tf.toString());ab.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Nf.toString());ab.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",wg.toString());ab.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Uf.toString());ab.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",
lg.toString());ab.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",Kg.toString());ab.extendedProperties.set("TotalNumberOfResourcesDownloaded",If.toString());ab.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",hg.toString());hd.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);hd.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",ab)}}parseFloat(ab){if(!ab)return 0;ab=parseFloat(ab);return isNaN(ab)?0:ab}}Object(z.a)(yd,
"AppStaticResourceManager",null,[]);class Pd extends Sys.EventArgs{constructor(ab){super();this.entries=ab}}Object(z.a)(Pd,"EntriesAvailableEventArgs",Sys.EventArgs,[]);var re=a(125);class ue{constructor(ab,Ua,hd,qe,Ae,ef){hd=void 0===hd?null:hd;qe=void 0===qe?null:qe;Ae=void 0===Ae?100:Ae;ef=void 0===ef?!1:ef;this.zdd=!1;this.Ik=null;this.lzb=0;this.xb=new Ma.a;this.AOa=null;this.fF=!1;this.b_e=0;this.Ve=ab;this.jKe=0;this.NAe=this;this.c$c=new xd(hd);this.mz=Ua;qe&&(this.AOa=new yd(null,qe,Ae));
this.Fih=ef}get haf(){try{return!(void 0===this.mz||null===this.mz)&&!(void 0===this.mz.getEntriesByType||null===this.mz.getEntriesByType)}catch(ab){return E.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",ab),!1}}get udi(){return this.jKe}get isActive(){return this.fF}get fxe(){return this.b_e}HDh(ab){this.xb.addHandler(ue.bEd,ab)}Fsk(ab){this.xb.removeHandler(ue.bEd,ab)}ji(ab,Ua){const hd=this.fxe!==ab;this.b_e=ab;this.isActive&&
this.Ve&&hd&&(this.Xr(),this.Ag());this.jKe=Ua}activate(){!this.isActive&&this.haf&&(this.Ag(),this.fF=!0)}deactivate(ab){this.isActive&&(this.Xr(),ab&&this.flush(),this.fF=!1)}flush(){if(this.isActive&&this.haf)try{var ab=window.performance.getEntriesByType("resource");0<ab.length-this.lzb&&E.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",ab.length-this.lzb);const Ua=!(void 0===window.performance.clearResourceTimings||
null===window.performance.clearResourceTimings);Ua&&(window.performance.clearResourceTimings(),this.lzb=0);const hd=[];for(let qe=this.lzb;qe<ab.length;qe++)this.c$c.y_f(ab[qe].name)&&(this.AOa&&(this.Fih?this.AOa.U8k(ab[qe]):this.AOa.T8k(ab[qe])),hd.push(new Xb(ab[qe],this.udi)));Ua||(this.lzb=ab.length);this.xb.raiseEvent(ue.bEd,new Pd(hd));for(ab=0;ab<hd.length;ab++)0!==hd[ab].behavior&&2!==hd[ab].behavior||this.NAe.nE(0,hd[ab].pxe());0<hd.length&&E.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",
hd.length)}catch(Ua){E.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",Ua)}}nE(ab,Ua){E.ULS.sendTraceTag(4310804,306,50,bd(ab,Ua))}Nlk(){this.AOa.tmk()}JJd(ab){return this.AOa.JJd(ab)}Ag(){this.Ve&&0<this.fxe&&(this.Ik=new re.a(3,2,1E3*this.fxe,()=>{this.flush()},5),this.Ve.Ag(this.Ik),this.zdd=!0)}Xr(){this.zdd&&(this.Ve.Xr(this.Ik),this.Ik=null,this.zdd=!1)}}ue.bEd="EntriesAvailable";Object(z.a)(ue,"ResourceTimingLogger",null,[590,610]);var He=a(137);class bf{constructor(){this.oc=
null}get name(){return"Common.ResourceTiming"}init(){Object(Ba.a)(Fc);kd.instance.run()}dispose(){}ji(ab){this.oc=ab;let Ua=null;if(sa.AFrameworkApplication.ea.ka("ResourceLoggerFilterDomainsIsEnabled"))try{Ua=sa.AFrameworkApplication.ea.Yk("ResourceLoggerDomainAllowList")}catch(ef){E.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const hd=[];hd.push(Hc.a.tQ(He.a.MO).toLowerCase());hd.push(Hc.a.tQ(He.a.mub).toLowerCase());const qe=sa.AFrameworkApplication.ea.Rd("AppStaticResourceMonitorCacheThresholdInMs",
100),Ae=sa.AFrameworkApplication.ea.ka("PPTAggregateResourceTimingV2Enabled");ab.register(590,"Common.NetworkTiming.IResourceTimingLogger").Lc().Qc(()=>new ue(sa.AFrameworkApplication.Rj,window.performance,Ua,hd,qe,Ae))}static main(){xb.a.instance.Qi(new bf)}}Object(z.a)(bf,"ResourceTimingPackage",null,[11,12]);const af=Object(Ba.b)("Common.App.CpuMeter.ICpuMeterMonitor"),Pe=Object(Ba.c)(af),wf=Object(Ba.b)("Common.App.CpuMeter.CpuMeterProvider"),xf=Object(Ba.c)(wf);class Cf extends Sys.EventArgs{constructor(ab,
Ua){super();this.j4k=ab;this.actualValue=Ua}}Object(z.a)(Cf,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);var tf=a(101);class Jf{constructor(){this.Y8a=[];this.JJe=this.t9c=0;this.moa=null;this.xb=new Ma.a;this.d5h=(ab,Ua)=>{tf.a(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.i7h(Ua.j4k,Ua.actualValue))}}init(ab,Ua,hd){this.moa=ab;this.t9c=Ua;this.JJe=hd;this.moa.K4e(Object(Ud.a)(this,this.WVj,"onCpuMeterFrameAvailable"));this.cFh(this.d5h)}WVj(ab,Ua){Ua.$gg&&
(Array.enqueue(this.Y8a,Ua.$gg.CP),this.Y8a.length>this.JJe&&(Array.dequeue(this.Y8a),this.wXh()))}wXh(){var ab=this.Y8a.length;let Ua=0;for(let hd=0;hd<ab;hd++){const qe=Array.dequeue(this.Y8a);Ua+=qe;Array.enqueue(this.Y8a,qe)}ab=Ua/ab;ab>this.t9c&&this.xb.raiseEvent("CPTTE",new Cf(this.t9c,ab))}cFh(ab){this.xb.addHandler("CPTTE",ab)}i7h(ab,Ua){const hd={};hd.ThresholdValue=ab;hd.ActualValue=Ua;return hd}}Object(z.a)(Jf,"CpuMeterMonitor",null,[649]);var dg=a(182);class uf{constructor(){this.S=this.T=
this.M=this.C=0}}Object(z.a)(uf,"ProfileInformation",null,[]);var lf=a(52),Pf=a(290);class Rf{constructor(ab,Ua){this.Ubd=!1;this.EPa={};this.Tfc=void 0===ab?0:ab;this.bgc=void 0===Ua?0:Ua;this.old=0;lf.a.addHandler(window.self,Ca.a.XHh,()=>{this.Ubd=!0});lf.a.addHandler(window.self,Ca.a.YHh,()=>{this.Ubd=!1})}a6e(ab,Ua,hd){const qe=Rf.generateKey(Ua,hd);qe in this.EPa?Ua=this.EPa[qe]:(Ua=new uf,Ua.S=hd?1:0,this.EPa[qe]=Ua,this.old++);Ua.C++;Ua.M=ab>Ua.M?ab:Ua.M;Ua.T+=ab}Hha(ab,Ua){this.a6e(ab,Ua,
!1);this.Ubd&&this.a6e(ab,Ua,!0)}getData(){if(0<this.bgc&&this.old>this.bgc)return this.QNi();const ab=0<this.Tfc,Ua={},hd=this.EPa;for(const Ae in hd){var qe=Ae;const ef=hd[Ae];this.VLg(ef);ab&&ef.T>=this.Tfc&&(Ua[qe]=ef)}return ab?Vc.a.Zg(Ua)?null:Ua:this.EPa}QNi(){var ab=0<this.Tfc,Ua=[];const hd=this.EPa;for(const qe in hd){const Ae={key:qe,value:hd[qe]},ef=Ae.value;(!ab||ef.T>=this.Tfc)&&Array.add(Ua,Ae)}if(Ua.length>this.bgc)Ua.sort((qe,Ae)=>Ae.value.T-qe.value.T),Ua=Ua.slice(0,this.bgc);else if(!Ua.length)return null;
ab={};for(const qe of Ua)Ua=qe.value,this.VLg(Ua),ab[qe.key]=Ua;return ab}VLg(ab){ab.M=Pf.a.Vea(ab.M,0);ab.T=Pf.a.Vea(ab.T,0)}reset(){this.EPa={};this.old=0}static generateKey(ab,Ua){return Ua?ab+" [it]":ab}}Object(z.a)(Rf,"FunctionCallAggregator",null,[615]);class Mf{}Mf.DNh="BatchedOperation";Mf.twk="Replication";Mf.l$k="25";Mf.uwk="9_"+Mf.DNh+"_"+Mf.twk;Object(z.a)(Mf,"CpuMeterConstants",null,[]);class zf{}Object(z.a)(zf,"CpuMeterFrame",null,[]);class df extends Sys.EventArgs{constructor(ab){super();
this.$gg=ab}}Object(z.a)(df,"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);class Bf{}Object(z.a)(Bf,"MiniTaskItemInfo",null,[]);class Kf{}Object(z.a)(Kf,"TaskItemInfo",null,[]);var Vf=a(605),sb=a(113);class Gc{static t5i(){if(!Gc.ybc&&(Gc.ybc=new sb.a,sa.AFrameworkApplication.ea&&sa.AFrameworkApplication.ea.Dj("AggregatorIdDisabledList"))){const ab=sa.AFrameworkApplication.ea.Yk("AggregatorIdDisabledList");for(let Ua=0;Ua<ab.length;Ua++)Gc.ybc.ga(ab[Ua],!0)}return Gc.ybc}}Gc.ybc=null;Object(z.a)(Gc,
"DisabledAggregatorListStore",null,[]);var ad=a(293);class Wd{constructor(ab,Ua,hd,qe,Ae,ef,Tf,Nf){ef=void 0===ef?!0:ef;Tf=void 0===Tf?null:Tf;this.Hmf=Nf;this.t5=this.oZe=this.cQe=!1;this.Ve=null;if(!ab)throw ad.a.argument("taskManagerLazy");if(!Ae)throw ad.a.argument("dataAggregator");this.wvh=ab;this.igd=Ua;this._id=hd;this.qOe=6E4*qe;this.Wcc=Ae;this.wWe=ef;this.oDb=Tf;Gc.t5i().Bb(this._id.toString())&&(this.t5=!0)}get $I(){return this.Ve||(this.Ve=this.wvh.value)}track(ab,Ua){Ua=void 0===Ua?
null:Ua;this.t5||(this.Tni(),this.tDk(),this.Wcc.Hha(ab,Ua))}tDk(){!this.cQe&&0<this.qOe&&(this.cQe=!0,this.LNg())}LNg(){const ab=new re.a(5,1,this.qOe,()=>{this.IFk()},19,this._id.toString());this.$I.Ag(ab)}IFk(){!this.oDb||this.oDb.vQk()?this.VOg():this.wWe&&this.Wcc.reset();this.LNg()}VOg(){const ab=this.Wcc.getData();if(ab){const Ua=parseInt(String(ab.length));if(isNaN(Ua)||0<Ua)this.TWc(ab),this.Hmf&&this.Hmf(ab),this.wWe&&this.Wcc.reset()}}TWc(ab){E.ULS.sendTraceTag(7079840,335,50,"Aggregator: {0}",
{["ID"]:this._id.toString(),["Data"]:ab})}Tni(){this.oZe||(this.igd(()=>{this.VOg()}),this.oZe=!0)}static QT(ab,Ua,hd,qe,Ae,ef){return new Wd(new Vf.a(()=>sa.AFrameworkApplication.Rj),sa.AFrameworkApplication.VMa,ab,Ua,hd,qe,Ae,ef)}static hib(ab,Ua,hd){return Wd.QT(ab,Ua,hd,!0,null,void 0)}}Object(z.a)(Wd,"Aggregator",null,[616]);class je{constructor(ab){ab=void 0===ab?null:ab;this.Zo=null;this.reset();this.oDb=ab}Hha(ab,Ua){if(!this.oDb||this.oDb.vQk())Ua in this.Zo||(this.Zo[Ua]=[]),this.Zo[Ua].push(ab)}getData(){return Vc.a.count(this.Zo)?
this.Zo:null}reset(){this.Zo={}}}Object(z.a)(je,"NamedValuesAggregator",null,[615]);var Ie=a(242);class Je{constructor(ab,Ua,hd,qe,Ae){this.qRa=0;this.yJ=null;this.Whc=this.XYe=0;this.lXe=!1;this.z9a=0;this.fBb=!1;this.JBa=null;this.Mec=0;this.WTe=new Ma.a;this.uvh=[];this.tS=ab;this.$ed=Ua;this.Fad=hd;this.iSe=qe;sa.AFrameworkApplication.ea&&sa.AFrameworkApplication.ea.ka("WrapSetTimeoutForTelemetryIsEnabled")&&this.n0d();this.ymh=Ae;this.Gad=new Rf(100);this.Eqh=Wd.hib(1,5,new je)}K4e(ab){this.WTe.addHandler("OnCpuMeterFrameAvailable",
ab)}mrb(ab,Ua,hd,qe){hd=(qe=void 0===qe?null:qe)?qe.priority:7;const Ae=this.tS();this.start(Ua,hd);try{ab()}finally{this.stop(Ua,qe),ab=this.tS()-Ae,this.iSe.track(ab,Ua)}}G3(ab,Ua){const hd=this.tS();try{ab()}finally{ab=this.tS()-hd,this.Fad.Hha(ab,Ua),0<this.qRa&&this.Gad.Hha(ab,Ua),this.iSe.track(ab,Ua)}}vae(ab){const Ua=new Kf;Ua.TN=ab.TKc;Ua.TP=ab.priority;this.jCg(1,Ua)}bob(ab){this.Mec|=ab}start(ab,Ua){if(!this.qRa){this.Gad.reset();const hd=this.d6f(ab);hd&&this.Z4d(1);this.yJ=new Kf;this.yJ.TN=
ab;this.yJ.TP=Ua;this.yJ.ST=(new Date).toISOString();this.yJ.STS=Pf.a.Vea(this.tS(),2);hd?this.yJ.UI=1:this.ttj(ab)?this.yJ.UI=2:this.yJ.UI=0}this.qRa++}Z4d(ab){this.z9a|=ab}zvd(ab,Ua){this.z9a=void 0===ab||ab?0:this.z9a&~(void 0===Ua?0:Ua)}stop(ab,Ua){Ua=void 0===Ua?null:Ua;let hd;this.qRa--;0>=this.qRa&&this.yJ&&(hd=this.tS()-this.yJ.STS,this.Whc+=hd,this.$ed.Hha(hd,ab),this.d6f(ab)&&this.zvd(!1,1),this.yJ.TRT=Pf.a.Vea(hd,2),Ua&&(this.yJ.TQT=Pf.a.Vea(Ua.dik,2),this.yJ.TDT=Pf.a.Vea(Ua.K7f,2)),this.ymh&&
(this.jCg(0,this.yJ),this.cxk()),this.qRa=0);0<=ab.indexOf(Mf.l$k)&&this.bob(2);0<=ab.indexOf(Mf.uwk)&&this.bob(4);1===(this.z9a&1)&&this.bob(1);2===(this.z9a&2)&&this.bob(8)}cxk(){var ab=this.yJ.TRT;if(750<ab){let hd=this.Gad.getData();if(hd){const qe={};for(const Ae in hd){var Ua=hd[Ae];const ef=Ae;ef.startsWith("SiOp_")||ef.endsWith("[it]")||(qe[ef]=Math.round(100*Ua.T/ab))}hd=qe}ab=Object.assign(new Bf,{B:this.yJ.STS,T:ab,S:hd});this.Eqh.track(ab,this.yJ.TN)}}xZk(){var ab=this.tS()-this.XYe,Ua=
Pf.a.Vea(this.Whc/ab*100,2);ab=new zf;ab.CP=Ua;ab.II=this.Mec;Ua=this.$ed.getData();Vc.a.count(Ua)&&(ab.LRT=Ua);Ua=this.Fad.getData();Vc.a.count(Ua)&&(ab.FP=Ua);this.WTe.raiseEvent("OnCpuMeterFrameAvailable",new df(ab));this.sZg()}sZg(){this.$ed.reset();this.Fad.reset();this.Whc=this.qRa=0;this.XYe=this.tS();this.Mec=0;this.yJ=null}run(){this.lXe?this.xZk():(this.sZg(),this.lXe=!0);this.JBa?this.JBa(Object(Ud.a)(this,this.run,"run"),1E3):window.setTimeout(Object(Ud.a)(this,this.run,"run"),1E3)}jCg(ab,
Ua){ab=this.uvh[ab];if(!Ie.a.Zg(ab))for(let qe=0;qe<ab.length;qe++){var hd=ab[qe];const Ae=hd[0];hd=hd[1];Ae&&!Ae(Ua)||hd(Ua)}}n0d(){if(!this.fBb){const ab=window.setTimeout;this.JBa=(Ua,hd)=>ab(Ua,hd);this.fBb=!0}}d6f(ab){return ab.startsWith("key")||ab.startsWith("input")}ttj(ab){return ab.startsWith("click")||ab.startsWith("mouse")||ab.startsWith("pointer")}}Object(z.a)(Je,"CpuMeter",null,[108]);class $e{constructor(ab){this.jzb=null;this.Wm=new dg.a;this.tS=ab}initialize(ab,Ua,hd,qe){this.jzb||
(this.jzb=new Je(this.tS,ab,Ua,hd,void 0===qe?!1:qe),this.Wm.setResult(this.jzb));return this.jzb}}Object(z.a)($e,"CpuMeterProvider",null,[648]);class Ib{constructor(ab){this.zA=[];this.ddc=[];this._count=void 0===ab?1:ab}uBi(){let ab=0;for(let Ua=0;Ua<this.zA.length;Ua++)this.zA[Ua]<this.zA[ab]&&(ab=Ua);return ab}Hha(ab,Ua){ab=Pf.a.Vea(ab,2);if(this.zA.length<this._count)Array.add(this.zA,ab),Array.add(this.ddc,Ua);else{var hd=this.uBi();ab>this.zA[hd]&&(this.zA[hd]=ab,this.ddc[hd]=Ua)}}getData(){return this.zA.length?
{["Vals"]:this.zA,["Desc"]:this.ddc}:null}reset(){this.zA=[];this.ddc=[]}}Object(z.a)(Ib,"MaxDataAggregator",null,[615]);var Nb=a(55);class Bc{get name(){return"Common.App.CpuMeter"}ji(ab){ab.register($e,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").Lc().Qc(()=>new $e(Nb.a.Td));ab.register(Jf,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").Lc().Qc(()=>new Jf)}init(){const ab=sa.AFrameworkApplication.ea;if(ab.ka("CpuMeterIsEnabled")){const Ua=
Object(Ba.a)(xf);Dd.a.instance.h7e.continueWith(()=>{Bc.dhj(ab,Ua)})}}dispose(){}static dhj(ab,Ua){const hd=Wd.hib(10,5,new Rf(ab.Rd("TaskManagerLoggingThreshold",0),ab.Rd("CpuMeterMaximumEntriesToLog",0)));Ua=Ua.initialize(new Ib(5),new Rf,hd,ab.ka("CPUMeterExposeTaskDetailsIsEnabled"));ab.ka("WordEditorInteractivePerfDisableCpuMeterFrames")||(Ua.run(),ab.ka("CpuMeterMonitorIsEnabled")&&Object(Ba.a)(Pe).init(Ua,ab.Cca("CpuMeterAverageCpuPercentThreshold",80),ab.Rd("CpuMeterRollingAverageFramesCount",
15)));tf.a(16827671,306,50,"Initializing CpuMeter")}static main(){xb.a.instance.Qi(new Bc)}}Object(z.a)(Bc,"CpuMeterPackage",null,[11,12]);var Af=a(1198);class gf{get name(){return"Common.App.EventsCachePackage"}ji(){}init(){Af.a.instance.init()}dispose(){}static main(){xb.a.instance.Qi(new gf)}}Object(z.a)(gf,"EventsCachePackage",null,[11,12]);var Qe=a(9),Aa=a(430);class Fb extends Aa.a{constructor(ab){super();this.nhf=!1;this.$=ab;this.ri()}create(){const ab=this.$.ra,Ua=mb.a.instance;if(!this.nhf){this.nhf=
!0;let hd;hd=I.EwaSettings.isChangeGateEnabled("OfficeVSO:5135167_PostMessageOriginFixup")?this.$.ta.DocumentHostInfo.PostMessageOrigin||pa.a.sH:sa.AFrameworkApplication.t1b||pa.a.sH;Ua.register(Ga,"Microsoft.Office.Excel.WebUI.Client.PostMessage.EwaHostMessenger").as("Postmessage.IHostPostmessenger").Lc().Qc(()=>new Ga(this.$,window.parent,hd,sa.AFrameworkApplication.ea.ka("HostSendReadyToAcceptPostMessage")))}this.Uf(ab.Tb(21)||ab.zc(21,Object(Ba.a)(Ka.a)))}}Object(z.a)(Fb,"HostMessengerFactory",
Aa.a,[]);var Ta=a(126),Eb=a(178),oc=a(874),Lc=a(661),Jd=a(93),Ab=a(186),Uc=a(375),Od=a(374),le=a(509),ge=a(59),ze=a(70);class Le{constructor(ab,Ua,hd){this.correlations=this.properties=this.operation=null;this.operation=ab;this.properties=Ua;this.correlations=hd}static Vyi(ab,Ua,hd){const qe={},Ae=ge.telemetryManager();switch(ab.command){case -1537138325:qe.Action=Ua.LabelText;break;case -1104934572:I.EwaSettings.Og()?(qe.PrevTab=ge.resolveRibbonCommandName(parseInt(Ua.OldContextCommand,10)),qe.NextTab=
ge.resolveRibbonCommandName(parseInt(Ua.NewContextCommand,10))):(qe.PrevTab=Ae.zma(parseInt(Ua.OldContextCommand,10)),qe.NextTab=Ae.zma(parseInt(Ua.NewContextCommand,10)));break;case 802602464:qe.Origin=Ua[Db.a.MF];break;case -1027730316:case -1059615499:qe.MenuType=Ua.launcherId;break;case -236759591:case 1650812936:case 1970784898:case 1378078823:case -400966242:case 467002767:"SqmControlId"in Ua&&(qe.SqmControlId=Ua.SqmControlId);break;case 1371713064:case 875133075:ze.a.Wc in Ua&&(qe.SampleTableId=
Ua[ze.a.Wc])}qe.InputMethod=Uc.a[ab.method];qe.Location=Od.a[ab.Re];qe.Mode=le.a[ab.mode];qe.ParentName=ab.tabName;qe.IsSystemInitiated="IsSystemInitiated"in Ua?Ua.IsSystemInitiated:!1;qe.NoReporting="NoReporting"in Ua?Ua.NoReporting:!1;"ControlIdToLog"in Ua&&(qe.ControlId=Ua.ControlIdToLog);"TerminalParentControlIdToLog"in Ua&&(qe.TerminalParentControlId=Ua.TerminalParentControlIdToLog);for(const ef of Object.keys(hd))qe[ef]=hd[ef];return qe}}Object(z.a)(Le,"InteractivityRecord",null,[]);class nf extends Le{constructor(ab,
Ua,hd){super(ab.operation,ab.properties,ab.correlations);this.timeFromNavigationStart=this.timeFromAppInteractive=0;this.timeFromAppInteractive=Ua;this.timeFromNavigationStart=hd}}Object(z.a)(nf,"FirstUserInteractivityRecord",Le,[]);var cf=a(790);class Te{constructor(){this.commandSurface=this.triggerMethod=Ta.a.ywb}static vhj(){Te.vhb||(Te.vhb=new cf.a(Lc.a.Ef()),Te.vhb.add("InputMethod"),Te.vhb.add("Location"),Te.vhb.add("Mode"))}}Te.vhb=null;Object(z.a)(Te,"ExcelUserAction",null,[]);var Wf=a(243),
Hf=a(507),ib=a(116),xc=a(114),Kc=a(109);class ra extends Jd.a{constructor(ab){super();this.IXf=0;this.jCf=!1;this.Y0d=Array(ra.gob);this.tsc=0;this.$=ab;this.z5f=I.EwaSettings.isChangeGateEnabled("OfficeVSO:3683664_AddTelemetryForNonCommandActions");Ta.a.mXi();this.mka={};ra.Xjc||(ra.Xjc=new oc.a(Lc.a.Ef()),ra.zgj(ra.Xjc));Te.vhj();if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback"))for(ab=0;ab<ra.gob;ab++)this.Y0d[ab]="NA"}dispose(){this.$=this.mka=null;super.dispose()}LIg(ab,
Ua,hd){const qe=ge.resolveRibbonCommandName(ab.command),Ae=JSON.stringify(ab);qe||E.ULS.sendTraceTag(537155555,3,50,`InteractivityLogger.ReportCommand: command name is null or empty. commandName: ${qe}, command: ${ab.command}, commandInfo: ${Ae}`);Ua=Le.Vyi(ab,Ua,hd);hd=!!Ua&&(!("IsSystemInitiated"in Ua)||!Ua.IsSystemInitiated);this.$&&this.$.fa.io&&hd&&Af.a.instance.FDg("OtelUserAction",new Hf.a(qe,ab.tabName,Date.now()));this.WIg(qe,Ua,null,!0,!0)}Jd(ab,Ua,hd,qe){this.WIg(ab,Ua,void 0===hd?null:
hd,!1,void 0===qe?!1:qe)}vZg(ab){if(this.mka){++this.IXf;this.mka[ab]||(this.mka[ab]=[]);var Ua=this.IXf.toString();this.mka[ab].push(Ua);E.ULS.sendTraceTag(537155553,0,50,`StartInteractivityCorrellation - '${ab}', correlation=${Ua}`)}else E.ULS.shipAssertTag(537155554,0,!1,`StartInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${ab}] == null`)}d_g(ab){if(this.mka&&this.mka[ab]){var Ua=this.mka[ab],hd=Ua.pop().toString();Ua.length||delete this.mka[ab];E.ULS.sendTraceTag(537155551,
0,50,`StopInteractivityCorrellation - '${ab}', correlation=${hd}`)}else E.ULS.shipAssertTag(537155552,0,!1,`StopInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${ab}] == null`)}tX(ab,Ua,hd){hd=void 0===hd?!1:hd;return Ab.c(qe=>{this.Jd(ab,qe(),void 0,hd)},ra.l4k,this.Aa,na.a.Bkj,!1,!Ua)}Qje(){let ab="";for(let Ua=0;Ua<ra.gob;Ua++)ab+=this.Y0d[(this.tsc+ra.gob-Ua-1)%ra.gob]+",";E.ULS.sendTraceTag(557188890,0,15,`Last operations ${ab}`)}Jdl(ab){ab&&(this.Y0d[this.tsc]=
ab,this.tsc=(this.tsc+1)%ra.gob)}OFj(ab,Ua,hd){sa.AFrameworkApplication.dvc();const qe=ab.operation,Ae=ab.properties;void 0!==hd?void ea.a.resolve(S.PageLoadEngagementInfoService,{xa:0}).then(ef=>{ef.vmk(qe,Ae,hd)}):this.v$k(ab);this.w$k(ab);this.Y8j(Ua,Ae,qe)}v$k(ab){this.CYk(ab)||(this.jCf=!0,ab=new nf(ab,kb.a.instance.Dja(),Object(Kc.b)()),ab=Sys.Serialization.JavaScriptSerializer.serialize(ab),E.ULS.sendTraceTag(458261331,0,50,`${ab}`))}CYk(ab){const Ua=ab.properties;ab=ab.operation;return this.jCf||
void 0===ab||null===ab||ab===Sb.a.Mmd||ab===Sb.a.Hne||ab===Sb.a.Ide||xa.a.DYd(ab)||!!Ua&&"IsSystemInitiated"in Ua&&Ua.IsSystemInitiated}w$k(ab){I.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback")&&this.Jdl(ab.operation);ab=Sys.Serialization.JavaScriptSerializer.serialize(ab);E.ULS.sendTraceTag(21542793,0,50,`${ab}`)}Y8j(ab,Ua,hd){Ta.a.wva()&&(Ua?"NoReporting"in Ua&&Ua.NoReporting||"IsSystemInitiated"in Ua&&Ua.IsSystemInitiated||!ab&&!this.z5f||((ab=Ta.a.Eh(Ua,ra.Xjc,
Te.vhb))?(Ua=ra.dzi(Ua))?Eb.a.sendUserActionEvent(Ta.a.Yrc(hd,null,Ua.triggerMethod,Ua.commandSurface,ab)):E.ULS.sendTraceTag(537155550,0,50,"user action was null"):E.ULS.sendTraceTag(537155549,0,15,"OtelUtils.DictionaryToDataFields returned null")):E.ULS.sendTraceTag(537155548,0,50,`Not logging action telemetry because adction data was null, actionName: ${hd}`))}WIg(ab,Ua,hd,qe,Ae){const ef=Wf.a(this.$);if(this.z5f){let Nf=null;Z.a.equals(ab,Sb.a.IWc,!0)&&Ua&&"InputMethod"in Ua&&(Nf=Sb.a.uDf(ab,
Ua.InputMethod));ef.d4b(Nf||ab,hd)}else Z.a.equals(ab,Sb.a.IWc,!0)&&Ua&&"InputMethod"in Ua&&(ab=Sb.a.uDf(ab,Ua.InputMethod)),ef.d4b(ab,hd);Ua&&(Ua.IsCommand=qe);const Tf="ActionRelativeTime"in Ua?Ua.ActionRelativeTime:Object(Kc.b)();Object(xc.f)(()=>{const Nf=new Le(ab,Ua,this.mka);this.OFj(Nf,Ae,Tf)},this.$.Aa,50)}static dzi(ab){if(!ab)return null;const Ua=new Te;"InputMethod"in ab&&(Ua.triggerMethod=ab.InputMethod);"Location"in ab&&(Ua.commandSurface=ab.Location);return Ua}static zgj(ab){ab?(ab.add("Origin",
ib.g.String),ab.add("InputMethod",ib.g.String),ab.add("ButtonType",ib.g.String),ab.add("selectedRange",ib.g.String),ab.add("SelectedRanges",ib.g.String),ab.add("editRange",ib.g.String),ab.add("Location",ib.g.String),ab.add("Mode",ib.g.String),ab.add("CurrentSelectionMode",ib.g.String),ab.add("Action",ib.g.String),ab.add("type",ib.g.String),ab.add("floatingObjectType",ib.g.String),ab.add("PrevTab",ib.g.String),ab.add("NextTab",ib.g.String),ab.add("DialogName",ib.g.String),ab.add("dx",ib.g.Int64),ab.add("dy",
ib.g.Int64),ab.add("NumberOfSelectedRanges",ib.g.Int64),ab.add("IsCommand",ib.g.Boolean),ab.add("IsInFormulaBarEdit",ib.g.Boolean),ab.add("isLink",ib.g.Boolean),ab.add("isSheetRef",ib.g.Boolean),ab.add("isEmptyText",ib.g.Boolean),ab.add("isFormula",ib.g.Boolean),ab.add("IsResizingHiddenHeader",ib.g.Boolean)):E.ULS.sendTraceTag(537155547,0,15,"InitTypeSpecifier was passed in a null dictionary")}}ra.l4k=1E3;ra.gob=40;ra.Xjc=null;Object(z.a)(ra,"InteractivityLogger",Jd.a,[19]);var jb=a(81),vc=a(144),
md=a(604),Qd=a(86),v=a(310),Qb=a(43),Dc=a(42),id=a(264);class Md extends Sys.EventArgs{constructor(ab){super();this.sK=ab}}Object(z.a)(Md,"ErrorDataArgs",Sys.EventArgs,[]);class Sd{constructor(ab,Ua){this.tcc=null;this.Nsc=this.gSd=!1;this.wXe=this.xXe=null;this.$jb=this.Yjb=0;this.XNg=ab;this.EUe=Ua}get Mvg(){return this.EUe}get ntb(){return this.xXe}get WNg(){return this.wXe}get Vzj(){return this.Jbf(this.XNg.getTime())}get b$j(){return this.Jbf(this.WNg.getTime())}get NUg(){return!(this.Nsc||void 0===
window.bsqmXLSPageLoadStartTime)}get Yvd(){try{return this.tcc||(this.tcc=ba.toUtc(window.bsqmXLSPageLoadStartTime)),this.tcc}catch(ab){return null}}set Yvd(ab){this.tcc=ab}BMk(ab){this.Nsc||(this.xXe=ab,this.wXe=ba.toUtc(this.ntb))}gdj(ab){if(ab.Values&&(!this.Yjb||!this.$jb))try{"Click"in ab.Values&&(this.Yjb=parseInt(ab.Values.Click.toString(),10));"Iframe"in ab.Values&&(this.$jb=parseInt(ab.Values.Iframe.toString(),10));const Ua=Dd.a.instance;0<this.Yjb&&(this.oag(this.Yjb,"PageLoadFromHostClick"),
Ua.xmk(this.Yjb));0<this.$jb&&(this.oag(this.$jb,"PageLoadFromHostFrameCreation"),Ua.zmk(this.$jb));const hd=ab.Values.RedirectCount||0,qe=ab.Values.FetchStart||ab.Values.HostFrameFetchStart||0;0<qe&&Ua.$lk(qe);Ua.amk(hd)}catch(Ua){}}Qyk(){this.XNg=this.Yvd=A.a.zb.Jc;this.EUe=0;this.gSd=this.Nsc=!1}Jbf(ab){const Ua=this.Yvd.getTime();return Ua>=ab?0:ab-Ua+this.Mvg}oag(ab,Ua){if(ab)if(I.EwaSettings.Og())void ea.a.resolve(S.TelemetryManagerService).then(hd=>{hd.q6a("UserAction",Ua,Ua,A.a.vLc(ab),fe.EcmaDateClock.instance.appStart);
hd.EVa(Ua,ba.toTimestamp(this.ntb))});else{const hd=ge.telemetryManager();hd.q6a("UserAction",Ua,Ua,A.a.vLc(ab),fe.EcmaDateClock.instance.appStart);hd.EVa(Ua,ba.toTimestamp(this.ntb))}}}Object(z.a)(Sd,"PageLoadPerfInfo",null,[]);var ne=a(71);class Ce{constructor(ab,Ua,hd){this.bkd=ab.keyCode;this.X5b(ab.ctrlKey,1);this.X5b(ab.shiftKey,2);this.X5b(ab.altKey,4);this.X5b(ne.b(ab),8);this.X5b(hd,16);this.bkd=this.fvb|Ua<<24}get fvb(){return this.bkd}get keyCode(){return this.fvb&65535}X5b(ab,Ua){ab&&
(this.bkd=this.fvb|Ua<<16)}}Object(z.a)(Ce,"ShortcutSqmData",null,[]);class Ge{constructor(){this.F3d=null;this.h0h={["0"]:0,["1"]:1,["2"]:2,["4"]:3,["8"]:4,["16"]:5,["32"]:6};this.oKg()}HVh(ab,Ua,hd){0===hd&&(hd=this.h0h[Ua.toString()]);return Ge.shouldLog(ab,hd)&&(ab=new Ce(ab,hd,Da.a.isMac),!Dc.a.rh(this.F3d,ab.fvb.toString()))?(this.F3d[ab.fvb.toString()]=!0,ab):null}oKg(){this.F3d={}}static irj(ab){return 112<=ab&&123>=ab||61440<=ab&&61451>=ab}static Xsj(ab){return 17!==ab&&18!==ab&&16!==ab&&
91!==ab&&93!==ab}static shouldLog(ab,Ua){let hd=ab.ctrlKey||ab.altKey||ne.b(ab);ab=ab.keyCode;hd=Ge.irj(ab)||hd;hd=Ge.Xsj(ab)&&hd;return 0!==Ua&&hd}}Object(z.a)(Ge,"UnhandledShortcutLogger",null,[]);class Ee{constructor(ab){this.vqc=[];this.mJh=null;this.sqmManager=ab}Ckc(ab){this.vqc.push(ab)}I8(ab,Ua,hd){try{if(Ua)Ua.endTime=hd,this.sqmManager.f2e(Ua);else for(let qe=0,Ae=this.vqc.length;qe<Ae;qe++){const ef=this.vqc[qe];ab?(ef.endTime=ef.startTime,ef.ygf=0):ef.endTime=hd;this.sqmManager.f2e(ef)}}catch(qe){}finally{this.vqc.length=
0}}}Object(z.a)(Ee,"UserInteractionPerfInfo",null,[]);var Ue=a(38),We=a(76),ya=a(261);class Cb extends Jd.a{constructor(ab,Ua){super();this.XQd=this.g4b=!1;this.QUg=!0;this.ub=new la.a;this.w9c=!1;this.jd=()=>{const hd=We.a(this.$).Kd.activityState,qe=Dc.a.rh(hd,Ue.a.K1e);Dc.a.rh(hd,Ue.a.REb)||qe||this.upload()};this.$=ab;this.APb=Ua;this.fa=ab.fa;this.$.Sj(this.jd);this.M5g=new Ge;this.D2a=new Sd(xa.a.Fme,ab.ta.PageGenerationMetrics.TimeToCompleteFirstFlush);this.T3c=new Ee(this)}mod(ab){this.ub.addHandler("EREK",
ab)}xie(ab){this.ub.removeHandler("EREK",ab)}get fci(){return this.w9c}get wkj(){return this.$.frame.GY?Fa.a.ykj:Fa.a.xkj}get workbookContext(){return this.$.workbookContext}get A0(){Cb.wyb||(Cb.wyb=this.utf());Cb.Osd||(Cb.Osd=!0,this.PWf());return Cb.wyb}set A0(ab){Cb.wyb=ab;Cb.wyb||(Cb.Osd=!1)}get oba(){return Qd.a(this.$.ta,3)}dispose(){this.fci&&sa.AFrameworkApplication.Qn&&sa.AFrameworkApplication.Qn.disable();this.$&&this.$.ro(this.jd);this.$=this.T3c=this.D2a=this.A0=null;super.dispose()}sRf(ab){this.D2a.gdj(ab);
this.EFj()}yoe(ab){this.setDw(9415,ab)}Ckc(ab){this.T3c.Ckc(ab)}I8(ab,Ua,hd){this.T3c.I8(ab,Ua,hd)}Z2d(ab){if(this.oba){ab=this.$.isEditMode||ab&&!!(this.fa.workbookContext.Options&512);if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:8784630_SupportCollabViewInApplicationModeExtended")){const Ua=this.fa.XHa;ab=ab?2:Ua?20:this.fa.$b.inEmbedView?14:1}else ab=ab?2:this.fa.$b.inEmbedView?14:1;this.setDw(8721,ab);this.ACi(ab);this.w9c=!1}}Eag(){const ab=this.D2a;this.oba&&ab.NUg&&(this.setDw(9450,ab.Mvg),
this.setDw(9085,ab.Vzj))}Fag(ab){if(!this.g4b){this.g4b=!0;const Ua=this.D2a;let hd=0;this.oba&&Ua.NUg?(Ua.BMk(ab),this.T3c.mJh=Ua.WNg,this.setDw(9086,Ua.b$j),Ua.Nsc=!0,hd=this.D2a.ntb.getTime()):hd=ab.getTime();Qb.TaskExtensions.tb(this.APb.value,qe=>{qe.result.sendMessage(hb.a.iJh,{["DocumentLoadedTime"]:hd})},this.Aa,3)}}f2e(ab){this.oba&&ab&&1!==ab.lna&&this.oqa(8327,id.b(ab),id.l(ab),id.a(ab),2,ab.ygf,id.m(ab),id.d(ab),id.e(ab))}Kje(ab,Ua){ab&&ab.MessageIdHash&&this.Jje(ab.MessageIdHash,ab.MessageIdName,
ab.MessageId,ab.ErrorCause?ab.ErrorCause:0,!1,Ua,ab,null)}Jje(ab,Ua,hd,qe,Ae,ef,Tf,Nf){Cb.cqd||(Cb.cqd=!0,vc.a.get_instance().isCompleted(13)||(vc.a.get_instance().Br(13),E.ULS.sendTraceTag(537151323,0,50,"App encountered its first error so updating app init status")));ab=this.Jgb(ab);const wg=!!Tf,Uf={};Uf.ErrorName=Ua;Uf.ErrorHashCode=ab.toString();Uf.ErrorId=hd.toString();Uf.ErrorCause=qe.toString();Uf.ErrorType=0===ef?"ErrorDialog":"BusinessBar";Uf.BusinessBarEntryName=Nf||"null";Uf.ServerCorrelationId=
wg?Tf.CorrelationId:"null";Uf.WebMethodName=wg?Tf.WebMethodName:"null";Uf.SessionHostingEcs=this.fa.workbookContext?this.fa.workbookContext.EcsServerName:"null";Uf.WfeServerId=wg?Tf.WfeServerId:"null";Ua=G.a.Nc(Uf);this.ub.raiseEvent("EREK",new Md(Uf));E.ULS.sendTraceTag(1881314,0,15,Ua);this.oba&&(dc.a.HDg(ab.toString()),this.oqa(9134,ab,qe,0),this.fa.zw||Ae||(this.setDw(10459,ab),this.Z2d(!0),this.XQd=!0,this.upload(),this.PWf()))}Jgb(ab){return 5439488|(ab>>>16^ab&65535)&65535}w3d(ab,Ua,hd){ab=
this.M5g.HVh(ab,Ua,hd);this.oba&&ab&&this.oqa(11007,ab.fvb)}upload(){!this.oba||!this.g4b&&!this.XQd||Da.a.Yg&&sa.AFrameworkApplication.Sf?Da.a.Yg&&sa.AFrameworkApplication.Sf&&E.ULS.sendTraceTag(537151320,0,15,"SqmManager.Upload: skipped UploadWsaData"):(this.A0.G$b(),this.w9c=!0);sa.AFrameworkApplication.Qn=this.A0=null;this.D2a.Qyk();this.g4b=!1;sa.AFrameworkApplication.Qn=this.A0=this.utf();this.M5g.oKg()}EFj(){const ab=this.D2a;if(this.oba&&!ab.gSd){var Ua=ab.Yjb,hd=ab.$jb,qe=ab.ntb.getTime();
sa.AFrameworkApplication.Z6=ab.ntb;Ua&&this.setDw(10324,Ua>qe?0:qe-Ua);hd&&this.setDw(10325,hd>qe?0:qe-hd);ab.gSd=!0}}oqa(ab,...Ua){this.oba&&this.A0.oqa(ab,...Ua)}setDw(ab,Ua){this.oba&&this.A0.setDw(ab,Ua)}utf(){v.a.Stf(this.$.ta);return sa.AFrameworkApplication.Qn}ACi(ab){let Ua;try{Ua=Object(Rc.a)(Object,G.a.Xj(sa.AFrameworkApplication.ea.appSettings.SessionStartInfoJson))}catch(hd){E.ULS.sendTraceTag(537151311,0,15,`Couldn't parse SessionStartInfoJson. Message: ${hd.message}`);return}if(Ua){let hd=
Object(Rc.a)(String,Ua.ApplicationModeExtended),qe=Object(Rc.a)(String,Ua.ApplicationMode);hd&&qe&&(hd=hd.toUpperCase(),2!==ab&&16!==ab||"VIEW"!==hd&&"UNIFIED"!==hd?1!==ab||"EDIT"!==hd&&"UNIFIED"!==hd||(hd="VIEW",qe="View"):(hd="EDIT",qe="Edit"),Ua.ApplicationModeExtended=hd,Ua.ApplicationMode=qe,sa.AFrameworkApplication.ea.appSettings.SessionStartInfoJson=G.a.Nc(Ua))}}PWf(){const ab=this.$.ta;this.A0.yU=!0;this.A0.F7a(ab.BWsaStartTime);this.setDw(59,83);this.g4b=!1;if(this.oba){const Ua=ab.DocumentHostInfo;
this.Mai();this.setDw(8491,this.$.bJ);this.setDw(9236,ab.RequestedUILcid);this.setDw(8473,ab.WacHostId);this.setDw(9902,id.c(Ua.ClusterId));I.EwaSettings.Ra(398)?this.A0.VQg(""):this.A0.VQg(ab.FlightHolder?ab.FlightHolder.FlightId:"");this.yoe(this.fa.$b.inEmbedView?1:0);this.XQd=!1;this.setDw(9104,id.c(Ua.FileSourceId));this.setDw(10309,this.wkj);this.EOk();sa.AFrameworkApplication.Kb.qhe(md.a.getInstance(!1))}}EOk(){Dd.a.instance.Fgj(this.A0);if(this.QUg){const ab=Dd.a.instance;ab.Ulk();ab.smk();
ab.pmk();ab.omk();ab.imk();this.QUg=!1}}Mai(){this.createStream(8327,1,ya.a.Tdi,ya.a.Efb);this.createStream(9134,1,3,ya.a.Efb);this.createStream(11007,1,1,ya.a.Efb)}createStream(ab,Ua,hd,qe){this.A0.createStream(ab,Ua,hd,qe)}}Cb.wyb=null;Cb.Osd=!1;Cb.cqd=!1;Object(z.a)(Cb,"SqmManager",Jd.a,[600,601]);var qa=a(88),qb=a(959);class bc{constructor(ab,Ua){this.entryTypes=null;this.buffered=!1;this.entryTypes=ab;this.buffered=void 0===Ua?!1:Ua}}Object(z.a)(bc,"PerformanceObserverInit",null,[]);class R extends Sys.EventArgs{constructor(ab){super();
this.Vtf=ab}}Object(z.a)(R,"LongTaskObservedEventArgs",Sys.EventArgs,[]);class cb extends Sys.EventArgs{constructor(ab){super();this.bEc=ab}}Object(z.a)(cb,"LongTaskPerformanceObserverInitializedEventArgs",Sys.EventArgs,[]);class zb{constructor(ab){this.ub=new la.a;this.ecd=!1;this.qm=()=>{if(Da.a.Wp){try{void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&((new PerformanceObserver(this.WHj)).observe(new bc([Fa.a.J3d])),this.ecd=!0)}catch(Ua){this.ecd=!1,E.ULS.sendTraceTag(537153885,
0,10,`Exception related to PerformanceObserver: ${Ua}`)}this.ub.raiseEvent("ltpoiek",new cb(this.bEc))}};this.WHj=Ua=>{this.ub.raiseEvent("ltoek",new R(Ua))};this.$=ab;this.$.fa.io?this.qm():this.$.fa.Yv(this.qm)}get bEc(){return this.ecd}A4e(ab){this.ub.addHandler("ltoek",ab)}Etk(ab){this.ub.removeHandler("ltoek",ab)}NEh(ab){this.ub.addHandler("ltpoiek",ab)}Ftk(ab){this.ub.removeHandler("ltpoiek",ab)}dispose(){fa.a.vb(this.ub);this.$=this.ub=null}}Object(z.a)(zb,"LongTaskPerformanceObserver",null,
[4]);var V=a(183);class Ea{constructor(ab,Ua){this.longTaskDuration=this.activeSessionDuration=0;this.activeSessionDuration=void 0===ab?0:ab;this.longTaskDuration=void 0===Ua?0:Ua}get K3d(){return this.activeSessionDuration?this.longTaskDuration/this.activeSessionDuration:0}Ryj(ab){return 100*this.K3d>ab}$Bh(ab){this.z3e(ab.longTaskDuration);this.Xnd(ab.activeSessionDuration)}z3e(ab){this.longTaskDuration+=ab}Xnd(ab){this.activeSessionDuration+=ab}}Object(z.a)(Ea,"LongTaskPerformanceData",null,[]);
class pb{constructor(ab,Ua,hd,qe,Ae){this.isVetoSession=!1;this.postBootWindowData=this.worstWindowData=this.entireSessionData=null;this.maxUsersCount=0;this.isVetoSession=ab;this.entireSessionData=Ua;this.worstWindowData=hd;this.postBootWindowData=qe;this.maxUsersCount=Ae}get reportName(){return"LongTaskPerformance"}static get $li(){return new pb(!1,new Ea,new Ea,new Ea,0)}}Object(z.a)(pb,"LongTaskPerformanceDataStatistics",null,[582]);class Jb extends Sys.EventArgs{constructor(ab){super();this.L3d=
ab}}Object(z.a)(Jb,"LongTaskTrackedEventArgs",Sys.EventArgs,[]);var zc=a(441),Mc=a(341);class od{constructor(ab,Ua){this.ub=new la.a;this.k0a=this.Kda=this.g_=this.df=null;this.z7f=this.qse=this.KIc=!1;this.O0a=null;this.maxUsersCount=0;this.yOc=(hd,qe)=>{hd=qe.Vtf.getEntriesByType(Fa.a.J3d);for(const Ae of hd)this.df.pI(Ae.duration)||sa.AFrameworkApplication.O_a||(this.g_.z3e(Ae.duration),this.ub.raiseEvent("lttek",new Jb(Ae)),hd={},hd.LongTaskDuration=Ae.duration,hd.LongTaskStartTime=Ae.startTime,
E.ULS.sendTraceTag(187982418,0,50,JSON.stringify(hd)))};this.qm=()=>{this.qse=!0;this.m8b()};this.wE=(hd,qe)=>{qe&&(this.maxUsersCount=Math.max(this.maxUsersCount,qe.U9g));this.Kda.maxUsersCount=this.maxUsersCount};this.de=()=>{this.m8b()};this.jd=()=>{this.t8b()};this.mpg=(hd,qe)=>{qe.bEc&&this.m8b()};this.qbg=()=>{this.g_.Xnd(ba.getElapsedMilliseconds(this.k0a,A.a.zb.Jc));this.Due(!0);var hd=!1;this.Kda.postBootWindowData.activeSessionDuration?(!this.z7f&&I.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&
(I.EwaSettings.Og()?void ea.a.resolve(S.TelemetryManagerService).then(Ae=>{Ae.Oje(2)}):ge.telemetryManager().Oje(2),ld.Health.instance.recordKpiUsage(Mc.a.longJsTask,Xd.b.FailureBased,zc.a.Wzj,null),this.z7f=!0),!this.Kda.isVetoSession&&this.g_.Ryj(this.aah)&&(this.Kda.isVetoSession=!0,I.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&(I.EwaSettings.Og()?void ea.a.resolve(S.TelemetryManagerService).then(Ae=>{Ae.Pje(2,this.Gbg)}):ge.telemetryManager().Pje(2,this.Gbg),
ld.Health.instance.recordKpiFailure(Mc.a.longJsTask,"SessionVetoedJsLoadTooSlow",!1,!0,null))),this.Kda.worstWindowData.K3d<=this.g_.K3d&&(this.Kda.worstWindowData=this.g_),this.Kda.entireSessionData.$Bh(this.g_)):(this.Kda.postBootWindowData=new Ea(this.g_.activeSessionDuration,this.g_.longTaskDuration),hd=!0);const qe={};qe.LastWindowScore=this.g_;qe.postBootWindow=hd;qe.CoauthersNumber=this.$.fa.ko.length;hd=JSON.stringify(qe);E.ULS.sendTraceTag(20779346,0,50,hd);this.g_=new Ea};this.lNc=()=>{this.df.isHidden||
sa.AFrameworkApplication.O_a||this.Due(!1)};this.kNc=()=>{this.g_.Xnd(ba.getElapsedMilliseconds(this.k0a,A.a.zb.Jc));this.k0a=null;this.O0a.cancel()};this.$=ab;this.aah=ab.ta.LongTaskPerformanceVetoThreshold;this.Gbg="PercentageOver_"+this.aah.toString();this.M3d=ab.ta.LongTaskPerformanceWindowDurationInMs;this.JU=Ua;I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void ea.a.resolve(S.DocumentVisibilityObserverService).then(hd=>{this.df=hd;
this.m8b()}):this.$.ra.Vc(291,hd=>{this.df=hd;this.m8b()});this.$.fa.io?this.qm():this.$.fa.Yv(this.qm);this.JU.NEh(this.mpg);this.$.Ul(this.de);this.$.Sj(this.jd)}OEh(ab){this.ub.addHandler("lttek",ab)}Gtk(ab){this.ub.removeHandler("lttek",ab)}dispose(){this.qse=!1;this.t8b();this.$.tm(this.de);this.$.ro(this.jd);this.JU.Ftk(this.mpg);fa.a.vb(this.O0a);this.JU=this.$=this.O0a=null;void 0!==this.df&&null!==this.df&&fa.a.vb(this.df)}m8b(){void 0===this.df||null===this.df?E.ULS.sendTraceTag(537153884,
0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but visibilityObserver is not ready yet"):this.JU.bEc?this.KIc?E.ULS.sendTraceTag(537153882,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we already tracking"):this.qse?(this.KIc=!0,this.Kda=pb.$li,this.g_=new Ea,this.$.fa.Dha(this.wE),this.maxUsersCount=this.$.fa.ko.length,this.JU.A4e(this.yOc),this.df.j6(this.kNc),this.df.h0(this.lNc),sa.AFrameworkApplication.N3e(this.kNc),
sa.AFrameworkApplication.O3e(this.lNc),this.O0a=kc.a.instance.create(this.qbg,this.M3d,na.a.sag,!1),Wf.a(this.$).g6(this.Kda),this.df.isHidden||sa.AFrameworkApplication.O_a||this.Due(!0),E.ULS.sendTraceTag(537153880,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: Start tracking")):E.ULS.sendTraceTag(537153881,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we still not ready to start tracking"):E.ULS.sendTraceTag(537153883,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but longTaskPerformanceObserver InitializedSuccessfully")}t8b(){this.KIc&&
(this.KIc=!1,this.JU.Etk(this.yOc),this.$.fa.A9(this.wE),void 0!==this.df&&null!==this.df&&(this.df.fsb(this.kNc),this.df.wLa(this.lNc)),sa.AFrameworkApplication.Lrk(this.kNc),sa.AFrameworkApplication.Mrk(this.lNc),this.O0a.cancel(),this.k0a=this.g_=this.Kda=null,this.maxUsersCount=0)}Due(ab){ab||void 0===this.k0a||null===this.k0a?(this.k0a=A.a.zb.Jc,this.O0a=V.AsyncMethodContext.rKb(this.qbg,ab?this.M3d:this.M3d-this.g_.activeSessionDuration,na.a.sag,this.O0a)):E.ULS.sendTraceTag(589875356,0,15,
"LongTaskPerformanceTracker:StampLastAppAwakeAndDocumentUnhiddenEcmaDateAndRestartTimer lastAppAwakeAndDocumentUnhiddenEcmaDate is not null when resuming a window")}}Object(z.a)(od,"LongTaskPerformanceTracker",null,[4]);var Td=a(29);class Zd extends la.a{constructor(ab,Ua){super();this.statusBarManager=this.df=null;this.npg=(hd,qe)=>{qe.L3d&&qe.L3d.duration>=this.XHj&&(this.Jbg++,this.b8f=qe.L3d.duration)};this.$=ab;this.$.ra.Vc(29,hd=>{this.statusBarManager=hd;hd.FJ(this)});I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",
!1)?void ea.a.resolve(S.DocumentVisibilityObserverService).then(hd=>{this.df=hd}):this.$.ra.Vc(291,hd=>{this.df=hd});this.b8f=this.Jbg=0;this.XHj=ab.ta.LongTaskThresholdMs;this.Nnb=Ua;this.Nnb.OEh(this.npg)}Js(ab){this.addHandler("LTSCEK",ab)}vs(ab){this.removeHandler("LTSCEK",ab)}Yp(){this.Wj("QueryLongTasksCount")&&this.raiseEvent("LTSCEK")}vq(ab,Ua){if("QueryLongTasksCount"!==ab)return!1;this.A9i(Ua);return!0}Wj(){return I.EwaSettings.Ra(505)}dispose(){this.statusBarManager&&(this.statusBarManager.OI(this),
this.statusBarManager=null);this.Nnb.Gtk(this.npg);super.dispose()}A9i(ab){const Ua=`Long Tasks: ${this.Jbg} | Last Task Duration: ${Math.round(this.b8f)}ms`;Td.a.oj(this.$)?(ab.LabelText=Ua,ab.Visible=!0):ab.Value=Ua}}Object(z.a)(Zd,"LongTasksStatusBarManager",la.a,[4,360,217]);var xe=a(12);class pe{constructor(){this.rttMs=this.bandwidthMps=0;this.effectiveConnection=this.connectionType=null;this.downlinkMaxMps=0}}Object(z.a)(pe,"NetworkInfoData",null,[]);class Re extends la.a{constructor(ab){super();
this.statusBarManager=null;this.Fnd=!1;this.Shg=()=>{this.raiseEvent("NetworkInformation")};this.$=ab;I.EwaSettings.isChangeGateEnabled("OfficeVSO:3539919_AddNetworkInformationTelemetry")&&(this.cO=this.Aye("connection")||this.Aye("mozConnection")||this.Aye("webkitConnection"))&&I.EwaSettings.Ra(410)&&ab.ra.Vc(29,Ua=>{this.statusBarManager=Ua;Ua.FJ(this);this.cO.addEventListener("change",this.Shg);this.Fnd=!0})}Js(ab){this.addHandler("NetworkInformation",ab)}vs(ab){this.removeHandler("NetworkInformation",
ab)}HGa(){return this.cO?Object(fb.a)(new pe,{bandwidthMps:this.cO.downlink,rttMs:this.cO.rtt,connectionType:this.cO.type,effectiveConnection:this.cO.effectiveType,downlinkMaxMps:this.cO.downlinkMax}):null}vq(ab,Ua){if("QueryNetworkInformation"!==ab)return!1;this.B9i(Ua);return!0}Wj(){return this.Fnd}dispose(){this.Fnd&&(this.statusBarManager&&(this.statusBarManager.OI(this),this.statusBarManager=null),this.cO&&this.cO.removeEventListener("change",this.Shg));this.$=null;super.dispose()}Aye(ab){return xe.HelperMethods.Aq(window.navigator,
ab)?window.navigator[ab]:null}B9i(ab){const Ua="Network: "+this.cO.downlink.toString()+" Mbps, "+this.cO.rtt.toString()+" ms";Td.a.oj(this.$)?(ab.LabelText=Ua,ab.Visible=!0):ab.Value=Ua}}Object(z.a)(Re,"NetworkInformationManager",la.a,[360,217]);class pf{constructor(ab,Ua,hd,qe,Ae,ef,Tf,Nf,wg,Uf){this.name=null;this.startToResponseRenderEnd=this.startToNextFrame=this.startTime=0;this.isPartOfGroup=this.isGroupBreaking=this.isUserOperation=this.wasHidden=!1;this.operationThatLedToLogging=null;this.startToOperationThatLedToLogging=
0;this.name=void 0===ab?"":ab;this.startTime=void 0===Ua?-1:Ua;this.startToNextFrame=void 0===hd?-1:hd;this.startToResponseRenderEnd=void 0===qe?-1:qe;this.wasHidden=void 0===Ae?!1:Ae;this.isUserOperation=void 0===ef?!0:ef;this.isGroupBreaking=void 0===Tf?!0:Tf;this.operationThatLedToLogging=void 0===wg?"":wg;this.startToOperationThatLedToLogging=void 0===Uf?-1:Uf;this.isPartOfGroup=void 0===Nf?!1:Nf}}Object(z.a)(pf,"OperationStatisticsData",null,[]);class vf{constructor(){this.YPc=null;this.Tfj()}isGroup(ab,
Ua,hd){const qe=[...ab,...Ua];for(let Ae=0;Ae<this.YPc.length;Ae++)if(this.Puj(this.YPc[Ae],qe,hd))return E.ULS.sendTraceTag(595194768,1,50,`OperationsGroupDetector: Operation '${hd}' is part of a group ( operationsList: ${this.tvg(ab)} , frameOperationsList: ${this.tvg(Ua)})`),!0;E.ULS.sendTraceTag(595194767,1,50,`OperationsGroupDetector: Operation '${hd}' is NOT part of a group.`);return!1}Puj(ab,Ua,hd){let qe=0;for(let Ae=0;Ae<Ua.length;Ae++)if(Ua[Ae].isGroupBreaking){if(ab.length<=qe||!Z.a.equals(Ua[Ae].name,
ab[qe],!0))return!1;qe++}return ab.length>qe&&Z.a.equals(hd,ab[qe],!0)}tvg(ab){return`[${ab.map(Ua=>Ua.name).join(", ")}]`}Tfj(){this.YPc=[];this.Hbb(["Paste","SelectingRange_unknown"]);this.Hbb(["AutoSum","SelectingRange_unknown"]);this.Hbb(["ChangeSheetDirection","ActiveItemChanged"]);this.Hbb(["InsertSheet","ActiveItemChanged","SelectingRange_unknown"]);this.Hbb(["DeleteSheet","DialogButtonClick","ActiveItemChanged","SelectingRange_unknown"]);this.Hbb(["EditBoxEndEdit","SetCell","SelectingRange_keyboard",
"MoveDownWithinSelectionOrCommitEdit"])}Hbb(ab){this.YPc.push(ab)}}Object(z.a)(vf,"OperationsGroupDetector",null,[]);var Qf=a(26);class yf{constructor(ab,Ua,hd,qe){this.T3b=this.e9=this.f$=null;this.Swk=()=>{this.Wpd=-1;const Ae=xe.HelperMethods.Lb();this.Afl(Ae);this.m5b&&(E.ULS.sendTraceTag(537153878,1,50,"GroupDetector: Setting current frame operations render duration due to rendering without additional blocks."),this.v$b(this.iK,Ae),this.m5b=!1);this.MGc&&(this.v$b(this.mL,Ae),this.m5b||this.v$b(this.iK,
Ae));window.setTimeout(this.BFj,0)};this.BFj=()=>{var Ae=[];const ef=this.$.ta.OperationToPrevOperationThreshold;for(var Tf=0;Tf<this.iK.length;Tf++){var Nf=this.iK[Tf];Tf<ef&&Ae.push(Nf);this.mL.push(Nf)}Na.f(this.$)&&Na.f(this.$).za?((Tf=this.sessionStatisticsManager.OKd(0))?(Nf=JSON.stringify(this.ZXb),Ae=JSON.stringify(Ae),E.ULS.sendTraceTag(237798547,1,50,`DOM count: (${Tf.bMj}, ${Tf.lNh}, ${Tf.KKj}), long tasks: ${Nf}, operations count: ${this.iK.length}, operations: ${Ae}`)):E.ULS.sendTraceTag(537153876,
1,50,"Report Manager NumberOfDomElements does not exist"),this.iK.length>ef&&E.ULS.sendTraceTag(537153875,1,50,`More than ${ef} operations are in the operationsList. count: ${this.iK.length}`),this.iK=[],this.ZXb=[]):E.ULS.sendTraceTag(537153877,1,10,"Grid == null or BlockManager == null")};this.yOc=(Ae,ef)=>{this.VHj(ef.Vtf)};this.$=ab;this.EO=Ua;this.vj=this.vj||A.a.zb;this.mL=[];this.iK=[];this.Wpd=this.Ymb=-1;this.ZXb=[];this.K8j=new vf;this.m5b=this.MGc=!1;this.tgj();this.Vfj();this.Ufj();this.sessionStatisticsManager=
hd;this.JU=qe;this.JU.A4e(this.yOc)}d4b(ab){var Ua=xe.HelperMethods.Lb();const hd=this.K8j.isGroup(this.mL,this.iK,ab);(this.MGc=this.$tj(ab))&&0<this.mL.length&&!hd&&(this.oel(),this.nel(ab,Ua),this.gDi());this.Ymb=-1;if(Na.f(this.$)&&Na.f(this.$).za){var qe=!this.f$.contains(ab);Ua=new pf(ab,Ua,void 0,void 0,void 0,qe,this.MGc,hd);this.iK.push(Ua);!this.m5b&&this.T3b.contains(ab)&&(this.m5b=!0);-1===this.Wpd&&(this.Wpd=window.requestAnimationFrame(this.Swk))}else E.ULS.sendTraceTag(537153879,1,
10,"Grid == null or BlockManager == null")}IUc(){this.Ymb=xe.HelperMethods.Lb()}QUc(){this.mL.length||this.iK.length?(this.v$b(this.iK,this.Ymb),this.v$b(this.mL,this.Ymb)):E.ULS.sendTraceTag(0,1,50,`ReportOnBlockCacheConsistent when no operations in the list. Last block render time: ${this.Ymb}`);this.Ymb=-1}$tj(ab){return!this.e9.contains(ab)&&!ab.includes("Menu")&&!ab.includes("TellMe")}gDi(){for(let ab=0;ab<this.mL.length;ab++){const Ua=this.mL[ab];this.EO.wxh(Ua);this.iGj(Ua)}this.mL=[]}Afl(ab){for(let Ua=
0;Ua<this.iK.length;Ua++)this.iK[Ua].startToNextFrame=this.hNd(this.iK[Ua].startTime,ab),this.iK[Ua].wasHidden=qb.a.pI(this.iK[Ua].startToNextFrame)}nel(ab,Ua){for(let hd=0;hd<this.mL.length;hd++)-1===this.mL[hd].startToResponseRenderEnd&&(this.mL[hd].operationThatLedToLogging=ab,this.mL[hd].startToOperationThatLedToLogging=this.hNd(this.mL[hd].startTime,Ua))}oel(){var ab=!1;for(const Ua of this.mL)if(Ua.isPartOfGroup){ab=!0;break}if(ab)for(ab=0;ab<this.mL.length;ab++)this.mL[ab].isPartOfGroup=this.mL[ab].isGroupBreaking}v$b(ab,
Ua){for(let hd=0;hd<ab.length;hd++)ab[hd].startToResponseRenderEnd=this.hNd(ab[hd].startTime,Ua),ab[hd].wasHidden=qb.a.pI(ab[hd].startToResponseRenderEnd)}iGj(ab){ab=JSON.stringify(ab);E.ULS.sendTraceTag(2020372336,1,50,`${ab}`)}hNd(ab,Ua){return-1===ab?-1:-1===Ua?-2:Ua-ab}VHj(ab){ab=ab.getEntriesByType(Fa.a.J3d);for(let Ua=0;Ua<ab.length;Ua++)if(30>this.ZXb.length)if(this.iK.length)this.ZXb.push(this.Uak(ab[Ua]));else{const hd=ab[Ua];if(null===hd||void 0===hd?0:hd.attribution)void 0!==hd.attribution.containerSrc&&
null!==hd.attribution.containerSrc&&(hd.attribution.containerSrc=""),void 0!==hd.attribution.containerId&&null!==hd.attribution.containerId&&(hd.attribution.containerId=""),void 0!==hd.attribution.containerName&&null!==hd.attribution.containerName&&(hd.attribution.containerName="");E.ULS.sendTraceTag(40777251,1,50,"LongTaskObserverAction: long task occur when operations list was empty.")}else{E.ULS.sendTraceTag(537153874,1,50,`More then ${30} long tasks are in the longTaskList. entries length: ${ab.length} First long task: ${this.ZXb[0]}`);
break}}Uak(ab){return`name:${ab.name}, startTime:${ab.startTime}, duration:${ab.duration}`}tgj(){this.f$||(this.f$=new cf.a(Lc.a.Ef()),this.f$.add("ActiveItemChanged"),this.f$.add(ge.resolveRibbonCommandName(-1398645260)),this.f$.add(ge.resolveRibbonCommandName(722290388)),this.f$.add(ge.resolveRibbonCommandName(974713501)),this.f$.add(Qf.a.iY(Qf.a.kqc)),this.f$.add(Qf.a.iY(Qf.a.jqc)),this.f$.add(Qf.a.iY(Qf.a.eJb)),this.f$.add(Qf.a.iY(Qf.a.PAg)),this.f$.add(Qf.a.iY(Qf.a.Ama)))}Vfj(){this.e9||(this.e9=
new cf.a(Lc.a.Ef()),this.e9.add("PromptEditInBrowser"),this.e9.add(ge.resolveRibbonCommandName(-1398645260)),this.e9.add(ge.resolveRibbonCommandName(722290388)),this.e9.add(ge.resolveRibbonCommandName(974713501)),this.e9.add(Qf.a.iY(Qf.a.kqc)),this.e9.add(Qf.a.iY(Qf.a.jqc)),this.e9.add(Qf.a.iY(Qf.a.eJb)),this.e9.add(Qf.a.iY(Qf.a.PAg)),this.e9.add(Qf.a.iY(Qf.a.Ama)))}Ufj(){this.T3b||(this.T3b=new cf.a(Lc.a.Ef()),this.T3b.add("SelectingRange_keyboard"),this.T3b.add("SelectingRange_mouse"))}}Object(z.a)(yf,
"OperationStatistics",null,[]);var Df=a(707);class pg{constructor(ab,Ua){this.messageIdName=null;this.errorCause=0;this.messageIdName=ab;this.errorCause=Ua}}Object(z.a)(pg,"RequestError",null,[]);class Zf{constructor(ab,Ua,hd,qe,Ae,ef,Tf,Nf,wg,Uf,lg,Kg,If,hg,gh,mc,sd){this.requestName=null;this.isPromotedUTRRequest=this.isFullyLoggedKPIRequest=this.isUserTriggeredRequest=!1;this.TimeFromLastEcsFreeze=this.WfeRequestDuration=this.EcsRequestDuration=this.ecsOperationDuration=this.requestInvokedTime=
this.requestTimeInQueue=this.totalOperationDuration=this.requestDuration=0;this.DuringLoadOnDemand=!1;this.errors=this.correlationID=null;this.httpStatus=0;this.requestResourceTiming=null;this.communicationErrorRetryCount=0;this.isDocumentHidden=this.successfulCall=!1;this.responseSize=this.coauthorsCount=0;this.networkInfoData=null;this.responseToCallbackTime=0;this.requestName=ab;this.isUserTriggeredRequest=Zf.JTi(ab);this.isFullyLoggedKPIRequest=Zf.zTi(ab);this.isPromotedUTRRequest=Zf.BTi(ab);
this.requestDuration=Ua;this.totalOperationDuration=hd;this.requestTimeInQueue=qe;this.requestInvokedTime=Ae;this.ecsOperationDuration=ef.EcsOperationDuration;this.EcsRequestDuration=ef.EcsRequestDuration;this.WfeRequestDuration=ef.WfeRequestDuration;this.TimeFromLastEcsFreeze=ef.TimeFromLastEcsFreeze;this.DuringLoadOnDemand=ef.DuringLoadOnDemand;this.correlationID=Tf;this.errors=Zf.B2h(Nf);this.httpStatus=wg;this.requestResourceTiming=Uf;this.communicationErrorRetryCount=lg;this.successfulCall=Kg;
this.isDocumentHidden=If;this.coauthorsCount=hg;this.responseSize=gh;this.networkInfoData=mc;this.responseToCallbackTime=sd}static B2h(ab){if(!ab)return[];const Ua=[];for(const hd of ab)Ua.push(new pg(hd.MessageIdName,hd.ErrorCause));return Ua}static JTi(ab){return!Zf.bQj.contains(ab)}static uWi(){const ab=new cf.a(Lc.a.Ef());ab.add("CheckPersistedContentUpdate");ab.add("GetContentBundle");ab.add("GetSessionStatus");ab.add("GetStatusBarAggregates");ab.add("PollSessionStatus");ab.add("UpdatePresenceUsers");
ab.add("UploadLatencyTelemetry");return ab}static zTi(ab){return Zf.BFi.contains(ab)}static BTi(ab){return Zf.Jgk.contains(ab)}static QRi(){const ab=new cf.a(Lc.a.Ef());ab.add("SetRichTextCell");ab.add("Copy");ab.add("FormatCells");ab.add("PasteRange");ab.add("FindCell");ab.add("ApplyToRangesV2");ab.add("ResizeRowsColumns");ab.add("InsertDeleteCells");ab.add("FillRange");ab.add("PasteHtmlContent");ab.add("ApplyFilter");ab.add("PasteString");ab.add("Undo");ab.add("LineageUpdateView");ab.add("FindAll");
ab.add("ApplyHyperlink");ab.add("AutoFit");ab.add("GetPrintSettings");ab.add("GetEdgeCell");ab.add("Paste");ab.add("MoveAndResizeFloatingObject");ab.add("FindRange");ab.add("SetCustomFilter");ab.add("RenameSheet");ab.add("ApplyThreadedComment");ab.add("SortFilterColumn");ab.add("InsertCopiedCutCellsV2");ab.add("InsertSheet");ab.add("ToggleAutoFilter");ab.add("ReorderSheets");ab.add("SetOutlineLevel");ab.add("RefreshAll");ab.add("LineageOpenPaneOrChangeFilter");ab.add("ApplySlicerSelection");ab.add("GetCardViewCardByCell");
ab.add("AutoSum");ab.add("LineageClosePane");ab.add("Sort");ab.add("ClearAutoFilter");ab.add("DeleteSheet");ab.add("Redo");I.EwaSettings.isChangeGateEnabled("OfficeVSO:5317483_AdditionalOperationsInXlreqKPI")&&(ab.add("RemovePageBreak"),ab.add("InsertPageBreak"),ab.add("SetPrintArea"),ab.add("ClearPrintArea"));return ab}static CTi(){const ab=new cf.a(Lc.a.Ef());ab.add("DeleteConditionalFormattingRules");ab.add("GetConditionalFormattingRules");ab.add("AddConditionalFormattingRule");ab.add("QuickEditConditionalFormattingRule");
ab.add("GetPrintSettings");ab.add("UpdatePresenceUsers");ab.add("GetThemeInfo");ab.add("InsertCopiedCutCellsV2");ab.add("PasteRange");ab.add("FillRange");ab.add("InsertCopiedCutCellsCrossSession");I.EwaSettings.isChangeGateEnabled("OfficeVSO:5738374_UTR_xlreq_lineage")&&(ab.add("LineageOpenPaneOrChangeFilter"),ab.add("LineageUpdateView"),ab.add("LineageRefreshView"),ab.add("LineageLoadMore"));I.EwaSettings.isChangeGateEnabled("OfficeVSO:8609133_PromoteGetNumberFormatViewModelData")&&ab.add("GetNumberFormatViewModelData");
ab.add("PasteString");return ab}}Zf.bQj=Zf.uWi();Zf.BFi=Zf.QRi();Zf.Jgk=Zf.CTi();Object(z.a)(Zf,"RequestStatisticsData",null,[]);class Tg{constructor(ab,Ua,hd){this.$=ab;this.EO=Ua;this.iwa=hd}VUc(ab,Ua,hd,qe,Ae,ef,Tf,Nf,wg,Uf,lg,Kg,If,hg){Kg=Df.a(Kg);ab=new Zf(ab,Ua,hd,qe,Ae,ef,Tf,Nf,wg,Kg,Uf,lg,qb.a.pI(Ua),this.rMd(null),If,this.iwa.HGa(),hg);this.rke(ab)}Zi(ab,Ua){ab="UnknownMethodName";var hd=-1;void 0!==Ua.context&&null!==Ua.context&&(ab=Ua.context.methodName,hd=Ua.context.communicationErrorRetryCount);
let qe,Ae={EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1};Ua.Ge?(qe=Ua.Ge.Errors||[],this.EO.Lwk(Ua.Ge.EditSessionIsDirty),void 0!==Ua.Ge.RequestTelemetryData&&null!==Ua.Ge.RequestTelemetryData&&(Ae=Ua.Ge.RequestTelemetryData)):qe=[];const ef=Ua.duration,Tf=Df.a(Ua.url);ab=new Zf(ab,ef,Ua.totalOperationDuration,Ua.Wwe,Ua.KK,Ae,Ua.ioe,qe,Ua.httpStatus,Tf,hd,!0,qb.a.pI(ef),this.rMd(Ua.Ge),Ua.responseSize,this.iwa.HGa(),Ua.responseToCallbackTime);
this.rke(ab);ab.requestResourceTiming&&(hd=ab.requestResourceTiming.totalDuration-ab.WfeRequestDuration,hd>=this.$.ta.LongNetworkTimeTelemetryThresholdInMilliseconds&&Ua.responseHeaders&&E.ULS.sendTraceTag(508880928,0,50,`RequestStatistics.onWebMethodSuccess: Slow network time detected: requestName = ${ab.requestName}, requestDuration = ${ab.requestDuration}, networkTime = ${hd},  ServerCorrelation = ${ab.correlationID}, msEdgeHeader = ${Fa.a.aZb in Ua.responseHeaders?Ua.responseHeaders[Fa.a.aZb]:
""}, backendDatacenter = ${Fa.a.f8d in Ua.responseHeaders?Ua.responseHeaders[Fa.a.f8d]:""}, proxyDatacenter = ${Fa.a.h8d in Ua.responseHeaders?Ua.responseHeaders[Fa.a.h8d]:""}`))}tr(ab,Ua){ab="UnknownMethodName";let hd=-1;void 0!==Ua.context&&null!==Ua.context&&(ab=Ua.context.methodName,hd=Ua.context.communicationErrorRetryCount);const qe=Ua.duration,Ae=Df.a(Ua.url);Ua=new Zf(ab,qe,Ua.totalOperationDuration,Ua.Wwe,Ua.KK,{EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,
DuringLoadOnDemand:!1},Ua.ioe,Ua.errors||[],Ua.httpStatus,Ae,hd,!1,qb.a.pI(qe),this.rMd(null),-1,this.iwa.HGa(),Ua.responseToCallbackTime);this.rke(Ua)}rke(ab){this.EO.bIh(ab);if(I.EwaSettings.Ra(212)){var Ua=ab.requestName;if(Ua!==Fa.a.PGa&&"SetCell"!==Ua&&"FindRange"!==Ua&&"FindAll"!==Ua&&"FindCell"!==Ua)return}Ua=I.EwaSettings.isChangeGateEnabled("OfficeVSO:5514802_UTRBasedOnULS_xlreq")&&!(void 0===ab.requestName||null===ab.requestName)&&ab.isPromotedUTRRequest;Tg.Zji(ab,Ua);this.EO.xxh(ab)}rMd(ab){var Ua;
if(null===(Ua=null===ab||void 0===ab?void 0:ab.CollaborationResult)||void 0===Ua?0:Ua.Users)return ab.CollaborationResult.Users.length;ab=this.$.fa.ko.length;return 0<ab?ab:1}static Zji(ab,Ua){Ua?I.EwaSettings.Og()?void ea.a.resolve(S.TelemetryManagerService).then(hd=>{hd.H5b(388829456,0,15,ab)}):ge.telemetryManager().H5b(388829456,0,15,ab):(Ua=Sys.Serialization.JavaScriptSerializer.serialize(ab),E.ULS.sendTraceTag(388829456,0,50,Ua));if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:5294200_ReportXlreqKPI")&&
void 0!==ab.requestName&&null!==ab.requestName&&ab.isFullyLoggedKPIRequest){const hd=new Map;hd.set("isUserTriggeredRequest",ab.isUserTriggeredRequest.toString());hd.set("requestDuration",ab.requestDuration.toString());hd.set("totalOperationDuration",ab.totalOperationDuration.toString());hd.set("requestTimeInQueue",ab.requestTimeInQueue.toString());hd.set("requestInvokedTime",ab.requestInvokedTime.toString());hd.set("ecsOperationDuration",ab.ecsOperationDuration.toString());hd.set("ecsRequestDuration",
ab.EcsRequestDuration.toString());hd.set("wfeRequestDuration",ab.WfeRequestDuration.toString());hd.set("timeFromLastEcsFreeze",ab.TimeFromLastEcsFreeze.toString());hd.set("duringLoadOnDemand",ab.DuringLoadOnDemand.toString());hd.set("correlationID",ab.correlationID);hd.set("errors",ab.errors.toString());hd.set("httpStatus",ab.httpStatus.toString());ab.networkInfoData&&(Ua=ab.networkInfoData,hd.set("networkInfoData_bandwidthMps",void 0===Ua.bandwidthMps||null===Ua.bandwidthMps?"NA":Ua.bandwidthMps.toString()),
hd.set("networkInfoData_rttMs",void 0===Ua.rttMs||null===Ua.rttMs?"NA":Ua.rttMs.toString()),hd.set("networkInfoData_effectiveConnection",void 0===Ua.effectiveConnection||null===Ua.effectiveConnection?"NA":Ua.effectiveConnection));ab.requestResourceTiming&&(Ua=ab.requestResourceTiming,hd.set("requestResourceTiming_fetchStart",void 0===Ua.downloadDuration||null===Ua.downloadDuration?"NA":Ua.downloadDuration.toString()));hd.set("communicationErrorRetryCount",ab.communicationErrorRetryCount.toString());
hd.set("successfulCall",ab.successfulCall.toString());hd.set("isDocumentHidden",ab.isDocumentHidden.toString());hd.set("coauthorsCount",ab.coauthorsCount.toString());hd.set("responseSize",ab.responseSize.toString());hd.set("responseToCallbackTime",ab.responseToCallbackTime.toString());I.EwaSettings.Og()?void ea.a.resolve(S.TelemetryManagerService).then(qe=>{qe.c4b(ab.requestName,ab.successfulCall,hd)}):ge.telemetryManager().c4b(ab.requestName,ab.successfulCall,hd)}}}Object(z.a)(Tg,"RequestStatistics",
null,[]);var Wg=a(235),ph=a(61);class Ug{constructor(){this.operationName=null;this.isUserOperation=!1;this.longestStartToResponse=this.longestStartToNextFrame=this.totalCount=0;this.startToResponsePercentiles=this.startToNextFramePercentiles=null}}Object(z.a)(Ug,"OperationTypeStatisticsData",null,[]);class fh{constructor(ab,Ua){this.data=new Ug;this.data.operationName=ab;this.data.isUserOperation=Ua;this.data.totalCount=0;this.IZg=[];this.JZg=[];this.data.longestStartToNextFrame=-1;this.data.longestStartToResponse=
-1;this.data.startToNextFramePercentiles="";this.data.startToResponsePercentiles=""}Jd(ab){this.data.totalCount<fh.NCd&&(this.IZg.push(ab.startToNextFrame),this.JZg.push(ab.startToResponseRenderEnd));this.data.totalCount++;this.data.longestStartToNextFrame<ab.startToNextFrame&&(this.data.longestStartToNextFrame=ab.startToNextFrame);this.data.longestStartToResponse<ab.startToResponseRenderEnd&&(this.data.longestStartToResponse=ab.startToResponseRenderEnd)}LGd(){0<this.data.totalCount&&(this.data.startToNextFramePercentiles=
this.ZLf(this.IZg),this.data.startToResponsePercentiles=this.ZLf(this.JZg))}ZLf(ab){ab.sort(xe.HelperMethods.gO);let Ua;Ua="("+qb.a.vta(ab,25).toString();Ua=Ua+", "+qb.a.vta(ab,50).toString();Ua=Ua+", "+qb.a.vta(ab,75).toString();Ua=Ua+", "+qb.a.vta(ab,95).toString();return Ua+")"}}fh.NCd=1E3;Object(z.a)(fh,"OperationTypeStatistics",null,[]);class rg{constructor(){this.requestName=null;this.averageWfeDuration=this.averageEcsDuration=this.averageEcsOperationDuration=this.averageDuration=this.callsDuringLoadOnDemand=
this.callsDuringEcsFreeze=this.unsuccessfulCalls=this.successfulCalls=this.totalCount=0;this.longestRequest=null;this.requestDurationPercentile95=this.requestDurationPercentile75=this.requestDurationPercentile50=this.requestDurationPercentile25=0}}Object(z.a)(rg,"RequestTypeStatisticsData",null,[]);class jh{constructor(ab){this.data=new rg;this.data.requestName=ab;this.data.totalCount=0;this.Asb=[];this.Uxe=this.Mxe=this.Nxe=this.Rxe=0;this.data.successfulCalls=0;this.data.unsuccessfulCalls=0;this.data.callsDuringEcsFreeze=
0;this.data.longestRequest=null;this.data.requestDurationPercentile25=-1;this.data.requestDurationPercentile50=-1;this.data.requestDurationPercentile75=-1;this.data.requestDurationPercentile95=-1}sxk(ab){this.data.totalCount<jh.NCd&&this.Asb.push(ab.requestDuration);this.data.totalCount++;this.Rxe+=ab.requestDuration;this.Nxe+=jh.EJd(ab.ecsOperationDuration);this.Mxe+=jh.EJd(ab.EcsRequestDuration);this.Uxe+=jh.EJd(ab.WfeRequestDuration);0<ab.TimeFromLastEcsFreeze&&ab.TimeFromLastEcsFreeze<jh.mFi&&
this.data.callsDuringEcsFreeze++;ab.successfulCall?this.data.successfulCalls++:this.data.unsuccessfulCalls++;ab.DuringLoadOnDemand&&this.data.callsDuringLoadOnDemand++;if(void 0===this.data.longestRequest||null===this.data.longestRequest||this.data.longestRequest.requestDuration<ab.requestDuration)this.data.longestRequest=ab}LGd(){0<this.data.totalCount&&(this.data.averageDuration=Math.floor(this.Rxe/this.data.totalCount),0<this.data.successfulCalls?(this.data.averageEcsOperationDuration=Math.floor(this.Nxe/
this.data.successfulCalls),this.data.averageEcsDuration=Math.floor(this.Mxe/this.data.successfulCalls),this.data.averageWfeDuration=Math.floor(this.Uxe/this.data.successfulCalls)):(this.data.averageEcsOperationDuration=0,this.data.averageEcsDuration=0,this.data.averageWfeDuration=0),this.Asb.sort(xe.HelperMethods.gO),this.data.requestDurationPercentile25=qb.a.vta(this.Asb,25),this.data.requestDurationPercentile50=qb.a.vta(this.Asb,50),this.data.requestDurationPercentile75=qb.a.vta(this.Asb,75),this.data.requestDurationPercentile95=
qb.a.vta(this.Asb,95))}static EJd(ab){return 0>ab?0:ab}}jh.mFi=3E3;jh.NCd=1E3;Object(z.a)(jh,"RequestTypeStatistics",null,[]);class zh{constructor(ab,Ua,hd,qe,Ae,ef,Tf,Nf){this.mode=null;this.dirtySessionOnLastRecordedRequest=this.endedBySplashScreen=this.ocsCapable=!1;this.maxCoauthorsCount=this.loadOnDemandCount=0;this.everConnectedToOcs=!1;this.requests=null;this.mode=ab;this.ocsCapable=Ua;this.endedBySplashScreen=hd;this.dirtySessionOnLastRecordedRequest=qe;this.loadOnDemandCount=Ae;this.maxCoauthorsCount=
ef;this.everConnectedToOcs=Tf;ab=[];for(const wg in Nf)Ua=Nf[wg],Ua.LGd(),ab.push(Ua.data);this.requests=ab}}Object(z.a)(zh,"SessionStatisticsData",null,[]);class zg{constructor(ab){this.dirtySessionOnLastRecordedRequest=this.zue=!1;this.O9f=0;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.$=ab;this.CEb={};this.pbb={};this.uAd={}}jd(){var ab=this.Jbi();if(xa.a.bya()){var Ua={};Ua.xlendJson=ab;this.$.dMa(Wg.a.oll,Ua,!1)}else ph.O(this.$.ma.sa,ab,null,null,null,null,null);ab=this.Kbi();xa.a.bya()?
(Ua={},Ua.xlenoJson=ab,this.$.dMa(Wg.a.pll,Ua,!1)):E.ULS.sendTraceTag(388776782,0,50,ab);ab=this.W6h();xa.a.bya()?(Ua={},Ua.xlencJson=ab,this.$.dMa(Wg.a.nll,Ua,!1)):E.ULS.sendTraceTag(388776770,0,50,ab);this.eyk()}PIc(){this.everConnectedToOcs=this.$.fa.a0a||this.everConnectedToOcs;ld.Health.instance&&ld.Health.instance.addOrUpdatePartCDimension("IsOcsSession",this.everConnectedToOcs.toString())}d9d(){const ab=new L.a;let Ua="";const hd=!this.$.isAnonymousUser(),qe=ab.Tf();if(qe){if(hd){ab.s6b("UMI_Linkable",
"true");return}Ua=ab.pXa("UMI_Linkable")}hd||E.ULS.sendTraceTag(537153870,0,50,`SessionStatistics.OnCommandUIGeneratedAndGridInteractive: IsLocalStorageSupported:${qe}, UMIIsLinkable:${!!Ua}`)}xsb(){this.zue=!0}Lwk(ab){this.dirtySessionOnLastRecordedRequest=ab}bIh(ab){this.maxCoauthorsCount=Math.max(this.maxCoauthorsCount,ab.coauthorsCount);ld.Health.instance&&ld.Health.instance.addOrUpdatePartCDimension("MaxNumEditors",this.maxCoauthorsCount.toString())}xxh(ab){if(!(ab.requestName in this.CEb)){const Ua=
new jh(ab.requestName);this.CEb[ab.requestName]=Ua}this.CEb[ab.requestName].sxk(ab)}wxh(ab){if(!(ab.name in this.pbb)){const Ua=new fh(ab.name,ab.isUserOperation);this.pbb[ab.name]=Ua}this.pbb[ab.name].Jd(ab)}g6(ab){this.uAd[ab.reportName]=ab}eyk(){this.dirtySessionOnLastRecordedRequest=this.zue=!1;this.O9f=this.$.fa.q2d;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.CEb={};this.pbb={};this.uAd={}}Jbi(){const ab=new zh(this.$.isEditMode?"edit":"view",this.$.fa.ocsCapable,this.zue,this.dirtySessionOnLastRecordedRequest,
this.$.fa.q2d-this.O9f,this.maxCoauthorsCount,this.everConnectedToOcs,this.CEb);return Sys.Serialization.JavaScriptSerializer.serialize(ab)}Kbi(){const ab=[];for(const Ua in this.pbb){const hd=this.pbb[Ua];hd.LGd();ab.push(hd.data)}return Sys.Serialization.JavaScriptSerializer.serialize(ab)}W6h(){return Sys.Serialization.JavaScriptSerializer.serialize(this.uAd)}}Object(z.a)(zg,"SessionStatistics",null,[]);class Zg extends Jd.a{constructor(ab){super();this.Exa=this.Mwa=null;this.Fmf=Array(1);this.Zed=
this.N3d=null;this.Zi=(Ua,hd)=>{I.EwaSettings.Ra(39)&&(this.Exa=this.Exa||new Tg(this.$,this.EO,this.iwa),this.Exa.Zi(Ua,hd))};this.tr=(Ua,hd)=>{I.EwaSettings.Ra(39)&&(this.Exa=this.Exa||new Tg(this.$,this.EO,this.iwa),this.Exa.tr(Ua,hd))};this.jd=(Ua,hd)=>{I.EwaSettings.Ra(39)&&this.EO.jd(Ua,hd)};this.qm=()=>{I.EwaSettings.Ra(39)&&this.EO.d9d()};this.PIc=(Ua,hd)=>{I.EwaSettings.Ra(39)&&this.EO.PIc(Ua,hd)};this.$=ab;I.EwaSettings.Ra(39)&&(qb.a.yWf(this.$),this.JU=new zb(this.$),this.U8h(),I.EwaSettings.Ra(505)&&
this.Nnb&&(this.N3d=new Zd(this.$,this.Nnb)),this.EO=new zg(this.$),this.iwa=new Re(this.$),this.$.Sj(this.jd),this.$.ma.ED(this.Zi),this.$.ma.yP(this.tr),this.$.fa.t4e(this.PIc),this.$.fa.Yv(this.qm))}get Nnb(){return this.Zed}dispose(){this.$&&I.EwaSettings.Ra(39)&&(this.$.ro(this.jd),this.$.ma.xG(this.Zi),this.$.ma.sV(this.tr),this.$.fa.lHg(this.PIc),I.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.fa.tie(this.qm));fa.a.vb(this.iwa);fa.a.vb(this.Nnb);this.Zed=null;fa.a.vb(this.JU);
this.JU=null;fa.a.vb(this.N3d);this.$=this.N3d=null;super.dispose()}xsb(){I.EwaSettings.Ra(39)&&this.EO.xsb()}VUc(ab,Ua,hd,qe,Ae,ef,Tf,Nf,wg,Uf,lg,Kg,If,hg){I.EwaSettings.Ra(39)&&(this.Exa=this.Exa||new Tg(this.$,this.EO,this.iwa),this.Exa.VUc(ab,Ua,hd,qe,Ae,ef,Tf,Nf,wg,Uf,lg,Kg,If,hg))}d4b(ab,Ua){I.EwaSettings.Ra(39)&&(this.Mwa=this.Mwa||new yf(this.$,this.EO,this,this.JU),this.Mwa.d4b(ab,Ua))}IUc(){I.EwaSettings.Ra(39)&&(this.Mwa=this.Mwa||new yf(this.$,this.EO,this,this.JU),this.Mwa.IUc())}QUc(){I.EwaSettings.Ra(39)&&
(this.Mwa=this.Mwa||new yf(this.$,this.EO,this,this.JU),this.Mwa.QUc())}g6(ab){I.EwaSettings.Ra(39)&&this.EO.g6(ab)}OKd(ab){return I.EwaSettings.Ra(39)?this.Fmf[ab]:null}xQg(ab){ab&&(this.Fmf[ab.type]=ab)}HGa(){return this.iwa.HGa()}U8h(){Da.a.Wp&&void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&(this.Zed=new od(this.$,this.JU))}}Object(z.a)(Zg,"SessionStatisticsManager",Jd.a,[16]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.BrowserInfoLogger");ub.main();
Type.registerNamespace("CNT");bf.main();Type.registerNamespace("CACPU");Bc.main();Type.registerNamespace("Common.App.EventsCacheManager");gf.main();(()=>{Qe.a.wb(ab=>{S.HostMessengerService.Oa()||ab.ra.zc(137,new Fb(ab))})})();(()=>{Qe.a.wb(ab=>{ab.ra.zc(37,new ra(ab))})})();(()=>{Qe.a.wb(ab=>{ab.ra.zc(40,new Cb(ab,new Vf.a(()=>S.HostMessengerService.Oa()?Object(qa.d)(ea.a.resolve(S.HostMessengerService,{xa:1})):jb.GetServiceTaskFactory.create(ab.ra,137,ab.Aa,1))))})})();(()=>{Qe.a.wb(ab=>{ab.ra.zc(276,
new Zg(ab))})})();(()=>{Qe.a.wb(ab=>{pd.a.ds.Vc(135,()=>{I.EwaSettings.Og()||gc.Ea(ab);S.FontTelemetryManagerService.Oa()||za.Ea(ab);I.EwaSettings.isChangeGateEnabled("OfficeVSO:8434150_MigrateValidationTelemetryManager")||cd.Ea(ab);S.AppUnloadTelemetryManagerService.Oa()||Za.Ea(ab);I.EwaSettings.isChangeGateEnabled("OfficeVSO:8680491_MigrateRenderingFidelityTracker")||Wa.RenderingFidelityTracker.Ea(ab)})})})();String(f);String(k);String(x);String(d);String(h);String(n);String(m);String(Wa);String(u);
String(l);String(t);String(e);window.___1717508060526_closurehack=f;window.___1717508060526_closurehack=k;window.___1717508060526_closurehack=x;window.___1717508060526_closurehack=d;window.___1717508060526_closurehack=h;window.___1717508060526_closurehack=n;window.___1717508060526_closurehack=m;window.___1717508060526_closurehack=Wa;window.___1717508060526_closurehack=u;window.___1717508060526_closurehack=l;window.___1717508060526_closurehack=t;window.___1717508060526_closurehack=e},952:function(y,
r,a){a.d(r,"a",function(){return m});y=a(0);var c=a(6),b=a(78),f=a(32),k=a(189);class x{constructor(u,l){this.message=u;this.rFa=l}}Object(y.a)(x,"CrossDocumentEventArgs",null,[]);var d=a(974),h=a(291),n=a(973);class m{constructor(u,l,t,e){this._name="";this.hx={};this.gaa=null;this.ackMessageHandler=w=>{w=w.CorrelationId;""!==w&&w in this.hx&&(n.a.sendTraceTag(42783044,2,"Received Ack for Message {0} CorrelationId: {1}",this.hx[w],w),this.hx[w]="ACK_RECEIVED")};this.OYb=w=>{const z=this.cQb(w);if(!z)return!1;
if(this.im[z.MessageId])return this.yM.MHa(this.im[z.MessageId],z),!0;if(this.wn[z.MessageId]){const E=this.wn[z.MessageId];w=new x(z,w);this.yM.nTb(E,w);return!0}return!1};this.CM=[];this.qM=[];this.rM=[];this.AM=[];this.kCa=u;this.iCa=l;this.im={};this.wn={};this.yM=t;m._id++;e&&e();this.$o=this.enable()}get targetOrigin(){return this.iCa}get aNa(){return this.kCa}enable(){if(!h.a())return n.a.sendTraceTag(5018251,2,"Not supported for current browser."),!1;this.eTb();n.a.sendTraceTag(5018252,2,
"Enabled.");return!0}isEnabled(){return this.$o}eTb(){n.a.debugAssertTag(5018253,!!this.yM,null);this.gaa=this.OYb;this.yM.TSa(this.gaa,null)}disable(){this.$o=!1;this.CM=[];this.qM=[];this.rM=[];this.AM=[];this.kCa=null;this.iCa="";this.yM.hVa(this.gaa);this.im={};this.wn={}}dispose(){this.disable()}pda(u){return!!this.CM&&Array.contains(this.CM,u)||this.lIa(u)}lIa(u){return!!this.qM&&Array.contains(this.qM,u)}nl(u){n.a.debugAssertTag(5018259,!!this.CM,null);Array.add(this.CM,u);n.a.sendTraceTag(5018260,
2,"Allow receiving : {0}",u)}bSa(u){n.a.debugAssertTag(5018261,!!this.qM,null);Array.add(this.qM,u);n.a.sendTraceTag(5018262,2,"Allow free receiving: {0}",u)}YUb(u){return!!this.rM&&Array.contains(this.rM,u)}SS(u){n.a.debugAssertTag(5018263,!!this.rM,null);Array.add(this.rM,u);n.a.sendTraceTag(5018264,2,"Allow free sending: {0}",u)}hVb(u){u=b.a.getOrigin(u);return!!u&&!!this.AM&&Array.contains(this.AM,u)}pH(u){n.a.debugAssertTag(5018265,!!this.AM,null);if(u===m.sH)return n.a.debugAssertTag(5018266,
!1,null),!1;let l=b.a.getOrigin(u);if(!l)return n.a.sendTraceTag(5018267,4,"Get origin fail:{0}",u),!1;c.AFrameworkApplication.ea.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.NormalizePostMessageOrigin")&&(l=f.a.wm(l));Array.add(this.AM,l);n.a.sendTraceTag(5018268,2,"Add origin:{0}",l);return!0}send(u,l){l=void 0===l?null:l;let t=this.targetOrigin;if(l){l=b.a.getOrigin(l);if(!l)return!1;t=l}return this.T9(u,this.aNa,t)}sendMessage(u,l,t){t=(t=void 0===t?"":t)&&""!==t?t:k.a.create().toString();
return this.send(this.pea(u,l,t,c.AFrameworkApplication.userSessionId))}postMessage(u){const l=k.a.create().toString();if(!c.AFrameworkApplication.ea.ka("RetryablePostMessagingIsEnabled")||!u.Zma)return this.send(this.pea(u.messageId,u.values,l,u.userSessionId));this.im[u.Z5]||(this.nl(u.Z5),this.ik(u.Z5,this.ackMessageHandler));this.hx[l]="";return this.KKa(u,l,1)}KKa(u,l,t){if(""!==l&&l in this.hx&&"ACK_RECEIVED"===this.hx[l])return delete this.hx[l],!0;if(t>u.aL)return n.a.sendTraceTag(40716250,
4,'No retries remaining. {{"MessageId":{0}, "CorrelationId":{1}}}',u.Z5,l),delete this.hx[l],!1;n.a.sendTraceTag(40716251,1<t?4:2,'Sending postmessage. Attempts remaining {0}. {{"MessageId":{1}, "CorrelationId":{2}}}',u.aL-t,u.messageId,l);t++;window.setTimeout(()=>{this.KKa(u,l,t)},u.jmd);u.values.ackExpected=!0;return this.send(this.pea(u.messageId,u.values,l,u.userSessionId))}pea(u,l,t,e){u=new d.a(u);u.CorrelationId=t;l&&(u.Values=l);u.Values.wdUserSession=e;return u}T9(u,l,t){n.a.debugAssertTag(5018269,
!!u,null);if(!this.$o)return!1;n.a.debugAssertTag(5018270,!!l,null);n.a.debugAssertTag(5018271,!!t,null);if(!l||!t)return n.a.debugAssertTag(5018272,!1,null),!1;if(t===m.sH&&!this.YUb(u.MessageId))return n.a.sendTraceTag(5018273,1,"Got unregistered message {0}",{["id"]:u.MessageId}),!1;u.SendTime=(new Date).getTime();let e="";try{e=Sys.Serialization.JavaScriptSerializer.serialize(u)}catch(w){return n.a.sendTraceTag(5018274,4,"JSON Ser failed {0}",{["Exception"]:w.message}),!1}l=m.sendMessage(l,e,
t);n.a.sendTraceTag(5018275,2,"Send {0}. {1}",l?"succeeded":"failed",{["id"]:u.MessageId,["origin"]:t});return l}ik(u,l){n.a.debugAssertTag(5018304,!!l,null);n.a.debugAssertTag(5018305,!!this.im&&!!this.wn,null);if(!this.$o)return!1;if(!this.pda(u))return n.a.sendTraceTag(5018306,2,"Not allow receiving {0}",{["id"]:u}),!1;this.im[u]!==l&&(n.a.debugAssertTag(5018307,!this.im[u]&&!this.wn[u],null),this.im[u]=l,delete this.wn[u]);return!0}registerEventCallback(u,l){n.a.debugAssertTag(40420062,!!l,null);
n.a.debugAssertTag(40420063,!!this.wn&&!!this.im,null);if(!this.$o)return!1;if(!this.pda(u))return n.a.sendTraceTag(40420064,2,"Not allow receiving {0}",{["id"]:u}),!1;this.wn[u]!==l&&(n.a.debugAssertTag(40420065,!this.im[u]&&!this.wn[u],null),this.wn[u]=l,delete this.im[u]);return!0}YL(u){this.$o&&(this.im[u]&&delete this.im[u],this.wn[u]&&delete this.wn[u])}cQb(u){const l=new Date;this.QXb(u);if(!u.origin||!u.source||void 0===u.data||null===u.data)return n.a.sendTraceTag(5018308,4,"eventArgs missing required properties."),
null;const t=this.FWb(u.data);if(!t)return null;if(!this.hVb(u.origin)){if(!this.lIa(t.MessageId))return n.a.sendTraceTag(5018309,1,"{0}",{["id"]:t.MessageId}),null;if(u.source!==this.aNa)return n.a.sendTraceTag(5018310,4,"Received message came from a source other than the parent window."),null}n.a.debugAssertTag(5018311,!!t.Values,null);t.Values.m_Source=u.source;t.Values.m_Origin=u.origin;t.Values.m_ReceivedTime=l.getTime();return t}FWb(u){if(!u)return null;let l=null;try{l=Sys.Serialization.JavaScriptSerializer.deserialize(u,
!0)}catch(w){return 2>m.FAa&&(n.a.sendTraceTag(5018312,2,"Deser failed"),m.FAa++),null}if(!l)return n.a.debugAssertTag(5018313,!1,null),null;for(u=0;u<m.uX.length;u++)if(!l[m.uX[u]])return"MessageId"!==m.uX[u]&&n.a.sendTraceTag(41502555,2,"Cannot find required message field: {0}",m.uX[u]),null;if(l.Values)try{l.Values}catch(w){return n.a.sendTraceTag(5018314,4,"Not a valid dictionary: {0}",w.message),null}else n.a.sendTraceTag(41502556,2,"No values in message");u=l.MessageId;if(!this.pda(u))return n.a.sendTraceTag(5018315,
1,"Ignore recvd {0}",{["id"]:u}),null;const t=l.SendTime,e=(new Date).getTime()-t;if(0>t)return n.a.sendTraceTag(520435660,2,"{0}",{["t"]:t,["id"]:u}),null;6E4<e&&n.a.sendTraceTag(520435659,2,"{0}",{["t"]:t,["delta"]:e,["id"]:u});-300>e&&n.a.sendTraceTag(520435658,2,"{0}",{["t"]:t,["delta"]:e,["id"]:u});u=new d.a;u.MessageId=l.MessageId;u.SendTime=l.SendTime;u.CorrelationId=l.CorrelationId;l.Values&&(u.Values=l.Values);n.a.sendTraceTag(40640779,1,"Received message with MessageId:{0}, SendTime:{1}, CorrelationId:{2}",
u.MessageId,u.SendTime,u.CorrelationId);return u}QXb(u){n.a.sendTraceTag(5018318,1,String.format("Received: {0}",{["origin"]:u.origin,["data"]:u.data,["source"]:u.source}))}static sendMessage(u,l,t){if(!h.a())return n.a.debugAssertTag(5018319,!1,null),!1;try{return u.postMessage(l,t),!0}catch(e){n.a.sendTraceTag(5018320,4,"{0}",{["exception"]:e.message})}return!1}}m.uX=["MessageId","SendTime"];m.sH="*";m._id=0;m.FAa=0;Object(y.a)(m,"CrossDocumentMessenger",null,[4,201])},959:function(y,r,a){a.d(r,
"a",function(){return k});y=a(0);var c=a(1),b=a(65),f=a(5);class k{static yWf(x){k.$=x;c.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void b.a.resolve(f.DocumentVisibilityObserverService).then(d=>{k.df=d}):k.$.ra.Vc(291,d=>{k.df=d})}static vta(x,d){return x[Math.round((x.length-1)*d/100)]}static pI(x){return k.df?k.df.pI(x):!1}}k.df=null;k.$=null;Object(y.a)(k,"SessionStatisticsManagerHelper",null,[])},973:function(y,r,a){a.d(r,"a",function(){return c});
y=a(0);class c{static E5b(){}static kLb(){}}c.sendTraceTag=c.E5b;c.debugAssertTag=c.kLb;Object(y.a)(c,"BULS",null,[])},974:function(y,r,a){a.d(r,"a",function(){return c});y=a(0);class c{constructor(b){this.MessageId=b;this.SendTime=0;this.CorrelationId="";this.Values={}}}Object(y.a)(c,"CrossDocumentMessage",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.tm.js.map/8be1dcd1b1d3af33c084313ff15edf38/EwaTS.tm.js.map