'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[49],{1194:function(y,r,a){a.r(r);a.d(r,"FormulaBar",function(){return wb});y=a(0);var c=a(15),b=a(94),f=a(144),k=a(155),x=a(16),d=a(91),h=a(6),n=a(926),m=a(39),u=a(418),l=a(96),t=a(20),e=a(7),w=a(306),z=a(753),E=a(751),M=a(562),G=a(174),A=a(150);r=a(93);var N=a(105);class K extends N.a{constructor(Wa,Fa,Da,ja,Qa,Ob){super(Wa);this.$U=()=>{this.domElement.disabled||(this.sqc.className=this.Xsc+" "+this.Kfg)};this.ZU=
()=>{this.domElement.disabled||(this.sqc.className=this.Xsc+" "+this.NMj)};this.Cpg=Ub=>{if(!this.domElement.disabled){const Zb=Ub.keyCode;if("mousedown"===Ub.type||13===Zb||32===Zb)this.sqc.className=this.Xsc+" "+this.dfk}};this.Dpg=()=>{this.domElement.disabled||(this.sqc.className=this.Xsc+" "+this.Kfg)};this.Xsc=Da;this.Kfg=ja;this.NMj=Qa;this.dfk=Ob;this.Dd.Ea("mouseover",this.$U);this.Dd.Ea("mouseout",this.ZU);this.Dd.Ea("focus",this.$U);this.Dd.Ea("blur",this.ZU);this.Dd.Ea("mousedown",this.Cpg);
this.Dd.Ea("keydown",this.Cpg);this.Dd.Ea("mouseup",this.Dpg);this.Dd.Ea("keyup",this.Dpg);this.sqc=Fa}}Object(y.a)(K,"PseudoClassBehavior",N.a,[]);var I=a(17);class L extends r.a{constructor(Wa){super();this.instances=[];this.$=Wa}dispose(){d.a.xd(this.instances);this.instances.length=0;this.$=null;super.dispose()}unc(Wa,Fa,Da,ja,Qa){const Ob=I.DOMElementExtensions.getElementById(this.$.domElement,this.$.Oc+Wa);Wa=Wa===Fa?Ob:I.DOMElementExtensions.getElementById(this.$.domElement,this.$.Oc+Fa);if(!Ob)return null;
Da=new K(Ob,Wa,Da,ja,"",Qa);this.instances.push(Da);return Da}}L.vSh="ewa-menu-btn-hover";L.xSh="ewa-menu-btn-pressed";Object(y.a)(L,"InitializePseudoClasses",r.a,[]);var J=a(29),B=a(282),Y=a(205),U=a(134),O=a(43),C=a(25);class X{constructor(Wa,Fa){this.$=Wa;this.qd=Fa;w.a(this.$).hl(this)}get ud(){return this.qd.Za.qg}get ij(){return C.f(this.$).isEditing&&C.f(this.$).rv}get tf(){return B.a.CDf}Nj(Wa,Fa){Fa||I.DOMElementExtensions.setFocus(this.ud);return!Fa}zk(Wa){return I.DOMElementExtensions.Ki(this.ud,
Wa)}Hm(){}fo(){}dispose(){w.a(this.$).XC(this)}}Object(y.a)(X,"FormulaBarFocusManager",null,[24,4]);var S=a(286),ea=a(309),Oa=a(64),Ha=a(83),Za=a(943),fa=a(165);class la extends r.a{constructor(Wa=null,Fa,Da,ja=null){super();this.c3a=this.hkb=this.Thb=this.$Rc=null;this.QId=J.a.hs()?16:13;this.RId=J.a.hs()?16:13;this.Pmg=()=>{const Qa=new Ha.a(753860909,2,this.$.xc,2,null);this.$.Ia.Gb(Qa);return!0};this.Qmg=Qa=>Qa.Ha.keyCode===b.a.vo?(Qa=new Ha.a(753860909,1,this.$.xc,2,null),this.$.Ia.Gb(Qa),!0):
!1;this.Rmg=()=>{this.da.isEditing&&this.da.Ej.Za.Xnc();return!1};this.$=Da;this.da=C.f(Da);this.il=Fa;this.svgIconProvider=ja;J.a.hs()?this.Thb=I.DOMElementExtensions.getElementById(this.$.domElement,this.$.Oc+e.a.vOb):(this.EFi=Fa.ia(1035),this.$Rc=Wa.unc(e.a.vOb,e.a.vOb,t.a.iEf+" "+t.a.BX,t.a.h6i,""),this.Thb=this.$Rc.domElement);this.Hfj(this.Thb)}Hfj(Wa){Wa.role="button";Wa.title=this.il.ia(1035);this.hkb=this.svgIconProvider?this.svgIconProvider.hka(Za.a.DFi,this.QId,this.RId,Wa,void 0,void 0,
void 0,this.il.ia(1035)):fa.b(this.RId,this.QId,t.a.Dti,Oa.a.Lh(0),null,null,!0,this.il.ia(1035));Wa.appendChild(this.hkb);S.a.instance.va(x.a.click,Wa,this.Pmg);k.a.instance.va(x.a.nd,Wa,this.Qmg);ea.a.instance.va(x.a.Sd,Wa,this.Rmg)}dispose(){this.v7a(this.Thb);this.Thb=null;J.a.hs()||(d.a.vb(this.$Rc),this.$Rc=null);I.DOMElementExtensions.vh(this.hkb);this.c3a=this.hkb=null;super.dispose()}v7a(Wa){Wa&&(S.a.instance.Ua(x.a.click,Wa,this.Pmg),k.a.instance.Ua(x.a.nd,Wa,this.Qmg),ea.a.instance.Ua(x.a.Sd,
Wa,this.Rmg))}fdl(Wa){!this.c3a&&this.svgIconProvider&&(this.c3a=this.svgIconProvider.hka(Za.a.JFi,this.QId,this.RId,this.Thb,void 0,void 0,void 0,this.EFi))&&this.c3a.classList.add("ewa-fb-function-button-img");this.hkb&&this.c3a&&(I.DOMElementExtensions.setVisible(this.hkb,!Wa),I.DOMElementExtensions.setVisible(this.c3a,Wa))}}Object(y.a)(la,"FormulaBarFunctionControl",r.a,[]);var ba=a(332),aa=a(194),oa=a(52),Na=a(10),Ia=a(208),Sa=a(156),Pa=a(12),za=a(1);const wa=J.a.hs()?1:2;class db{constructor(Wa){this.WEa=
this.expandButton=this.UFa=this.wad=this.vad=this.uad=null;this.fIc=this.bWd=this.g8=!1;this.pbf=this.CKg=0;this.HBb=J.a.hs()?16:0;this.yWe=0;this.byc=J.a.hs()?24:Ia.c;this.jda=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8550405_ValuePreviewDismissOnScroll");this.QNc=Fa=>{this.Tzf();Fa.Ha.rawEvent.preventDefault();return!0};this.MNc=Fa=>{this.bWd=!0;this.CKg=Fa.clientPoint.y;document.body.classList.add(t.a.lvf);this.g8||(this.o4a=0);this.hgb.Ea("mousemove",this.Glg,!0);this.hgb.Ea("touchmove",this.Glg);
this.hgb.Ea("mouseup",this.q9d);this.hgb.Ea("touchend",this.q9d);this.hgb.Ea("mouseleave",this.q9d);return!0};this.q9d=()=>{this.bWd=!1;this.o4a=J.a.hs()?this.g8?this.UFa.clientHeight-this.byc:0:this.Zr.clientHeight-this.byc;document.body.classList.remove(t.a.lvf);this.hgb.XH();c.ULS.sendTraceTag(575426571,0,50,`FormulaBarResizeControl.OnDragHandlerResizeEnd formula bar drag resized to: ${this.Zr.clientHeight} pixel`)};this.Glg=Fa=>{this.bWd?(Fa=Pa.HelperMethods.kPb(Fa).y,Fa=this.hLf(this.o4a+Math.min(Fa,
this.$.domElement.clientHeight-75)-this.CKg),this.g8=Fa>=this.lineHeight,I.DOMElementExtensions.toggleCssClass(this.Zr,t.a.mvf,this.g8),Fa=this.byc+Math.round(Math.max(Fa-wa,0)),(J.a.hs()?this.UFa.clientHeight:this.Zr.clientHeight)!==Fa&&(this.Zr.style.height=Fa+"px",this.$.n4a())):c.ULS.shipAssertTag(537161935,0,!1,"FormulaBarResizeControl.OnDragHandlerResize: reached OnDragHandlerResize with isDuringResize false")};this.aV=Fa=>{this.g8&&(this.BWa=Math.round((Math.round(this.BWa/this.lineHeight)+
(0<Fa.cOa?1:-1))*this.lineHeight));Fa.Ha.preventDefault();return!1};this.kR=()=>{this.Kyk();this.fIc&&(ba.a.instance.Ua(x.a.$N,document.body,this.kR),ba.a.instance.Ua(x.a.EJa,document.body,this.kR),aa.a.instance.Ua(x.a.If,document.body,this.kR),this.fIc=!1);return!1};this.onActiveCellChanged=()=>{this.BWa=0};this.Zrg=Fa=>{this.fIc||(ba.a.instance.va(x.a.$N,document.body,this.kR),ba.a.instance.va(x.a.EJa,document.body,this.kR),aa.a.instance.va(x.a.If,document.body,this.kR),this.fIc=!0);Fa.preventDefault()};
this.onScroll=Fa=>Da=>{Fa.onScroll();this.Zrg(Da)};this.n6j=Fa=>{this.BWa=this.pbf;Fa.preventDefault()};this.$=Wa;this.hgb=Sa.a.instance.zUa(document.body.ownerDocument)}get lineHeight(){return this.HBb?this.HBb:Na.a.DDf}set lineHeight(Wa){this.HBb=Wa}get Zr(){const {FormulaBar:Wa}=a(1194);this.uad||(this.uad=Wa.XIf(this.$));return this.uad}get cyc(){this.vad||(this.vad=document.getElementById(e.a.wOb));return this.vad}get $X(){this.wad||(this.wad=document.getElementById(e.a.wOb+"_"+e.a.Qwe));return this.wad}get BWa(){return this.$X.scrollTop}set BWa(Wa){this.pbf=
Wa;this.$X.scrollTop!==Wa&&(this.$X.scrollTop=Wa)}get yEi(){return 2*this.lineHeight-wa}get o4a(){return this.yWe}set o4a(Wa){this.yWe=Wa}Tzf(){this.g8=!this.g8;I.DOMElementExtensions.toggleCssClass(this.Zr,t.a.mvf,this.g8);this.g8&&!this.o4a&&(this.o4a=this.yEi);this.Zr.style.height=this.byc+(this.g8?this.o4a:0)+"px";this.expandButton.setAttribute(e.a.oy,this.g8?"Collapse the formula bar":"Expand the formula bar");this.$.n4a();c.ULS.sendTraceTag(575426572,0,50,`FormulaBarResizeControl.OnExpandButtonClick formula bar ${this.g8?
"expanded":"collapsed"}`)}Yai(Wa){this.UFa=document.createElement("div");this.UFa.id=this.$.Oc+e.a.wId;this.UFa.className=t.a.ori;this.expandButton=db.S7h(this.$.Oc,Wa);this.UFa.appendChild(this.expandButton);this.WEa=db.p7h(this.$.Oc);this.UFa.appendChild(this.WEa);return this.UFa}Vok(){ba.a.instance.va(x.a.wt,this.expandButton,this.QNc);aa.a.instance.va(x.a.ih,this.expandButton,this.QNc);ba.a.instance.va(x.a.wt,this.WEa,this.MNc);aa.a.instance.va(x.a.ih,this.WEa,this.MNc)}Yok(Wa){ba.a.instance.va(x.a.CI,
this.cyc,this.aV);oa.a.addHandler(this.$X,x.a.scroll,this.jda?this.onScroll(Wa):this.Zrg);J.a.hs()&&oa.a.addHandler(this.$X,x.a.Ome,this.kR);oa.a.addHandler(this.$X,x.a.focus,this.n6j);C.f(this.$).ha.add_activeCellChanged(this.onActiveCellChanged)}Gal(){void 0!==this.expandButton&&null!==this.expandButton&&(ba.a.instance.Ua(x.a.wt,this.expandButton,this.QNc),aa.a.instance.Ua(x.a.ih,this.expandButton,this.QNc));void 0!==this.WEa&&null!==this.WEa&&(ba.a.instance.Ua(x.a.wt,this.WEa,this.MNc),aa.a.instance.Ua(x.a.ih,
this.WEa,this.MNc));void 0!==this.cyc&&null!==this.cyc&&ba.a.instance.Ua(x.a.CI,this.cyc,this.aV);C.f(this.$).ha.remove_activeCellChanged(this.onActiveCellChanged)}Kyk(){this.BWa=Math.round(this.hLf(this.BWa))}hLf(Wa){return Math.round(Wa/this.lineHeight)*this.lineHeight}static S7h(Wa,Fa){const Da=document.createElement("a");Da.id=Wa+e.a.BEi;Da.classList.add(t.a.fri);I.DOMElementExtensions.FG(Da,e.a.HA);Da.setAttribute(e.a.oy,"Expand the formula bar");Fa.hka(Za.a.R0h,12,12,Da,J.a.hs()?20:null,J.a.hs()?
20:null).classList.add(t.a.gri);return Da}static p7h(Wa){const Fa=document.createElement("div");Fa.id=Wa+e.a.zEi;Fa.className=t.a.eri;return Fa}}Object(y.a)(db,"FormulaBarResizeControl",null,[]);N=a(267);var Ba=a(44),Ka=a(698),da=a(191),sa=a(99),mb=a(45),Ma=a(1378);class hb{}hb.disabled="disabled";hb.q_k="stale";hb.text="text";hb.Xek="presentationMode";hb.viewMode="viewMode";Object(y.a)(hb,"NameBoxStateUpdateKey",null,[]);var $a=a(152),Va=a(167),xa=a(632),ia=a(74);class Z extends N.a{constructor(Wa,
Fa){super(document.createElement("div"));this.$=Wa;this.xg=null;this.Pwe="";this.o8k=()=>{this.$.Ia.iRb("PopulateNameBoxMenu",{menuId:"NameBox"})};this.P9d=()=>{this.IR(this.da.ha.CMf())};this.Gj=(Da,ja)=>{za.EwaSettings.isChangeGateEnabled("OfficeVSO:9015780_DisableNameBoxOnActiveSheet")&&(ia.e(this.$.la)?this.jVa(!0):this.jVa(!1));this.kma(Da,ja);this.U5b(Da,ja)};this.U5b=()=>{let Da=Ma.c(this.$,this.da);Ka.c(Da,!0)||(this.xg&&(Da=this.$.wc.getItemByName(this.xg))&&Da.deactivate(),this.IR(this.da.ha.oa.activeCell.toString()))};
this.VZb=(Da,ja)=>{var Qa,Ob,Ub,Zb,uc;!(Da=ja.la)||za.EwaSettings.isChangeGateEnabled("OfficeVSO:8137505_AvoidViewportJumpWhenScrollingNamedObject")&&(null===(Qa=ja.Vx)||void 0===Qa?void 0:Qa.name)===(null===Da||void 0===Da?void 0:Da.name)&&(null===(Ob=ja.Vx)||void 0===Ob?void 0:Ob.usedRange.top)===(null===Da||void 0===Da?void 0:Da.usedRange.top)&&(null===(Ub=ja.Vx)||void 0===Ub?void 0:Ub.usedRange.bottom)===(null===Da||void 0===Da?void 0:Da.usedRange.bottom)&&(null===(Zb=ja.Vx)||void 0===Zb?void 0:
Zb.usedRange.left)===(null===Da||void 0===Da?void 0:Da.usedRange.left)&&(null===(uc=ja.Vx)||void 0===uc?void 0:uc.usedRange.right)===(null===Da||void 0===Da?void 0:Da.usedRange.right)||(Qa=Da.usedRange,2===Da.type&&(Qa=da.a(Da)),Ob=this.da.ha.oa.vi,Ub=this.da.inRangePicker||this.da.nk,Zb=!1,2===Da.type&&Ob&&!Ub&&(Ob=this.da.ha.oa.activeRange,Zb=Da.sheetName===this.$.qa.la.name&&!!Ob&&Ob.top===Qa.top&&Ob.left===Qa.left&&Ob.bottom===Qa.bottom&&Ob.right===Qa.right),Qa=Ba.y(Qa,this.$),Qa.NamedObjectName=
Da.name,Qa.SheetName=Da.sheetName,this.da.lj(Qa,null,null,null,60,"EditableNamedObjectsDropdownList.OnActiveNamedObjectChanged",0,!0,!0,null,ja.disableAutoFocusOnGrid),ja=Ka.a(Da.name),this.IR(ja.name,ja.fullName))};this.rm=()=>{const Da=Ma.b(this.da);null!=Da&&this.IR(Da.name)};this.Bmg=(Da,ja)=>{this.P9d(Da,ja)};this.r0b=()=>{this.jVa(!0)};this.q0b=()=>{this.jVa(!1)};this.sr=()=>{za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableNameBoxInViewMode",!1)?this.cdl(!this.$.isEditMode):
this.jVa(!this.$.isEditMode)};this.zpg=()=>{mb.a(this.$).NI($a.a.CEi,Va.a.Hd)};this.bV=(Da,ja)=>{this.ORg(ja.DJ)};this.onKeyDown=Da=>Da.Ha.keyCode===b.a.QNa?(this.da.focus(),!0):!1;this.kma=()=>{this.k3c({[hb.q_k]:!0})};this.da=C.f(Wa);this.Rgj(Fa);za.EwaSettings.isChangeGateEnabled("OfficeVSO:8749712_AppendNameBoxStateDuringInit")||(this.IR(za.EwaSettings.isChangeGateEnabled("OfficeVSO:8749724_StartNameBoxWithNamedObjectIfExists")?this.da.ha.NNd():this.da.ha.oa.activeCell.toString(),"",!0),this.jVa(!za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableNameBoxInViewMode",
!1)&&!this.$.isEditMode));this.ORg(mb.a(this.$).ks());this.Aj();k.a.instance.va(x.a.nd,this.domElement,this.onKeyDown.bind(this))}get text(){return za.EwaSettings.isChangeGateEnabled("OfficeVSO:8654931_readNameBoxTextFromReact")?appChrome.getNameBoxText():this.Pwe}get isEnabled(){return appChrome.isNameBoxEnabled()}dispose(){if(this.$){this.$.Mb.WHg(this.r0b.bind(this));this.$.Mb.VHg(this.q0b.bind(this));this.$.fa&&this.$.fa.pV(this.sr.bind(this));var Wa=sa.a(this.$);Wa&&(Wa.ZTc(this.Bmg.bind(this)),
Wa.aje(this.rm.bind(this)));(Wa=mb.a(this.$))&&Wa.hg.Mea(this.bV.bind(this));this.$.fa&&this.$.wc&&(this.$.wc.xh(this.VZb.bind(this)),this.$.wc.cUc(this.U5b.bind(this)),this.$.wc.cUc(this.fEg.bind(this)),this.$.wc.y9(this.kma.bind(this)),this.$.wc.zxa(this.kma.bind(this)),this.$.wc.Axa(this.kma.bind(this)),this.$.wc.w3b(this.kma.bind(this)));this.$.qa&&this.$.qa.xh(this.Gj.bind(this))}this.da&&(Wa=this.da.ha,Wa.z9(this.U5b.bind(this)),Wa.qV(this.P9d.bind(this)),Wa.ob.yL(this.rm.bind(this)));super.dispose()}bdl(Wa){this.k3c({[hb.Xek]:Wa})}cdl(Wa){this.k3c({[hb.viewMode]:Wa})}Rgj(Wa){const Fa=
document.getElementById(this.$.Oc+e.a.EDf);void 0!==Fa&&null!==Fa&&Wa.removeChild(Fa);appChrome.renderNameBoxUI(this.domElement,this.QVi(),this.o8k.bind(this));Wa.insertBefore(this.domElement,Wa.firstChild)}QVi(){return za.EwaSettings.isChangeGateEnabled("OfficeVSO:8749712_AppendNameBoxStateDuringInit")?{[hb.disabled]:xa.a.tre(this.$),[hb.text]:za.EwaSettings.isChangeGateEnabled("OfficeVSO:8749724_StartNameBoxWithNamedObjectIfExists")?this.da.ha.NNd():this.da.ha.oa.activeCell.toString()}:{}}Aj(){this.$.Mb.j5e(this.r0b.bind(this));
this.$.Mb.i5e(this.q0b.bind(this));this.$.fa.XS(this.sr.bind(this));const Wa=this.da.ha;this.$.wc.mh(this.VZb.bind(this));this.$.qa.mh(this.Gj.bind(this));Wa.Qaa(this.U5b.bind(this));Wa.YS(this.P9d.bind(this));Wa.ob.pF(this.rm.bind(this));sa.a(this.$).Yod(this.rm.bind(this));sa.a(this.$).plc(this.Bmg.bind(this));mb.a(this.$).hg.Cha(this.bV.bind(this));this.$.wc.tlc(this.U5b.bind(this));this.$.wc.tlc(this.fEg.bind(this));this.$.wc.i0(this.kma.bind(this));this.$.wc.sqa(this.kma.bind(this));this.$.wc.tqa(this.kma.bind(this));
this.$.wc.Tbb(this.kma.bind(this))}ORg(Wa){this.jVa(Wa||xa.a.tre(this.$));Wa?this.domElement.addEventListener("pointerdown",this.zpg):this.domElement.removeEventListener("pointerdown",this.zpg);this.b6k(Wa)}b6k(Wa){for(let Fa=0;Fa<this.domElement.children.length;Fa++)this.domElement.children[Fa].style.pointerEvents=Wa?"none":""}IR(Wa,Fa="",Da=!1){this.Pwe=Wa;this.xg=""!==Fa?Fa:this.xg;appChrome.setNamedObjectOrActiveCellRange(Fa,Wa,Da)}jVa(Wa){this.k3c({[hb.disabled]:Wa})}fEg(Wa,Fa){Ma.a(this.$,!0);
this.kma(Wa,Fa)}k3c(Wa){appChrome.updateNameBoxState(Wa)}}Object(y.a)(Z,"NameBox",N.a,[4]);var ta=a(173),pa=a(114);const Ga=t.a.Sig+" "+t.a.BX,Ca=t.a.Pcf+" "+t.a.BX;class kb extends r.a{constructor(Wa=null,Fa,Da,ja){super();this.jIb=this.RZb=this.kIb=this.SZb=this.UJ=this.gL=null;this.bBb=this.OTe=this.DN=this.KHc=!1;this.VEg=()=>{this.da.VP.Jp(this.Nh);this.da.VP.Uq(this.wg);this.KHc=!0};this.Nh=()=>{this.W2g(!0)};this.wg=()=>{this.W2g(!1)};this.iqg=Ob=>this.tNc(!0,`OkCancelEditControl.OnOkClick: ${Ob.Yb}`,
Pa.HelperMethods.mv(Ob));this.jqg=Ob=>this.tNc(!0,`OkCancelEditControl.OnOkKeyDown: ${Ob.Yb}`);this.Vjg=Ob=>this.tNc(!1,`OkCancelEditControl.OnCancelClick: ${Ob.Yb}`,Pa.HelperMethods.mv(Ob));this.Yjg=Ob=>this.tNc(!1,`OkCancelEditControl.OnCancelKeyDown: ${Ob.Yb}`);this.uE=()=>{this.a6k(!this.$.isEditMode)};this.onPointerDown=()=>{this.da.isEditing&&(this.da.Ej.Za.mI=!0);return!1};const {FormulaBar:Qa}=a(1194);this.$=Da;this.da=C.f(Da);this.DN=J.a.DN();ja?(this.SZb=ja.KXa(Za.a.qef,16),this.kIb=ja.KXa(Za.a.Tei,
16),J.a.hs()||(this.RZb=ja.KXa(Za.a.eYh,16),this.jIb=ja.KXa(Za.a.Uei,16),this.SZb.style.display="none",this.kIb.style.display="none")):(this.SZb=fa.b(16,16,t.a.sti,Oa.a.Lh(1),null,null,!0,Fa.ia(1041)),this.kIb=fa.b(16,16,t.a.xti,Oa.a.Lh(1),null,null,!0,Fa.ia(1042)));J.a.hs()?(this.gL=I.DOMElementExtensions.getElementById(this.$.domElement,this.$.Oc+Qa.cNc),this.UJ=I.DOMElementExtensions.getElementById(this.$.domElement,this.$.Oc+Qa.Zoc)):(this.r8d=Wa.unc(Qa.cNc,Qa.cNc,Ga,"",""),this.gL=this.r8d.domElement,
this.bud=Wa.unc(Qa.Zoc,Qa.Zoc,Ca,"",""),this.UJ=this.bud.domElement);this.gL.appendChild(this.SZb);this.UJ.appendChild(this.kIb);J.a.hs()?(this.gL.classList.add(t.a.v6),this.UJ.classList.add(t.a.v6),this.bBb=!this.$.isEditMode,I.DOMElementExtensions.toggleCssClass(this.gL,t.a.tFa,this.bBb),I.DOMElementExtensions.toggleCssClass(this.UJ,t.a.tFa,this.bBb)):(this.gL.appendChild(this.RZb),this.UJ.appendChild(this.jIb));this.da.cellTextEditBox.Jp(this.Nh);this.da.cellTextEditBox.Uq(this.wg);J.a.hs()&&Da.fa.CD(this.uE);
S.a.instance.va(x.a.click,this.gL,this.iqg);k.a.instance.va(x.a.nd,this.gL,this.jqg);ea.a.instance.va(x.a.Sd,this.gL,this.onPointerDown);S.a.instance.va(x.a.click,this.UJ,this.Vjg);k.a.instance.va(x.a.nd,this.UJ,this.Yjg);ea.a.instance.va(x.a.Sd,this.UJ,this.onPointerDown);this.DN&&this.da.yDh(this.VEg)}get X8(){return this.OTe}get isEwaDisabled(){return this.bBb}dispose(){this.da&&this.da.cellTextEditBox&&(this.da.cellTextEditBox.zp(this.Nh),this.da.cellTextEditBox.gq(this.wg));this.da&&this.DN&&
(this.da.xsk(this.VEg),this.KHc&&(this.da.VP.zp(this.Nh),this.da.VP.gq(this.wg),this.KHc=!1));this.gL&&(S.a.instance.Ua(x.a.click,this.gL,this.iqg),k.a.instance.Ua(x.a.nd,this.gL,this.jqg),ea.a.instance.Ua(x.a.Sd,this.gL,this.onPointerDown),this.gL=null);this.UJ&&(S.a.instance.Ua(x.a.click,this.UJ,this.Vjg),k.a.instance.Ua(x.a.nd,this.UJ,this.Yjg),ea.a.instance.Ua(x.a.Sd,this.UJ,this.onPointerDown),this.UJ=null);J.a.hs()||(d.a.vb(this.r8d),this.r8d=null,d.a.vb(this.bud),this.bud=null);J.a.hs()&&this.$&&
this.$.fa.xB(this.uE);J.a.hs()||(I.DOMElementExtensions.vh(this.jIb),this.jIb=null,I.DOMElementExtensions.vh(this.RZb),this.RZb=null);super.dispose()}a6k(Wa){Object(pa.d)(()=>{this.gL&&this.UJ&&(I.DOMElementExtensions.toggleCssClass(this.gL,t.a.tFa,Wa),I.DOMElementExtensions.toggleCssClass(this.UJ,t.a.tFa,Wa));this.bBb=Wa},this.$.Aa)}tNc(Wa,Fa,Da=null){const ja=this.da.Ej;if(Da){const Qa=this.da.rv?"formulaBar_end_edit_ok_cancel_btn":"cell_text_end_edit_ok_cancel_btn";let Ob;Ob=[Object(ta.a)(this.da.cellTextEditBox.Za.gNa)];
ta.b(this.$).kq(Da.rawEvent,Qa,Ob)}this.KHc&&this.da.VP.mK?this.da.VP.endEdit(Wa,Fa,0):ja.endEdit(Wa,Fa,0);this.da.focus();return!0}W2g(Wa){if(J.a.hs())Wa?(this.gL.classList.remove(t.a.v6),this.UJ.classList.remove(t.a.v6)):(this.gL.classList.add(t.a.v6),this.UJ.classList.add(t.a.v6));else{const Fa=Wa?"block":"none",Da=Wa?"none":"block";this.SZb.style.display=Fa;this.kIb.style.display=Fa;this.RZb.style.display=Da;this.jIb.style.display=Da}this.OTe=Wa}}Object(y.a)(kb,"OkCancelEditControl",r.a,[]);var eb=
a(334),Yb=a(347),Gb=a(71),Mb=a(209),Rb=a(13),$b=a(330),cc=a(233),fb=a(333),Sb=a(151),kc=a(162),na=a(40),fc=a(434),Cc=a(186),tc=a(159),nb=a(321),tb=a(5),La=a(65);class wb extends u.a{constructor(Wa,Fa,Da=null){super(C.f(Wa));this.fna=Fa;this.AMe=this.TA=this.clearContentNotifier=this.nameBox=this.Zr=this.g2g=null;this.hCe=!1;this.$X=null;this.DVg=this.O2f=this.wFc=this.Atd=this.ACc=!1;this.jda=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8550405_ValuePreviewDismissOnScroll");this.ouj=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8614675_partialInteractivityFormulaBar");
this.Nh=()=>{this.hCe=!1;this.Ppe();this.wFc&&this.u9b(!this.M0f)};this.wg=()=>{this.Ppe();this.wFc&&this.u9b(!1)};this.u9b=(ja,Qa=!1)=>{if(wb.ita&&this.Atd!==ja){if(J.a.hs()){const Ob=()=>{wb.ita&&(I.DOMElementExtensions.toggleCssClass(wb.ita,t.a.tFa,ja),I.DOMElementExtensions.toggleCssClass(wb.ita,t.a.v6,ja))};za.EwaSettings.isChangeGateEnabled("OfficeVSO:8976373_DisableFunctionInCurrentFrame")?Ob():Qa?Ob():Object(pa.d)(()=>{Ob()},this.$.Aa)}else I.DOMElementExtensions.toggleCssClass(wb.ita,t.a.v6,
ja);this.Atd=ja}};this.Ctg=()=>{this.isEditing||this.Za.disabled||this.startEdit(!0,!1,null)};this.Zp=()=>{this.tMa()};this.bV=(ja,Qa)=>{this.tMa();wb.ita&&(Qa.DJ?this.ouj?this.u9b(!0):wb.ita.classList.add(t.a.v6):this.$lc())};this.wu=(ja,Qa)=>{ja=this.grid;this.hCe=!0;this.isEditing?(this.MUb||(Qa.AFc||this.eW(null),this.raiseEvent(u.a.rIb,Qa)),this.MUb||ja.cellTextEditBox.Za.isCursorAttached()&&!this.Za.isCursorAttached()&&ja.cellTextEditBox.Za.clearCursorFormatLocation()):ja.isEditing&&this.tMa()};
this.onBlockCacheItemChanged=(ja,Qa)=>{(ja=this.grid.ha.oa.activeCell)&&(Qa=this.grid.fJ(Qa.he.hash))&&ja.ld(Qa.Fd)&&this.tMa()};this.G$d=(ja,Qa)=>{-185374993===Qa.command&&this.tMa()};this.onActiveItemChanged=()=>{this.tMa();O.TaskExtensions.tb(Y.a(this.$.ra),()=>{this.jRg()},this.Aa,11)};this.mWa=()=>{this.jRg();J.a.plb()?this.fna.F9k(this.IRi()):(na.a.instance.BZ(e.a.I1,nb.a.c9b),na.a.instance.uV(e.a.I1,nb.a.c9b));na.a.instance.D9(e.a.I1,nb.a.$af)};this.onKeyDown=ja=>{if(ja.Ha.keyCode===b.a.JB){var Qa=
this.vGa();const Ob=I.DOMElementExtensions.Fz(Qa);Qa=I.DOMElementExtensions.A7(Qa);return I.DOMElementExtensions.n5a(ja.Ha,Ob,Qa)}return!1};this.uE=()=>{this.$lc()};this.kij=()=>{if(this.Zr){var ja=()=>{this.nameBox=new Z(this.$,this.Zr);this.exk()};za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DeferNameBoxInitializationUntilAppChromeIsReady",!1)?f.a.get_instance().Mg(7,ja):ja()}else this.gxk()};this.AMe=new db(Wa);this.initialize(this.ipe(Wa,Da));this.AWa.Vok();this.EVd=za.EwaSettings.isChangeGateEnabled("OfficeVSO:5160311_CrossBookCrossSheetDataBookPickerOverlay");
this.vH=new eb.a(this.Zr,1);this.Xqj=za.EwaSettings.isChangeGateEnabled("OfficeVSO:6148798_FormulaBarCrossSessionPicker");J.a.hs()&&za.EwaSettings.isChangeGateEnabled("OfficeVSO:8773064_FormulabarRemovePseudoClass")?(this.uId=new la(void 0,Rb.a.instance,Wa,Da),this.dNc=new kb(void 0,Rb.a.instance,Wa,Da)):(this.aEc=new L(Wa),this.aEc.unc(e.a.U2g,e.a.U2g,e.a.Y5k+" cui-TabRowRight",L.vSh,L.xSh),this.uId=new la(this.aEc,Rb.a.instance,Wa,Da),this.dNc=new kb(this.aEc,Rb.a.instance,Wa,Da));this.g2g=Cc.c(()=>
{this.KSg()},1,this.$.Aa,"FormulaBar.setTextBoxForActiveItem",!0);Wa.qa.mh(this.onActiveItemChanged);Fa=this.grid;Fa.cellTextEditBox.Jp(this.Nh);Fa.cellTextEditBox.Uq(this.wg);Fa.cellTextEditBox.lSa(this.wu);Fa.KJ(this.Zp);Fa.za.$t(this.onBlockCacheItemChanged);Fa.za.qqa(this.onBlockCacheItemChanged);Fa.Flc(this.G$d);mb.a(Wa).hg.Cha(this.bV);Wa.fa.CD(this.uE);sa.a(Wa).Yod(this.Zp);za.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&(za.EwaSettings.isChangeGateEnabled("OfficeVSO:9011101_RemoveServiceNameClearContentNotifier")?
void La.a.Bd(tb.ClearContentNotifierService).then(ja=>{this.clearContentNotifier=ja;this.clearContentNotifier.wFb(this.wu)}):Wa.ra.Vc(313,ja=>{this.clearContentNotifier=ja;this.clearContentNotifier.wFb(this.wu)}));k.a.instance.va(x.a.nd,this.ud,this.onKeyDown);Fa=this.Za.style;$b.c(Fa,Wa.isChromeRtl,"0px");Fa.textAlign=this.bZf?"right":"left";this.isVisible=!1;this.EVd&&(this.Za.isVisible=!1);Fa=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8654712_PopulateFBTextBoxBeforeCommandUIAttach");Fa||(G.a(this.$).OCa(this.mWa),
this.$.fa.ska&&(c.ULS.sendTraceTag(537161948,0,50,"FormulaBar: CommandUI already generated when registering to: OnCommandUIAttachCompleted"),this.mWa(null,null)));za.EwaSettings.isChangeGateEnabled("OfficeVSO:8605252_FormulaBarInitStateFix")?this.KSg():this.tMa();za.EwaSettings.isChangeGateEnabled("OfficeVSO:8740111_setDisabledModeSyncInFormulaBarInit")?this.$lc(!0):this.$lc();this.Za.$Ug=!0;this.kij();w.a(Wa).hl(this);this.Za.l4e(this.Ctg);this.MUb=!1;this.TA=new X(this.$,this);this.wgj();Fa&&(za.EwaSettings.rUb()?
this.TBk():this.UBk());this.Za.mba(()=>{na.a.instance.D9(e.a.I1,nb.a.K1g);this.toggleEditingEvents(!1)});this.wFc=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8106214_disableFunctionButtonV2")}set text(Wa){this.isEditing?this.Za.setPlainText(Wa):super.text=Wa}get isEditing(){return super.isEditing}set isEditing(Wa){super.isEditing=Wa;this.toggleEditingEvents(Wa)}get M0f(){return this.FDc||0>=this.text.length}get I8b(){return!0}get formattedText(){return this.Za.getFormattedText()}set formattedText(Wa){this.Za.setFormattedText(Wa)}get kUb(){return this.isEditing}get isVisible(){return I.DOMElementExtensions.isVisible(this.Zr)}set isVisible(Wa){this.EVd?
I.DOMElementExtensions.setVisible(this.Zr,Wa):(I.DOMElementExtensions.setVisible(this.Zr,Wa),this.Za.isVisible=Wa)}get ud(){return this.Zr}get ij(){return this.isVisible}get tf(){return B.a.vId}get AWa(){return this.AMe}Nj(Wa,Fa){Wa=!1;Fa||(Wa=this.KDi());return Wa}dispose(){const Wa=this.$;if(Wa){Wa.qa.xh(this.onActiveItemChanged);var Fa=this.grid;Fa.cellTextEditBox.zp(this.Nh);Fa.cellTextEditBox.gq(this.wg);Fa.cellTextEditBox.a4a(this.wu);Fa.xL(this.Zp);Fa.za.yu(this.onBlockCacheItemChanged);Fa.za.esb(this.onBlockCacheItemChanged);
mb.a(this.$).hg.Mea(this.bV);Wa.fa.xB(this.uE);sa.a(Wa).aje(this.Zp);Fa=G.a(this.$);k.a.instance.Ua(x.a.nd,this.ud,this.onKeyDown);this.AWa.Gal();Fa&&Fa.e4a(this.mWa);w.a(Wa).XC(this);za.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&(this.clearContentNotifier&&this.clearContentNotifier.q3b(this.wu),za.EwaSettings.isChangeGateEnabled("OfficeVSO:9011101_RemoveServiceNameClearContentNotifier")||Wa.ra.HEa(313))}this.Za&&this.Za.fHg(this.Ctg);d.a.xd([this.vH,
this.uId,this.dNc,this.aEc,this.nameBox]);d.a.vb(this.TA);this.Zr&&(I.DOMElementExtensions.HH(this.Zr),this.Zr.className="");c.ULS.sendTraceTag(537161946,0,50,"FormulaBar.Dispose: setting this.formulaBarElement to null");this.Zr=null;super.dispose()}endEdit(Wa,Fa,Da,ja=null){this.Za.addEventLogRecord("FormulaBar.EndEdit",{["Commit"]:Wa,["Caller"]:Fa});this.vvb(!1);if(this.isEditing){var Qa=null;ja&&(Qa=this.$.shortcutKeyManager.yy(ja));var Ob=this.grid.Rb;this.isEditing=!1;this.VJ(!0);this.umb()&&
this.grid.SD&&this.grid.SD.Nhb&&this.grid.SD.Ctb(e.a.uSb);if(Wa){var Ub=new z.a(this.grid.ha.oa.activeCell,Ob.text,Ob.text,!1,this.grid.$.qa.la);this.tBg(Ub);null!==Ub&&(Ob.text=Ub.newValue)}else this.Za.setPlainText(this.text);Ub=new E.a(this.grid.ha.oa.activeCell,Ob.text,Wa,ja);this.hfe(Ub);Ob.endEdit(Wa,`${Fa}->FormulaBar.EndEdit`,Da,ja);this.r5f(Qa)||Ob.Za.focus();this.Za.x8b("FormulaBar.EndEdit")}else this.Za.x8b("FormulaBar.EndEdit",{["IsEditing"]:"false"})}tja(Wa,Fa,Da,ja=!0,Qa=!0){super.tja(Wa,
Fa,Da,ja,Qa);this.grid.Rb.tja(Wa,Fa,Da,ja,Qa)}rzg(Wa){const Fa=this.grid.Rb,Da=this.Za.selection;Da.length&&Fa.tja(Da.index,Da.length,Wa,!1,!1)}zk(Wa){return I.DOMElementExtensions.Ki(this.Zr,Wa)}Hm(){h.AFrameworkApplication.ua.hh.Bp(this.tf)}fo(){}O7g(Wa){this.nameBox.bdl(Wa);this.uId.fdl(Wa)}BAe(){if(this.$X){var Wa=Object(tc.g)(this.text);this.ACc!==Wa&&(this.LSg(Wa),this.ACc=Wa)}}H8d(){this.Za.addEventLogRecord("FormulaBar.OnAutoCompleteCommandHandled");const Wa=this.grid.Rb;Wa.isEditing&&this.isEditing&&
(Wa.formattedText=this.formattedText,Wa.setCaretPosition(this.Za.caretPosition))}h0b(Wa){this.Za.disabled||(this.grid.cellTextEditBox.Za.mI=!0,this.isEditing||this.startEdit(!1,!0,Wa),this.mra())}Kpb(){this.oV&&(this.FS=this.Za.caretPosition,this.P_=this.Za.Mma.length);this.eW(null);this.wma();this.n5g()}Iwa(Wa){var Fa=this.$.shortcutKeyManager.yy(Wa);const Da=this.MUb;1872288872===Fa||125627505===Fa||267796030===Fa?super.Iwa(Wa):Da?Gb.g(Wa):this.isEditing&&this.grid.Rb.isEditing&&(Fa=this.grid.Rb,
Fa.formattedText=this.formattedText,Fa.setCaretPosition(this.Za.caretPosition),this.P2c(),0===this.Za.selection.length&&this.eW(null,null),this.Xqj&&this.inRangePicker&&this.Iue(),super.Iwa(Wa))}Nd(Wa,Fa){this.isEditing&&super.Nd(Wa,Fa)}Hw(Wa,Fa){this.isEditing&&super.Hw(Wa,Fa)}UBk(){this.$.fa.ska?(c.ULS.sendTraceTag(507585433,0,50,"FormulaBar: CommandUI already generated when registering to: OnCommandUIAttachCompleted"),this.mWa(null,null)):G.a(this.$).OCa(this.mWa)}TBk(){this.$.fa.Tkb?this.mWa(null,
null):this.$.fa.ZEb(()=>this.mWa(null,null))}wgj(){const Wa=this.grid.Ob(void 0);Wa?(this.ACc=Wa.Jx||Object(tc.g)(Wa.text),this.LSg(this.ACc)):c.ULS.sendTraceTag(509720320,0,50,"FormulaBar.initTextElementStyles: failed to get active cell")}LSg(Wa){I.DOMElementExtensions.toggleCssClass(this.$X,t.a.sEd,Wa)}ipe(Wa,Fa){this.Zr=wb.XIf(Wa);this.Zr.classList.add(t.a.kri);this.Zr.classList.add(t.a.ovf);J.a.hs()&&this.Zr.classList.add(t.a.hri);const Da=this.AWa.Yai(Fa);Fa=wb.Nzd();Da.appendChild(Fa);wb.ita=
wb.X7h(Wa.Oc);const ja=wb.R7h(),Qa=wb.I9h(Wa.Oc),Ob=wb.H9h(Wa.Oc),Ub=wb.n6h(Wa.Oc);Ob.tabIndex=-1;Ub.tabIndex=-1;Qa.appendChild(Ub);Qa.appendChild(Ob);Qa.appendChild(wb.ita);ja.appendChild(Qa);ja.appendChild(Da);Wa=wb.k9h(Wa.Oc);this.Zr.appendChild(Wa);this.Zr.appendChild(ja);const Zb=new fb.a(Fa,!0,!1);this.$X=Fa;this.AWa.lineHeight=Zb.JRi();Zb.mba(()=>{fc.c(Zb.qg,n.a.ariaLabel,"formula bar")});Zb.mba(()=>{this.AWa.Yok(this.jda?{onScroll:()=>this.jfe()}:{})});Zb.isVisible=!1;return Zb}p2a(Wa){this.nSc(Wa);
super.p2a(Wa);Sb.b(this.$).Jd(A.a.JEi,{["Location"]:"canvas"});m.a.mi&&window.focus();const Fa=this.$.shortcutKeyManager.yy(Wa);this.lfk(Wa,Fa);this.Za.disabled||this.isEditing||this.startEdit(!0,!1,Wa);let Da;Da={};Da.wasEditing=this.isEditing;Da.formulaBar=!0;let ja=this.Ok(Wa,Fa);!ja&&Mb.d(Fa,this.Llb,!0)&&(ja=this.r5f(Fa)?!0:this.grid.ha.Ok(Wa,Fa,Da));ja||kc.a(this.$).w3d(Wa,0,7)}startEdit(Wa,Fa,Da){const ja=this.grid;if(!this.isEditing||!ja.isEditing){this.Za.x8b("FormulaBar.StartEdit");this.Za.addEventLogRecord("FormulaBar.StartEdit",
{["SetCaretPositionToEnd"]:Wa,["IsOnMouseDown"]:Fa});Sb.b(ja.$).Jd(A.a.IEi,{["Location"]:"canvas"});this.isEditing=this.MUb=!0;ja.Nw&&ja.Nw.nXc(this);ja.cellTextEditBox.VJ(!1);ja.cellTextEditBox.Ike();this.Bpe(!1);var Qa=()=>{var Ob=ja.$.qa.la;const Ub=ja.Ob(null);Ob=new M.a(Ub,Ob,void 0,void 0,void 0,this.gMd(Ub));this.ife(Ob);this.f6b(ja.cellTextEditBox.Za.pK);Ob=()=>{if(this.isEditing&&ja.isEditing){ja.isEditing&&ja.cellTextEditBox.Za.detachCursorFormat();if(!this.eW(null)){const uc=ja.cellTextEditBox.formattedText;
var Zb=this.Za.caretPosition;const Hc=uc.Text.length;Zb=this.Za.text.length!==Hc?Hc:Zb;this.formattedText=uc;this.Za.caretPosition=Zb}this.MUb=!1;this.Za.clearHistory()}else this.isEditing=!1};za.EwaSettings.isChangeGateEnabled("OfficeVSO:9025873_UsePostTaskHelperInFormulaBarStartEdit")?void Object(pa.c)(Ob,{priority:"background"}):setTimeout(Ob,0);ja.cellTextEditBox.iKg()};if(ja.isEditing)ja.ZH=1,Qa();else if(this.Za.mI=!0,O.TaskExtensions.tb(ja.startEdit(!1,1,Da,!1,void 0,Fa,1),Ob=>{Ob.result?(ja.isEditing||
(this.Za.addErrorLogRecord("FormulaBar.StartEdit","tag_cnkc7"),c.ULS.sendTraceTag(37003425,0,10,"FormulaBar.StartEdit: grid.IsEditing is false after calling grid.StartEdit. Stack=")),this.isEditing&&ja.isEditing?(ja.cellTextEditBox.Za.mI=!0,Ob=ja.Ob(null),this.Za.aDf(Number.NaN,this.gMd(Ob)),Wa&&this.Za.setCaretPositionToEnd(),Qa()):this.isEditing=!1):this.isEditing=!1},this.Aa,11),this.Za.mI=!1,Fa=ja.Ob(null),null===Fa||void 0===Fa?0:Fa.sXd)this.Za.addEventLogRecord("FormulaBar.StartEditStripOutLegacyArrayCurlyBraces"),
this.text=Pa.HelperMethods.D_g(this.text)}}vQd(Wa){super.vQd(Wa);this.wFc&&this.grid&&this.grid.isEditing&&2===Wa&&this.u9b(!this.M0f)}onActiveCellChanged(Wa,Fa){super.onActiveCellChanged(Wa,Fa);this.Ppe()}A5a(Wa){za.EwaSettings.isChangeGateEnabled("OfficeVSO:7549189_logsForNullTextboxInvestigation")&&c.ULS.sendTraceTag(509445518,0,50,`FormulaBar.set_textBox: Setting the text box for the formula bar, textBox defined: ${!!Wa}`);super.A5a(Wa)}Ppe(){const Wa=this.grid;Wa.isEditing&&2===Wa.ZH||this.tMa()}ph(){var Wa=
this.grid;this.isEditing&&Wa.isEditing&&(Wa=Wa.Rb,Wa.text=this.text,Wa.setCaretPosition(this.Za.caretPosition),this.inRangePicker&&this.Za.focus())}tMa(){this.g2g()}jNk(){if(this.Za){var Wa=this.grid;this.Za.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal",{["IsEditing"]:this.isEditing,["TextBox.Initialized"]:this.Za.initialized,["Grid.IsEditing"]:Wa.isEditing});if(!this.isEditing){var Fa=mb.a(this.$).ks();this.Zr.disabled=Fa||!this.$.isEditMode;var Da=(Fa=this.$.sT===Wa)&&1===Wa.ha.gf;
this.Za.initialized&&(this.Za.disabled=this.Zr.disabled||Fa&&!Da);Fa=new cc.a(this.Za.style);var ja=!1;if(Da)if(Wa.isEditing)this.Za.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["ActiveCellContents"]:"CellTextEditBox.Text"}),Da=Wa.cellTextEditBox.text;else{ja=Wa.Ob(null);Da=new U.SheetProtection(this.$.qa);if(!ja||!Da.omb(ja.range,Wa))return;Wa=Da.Ih;Da=ja.isHidden;var Qa=ja.formulaBarText;const Ob=ja.text;this.Za.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",
{["sheetProtection.IsLocked"]:Wa,["activeCell.IsHidden"]:Da,["activeCell.FormulaBarText"]:!!Qa,["activeCell.Text"]:!!Ob});Da=Wa&&Da?"":Qa||Ob;ja=ja.$se}else Da="",Qa=Wa.ha.ob.Wb,Qa=(null===Qa||void 0===Qa?0:Qa.floatingObject)?Qa.floatingObject.Sb:null,64===Wa.ha.gf&&Qa&&Qa.IsShapeFormulaPresent&&((Wa=(Wa=Qa.ShapeText)?Wa.substring(Wa.indexOf(xa.a.dyc)+xa.a.dyc.length,Wa.indexOf(xa.a.ODf)):null)?(this.Za.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["ActiveCellContents"]:"ShapeFormula"}),
Da="="+Wa):c.ULS.sendTraceTag(537161938,0,15,"FormulaBar.setTextBoxForActiveItemInternal: IsShapeFormulaPresent is true but formula not found in shapeText"));this.Bpe(ja);this.YAb=this.Noc();Fa.dz.direction=this.t2?l.a.rtl:l.a.R0a;Fa.dz.textAlign=this.t2?l.a.right:l.a.left;J.a.hs()&&I.DOMElementExtensions.toggleCssClass(this.$X,t.a.Avc,this.t2);Fa.q0();this.text=Da}}}KSg(){if(!za.EwaSettings.isChangeGateEnabled("OfficeVSO:8759863_SetTextBoxForActiveItemInternalRefactor"))this.jNk();else if(this.Za){var Wa=
this.grid;this.Za.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal",{["IsEditing"]:this.isEditing,["TextBox.Initialized"]:this.Za.initialized,["Grid.IsEditing"]:Wa.isEditing});if(!this.isEditing){var Fa=mb.a(this.$).ks();this.Zr.disabled=Fa||!this.$.isEditMode;Fa=this.$.sT===Wa;this.Za.initialized&&(this.Za.disabled=this.Zr.disabled||Fa&&!Wa.jXd);if(Wa=xa.a.wbf(Wa))this.iNk(Wa.eta),this.Bpe(Wa.VV),this.YAb=this.Noc(),Fa=new cc.a(this.Za.style),Fa.dz.direction=this.t2?l.a.rtl:l.a.R0a,
Fa.dz.textAlign=this.t2?l.a.right:l.a.left,J.a.hs()&&I.DOMElementExtensions.toggleCssClass(this.$X,t.a.Avc,this.t2),Fa.q0(),this.text=Wa.eta}}}iNk(Wa){if(this.grid.jXd)if(this.grid.isEditing)this.Za.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["ActiveCellContents"]:"CellTextEditBox.Text"});else{Wa=new U.SheetProtection(this.$.qa);const Fa=this.grid.Ob(null);this.Za.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["sheetProtection.IsLocked"]:Wa.Ih,
["activeCell.IsHidden"]:Fa.isHidden,["activeCell.FormulaBarText"]:!!Fa.formulaBarText,["activeCell.Text"]:!!Fa.text})}else Wa&&64===this.grid.ha.gf&&this.Za.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["ActiveCellContents"]:"ShapeFormula"})}IRi(){return{formulaBarText:this.text,lU:this.lU(),GIa:this.t2,VV:this.DVg,X8:this.dNc.X8,jta:!this.Atd,VFa:!this.$.isEditMode,TJa:this.dNc.isEwaDisabled,uva:!this.$.isEditMode}}jRg(){var Wa=this.$.sT;if(this.EVd){var Fa=
!!this.grid.VP&&this.grid.VP.mK;this.isVisible=Wa=!!Wa&&this.$.xId&&!this.$.fa.$b.inEmbedView;Fa||(this.Za.isVisible=Wa)}else this.isVisible=!!Wa&&this.$.xId&&!this.$.fa.$b.inEmbedView;if(Fa=document.getElementById("AdditionalBarsRegion"))Fa.style.height="",this.$.tY()&&(Fa=document.getElementById("RibbonRegion"),!this.O2f&&Fa&&(Fa.style.height="",this.$.PMb(),this.O2f=!0));za.EwaSettings.isChangeGateEnabled("OfficeVSO:8728441_moveHideSkeleton")&&J.a.plb()?this.fna.iI(e.a.$5a):this.$.FK(e.a.$5a);
J.a.plb()&&this.fna.nal();this.$.AL()}Bpe(Wa){this.DVg=Wa;I.DOMElementExtensions.toggleCssClass(this.Za.domElement,t.a.nvf,Wa)}vGa(){return this.Zr.querySelectorAll(I.DOMElementExtensions.$D+", div[tabindex]")}Fz(){return I.DOMElementExtensions.Fz(this.vGa())}KDi(){const Wa=this.Fz();return Wa?(I.DOMElementExtensions.setFocus(Wa),!0):!1}lfk(Wa,Fa){Fa=-287251124===Fa||-1925065947===Fa||1764140053===Fa;Yb.a.ymb()&&Fa&&Wa.preventDefault()}$lc(Wa=!1){this.u9b(!this.$.isEditMode,Wa);if(J.a.hs()){const Fa=
()=>{this.$X&&I.DOMElementExtensions.toggleCssClass(this.$X,t.a.tFa,!this.$.isEditMode)};Wa?Fa():Object(pa.d)(()=>{Fa()},this.$.Aa)}}f6b(Wa){this.Za.pK=Wa}toggleEditingEvents(Wa){this.Za.toggleEditingEvents(Wa)}exk(){J.a.plb()?this.fna.G9k(this.RVi()):(na.a.instance.BZ(e.a.I1,nb.a.zob),na.a.instance.uV(e.a.I1,nb.a.zob));na.a.instance.D9(e.a.I1,nb.a.zob)}RVi(){return{gZb:this.nameBox.text,isEnabled:this.nameBox.isEnabled}}gxk(){c.ULS.sendTraceTag(537161947,0,50,"FormulaBar.ctor: this.formulaBarElement is null (probably after dispose)")}r5f(Wa){return!this.hCe&&
(125627505===Wa||706199415===Wa)}get text(){return super.text}static XIf(Wa){return document.getElementById(Wa.Oc+e.a.Afb)}static R7h(){const Wa=document.createElement("div");Wa.className=t.a.dri;Wa.classList.add(t.a.BX);return Wa}static I9h(Wa){const Fa=document.createElement("div");Fa.id=Wa+wb.vSj;Fa.className=t.a.uSj;Fa.classList.add(t.a.BX);return Fa}static Nzd(){const Wa=Yb.a.ymb(),Fa=document.createElement(Wa?"div":"textarea");Fa.className=t.a.lri;J.a.y2f()&&Fa.classList.add(t.a.nri);za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaBarGreenLineEnabled",
!1)&&Fa.classList.add(t.a.iri);Fa.classList.add(t.a.mri);Fa.classList.add(t.a.nQj);Wa?Fa.id=e.a.wOb:(Fa.cols=20,Fa.rows=2);return Fa}static X7h(Wa){const Fa=document.createElement("div");Fa.id=Wa+e.a.vOb;Fa.className=t.a.iEf;I.DOMElementExtensions.FG(Fa,e.a.HA);Fa.setAttribute(e.a.oy,"insert function");Fa.tabIndex=0;Fa.classList.add(t.a.BX);return Fa}static H9h(Wa){const Fa=document.createElement("div");Fa.id=Wa+wb.cNc;Fa.className=t.a.Sig;I.DOMElementExtensions.FG(Fa,e.a.HA);Fa.setAttribute(e.a.oy,
"commit edit");Fa.tabIndex=0;Fa.classList.add(t.a.BX);return Fa}static n6h(Wa){const Fa=document.createElement("div");Fa.id=Wa+wb.Zoc;Fa.className=t.a.Pcf;I.DOMElementExtensions.FG(Fa,e.a.HA);Fa.setAttribute(e.a.oy,"cancel edit");Fa.tabIndex=0;Fa.classList.add(t.a.BX);return Fa}static k9h(Wa){const Fa=document.createElement("div");Fa.id=Wa+e.a.EDf;Fa.className=t.a.jri;return Fa}}wb.vSj="okCancelButtonContainer";wb.cNc="okboxButton";wb.Zoc="cancelboxButton";wb.ita=null;Object(y.a)(wb,"FormulaBar",
u.a,[24])},1378:function(y,r,a){a.d(r,"d",function(){return h});a.d(r,"c",function(){return n});a.d(r,"b",function(){return m});a.d(r,"a",function(){return u});var c=a(28),b=a(698),f=a(1379),k=a(142),x=a(143),d=a(678);const h=t=>255<t.length||!l(t)||c.a.MG(t,"_xl")?!1:!0,n=(t,e)=>{var w=e.ha;e=w.oa.vi;w=w.oa.activeRange;return t.qa.la&&e?b.b(t.wc,w,t.qa.la.name):null},m=t=>{let e=null;t=t.ha.ob;t.isFloatingObjectSelected&&(e=t.Wb.floatingObject);return e},u=(t,e=!0)=>{const w=f.a.getInstance(t),z=
w.fWi();z&&!t.wc.Bl(z)&&d.a(x.a.M_h,[k.a.pgg],!0,!0,!1,!1,null);w.stop(e)},l=t=>{if(!t.length)return!1;for(let e=0;e<t.length;e++){const w=t.charAt(e),z=t.charCodeAt(e);if(!e){if("\\"!==w&&"_"!==w&&!c.a.isLetter(z))return!1}else if("_"!==w&&"."!==w&&!c.a.T1f(z)&&!c.a.isNumeral(z))return!1}return!0}},1379:function(y,r,a){y=a(0);var c=a(15);class b{constructor(f){this.start=k=>{this.inProgress?c.ULS.sendTraceTag(528053384,0,50,"NameBoxTelemetry: Received start when an instance of this stopwatch was already ongoing"):
(this.Pj.start(),this.inProgress=!0,this.jhg=k)};this.stop=(k=!0)=>{this.inProgress&&(this.Pj.stop(),k&&c.ULS.sendTraceTag(528053383,0,50,`{"CreateNamedRange_UserPerspective": ${this.Pj.Kc}}`),this.inProgress=!1,this.jhg=void 0)};this.fWi=()=>this.jhg;this.Pj=f.Vb.Pg("UserAction","CreateNamedObjectTimer");this.inProgress=!1}}b.getInstance=f=>{void 0===b.instance&&(b.instance=new b(f));return b.instance};r.a=b;Object(y.a)(b,"NameBoxTelemetry",null,[])},1584:function(y,r,a){r=a(490);a=a(1585);a=a.Di?
a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);r(a,{insert:"head",Oj:!1});y.exports=a.Fk||{}},1585:function(y,r,a){r=a(489)(!1);r.push([y.i,'.ewa-fb{height:20px;background-color:#fff;color:#444;overflow:hidden;padding:10px 8px;position:relative;margin:auto}.grid-visual-refresh .ewa-fb{height:32px;overflow:hidden;padding:0;background-color:#f5f5f5}.ewa-fb-placeholder{color:#bbb}.ewa-fb-fluent .ewa-fb-placeholder .ql-editor{color:#bbb}.ewa-root-ltr .ewa-fb{padding-right:4px}.ewa-root-rtl .ewa-fb{padding-left:4px}.ewa-fb-presence-cover,.ewa-fb-text-box{display:inline-block;margin:0 0 0 1px;padding:0;height:18px;width:100%;z-index:101}.ewa-fb-presence-cover{opacity:.2;position:absolute;margin:1px 10px 0 10px}.ewa-fb-text-box,.ewa-fb-text-box-monospace-experiment,.ewa-fb-text-box-new-theme{overflow:hidden;border:1px solid #e6e7e8;outline:0;resize:none;position:relative;flex-grow:1;white-space:pre}.ewa-fb-text-box:focus-within{outline:1px auto}.grid-visual-refresh .ewa-fb-text-box{background-color:#fff;height:18px;line-height:22px;margin:0;top:4px;width:auto;position:relative;padding:2px}.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#fff;height:18px;line-height:18px;margin:0;top:4px;width:auto;position:relative;padding:2px}.ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:18px;overflow:hidden;margin-top:1px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:100%;width:calc(100% - 4px);scrollbar-width:thin;scrollbar-color:#b1b0b0 #fff}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-button:start{background-color:#fff;height:18px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-button:end{background-color:#fff;height:4px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-thumb{border-radius:10px;background-color:#b1b0b0}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar{width:6px}.ewa-fb-extended .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{overflow-y:auto;overflow-x:hidden}.grid-visual-refresh .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{line-height:inherit;height:inherit}.grid-visual-refresh .ewa-fb-text-box.ie .ewa-rteTextElement>.ewa-rteLine{line-height:inherit}.ewa-fb-text-box.ql-container{pointer-events:none}.ewa-fb-text-box .ewa-rteTextElement{pointer-events:all}.ewa-root-ltr .ewa-fb-presence-cover,.ewa-root-ltr .ewa-fb-text-box{left:33px}.ewa-root-ltr .grid-visual-refresh .ewa-fb-text-box{right:4px;left:38px}.ewa-root-rtl .ewa-fb-text-box .ewa-root-rtl .ewa-fb-presence-cover{right:33px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-text-box{right:38px;left:4px}.ewa-fb .functionbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101}.green-fill-paths:hover path{fill:#107C41}.grid-visual-refresh .ewa-fb .functionbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-root-ltr .grid-visual-refresh .ewa-fb .functionbox{margin-right:3px}.ewa-root-rtl .grid-visual-refresh .ewa-fb .functionbox{margin-left:3px}.ewa-fb-presence-cover-internal{height:100%}.ewa-root-ltr .ewa-fb-presence-cover-internal{margin-right:50px}.ewa-root-rtl .ewa-fb-presence-cover-internal{margin-left:50px}.ewa-fb .functionbox .clip13x13{margin:2px 8px 1px 8px}.grid-visual-refresh .ewa-fb .functionbox .clip13x13{margin-top:4px;margin-bottom:4px}.ewa-fb .functionbox:hover .ewaboot_formulabar13{margin-top:-13px}.ewa-root-ltr .ewa-fb.drop-down{padding-left:3px}.ewa-root-rtl .ewa-fb.drop-down{padding-right:3px}.ewa-fb .ok-cancel-buttons-container{position:relative;z-index:101;display:none;flex-flow:row}.ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{display:flex;order:1;height:22px;border:1px solid #e6e7e8;top:4px}.ewa-root-rtl .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{margin-left:3px}.ewa-root-ltr .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{margin-right:3px}.grid-visual-refresh .ewa-fb .ok-cancel-buttons-container{position:relative}.ewa-fb .okbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101;margin:0 2px 0 2px;display:flex;justify-content:center;align-items:center}.grid-visual-refresh .ewa-fb .okbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-fb .cancelbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101;display:flex;justify-content:center;align-items:center}.grid-visual-refresh .ewa-fb .cancelbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-fb-nb{display:flex;flex-flow:row}.grid-visual-refresh .ewa-fb-nb{background-color:#f5f5f5;height:32px}.ewa-fb-nb .ewa-fb.drop-down{flex:1 1 auto}.grid-visual-refresh .ewa-fb-nb .ewa-fb.drop-down{right:0;height:32px;display:flex;flex-flow:row}.ewa-fb-name-box-placeholder{position:relative;width:118px;float:left;display:block;overflow:hidden;height:20px;background-color:#fff;padding:2px;align-self:center;margin:0 0 0 4px}.ewa-root-rtl .ewa-fb-name-box-placeholder{float:right;margin:0 4px 0 0}.button-disabled{pointer-events:none;background-color:#f0f0f0!important}.ewa-fb-extended .ewa-fb-expand-button-img{transform:rotate(180deg)}.ewa-fb-expand-button-container{padding-top:3px;position:absolute;z-index:102}.ewa-root-ltr .ewa-fb-expand-button-container{padding-right:7px;right:0}.ewa-root-rtl .ewa-fb-expand-button-container{padding-left:7px;left:0}.ewa-fb-text-div-container{width:100%;position:relative}.ewa-fb-refactor .ewa-fb-text-div-container{order:2}body.ewa-fb-drag-resize *{cursor:inherit!important}body.ewa-fb-drag-resize{cursor:ns-resize}.ewa-fb-drag-handler{position:absolute;height:6px;width:100%;cursor:ns-resize;z-index:102;bottom:0}.grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new{height:calc(100% - 8px);box-sizing:border-box;width:100%}.grid-visual-refresh .ewa-fb-refactor.ewa-fb-nb .ewa-fb.drop-down{height:inherit}.grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{height:auto;overflow:hidden;white-space:pre-wrap}.ewa-root-ltr .grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-right:20px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-left:20px}.skel-formula-bar .grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{overflow-wrap:break-word}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .functionbox{top:0;order:2;border:none;margin:0}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .okbox{top:0;margin:0;border:none;order:1}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .cancelbox{top:0;border:none;order:0}.ewr-presentMode-on .ewa-fb{color:#f3f2f1}.ewr-presentMode-on.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-on.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#3c3c3c;border:1px solid #3c3c3c;border-radius:2px}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#292827!important;border:1px solid #292827!important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb,.ewr-presentMode-on.grid-visual-refresh .ewa-fb-nb{background-color:#323130}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-nb{background-color:#000!important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb .functionbox{background-color:#323130;border:1px solid #323130}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .functionbox{background-color:#000!important;border:1px solid #000!important}.ewr-presentMode-on .green-fill-paths:hover path{fill:#37a660}.ewr-presentMode-on .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{border:none}.ewr-presentMode-on .ewa-fb .okbox,.ewr-presentMode-on.grid-visual-refresh .ewa-fb .okbox{background-color:#3c3c3c;border:1px solid #3c3c3c;border-top-right-radius:2px;border-bottom-right-radius:2px}.ewr-presentMode-on.ewr-namedsheetview .ewa-fb .okbox,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .okbox{background-color:#292827!important;border:1px solid #292827!important}.ewr-presentMode-on .ewa-fb .cancelbox,.ewr-presentMode-on.grid-visual-refresh .ewa-fb .cancelbox{background-color:#3c3c3c;border:1px solid #3c3c3c;border-top-left-radius:2px;border-bottom-left-radius:2px}.ewr-presentMode-on.ewr-namedsheetview .ewa-fb .cancelbox,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .cancelbox{background-color:#292827!important;border:1px solid #292827!important}.ewr-presentMode-on .ewa-fb-expand-button-img{fill:#e1dfdd}.ewr-presentMode-on .ql-editor ::selection{background-color:#605e5c}.ewr-presentMode-on .functionbox.button-disabled{background-color:#323130!important}.ewr-presentMode-on .ewa-fb-function-button-img{fill:#e1dfdd}.ewr-presentMode-on .functionbox.button-disabled .ewa-fb-function-button-img{fill:#8a8886!important}.ewr-presentMode-transition .ewa-fb .cancelbox,.ewr-presentMode-transition .ewa-fb .okbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .cancelbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .functionbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .okbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-fb,.ewr-presentMode-transition .functionbox.button-disabled,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-nb{transition:background-color .4s linear,color .4s linear}.ewa-fb-nb.ewa-fb-refactor.ewa-fb-fluent{height:24px;background-color:#F5F5F5;color:#444;overflow:hidden;padding:4px 8px;position:relative;margin:0;gap:8px;flex-flow:row}.ewa-fb-fluent .ewa-fb.drop-down{flex-flow:row;gap:8px;padding-left:0;padding-right:0}.ewa-fb-fluent .ewa-fb.drop-down .ok-cancel-buttons-container{display:flex;width:66px;border:1px solid #D1D1D1;border-radius:4px;flex-flow:row;top:0;margin:0}.ewa-fb-fluent .functionbox{display:flex;align-items:center;justify-content:center}.ewa-root-ltr .ewa-fb-fluent .functionbox{border-top-right-radius:4px;border-bottom-right-radius:4px}.ewa-root-rtl .ewa-fb-fluent .functionbox{border-top-left-radius:4px;border-bottom-left-radius:4px}.ewa-root-ltr .ewa-fb-fluent .cancelbox{border-top-left-radius:4px;border-bottom-left-radius:4px}.ewa-root-rtl .ewa-fb-fluent .cancelbox{border-top-right-radius:4px;border-bottom-right-radius:4px}.ewa-fb-fluent .cancelbox:hover,.ewa-fb-fluent .ewa-fb-expand-button-container:hover,.ewa-fb-fluent .functionbox:hover,.ewa-fb-fluent .okbox:hover{background-color:#F5F5F5}.ewa-fb-fluent .cancelbox:focus,.ewa-fb-fluent .ewa-fb-expand-button-container:focus,.ewa-fb-fluent .functionbox:focus,.ewa-fb-fluent .okbox:focus{background-color:#E0E0E0}.ewa-fb-fluent .cancelbox.button-disabled,.ewa-fb-fluent .functionbox.button-disabled,.ewa-fb-fluent .okbox.button-disabled{pointer-events:none;background-color:#FFF!important}.ewa-fb-fluent .cancelbox.button-disabled path,.ewa-fb-fluent .functionbox.button-disabled path,.ewa-fb-fluent .okbox.button-disabled path{fill:#BDBDBD}.ewa-fb-fluent .ewa-fb-text-div-container{display:flex;border-radius:4px;flex-flow:column}.ewa-fb-fluent .ewa-fb-expand-button-container{order:1;height:20px;width:20px;border-radius:4px;flex-grow:0;padding:0}.ewa-root-ltr .ewa-fb-fluent .ewa-fb-expand-button-container{margin:2px 4px 0 0}.ewa-root-rtl .ewa-fb-fluent .ewa-fb-expand-button-container{margin:2px 0 0 4px}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new{border:1px solid #D1D1D1;border-radius:4px;top:0;line-height:16px;padding:3px 0 5px 0;color:#242424}.ewa-root-ltr .ewa-fb-refactor.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-right:10px}.ewa-root-rtl .ewa-fb-refactor.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-left:12px}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement>.ewa-rteLine{cursor:text}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:calc(100% - 4px);width:calc(100% - 22px);margin-top:2px;cursor:default}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-thumb{border-radius:4px;background-color:grey;background-clip:padding-box}.ewa-root-ltr .ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{padding:0 4px 0 8px}.ewa-root-rtl .ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{padding:0 4px 0 14px}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new.ewa-fb-fluent-bordershadow:focus-within{border-bottom:2px solid #107c41;outline:0}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new.ewa-fb-fluent-border-highlight:focus-within{outline:0;border:1px solid #D1D1D1;border-bottom-style:none}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new.ewa-fb-fluent-border-highlight:focus-within::after{box-sizing:border-box;content:"";position:absolute;left:-1px;bottom:-1px;right:-1px;height:4px;border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-bottom:3px solid #107c41;clip-path:inset(calc(100%-3px) 0 0)}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new.ewa-fb-disabled{border:1px solid #D1D1D1;border-radius:4px;background-color:#F5F5F5}.ewa-fb-fluent .cancelbox.button-disabled.ewa-fb-disabled,.ewa-fb-fluent .functionbox.button-disabled.ewa-fb-disabled,.ewa-fb-fluent .okbox.button-disabled.ewa-fb-disabled{background-color:#F5F5F5!important}.ewa-root-ltr .ewa-fb-rtl .ewa-rteLine{padding-right:20px!important}.ewa-fb-fluent .ql-editor ::selection{background:#616161;color:#FFF}.skel-fb-namebox-wrapper{height:24px;width:124px;line-height:22px;padding:0 16px 0 0;border-color:#d1d1d1;position:relative;background-color:#fff;border-width:1px;border-style:solid;overflow:hidden;white-space:nowrap;box-sizing:border-box;border-radius:4px}.skel-fb-namebox-wrapper.skel-legacy-namebox{border-radius:0;line-height:16px;border-color:#e1dfdd;margin:4px}.skel-fb-namebox-button{position:absolute;border:none;padding:0;background-color:transparent;color:#797775;min-width:16px;right:-1px;display:flex;height:24px;justify-content:center;align-items:center}.skel-fb-namebox-rtl{left:-1px;right:auto}.skel-fb-namebox-icon{display:flex;width:12px;fill:#252423;align-items:center;justify-content:center}.skel-legacy-namebox .skel-fb-namebox-icon{font-size:12px;margin:0;height:8px;line-height:8px;text-align:center;flex-shrink:0;display:flex;width:8px;align-items:center}.skel-fb-namebox-disabled{background-color:#f5f5f5}.skel-fb-namebox-disabled .skel-fb-namebox-span{color:#c8c6c4}.skel-fb-namebox-disabled .skel-svg-disabled{fill:#939393}.skel-fb-namebox-disabled svg{opacity:.4}.skel-fb-namebox-span{color:#252423;float:left;margin-right:4px;margin-top:4px;line-height:16px;background-color:transparent;box-sizing:border-box;border-style:none;outline:0;overflow:hidden;text-overflow:ellipsis;font-size:12px;padding-left:4px}.skel-fb-namebox-span.skel-fb-namebox-v9{font-family:"Aptos Narrow","Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;font-size:11pt;line-height:15px}',
""]);y.exports=r},890:function(y,r,a){a.r(r);y={};a.r(y);a.d(y,"FormulaBarCommandHandler",function(){return Sa});var c=a(133);r=a(0);var b=a(15),f=a(170),k=a(606),x=a(150),d=a(139),h=a(10),n=a(27),m=a(74),u=a(44),l=a(698),t=a(124),e=a(270),w;(function(Ma){Ma[Ma.NONE=0]="NONE";Ma[Ma.FLOATING_OBJECTS=1]="FLOATING_OBJECTS";Ma[Ma.PRINT_AREA=2]="PRINT_AREA";Ma[Ma.DISCONTINUOUS_RANGES=3]="DISCONTINUOUS_RANGES";Ma[Ma.ILLEGAL_SHEET_SCOPE=4]="ILLEGAL_SHEET_SCOPE";Ma[Ma.INVALID_NAME=5]="INVALID_NAME";Ma[Ma.EMPTY_RANGE=
6]="EMPTY_RANGE";Ma[Ma.GENERIC_ERROR=7]="GENERIC_ERROR";Ma[Ma.VIEW_MODE=8]="VIEW_MODE"})(w||(w={}));Object(r.b)("NameBoxInvalidOperation",w);var z=a(36),E=a(28),M=a(13),G=a(142),A=a(143),N=a(678),K=a(113);class I extends e.a{constructor(Ma,hb){super(Ma,hb);this.jq()}get Tc(){return"NameBoxErrorDialog"}jq(){super.jq();const Ma=this.error.Caption,hb=this.bQi(this.error),$a=this.aQi(this.error);this.hc=0;this.gqa($a);this.Ni(Ma,hb,2,this.TZ)}bQi(Ma){return E.a.equals(Ma.MessageIdName,I.n2c,!0)?String.format(Ma.Description):
E.a.equals(Ma.MessageIdName,I.lTb,!0)?"":Ma.Description}aQi(Ma){const hb=[];E.a.equals(Ma.MessageIdName,I.lTb,!0)&&(Ma=String.format(M.a.instance.ia(2253)),hb.push(...Ma.split("-").map($a=>$a.trim())));return hb}static PY(Ma,hb=null){if(Ma.MessageIdName===I.lTb)b.ULS.sendTraceTag(528053385,0,50,Ma.Caption);else{let $a=Ma.Caption;Ma.MessageIdName===I.n2c&&($a=`Unsupported Operation: ${w[hb]}`);Ma=new K.a;Ma.ga("errorCaption",$a);N.a(A.a.Cyi,[G.a.pgg],!0,!0,!1,!1,Ma)}}static Cd(Ma){switch(Ma){case 3:case 1:case 2:return z.a.Cd(1,
0,2254,2255,0,-1280789630,I.n2c);case 5:case 4:return z.a.Cd(1,0,2252,2253,0,875859818,I.lTb);case 8:case 7:return z.a.Cd(1,0,0,1,0,424201999,I.lTb);case 6:return z.a.Cd(1,0,2256,2257,0,-1280789630,I.n2c);default:throw Error.invalidOperation("Error should not be created if there is no valid NameBoxInvalidOperation");}}}I.n2c="NameBoxUnsupportedOperation";I.lTb="NameBoxInvalidName";Object(r.a)(I,"NameBoxErrorDialog",e.a,[]);const L=(Ma,hb,$a,Va,xa,ia,Z)=>{a:switch(Z){case 2:Z="Table";break a;case 3:Z=
E.a.FMb(hb,"Print_Area")?"Print Area":"Named Range";break a;default:Z="Unknown"}return{key:Ma,name:hb,sheetName:$a,topLeft:Va,bottomRight:xa,location:ia,type:Z}};var J=a(1378),B=a(1),Y=a(25),U=a(151),O=a(1379);class C{constructor(Ma,hb){this.zfk="Print_Area";this.sBk="R";this.Z_h="C";this.tOj="Value";this.$=Ma;this.da=Y.f(this.$);this.HJa=hb;this.uOj=O.a.getInstance(this.$)}Bck(){var Ma=this.$.wc.items,hb=this.$.la.name;const $a={};for(var Va of Ma){Ma=l.a(Va.name);var xa=Ma.tub;if(m.h(Va)&&(!xa||
E.a.equals(Ma.scope,hb,!1))){var ia=Ma.name in $a;if(!ia||ia&&xa)$a[Ma.name]={["namedObjectDetails"]:Ma,["namedObjectItem"]:Va}}}hb=[];for(const Z in $a)Ma=$a[Z],Va=Ma.namedObjectItem,Ma=Ma.namedObjectDetails,xa=`${Va.sheetName}!${Va.usedRange.topLeft.Gz(!1)}:${Va.usedRange.bottomRight.Gz(!1)}`,ia=Va.type,hb.push(L(Va.name,Ma.name,Va.sheetName,Va.usedRange.topLeft.Gz(!1),Va.usedRange.bottomRight.Gz(!1),xa,ia));hb.sort((Z,ta)=>Z.name.localeCompare(ta.name));this.HJa.Cck(hb);J.a(this.$,!1);this.XIg(hb.length)}X8i(Ma){Ma=
l.a(Ma[this.tOj].toString());const hb=Ma.name,$a=Ma.scope.length?Ma.scope:null;var Va=this.XXh(Ma);this.dFk(Ma)||(this.SEj(Ma),0!==Va?(this.HJa.Mpf(this.$,Va),this.mLg()):J.d(hb)?(Va=u.u(Y.f(this.$).ha.oa.selectedRanges,this.$),this.HJa.l9h(this.$,hb,Va,$a,C.JSj,C.ISj),this.uOj.start(Ma.name)):(this.HJa.Mpf(this.$,5),this.mLg()))}RHd(){this.HJa.RHd()}dFk(Ma){const hb=Ma.fullName,$a=Ma.name,Va=Ma.scope;let xa,ia,Z=!1;!({sheetName:xa,range:ia}=u.kb(hb,this.$.qa)).returnValue||!ia.Aw&&B.EwaSettings.isChangeGateEnabled("OfficeVSO:4653651_CheckIsValidRangeInNamedObjectDropDown")?
E.a.equals($a,this.sBk,!0)?(this.eFk(Va),this.i4a(2)):E.a.equals($a,this.Z_h,!0)?(this.WEk(Va),this.i4a(2)):this.$.wc.Bl(hb)?(this.vOg(hb),this.i4a(Ma.tub?1:0)):this.$.wc.Bl($a)?(this.vOg($a),this.i4a(0)):Z=!0:(this.ZEk(xa,ia),this.i4a(3));return!Z}ZEk(Ma,hb){Ma=Ma||this.$.qa.la.name;var $a=l.b(this.$.wc,hb,Ma);l.c($a)||($a=u.y(hb,this.$),$a.SheetName=Ma,Y.f(this.$).lj($a,hb.topLeft,null,null,60,"NameBoxCommandHandler.SelectNamedObjectByRange"),this.da.focus())}eFk(Ma=null){const hb=this.da.ha.oa.activeCell;
this.zdf(Ma)&&(Ma=new n.Range(hb.top,0,hb.bottom,h.a.rf,!0,!1),this.da.ha.VI([Ma],0,Ma,0))}WEk(Ma=null){const hb=this.da.ha.oa.activeCell;this.zdf(Ma)&&(Ma=new n.Range(0,hb.left,h.a.sf,hb.right,!0,!1),this.da.ha.VI([Ma],0,Ma,0))}zdf(Ma){return Ma?(Ma=this.$.qa.getItemByName(Ma),(null===Ma||void 0===Ma?0:Ma.visible)?(Ma.activate({scenario:"namedObject"}),!0):!1):!0}vOg(Ma){Ma=this.$.wc.getItemByName(Ma);l.c(Ma);this.da.focus()}XXh(Ma){return this.$.isEditMode?this.Eqj()?1:E.a.equals(Ma.name,this.zfk,
!0)?2:this.rhi()?3:this.Udj(Ma)?4:this.Dpj()?6:0:8}mLg(){var Ma=J.b(this.da);null!=Ma?this.HJa.Qud("",Ma.name):(Ma=J.c(this.$,this.da))?this.HJa.Qud(Ma.name,Ma.name):this.HJa.Qud("",this.da.ha.oa.activeCell.toString())}Eqj(){return!!this.da.ha.ob.activeFloatingObjectControlId}rhi(){return 1<this.da.ha.oa.selectedRanges.length}Udj(Ma){return Ma.tub&&!this.$.RQ(Ma.scope)}Dpj(){return this.da.Eb.rIa(this.da.ha.oa.selectedRanges[0])}static JSj(Ma){return hb=>{z.a.zf(hb.Errors)&&(I.PY(hb.Errors[0]),new I(Ma,
hb.Errors[0]),O.a.getInstance(Ma).stop(!1))}}static ISj(Ma){return hb=>{(hb=t.a.te(hb.data))&&0<hb.length?(I.PY(hb[0]),new I(Ma,hb[0])):(I.PY(I.Cd(7)),new I(Ma,I.Cd(7)));O.a.getInstance(Ma).stop(!1)}}SEj(Ma){const hb=null!=J.c(this.$,this.da);Ma.tub?this.i4a(hb?7:6):this.i4a(hb?5:4)}i4a(Ma){U.b(this.$).Jd(x.a.v1k,{type:Ma.toString()},null,!0)}XIg(Ma){U.b(this.$).Jd(x.a.Sxg,{wol:Ma},null,!0)}}Object(r.a)(C,"NameBoxCommandHandler",null,[]);var X=a(429),S=a(213),ea=a(61);const Oa=(Ma,hb,$a,Va,xa,ia,
Z,ta,pa,Ga,Ca=null)=>{Ca=Ma.$a(9,Ca);Ca.name=hb;Ca.selectedRanges=$a;Ca.sheetName=Va;Ca.formula=xa;Ca.comment=ia;return ea.h(Ma,"AddDefinedName",Ca,Z,ta,pa,Ga,0)};var Ha=a(266),Za=a(104),fa;(function(Ma){Ma[Ma.EMPTY_RANGE=0]="EMPTY_RANGE";Ma[Ma.RANGE_CREATED=1]="RANGE_CREATED"})(fa||(fa={}));Object(r.b)("NameBoxStatusCalloutType",fa);class la{Mhi(){this.Ilf();appChrome.renderNameBoxStatusCallout(la.w_c,fa.EMPTY_RANGE)}Vhi(Ma,hb){this.Ilf();const $a=Object(u.G)(hb.Ranges[0]);appChrome.renderNameBoxStatusCallout(la.w_c,
fa.RANGE_CREATED,Ma,hb.SheetName,`${$a.topLeft.toString()}:${$a.bottomRight.toString()}`)}Ilf(){null==la.w_c&&(la.w_c=document.createElement("div"))}Cck(Ma){Za.c()&&appChrome.populateNameBoxMenu(Ma)}l9h(Ma,hb,$a,Va,xa,ia){const Z=()=>this.Vhi(hb,$a);X.a(Ma.userOperationManager,(ta,pa,Ga)=>Oa(Ma.ma.sa,hb,$a,Va,"","",Ha.c(ta,xa(Ma),B.EwaSettings.isChangeGateEnabled("OfficeVSO:8156986_AddsNameBoxStatusCallout")?Z:void 0),Ha.b(pa,ia(Ma)),Ga,Ma),ta=>new S.a(1020,0,ta),null)}Mpf(Ma,hb){I.PY(I.Cd(hb),hb);
8!==hb&&(B.EwaSettings.isChangeGateEnabled("OfficeVSO:8156986_AddsNameBoxStatusCallout")&&6===hb?this.Mhi():new I(Ma,I.Cd(hb)))}RHd(){appChrome.updateNameBoxState({["focus"]:!0})}Qud(Ma,hb){appChrome.setNamedObjectOrActiveCellRange(Ma,hb)}}la.w_c=null;Object(r.a)(la,"NamedObjectsService",null,[250]);var ba=a(209),aa=a(67),oa=a(7),Na=a(5),Ia=a(65);let Sa=class{constructor(Ma,hb){this.$=Ma;this.da=Y.f(this.$);this.Ya=hb;this.y6d=new C(Ma,new la)}gd(){return!1}executeCommand(Ma,hb,$a){hb=hb.command;
Ma=null;switch(hb){case 1726517890:this.y6d.X8i($a);break;case 2045896573:$a=d.a(this.$);(null===$a||void 0===$a?0:$a.AWa)?$a.AWa.Tzf():b.ULS.sendTraceTag(537161936,0,15,"FormulaBarCommandHandler.ExecuteCommand: FormulaBarResizeControl is null when trying to expand the formula bar");break;case -1003645154:this.y6d.RHd();break;case -1790328692:$a=d.a(this.$);hb=!this.$.xUb;$a.isVisible=hb;$a.Za.isVisible=hb;this.$.xUb=hb;this.$.Sg();try{f.a.BB(oa.a.K0f,hb.toString(),k.AFrame.tza)}catch(Va){b.ULS.sendTraceTag(509216780,
0,15,`Failed setting ExcelIsFormulaBarOn cookie with error message: ${Va.message}`)}break;default:Ma=ba.a(hb)}return Ma||aa.Task.Va(!0)}Rc(Ma,hb,$a){Ma=!1;switch(hb.command){case 1726517890:Ma=!!$a;break;case -1003645154:case 2045896573:Ma=!0;break;case -1790328692:Ma=B.EwaSettings.isChangeGateEnabled("OfficeVSO:8235335_DisplaySettings")}return Ma}td(Ma,hb){if("PopulateNameBoxMenu"!==hb)return!1;Ma=this.$.Vb.Uc("UserAction","PopulateNameBoxMenuTimer");this.y6d.Bck();Ma.stop();return!0}XIg(Ma){Ma=
{["NamedObjectsCount"]:Ma};U.b(this.$).Jd(x.a.Sxg,Ma,null,!0)}};Sa=Object(c.__decorate)([Object(Ia.d)(Na.FormulaBarCommandHandlerService),Object(c.__param)(0,Object(Na.EwaControlService)()),Object(c.__param)(1,Object(Na.RibbonControlsService)())],Sa);Object(r.a)(Sa,"FormulaBarCommandHandler",null,[29]);var Pa=a(9);c=a(430);var za=a(81),wa=a(43),db=a(1194),Ba=a(40),Ka=a(942),da=a(29),sa=a(88);class mb extends c.a{constructor(Ma){super();this.$=Ma;this.ri()}create(){Ba.a.instance.sza(oa.a.I1);const Ma=
za.GetServiceTaskFactory.Ne(this.$.ra,388,387,this.Cc),hb=da.a.plb()?Object(sa.d)(Ia.a.resolve(Na.SkeletonManagerService)):aa.Task.Va(null);wa.TaskExtensions.tb(wa.TaskExtensions.jl([Ma,hb],this.Aa),()=>{this.Uf(Object(Ka.a)(this.$.ra,172,()=>new db.FormulaBar(this.$,hb.result,Ma.result)))},this.$.Aa,3)}}Object(r.a)(mb,"FormulaBarFactory",c.a,[]);(()=>{Pa.a.wb(Ma=>{B.EwaSettings.isChangeGateEnabled("OfficeVSO:8704628_importFBLessAsCoreCss")||a(1584);Ma.ra.zc(186,new mb(Ma))})})();String(y);window.___1717508060548_closurehack=
y}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.vrd.js.map/51d14c41372b5a78c28ef8fa16ec855e/EwaTS.vrd.js.map