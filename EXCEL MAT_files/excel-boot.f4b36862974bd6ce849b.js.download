var Microsoft="object"==typeof Microsoft?Microsoft:{};Microsoft.Office=Microsoft.Office||{},Microsoft.Office.Excel=function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=15)}({15:function(e,t,i){"use strict";var n,o,r;i.r(t),i.d(t,"DocRebootSupportMode",(function(){return Ei})),i.d(t,"CommandIds",(function(){return se})),i.d(t,"EventIds",(function(){return ue})),i.d(t,"createCancellationToken",(function(){return li})),i.d(t,"Application",(function(){return Pi})),i.d(t,"createApplication",(function(){return Fi})),function(e){e[e.u=0]="msoulscat_ES_EWAJS",e[e.h=1]="msoulscat_ES_EWAJSGrid",e[e.v=6]="msoulscat_ES_EWAJSChart",e[e.g=202]="msoulscat_MSOSP_FileMenuCommands",e[e._=220]="msoulscat_MSOSP_AddInCommands",e[e.A=225]="msoulscat_MSOSP_OTelJS",e[e.P=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.F=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.O=301]="msoulscat_Wac_WordViewer",e[e.R=306]="msoulscat_Wac_BrowserGeneral",e[e.U=320]="msoulscat_Wac_TaskPane",e[e.k=339]="msoulscat_Wac_OneNoteGeneral",e[e.N=340]="msoulscat_Wac_Ribbon",e[e.H=356]="msoulscat_Wac_WacFeedback",e[e.B=379]="msoulscat_Wac_WopiPendingApplication",e[e.J=383]="msoulscat_Wac_Telemetry",e[e.j=391]="msoulscat_Wac_WacCatchUpActivities",e[e.q=394]="msoulscat_Wac_Dictation",e[e.K=395]="msoulscat_Wac_OneNoteSync",e[e.X=700]="msoulscat_Wac_VisioApp",e[e.$=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.Z=800]="msoulscat_Wac_PptAnimation",e[e.Y=833]="msoulscat_Wac_PptLive",e[e.ee=834]="msoulscat_Wac_PptMWeb",e[e.te=835]="msoulscat_Wac_PptGc2General",e[e.ie=836]="msoulscat_Wac_PptGc2GraphicHost",e[e.ne=837]="msoulscat_Wac_PptGc2Operation",e[e.oe=844]="msoulscat_Wac_PptDataSync",e[e.re=848]="msoulscat_Wac_PptFluidRuntime",e[e.se=815]="msoulscat_Wac_PptShape",e[e.ae=817]="msoulscat_Wac_PptSession",e[e.ce=830]="msoulscat_Wac_PptSlideshow",e[e.ue=822]="msoulscat_Wac_PptView",e[e.le=846]="msoulscat_Wac_PptVideos",e[e.fe=1303]="msoulscat_Uci_Insights",e[e.he=2300]="msoulscat_Wac_VersionHistory",e[e.pe=302]="msoulscat_Wac_WordPresence",e[e.me=3e3]="msoulscat_Wac_OAuth",e[e.ve=3005]="msoulscat_Wac_WordVersionHistory",e[e.we=3006]="msoulscat_Wac_LivePersonaCard",e[e.ge=3012]="msoulscat_Wac_CatchUpFlyout",e[e.Se=3016]="msoulscat_Wac_WordDesigner",e[e.Ie=3021]="msoulscat_Wac_ModernFontPicker",e[e._e=3027]="msoulscat_Wac_UnifiedUiHost",e[e.be=3033]="msoulscat_Wac_EquationTools",e[e.ye=1401]="msoulscat_Osf_Latency",e[e.Te=1402]="msoulscat_Osf_Notification",e[e.Ce=1403]="msoulscat_Osf_Runtime",e[e.Ee=3041]="msoulscat_Wac_AiMaker",e[e.Ae=3043]="msoulscat_Wac_AiRewrite",e[e.Pe=3044]="msoulscat_Wac_AiInsert",e[e.Fe=3047]="msoulscat_Wac_AiSummarize",e[e.Oe=3048]="msoulscat_Wac_CopilotCompose",e[e.Re=3049]="msoulscat_Wac_Skittles",e[e.Ue=3050]="msoulscat_Wac_CopilotChat",e[e.We=3051]="msoulscat_Wac_Syntex",e[e.xe=3052]="msoulscat_Wac_WireGraph",e[e.ke=3053]="msoulscat_Wac_CshCopilot",e[e.Me=3054]="msoulscat_Wac_CopilotComposeLaunchpad",e[e.Ne=3055]="msoulscat_Wac_CopilotProactiveSummary",e[e.He=3056]="msoulscat_Wac_CopilotProactiveShared",e[e.De=3057]="msoulscat_Wac_CopilotCursor"}(n||(n={})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(o||(o={})),function(e){e[e.Firefox=0]="Firefox",e[e.Opera=1]="Opera",e[e.IE=2]="IE",e[e.Edge=3]="Edge",e[e.Chrome=4]="Chrome",e[e.Safari=5]="Safari",e[e.TeamsElectron=6]="TeamsElectron",e[e.Unknown=7]="Unknown"}(r||(r={}));var s=window.navigator,a=s?s.userAgent:void 0;function c(){if(a){if(a.indexOf("Firefox")>-1)return r.Firefox;if(a.indexOf("Opera")>-1||a.indexOf("OPR")>-1)return r.Opera;if(a.indexOf("Trident")>-1)return r.IE;if(a.indexOf("Electron")>-1&&a.indexOf("Teams")>-1)return r.TeamsElectron;if(a.indexOf("Edg")>-1)return r.Edge;if(a.indexOf("Chrome")>-1)return r.Chrome;if(a.indexOf("Safari")>-1)return r.Safari}return r.Unknown}function u(){try{return!!a&&a.indexOf("iPad")>=0||!!a&&a.indexOf("Macintosh")>=0&&h()&&!(a&&a.indexOf("iPhone")>=0)||!!a&&a.indexOf("Android")>=0||h()}catch(e){return!1}}function l(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch(e){return!1}}function d(){return c()===r.IE&&!(c()===r.IE&&null!=document.documentMode&&void 0!==document.documentMode&&document.documentMode>=11)}function f(){try{return window.external&&window.external.getHostEnvironmentValue&&'{"os-sku":"189"}'===window.external.getHostEnvironmentValue("os-sku")}catch(e){return!1}}function h(){return!!s&&s.maxTouchPoints>0}var p=["eurppc"];function m(e){return 8===e.toLowerCase().indexOf("ffc")}function v(e){return 8===e.toLowerCase().indexOf("ppc")}function w(e){var t=e.match(/^https:\/\/((?!word)\w+)(-\w+)+\..*$/i);return t&&t[1]?t[1]:"public"}function g(e,t){if(!t||-1===p.indexOf(t.toLowerCase()))return e;var i=e.match(/(^http[s]:\/\/)((?!word)\w*[-])?(.*)/i);return i?"".concat(i[1]).concat(t,"-").concat(i[3]):e}function S(e){var t=e.match(/^(.*?\/\/[^\/]+)(.*)$/);if(!t)throw new Error("Invalid URL");return t[1]}function I(e,t){var i=e.match(/^(.*?\/\/)([^\/:]+)(.*)$/);if(!i)throw new Error("Invalid URL");var n=i[2];if(void 0===t)return n;if(t<0)throw new Error("subDomainParts should be at least 1");return n.split(".").slice(-(t+1)).join(".")}function _(e,t,i){i&&(e[t.toLowerCase()]=i)}function b(e,t){e[t.toLowerCase()]=""}function y(e,t){var i=e.toLowerCase(),n=t.toLowerCase(),o=i.indexOf("&"+n+"=");if(-1===o&&(o=i.indexOf("?"+n+"=")),-1===o)return"";var r=o+(t.length+2),s=e.indexOf("&",r);return e.substring(r,-1===s?void 0:s)}function T(e,t,i,n){if(!i)return e;var o=e,r=o.indexOf("?"),s="&";r===o.length-1||"&"===o.slice(-1)||"&>"===o.slice(-2)?s="":-1===r&&(s="?");var a=t.toLowerCase()+"=",c=new RegExp("\\W"+a,"i").exec(o);if("?"!==s&&c){if(n){var u=c.index+1,l=o.indexOf("&",u);o=o.substring(0,u)+a+i+(-1===l?"":o.substring(l))}return o}return o.concat(s,a,i)}function C(e){var t={},i=e.indexOf("?");return-1===i||i===e.length-1||e.substring(i+1).replace(new RegExp(/<.*?>/g),"").split("&").forEach((function(e){if(e){var i=e.indexOf("=");-1!==i&&i!==e.length-1&&(t[e.substring(0,i).toLowerCase()]=e.substring(i+1))}})),t}function E(e,t){if(!e)return e;var i=e,n=i.indexOf("?"),o=t.toLowerCase()+"=",r=i.toLowerCase().indexOf(o,n);if(r>=0){var s=i.indexOf("&",r);return"&"===(i=i.substring(0,r)+(-1===s?"":i.substring(s+1))).slice(-1)&&(i=i.slice(0,-1)),i}return e}function A(e){if(!e)return"";var t=-1===e.indexOf("#")?e.length:e.indexOf("#"),i=e.lastIndexOf("/",t);if(-1!==i&&i+1===e.indexOf("://")+"://".length)return"";i+=1;var n=e.indexOf("?");if(-1!==(n=n>=t?-1:n)&&i>n)return"";var o=-1===n?t:n;return i>=o?"":e.substring(i,o)}function P(e){var t=new RegExp("(c[1-5])h?(-)");return e.replace(t,"$1h$2")}function F(e,t,i){var n=new RegExp("[?&]"+t+"=("+(i||"1")+")\\b","i"),o=e.match(n);return!(!o||i&&o[1]!==i)}function O(e,t){var i=y(e,t);return i?decodeURI(i):i}function R(e){return e?e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0]:""}function U(e,t){return{shouldPreload:function(t,i){return e(t,i)},preload:function(e,i,r,s){t(e,i,s).forEach((function(e){!function(e,t,i,r,s){var a=document.createElement("link");if(a.setAttribute("crossorigin","anonymous"),a.rel=x,a.href=e,t){var c=A(e);t.ULS.Ve(561059910,n.B,o.Info,"Preloading resource: ".concat(c)),a.addEventListener("error",(function(){t.ULS.Ve(561059911,n.B,o.Error,"Resource failed to load: ".concat(c))}))}a.setAttribute("as","script"),r&&a.setAttribute("integrity",r),document.head.appendChild(a)}(e[0],r,0,e[1])}))}}}var W,x=(W=c())===r.Firefox||W===r.IE?"prefetch":"preload",k={en:"1033",cs:"1029",da:"1030",de:"1031",el:"1032",fi:"1035",fr:"1036",hu:"1038",it:"1040",ja:"1041",ko:"1042",nl:"1043",nb:"1044",sk:"1051",sv:"1053",tr:"1055",uk:"1058",sl:"1060",es:"3082",pl:"1045",ro:"1048",ru:"1049"};function M(e,t){return void 0===e&&(e=!1),{shouldPreconnect:function(e){return H&&(!t||t(e))},preconnect:function(t){return function(e){var t=document.createElement("link");t.rel="preconnect",t.href=e,t.crossOrigin="anonymous",document.head.appendChild(t)}(e?P(t):t)}}}var N,H=!0;function D(e,t,i){if(t){var n=window.navigator;if(n&&n.sendBeacon)try{return void n.sendBeacon(t,e)}catch(e){}!function(e,t,i){var n=new XMLHttpRequest;n.readyState!==XMLHttpRequest.UNSENT&&n.readyState!==XMLHttpRequest.DONE||(n.open("POST",t,i),n.send(e))}(e,t,i)}}!function(e){e.Unknown="UNKNOWN",e.Initialized="INITIALIZED",e.Prebooted="PREBOOTED",e.Booting="BOOTING",e.Booted="BOOTED",e.Failed="FAILED",e.Disposing="DISPOSING",e.Disposed="DISPOSED"}(N||(N={}));var V,L,B={BUILD_NUMBER:"###VERSION###"};function J(){try{return"20240529.1"}catch(e){return B.BUILD_NUMBER}}function j(e,t,i){!function(e,t,i,n){void 0===n&&(n=!0);var o={type:t.toString(),payloadJson:JSON.stringify(i)};D(JSON.stringify(o),e,n)}(e,V.JSAPI_STATE,{application:t,build:J(),state:i})}function G(){return window.performance.now()}function q(){return Math.round(window.performance.now()+window.performance.timeOrigin)}!function(e){e.JSAPI_STATE="JSAPI_STATE",e.H_V2="H_V2"}(V||(V={})),function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(L||(L={}));var z,K,X=function(){function e(e){var t=this;this.Le=3e4,this.Be=30,this.Je=0,this.je=[],this.Ge=q(),this.qe=[],this.ze="",this.Ke=0,this.flushOnClose=function(){t.Xe(!1,!1)},this.flush=function(){t.$e()},this.flushAndSetNewEndpoint=function(e,i){var n,o=t.Ze(e);o.localeCompare(null!==(n=t.Qe)&&void 0!==n?n:"",void 0,{sensitivity:"accent"})&&(t.qe.push((function(){t.Qe=o,i&&i()})),t.Xe(!0,!0))},this.Ze=function(e){return e+"?usid="+t.ze+"&officeserverversion="+J()},this.$e=function(){window.setTimeout((function(){return t.Xe(!0,!0)}),0)},this.Xe=function(e,i){var n,o,r,s,a,c,u,l=G();window.clearTimeout(t.Ye),t.Qe&&(t.je.length>0&&(t.Je+=1,D((n=t.je.splice(0,e?t.Be:t.je.length),o=t.ze,r=t.Je,s=t.Ge,a=[],c=n.map((function(e){return function(e,t,i){var n={};if(n.G=e.tag,n.T=e.timestamp-t,n.M=e.message,n.C=e.category,e.correlationId){var o=i.findIndex((function(t){return t===e.correlationId}));o<0&&(o=i.push(e.correlationId)-1),n.I=o}var r=1e3*e.type+e.level;return n.D=r,n}(e,s,a)})),u=function(e,t,i,n,o){var r={};return r.T=e,r.L=t,r.S=i,r.I=n,o&&o.length>0&&(r.W=o),r.V=1,r}(s,c,o,r,a),JSON.stringify(u)),t.Qe,i),t.Ge=q()),0===t.je.length&&t.qe.length>0&&(t.qe.forEach((function(e){"requestIdleCallback"in window?window.requestIdleCallback(e):window.setTimeout(e,0)})),t.qe=[]),e&&(t.Ye=window.setTimeout((function(){t.$e()}),t.je.length>t.Be||t.qe.length>0?1e3:t.Le)),t.Ke+=G()-l)},e&&this.configure(e)}return e.prototype.getTimeSpentLogging=function(){return this.Ke},e.prototype.addLoggingTime=function(e){this.Ke+=e},e.prototype.configure=function(e){var t=G();if(e.uploadCadenceInMs&&(this.Le=e.uploadCadenceInMs),e.uploadTriggerSize&&(this.Be=e.uploadTriggerSize),e.sessionId&&(this.ze=e.sessionId),e.remoteUlsEndpoint){if(!e.sessionId&&this.Qe)throw new Error("Remote ULS endpoint is already set");this.Qe=this.Ze(e.remoteUlsEndpoint),this.Ge=q(),this.$e()}this.Ke+=G()-t},e.prototype.handleTrace=function(e){var t=G();e.message.length>3072&&(e.message=e.message.substring(0,3072-"... [Trimmed]".length)+"... [Trimmed]"),this.je.push(e),(this.je.length>this.Be||e.level===o.Error)&&this.$e(),this.Ke+=G()-t},e.prototype.getUserSessionId=function(){return this.ze},e}(),$=[];function Z(e){var t=new X(e);function i(e,i,n,o){var r=G();if(!function(e){return 1===$[e]}(e)){var s={timestamp:q(),category:i,tag:e,level:n,type:L.Trace,message:o,correlationId:""};t.addLoggingTime(G()-r),t.handleTrace(s)}}return{ULS:{Ve:function(e,t,n,o){i(e,t,n,o)},shipAssertTag:function(e,t,n,r){n&&i(e,t,o.Error,r)},debugAssertTag:function(e,t,i,n){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:t.flush,flushOnClose:t.flushOnClose,setCorrelationId:function(){}},configure:function(e){t.configure(e)},settingsChangeHandler:function(e){var i,n;i=e.et.getValue(K.tt,""),n=e.et.getValue(K.nt,""),z&&n===z||($=[],z=n,i&&i.split(",").forEach((function(e){var t=parseInt(e,10);t&&($[t]=1)}))),t.configure({uploadCadenceInMs:e.et.getValue(K.ot,6e4)});var o=e.et.getValue(K.rt,"").toString();""!==o&&t.flushAndSetNewEndpoint(o)},getTimeSpentLogging:function(){return t.getTimeSpentLogging()},getUserSessionId:function(){return t.getUserSessionId()},flushAndSetNewEndpoint:function(e,i){t.flushAndSetNewEndpoint(e,i)}}}!function(e){e.st="BootstrapperMaxUlsHeartbeatTime",e.ct="BootstrapperNoCompleteWarning1Time",e.ut="BootstrapperNoCompleteWarning2Time",e.nt="RemoteUlsETag",e.tt="RemoteUlsSuppressions",e.lt="BootstrapperSettingsFetchPeriod",e.dt="timestamp",e.ft="BootstrapperUlsHeartbeatIntervalMs",e.ht="BootstrapperUlsHeartBeatIsEnabled",e.ot="BootstrapperUlsUploadCadenceMs",e.pt="WordConsumptionViewToEditRedirectIsEnabled",e.vt="RequestedCallThrottlingDefaultToViewMinimumValue",e.rt="BulsEndpointUrl",e.wt="EnableCommonHostDiagnosticsParams",e.gt="EnableICNForWord",e.St="EnableModernEmbedViewForPowerPoint",e.It="EnableModernEmbedViewInOneUpForPowerPoint",e._t="EnableModernEmbedViewForPowerPointGlobalAppUrl",e.bt="EnableModernReadingViewForPowerPoint",e.yt="EnableDefaultToModernForPowerPoint",e.Tt="ShouldLogJsApiKpisForWord",e.Ct="WordSwitchToViewInTeamsJsapiV1Enabled",e.Et="EnableWordSessionRefreshTelemetry",e.At="PowerPointUseEssDCHint",e.Pt="ModernEmbedViewBootstrapperFeatureGatesForPowerPoint",e.Ft="ModernReadingViewBootstrapperFeatureGatesForPowerPoint",e.Ot="ModernEmbedViewForPowerPointEnabledPercentage",e.Rt="PowerPointESSCookieLookbackThresholdHour",e.Ut="PowerPointSetESSCookieLookbackExpEnabled",e.Wt="ExcelForceViewOnlyInTeamsJsapiV1"}(K||(K={}));var Q,Y=function(){return(Y=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function ee(e,t,i){if(i||2===arguments.length)for(var n,o=0,r=t.length;o<r;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function te(e){if(e){var t=e.lastIndexOf(".");if(-1!==t)return e.substring(t+1).toLowerCase()}return""}function ie(e){if(!e)return"";var t=Object.getOwnPropertyNames(e),i=Object.getOwnPropertyNames(Object.getPrototypeOf(e));return JSON.stringify(e,ee(ee([],t,!0),i,!0))}function ne(e,t){return{isFeatureEnabled:function(i){return function(e,t,i){if(t)try{return t(e)}catch(e){i&&i.ULS.Ve(594883024,n.B,o.Error,"IsFeatureEnabled callback error: "+ie(e))}}(i,e,t)}}}function oe(e,t){var i={};if(Object.keys(Q).forEach((function(t){var n=e.isFeatureEnabled(Q[t]);void 0!==n&&(i[Q[t]]=n?"1":"0")})),t&&t.wdFlights)for(var n=0,o=t.wdFlights.toLowerCase().split(",");n<o.length;n++){var r=o[n];"et-treatment"!==r&&"et-control"!==r||(i[Q.xt]="et-treatment"===r?"1":"0")}return JSON.stringify(i)}Object.create,Object.create,function(e){e.xt="EnterpriseTemplates",e.kt="ExcelAdaptiveLayoutDownload",e.Mt="ExcelLandingPageOfflineTelemetry",e.Nt="ExcelLandingPageObserverRetry",e.Ht="H2StaticContent",e.Dt="HashedUrl",e.Vt="ODCShareLinkPreload",e.Lt="OfficeComExcelJsApiV2",e.Bt="OfficeComPptJsApiV2",e.Jt="OfficeComUiHost",e.jt="OfficeComWordJsApiV2",e.Gt="OfficeHwaUiHost",e.qt="OfficeUnifiedUiHostTeams",e.zt="WordViewToUnifiedRead",e.Kt="PowerPointEarlySessionStart"}(Q||(Q={}));var re,se,ae,ce,ue,le,de=function(){function e(){this.Xt=[]}return e.prototype.add=function(e){e&&this.Xt.push(e)},e.prototype.remove=function(e){if(e){var t=this.Xt.indexOf(e);t>-1&&this.Xt.splice(t,1)}},e.prototype.removeAll=function(){this.Xt=[]},e.prototype.dispatch=function(e,t){this.Xt.forEach((function(i){try{i(e)}catch(e){t&&t(e)}}))},e}(),fe=function(){function e(e,t){var i=this;this.$t=0,this.Zt=function(){try{if(!window||!window.localStorage)return;var e=window.localStorage.getItem(i.Qt);if(!e)return;var t=JSON.parse(e);i.Yt(t)}catch(e){i.ei.ULS.Ve(592836768,n.B,o.Warning,"Failed to get settings from localStorage: "+ie(e))}},this.Yt=function(e){return!!i.ti(e)&&(i.ii=e,i.ni.dispatch({et:i},(function(e){i.ei.ULS.Ve(592836769,n.B,o.Error,"Settings listener error: "+ie(e))})),!0)},this.ti=function(e){if(e&&"object"==typeof e){if(e.hasOwnProperty(K.dt)&&!isNaN(e.timestamp))return!0;i.ei.ULS.Ve(592836770,n.B,o.Error,"Received invalid settings")}return!1},this.oi=function(){if(i.ri){var e=new XMLHttpRequest;window.location.href.indexOf("wdkestrelrouting=true")>-1?e.setRequestHeader("X-KestrelRouting","true"):window.location.href.indexOf("wdkestrelrouting=false")>-1&&e.setRequestHeader("X-KestrelRouting","false"),e.open("GET",i.ri),e.responseType="json",e.timeout=5e3,e.send(),e.onload=function(){if(200===e.status&&e.response?(i.si(e.response),i.$t=0):(i.ei.ULS.Ve(592836771,n.B,o.Error,"Fetch settings error. Status: ".concat(e.status,", curErrors: ").concat(i.$t)),i.$t+=1),!(i.$t>7)){var t=i.getValue(K.lt,3e5);i.$t>3&&(t+=(i.$t-3+1)*(t/2)),i.ai=window.setTimeout(i.oi,t)}}}},this.si=function(e){"requestIdleCallback"in window?(i.ci&&self.cancelIdleCallback(i.ci),i.ci=window.requestIdleCallback((function(){return i.li(e)}),{timeout:1e4})):window.setTimeout((function(){return i.li(e)}),0)},this.li=function(e){if(i.Yt(e)&&window&&window.localStorage){var t=JSON.stringify(e);try{window.localStorage.setItem(i.Qt,t)}catch(e){i.ei.ULS.Ve(592836800,n.B,o.Warning,"Failed to set localStorage: "+ie(e))}}},this.di=e,this.Qt="Prod"+e+"Settings",this.ei=t,this.ni=new de,this.Zt()}return e.prototype.updateEnvironment=function(e){this.Qt=(m(e)?"FF":"Prod")+this.di+"Settings",this.Zt()},e.prototype.initializePeriodicFetch=function(e,t){this.Qt=(m(e)?"FF":"Prod")+this.di+"Settings",this.Zt(),this.ri=e+"AppSettingsHandler.ashx?app="+this.di+"&usid="+t+"&build="+J(),this.ai||(this.ai=window.setTimeout(this.oi,3e4))},e.prototype.getValue=function(e,t){if(this.ii||this.Zt(),!this.ii||!this.ii.hasOwnProperty(e))return t;var i=this.ii[e],n=typeof t;if(typeof i===n)return i;if("string"==typeof i){if("number"===n)return parseInt(i,10);if("boolean"===n)return"true"===i}return t},e.prototype.addSettingsChangeListener=function(e){this.ni.add(e)},e.prototype.removeSettingsChangeListener=function(e){this.ni.remove(e)},e.prototype.dispose=function(){this.ai&&window.clearTimeout(this.ai),this.ci&&self.cancelIdleCallback(this.ci),this.ai=void 0,this.ci=void 0,this.ii=void 0,this.ni.removeAll()},e}();!function(e){e.appReboot="appReboot",e.boot="boot",e.closeTab="closeTab",e.createNew="createNew",e.dispose="dispose",e.frameTrust="frameTrust",e.getAuthToken="getAuthToken",e.getHostKeyValue="getHostKeyValue",e.handleBootState="handleBootState",e.postWacToken="postWacToken",e.rename="rename",e.setOverlayContent="setOverlayContent",e.storeHostKeyValue="storeHostKeyValue",e.switchMode="switchMode",e.updateBootComplete="updateBootComplete",e.setWacFlightValue="setWacFlightValue"}(re||(re={})),function(e){e.blurFocus="blurFocus",e.boot="boot",e.completeCreateNew="completeCreateNew",e.continueAccessibilityLoop="continueAccessibilityLoop",e.createNew="createNew",e.dispose="dispose",e.grabFocus="grabFocus",e.moveToFolder="moveToFolder",e.popState="popState",e.sendChannelId="sendChannelId",e.sendConvId="sendConvId",e.teamsUsersReply="teamsUsersReply",e.teamsUserMentionReply="teamsUserMentionReply",e.backButtonPressed="backButtonPressed",e.getClientUrl="getClientUrl",e.getWebUrl="getWebUrl",e.rename="rename",e.completeSharedFilePicker="completeSharedFilePicker",e.sendAccessToken="sendAccessToken",e.sendAuthToken="sendAuthToken",e.sendCustomAuthConfig="sendCustomAuthConfig",e.sendEmbeddedViewUrl="sendEmbeddedViewUrl",e.sendFrameTrustResult="sendFrameTrustResult",e.sendHWRTelemetry="sendHWRTelemetry",e.sendSessionInfo="sendSessionInfo",e.sendUserAccessAndPermissions="sendUserAccessAndPermissions",e.sendWopiInfo="sendWopiInfo",e.sendDavUrl="sendDavUrl",e.switchMode="switchMode",e.signalShared="signalShared",e.postWacToken="postWacToken"}(se||(se={})),function(e){e.hi="App_AccessibilityLoopComplete",e.pi="Wac_ActionComplete",e.mi="WacInitialize_Ready",e.vi="Wac_AppFailed",e.wi="Wac_AppBootState",e.gi="Wac_AppCompleted",e.Si="BrowserEvent",e.Ii="UI_Close",e._i="App_CloseTab",e.bi="UI_Conversation",e.yi="UI_CopyAndEdit",e.Ti="App_CreateNewDocument",e.Ci="Wac_AppDataSavedStatus",e.Ei="UI_Download",e.Ai="UI_Edit",e.Pi="Error",e.Fi="UI_FileEmbed",e.Oi="UI_FileProperties",e.Ri="File_Rename",e.Ui="File_RenameFailed",e.Wi="UI_FileVersions",e.xi="StateChanged",e.ki="App_IsFrameTrusted",e.Mi="GetAccessToken",e.Ni="App_GetAuthToken",e.Hi="App_GetCustomAuthConfig",e.Di="App_GetHostKeyValue",e.Vi="App_WopiInfoFromUrl",e.Li="App_DavUrlFromIds",e.Bi="App_LoadingStatus",e.Ji="App_SwitchMode",e.ji="App_MoveToFolder",e.Gi="UI_OpenInMobileApp",e.qi="UI_OpenInBrowser",e.zi="UI_OpenInClient",e.Ki="PageChanged",e.Xi="App_PushCommentContext",e.$i="App_PushState",e.Zi="App_DocReboot",e.Qi="UI_RedeemForCommenting",e.Yi="App_RefreshSessionInfo",e.tn="UI_ReplyWithChanges",e.in="UI_ReportAbuse",e.nn="App_FilePicker",e.on="UI_SaveStatus",e.rn="WopiSession_Complete_Ack",e.sn="SetOverlayContent",e.an="UI_Sharing",e.cn="UI_ShareForm",e.un="UI_SignIn",e.ln="App_StoreHostKeyValue",e.dn="App_Unloaded",e.fn="App_UlsLog",e.hn="Wac_UnloadingApp",e.pn="App_UpdateBootComplete",e.mn="PageCount",e.vn="UI_CheckUserAccessAndGrantPermissions",e.wn="User_Activity",e.gn="Edit_Notification",e.Sn="UI_Workflow",e.In="ZoomChanged",e._n="CAAEMessage",e.bn="Excel_HostFrameCacheSave",e.yn="Excel_HostFrameCacheEvict",e.Tn="Excel_RegenerateFileBundle",e.Cn="App_SwitchToWacFrame",e.En="App_SaveSSRData",e.An="App_PurgeDataInHostCache",e.Pn="App_SaveHostRenderingV2Data",e.Fn="App_SaveHostUtilsData",e.On="AcquireOAuthTokenTeams",e.Rn="App_SwitchNotebook",e.Un="FailedBoot_CheckFileInfo",e.Wn="GetTeamsUsers",e.xn="SendTeamsUserMention",e.kn="NavigateBackToHost",e.Mn="App_GetClientUrlComplete",e.Nn="App_GetWebUrlComplete",e.Hn="App_CopyLinkComplete",e.Dn="App_SendConversationId",e.Vn="CloseTeamsConversation",e.Ln="PageLoaded",e.Bn="Visio_BRS",e.Jn="Visio_SendLicenseInfo",e.jn="Visio_Consumption_CLTComplete",e.Gn="Visio_SwitchMode_FromViewFrame",e.qn="Visio_ModeSwitch_ToHost_Ack",e.zn="Visio_UpdateEditUrl",e.Kn="Visio_PageViewLoaded",e.Xn="Visio_ActiveAppFrameLoadFailed",e.$n="Visio_DisposeBkgFrame",e.Zn="Visio_ReadyToReceiveDocData",e.Qn="Visio_DocReboot_HostNav",e.Yn="Visio_SwitchToVisioFrame",e.eo="WacAppPerfMetric",e.to="App_ModifyURLState",e.io="App_WacTokenAck",e.no="App_InitEnd",e.oo="App_SplashScreenShown",e.so="App_SetWacFlightValue"}(ae||(ae={})),function(e){e.ao="Ack",e.co="WacInitialize_Ready_Ack",e.uo="Wac_BeforeUnloadApp",e.lo="Blur_Focus",e.do="Wac_AppFailed_Ack",e.fo="Wac_AppCompleted_Ack",e.ho="WopiStartSession_Complete",e.po="WopiPendingSession_Complete",e.mo="Host_AccessibilityLoopComplete",e.ki="Host_IsFrameTrusted",e.vo="Grab_Focus",e.wo="HostCacheDiagnostic",e.So="Host_KeyValue",e.Io="JsApiDiagnostics",e.ji="Host_MoveToFolder",e._o="PageChanged_Ack",e.bo="App_PopState",e.yo="Host_SendChannelId",e.To="Host_SendConversationId",e.Co="GetTeamsUsers_Reply",e.Eo="SendTeamsUserMention_Reply",e.Ao="Host_BackButtonPressed",e.Po="Host_GetClientUrl",e.Fo="Host_GetWebUrl",e.Oo="File_Rename",e.nn="Host_FilePicker",e.Ro="PostAccessToken",e.Uo="Host_SetAuthToken",e.Wo="Host_SetCustomAuthConfig",e.xo="App_PushCommentContext",e.Mo="CanEmbed",e.No="Host_RefreshSessionInfo",e.Ho="CheckUserAccessAndGrantPermissions_Result",e.Do="Host_WopiInfoFromUrl",e.Vo="Host_DavUrlFromIds",e.Lo="SetCurrentPage",e.Bo="SetZoomLevel",e.Jo="WopiPendingSession_Fail",e.jo="SetOverlayContent",e.Go="WopiPendingApplicationComplete_Received",e.qo="Host_SwitchMode",e.zo="Host_Unload",e.Ko="PageCount_Ack",e.Xo="ZoomChanged_Ack",e.$o="Host_ShareUI",e.Zo="Host_Telemetry",e.Qo="Visio_ConsumptionCLTComplete_Ack",e.Yo="Visio_SwitchMode_FromHF_Ack",e.er="Visio_SwitchMode_FromHostFrame",e.ir="Visio_FallbackToLegacySwitch",e.nr="Visio_DocumentData",e.or="Host_PostWacToken"}(ce||(ce={})),function(e){e.AccessibilityLoopCompleted="AccessibilityLoopCompleted",e.ActionCompleted="ActionCompleted",e.BrowserEvent="BrowserEvent",e.CAAEMessage="CAAEMessage",e.Close="Close",e.InitEnd="InitEnd",e.Conversation="Conversation",e.CopyAndEdit="CopyAndEdit",e.CreateNewDocument="CreateNewDocument",e.Download="Download",e.Edit="Edit",e.Error="Error",e.FileEmbed="FileEmbed",e.FileProperties="FileProperties",e.FileRenamed="FileRenamed",e.FileVersions="FileVersions",e.FrameStateChanged="FrameStateChanged",e.FrameTrust="FrameTrust",e.GetAccessToken="GetAccessToken",e.GetAuthToken="GetAuthToken",e.GetCustomAuthConfig="GetCustomAuthConfig",e.GetWopiInfoFromUrl="GetWopiInfoFromUrl",e.GetDavUrlFromIds="GetDavUrlFromIds",e.ModeSwitched="ModeSwitched",e.MoveToFolder="MoveToFolder",e.OpenInMobileApp="OpenInMobileApp",e.OpenInBrowser="OpenInBrowser",e.OpenInClient="OpenInClient",e.PageChanged="PageChanged",e.PushState="PushState",e.Reboot="Reboot",e.RedeemForCommenting="RedeemForCommenting",e.RefreshSessionInfo="RefreshSessionInfo",e.ReplyWithChanges="ReplyWithChanges",e.ReportAbuse="ReportAbuse",e.SharedFilePicker="SharedFilePicker",e.SaveStatus="SaveStatus",e.Share="Share",e.ShareForm="ShareForm",e.SignIn="SignIn",e.SplashScreenShown="SplashScreenShown",e.UserAccessAndPermissions="UserAccessAndPermissions",e.UserActivity="UserActivity",e.UserEditActivity="UserEditActivity",e.Workflow="Workflow",e.ZoomChanged="ZoomChanged",e.AcquireOAuthTokenTeams="AcquireOAuthTokenTeams",e.LoadingStatus="LoadingStatus",e.SwitchNotebook="SwitchNotebook",e.FailedBootCheckFileInfo="FailedBootCheckFileInfo",e.GetTeamsUsers="GetTeamsUsers",e.SendTeamsUserMention="SendTeamsUserMention",e.NavigateBackToHost="NavigateBackToHost",e.GetClientUrlComplete="GetClientUrlComplete",e.GetWebUrlComplete="GetWebUrlComplete",e.CopyLinkComplete="CopyLinkComplete",e.SendConversationId="SendConversationId",e.CloseTeamsConversation="CloseTeamsConversation",e.PageLoaded="PageLoaded",e.FrameChanged="FrameChanged"}(ue||(ue={}));var he,pe=((le={})[se.boot]={rr:re.boot},le[se.createNew]={rr:re.createNew},le[se.dispose]={rr:re.dispose},le[se.postWacToken]={rr:re.postWacToken},le[se.rename]={rr:re.rename},le[se.switchMode]={rr:re.switchMode},le[ae.wi]={rr:re.handleBootState},le[ae._i]={rr:re.closeTab},le[ae.ki]={rr:re.frameTrust},le[ae.Ni]={rr:re.getAuthToken},le[ae.Di]={rr:re.getHostKeyValue},le[ae.Zi]={rr:re.appReboot},le[ae.so]={rr:re.setWacFlightValue},le[ae.sn]={rr:re.setOverlayContent},le[ae.ln]={rr:re.storeHostKeyValue},le[ae.pn]={rr:re.updateBootComplete},le[se.blurFocus]={sr:ce.lo},le[se.continueAccessibilityLoop]={sr:ce.mo},le[se.grabFocus]={sr:ce.vo},le[se.moveToFolder]={sr:ce.ji},le[se.popState]={sr:ce.bo},le[se.sendChannelId]={sr:ce.yo},le[se.sendConvId]={sr:ce.To},le[se.teamsUsersReply]={sr:ce.Co},le[se.teamsUserMentionReply]={sr:ce.Eo},le[se.backButtonPressed]={sr:ce.Ao},le[se.getClientUrl]={sr:ce.Po},le[se.getWebUrl]={sr:ce.Fo},le[se.sendAccessToken]={sr:ce.Ro},le[se.sendAuthToken]={sr:ce.Uo},le[se.sendHWRTelemetry]={sr:ce.Zo},le[se.sendCustomAuthConfig]={sr:ce.Wo},le[se.sendDavUrl]={sr:ce.Vo},le[se.sendEmbeddedViewUrl]={sr:ce.Mo},le[se.sendFrameTrustResult]={sr:ce.ki},le[se.sendSessionInfo]={sr:ce.No},le[se.sendUserAccessAndPermissions]={sr:ce.Ho},le[se.sendWopiInfo]={sr:ce.Do},le[se.signalShared]={sr:ce.$o},le[se.completeSharedFilePicker]={sr:ce.nn},le[ae.hi]={ar:ue.AccessibilityLoopCompleted},le[ae.pi]={ar:ue.ActionCompleted},le[ae.Si]={ar:ue.BrowserEvent},le[ae._n]={ar:ue.CAAEMessage},le[ae.Ii]={ar:ue.Close},le[ae.bi]={ar:ue.Conversation},le[ae.yi]={ar:ue.CopyAndEdit},le[ae.Ti]={ar:ue.CreateNewDocument},le[ae.Ei]={ar:ue.Download},le[ae.Ai]={ar:ue.Edit},le[ae.Pi]={ar:ue.Error},le[ae.Fi]={ar:ue.FileEmbed},le[ae.Oi]={ar:ue.FileProperties},le[ae.Ri]={ar:ue.FileRenamed},le[ae.Wi]={ar:ue.FileVersions},le[ae.Mi]={ar:ue.GetAccessToken},le[ae.Li]={ar:ue.GetDavUrlFromIds},le[ae.Hi]={ar:ue.GetCustomAuthConfig},le[ae.Vi]={ar:ue.GetWopiInfoFromUrl},le[ae.xi]={ar:ue.FrameStateChanged},le[ae.Ji]={ar:ue.ModeSwitched},le[ae.ji]={ar:ue.MoveToFolder},le[ae.Gi]={ar:ue.OpenInMobileApp},le[ae.qi]={ar:ue.OpenInBrowser},le[ae.zi]={ar:ue.OpenInClient},le[ae.Ki]={ar:ue.PageChanged},le[ae.$i]={ar:ue.PushState},le[ae.Qi]={ar:ue.RedeemForCommenting},le[ae.Yi]={ar:ue.RefreshSessionInfo},le[ae.tn]={ar:ue.ReplyWithChanges},le[ae.nn]={ar:ue.SharedFilePicker},le[ae.in]={ar:ue.ReportAbuse},le[ae.on]={ar:ue.SaveStatus},le[ae.an]={ar:ue.Share},le[ae.cn]={ar:ue.ShareForm},le[ae.un]={ar:ue.SignIn},le[ae.vn]={ar:ue.UserAccessAndPermissions},le[ae.wn]={ar:ue.UserActivity},le[ae.gn]={ar:ue.UserEditActivity},le[ae.Sn]={ar:ue.Workflow},le[ae.In]={ar:ue.ZoomChanged},le[ae.On]={ar:ue.AcquireOAuthTokenTeams},le[ae.Bi]={ar:ue.LoadingStatus},le[ae.Rn]={ar:ue.SwitchNotebook},le[ae.Un]={ar:ue.FailedBootCheckFileInfo},le[ae.Wn]={ar:ue.GetTeamsUsers},le[ae.xn]={ar:ue.SendTeamsUserMention},le[ae.kn]={ar:ue.NavigateBackToHost},le[ae.Mn]={ar:ue.GetClientUrlComplete},le[ae.Nn]={ar:ue.GetWebUrlComplete},le[ae.Hn]={ar:ue.CopyLinkComplete},le[ae.Dn]={ar:ue.SendConversationId},le[ae.Vn]={ar:ue.CloseTeamsConversation},le[ae.Ln]={ar:ue.PageLoaded},le[ae.no]={ar:ue.InitEnd},le[ae.oo]={ar:ue.SplashScreenShown},le);function me(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},i=window.crypto||window.msCrypto;if(i){t.crypto=!0;try{return i.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: ".concat(ie(e)))}}t.perfNow=!0;for(var n=0;n<e.length;n+=1){try{var o=Math.floor(100*window.performance.now())%10;(o<0||o>9)&&(o=0);for(var r=0;r<o;r+=1)Math.random()}catch(e){t.exceptions.push("Math.random: ".concat(ie(e)))}e[n]=Math.floor(16*Math.random())}return t}(e),i=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=15&e[i];return i+=1,("x"===t?n:3&n|8).toString(16)})),t]}function ve(e,t){try{if(void 0===window.performance)return void t.ULS.Ve(595948609,n.B,o.Info,"Performance not supported");var i=window.performance.getEntriesByType("resource");if(void 0===i||i.length<=0)return void t.ULS.Ve(595948610,n.B,o.Info,"No resources under performance");for(var r=new RegExp(e+"(-boot\\.min|(\\.(app|preview))?\\.boot)(\\.[0-9a-f]{20})?\\.js","i"),s=i.length-1;s>=0;s-=1){var a=i[s],c=a.name.match(r);if(c){var u=JSON.stringify(a);return u=u.replace(new RegExp(a.name,"g"),c[0]),void t.ULS.Ve(595948616,n.B,o.Info,u)}}t.ULS.Ve(595948484,n.B,o.Info,"Could not find JSAPI resource timing entry")}catch(e){t.ULS.Ve(595948617,n.B,o.Info,"Could not trace the resource timing: ".concat(ie(e)))}}function we(e){var t,i,n=Y(Y({},e.host),{sessionId:e.hostSessionId,domain:location?location.host:void 0});delete n.siteId,delete n.webId,delete n.uiHostTabId;var o={};if(e.wdParams){var r=JSON.parse(JSON.stringify(e.wdParams).toLowerCase());["wdorigin","wdpreviouscorrelation","wdprevioussession","wdtf"].forEach((function(e){r[e]&&(o[e]=r[e])}));var s=/^\w{8}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{12}$/i;o.wdprevioussession&&!s.test(o.wdprevioussession)&&delete o.wdprevioussession,o.wdpreviouscorrelation&&!s.test(o.wdpreviouscorrelation)&&delete o.wdpreviouscorrelation}var a=Y({},e.rebootOverride);delete a.ackExpected,delete a["ui-language"],delete a.wdUserSession,delete a.rebootMode,delete a.documentUrl;var c=e.wopi;return{accessToken:c?{length:c.accessToken.length,expiry:c.expiry}:"N/A",wacToken:c&&c.wacToken?{length:c.wacToken.length}:void 0,bootParams:e.bootParams,build:J(),host:n,intent:e.intent,jsApiVersion:"v2",rebootOverride:a,region:w(e.appBaseUrl),sessionOrigin:e.hostInitDiagnostics?e.hostInitDiagnostics.entryPoint:void 0,sessionContext:e.sessionContext,throttling:e.throttling,ui:e.ui,viewMode:e.viewMode,meeting:e.meeting?{id:null===(t=e.meeting)||void 0===t?void 0:t.id,isPresenter:null===(i=e.meeting)||void 0===i?void 0:i.isPresenter}:void 0,wdParams:o}}function ge(){var e={perfNowSupported:!0,browser:r[c()],touchMode:u(),highContrast:l(),windows10x:f()};try{var t=window.navigator,i=t.connection||t.mozConnection||t.webkitConnection;i&&(e.netDownlink=i.downlink,e.netDownlinkMax=i.downlinkMax,e.netEffectiveType=i.effectiveType,e.netRtt=i.rtt,e.netSaveData=i.saveData,e.netType=i.type),e.deviceMemory=t.deviceMemory,e.logicalProcessors=t.hardwareConcurrency}catch(e){}return e}function Se(e){var t=window.performance.timing;t&&(e.hostPageNavigationStartTime||(e.hostPageNavigationStartTime=t.navigationStart),e.hostPageFetchStartTime||(e.hostPageFetchStartTime=t.fetchStart),e.hostPageRequestStartTime||(e.hostPageRequestStartTime=t.requestStart),e.hostPageResponseStartTime||(e.hostPageResponseStartTime=t.responseStart),e.hostPageResponseEndTime||(e.hostPageResponseEndTime=t.responseEnd),e.hostPageDomCompleteTime||(e.hostPageDomCompleteTime=t.domComplete));var i=window.performance.navigation;if(i&&(void 0===e.hostPageRedirectCount&&(e.hostPageRedirectCount=i.redirectCount),!e.hostPageNavigationType)){var n="UNKNOWN";switch(i.type){case 0:n="NAVIGATE";break;case 1:n="RELOAD";break;case 2:n="BACK_FORWARD";break;case 255:n="RESERVED"}e.hostPageNavigationType=n}}!function(e){e[e.Unknown=0]="Unknown",e[e.Normal=1]="Normal",e[e.Minor=2]="Minor",e[e.Medium=3]="Medium",e[e.Major=4]="Major",e[e.Critical=5]="Critical"}(he||(he={}));var Ie=function(){function e(e,t){this.cr=function(){return _e(e,"OnBeforeUnload",t)},this.ur=function(){return _e(e,"OnPageHide",t)},this.lr=function(){return _e(e,"VisibilityChange_"+document.visibilityState,t)},this.dr=function(){return _e(e,"OnUnload",t)},window.addEventListener("beforeunload",this.cr,{capture:!0,once:!0}),window.addEventListener("pagehide",this.ur,{capture:!0}),window.addEventListener("visibilitychange",this.lr,{capture:!0}),window.addEventListener("unload",this.dr,{capture:!0,once:!0})}return e.prototype.dispose=function(){window.removeEventListener("beforeunload",this.cr,{capture:!0}),window.removeEventListener("pagehide",this.ur,{capture:!0}),window.removeEventListener("visibilitychange",this.lr,{capture:!0}),window.removeEventListener("unload",this.dr,{capture:!0})},e}();function _e(e,t,i){e.ULS.Ve(595957843,n.B,o.Info,"Page lifecycle: ".concat(t," fired")+(i?", flushing logger":"")),i&&e.ULS.flush()}var be=["https://augloop.office.com/v2","api://visio.officeapps.live.com/va/00695ed2-3202-4156-8da1-69f60065e255","394866fc-eedb-4f01-8536-3ff84b16be2a","https://officescripting.microsoft.com","https://officescripting-int.microsoft.com","https://nleditor.osi.office.net/nleditor","e03a13ee-9730-4cae-8525-47559c8cf18a","https://powerquery.microsoft.com","api://app.powerbi.com/00000009-0000-0000-c000-000000000000"],ye=function(){function e(e){var t=this;this.hr={},this.pr=[],this.mr=function(e){if(e&&e.origin)try{var i=e.data;if("string"==typeof i&&i.includes("AddinTrustedOrigin")){var r=JSON.parse(i),s=r.AddinTrustId;s&&"AddinTrustedOrigin"===r.MessageId&&(t.ei.ULS.Ve(560754784,n.B,o.Info,"didReceiveMessage addinTrustId ".concat(s)),t.hr[s]=e.origin,t.pr.forEach((function(t){t(s,e.origin)})))}}catch(e){t.ei.ULS.Ve(560754785,n.B,o.Error,"AuthTokenTrustValidator didReceiveMessage failed")}},this.ei=e,window.addEventListener("message",this.mr)}return e.prototype.isResourceTrustedForMessage=function(e){return t=this,i=void 0,s=function(){var t,i,r,s,a,c,u,l,d=this;return function(e,t){var i,n,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(a){return function(c){return function(a){if(i)throw new TypeError("Generator is already executing.");for(;r&&(r=0,a[0]&&(s=0)),s;)try{if(i=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{i=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}(this,(function(f){switch(f.label){case 0:return e&&e.Resource?(t=e.Resource,i=e.AddinTrustId,(r=function(e){if(!e)return!1;for(var t=e.toLowerCase(),i=0,n=be;i<n.length;i++){var o=n[i];if(o===t||"".concat(o,"/")===t)return!0}return!1}(t))||!i?[2,r]:this.hr[i]?[2,Te(t,this.hr[i])]:(a=new Promise((function(e){s=function(n,o){i===n&&e(Te(t,o))},d.pr.push(s)})),c=-1,u=new Promise((function(e){c=window.setTimeout((function(){d.ei.ULS.Ve(560754786,n.B,o.Warning,"isResourceTrustedForMessage - timeout waiting for addinTrustId: ".concat(i)),e(!1)}),2e3)})),[4,Promise.race([a,u])])):[2,!1];case 1:return l=f.sent(),this.pr=this.pr.filter((function(e){return e!==s})),window.clearTimeout(c),[2,l]}}))},new((r=void 0)||(r=Promise))((function(e,n){function o(e){try{c(s.next(e))}catch(e){n(e)}}function a(e){try{c(s.throw(e))}catch(e){n(e)}}function c(t){var i;t.done?e(t.value):(i=t.value,i instanceof r?i:new r((function(e){e(i)}))).then(o,a)}c((s=s.apply(t,i||[])).next())}));var t,i,r,s},e.prototype.dispose=function(){this.hr={},this.pr=[],window.removeEventListener("message",this.mr)},e}();function Te(e,t){try{if(!e||!t)return!1;for(var i=/[?&#%\\]/,n=0;n<e.length;n+=1){var o=e.charCodeAt(n);if(o<33||o>126)return!1;var r=e.charAt(n);if(i.test(r))return!1}var s=e;"api:"===s.substring(0,"api:".length).toLowerCase()&&(s="".concat("https:").concat(s.substring("api:".length)));var a=new URL(s);return"https:"===a.protocol&&t.toLowerCase()===a.origin.toLowerCase()}catch(e){return!1}}var Ce,Ee=function(){function e(e,t,i,r,s,a,c){var u,l,d=this;this.successTime=0,this.failureTime=0,this.timeoutTime=0,this.pendingReboot=!1,this.skipWopiValidation=!1,this.skipFileNameCheck=!1,this.appContext={},this.isLoggerFromOwl=!1,this.appUrl="",this.appBaseUrl="",this.appBasePath="",this.remoteTelemetryUrl="",this.vr={},this.onMessage=function(e){var t=e.MessageId,i=e.Values||{},r=d.vr[t];if(r&&r.length>0)d.wr(t,i);else{var s=pe[t];if(s){var a=s.rr,c=s.ar;a?(d.logger.ULS.Ve(574654543,n.B,o.Info,"Running flow: ".concat(a)),d.gr[a](t,i,d,d.Sr[a]).catch((function(e){d.Ir(a,e)}))):c&&(c===ue.Share&&(i.sendTimeAsClickTime=e.SendTime),d.raiseEvent(c,i))}}},this.Ir=function(e,t){d.logger.ULS.Ve(596459925,n.B,o.Error,"".concat(e," flow error: ").concat(ie(t))),d.remoteTelemetryUrl&&j(d.remoteTelemetryUrl,d.appInfo.name,"flowException")},this.wr=function(e,t){d.logger.ULS.Ve(574654544,n.B,o.Info,"Dispatching action: ".concat(e));for(var i=d.vr[e].slice().reverse(),r=i.length-1;r>-1;r-=1)try{i[r](e,t)}catch(t){d.logger.ULS.Ve(596444186,n.B,o.Error,"".concat(e," action handler error: ").concat(ie(t)))}return Promise.resolve({completion:"success"})},this.state=N.Unknown;var f=me(),h=f[0],p=f[1];this.isLoggerFromOwl=!!i.logger,this.logger=null!==(l=i.logger)&&void 0!==l?l:Z(),this.logger.ULS.Ve(593506837,n.B,o.Info,JSON.stringify(p)),this.sessionId=h,this.hostSessionId=i.hostSessionId,this.host=e.host,this.hostName=this.host.uiHostName||this.host.storageHostName,this.user=e.user,this.bootstrapperUrl=e.bootstrapperUrl,this.ui=e.ui||{},this.viewMode=e.viewMode,this.application=r,this.appInfo=t,this.session=s,this.featureManager=ne(e.host.capabilities&&e.host.capabilities.isFeatureEnabledCallback,this.logger),this.et=new fe(t.name,this.logger),this.preloader=t.preloader,u=a(this.featureManager),this.gr=u[0],this.Sr=u[1],this._r=c,this.clientDiagnostics=ge(),this.pageStateObserver=new Ie(this.logger,!0),this.authTokenTrustValidator=new ye(this.logger)}return Object.defineProperty(e.prototype,"diagnostics",{get:function(){return{hostInitDiagnostics:this.hostInitDiagnostics,appInitDiagnostics:this.appInitDiagnostics}},enumerable:!1,configurable:!0}),e.prototype.raiseEvent=function(e,t){this.logger.ULS.Ve(574654541,n.B,o.Info,"Raising event: ".concat(e));try{this._r(e,t)}catch(e){this.logger.ULS.Ve(593506838,n.B,o.Error,"Event handler error: ".concat(ie(e)))}},e.prototype.addActionHandler=function(e,t){this.vr[e]||(this.vr[e]=[]),this.vr[e].push(t)},e.prototype.removeActionHandler=function(e,t){var i=this.vr[e];if(i&&i.length>0){var n=i.indexOf(t);n>-1&&i.splice(n,1)}},e.prototype.run=function(e,t,i){var r=this;if(this.state===N.Disposed&&this.backgroundSession)return this.logger.ULS.Ve(525203609,n.B,o.Info,"Redirecting to background session: ".concat(e)),this.backgroundSession.run(e,t,i);var s=[],a=this.vr[e];if(a&&a.length>0)s.push(this.wr(e,t));else{var c=pe[e];if(c){var u=c.rr,l=c.sr;if(u){this.logger.ULS.Ve(574654542,n.B,o.Info,"Running flow: ".concat(u));var d=this.gr[u](e,t,this,this.Sr[u],i).catch((function(e){return r.Ir(u,e),{completion:"failure",errorSource:"jsapi",error:e}}));s.push(d)}else l&&(this.container&&this.container.postMessage(l,t),s.push(Promise.resolve({completion:"success"})))}else s.push(Promise.resolve({completion:"failure"})),this.logger.ULS.Ve(593500189,n.B,o.Warning,"Unhandled command: ".concat(e))}return Promise.race(s)},e.prototype.dispose=function(){if(this.successTime=0,this.failureTime=0,this.timeoutTime=0,this.et.dispose(),this.pageStateObserver.dispose(),this.authTokenTrustValidator.dispose(),this.vr={},!this.pendingReboot){var e=this.application.sessions,t=e.indexOf(this.session);t>-1&&e.splice(t,1)}},e}(),Ae=function(){function e(e,t,i,n,o,r){var s=this;!function(e){if(!e)throw new TypeError("SessionInitParams");if(!e.hostSessionId)throw new TypeError("HostSessionId")}(i),this.br=new Ee(e,t,i,n,this,r,(function(e,t){return o({type:e,data:t,session:s})})),this.br.state=N.Initialized}return Object.defineProperty(e.prototype,"id",{get:function(){return this.br.sessionId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"diagnostics",{get:function(){return this.br.diagnostics},enumerable:!1,configurable:!0}),e.prototype.run=function(e,t,i){return this.br.run(e,t,i)},e.prototype.boot=function(e,t){return this.br.run(se.boot,e,t)},e.prototype.dispose=function(e){return this.br.run(se.dispose,void 0,e)},e}();function Pe(e){if(!e)return"";var t=""+document.cookie,i=new RegExp("(?:^|; )"+e+"=([^;]*)"),n=t.match(i);return!n||n.length<2?"":n[1]}function Fe(e,t,i,n,o){void 0===n&&(n=Ce.none);var r=e+"="+t,s="",a=new Date;a.setTime(a.getTime()+31536e6);var c=new Date;c.setTime(c.getTime()+864e5*i),c>a&&(c=a),c&&(s=";expires="+c.toUTCString());var u=r+s+";SameSite="+Ce[n];return document.cookie=o?u+"; Secure":u,!(!document.cookie||-1===document.cookie.indexOf(r))||n===Ce.none&&Fe(e,t,i,Ce.doNotSet,o)}!function(e){e[e.doNotSet=0]="doNotSet",e[e.none=1]="none",e[e.lax=2]="lax",e[e.strict=3]="strict"}(Ce||(Ce={}));var Oe,Re=function(){function e(e,t,i,r){var s,a,c=this;this.yr="",this.Tr="",this.Cr=!1,this.Er=!1,this.Ar=!1,this.Pr=!1,this.Fr=function(e){var t,i=!1,r=!0,s="",a=!1;if(c.Or&&c.Or.contentWindow&&(i=!0,r=e.source===c.Or.contentWindow),e.origin&&!(a=(s=I(e.origin,2).toLowerCase())===c.Tr)&&c.Rr&&(s=I(e.origin).toLowerCase(),a=c.Rr.includes(s)),!c.Cr&&(!c.Er||a&&r)||c.ei.ULS.Ve(593232850,n.B,o.Info,"Window: available["+i+"] valid["+r+"]; Origin: valid["+a+"] expected["+c.Tr+"] actual["+s+"]"),a&&(!c.Ar||r)){var u;try{u=JSON.parse(e.data)}catch(e){return void c.ei.ULS.Ve(593232851,n.B,o.Info,"Failed to parse event data: ".concat(ie(e)))}var l=u.MessageId;if(l){if(c.ei.ULS.Ve(593232854,n.B,o.Info,"Received message: ".concat(l,", correlation: ").concat(u.CorrelationId)),l!==ae.gi&&l!==ae.Bi||c.setTargetOrigin(e.origin),u.Values&&u.Values.ackExpected&&c.postMessage(ce.ao,void 0,u.CorrelationId),c.Pr&&l===ae.eo)return window._pageTimings=null!==(t=window._pageTimings)&&void 0!==t?t:{},void(window._pageTimings[u.Values.name]=u.Values.time);if(c.Ur)try{c.Ur(u)}catch(e){c.ei.ULS.Ve(594556386,n.B,o.Error,"Message handler error: ".concat(ie(e)))}else c.ei.ULS.Ve(591933923,n.B,o.Error,"No message handler")}else(c.Cr||c.Er)&&c.ei.ULS.Ve(593232853,n.B,o.Info,"Missing message id")}},this.ei=t,this.setTargetOrigin(e),this.Rr=r,i&&this.setMessageHandler(i),this.Pr=!!(null===(a=null===(s=window.location)||void 0===s?void 0:s.search)||void 0===a?void 0:a.match(/wdpa=1/gi))||"1"===Pe("EnableMetricLogging"),window.addEventListener("message",this.Fr,!1)}return e.prototype.setTargetOrigin=function(e){var t=S(e).toLowerCase();this.yr&&this.yr!==t&&this.ei.ULS.Ve(593232847,n.B,o.Warning,"Updating origin: [".concat(R(this.yr),"]->[").concat(R(t),"]")),this.yr=t,this.Tr=I(t,2),this.Cr=m(t),this.Er=v(t)},e.prototype.setTargetFrame=function(e,t){this.Or=e,this.Ar=!!t},e.prototype.setMessageHandler=function(e){this.Ur=e},e.prototype.removeMessageHandler=function(){this.Ur=void 0},e.prototype.postMessage=function(e,t,i){if(this.Or&&this.Or.contentWindow){this.ei.ULS.Ve(593232849,n.B,o.Info,"Sending message: "+e);var r={MessageId:e,SendTime:q(),CorrelationId:i,Values:t};this.Or.contentWindow.postMessage(JSON.stringify(r),this.yr)}else this.ei.ULS.Ve(593232848,n.B,o.Error,"Missing target to send message: "+e)},e.prototype.dispose=function(){window.removeEventListener("message",this.Fr,!1),this.Ur=void 0},e}();function Ue(e,t){c()===r.Safari?e.style.display=t?"none":"block":e.style.visibility=t?"hidden":"visible"}function We(e,t,i){_(t,Oe.Wr,String(i?window.outerHeight:e.offsetHeight)),_(t,Oe.xr,String(i?window.outerWidth:e.offsetWidth)),_(t,Oe.kr,String(u())),_(t,Oe.Mr,String(l())),_(t,Oe.Nr,String(f())),_(t,Oe.Hr,String(function(){try{return window.matchMedia("(prefers-color-scheme: dark)").matches}catch(e){return!1}}()))}function xe(e){try{return window===window.top||window.parent===window.top&&window.location.origin===window.top.origin}catch(t){return e&&e.ULS.Ve(591525084,n.B,o.Info,"Trust check error: ".concat(ie(t))),!1}}!function(e){e.Dr="access_token",e.Vr="access_token_ttl",e.Lr="wac_token",e.Br="bundleSrc",e.Jr="bundleStaleness",e.jr="DocID",e.Gr="SiteID",e.qr="WebID",e.zr="ETag",e.Kr="feature_status",e.Xr="fileExtension",e.$r="fileGetUrl",e.Zr="customFontCatalogUrl",e.Qr="fileName",e.Yr="fileSize",e.Nr="forceSLR",e.Wr="frameHeightPx",e.xr="frameWidthtPx",e.Mr="highContrast",e.ts="highDpi",e.ns="host_diagnostics",e.os="hostName",e.ss="huictrls",e.as="owner_id",e.us="sc",e.ls="softBlockedBrowser",e.ds="templateUrl",e.kr="touchMode",e.fs="user_id",e.hs="hfck",e.ps="hfcv",e.ms="timeZoneId",e.Hr="darkCssMedia",e.vs="caae",e.ws="meetingId",e.gs="meetingTitle",e.Ss="meetingType",e.Is="scheduledStartTime",e._s="scheduledEndTime",e.bs="isPresenter",e.ys="meetingOrganizerId",e.Ts="meetingJoinUrl",e.Cs="isMeetingTeamsRoom",e.Es="jsapibuild",e.As="owlver",e.Ps="owlro",e.Fs="caaemode",e.Os="traceparent",e.Rs="tracestate",e.Us="supports_zipit"}(Oe||(Oe={}));var ke,Me,Ne,He,De,Ve,Le,Be,Je,je,Ge,qe,ze,Ke,Xe=function(){function e(e,t){!function(e){if(!e||!e.appendChild)throw TypeError("Container")}(e),this.Ws=e,this.xs=t,this.ks=t+"_Form",this.Ms=xe()}return Object.defineProperty(e.prototype,"element",{get:function(){return this.Ws},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frameId",{get:function(){return this.xs},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formId",{get:function(){return this.ks},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTopFrameTrusted",{get:function(){return this.Ms},enumerable:!1,configurable:!0}),e.prototype.boot=function(e,t,i,r){var s=this;this.ei=i,this.Ns=new Re(e,i,this.Ur,r.additionalReceivingDomainList);var a=r.useAdditionalDiv,c=r.permissionsPolicy;this.Hs&&!a?(this.Hs.setAttribute("allow",c),this.ei.ULS.Ve(588793045,n.B,o.Info,"Wac frame reused")):(this.Hs=function(e,t,i,n,o,r,s,a){e.style.top="0",e.style.bottom="0",e.style.left="0",e.style.right="0",e.style.height="100%",e.style.width="100%";var c=e.ownerDocument,u=c.createElement("iframe");if(u.id=t,u.name=t,u.src="",u.title="Office on the web Frame",u.marginWidth="0",u.marginHeight="0",u.style.top="0",u.style.bottom="0",u.style.left="0",u.style.right="0",u.style.height="100%",u.style.width="100%",u.style.display="block",u.style.position="absolute",u.style.backgroundColor="transparent",u.style.border="none",u.frameBorder="0",u.setAttribute("allowfullscreen","true"),u.setAttribute("allowTransparency","true"),u.setAttribute("allow",i),Ue(u,s),n&&(e.style.minHeight=n,u.style.minHeight=n),o&&(e.style.minWidth=o,u.style.minWidth=o),a&&u.setAttribute("role","none"),r){var l=c.createElement("div");l.style.top="0",l.style.bottom="0",l.style.left="0",l.style.right="0",l.style.height="100%",l.style.width="100%",l.style.backgroundColor="#393a3d",l.style.backfaceVisibility="hidden",n&&(l.style.minHeight=n),o&&(l.style.minWidth=o),l.appendChild(u),e.appendChild(l)}else e.appendChild(u);return u}(this.Ws,this.xs,c,r.minHeight,r.minWidth,a,r.isInvisible,r.setNoneRole),this.ei.ULS.Ve(588793046,n.B,o.Info,"Wac frame created")),this.Ns.setTargetFrame(this.Hs,r.enforceSameWindow),a&&(this.Ds=this.Hs.parentElement),r.useFrameFixForTeams&&i.ULS.Ve(509143245,n.B,o.Info,"Frame fix enabled for teams uiHost"),We(this.Hs,t,r.useFrameFixForTeams),this.Vs=function(e,t,i,n,o){var r=e.ownerDocument,s=r.createElement("form");for(var a in s.id=i,s.name=i,s.action=n,s.target=t,s.method="POST",o){var c=r.createElement("input");c.type="hidden",c.name=a,c.value=o[a],s.appendChild(c)}return e.appendChild(s),s}(this.Ws,this.xs,this.ks,e,t);try{this.Vs.submit()}catch(e){this.ei.ULS.Ve(507909977,n.B,o.Warning,"WAC frame failed to submit, will retry. Error: ".concat(ie(e))),new Promise((function(e){window.setTimeout(e,10)})).then((function(){s.Vs.submit()})).catch((function(e){throw s.ei.ULS.Ve(507909976,n.B,o.Error,"WAC frame failed to submit on retry. Error: ".concat(ie(e))),e}))}},e.prototype.setVisibility=function(e){this.Hs&&Ue(this.Hs,e)},e.prototype.setMessageHandler=function(e){this.Ur=e,this.Ns&&this.Ns.setMessageHandler(e)},e.prototype.setWrapperPostMessage=function(e){this.Ls=e},e.prototype.removeMessageHandler=function(){this.Ur=void 0,this.Ns&&this.Ns.removeMessageHandler()},e.prototype.postMessage=function(e,t){this.Ls?this.Ls(e,t):this.Ns&&this.Ns.postMessage(e,t)},e.prototype.dispose=function(e,t){var i=this;return new Promise((function(n){if(i.Vs&&(i.Ws.removeChild(i.Vs),i.Vs=void 0),i.Ns&&(i.Ns.dispose(),i.Ns=void 0,i.Ur=void 0),i.Ls&&(i.Ls=void 0),i.ei=void 0,!i.Hs||!i.Ds&&e)n();else{var o=function(){i.Ds?(i.Ds.removeChild(i.Hs),i.Ws.removeChild(i.Ds)):i.Ws.removeChild(i.Hs),i.Hs=void 0,i.Ds=void 0,n()};t?o():(i.Hs.src="about:blank",window.setTimeout(o,0))}}))},e}(),$e=function(){function e(e,t,i){var n,o=this;this.sessions=[],this.containers=[],this.Bs=function(e){o.Js.dispatch(e)},function(e){if(!e)throw new TypeError("ApplicationInitParams");var t=e.host;if(!t||!t.storageHostName)throw new TypeError("HostInfo");var i=e.user;if(!i||null==i.id)throw new TypeError("UserInfo")}(e),this.js=e,this.Gs=t,this.qs=i,this.Js=new de,(n=e.host.owlVersion)&&(B.BUILD_NUMBER=n)}return Object.defineProperty(e.prototype,"name",{get:function(){return this.Gs.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return J()},enumerable:!1,configurable:!0}),e.prototype.addEventListener=function(e){this.Js.add(e)},e.prototype.removeEventListener=function(e){this.Js.remove(e)},e.prototype.createContainer=function(e){var t="WacFrame_".concat(this.Gs.name,"_").concat(this.containers.length),i=new Xe(e,t);return this.containers.push(i),i},e.prototype.createSession=function(e){var t=new Ae(this.js,this.Gs,e,this,this.Bs,this.qs);return this.sessions.push(t),t},e.prototype.dispose=function(e){var t=this,i=this.sessions.map((function(t){return t.dispose(e).catch((function(e){}))}));return Promise.all(i).then((function(e){return t.Js.removeAll(),t.sessions=[],t.containers=[],{completion:"success"}}))},e}(),Ze=!1,Qe=!1;function Ye(){Ze=!1}function et(e,t,i,r,s,a,c){if(t.ULS.Ve(595714433,n.B,o.Info,"Starting disposing the application. unloadApp:".concat(e,"; disposed:").concat(Ze,"; unloading:").concat(Qe)),Ze||Qe&&e)t.ULS.Ve(595714908,n.B,o.Info,"Application is already disposed or unloading");else{var u,l={logger:t,postMessenger:i,innerApplicationFrame:r,onDisposed:s,onFrameRemoved:a,unloadTimeoutInMs:c||1e3,forceAppUnload:!1,disposeStartTime:q(),appUnloadTimedOut:!1};if(e&&r)return Qe=!0,l.forceAppUnload=!0,(u=l).forceAppUnloadStartTime=q(),u.logger.ULS.Ve(595855490,n.B,o.Info,"Sending postmessage to unload app"),u.logger.ULS.flush(),u.postMessenger.registerMessagePayloadHandler(ae.dn,(function(e){return function(e,t){e.forceAppUnloadEndTime=q(),e.appUnloadedMessageValues=t,e.logger.ULS.Ve(595855491,n.B,o.Info,"AppUnloaded received from app"),tt(e)}(u,e)})),u.postMessenger.sendPostMessage(u.innerApplicationFrame,ce.zo,{}),void window.setTimeout((function(){return function(e){!Qe&&Ze||(e.appUnloadTimedOut=!0,e.logger.ULS.Ve(595855492,n.B,o.Info,"ApplicationUnload timed out, forcing dispose"),tt(e))}(u)}),u.unloadTimeoutInMs);tt(l)}}function tt(e){if(!Ze)try{Ze=!0,Qe=!1,function(e){e.innerApplicationFrame&&(e.innerApplicationFrame.src="about:blank",window.setTimeout((function(){e.innerApplicationFrame&&e.innerApplicationFrame.parentElement&&e.innerApplicationFrame.parentElement.removeChild(e.innerApplicationFrame),e.onFrameRemoved&&e.onFrameRemoved()}),0))}(e),function(e){var t={disposeStartTime:e.disposeStartTime,disposeEndTime:q(),forceAppUnload:e.forceAppUnload,appUnloadTimedOut:e.appUnloadTimedOut};if(e.forceAppUnloadStartTime&&(t.appUnloadStartTime=e.forceAppUnloadStartTime),e.forceAppUnloadEndTime&&(t.appUnloadEndTime=e.forceAppUnloadEndTime),e.appUnloadedMessageValues){var i=e.appUnloadedMessageValues,r=Number(i.hostMessageReceived);e.forceAppUnloadStartTime&&!isNaN(r)&&(t.hostToAppPostMessageLatency=r-e.forceAppUnloadStartTime);var s=Number(i.appMessageSent);!isNaN(s)&&e.forceAppUnloadEndTime&&(t.appToHostPostMessageLatency=e.forceAppUnloadEndTime-s);var a=Number(i.appUnloadStart),c=Number(i.appUnloadEnd);if(isNaN(a)||isNaN(c)||(t.appUnloadLatency=c-a),i.serverTimings){var u=i.serverTimings;for(var l in u)t["st-"+l.toString()]=u[l]}}e.logger.ULS.Ve(595855436,n.B,o.Info,"App disposed "+JSON.stringify(t)),e.logger.ULS.flushOnClose()}(e),e.onDisposed&&e.onDisposed()}catch(t){e.logger.ULS.Ve(595714434,n.B,o.Error,"Error disposing: ".concat(ie(t)))}}function it(e,t){return e+"_layouts/RemoteTelemetry.ashx"+(t?"?usid="+t:"")}function nt(e,t){return it(rt(e),t)}function ot(e,t,i,n,o,r){void 0===r&&(r=!1),e.SessionInformation.IsCore&&(e.SessionInformation.HideViewerToolbar=!0),function(e,t){var i=e.SessionInformation;if(i.WdParams||(i.WdParams={}),!i.WdParams.wd){t.substring(1).split("&").filter((function(e){if(0===e.indexOf("wd")){var t=e.split("=");t[0].length>2&&(i.WdParams[t[0]]=t[1])}}));var n=e.RebootOverrideData;n&&n.previousSessionId&&(i.WdParams.wdprevioussession=n.previousSessionId)}}(e,window.location.search);var s=o||new fe("Excel",i),a=rt(e.ApplicationUrl);return{container:e.Container,sessionInformation:e.SessionInformation,applicationUrl:e.ApplicationUrl,wopiPrecheckInfo:e.WopiPrecheckInfo,applicationCustomSettings:e.ApplicationCustomSettings,diagnostics:{HostInitDiagnostics:e.Diagnostics,ClientDiagnostics:ge(),AppInitDiagnostics:{officeSessionId:t,officeBootstrapperVersion:J(),hostName:e.SessionInformation.HostName},SessionTraces:{}},fnOnInitializeSuccess:e.FnOnInitializeSuccess,fnOnInitializeFailure:e.FnOnInitializeFailure,sessionId:t,applicationBasePath:a,remoteTelemetryUrl:it(a,t),wopiInfo:e.WopiInfo,forceSingleStepBoot:r,isCreateNew:e.WopiPrecheckInfo.IsNewFile||F(e.ApplicationUrl,"new"),featureManager:n||ne(e.FnIsFeatureEnabled,i),et:s,newFileTemplateSource:e.NewFileTemplateSource,rebootOverrideData:e.RebootOverrideData,pageStateObserver:new Ie(i,!0)}}function rt(e){var t=e.match(/^(.*?\/\/[^\/]+\/[^\/]+\/)(.*)$/);if(!t)throw new Error("Invalid URL");return t[1]}function st(e,t){t&&t.Diagnostics&&Object.keys(t.Diagnostics).forEach((function(i){return e[i]=t.Diagnostics[i]}))}function at(e,t,i){t.ULS.Ve(596459999,n.B,i,"SessionTraces: "+JSON.stringify(e))}function ct(e,t){t.stop();var i=t.getVisibilityChangeEvents();null!=i&&i.length>0&&(e.AppInitDiagnostics.documentLoadedWithTabSwitch=!0,e.SessionTraces.tabSwitchDiagnostics=JSON.stringify(i)),t.dispose()}function ut(e,t,i){try{var r=function(e,t){var i=Y({},t);delete i.UserId,delete i.OwnerId,delete i.SiteId,delete i.WebId,delete i.Upn,delete i.TenantId,delete i.UiHostTabId,delete i.OriginalWdParam,delete i.WdParams;var n=i,o=t.WdParams?JSON.parse(JSON.stringify(t.WdParams).toLowerCase()):{};n.WdParams={},["wdorigin","wdpreviouscorrelation","wdprevioussession","wdtf"].forEach((function(e){o[e]&&(n.WdParams[e]=o[e])}));var r=/^\w{8}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{12}$/i;return n.WdParams.wdprevioussession&&!r.test(n.WdParams.wdprevioussession)&&delete n.WdParams.wdprevioussession,n.WdParams.wdpreviouscorrelation&&!r.test(n.WdParams.wdpreviouscorrelation)&&delete n.WdParams.wdpreviouscorrelation,n.UiEmbedMode=F(e,"uiembed"),n.UiHostName=y(e,"uih")||"N/A",n.HostDomain=location?location.hostname:"",n}(t.applicationUrl,t.sessionInformation);r.Build=J(),r.Region=w(t.applicationUrl);var s=Y({},t.rebootOverrideData);delete s.ackExpected,delete s["ui-language"],delete s.wdUserSession,delete s.rebootMode,delete s.documentUrl,r.RebootOverride=s;var a=t.diagnostics.HostInitDiagnostics;a&&(e.ULS.Ve(596444238,n.B,o.Info,"HostInitDiagnostics: "+JSON.stringify(t.diagnostics.HostInitDiagnostics)),r.SessionOrigin=a.entryPoint),i&&e.ULS.Ve(595937313,n.B,o.Info,JSON.stringify(i)),e.ULS.Ve(595632928,n.B,o.Info,function(){if(window&&window.navigator){var e=window.navigator,t=e.connection||e.mozConnection||e.webkitConnection;if(t)return"EffectiveType: "+t.effectiveType+", BandwidthMps: "+t.downlink+", ConnectionType: "+t.type}return""}());var c=t.wopiInfo;c&&c.AccessToken&&c.AccessTokenExpiry||e.ULS.Ve(595894553,n.B,o.Warning,"There are some missing parameters"),c&&(c.AccessToken&&(r.AccessTokenLength=c.AccessToken.length),r.AccessTokenExpiry=c.AccessTokenExpiry,c.WacToken&&(r.WacTokenLength=c.WacToken.length)),"Microsoft Teams"===t.sessionInformation.HostName&&e.ULS.Ve(507122579,n.B,o.Important,"".concat("Excel"," setting Force View only for Teams WXP Files session.")),r.JsApiVersion="v1",e.ULS.Ve(596444237,n.B,o.Info,JSON.stringify({session:r,client:t.diagnostics.ClientDiagnostics}))}catch(t){e.ULS.Ve(558155802,n.B,o.Error,"Failed to log initialization info: ".concat(ie(t)))}}function lt(e){return new RegExp("xlviewerinternal.aspx","i").test(e)}function dt(e){return new RegExp("xlembed.aspx","i").test(e)}function ft(e){return new RegExp("xlpreview.aspx","i").test(e)}function ht(e,t,i,r){Le=e,Be=t,Je=void 0,je=i,Ge=r,Me=!1,Ne=!1,He=0,wt(),setTimeout((function(){Le.ULS.Ve(593589517,n.B,o.Info,"ExcelLandingPageObserver:initExcelLandingPageObserver heartbeat signal called after ms: 3000")}),3e3),setTimeout((function(){!function e(){He>=3?Le.ULS.Ve(595350870,n.B,o.Info,"ExcelLandingPageObserver: checkFirstFlushArrived  Max Limit reached for retry attempts3"):(wt(),Me?setTimeout((function(){(!Ne||He>0)&&Le.ULS.Ve(595350872,n.B,o.Info,"ExcelLandingPageObserver: checkSecondFlushArrived Second Flush status: "+Ne+" after first flush retry attempt: "+He)}),Ve):(He+=1,Le.ULS.Ve(595350871,n.B,o.Info,"ExcelLandingPageObserver: checkFirstFlushArrived  Retry Request: "+He),je&&je.isFeatureEnabled(Q.Nt)&&1===He&&document.getElementById(Be).submit(),setTimeout((function(){e()}),De)))}()}),De),je&&je.isFeatureEnabled(Q.Mt)&&(window.localStorage?window.addEventListener("offline",gt):Le.ULS.Ve(593589518,n.B,o.Info,"ExcelLandingPageObserver:initExcelLandingPageObserver localstorage not supported by Browser. Skip saving in cache")),Le.ULS.Ve(594622165,n.B,o.Info,"ExcelLandingPageObserver:initExcelLandingPageObserver called with OfflineTelemetry: "+"".concat(je?je.isFeatureEnabled(Q.Mt):"False [featureManager undefined]"))}function pt(e){"PageLoadSkeleton Presented"===e?Me=!0:"BootstapContext Recieved"===e&&(Ne=!0)}function mt(){if(je&&je.isFeatureEnabled(Q.Mt))if(window.localStorage)for(var e=0;e<localStorage.length;e+=1)try{var t=localStorage.key(e);if("OfflineMode_"===t.substring(0,"OfflineMode_".length)){var i=localStorage.getItem(t);Le.ULS.Ve(593589520,n.B,o.Info,"ExcelLandingPageObserver:uploadOfflineModeTelemetry Message"+i),localStorage.removeItem(t)}}catch(e){Le.ULS.Ve(593589521,n.B,o.Error,"ExcelLandingPageObserver:uploadOfflineModeTelemetry exception during loading from cache. Exception: "+ie(e))}else Le.ULS.Ve(593589519,n.B,o.Info,"ExcelLandingPageObserver:uploadOfflineModeTelemetry localstorage not supported by Browser. Skip uploading")}function vt(e){return lt(e)||dt(e)}function wt(){De=3750,Ve=6e3;var e=function(){if(window&&window.navigator){var e=window.navigator.connection||window.navigator.mozConnection||window.navigator.webkitConnection;return e?e.effectiveType:void 0}}();if(void 0!==e)switch(void 0!==Je&&Je!==e&&Le.ULS.Ve(595350873,n.B,o.Info,"ExcelLandingPageObserver: initializeTimeOutIntervals previousConnection: "+Je+" currentConnection: "+e+" First Flush: "+Me+" Second Flush:"+Ne),Je=e,e){case"4g":De=3750,Ve=6e3;break;case"3g":De=5e3,Ve=8e3;break;case"2g":De=1e4,Ve=24e3;break;case"slow-2g":De=2e4,Ve=4e4}}function gt(){try{var e=q(),t="OfflineMode_"+Ge+"_"+e,i={"Sessionid:":Ge,OfflineTime:e};localStorage.setItem(t,JSON.stringify(i))}catch(e){Le.ULS.Ve(593589522,n.B,o.Error,"ExcelLandingPageObserver:logOfflineModeTelemetry exception during saving into cache exception: "+ie(e))}}function St(e,t,i){void 0===t&&(t=void 0),void 0===i&&(i=void 0),qe=e;try{window.localStorage?i?(i.addActionHandler(ae.bn,(function(e,t){_t(t)})),i.addActionHandler(ae.yn,(function(e,t){bt(t)}))):t&&(t.registerMessagePayloadHandler(ae.bn,(function(e){_t(e)})),t.registerMessagePayloadHandler(ae.yn,(function(e){bt(e)}))):qe.ULS.Ve(574677217,n.B,o.Warning,"ExcelHostFrameCacheManager: initHostFrameCacheManager: localstorage not supported by Browser. Skip saving HostFrame cache save")}catch(e){qe.ULS.Ve(574677218,n.B,o.Warning,"ExcelHostFrameCacheManager: initHostFrameCacheManager: error while initializing.")}}function It(e,t,i){try{qe||(qe=e);var r="".concat(t[Oe.jr],"_").concat(i,"_").concat(t[Oe.os],"_").concat(t[Oe.fs]);if(r="XlHc_"+function(e){var t=0,i=e.length,n=0;if(i>0)for(;n<i;)t=(t<<5)-t+e.charCodeAt(n)|0,n+=1;return t}(r),t[Oe.hs]=r,window.localStorage){var s=localStorage.getItem(r);null!==s&&(t[Oe.ps]=s)}else qe.ULS.Ve(574677219,n.B,o.Warning,"ExcelHostFrameCacheManager: setHostFrameCachePostData: localstorage not supported by Browser. Skip saving HostFrame cache save")}catch(e){qe.ULS.Ve(574677248,n.B,o.Warning,"ExcelHostFrameCacheManager: setHostFrameCachePostData: error while setting host frame cache post data.")}}function _t(e){if(e&&e.hasOwnProperty("cacheItemKey")&&0===e.cacheItemKey.indexOf("XlHc_")&&e.hasOwnProperty("cacheItemValue"))try{window.localStorage.setItem(e.cacheItemKey,e.cacheItemValue),qe.ULS.Ve(574677249,n.B,o.Info,"ExcelHostFrameCacheManager: handleHostFrameSaveMessage: setting localstorage HostFrame cache item")}catch(e){qe.ULS.Ve(574677250,n.B,o.Warning,"ExcelHostFrameCacheManager: handleHostFrameSaveMessage: error while saving HostFrame to local storage. error: "+ie(e))}else qe.ULS.Ve(574677251,n.B,o.Warning,"ExcelHostFrameCacheManager: handleHostFrameSaveMessage: HostFrame cache save message does not contain all expected values, skipping HostFrame cache save")}function bt(e){if(e&&e.hasOwnProperty("workbookList")&&e.hasOwnProperty("evictAllExceptListed"))try{var t=e.evictAllExceptListed,i=JSON.parse(e.workbookList);qe.ULS.Ve(574677252,n.B,o.Info,"ExcelHostFrameCacheManager: handleHostFrameEvictMessage: removing items from cache. workbookList length: "+i.length+", evictAllExceptListed: "+t),!0===t?function(e){for(var t=new Date,i=new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds()).getTime(),r=0;r<localStorage.length;r+=1){var s=localStorage.key(r),a=!1;if(0===s.indexOf("XlHc_")){if(e.indexOf(s)<0)a=!0;else{var c=localStorage.getItem(s),u=void 0;try{u=JSON.parse(c)}catch(e){qe.ULS.Ve(574677255,n.B,o.Warning,"ExcelHostFrameCacheManager: evictAllItemsExcept: unable to check for stale HostFrame cache, error parsing HostFrame cache item, error: "+ie(e))}u?i-u.LastModified>5184e6&&(a=!0):a=!0}a&&(localStorage.removeItem(s),qe.ULS.Ve(574677256,n.B,o.Verbose,"ExcelHostFrameCacheManager: EvictAllItemsExcept: Removed HostFrame cache item"))}}}(i):function(e){for(var t=0;t<e.length;t+=1)localStorage.removeItem(e[t]),qe.ULS.Ve(574677257,n.B,o.Verbose,"ExcelHostFrameCacheManager: EvictSpecificItems: Removed HostFrame cache item")}(i)}catch(e){qe.ULS.Ve(574677253,n.B,o.Warning,"ExcelHostFrameCacheManager: handleHostFrameEvictMessage: error while evicting HostFrame from local storage. error: "+ie(e))}else qe.ULS.Ve(574677254,n.B,o.Warning,"ExcelHostFrameCacheManager: handleHostFrameEvictMessage: HostFrame cache evict message does not contain all expected values")}function yt(e,t,i){void 0===i&&(i=!1);var n=e.applicationUrl;e.wopiPrecheckInfo.IsNewFile&&n.replace("unified=1","edit=1&new=1");var o={};if("Microsoft Teams"===e.sessionInformation.HostName&&(o.fvo="1",e.et.getValue(K.Wt,!1)&&(n=E(n,"unified")),e.et.getValue(K.Ct,!1)&&(o.readOnly="1")),o.jsApi="1",o.jsapiver="v1",i&&(o.NewSession="1"),o.corrid=e.sessionId,o.usid=e.sessionId,o.sftc="1",(e.applicationCustomSettings&&e.applicationCustomSettings.IsCore||e.sessionInformation.IsCore)&&(o.core="1"),e.sessionInformation.HideViewerToolbar&&(o.hvt="1"),e.sessionInformation.HideEditUpsellDialog&&(o.hdeditdlg="1"),e.sessionInformation.DisableFocusOnBoot&&(o.disableFocusOnBoot="1"),e.sessionInformation.HighContrastMode&&(o.hcm=encodeURIComponent(e.sessionInformation.HighContrastMode)),e.sessionInformation.SupportsAtMentions&&(o.sams="1"),e.sessionInformation.SupportsAccessibilityLoop&&(o.accloop="1"),e.sessionInformation.SupportsDocReboot){var r=e.sessionInformation.SupportsDocReboot;o.sdr=!0===r?"1":r.toString()}e.sessionInformation.SupportsCreateNewDocument&&(o.scnd="1"),e.sessionInformation.SupportsAuthToken&&(o.sat="1"),e.sessionInformation.SupportsCustomAuthConfig&&(o.cac="1"),e.sessionInformation.SupportsMoveToFolder&&(o.mtf="1"),e.sessionInformation.SupportsCommonFilePicker&&(o.sfp="1"),e.sessionInformation.OpenLinksInNewWindow&&(o.onw="1"),e.sessionInformation.UseDarkTheme&&(o.udt="1"),e.sessionInformation.SupportsExcelExternalLinks&&(o.xlel="1"),e.sessionInformation.SupportsRefreshAccessToken&&(o.rat="1"),(e.sessionInformation.HideHeader||"DocGen"===e.sessionInformation.ContentAssemblyMode||"Templatization"===e.sessionInformation.ContentAssemblyMode||"ContentAssemblyEdit"===e.sessionInformation.ContentAssemblyMode||"ContentAssemblyView"===e.sessionInformation.ContentAssemblyMode)&&(o.hhdr="1"),e.sessionInformation.HideAppLauncherInHeader&&(o.halh="1"),e.sessionInformation.HideChatInHeader&&(o.hch="1"),e.sessionInformation.HideMeInHeader&&(o.hmh="1"),e.sessionInformation.HideSearchInHeader&&(o.hsh="1"),e.sessionInformation.HideWorkflowInHeader&&(o.hwfh="1"),e.sessionInformation.HideSettingsInHeader&&(o.hsth="1"),e.sessionInformation.ShowAppIconInHeader&&(o.sih="1"),e.sessionInformation.UseNeutralColorInHeader&&(o.unh="1"),e.sessionInformation.HideBreadCrumbInViewer&&(o.hbcv="1"),e.sessionInformation.HideTitleInViewer&&(o.htv="1"),e.sessionInformation.HideWACOneDriveFileLocationPicker&&(o.hodflp="1"),e.sessionInformation.NoBrowserModalDialogs&&(o.nbmd="1"),e.applicationCustomSettings&&e.applicationCustomSettings.FixDiagnosticsJson&&(o.fixdiag="1"),e.wopiPrecheckInfo.ReadOnly&&(o.readOnly="1"),"DocGen"!==e.sessionInformation.ContentAssemblyMode&&"ContentAssemblyView"!==e.sessionInformation.ContentAssemblyMode||(o.readOnly="1"),e.sessionInformation.UIEmbed&&(o.uiEmbed="1"),e.sessionInformation.IsSynthetic&&(o.syn="1"),e.sessionInformation.SupportsDirectDownload&&(o.sdd="1"),e.sessionInformation.SupportsDirectPrint&&(o.sdp="1"),e.sessionInformation.UiHostIntegrationType&&(o.uihit=encodeURIComponent(e.sessionInformation.UiHostIntegrationType)),e.sessionInformation.MetaUiHostVersion&&(o.muv=encodeURIComponent(e.sessionInformation.MetaUiHostVersion)),e.applicationCustomSettings&&e.applicationCustomSettings.InAppDocumentPreview&&(o.InAppDocPreview="1"),t.isSingleStepBoot?(t.bootFlowType===ze.unifiedSingleFlush&&(e.isCreateNew||(o.instantedit="1",o.wopicomplete="1")),o.wdRedirectionReason=t.bootFlowType):(o.instantedit="1",o.fileSrc=encodeURIComponent(e.sessionInformation.HostName),o.pmOrigin=encodeURIComponent(S(window.location.href)),e.isCreateNew&&(o.new="1",e.wopiPrecheckInfo.IsNewFileFromHostTemplate&&(o.wdTpl="fromhost"))),e.wopiPrecheckInfo.PreseededSessionKey&&(o.preseededSessionKey=encodeURIComponent(e.wopiPrecheckInfo.PreseededSessionKey)),e.wopiPrecheckInfo.PreseededWacSessionId&&(o.preseededWacSessionId=encodeURIComponent(e.wopiPrecheckInfo.PreseededWacSessionId)),e.wopiPrecheckInfo.RequestedCallThrottling&&(o.rct=e.wopiPrecheckInfo.RequestedCallThrottling),e.wopiPrecheckInfo.ClientThrottlingProtection&&(o.ctp=e.wopiPrecheckInfo.ClientThrottlingProtection);var s=e.wopiPrecheckInfo.FileSize;return s&&s>=52428800&&s<=104857600&&(o.ilf="1"),e.applicationCustomSettings&&e.applicationCustomSettings.additionalApplicationParameters&&(o=Y(Y({},e.applicationCustomSettings.additionalApplicationParameters),o)),e.rebootOverrideData&&e.rebootOverrideData.queryOverrides&&(o=Y(Y({},o),e.rebootOverrideData.queryOverrides)),function(e,t,i,n,o){var r=C(e);("teams"===r.uih&&"UnifiedUiHostTeams"!==t.UiHostIntegrationType&&"TeamsModern"!==t.UiHostIntegrationType||"owa"===r.uih)&&(r.hhdr="1");var s=e.indexOf("?"),a=-1===s?e.concat("?"):e.substring(0,s+1);t.UiLocale&&(r.ui=encodeURIComponent(t.UiLocale)),t.DataLocale&&(r.rs=encodeURIComponent(t.DataLocale)),t.HostSessionId&&(r.hid=encodeURIComponent(t.HostSessionId)),t.DisableChat&&(r.dchat="1"),t.SessionContext&&(r.sc=encodeURIComponent(t.SessionContext)),i&&i.WopiSrc&&(r.wopisrc=encodeURIComponent(i.WopiSrc)),t.CookieCompliant&&(r.mscc="1"),n&&(n.entryPoint&&(r.wdorigin=encodeURI(n.entryPoint)),n.userClickTime&&(r.wdhostclicktime=n.userClickTime.toString())),r=Y(Y(Y({},r),t.WdParams),o);var c={};for(var u in r)c[u.toLowerCase()]=r[u];var l=[];for(var u in c)c[u]&&l.push(u.concat("=",c[u]));return a.concat(l.join("&"))}(n,e.sessionInformation,e.wopiInfo,e.diagnostics.HostInitDiagnostics,o)}function Tt(e){return e.AccessTokenExpiry?e.AccessTokenExpiry.getTime().toString():"0"}!function(e){e.AppInitError="AppInitError",e.ApiDisabledError="ApiDisabledError",e.CannotLoadFirstPage="CannotLoadFirstPage",e.InvalidWopiInfo="InvalidWopiInfo",e.TimeoutWacReady="TimeoutWacReady",e.WacFailed="WacFailed"}(ke||(ke={})),function(e){e.bootWithoutWopiInfo="",e.unifiedSingleFlush="Unified_SingleFlush",e.unifiedIrmEnabled="Unified_IrmEnabled",e.unifiedViewActionUrl="Unified_ViewActionUrl",e.unifiedNotEditOrViewActionUrl="Unified_NotEditOrViewActionUrl",e.forceSingleStepBoot="Force_SingleStepBoot",e.wordUiEmbedReadOnlyEarlyRedirect="WordUiEmbed_ReadOnlyEarlyRedirect",e.wordUiEmbedIrmEnabledEarlyRedirect="WordUiEmbed_IrmEnabledEarlyRedirect",e.wordViewToUnifiedReadRedirect="WordView_UnifiedReadRedirect"}(ze||(ze={}));var Ct=((Ke={})[se.blurFocus]=ce.lo,Ke[se.continueAccessibilityLoop]=ce.mo,Ke[se.grabFocus]=ce.vo,Ke[se.moveToFolder]=ce.ji,Ke[se.popState]=ce.bo,Ke[se.rename]=ce.Oo,Ke[se.sendAccessToken]=ce.Ro,Ke[se.sendAuthToken]=ce.Uo,Ke[se.sendCustomAuthConfig]=ce.Wo,Ke[se.sendEmbeddedViewUrl]=ce.Mo,Ke[se.sendSessionInfo]=ce.No,Ke[se.sendUserAccessAndPermissions]=ce.Ho,Ke[se.sendWopiInfo]=ce.Do,Ke[se.sendDavUrl]=ce.Vo,Ke[se.completeSharedFilePicker]=ce.nn,Ke[se.switchMode]=ce.qo,Ke[se.signalShared]=ce.$o,Ke),Et=function(){function e(e,t){var i,r,s=this;if(this.zs=!1,this.Ks={},this.yr="",this.Tr="",this.Ar=!1,this.Cr=!1,this.Er=!1,this.Pr=!1,this.Xs=[],this.$s=!0,this.Zs=function(e,t,i){if(e){var r={MessageId:ce.ao,CorrelationId:i,SendTime:q()};s.ei.ULS.Ve(595732176,n.B,o.Info,"Sending Ack back"),e.postMessage(JSON.stringify(r),t)}else s.ei.ULS.Ve(595736136,n.B,o.Info,"Missing target to send Ack back")},this.Qs=function(e){var t,i=!1,r=!0,a="",c=!1;if(s.Ys&&s.Ys.contentWindow&&(i=!0,r=e.source===s.Ys.contentWindow),e.origin&&!(c=(a=I(e.origin,2).toLowerCase())===s.Tr)&&s.Rr&&(a=I(e.origin).toLowerCase(),c=s.Rr.includes(a)),!s.Cr&&(!s.Er||c&&r)||s.ei.ULS.Ve(595730526,n.B,o.Info,"Window is available: ".concat(i,", window is valid: ").concat(r,", origin is valid: ").concat(c,", expected origin: ").concat(s.Tr,", actual origin: ").concat(a)),c&&(!s.Ar||r)){var u;try{u=JSON.parse(e.data)}catch(e){return void s.ei.ULS.Ve(596464282,n.B,o.Info,"Failed to parse event data: ".concat(ie(e),"."))}var l=u.MessageId;if(l){if(s.ei.ULS.Ve(595714715,n.B,o.Info,"Received messageId: ".concat(l,", correlation: ").concat(u.CorrelationId)),l!==ae.gi&&l!==ae.Bi||s.ea(e.origin),s.Pr&&l===ae.eo)return window._pageTimings=null!==(t=window._pageTimings)&&void 0!==t?t:{},void(window._pageTimings[u.Values.name]=u.Values.time);u.Values&&u.Values.ackExpected&&s.Zs(e.source,e.origin,u.CorrelationId);var d=s.Ks[l];if(!d)return s.ei.ULS.Ve(596464289,n.B,o.Info,"No handler found for message id: ".concat(l)),void(s.$s&&l===ae.Ni&&(s.Xs.push(u),s.ei.ULS.Ve(543207888,n.B,o.Info,"Kept for later process: ".concat(l))));s.ei.ULS.Ve(596464288,n.B,o.Info,"Processing message: ".concat(l)),l===ae.an&&(u.Values=Y(Y({},u.Values||{}),{sendTimeAsClickTime:u.SendTime}));try{d(u.Values||{})}catch(e){s.ei.ULS.Ve(593773704,n.B,o.Error,"Handler error: ".concat(ie(e)))}s.$s&&l===ae.gi&&s.ta()}else(s.Cr||s.Er)&&s.ei.ULS.Ve(595730520,n.B,o.Info,"Could not find message id")}},this.ta=function(){s.$s=!1,s.Xs.forEach((function(e){var t=e.MessageId,i=s.Ks[t];if(i){s.ei.ULS.Ve(543207890,n.B,o.Info,"Processing message after boot complete: ".concat(t));try{i(e.Values||{})}catch(e){s.ei.ULS.Ve(543207891,n.B,o.Error,"Handler error: ".concat(ie(e)))}}else s.ei.ULS.Ve(543207889,n.B,o.Info,"No handler found after boot complete: ".concat(t))})),s.Xs=[]},this.ia=function(e,t,i){e.postMessage(t,i)},this.ea=function(e){var t=e.toLowerCase();s.yr&&s.yr!==t&&s.ei.ULS.Ve(596128131,n.B,o.Warning,"Updating origin: [".concat(R(s.yr),"]->[").concat(R(t),"]")),s.yr=t,s.Tr=I(t,2),s.Cr=m(t),s.Er=v(t)},!e)throw new Error("Missing origin for PostMessageHandler");this.Cr=m(e),this.Er=v(e),this.ei=t,this.ea(e),this.Pr=!!(null===(r=null===(i=window.location)||void 0===i?void 0:i.search)||void 0===r?void 0:r.match(/wdpa=1/gi))||"1"===Pe("EnableMetricLogging")}return e.prototype.registerMessagePayloadHandler=function(e,t){if(this.Ks[e])throw new Error("Duplicate registration!");this.Ks[e]=t},e.prototype.removeMessageHandler=function(e){delete this.Ks[e]},e.prototype.sendPostMessage=function(e,t,i){if(e&&e.contentWindow){this.ei.ULS.Ve(596464334,n.B,o.Info,"Sending message: "+t);var r={MessageId:t,SendTime:q(),Values:i};this.ia(e.contentWindow,JSON.stringify(r),this.yr)}else this.ei.ULS.Ve(595948308,n.B,o.Info,"Missing target for SendPostMessage")},e.prototype.activate=function(e,t){this.Ys=e,this.Ar=!!t,this.zs||(window.addEventListener("message",this.Qs,!1),this.zs=!0)},e.prototype.postMessageForCommand=function(e,t,i){var r=Ct[t];r?(this.ei.ULS.Ve(595702598,n.B,o.Info,"Sending message ".concat(r," for command ").concat(t)),this.sendPostMessage(e,r,i)):this.ei.ULS.Ve(595702599,n.B,o.Warning,"No mapping for command ".concat(t))},e.prototype.dispose=function(){this.Ks={},this.zs&&(window.removeEventListener("message",this.Qs,!1),this.zs=!1)},e}(),At=function(){function e(e,t,i,n,o){this.na=0,this.oa=[],this.Cr=!1,this.Cr=e,this.ra=t,this.ei=i,this.sa=n,this.aa=o,this.restart()}return e.prototype.restart=function(){var e=this,t=this.ra.getValue(K.ht,!1);this.na=G()+(this.aa?this.aa:this.ra.getValue(K.st,6e5));var i=this.Cr?3e3:5e3;this.ca=window.setInterval((function(){t&&e.ei.ULS.Ve(595724178,n.B,o.Info,"Boot_HeartBeat"),G()>e.na&&(e.stop(),Pt(e.ei),e.sa&&e.sa())}),this.ra.getValue(K.ft,i)),this.oa.push(window.setTimeout(Pt,this.ra.getValue(K.ct,6e4),this.ei,1)),this.oa.push(window.setTimeout(Pt,this.ra.getValue(K.ut,18e4),this.ei,2))},e.prototype.stop=function(){this.na=0,this.ca&&(window.clearInterval(this.ca),this.ca=void 0),this.oa.forEach((function(e){window.clearTimeout(e)})),this.oa=[]},e}();function Pt(e,t){e.ULS.Ve(594901218,n.B,o.Warning,"Boot_NotComplete_".concat(t||"Final")),e.ULS.flush()}function Ft(e){localStorage.setItem(e.flightKey,e.flightValue.toString())}var Ot=function(e,t,i,r,s){return e!==ae.so?Promise.reject("Wrong flow"):new Promise((function(e){var r=t.flightKey,s=t.flightValue;i.logger.ULS.Ve(507343134,n._e,o.Info,"setWacFlightValue ".concat(r,": ").concat(s)),Ft(t),e({completion:"success"})}))};function Rt(e){var t=window.navigator;if(t&&t.virtualKeyboard&&void 0!==t.virtualKeyboard.overlaysContent&&window===top)return t.virtualKeyboard.overlaysContent=e}var Ut=function(e,t,i,n,o){return e!==ae.sn?Promise.reject("Wrong flow"):new Promise((function(e){Rt(t.overlayContent),i.container&&i.container.postMessage(ce.jo,void 0),e({completion:"success"})}))};function Wt(e){return Pe(e.hostKey)}var xt=function(e,t,i,r,s){return e!==ae.Di?Promise.reject("Wrong flow"):new Promise((function(e){var r=t.hostKey;i.logger.ULS.Ve(574408915,n.B,o.Info,"getHostKeyValue ".concat(r));var s=Wt(t);i.container&&s&&i.container.postMessage(ce.So,{hostKey:r,hostValue:s}),e({completion:"success"})}))};function kt(e){Fe(e.hostKey,e.hostValue,365)}var Mt,Nt=function(e,t,i,r,s){return e!==ae.ln?Promise.reject("Wrong flow"):new Promise((function(e){var r=t.hostKey,s=t.hostValue;i.logger.ULS.Ve(574408914,n.B,o.Info,"storeHostKeyValue ".concat(r,": ").concat(s)),kt(t),e({completion:"success"})}))},Ht=function(){function e(e,t,i,r,s,a){var c=this;if(this.ua=!1,this.la=function(e,t){c.fa.officeFrameCreateTime=q(),c.ha.frameCreateStartTime=c.fa.officeFrameCreateTime;var i=c.pa.applicationCustomSettings&&c.pa.applicationCustomSettings.appFrameName;c.Ys=function(e,t,i,n,o,r,s){var a=function(e,t,i){var n=e.ownerDocument.createElement("iframe");n.name=i||"WebApplicationFrame",n.id="WebApplicationFrame",n.src="",n.title="Office Online Frame",n.width="100%",n.height="100%",n.marginWidth="0",n.marginHeight="0",n.style.left="0",n.style.top="0",n.style.right="0",n.style.bottom="0",n.style.display="block",n.style.position="absolute",n.style.backgroundColor="transparent",n.style.border="none",n.frameBorder="0",n.setAttribute("allowfullscreen","true"),n.setAttribute("allowTransparency","true");var o=S(t);return n.setAttribute("allow","microphone ".concat(o,"; autoplay ").concat(o,"; camera ").concat(o,"; clipboard-read ").concat(o,"; clipboard-write ").concat(o,"; keyboard-map ").concat(o,"; display-capture ").concat(o)),e.appendChild(n),n}(e,t,s);return vt(t)&&ht(o,"office_form",n,r),It(o,i,""),function(e,t,i,n){We(e,n);var o=t.ownerDocument,r=o.createElement("form");for(var s in r.id="office_form",r.name="office_form",r.action=i,r.target=e.name,r.method="POST",n){var a=o.createElement("input");a.type="hidden",a.name=s,a.value=n[s],r.appendChild(a)}return t.appendChild(r),r.submit(),e}(a,e,t,i)}(c.pa.container,e,t,c.pa.featureManager,c.ei,c.pa.sessionId,i),c.ma.activate(c.Ys)},this.va=function(e){c.ma.registerMessagePayloadHandler(ae.gi,c.wa),c.ma.registerMessagePayloadHandler(ae.vi,c.ga),c.Ye=window.setTimeout(c.Sa,15e3),c.Ia=new At(e,c.pa.et,c.ei,(function(){j(c.pa.remoteTelemetryUrl,"Excel","bootTimeout")}))},this._a=function(e){var t=e.flightKey,i=e.flightValue;c.ei.ULS.Ve(507343133,n._e,o.Info,"storeWacFlightKeyValue ".concat(t,": ").concat(i));try{Ft(e)}catch(e){c.ei.ULS.Ve(507340380,n._e,o.Error,"Handler error: ".concat(ie(e)))}},this.ba=function(e){var t=e&&e.state?e.state:"unknown";c.ei.ULS.Ve(595714271,n.B,o.Info,"WAC Boot App state:[".concat(t,"]")),pt(t)},this.ya=function(e){var t=xe(c.ei);c.ei.ULS.Ve(595653903,n.B,o.Info,"Top frame is trusted: ".concat(t)),c.Ta(ce.ki,{isTopFrameTrusted:t})},this.Ca=function(e){var t=Rt(e&&e.overlayContent);c.ei.ULS.Ve(587487432,n.B,o.Info,"Overlay content: ".concat(t)),c.Ta(ce.jo,void 0)},this.wa=function(e){if(c.ei.ULS.Ve(595986314,n.B,o.Info,"Received wac complete message"),c.ei.ULS.flush(),window.clearTimeout(c.Ye),c.Ia&&c.Ia.stop(),mt(),c.ua)c.ei.ULS.Ve(596444234,n.B,o.Info,"Received multiple wac complete or failure messages");else{c.ua=!0,c.Ta(ce.fo,{}),st(c.fa,e);var t=c.Ea();c.Aa(t),c.pa.et.getValue(K.wt,!1)&&(c.pa.diagnostics.HostInitDiagnostics||(c.pa.diagnostics.HostInitDiagnostics={}),Se(c.pa.diagnostics.HostInitDiagnostics)),c.Pa(c.pa.diagnostics)}},this.Fa=function(){c.ei.ULS.Ve(579342464,n.B,o.Info,"Received close tab message");try{window.close()}catch(e){c.ei.ULS.Ve(579213188,n.B,o.Warning,"Failed to close the browser tab")}},this.Ea=function(){return{innerApplicationFrame:c.Ys}},this.ga=function(e){if(c.ei.ULS.Ve(595986315,n.B,o.Error,"Received wac failed message"),c.ei.ULS.flush(),window.clearTimeout(c.Ye),c.Ia&&c.Ia.stop(),c.ua)c.ei.ULS.Ve(596444235,n.B,o.Info,"Received multiple wac complete or failure messages");else{c.ua=!0,c.Ta(ce.do,{});var t={errorType:ke.WacFailed,errorObject:{}};e&&(t.errorObject=e.Error,c.ha.error=t),c.Oa(t)}},this.Ra=function(e){var t=e.hostKey;c.ei.ULS.Ve(574433173,n.B,o.Info,"GetHostKeyValue ".concat(t));var i=Wt(e);null!=i&&c.Ta(ce.So,{hostKey:t,hostValue:i})},this.Ua=function(e){var t=e.hostKey,i=e.hostValue;c.ei.ULS.Ve(574433174,n.B,o.Info,"storeHostKeyValue ".concat(t,": ").concat(i)),kt(e)},this.Sa=function(){c.ua||c.ei.ULS.Ve(596444236,n.B,o.Warning,"Timeout. SessionTraces:"+JSON.stringify(c.ha))},this.Pa=function(e){c.Ta(ce.Io,{HostInitializeDiagnostics:e.HostInitDiagnostics,ClientDiagnostics:e.ClientDiagnostics})},this.Ta=function(e,t){c.Ys&&c.Ys.contentWindow?c.ma.sendPostMessage(c.Ys,e,t):c.ei.ULS.Ve(595955718,n.B,o.Info,"Attempted to send postmessage: "+e)},void 0===t)throw new TypeError("bootFlowInfo");if(t.isSingleStepBoot&&void 0===e.wopiInfo)throw new TypeError("wopiInfo");this.pa=e,this.Wa=t,this.ei=i,this.ma=r,this.Aa=s,this.Oa=a,this.fa=e.diagnostics.AppInitDiagnostics,this.ha=e.diagnostics.SessionTraces,this.ha.wopiInitializeTime=q()}return e.prototype.Boot=function(){this.ei.ULS.Ve(596444241,n.B,o.Info,"Initializing WAC frame");var e=yt(this.pa,this.Wa,!0),t=function(e,t){var i={};if(e.wopiInfo&&(i[Oe.Dr]=e.wopiInfo.AccessToken,i[Oe.Vr]=Tt(e.wopiInfo),e.wopiInfo.WacToken&&(i[Oe.Lr]=e.wopiInfo.WacToken)),e.wopiPrecheckInfo.BundleInfo&&e.wopiPrecheckInfo.BundleInfo.Url&&e.wopiPrecheckInfo.BundleInfo.Url.length>0)if(i[Oe.Br]=e.wopiPrecheckInfo.BundleInfo.Url,null!=e.wopiPrecheckInfo.BundleInfo.BundleStaleness&&void 0!==e.wopiPrecheckInfo.BundleInfo.BundleStaleness){var r=e.wopiPrecheckInfo.BundleInfo.BundleStaleness.toString();t.ULS.Ve(593503580,n.B,o.Info,"Content bundle staleness - "+r),i[Oe.Jr]=r}else t.ULS.Ve(593503581,n.B,o.Info,"Content bundle staleness does not exist");if(e.wopiPrecheckInfo.FileGetUrl&&(i[Oe.$r]=e.wopiPrecheckInfo.FileGetUrl),e.wopiPrecheckInfo.CustomFontCatalogUrl&&(i[Oe.Zr]=e.wopiPrecheckInfo.CustomFontCatalogUrl),e.wopiPrecheckInfo.FileName){var s=te(e.wopiPrecheckInfo.FileName);s&&(i[Oe.Xr]=s),i[Oe.Qr]=e.wopiPrecheckInfo.FileName}e.newFileTemplateSource&&e.newFileTemplateSource.FileSize?i[Oe.Yr]=e.newFileTemplateSource.FileSize.toString():e.wopiPrecheckInfo.FileSize&&(i[Oe.Yr]=e.wopiPrecheckInfo.FileSize.toString()),e.sessionInformation.UserId&&(i[Oe.fs]=e.sessionInformation.UserId),e.sessionInformation.OwnerId&&(i[Oe.as]=e.sessionInformation.OwnerId),e.sessionInformation.SessionContext&&(i[Oe.us]=e.sessionInformation.SessionContext),void 0!==e.sessionInformation.SupportsZipIt&&(i[Oe.Us]=e.sessionInformation.SupportsZipIt.toString()),e.diagnostics.HostInitDiagnostics&&(i[Oe.ns]=JSON.stringify({HostInitializeDiagnostics:e.diagnostics.HostInitDiagnostics,ClientDiagnostics:e.diagnostics.ClientDiagnostics})),i[Oe.Kr]=oe(e.featureManager,e.sessionInformation.WdParams),e.applicationCustomSettings&&e.applicationCustomSettings.HostUIControls&&(i[Oe.ss]=JSON.stringify(e.applicationCustomSettings.HostUIControls)),i[Oe.ts]=String(window.devicePixelRatio>1.24),i[Oe.ls]=String(d()),i[Oe.os]=e.sessionInformation.HostName;var a=e.newFileTemplateSource;a&&a.FileGetUrl&&(i[Oe.ds]=a.FileGetUrl),a&&a.DocUniqueId?i[Oe.jr]=a.DocUniqueId:e.wopiPrecheckInfo.DocUniqueId&&(i[Oe.jr]=e.wopiPrecheckInfo.DocUniqueId),a&&a.ETag?i[Oe.zr]=a.ETag:e.wopiPrecheckInfo.ETag&&(i[Oe.zr]=e.wopiPrecheckInfo.ETag),i[Oe.ms]=(new Intl.DateTimeFormat).resolvedOptions().timeZone,"Templatization"!==e.sessionInformation.ContentAssemblyMode&&"DocGen"!==e.sessionInformation.ContentAssemblyMode&&"ContentAssemblyEdit"!==e.sessionInformation.ContentAssemblyMode&&"ContentAssemblyView"!==e.sessionInformation.ContentAssemblyMode||(i[Oe.vs]="1"),e.sessionInformation.ContentAssemblyMode&&(i[Oe.Fs]=e.sessionInformation.ContentAssemblyMode);var c=e.sessionInformation.Meeting;c&&(c.id&&(i[Oe.ws]=c.id),c.title&&(i[Oe.gs]=c.title),c.type&&(i[Oe.Ss]=c.type),c.scheduledStartTime&&(i[Oe._s]=c.scheduledStartTime),c.scheduledEndTime&&(i[Oe._s]=c.scheduledEndTime),c.joinUrl&&(i[Oe.Ts]=encodeURIComponent(c.joinUrl)),c.organizerId&&(i[Oe.ys]=c.organizerId),c.isPresenter&&(i[Oe.bs]=c.isPresenter.toString()),c.isMeetingTeamsRoom&&(i[Oe.Cs]=c.isMeetingTeamsRoom.toString()));var u=e.sessionInformation.OwlVersion;u&&(i[Oe.As]=u);var l=e.sessionInformation.OwlRollout;l&&(i[Oe.Ps]=l),i[Oe.Es]=J();var f=e.sessionInformation.TraceParent;if(f){i[Oe.Os]=f;var h=e.sessionInformation.TraceState;h&&(i[Oe.Rs]=h)}return i}(this.pa,this.ei);if(this.ma.registerMessagePayloadHandler(ae.wi,this.ba),this.ma.registerMessagePayloadHandler(ae._i,this.Fa),this.pa.sessionInformation.SupportsFrameTrustCheck||this.ma.registerMessagePayloadHandler(ae.ki,this.ya),this.ma.registerMessagePayloadHandler(ae.sn,this.Ca),this.ma.registerMessagePayloadHandler(ae.Di,this.Ra),this.ma.registerMessagePayloadHandler(ae.ln,this.Ua),this.ma.registerMessagePayloadHandler(ae.so,this._a),this.Wa.ignoreWacFramePostMessages||this.va(m(e)),this.la(e,t),this.Wa.ignoreWacFramePostMessages){var i=this.Ea();this.Aa(i)}return this.ei.ULS.Ve(595661019,n.B,o.Info,"Created Wac Frame"),this.Ys},e}(),Dt=function(){function e(e,t,i,r,s,a,c){var u=this;this.xa=!1,this.ka=!1,this.Ma=!1,this.Na=null,this.Ha=!0,this.Da=!1,this.Va=!1,this.La=function(){u.ei.ULS.Ve(596444231,n.B,o.Info,"Initializing Office frame WITHOUT WOPI info - first step of two step flow."),window.setTimeout(u.Ba,5e3),u.ma.registerMessagePayloadHandler(ae.mi,u.Ja),u.ma.registerMessagePayloadHandler(ae.rn,u.Ga);var e=new Ht(u.pa,u.Wa,u.ei,u.ma,u.Aa,u.Oa);u.Ys=e.Boot(),u.qa&&u.qa(u.Ys)},this.za=function(){var e={ParallelizeStartSession:u.Ha,WacFrameIsLoaded:u.xa,WacAcceptsStartSessionComplete:u.Da};u.ei.ULS.Ve(596444232,n.B,o.Info,"Completing the initialized application WITH the WOPI info - second step of two step flow. Current app state - "+JSON.stringify(e)),!u.Ha||u.xa&&!u.Da?u.xa&&u.Ka():u.Xa()},this.$a=function(){u.ei.ULS.Ve(596444233,n.B,o.Info,"Initializing Office frame WITH WOPI info - single step WOPI boot flow."),u.pa.wopiInfo=u.Za;var e=new Ht(u.pa,u.Wa,u.ei,u.ma,u.Aa,u.Oa);u.Ys=e.Boot(),u.qa(u.Ys)},this.Qa=function(e){u.xa?(u.ei.ULS.Ve(595968481,n.B,o.Warning,"Fail called and wacframe is able to accept postmessages"),u.Ya(e)):(u.ei.ULS.Ve(595968482,n.B,o.Warning,"Fail was called on the session prior to WacReady."),u.Na=e)},this.Ya=function(e){u.ei.ULS.Ve(596444189,n.B,o.Warning,"Fail called, sending the failure postmessage to IFrame"),u.Ta(ce.Jo,e)},this.ec=function(){u.ei.ULS.Ve(596444190,n.B,o.Warning,"Fail called during single step boot, calling host failure callback..."),u.Oa({errorType:ke.InvalidWopiInfo,errorObject:new TypeError("wopiInfo")})},this.Ba=function(){u.xa||(u.ei.ULS.Ve(596444191,n.B,o.Warning,"Timeout Wac Ready"),u.Oa({errorType:ke.TimeoutWacReady,errorObject:void 0}))},this.tc=function(){u.Ma||(u.ha.timeoutCompleteOrFail=q(),u.ei.ULS.Ve(596444192,n.B,o.Warning,"Timeout Complete or Fail. SessionTraces:"+JSON.stringify(u.ha)))},this.ic=function(e,t,i){u.Va||(u.ei.ULS.Ve(596444193,n.B,o.Info,"SessionCompletion timed out with no ack."),u.nc(e,t,i+1))},this.Ja=function(e){if(u.ha.readyMessageReceiveTime=q(),u.Ta(ce.co,{}),u.xa)u.ei.ULS.Ve(596444194,n.B,o.Info,"Received multiple ready messages - frame is already loaded.");else{u.xa=!0,u.Da=e&&e.CanAcceptStartSessionComplete;var t={AcceptStartSessionComplete:u.Da,ParallelizeStartSession:u.Ha,StartSessionResponseAvailable:!!u.oc,WopiInfoAvailable:!!u.Za};u.ei.ULS.Ve(596444195,n.B,o.Info,"HandleWacReadyMessage - "+JSON.stringify(t)),u.Ma&&(u.Na?u.Ya(u.Na):u.Ta(ce.Go,{})),u.Ha&&u.Da?u.oc&&u.rc():u.Za&&u.Ka(),st(u.fa,e)}},this.Ga=function(e){u.Va=!0,u.ha.sessionCompleteAckReceivedTime=q()},this.Ta=function(e,t){u.ma.sendPostMessage(u.Ys,e,t)},this.ac=function(e,t){u.nc(e,t,1)},this.nc=function(e,t,i){if(i>3)u.ei.ULS.Ve(596444224,n.B,o.Error,"Attempted to call complete, but received no ack from the frame. Time: ".concat(q()));else{u.ei.ULS.Ve(596444225,n.B,o.Info,"Sending completion message to frame. Attempt number: ".concat(i,", Time: ").concat(q()));var r=q();1===i&&(u.oc&&u.oc.Diagnostics&&(u.oc.Diagnostics.completeMessageCreateTime=r),u.ha.completeMessageCreateTime=r),t.Diagnostics.completeMessageSendTime=r,u.ha.completeMessageSendTime=r,u.Ta(e,t),window.setTimeout((function(){return u.ic(e,t,i)}),1e3)}},this.Xa=function(){u.ei.ULS.Ve(596444226,n.B,o.Info,"Making parallelized startSession request.");var e=u.cc(u.Za),t="access_token="+encodeURIComponent(u.Za.AccessToken)+"&access_token_ttl="+encodeURIComponent(Tt(u.Za));u.ha.startSessionStartTime=q(),function(e,t,i,n){var o=new XMLHttpRequest;for(var r in o.onreadystatechange=function(){if(o&&4===o.readyState){if(void 0===o.status||0===o.status)return;try{n&&n(o)}finally{null!=o&&(o.onreadystatechange=function(){})}}},o.open("POST",e),i)o.setRequestHeader(r,i[r]);o.send(t)}(e,t,{"Content-Type":"application/x-www-form-urlencoded"},u.uc)},this.uc=function(e){if(u.ha.startSessionCompleteTime=q(),u.ha.startSessionResponseStatus=e.status,u.oc={StartSessionResponse:{RequestStatus:e.status,ResponseText:e.responseText},Diagnostics:{wopiPendingInitializeTime:u.ha.wopiPendingInitializeTime,wopiPendingCompleteTime:u.ha.wopiPendingCompleteTime,startSessionStartTime:u.ha.startSessionStartTime,startSessionCompleteTime:u.ha.startSessionCompleteTime,readyMessageReceiveTime:u.ha.readyMessageReceiveTime}},u.ei.ULS.Ve(596444227,n.B,o.Info,"StartSession request completed with status code: ".concat(u.oc.StartSessionResponse.RequestStatus,", Time: ").concat(q())),u.xa&&u.Da)u.rc();else{var t={WacFrameIsLoaded:u.xa,InitializeCompleted:u.ka};u.ei.ULS.Ve(596444228,n.B,o.Info,"StartSessionCompleted not called - "+JSON.stringify(t))}},this.Ka=function(){if(!u.ka){u.ka=!0,u.ei.ULS.Ve(596444229,n.B,o.Info,"Sending wopi info to the frame.");var e={WopiDetails:{WopiSrc:u.Za.WopiSrc,AccessToken:u.Za.AccessToken,AccessTokenTtl:Tt(u.Za)},Diagnostics:{wopiPendingInitializeTime:u.ha.wopiPendingInitializeTime,wopiPendingCompleteTime:u.ha.wopiPendingCompleteTime,readyMessageReceiveTime:u.ha.readyMessageReceiveTime}};u.Za.WacToken&&(e.WopiDetails.WacToken=u.Za.WacToken),u.ac(ce.po,e)}},this.rc=function(){200===u.oc.StartSessionResponse.RequestStatus?u.ka||(u.ka=!0,u.ac(ce.ho,u.oc)):u.Ka()},this.cc=function(e){var t=u.pa.applicationBasePath+"wordeditorstartsession.ashx",i=yt(u.pa,u.Wa,!1);return t=T(t+="?"+i.substring(i.indexOf("?")+1),"WOPISrc",encodeURIComponent(e.WopiSrc)),t=T(t,"build",encodeURIComponent(J())),t=T(t,"WacUserType",encodeURIComponent("WOPI")),u.pa.wopiPrecheckInfo.FileGetUrl&&(t=T(t,"fileGetUrlPresent","1")),t},this.lc=function(e){if(u.pa.isCreateNew){if(!e||!e.NewFilePath)return void u.ei.ULS.Ve(596444230,n.B,o.Info,"Either NewFileInfo or NewFilePath are not provided for a new file.");history.replaceState({},"",e.NewFilePath),e.UpdatedPageTitle&&(document.title=e.UpdatedPageTitle)}},this.pa=e,this.Wa=t,this.fa=e.diagnostics.AppInitDiagnostics,this.ei=i,this.ma=r,this.Aa=a,this.Oa=c,Promise&&(this.dc=new Promise((function(e){return u.qa=e}))),this.ha=e.diagnostics.SessionTraces,this.ha.wopiPendingInitializeTime=q(),this.fc=s,Ye(),window.setTimeout(this.tc,5e3)}return e.prototype.Complete=function(e,t){if(this.Ma)this.ei.ULS.Ve(596444184,n.B,o.Warning,"Complete called after Complete/Fail already called");else{this.ei.ULS.Ve(596444185,n.B,o.Info,"Complete called."),this.pa.diagnostics.HostInitDiagnostics&&(this.pa.diagnostics.HostInitDiagnostics.hostCompleteCallTime=q()),this.Ma=!0,this.Za=e,this.ha.wopiPendingCompleteTime=q();try{this.Wa.isSingleStepBoot?this.$a():this.za(),this.xa&&this.Ta(ce.Go,{}),this.lc(t)}catch(e){this.ei.ULS.Ve(596444186,n.B,o.Error,"Unexpected script error: ".concat(ie(e))),j(this.pa.remoteTelemetryUrl,"Excel","bootException")}finally{this.ei.ULS.flush()}}},e.prototype.Fail=function(e){this.Ma?this.ei.ULS.Ve(596444187,n.B,o.Warning,"Fail called after Complete/Fail already called"):(this.ei.ULS.Ve(596444188,n.B,o.Warning,"Fail called. Reason: "+(e?JSON.stringify(e):"N/A")),this.Ma=!0,this.Wa.isSingleStepBoot?this.ec():this.Qa(e),this.ei.ULS.flush())},e.prototype.Dispose=function(e,t,i){var n=this;et(e||!1,this.ei,this.ma,this.Ys,(function(){delete n.Ys,t&&t(),n.fc(),n.ma.dispose()}),void 0,i)},e.prototype.PostWacToken=function(e,t,i){!function(e,t,i,r,s,a){var c=q();r.ULS.Ve(507774684,n.B,o.Important,"postWacToken flow initiated");var u=function(){a&&a.flush&&a.flush()};s?s.then((function(s){var l=function(){return i.sendPostMessage(s,ce.or,{wacToken:e,postWacTokenStart:t})};l();var d=window.setInterval(l,100);i.registerMessagePayloadHandler(ae.io,(function(e){r.ULS.Ve(507597019,n.B,o.Info,"postWacToken flow completed in ".concat(q()-c," ms")),window.clearInterval(d),window.clearTimeout(f),a&&(a.PostWacTokenResult="success",a.PostWacTokenEndTime=q(),e&&void 0!==e.TokenAlreadySet&&(a.TokenAlreadySet=e.TokenAlreadySet),u())}));var f=window.setTimeout((function(){r.ULS.Ve(507597018,n.B,o.Warning,"postWacToken flow timed out after ".concat(6e4," ms")),window.clearInterval(d),a&&(a.PostWacTokenResult="timeout",a.PostWacTokenEndTime=q(),u())}),6e4)})).catch((function(e){r.ULS.Ve(507873094,n.B,o.Warning,"This should never reject, error: ".concat(ie(e))),a&&(a.PostWacTokenResult="Unexpected JSAPI V1 error",a.PostWacTokenEndTime=q(),u())})):(r.ULS.Ve(507846862,n.B,o.Warning,"`Promise` does not exist natively for this browser."),a&&(a.PostWacTokenResult="JSAPI V1 error: Promise not supported in browser",a.PostWacTokenEndTime=q(),u()))}(e,t,this.ma,this.ei,this.dc,i)},e.prototype.Boot=function(){this.Wa.isSingleStepBoot||this.La(),this.ei.ULS.flush()},e}(),Vt=function(){function e(){var e=this;if(this.hc=[],this.Ks=[],this.pc=function(){var t={visibility:document.visibilityState,time:q(),initialState:!1};e.hc.push(t);for(var i=0,n=e.Ks;i<n.length;i++){var o=n[i];o&&o(t)}},"hidden"===document.visibilityState){var t={visibility:document.visibilityState,time:q(),initialState:!0};this.hc.push(t)}document.addEventListener("visibilitychange",this.pc)}return e.prototype.registerEventHandler=function(e){this.Ks.push(e)},e.prototype.removeEventHandler=function(e){if(e){var t=this.Ks.indexOf(e);this.Ks.splice(t,1)}},e.prototype.stop=function(){document.removeEventListener("visibilitychange",this.pc)},e.prototype.getVisibilityChangeEvents=function(){return this.hc},e.prototype.dispose=function(){this.stop(),this.Ks=[],this.hc=[]},e}(),Lt="excel-boot".concat(".min",".js"),Bt=[];function Jt(e){window.performance&&window.performance.getEntriesByType&&window.addEventListener("load",(function(){try{for(var t=0,i=window.performance.getEntriesByType("resource");t<i.length;t++){var r=i[t],s=A(r.name);if("about:blank"!==r.name&&-1===s.indexOf("RemoteUls.ashx")&&-1===s.indexOf("mhtml:file"))if(s===Lt)a=(a=JSON.stringify(r)).replace(new RegExp(r.name,"g"),s),e.ULS.Ve(574662801,n.B,o.Info,a);else if(-1!==Bt.indexOf(s)){var a;a=(a=JSON.stringify(r)).replace(new RegExp(r.name,"g"),s),e.ULS.Ve(595736532,n.B,o.Info,a)}}try{var c=window.performance.getEntriesByType("navigation"),u=void 0;u=c.length>0?c[0].type||"UndefinedType":"none",e.ULS.Ve(555872898,n.B,o.Info,"Navigation type is: ".concat(u))}catch(t){e.ULS.Ve(556011586,n.B,o.Info,"ExcelPreloader.tryObserveResourceTiming: Exception thrown when trying to read navigation type. Exception: "+JSON.stringify(t))}window.performance.clearResourceTimings()}catch(t){e.ULS.Ve(595732049,n.B,o.Info,"ExcelPreloader.tryObserveResourceTiming: could not trace resource timing, error is: "+JSON.stringify(t))}}),{once:!0})}function jt(e,t,i){void 0===t&&(t=void 0),void 0===i&&(i=void 0),Mt=e;try{i?i.addActionHandler(ae.Tn,(function(e,t){Gt(t)})):t&&t.registerMessagePayloadHandler(ae.Tn,(function(e){Gt(e)}))}catch(e){Mt.ULS.Ve(572383452,n.B,o.Warning,"ExcelFileBundleRegenerationRequester.initRegenerateFileBundleMessageHandler: ".concat(ie(e)))}}function Gt(e){if(e&&e.hasOwnProperty("fileUrl")&&e.hasOwnProperty("fileType"))try{var t=function(){var e=new Kt,t=new XMLHttpRequest;return t.timeout=3e4,t.withCredentials=!0,t.onreadystatechange=function(){t.readyState===XMLHttpRequest.DONE&&(200===t.status?(e.IsSucceeded=!0,e.HostCorrelationId=function(e){var t,i=null;try{var r=(new window.DOMParser).parseFromString(e,"text/xml");i=new URL(null!==(t=r.documentElement.textContent)&&void 0!==t?t:"").searchParams.get("correlationId")}catch(e){Mt.ULS.Ve(572383454,n.B,o.Warning,"ExcelFileBundleRegenerationRequester.readSpoCorrelationFromResponse: ".concat(ie(e)))}return i}(t.responseText)):e.FailureReason="XhrHttp".concat(t.status),qt(e))},t.onerror=function(t){e.FailureReason="XhrError",qt(e)},t}(),i=function(e){var t=new URL(e.fileUrl).origin,i=new URL(t);return i.pathname="_api/SP.Utilities.WOPIHostUtility.GenerateFileBundle",i.searchParams.set("fileUrl",e.fileUrl),i.searchParams.set("fileType",e.fileType),i}(e);t.open("GET",i.toString(),!0),t.send()}catch(e){Mt.ULS.Ve(572381152,n.B,o.Warning,"ExcelFileBundleRegenerationRequester.handleRegenerateFileBundleMessage: ".concat(ie(e)))}else Mt.ULS.Ve(572383453,n.B,o.Warning,"ExcelFileBundleRegenerationRequester.handleRegenerateFileBundleMessage: Message is missing parameter(s). values=null? ".concat(!e,",\n        fileUrl=null? ").concat(e&&!e.hasOwnProperty("fileUrl"),", fileType=null? ").concat(e&&!e.hasOwnProperty("fileType")))}function qt(e){Mt.ULS.Ve(572383455,n.B,o.Warning,"ExcelFileBundleRegenerationRequester.logResult: ".concat(JSON.stringify(e)))}var zt,Kt=function(){this.IsSucceeded=!1,this.HostCorrelationId=null,this.FailureReason=null};function Xt(e,t,i){void 0===t&&(t=void 0),void 0===i&&(i=void 0),zt=e;var r=function(e){e.forEach((function(e){e?function(e,t,i){if(xe(zt)){var r="addqsp"===(null==e?void 0:e.toLowerCase()),s="removeqsp"===(null==e?void 0:e.toLowerCase());t?r?$t(!0,!1,t,i):s?$t(!1,!0,t,i):zt.ULS.Ve(508864545,n.B,o.Error,"Does not contain expected values."):zt.ULS.Ve(508864546,n.B,o.Warning,"handleHostFrameModifyURLState: qspName is null.")}}(e.ops,e.qspName,e.qspValue):zt.ULS.Ve(508864544,n.B,o.Warning,"handleHostFrameModifyURLState: MessageData is null.")}))};try{i?i.addActionHandler(ae.to,(function(e,t){r(t)})):t&&t.registerMessagePayloadHandler(ae.to,(function(e){r(e)}))}catch(e){zt.ULS.Ve(508864547,n.B,o.Error,"ExcelModifyURLStateManager: error while initializing.")}}function $t(e,t,i,r){var s=new URLSearchParams(window.location.search);e&&r?null==s||s.set(i,r):t&&(null==s||s.delete(i));try{window.history.replaceState({},"",window.location.origin+window.location.pathname+"?"+s.toString()),zt.ULS.Ve(508864543,n.B,o.Info," ".concat(e?"Added":"Removed"," querystring param from url of hostframe"))}catch(e){zt.ULS.Ve(508864542,n.B,o.Warning,"ExcelModifyURLStateManager: error while changing state of hostframe:\n        ".concat(ie(e)))}}var Zt,Qt=function(){function e(e,t){var i=this;this.mc=function(e,t){return window.setInterval((function(){i.Prefetch({BootstrapperUrl:e}),t.ULS.Ve(595895774,n.B,o.Info,"Prefetching "+A(e))}),36e5)},this.vc=e,this.wc=t}return e.prototype.GetVersion=function(){return J()},e.prototype.GetMinContentVersion=function(){throw new Error("Not implemented")},e.prototype.Prefetch=function(e){if(null!=e&&void 0!==e){var t=document.createElement("link");t.rel="prefetch";var i=e.BootstrapperUrl;".js"!==i.toString().slice(-3)&&(i+=".js"),t.href=i;var n=document.getElementsByTagName("head")[0];null!=n&&void 0!==n&&n.appendChild(t)}},e.prototype.InitializeWopiPending=function(e,t,i,r,s,a){var c,u,l,d,f,h=!1;try{i?l=i:(l=(c=me())[0],d=c[1]),j(nt(e.ApplicationUrl,l),"Excel","init");var p,m=q();!function(e){if(void 0===e)throw new TypeError("initParams");var t=e.Container;if(void 0===t||void 0===t.appendChild)throw new TypeError("Container");var i=e.SessionInformation;if(void 0===i||void 0===i.HostName||void 0===i.HostSessionId||void 0===i.UserId)throw new TypeError("SessionInformation");var n=e.ApplicationUrl;if(void 0===n||"string"!=typeof n)throw new TypeError("ApplicationUrl");var o=e.WopiPrecheckInfo;if(void 0===o||void 0===o.FileName)throw new TypeError("WopiPrecheckInfo");if(void 0===e.FnOnInitializeSuccess)throw new TypeError("FnOnInitializeSuccess");if(void 0===e.FnOnInitializeFailure)throw new TypeError("FnOnInitializeFailure")}(e),e.ApplicationUrl=g(e.ApplicationUrl,y(e.ApplicationUrl,"region")),e.ApplicationUrl=E(e.ApplicationUrl,"region"),function(e){var t,i=e.RebootOverrideData;if(i)if(i.queryOverrides||(i.queryOverrides={}),t=i.mode)"view"===(t=t.toLowerCase())?i.queryOverrides.wdforcedmode="View":"edit"===t&&(i.queryOverrides.wdforcedmode="Edit");else{var n=i.reason;n&&"saveas"===(n=n.toLowerCase())&&(i.queryOverrides.wdforcedmode="Edit")}}(e),u=t||Z({remoteUlsEndpoint:rt(e.ApplicationUrl)+"RemoteUls.ashx",sessionId:l}),f=ot(e,l,u,s,a,this.wc.forceSingleStepBoot),a||(f.et.addSettingsChangeListener(u.settingsChangeHandler),f.et.initializePeriodicFetch(f.applicationBasePath,l)),f.diagnostics.HostInitDiagnostics&&(f.diagnostics.HostInitDiagnostics.hostInitializeCallTime=m),ut(u,f,d),h=!0;var v=e.BootstrapperUrl;v&&(p=this.mc(v,u));var w=function(){f.et.dispose(),f.pageStateObserver.dispose(),window.clearInterval(p)},I=S(e.ApplicationUrl),_=r||new Et(I,u),b=new Vt,T=function(e,t){var i={isSingleStepBoot:e.forceSingleStepBoot,bootFlowType:e.forceSingleStepBoot?ze.forceSingleStepBoot:ze.bootWithoutWopiInfo,ignoreWacFramePostMessages:!1};if(e.forceSingleStepBoot||(i=function(e,t){var i=e.applicationUrl,r=lt(i),s=dt(i),a=ft(i),c={isSingleStepBoot:!0,bootFlowType:ze.forceSingleStepBoot,ignoreWacFramePostMessages:!(r||s)};return r||s||a||t.ULS.Ve(553673219,n.B,o.Warning,"Unknown endpoint: ".concat(A(i))),c}(e,t)),i.isSingleStepBoot){var r={singleStepBootIsRequired:!0,singleStepBootReason:i.bootFlowType,irmEnabled:e.wopiPrecheckInfo.IrmEnabled,readOnly:e.wopiPrecheckInfo.ReadOnly,ignoreWacFramePostMessages:i.ignoreWacFramePostMessages};t.ULS.Ve(596444182,n.B,r.irmEnabled?o.Warning:o.Info,JSON.stringify(r))}else t.ULS.Ve(596444183,n.B,o.Info,"Received input valid for two step flow");return i}(f,u),C=function(e,t,i,r,s,a,c){return function(u){var l=e.diagnostics;ct(l,r),at(l.SessionTraces,i,o.Info);var d=ei(l);i.ULS.Ve(596448985,n.B,o.Info,JSON.stringify(d)),j(e.remoteTelemetryUrl,"Excel","bootSuccess");var f=c(e.sessionId,i,t,s,u);try{a(f,d)}catch(e){i.ULS.Ve(595719171,n.B,o.Error,"Exception thrown from host's success callback: ".concat(ie(e)))}ve("excel",i),Yt(i)}}(f,_,u,b,w,e.FnOnInitializeSuccess,this.vc),F=function(e,t,i,r){return function(s){var a=e.diagnostics;ct(a,i),at(a.SessionTraces,t,o.Warning);var c=ei(a);void 0!==s&&"Js Boot Failed"!==s.errorObject.errorType&&t.ULS.Ve(575931487,n.B,o.Error,"Core JS failure recieved "+JSON.stringify(s)),t.ULS.Ve(596448986,n.B,o.Error,JSON.stringify({error:s,appInitDiagnostics:c})),j(e.remoteTelemetryUrl,"Excel","bootFailure");try{r(s,c)}catch(e){t.ULS.Ve(595719172,n.B,o.Error,"Exception thrown from host's failure callback: ".concat(ie(e)))}ve("excel",t),Yt(t)}}(f,u,b,e.FnOnInitializeFailure);e.FnOnAppModeSwitched&&_.registerMessagePayloadHandler(ae.Ji,e.FnOnAppModeSwitched),St(u,_),jt(u,_),Xt(u,_),Jt(u),e.WopiPrecheckInfo.ReadOnly&&e.FnOnAppModeSwitched;var O=y(f.applicationUrl,"uih");if(v&&this.wc.preconnector&&this.wc.preconnector.shouldPreconnect(O)&&this.wc.preconnector.preconnect(v),v&&this.wc.preloader&&this.wc.preloader.shouldPreload(f.applicationUrl))try{var R=v;f.featureManager.isFeatureEnabled(Q.Ht)&&(u.ULS.Ve(595645891,n.B,o.Info,"HTTP2 preload enabled"),R=P(v));var U=f.sessionInformation.UiLocale;U||(U=decodeURIComponent(y(f.applicationUrl,"ui"))),this.wc.preloader.preload(R,U,u,f.featureManager)}catch(e){u.ULS.Ve(595943884,n.B,o.Error,"Error preloading")}var W=new Dt(f,T,u,_,w,C,F);return W.Boot(),W}catch(t){return u&&(u.ULS.Ve(596459925,n.B,o.Error,"".concat(ke.AppInitError,": ").concat(ie(t))),h||ut(u,f||ot(e,l,u,s,a,this.wc.forceSingleStepBoot),d),u.ULS.flushOnClose()),void(e&&(e.ApplicationUrl&&j(nt(e.ApplicationUrl,l),"Excel","bootException"),e.FnOnInitializeFailure&&e.FnOnInitializeFailure({errorType:ke.AppInitError,errorObject:t})))}},e}();function Yt(e){e.ULS.Ve(590914655,n.B,o.Info,"Time spent logging: ".concat(e.getTimeSpentLogging()))}function ei(e){return Y(Y(Y({},e.AppInitDiagnostics),e.HostInitDiagnostics),{SessionTraces:e.SessionTraces})}!function(e){e.BrowserEvent="BrowserEvent",e.AcquireOAuthTokenTeams="AcquireOAuthTokenTeams",e.PageChanged="PageChanged",e.ZoomChanged="ZoomChanged",e.ContentRefreshBegin="ContentRefreshBegin",e.ContentRefreshEnd="ContentRefreshEnd",e.AppClosed="UI_Close",e.UserEdit="Edit_Notification",e.FileRename="File_Rename",e.FileShare="UI_Sharing",e.ShowFileVersions="UI_FileVersions",e.UIWorkflow="UI_Workflow",e.IsDisabled="IsDisabled",e.AccessibilityLoopComplete="App_AccessibilityLoopComplete",e.Unloaded="Unloaded",e.Disposed="Disposed",e.SwitchMode="App_SwitchMode",e.DocumentReboot="DocReboot",e.WopiInfoFromUrl="WopiInfoFromUrl",e.DavUrlFromIds="DavUrlFromIds",e.ModeSwitched="ModeSwitched",e.CreateNewDocument="App_CreateNewDocument",e.GetAuthToken="GetAuthToken",e.GetCustomAuthConfig="GetCustomAuthConfig",e.SetOverlayContent="SetOverlayContent",e.MoveToFolder="MoveToFolder",e.SharedFilePicker="SharedFilePicker"}(Zt||(Zt={}));var ti=function(){function e(e,t,i,r,s){var a=this;this.Ks={},this.gc=function(){a.ma.registerMessagePayloadHandler(ae.Zi,a.Sc),a.ma.registerMessagePayloadHandler(ae.Vi,a.Ic),a.ma.registerMessagePayloadHandler(ae.Li,a._c),a.ma.registerMessagePayloadHandler(ae.Ni,a.bc),a.ma.registerMessagePayloadHandler(ae.an,a.yc),a.ma.registerMessagePayloadHandler(ae.Hi,a.Tc),a.ma.registerMessagePayloadHandler(ae.ji,a.Cc),a.ma.registerMessagePayloadHandler(ae.nn,a.Ec)},this.Ac=function(e,t){var i=a.Ks[e];if(i)try{i(t||{})}catch(e){a.ei.ULS.Ve(593773706,n.B,o.Error,"Handler error: ".concat(ie(e)))}},this.Sc=function(e){e.previousSessionId=a.Pc,a.Ac(Zt.DocumentReboot,e)},this.Ic=function(e){a.Ac(Zt.WopiInfoFromUrl,e)},this._c=function(e){a.Ac(Zt.DavUrlFromIds,e)},this.bc=function(e){Promise?a.Fc.isResourceTrustedForMessage(e).then((function(t){t?a.Ac(Zt.GetAuthToken,e):a.ma.sendPostMessage(a.Ys,ce.Uo,{AuthToken:"",Error:"accessDenied",RequestId:e.RequestId,IdentityType:e.IdentityType})}),(function(){a.ma.sendPostMessage(a.Ys,ce.Uo,{AuthToken:"",Error:"Exception encountered in AuthTokenTrustValidator.isResourceTrustedForMessage",RequestId:e.RequestId,IdentityType:e.IdentityType})})):a.ma.sendPostMessage(a.Ys,ce.Uo,{AuthToken:"",Error:'"Promise" does not exist natively in browser',RequestId:e.RequestId,IdentityType:e.IdentityType})},this.yc=function(e){a.Ac(Zt.FileShare,e)},this.Tc=function(e){a.Ac(Zt.GetCustomAuthConfig,e)},this.Cc=function(e){a.Ac(Zt.MoveToFolder,e)},this.Ec=function(e){a.Ac(Zt.SharedFilePicker,e)},this.Pc=e,this.ei=t,this.Ys=s.innerApplicationFrame,this.ma=i,this.Oc=r,this.Fc=new ye(t),this.gc(),Ye()}return e.prototype.GetApplicationType=function(){return"Excel"},e.prototype.GetVersion=function(){return J()},e.prototype.GetSessionId=function(){return this.Pc},e.prototype.RegisterEventHandler=function(e,t){switch(e){case Zt.Unloaded:case Zt.Disposed:case Zt.DocumentReboot:case Zt.WopiInfoFromUrl:case Zt.DavUrlFromIds:case Zt.GetAuthToken:case Zt.GetCustomAuthConfig:case Zt.MoveToFolder:case Zt.SharedFilePicker:case Zt.SetOverlayContent:case Zt.FileShare:if(this.Ks[e])throw new Error("Duplicate registration");this.Ks[e]=t;break;default:this.ma.registerMessagePayloadHandler(e,t)}},e.prototype.RemoveEventHandler=function(e,t){switch(e){case Zt.Unloaded:case Zt.Disposed:case Zt.DocumentReboot:case Zt.FileShare:case Zt.WopiInfoFromUrl:case Zt.DavUrlFromIds:case Zt.GetAuthToken:case Zt.GetCustomAuthConfig:case Zt.MoveToFolder:case Zt.SharedFilePicker:case Zt.SetOverlayContent:if(this.Ks[e]!==t)throw new Error("The handler requested to be removed does not exist for the eventType");delete this.Ks[e];break;default:this.ma.removeMessageHandler(e)}},e.prototype.RegisterErrorHandler=function(e){},e.prototype.RemoveErrorHandler=function(e){},e.prototype.PostCommand=function(e,t){this.ma.postMessageForCommand(this.Ys,e,t)},e.prototype.Dispose=function(e,t){var i=this;et(e||!1,this.ei,this.ma,this.Ys,(function(){delete i.Ys,i.Oc(),i.ma.dispose(),i.Ac(Zt.Unloaded,{})}),(function(){try{i.Ac(Zt.Disposed,{}),i.Ks={}}catch(e){i.ei.ULS.Ve(589108815,n.B,o.Error,"onFrameRemoved error: ".concat(ie(e)))}}),t)},e}();function ii(e,t){return lt(e)&&!ni(t)}var ni=function(e){return[r.Chrome,r.Edge].includes(c())&&(!e||"https://onedrive.live.com"!==e.toLowerCase())};function oi(e,t,i,r,s){var a={};if(s)a=s;else try{a=JSON.parse("###JSAPIHASHES###")}catch(e){r&&r.ULS.Ve(589178847,n.B,o.Info,"GetExcelResources failed to parse hash dictionary")}for(var c=P("".concat(S(e)).concat("/x/","s/")),u=function(e){var t=e?e.toLowerCase().split("-")[0]:"en";return k[t]}(null!=t?t:"en-US"),l=[],d=0,f=function(e){var t=[["App_Scripts/".concat("EwaTS").concat("",".js"),!1],["App_Scripts/gridRenderer".concat(".min",".js"),!1],["App_Scripts/MicrosoftAjaxDS".concat("",".js"),!1],["App_Scripts/".concat("EwaTS").concat("",".bootCommon.js"),!1]];return e&&(t=t.concat([["App_Scripts/".concat(e,"/Ewa.Strings.Wac").concat("",".js"),!0],["Resources/".concat(e,"/EwrDefault.css"),!0],["Resources/".concat(e,"/excelframe.css"),!0]])),t}(u);d<f.length;d++){var h=f[d],p=h[0],m=h[1],v=p.substring(p.lastIndexOf("/")+1);if(Bt.push(v),!m||"1033"===u){var w=v.toLowerCase();if(console.log("lowerCaseFile"),a&&a[w]){var g=a[w].UrlHash,I=a[w].SriHash;if(g&&I){var _=c+g+"__layouts/"+p;l.push([_,"sha256-"+I]),r&&r.ULS.Ve(589178849,n.B,o.Info,"GetExcelResources adding hashed url for ".concat(v))}}}}return l}var ri=function(e,t,i,r,s){return e!==ae.Zi?Promise.reject("Wrong flow"):new Promise((function(e){i.pendingReboot=!0;var r=void 0;if(t.queryOverrides)try{r=JSON.parse(t.queryOverrides)}catch(e){i.logger.ULS.Ve(592217694,n.B,o.Error,"Failed to parse queryOverrides: ".concat(r))}i.raiseEvent(ue.Reboot,Y(Y({},t),{previousSessionId:i.sessionId,queryOverrides:r})),e({completion:"success"})}))};var si=function(e,t,i,r,s){return e!==se.boot?Promise.reject("Wrong flow"):new Promise((function(e){var a,c,u=q();if(i.state=N.Booting,i.pendingReboot=!1,function(e,t,i){if(void 0===i&&(i=!1),!e)throw new TypeError("SessionBootParams");var n=e.appUrl,o=e.appBaseUrl;if(!n&&!o)throw new TypeError("Either appUrl or appBaseUrl should exist");if(n&&"string"!=typeof n)throw new TypeError("AppUrl");if(o&&"string"!=typeof o)throw new TypeError("AppBaseUrl");var r=e.file;if(!r||!i&&!r.name)throw new TypeError("FileInfo");var s,a=e.container;if(!a||!(a instanceof Xe)&&!a.appendChild)throw new TypeError("Container");if(!(t||(s=e.wopi)&&s.source&&s.accessToken&&(s.expiry||0===s.expiry)))throw new TypeError("WopiInfo")}(t,i.skipWopiValidation,i.skipFileNameCheck),i.intent=t.intent,i.file=t.file,i.customFontCatalogUrl=t.customFontCatalogUrl,i.wopi=t.wopi,i.contentBundle=t.contentBundle,i.newFileTemplate=t.newFileTemplate,i.ownerId=t.ownerId,i.sessionContext=t.sessionContext,i.actNavId=t.actNavId,i.preseededSession=t.preseededSession,i.throttling=t.throttling,i.meeting=t.meeting,i.tenantId=t.tenantId,i.wdParams=(c=t.wdParams,function(e,t){var i={};return t&&Object.keys(t).forEach((function(e){i[e.toLowerCase()]=t[e]})),e.split("&").forEach((function(e){if(/^wd\w+=\w+/i.test(e)){var t=e.split("=");i[t[0].toLowerCase()]=t[1]}})),i}(window.location.search.substring(1),c)),i.pinnedTarget=t.pinnedTarget,i.rebootOverride=t.rebootOverride,i.bootParams=t.bootParams||{},i.hostInitDiagnostics=Y(Y({},t.diagnostics),{hostInitializeCallTime:u}),i.et.getValue(K.wt,!1)&&Se(i.hostInitDiagnostics),t.appUrl){var l=t.appUrl;i.appUrl=l;var f=i.bootParams;F(l,"new")&&(f.isNewFile=!0),f.dataLanguage||(h=O(l,"rs"))&&(f.dataLanguage=h);var h,p=i.ui;if(F(l,"uiembed")&&(p.uiEmbed=!0),p.language||(h=O(l,"ui"))&&(p.language=h),!i.hostInitDiagnostics.entryPoint){var v=O(l,"wdorigin");v&&(i.hostInitDiagnostics.entryPoint=v)}if(!i.host.uiHostName){var w=O(l,"uih");w&&(i.host.uiHostName=w)}}else i.appUrl="";i.appBaseUrl=t.appBaseUrl?t.appBaseUrl.toLowerCase():S(t.appUrl).toLowerCase(),i.appBaseUrl=g(i.appBaseUrl,y(i.appUrl,"region")),i.et.updateEnvironment(i.appBaseUrl),r.initializeAppContext(i,e,t),i.appBasePath=r.buildAppBasePath(i);var I=!1,T=i.preseededSession;i.appInfo.usePreseededSessionId&&T&&T.id&&(i.sessionId=T.id,I=!0);var E,A=!1,R=t.hostGeneratedSessionId;if(!I&&R&&(i.sessionId=R,A=!0),t.rebootOverride&&(I||A||(a=me(),i.sessionId=a[0],E=a[1]),i.pageStateObserver=new Ie(i.logger,!0),i.authTokenTrustValidator=new ye(i.logger)),i.logger.ULS.Ve(38580693,n.B,o.Info,"User session id: ".concat(i.sessionId,", is preseeded: ").concat(I,", is host generated: ").concat(A)),i.remoteTelemetryUrl=r.buildRemoteTelemetryUrl(i),j(i.remoteTelemetryUrl,i.appInfo.name,"init"),!i.isLoggerFromOwl){var U=i.et.getValue(K.rt,"").toString();U||(U=i.appBasePath+"RemoteUls.ashx"),i.logger.configure({remoteUlsEndpoint:U,sessionId:i.sessionId})}if(i.et.initializePeriodicFetch(i.appBasePath,i.sessionId),E&&i.logger.ULS.Ve(590966790,n.B,o.Info,JSON.stringify(E)),function(e){try{var t=e.hostInitDiagnostics;e.logger.ULS.Ve(558155803,n.B,o.Info,"HostInitDiagnostics: "+(t?JSON.stringify(t):"N/A")),e.logger.ULS.Ve(596444237,n.B,o.Info,JSON.stringify({session:we(e),client:e.clientDiagnostics}))}catch(t){e.logger.ULS.Ve(558155804,n.B,o.Error,"Failed to log init info: ".concat(ie(t)))}}(i),r.onContextReady&&r.onContextReady(i),i.appInitDiagnostics={officeSessionId:i.sessionId,officeBootstrapperVersion:J(),hostName:i.hostName,documentLoadedWithTabSwitch:"hidden"===document.visibilityState},document.addEventListener("visibilitychange",(function(){i.appInitDiagnostics.documentLoadedWithTabSwitch=!0}),{once:!0}),!i.container){var W=t.container;i.container=W instanceof Xe?W:i.application.createContainer(W)}i.container.setMessageHandler(i.onMessage);var x=!!r.ignoreCompletionMessage&&r.ignoreCompletionMessage(i),k=function(e,t){var s,a;i.successTime=q(),x||(i.container.postMessage(ce.fo,void 0),s=i.appInitDiagnostics,(a=t.Diagnostics)&&Object.keys(a).forEach((function(e){s[e]=a[e]}))),i.et.addSettingsChangeListener(i.logger.settingsChangeHandler),r.onSuccess&&r.onSuccess(i,t),i.logger.ULS.Ve(596448985,n.B,o.Info,JSON.stringify(i.diagnostics)),j(i.remoteTelemetryUrl,i.application.name,"bootSuccess"),i.logger.ULS.flush(),i.container.postMessage(ce.Io,{HostInitializeDiagnostics:i.hostInitDiagnostics,ClientDiagnostics:i.clientDiagnostics}),i.state=N.Booted,H({completion:"success"}),ve(i.appInfo.name,i.logger)},M=function(e,t){var s;i.failureTime=q(),r.onFailure&&r.onFailure(i,t.Error),i.logger.ULS.Ve(596448986,n.B,o.Error,JSON.stringify({error:t.Error,diagnostics:i.diagnostics})),j(i.remoteTelemetryUrl,i.application.name,"bootFailure"),i.logger.ULS.flush(),i.state=N.Failed,H({completion:"failure",error:t.Error,errorSource:"app",documentLoadedWithTabSwitch:null===(s=i.appInitDiagnostics)||void 0===s?void 0:s.documentLoadedWithTabSwitch}),ve(i.appInfo.name,i.logger)},H=function(t){x||(i.bootHeartBeat&&i.bootHeartBeat.stop(),i.removeActionHandler(ae.gi,k),i.removeActionHandler(ae.vi,M)),e(t)};s&&s.subscribe((function(){var e;H({completion:s.reason||"cancelled",documentLoadedWithTabSwitch:null===(e=i.appInitDiagnostics)||void 0===e?void 0:e.documentLoadedWithTabSwitch})})),x||(i.addActionHandler(ae.gi,k),i.addActionHandler(ae.vi,M)),function(e){var t;if(function(e){return"wdjs"in e||"wd1js"in e}(e))"true"===window.sessionStorage.getItem("sideLoadingIsEnabled")?(!1,"true"===(t=Pe("sideLoadingIsEnabled"))||"false"!==t&&!1||Fe("sideLoadingIsEnabled","true",1)):Fe("sideLoadingIsEnabled","false",0)}(i.wdParams);var D=r.buildBootRequestParams(i),V=function(e,t,i){var n=Y(Y(Y({},C(e.appUrl)),function(e){var t={};_(t,"jsapi","1"),_(t,"jsapiver","v2"),_(t,"corrid",e.sessionId),_(t,"usid",e.sessionId),_(t,"newsession","1"),_(t,"sftc","1"),e.hostSessionId&&_(t,"hid",encodeURIComponent(e.hostSessionId));var i=e.host;i.uiHostName&&_(t,"uih",i.uiHostName),i.uiHostIntegrationType&&_(t,"uihit",encodeURIComponent(i.uiHostIntegrationType)),i.metaUiHostVersion&&_(t,"muv",encodeURIComponent(i.metaUiHostVersion));var n=i.capabilities;n&&(n.accessibilityLoop&&_(t,"accloop","1"),n.rebootDoc&&_(t,"sdr",n.rebootDoc.toString()),n.createNewDoc&&_(t,"scnd","1"),n.authToken&&_(t,"sat","1"),n.customAuthConfig&&_(t,"cac","1"),n.refreshAccessToken&&_(t,"rat","1"),n.atMentions&&_(t,"sams","1"),n.moveToFolder&&_(t,"mtf","1"),n.noBrowserModalDialogs&&_(t,"nbmd","1"),n.commonFilePicker&&_(t,"sfp","1"),n.directDownload&&_(t,"sdd","1"),n.directPrint&&_(t,"sdp","1"));var o=e.ui;o.language&&_(t,"ui",encodeURIComponent(o.language)),o.uiEmbed&&_(t,"uiembed","1"),(o.hideHeader||"DocGen"===o.contentAssemblyMode||"Templatization"===o.contentAssemblyMode||"ContentAssemblyEdit"===o.contentAssemblyMode||"ContentAssemblyView"===o.contentAssemblyMode)&&_(t,"hhdr","1"),o.highContrast&&_(t,"hcm",encodeURIComponent(o.highContrast)),o.hideFileLocationPicker&&_(t,"hodflp","1"),o.hideAppLauncherInHeader&&_(t,"halh","1"),o.hideChatInHeader&&_(t,"hch","1"),o.hideMeInHeader&&_(t,"hmh","1"),o.hideSearchInHeader&&_(t,"hsh","1"),o.hideWorkflowInHeader&&_(t,"hwfh","1"),o.hideSettingsInHeader&&_(t,"hsth","1"),o.showAppIconInHeader&&_(t,"sih","1"),o.useNeutralColorInHeader&&_(t,"unh","1"),o.openLinksInNewWindow&&_(t,"onw","1"),o.useDarkTheme&&_(t,"udt","1"),"DocGen"!==o.contentAssemblyMode&&"ContentAssemblyView"!==o.contentAssemblyMode||_(t,"readOnly","1");var r=e.wopi;r&&r.source&&_(t,"wopisrc",encodeURIComponent(r.source));var s=e.bootParams;s&&(s.dataLanguage&&_(t,"rs",encodeURIComponent(s.dataLanguage)),s.readOnly&&_(t,"readonly","1"),s.disableChat&&_(t,"dchat","1"),s.cookieCompliant&&_(t,"mscc","1"),s.isNewFile&&(_(t,"new","1"),s.isFromHostTemplate&&_(t,"wdtpl","fromhost"))),e.user.isLicensed&&_(t,"islicenseduser","1"),e.user.isSynthetic&&_(t,"syn","1"),e.actNavId&&_(t,"actnavid",e.actNavId),e.sessionContext&&_(t,"sc",encodeURIComponent(e.sessionContext));var a=e.wdParams;if(a)for(var c in a)_(t,c,a[c]);var u=e.preseededSession;u&&(u.key&&_(t,"preseededsessionkey",encodeURIComponent(u.key)),u.id&&_(t,"preseededwacsessionid",encodeURIComponent(u.id)));var l=e.throttling;l&&(l.protection&&_(t,"ctp",l.protection),l.request&&_(t,"rct",l.request));var d=e.hostInitDiagnostics;d&&(d.entryPoint&&_(t,"wdorigin",encodeURI(d.entryPoint)),d.userClickTime&&_(t,"wdhostclicktime",d.userClickTime.toString()));var f=e.rebootOverride;return f&&f.previousSessionId&&_(t,"wdprevioussession",f.previousSessionId),b(t,"region"),t}(e)),i),o=e.rebootOverride;return o&&o.queryOverrides&&(n=Y(Y({},n),o.queryOverrides)),function(e,t,i){var n=[];for(var o in i)i[o]&&n.push(o+"="+i[o]);return e+t+(n.length>0?"?"+n.join("&"):"")}(e.appBasePath,t,n)}(i,D.appPageName,D.queryParamsOverrides),L=function(e,t){var i=function(e){var t={};_(t,"highdpi",String(window.devicePixelRatio>1.24)),_(t,"softblockedbrowser",String(d())),_(t,"hostname",e.hostName),_(t,"feature_status",oe(e.featureManager,e.wdParams)),_(t,"jsapibuild",J());var i=e.wopi;i&&(_(t,"access_token",i.accessToken),_(t,"access_token_ttl",i.expiry.toString()),i.wacToken&&_(t,"wac_token",i.wacToken));var r=e.customFontCatalogUrl;r&&_(t,"customfontcatalogurl",r);var s=e.contentBundle;if(s){if(s.url){_(t,"bundlesrc",s.url);var a=s.staleness,c=null!=a;c&&_(t,Oe.Jr,a.toString()),e.logger.ULS.Ve(577783775,n.B,o.Info,"Content bundle staleness: "+(c?a:"N/A"))}s.urlNoAuth&&_(t,"bundleurlnoauth",s.urlNoAuth),s.bundleCode&&_(t,"bundlecode",s.bundleCode)}var u=e.file,l=u.name;if(l){_(t,"filename",l);var f=te(l);f&&_(t,"fileextension",f)}u.getUrl&&_(t,"filegeturl",u.getUrl),u.downloadCode&&_(t,"filedownloadcode",u.downloadCode),u.urlNoAuth&&_(t,"fileurlnoauth",u.urlNoAuth),u.size&&_(t,"filesize",u.size.toString()),u.eTag&&_(t,"etag",u.eTag),u.cTag&&_(t,"revid",u.cTag),u.uniqueId&&_(t,"docid",u.uniqueId),void 0!==u.immutableReason&&_(t,"immutableReason",u.immutableReason.toString()),void 0!==u.supportsZipIt&&_(t,"supports_zipit",u.supportsZipIt.toString());var h=e.newFileTemplate;h&&(h.getUrl&&_(t,"templateurl",h.getUrl),h.size&&_(t,"filesize",h.size.toString()),h.eTag&&_(t,"etag",h.eTag),h.uniqueId&&_(t,"docid",h.uniqueId)),e.user.id&&_(t,"user_id",e.user.id),e.ownerId&&_(t,"owner_id",e.ownerId),e.sessionContext&&_(t,"sc",e.sessionContext);var p=e.ui;p.controls&&_(t,"huictrls",JSON.stringify(p.controls)),"Templatization"!==p.contentAssemblyMode&&"DocGen"!==p.contentAssemblyMode&&"ContentAssemblyEdit"!==p.contentAssemblyMode&&"ContentAssemblyView"!==p.contentAssemblyMode||_(t,"caae","1"),p.contentAssemblyMode&&_(t,"caaemode",p.contentAssemblyMode);var m=e.meeting;m&&(m.id&&_(t,"meetingId",m.id),m.title&&_(t,"meetingTitle",m.title),m.type&&_(t,"meetingType",m.type),m.scheduledStartTime&&_(t,"scheduledStartTime",m.scheduledStartTime),m.scheduledEndTime&&_(t,"scheduledEndTime",m.scheduledEndTime),m.isPresenter&&_(t,"isPresenter",m.isPresenter.toString()),m.organizerId&&_(t,"meetingOrganizerId",m.organizerId),m.joinUrl&&_(t,"meetingJoinUrl",encodeURIComponent(m.joinUrl)),m.isMeetingTeamsRoom&&_(t,"isMeetingTeamsRoom",m.isMeetingTeamsRoom.toString()));var v=e.host;return v.owlVersion&&_(t,"owlver",v.owlVersion),v.owlRollout&&_(t,"owlro",v.owlRollout),t}(e);return Object.keys(t).forEach((function(e){t[e]?i[e]=t[e]:delete i[e]})),i}(i,D.postDataOverrides);if(i.bootstrapperUrl&&i.preconnector&&i.preconnector.shouldPreconnect(i.hostName)&&i.preconnector.preconnect(i.bootstrapperUrl),i.bootstrapperUrl&&i.preloader&&i.preloader.shouldPreload(V,i.host.origin))try{r.beforePreload&&r.beforePreload(i);var B=i.bootstrapperUrl;i.featureManager.isFeatureEnabled(Q.Ht)&&(i.logger.ULS.Ve(590966791,n.B,o.Info,"HTTP2 preload enabled"),B=P(B)),i.preloader.preload(B,i.ui.language,i.logger,i.featureManager)}catch(e){i.logger.ULS.Ve(590966792,n.B,o.Error,"Error preloading")}r.beforeContainerBoot&&r.beforeContainerBoot(i,V),i.appInitDiagnostics.officeFrameCreateTime=q(),i.container.boot(V,L,i.logger,r.buildContainerBootParams(i)),x?k(ae.gi,{Diagnostics:{}}):(i.bootHeartBeat=new At(m(i.appBaseUrl),i.et,i.logger,(function(){var e;i.timeoutTime=q(),r.onTimeout&&r.onTimeout(i),j(i.remoteTelemetryUrl,i.application.name,"bootTimeout"),H({completion:"timeout",error:{documentLoadedWithTabSwitch:null===(e=i.appInitDiagnostics)||void 0===e?void 0:e.documentLoadedWithTabSwitch}}),s&&s.cancel()}),s&&r.overrideBootTimeout?Math.min(s.timeoutInMs,r.overrideBootTimeout(i)):s?s.timeoutInMs:r.overrideBootTimeout?r.overrideBootTimeout(i):void 0),r.beforeBootCompletionMessage&&r.beforeBootCompletionMessage(i))})).catch((function(e){throw i.failureTime=q(),r.onException&&r.onException(i,e),i.remoteTelemetryUrl&&j(i.remoteTelemetryUrl,i.application.name,"bootException"),i.bootHeartBeat&&i.bootHeartBeat.stop(),{error:e.toString(),errorStack:e.stack}}))},ai=function(e,t,i,r,s){return e!==ae._i?Promise.reject("Wrong flow"):new Promise((function(e){try{window.top&&window.top.close()}catch(e){i.logger.ULS.Ve(579213189,n.B,o.Warning,"Failed to close the browser tab")}e({completion:"success"})}))},ci=function(e,t,i){return new Promise((function(t){i.logger.ULS.Ve(590111070,n.B,o.Error,"Unsupported flow: ".concat(e)),t({completion:"failure"})}))},ui=function(){function e(e){var t=this;this.Rc=!1,this.Uc="",this.Wc=[],this.xc=function(e){t.Rc||(t.Rc=!0,t.Uc=e?"timeout":"cancelled",t.Wc.map((function(e){return e()})),t.Wc=[])},this.kc=e,window.setTimeout((function(){return t.xc(!0)}),e)}return Object.defineProperty(e.prototype,"isCancelled",{get:function(){return this.Rc},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timeoutInMs",{get:function(){return this.kc},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){return this.Uc},enumerable:!1,configurable:!0}),e.prototype.cancel=function(){this.xc(!1)},e.prototype.subscribe=function(e){this.Rc?e():this.Wc.push(e)},e}();function li(e){return new ui(e)}var di=function(e,t,i,r,s){return e!==se.dispose?Promise.reject("Wrong flow"):new Promise((function(e){i.logger.ULS.Ve(595714433,n.B,o.Info,"start disposing the application");var a=i.host.requireExplicitUnload,c={disposeStartTime:q(),forceAppUnload:a};i.state=N.Disposing;var u=function(){i.state=N.Disposed,e({completion:"success"})},l=function(e){r&&r.disposeAppSpecificResources&&r.disposeAppSpecificResources(i,t),i.dispose(),c.disposeEndTime=q(),function(e,t,i){if(i){var r=Number(i.hostMessageReceived);t.appUnloadStartTime&&!isNaN(r)&&(t.hostToAppPostMessageLatency=r-t.appUnloadStartTime);var s=Number(i.appMessageSent);!isNaN(s)&&t.appUnloadEndTime&&(t.appToHostPostMessageLatency=t.appUnloadEndTime-s);var a=Number(i.appUnloadStart),c=Number(i.appUnloadEnd);if(isNaN(a)||isNaN(c)||(t.appUnloadLatency=c-a),i.serverTimings){var u=i.serverTimings;for(var l in u)t["st-"+l.toString()]=u[l]}}e.logger.ULS.Ve(592524822,n.B,o.Info,"App disposed: "+JSON.stringify(t)),e.logger.ULS.flushOnClose()}(i,c,e),i.container?i.container.dispose(i.pendingReboot,a).then(u):u()};a?(c.appUnloadStartTime=q(),i.addActionHandler(ae.dn,(function(e,t){c.appUnloadEndTime=q(),l(t)})),(s||new ui(5e3)).subscribe((function(){i.state===N.Disposing&&(c.appUnloadTimedOut=!0,l())})),i.container&&i.container.postMessage(ce.zo,void 0)):l()}))},fi=function(e,t,i,r,s){return e!==ae.ki?Promise.reject("Wrong flow"):new Promise((function(e){if(i.host.capabilities&&i.host.capabilities.frameTrustCheck)i.raiseEvent(ue.FrameTrust,t);else{var r=!!i.container&&i.container.isTopFrameTrusted;i.logger.ULS.Ve(592445957,n.B,o.Info,"Top frame is trusted: ".concat(r)),i.container&&i.container.postMessage(ce.ki,{isTopFrameTrusted:r})}e({completion:"success"})}))},hi=function(e,t,i,n,o){return e!==ae.Ni?Promise.reject("Wrong flow"):new Promise((function(e){i.authTokenTrustValidator.isResourceTrustedForMessage(t).then((function(n){n?i.raiseEvent(ue.GetAuthToken,t):(i.container.postMessage(ce.Uo,{AuthToken:"",Error:"accessDenied",RequestId:t.RequestId,IdentityType:t.IdentityType}),e({completion:"success"}))}),(function(n){i.container.postMessage(ce.Uo,{AuthToken:"",Error:"Exception encountered in AuthTokenTrustValidator.isResourceTrustedForMessage",RequestId:t.RequestId,IdentityType:t.IdentityType}),e({completion:"failure",error:n})}))}))},pi=function(e,t,i,r,s){return e!==ae.wi?Promise.reject("Wrong flow"):new Promise((function(e){var s=t&&t.state?t.state:"Unknown";i.logger.ULS.Ve(592839750,n.B,o.Info,"Boot state: [".concat(s,"]")),r&&r.beforeComplete&&r.beforeComplete(s),e({completion:"success"})}))},mi=function(e,t,i,r,s){if(e!==se.postWacToken)return Promise.reject("Wrong flow");var a=G();return i.logger.ULS.Ve(507774685,n.B,o.Important,"postWacToken flow initiated"),new Promise((function(e){var r=function(e,t){i.logger.ULS.Ve(507597017,n.B,o.Info,"postWacToken flow completed in ".concat(G()-a," ms")),window.clearInterval(u),window.clearTimeout(l);var r={completion:"success"};t&&void 0!==t.TokenAlreadySet&&(r.data={TokenAlreadySet:t.TokenAlreadySet}),s(r)},s=function(t){i.removeActionHandler(ae.io,r),e(t)},c=function(){var e;return null===(e=i.container)||void 0===e?void 0:e.postMessage(ce.or,t)};i.addActionHandler(ae.io,r),c();var u=window.setInterval(c,100),l=window.setTimeout((function(){window.clearInterval(u),i.logger.ULS.Ve(507844190,n.B,o.Warning,"postWacToken flow timed out after ".concat(6e4," milliseconds")),s({completion:"timeout"})}),6e4)}))},vi=function(e,t,i,n,o){return e!==se.rename?Promise.reject("Wrong flow"):new Promise((function(e){var n=function(e,i){var n={completion:i.NewName===t.NewName?"success":"failure"};s(n)},r=function(e,t){s({completion:"failure"})},s=function(t){i.removeActionHandler(ae.Ri,n),i.removeActionHandler(ae.Ui,r),e(t)};i.addActionHandler(ae.Ri,n),i.addActionHandler(ae.Ui,r),(o||new ui(5e3)).subscribe((function(){s({completion:"cancelled"})})),i.container&&i.container.postMessage(ce.Oo,t)}))},wi=function(e,t,i,n,o){return e!==se.switchMode?Promise.reject("Wrong flow"):new Promise((function(e){var n=function(e,t){r({completion:"success"})},r=function(t){i.removeActionHandler(ae.Ji,n),e(t)};i.addActionHandler(ae.Ji,n),(o||new ui(5e3)).subscribe((function(){r({completion:"cancelled"})})),i.container&&i.container.postMessage(ce.qo,t)}))};function gi(e){}function Si(e){Jt(e.logger)}function Ii(e){return e.appBaseUrl+"/x/"}function _i(e){return e.appBasePath+"_layouts/"+"RemoteTelemetry.ashx"+((t=e.sessionId)?"?usid="+t:"");var t}function bi(e){var t=e.appUrl,i=lt(t),r=dt(t),s=ft(t);return i||r||s||e.logger.ULS.Ve(553673218,n.B,o.Warning,"Unknown endpoint: ".concat(A(t))),!(i||r)}function yi(e){var t,i,n=e.appUrl,o=lt(n),r=dt(n),s=ft(n),a=o?"_layouts/xlviewerinternal.aspx":r?"_layouts/xlembed.aspx":s?"_layouts/xlpreview.aspx":function(e){var t=e.toLowerCase().indexOf("/x/");if(t<0)return"";var i=e.indexOf("?");return i<0?e.substring(t+"/x/".length):i<t?"":e.substring(t+"/x/".length,i)}(n),c={},u={};_(c,"wdredirectionreason","Force_SingleStepBoot");var l=e.host.capabilities;l&&l.excelExternalLinks&&_(c,"xlel","1");var d=e.viewMode;d&&(d.hideToolbar&&_(c,"hvt","1"),d.hideEditUpsellDialog&&_(c,"hdeditdlg","1"));var f=e.bootParams;f&&f.isNewFile?(b(c,"unified"),_(c,"edit","1"),_(c,"new","1")):_(c,"instantedit","1"),_(u,Oe.ns,JSON.stringify({HostInitializeDiagnostics:e.hostInitDiagnostics,ClientDiagnostics:e.clientDiagnostics}));var h=((t={})[Oe.os]=e.hostName,t[Oe.fs]=e.user.id,t[Oe.jr]=(null===(i=e.file)||void 0===i?void 0:i.uniqueId)||"noDocId",t);It(e.logger,h,""),_(u,Oe.hs,h[Oe.hs]),h[Oe.ps]&&_(u,Oe.ps,h[Oe.ps]),_(u,Oe.ms,(new Intl.DateTimeFormat).resolvedOptions().timeZone);var p=e.rebootOverride;if(p){var m=p.mode;m&&("view"===(m=m.toLowerCase())?_(c,"wdforcedmode","View"):"edit"===m&&_(c,"wdforcedmode","Edit"))}var v=e.file.size;return v&&v>=52428800&&v<=104857600&&_(c,"ilf","1"),{appPageName:a,queryParamsOverrides:c,postDataOverrides:u}}function Ti(e,t){vt(t)&&ht(e.logger,e.container.formId,e.featureManager,e.sessionId),St(e.logger,void 0,e),jt(e.logger,void 0,e),Xt(e.logger,void 0,e)}function Ci(e){var t,i;return{permissionsPolicy:(i=e.appBaseUrl,"microphone ".concat(i,"; autoplay ").concat(i,"; camera ").concat(i,"; clipboard-read ").concat(i,"; clipboard-write ").concat(i,"; keyboard-map ").concat(i,"; display-capture ").concat(i)),useFrameFixForTeams:"teams"===(null===(t=e.host.uiHostName)||void 0===t?void 0:t.toLowerCase())}}var Ei,Ai=function(){var e,t;return[(e={},e[re.appReboot]=ri,e[re.boot]=si,e[re.closeTab]=ai,e[re.createNew]=ci,e[re.dispose]=di,e[re.frameTrust]=fi,e[re.getAuthToken]=hi,e[re.getHostKeyValue]=xt,e[re.handleBootState]=pi,e[re.postWacToken]=mi,e[re.rename]=vi,e[re.setWacFlightValue]=Ot,e[re.setOverlayContent]=Ut,e[re.storeHostKeyValue]=Nt,e[re.switchMode]=wi,e[re.updateBootComplete]=ci,e),(t={},t[re.boot]={initializeAppContext:gi,beforePreload:Si,buildAppBasePath:Ii,buildRemoteTelemetryUrl:_i,ignoreCompletionMessage:bi,buildBootRequestParams:yi,beforeContainerBoot:Ti,buildContainerBootParams:Ci,onSuccess:mt},t[re.handleBootState]={beforeComplete:pt},t)]};!function(e){e[e.NotSupported=0]="NotSupported",e[e.SameDocOnly=1]="SameDocOnly",e[e.AnyDoc=2]="AnyDoc",e[e.OtherMode=4]="OtherMode"}(Ei||(Ei={}));var Pi=new Qt((function(e,t,i,n,o){return new ti(e,t,i,n,o)}),{forceSingleStepBoot:!1,preloader:U(ii,oi),preconnector:M(!0)}),Fi=function(e){var t={name:"Excel",preloader:U(ii,oi),preconnector:M(!0)};return new $e(e,t,Ai)}}});
//# sourceMappingURL=excel-boot.f4b36862974bd6ce849b.js.map