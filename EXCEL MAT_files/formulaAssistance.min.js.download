var formulaAssistance=(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[18],{2001:function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),t.DefinedNameInfoType=void 0,function(e){e[e.Invalid=-1]="Invalid",e[e.Table=0]="Table",e[e.NamedRange=1]="NamedRange",e[e.Lambda=2]="Lambda",e[e.Other=3]="Other"}(o||(t.DefinedNameInfoType=o={}))},2002:function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),t.MajorityDataType=void 0,function(e){e[e.Text=0]="Text",e[e.Number=1]="Number",e[e.Date=2]="Date",e[e.Max=3]="Max"}(o||(t.MajorityDataType=o={}))},2003:function(e,t,n){"use strict";var o,a,r,i,l,c;Object.defineProperty(t,"__esModule",{value:!0}),t.RepairItemPartType=t.CodeActionKind=t.DiagnosticTag=t.DiagnosticSeverity=t.SuggestionKind=t.CompletionItemKind=void 0,function(e){e[e.Function=3]="Function",e[e.Enum=13]="Enum",e[e.NamedRange=100]="NamedRange",e[e.TableHeader=101]="TableHeader",e[e.LetVariable=102]="LetVariable",e[e.RichEntity=103]="RichEntity",e[e.Lambda=104]="Lambda",e[e.CustomFunction=105]="CustomFunction",e[e.Table=106]="Table",e[e.TableSpecialStructRef=107]="TableSpecialStructRef",e[e.RichEntityEmptyCellRef=108]="RichEntityEmptyCellRef",e[e.RangeRef=109]="RangeRef",e[e.NamedOther=110]="NamedOther"}(o||(t.CompletionItemKind=o={})),function(e){e[e.Simple=0]="Simple",e[e.Smart=1]="Smart"}(a||(t.SuggestionKind=a={})),function(e){e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Information=3]="Information",e[e.Hint=4]="Hint"}(r||(t.DiagnosticSeverity=r={})),function(e){e[e.Unnecessary=1]="Unnecessary",e[e.Deprecated=2]="Deprecated"}(i||(t.DiagnosticTag=i={})),function(e){e[e.Empty=0]="Empty",e[e.QuickFix=1]="QuickFix",e[e.Refactor=2]="Refactor",e[e.RefactorExtract=3]="RefactorExtract",e[e.RefactorInline=4]="RefactorInline",e[e.RefactorRewrite=5]="RefactorRewrite",e[e.Source=6]="Source",e[e.SourceOrganizeImports=7]="SourceOrganizeImports",e[e.SourceFixAll=8]="SourceFixAll"}(l||(t.CodeActionKind=l={})),function(e){e[e.None=0]="None",e[e.Added=1]="Added",e[e.Removed=2]="Removed",e[e.Replaced=3]="Replaced"}(c||(t.RepairItemPartType=c={}))},2004:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2005:function(e,t,n){"use strict";var o,a;Object.defineProperty(t,"__esModule",{value:!0}),t.ReferenceMode=t.IncompatibilityType=void 0,function(e){e[e.gMove=1]="gMove"}(o||(t.IncompatibilityType=o={})),function(e){e[e.R1C1=0]="R1C1",e[e.A1=1]="A1"}(a||(t.ReferenceMode=a={}))},2006:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2007:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2008:function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),t.Rounding=void 0,function(e){e[e.RoundSec=0]="RoundSec",e[e.Round10ths=1]="Round10ths",e[e.Round100ths=2]="Round100ths",e[e.Round1000ths=3]="Round1000ths"}(o||(t.Rounding=o={}))},2009:function(e,t,n){"use strict";var o,a,r,i,l,c,s,u,d,m,p,g,f,b;Object.defineProperty(t,"__esModule",{value:!0}),t.TableOrientation=t.RecognizedTablesMetadataState=t.ColumnFormulaSuggestionUpdateKind=t.SchedulerFeature=t.GotoCtrlClickResultKind=t.ValuePreviewResultKind=t.PositionKind=t.HighlightKind=t.PerCharacterExperimentResultKind=t.PluginAttachGroup=t.PluginGroup=t.PluginFactoryName=t.MessageType=t.EditorMessageType=void 0,function(e){e[e.FunctionMessage=0]="FunctionMessage"}(o||(t.EditorMessageType=o={})),function(e){e[e.Insert=0]="Insert",e[e.Delete=1]="Delete",e[e.Replace=2]="Replace"}(a||(t.MessageType=a={})),function(e){e[e.TestPlugin=0]="TestPlugin",e[e.AutocompletePlugin=1]="AutocompletePlugin",e[e.DragPlugin=2]="DragPlugin",e[e.ConfigTestPlugin=3]="ConfigTestPlugin",e[e.ArgumentAssistancePlugin=4]="ArgumentAssistancePlugin",e[e.FeatureGateTestPlugin=5]="FeatureGateTestPlugin",e[e.DNMTraceTagTestPlugin=7]="DNMTraceTagTestPlugin",e[e.ParenthesesCouplingPlugin=8]="ParenthesesCouplingPlugin",e[e.AutocompleteFunctionPlugin=9]="AutocompleteFunctionPlugin",e[e.AutocompleteLetPlugin=10]="AutocompleteLetPlugin",e[e.AutocompleteRichValuePlugin=11]="AutocompleteRichValuePlugin",e[e.AutocompleteNamedObjectsPlugin=12]="AutocompleteNamedObjectsPlugin",e[e.AutocompleteTableHeadersPlugin=13]="AutocompleteTableHeadersPlugin",e[e.ColoredReferencesPlugin=14]="ColoredReferencesPlugin",e[e.ValuePreviewPlugin=15]="ValuePreviewPlugin",e[e.AutocompleteRangeSuggestionPlugin=16]="AutocompleteRangeSuggestionPlugin",e[e.SyntaxErrorsPlugin=17]="SyntaxErrorsPlugin",e[e.GotoCtrlClickPlugin=18]="GotoCtrlClickPlugin",e[e.AutocompleteEnumPlugin=19]="AutocompleteEnumPlugin",e[e.FormulaByExamplePlugin=20]="FormulaByExamplePlugin",e[e.SetCellPrefetchPlugin=21]="SetCellPrefetchPlugin",e[e.FormulaTranspilerPlugin=22]="FormulaTranspilerPlugin",e[e.FormulaCollectionPlugin=1004]="FormulaCollectionPlugin",e[e.ParserPerformanceMeasurements=1005]="ParserPerformanceMeasurements",e[e.FormulaRepairShadowEvalPlugin=1007]="FormulaRepairShadowEvalPlugin",e[e.PythonAutocompletePlugin=1008]="PythonAutocompletePlugin",e[e.AutocompleteWrapperPlugin=1009]="AutocompleteWrapperPlugin",e[e.AutocompleteBinaryModelExperimentPlugin=1010]="AutocompleteBinaryModelExperimentPlugin",e[e.ChangeGateTestPlugin=2e3]="ChangeGateTestPlugin",e[e.SlowTestPlugin=2001]="SlowTestPlugin",e[e.EvalOnCloneTestPlugin=2002]="EvalOnCloneTestPlugin",e[e.EvalFormulaTestPlugin=2003]="EvalFormulaTestPlugin",e[e.PythonTestPlugin=2004]="PythonTestPlugin",e[e.ChatGPTPlugin=2005]="ChatGPTPlugin",e[e.EventsTestPlugin=2006]="EventsTestPlugin"}(r||(t.PluginFactoryName=r={})),function(e){e[e.Excel=0]="Excel",e[e.Python=1]="Python"}(i||(t.PluginGroup=i={})),function(e){e[e.Core=0]="Core",e[e.Python=1]="Python",e[e.SmartSuggestionsAutoComplete=2]="SmartSuggestionsAutoComplete"}(l||(t.PluginAttachGroup=l={})),function(e){e[e.AutocompleteWrapperPluginResult=0]="AutocompleteWrapperPluginResult"}(c||(t.PerCharacterExperimentResultKind=c={})),function(e){e[e.CellRef=0]="CellRef",e[e.StructRef=1]="StructRef",e[e.NamedRange=2]="NamedRange",e[e.Parentheses=3]="Parentheses"}(s||(t.HighlightKind=s={})),function(e){e[e.Absolute=0]="Absolute",e[e.Relative=1]="Relative"}(u||(t.PositionKind=u={})),function(e){e[e.Failure=0]="Failure",e[e.Success=1]="Success",e[e.Unavailable=2]="Unavailable"}(d||(t.ValuePreviewResultKind=d={})),function(e){e[e.ReferenceFound=0]="ReferenceFound",e[e.NoReferenceFound=1]="NoReferenceFound",e[e.Failure=2]="Failure",e[e.RangeResolutionFailure=3]="RangeResolutionFailure",e[e.NotAFormula=4]="NotAFormula"}(m||(t.GotoCtrlClickResultKind=m={})),function(e){e[e.ArgumentAssistance=0]="ArgumentAssistance",e[e.SimpleAutoComplete=1]="SimpleAutoComplete",e[e.SmartSuggestionsAutoComplete=2]="SmartSuggestionsAutoComplete",e[e.ValuePreview=3]="ValuePreview",e[e.ColoredReferences=4]="ColoredReferences",e[e.ParenthesisCoupling=5]="ParenthesisCoupling",e[e.SyntaxErrors=6]="SyntaxErrors",e[e.GotoCtrlClick=7]="GotoCtrlClick",e[e.EnumAutoComplete=8]="EnumAutoComplete"}(p||(t.SchedulerFeature=p={})),function(e){e[e.Accept=0]="Accept",e[e.Decline=1]="Decline",e[e.Ignore=2]="Ignore"}(g||(t.ColumnFormulaSuggestionUpdateKind=g={})),function(e){e[e.Valid=2]="Valid",e[e.Invalid=4]="Invalid",e[e.All=6]="All"}(f||(t.RecognizedTablesMetadataState=f={})),function(e){e[e.none=0]="none",e[e.rowMajor=1]="rowMajor",e[e.columnMajor=2]="columnMajor"}(b||(t.TableOrientation=b={}))},2010:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2011:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2012:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2013:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(3).__exportStar(n(2014),t)},2014:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2034:function(e,t,n){"use strict";n.r(t),n.d(t,"FormulaAssistanceUIFactoryGlobal",(function(){return Yt}));var o=n(3),a=n(1),r=n(373),i=n(57),l=n(1333),c=n(28),s=n.n(c),u=n(17),d=n(5),m=n(145),p=n(18),g=n(102),f=Object(o.__assign)(Object(o.__assign)({},d.b.fadeIn100),{animationTimingFunction:d.c.easeFunction1}),b="0.467s cubic-bezier(0.5, 0, 0, 1)",h={animation:"none","will-change":"transform",left:"0px !important /* @noflip */",right:"auto !important /* @noflip */",top:"var(--top) !important",bottom:"var(--bottom) !important",maxWidth:"var(--max-width) !important",maxHeight:"var(--max-height) !important"},v={root:Object(o.__assign)({borderRadius:4},f),calloutMain:{borderRadius:4}},x={root:{color:Object(g.a)().primary,fontSize:d.k.size12,fontWeight:d.l.semibold,lineHeight:d.k.size16,userSelect:"none",selectors:{"&:active, &:hover, &:active:hover, &:focus":{color:Object(g.a)().primary}}}},E={scrollbarWidth:"thin",scrollbarColor:"#808080 #FFF","-ms-scrollbar-base-color":"#808080","-ms-scrollbar-track-color":"#FFF",selectors:{"::-webkit-scrollbar":{width:14},"::-webkit-scrollbar-thumb":{borderRadius:20,backgroundColor:m.a.gray110,border:"solid 4px transparent",backgroundClip:"content-box"},"::-webkit-scrollbar-thumb:hover":{backgroundColor:m.a.gray120},"::-webkit-scrollbar-button:vertical":{height:4}}},C={container:{height:"100%"},root:{height:"100%",maxWidth:"max-content",boxSizing:"border-box"}},y={padding:"".concat(5,"px ").concat(7,"px")},S=n(19),_=n(160),R=_.b.getInstance().getTheme(),O=Object(S.getBooleanFeatureGate)("Microsoft.Office.Excel.FormulaAssistantMinifiedState",!1),P=Object(u.c)((function(e){var t=e===z.expanded,n=t||e===z.collapsed,a=function(){return O?n?"".concat(10,"px ").concat(14,"px"):void 0:"".concat(5,"px ").concat(7,"px")};return Object(d.db)({cardPart:{padding:a()},expandedCardPart:{padding:a(),minWidth:t?void 0:"".concat(326,"px")},focusTrapCallout:{height:"100%"},root:{display:"flex",width:n?"min-content":"".concat(20,"px"),maxHeight:n?"100%":void 0,cursor:"default",flexDirection:"column"},collapsedCard:{width:"max-content",maxWidth:"".concat(500,"px"),minWidth:O||t?"".concat(340,"px"):"0px",direction:"ltr",flexShrink:0,transition:t?void 0:"min-width ".concat("0s cubic-bezier(0.5, 0, 0, 1) 0.467s"),selectors:{":after":A(t)}},expandedCard:Object(o.__assign)(Object(o.__assign)({overflowY:"auto",maxWidth:t?"".concat(500,"px"):"0px",transition:O?n?"max-height ".concat(b):void 0:t?"max-height ".concat(b):"max-height ".concat(b,", max-width ").concat("0s cubic-bezier(0.5, 0, 0, 1) 0.467s")},E),{":before":A(!t)}),collapseHeader:{width:"85%"},singleLineCard:Object(o.__assign)({},Object(S.isChangeGateEnabled)("OfficeVSO:9010567_MinifiedIconHighContrastMode")&&{height:22,overflow:"hidden",padding:"0px",marginLeft:-1})})})),k=Object(d.db)(v,{calloutMain:{overflow:"hidden"}}),A=function(e){return{content:'""',position:"relative",display:e?"block":"none",margin:"0px ".concat(7,"px 0px ").concat(7,"px"),height:1,backgroundColor:m.a.gray40}},w=Object(u.c)((function(){var e;return{root:{height:20,width:20,top:2,borderRadius:2,selectors:(e={},e[":hover, :focus"]=Object(o.__assign)({},p.n),e)},icon:{height:16,width:16}}})),F=Object(u.c)((function(){return Object(d.db)(w(),{icon:{transition:"transform .2s",transform:"var(".concat("--collapse-icon-transform",")")},flexContainer:{marginLeft:1}})})),j=Object(u.c)((function(){return Object(d.db)(w(),{icon:{transition:"transform .2s",transform:"var(".concat("--collapse-icon-transform",")")},flexContainer:{marginLeft:1}})})),T=Object(u.c)((function(){var e,t;return{icon:{height:22,width:20,transition:"transform .2s",transform:"var(".concat("--collapse-icon-transform",")"),backgroundColor:R.palette.green,padding:0,selectors:(e={},e["path.OfficeIconColors_m22"]={fill:"white"},e["path.OfficeIconColors_m20"]={fill:"green"},e[":hover, :focus"]=Object(o.__assign)({},Object(S.isChangeGateEnabled)("OfficeVSO:9010567_MinifiedIconHighContrastMode")&&(t={},t[d.m]=[p.n],t)),e)},root:{height:22,width:20,top:0,borderRadius:2},flexContainer:{marginLeft:1}}})),I=n(2543),M=n(80),N=n(79),D=n(213);function H(e){var t=Object(a.useRef)(0),n=Object(a.useState)(null),o=n[0],r=n[1];return Object(a.useEffect)((function(){var n=-1,o=function(){var a=document.getElementById(e);a?(r(a),t.current>=10&&M.a.sendTraceTag(508842627,N.a.msoulscat_ES_EWAJS,D.a.Warning,"useElementById found #".concat(e," ")+"in ".concat(t.current," frames."))):t.current<40?(t.current++,n=requestAnimationFrame(o)):M.a.sendTraceTag(509634701,N.a.msoulscat_ES_EWAJS,D.a.Error,"useElementById couldn't find #".concat(e," ")+"in less than ".concat(t.current," frames."))};return o(),function(){return cancelAnimationFrame(n)}}),[e,40]),o}function L(e,t,n){return e<t?t:e>n?n:e}function W(e){var t=e.x,n=e.y,o=e.maxWidth,a=e.maxHeight,r=e.renderDown,i=r?"0px":"auto",l=r?"auto":"-100vh",c=r?"".concat(Math.round(n),"px"):"calc(".concat(Math.round(n),"px - 100vh)");return{transform:"translate(".concat(Math.round(t),"px, ").concat(c,")"),"--top":i,"--bottom":l,"--max-width":"".concat(o,"px"),"--max-height":"".concat(a,"px")}}function B(e,t,n,o,a,r,i){var l={top:8,left:8,right:window.innerWidth-8,bottom:window.innerHeight-8},c={top:L(i.top,l.top,l.bottom),left:L(i.left,l.left,l.right),right:L(i.right,l.left,l.right),bottom:L(i.bottom,l.top,l.bottom)},s={top:L(e.top,c.top,c.bottom),left:L(e.left,c.left,c.right),right:L(e.right,c.left,c.right),bottom:L(e.bottom,c.top,c.bottom)},u=c.right-c.left,d=function(e,t,n,o,a,r){if(o){var i=r.bottom-t,l=e-r.top,c=(a?i:l)>=n,s=c?a:!a;return!c&&n>i&&n>l&&(s=i>=l),{availableVerticalSpace:r.bottom-r.top,shouldRenderDown:s}}var u=e-r.top,d=r.bottom-t,m=0,p=a;return a&&n<=d?m=d:!a&&n<=u?m=u:(p=d>=u,m=Math.max(d,u)),{availableVerticalSpace:m,shouldRenderDown:p}}(s.top,s.bottom,n,a,r,c),m=d.availableVerticalSpace,p=d.shouldRenderDown,g=Math.min(415,m),f=Math.min(500,u),b=L(s.left,c.left,c.right-Math.min(o,f)),h=0;if(a&&r!==p){var v=s.top;h=p?v-t:v+t}else h=p?s.bottom:s.top;var x=h;return a&&(x=L(h,p?c.top:Math.min(c.bottom,c.top+t),p?Math.max(c.top,c.bottom-t):c.bottom)),{x:b,y:x,maxWidth:f,maxHeight:g,renderDown:p}}var z,G=n(14),K=n.n(G);!function(e){e[e.expanded=0]="expanded",e[e.collapsed=1]="collapsed",e[e.singleLine=2]="singleLine"}(z||(z={}));var V,U,J,Z=Object(S.getBooleanFeatureGate)("Microsoft.Office.Excel.FormulaAssistantMinifiedState",!1),Q=a.forwardRef((function(e,t){var n=e.hidden,c=e.setComponentApi,u=e.onLayoutChange,d=e.getTargetAndBounds,m=e.renderCompactCard,p=e.renderExpandedCard,g=e.onIsExpandedChange,f=e.isExpanded,h=e.collapsedId,v=Object(o.__rest)(e,["hidden","setComponentApi","onLayoutChange","getTargetAndBounds","renderCompactCard","renderExpandedCard","onIsExpandedChange","isExpanded","collapsedId"]),x=H("aa-callout"),E=a.useState(f?z.expanded:z.collapsed),C=E[0],y=E[1],_=a.useRef(null),R=a.useRef(null),O=a.useRef(null),A=a.useRef(null),w=a.useRef(null),L=a.useRef(C),G=a.useRef(-1),V=a.useRef(-1),U=a.useCallback((function(e){var t;if(void 0===e&&(e=!1),!n&&x){var o,a=_.current,r=O.current,i=w.current,l=C!==z.singleLine?a.scrollHeight+r.scrollHeight:null==i?void 0:i.scrollHeight,c=C!==z.singleLine?a.scrollWidth:0,s=d(),m=s.target,p=s.bounds,g=s.isFloating,f=s.renderDown,h=s.activeCellAndGridZoom;switch(C!==z.singleLine||0===p.top&&0===p.left||(m.left-=10*(null!==(t=null==h?void 0:h.zoomNumber)&&void 0!==t?t:1)),C){case z.expanded:o=l;break;case z.collapsed:o=a.clientHeight;break;default:o=0}var v=g?l:Math.max(l,300),E=!1;g&&(G.current!==m.top||V.current!==m.left)&&((E=!f&&!e)&&(m.top-=o,m.bottom=m.top),G.current=m.top,V.current=m.left);var y=B(m,o,v,c,g,f||E,p);u(y);var S=C!==L.current,R=y.renderDown===f&&y.y!==m.top,P=S&&R;L.current=C;var k=W(y);if(P){x.style.transition="transform ".concat(b);var A=function(){x.style.transition="",x.ontransitionend=null,x.ontransitioncancel=null};x.ontransitionend=A,x.ontransitioncancel=A}for(var F=0,j=Object.entries(k);F<j.length;F++){var T=j[F],I=T[0],M=T[1];x.style.setProperty(I,M)}var N=y.maxWidth<340;x.style.minWidth=C===z.expanded?"".concat(N?y.maxWidth:340,"px"):"0px";var D=C===z.expanded&&y.maxHeight<l;r.style.overflow=D?"hidden auto":"hidden";var H=C===z.expanded&&y.renderDown;Z||a.style.setProperty("--collapse-icon-transform",H?"scaleY(-1)":"")}}),[d,n,C,u,x]);a.useEffect((function(){if(x){var e=O.current,t=C===z.expanded?e.scrollHeight:0;e.style.maxHeight="".concat(t,"px")}})),a.useEffect((function(){x&&U(!0)})),a.useEffect((function(){c({updatePosition:U})}),[c,U]);var J=P(C),Q=function(){M.a.sendTraceTag(507327841,N.a.msoulscat_ES_EWAJS,D.a.Info,"Formula Argument Assistance Close Button Clicked")},Y=function(e){C!==z.singleLine?y(z.singleLine):y(z.collapsed),C!==z.singleLine?null==g||g(C===z.expanded):Q()},X=function(e){e.preventDefault()},q=C===z.expanded?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaArgumentAssistanceCollapse):ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaArgumentAssistanceExpand);return Z&&z.singleLine===C&&M.a.sendTraceTag(507003416,N.a.msoulscat_ES_EWAJS,D.a.Info,"Formula Argument Assistance Card is opened in singleline state."),a.createElement(l.a,Object(o.__assign)({onKeyDownCapture:function(e){var t,n,o=null!==(t=e.keyCode)&&void 0!==t?t:e.which;C!==z.expanded||o!==i.a.up&&o!==i.a.down||null===(n=O.current)||void 0===n||n.scrollBy({top:o===i.a.up?-100:100,left:0,behavior:"smooth"})},isBeakVisible:!1,styles:k,hidden:n,focusTrapProps:{className:J.focusTrapCallout,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,disableFirstFocus:!0}},v),a.createElement("div",{ref:t,className:J.root},a.createElement("div",{id:h,className:J.collapsedCard,ref:_},a.createElement(r.a,{className:J.cardPart,horizontal:!0,horizontalAlign:"space-between",reversed:!0},C!==z.singleLine&&a.createElement(a.Fragment,null,a.createElement(a.Fragment,null,Z&&a.createElement(a.Fragment,null,a.createElement(I.a,{id:"toggleCardStateCloseButtonId","data-testid":"toggleCardStateCloseButtonId",iconProps:{iconName:K.a.CancelGlyph_20},ariaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.Close),customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.Close),onClick:Y,styles:j()}),a.createElement(I.a,{id:"toggleCardStateButtonId","data-testid":"toggleCardStateButtonId",iconProps:{iconName:C===z.expanded?s.a.CommonControlChevronDown_16:s.a.CommonControlChevronUp_16},ariaLabel:C===z.expanded?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaArgumentAssistanceCollapse):ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaArgumentAssistanceExpand),customTooltip:C===z.expanded?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaArgumentAssistanceCollapse):ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaArgumentAssistanceExpand),onClick:function(e){C===z.expanded?y(z.collapsed):C===z.collapsed&&y(z.expanded),C!==z.singleLine?null==g||g(C===z.expanded):Q()},styles:F()})),!Z&&a.createElement(I.a,{id:"toggleCardStateButtonId","data-testid":"toggleCardStateButtonId",iconProps:{iconName:s.a.CommonControlChevronDown_16},ariaLabel:q,customTooltip:q,onClick:function(e){var t=C!==z.expanded;C===z.expanded?y(z.collapsed):y(z.expanded),null==g||g(t)},styles:F()})),a.createElement("div",{ref:R,className:Z?J.collapseHeader:null},m())))),Z&&C===z.singleLine&&a.createElement("div",Object(o.__assign)({ref:w,onPointerDown:X},Object(S.isChangeGateEnabled)("OfficeVSO:9010567_MinifiedIconHighContrastMode")?{className:J.singleLineCard}:{style:{backgroundColor:"green"}}),a.createElement(I.a,{id:"toggleCardStateMinifiedButtonId","data-testid":"toggleCardStateMinifiedButtonId",iconProps:{iconName:s.a.FormulaBar_16},ariaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaArgumentAssistanceExpand),customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaArgumentAssistanceExpand),onClick:Y,styles:T()})),a.createElement("div",{className:J.expandedCard,ref:O,onPointerDown:X},a.createElement("div",{className:J.expandedCardPart,ref:A},p(C===z.expanded)))))})),Y=n(2072),X=n(343),q=n(1108),$={root:h},ee=Object(u.c)((function(e){return{display:"block",content:"attr(".concat(e,")"),fontSize:d.k.size12,fontWeight:d.l.semibold,height:0,overflow:"hidden",visibility:"hidden"}})),te={label:{root:{fontSize:d.k.size12,fontWeight:d.l.semibold,lineHeight:d.k.size16,paddingBottom:4,paddingTop:0}},formula:{root:{color:m.a.gray180,fontSize:d.k.size12,fontWeight:d.l.semibold,lineHeight:d.k.size16,selectors:(V={},V[d.m]={color:"WindowText"},V)}},text:{root:{color:m.a.gray180,fontSize:d.k.size12,lineHeight:d.k.size16,selectors:(U={},U[d.m]={color:"WindowText"},U)}},param:{root:{color:Object(g.a)().shade20,fontSize:d.k.size12,fontWeight:d.l.semibold,lineHeight:d.k.size16,selectors:(J={},J[d.m]={color:"Highlight"},J)}},parametersContainer:{display:"grid",gridTemplateColumns:"auto 1fr",gridGap:1,color:m.a.gray180,fontSize:d.k.size12,lineHeight:d.k.size16},expandedCardPart:{root:{paddingTop:4}}},ne=Object(u.c)((function(e){var t,n;return e?Object(d.db)({root:{selectors:(n={},n[d.m]={border:"2px solid Highlight"},n)}}):Object(d.db)({root:{cursor:"pointer",opacity:.5,selectors:(t={},t[d.m]={opacity:1},t)}})})),oe=Object(u.c)((function(e){var t={":after":ee("formula-text")};return e?Object(d.db)({root:t}):Object(d.db)({root:Object(o.__assign)(Object(o.__assign)({},t),{textAlign:"unset",borderBottom:"0px","&:active, &:hover, &:active:hover, &:focus":{color:m.a.gray180}})})})),ae={root:{direction:"ltr"}},re=Object(u.c)((function(e){var t;return Object(d.db)({param:Object(o.__assign)({backgroundColor:ie(e),padding:"2px 5px 4px 5px",transition:"background-color 150ms linear",cursor:"default"},e?p.n:{}),paramName:{fontWeight:e?d.l.semibold:d.l.regular,":after":ee("param-name")}},{param:{selectors:(t={},t[d.m]={transition:"none",border:"1px solid WindowText"},t)}})})),ie=function(e){return e?"rgb(202, 234, 216, 0.6)":"rgb(245, 245, 245)"},le=function(e){var t=e.description;return a.createElement(r.a,null,a.createElement(X.a,{styles:te.label},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaArgumentAssistanceDescription)),a.createElement(q.a,{styles:te.text},t))},ce=function(e){var t=e.functionName,n=e.params,o=e.selected,r=e.functionNameStyle,i=e.textStyle,l=e.selectedStyle,c=e.listSeparator,s=e.styles,u=e.onClick;return a.createElement(q.a,{styles:Object(d.db)(ae,i,s),onClick:u},a.createElement(q.a,{styles:r},t),a.createElement(a.Fragment,null,"(",n.length>0&&n.map((function(e,t){var n=t===o?l:i;return a.createElement(a.Fragment,{key:t},a.createElement(q.a,{styles:n},e))})).reduce((function(e,t){return[e,"".concat(c," "),t]})),")"))},se=function(e){var t=e.functionName,n=e.parameters,o=e.listSeparator,i=e.description;return n?a.createElement(r.a,null,a.createElement(X.a,{styles:te.label},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaArgumentAssistanceExample)),a.createElement(ce,{functionName:"=".concat(t),params:n.params,selected:n.activeParam,functionNameStyle:te.text,textStyle:te.text,selectedStyle:te.param,listSeparator:o}),i&&a.createElement(q.a,{styles:te.text},i)):null},ue=function(e){var t=e.parameters,n=e.descriptions;return a.createElement(a.Fragment,null,t.params&&t.params.length>0&&a.createElement("div",{style:te.parametersContainer},t.params.map((function(e,o){var r=o===t.activeParam,i=re(r);return a.createElement(a.Fragment,{key:o},a.createElement("div",{className:[i.param,i.paramName].join(" "),"param-name":e},e),a.createElement("div",{className:i.param},n[o]))}))))},de=n(1275),me=function(e){var t=e.functionName,n=e.signatures,o=e.activeSignature,i=e.listSeparator,l=e.onFormulaClick;return a.createElement(r.a,{"data-testid":"functionSignatureId"},n.map((function(e,n){var r=n===o,c=e.signatureParams.params,s="".concat(t,"(").concat(c.join("".concat(i," ")),")");return r?a.createElement("div",{className:oe(r).root,"formula-text":s,id:"aa_function_".concat(n),key:n},a.createElement(ce,{functionName:t,params:c,selected:e.signatureParams.activeParam,functionNameStyle:te.formula,textStyle:te.text,selectedStyle:te.param,listSeparator:i,styles:ne(r)})):a.createElement(de.a,{styles:oe(r),key:n,onClick:l(n),"formula-text":s,id:"aa_function_".concat(n),"data-testid":"functionLinkSignatureId"},a.createElement(ce,{functionName:t,params:c,selected:e.signatureParams.activeParam,functionNameStyle:te.formula,textStyle:te.text,selectedStyle:te.param,listSeparator:i,styles:ne(r)}))})))},pe=function(e){var t=e.disabled,n=e.onClick,r=Object(o.__rest)(e,["disabled","onClick"]);return a.createElement(de.a,{"data-testid":"feedbackId",disabled:t,styles:Object(d.db)(x,r.styles),onClick:n},ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaAuthoringGiveFeedback))},ge=a.createContext({isFeedbackAllowed:!1}),fe=function(e){var t=e.functionName,n=e.isExpanded,o=e.onHelpClick,i=e.onFeedback,l=a.useContext(ge).isFeedbackAllowed;return a.createElement(r.a,{horizontal:!0,horizontalAlign:"space-between"},a.createElement(de.a,{"data-testid":"learnMoreLinkId",disabled:!n,styles:x,onClick:o},"".concat(ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaArgumentAssistanceLearnMore)," ").concat(t)),l&&a.createElement(pe,{disabled:!n,onClick:i}))},be=a.forwardRef((function(e,t){var n=e.setComponentApi,o=e.onLayoutChange,l=e.getTargetAndBounds,c=e.functionRenderingInfo,s=e.callbacks,u=e.isExpanded,d=e.hidden,m=c,p=m.functionName,g=m.functionDescription,f=m.signatures,b=m.activeSignature,h=m.listSeparator,v=a.useState(null!=b?b:0),x=v[0],E=v[1],C=f[x],y=function(e){return function(t){E(e)}},S=function(e){var t;null===(t=null==s?void 0:s.onHelpLink)||void 0===t||t.call(s)},_=function(e){var t;null===(t=null==s?void 0:s.onFeedback)||void 0===t||t.call(s,c)};return a.createElement(Y.a,null,a.createElement(Q,{getTargetAndBounds:l,setComponentApi:n,onLayoutChange:o,renderCompactCard:function(){return a.createElement(me,{functionName:p,signatures:f,activeSignature:x,listSeparator:h,onFormulaClick:y})},renderExpandedCard:function(e){return a.createElement(r.a,{styles:te.expandedCardPart,tokens:{childrenGap:12}},a.createElement(le,{description:g}),a.createElement(se,{functionName:p,parameters:C.exampleParams,listSeparator:h,description:C.exampleDescription}),a.createElement(ue,{parameters:C.descriptionParams,descriptions:C.descriptions}),a.createElement(fe,{functionName:p,isExpanded:e,onHelpClick:S,onFeedback:_}))},isExpanded:u,onIsExpandedChange:null==s?void 0:s.onIsExpandedChange,onDismiss:function(e){var t,n;(null===(t=null==e?void 0:e.nativeEvent)||void 0===t?void 0:t.keyCode)===i.a.escape&&(null===(n=null==s?void 0:s.onDismissClick)||void 0===n||n.call(s))},ref:t,key:u.toString(),styles:$,hidden:d,id:"aa-callout",collapsedId:"aa-header",layerProps:{eventBubblingEnabled:!0}}))})),he=n(744),ve=Object(o.__assign)(Object(o.__assign)({},y),{cursor:"default"}),xe=Object(u.c)((function(){return Object(d.db)(v,$)})),Ee=a.forwardRef((function(e,t){var n=e.setComponentApi,o=e.onLayoutChange,r=e.getTargetAndBounds,i=e.functionRenderingInfo,l=e.hidden,c=i,s=c.functionName,u=c.listSeparator,d=c.parameters,m=H("aa-callout"),p=xe(),g=a.useCallback((function(){if(!l&&m){var e=r(),t=e.target,n=e.bounds,a=e.isFloating,i=e.renderDown,c=m.clientHeight,s=m.clientWidth,u=B(t,c,a?c:Math.max(c,300),s,a,i,n);o(u);for(var d=W(u),p=0,g=Object.entries(d);p<g.length;p++){var f=g[p],b=f[0],h=f[1];m.style.setProperty(b,h)}}}),[r,l,o,m]);return a.useEffect((function(){n({updatePosition:g})}),[n,g]),a.useEffect((function(){m&&g()})),a.createElement(he.a,{isBeakVisible:!1,styles:p,hidden:l,id:"aa-callout"},a.createElement("div",{ref:t,id:"aa-header",style:ve},a.createElement(ce,{functionName:s,params:d.params,selected:d.activeParam,functionNameStyle:te.formula,textStyle:te.text,selectedStyle:te.param,listSeparator:u,styles:ne(!0)})))})),Ce=a.forwardRef((function(e,t){switch(e.kind){case"Full":return a.createElement(be,Object(o.__assign)({},e,{ref:t}));case"Minimal":return a.createElement(Ee,Object(o.__assign)({},e,{ref:t}))}})),ye=n(507),Se=n(701),_e=n(315),Re=n(1171),Oe=n(789),Pe=n(894),ke=n(1337),Ae=n(22),we=n(208),Fe=_.b.getInstance().getTheme(),je=Object(d.X)(0,d.t),Te={height:"100%",display:"flex",flexDirection:"column",width:"inherit"},Ie={display:"flex",minHeight:"0px",flexDirection:"column"},Me={root:h},Ne="svg > path.OfficeIconColors_HighContrast:not([class*='OfficeIconColors_m'])",De=Object(u.c)((function(){var e,t;return Object(d.eb)({"&:hover":(e={},e[d.m]=(t={},t[Ne]={fill:"HighlightText"},t),e),"&:focus":{outline:"-webkit-focus-ring-color auto 1px"}})})),He=Object(u.c)((function(e,t){var n,a,r=Ge(),i=Ke();return Object(d.db)(Object(ke.b)(Fe),{linkContent:Object(o.__assign)({color:i?Ae.a.colorNeutralForeground1:m.a.gray180,minHeight:28,padding:r?void 0:"0px ".concat(12,"px 0px ").concat(12,"px"),cursor:"pointer",userSelect:"none",backgroundColor:e?i?Ae.a.colorNeutralBackground1Hover:"#F5F5F5":"",borderRadius:r?4:void 0,"&:hover":Object(o.__assign)({backgroundColor:i?Ae.a.colorNeutralBackground1Selected:"#F0F0F0"},p.n)},e?p.n:{}),icon:{alignSelf:"center",width:16,height:16,margin:r?"0px ".concat(4,"px 0px ").concat(8,"px"):"0px ".concat(4,"px"),selectors:(n={},n[je]={fontSize:"",width:""},n[d.m]={selectors:(a={},a[Ne]={fill:e?"HighlightText":""},a)},n)},label:{font:"12px Segoe UI",lineHeight:d.k.size16,flexGrow:"",overflow:t?"hidden":"",textOverflow:t?"elipsis":"",alignSelf:"center",margin:"0px 0px 0px ".concat(r?4:6,"px"),display:t?"-webkit-box":void 0,whiteSpace:t?"normal":void 0,wordBreak:t?"break-all":void 0,WebkitLineClamp:t?"1":void 0,WebkitBoxOrient:t?"vertical":void 0},secondaryText:Object(o.__assign)({color:i?Ae.a.colorNeutralForeground2:m.a.gray130,fontSize:d.k.size10,lineHeight:d.k.size12,textAlign:"left",whiteSpace:"normal",padding:"2px 0px 2px 8px",alignSelf:"center",overflow:t?"hidden":void 0,overflowWrap:t?"break-word":void 0},ze(e))})})),Le=Object(u.c)((function(e,t,n,a,r){var i,l,c,s=Ge(),u=t?s?11:9:0,m=s?242+u:228+u,p=s?m-(2+30*n+u):m-(4+28*n+u);return Object(d.db)(C,{root:{width:e?void 0:340,minWidth:e?240:void 0,maxWidth:e?340:void 0,paddingTop:s?2:4,borderRadius:s?4:void 0},subComponentStyles:{menuItem:{item:{selectors:(i={},i[" [role='menuitem']"]={margin:s?"".concat(2,"px ").concat(4,"px 0px ").concat(4,"px"):void 0},i)},divider:{height:1,margin:s?"".concat(6,"px ").concat(16,"px ").concat(4,"px ").concat(16,"px"):4,borderRadius:s?"0.5px":void 0,selectors:(l={},l[d.m]={backgroundColor:"WindowText"},l)}}},simpleSection:Object(o.__assign)(Object(o.__assign)({maxHeight:p,overflowY:"auto",overflowX:r?"hidden":void 0},E),{selectors:Object(o.__assign)((c={},c[" [role='menuitem']"]={marginRight:s&&p<30*a?"0px !important":void 0},c),E.selectors)})})})),We=Object(u.c)((function(){var e=Ge();return{footer:{root:{padding:e?"".concat(2,"px ").concat(4,"px ").concat(4,"px ").concat(4,"px"):"".concat(4,"px ").concat(12,"px 8px ").concat(12,"px")}},feedback:{root:{float:"right",fontSize:d.k.size10,lineHeight:d.k.size14,margin:e?"".concat(2,"px 12px ").concat(2,"px 0px"):void 0}}}})),Be=function(e){switch(e.kind){case we.CompletionItemKind.Function:return e.type===we.SuggestionKind.Simple?s.a.FormulaBar_16:s.a.Intelligence_16;case we.CompletionItemKind.Enum:return s.a.NameManager_16;case we.CompletionItemKind.RichEntity:return s.a.Tag_16;case we.CompletionItemKind.LetVariable:return s.a.FormulaLet_16;case we.CompletionItemKind.NamedRange:return s.a.NameRange_16;case we.CompletionItemKind.Table:return s.a.Table_16;case we.CompletionItemKind.TableHeader:return s.a.SelectColumn_16;case we.CompletionItemKind.RichEntityEmptyCellRef:return s.a.AbsoluteReference_16;case we.CompletionItemKind.Lambda:return s.a.FormulaBar_16;case we.CompletionItemKind.NamedOther:return s.a.Tag_16;default:return""}},ze=function(e){var t;return{selectors:(t={},t[d.m]={color:e?"HighlightText":"WindowText"},t)}},Ge=Object(u.c)((function(){return Object(S.isChangeGateEnabled)("OfficeVSO:7982656_isFluentvNextChangesEnabled")})),Ke=Object(u.c)((function(){return Object(S.isChangeGateEnabled)("OfficeVSO:8137695_isFluentvNextColorChangesEnabled")})),Ve=function(e){var t=e.onFeedback,n=a.useContext(ge).isFeedbackAllowed;return a.createElement(r.a,{styles:We().footer,tokens:{childrenGap:8}},n&&a.createElement("div",null,a.createElement(pe,{styles:We().feedback,disabled:!1,onClick:t})))},Ue=n(1127);function Je(e,t,n,o){if(!t)return 0;var a=Ze(t,o);if(!e)return Math.min(a,n);var r=Ze(e,o);if(a+r>=n){M.a.sendTraceTag(508303310,N.a.msoulscat_ES_EWAJS,D.a.Info,"sharedUtils.atLeastThirdOfAvailableWidth: The needed width is bigger than the available limit,\n      targetWidth: ".concat(a,", additionalTextWidth:  ").concat(r,"."));var i=n/3;if(a>i){a=i;var l=2*i-r;l>0&&(a+=l)}}return a}var Ze=function(e,t){void 0===t&&(t="12px Segoe UI");var n=document.createElement("canvas").getContext("2d");return n.font=t,n.measureText(e).width};function Qe(e){return null!=e}function Ye(e){return null==e}var Xe,qe,$e=a.forwardRef((function(e,t){var n,r=e.setComponentApi,l=e.onLayoutChange,c=e.getTargetAndBounds,s=e.completionItems,u=e.callbacks,p=e.activeItemIndex,g=e.hidden,f=e.disableItemReadout,b=a.useRef(null);a.useLayoutEffect((function(){b.current&&b.current.scrollIntoView({block:"nearest"})}));var h=a.useMemo((function(){return Object(Pe.a)(s)}),[s]),v=a.useMemo((function(){return h.reduce((function(e,t){return e[t.type]=!0,e}),{})}),[h]),x=v[we.SuggestionKind.Smart],E=x&&!v[we.SuggestionKind.Simple],C=x&&v[we.SuggestionKind.Simple],y=Le(E,C,h.filter((function(e){return e.type===we.SuggestionKind.Smart})).length,h.filter((function(e){return e.type===we.SuggestionKind.Simple})).length,ot()),S=function(e){return function(t){var n;e!==p&&(null===(n=null==u?void 0:u.onCompletionItemSelected)||void 0===n||n.call(u,h[e],e)),t.target.offsetHeight<t.target.scrollHeight&&t.target.setAttribute("title",h[e].label)}},_=function(e){return function(t){var n;t.preventDefault(),null===(n=null==u?void 0:u.onCompletionItemCommitted)||void 0===n||n.call(u,h[e])}},R=function(e){return function(t){var n;t.nativeEvent.keyCode===i.a.enter&&(t.preventDefault(),null===(n=null==u?void 0:u.onCompletionItemCommitted)||void 0===n||n.call(u,h[e]))}},O=function(e){return function(t){var n,o;e!==p&&(t.stopPropagation(),null===(n=null==u?void 0:u.onCompletionItemSelected)||void 0===n||n.call(u,h[e],e),null===(o=t.currentTarget)||void 0===o||o.focus())}},P=a.useCallback((function(e,n){var r=Object(o.__assign)(Object(o.__assign)({},e),{items:null==e?void 0:e.items.filter((function(e){return"smart-section"===e.key}))}),i=Object(o.__assign)(Object(o.__assign)({},e),{items:null==e?void 0:e.items.filter((function(e){return"simple-section"===e.key}))}),l={style:Te},c={style:Ie};return a.createElement(Ue.a,null,a.createElement("div",Object(o.__assign)({},l,{ref:t}),a.createElement(Se.a,Object(o.__assign)({disabled:g},c),n(r),a.createElement("div",{className:y.simpleSection},n(i))),a.createElement(Ve,{onFeedback:function(e){var t;null===(t=null==u?void 0:u.onFeedback)||void 0===t||t.call(u)}})))}),[u,y.simpleSection,t,g]),k=a.useCallback((function(e,t){return function(n,o){var r,i=tt(n.item.text,t),l=nt(e,n.item.text,t);return a.createElement(a.Fragment,null,o.renderItemIcon(n),a.createElement("span",{id:e?"ac_selected_function":void 0,className:n.classNames.label,style:ot()?(r=l,{width:r,minWidth:r}):void 0},n.item.text),t&&A(t,i),e&&o.renderSecondaryText(n))}}),[]),A=function(e,t){return a.createElement(a.Fragment,null,a.createElement("span",{style:{margin:Ge()?"2px ".concat(4,"px"):"2px 0px 2px ".concat(4,"px"),width:8,color:Ke()?Ae.a.colorNeutralForeground2:m.a.gray130,fontSize:d.k.size12}},"="),a.createElement("span",{style:(n=t,{display:"-webkit-box",whiteSpace:"normal",wordBreak:"break-all",width:n,minWidth:n,margin:Ge()?"2px ".concat(4,"px 2px 0px"):"2px 0px 2px ".concat(4,"px"),color:Ke()?Ae.a.colorNeutralForeground2:m.a.gray130,WebkitLineClamp:1,WebkitBoxOrient:"vertical",textOverflow:"elipsis",overflow:"hidden",font:"12px Segoe UI"})},e));var n},w=h.map((function(e,t){var n,o;return{key:e.label+e.kind,text:e.label,secondaryText:e.detail,iconProps:{iconName:Be(e)},onRender:(o=t,function(e,t){var n=o===p,r=h[o].type===we.SuggestionKind.Smart,i=n&&!E;return a.createElement("div",{role:"menuitem",className:De(),"data-testid":"menuItemId".concat(o),onMouseMove:S(o),onMouseDown:_(o),onKeyDown:R(o),onFocus:O(o),ref:n?b:void 0,"data-is-focusable":!0,tabIndex:n?0:-1,"aria-label":f?" ":void 0},a.createElement(ye.a,{classNames:He(i,!!ot()||r),hasIcons:!0,index:o,item:e}))}),onRenderContent:k(e.type===we.SuggestionKind.Simple&&t===p||rt()&&e.kind===we.CompletionItemKind.Enum,null!==(n=e.evaluation)&&void 0!==n?n:void 0),data:e.type}})),F={key:"smart-section",itemType:_e.a.Section,sectionProps:{items:w.filter((function(e){return e.data===we.SuggestionKind.Smart})),bottomDivider:C}},j={key:"simple-section",itemType:_e.a.Section,sectionProps:{items:w.filter((function(e){return e.data===we.SuggestionKind.Simple})),bottomDivider:!1}},T=null!==(n=null==u?void 0:u.onRestoreFocus)&&void 0!==n?n:void 0,I=[F,j],M=H("ac-callout"),N=a.useCallback((function(){if(!g&&M){var e=c(),t=e.target,n=e.bounds,o=e.isFloating,a=e.renderDown,r=M.clientHeight,i=M.clientWidth,s=B(t,r,o||E?r:Math.max(r,300),i,o,a||E,n);l(s);for(var u=W(s),d=0,m=Object.entries(u);d<m.length;d++){var p=m[d],f=p[0],b=p[1];M.style.setProperty(f,b)}}}),[c,g,l,E,M]);return a.useEffect((function(){r({updatePosition:N})}),[r,N]),a.useEffect((function(){M&&N()})),a.createElement(Re.a,{items:I,styles:y,onRenderMenuList:P,isBeakVisible:!1,shouldFocusOnMount:!1,hidden:g,calloutProps:{id:"ac-callout",styles:Me,layerProps:{eventBubblingEnabled:!0}},focusZoneAs:et,focusZoneProps:{disabled:g},onDismiss:function(e){var t,n;(null===(t=null==e?void 0:e.nativeEvent)||void 0===t?void 0:t.keyCode)===i.a.escape&&(null===(n=null==u?void 0:u.onDismiss)||void 0===n||n.call(u))},onRestoreFocus:T})})),et=function(e){return a.createElement(Oe.a,{disableFirstFocus:!0,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,className:e.className},e.children)},tt=function(e,t){if(void 0!==e&&void 0!==t)return Je(e,t,at()?280:270)},nt=function(e,t,n){if(void 0!==t&&void 0===n){var o=at()?300:286;if(!e)return o;var a=Ze(t);return a<=2/3*o?a:2/3*o}},ot=Object(u.c)((function(){return Object(S.isChangeGateEnabled)("OfficeVSO:7921247_fixAutoCompleteOverFlowBug")})),at=Object(u.c)((function(){return Object(S.isChangeGateEnabled)("OfficeVSO:7982656_isFluentvNextChangesEnabled")})),rt=Object(u.c)((function(){return Object(S.isChangeGateEnabled)("OfficeVSO:8593118_AutoCompleteEnumDescriptions")})),it=n(2540),lt=n(92),ct=_.b.getInstance().getTheme(),st=ct.palette,ut={root:{margin:"0 8px",padding:0,height:5,":before":{backgroundColor:st.neutralQuaternaryAlt}}},dt=Object(u.c)((function(){var e;return Object(d.eb)({"&:hover":(e={},e[d.m]={},e),"&:focus":{outline:"-webkit-focus-ring-color auto 1px"}})})),mt=Object(u.c)((function(){return Object(d.db)(Object(ke.b)(ct),{linkContent:{color:st.neutralDark,minHeight:24,cursor:"pointer",userSelect:"none","&:hover":Object(o.__assign)({},p.n)}})})),pt=Object(u.c)((function(e){return Object(d.eb)({justifyContent:"space-between",display:"flex",width:"100%",padding:"2px 5px",margin:"0px 4px",borderRadius:4,backgroundColor:e?st.neutralLighterAlt:st.white,"&:hover":{backgroundColor:st.neutralLighter}})})),gt=Object(u.c)((function(){return Object(d.db)(C,{root:{maxWidth:340,minWidth:240},list:Object(o.__assign)({maxHeight:72,overflowY:"auto"},E)})})),ft={root:{root:{padding:"8px ".concat(12,"px 3px ").concat(12,"px")}},title:{root:{fontSize:d.k.size12,fontWeight:d.l.semibold,lineHeight:d.k.size12,color:st.neutralDark,padding:0}},description:{root:{color:st.neutralSecondary,fontSize:d.k.size12,lineHeight:d.k.size16,fontWeight:d.l.regular,selectors:(Xe={},Xe[d.m]={color:"WindowText"},Xe)}}},bt={root:{padding:"0px ".concat(12,"px 5px ").concat(12,"px")}},ht=Object(u.c)((function(){return Object(d.eb)({fontSize:d.k.size12,borderBottom:"1px solid transparent",padding:"0px 3px",height:"24px",":hover":{backgroundColor:st.neutralLighterAlt,color:st.black,border:"1px solid "+st.neutralLighter}})})),vt={root:{width:12,marginLeft:0}},xt={root:{backgroundColor:"rgb(210, 224, 244)",borderRadius:"2px"}},Et={root:{font:"12px consolas"}},Ct={lineHeight:d.k.size16,flexGrow:"",alignSelf:"center",padding:"".concat(2,"px 0px"),margin:"0px 0px 0px 0px",overflow:"hidden",textOverflow:"ellipsis","-webkit-line-clamp":"2","-webkit-box-orient":"vertical",display:"-webkit-box","white-space":"normal","word-break":"break-all",flex:1},yt=Object(u.c)((function(e){return e===we.RepairItemPartType.None?Et:Object(d.db)(Et,xt)})),St={padding:"0px",paddingLeft:"".concat(5,"px"),overflow:"hidden",textOverflow:"ellipsis",font:"12px consolas",alignSelf:"center"},_t=n(644),Rt=function(e){var t=e.onIgnore,n=e.onFeedback,o=e.onApply,i=a.useContext(ge).isFeedbackAllowed;return a.createElement(r.a,{styles:bt,horizontal:!0,horizontalAlign:"space-between"},a.createElement(r.a,{horizontal:!0,horizontalAlign:"start"},Qe(o)&&a.createElement(_t.a,{className:ht(),text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.Apply),onClick:o,iconProps:{iconName:s.a.Checkmark_16,styles:vt}}),a.createElement(_t.a,{className:ht(),text:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaAuthoringIgnore),onClick:t,iconProps:{iconName:s.a.DeleteHover_16,styles:vt}})),i&&a.createElement(pe,{disabled:!1,onClick:n}))},Ot=function(e,t){return a.createElement(r.a,{styles:ft.root,tokens:{childrenGap:2}},a.createElement(q.a,{styles:ft.title},e),a.createElement(q.a,{styles:ft.description},t))},Pt=function(e){var t=e.title,n=e.description,o=e.repairs,a=null!=t?t:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaRepairDefaultTitle),r=null!=n?n:1===o?ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaRepairDefaultDescriptionSingle):ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaRepairDefaultDescriptionMultiple).replace("{0}",o.toString());return Ot(a,r)},kt=function(e){var t=e.item,n=e.repairParts,r=e.isChecked,i=Object(a.useMemo)((function(){return Je(t.text,t.secondaryText,311,"12px consolas")}),[t.text,t.secondaryText]),l=Object(o.__assign)(Object(o.__assign)({},St),{width:"".concat(i,"px")}),c=n.filter(Qe);return a.createElement("div",{className:pt(r)},a.createElement("div",{style:Ct},c.map((function(e){var n,o;return a.createElement(q.a,{key:e.location.start,styles:yt(e.type),style:{color:null!==(n=e.color)&&void 0!==n?n:void 0}},null===(o=t.text)||void 0===o?void 0:o.substring(e.location.start,e.location.end))}))),t.secondaryText&&a.createElement(q.a,{style:l},t.secondaryText))},At=function(e){var t=e.diagnostics,n=e.description,i=e.repairs,l=e.callbacks,c=Object(o.__rest)(e,["diagnostics","description","repairs","callbacks"]),s=gt(),u=a.useMemo((function(){return Object(Pe.a)(i)}),[i]),d=u.length>1,m=function(e,t){var n=Object(a.useState)(0),o=n[0],r=n[1],i=Object(a.useState)(),l=i[0],c=i[1],s=Object(a.useRef)([]).current,u=Object(a.useCallback)((function(n,o){var a,r;Ye(s[n])&&(s[n]=null==t?void 0:t(e[n])),null===(a=s[n])||void 0===a||a.highlightRanges(o),c(null===(r=s[n])||void 0===r?void 0:r.coloredParts)}),[t,s,e]);return Object(a.useEffect)((function(){return u(0,!0),function(){return u(0,!1)}}),[u]),[o,function(e){e!==o&&(u(o,!1),u(e,!0),r(e))},l]}(u,null==l?void 0:l.getItemHighlights),p=m[0],g=m[1],f=m[2],b=function(e){return function(t){var n,o;"Enter"===t.nativeEvent.key&&(t.preventDefault(),null===(n=null==l?void 0:l.onCommit)||void 0===n||n.call(l,e)),"Escape"===t.nativeEvent.key&&(t.preventDefault(),null===(o=null==l?void 0:l.onEscape)||void 0===o||o.call(l))}},h=function(e,t){return function(n,o){var r,i=function(){return g(t)};return a.createElement("div",{role:"menuitem",className:dt(),"data-is-focusable":!0,onPointerDown:(r=e,function(e){var t;e.preventDefault(),null===(t=null==l?void 0:l.onCommit)||void 0===t||t.call(l,r)}),onKeyDown:b(e),onMouseEnter:i,onFocus:i},a.createElement(ye.a,{classNames:mt(),hasIcons:!1,index:t,item:n}))}},x=function(e){return a.createElement(kt,Object(o.__assign)({},e,{isChecked:d&&p===e.index,repairParts:p===e.index&&Qe(f)?f:u[e.index].repairedFormulaParts}))},E=a.useCallback((function(){var e,t=u[d?p:0];t?null===(e=null==l?void 0:l.onCommit)||void 0===e||e.call(l,t):M.a.sendTraceTag(508179275,N.a.msoulscat_ES_EWAJS,D.a.Error,"FormulaRepairCard: onApply: repair is undefined")}),[l,u,p,d]),C=a.useCallback((function(e,i){var c=Object(o.__assign)(Object(o.__assign)({},e),{items:null==e?void 0:e.items});return a.createElement("div",{ref:null==l?void 0:l.onRender},a.createElement(r.a,{tokens:{childrenGap:4}},a.createElement(Pt,{title:t,description:n,repairs:u.length}),i(c),a.createElement(it.a,{styles:ut}),a.createElement(Rt,{onFeedback:function(e){var t;null===(t=null==l?void 0:l.onFeedback)||void 0===t||t.call(l)},onIgnore:function(e){var t;null===(t=null==l?void 0:l.onIgnore)||void 0===t||t.call(l)},onApply:E})))}),[n,t,u,l,E]),y=u.map((function(e,t){return{key:e.text,text:e.text,secondaryText:Ft(e.formulaValue)?void 0:" = ".concat(e.formulaValue),onRender:h(e,t),onRenderContent:x}}));return a.createElement(Re.a,{items:y,styles:s,onRenderMenuList:C,isBeakVisible:!1,shouldFocusOnMount:!0,calloutProps:{id:"formulaRepair-callout",styles:v,layerProps:{eventBubblingEnabled:!0},onPointerDown:function(e){e.preventDefault()}},gapSpace:4,onDismiss:function(){var e;null===(e=null==l?void 0:l.onDismiss)||void 0===e||e.call(l)},target:c.target,directionalHint:"below"===c.renderLocation?lt.a.bottomLeftEdge:lt.a.rightTopEdge,onRestoreFocus:wt})},wt=function(){},Ft=function(e){return null==e||0===e.length},jt=n(106),Tt=n(54),It=n(1401),Mt=n(1162),Nt=n(223),Dt=n(2560),Ht=n(397),Lt={root:{direction:"ltr"},subText:{overflow:"hidden",whiteSpace:"pre",textOverflow:"ellipsis",fontFamily:'Consolas, "Courier New", monospace'}},Wt=a.memo((function(e){var t,n=e.isLoaded,r=e.value,i=e.textColor,l=Object(o.__rest)(e,["isLoaded","value","textColor"]);return n?(t=r||void 0,Qe(i)&&(t=a.createElement("span",{style:{color:i}},t))):t=a.createElement(Dt.a,{type:"AppSpinnerProps",id:"ValuePreviewSpinner",appColors:Object(g.a)(),spinnerSize:Ht.a.small}),a.createElement(Nt.a,null,(function(e){return a.createElement(Mt.a,Object(o.__assign)({},l,{calloutProps:{styles:Object(It.a)(e),beakWidth:10},content:t,styles:Lt,directionalHint:lt.a.topCenter}))}))})),Bt=function(){return Ot(ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaRepairDefaultTitle),ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaSyntaxErrorIndicationDescription))},zt=function(e){var t=Object(o.__rest)(e,[]);return a.createElement(l.a,{isBeakVisible:!1,id:"formulaRepair-callout",styles:v,layerProps:{eventBubblingEnabled:!0},onPointerDown:function(e){e.preventDefault()},onDismiss:function(){var e;null===(e=null==t?void 0:t.onDismiss)||void 0===e||e.call(t)},target:t.target,gapSpace:4,directionalHint:lt.a.rightTopEdge,focusTrapProps:{isClickableOutsideFocusTrap:!0,disableFirstFocus:!0,forceFocusInsideTrap:!1}},a.createElement("div",{ref:null==t?void 0:t.onRender},a.createElement(r.a,{tokens:{childrenGap:8}},a.createElement(Bt,null),a.createElement(Rt,{onFeedback:function(e){var n;null===(n=null==t?void 0:t.onFeedback)||void 0===n||n.call(t)},onIgnore:function(e){var n;null===(n=null==t?void 0:t.onIgnore)||void 0===n||n.call(t)}}))))},Gt=n(2547),Kt=_.b.getInstance().getTheme(),Vt=Object(u.c)((function(){return Object(d.eb)({backgroundColor:Kt.palette.white,border:"1px solid",borderColor:Kt.palette.neutralQuaternary,borderRadius:"2px",boxShadow:"0px 2px 2px rgba(0, 0, 0, 0.1)",height:"28px",width:"28px"})})),Ut={root:{width:"100%",height:"100%"}},Jt=function(e){var t=e.onClick,n=e.target;return a.createElement(Y.a,null,a.createElement(Gt.a,{target:n,directionalHint:lt.a.rightCenter,offsetFromTarget:5,className:Vt()},a.createElement(I.a,{onClick:t,id:"formula-repair-icon",customTooltip:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaRepairAvailable),ariaLabel:ExcelRibbonStringsManager.get(ExcelRibbonStringsEnum.FormulaRepairAvailable),tooltipDirection:lt.a.topCenter,iconProps:{iconName:s.a.SearchTools_16},styles:Ut})))};!function(e){e[e.ArgumentAssistanceCard=0]="ArgumentAssistanceCard",e[e.AutoCompleteMenu=1]="AutoCompleteMenu",e[e.ValuePreview=2]="ValuePreview"}(qe||(qe={}));var Zt=function(){function e(e){this.context={isFeedbackAllowed:!1},this.componentApis={},this.componentRefs={},this.lastGetTargetAndBounds=null,this.lastProps=new Map,this.position={x:0,y:0,renderDown:!0},this.useFixedPosition=!1,e&&(this.context=Object(o.__assign)(Object(o.__assign)({},this.context),e))}return e.prototype.onLayoutChange=function(e){var t=e.x,n=e.y,o=e.renderDown;this.position.x=t,this.position.y=n,this.position.renderDown=o},e.prototype.getTargetAndBounds=function(e){if(void 0===e&&(e=!1),this.useFixedPosition&&!e){var t=this.position,n=t.x,o=t.y,a=t.renderDown;return{target:{top:o,left:n,right:n,bottom:o},bounds:{top:0,left:0,right:innerWidth,bottom:innerHeight},isFloating:!0,renderDown:a}}Ye(this.lastGetTargetAndBounds)&&M.a.sendTraceTag(512313119,N.a.msoulscat_ES_EWAJS,D.a.Error,"FormulaAssistanceUIControl.getTargetAndBounds: "+"this.lastGetTargetAndBounds is ".concat(this.lastGetTargetAndBounds,"."));var r=this.lastGetTargetAndBounds();if(Ye(r)||Ye(r.target)||Ye(r.bounds)){var i=JSON.stringify(r);M.a.sendTraceTag(512313118,N.a.msoulscat_ES_EWAJS,D.a.Error,"FormulaAssistanceUIControl.getTargetAndBounds: "+"this.lastGetTargetAndBounds() returned: ".concat(i,"."))}return{target:r.target,bounds:r.bounds,isFloating:!1,renderDown:this.position.renderDown,activeCellAndGridZoom:r.activeCellAndGridZoom}},e.prototype.renderControl=function(e,t,n,r){var i=this;if(t&&n){this.lastGetTargetAndBounds=r,this.componentRefs[e]||(this.componentRefs[e]=a.createRef());var l,c={type:e,rendered:!0,ref:this.componentRefs[e],getTargetAndBounds:this.getTargetAndBounds.bind(this),onLayoutChange:this.onLayoutChange.bind(this),setComponentApi:function(t){i.componentApis[e]=t}};switch(e){case qe.ArgumentAssistanceCard:var s=n;l=a.createElement(Ce,Object(o.__assign)({},c,s));break;case qe.AutoCompleteMenu:l=a.createElement($e,Object(o.__assign)({},c,n,{disableItemReadout:!0}))}M.a.shipAssertTag(520926812,N.a.msoulscat_ES_EWAJS,Qe(l),"FormulaAssistanceUIControl.renderControl: "+"control is ".concat(l," because the type '").concat(e,"' is unknown.")),Tt.render(a.createElement(ge.Provider,{value:this.context},l),t),this.lastProps.set(t,Object(o.__assign)(Object(o.__assign)({},c),n))}},e.prototype.renderArgumentAssistanceCard=function(e,t,n){this.renderControl(qe.ArgumentAssistanceCard,e,t,n)},e.prototype.renderAutoCompleteMenu=function(e,t,n){this.renderControl(qe.AutoCompleteMenu,e,t,n)},e.prototype.renderValuePreview=function(e,t,n){e&&t&&n&&Tt.render(a.createElement(Wt,Object(o.__assign)({},n,{targetElement:t})),e)},e.prototype.renderFormulaRepair=function(e,t,n){e&&t&&n&&Tt.render(a.createElement(ge.Provider,{value:this.context},a.createElement(At,Object(o.__assign)({},n,{target:t}))),e)},e.prototype.renderFormulaRepairIcon=function(e,t,n){e&&t&&n&&Tt.render(a.createElement(ge.Provider,{value:this.context},a.createElement(Jt,{onClick:n,target:t})),e)},e.prototype.renderSyntaxErrorIndication=function(e,t,n){e&&t&&n&&Tt.render(a.createElement(ge.Provider,{value:this.context},a.createElement(zt,Object(o.__assign)({},n,{target:t}))),e)},e.prototype.dismiss=function(e){if(e)if(this.lastProps.has(e)){var t=this.lastProps.get(e);if(t&&t.rendered){t.rendered=!1;var n=null;switch(t.type){case qe.AutoCompleteMenu:n=a.createElement($e,Object(o.__assign)({},t,{hidden:!0}));break;case qe.ArgumentAssistanceCard:n=a.createElement(Ce,Object(o.__assign)({},t,{hidden:!0}))}n&&Tt.render(a.createElement(ge.Provider,{value:this.context},n),e)}}else Tt.unmountComponentAtNode(e)},e.prototype.focus=function(e){var t=this.getRootElement(e);return this.focusElement(t)},e.prototype.focusElement=function(e){return!!e&&Object(jt.c)(e)},e.prototype.getRootElement=function(e){var t;return(null===(t=this.componentRefs[e])||void 0===t?void 0:t.current)||null},e.prototype.getCalloutElement=function(e){switch(e){case qe.ArgumentAssistanceCard:return document.getElementById("aa-callout");default:return null}},e.prototype.getDraggableElement=function(e){switch(e){case qe.ArgumentAssistanceCard:return document.getElementById("aa-header");default:return null}},e.prototype.updatePosition=function(e){var t;null===(t=this.componentApis[e])||void 0===t||t.updatePosition()},e.prototype.updateContext=function(e){this.context=Object(o.__assign)(Object(o.__assign)({},this.context),e)},e.prototype.getPosition=function(){return this.position},e.prototype.setFixedPosition=function(e){this.useFixedPosition=Qe(e),e&&(this.position.x=e.x,this.position.y=e.y,this.position.renderDown=e.renderDown)},e}(),Qt=n(662),Yt=new(function(){function e(){}return e.prototype.create=function(e){return Qt.a.registerUiSlice20Icons(),new Zt(e)},e}())},208:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(3);o.__exportStar(n(2001),t),o.__exportStar(n(2002),t),o.__exportStar(n(2003),t),o.__exportStar(n(2004),t),o.__exportStar(n(2005),t),o.__exportStar(n(2006),t),o.__exportStar(n(2007),t),o.__exportStar(n(2008),t),o.__exportStar(n(2009),t),o.__exportStar(n(2010),t),o.__exportStar(n(2011),t),o.__exportStar(n(2012),t),o.__exportStar(n(2013),t)}},[[2034,2,0,1]]]);
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/formulaAssistance.min.js.map/a80ed96495ebe19904b21095020c711f/formulaAssistance.min.js.map