var interactivity=(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[22],{1602:function(e,t,n){"use strict";n.d(t,"a",(function(){return bt}));var r=n(3),a=n(80),o=n(79),i=n(213),c=n(2167),s=["auxclick","click","contextmenu","dblclick","mousedown","mouseenter","mouseleave","mouseout","mouseover","mouseup","pointerover","pointerenter","pointerdown","pointerup","pointercancel","pointerout","pointerleave","gotpointercapture","lostpointercapture","touchstart","touchend","touchcancel","keydown","keypress","keyup","beforeinput","input","compositionstart","compositionupdate","compositionend","dragstart","dragend","dragenter","dragleave","dragover","drop"],u={events:["click","keypress","mousedown"],durationThresholdInMs:100},l={},d={};function p(e){void 0===e&&(e="EndOfState");var t=m(e);return JSON.parse(JSON.stringify(t))}function m(e){switch(e){case"Periodic":return d;case"EndOfState":return l;default:return a.a.sendTraceTag(508303315,o.a.msoulscat_Wac_BrowserGeneral,i.a.Error,"InteractivityTracker.getTrackedUserActionReportMap wrong report mode"),l}}function f(e,t,n){void 0===n&&(n=1),Ae()||g(e,t,"EndOfState",n),Ee()&&g(e,t,"Periodic",n)}function g(e,t,n,r){void 0===r&&(r=1);var a=v(e,n);"total"===t&&(a.total+=r),"slow"===t&&(a.slow+=r)}function v(e,t){void 0===t&&(t="EndOfState");var n=m(t),r=n[e.action];return r||(r={total:0,slow:0,actionBucket:e.actionBucket},n[e.action]=r),r}function T(){Ae()||(l={}),Ee()&&(d={})}var h=void 0,y={};function w(e){return y[e]}function S(e){var t=-1,n=Se();e.getEntries().forEach((function(e){var r=e.entryType;a.a.shipAssertTag(539829780,o.a.msoulscat_Wac_BrowserGeneral,"event"===r,"ResponsivenessTracker:handleObservedEvents - unexpected observed entry type: ".concat(r)),function(e,t){if(w(e.name)){var n=function(e){return Xe(Ye(e.name,e.startTime))}(e);if(!function(e,t,n){var r=t[0];return void 0!==r.state&&r.state!==n&&(Xe(Ye(e.name,e.startTime)),!0)}(e,n,t)){var r=e.startTime+e.duration;n.forEach((function(t){"undefined"!==t.action?(function(e,t,n){var r=ce(),c=r.deviceMemory,s=r.hardwareConcurrency,u=t.name,l="InteractivityTracker:logSlowEvent - EventTiming - state: ".concat(e.state,", userAction: ").concat(e.action,", eventName: ").concat(u,", ")+"eventStartToNextFrame: ".concat(t.duration.toFixed(2),", startTime: ").concat(t.startTime.toFixed(2),", ")+"processingStart: ".concat(t.processingStart.toFixed(2),", processingEnd: ").concat(t.processingEnd.toFixed(2),", ")+"renderTime: ".concat(n.toFixed(2),", ")+"".concat(le(),", ")+" deviceMemory: ".concat(c,", hardwareConcurrency: ").concat(s)+", actionBucket: ".concat(he(e),", context: ").concat(JSON.stringify(e.contexts));a.a.sendTraceTag(137704134,o.a.msoulscat_Wac_BrowserGeneral,i.a.Info,l);var d={};e.contexts.forEach((function(e){d[e.itemKey]=e.value}));var p={};p.state=e.state,p.userAction=e.action,p.eventName=u,p.eventStartToNextFrame=t.duration.toFixed(2),p.startTime=t.startTime.toFixed(2),p.processingStart=t.processingStart.toFixed(2),p.processingEnd=t.processingEnd.toFixed(2),p.renderTime=n.toFixed(2),p.appInfo=le(),p.deviceMemory=c,p.hardwareConcurrency=s,p.actionBucket=he(e),p.contexts=d;var m=JSON.stringify(p);a.a.sendTraceTag(137704576,o.a.msoulscat_Wac_BrowserGeneral,i.a.Info,m),ve("VSO:8185150")&&function(e){var t;null===(t=null==C?void 0:C.logSlowActionsHandler)||void 0===t||t.call(C,e)}(m)}(t,e,r),ze(e.startTime,t,r)):a.a.sendTraceTag(523621256,o.a.msoulscat_Wac_BrowserGeneral,i.a.Info,"ResponsivenessTracker:processEventTimingEntry - undefined slow action, probably due to duplicate slow actions")}))}}}(e,n),e.startTime>t&&(t=e.startTime)})),function(e){var t=0;for(var n in Be){var r=Ze(n);r&&r<e&&performance.now()-r>3e3&&(Xe(n),t+=1)}a.a.sendTraceTag(539829781,o.a.msoulscat_Wac_BrowserGeneral,i.a.Info,"InteractivityTracker:clearTrackedEventsToUserAction - cleared ".concat(t," tracked events}"))}(t)}var k=300,A=void 0,E=1e4,_=new Map;function O(e){for(var t=function(e){var t=e.identifier;if(!t)return Object({NODE_ENV:"production"}).DEBUG&&a.a.debugAssertTag(508065293,o.a.msoulscat_Wac_BrowserGeneral,!1,"asyncUiTracker.handleObservedEvents - missing identifier on entry"),"continue";var n=e.element,r=null==n?void 0:n.getAttribute("data-ui-mutation-time");if(!r)return"continue";var c=Re[t],s=null==n?void 0:n.getAttribute("data-ui-mutation-context-value"),u=null==n?void 0:n.getAttribute("data-ui-mutation-remove-element");if(ve("OfficeVSO:8650749_shouldRemoveElementFromDom")&&u&&(window.requestIdleCallback?window.requestIdleCallback((function(){return I(n)})):setTimeout((function(){return I(n)}),0)),!c||0===c.length)return a.a.sendTraceTag(508121942,o.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,"AsyncUiTracker:handleObservedEvents - missing pending entry, identifier = ".concat(t,", contextValue = ").concat(s)),"continue";var l=parseFloat(r),d=function(e,t,n,r,c){for(var s,u=void 0,l=0,d=r;l<d.length;l++){var p=d[l];if(!p.isReported&&!(e.renderTime-p.startTime>E)&&p.startTime<=n&&(!u||p.startTime>u.startTime)){if(u&&!u.isReportedAsDuplicate){u.isReportedAsDuplicate=!0;var m=((s={}).matchingUserActionStartTime=u.startTime,s.userActionStartTime=p.startTime,s.identifier=t,s.uiMutationTime=n,s.userActionContexts=p.contexts,s.contextValue=c,s);a.a.sendTraceTag(508072512,o.a.msoulscat_Wac_BrowserGeneral,i.a.Info,"AsyncUiTracker:handleObservedEvents - more than one matching pending entry: ".concat(JSON.stringify(m)))}u=p}}return u}(e,t,l,c,s);if(!d)return a.a.sendTraceTag(508121941,o.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,"AsyncUiTracker:handleObservedEvents - no matching pending entry, identifier = ".concat(t,", ")+"uiMutationTime = ".concat(l,", contextValue = ").concat(s," ")+"there are ".concat(c.length," pending entries.")),"continue";Boolean(s)&&(d.action=s),function(e,t,n){var r;if(!n.state||n.state===t){n.isReported=!0,function(e,t){var n,r={};e.contexts.forEach((function(e){r[e.itemKey]=e.value}));var c=ce(),s=c.deviceMemory,u=c.hardwareConcurrency,l=((n={}).userAction=e.action,n.startTime=e.startTime.toFixed(2),n.renderTime=t.renderTime.toFixed(2),n.appInfo=le(),n.deviceMemory=s,n.hardwareConcurrency=u,n.actionBucket=he(e),n.contexts=r,n.appState=e.state,n),d=JSON.stringify(l);a.a.sendTraceTag(137703444,o.a.msoulscat_Wac_BrowserGeneral,i.a.Important,d),ve("OfficeVSO:8645877_addAsyncActionsCustomHandler")&&(l.contexts=e.contexts,function(e){var t;null===(t=null==C?void 0:C.logAsyncActionHandler)||void 0===t||t.call(C,e)}(l))}(n,e),f(n,"total"),ne()&&Qe(n),performance.measure("Async UI Action: ".concat(n.action),{start:n.startTime,end:e.renderTime});var c=null!==(r=_.get(n.action))&&void 0!==r?r:k;e.renderTime-n.startTime>c&&ze(n.startTime,n,e.renderTime)}}(e,Se(),d)},n=0,r=e.getEntries();n<r.length;n++)t(r[n]);!function(e){for(var t=performance.now()-e,n=0,r=Object.keys(Re);n<r.length;n++){var c=r[n],s=Re[c];Re[c]=s.filter((function(e){return e.startTime>t&&!e.isReported}));var u=s.filter((function(e){return e.isReported})).length,l=s.length-u-Re[c].length;if(ne())for(var d=0,p=s;d<p.length;d++){var m=p[d];m.startTime<=t&&Qe(m)}0===Re[c].length&&delete Re[c],l>0&&a.a.sendTraceTag(508121939,o.a.msoulscat_Wac_BrowserGeneral,i.a.Info,"InteractivityTracker:clearOldAsyncActions - cleared ".concat(l," timed out tracked actions for ").concat(c))}}(E)}function I(e){var t;null===(t=e.parentElement)||void 0===t||t.removeChild(e)}var C,b=function(){function e(e){this.isLoafPerfImpactTestEnabled=e}return e.prototype.start=function(e){var t=this;return!!PerformanceObserver.supportedEntryTypes.includes("long-animation-frame")&&(this.onEntry=e,this.observer=new PerformanceObserver((function(e){if(!t.isLoafPerfImpactTestEnabled)for(var n=0,r=e.getEntries();n<r.length;n++){var a=r[n],o=a.renderStart,i=a.startTime,c=a.duration,s=a.styleAndLayoutStart;t.reportData(i,o?o-i:c,"preRenderTaskDuration"),t.reportData(o,s?s-o:0,"renderPreStyleAndLayoutDuration"),t.reportData(s,s?i+c-s:0,"renderStyleAndLayoutDuration"),t.reportScriptsData(a)}})),this.observer.observe({type:"long-animation-frame"}),!0)},e.prototype.stop=function(){var e;null===(e=this.observer)||void 0===e||e.disconnect()},e.prototype.reportScriptsData=function(e){var t=e.renderStart;if(t){for(var n=0,r=0,a=0,o=0,i=e.scripts;o<i.length;o++){var c=i[o];n+=c.duration,r+=c.executionStart-c.startTime,a+=c.forcedStyleAndLayoutDuration}this.reportData(t,n,"totalScriptsRunTime"),this.reportData(t,r,"totalScriptsCompileTime"),this.reportData(t,a,"forcedStyleAndLayoutDuration")}},e.prototype.reportData=function(e,t,n){t>0&&this.onEntry({startTime:e,duration:t,source:"long-animation-frame",data:n})},e}(),W=[],P=[],B=[],R=0,U=!1,M=!1,N=void 0;function x(e){if(W.push(e),U){var t=P.find((function(t){return D(t,e)}));t&&a.a.sendTraceTag(507312265,o.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,"Timeline entry is intersecting with an already reported slow action: timelineEntry: ".concat(JSON.stringify(e),", ").concat(JSON.stringify(t)))}}function D(e,t){return e.startTime<=t.startTime+t.duration&&e.endTime>=t.startTime}function G(){var e=performance.now()-12e4;W=W.filter((function(t){return t.startTime>=e})),P=P.filter((function(t){return t.startTime>=e})),M&&F(G,3e4)}function J(e){e&&F((function(){return function(e){var t=W.filter((function(t){return D(e,t)})).map((function(t){return n=t,r=e,{startTime:a=Math.max(n.startTime,r.startTime),duration:Math.min(n.startTime+n.duration,r.endTime)-a,source:n.source,data:n.data};var n,r,a}));U&&P.push(e);var n=function(e,t){var n,r,a,o,i;return JSON.stringify(((n={}).action=((r={}).startTime=e.startTime,r.endTime=e.endTime,r.actionName=(null===(a=e.actionProps)||void 0===a?void 0:a.name)||"",r.actionBucket=(null===(o=e.actionProps)||void 0===o?void 0:o.actionBucket)||"",r),n.appState=null===(i=e.actionProps)||void 0===i?void 0:i.appState,n.timelineEntries=t,n))}(e,t);a.a.sendTraceTag(137704651,o.a.msoulscat_Wac_BrowserGeneral,i.a.Info,n)}(e)}),R)}function F(e,t){"scheduler"in window?window.scheduler.postTask(e,{delay:t,priority:"background"}):setTimeout(e,t)}var L,V,q,j=void 0,H=void 0,z=void 0,K=void 0,Q=void 0,X=!1,Y=void 0,Z=void 0,$=void 0,ee=new Set,te=!1;function ne(){return te}function re(e){return ee.has(e)}function ae(e){ee.add(e)}var oe,ie=!1;function ce(){return Y=null!=Y?Y:navigator.deviceMemory||0,Z=null!=Z?Z:navigator.hardwareConcurrency||0,{deviceMemory:Y,hardwareConcurrency:Z}}function se(){return null!=j?j:void 0}function ue(){return null!=H?H:void 0}function le(){var e;return z||(e=H,z=JSON.stringify(e)),null!=z?z:void 0}function de(e){var t,n;if(void 0===e&&(e=u),C=null==e?void 0:e.callbacks,fe()&&(a.a.sendTraceTag(539829774,o.a.msoulscat_Wac_BrowserGeneral,i.a.Info,"InteractivityTracker:canStartObserver:false - repeated start attempt"),1))return a.a.sendTraceTag(539829765,o.a.msoulscat_Wac_BrowserGeneral,i.a.Info,"InteractivityTracker:startInteractivityTracker - cannot start interactivityTracker"),{started:!1,failureReason:"cannot start interactivityTracker"};X=!0;var r=function(e){if(!e.durationThresholdInMs||e.durationThresholdInMs<0)return a.a.shipAssertTag(539829770,o.a.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:validateOptions - unexpected options.durationThresholdInMs undefined or < 0"),u;if(null==e.events||0===e.events.length)return a.a.shipAssertTag(539829771,o.a.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:validateOptions - unexpected options.events missing or empty"),u;for(var t=0,n=e.events;t<n.length;t++){var r=n[t];if(r&&s.indexOf(r)<0)return a.a.shipAssertTag(539829772,o.a.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:validateOptions - invalid event in options.events ".concat(r)),u}if(e.callbacks&&"function"!=typeof e.callbacks.getAppState)return a.a.shipAssertTag(539829773,o.a.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:validateOptions - getAppState is not a function"),u;if(e.periodicReportIntervalMs&&e.periodicReportIntervalMs<0)return a.a.shipAssertTag(509195584,o.a.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:validateOptions - Invalid periodicReport.intervalMs"),u;if(e.animationTracking){if(!e.animationTracking.chunkDurationMs||!e.animationTracking.minFramesPerChunk)return a.a.shipAssertTag(508343188,o.a.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:validateOptions - Invalid animationTracking properties"),u;if(e.animationTracking.chunkDurationMs<100)return a.a.shipAssertTag(508343187,o.a.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:validateOptions - Invalid animationTracking.chunkDurationMs (less than 100)"),u;if(e.animationTracking.minFramesPerChunk<0)return a.a.shipAssertTag(508343186,o.a.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:validateOptions - Invalid animationTracking.minFramesPerChunk (less than 0)"),u}return e}(e);te=Boolean(r.allowAsyncUIContextReporting),L=r.periodicReportIntervalMs,V=r.animationTracking,ie=Boolean(r.asyncUiTracking),we(),j=Se(),H=ke(),Ee()&&Ie(),window.addEventListener("beforeunload",pe),window.addEventListener("visibilitychange",we),q={lastTrackedActionTime:0,lastTrackedAsyncUiTime:0,lastTrackedAnimationTime:0,isDuringAnimationTracking:!1};try{if(function(e){!function(e){var t;null===(t=e.events)||void 0===t||t.forEach((function(e){y[e]=!0}))}(e),(h=new PerformanceObserver(S)).observe({type:"event",buffered:!0,durationThreshold:e.durationThresholdInMs})}(r),Oe()){!function(e){var t,n,r,a,o,i;k=null!==(n=null===(t=e.asyncUiTracking)||void 0===t?void 0:t.slowUiEventThresholdMs)&&void 0!==n?n:k,E=null!==(a=null===(r=e.asyncUiTracking)||void 0===r?void 0:r.asyncUiEventTimeoutMs)&&void 0!==a?a:E,null===(i=null===(o=e.asyncUiTracking)||void 0===o?void 0:o.slowActionTimeoutOverrides)||void 0===i||i.forEach((function(e){(null==e?void 0:e.actionName)&&_.set(e.actionName,e.slowActionThreshold)})),(A=new PerformanceObserver(O)).observe({type:"element"})}(r);var l=[];ve("OfficeVSO:8880204_RemoveAllowedAsyncUiNamesList")||(l=null!==(n=null===(t=r.asyncUiTracking)||void 0===t?void 0:t.allowedAsyncUiNames)&&void 0!==n?n:[]).length>0&&(ee=new Set(l))}r.timeline&&function(e,t,n,r){M=!0,N={add:t,remove:n},R=e.reportDelayMs,U=e.runSlowActionsPassiveTestEnabled,t(c.a.EndTrackSlowAction,J),function(e,t){for(var n=0,r=e;n<r.length;n++){var c=r[n],s=void 0;switch(c.type){case"long-animation-frame":var u=t("Microsoft.Office.Excel.LoafPerfImpactTest",!1);s=new b(u);break;case"custom":s=c.customReporter;break;default:a.a.sendTraceTag(507312266,o.a.msoulscat_Wac_BrowserGeneral,i.a.Error,"Unknown timeline reporter type: ".concat(c.type));continue}s.start(x)&&B.push(s)}}(e.reporters,r),F(G,3e4)}(r.timeline,De,Ge,Te),a.a.sendTraceTag(539829775,o.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,"InteractivityTracker:startInteractivityTracker - started")}catch(e){return a.a.sendTraceTag(539829776,o.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,"InteractivityTracker:startInteractivityTracker - failed to start. Error: ".concat(e)),me(),{started:!1,failureReason:"Error: ".concat(e)}}return{started:!0}}function pe(){be(),T()}function me(){return fe()?(null==h||h.disconnect(),h=void 0,null==A||A.disconnect(),A=void 0,M&&(P=[],W=[],null==N||N.remove(c.a.EndTrackSlowAction,J),B.forEach((function(e){e.stop()})),M=!1),window.removeEventListener("beforeunload",pe),window.removeEventListener("visibilitychange",we),$e(),T(),X=!1,!0):(a.a.shipAssertTag(539829766,o.a.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:stopInteractivityTracker - attempt stop non-started"),!1)}function fe(){return X}function ge(){return!ye(null==C?void 0:C.getCurrentAppInfo)}function ve(e){if(null==C?void 0:C.isChangeGateEnabled)try{return null==C?void 0:C.isChangeGateEnabled(e)}catch(e){a.a.sendTraceTag(539829767,o.a.msoulscat_Wac_BrowserGeneral,i.a.Error,"InteractivityTracker:isChangeGateEnabled - failed to call isChangeGateEnabledCallback. Error: ".concat(e))}return!1}function Te(e,t){if(null==C?void 0:C.getBooleanFeatureGate)try{return null==C?void 0:C.getBooleanFeatureGate(e,t)}catch(e){a.a.sendTraceTag(525173323,o.a.msoulscat_Wac_BrowserGeneral,i.a.Error,"InteractivityTracker:getBooleanFeatureGate - failed to call getBooleanFeatureGateCallback. Error: ".concat(e))}return!1}function he(e){if(e.actionBucket)return e.actionBucket;var t=e.action;if(null==C?void 0:C.getActionBucket){var n=null==C?void 0:C.getActionBucket(t);return null!=n?n:"undefined"}return""}function ye(e){return null==e}function we(){ve("OfficeVSO:5610366_StopTrackingEventsWhenPageIsHidden")&&"hidden"===document.visibilityState&&$e()}function Se(){if(null==C?void 0:C.getAppState)try{return null==C?void 0:C.getAppState()}catch(e){a.a.sendTraceTag(539829768,o.a.msoulscat_Wac_BrowserGeneral,i.a.Error,"InteractivityTracker:getAppState - failed to call getAppStateCallback. Error: ".concat(e))}}function ke(){if(null==C?void 0:C.getCurrentAppInfo)try{return Object(r.__assign)({},null==C?void 0:C.getCurrentAppInfo())}catch(e){a.a.sendTraceTag(539829769,o.a.msoulscat_Wac_BrowserGeneral,i.a.Error,"InteractivityTracker:getCurrentAppInfo - failed to call getCurrentAppInfoCallback. Error: ".concat(e))}}function Ae(){return Boolean(L)}function Ee(){return!!L}function _e(){return!ye(V)}function Oe(){return ie&&(void 0===$&&(($=!("undefined"==typeof window||((null===(e=window.PerformanceObserver)||void 0===e?void 0:e.supportedEntryTypes)||[]).indexOf("element")<0)&&"elementTiming"in new Image)||a.a.sendTraceTag(508118157,o.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,"trackerState:isElementTimingSupported - element timing not supported")),$);var e}function Ie(){Q=window.setTimeout(Ce,L)}function Ce(){Q&&window.clearTimeout(Q),K&&window.cancelIdleCallback(K),K=window.requestIdleCallback((function(){We("Periodic"),d={},Ie()}))}function be(){Ae()||We("EndOfState"),Ee()&&We("Periodic")}function We(e){a.a.shipAssertTag(539829777,o.a.msoulscat_Wac_BrowserGeneral,fe(),"InteractivityTracker:validateTrackerStarted - non-started tracker: caller ".concat("logInteractivityReport"));var t=function(e){var t=[];for(var n in e){var r=e[n];r.action=n,r.actionBucket=he(r),t.push(r)}return t}(p(e));if("Periodic"!==e||0!==t.length){var n,r,c,s,u,l,d=(ge()?(r=null===(n=ue())||void 0===n?void 0:n.appState,ve("OfficeVSO:6215934_CoauthInteractivityRegressionDetection")&&(c="".concat(null==C?void 0:C.getAppInfoForReport()))):r=se(),"".concat(c," state: ").concat(r).trim());s=137704527,u=i.a.Warning,!1,l="InteractivityTracker:logInteractivityReport - ".concat(d," totals: ").concat(JSON.stringify(t)),(null==C?void 0:C.sendBeaconTraceTag)?null==C||C.sendBeaconTraceTag(s,u,!1,l):(a.a.sendTraceTag(539550627,o.a.msoulscat_Wac_BrowserGeneral,i.a.Info,"InteractivityTracker:sendBeaconTraceTag - interactivityTrackerCallbacks.sendBeaconTraceTag does not exist. Sending trace tag instead for tag: ".concat(s)),a.a.sendTraceTag(s,o.a.msoulscat_Wac_BrowserGeneral,u,l))}}function Pe(){return void 0===oe&&((oe=new Map([])).set(c.a.EndTrackSlowAction,"EndTrackSlowAction"),oe.set(c.a.StartTrackAction,"StartTrackAction")),oe}var Be={},Re={},Ue=new Map,Me=new Map,Ne=new Map,xe=void 0;function De(e,t){xe||(xe=new EventTarget);var n=Pe().get(e);n&&xe.addEventListener(n,(function(e){return t(e.detail)}))}function Ge(e,t){if(xe){var n=Pe().get(e);n&&xe.removeEventListener(n,(function(e){return t(e.detail)}))}else a.a.sendTraceTag(527522002,o.a.msoulscat_Wac_BrowserGeneral,i.a.Error,"InteractivityTracker.removeEventListener InteractivityTrackerEventTarget is null}")}function Je(e,t){return e+"_@@@_"+t}function Fe(e,t,n,a){if(!Ve(a,e))return[];q.lastTrackedAsyncUiTime=performance.now();for(var o=[],i=0,s=e;i<s.length;i++){var u=s[i];if(u){re(u)||ae(u);var l={action:"".concat(u,"-default"),state:t,contexts:n?Object(r.__spreadArray)([],n,!0):[],startTime:a.timeStamp,actionBucket:u};et(l,u,!0),o.push(l),Ke(c.a.StartTrackAction,l,t)}}return o}function Le(e,t,n,s){if(function(e,t){return!!qe(t)&&(!!je(e)&&(!!w(e.type)||(Object({NODE_ENV:"production"}).DEBUG&&a.a.debugAssertTag(538543693,o.a.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:validateTrackEventParams - InteractivityTracker doesn't support tracking of this event type: ".concat(e.type,", userAction: ").concat(t)),a.a.sendTraceTag(508839814,o.a.msoulscat_Wac_BrowserGeneral,i.a.Info,"InteractivityTracker:validateTrackEventParams - InteractivityTracker doesn't support tracking of this event type: ".concat(e.type,", userAction: ").concat(t)),!1)))}(e,t)&&He(t)){q.lastTrackedActionTime=performance.now();var u=Ye(e.type,e.timeStamp),l=function(e,t,n){var r=Be[e],c=void 0!==r&&void 0!==r.find((function(e){return e.action===n}));return(!c||"keypress"!==t.type)&&(!!c&&(a.a.sendTraceTag(539829784,o.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,"InteractivityTracker:checkDuplicateAction - duplicate tracked action. Same action: ".concat(n," was already tracked on the same event with type: ").concat(t.type)),a.a.debugAssertTag(539829785,o.a.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:checkDuplicateAction - duplicate tracked action. Same action: ".concat(n," was already tracked on the same event with type: ").concat(t.type)),!0))}(u,e,t),d=tt(),p={action:t,state:d,contexts:n?Object(r.__spreadArray)([],n,!0):[],startTime:e.timeStamp},m=[];if(!l&&(et(p,u),f(p,"total"),Ke(c.a.StartTrackAction,p,d),Oe()&&s)){var g=n?Object(r.__spreadArray)([],n,!0):[];g.push({itemKey:"action",value:t}),m=Fe(s,d,g,e)}var v="InteractivityTracker:trackEvent - userActionKey: ".concat(u," userAction: ").concat(t,", ").concat(le(),", actionBucket: ").concat(he(p),", context: ").concat(JSON.stringify(n));Oe()&&(l&&(v+=", isDuplicateAction: ".concat(l)),s&&s.length>0&&(v+=", asyncUiNames: ".concat(JSON.stringify(s)))),a.a.sendTraceTag(137704644,o.a.msoulscat_Wac_BrowserGeneral,i.a.Info,v);var T=Je(u,t);if(ne()){Ue.set(T,new Set(Object(r.__spreadArray)(Object(r.__spreadArray)([],m,!0),[p],!1)));for(var h=0,y=m;h<y.length;h++)y[h].contextKey=T;p.contextKey=T}return T}}function Ve(e,t){return!(!je(e)||(!t||0===t.length)&&(a.a.sendTraceTag(507557069,o.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,"InteractivityTracker:validateTrackAsyncUiParams -  no async UI Names"),1))}function qe(e){return!(!e||0===e.length&&(a.a.sendTraceTag(539829786,o.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,"InteractivityTracker:validateEventAndAction -  no userAction value"),1))}function je(e){return!!e&&e instanceof Event}function He(e){return!!fe()||(a.a.sendTraceTag(539829787,o.a.msoulscat_Wac_BrowserGeneral,i.a.Info,"InteractivityTracker:validateTrackerStarted - tracker not started. userAction dropped: ".concat(e)),!1)}function ze(e,t,n){var r,s=ue(),u=v(t,Ae()?"Periodic":"EndOfState");Ke(c.a.EndTrackSlowAction,t,null!==(r=t.state)&&void 0!==r?r:null==s?void 0:s.appState,e,n),f(t,"slow"),u.slow>u.total&&"undefined"!==t.action&&a.a.sendTraceTag(539829788,o.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,"InteractivityTracker:processSlowEventActionTimingEntry: action ".concat(t.action," slow count (").concat(u.slow,") higher then total (").concat(u.total,"). trackedEventsToUserAction size is ").concat(Object.keys(Be).length))}function Ke(e,t,n,r,a){var o;if(void 0===r&&(r=void 0),void 0===a&&(a=void 0),xe){var i={name:t.action,appState:n,recentAppInfoProperties:null===(o=ue())||void 0===o?void 0:o.appInfoProperties};i.actionBucket=he(t);var c=Pe().get(e);c&&xe.dispatchEvent(new CustomEvent(c,{detail:{startTime:r,endTime:a,actionProps:i}}))}}function Qe(e){var t=e.contextKey;if(t){var n=Ue.get(t);n&&(n.delete(e),0===n.size&&Ue.delete(t))}}function Xe(e){var t=Be[e];if(!t)return[{action:"undefined",state:void 0,contexts:[],startTime:-1}];if(ne())for(var n=0,r=t;n<r.length;n++)Qe(r[n]);return delete Be[e],t}function Ye(e,t){return"".concat(e,"_").concat(t)}function Ze(e){var t=e.indexOf("_"),n=t>-1?e.substring(t+1):void 0;return n?parseFloat(n):void 0}function $e(){Be={},Re={},Ue=new Map}function et(e,t,n){if(void 0===n&&(n=!1),n){var r=(Me.get(e.action)||0)+1;Me.set(e.action,r),e.contexts.push({itemKey:"actionIndex",value:r.toString()});var a=he(e),o=(Ne.get(a)||0)+1;Ne.set(a,o),e.contexts.push({itemKey:"bucketIndex",value:o.toString()})}var i=Be;n&&(i=Re);var c=i[t];c?c.push(e):i[t]=[e]}function tt(){var e,t,n;return ge()?(function(){var e,t,n=ke();(null===(e=ue())||void 0===e?void 0:e.appState)!==(null==n?void 0:n.appState)&&(be(),T()),(t=n)&&(H=t,z=void 0)}(),t=null===(e=ue())||void 0===e?void 0:e.appState):((n=Se())!==se()&&(j=n,1)&&(be(),T()),t=se()),null!=t?t:"undefined"}var nt,rt=function(){function e(){this.collectedActions=[],this.collectingEnabled=!1,this.startCollectingSlowActions=this.startCollectingSlowActions.bind(this),this.stopCollectingSlowActions=this.stopCollectingSlowActions.bind(this),this.collectSlowUserAction=this.collectSlowUserAction.bind(this),this.retrieveAllSlowActions=this.retrieveAllSlowActions.bind(this),this.cleanCollectedActions=this.cleanCollectedActions.bind(this),this.retrieveSlowActionsBetweenTimeRange=this.retrieveSlowActionsBetweenTimeRange.bind(this)}return e.prototype.startCollectingSlowActions=function(e){e||this.cleanCollectedActions(),this.collectingEnabled=!0},e.prototype.stopCollectingSlowActions=function(){this.collectingEnabled=!1},e.prototype.collectSlowUserAction=function(e){this.collectingEnabled&&e&&this.collectedActions.push(e)},e.prototype.retrieveAllSlowActions=function(){return Object(r.__spreadArray)([],this.collectedActions,!0)},e.prototype.cleanCollectedActions=function(){this.collectedActions=[]},e.prototype.retrieveSlowActionsBetweenTimeRange=function(e,t){return this.collectedActions.filter((function(n){return e>=n.startTime&&e<=n.endTime||t>=n.startTime&&t<=n.endTime}))},e}(),at=n(737),ot=function(){function e(){this.serializedException="",this.wasSerializeExceptionCalled=!1}return e.prototype.serializeException=function(e){this.wasSerializeExceptionCalled=!0,null!=JSON&&"stringify"in JSON?this.serializedException=null!=Object&&"getOwnPropertyNames"in Object?JSON.stringify(e,Object.getOwnPropertyNames(e)):"":this.serializedException=""},e.prototype.retrieveSerializedException=function(){return this.wasSerializeExceptionCalled?(this.wasSerializeExceptionCalled=!1,this.serializedException):""},e}(),it=function(){function e(){}return e.prototype.logOperation=function(e,t,n,r,a,o,i,c){},e.prototype.logFallbackResultReturned=function(){},e}(),ct=new(function(){function e(){this.elements=[]}return e.prototype.push=function(e){this.elements.unshift(e)},e.prototype.pop=function(){return this.elements.shift()},e.prototype.peek=function(){return this.elements.length>0?this.elements[0]:void 0},e}()),st=function(){function e(e,t,n,r,a,o){var i=ct.peek(),c=void 0!==i?i:"";ct.push(e),this.logs=[],this.propertyBag=new Map;var s=at.a.createNewStopWatch();s.start();var u=void 0,l=!1;try{l=(u=t(this)).didOperationFailUnexpectedly}catch(e){a.serializeException(e),this.exception=a.retrieveSerializedException(),l=!0}this.operationResult=void 0!==u?u:n,s.stop(),!l&&r||o.logOperation(e,c,this.operationResult.didOperationSucceed,s.getElapsedTime(),l,this.logs,this.propertyBag,this.exception),ct.pop()}return e.prototype.addLog=function(e){this.logs.push(e)},e.prototype.addProperty=function(e,t){this.propertyBag.set(e,t)},e.prototype.getResult=function(){return this.operationResult.result},e.startNew=function(t,n,r,a,o,i){return new e(t,n,r,null!=o&&o,null==i?new ot:i,null==a?new it:a)},e}(),ut=function(){function e(e,t,n){this.didOperationSucceed=e,this.didOperationFailUnexpectedly=t,this.result=n}return e.generateOperationResult=function(t){return new e(t.didOperationSucceed,null!=t.didOperationFailUnexpectedly&&t.didOperationFailUnexpectedly,t.result)},e}(),lt=(function(){function e(e,t){var n=this;this.windowPropertyChecker=e,this.logger=t,this.callbacks=[],this.windowPropertyChecker.hasProperty("addEventListener")?window.addEventListener("beforeunload",(function(){var e=ut.generateOperationResult({didOperationSucceed:!1,result:void 0});st.startNew("BeforeUnloadEventCallback",(function(){return n.callbacks.forEach((function(t){st.startNew("BeforeUnloadEventIndividualCallback",(function(){return t(),ut.generateOperationResult({didOperationSucceed:!0,result:void 0})}),e)})),ut.generateOperationResult({didOperationSucceed:!0,result:void 0})}),e)})):this.logger.logWindowAddEventListenerNotFound()}e.prototype.subscribeForBeforeWindowUnloadEvent=function(e){this.callbacks.push(e)}}(),function(){function e(){}return e.prototype.logWindowMissingInJSEnvironment=function(){a.a.sendTraceTag(578834847,o.a.msoulscat_Wac_Telemetry,i.a.Warning,"Unable to find window in the JS environment")},e.prototype.logEmptyUserAgentString=function(){a.a.sendTraceTag(578834850,o.a.msoulscat_Wac_Telemetry,i.a.Error,"Empty user agent string")},e.prototype.logChromiumOnIOS=function(){a.a.sendTraceTag(578834851,o.a.msoulscat_Wac_Telemetry,i.a.Info,"iOS version of Chromium based browser detected")},e.prototype.logBrowserUserAgentNotChromiumBased=function(){a.a.sendTraceTag(578834880,o.a.msoulscat_Wac_Telemetry,i.a.Info,"Browser not chromium based")},e.prototype.logUserAgentSpoofedToBeChromium=function(){a.a.sendTraceTag(578834881,o.a.msoulscat_Wac_Telemetry,i.a.Info,"Browser user agent spoofed to be chromium based")},e.prototype.logUserAgentToParseChromiumMajorVersionNumber=function(e){a.a.sendTraceTag(578834882,o.a.msoulscat_Wac_Telemetry,i.a.Info,e)},e.prototype.logChromeNotPresentInUserAgent=function(){a.a.sendTraceTag(578834883,o.a.msoulscat_Wac_Telemetry,i.a.Error,"Chrome was not found in the user agent")},e.prototype.logUnableToIsolateChromeInformationFromUserAgent=function(){a.a.sendTraceTag(578834884,o.a.msoulscat_Wac_Telemetry,i.a.Error,"Unable to isolate chrome information from the user agent")},e.prototype.logUnableToExtractChromeVersionInformation=function(){a.a.sendTraceTag(578834885,o.a.msoulscat_Wac_Telemetry,i.a.Error,"Unable to extract chrome version information from the user agent")},e.prototype.logUnableToParseChromeMajorVersionString=function(){a.a.sendTraceTag(578834886,o.a.msoulscat_Wac_Telemetry,i.a.Error,"Unable to parse the chromium major version number")},e.prototype.logRequestIdleCallbackMissing=function(){a.a.sendTraceTag(576582740,o.a.msoulscat_Wac_Telemetry,i.a.Warning,"Unable to find window.requestIdleCallback in the JS environment")},e.prototype.logCallbackBeingInvokedImmediately=function(){a.a.sendTraceTag(576582743,o.a.msoulscat_Wac_Telemetry,i.a.Error,"Callback is being invoked immediately as there is no platform support for deferring work")},e.prototype.logCancelIdleCallbackMissing=function(){a.a.sendTraceTag(576582744,o.a.msoulscat_Wac_Telemetry,i.a.Warning,"Unable to find window.cancelIdleCallback in the JS environment")},e.prototype.logUnknownMechanism=function(){a.a.sendTraceTag(576582747,o.a.msoulscat_Wac_Telemetry,i.a.Error,"Unable to find a way to cancel the idle time job")},e.prototype.logWindowSetTimeOutMissingInJSEnvironment=function(){a.a.sendTraceTag(576239755,o.a.msoulscat_Wac_Telemetry,i.a.Error,"window.setTimeout is missing in JS environment")},e.prototype.logWindowPerformanceMissingInJSEnvironment=function(){a.a.sendTraceTag(576218121,o.a.msoulscat_Wac_Telemetry,i.a.Error,"Unable to find window.performance in the JS environment")},e.prototype.logWindowPerformanceNowMissingInJSEnvironment=function(){a.a.sendTraceTag(576218122,o.a.msoulscat_Wac_Telemetry,i.a.Error,"Unable to find window.performance.now in the JS environment")},e.prototype.logNavigatorMissingInJSEnvironment=function(){a.a.sendTraceTag(574657350,o.a.msoulscat_Wac_Telemetry,i.a.Error,"Navigator is missing in the JS environment")},e.prototype.logSendBeaconNotSupported=function(){a.a.sendTraceTag(573970625,o.a.msoulscat_Wac_Telemetry,i.a.Info,"SendBeacon not supported in current environment")},e.prototype.logBeaconURLIsEmpty=function(){a.a.sendTraceTag(573919702,o.a.msoulscat_Wac_Telemetry,i.a.Error,"We were passed an empty URL for sendBeacon")},e.prototype.logBeaconDataIsEmpty=function(){a.a.sendTraceTag(573907718,o.a.msoulscat_Wac_Telemetry,i.a.Error,"We were passed an empty data for sendBeacon")},e.prototype.logDocumentMissingInJsEnvironment=function(){a.a.sendTraceTag(573572181,o.a.msoulscat_Wac_Telemetry,i.a.Error,"Document is not present in JS Environment")},e.prototype.logDocumentVisibilityStateMissingInJsEnvironment=function(){a.a.sendTraceTag(573572182,o.a.msoulscat_Wac_Telemetry,i.a.Error,"Document VisibilityState is not present in JS Environment")},e.prototype.logDocumentAddEventListenerMissingInJsEnvironment=function(){a.a.sendTraceTag(573572183,o.a.msoulscat_Wac_Telemetry,i.a.Error,"Document AddEventListener is not present in JS Environment")},e.prototype.logWindowAddEventListenerNotFound=function(){a.a.sendTraceTag(538710337,o.a.msoulscat_Wac_Telemetry,i.a.Error,"Window AddEventListener is not present in JS Environment")},e.prototype.logPerformanceEventCountsNotSupported=function(){a.a.sendTraceTag(537522270,o.a.msoulscat_Wac_Telemetry,i.a.Warning,"Performance.EventCounts is not present in JS Environment")},e.prototype.logRemoveQueryParamsNotCalled=function(){a.a.sendTraceTag(527439250,o.a.msoulscat_Wac_Telemetry,i.a.Error,"Remove query params was not called before retrieve")},e.prototype.logWindowPerformanceEventCountsMissingInJSEnvironment=function(){a.a.sendTraceTag(525099864,o.a.msoulscat_Wac_Telemetry,i.a.Info,"window.performance.eventcounts was not present in the JS environment")},e}()),dt=function(){function e(e){this.logger=e}return e.prototype.hasProperty=function(e){var t=this,n=ut.generateOperationResult({didOperationSucceed:!1,result:!1});return st.startNew("CheckWindowProperty",(function(n){if(null==window)return t.logger.logWindowMissingInJSEnvironment(),ut.generateOperationResult({didOperationSucceed:!1,result:!1,didOperationFailUnexpectedly:!0});n.addProperty("PropertyNameChecked",e);var r=e in window;return n.addProperty("DoesPropertyExistOnWindow",r),ut.generateOperationResult({didOperationSucceed:!0,result:r})}),n).getResult()},e}(),pt=(function(){function e(e,t){this.windowPropertyChecker=e,this.logger=t,this.isEventCountsAPIAvailable=!0,this.windowPropertyChecker.hasProperty("performance")||(this.logger.logWindowPerformanceMissingInJSEnvironment(),this.isEventCountsAPIAvailable=!1),null==window.performance.eventCounts&&(this.logger.logWindowPerformanceEventCountsMissingInJSEnvironment(),this.isEventCountsAPIAvailable=!1)}e.prototype.getEventCounts=function(){return this.isEventCountsAPIAvailable,new Map}}(),function(){function e(e){this.logger=e,this.wasRemoveQueryParamsCalled=!1,this.queryParamsRemovedURL=""}e.prototype.removeQueryParams=function(e){this.wasRemoveQueryParamsCalled=!0,this.queryParamsRemovedURL=e.split("?")[0]},e.prototype.retrieveQueryParamsRemovedURL=function(){return this.wasRemoveQueryParamsCalled?(this.wasRemoveQueryParamsCalled=!1,this.queryParamsRemovedURL):(this.logger.logRemoveQueryParamsNotCalled(),"")}}(),function(){function e(){}e.prototype.addEventListener=function(e,t){},e.prototype.onError=function(e){},e.prototype.postMessage=function(e){},e.prototype.terminate=function(){}}(),function(){function e(){this.xmlHTTPRequest=new XMLHttpRequest}return e.prototype.open=function(e,t,n){this.xmlHTTPRequest.open(e,t,n)},e.prototype.send=function(e){this.xmlHTTPRequest.send(e)},e}());(function(){function e(){}e.prototype.generateXMLHTTPRequestWrapper=function(){return new pt}})(),function(){function e(e){this.logger=e}e.prototype.isBrowserChromiumBased=function(e){return function(e,t){var n=ut.generateOperationResult({didOperationSucceed:!1,result:!1});return st.startNew("CheckChromiumBrowser",(function(n){if(n.addProperty("UserAgent",e),0===e.localeCompare(""))return t.logEmptyUserAgentString(),ut.generateOperationResult({didOperationSucceed:!1,result:!1,didOperationFailUnexpectedly:!0});var r=e.match(/(Chrome\/|CriOS\/)/g);return null!=e.match(/(CriOS\/)/g)&&t.logChromiumOnIOS(),null===r?(t.logBrowserUserAgentNotChromiumBased(),ut.generateOperationResult({didOperationSucceed:!0,result:!1})):ut.generateOperationResult({didOperationSucceed:!0,result:!0})}),n).getResult()}(e,this.logger)},e.prototype.parseChromeMajorVersionNumber=function(e){return function(e,t){var n=ut.generateOperationResult({didOperationSucceed:!1,result:-1});return st.startNew("ParseChromiumMajorVersionNumber",(function(n){n.addProperty("UserAgent",e);var r=e.match(/((Chrome\/|CriOS\/)(\d|\.)+)/g);if(null==r)return t.logChromeNotPresentInUserAgent(),ut.generateOperationResult({didOperationSucceed:!1,result:-1});var a=r[0].split("/");if(a.length<2)return t.logUnableToIsolateChromeInformationFromUserAgent(),ut.generateOperationResult({didOperationSucceed:!1,result:-1});var o=a[1].split(".");if(o.length<4)return t.logUnableToExtractChromeVersionInformation(),ut.generateOperationResult({didOperationSucceed:!1,result:-1});var i=o[0],c=parseInt(i,10);return isNaN(c)?(t.logUnableToParseChromeMajorVersionString(),ut.generateOperationResult({didOperationSucceed:!1,result:-1})):(n.addProperty("MajorVersionNumber",c),ut.generateOperationResult({didOperationSucceed:!0,result:c}))}),n).getResult()}(e,this.logger)}}(),function(){function e(e,t){this.windowPropertyChecker=e,this.logger=t}e.prototype.scheduleJobForIdleTime=function(e){var t,n,r,a;t=function(){e()},n=this.windowPropertyChecker,r=this.logger,a=ut.generateOperationResult({didOperationSucceed:!1,result:{id:-1,underlyingMechanism:"InvalidUnderlyingMechanism"}}),st.startNew("RequestIdleCallbackShim",(function(){if(n.hasProperty("requestIdleCallback")){var e=window.requestIdleCallback(t,void 0);return ut.generateOperationResult({didOperationSucceed:!0,result:{id:e,underlyingMechanism:"requestIdleCallback"}})}r.logRequestIdleCallbackMissing();Date.now();return r.logCallbackBeingInvokedImmediately(),t(),ut.generateOperationResult({didOperationSucceed:!0,result:{id:-1,underlyingMechanism:"InvalidUnderlyingMechanism"}})}),a).getResult()}}(),function(){function e(){}e.prototype.getBooleanPropertyValue=function(e){var t=ut.generateOperationResult({didOperationSucceed:!1,result:!1});return st.startNew("CheckSelfProperty",(function(t){t.addProperty("PropertyChecked",e);var n=!!self.hasOwnProperty(e)&&self[e];return ut.generateOperationResult({didOperationSucceed:!0,result:n})}),t).getResult()}}(),function(){function e(e){this.selfPropertyChecker=e}e.prototype.isSiteCrossOriginIsolated=function(){var e=this,t=ut.generateOperationResult({didOperationSucceed:!1,result:!1});return st.startNew("CheckCrossOriginSiteIsolation",(function(){var t=e.selfPropertyChecker.getBooleanPropertyValue("crossOriginIsolated");return ut.generateOperationResult({didOperationSucceed:!0,result:t})}),t).getResult()}}(),function(){function e(e){this.logger=e}e.prototype.setTimerJob=function(e,t){var n=this,r=ut.generateOperationResult({didOperationSucceed:!1,result:void 0});st.startNew("SetTimerJob",(function(){return null==window?(n.logger.logWindowMissingInJSEnvironment(),ut.generateOperationResult({didOperationSucceed:!1,result:void 0,didOperationFailUnexpectedly:!0})):null==window.setTimeout?(n.logger.logWindowSetTimeOutMissingInJSEnvironment(),ut.generateOperationResult({didOperationSucceed:!1,result:void 0,didOperationFailUnexpectedly:!0})):(window.setTimeout(e,t),ut.generateOperationResult({didOperationSucceed:!0,result:void 0}))}),r)}}(),function(){function e(e){var t=this;this.logger=e,this.onVisibilityChange=function(){t.updateIsHidden()},this.isDocumentPresentInJsEnvironment()||this.logger.logDocumentMissingInJsEnvironment(),this.isDocumentVisibilityStatePresentInJsEnvironment()||this.logger.logDocumentVisibilityStateMissingInJsEnvironment(),this.isDocumentAddEventListenerPresentInJsEnvironment()||this.logger.logDocumentAddEventListenerMissingInJsEnvironment(),this.lastUnHiddenDate=void 0,this.isDocumentHidden=!1,this.updateIsHidden(),document.addEventListener("visibilitychange",this.onVisibilityChange)}e.prototype.isDocumentVisibleNow=function(){var e=this,t=ut.generateOperationResult({didOperationSucceed:!1,result:!1});return st.startNew("CheckDocumentVisibility",(function(){if(!e.isDocumentPresentInJsEnvironment())return e.logger.logDocumentMissingInJsEnvironment(),ut.generateOperationResult({didOperationSucceed:!1,result:!1,didOperationFailUnexpectedly:!0});if(!e.isDocumentVisibilityStatePresentInJsEnvironment())return e.logger.logDocumentVisibilityStateMissingInJsEnvironment(),ut.generateOperationResult({didOperationSucceed:!1,result:!1,didOperationFailUnexpectedly:!0});var t="hidden"!==document.visibilityState;return ut.generateOperationResult({didOperationSucceed:!0,result:t})}),t).getResult()},e.prototype.wasDocumentHiddenDuringTimeRange=function(e){var t=this,n=ut.generateOperationResult({didOperationSucceed:!1,result:!1});return st.startNew("WasDocumentHiddenDuringTimeRange",(function(){if(t.isDocumentHidden)return ut.generateOperationResult({didOperationSucceed:!0,result:!0});if(void 0===t.lastUnHiddenDate)return ut.generateOperationResult({didOperationSucceed:!0,result:!1});var n=Date.now()-t.lastUnHiddenDate<e;return ut.generateOperationResult({didOperationSucceed:!0,result:n})}),n).getResult()},e.prototype.isDocumentPresentInJsEnvironment=function(){return null!=document},e.prototype.isDocumentVisibilityStatePresentInJsEnvironment=function(){return"visibilityState"in document},e.prototype.isDocumentAddEventListenerPresentInJsEnvironment=function(){return"addEventListener"in document},e.prototype.updateIsHidden=function(){this.isDocumentHidden="hidden"===document.visibilityState,this.isDocumentHidden||(this.lastUnHiddenDate=Date.now())}}();!function(e){e.SendBeacon="sendBeacon"}(nt||(nt={}));var mt;(function(){function e(e,t,n,r){this.navigatorPropertyChecker=e,this.navigatorAPI=t,this.xmlHTTPRequestWrapperFactory=n,this.logger=r}e.prototype.sendBeacon=function(e){return t=this.navigatorPropertyChecker,n=this.navigatorAPI,r=this.xmlHTTPRequestWrapperFactory,a=this.logger,o=e.url,i=e.data,c=ut.generateOperationResult({didOperationSucceed:!1,result:!1}),st.startNew("SendBeaconCall",(function(e){if(0===o.length)return a.logBeaconURLIsEmpty(),ut.generateOperationResult({didOperationSucceed:!1,result:!1});if(0===i.length)return a.logBeaconDataIsEmpty(),ut.generateOperationResult({didOperationSucceed:!1,result:!1});if(!t.hasProperty(nt.SendBeacon)){a.logSendBeaconNotSupported();var c=r.generateXMLHTTPRequestWrapper();return c.open("POST",o,!0),c.send(i),e.addProperty("POSTRequestSent",!0),ut.generateOperationResult({didOperationSucceed:!0,result:!0})}var s=n.sendBeacon(o,i);return e.addProperty("BeaconRequestSuccessfullyQueued",s),ut.generateOperationResult({didOperationSucceed:!0,result:s})}),c).getResult();var t,n,r,a,o,i,c}})(),function(){function e(e){this.logger=e}e.prototype.hasProperty=function(e){var t=this,n=ut.generateOperationResult({didOperationSucceed:!1,result:!1});return st.startNew("CheckNavigatorProperty",(function(n){if(null==navigator)return t.logger.logNavigatorMissingInJSEnvironment(),ut.generateOperationResult({didOperationSucceed:!1,result:!1,didOperationFailUnexpectedly:!0});n.addProperty("NavigatorPropertyChecked",e);var r=e in navigator;return n.addProperty("IsPropertyPresentInNavigatorResult",r),ut.generateOperationResult({didOperationSucceed:!0,result:r})}),n).getResult()}}(),function(){function e(e){this.logger=e}e.prototype.sendBeacon=function(e,t){return null==navigator?(this.logger.logNavigatorMissingInJSEnvironment(),!1):navigator.sendBeacon(e,t)}}(),function(){function e(e){this.logger=e}e.prototype.getCurrentTimestamp=function(){if(null!=window)if(null!=window.performance){if(null!=window.performance.now)return window.performance.now();this.logger.logWindowPerformanceNowMissingInJSEnvironment()}else this.logger.logWindowPerformanceMissingInJSEnvironment();else this.logger.logWindowMissingInJSEnvironment()}}(),function(){function e(){this.elements=[]}e.prototype.peek=function(){return this.elements.length>0?this.elements[0]:void 0},e.prototype.queue=function(e){this.elements.push(e)},e.prototype.dequeue=function(){this.elements.shift()},e.prototype.length=function(){return this.elements.length}}(),function(){function e(e){this.logger=e,this.logger=e}e.prototype.retrieveUserAgent=function(){var e=this,t=ut.generateOperationResult({didOperationSucceed:!1,result:""});return st.startNew("RetrieveUserAgent",(function(){var t=e.getUserAgentFromNavigatorAPI();return ut.generateOperationResult({didOperationSucceed:!0,result:t})}),t).getResult()},e.prototype.getUserAgentFromNavigatorAPI=function(){return"undefined"==typeof navigator?(this.logger.logNavigatorMissingInJSEnvironment(),""):navigator.userAgent}}(),function(){function e(){this.elements=[]}e.prototype.peek=function(){var e=this.count();if(0!==e)return this.elements[e-1]},e.prototype.push=function(e){this.elements.push(e)},e.prototype.pop=function(){this.elements.pop()},e.prototype.count=function(){return this.elements.length}}(),function(){function e(){}e.getWindowPropertyChecker=function(){var e=new lt;return new dt(e)}}(),function(){function e(e){this.windowPropertyChecker=e}e.prototype.isWebWorkerAPIAvailable=function(){return!!this.windowPropertyChecker.hasProperty("Worker")},e.prototype.isSharedWebWorkerAPIAvailable=function(){return!!this.windowPropertyChecker.hasProperty("SharedWorker")}}(),function(){function e(){}e.prototype.generateGuid=function(){return""}}();function ft(e){return void 0===e&&(e=void 0),mt={animationStart:e&&e.timeStamp?e.timeStamp:performance.now(),lastAnimationChunkStart:performance.now(),currentAnimationFrameTimestamp:performance.now(),currentChunkFrameCount:0,currentAnimationTotalChunks:0,currentAnimationSlowChunks:0,lastAppState:"",rafId:void 0,wasClearedOnTimeout:!1}}function gt(){return mt}var vt,Tt=!1;function ht(e){return window.requestAnimationFrame((function(){!function(e){!function(e){var t=gt();if(_t(t))return Et(t,e),void(q.isDuringAnimationTracking=!1);q.isDuringAnimationTracking=!0,q.lastTrackedAnimationTime=performance.now(),t.currentAnimationFrameTimestamp=performance.now();var n=t.currentAnimationFrameTimestamp-t.lastAnimationChunkStart,r=V.chunkDurationMs;if(n<r)t.currentChunkFrameCount++;else{var a=Math.floor(n/r);!function(e,t,n){var r={name:e,chunks:t,slowChunksDetails:void 0},a=gt();a.currentChunkFrameCount<V.minFramesPerChunk?r.slowChunksDetails={slowAnimationPeriodStart:a.lastAnimationChunkStart,slowAnimationPeriodDuration:t*n,slowChunksNumber:t}:t>1&&(r.slowChunksDetails={slowAnimationPeriodStart:a.lastAnimationChunkStart+n,slowAnimationPeriodDuration:(t-1)*n,slowChunksNumber:t-1}),performance.measure("ConsecutiveChunksMeasure",{start:a.lastAnimationChunkStart,duration:t*n,detail:r})}(e,a,r),t.lastAnimationChunkStart+=a*r,t.currentChunkFrameCount=1}}(e),wt(gt())&&(gt().rafId=ht(e))}(e)}))}function yt(e){kt().disconnect(),performance.clearMeasures("ConsecutiveChunksMeasure"),window.cancelAnimationFrame(e.rafId),e.currentAnimationTotalChunks=0,e.currentAnimationSlowChunks=0,e.rafId=void 0}function wt(e){return void 0!==(null==e?void 0:e.rafId)}function St(e){e.getEntriesByName("ConsecutiveChunksMeasure").forEach((function(e){!function(e){a.a.debugAssertTag(507912414,o.a.msoulscat_Wac_BrowserGeneral,"measure"===e.entryType,"AnimationTracker:validateMeasureEntry - unexpected observed entry type: ".concat(e.entryType))}(e);var t=gt(),n=e.detail,r=n.name;t.currentAnimationTotalChunks+=n.chunks;var i=n.slowChunksDetails;if(!ye(i)){t.currentAnimationSlowChunks+=i.slowChunksNumber;var s={action:r};Ke(c.a.EndTrackSlowAction,s,t.lastAppState,i.slowAnimationPeriodStart,i.slowAnimationPeriodStart+i.slowAnimationPeriodDuration)}})),performance.clearMeasures("ConsecutiveChunksMeasure")}function kt(){return void 0!==vt?vt:vt=new PerformanceObserver(St)}function At(e){return"hidden"===document.visibilityState&&(yt(e),a.a.sendTraceTag(507593093,o.a.msoulscat_Wac_BrowserGeneral,i.a.Info,"AnimationTracker: updateDocumentVisibility - clear animation tracking due to document visibility: ".concat(document.visibilityState)),!0)}function Et(e,t){yt(e),e.wasClearedOnTimeout=!0,a.a.sendTraceTag(507593045,o.a.msoulscat_Wac_BrowserGeneral,i.a.Info,"AnimationTracker:handleTimeOut - animation timeout for animation: ".concat(t,", gap: ").concat(e.currentAnimationFrameTimestamp-e.animationStart,", docmunet visibility: ").concat(document.visibilityState))}function _t(e){return e.currentAnimationFrameTimestamp-e.animationStart>V.animationTimeoutMs}ft();var Ot=!1,It=function(){function e(){}return e.prototype.create=function(){if(function(){var e;if(!window.PerformanceObserver)return a.a.sendTraceTag(539829760,o.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,"InteractivityTracker:isInteractivityTrackerSupported:false - no PerformanceObserver"),!1;if(!PerformanceObserver.supportedEntryTypes)return a.a.sendTraceTag(539829761,o.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,"isInteractivityTrackerSupported:false - PerformanceObserver missing supportedEntryTypes"),!1;if((null===(e=null===PerformanceObserver||void 0===PerformanceObserver?void 0:PerformanceObserver.supportedEntryTypes)||void 0===e?void 0:e.indexOf("event"))<0)return a.a.sendTraceTag(539829762,o.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,"isInteractivityTrackerSupported:false - PerformanceObserver not supporting event timing"),!1;var t="undefined"==typeof navigator?"":navigator.userAgent;return function(e){return 0!==e.localeCompare("")&&null!==e.match(/(Chrome\/|CriOS\/)/g)}(t)?!(function(e){var t=e.match(/((Chrome\/|CriOS\/)(\d|\.)+)/g);if(null==t)return-1;var n=t[0].split("/");if(n.length<2)return-1;var r=n[1].split(".");if(r.length<4)return-1;var a=r[0],o=parseInt(a,10);return isNaN(o)?-1:o}(t)<85&&(a.a.sendTraceTag(539829764,o.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,"isInteractivityTrackerSupported:false - user agent chromium version < 85"),1)):(a.a.sendTraceTag(539829763,o.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,"isInteractivityTrackerSupported:false - user agent is not chromium based."),!1)}()){var e=window.__InteractivityTracker__;return e||(e=window.__InteractivityTracker__=new Ct),e}},e}(),Ct=function(){function e(){}return e.prototype.start=function(e){return de(e)},e.prototype.stop=function(){return me()},e.prototype.track=function(e,t,n){return Ot||(Ot=!0,a.a.sendTraceTag(508056529,o.a.msoulscat_Wac_BrowserGeneral,i.a.Info,"InteractivityTrackerFactory.track: used deprecated method track")),Le(e,t,n,void 0)},e.prototype.trackInteraction=function(e,t,n,r){return Le(e,t,n,r)},e.prototype.trackAsyncUi=function(e,t,n,a){!function(e,t,n,a){if(Ve(e,t)&&He(a)&&Oe()){var o=n?Object(r.__spreadArray)([],n,!0):[];qe(a)&&o.push({itemKey:"action",value:a});var i=Fe(t,tt(),n,e);if(ne()&&i.length>0){var c=Je(Ye(e.type,e.timeStamp),a||t[0]);Ue.set(c,new Set(i));for(var s=0,u=i;s<u.length;s++)u[s].contextKey=c}}}(e,t,n,a)},e.prototype.addContext=function(e,t,n){e&&t&&function(e,t){if(ne())for(var n=0,r=Array.from(Ue.get(e)||[]);n<r.length;n++)r[n].contexts.push(t);else{var a=function(e){var t=e.split("_@@@_"),n=t[0],r=t[1];if(Be[n])return Be[n].find((function(e){return e.action===r}))}(e);null==a||a.contexts.push(t)}}(e,{itemKey:t,value:n})},e.prototype.isEventSupportedForTracking=function(e){return!!e&&w(e.type)},e.prototype.createActionsRetriever=function(){var e=new rt;return De(c.a.EndTrackSlowAction,e.collectSlowUserAction),e},e.prototype.addEventListener=function(e,t){t&&De(e,t)},e.prototype.removeEventListener=function(e,t){t&&Ge(e,t)},e.prototype.recentAppState=function(){return se()},e.prototype.trackedUserActionsReport=function(){var e=p();if(e){for(var t=[],n=0,r=Object.entries(e);n<r.length;n++){var a=r[n],o=a[0],i=a[1],c={action:o,actionBucket:i.actionBucket};t.push({userAction:o,actionBucket:he(c),total:i.total,slow:i.slow})}return t}},e.prototype.startTrackAnimation=function(e,t){return!!t&&function(e,t){if(!_e()||ye(t))return!1;var n=gt();return wt(n)&&yt(n),n=ft(e),ve("OfficeVSO:8625874_clearAnimationTrackingWhenUnvisible")&&!Tt&&function(e){window.addEventListener("visibilitychange",(function(){wt(e)&&At(e)})),Tt=!0}(n),n.lastAppState=tt(),kt().observe({type:"measure",buffered:!0}),n.rafId=ht(t),!ve("OfficeVSO:8625874_clearAnimationTrackingWhenUnvisible")||!At(n)}(e,t)},e.prototype.stopTrackAnimation=function(e,t){void 0===t&&(t=!1),e&&function(e,t){if(void 0===t&&(t=!1),_e()&&!ye(e)){q.isDuringAnimationTracking=!1;var n=gt();if(t)yt(n);else{if(n.wasClearedOnTimeout)return n.wasClearedOnTimeout=!1,void a.a.sendTraceTag(507912418,o.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,"AnimationTracker:stopAnimationTracking - called stop animation after timeout: ".concat(e));if(void 0!==n.rafId)if(ve("OfficeVSO:8625874_clearAnimationTrackingWhenUnvisible")&&_t(n))Et(n,e);else{var r={action:e};n.currentAnimationTotalChunks>0&&(f(r,"total",n.currentAnimationTotalChunks),f(r,"slow",n.currentAnimationSlowChunks),a.a.sendTraceTag(507912415,o.a.msoulscat_Wac_BrowserGeneral,i.a.Info,"AnimationTracker.stopTrackAnimation - animationName: ".concat(e," totalChunks: ").concat(n.currentAnimationTotalChunks," slowChunks: ").concat(n.currentAnimationSlowChunks))),yt(n)}else a.a.sendTraceTag(507912417,o.a.msoulscat_Wac_BrowserGeneral,i.a.Warning,"AnimationTracker:stopAnimationTracking - stop animation for animation wasn't started: ".concat(e))}}}(e,t)},e.prototype.isAsyncUiNameAllowed=function(e){return!!e&&re(e)},e.prototype.getStatus=function(){return Object(r.__assign)({},q)},e}(),bt=new It},2015:function(e,t,n){"use strict";n.r(t);var r=n(1602);n.d(t,"InteractivityTrackerFactoryGlobal",(function(){return r.a}))},2167:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.StartTrackAction=0]="StartTrackAction",e[e.EndTrackSlowAction=1]="EndTrackSlowAction"}(r||(r={}))},737:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=function(){function e(){}return e.prototype.getCurrentTimestamp=function(){return performance.now()},e}(),a=function(){function e(e,t,n){return this.performanceAPIChecker=e,this.performanceTimestampRetriever=t,this.logger=n,this.startTimestamp=-1,this.stopTimestamp=-1,this.performanceAPIChecker.isPerformanceAPIAvailable()?this.performanceAPIChecker.isPerformanceNowDefined()?void(this.unsupportedEnvironment=!1):(this.logger.logPerformanceNowMissingInJSEnvironment(),void(this.unsupportedEnvironment=!0)):(this.logger.logPerformanceMissingInJSEnvironment(),void(this.unsupportedEnvironment=!0))}return e.prototype.start=function(){this.unsupportedEnvironment?this.logger.logStopWatchStartingInUnsupportedEnvironment():this.startTimestamp=this.performanceTimestampRetriever.getCurrentTimestamp()},e.prototype.stop=function(){this.unsupportedEnvironment?this.logger.logStopWatchStoppingInUnsupportedEnvironment():this.stopTimestamp=this.performanceTimestampRetriever.getCurrentTimestamp()},e.prototype.getElapsedTime=function(){if(-1===this.startTimestamp)return this.logger.logGetElapsedTimeCalledWithoutCallingStart(),-1;if(-1===this.stopTimestamp)return this.logger.logGetElapsedTimeCalledWithoutCallingStop(),-1;var e=this.stopTimestamp-this.startTimestamp;return this.resetTimestamps(),e},e.prototype.resetTimestamps=function(){this.startTimestamp=-1,this.stopTimestamp=-1},e}(),o=n(80),i=n(79),c=n(213),s=function(){function e(){}return e.prototype.logPerformanceMissingInJSEnvironment=function(){o.a.sendTraceTag(579110677,i.a.msoulscat_Wac_Telemetry,c.a.Error,"Unable to find performance in the JS environment")},e.prototype.logPerformanceNowMissingInJSEnvironment=function(){o.a.sendTraceTag(579110678,i.a.msoulscat_Wac_Telemetry,c.a.Error,"Unable to find performance.now in the JS environment")},e.prototype.logStopWatchStartingInUnsupportedEnvironment=function(){o.a.sendTraceTag(579110679,i.a.msoulscat_Wac_Telemetry,c.a.Error,"Starting the stopwatch in an unsupported environment. Incorrect data will be stored")},e.prototype.logStopWatchStoppingInUnsupportedEnvironment=function(){o.a.sendTraceTag(579110680,i.a.msoulscat_Wac_Telemetry,c.a.Error,"Stopping the stopwatch in an unsupported environment. Incorrect data will be stored")},e.prototype.logGetElapsedTimeCalledWithoutCallingStart=function(){o.a.sendTraceTag(579110683,i.a.msoulscat_Wac_Telemetry,c.a.Error,"Stopwatch needs to be started before you can get elapsed time")},e.prototype.logGetElapsedTimeCalledWithoutCallingStop=function(){o.a.sendTraceTag(579110684,i.a.msoulscat_Wac_Telemetry,c.a.Error,"Stopwatch needs to be stopped before you can get elapsed time")},e}(),u=function(){function e(){}return e.prototype.isPerformanceAPIAvailable=function(){return null!=performance},e.prototype.isPerformanceNowDefined=function(){return"now"in performance},e}(),l=function(){function e(){}return e.createNewStopWatch=function(){var e=new s,t=new u,n=new r;return new a(t,n,e)},e}()}},[[2015,2,0]]]);
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/interactivity.min.js.map/9ddf03d91e2d55bf6ce99e2d74e168be/interactivity.min.js.map