var Microsoft;!function(){"use strict";var n,t,e,o,i={7630:function(n,t,e){e.d(t,{t:function(){return u}});var o=e(1990),i=e(843),r=e(4267),u=function(n){function t(t){var e=n.call(this)||this;return e.H=t,e}return o.C6(t,n),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),t.prototype.A=function(t){var e=n.prototype.A.call(this,t);return e&&!e.closed&&t.next(this.H),e},t.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new r.P;return this.H},t.prototype.next=function(t){n.prototype.next.call(this,this.H=t)},t}(i.B7)},8703:function(n,t,e){e.d(t,{c:function(){return l}});var o=e(4200),i=e(9633),r=e(7860),u=e(1819);function s(n){return n}var a=e(2180),l=function(){function n(n){this.U=!1,n&&(this.A=n)}return n.prototype.lift=function(t){var e=new n;return e.source=this,e.operator=t,e},n.prototype.subscribe=function(n,t,e){var u=this.operator,s=function(n,t,e){if(n){if(n instanceof o.v)return n;if(n[i.D])return n[i.D]()}return n||t||e?new o.v(n,t,e):new o.v(r.I)}(n,t,e);if(u?s.add(u.call(s,this.source)):s.add(this.source||a.$.useDeprecatedSynchronousErrorHandling&&!s.syncErrorThrowable?this.A(s):this.N(s)),a.$.useDeprecatedSynchronousErrorHandling&&s.syncErrorThrowable&&(s.syncErrorThrowable=!1,s.syncErrorThrown))throw s.syncErrorValue;return s},n.prototype.N=function(n){try{return this.A(n)}catch(t){a.$.useDeprecatedSynchronousErrorHandling&&(n.syncErrorThrown=!0,n.syncErrorValue=t),function(n){for(;n;){var t=n,e=t.closed,i=t.destination,r=t.isStopped;if(e||r)return!1;n=i&&i instanceof o.v?i:null}return!0}(n)?n.error(t):console.warn(t)}},n.prototype.forEach=function(n,t){var e=this;return new(t=c(t))((function(t,o){var i;i=e.subscribe((function(t){try{n(t)}catch(n){o(n),i&&i.unsubscribe()}}),o,t)}))},n.prototype.A=function(n){var t=this.source;return t&&t.subscribe(n)},n.prototype[u.s]=function(){return this},n.prototype.pipe=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return 0===n.length?this:(0===(e=n).length?s:1===e.length?e[0]:function(n){return e.reduce((function(n,t){return t(n)}),n)})(this);var e},n.prototype.toPromise=function(n){var t=this;return new(n=c(n))((function(n,e){var o;t.subscribe((function(n){return o=n}),(function(n){return e(n)}),(function(){return n(o)}))}))},n.create=function(t){return new n(t)},n}();function c(n){if(n||(n=a.$.Promise||Promise),!n)throw new Error("no Promise impl found");return n}},7860:function(n,t,e){e.d(t,{I:function(){return r}});var o=e(2180),i=e(7615),r={closed:!0,next:function(n){},error:function(n){if(o.$.useDeprecatedSynchronousErrorHandling)throw n;(0,i.T)(n)},complete:function(){}}},843:function(n,t,e){e.d(t,{B7:function(){return d}});var o=e(1990),i=e(8703),r=e(4200),u=e(7216),s=e(4267),a=function(n){function t(t,e){var o=n.call(this)||this;return o.subject=t,o.subscriber=e,o.closed=!1,o}return o.C6(t,n),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var n=this.subject,t=n.observers;if(this.subject=null,t&&0!==t.length&&!n.isStopped&&!n.closed){var e=t.indexOf(this.subscriber);-1!==e&&t.splice(e,1)}}},t}(u.y),l=e(9633),c=function(n){function t(t){var e=n.call(this,t)||this;return e.destination=t,e}return o.C6(t,n),t}(r.v),d=function(n){function t(){var t=n.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return o.C6(t,n),t.prototype[l.D]=function(){return new c(this)},t.prototype.lift=function(n){var t=new f(this,this);return t.operator=n,t},t.prototype.next=function(n){if(this.closed)throw new s.P;if(!this.isStopped)for(var t=this.observers,e=t.length,o=t.slice(),i=0;i<e;i++)o[i].next(n)},t.prototype.error=function(n){if(this.closed)throw new s.P;this.hasError=!0,this.thrownError=n,this.isStopped=!0;for(var t=this.observers,e=t.length,o=t.slice(),i=0;i<e;i++)o[i].error(n);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new s.P;this.isStopped=!0;for(var n=this.observers,t=n.length,e=n.slice(),o=0;o<t;o++)e[o].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype.N=function(t){if(this.closed)throw new s.P;return n.prototype.N.call(this,t)},t.prototype.A=function(n){if(this.closed)throw new s.P;return this.hasError?(n.error(this.thrownError),u.y.EMPTY):this.isStopped?(n.complete(),u.y.EMPTY):(this.observers.push(n),new a(this,n))},t.prototype.asObservable=function(){var n=new i.c;return n.source=this,n},t.create=function(n,t){return new f(n,t)},t}(i.c),f=function(n){function t(t,e){var o=n.call(this)||this;return o.destination=t,o.source=e,o}return o.C6(t,n),t.prototype.next=function(n){var t=this.destination;t&&t.next&&t.next(n)},t.prototype.error=function(n){var t=this.destination;t&&t.error&&this.destination.error(n)},t.prototype.complete=function(){var n=this.destination;n&&n.complete&&this.destination.complete()},t.prototype.A=function(n){return this.source?this.source.subscribe(n):u.y.EMPTY},t}(d)},4200:function(n,t,e){e.d(t,{v:function(){return c}});var o=e(1990),i=e(3733),r=e(7860),u=e(7216),s=e(9633),a=e(2180),l=e(7615),c=function(n){function t(e,o,i){var u=n.call(this)||this;switch(u.syncErrorValue=null,u.syncErrorThrown=!1,u.syncErrorThrowable=!1,u.isStopped=!1,arguments.length){case 0:u.destination=r.I;break;case 1:if(!e){u.destination=r.I;break}if("object"==typeof e){e instanceof t?(u.syncErrorThrowable=e.syncErrorThrowable,u.destination=e,e.add(u)):(u.syncErrorThrowable=!0,u.destination=new d(u,e));break}default:u.syncErrorThrowable=!0,u.destination=new d(u,e,o,i)}return u}return o.C6(t,n),t.prototype[s.D]=function(){return this},t.create=function(n,e,o){var i=new t(n,e,o);return i.syncErrorThrowable=!1,i},t.prototype.next=function(n){this.isStopped||this.F(n)},t.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this.R(n))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,n.prototype.unsubscribe.call(this))},t.prototype.F=function(n){this.destination.next(n)},t.prototype.R=function(n){this.destination.error(n),this.unsubscribe()},t.prototype._=function(){this.destination.complete(),this.unsubscribe()},t.prototype.B=function(){var n=this.J;return this.J=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this.J=n,this},t}(u.y),d=function(n){function t(t,e,o,u){var s,a=n.call(this)||this;a.X=t;var l=a;return(0,i.T)(e)?s=e:e&&(s=e.next,o=e.error,u=e.complete,e!==r.I&&(l=Object.create(e),(0,i.T)(l.unsubscribe)&&a.add(l.unsubscribe.bind(l)),l.unsubscribe=a.unsubscribe.bind(a))),a.nn=l,a.F=s,a.R=o,a._=u,a}return o.C6(t,n),t.prototype.next=function(n){if(!this.isStopped&&this.F){var t=this.X;a.$.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this.F,n)&&this.unsubscribe():this.__tryOrUnsub(this.F,n)}},t.prototype.error=function(n){if(!this.isStopped){var t=this.X,e=a.$.useDeprecatedSynchronousErrorHandling;if(this.R)e&&t.syncErrorThrowable?(this.__tryOrSetError(t,this.R,n),this.unsubscribe()):(this.__tryOrUnsub(this.R,n),this.unsubscribe());else if(t.syncErrorThrowable)e?(t.syncErrorValue=n,t.syncErrorThrown=!0):(0,l.T)(n),this.unsubscribe();else{if(this.unsubscribe(),e)throw n;(0,l.T)(n)}}},t.prototype.complete=function(){var n=this;if(!this.isStopped){var t=this.X;if(this._){var e=function(){return n._.call(n.nn)};a.$.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,e),this.unsubscribe()):(this.__tryOrUnsub(e),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(n,t){try{n.call(this.nn,t)}catch(n){if(this.unsubscribe(),a.$.useDeprecatedSynchronousErrorHandling)throw n;(0,l.T)(n)}},t.prototype.__tryOrSetError=function(n,t,e){if(!a.$.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this.nn,e)}catch(t){return a.$.useDeprecatedSynchronousErrorHandling?(n.syncErrorValue=t,n.syncErrorThrown=!0,!0):((0,l.T)(t),!0)}return!1},t.prototype.tn=function(){var n=this.X;this.nn=null,this.X=null,n.unsubscribe()},t}(c)},7216:function(n,t,e){e.d(t,{y:function(){return s}});var o=e(7372),i=e(6582),r=e(3733),u=function(){function n(n){return Error.call(this),this.message=n?n.length+" errors occurred during unsubscription:\n"+n.map((function(n,t){return t+1+") "+n.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=n,this}return n.prototype=Object.create(Error.prototype),n}(),s=function(){function n(n){this.closed=!1,this.J=null,this.en=null,n&&(this.rn=!0,this.tn=n)}var t;return n.prototype.unsubscribe=function(){var t;if(!this.closed){var e=this,s=e.J,l=e.rn,c=e.tn,d=e.en;if(this.closed=!0,this.J=null,this.en=null,s instanceof n)s.remove(this);else if(null!==s)for(var f=0;f<s.length;++f)s[f].remove(this);if((0,r.T)(c)){l&&(this.tn=void 0);try{c.call(this)}catch(n){t=n instanceof u?a(n.errors):[n]}}if((0,o.c)(d)){f=-1;for(var v=d.length;++f<v;){var h=d[f];if((0,i.G)(h))try{h.unsubscribe()}catch(n){t=t||[],n instanceof u?t=t.concat(a(n.errors)):t.push(n)}}}if(t)throw new u(t)}},n.prototype.add=function(t){var e=t;if(!t)return n.EMPTY;switch(typeof t){case"function":e=new n(t);case"object":if(e===this||e.closed||"function"!=typeof e.unsubscribe)return e;if(this.closed)return e.unsubscribe(),e;if(!(e instanceof n)){var o=e;(e=new n).en=[o]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var i=e.J;if(null===i)e.J=this;else if(i instanceof n){if(i===this)return e;e.J=[i,this]}else{if(-1!==i.indexOf(this))return e;i.push(this)}var r=this.en;return null===r?this.en=[e]:r.push(e),e},n.prototype.remove=function(n){var t=this.en;if(t){var e=t.indexOf(n);-1!==e&&t.splice(e,1)}},n.EMPTY=((t=new n).closed=!0,t),n}();function a(n){return n.reduce((function(n,t){return n.concat(t instanceof u?t.errors:t)}),[])}},2180:function(n,t,e){e.d(t,{$:function(){return i}});var o=!1,i={Promise:void 0,set useDeprecatedSynchronousErrorHandling(n){n&&(new Error).stack,o=n},get useDeprecatedSynchronousErrorHandling(){return o}}},1819:function(n,t,e){e.d(t,{s:function(){return o}});var o=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}()},9633:function(n,t,e){e.d(t,{D:function(){return o}});var o=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}()},4267:function(n,t,e){e.d(t,{P:function(){return o}});var o=function(){function n(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return n.prototype=Object.create(Error.prototype),n}()},7615:function(n,t,e){function o(n){setTimeout((function(){throw n}),0)}e.d(t,{T:function(){return o}})},7372:function(n,t,e){e.d(t,{c:function(){return o}});var o=function(){return Array.isArray||function(n){return n&&"number"==typeof n.length}}()},3733:function(n,t,e){function o(n){return"function"==typeof n}e.d(t,{T:function(){return o}})},6582:function(n,t,e){function o(n){return null!==n&&"object"==typeof n}e.d(t,{G:function(){return o}})},1990:function(n,t,e){e.d(t,{C6:function(){return i}});var o=function(n,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var e in t)t.hasOwnProperty(e)&&(n[e]=t[e])},o(n,t)};function i(n,t){function e(){this.constructor=n}o(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}},334:function(n,t,e){e.d(t,{Cl:function(){return o},Ju:function(){return u},YH:function(){return r},fX:function(){return a},sH:function(){return i},zs:function(){return s}});var o=function(){return o=Object.assign||function(n){for(var t,e=1,o=arguments.length;e<o;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n},o.apply(this,arguments)};function i(n,t,e,o){return new(e||(e=Promise))((function(i,r){function u(n){try{a(o.next(n))}catch(n){r(n)}}function s(n){try{a(o.throw(n))}catch(n){r(n)}}function a(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(u,s)}a((o=o.apply(n,t||[])).next())}))}function r(n,t){var e,o,i,r,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(a){return function(s){if(e)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(u=0)),u;)try{if(e=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return u.label++,{value:s[1],done:!1};case 5:u.label++,o=s[1],s=[0];continue;case 7:s=u.ops.pop(),u.trys.pop();continue;default:if(!((i=(i=u.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){u=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){u.label=s[1];break}if(6===s[0]&&u.label<i[1]){u.label=i[1],i=s;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(s);break}i[2]&&u.ops.pop(),u.trys.pop();continue}s=t.call(n,u)}catch(n){s=[6,n],o=0}finally{e=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}function u(n){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&n[t],o=0;if(e)return e.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&o>=n.length&&(n=void 0),{value:n&&n[o++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function s(n,t){var e="function"==typeof Symbol&&n[Symbol.iterator];if(!e)return n;var o,i,r=e.call(n),u=[];try{for(;(void 0===t||t-- >0)&&!(o=r.next()).done;)u.push(o.value)}catch(n){i={error:n}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(i)throw i.error}}return u}function a(n,t,e){if(e||2===arguments.length)for(var o,i=0,r=t.length;i<r;i++)!o&&i in t||(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return n.concat(o||Array.prototype.slice.call(t))}Object.create,Object.create},4999:function(n,t,e){var o;e.d(t,{Y:function(){return o}}),function(n){n.blurFocus="blurFocus",n.boot="boot",n.completeCreateNew="completeCreateNew",n.continueAccessibilityLoop="continueAccessibilityLoop",n.createNew="createNew",n.dispose="dispose",n.grabFocus="grabFocus",n.moveToFolder="moveToFolder",n.popState="popState",n.sendChannelId="sendChannelId",n.sendConvId="sendConvId",n.teamsUsersReply="teamsUsersReply",n.teamsUserMentionReply="teamsUserMentionReply",n.backButtonPressed="backButtonPressed",n.getClientUrl="getClientUrl",n.getWebUrl="getWebUrl",n.rename="rename",n.completeSharedFilePicker="completeSharedFilePicker",n.sendAccessToken="sendAccessToken",n.sendAuthToken="sendAuthToken",n.sendCustomAuthConfig="sendCustomAuthConfig",n.sendEmbeddedViewUrl="sendEmbeddedViewUrl",n.sendFrameTrustResult="sendFrameTrustResult",n.sendHWRTelemetry="sendHWRTelemetry",n.sendSessionInfo="sendSessionInfo",n.sendUserAccessAndPermissions="sendUserAccessAndPermissions",n.sendWopiInfo="sendWopiInfo",n.sendDavUrl="sendDavUrl",n.switchMode="switchMode",n.signalShared="signalShared",n.postWacToken="postWacToken"}(o||(o={}))},8970:function(n,t,e){var o;e.d(t,{Jf:function(){return v}}),function(n){n[n.Trace=0]="Trace",n[n.Assert=1]="Assert"}(o||(o={}));var i=e(2808);var r=1e3;var u=e(7070),s="###VERSION###";var a,l,c=function(){function n(n){var t=this;this.un=3e4,this.sn=30,this.an=0,this.ln=[],this.cn=(0,u.u_)(),this.dn=[],this.fn="",this.vn=0,this.flushOnClose=function(){t.hn(!1,!1)},this.flush=function(){t.pn()},this.flushAndSetNewEndpoint=function(n,e){var o,i=t.mn(n);i.localeCompare(null!==(o=t.wn)&&void 0!==o?o:"",void 0,{sensitivity:"accent"})&&(t.dn.push((function(){t.wn=i,e&&e()})),t.hn(!0,!0))},this.mn=function(n){return n+"?usid="+t.fn+"&officeserverversion="+function(){try{return"20240529.1"}catch(n){return s}}()},this.pn=function(){window.setTimeout((function(){return t.hn(!0,!0)}),0)},this.hn=function(n,e){var o,i,s,a,l,c,d,f=(0,u.Wv)();window.clearTimeout(t.gn),t.wn&&(t.ln.length>0&&(t.an+=1,function(n,t,e){if(t){var o=window.navigator;if(o&&o.sendBeacon)try{return void o.sendBeacon(t,n)}catch(n){}!function(n,t,e){var o=new XMLHttpRequest;o.readyState!==XMLHttpRequest.UNSENT&&o.readyState!==XMLHttpRequest.DONE||(o.open("POST",t,e),o.send(n))}(n,t,e)}}((o=t.ln.splice(0,n?t.sn:t.ln.length),i=t.fn,s=t.an,a=t.cn,l=[],c=o.map((function(n){return function(n,t,e){var o={};if(o.G=n.tag,o.T=n.timestamp-t,o.M=n.message,o.C=n.category,n.correlationId){var i=e.findIndex((function(t){return t===n.correlationId}));i<0&&(i=e.push(n.correlationId)-1),o.I=i}var u=n.type*r+n.level;return o.D=u,o}(n,a,l)})),d=function(n,t,e,o,i){var r={};return r.T=n,r.L=t,r.S=e,r.I=o,i&&i.length>0&&(r.W=i),r.V=1,r}(a,c,i,s,l),JSON.stringify(d)),t.wn,e),t.cn=(0,u.u_)()),0===t.ln.length&&t.dn.length>0&&(t.dn.forEach((function(n){"requestIdleCallback"in window?window.requestIdleCallback(n):window.setTimeout(n,0)})),t.dn=[]),n&&(t.gn=window.setTimeout((function(){t.pn()}),t.ln.length>t.sn||t.dn.length>0?1e3:t.un)),t.vn+=(0,u.Wv)()-f)},n&&this.configure(n)}return n.prototype.getTimeSpentLogging=function(){return this.vn},n.prototype.addLoggingTime=function(n){this.vn+=n},n.prototype.configure=function(n){var t=(0,u.Wv)();if(n.uploadCadenceInMs&&(this.un=n.uploadCadenceInMs),n.uploadTriggerSize&&(this.sn=n.uploadTriggerSize),n.sessionId&&(this.fn=n.sessionId),n.remoteUlsEndpoint){if(!n.sessionId&&this.wn)throw new Error("Remote ULS endpoint is already set");this.wn=this.mn(n.remoteUlsEndpoint),this.cn=(0,u.u_)(),this.pn()}this.vn+=(0,u.Wv)()-t},n.prototype.handleTrace=function(n){var t=(0,u.Wv)();n.message.length>3072&&(n.message=n.message.substring(0,3059)+"... [Trimmed]"),this.ln.push(n),(this.ln.length>this.sn||n.level===i.k.Error)&&this.pn(),this.vn+=(0,u.Wv)()-t},n.prototype.getUserSessionId=function(){return this.fn},n}(),d=[];!function(n){n.Sn="BootstrapperMaxUlsHeartbeatTime",n.Hn="BootstrapperNoCompleteWarning1Time",n.Cn="BootstrapperNoCompleteWarning2Time",n.In="RemoteUlsETag",n.An="RemoteUlsSuppressions",n.yn="BootstrapperSettingsFetchPeriod",n.Un="timestamp",n.Tn="BootstrapperUlsHeartbeatIntervalMs",n.Pn="BootstrapperUlsHeartBeatIsEnabled",n.kn="BootstrapperUlsUploadCadenceMs",n.Nn="WordConsumptionViewToEditRedirectIsEnabled",n.En="RequestedCallThrottlingDefaultToViewMinimumValue",n.Wn="BulsEndpointUrl",n.Fn="EnableCommonHostDiagnosticsParams",n.Rn="EnableICNForWord",n.Dn="EnableModernEmbedViewForPowerPoint",n.On="EnableModernEmbedViewInOneUpForPowerPoint",n.jn="EnableModernEmbedViewForPowerPointGlobalAppUrl",n._n="EnableModernReadingViewForPowerPoint",n.Bn="EnableDefaultToModernForPowerPoint",n.xn="ShouldLogJsApiKpisForWord",n.Ln="WordSwitchToViewInTeamsJsapiV1Enabled",n.Kn="EnableWordSessionRefreshTelemetry",n.Vn="PowerPointUseEssDCHint",n.Gn="ModernEmbedViewBootstrapperFeatureGatesForPowerPoint",n.Jn="ModernReadingViewBootstrapperFeatureGatesForPowerPoint",n.qn="ModernEmbedViewForPowerPointEnabledPercentage",n.zn="PowerPointESSCookieLookbackThresholdHour",n.Zn="PowerPointSetESSCookieLookbackExpEnabled",n.Qn="ExcelForceViewOnlyInTeamsJsapiV1"}(l||(l={}));var f=6e4;function v(n){var t=new c(n);function e(n,e,i,r){var s=(0,u.Wv)();if(!function(n){return 1===d[n]}(n)){var a={timestamp:(0,u.u_)(),category:e,tag:n,level:i,type:o.Trace,message:r,correlationId:""};t.addLoggingTime((0,u.Wv)()-s),t.handleTrace(a)}}return{ULS:{sendTraceTag:function(n,t,o,i){e(n,t,o,i)},shipAssertTag:function(n,t,o,r){o&&e(n,t,i.k.Error,r)},debugAssertTag:function(n,t,e,o){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:t.flush,flushOnClose:t.flushOnClose,setCorrelationId:function(){}},configure:function(n){t.configure(n)},settingsChangeHandler:function(n){var e,o;e=n.Xn.getValue(l.An,""),o=n.Xn.getValue(l.In,""),a&&o===a||(d=[],a=o,e&&e.split(",").forEach((function(n){var t=parseInt(n,10);t&&(d[t]=1)}))),t.configure({uploadCadenceInMs:n.Xn.getValue(l.kn,f)});var i=n.Xn.getValue(l.Wn,"").toString();""!==i&&t.flushAndSetNewEndpoint(i)},getTimeSpentLogging:function(){return t.getTimeSpentLogging()},getUserSessionId:function(){return t.getUserSessionId()},flushAndSetNewEndpoint:function(n,e){t.flushAndSetNewEndpoint(n,e)}}}},2463:function(n,t,e){e.d(t,{O:function(){return r}});var o=e(334);function i(n){if(!n)return"";var t=Object.getOwnPropertyNames(n),e=Object.getOwnPropertyNames(Object.getPrototypeOf(n));return JSON.stringify(n,(0,o.fX)((0,o.fX)([],t,!0),e,!0))}function r(){var n=new Uint8Array(31),t=function(n){var t={crypto:!1,perfNow:!1,exceptions:[]},e=window.crypto||window.msCrypto;if(e){t.crypto=!0;try{return e.getRandomValues(n),t}catch(n){t.exceptions.push("crypto: ".concat(i(n)))}}t.perfNow=!0;for(var o=0;o<n.length;o+=1){try{var r=Math.floor(100*window.performance.now())%10;(r<0||r>9)&&(r=0);for(var u=0;u<r;u+=1)Math.random()}catch(n){t.exceptions.push("Math.random: ".concat(i(n)))}n[o]=Math.floor(16*Math.random())}return t}(n),e=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var o=15&n[e];return e+=1,("x"===t?o:3&o|8).toString(16)})),t]}},7070:function(n,t,e){function o(){return window.performance.now()}function i(){return Math.round(window.performance.now()+window.performance.timeOrigin)}function r(n){Array.isArray(n)?n.forEach((function(n){window.performance.mark(n)})):window.performance.mark(n)}e.d(t,{Wv:function(){return o},l8:function(){return r},u_:function(){return i}})},4947:function(n,t,e){e.d(t,{v:function(){return o}});var o,i=e(3238),r=e(334),u=function(){function n(){this.blockedEvents=new Map,this.eventHitCounts=new Map,this.eventDurations=new Map,this.eventDurationsTotal=new Map}return n.prototype.isEventBlocked=function(n){var t=this.blockedEvents.get(n);return!!t&&(Date.now()>=t?(this.unblockEvent(n),!1):(this.aggregateEventCount(n),!0))},n.prototype.blockEvent=function(n,t){var e=Date.now()+t;this.blockedEvents.set(n,e),this.updateEventHitCount(n,0),this.eventDurations.delete(n),this.eventDurationsTotal.delete(n)},n.prototype.unblockEvent=function(n){this.blockedEvents.delete(n)},n.prototype.getEventHitCount=function(n){return this.eventHitCounts.get(n)},n.prototype.updateEventHitCount=function(n,t){this.eventHitCounts.set(n,t)},n.prototype.aggregateEventCount=function(n){var t=this.getEventHitCount(n);"number"==typeof t&&this.updateEventHitCount(n,++t)},n.prototype.getEventDurations=function(n){return this.eventDurations.get(n)},n.prototype.aggregateEventDuration=function(n,t){var e,o=(null!==(e=this.getEventHitCount(n))&&void 0!==e?e:0)+1,i=this.eventDurationsTotal.get(n),u=this.eventDurations.get(n);if(void 0!==u){var s=(0,r.fX)([],u,!0);u[0]>t&&(s[0]=t),u[1]<t&&(s[1]=t);var a=void 0;void 0!==i&&i.length<10?(i.push(t),a=i.reduce((function(n,t){return n+t}),0)/o):(a=u[2]+(t-u[2])/o,this.eventDurationsTotal.delete(n)),s[2]=a,this.eventDurations.set(n,s)}else this.eventDurations.set(n,[t,t,t]),this.eventDurationsTotal.set(n,[t])},n}(),s=function(){function n(n,t,e,o,i){this.healthLogger=n,this.featureConfig=t,this.kpiUsageEventBlocker=e,this.kpiFailureEventBlocker=o,this.kpiSuccessEventBlocker=i}return n.prototype.logKpiUsage=function(t,e,o,i){var r=this.getKpiKey(t+n.USAGE_KPI,null==o?void 0:o.extendedProperties);if(this.kpiUsageEventBlocker.isEventBlocked(r))return!1;if(this.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(o),this.recordKpiUsage(t,e,o,r),0!==i){var u=null!=i?i:3e5;this.kpiUsageEventBlocker.blockEvent(r,u)}return!0},n.prototype.logKpiFailure=function(t,e,o,i,r){var u,s,a,l=this.getKpiKey(t+n.FAILURE_KPI+e,null===(u=null==o?void 0:o.additionalValues)||void 0===u?void 0:u.extendedProperties);if("number"==typeof(null===(s=null==o?void 0:o.additionalValues)||void 0===s?void 0:s.durationMs)&&this.kpiFailureEventBlocker.aggregateEventDuration(l,o.additionalValues.durationMs),this.kpiFailureEventBlocker.isEventBlocked(l))return!1;if(this.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(),this.recordKpiFailure(t,e,o,l),i&&this.recordQosError(null!==(a=i.errorNameOverride)&&void 0!==a?a:e,i.name,i),0!==r){var c=null!=r?r:3e5;this.kpiFailureEventBlocker.blockEvent(l,c)}return!0},n.prototype.logKpiSuccess=function(t,e,o){var i,r,u=this.getKpiKey(t+n.SUCCESS_KPI,null===(i=null==e?void 0:e.additionalValues)||void 0===i?void 0:i.extendedProperties);if("number"==typeof(null===(r=null==e?void 0:e.additionalValues)||void 0===r?void 0:r.durationMs)&&this.kpiSuccessEventBlocker.aggregateEventDuration(u,e.additionalValues.durationMs),this.kpiSuccessEventBlocker.isEventBlocked(u))return!1;if(this.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(),this.recordKpiSuccess(t,e,u),0!==o){var s=null!=o?o:3e5;this.kpiSuccessEventBlocker.blockEvent(u,s)}return!0},n.prototype.ensureFeatureDenominatorLoggedAndVetoPillarRegistered=function(t){var e,i=this.featureConfig.topLevelKpiName,r=this.getKpiKey(this.featureConfig.topLevelKpiName,null==t?void 0:t.extendedProperties);if(!this.kpiUsageEventBlocker.isEventBlocked(null!=r?r:"")){this.recordKpiUsage(i,o.FailureBased,t);var u=null!==(e=this.featureConfig.vetoPillar)&&void 0!==e?e:this.featureConfig.areaName;u&&n.QOS_PILLARS_LIST.includes(u)&&this.healthLogger.addQosPillar(u),this.kpiUsageEventBlocker.blockEvent(null!=r?r:"",864e5)}},n.prototype.recordKpiUsage=function(n,t,e,o){void 0===e&&(e={});var i=e||{},r=i.extendedProperties,u=i.isForAlertableKpi,s=this.createExtendedPropertiesWithMoreFields(r,o);u?this.healthLogger.recordKpiUsageForAlertableKpi(n,this.featureConfig.crewAlias,s):this.healthLogger.recordKpiUsage(n,t,this.featureConfig.crewAlias,s)},n.prototype.getKpiKey=function(n,t){var e=this.getKpiAreaName(t),o=this.getKpiFeatureName(t),i=this.getKpiPivot(t);return"".concat(e,".").concat(o,".").concat(null!=n?n:"").concat(i&&0===i.length?"."+i:"")},n.prototype.getKpiAreaName=function(t){var e,o,i;return null!==(i=null!==(o=null!==(e=null==t?void 0:t.get(n.AREA_NAME_COLUMN_KEY))&&void 0!==e?e:this.featureConfig.areaName)&&void 0!==o?o:this.featureConfig.vetoPillar)&&void 0!==i?i:""},n.prototype.getKpiFeatureName=function(t){var e,o;return null!==(o=null!==(e=null==t?void 0:t.get(n.FEATURE_NAME_COLUMN_KEY))&&void 0!==e?e:this.featureConfig.featureName)&&void 0!==o?o:""},n.prototype.getKpiPivot=function(t){var e=null==t?void 0:t.get(n.PIVOT_TYPE_COLUMN_KEY),o=null==t?void 0:t.get(n.PIVOT_VALUE_COLUMN_KEY);return e&&0!==e.length&&o&&0!==o.length?"".concat(e,"=").concat(o):""},n.prototype.recordKpiFailure=function(n,t,e,o){void 0===e&&(e={});var i=e||{},r=i.isIntentional,u=i.isInternal,s=i.additionalValues,a=i.hasImpliedUsage,l=this.createAdditionalValuesWithMoreFields(s,o);!1===a?this.healthLogger.recordKpiFailure(n,t,r,u,l):this.healthLogger.recordKpiImpliedFailure(n,t,r,u,this.featureConfig.crewAlias,l)},n.prototype.recordKpiSuccess=function(n,t,e){void 0===t&&(t={});var o=t||{},i=o.additionalValues,r=o.hasImpliedUsage,u=this.createAdditionalValuesWithMoreFields(i,e);!1===r?this.healthLogger.recordKpiSuccess(n,u):this.healthLogger.recordKpiImpliedSuccess(n,this.featureConfig.crewAlias,u)},n.prototype.recordQosError=function(n,t,e){void 0===e&&(e={});var o=e.isIntentional,i=e.isInternal,r=e.alertOnPillar,u=e.isSessionEndingError,s=e.additionalValues,a=this.createAdditionalValuesWithMoreFields(s);this.healthLogger.recordQosError(n,[t],o,i,r,u,a)},n.prototype.createExtendedPropertiesWithMoreFields=function(t,e){var o=new Map(t||new Map);if(o.get(n.FEATURE_NAME_COLUMN_KEY)||o.set(n.FEATURE_NAME_COLUMN_KEY,this.getKpiFeatureName(t)),o.set(n.AREA_NAME_COLUMN_KEY,this.getKpiAreaName(o)),o.has(n.SKIP_ARIA_COLUMN_KEY)||o.has("skipAria")||o.set(n.SKIP_ARIA_COLUMN_KEY,"true"),!this.featureConfig.doNotEmitAggregatedCount&&e){var i=this.getEventBlocker(e);if(i){var r=i.getEventHitCount(e);if(r){o.set(n.AGGREGATED_COUNT_COLUMN_KEY,r.toString());var u=i.getEventDurations(e);r>1&&u&&o.set(n.AGGREGATED_DURATION_COLUMN_KEY,u.map((function(n){return Math.round(100*n)/100})).toString())}}}return o},n.prototype.createAdditionalValuesWithMoreFields=function(n,t){var e={};return(e=(0,r.Cl)({},n)).extendedProperties=this.createExtendedPropertiesWithMoreFields(null==n?void 0:n.extendedProperties,t),e},n.prototype.getEventBlocker=function(t){return t.endsWith(n.USAGE_KPI)?this.kpiUsageEventBlocker:t.includes(n.FAILURE_KPI)?this.kpiFailureEventBlocker:t.endsWith(n.SUCCESS_KPI)?this.kpiSuccessEventBlocker:void 0},n.FEATURE_NAME_COLUMN_KEY="FeatureName",n.AREA_NAME_COLUMN_KEY="AreaName",n.AGGREGATED_COUNT_COLUMN_KEY="AggCount",n.AGGREGATED_DURATION_COLUMN_KEY="AggMs",n.SKIP_ARIA_COLUMN_KEY="SkipAria",n.PIVOT_TYPE_COLUMN_KEY="PivotType",n.PIVOT_VALUE_COLUMN_KEY="PivotValue",n.QOS_PILLARS_LIST=["Interruptions","Open","NotebookNavigation","Fidelity","AsyncCollab","Present","ContentConsumption","bSqmCompatibility","Boot"],n.USAGE_KPI=".Usage",n.SUCCESS_KPI=".Success",n.FAILURE_KPI=".Failure.",n}(),a=function(){function n(t,e,i,u,a){var l,c,d,f=this;this.healthLogger=t,this.featureConfig=e,this.kpiUsageEventBlocker=i,this.kpiFailureEventBlocker=u,this.kpiSuccessEventBlocker=a,this.featureUsageAndHealthLogger=new s(this.healthLogger,this.featureConfig,null!==(l=this.kpiUsageEventBlocker)&&void 0!==l?l:n.kpiUsageBlocker,null!==(c=this.kpiSuccessEventBlocker)&&void 0!==c?c:n.kpiFailureBlocker,null!==(d=this.kpiFailureEventBlocker)&&void 0!==d?d:n.kpiSuccessBlocker),this.executeCallbackWithLogging=function(n,t){var e,i,u,s=function(n){return"VetoFailureLoggingParams".includes(n)};(null==t?void 0:t.kpiUsageLoggingParams)?(i="Usage",u=null==t?void 0:t.kpiUsageLoggingParams):(null==t?void 0:t.kpiSuccessLoggingParams)?(i="UsageWithSuccess",u=null==t?void 0:t.kpiSuccessLoggingParams):(null==t?void 0:t.kpiFailureLoggingParams)?(i="UsageWithFailure",u=null==t?void 0:t.kpiFailureLoggingParams):(i="UsageWithVetoFailure",u=null==t?void 0:t.vetoFailureLoggingParams);var a=null==u?void 0:u.usageName,l=null==u?void 0:u.usageKpiType;f.logKpiUsage({kpiName:a,kpiType:null!=l?l:o.FailureBased});try{null==n||n(),"UsageWithSuccess"===i&&"KpiSuccessLoggingParams".includes(u)&&f.logKpiSuccess({kpiName:a,optionalProperties:u.successOptionalProperties})}catch(n){if("UsageWithFailure"===i&&"KpiFailureLoggingParams".includes(u)||"UsageWithVetoFailure"===i&&s(u)){var c=void 0;s(u)&&(c=(0,r.Cl)({name:null!==(e=u.vetoName)&&void 0!==e?e:""},u.vetoOptionalProperties)),f.logKpiFailure({kpiName:u.usageName,errorName:u.failureErrorName,optionalProperties:u.failureOptionalProperties,optionalVeto:c})}throw n}}}return n.getInstance=function(t,e,o,i,r){return new n(t,e,o,i,r)},n.prototype.logKpiUsage=function(n){var t;return!(!n||!n.kpiName)&&this.featureUsageAndHealthLogger.logKpiUsage(n.kpiName,null!==(t=n.kpiType)&&void 0!==t?t:o.FailureBased,n.optionalProperties,n.blockFutureEmissionDurationInMs)},n.prototype.logKpiFailure=function(n){return!!(n&&n.kpiName&&n.errorName)&&this.featureUsageAndHealthLogger.logKpiFailure(n.kpiName,n.errorName,n.optionalProperties,n.optionalVeto,n.blockFutureEmissionDurationInMs)},n.prototype.logKpiSuccess=function(n){return!(!n||!n.kpiName)&&this.featureUsageAndHealthLogger.logKpiSuccess(n.kpiName,n.optionalProperties,n.blockFutureEmissionDurationInMs)},n.prototype.ensureFeatureDenominatorLoggedAndVetoPillarRegistered=function(n){this.featureUsageAndHealthLogger.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(n)},n.kpiUsageBlocker=new u,n.kpiFailureBlocker=new u,n.kpiSuccessBlocker=new u,n}(),l=function(){function n(){}return n.prototype.getHealthInstance=function(n){if(n)return i.Xk.getInstance().initialize(n),i.Xk.getInstance()},n.prototype.getExtendedHealthInstance=function(n,t){if(n&&t)return a.getInstance(n,t)},n}();!function(n){n[n.FailureBased=0]="FailureBased",n[n.SuccessBased=1]="SuccessBased"}(o||(o={})),new l},3238:function(n,t,e){e.d(t,{Xk:function(){return v}});var o,i=e(334);function r(n){if(n){var t={};return n.forEach((function(n,e){e&&(t[e]=n)})),t}}function u(n,t){var e=[],o=new Set;return n.concat(t).forEach((function(n){return o.add(n)})),o.forEach((function(n){return e.push(n)})),e}!function(n){n[n.Failure=0]="Failure",n[n.ImpliedUsageFailure=1]="ImpliedUsageFailure",n[n.ImpliedUsageSuccess=2]="ImpliedUsageSuccess",n[n.Success=3]="Success",n[n.Usage=4]="Usage"}(o||(o={}));var s,a,l,c,d,f=e(4947);!function(n){n[n.BSqmError=0]="BSqmError",n[n.Kpi=1]="Kpi",n[n.QosError=2]="QosError",n[n.QosPillar=3]="QosPillar",n[n.DiagnosticLog=4]="DiagnosticLog",n[n.OfflineWorkerInit=5]="OfflineWorkerInit",n[n.OfflineWorkerFlush=6]="OfflineWorkerFlush",n[n.OfflineWorkerFailedUpload=7]="OfflineWorkerFailedUpload"}(s||(s={})),function(n){n.HealthDimensions="d",n.PartCDimensions="a",n.BSqmErrors="b",n.QosErrors="e",n.Heartbeat="h",n.QosPillars="q",n.Kpis="k",n.DiagnosticLogs="l",n.ClientSendTime="t"}(a||(a={})),function(n){n[n.AttemptToUseFunctionalityBeforeIitialization=0]="AttemptToUseFunctionalityBeforeIitialization",n[n.WorkerApiIsNotAvailable=1]="WorkerApiIsNotAvailable",n[n.InvalidWorkerUrl=2]="InvalidWorkerUrl",n[n.InstallingOfflineWorker=3]="InstallingOfflineWorker",n[n.OfflineWorkerMessage=4]="OfflineWorkerMessage",n[n.FailedToProcessMessageFromOfflineWorker=5]="FailedToProcessMessageFromOfflineWorker",n[n.FailedToInstallOfflineWorker=6]="FailedToInstallOfflineWorker",n[n.InitializedHealth=7]="InitializedHealth",n[n.BatchesOfHealthEventsInIndexedDB=8]="BatchesOfHealthEventsInIndexedDB",n[n.IndexedDbTransactionFailed=9]="IndexedDbTransactionFailed",n[n.InstalledOfflineWorker=10]="InstalledOfflineWorker",n[n.IndexedDdIsNotSupported=11]="IndexedDdIsNotSupported",n[n.GetAllKeysIsNotSupported=12]="GetAllKeysIsNotSupported",n[n.FailedToProcessMessage=13]="FailedToProcessMessage",n[n.FailedToLoadWorkerScript=14]="FailedToLoadWorkerScript",n[n.FailedToSendEventToWorker=15]="FailedToSendEventToWorker",n[n.FailedToJsonStringifyEvent=16]="FailedToJsonStringifyEvent",n[n.IndexedDbEntryIsNotAnObject=17]="IndexedDbEntryIsNotAnObject"}(l||(l={})),function(n){n[n.AttemptedToAddOrUpdatePartCDimension=0]="AttemptedToAddOrUpdatePartCDimension",n[n.AttemptedToRecordBSqmQosError=1]="AttemptedToRecordBSqmQosError",n[n.AttemptedToRecordSessionEndingQosError=2]="AttemptedToRecordSessionEndingQosError",n[n.AttemptedToSetAppOnlineStatus=3]="AttemptedToSetAppOnlineStatus",n[n.AttemptedToUpdatePartADimensions=4]="AttemptedToUpdatePartADimensions"}(c||(c={})),function(n){n[n.SendSucceeded=0]="SendSucceeded",n[n.SendFailed=1]="SendFailed",n[n.DidNotAttempt=2]="DidNotAttempt"}(d||(d={}));var v=function(){function n(){var n=this;this.Yn={},this.$n={},this.nt=[],this.tt={},this.et=0,this.ot={it:3e5,rt:!1,ut:!1,st:!1,ct:3e4,dt:25,ft:"",vt:864e5,ht:"",wt:"",bt:3,gt:3,St:15e3,Ht:new Set},this.Ct=!1,this.It=-1,this.At=!1,this.yt=0,this.Ut=!0,this.Tt=function(){return!1},this.Pt={},this.kt=[],this.Nt=0,this.Et=0,this.Wt=void 0,this.Ft=[],this.Dt=[],this.Ot=[],this.jt=[],this._t=0,this.Bt=0,this.xt=0,this.Lt=[],this.Kt=!1,this.Vt=0,this.Gt=!1,this.Jt=function(){n._t&&(window.clearTimeout(n._t),n._t=0)},this.qt=function(){n.kt=[],n.Ft=[],n.Dt=[],n.Wt=void 0,n.Ot=[],n.jt=[],n.Nt=0,n.Et=0},this.zt=function(){try{if(n.Nt<=0)return;var t=n.Zt();n.Qt(t,n.et,n.ot.gt),n.qt()}catch(n){}},this.Zt=function(){return{d:n.tt,a:n.Xt(),b:n.kt,e:n.Dt,h:n.Wt,q:n.Ot,k:n.Ft,l:n.jt,type:"h_v2"}},this.Xt=function(){return n.ot.st&&(n.kt&&n.kt.length>0||n.Dt&&n.Dt.length>0)&&Object.keys(n.$n).length>0?(0,i.Cl)((0,i.Cl)({},n.Yn),n.$n):n.Yn},this.Yt=function(t,e,o,i){var r;if(void 0===i&&(i=!1),e&&!n.ot.Ht.has(o))if(n.Ut){switch(t){case s.BSqmError:n.kt.push(e);break;case s.Kpi:n.Ft.push(e);break;case s.QosError:n.Dt.push(e);break;case s.QosPillar:-1===n.Ot.map((function(n){return n.n})).indexOf(e.n)&&n.Ot.push(e);break;case s.DiagnosticLog:n.jt.push(e)}if(n.Nt+=1,t!==s.DiagnosticLog&&t!==s.QosPillar&&(n.Et+=1),n.Tt()&&!i)return void n.zt();n.Nt>=n.ot.dt&&(n.Jt(),n.$t())}else e.o=(new Date).toJSON(),null===(r=n.ne)||void 0===r||r.postMessage({t,k:"".concat(n.tt.w,".").concat(n.et),m:n.tt,c:n.Xt(),v:e})},this.te=function(){n.Jt(),n._t=window.setTimeout((function(){n.$t()}),n.ot.ct)},this.$t=function(t){void 0===t&&(t=!1),t&&n.Et<=0||(n.zt(),n.te())},this.ee=function(){if(n.Lt||n.Pt){n.Wt&&-1!==n.It||(n.It=(n.It+1)%1e3),n.Wt||(n.Nt+=1);var t={p:n.Wt?u(n.Wt.p,n.Lt):n.Lt,k:n.Wt?u(n.Wt.k,n.nt):n.nt,i:n.ot.it,o:n.It};n.Wt=t}},this.oe=function(t,e,o,i,u,a,l,c,d,f){if(t&&(!e||n.Pt[t])){e||n.ie(t,c,d,f);var v=n.Pt[t],h={n:v.k,e:o,t:v.t,a:v.a,f:v.o,d:null==i?void 0:i.durationMs,p:r(null==i?void 0:i.extendedProperties)};if(u){var p={n:u,x:l,z:a};h.k=p}n.Yt(s.Kpi,h,t)}},this.re=function(){var t,e,o,i,r,u,s,a,l,c,d,f,v,h,p,m,w,b,g,S,H,C,I,A,y,U,T,P,k,N,E,W,F,R,D,O,j,M=n.ot.tt;M&&(n.tt={a:null!==(t=M.application)&&void 0!==t?t:void 0,b:null!==(e=M.applicationLcid)&&void 0!==e?e:void 0,c:null!==(o=M.applicationMode)&&void 0!==o?o:void 0,d:null!==(i=M.applicationModeExtended)&&void 0!==i?i:void 0,e:null!==(r=M.arrVersion)&&void 0!==r?r:void 0,f:null!==(u=M.browser)&&void 0!==u?u:void 0,g:null!==(s=M.browserLcid)&&void 0!==s?s:void 0,h:null!==(a=M.browserMajorVersion)&&void 0!==a?a:void 0,i:null!==(l=M.browserVersion)&&void 0!==l?l:void 0,j:null!==(c=M.clientVersion)&&void 0!==c?c:void 0,k:null!==(d=M.datacenter)&&void 0!==d?d:void 0,l:null!==(f=M.dataCulture)&&void 0!==f?f:void 0,m:null!==(v=M.flightsImpressionId)&&void 0!==v?v:void 0,n:null!==(h=M.host)&&void 0!==h?h:void 0,o:null!==(p=M.isAnonymousUser)&&void 0!==p?p:void 0,p:null!==(m=M.isBusinessUser)&&void 0!==m?m:void 0,q:null!==(w=M.isEduUser)&&void 0!==w?w:void 0,r:null!==(b=M.isSynthetic)&&void 0!==b?b:void 0,s:null!==(g=M.loggableUserId)&&void 0!==g?g:void 0,t:null!==(S=M.loggableUserIdSpace)&&void 0!==S?S:void 0,u:null!==(H=M.ring)&&void 0!==H?H:void 0,v:null!==(C=M.serverDocId)&&void 0!==C?C:void 0,w:null!==(I=M.session_id)&&void 0!==I?I:void 0,x:null!==(A=M.sessionOrigin)&&void 0!==A?A:void 0,y:null!==(y=M.tenantId)&&void 0!==y?y:void 0,z:null!==(U=M.uiHost)&&void 0!==U?U:void 0,aa:null!==(T=M.wfeVersion)&&void 0!==T?T:void 0,ab:null!==(P=M.fileExtension)&&void 0!==P?P:void 0,ac:null!==(k=M.uiHostIntegrationType)&&void 0!==k?k:void 0,ad:null!==(N=M.osVersion)&&void 0!==N?N:void 0,af:null!==(E=M.networkDownlink)&&void 0!==E?E:void 0,ag:null!==(W=M.networkDownlinkMax)&&void 0!==W?W:void 0,ah:null!==(F=M.networkEffectiveType)&&void 0!==F?F:void 0,ai:null!==(R=M.networkRTT)&&void 0!==R?R:void 0,aj:null!==(D=M.networkSaveData)&&void 0!==D?D:void 0,ak:null!==(O=M.networkType)&&void 0!==O?O:void 0,al:null!==(j=M.userLicenseType)&&void 0!==j?j:void 0})},this.ue=function(){n.ee(),n.yt=window.setTimeout((function(){n.ue()}),n.ot.it)},this.se=function(){n.Lt&&n.Lt.forEach((function(t){t&&n.ae(t,!0)}))},this.ae=function(t,e){var o={};o.n=t,n.Yt(s.QosPillar,o,t,e)},this.le=function(){n.Lt&&(n.Bt=Date.now(),n.se()),n.ce()},this.ce=function(t){void 0===t&&(t=n.ot.vt),n.xt=window.setTimeout((function(){n.le()}),t)},this.de=function(){n.Ct||(n.Ct=!0,n.At=!0,n.ue())},this.fe=function(){0!==n.xt&&(window.clearTimeout(n.xt),n.xt=0)},this.ve=function(){if(n.ot.rt&&n.ot.ut&&n.ot.wt&&""!==n.ot.wt&&n.ot.ft&&""!==n.ot.ft)try{if("undefined"==typeof Worker)return void n.he(l.WorkerApiIsNotAvailable);if(!n.ot.ft)return void n.he(l.InvalidWorkerUrl);n.he(l.InstallingOfflineWorker);var t=new Blob(["try{importScripts('".concat(encodeURI(n.ot.ft),"');}catch(e){self.postMessage({i:14,l:'W',r:e.toString()})}")],{type:"application/javascript"});n.ne=new Worker(URL.createObjectURL(t)),n.ne.onmessage=function(t){try{var e=t.data;n.he(e.i,e.r)}catch(t){n.he(l.FailedToProcessMessageFromOfflineWorker,t.toString())}},n.ne.postMessage({t:s.OfflineWorkerInit,v:n.ot.wt}),n.ne.postMessage({t:s.OfflineWorkerFlush})}catch(t){n.he(l.FailedToInstallOfflineWorker,t.toString())}},this.pe=function(t,e){var o;if(t.b.length>0||t.e.length>0||t.q.length>0||t.k.length>0||t.l.length>0)try{return null===(o=n.ne)||void 0===o||o.postMessage({t:s.OfflineWorkerFailedUpload,k:"".concat(t.d.w,".").concat(e),v:t}),d.SendSucceeded}catch(t){var i=n.me(t);return n.he(l.FailedToSendEventToWorker,i),d.SendFailed}return d.DidNotAttempt},this.ie=function(t,e,o,i){t&&void 0!==e&&(n.Pt[t]||(n.Pt[t]={k:t,t:e,a:!0===o,o:null!=i?i:void 0},o&&(n.nt.push(t),n.ee())))},this.we=function(t){n.It=-1,t?(n.Bt=Date.now(),n.ce(),n.de()):n.ee()},this.be=function(t){return!!n.Gt||(n.he(l.AttemptToUseFunctionalityBeforeIitialization,null==t?void 0:t.toString()),!1)},this.Qt=function(t,e,o){if(t){var r=n.ot.ht;if(n.Kt&&(o<=0||!n.Ut)&&n.pe(t,e)!==d.SendFailed)return;if(!(o<=0)){var u=n.ge(t,!1);if(null!==u){if(n.Tt())try{if(void 0!==navigator.sendBeacon){if(u.length>=65536&&n.ot.st){var s=(0,i.Cl)((0,i.Cl)({},t),{a:n.Yn}),a=n.ge(s,!0);if(null===a)return;navigator.sendBeacon(r,a)}else navigator.sendBeacon(r,u);return}}catch(n){}var l=new XMLHttpRequest;l.open("POST",r,!0),l.onreadystatechange=function(){l.readyState===XMLHttpRequest.DONE&&(200===l.status?n.Kt||(n.Kt=!0):n.Vt<n.ot.bt?(n.Vt+=1,window.setTimeout((function(){n.Vt-=1,n.Qt(t,e,o-1)}),n.ot.St)):n.Kt&&n.pe(t,e))},l.send(u)}}}},this.he=function(t,e){var o={i:t,r:e};n.Yt(s.DiagnosticLog,o,t.toString())},this.me=function(n){var t=void 0;return"string"==typeof n?t=n:n instanceof Error&&(t=n.name+" "+n.message,n.stack&&(t+=" "+n.stack)),t},this.ge=function(t,e){try{return i=t,JSON.stringify(i)}catch(t){var o=n.me(t);return o="ModifiedPayload: "+e+" | "+o,n.he(l.FailedToJsonStringifyEvent,o),null}var i}}return n.getInstance=function(t){return void 0===t&&(t=!1),n.Se&&!t||(n.Se=new n),this.Se},n.prototype.initialize=function(n){if(n)try{return this.ot=function(n){var t,e,o,i,r,u,s,a,l,c,d,f,v,h,p;return{tt:null!==(t=n.dimensions)&&void 0!==t?t:void 0,it:null!==(e=n.heartbeatIntervalMs)&&void 0!==e?e:3e5,rt:null!==(o=n.isHealthEnabled)&&void 0!==o&&o,ut:null!==(i=n.isOfflineEnabled)&&void 0!==i&&i,st:null!==(r=n.isErrorPartCEnabled)&&void 0!==r&&r,ct:null!==(u=n.loggerMaxIntervalMs)&&void 0!==u?u:3e4,dt:null!==(s=n.loggerMaxQueueSize)&&void 0!==s?s:25,ft:null!==(a=n.offlineWorkerUrl)&&void 0!==a?a:"",wt:null!==(l=n.absoluteRemoteTelemetryUrlForOfflineWorker)&&void 0!==l?l:"",vt:null!==(c=n.recordPillarToWarmPipelineIntervalMs)&&void 0!==c?c:864e5,ht:null!==(d=n.remoteTelemetryUrl)&&void 0!==d?d:"",bt:null!==(f=n.maxConcurrentRetries)&&void 0!==f?f:3,gt:null!==(v=n.retryMaxAttempts)&&void 0!==v?v:3,St:null!==(h=n.retryDelayMs)&&void 0!==h?h:15e3,Ht:null!==(p=n.disabledHealthEvents)&&void 0!==p?p:new Set}}(n),this.re(),this.te(),this.ve(),this.Gt=!0,void this.he(l.InitializedHealth)}catch(n){}this.Gt=!1},n.prototype.addOrUpdatePartCDimension=function(n,t){this.be(c.AttemptedToAddOrUpdatePartCDimension)&&n&&(this.Yn.hasOwnProperty(n)&&this.Yn[n]===t||(this.$t(!0),this.Yn[n]=t,this.et+=1,this.ee(),this.se()))},n.prototype.addOrUpdateErrorPartCDimension=function(n,t){this.ot.st&&n&&(this.$n[n]=t)},n.prototype.addQosPillar=function(n){if(n){var t=0===this.Lt.length;-1===this.Lt.indexOf(n)&&(this.Lt.push(n),this.ae(n,!1),this.we(t))}},n.prototype.recordBsqmQosError=function(n,t,e){if(this.be(c.AttemptedToRecordBSqmQosError)&&(this.He(!1),this.se(),n)){var o={b:n,v:t,d:null==e?void 0:e.durationMs,p:r(null==e?void 0:e.extendedProperties),s:this.Lt,i:null==e?void 0:e.inStaging};this.Yt(s.BSqmError,o,n),this.shutdown(!0)}},n.prototype.recordKpiFailure=function(n,t,e,i,r){this.oe(n,!0,o.Failure,r,t,i,e)},n.prototype.recordKpiImpliedFailure=function(n,t,e,i,r,u){this.oe(n,!1,o.ImpliedUsageFailure,u,t,i,e,f.v.FailureBased,!1,r)},n.prototype.recordKpiImpliedSuccess=function(n,t,e){this.oe(n,!1,o.ImpliedUsageSuccess,e,void 0,void 0,void 0,f.v.FailureBased,!1,t)},n.prototype.recordKpiSuccess=function(n,t){this.oe(n,!0,o.Success,t)},n.prototype.recordKpiUsage=function(n,t,e,i){this.oe(n,!1,o.Usage,{extendedProperties:i},void 0,void 0,void 0,t,!1,e)},n.prototype.recordKpiUsageForAlertableKpi=function(n,t,e){if(n){var i=!0,r=this.Pt[n];r&&(i=r.t===f.v.FailureBased),this.oe(n,!1,o.Usage,{extendedProperties:e},void 0,void 0,void 0,f.v.FailureBased,!0,t),i&&this.de()}},n.prototype.recordQosError=function(n,t,e,o,i,u,a){if((!u||this.be(c.AttemptedToRecordSessionEndingQosError))&&n&&t){var l={n,x:e,z:o,l:i,v:t,e:u,d:null==a?void 0:a.durationMs,p:r(null==a?void 0:a.extendedProperties),s:this.Lt,i:null==a?void 0:a.inStaging};this.Yt(s.QosError,l,n),u&&(this.He(!1),this.se(),this.shutdown(!0))}},n.prototype.removeQosPillar=function(n){if(n){var t=this.Lt.indexOf(n);t>-1&&(this.Lt.splice(t,1),this.we(!1)),0===this.Lt.length&&this.fe()}},n.prototype.resumeAllHealthTimers=function(){if(this.Ct&&!this.At&&this.ue(),0===this.xt&&0!==this.Bt){var n=Date.now()-this.Bt;n>=this.ot.vt||n<=0?this.le():this.ce(this.ot.vt-n)}},n.prototype.setHandlerForIsAppShuttingDown=function(n){n&&(this.Tt=n)},n.prototype.setIsAppOnline=function(n){var t;this.be(c.AttemptedToSetAppOnlineStatus)&&(!this.Ut&&n&&(null===(t=this.ne)||void 0===t||t.postMessage({t:s.OfflineWorkerFlush,v:this.Tt()})),this.Ut=n)},n.prototype.shutdown=function(n){var t;void 0===n&&(n=!1),this.ot.rt&&(this.Jt(),this.He(!1),this.Tt=function(){return!0},this.zt(),(!n||n&&this.Ut)&&(null===(t=this.ne)||void 0===t||t.terminate()))},n.prototype.stopAllHealthTimers=function(){this.He(!0)},n.prototype.He=function(n){this.At=!1,this.It=-1,0!==this.yt&&(window.clearTimeout(this.yt),this.yt=0),this.fe(),n&&this.zt()},n.prototype.updatePartADimensions=function(n){var t=this;if(n&&this.be(c.AttemptedToUpdatePartADimensions)){var e=!1;Object.keys(n).forEach((function(o){void 0!==n[o]&&null!==n[o]&&""!==n[o]&&t.ot.tt[o]!==n[o]&&(t.ot.tt[o]=n[o],e=!0)})),e&&(this.$t(),this.re(),this.et+=1,this.ee(),this.se())}},n.prototype.flushAndSetNewEndpoint=function(n,t){var e;n.localeCompare(null!==(e=this.ot.ht)&&void 0!==e?e:"",void 0,{sensitivity:"accent"})&&(this.$t(!1),this.ot.ht=n,t&&t())},n}()},7627:function(n,t,e){var o;e.d(t,{n:function(){return o}}),function(n){n[n.Ce=0]="msoulscat_ES_EWAJS",n[n.Ie=1]="msoulscat_ES_EWAJSGrid",n[n.Ae=6]="msoulscat_ES_EWAJSChart",n[n.ye=202]="msoulscat_MSOSP_FileMenuCommands",n[n.Ue=220]="msoulscat_MSOSP_AddInCommands",n[n.Te=225]="msoulscat_MSOSP_OTelJS",n[n.Pe=227]="msoulscat_MSOSP_OTelJSInWebWoker",n[n.ke=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",n[n.Ne=301]="msoulscat_Wac_WordViewer",n[n.Ee=306]="msoulscat_Wac_BrowserGeneral",n[n.We=320]="msoulscat_Wac_TaskPane",n[n.Fe=339]="msoulscat_Wac_OneNoteGeneral",n[n.Re=340]="msoulscat_Wac_Ribbon",n[n.De=356]="msoulscat_Wac_WacFeedback",n[n.Oe=379]="msoulscat_Wac_WopiPendingApplication",n[n.je=383]="msoulscat_Wac_Telemetry",n[n.Me=391]="msoulscat_Wac_WacCatchUpActivities",n[n._e=394]="msoulscat_Wac_Dictation",n[n.Be=395]="msoulscat_Wac_OneNoteSync",n[n.xe=700]="msoulscat_Wac_VisioApp",n[n.Le=1601]="msoulscat_OneNoteOnline_EditableCache",n[n.Ke=800]="msoulscat_Wac_PptAnimation",n[n.Ve=833]="msoulscat_Wac_PptLive",n[n.Ge=834]="msoulscat_Wac_PptMWeb",n[n.Je=835]="msoulscat_Wac_PptGc2General",n[n.qe=836]="msoulscat_Wac_PptGc2GraphicHost",n[n.ze=837]="msoulscat_Wac_PptGc2Operation",n[n.Ze=844]="msoulscat_Wac_PptDataSync",n[n.Qe=848]="msoulscat_Wac_PptFluidRuntime",n[n.Xe=815]="msoulscat_Wac_PptShape",n[n.Ye=817]="msoulscat_Wac_PptSession",n[n.no=830]="msoulscat_Wac_PptSlideshow",n[n.eo=822]="msoulscat_Wac_PptView",n[n.oo=846]="msoulscat_Wac_PptVideos",n[n.io=1303]="msoulscat_Uci_Insights",n[n.ro=2300]="msoulscat_Wac_VersionHistory",n[n.uo=302]="msoulscat_Wac_WordPresence",n[n.so=3e3]="msoulscat_Wac_OAuth",n[n.ao=3005]="msoulscat_Wac_WordVersionHistory",n[n.lo=3006]="msoulscat_Wac_LivePersonaCard",n[n.co=3012]="msoulscat_Wac_CatchUpFlyout",n[n.do=3016]="msoulscat_Wac_WordDesigner",n[n.fo=3021]="msoulscat_Wac_ModernFontPicker",n[n.vo=3027]="msoulscat_Wac_UnifiedUiHost",n[n.ho=3033]="msoulscat_Wac_EquationTools",n[n.po=1401]="msoulscat_Osf_Latency",n[n.mo=1402]="msoulscat_Osf_Notification",n[n.wo=1403]="msoulscat_Osf_Runtime",n[n.bo=3041]="msoulscat_Wac_AiMaker",n[n.So=3043]="msoulscat_Wac_AiRewrite",n[n.Ho=3044]="msoulscat_Wac_AiInsert",n[n.Co=3047]="msoulscat_Wac_AiSummarize",n[n.Io=3048]="msoulscat_Wac_CopilotCompose",n[n.Ao=3049]="msoulscat_Wac_Skittles",n[n.yo=3050]="msoulscat_Wac_CopilotChat",n[n.Uo=3051]="msoulscat_Wac_Syntex",n[n.To=3052]="msoulscat_Wac_WireGraph",n[n.Po=3053]="msoulscat_Wac_CshCopilot",n[n.ko=3054]="msoulscat_Wac_CopilotComposeLaunchpad",n[n.No=3055]="msoulscat_Wac_CopilotProactiveSummary",n[n.Eo=3056]="msoulscat_Wac_CopilotProactiveShared",n[n.Wo=3057]="msoulscat_Wac_CopilotCursor"}(o||(o={}))},2808:function(n,t,e){var o;e.d(t,{k:function(){return o}}),function(n){n[n.Error=10]="Error",n[n.Warning=15]="Warning",n[n.Important=20]="Important",n[n.Info=50]="Info",n[n.Verbose=100]="Verbose",n[n.Spam=200]="Spam"}(o||(o={}))},7055:function(n,t,e){e.d(t,{e:function(){return s}});var o=e(7070),i=e(7627),r=e(2808),u=e(7282);function s(n,t,e,a,l,c,d){void 0===a&&(a=!1),void 0===l&&(l=!1),void 0===c&&(c=1),void 0===d&&(d=!1);var f=(0,o.u_)();return(0,o.l8)("wopiDataStartTime"),t(n,a,l,e).then((function(t){var s,a,l,c;if(!t){var d="Graph call failed";return null==e||e.ULS.sendTraceTag(553726284,i.n.vo,r.k.Error,"GetWopiData: Failed to get the driveItem. [ErrorMessage: ".concat(d,"]")),Promise.reject(d)}var v={docUrl:null!==(s=t.webDavUrl)&&void 0!==s?s:n.docUrl,driveId:null!==(l=null===(a=null==t?void 0:t.parentReference)||void 0===a?void 0:a.driveId)&&void 0!==l?l:n.driveId,docId:null!==(c=null==t?void 0:t.id)&&void 0!==c?c:n.docId,fileName:t.name};null==e||e.ULS.sendTraceTag(553726285,i.n.vo,r.k.Info,"GetWopiData: Fetched documentIdentifier. [IsValid: ".concat(!!v,"]"));var h=(0,u.Z1)(t,e);null==e||e.ULS.sendTraceTag(553726287,i.n.vo,r.k.Info,"GetWopiData: Getting WopiHostData from drive item. [IsValid: ".concat(!!h,"]"));var p={startTime:f,endTime:(0,o.u_)()};return(0,o.l8)("wopiDataEndTime"),{documentIdentifier:v,wopiHostData:h,fetchDiagnostics:p}})).catch((function(o){var u;return null==e||e.ULS.sendTraceTag(520729472,i.n.vo,r.k.Warning,"GetWopiData: General getWopiData error. [Message: ".concat(null==o?void 0:o.message,"][FailureReason: ").concat(null==o?void 0:o.failure,"][Status: ").concat(null==o?void 0:o.status,"]")),c>0&&(null==o?void 0:o.retry)?(null==e||e.ULS.sendTraceTag(544306772,i.n.vo,r.k.Error,"GetWopiData: Retrying getWopiData. [Message: ".concat(null==o?void 0:o.message,"][FailureReason: ").concat(null==o?void 0:o.failure,"][Status: ").concat(null==o?void 0:o.status,"]")),new Promise((function(n){var t=function(n){if(0===n)throw new Error("Retry count should not be 0");return 1===n?window.crypto.getRandomValues(new Uint32Array(1))[0]%291+10:10}(c);setTimeout(n,t),null==e||e.ULS.sendTraceTag(508035599,i.n.vo,r.k.Warning,"GetWopiData: Retrying getWopiData with ".concat(c," retries left. Delaying retry for ").concat(t,"ms."))})).then((function(){return s(n,t,e,a,l,c-1)})).catch((function(n){return null==e||e.ULS.sendTraceTag(508035598,i.n.vo,r.k.Error,"GetWopiData: Failed to delay retry getWopiData. [Error: ".concat(n.message,"]")),Promise.reject(n)}))):c>0&&d&&"accessDenied"===(null==o?void 0:o.errorCode)?new Promise((function(n){setTimeout(n,3e3),null==e||e.ULS.sendTraceTag(523269073,i.n.vo,r.k.Warning,"GetWopiData: Retrying getWopiData after retryIntervalForWopiDataRequest: ".concat(3e3,"ms. [Error: ").concat(JSON.stringify(o),"][FailureReason: ").concat(null==o?void 0:o.failure,"]"))})).then((function(){return s(n,t,e,a,l,0)})):(null==e||e.ULS.sendTraceTag(544306773,i.n.vo,r.k.Error,"GetWopiData: Not retrying getWopiData. [ShouldRetry: ".concat(c>0,"][FailureReason: ").concat(null!==(u=null==o?void 0:o.failure)&&void 0!==u?u:null==o?void 0:o.message,"]")),Promise.reject(o))}))}},6141:function(n,t,e){e.d(t,{K:function(){return d},k:function(){return c}});var o,i=e(334),r=e(7070),u=e(7627),s=e(2808),a=e(9458);function l(n,t,e,i,r,u,s){if(null==o||o.delete(e),i&&"PRODUCTION"===i){var a=new URL(n);return a.hostname="wise-backup.public.onecdn.static.microsoft",c(a.toString(),t,e,!1,i,void 0,r,u,s)}return c(n,t,e,!1,i,void 0,r,u,s)}function c(n,t,e,c,f,v,h,p,m){return void 0===c&&(c=!0),(0,i.sH)(this,void 0,void 0,(function(){var w,b,g=this;return(0,i.YH)(this,(function(S){return o||(o=new Map),(w=o.get(e))?[2,w]:(b=new Promise((function(o,w){return(0,i.sH)(g,void 0,void 0,(function(){var b,g,S,H,C,I=this;return(0,i.YH)(this,(function(A){switch(A.label){case 0:return b=(0,r.u_)(),(g=document.getElementById("".concat(e,"_bootstrapper")))?(S=(0,i.zs)(d(e),2),H=S[0],!S[1]&&H?[3,2]:[4,new Promise((function(n,t){g.onload=function(){n()},g.onerror=function(){t("JSAPI script failed to load in parallel with OWL")}})).catch((function(){null==v||v.ULS.sendTraceTag(507531682,u.n.vo,s.k.Error,"JSAPI failed to load ".concat(a.p[e]," bootstrapper in parallel with OWL")),w("JSAPI script failed to load in parallel with OWL")}))]):[3,3];case 1:A.sent(),A.label=2;case 2:return C=(0,r.u_)(),null==v||v.ULS.sendTraceTag(507531681,u.n.vo,s.k.Important,"JSAPI script successfully loaded for ".concat(a.p[e]," with OWL")),[2,o({bootstrapperUrl:n,applicationUrl:t,performance:{startTime:b,endTime:C}})];case 3:return function(n,t,e,o,i,r,u,s,a,l){if(void 0===o&&(o=!1),void 0===r&&(r=!1),void 0===u&&(u=!1),!document)return null;if(i){var c=document.getElementById(i);if(null!=c)return t&&t(),c}var d=document.createElement("script");if(d.src=n,i&&(d.id=i),t&&(d.onload=t),e&&(d.onerror=function(){var n;u&&(null===(n=d.parentNode)||void 0===n||n.removeChild(d)),e()}),r&&(d.crossOrigin="anonymous"),l&&s&&!a&&(d.integrity=s),o){var f=document.getElementsByTagName("script")[0];if(f&&f.parentNode)return f.parentNode.insertBefore(d,f)}document.body.appendChild(d)}(n,(function(){var i=(0,r.u_)();null==v||v.ULS.sendTraceTag(507834582,u.n.vo,s.k.Important,"JSAPI fetch succeeded for ".concat(a.p[e]," bootstrapper. OnRetry: false")),o({bootstrapperUrl:n,applicationUrl:t,performance:{startTime:b,endTime:i}})}),(function(){return(0,i.sH)(I,void 0,void 0,(function(){var d;return(0,i.YH)(this,(function(i){switch(i.label){case 0:if(!c)return[3,5];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,l(n,t,e,f,h,p)];case 2:return i.sent(),d=(0,r.u_)(),null==v||v.ULS.sendTraceTag(507834581,u.n.vo,s.k.Important,"JSAPI fetch succeeded for ".concat(a.p[e]," bootstrapper. OnRetry: true")),o({bootstrapperUrl:n,applicationUrl:t,performance:{startTime:b,endTime:d}}),[3,4];case 3:return i.sent(),null==v||v.ULS.sendTraceTag(507834580,u.n.vo,s.k.Error,"JSAPI fetch failed for ".concat(a.p[e]," bootstrapper. OnRetry: true")),w("Load bootstrapper script failed"),[3,4];case 4:return[3,6];case 5:null==v||v.ULS.sendTraceTag(507834579,u.n.vo,s.k.Error,"JSAPI fetch failed for ".concat(a.p[e]," bootstrapper. OnRetry: false")),w("Load bootstrapper script failed"),i.label=6;case 6:return[2]}}))}))}),!1,"".concat(a.p[e],"_bootstrapper"),m,c,h,p,m),[2]}}))}))})),o.set(e,b),[2,b])}))}))}function d(n){var t=window.Microsoft;if(void 0===t)return[void 0,"Microsoft is undefined"];var e=t.Office,o=a.p[n];return e&&e[o]?[e[o],void 0]:[void 0,"Failed to find bootstrapper for app: ".concat(o)]}},9278:function(n,t,e){e.d(t,{d$:function(){return W},Az:function(){return F}});var o=e(334),i=e(4999),r=e(1990),u=e(843),s=e(7216),a=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.value=null,t.hasNext=!1,t.hasCompleted=!1,t}return r.C6(t,n),t.prototype.A=function(t){return this.hasError?(t.error(this.thrownError),s.y.EMPTY):this.hasCompleted&&this.hasNext?(t.next(this.value),t.complete(),s.y.EMPTY):n.prototype.A.call(this,t)},t.prototype.next=function(n){this.hasCompleted||(this.value=n,this.hasNext=!0)},t.prototype.error=function(t){this.hasCompleted||n.prototype.error.call(this,t)},t.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&n.prototype.next.call(this,this.value),n.prototype.complete.call(this)},t}(u.B7),l=e(8703);var c=e(21),d=e(8478),f=e(2394),v=e(7627),h=e(2808),p=e(3118),m=e(620);function w(n,t,e,o,i){(e||o)&&n.then((function(n){if(n){var r=function(n){var t,e=(t=n.match(/^https:\/\/((?!word)\w+)(-\w+)+\..*$/i))&&t[1]?t[1]:"public";return{region:e,dataBoundary:(0,m.y)(e)}}(n);if(e)try{var u=(0,p.yc)(t,r.dataBoundary);e.flushAndSetNewEndpoint(u,(function(){null==e||e.ULS.sendTraceTag(509612803,v.n.vo,h.k.Info,"Updated ULS endpoint. Environment: ".concat(t,", DataBoundary: ").concat(r.dataBoundary,", Region: ").concat(r.region))}))}catch(n){e.ULS.sendTraceTag(509875042,v.n.vo,h.k.Warning,"Failed to identify data boundary-aware bULS endpoint. Error: ".concat(n.message))}if(o)try{u=(0,p.C6)(t,i,r.dataBoundary),o.flushAndSetNewEndpoint(u,(function(){null==e||e.ULS.sendTraceTag(509612802,v.n.vo,h.k.Info,"Updated Health endpoint. Environment: ".concat(t,", DataBoundary: ").concat(r.dataBoundary,", Region: ").concat(r.region))}))}catch(n){null==e||e.ULS.sendTraceTag(509875041,v.n.vo,h.k.Warning,"Failed to identify data boundary-aware Health endpoint. Error: ".concat(n.message))}}})).catch((function(n){null==e||e.ULS.sendTraceTag(509875042,v.n.vo,h.k.Warning,"Failed to resolve app url promise. Error: ".concat(n.message))}))}var b=e(7070),g=e(7630),S=e(8790),H=e(3261),C=e(9424),I=e(2573),A=e(1110),y=e(4056),U=e(6141),T=e(7282),P=e(3183);function k(n,t,e,i,r,u,s,a,f){var p=this,m=n.loadFunctionSubject,w=n.documentBootInfo,k=n.correlationId,N=n.wopiFetchData,E=void 0===N?{wopiHostData:void 0,fetchDiagnostics:void 0}:N,W=w.fileType,F=w.wdOrigin,R=w.puid,D=w.uiCulture,O=w.dataCulture,j=w.clickTime,M=w.rebootOverrideData,_=E.wopiHostData,B=E.fetchDiagnostics,x=null==e?void 0:e.logger,L=null==e?void 0:e.health;if(!(_&&_.wac&&_.wac.bootstrapperUrl&&_.wac.applicationUrl)){var K=!!_,V=!!(null==_?void 0:_.wac),G=new Map([["WopiHostDataPresent","".concat(K)],["WopiWacDataPresent","".concat(V)]]),J=JSON.stringify(Array.from(G.entries())),q={wacErrorName:c.R7.Fo,qosErrorName:c.by.QosError_VroomWopiFailure,errorMessage:J};return null==x||x.ULS.sendTraceTag(554964098,v.n.vo,h.k.Info,"".concat(c.R7.Fo,": Failed to get wopi data for the item, ").concat(J)),void(i&&i(q))}var z=a||_.wac.bootstrapperUrl,Z=f,Q=_.wac.applicationUrl;_.wac.userId&&(null==L||L.updatePartADimensions({loggableUserId:_.wac.userId}));var X=new Promise((function(n,t){setTimeout((function(){return t("jsApi timed out after 60 seconds")}),6e4)})),Y=new Promise((function(n,a){return(0,o.sH)(p,void 0,void 0,(function(){var f,p,N;return(0,o.YH)(this,(function(E){return m.subscribe((function(){return n("jsApi successfully loaded")})),f=function(n,i){var a,f,p=(0,P.Mt)(_,Q,null!==(a=null==t?void 0:t.uiHostName)&&void 0!==a?a:"UUIH",w,null==t?void 0:t.uiEmbed),U=(0,T.Tf)(p,x),N=(0,P.PS)(W,null==t?void 0:t.featureGates,x),E=(0,H.SI)(H.dT.FeatureGate_EnableSingleOwlJsapiLogger,null==t?void 0:t.featureGates);(null==e?void 0:e.bootDiagnostics)&&(e.bootDiagnostics.perfJsapiTiming=e.bootDiagnostics.perfJsapiTiming||(0,S.Rt)(W)),N?(null==L||L.addOrUpdatePartCDimension("JsApiVersion","V2"),f=function(a){var f=a.container,m=a.flushTime;return new l.c((function(a){var l,S,T,N,W,R,D,K,V,G,J,q,Z,Q=(0,C.I)(w,z,t,e,_),X=d.W.isCreateNewFlowExecuting&&d.W.application?d.W.application:n.createApplication(Q),Y={hostSessionId:k,logger:E?x:void 0},$=d.W.isCreateNewFlowExecuting&&d.W.session?d.W.session:X.createSession(Y);u&&u(X,_,w,$),!(0,H.SI)("UseNewEuplReporting",null==t?void 0:t.featureGates)&&r&&r();var nn={appUrl:p,file:(0,o.Cl)((0,o.Cl)({name:_.fileName,getUrl:(null===(N=_.wac)||void 0===N?void 0:N.fileGetUrl)||_.downloadUrl,urlNoAuth:null!==(R=null===(W=_.wac)||void 0===W?void 0:W.fileUrlNoAuth)&&void 0!==R?R:"",size:_.fileSize,downloadCode:_.downloadCode,eTag:_.eTag},w.docId&&{uniqueId:w.docId,immutableReason:null==e?void 0:e.fileImmutableReason}),{supportsZipIt:null==e?void 0:e.supportsZipIt}),customFontCatalogUrl:_.wac.customFontCatalogUrl,contentBundle:{majorVersion:_.bundleVersion?Number(_.bundleVersion):0,url:null!==(D=_.bundleUrl)&&void 0!==D?D:"",urlNoAuth:null!==(K=_.bundleUrlNoAuth)&&void 0!==K?K:"",bundleCode:_.bundleCode,staleness:_.bundleStaleness||0},newFileTemplate:w.newFileTemplate,container:f,wopi:{source:_.wac.wopiSrc,accessToken:_.wac.accessToken,expiry:parseInt(_.wac.accessTokenExpiry,10),wacToken:null==e?void 0:e.wacToken},bootParams:{readOnly:_.readOnly,irmEnabled:_.irmEnabled,supportsDecryptedContentDownload:_.protectionEnabled,viewOnly:_.blocksDownload,disableChat:!0,openViewByDefault:"view"===w.intent,dataLanguage:O},diagnostics:(null===(V=null==e?void 0:e.bootDiagnostics)||void 0===V?void 0:V.legacyPerformanceData)?(0,o.Cl)((0,o.Cl)((0,o.Cl)({},(0,P.ch)(null===(G=null==e?void 0:e.bootDiagnostics)||void 0===G?void 0:G.legacyPerformanceData.host)),(0,P.wh)(j,m,F,B,i.performance,e,null==t?void 0:t.featureGates)),{legacyPerformanceData:null===(J=null==e?void 0:e.bootDiagnostics)||void 0===J?void 0:J.legacyPerformanceData}):(0,P.VS)(j,m,F,B,i.performance,e,null==t?void 0:t.featureGates),sessionContext:U||(0,P.uU)(),preseededSession:{key:_.preSeededSessionKey,id:_.preSeededWacSessionId},wdParams:(0,o.Cl)((0,o.Cl)((0,o.Cl)({},w.templateId&&(l={},l.wdTpl=w.templateId,l)),M&&M.lcid&&(S={},S.wdlcid=M.lcid,S)||w.uiCulture&&(T={},T.wdlcid=w.uiCulture,T)),(0,P.aT)(w.wdValue)),hostGeneratedSessionId:null==e?void 0:e.sessionId,meeting:null==e?void 0:e.meeting,rebootOverride:M,throttling:{protection:null===(q=_.wac)||void 0===q?void 0:q.clientThrottlingProtection,request:null===(Z=_.wac)||void 0===Z?void 0:Z.requestedCallThrottling}};(0,b.l8)(I.ls.OwlWacBootStart);var tn=(0,H.SI)(H.dT.FeatureGate_OwlPostWacTokenForTeamsHosts,null==t?void 0:t.featureGates);tn&&((0,A.iz)(!!nn.wopi.wacToken),nn.wopi.wacToken&&(null==L||L.recordKpiSuccess(c.ex.Ro,{extendedProperties:new Map([["scenario","postWacTokenBeforeBootJsapiV2"]])}),null==x||x.ULS.sendTraceTag(507347489,v.n.vo,h.k.Important,"WAC token has been fetched before calling jsapi boot"))),(d.W.isCreateNewFlowExecuting?d.W.completeCreateNewPromise:$.boot(nn,s)).then((function(n){var t;if("success"===n.completion)a.next({wopiHostData:_,officeApplication:X,bootedDocumentInfo:new g.t(w),officeDocumentSession:$,wacBootDiagnostics:null===(t=null==$?void 0:$.diagnostics)||void 0===t?void 0:t.appInitDiagnostics}),a.complete();else if("cancelled"===n.completion)tn&&(null==L||L.recordKpiFailure(c.ex.Ro,n.completion,!0,!1,{extendedProperties:new Map([["scenario","postWacTokenBeforeBootJsapiV2"],["status","cancelled"]])})),null==x||x.ULS.sendTraceTag(509646293,v.n.vo,h.k.Info,"User cancelled document session boot");else{var e=n.completion;tn&&(null==L||L.recordKpiFailure(c.ex.Ro,n.completion,!1,!1,{extendedProperties:new Map([["scenario","postWacTokenBeforeBootJsapiV2"],["status","failed"]])}));var o=void 0;if("timeout"===n.completion)o=c.R7.Do;else switch(n.errorSource&&"string"==typeof n.errorSource?n.errorSource.toLowerCase():void 0){case"app":o=c.R7.Oo;break;case"jsapi":o=c.R7.jo;break;default:o=c.R7.Mo}var i={wacErrorName:o,qosErrorName:c.by.QosError_EncounteredJsApiError,errorMessage:e,error:n.error,documentLoadedWithTabSwitch:!!n.documentLoadedWithTabSwitch},r=(0,y.C)(i),u=JSON.stringify(Array.from(r.entries()));null==x||x.ULS.sendTraceTag(575419404,v.n.vo,h.k.Error,u),a.error(i)}})).catch((function(n){return null==x?void 0:x.ULS.sendTraceTag(512337547,v.n.vo,h.k.Error,"officeDocumentSession.boot threw error: ".concat(n))}))}))}):(null==L||L.addOrUpdatePartCDimension("JsApiVersion","V1"),f=function(u){var s=u.container,a=u.flushTime;return new l.c((function(u){var l=(0,P.Xl)(_?_.wac.userId:R,k,D,O,t,e,(0,P.aT)(w.wdValue),U),d=(0,P.TB)(w,_),f=(0,P.VS)(j,a,F,B,i.performance,e,null==t?void 0:t.featureGates),p=null==t?void 0:t.uiHostName,m=(0,P.K7)((0,o.Cl)((0,o.Cl)({},_.wac),{wacToken:null==e?void 0:e.wacToken})),S=(0,P.ND)(s,i,m,l,d,f,(function(n,t){u.next({wopiHostData:_,officeApplication:n,bootedDocumentInfo:new g.t(w),wopiPendingApp:T,wacBootDiagnostics:t}),u.complete()}),(function(n){var t=n.errorObject.message,e={wacErrorName:c.R7._o,qosErrorName:c.by.QosError_EncounteredJsApiError,errorName:n.errorType,errorMessage:t,error:n},o=(0,y.C)(e),i=JSON.stringify(Array.from(o.entries()));null==x||x.ULS.sendTraceTag(575419405,v.n.vo,h.k.Error,i),u.error(e)}),p,w,_,null==t?void 0:t.showCloseButton,null==t?void 0:t.supportsShare,null==t?void 0:t.openInBrowserEnabled,null==t?void 0:t.ellipsisDownloadACopyButtonEnabled,null==t?void 0:t.copyLinkEnabled,null==t?void 0:t.uiEmbed,null==t?void 0:t.supportsHostUiControls,null==t?void 0:t.conversationButtonEnabled,null==e?void 0:e.additionalApplicationParameters),C=(0,b.u_)();null==x||x.ULS.sendTraceTag(576578583,v.n.vo,h.k.Info,"BootStrapFile: About to call InitializeWopiPending");var I=(0,H.SI)(H.dT.FeatureGate_OwlPostWacTokenForTeamsHosts,null==t?void 0:t.featureGates);I&&((0,A.iz)(!!m.WacToken),m.WacToken&&(null==L||L.recordKpiSuccess(c.ex.Ro,{extendedProperties:new Map([["scenario","postWacTokenBeforeBootJsapiV1"]])}),null==x||x.ULS.sendTraceTag(507347488,v.n.vo,h.k.Important,"WAC token has been fetched before calling jsapi initializeWopiPending")));var T=n.Application.InitializeWopiPending(S,void 0,null==e?void 0:e.sessionId),N=(0,b.u_)()-C;null==x||x.ULS.sendTraceTag(570775769,v.n.vo,h.k.Info,"BootStrapFile: InitializeWopiPending returned. [IsValidWopiPendingApp: ".concat(!!T,"][TimeElapsed: ").concat(N,"]"));var E=(0,b.u_)();if(T){r&&r(),T.Complete(m);var W=(0,b.u_)(),M=W-E,K=W-C;null==x||x.ULS.sendTraceTag(570775770,v.n.vo,h.k.Info,"BootStrapFile: Complete returned.[TimeElapsedInComplete: ".concat(M,"][TimeElapsedSinceInitializeWopiPending: ").concat(K,"]"))}else{var V={wacErrorName:c.R7.Bo,qosErrorName:c.by.QosError_EncounteredJsApiError,errorMessage:"WOPI pending failed"};I&&(null==L||L.recordKpiFailure(c.ex.Ro,V.errorMessage,!1,!1,{extendedProperties:new Map([["scenario","postWacTokenBeforeBootJsapiV1"],["status","failed"]])}));var G=(0,y.C)(V),J=JSON.stringify(Array.from(G.entries()));u.error(V),null==x||x.ULS.sendTraceTag(575419406,v.n.vo,h.k.Error,J)}}))}),m.next(f),m.complete()},d.W.isTwoStepCreateNew&&d.W.bootstrapperLoadPromise?d.W.bootstrapperLoadPromise.then((function(n){n?f(d.W.bootstrapper,d.W.bootstrapperInfo):null==x||x.ULS.sendTraceTag(507778322,v.n.vo,h.k.Warning,"Office bootstrapper failed to load for 2-step create new, check previous logs for more details")})).catch((function(n){return null==x?void 0:x.ULS.sendTraceTag(507778321,v.n.vo,h.k.Error,"Encountered error loading Office bootstrapper for 2-step create new: ".concat(n))})):(p=(0,H.SI)(H.dT.FeatureGate_EnableJsapiTags,null==t?void 0:t.featureGates),(0,H.lO)(H.dT.FeatureGate_EnableJsapiTags,p,x),(0,U.k)(z,_.wac.applicationUrl,W,!0,null==e?void 0:e.wiseEnvironment,x,Z,null===(N=null==e?void 0:e.owlRollout)||void 0===N?void 0:N.includes("LOCALHOST"),p).then((function(n){var t=(0,o.zs)((0,U.K)(W),2),e=t[0],r=t[1];if(!r&&e)f(e,n);else{var u=null!=r?r:"Error message undefined. BootStrapped not loaded: ".concat(!e);null==x||x.ULS.sendTraceTag(575419403,v.n.vo,h.k.Error,u);var s={wacErrorName:c.R7.xo,qosErrorName:c.by.QosError_OfficeBootstrapperNotLoaded,errorMessage:u,error:r,inStaging:!1};i&&i(s)}})).catch((function(n){a(n)}))),[2]}))}))}));Promise.race([X,Y]).catch((function(n){var t=(null!=n?n:"Failed to load the document")+", bootstrapperUrl: ".concat(z.replace(/^https?:\/\//,"")),e={wacErrorName:c.R7.Bo,qosErrorName:c.by.QosError_FailedToLoadDocument,errorMessage:t,error:n,inStaging:!1};null==x||x.ULS.sendTraceTag(575419407,v.n.vo,h.k.Error,"".concat(c.R7.Bo,": ").concat(t)),i&&i(e)}))}var N,E=e(7055);function W(n){return N?"".concat(n,".").concat(N.size):n}function F(n,t,e,r,u,s,v,h,p,m,b,g){var S;if(void 0===v&&(v=!1),N||(N=new Map),!n.isNewFile||!n.createNewInfo&&!n.isTwoStepCreateNew){var H=(0,T.x9)(n);if(!H)return{correlationId:t,bootstrapperObservable:(S="Not enough document information was provided",new l.c((function(n){return n.error(S)}))),fileNamePromise:Promise.reject("No name was provided"),applicationUrlPromise:Promise.reject("No applicationUrl")};var C=N.get(H);if(C)return C}return function(n,t,e,r,u,s,l,v,h,p,m,b){var g,S;void 0===l&&(l=!1);var H=W(t),C=null==u?void 0:u.logger,I=new a,A=null!=b?b:k;if(!d.W.isTwoStepCreateNew||!d.W.hostSessionId||!(null==u?void 0:u.createNewParams)){var y=(0,E.e)(n,e,C,l,!(!n.isNewFile&&!n.templateId),1,!!(null==u?void 0:u.meeting));y.then((function(t){var e,i;A({documentBootInfo:(0,o.Cl)((0,o.Cl)({},n),t.documentIdentifier),correlationId:H,loadFunctionSubject:I,wopiFetchData:t},r,u,s,v,h,p,null===(e=null==m?void 0:m.get(n.fileType))||void 0===e?void 0:e.jsApiUrl,null===(i=null==m?void 0:m.get(n.fileType))||void 0===i?void 0:i.jsApiSri)})).catch((function(t){if(d.W.isTwoStepCreateNew&&d.W.session&&d.W.session.run(i.Y.completeCreateNew,{state:"failure",reason:"wopiFetchFailed"},p),s){var e=JSON.stringify(t),o={wacErrorName:c.R7.Lo,qosErrorName:c.by.QosError_VroomWopiFailure,errorMessage:e,error:t,httpErrorCode:t.status,networkError:(0,f.TX)(t)};s(o,n)}}));var U={correlationId:H,bootstrapperObservable:I.asObservable(),fileNamePromise:n.fileName?Promise.resolve(n.fileName):y.then((function(n){return n.wopiHostData.fileName})),applicationUrlPromise:new Promise((function(n,t){y.then((function(t){var e,o;return n(null===(o=null===(e=null==t?void 0:t.wopiHostData)||void 0===e?void 0:e.wac)||void 0===o?void 0:o.applicationUrl)})).catch((function(n){t(n)}))}))};return u&&u.wiseEnvironment&&w(U.applicationUrlPromise,u.wiseEnvironment,C,u.health,u.sessionId),U}A({documentBootInfo:n,correlationId:H,loadFunctionSubject:I,wopiFetchData:(0,T.Rk)(u.createNewParams,n)},r,u,s,v,h,p,null===(g=null==m?void 0:m.get(n.fileType))||void 0===g?void 0:g.jsApiUrl);var P={correlationId:d.W.hostSessionId,bootstrapperObservable:I.asObservable(),fileNamePromise:Promise.resolve(n.fileName),applicationUrlPromise:Promise.resolve(null===(S=null==u?void 0:u.createNewParams)||void 0===S?void 0:S.appUrl)};return u&&u.wiseEnvironment&&w(P.applicationUrlPromise,u.wiseEnvironment,C,u.health,u.sessionId),P}(n,t,e,r,u,s,v,h,p,m,b,g)}},7282:function(n,t,e){e.d(t,{Rk:function(){return f},Tf:function(){return v},Z1:function(){return c},lW:function(){return d},x9:function(){return l}});var o=e(334),i=e(7627),r=e(2808),u=e(9458),s=e(8478),a=e(3183);function l(n){return n.shareUrl?n.shareUrl:n.docId&&n.driveId?"".concat(n.driveId,"_").concat(n.docId):n.docUrl?n.docUrl:n.isNewFile&&n.fileName?"".concat(n.fileName,"_").concat(u.p[n.fileType]):n.baseUrl&&n.fileId?"".concat(n.baseUrl,"_").concat(n.fileId):void 0}function c(n,t){var e,u,s,a,l,c,d,f,v,h,p,m=!!(null==n?void 0:n.openWith),w=!!(null===(e=null==n?void 0:n.openWith)||void 0===e?void 0:e.wac);return null==t||t.ULS.sendTraceTag(553916429,i.n.vo,r.k.Info,"GetWopiHostDataFromItem: [ValidOpenWith: ".concat(m,"][ValidWac: ").concat(w,"]")),{bundleStaleness:n.officeBundle?n.officeBundle.bundleStaleness:0,bundleUrl:n.officeBundle?n.officeBundle.url:"",bundleCode:n.officeBundle?n.officeBundle.bundleCode:"",bundleUrlNoAuth:n.officeBundle?n.officeBundle.urlNoAuth:"",bundleVersion:n.officeBundle?n.officeBundle.version:"",sharepointSiteUrl:n.sharepointIds?n.sharepointIds.siteUrl:"",downloadUrl:n["@content.downloadUrl"]||n["@microsoft.graph.downloadUrl"],downloadCode:n["@content.downloadCode"],eTag:n.eTag,fileName:n.name,fileSize:n.size,irmEnabled:(null===(u=n.file)||void 0===u?void 0:u.contentSensitivityLabelProtected)||(null===(s=n.file)||void 0===s?void 0:s.irmEffectivelyEnabled)||(null===(a=n.sensitivityLabel)||void 0===a?void 0:a.protectionEnabled)||(null===(l=n.file)||void 0===l?void 0:l.irmEnabled),protectionEnabled:(null===(c=n.sensitivityLabel)||void 0===c?void 0:c.protectionEnabled)||(null===(d=n.file)||void 0===d?void 0:d.contentSensitivityLabelProtected),isNewFile:!1,readOnly:n.currentUserRole&&n.currentUserRole.readOnly,blocksDownload:n.currentUserRole&&n.currentUserRole.blocksDownload,wac:n.openWith.wac,sharePointInfo:(0,o.Cl)({},n.sharepointIds),webUrl:n.webUrl,preSeededSessionKey:null===(f=null==n?void 0:n.wacSession)||void 0===f?void 0:f.preSeededSessionKey,preSeededWacSessionId:null===(v=null==n?void 0:n.wacSession)||void 0===v?void 0:v.preSeededWacSessionId,webDavUrl:n.webDavUrl,restUrl:(null===(h=n.openWith.wopi)||void 0===h?void 0:h.editUrl)||(null===(p=n.openWith.wac)||void 0===p?void 0:p.applicationUrl)}}function d(n,t,e,i,r){var u,l,c,d,f,h,p,m,w,b,g,S,H,C,I,A,y,U,T,P,k,N,E,W;if(!n.appUrl)throw new Error("appUrl must be provided in CreateNewParams");return{appUrl:(0,a.Mt)(void 0,n.appUrl,(null==i?void 0:i.uiHostName)||"OWL-2-step-create-new",t,null==i?void 0:i.uiEmbed),file:(0,o.Cl)({name:null===(c=n.file)||void 0===c?void 0:c.name,getUrl:null===(d=n.file)||void 0===d?void 0:d.getUrl,size:null===(f=n.file)||void 0===f?void 0:f.size,eTag:null===(h=n.file)||void 0===h?void 0:h.eTag},t.docId&&{uniqueId:t.docId,immutableReason:null==r?void 0:r.fileImmutableReason}),customFontCatalogUrl:n.customFontCatalogUrl,contentBundle:{majorVersion:(null===(p=n.contentBundle)||void 0===p?void 0:p.majorVersion)?Number(null===(m=n.contentBundle)||void 0===m?void 0:m.majorVersion):0,url:null!==(b=null===(w=n.contentBundle)||void 0===w?void 0:w.url)&&void 0!==b?b:"",staleness:(null===(g=n.contentBundle)||void 0===g?void 0:g.staleness)||0},newFileTemplate:t.newFileTemplate,container:e,bootParams:{readOnly:null===(S=n.bootParams)||void 0===S?void 0:S.readOnly,irmEnabled:null===(H=n.bootParams)||void 0===H?void 0:H.irmEnabled,supportsDecryptedContentDownload:null===(C=n.bootParams)||void 0===C?void 0:C.supportsDecryptedContentDownload,viewOnly:null===(I=n.bootParams)||void 0===I?void 0:I.viewOnly,disableChat:!0,openViewByDefault:"view"===t.intent,dataLanguage:t.dataCulture,isNewFile:t.isNewFile},diagnostics:(null===(A=null==r?void 0:r.bootDiagnostics)||void 0===A?void 0:A.legacyPerformanceData)?(0,o.Cl)((0,o.Cl)((0,o.Cl)({},(0,a.ch)(null===(y=null==r?void 0:r.bootDiagnostics)||void 0===y?void 0:y.legacyPerformanceData.host)),(0,a.wh)(t.clickTime,0,t.wdOrigin,void 0,null===(U=s.W.bootstrapperInfo)||void 0===U?void 0:U.performance,r,null==i?void 0:i.featureGates)),{legacyPerformanceData:null===(T=null==r?void 0:r.bootDiagnostics)||void 0===T?void 0:T.legacyPerformanceData}):(0,a.VS)(t.clickTime,0,t.wdOrigin,void 0,null===(P=s.W.bootstrapperInfo)||void 0===P?void 0:P.performance,r,null==i?void 0:i.featureGates),sessionContext:v(n.appUrl)||(0,a.uU)(),preseededSession:{key:null===(k=n.preseededSession)||void 0===k?void 0:k.key,id:null===(N=n.preseededSession)||void 0===N?void 0:N.id},wdParams:(0,o.Cl)((0,o.Cl)((0,o.Cl)({},t.templateId&&(u={},u.wdTpl=t.templateId,u)),t.uiCulture&&(l={},l.wdlcid=t.uiCulture,l)),(0,a.aT)(t.wdValue)),hostGeneratedSessionId:null==r?void 0:r.sessionId,meeting:null==r?void 0:r.meeting,throttling:{protection:null===(E=n.throttling)||void 0===E?void 0:E.protection,request:null===(W=n.throttling)||void 0===W?void 0:W.request}}}function f(n,t){var e,o,i,r,u,a,l,c,d,f,v,h;return{documentIdentifier:{docUrl:t.docUrl,driveId:t.driveId,docId:t.docId,fileName:null===(e=n.file)||void 0===e?void 0:e.name},wopiHostData:{bundleStaleness:null===(o=n.contentBundle)||void 0===o?void 0:o.staleness,bundleUrl:null===(i=n.contentBundle)||void 0===i?void 0:i.url,bundleVersion:null===(r=n.contentBundle)||void 0===r?void 0:r.majorVersion.toString(),downloadUrl:null===(u=n.file)||void 0===u?void 0:u.getUrl,eTag:null===(a=n.file)||void 0===a?void 0:a.eTag,fileName:null===(l=n.file)||void 0===l?void 0:l.name,fileSize:null===(c=n.file)||void 0===c?void 0:c.size,irmEnabled:null===(d=n.bootParams)||void 0===d?void 0:d.irmEnabled,protectionEnabled:null===(f=n.bootParams)||void 0===f?void 0:f.supportsDecryptedContentDownload,isNewFile:!!t.isNewFile,readOnly:!!(null===(v=n.bootParams)||void 0===v?void 0:v.readOnly),blocksDownload:!!(null===(h=n.bootParams)||void 0===h?void 0:h.viewOnly),sharePointInfo:{},wac:{bootstrapperUrl:s.W.bootstrapperUrl,applicationUrl:n.appUrl,userId:t.puid}},fetchDiagnostics:{}}}function v(n,t){var e;try{e=new URLSearchParams(new URL(n).search).get("sc")||void 0}catch(n){null==t||t.ULS.sendTraceTag(520135565,i.n.vo,r.k.Info,"Error trying to get session context from app URL: ".concat(JSON.stringify(n)))}return e}},3183:function(n,t,e){e.d(t,{$e:function(){return I},Im:function(){return b},K7:function(){return w},Mt:function(){return y},ND:function(){return T},PS:function(){return A},Q9:function(){return v},TB:function(){return m},VS:function(){return g},Xl:function(){return p},aT:function(){return U},ch:function(){return H},uU:function(){return h},wh:function(){return S}});var o=e(334),i=e(7070),r=e(7627),u=e(2808),s=e(9458),a=e(21),l=e(2368),c=e(8801),d=e(8068),f=e(3261),v="officecom";function h(){return JSON.stringify({pmo:window.location.origin,pmshare:!0,surl:void 0,curl:void 0,vurl:void 0,eurl:void 0})}function p(n,t,e,o,i,r,u,s){return{HostName:"office.com",HostSessionId:t,UserId:n,OwnerId:void 0,UiLocale:e,DataLocale:o,DisableChat:!0,CookieCompliant:!0,WdParams:u,DisableFocusOnBoot:!1,SessionContext:s||h(),HighContrastMode:null==r?void 0:r.highContrastMode,HideHeader:null==i?void 0:i.hideHeader,HideAppLauncherInHeader:null==i?void 0:i.hideAppLauncherInHeader,HideSearchInHeader:null==i?void 0:i.hideSearchInHeader,HideMeInHeader:null==i?void 0:i.hideMeInHeader,HideChatInHeader:null==i?void 0:i.hideChatInHeader,HideWorkflowInHeader:null==i?void 0:i.hideWorkflowInHeader,HideSettingsInHeader:null==i?void 0:i.hideSettingsInHeader,ShowAppIconInHeader:null==i?void 0:i.showAppIconInHeader,UseNeutralColorInHeader:null==i?void 0:i.useNeutralColorInHeader,SupportsDocReboot:null==i?void 0:i.supportsDocumentReboot,SupportsCreateNewDocument:null==i?void 0:i.supportsCreateNewDocument,SupportsAuthToken:null==i?void 0:i.supportsAuthToken,SupportsAtMentions:null==i?void 0:i.supportsAtMentions,SupportsMoveToFolder:null==i?void 0:i.supportsMoveToFolder,SupportsCommonFilePicker:null==i?void 0:i.supportsCommonFilePicker,SupportsDirectPrint:null==i?void 0:i.supportsDirectPrint,SupportsDirectDownload:null==i?void 0:i.supportsDirectDownload,MetaUiHostVersion:null==r?void 0:r.metaUiHostVersion,SupportsAccessibilityLoop:null==i?void 0:i.supportsAccessibilityLoop,SupportsExcelExternalLinks:null==i?void 0:i.supportsExcelExternalLinks,UiHostIntegrationType:null==i?void 0:i.uiHostIntegrationType,OpenLinksInNewWindow:null==i?void 0:i.openLinksInNewWindow,UiHostTabId:null==r?void 0:r.uiHostTabId,Upn:null==r?void 0:r.upn,TenantId:null==r?void 0:r.tenantId,Meeting:null==r?void 0:r.meeting,SupportsCustomAuthConfig:null==i?void 0:i.supportsCustomAuthConfig,ContentAssemblyMode:null==i?void 0:i.contentAssemblyMode,SupportsRefreshAccessToken:null==i?void 0:i.supportsRefreshAccessToken,IsSynthetic:null==r?void 0:r.isSynthetic,OwlVersion:null==r?void 0:r.owlVersion,OwlRollout:null==r?void 0:r.owlRollout,SupportsZipIt:null==r?void 0:r.supportsZipIt}}function m(n,t){var e,i,r,u=n.docId,s=n.isNewFile,a=n.fileName,l=n.intent;return t?(0,o.Cl)((0,o.Cl)({FileName:t.fileName,FileGetUrl:(null===(e=t.wac)||void 0===e?void 0:e.fileGetUrl)||t.downloadUrl,CustomFontCatalogUrl:t.wac.customFontCatalogUrl,FileSize:t.fileSize,BundleInfo:{Url:t.bundleUrl,MajorVersion:t.bundleVersion,BundleStaleness:t.bundleStaleness},ReadOnly:t.readOnly,IrmEnabled:t.irmEnabled,ViewOnly:t.blocksDownload,ETag:t.eTag,ClientThrottlingProtection:null===(i=t.wac)||void 0===i?void 0:i.clientThrottlingProtection,RequestedCallThrottling:null===(r=t.wac)||void 0===r?void 0:r.requestedCallThrottling,IsNewFile:!!s||t.isNewFile},u&&{DocUniqueId:u}),{OpenViewByDefault:"view"===l}):(0,o.Cl)({FileName:a,IsNewFile:!0},u&&{DocUniqueId:u})}function w(n){return{WopiSrc:n.wopiSrc,AccessToken:n.accessToken,AccessTokenExpiry:new Date(parseInt(n.accessTokenExpiry,10)),WacToken:n.wacToken}}function b(n){switch((0,l.rA)(n)){case l._Q.OneDrive:return"OneDrive";case l._Q.SharePoint:return"SharePoint Online";default:return"Unknown"}}function g(n,t,e,i,r,u,s){void 0===i&&(i={startTime:0,endTime:0}),void 0===r&&(r={startTime:0,endTime:0});var a=window.performance.timing,l=window.performance.navigation,c=l.redirectCount||0,d=a.navigationStart||0,f=a.fetchStart||0,v=a.responseEnd||0,h=a.requestStart||0,p=a.responseStart||0,m=a.responseEnd||0,w=a.domComplete||0,b="UNKNOWN";switch(l.type){case 0:b="NAVIGATE";break;case 1:b="RELOAD";break;case 2:b="BACK_FORWARD";break;case 255:b="RESERVED"}return(0,o.Cl)((0,o.Cl)({},S(n,t,e,i,r,u,s)),{hostPageNavigationStartTime:d,hostPageFetchStartTime:f,hostPageFetchEndTime:v,hostPageRequestStartTime:h,hostPageResponseStartTime:p,hostPageResponseEndTime:m,hostPageDomCompleteTime:w,hostPageRedirectCount:c,hostPageNavigationType:b})}function S(n,t,e,s,l,f,v){void 0===s&&(s={startTime:0,endTime:0}),void 0===l&&(l={startTime:0,endTime:0});var h=l.startTime||0,p=l.endTime||0,m=(0,i.u_)();(0,i.l8)("officeInitializationTime");var w,b,g=null==f?void 0:f.logger,S=(null==f?void 0:f.bootDiagnostics)||{},H=S.tabsCacheHit,C=S.packageEntryTime,I=S.isTestMode,A=S.ringId;n&&(w=m-n),C&&(b=m-C);var y=(0,o.Cl)((0,o.Cl)((0,o.Cl)({owlVersion:null==f?void 0:f.owlVersion},S),a.pP),{bootStrapStartTime:(null==l?void 0:l.startTime)||0,bootStrapEndTime:(null==l?void 0:l.endTime)||0,wopiDataStartTime:(null==s?void 0:s.startTime)||0,wopiDataEndTime:(null==s?void 0:s.endTime)||0,isCookieBlocked:!c.L,createNewEndTime:S.createNewStartTime?(0,i.u_)():void 0,owlFeatureGates:v?(0,d.c)(v):void 0});return a.pP.accessTokenStartTime=void 0,a.pP.accessTokenEndTime=void 0,a.pP.driveItemStartTime=void 0,a.pP.driveItemEndTime=void 0,a.pP.driveItemFromWacStartTime=void 0,a.pP.driveItemFromWacEndTime=void 0,a.pP.spRequestGuid=void 0,a.pP.createNewStartTime=void 0,a.pP.createNewEndTime=void 0,a.pP.loadManifestStartTime=void 0,a.pP.loadManifestEndTime=void 0,a.pP.getManifestFromRemoteTimeElapsed=void 0,a.pP.loadManifestServerTimeElapsed=void 0,a.pP.loadOwlStartTime=void 0,a.pP.loadOwlEndTime=void 0,a.pP.isVroom21=!1,null==g||g.ULS.sendTraceTag(556613895,r.n.vo,u.k.Info,"getDiagnostics: [SessionOrigin: ".concat(e,"][TabsCacheHit: ").concat(H,"][IsTestMode: ").concat(I,"][RingId: ").concat(A,"][TimeElapsedSinceUserClick:").concat(w,"][TimeElapsedSincePackageEntry: ").concat(b,"]")),{entryPoint:e,hostPageFirstFlushTime:t,userClickTime:n,officeBootstrapperStartTime:h,officeBootstrapperEndTime:p,officeInitializationTime:m,unifiedUiHostDiagnostics:y}}function H(n){var t="UNKNOWN";switch(null==n?void 0:n.navigation.type){case 0:t="NAVIGATE";break;case 1:t="RELOAD";break;case 2:t="BACK_FORWARD";break;case 255:t="RESERVED"}return{hostPageNavigationStartTime:(null==n?void 0:n.timing.navigationStart)||0,hostPageFetchStartTime:(null==n?void 0:n.timing.fetchStart)||0,hostPageFetchEndTime:(null==n?void 0:n.timing.responseEnd)||0,hostPageRequestStartTime:(null==n?void 0:n.timing.responseEnd)||0,hostPageResponseStartTime:(null==n?void 0:n.timing.responseStart)||0,hostPageResponseEndTime:(null==n?void 0:n.timing.responseEnd)||0,hostPageDomCompleteTime:(null==n?void 0:n.timing.domComplete)||0,hostPageRedirectCount:(null==n?void 0:n.navigation.redirectCount)||0,hostPageNavigationType:t}}var C=function(n){var t=new URL(n);return t.searchParams.delete("wopisrc"),t.href};function I(n){return function(t){var e=t;switch(t){case"OfficeComWordJsApiV2":case"OfficeComExcelJsApiV2":case"OfficeComPptJsApiV2":return!0;case"OfficeUnifiedUiHostTeams":e="unifiedUiHostInTeams"}if((null==n?void 0:n.experiments)&&e in(null==n?void 0:n.experiments))return function(n){switch(n){case 0:return!1;case 1:return!0;default:return}}(null==n?void 0:n.experiments[e])}}function A(n,t,e){switch(n){case s.p.Word:case s.p.PowerPoint:case s.p.Excel:case s.p.Visio:return!0;case s.p.OneNote:var o=(0,f.SI)(f.dT.FeatureGate_OneNoteJsApiV2Gate,t);return(0,f.lO)(f.dT.FeatureGate_OneNoteJsApiV2Gate,o,e),o;default:return!1}}function y(n,t,e,o,i){var r,u,s=n?(null===(r=n.wac)||void 0===r?void 0:r.applicationUrl)||(null===(u=n.wac)||void 0===u?void 0:u.editUrl):C(t);return s?function(n,t,e,o,i,r){var u="".concat(n,"&uih=").concat(t);return(null==r||r)&&(u="".concat(u,"&uiEmbed=1")),o&&(u="".concat(u,"&wdTpl=").concat(o)),i&&(u="".concat(u,"&wdlcid=").concat(i)),e&&(u="".concat(u,"&actNavId=").concat(e)),u}(s,e,o.navId,o.templateId,o.rebootOverrideData?o.rebootOverrideData.lcid:o.uiCulture,i):""}function U(n){var t;return n?((t={}).wd=encodeURIComponent(n),t):{}}function T(n,t,e,i,r,u,s,a,l,c,d,f,v,h,p,m,w,b,g,S){var H=t.applicationUrl,C=t.bootstrapperUrl;void 0===l&&(l="officecom"),void 0===S&&(S={});var A={HostUIControls:b?[{id:"close",visibility:f?1:0},{id:"share",visibility:v?1:0},{id:"ellipsisOpenInBrowser",visibility:h?1:0},{id:"ellipsisDownload",visibility:p?1:0},{id:"copyLink",visibility:m?1:0},{id:"conversation",visibility:g?1:0}]:void 0,additionalApplicationParameters:S},U=y(d,H,l,c,w);return(0,o.Cl)({BootstrapperUrl:C,Container:n,SessionInformation:i,ApplicationUrl:U,WopiPrecheckInfo:r,ApplicationCustomSettings:A,Diagnostics:u,FnOnInitializeSuccess:s,FnOnInitializeFailure:a,FnIsFeatureEnabled:I(),RebootOverrideData:c.rebootOverrideData},e?{WopiInfo:e}:{})}},5851:function(n,t,e){e.d(t,{RC:function(){return s},SM:function(){return r},Ko:function(){return u},bn:function(){return a},j0:function(){return o}});var o,i=e(334),r=[];function u(){r=[]}function s(n){var t=this;return function(o){return(0,i.sH)(t,void 0,void 0,(function(){return(0,i.YH)(this,(function(t){switch(t.label){case 0:return[4,e.e(6720).then(e.bind(e,5492))];case 1:return[4,t.sent().wopiInfoFromUrlHandler(n,o)];case 2:return t.sent(),[2]}}))}))}}function a(n){var t=this;return function(o){return(0,i.sH)(t,void 0,void 0,(function(){return(0,i.YH)(this,(function(t){switch(t.label){case 0:return[4,e.e(6720).then(e.bind(e,5492))];case 1:return[4,t.sent().davUrlFromIdsHandler(n,o)];case 2:return t.sent(),[2]}}))}))}}!function(n){n[n.GetWopiInfoFromUrl=0]="GetWopiInfoFromUrl",n[n.GetDavUrlFromIds=1]="GetDavUrlFromIds"}(o||(o={}))},1999:function(n,t,e){e.d(t,{Q:function(){return s}});var o=e(7627),i=e(2808),r=e(4105),u=e(4999);function s(n,t,e,s,a){if(s){var l=function(n){switch(n){case r.Ph.PostMessage_RefreshSessionInfo:return u.Y.sendSessionInfo;case r.Ph.PostMessage_GrantPermissions:return u.Y.sendUserAccessAndPermissions;case r.Ph.PostMessage_SetAuthToken:return u.Y.sendAuthToken;case r.Ph.PostMessage_HostAccessibilityLoopComplete:return u.Y.continueAccessibilityLoop;case r.Ph.PostMessage_SetHostWopiInfoFromUrl:return u.Y.sendWopiInfo;case r.Ph.PostMessage_MoveToFolderCompleted:return u.Y.moveToFolder;case r.Ph.PostMessage_CompleteFilePicker:return u.Y.completeSharedFilePicker;case r.Ph.PostMessage_SendCustomAuthConfig:return u.Y.sendCustomAuthConfig;case r.Ph.PostMessage_SetDavUrlFromIds:return u.Y.sendDavUrl;case r.Ph.PostMessage_BlurFocus:return u.Y.blurFocus;case r.Ph.PostMessage_PopState:return u.Y.popState;case r.Ph.PostMessage_GrabFocus:return u.Y.grabFocus;case r.Ph.PostMessage_HostGetClientUrl:return u.Y.getClientUrl;case r.Ph.PostMessage_HostGetWebUrl:return u.Y.getWebUrl;case r.Ph.PostMessage_HostBackButtonPressed:return u.Y.backButtonPressed;case r.Ph.PostMessage_HostSendChannelId:return u.Y.sendChannelId;case r.Ph.PostMessage_HostSendConversationId:return u.Y.sendConvId;case r.Ph.PostMessage_PostWacToken:return u.Y.postWacToken;default:return}}(n);if(l){var c=l;s.run(c,t).catch((function(n){return null==a?void 0:a.ULS.sendTraceTag(512337544,o.n.vo,i.k.Warning,"Failed to send post message. officeDocumentSession.run returned error: ".concat(n))}))}}else e?e.then((function(e){e?function(n,t,e,r){var u,s=null;try{s=new URL(n)}catch(t){return void(null==r||r.ULS.sendTraceTag(541180047,o.n.vo,i.k.Warning,"Failed to send post message. could not create url from ".concat(n," with error: ").concat(t)))}var a=s.origin,l={MessageId:t,SendTime:(new Date).getTime(),Values:e},c=JSON.stringify(l),d=document.getElementById("WebApplicationFrame");d?null===(u=null==d?void 0:d.contentWindow)||void 0===u||u.postMessage(c,a):null==r||r.ULS.sendTraceTag(541180048,o.n.vo,i.k.Warning,"Failed to send post message. Could not find iframe")}(e,n,t,a):null==a||a.ULS.sendTraceTag(541180045,o.n.vo,i.k.Warning,"Failed to send post message. appUrl is null")})).catch((function(n){return null==a?void 0:a.ULS.sendTraceTag(512337543,o.n.vo,i.k.Warning,"Failed to send post message. appUrlPromise failed to resolve with error: ".concat(n))})):null==a||a.ULS.sendTraceTag(541180046,o.n.vo,i.k.Warning,"Failed to send post message. Both documentSession and appUrlPromise are null")}},620:function(n,t,e){var o;function i(n){var t=n.toUpperCase();return"CHC"===t||"DEC"===t||"EUC"===t||"EURPPC"===t||"FRC"===t||"SEC"===t||"NOC"===t?o.EuropeanUnion:o.RestOfWorld}e.d(t,{n:function(){return o},y:function(){return i}}),function(n){n[n.RestOfWorld=0]="RestOfWorld",n[n.EuropeanUnion=1]="EuropeanUnion"}(o||(o={}))},3118:function(n,t,e){e.d(t,{C6:function(){return u},ob:function(){return s},yc:function(){return r}});var o=e(620);function i(n,t){switch(n){case"FASTFOOD":return"https://ffc-common.online.office.com/suite/";case"MSIT":return"https://ppc-common.online.office.com/suite/";case"PRODUCTION":default:return t===o.n.EuropeanUnion?"https://euc-common.online.office.com/suite/":"https://common.online.office.com/suite/";case"GALLATIN":return"https://common.partner.officewebapps.cn/suite/";case"USGOV":return"https://gbc-common.online.office.com/suite/";case"TRAILBLAZER":return"https://common.gov.online.office365.us/suite/";case"PATHFINDER":return"https://common.dod.online.office365.us/suite/";case"AIRGAP08":return"https://common.wac.online.office.eaglex.ic.gov/suite/";case"AIRGAP09":return"https://common.wac.online.office.microsoft.scloud/suite/"}}function r(n,t){return i(n,t)+"RemoteUls.ashx"}function u(n,t,e){var o=i(n,e)+"RemoteTelemetry.ashx";return t&&(o+="?usid="+t),o}function s(n){switch(n){case"GALLATIN":return"https://microsoftgraph.chinacloudapi.cn";case"TRAILBLAZER":return"https://graph.microsoft.us";case"PATHFINDER":return"https://dod-graph.microsoft.us";case"AIRGAP08":return"https://graph.eaglex.ic.gov";case"AIRGAP09":return"https://graph.microsoft.scloud";default:return"https://graph.microsoft.com"}}},4105:function(n,t,e){var o,i,r,u,s,a;e.d(t,{O5:function(){return o},Ph:function(){return u},bi:function(){return i},n_:function(){return s}}),function(n){n.Event_DocumentReboot="DocReboot",n.Event_SetOverlayContent="SetOverlayContent",n.Event_GetWopiInfoFromUrl="WopiInfoFromUrl",n.Event_Unloaded="Unloaded",n.Event_MoveToFolder="MoveToFolder",n.Event_SharedFilePicker="FilePicker",n.Event_GetCustomAuthConfig="GetCustomAuthConfig",n.Event_GetDavUrlFromIds="DavUrlFromIds"}(o||(o={})),function(n){n.PostMessage_FileRenamed="File_Rename",n.PostMessage_Close="UI_Close",n.PostMessage_EditModeSwitch="UI_Edit",n.PostMessage_FileVersion="UI_FileVersions",n.PostMessage_SaveStatus="UI_SaveStatus",n.PostMessage_Share="UI_Sharing",n.PostMessage_Workflow="UI_Workflow",n.PostMessage_UserActivity="User_Activity",n.PostMessage_EditNotification="Edit_Notification",n.PostMessage_CheckUserAccess="UI_CheckUserAccessAndGrantPermissions",n.PostMessage_PostMessageDocReboot="App_DocReboot",n.PostMessage_AppRefreshSessionInfo="App_RefreshSessionInfo",n.PostMessage_AppCreateNewDocument="App_CreateNewDocument",n.PostMessage_GetAuthToken="App_GetAuthToken",n.PostMessage_NavigateBackToHost="NavigateBackToHost",n.PostMessage_SendConversationId="App_SendConversationId",n.PostMessage_CloseTeamsConversation="CloseTeamsConversation",n.PostMessage_AccessibilityLoopComplete="App_AccessibilityLoopComplete",n.PostMessage_GetClientUrlComplete="App_GetClientUrlComplete",n.PostMessage_GetWebUrlComplete="App_GetWebUrlComplete",n.PostMessage_LoadingStatus="App_LoadingStatus",n.PostMessage_ActionComplete="Wac_ActionComplete",n.PostMessage_OpenInBrowser="UI_OpenInBrowser",n.PostMessage_AppGetCustomAuthConfig="App_GetCustomAuthConfig",n.PostMessage_AppPushState="App_PushState",n.PostMessage_CAAEMessage="CAAEMessage",n.PostMessage_FileEmbed="UI_FileEmbed",n.PostMessage_AcquireOAuthTokenTeams="AcquireOAuthTokenTeams"}(i||(i={})),function(n){n.Nav="actnavid"}(r||(r={})),function(n){n.PostMessage_RefreshSessionInfo="Host_RefreshSessionInfo",n.PostMessage_GrantPermissions="CheckUserAccessAndGrantPermissions_Result",n.PostMessage_SetOverlayContent="SetOverlayContent",n.PostMessage_SetAuthToken="Host_SetAuthToken",n.PostMessage_SetHostWopiInfoFromUrl="Host_WopiInfoFromUrl",n.PostMessage_HostAccessibilityLoopComplete="Host_AccessibilityLoopComplete",n.PostMessage_HostGetClientUrl="Host_GetClientUrl",n.PostMessage_HostGetWebUrl="Host_GetWebUrl",n.PostMessage_MoveToFolderCompleted="Host_MoveToFolder",n.PostMessage_CompleteFilePicker="Host_FilePicker",n.PostMessage_SendCustomAuthConfig="Host_SetCustomAuthConfig",n.PostMessage_SetDavUrlFromIds="Host_DavUrlFromIds",n.PostMessage_BlurFocus="Blur_Focus",n.PostMessage_PopState="App_PopState",n.PostMessage_GrabFocus="Grab_Focus",n.PostMessage_HostSendChannelId="Host_SendChannelId",n.PostMessage_HostBackButtonPressed="Host_BackButtonPressed",n.PostMessage_HostSendConversationId="Host_SendConversationId",n.PostMessage_PostWacToken="Host_PostWacToken"}(u||(u={})),function(n){n.SameDocument="0",n.NewDocument="1"}(s||(s={})),function(n){n.AccessToken="AccessToken",n.FileGetUrl="FileGetUrl"}(a||(a={}))},8790:function(n,t,e){e.d(t,{Ip:function(){return c},R7:function(){return l},Rt:function(){return v},hK:function(){return a},wR:function(){return f}});var o=e(334),i=e(8970),r=e(3238),u=e(3118),s=e(9458),a=function(){function n(n,t){var e;"string"==typeof n?this.sessionId=n:(e=(0,o.zs)(n,1),this.sessionId=e[0]),this.environment=t,this.logger=this.setUlsLogger(this.sessionId)}return n.prototype.setUlsLogger=function(n){var t=(0,u.yc)(this.environment);return(0,i.Jf)({remoteUlsEndpoint:t,sessionId:n})},n}(),l=function(n,t,e,o,i,s,a,l,c,d,f,v){var h,p=(0,u.C6)(e,n),m={application:t.toString(),applicationMode:"UnifiedUiHost",applicationModeExtended:"UNIFIEDUIHOST",session_id:n,clientVersion:null!=o?o:"n/a",isSynthetic:s,applicationLcid:a,loggableUserId:l,tenantId:c,uiHost:d,uiHostIntegrationType:f,sessionOrigin:v};this.health=r.Xk.getInstance(),this.health.initialize({isHealthEnabled:!0,isOfflineEnabled:!1,remoteTelemetryUrl:p,dimensions:m}),this.health.addOrUpdatePartCDimension("UUIHTargetApp",t.toString()),this.health.addOrUpdatePartCDimension("HealthSourceComponent","UnifiedUiHost"),this.health.addOrUpdatePartCDimension("WiseEnvironment",e.toString()),this.health.addOrUpdatePartCDimension("Exposure",null!==(h=null==i?void 0:i.toString())&&void 0!==h?h:"n/a")};function c(){var n,t=null===(n=performance.getEntriesByType("navigation")[0])||void 0===n?void 0:n.toJSON();if(t)return{connectEnd:t.connectEnd,connectStart:t.connectStart,decodedBodySize:t.decodedBodySize,domainLookupEnd:t.domainLookupEnd,domainLookupStart:t.domainLookupStart,domComplete:t.domComplete,domContentLoadedEventEnd:t.domContentLoadedEventEnd,domContentLoadedEventStart:t.domContentLoadedEventStart,domInteractive:t.domInteractive,duration:t.duration,encodedBodySize:t.encodedBodySize,entryType:t.entryType,fetchStart:t.fetchStart,initiatorType:t.initiatorType,loadEventEnd:t.loadEventEnd,loadEventStart:t.loadEventStart,nextHopProtocol:t.nextHopProtocol,redirectCount:t.redirectCount,redirectEnd:t.redirectEnd,redirectStart:t.redirectStart,requestStart:t.requestStart,responseEnd:t.responseEnd,responseStart:t.responseStart,secureConnectionStart:t.secureConnectionStart,serverTiming:t.serverTiming,startTime:t.startTime,transferSize:t.transferSize,type:t.type,unloadEventEnd:t.unloadEventEnd,unloadEventStart:t.unloadEventStart,workerStart:t.workerStart}}function d(n,t){var e,o,i=window.performance.getEntriesByType("resource").filter((function(e){return e.name.includes(n)&&e.name.endsWith(t)})),r=null===(e=i[0])||void 0===e?void 0:e.toJSON();if(r)return{connectStart:r.connectStart,secureConnectionStart:r.secureConnectionStart,connectEnd:r.connectEnd,domainLookupStart:r.domainLookupStart,domainLookupEnd:r.domainLookupEnd,redirectStart:r.redirectStart,redirectEnd:r.redirectEnd,requestStart:r.requestStart,responseStart:r.responseStart,responseEnd:r.responseEnd,fetchStart:r.fetchStart,workerStart:r.workerStart,duration:r.duration,decodedBodySize:r.decodedBodySize,encodedBodySize:r.encodedBodySize,transferSize:r.transferSize,entryType:r.entryType,initiatorType:r.initiatorType,nextHopProtocol:r.nextHopProtocol,serverTiming:r.serverTiming,startTime:r.startTime,isCached:(o=r,o.transferSize>=0?0===o.transferSize:o.responseEnd-o.fetchStart<100)}}function f(){return d("owl.slim",".js")}function v(n){var t=void 0;switch(n){case s.p.Word:t="word.boot";break;case s.p.Excel:t="excel-boot";break;case s.p.PowerPoint:t="powerpoint.app.boot";break;case s.p.OneNote:t="onenote-boot";break;case s.p.Visio:t="visio.boot";break;default:return}return d(t,".js")}},21:function(n,t,e){var o,i,r,u,s,a,l;e.d(t,{R7:function(){return a},S2:function(){return r},SQ:function(){return c},by:function(){return s},ex:function(){return i},pP:function(){return d},zJ:function(){return u}}),function(n){n.DriveId="drive",n.ItemId="item",n.DocUrl="file",n.ContentUri="contenturi",n.Nav="nav"}(o||(o={})),function(n){n.Vo="DavUrlFromIds",n.Go="FilePicker",n.Jo="OwlBoot",n.Ro="OwlPostWacTokenForTeams",n.qo="PostWacToken",n.zo="PrebootDocument",n.Zo="PrebootDocumentOpen",n.Qo="WopiAuthRefresh",n.Xo="WopiAuthFetch",n.Yo="WopiInfoFromUrl"}(i||(i={})),function(n){n.FC_Owl="owlfc"}(r||(r={})),function(n){n.QosVeto_ShareDialogExperienceDegraded="ShareDialogExperienceDegraded",n.QosVeto_CreateNewExperienceDegraded="CreateNewExperienceDegraded",n.QosVeto_ExternalLinksExperienceDegraded="ExternalLinksExperienceDegraded",n.QosVeto_WopiAuthExperienceDegraded="WopiAuthExperienceDegraded",n.QosVeto_FilePickerFailed="FilePickerFailed",n.QosVeto_OpenInExperienceFailed="OpenInExperienceFailed"}(u||(u={})),function(n){n.QosError_VroomWopiFailure="VroomWopiFailure",n.QosError_OfficeBootstrapperNotLoaded="OfficeBootstrapperNotLoaded",n.QosError_EncounteredJsApiError="EncounteredJsApiError",n.QosError_FailedToLoadDocument="FailedToLoadDocument",n.QosError_AttemptingToBootDocumentFailed="AttemptingToBootDocumentFailed",n.QosError_DavUrlFromIdsFailure="DavUrlFromIdsFailure",n.QosError_ShareDialogHandlerInitFailure="ShareDialogHandlerInitFailure",n.QosError_ShareDialogHandlerHostReportedFailure="ShareDialogHandlerHostReportedFailure",n.QosError_ShareDialogHandlerGenericFailure="ShareDialogHandlerGenericFailure",n.QosError_ShareDialogHandlerPerfFailure="ShareDialogHandlerPerfFailure",n.QosError_CreateNewHandlerRebootSessionFailure="CreateNewHandlerRebootSessionFailure",n.QosError_CreateNewHandlerCreateDocumentFailure="CreateNewHandlerCreateDocumentFailure",n.QosError_CreateNewHandlerEndSessionFailure="CreateNewHandlerEndSessionFailure",n.QosError_CreateNewHandlerGenericFailure="CreateNewHandlerGenericFailure",n.QosError_WopiRefreshAuthTokenFailure="WopiRefreshAuthTokenFailure",n.QosError_WopiFetchAuthTokenFailure="WopiFetchAuthTokenFailure",n.QosError_WopiInfoFromUrlFailure="WopiInfoFromUrlFailure",n.QosError_FilePickerBootFailed="FilePickerBootFailed",n.QosError_RetrievingWopiHostDataFailed="RetrievingWopiHostDataFailed",n.QosError_SelectedItemNotReturned="SelectedItemNotReturned",n.QosError_SelectedItemMissingProperties="SelectedItemMissingProperties",n.QosError_UrlNotProvided="UrlNotProvided",n.QosError_CallbackNotDefined="CallbackNotDefined"}(s||(s={})),function(n){n.Fo="Bootstrapfile_WacDocumentVroomError",n.Lo="LoadDocument_WacDocumentVroomError",n.xo="WacDocumentBootstrapperLoadError",n.Bo="WacInitializeWopiPendingError",n.$o="WacDocumentGenericBootError",n._o="WacDocumentJsApiV1Error",n.Mo="WacDocumentJsApiV2Error",n.Oo="WacDocumentJsApiV2Error_App",n.jo="WacDocumentJsApiV2Error_JsApi",n.Do="WacDocumentJsApiV2Error_Timeout"}(a||(a={})),function(n){n.PermissionError="PermissionError",n.NotFound="NotFound",n.Throttling="Throttling",n.Offline="Offline",n.Other="Other"}(l||(l={}));var c,d={};!function(n){n.New="NEW",n.BackstageMru="BACKSTAGE-MRU",n.Reboot="REBOOT"}(c||(c={}))},8478:function(n,t,e){e.d(t,{W:function(){return h},d:function(){return p}});var o=e(334),i=e(7627),r=e(2808),u=e(3183),s=e(9278),a=e(6141),l=e(7282),c=e(4999),d=e(9424),f=e(2224),v=e(3261),h=function(){function n(){}return Object.defineProperty(n,"isCreateNewFlowExecuting",{get:function(){return!!(n.isTwoStepCreateNew&&n.createNewFlowExecuting&&n.hostSessionId&&n.bootstrapper&&n.bootstrapperLoadPromise&&n.bootstrapperUrl&&n.bootstrapperInfo&&n.application&&n.session)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"isCreateNewFlowExecutingForJsApiBundledWithOwl",{get:function(){return!!(n.isTwoStepCreateNew&&n.createNewFlowExecuting&&n.hostSessionId&&n.bootstrapperUrl&&n.application&&n.session)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"completeCreateNewPromise",{get:function(){return n.ni},enumerable:!1,configurable:!0}),n.completeCreateNew=function(n){this.ti.resolve&&this.ti.resolve(n)},n.failCreateNew=function(n){this.ti.reject&&this.ti.reject(n)},n.isTwoStepCreateNew=!1,n.createNewFlowExecuting=!1,n.sessionPromise=new f.Z,n.ti={},n.ni=new Promise((function(t,e){n.ti.resolve=t,n.ti.reject=e})),n}();function p(n,t){var e,f,p,m,w,b,g;if(h.isTwoStepCreateNew=!!(n.documentBootInfo.isNewFile&&n.documentBootInfo.isTwoStepCreateNew&&n.sessionConfig.createNewParams&&n.sessionConfig.createNewParams.appUrl&&(0,u.PS)(n.documentBootInfo.fileType,null===(e=n.uiHostConfig)||void 0===e?void 0:e.featureGates,t)&&(null===(f=n.initPackageParams)||void 0===f?void 0:f.jsApiUrlInfos)&&(null===(p=n.initPackageParams)||void 0===p?void 0:p.jsApiUrlInfos.get(n.documentBootInfo.fileType))),h.isTwoStepCreateNew){var S=n.initPackageParams.jsApiUrlInfos.get(n.documentBootInfo.fileType);if(S){h.bootstrapperUrl=S.jsApiUrl,h.hostSessionId=(0,s.d$)(n.sessionConfig.hostCorrelationId);var H=(0,v.SI)(v.dT.FeatureGate_EnableJsapiTags,null===(w=n.uiHostConfig)||void 0===w?void 0:w.featureGates);(0,v.lO)(v.dT.FeatureGate_EnableJsapiTags,H,t),h.bootstrapperLoadPromise=(0,a.k)(S.jsApiUrl,n.sessionConfig.createNewParams.appUrl,n.documentBootInfo.fileType,!0,n.sessionConfig.wiseEnvironment,t,S.jsApiSri,null===(g=null===(b=n.sessionConfig)||void 0===b?void 0:b.owlRollout)||void 0===g?void 0:g.includes("LOCALHOST"),H).then((function(e){var u,s=(0,o.zs)((0,a.K)(n.documentBootInfo.fileType),2),f=s[0],p=s[1];if(p||!f||!h.hostSessionId)return null==t||t.ULS.sendTraceTag(507778318,i.n.vo,r.k.Warning,"Failed to load bootstrapper for ".concat(n.documentBootInfo.fileType," in 2-step create new flow. Error: ").concat(p)),!1;h.bootstrapper=f,h.bootstrapperInfo=e,h.application=f.createApplication((0,d.I)(n.documentBootInfo,h.bootstrapperInfo.bootstrapperUrl,n.uiHostConfig,n.sessionConfig));var m=(0,v.SI)(v.dT.FeatureGate_EnableSingleOwlJsapiLogger,null===(u=n.uiHostConfig)||void 0===u?void 0:u.featureGates);h.session=h.application.createSession({hostSessionId:h.hostSessionId,logger:m?t:void 0}),h.sessionPromise.resolve(h.session),h.createNewFlowExecuting=!0;var w=(0,l.lW)(n.sessionConfig.createNewParams,n.documentBootInfo,n.container,n.uiHostConfig,n.sessionConfig);return h.session.run(c.Y.createNew,w).catch((function(n){null==t||t.ULS.sendTraceTag(507778317,i.n.vo,r.k.Warning,"Caught error running create new flow: ".concat(n)),h.createNewFlowExecuting=!1})),!0})).catch((function(e){return null==t||t.ULS.sendTraceTag(507778316,i.n.vo,r.k.Warning,"Failed to load bootstrapper for ".concat(n.documentBootInfo.fileType," in 2-step create new flow. Error: ").concat(e)),!1}))}else null==t||t.ULS.sendTraceTag(507778319,i.n.vo,r.k.Warning,"jsapiBootstrapperUrl for ".concat(n.documentBootInfo.fileType," is undefined in ").concat(null===(m=n.uiHostConfig)||void 0===m?void 0:m.uiHostName))}}},2394:function(n,t,e){e.d(t,{TX:function(){return r},wA:function(){return u},yC:function(){return s}});var o=e(334),i=e(21);function r(n){return!(!n||!n.failure)&&"TypeError: Failed to fetch"===n.failure}function u(n){switch(n){case i.R7.Fo:case i.R7.Lo:return!1;default:return!0}}function s(n){var t=n.httpErrorCode,e=n.networkError,r=n.qosErrorName,u=n.errorMessage,s=n.error,c=n.documentLoadedWithTabSwitch,d=r===i.by.QosError_EncounteredJsApiError&&"timeout"===u&&c;return e||d||[401,403,404,429].includes(t)||function(n){var t,e,i,r;if(!n)return!1;try{for(var u=[JSON.parse(n)];u.length>0;){var s=u.pop();if("string"==typeof s){if(a.has(s))return!0}else if("object"==typeof s&&null!==s)try{for(var c=(t=void 0,(0,o.Ju)(Object.values(s))),d=c.next();!d.done;d=c.next()){var f=d.value;u.push(f)}}catch(n){t={error:n}}finally{try{d&&!d.done&&(e=c.return)&&e.call(c)}finally{if(t)throw t.error}}}}catch(t){try{for(var v=(0,o.Ju)(l),h=v.next();!h.done;h=v.next()){var p=h.value;if(-1!==n.indexOf(p))return!0}}catch(n){i={error:n}}finally{try{h&&!h.done&&(r=v.return)&&r.call(v)}finally{if(i)throw i.error}}}return!1}(JSON.stringify(s))}var a=new Set(["DocumentIsIRMProtected","5373959","5243086","5243055","5374037","5373972","5373968","5373967","5373965","5373961","5243101","29"]),l=Array.from(a)},3261:function(n,t,e){e.d(t,{SI:function(){return s},dT:function(){return o},lO:function(){return u}});var o,i=e(7627),r=e(2808);function u(n,t,e){null==e||e.ULS.sendTraceTag(521164238,i.n.vo,r.k.Info,"".concat(n,": ").concat(t?"Enabled":"Disabled"))}function s(n,t){if(!t)return!1;if(!t.has(n))return!1;var e=t.get(n);return null!=e&&"boolean"==typeof e&&e}!function(n){n.FeatureGate_OneNoteJsApiV2Gate="OneNoteJsApiV2Gate",n.FeatureGate_StartPageUseOWLGate="StartPageUseOWLGate",n.FeatureGate_GrabFocusOnFilePickerCloseGate="GrabFocusOnFilePickerCloseGate",n.FeatureGate_Vroom21SupportGate="Vroom21SupportGate",n.FeatureGate_CommandingAshaVetoes="CommandingAshaVetoes",n.FeatureGate_ESSForXLGate="ESSForXL",n.FeatureGate_Vroom21ForWord="Vroom21ForWord",n.FeatureGate_Vroom21ForExcel="Vroom21ForExcel",n.FeatureGate_PrefetchWacToken="PrefetchWacToken",n.FeatureGate_UseNewEuplReporting="UseNewEuplReporting",n.FeatureGate_PostWacTokenAsync="PostWacTokenAsync",n.FeatureGate_DeprecatePreAuthUrl="DeprecatePreAuthUrl",n.FeatureGate_UseUnifiedBundling="UseUnifiedBundling",n.FeatureGate_OwlPostWacTokenForTeamsHosts="OwlPostWacTokenForTeamsHosts",n.FeatureGate_EnableSingleOwlJsapiLogger="EnableSingleOwlJsapiLogger",n.FeatureGate_EnableJsapiTags="IsOwlAdditionalJsapiTagsEnabled",n.FeatureGate_ShowHeaderOneNote="ShowHeaderOneNote",n.FeatureGate_OneNoteTeamsClaimsHandling="OneNoteTeamsClaimsHandling",n.FeatureGate_UseWacParamsCopy="UseWacParamsCopy",n.FeatureGate_OneNotePersonalAppRedirectToLegacyMyNotebookPage="OneNotePersonalAppRedirectToLegacyMyNotebookPage",n.FeatureGate_EnableAriaLoggingForShareDialogLaunch="enableAriaLoggingForShareDialogLaunch",n.FeatureGate_UseLoadJSApiWithOWLEnabled="UseLoadJSApiWithOWLEnabled",n.FeatureGate_UseSeparateVroomAccessTokenFn="UseSeparateVroomAccessTokenFn"}(o||(o={}))},8801:function(n,t,e){e.d(t,{L:function(){return o}}),e(7627),e(2808);var o=function(){var n=void 0;try{n=window.localStorage}catch(n){}return n}()},4056:function(n,t,e){function o(n){return new Map([["ErrorName","".concat(n.wacErrorName)+(n.errorName?"_".concat(n.errorName):"")],["ErrorMessage",n.errorMessage?n.errorMessage:""],["HttpErrorCode","".concat(n.httpErrorCode)],["NetworkError","".concat(n.networkError)],["DocumentLoadedWithTabSwitch","".concat(n.documentLoadedWithTabSwitch)]])}e.d(t,{C:function(){return o}})},9424:function(n,t,e){e.d(t,{I:function(){return i}});var o=e(3183);function i(n,t,e,i,r){var u,s,a,l,c,d,f,v,h,p,m,w;return{host:{storageHostName:(0,o.Im)(null!==(u=n.docUrl)&&void 0!==u?u:""),capabilities:{isFeatureEnabledCallback:(0,o.$e)(i),moveToFolder:null==e?void 0:e.supportsMoveToFolder,commonFilePicker:null==e?void 0:e.supportsCommonFilePicker,rebootDoc:null==e?void 0:e.supportsDocumentReboot,createNewDoc:null==e?void 0:e.supportsCreateNewDocument,authToken:null==e?void 0:e.supportsAuthToken,excelExternalLinks:null==e?void 0:e.supportsExcelExternalLinks,refreshAccessToken:null==e?void 0:e.supportsRefreshAccessToken,atMentions:null==e?void 0:e.supportsAtMentions,accessibilityLoop:null==e?void 0:e.supportsAccessibilityLoop,customAuthConfig:null==e?void 0:e.supportsCustomAuthConfig,directPrint:null===(s=null==e?void 0:e.supportsDirectPrint)||void 0===s||s,directDownload:null==e?void 0:e.supportsDirectDownload},uiHostName:(null==e?void 0:e.uiHostName)||o.Q9,requireExplicitUnload:null==e?void 0:e.supportsExplicitUnload,metaUiHostVersion:null==i?void 0:i.metaUiHostVersion,uiHostIntegrationType:null==e?void 0:e.uiHostIntegrationType,uiHostScenarioType:null===(a=null==i?void 0:i.additionalApplicationParameters)||void 0===a?void 0:a.uiHostScenarioType,owlVersion:null==i?void 0:i.owlVersion,owlRollout:null==i?void 0:i.owlRollout,origin:null==i?void 0:i.origin},user:{id:r&&r.wac&&r.wac.userId||n.puid||"",isSynthetic:null==i?void 0:i.isSynthetic},bootstrapperUrl:t,ui:{uiEmbed:null===(l=null==e?void 0:e.uiEmbed)||void 0===l||l,controls:(null==e?void 0:e.supportsHostUiControls)?[{id:"close",visibility:(null==e?void 0:e.showCloseButton)?1:0},{id:"share",visibility:(null==e?void 0:e.supportsShare)?1:0},{id:"ellipsisOpenInBrowser",visibility:(null==e?void 0:e.openInBrowserEnabled)?1:0},{id:"ellipsisDownload",visibility:(null==e?void 0:e.ellipsisDownloadACopyButtonEnabled)?1:0},{id:"copyLink",visibility:(null==e?void 0:e.copyLinkEnabled)?1:0},{id:"conversation",visibility:(null==e?void 0:e.conversationButtonEnabled)?1:0}]:void 0,language:n.uiCulture,hideHeader:null==e?void 0:e.hideHeader,hideAppLauncherInHeader:null==e?void 0:e.hideAppLauncherInHeader,hideSearchInHeader:null==e?void 0:e.hideSearchInHeader,hideMeInHeader:null==e?void 0:e.hideMeInHeader,hideChatInHeader:null==e?void 0:e.hideChatInHeader,hideWorkflowInHeader:null==e?void 0:e.hideWorkflowInHeader,hideSettingsInHeader:null==e?void 0:e.hideSettingsInHeader,showAppIconInHeader:null==e?void 0:e.showAppIconInHeader,useNeutralColorInHeader:null==e?void 0:e.useNeutralColorInHeader,highContrast:"invert"===(null==i?void 0:i.highContrastMode)?"invert":void 0,openLinksInNewWindow:null==e?void 0:e.openLinksInNewWindow,contentAssemblyMode:null==e?void 0:e.contentAssemblyMode,showNotebookList:"1"===(null===(c=null==i?void 0:i.additionalApplicationParameters)||void 0===c?void 0:c.shownotebooklist),enableMobileViewer:"1"===(null===(d=null==i?void 0:i.additionalApplicationParameters)||void 0===d?void 0:d.wdMobileEmbedOneNoteViewer),mobileEmbedView:"1"===(null===(f=null==i?void 0:i.additionalApplicationParameters)||void 0===f?void 0:f.wdMobileEmbedOneNoteViewer),showBreadcrumbInMobileView:"1"===(null===(v=null==i?void 0:i.additionalApplicationParameters)||void 0===v?void 0:v.wdMobileEmbedOneNoteViewer),showInternalFeedback:"1"===(null===(h=null==i?void 0:i.additionalApplicationParameters)||void 0===h?void 0:h.wdNotesInternalFeedbackEnabled),embed:"1"===(null===(p=null==i?void 0:i.additionalApplicationParameters)||void 0===p?void 0:p.embed),embedded:"1"===(null===(m=null==i?void 0:i.additionalApplicationParameters)||void 0===m?void 0:m.embedded),hidesections:"1"===(null===(w=null==i?void 0:i.additionalApplicationParameters)||void 0===w?void 0:w.hidesections)}}}},2573:function(n,t,e){e.d(t,{ls:function(){return o},nC:function(){return u},nu:function(){return r}});var o,i=e(334);function r(n){var t;void 0===n&&(n="");var e=null===(t=window.performance.getEntriesByName(o.OwlHostTimeOrigin)[0])||void 0===t?void 0:t.detail;return window.performance.getEntriesByType("mark").filter((function(t){return t.name.startsWith(n)})).reduce((function(n,t){return t.name!==o.OwlHostTimeOrigin?n[t.name]=e+t.startTime:n[t.name]=e,n}),{})}function u(n){var t,e=n[o.OwlStart]||n[o.OwlWithCustomFunctionsStart],r=n[o.OwlOnBootComplete];return{totalTime:r-e,owlPerformanceTimeline:(0,i.Cl)((0,i.Cl)({},n),((t={})[o.OwlStart]=e,t[o.OwlEnd]=r,t))}}!function(n){n.OwlBootAppMessageSend="owlBootAppMessageSend",n.OwlBootAppMessageReceive="owlBootAppMessageReceive",n.OwlLoadedMessageSend="owlLoadedMessageSend",n.OwlLoadedMessageReceive="owlLoadedMessageReceive",n.OwlBootAppWithCustomFunctionsMessageSend="owlBootAppWithCustomFunctionsMessageSend",n.OwlBootAppWithCustomFunctionsMessageReceive="owlBootAppWithCustomFunctionsMessageReceive",n.OwlWithCustomFunctionsStart="owlWithCustomFunctionsStart",n.OwlWithCustomFunctionsEnd="owlWithCustomFunctionsEnd",n.OwlStart="owlStart",n.OwlEnd="owlEnd",n.OwlHostTimeOrigin="owlHostTimeOrigin",n.OwlWacBootStart="owlWacBootStart",n.OwlOnBootComplete="owlOnBootComplete"}(o||(o={}))},2224:function(n,t,e){e.d(t,{Z:function(){return r}});var o=e(7627),i=e(2808),r=function(){function n(n){var t=this;this.resolve=function(){null==n||n.ULS.sendTraceTag(507586270,o.n.vo,i.k.Warning,"DeferredPromise.resolve() called before resolve function was set")},this.reject=function(t){return null==n?void 0:n.ULS.sendTraceTag(507586269,o.n.vo,i.k.Error,"DeferredPromise.reject() called before reject function was set. Error: ".concat(t))},this.ei=new Promise((function(n,e){t.resolve=n,t.reject=e})),this.ei.finally}return n.prototype.then=function(n,t){return this.ei.then(n,t)},n.prototype.catch=function(n){return this.ei.catch(n)},n.prototype.finally=function(n){return this.ei.finally(n)},n}()},8068:function(n,t,e){function o(n){return JSON.stringify(Object.fromEntries(n))}e.d(t,{c:function(){return o}})},2368:function(n,t,e){e.d(t,{Bp:function(){return h},Mn:function(){return m},_Q:function(){return o},g$:function(){return f},lt:function(){return d},rA:function(){return p},sH:function(){return c},vi:function(){return v}});var o,i=e(334),r=/http[s]?:\/\/[\S]*?\.sharepoint[\S]*?\.com/,u=/http[s]?:\/\/[\S]*?-my\.sharepoint[\S]*?\.com/,s=/http[s]?:\/\/d\.docs\.live\.net/,a="https://graph.microsoft.com",l=new RegExp(["^(https?:)//","(([^:/?#]*)(?::([0-9]+))?)","(/{0,1}[^?#]*)","(\\?[^#]*|)","(#.*|)$"].join(""));function c(n){if(!n)return"";try{return decodeURIComponent(n)}catch(n){return""}}function d(n){return n?n.substring(0,n.lastIndexOf("/")):""}function f(n){if(n&&n.length){var t=n.match(l);if(t)return{href:n,protocol:t[1],host:t[2],hostname:t[3],port:t[4],path:t[5],search:t[6],hash:t[7]}}}function v(n){if(n&&n.length&&n.startsWith(a))return"Graph"}function h(n,t,e){var o=n,r="",u=!0;for(var s in t&&(o=(0,i.Cl)((0,i.Cl)({},t),o)),o){var a=o[s];if(!e||"object"!=typeof a&&a||"object"==typeof a&&a&&a.uriValue||"number"==typeof a||"boolean"==typeof a){u?u=!1:r+="&";var l;l="object"==typeof a&&a&&a.uriValue?a.uriValue:encodeURIComponent("".concat(a)),r+="".concat(s,"=").concat(l)}}return r}function p(n){if(n&&n.length){if(n.match(u)||n.match(s))return o.OneDrive;if(n.match(r))return o.SharePoint}}function m(n,t){var e=n.toLowerCase(),o=function(n){var t=f(n);return t&&t.hostname||""}(t),i=function(n){var t=n.toLowerCase();return!t||t.startsWith("http:")||t.startsWith("https:")||t.startsWith("mailto:")||t.startsWith("sip:")||t.startsWith("tel:")||t.startsWith("im:")?t:"https://"+t}(o),r=d(t);return 0===e.indexOf("https://")||0===e.indexOf("http://")?e:"/"===e.charAt(0)?"".concat(i).concat(e):"".concat(r,"/").concat(e)}!function(n){n.OneDrive="Documents",n.SharePoint="Sites"}(o||(o={}))},1110:function(n,t,e){e.d(t,{Q5:function(){return o},iz:function(){return i},r$:function(){return r}});var o=!1;function i(n){o=n}function r(){o=!1}new Map},9458:function(n,t,e){var o;e.d(t,{p:function(){return o}}),function(n){n.Excel="Excel",n.None="None",n.OneNote="OneNote",n.PowerPoint="PowerPoint",n.Visio="Visio",n.Word="Word"}(o||(o={}))}},r={};function u(n){var t=r[n];if(void 0!==t)return t.exports;var e=r[n]={id:n,exports:{}};return i[n](e,e.exports,u),e.exports}u.m=i,u.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return u.d(t,{a:t}),t},t=Object.getPrototypeOf?function(n){return Object.getPrototypeOf(n)}:function(n){return n.__proto__},u.t=function(e,o){if(1&o&&(e=this(e)),8&o)return e;if("object"==typeof e&&e){if(4&o&&e.__esModule)return e;if(16&o&&"function"==typeof e.then)return e}var i=Object.create(null);u.r(i);var r={};n=n||[null,t({}),t([]),t(t)];for(var s=2&o&&e;"object"==typeof s&&!~n.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((function(n){r[n]=function(){return e[n]}}));return r.default=function(){return e},u.d(i,r),i},u.d=function(n,t){for(var e in t)u.o(t,e)&&!u.o(n,e)&&Object.defineProperty(n,e,{enumerable:!0,get:t[e]})},u.f={},u.e=function(n){return Promise.all(Object.keys(u.f).reduce((function(t,e){return u.f[e](n,t),t}),[]))},u.u=function(n){return"owl."+{103:"tr-tr-owl-strings-json",104:"bn-in-owl-strings-json",164:"nn-no-owl-strings-json",319:"ca-es-valencia-owl-strings-json",324:"as-in-owl-strings-json",360:"am-et-owl-strings-json",465:"te-in-owl-strings-json",484:"sv-se-owl-strings-json",501:"bs-latn-ba-owl-strings-json",535:"es-es-owl-strings-json",551:"uz-latn-uz-owl-strings-json",681:"eu-es-owl-strings-json",683:"tk-tm-owl-strings-json",825:"ru-ru-owl-strings-json",941:"mn-mn-owl-strings-json",949:"be-by-owl-strings-json",1120:"cs-cz-owl-strings-json",1200:"sr-cyrl-rs-owl-strings-json",1217:"ms-my-owl-strings-json",1250:"sq-al-owl-strings-json",1325:"de-de-owl-strings-json",1363:"fr-ca-owl-strings-json",1494:"lb-lu-owl-strings-json",1495:"pt-pt-owl-strings-json",1568:"zh-cn-owl-strings-json",1713:"ky-kg-owl-strings-json",1827:"da-dk-owl-strings-json",1836:"vi-vn-owl-strings-json",2077:"bg-bg-owl-strings-json",2094:"sd-arab-pk-owl-strings-json",2152:"nb-no-owl-strings-json",2178:"tt-ru-owl-strings-json",2217:"fi-fi-owl-strings-json",2253:"mr-in-owl-strings-json",2368:"hy-am-owl-strings-json",2443:"nl-nl-owl-strings-json",2527:"ml-in-owl-strings-json",2575:"fa-ir-owl-strings-json",2583:"or-in-owl-strings-json",2591:"az-latn-az-owl-strings-json",2624:"km-kh-owl-strings-json",3257:"qps-ploc-owl-strings-json",3264:"gu-in-owl-strings-json",3330:"mi-nz-owl-strings-json",3349:"ta-in-owl-strings-json",3508:"ko-kr-owl-strings-json",3589:"el-gr-owl-strings-json",3983:"prs-af-owl-strings-json",4061:"it-it-owl-strings-json",4111:"lv-lv-owl-strings-json",4139:"ka-ge-owl-strings-json",4290:"sl-si-owl-strings-json",4334:"et-ee-owl-strings-json",4423:"pl-pl-owl-strings-json",4650:"en-us-owl-strings-json",4722:"quz-pe-owl-strings-json",4890:"si-lk-owl-strings-json",5047:"mk-mk-owl-strings-json",5365:"mt-mt-owl-strings-json",5537:"uk-ua-owl-strings-json",5583:"is-is-owl-strings-json",5775:"kn-in-owl-strings-json",5807:"gd-gb-owl-strings-json",5850:"ar-sa-owl-strings-json",5953:"sw-ke-owl-strings-json",5994:"qps-plocm-owl-strings-json",6072:"kk-kz-owl-strings-json",6109:"id-id-owl-strings-json",6201:"pa-in-owl-strings-json",6281:"sr-latn-rs-owl-strings-json",6479:"kok-in-owl-strings-json",6599:"af-za-owl-strings-json",6720:"handlers",6895:"pt-br-owl-strings-json",6914:"es-mx-owl-strings-json",7063:"ca-es-owl-strings-json",7171:"fr-fr-owl-strings-json",7207:"th-th-owl-strings-json",7234:"cy-gb-owl-strings-json",7291:"lo-la-owl-strings-json",7479:"ur-pk-owl-strings-json",7717:"ga-ie-owl-strings-json",7761:"chr-cher-us-owl-strings-json",7923:"en-gb-owl-strings-json",8016:"zh-tw-owl-strings-json",8041:"hi-in-owl-strings-json",8234:"ja-jp-owl-strings-json",8303:"lt-lt-owl-strings-json",8375:"hr-hr-owl-strings-json",8461:"ro-ro-owl-strings-json",8664:"fil-ph-owl-strings-json",9015:"sk-sk-owl-strings-json",9059:"he-il-owl-strings-json",9094:"ug-cn-owl-strings-json",9134:"ne-np-owl-strings-json",9445:"bn-bd-owl-strings-json",9770:"sr-cyrl-ba-owl-strings-json",9790:"gl-es-owl-strings-json",9894:"qps-ploca-owl-strings-json",9917:"hu-hu-owl-strings-json",9971:"ha-latn-ng-owl-strings-json"}[n]+"."+{103:"153bac0f342fb5055ee2",104:"df9f183bf39e78e0d5e1",164:"252f148efb7029f81724",319:"64ed5de4c94eeba54089",324:"72f93e0f8ead100fffb6",360:"72326688761c322ca754",465:"50e13547345d8084084f",484:"d729c27d930d0836ead0",501:"fa828aaa8add91265374",535:"d31406fd6e369b4ddbf5",551:"23034a96d802f2511569",681:"822b70cd2a59413fb2a7",683:"eb7b304427fcb0dde842",825:"348f2a3fa2baec4478fb",941:"ba231385a73513bb48c3",949:"ff3cb6b4a53d00c93643",1120:"89a0ba1d11cbee766ae7",1200:"43e750734b535de542ae",1217:"185ba3208d8c36b09ffb",1250:"ec0238680cb91b614907",1325:"4a3187eb4224ade49be5",1363:"71827ef5e1aff39563a7",1494:"af746c18eeae93a9e8c5",1495:"3e874163fcc6a73415d0",1568:"8b9c8c5922a2a659ff03",1713:"3f07dd20c665c8665f6c",1827:"ae30c5fa9f9b79d0395c",1836:"38cd284f6345233153ce",2077:"b1768e753774121eda08",2094:"db80c4799ff40bf38e24",2152:"de398b7e82222390ea2f",2178:"d6249ac6f03a5d843441",2217:"bb9cdda3ef274cc6606d",2253:"c6c48567403739fe38d4",2368:"8ed47dd7c74b7f1d5ed1",2443:"e8091c611226305ea307",2527:"67225d0a67a07a8770ae",2575:"d066bf3c9a682ae94d32",2583:"4fbe0f6ebc70a40f2d54",2591:"d2e6b774f73a30adaf25",2624:"94650c1939240fb457d5",3257:"fb74a2e4c37004e47973",3264:"a69e4eedce060b2ec298",3330:"2267ac2cf295dc1f1de8",3349:"759de6e32c8dc2d60ad7",3508:"581b737faf797c665600",3589:"1da95e12a36ff7d58c66",3983:"6d9eea2fb71fd6283d4b",4061:"10bcd40709924765064c",4111:"d99956d7a8f76f7dae5d",4139:"11cafbf656e25057c600",4290:"19d54e4e0bf6eaba4180",4334:"eb19c1bb6b0399bf98b0",4423:"82b152cfa33ecf02ea6d",4650:"86e7a3ccc22ee935d5d1",4722:"3583b5641bce82bc03b7",4890:"ce0bd365bd44ef152b75",5047:"ad90f1d52a68d7decb18",5365:"333a79c6b47417314f85",5537:"2f6bf63467a20bd9acf4",5583:"f813b915c3fa41f93120",5775:"0ec0132af3fd649e77bd",5807:"1254493973121863a999",5850:"9048f07d5effec224575",5953:"a19b83398f698d1b7a52",5994:"7d45409667f8f7bf4665",6072:"308fed32b8e99a5428b4",6109:"549b3979ab8f2d33d9d7",6201:"e2ddbe2cc99cefd092f0",6281:"57e3015be9f26902fa1e",6479:"349baaded548b94324db",6599:"a5e8fa09a244f33febc5",6720:"e82d14ddf2019bc08c39",6895:"5ea059367e94773cfb58",6914:"c4f6c5b7ca9de329cc0c",7063:"2332d6b471471cb0be74",7171:"c7ec85fef8960461e952",7207:"5c5097f943d4803eca45",7234:"ba192306a30c3647a346",7291:"883cf9ff4b3a4da00d4b",7479:"ec3a19a01afeb2032e4b",7717:"d7231353e3984004480c",7761:"e9521ee20085138eb30f",7923:"ba3de8b5e74af326f58f",8016:"adbe95916a7820e36fbc",8041:"4aa00afdce633bc9bf1b",8234:"deae777857c929b51a07",8303:"642a9ee729c3255bef90",8375:"ffd0b633520b6b5228af",8461:"9981c290c9a72f7c6501",8664:"2f162a2cf6d4d055a7be",9015:"84b0032f399c6d4b893d",9059:"d866567c684f2de695be",9094:"0f071e532200ed1102e6",9134:"04300cda2ea33dcacf08",9445:"92761f600f3a90c13881",9770:"16edcd38ac49a7256784",9790:"8d33a048348b68303c15",9894:"ca377a61725bb40bc30b",9917:"731266ab6be8dcb29935",9971:"8ee3b815b9835ef91adb"}[n]+".js"},u.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(n){if("object"==typeof window)return window}}(),u.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},e={},o="Microsoft.Office.OWL:",u.l=function(n,t,i,r){if(e[n])e[n].push(t);else{var s,a;if(void 0!==i)for(var l=document.getElementsByTagName("script"),c=0;c<l.length;c++){var d=l[c];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==o+i){s=d;break}}s||(a=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,u.nc&&s.setAttribute("nonce",u.nc),s.setAttribute("data-webpack",o+i),s.src=n,0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous"),s.integrity=u.sriHashes[r],s.crossOrigin="anonymous"),e[n]=[t];var f=function(t,o){s.onerror=s.onload=null,clearTimeout(v);var i=e[n];if(delete e[n],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((function(n){return n(o)})),t)return t(o)},v=setTimeout(f.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=f.bind(null,s.onerror),s.onload=f.bind(null,s.onload),a&&document.head.appendChild(s)}},u.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},function(){var n;u.g.importScripts&&(n=u.g.location+"");var t=u.g.document;if(!n&&t&&(t.currentScript&&(n=t.currentScript.src),!n)){var e=t.getElementsByTagName("script");if(e.length)for(var o=e.length-1;o>-1&&(!n||!/^http(s?):/.test(n));)n=e[o--].src}if(!n)throw new Error("Automatic publicPath is not supported in this browser");n=n.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),u.p=n}(),u.sriHashes={103:"sha384-G3jS062JI7MbEetq20nRoEYpTUxJbOyrSe7nQR8kLu0Cs+UntFhrzRscHhEyfkft",104:"sha384-h1pYvWKhY+2aZgzjQm2ii68nnebeKqFRFBlDej+tX+ctSWyqVB4hJVZ96WYWe4fo",164:"sha384-BSkBNz20t57z5BKpUjoyqXH3uAp3zCS6PaDHrznvLPi9c7oK8soagsCUXOxAQfwi",319:"sha384-RMn3EIk2oGWsS+FjBPyOc5f9Q60ap6/tGoNlByPH5eRrB+pdtEjPMATNi6IaSjuk",324:"sha384-eTbS+awSgcYBPZJfO8SmsfTtp/07mw7pOwiy+JAGhNvUTFEgRBX6jhz7NVfHh8uc",360:"sha384-8HRNuLG5/1a3ADLF5nA0Mt4J4JhGLDyPrfG1kh9vzANDTASHHLIJhYMwHnb0TeSI",465:"sha384-4f5vMa2bdBa7VRsE1NSYQmcF9FgntaMI5Nlq2BvKV6dYYCGNYEfBdVgvFIDH7rZC",484:"sha384-vfOIyM1agPkvet1AMNd2MKdm69p8diDaz4Z5y4/rWD8MeOmCe1LPWKnrMIAOHsPr",501:"sha384-cfNBR+DAz0Wvw/yLQSVt/uW5dnXeeqZ+cz5Rxj8+OySObSuRluyRKumH1zCvW3WJ",535:"sha384-Vn6IaAqwTrqnT76ToMCaopNGiPkdtHtE17loIEVdKhvACERlf/7LzdFtGDACSSUl",551:"sha384-w/CyBDWbjIhyWgMTK8pooOvkufHcesDq9DsTrPEFWjKJiFI5oMXTMYwHtZBnOgn1",681:"sha384-EtAcXNzHzGXE+Riy18of+YFA7hRamdG1E5JEpfvVZOA86flyTCxEH7tfpvqNFgrl",683:"sha384-7d7ByTFcHb0tzlh7jE3jKd/TwSk0kHgFgULmnDHv60UEdJI0Fk5z0DJ8XfGyameP",825:"sha384-3GnjQZfasCP8VnMMuin7qAsw3wEdvSpYsPmM5cUu/hx/+4bgD90LBIZCMc/PhSOA",941:"sha384-4v5x4omBM2RWYoUAtxyAVBR1eVhLOOOHaQoWW1rJk/GA0H3S7DgbHDwPHQcgeA17",949:"sha384-X5Ie/dxkbXTzDibSU+P4N8LWdDEOO6dtCf7pJVgrhbvY6gYMVEB8t1KbD6iDaWm8",1120:"sha384-dqs1xMNG7v6uW7Qy4H/pST4mXiJcjJ6kgoGQCJNetBsACy0Niqog9Ya2SuHJtyd5",1200:"sha384-d267wXripdtbihEe77qYS31+SRD2ljhDuXA4pdP8IHaxofp4ysxP3Rwm/YG8gGm6",1217:"sha384-bKg79bWlv8p81vF+YV9N69Y19hkishpjFQME4hvRBpfVymG3fn4xy6y5928fOs7E",1250:"sha384-V+S1rbCk+zOqQHnj6OvAIP3X+ph09E05bPDUjlAmUvPhgvZ9gHlFkjZKsWEmrUEh",1325:"sha384-Nk02fpmuXaAylTPNbFzRwRiV4AEcXGM4ocw7v2XcR1fG1fizCg+DIldsO654F3aB",1363:"sha384-VepozH5GmtvQGqJDoifozngFQqwuAoh94bAVYP0KNfdkO2G8uFw0iEQz4D5aKhgy",1494:"sha384-DugjTFg39j++njEKSGuRpG63K5SFD7N+M1vp0HKzCqAK5sWr6aGnMPYVShmar4A6",1495:"sha384-Kzpob14myRbD/VrLMqG8kt1VYAUEiT7r/gXNg2Qfkkr2z/VxKAVF0SUex/dHEUaB",1568:"sha384-cHr6t2K0whkdxgAkWIFOXKnTv0xPkOpcwXfhfxQwuSkvwByvLmJjC0U9VpVcXRwS",1713:"sha384-wNSMxVOnjtzUqgS3RoSXoFOCOp0/tgKETMtfNoEQrP64x4AScWT0vCdfeL59add7",1827:"sha384-RwW99DnOU86wURV9kEqJtTdXD+dpkWjJqa3xT0yUK8O3Dv0gfU6GFcUzsyypBGX2",1836:"sha384-FmMY333k5vDPoFGRMtPvJBWopGpEewuswdCT69WOkLmsa4yhEk8pncelz1vsz1MC",2077:"sha384-fDl+WK9IHqBnboDkquP/JFzu/obk6qcU1Kq82jbQnNw6hzld0pCeAsuE9dG5kpTE",2094:"sha384-AbMlmdLuuOuGCZhiEdMpd/pvJ26tWo1jPnYhf/FvSPdbMcMcB05+hSp1jHWFlelf",2152:"sha384-OV5HstiRYggiFwA9gjJ7aAMSBtBJX3XxK8+r9ZMcdavlmy3DKCLRyxdwVSjfYv1e",2178:"sha384-zDEPrQoH/KnGm7DtcWUZXb+us4s7HuxJ1i854xCI4wUYtI3yi3+RXUZN/yqXnkVJ",2217:"sha384-CrSB/2UP0ehCci4RHqTuUbmaT0xlQekxvGKa35eVITQTUYSbGA22hgrjZ3c9wSbh",2253:"sha384-xEeJzMM5G5fPZCOrSMI0HJxhf4migZLEmKebCICN5/haQG+OE6J/HAN21Ymhv6ZX",2368:"sha384-jflhMX8X7ggo26Dqx+d0OuwuyHx4f607bi2vMewy18A9Ku9+kdtugaRyNFH1krTB",2443:"sha384-JptaXRgR+nsPuJ670rTlx9rVRPt+6c9B8/KR2jw+l3zsMJycSlfLkygKBy/8zm5G",2527:"sha384-e7TWhlJ5MsESniytx+nRo05b53MdRvYgGVvHbISoRutwLo2uZ1QzrlSxJUqqJxMp",2575:"sha384-XtNYcVIBcwkSACwisU0j2Rg+3WTUkGtevanqFEpFtHTTewixHW4Doi3XHKB4sYXW",2583:"sha384-VVVzvZObD4K8xZiWwHst4Nq0PCvECO/w5OdA0UGRgvNW4U9Tv6CJoopKA2Xat2tM",2591:"sha384-1CKZWhFDRwZ/WJfnRZKgNTdgh74PZFwbBlXui94+c0Nz9ekz1CTV5sT5ZNxvzeuS",2624:"sha384-SJsXTjM9snAxkeERju9GcpejznJlYkWNj6DpWTKmqDw5HetsIYfrraLkhsFe6QaG",3257:"sha384-//c/WSK0UxTHIMNwl7h5LHsokdYoddr0BunFEr27zGuN4b25X/CuigOuEoFzUX7t",3264:"sha384-mbH8ml5jqoF38YfgvC5AD682xo18rp04zZk3231xTX1/eliJuu/ZR7MV5gIQ7nyY",3330:"sha384-OTVFVwD0IRcxiVuVVo+IfXo/Q2GBHuWBLfRR0tT7OUOQXe57H0dWP1fJbnlbSKSN",3349:"sha384-STLRHIZ00S2bm8NnXZtxj5RasU9ZHdMoVrPOfAn+4NmDJO6nr+iQ/+1gJZzli0ac",3508:"sha384-g3scCXAP1Do9NU8TOAbN/o82p0LsFiiyM14yuZBgmCaNF+p23lNquQUfhhtv6Xvi",3589:"sha384-m5yGuchkNxMJByW/2+b/YWBKp518O7+vqway3sp7BvYmRvU/rzB5k5dmo2sjmjnk",3983:"sha384-jKwIUsLO/CJbT8xYd7mfyBnPf2cD6/x6w5PNMVNsPB9l5BZRoxbgbflrACCSJizw",4061:"sha384-lXylzYvd//RztEst3AnKc9reMCRnOqY1cHnonKC9O8GNylvM7hO11+L/8mPgO4sQ",4111:"sha384-LDHj9r1qIZE3R6oyZvOaz/tZ0GEMkMl2HHb1WYLY8Jd2bacQl80H/OTQKTz46S9l",4139:"sha384-h8FhmDB8NCEtVyK0ArOdB5dsJdJ+fs5+X6xnntaC65ahMUrxoAUiqOXkt+Y0BmZB",4290:"sha384-QNi1SuGj2CHeRbsesCOaIEJST1mvlYbda+sBM+jhLB7ji+S+ar/59jqA4GzTBsV6",4334:"sha384-FlIqfdbzhOG3IwT3PPuma8TPI6gWsOf1tfH9Nmb1iKuvuqt+tV4o2AnsuQazJpVj",4423:"sha384-cHNXoQqAnlNcYDMe0WnZ6vO+zXKZesqxMMdsgRgQ+CYNCevMsNQcjFlJso58+rkP",4650:"sha384-989te1ex/9tP8a57zsvRp0zgMc/jMtaGGv/sdZun8W2cvAxN/feLdGogOp63aLQ9",4722:"sha384-GXb/NFC+ZcBY7OEGW2/W0TrJD4PKGmURT6ogbA+3pf3URa+Y1BO8PQ8A52imSQxd",4890:"sha384-Mt3Td5kJgT2EQVYqKJGXXm93KOc39igJM7Jh5zuzN87B1uFrQFHqbaVeaQHaojyu",5047:"sha384-yia19dc1edMKgDUTaBAJh1MiaveTtrzk0DYLBBO4LeXgjvZOpqhXfOz9IAcfg583",5365:"sha384-RPokCIhVlkdjFxoeScDDbUND8Bj/efuKu7eiRGhT3gS9tAz3aKShNYN5M4Zc76jV",5537:"sha384-cZE0wrxE3GBg9MUpMk+72HiGSFbBvdAF7DvFWE1pJqVmUnhodChc3BIRbxKY70KU",5583:"sha384-4bFdEGr/9ZohaZoDJ9gUTT3reOCvhszSRaZcu1FfrmW38F+Dt63OCKPJT9bwn+6E",5775:"sha384-jq3V7sfWevPAKJVFEVR8x+0Hpq/TXcADRS7E8ulbAMgYVwxm6O+D2tpEBC04u2IF",5807:"sha384-um6Kr6JnWyjQ6pEqmOzchAPctZqgtzxUDQsRV0tzKEzOzdQZKi3HwkqcgYoaqdr/",5850:"sha384-7CV8XoswldpdJETanniMtqPFwcF1pUgiWAZIIyntv/jN6HXIbWKTAYJLGHdn2X9/",5953:"sha384-4TKvIPYlgn9mD5UMGOJX3cA16AQlVJEkbqF1JNQOBULHolS3P7iz5r7h9o5tbHwp",5994:"sha384-/6fzFtzC4owkjhnKClO5hFInlB3EDvUmntptNaWSy81kDjuHLg+QpCHYxVb2NgTr",6072:"sha384-3H1ttNObD9FCkmSN6LRc2q6ImYlu4ZVJKUEpubyPGtpx07L7D8oVGj46kc82WQyY",6109:"sha384-ciIwUSVpXMZ0ovOGLj7cfZCtU2z485hDC+EaVvRWgu0R7aImsgZRJvLaP0B1ApQK",6201:"sha384-/hMjjexcTVymHV5mVtef/UUcEXqSBNAsrd/juyzVDIrey0fUbuW45sK6PruG9eQj",6281:"sha384-NhCoy4NbmLIs/VbYk5pLqs/lXOLZ7MA/BwZUhP1lh0UQ4IuJGo+nVelPO1Ehh2m+",6479:"sha384-tAEMQFXHy4f0gcpo3TH2SclAjKQAlDp8VMAqmzvuOstawpzoVNwE6+awweMmsvJU",6599:"sha384-tU2rHKeJmyrb91y3I1AyYKNgoXddpWOXp9DCgCoSp1yz21A8prpk7wsbEYI1NzTp",6720:"sha384-EmJzp/pVFUDYpU3Y6w7Qap6WIbJm2YG3sEmQfqyr/g/MukG5ubBAPO51W4SDPQ3a",6895:"sha384-P9ad+ggAd22bX0HpbM/ctEEQ8UfbzADRSK8oWAO5iPC+uTljA+0ZTQryazrnG0Lc",6914:"sha384-Wjpiov20ykmC60FZETBOJRAFXi6phWyF2wZ16UmVlx8cLTQg2LiDpEkY6JJ8XvD2",7063:"sha384-v39qUfMl1b0MBc3T1lDi+QoD0dB3VdjSoR3Aqj7CJlXyOPW2+V2kiWae/mgboeeM",7171:"sha384-GhZCsXWF6AuhJVbXBkIfVXZXWxCTE4vCeaMIW6y5jPmAT4C2ps5REHBuhRu76LgS",7207:"sha384-rfnOVEOA1/2Na3hroFJw75/K5BqC2oGZ1YZyDqA7AccuCh92oD64GMddEJEJ8pcM",7234:"sha384-BhsAkxkgcIOhZPNcuZdIesTi6trPlbg9aV1lm2bO7RlXLdqN1eLYXFl3gcjNKLKw",7291:"sha384-DY5bSHD9BG/s0huW6AtyyN1mtqxqBZpHGrydl274ujulwIXhPL0jUk29f0TPCKwF",7479:"sha384-aTNBXkhg0v3XDLMh+DQ9ijj7yC8BA4zAtpYxqf3bwtvipUg3whzlLXrqxbY4YnMC",7717:"sha384-JvdsrTQo3T3BPrIkMG4B4rII0jPJGrQ0nbMZ7Btcnbcigm+5AJNdcpAK0GqLUwec",7761:"sha384-OemxYNhz14PaWMKG+3xY8sE3IYCdfCd6w4k/2i//xVioUDhM9o5GGa02/aD/7QQW",7923:"sha384-mCUmw1o0+c3ZzXLUucJ2BhSLYhL3+9yQ/6oL9u8oy9Gup3ZeA8VcSGNXAtcbDir5",8016:"sha384-tuEqNpqWDDonk9cD9zK8cI4dtVREVxnMINDSScvt0ZOlxl0UbBBQr/W+uDRSfqOc",8041:"sha384-csz37XdnhxlgNNUOZs619zf/kzPOOhHk+vSCWW8GTcFEnbcGhPMybFErsAIJq06a",8234:"sha384-ov6ee2oi6uMdgg/wGArhfZ7HUHJLyVdSQl76bCvPl6pXDO9VdFi8QW/GsjTJd9kb",8303:"sha384-c5h3oMEh87LNxTjZTHWcSAKW7n2i7jT+58DAe7rVcW7zjDW0QqbvbkNuBeoJ++m9",8375:"sha384-SMmrSeC2rI1IZ1Jk9cOgUL6kTN5IKsErwy1qWgV5jzHM+7ck3ieDOK0R5kI8urRh",8461:"sha384-bCB+QFPlVth9ab3M9myjRym6Cy9+G+N0cBaMH9hNhjaLmmpm6Ov9bny21ycexErH",8664:"sha384-PiGbGcGBWR0zDuTYDL7dp9FYhwxUesNBMZWgpyfklapnaNZIOmhLkxri3MQuIbO+",9015:"sha384-avs7R+c4zADirwYDyYingu5UpktLmi4hN1kwG1DwcEMQgENCcYv3lZfvTi6SJhNT",9059:"sha384-IPR6eJ6N4nQX6nBgbRys+rb1Hcj6QHQer9XhGRv19WRIlwyxUCptqzQRDEGZV4Vm",9094:"sha384-iyrNANuaxpKI6rW/3lzEPleOfzv+30dfvR6foE1FCLJzItmWkio/FZQj1ND4wWtj",9134:"sha384-V1iowyTeJzXpFt0kQ+BME88WzS72PZQnfydjw0G4T318IPYhx/qROnIcDTf1zTGN",9445:"sha384-YWMugBjtxkRIq90s6AtVzwkMtODShaODerrQYxtUtdUXDNCjjEg1opnXHlJm6ipd",9770:"sha384-hMZSqn6zfVQBZAzcrUP7ZYmdvED7Q8Y/8tZOhRzJB7ZgJj3W3uW5fP57sxo9I+Da",9790:"sha384-Y65KfBAzy5vZizEqT9fC8nZwxOaD00IFqNGsGWyd6WhYjSlQjP8FIBg9kZQ7wRcc",9894:"sha384-z0humrJRlRvBgIpBVIe7RoajG+xnO1TlIKhFj9eQvZVa6RPl8oK1idaXkVCgamdN",9917:"sha384-Kl/rTDXySc/JPdmWok/u+QWRluxQz43+8eYIu+n2Y1uTvwUQ5s8ZOGaEJ+/7Nm+t",9971:"sha384-uD/ofPyOrQYrax0erlfXW6xneXfFl2P5IrDpWO+bAsYtlgTFZUGVm7GZc55dKDcz"},function(){if(void 0!==u){var n=u.u,t=u.e,e={},o={};u.u=function(t){return n(t)+(e.hasOwnProperty(t)?"?"+e[t]:"")},u.e=function(i){return t(i).catch((function(t){var r=o.hasOwnProperty(i)?o[i]:5;if(r<1){var s=n(i);throw t.message="Loading chunk "+i+" failed after 5 retries.\n("+s+")",t.request=s,t}return new Promise((function(n){var t=5-r+1;setTimeout((function(){var s="cache-bust=true&retry-attempt="+t;e[i]=s,o[i]=r-1,n(u.e(i))}),0)}))}))}}}(),function(){var n={728:0};u.f.j=function(t,e){var o=u.o(n,t)?n[t]:void 0;if(0!==o)if(o)e.push(o[2]);else{var i=new Promise((function(e,i){o=n[t]=[e,i]}));e.push(o[2]=i);var r=u.p+u.u(t),s=new Error;u.l(r,(function(e){if(u.o(n,t)&&(0!==(o=n[t])&&(n[t]=void 0),o)){var i=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",s.name="ChunkLoadError",s.type=i,s.request=r,o[1](s)}}),"chunk-"+t,t)}};var t=function(t,e){var o,i,r=e[0],s=e[1],a=e[2],l=0;if(r.some((function(t){return 0!==n[t]}))){for(o in s)u.o(s,o)&&(u.m[o]=s[o]);a&&a(u)}for(t&&t(e);l<r.length;l++)i=r[l],u.o(n,i)&&n[i]&&n[i][0](),n[i]=0},e=self.webpackChunkMicrosoft_Office_OWL=self.webpackChunkMicrosoft_Office_OWL||[];e.forEach(t.bind(null,0)),e.push=t.bind(null,e.push.bind(e))}(),u.nc=void 0;var s={};!function(){u.r(s),u.d(s,{bootDocumentWithCustomFunctions:function(){return Jn},completeCreateNew:function(){return Gn},initPackage:function(){return Kn}});var n=u(334),t=u(7627),e=u(2808),o=u(7070),i=u(2463),r=u(7282),a=u(8801),l=function(){function n(n){var t=this;this.oi=!1,this.ii="",this.ri=[],this.si=function(n){t.oi||(t.oi=!0,t.ii=n?"timeout":"cancelled",t.ri.map((function(n){return n()})),t.ri=[])},this.li=n,window.setTimeout((function(){return t.si(!0)}),n)}return Object.defineProperty(n.prototype,"isCancelled",{get:function(){return this.oi},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"timeoutInMs",{get:function(){return this.li},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"reason",{get:function(){return this.ii},enumerable:!1,configurable:!0}),n.prototype.cancel=function(){this.si(!1)},n.prototype.subscribe=function(n){this.oi?n():this.ri.push(n)},n}();function c(n){return new l(n)}var d=u(8970),f=u(4999),v=u(4947),h=u(9458),p=u(7630),m=u(843),w=u(8703),b=u(7372),g=u(3733),S=u(1990),H=u(4200);function C(n,t){return function(e){if("function"!=typeof n)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return e.lift(new I(n,t))}}var I=function(){function n(n,t){this.project=n,this.thisArg=t}return n.prototype.call=function(n,t){return t.subscribe(new A(n,this.project,this.thisArg))},n}(),A=function(n){function t(t,e,o){var i=n.call(this,t)||this;return i.project=e,i.count=0,i.thisArg=o||i,i}return S.C6(t,n),t.prototype.F=function(n){var t;try{t=this.project.call(this.thisArg,n,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(t)},t}(H.v);function y(n,t,e,o){return(0,g.T)(e)&&(o=e,e=void 0),o?y(n,t,e).pipe(C((function(n){return(0,b.c)(n)?o.apply(void 0,n):o(n)}))):new w.c((function(o){U(n,t,(function(n){arguments.length>1?o.next(Array.prototype.slice.call(arguments)):o.next(n)}),o,e)}))}function U(n,t,e,o,i){var r;if(function(n){return n&&"function"==typeof n.addEventListener&&"function"==typeof n.removeEventListener}(n)){var u=n;n.addEventListener(t,e,i),r=function(){return u.removeEventListener(t,e,i)}}else if(function(n){return n&&"function"==typeof n.on&&"function"==typeof n.off}(n)){var s=n;n.on(t,e),r=function(){return s.off(t,e)}}else if(function(n){return n&&"function"==typeof n.addListener&&"function"==typeof n.removeListener}(n)){var a=n;n.addListener(t,e),r=function(){return a.removeListener(t,e)}}else{if(!n||!n.length)throw new TypeError("Invalid event target");for(var l=0,c=n.length;l<c;l++)U(n[l],t,e,o,i)}o.add(r)}var T=u(7615);function P(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var k=P(),N=u(1819),E=function(n){return n&&"number"==typeof n.length&&"function"!=typeof n};function W(n){return!!n&&"function"!=typeof n.subscribe&&"function"==typeof n.then}var F=u(6582),R=function(n){if(n&&"function"==typeof n[N.s])return o=n,function(n){var t=o[N.s]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(n)};if(E(n))return e=n,function(n){for(var t=0,o=e.length;t<o&&!n.closed;t++)n.next(e[t]);n.complete()};if(W(n))return function(n){return function(t){return n.then((function(n){t.closed||(t.next(n),t.complete())}),(function(n){return t.error(n)})).then(null,T.T),t}}(n);if(n&&"function"==typeof n[k])return t=n,function(n){for(var e=t[k]();;){var o=void 0;try{o=e.next()}catch(t){return n.error(t),n}if(o.done){n.complete();break}if(n.next(o.value),n.closed)break}return"function"==typeof e.return&&n.add((function(){e.return&&e.return()})),n};var t,e,o,i=(0,F.G)(n)?"an invalid object":"'"+n+"'";throw new TypeError("You provided "+i+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};u(7216);var D=function(n){function t(t){var e=n.call(this)||this;return e.parent=t,e}return S.C6(t,n),t.prototype.F=function(n){this.parent.notifyNext(n)},t.prototype.R=function(n){this.parent.notifyError(n),this.unsubscribe()},t.prototype._=function(){this.parent.notifyComplete(),this.unsubscribe()},t}(H.v),O=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return S.C6(t,n),t.prototype.notifyNext=function(n){this.destination.next(n)},t.prototype.notifyError=function(n){this.destination.error(n)},t.prototype.notifyComplete=function(){this.destination.complete()},t}(H.v);function j(n,t,e){return void 0===e&&(e=Number.POSITIVE_INFINITY),"function"==typeof t?function(o){return o.pipe(j((function(e,o){return(i=n(e,o),i instanceof w.c?i:new w.c(R(i))).pipe(C((function(n,i){return t(e,n,o,i)})));var i}),e))}:("number"==typeof t&&(e=t),function(t){return t.lift(new M(n,e))})}var M=function(){function n(n,t){void 0===t&&(t=Number.POSITIVE_INFINITY),this.project=n,this.concurrent=t}return n.prototype.call=function(n,t){return t.subscribe(new _(n,this.project,this.concurrent))},n}(),_=function(n){function t(t,e,o){void 0===o&&(o=Number.POSITIVE_INFINITY);var i=n.call(this,t)||this;return i.project=e,i.concurrent=o,i.hasCompleted=!1,i.buffer=[],i.active=0,i.index=0,i}return S.C6(t,n),t.prototype.F=function(n){this.active<this.concurrent?this.ci(n):this.buffer.push(n)},t.prototype.ci=function(n){var t,e=this.index++;try{t=this.project(n,e)}catch(n){return void this.destination.error(n)}this.active++,this.di(t)},t.prototype.di=function(n){var t=new D(this),e=this.destination;e.add(t);var o=function(n,t){if(!t.closed){if(n instanceof w.c)return n.subscribe(t);var e;try{e=R(n)(t)}catch(n){t.error(n)}return e}}(n,t);o!==t&&e.add(o)},t.prototype._=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(n){this.destination.next(n)},t.prototype.notifyComplete=function(){var n=this.buffer;this.active--,n.length>0?this.F(n.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},t}(O),B=function(){function n(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return n.prototype=Object.create(Error.prototype),n}();var x=function(){function n(n){if(this.total=n,this.total<0)throw new B}return n.prototype.call=function(n,t){return t.subscribe(new L(n,this.total))},n}(),L=function(n){function t(t,e){var o=n.call(this,t)||this;return o.total=e,o.count=0,o}return S.C6(t,n),t.prototype.F=function(n){var t=this.total,e=++this.count;e<=t&&(this.destination.next(n),e===t&&(this.destination.complete(),this.unsubscribe()))},t}(H.v);function K(n,t){return function(e){return e.lift(new G(n,t))}}var V,G=function(){function n(n,t){this.predicate=n,this.thisArg=t}return n.prototype.call=function(n,t){return t.subscribe(new J(n,this.predicate,this.thisArg))},n}(),J=function(n){function t(t,e,o){var i=n.call(this,t)||this;return i.predicate=e,i.thisArg=o,i.count=0,i}return S.C6(t,n),t.prototype.F=function(n){var t;try{t=this.predicate.call(this.thisArg,n,this.count++)}catch(n){return void this.destination.error(n)}t&&this.destination.next(n)},t}(H.v),q=u(3183),z=u(9278),Z=u(5851),Q=u(1999),X=u(4105),Y=u(21);!function(n){n.AccessibilityLoopCompleted="AccessibilityLoopCompleted",n.ActionCompleted="ActionCompleted",n.BrowserEvent="BrowserEvent",n.CAAEMessage="CAAEMessage",n.Close="Close",n.InitEnd="InitEnd",n.Conversation="Conversation",n.CopyAndEdit="CopyAndEdit",n.CreateNewDocument="CreateNewDocument",n.Download="Download",n.Edit="Edit",n.Error="Error",n.FileEmbed="FileEmbed",n.FileProperties="FileProperties",n.FileRenamed="FileRenamed",n.FileVersions="FileVersions",n.FrameStateChanged="FrameStateChanged",n.FrameTrust="FrameTrust",n.GetAccessToken="GetAccessToken",n.GetAuthToken="GetAuthToken",n.GetCustomAuthConfig="GetCustomAuthConfig",n.GetWopiInfoFromUrl="GetWopiInfoFromUrl",n.GetDavUrlFromIds="GetDavUrlFromIds",n.ModeSwitched="ModeSwitched",n.MoveToFolder="MoveToFolder",n.OpenInMobileApp="OpenInMobileApp",n.OpenInBrowser="OpenInBrowser",n.OpenInClient="OpenInClient",n.PageChanged="PageChanged",n.PushState="PushState",n.Reboot="Reboot",n.RedeemForCommenting="RedeemForCommenting",n.RefreshSessionInfo="RefreshSessionInfo",n.ReplyWithChanges="ReplyWithChanges",n.ReportAbuse="ReportAbuse",n.SharedFilePicker="SharedFilePicker",n.SaveStatus="SaveStatus",n.Share="Share",n.ShareForm="ShareForm",n.SignIn="SignIn",n.SplashScreenShown="SplashScreenShown",n.UserAccessAndPermissions="UserAccessAndPermissions",n.UserActivity="UserActivity",n.UserEditActivity="UserEditActivity",n.Workflow="Workflow",n.ZoomChanged="ZoomChanged",n.AcquireOAuthTokenTeams="AcquireOAuthTokenTeams",n.LoadingStatus="LoadingStatus",n.SwitchNotebook="SwitchNotebook",n.FailedBootCheckFileInfo="FailedBootCheckFileInfo",n.GetTeamsUsers="GetTeamsUsers",n.SendTeamsUserMention="SendTeamsUserMention",n.NavigateBackToHost="NavigateBackToHost",n.GetClientUrlComplete="GetClientUrlComplete",n.GetWebUrlComplete="GetWebUrlComplete",n.CopyLinkComplete="CopyLinkComplete",n.SendConversationId="SendConversationId",n.CloseTeamsConversation="CloseTeamsConversation",n.PageLoaded="PageLoaded",n.FrameChanged="FrameChanged"}(V||(V={}));var $,nn,tn,en=u(2224),on=u(3261),rn=u(8478),un=u(1110),sn=u(2573),an=u(8068),ln="https://wise-m.public.cdn.office.net/wise-m/owl",cn="https://wise.public.cdn.office.net/wise/owl",dn=new Set,fn=[10,100],vn=[1,10,50,100],hn=2e3;function pn(n,t,e,o){$=e,nn=n,mn(t,"MSIT",fn,0,o),mn(t,"PRODUCTION",vn,3e4,o)}function mn(t,e,o,i,r){var u=this,s=i;o.forEach((function(o){return(0,n.sH)(u,void 0,void 0,(function(){var i=this;return(0,n.YH)(this,(function(u){return setTimeout((function(){return(0,n.sH)(i,void 0,void 0,(function(){return(0,n.YH)(this,(function(n){switch(n.label){case 0:return[4,wn(t,e,o,1,r)];case 1:return n.sent(),[2]}}))}))}),s+=hn),[2]}))}))}))}function wn(o,i,r,u,s){return void 0===u&&(u=0),(0,n.sH)(this,void 0,void 0,(function(){var a,l=this;return(0,n.YH)(this,(function(c){switch(c.label){case 0:return a=0,[4,fetch("".concat(ln,"/5mttl/").concat(i.toLowerCase(),"/").concat(r,"/manifest.json"),{cache:"no-cache"}).then((function(n){return null==$||$.ULS.sendTraceTag(507326861,t.n.vo,e.k.Info,"Fetching manifest from CDN was successful for ".concat(o," in ").concat(i," with exposure ").concat(r," with remaining retry count ").concat(u,".")),n.text()})).then((function(c){return(0,n.sH)(l,void 0,void 0,(function(){var l,d=this;return(0,n.YH)(this,(function(f){if(null==$||$.ULS.sendTraceTag(507326860,t.n.vo,e.k.Info,"Parsing manifest from CDN was successful for ".concat(o," in ").concat(i," with exposure ").concat(r," with remaining retry count ").concat(u,".")),c.includes("<Code>BlobNotFound</Code>"))u>0?setTimeout((function(){return(0,n.sH)(d,void 0,void 0,(function(){return(0,n.YH)(this,(function(n){switch(n.label){case 0:return[4,wn(o,i,r,u-1)];case 1:return n.sent(),[2]}}))}))}),29e3):null==$||$.ULS.sendTraceTag(507107014,t.n.vo,e.k.Warning,"Fetching manifest from CDN failed for ".concat(o," in ").concat(i," with exposure ").concat(r," with remaining retry count ").concat(u,". Error: BlobNotFound"));else{if(!(l=JSON.parse(c)).clientVersion)return null==$||$.ULS.sendTraceTag(507326859,t.n.vo,e.k.Warning,"Manifest from CDN does not have clientVersion for ".concat(o," in ").concat(i," with exposure ").concat(r,". Manifest: ").concat(l)),[2];if(!l.files)return null==$||$.ULS.sendTraceTag(507326858,t.n.vo,e.k.Warning,"Manifest from CDN does not have files for ".concat(o," in ").concat(i," with exposure ").concat(r,". Manifest: ").concat(l)),[2];dn.has(l.clientVersion)||(dn.add(l.clientVersion),Object.keys(l.files).filter((function(n){return n.includes(o.toLowerCase()+".boot.js")||n.includes(o.toLowerCase()+".app.boot.js")||n.includes(o.toLowerCase()+"-boot.js")||n.includes("owl."+o.toLowerCase()+".js")||n.includes("owl.js")||n.includes("owl."+o.toLowerCase()+".slim.js")||n.includes("owl.slim.js")})).forEach((function(n){var o=l.files[n];if(o&&2===o.length){var i=function(n,o,i,r){var u=document.createElement("link");return u.rel="prefetch",u.href=n,u.as="script",(i.includes("owl")||r)&&(u.crossOrigin="anonymous",u.integrity=o),u.id=i,u.onerror=function(){null==$||$.ULS.sendTraceTag(507326856,t.n.vo,e.k.Warning,"Failed to prefetch ".concat(i," from ").concat(n)),u.remove()},u}("".concat(cn,"/").concat(o[0]),o[1],n,s);!function(n,t,e){setTimeout((function(){n.appendChild(t)}),e)}(nn,i,a+=hn)}})))}return[2]}))}))})).catch((function(s){u>0?setTimeout((function(){return(0,n.sH)(l,void 0,void 0,(function(){return(0,n.YH)(this,(function(n){switch(n.label){case 0:return[4,wn(o,i,r,u-1)];case 1:return n.sent(),[2]}}))}))}),29e3):null==$||$.ULS.sendTraceTag(507326857,t.n.vo,e.k.Warning,"Fetching manifest from CDN failed for ".concat(o," in ").concat(i," with exposure ").concat(r," with remaining retry count ").concat(u,". Error: ").concat(s))}))];case 1:return c.sent(),[2]}}))}))}!function(n){n[n.Completed=0]="Completed",n[n.Unloaded=1]="Unloaded",n[n.Timeout=2]="Timeout"}(tn||(tn={}));var bn="officeapps.live.com",gn=2e3,Sn=9e3,Hn=9500,Cn=6e5,In=15e4,An=[],yn=new en.Z,Un={BootAttempted:!1,BootSucceeded:!1,PostWacTokenAttempted:!1},Tn={};function Pn(i){var r,s,a,l,w,b=this,g=(null===(r=i.sessionConfig.bootDiagnostics)||void 0===r?void 0:r.hostPageFirstFlushTime)||(0,o.u_)(),S=i.documentBootInfo,H=i.fetchItemFromNetwork,I=i.fetchAccessToken,A=i.sessionConfig,U=i.container,T=i.setTitle,P=i.onBootComplete,k=i.onBootFailure,N=i.onReturnFocus,E=i.onConversationClose,W=i.onNavigateBack,F=i.onOpenPageLevelConversation,R=i.onDocumentClose,D=i.onSuccessNotification,O=i.onDismissHostSpinner,M=i.uiHostConfig,_=i.createDocument,B=i.openShareControl,L=i.onOpenInMobileApp,G=i.sharingLinkTokenProvider,J=i.onUserActivity,$=i.onCAAEMessage,nn=i.onAcquireOAuthTokenTeams,ln=i.onUserAccess,cn=i.onMoveToFolder,dn=i.onSharedFilePicker,fn=i.onRename,vn=i.initPackageParams,hn=i.onFrameChange,mn=i.invokeSessionRefreshInfoPopupBlockedDialog,wn=i.onFileEmbed,In=i.bootstrapFile,Pn=null==M?void 0:M.supportsExplicitUnload;A.logger||(A.logger=(0,d.Jf)());var kn=A.hostCorrelationId,Nn=A.isMsa,Wn=A.tenantId,Fn=A.shareApiEndpoint,Rn=A.organizationName,Dn=A.logger,On=A.hostClientType,jn=A.channelId,Mn=A.health,_n=(0,q.PS)(S.fileType,null==M?void 0:M.featureGates,Dn);null==Dn||Dn.ULS.sendTraceTag(576578584,t.n.vo,e.k.Info,"Lean Ui Host: bootApp");var Bn,xn=c(Cn),Kn=[],Vn=function(o){return new Promise((function(i){_n&&!xn&&i("No active session to close. Return from here."),An&&An.forEach((function(n){clearInterval(n),clearTimeout(n)}));var r=function(n){null==Dn||Dn.ULS.sendTraceTag(575411776,t.n.vo,e.k.Info,"Dispose the WAC frame. And reboot: ".concat(n?"true":"false")),ut.next(n),ut.complete(),i("WAC frame disposed")},u=function(){S.fileType===h.p.Excel&&(0,Z.Ko)(),null==et||et.unsubscribe(),null==ot||ot.unsubscribe()};if(!qn)return null==Dn||Dn.ULS.sendTraceTag(529093076,t.n.vo,e.k.Warning,"No active session exists, when endSession is called!! Bail out endSession"),void r(o);if(_n){null==qn||qn.removeEventListener(Bn),null==xn||xn.cancel();var s=function(n){if(n===h.p.OneNote)return c(Sn)}(S.fileType);null==qn||qn.dispose(s).catch((function(n){null==Dn||Dn.ULS.sendTraceTag(527257879,t.n.vo,e.k.Error,"Error waiting for Unloaded event from WAC. Force to dispose session if app is not unloaded. appUnloaded: ".concat($n,", Error: ").concat(n))})).finally((function(){u(),r(o)})),null==s||s.cancel()}else if(Kn.forEach((function(t){var e=(0,n.zs)(t,2),o=e[0],i=e[1];qn.RemoveEventHandler(o,i)})),null==qn||qn.Dispose(Pn,function(n){if(n===h.p.OneNote)return Sn}(S.fileType)),u(),Pn){qn.RegisterEventHandler(X.O5.Event_Unloaded,(function(){null==Dn||Dn.ULS.sendTraceTag(575411777,t.n.vo,e.k.Info,"Receive Unloaded Event from WAC"),$n=!0,clearTimeout(a),r(o)}));var a=window.setTimeout((function(){null==Dn||Dn.ULS.sendTraceTag(575411778,t.n.vo,e.k.Info,"Time out on waiting for Unloaded event from WAC. Force to dispose session if app is not unloaded. appUnloaded: ".concat($n)),$n||r(o)}),S.fileType===h.p.OneNote?Hn:gn)}else null==Dn||Dn.ULS.sendTraceTag(575271647,t.n.vo,e.k.Info,"No Explicit Unload. Tear down the WAC frame to end session."),r(o)}))},Gn=function(o,i,r){var s,a,l,c,d=Promise.resolve(null===(s=null==o?void 0:o.wac)||void 0===s?void 0:s.applicationUrl),f=function(){return i.asObservable().pipe((1,function(n){return n.lift(new x(1))})).toPromise()},v=null!==(a=null==M?void 0:M.sessionOriginPrefix)&&void 0!==a?a:"TEAMS.UNIFIEDUIHOST.",h=function(t){var e=this;return function(o){return(0,n.sH)(e,void 0,void 0,(function(){return(0,n.YH)(this,(function(n){switch(n.label){case 0:return[4,u.e(6720).then(u.bind(u,5492))];case 1:return[4,n.sent().documentRebootHandler(t,o)];case 2:return n.sent(),[2]}}))}))}}({getCurrentDocumentInfo:f,health:Mn,getWdOrigin:function(n){return"".concat(v).concat(n)},reboot:function(n,o){Vn({documentBootInfo:n,navigationRequired:!o}).catch((function(){null==Dn||Dn.ULS.sendTraceTag(512296464,t.n.vo,e.k.Error,"endSession: endSession error in DocumentReboot")}))}}),p=function(t){var e=this;return function(o){return(0,n.sH)(e,void 0,void 0,(function(){return(0,n.YH)(this,(function(n){switch(n.label){case 0:return[4,u.e(6720).then(u.bind(u,5492))];case 1:return[4,n.sent().renameHandler(t,o)];case 2:return n.sent(),[2]}}))}))}}({bootedDocumentInfo:i,getCurrentDocumentInfo:f,hostRenameCallback:fn,health:Mn}),m=function(t){var e=this,o=(0,n.Cl)((0,n.Cl)({},t),{popupMetadata:{retry:0,dialogInvoked:!1,popupOpen:!1}});return function(t){return(0,n.sH)(e,void 0,void 0,(function(){return(0,n.YH)(this,(function(n){switch(n.label){case 0:return[4,u.e(6720).then(u.bind(u,5492))];case 1:return[4,n.sent().sessionRefreshInfoHandler(o,t)];case 2:return n.sent(),[2]}}))}))}}({hostUrl:null==A?void 0:A.hostUrl,supportsRefreshTokenReauthPopUp:null==M?void 0:M.supportsRefreshTokenReauthPopUp,getCurrentDocumentInfo:f,documentBootInfo:S,fetchItemFromNetwork:H,officeDocumentSession:r,appUrlPromise:d,invokePopupBlockedDialog:mn,logger:Dn,health:Mn}),w=function(t){var e=this;return function(o){return(0,n.sH)(e,void 0,void 0,(function(){return(0,n.YH)(this,(function(n){switch(n.label){case 0:return[4,u.e(6720).then(u.bind(u,5492))];case 1:return[4,n.sent().shareHandler(t,o)];case 2:return n.sent(),[2]}}))}))}}({getCurrentDocumentInfo:f,sharePointInfo:o.sharePointInfo,shareApiEndPointBase:Fn,fetchAccessToken:I,openShareControl:B,correlationId:Zn,isMsa:Nn,tenantId:Wn,organizationName:Rn,onOpen:function(){(0,Q.Q)(X.Ph.PostMessage_BlurFocus,void 0,Yn,nt,Dn)},onClose:function(){(0,Q.Q)(X.Ph.PostMessage_GrabFocus,void 0,Yn,nt,Dn)},health:Mn,featureGates:null==M?void 0:M.featureGates,logger:Dn}),b=null!=ln?ln:function(t){var e=this;return function(o){return(0,n.sH)(e,void 0,void 0,(function(){return(0,n.YH)(this,(function(n){switch(n.label){case 0:return[4,u.e(6720).then(u.bind(u,5492))];case 1:return n.sent().userAccessHandler(t,o),[2]}}))}))}}({getCurrentDocumentInfo:f,shareHandler:w,officeDocumentSession:r,appUrlPromise:d,logger:Dn,health:Mn}),g=function(t){var e=this;return function(){return(0,n.sH)(e,void 0,void 0,(function(){return(0,n.YH)(this,(function(n){switch(n.label){case 0:return[4,u.e(6720).then(u.bind(u,5492))];case 1:return n.sent().userActivityHandler(t),[2]}}))}))}}({getCurrentDocumentInfo:f,onUserActivity:J,health:Mn}),C=function(t){var e=this;return function(o){return(0,n.sH)(e,void 0,void 0,(function(){return(0,n.YH)(this,(function(n){switch(n.label){case 0:return[4,u.e(6720).then(u.bind(u,5492))];case 1:return[4,n.sent().createNewHandler(t,o)];case 2:return n.sent(),[2]}}))}))}}({getCurrentDocumentInfo:f,createDocument:_,getWdOrigin:function(n){return"".concat(v).concat(n)},reboot:function(n,o){Vn({documentBootInfo:n,navigationRequired:!o}).catch((function(n){var o=(0,on.SI)(on.dT.FeatureGate_CommandingAshaVetoes,null==M?void 0:M.featureGates);(0,on.lO)(on.dT.FeatureGate_CommandingAshaVetoes,o,Dn),o&&(null==Mn||Mn.recordQosError(Y.by.QosError_CreateNewHandlerEndSessionFailure,[Y.zJ.QosVeto_CreateNewExperienceDegraded],!1,!1,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorName",Y.by.QosError_CreateNewHandlerEndSessionFailure],["CorrelationId","".concat(Zn)],["Reason",n]])})),null==Dn||Dn.ULS.sendTraceTag(512296463,t.n.vo,e.k.Error,"endSession: endSession error in DocumentCreate")}))},logger:Dn,health:Mn,correlationId:Zn}),y=function(t){var e=this;return function(o){return(0,n.sH)(e,void 0,void 0,(function(){return(0,n.YH)(this,(function(n){switch(n.label){case 0:return[4,u.e(6720).then(u.bind(u,5492))];case 1:return[4,n.sent().getAuthTokenHandler(t,o)];case 2:return n.sent(),[2]}}))}))}}({getCurrentDocumentInfo:f,fetchAccessToken:I,officeDocumentSession:r,appUrlPromise:d,logger:Dn,health:Mn}),T=function(t){var e=this;return function(o){return(0,n.sH)(e,void 0,void 0,(function(){return(0,n.YH)(this,(function(n){switch(n.label){case 0:return[4,u.e(6720).then(u.bind(u,5492))];case 1:return n.sent().sendConversationIdHandler(t,o),[2]}}))}))}}({getCurrentDocumentInfo:f,onOpenPageLevelConversation:F,hostSendConversationId:st,health:Mn}),P=function(t){var e=this;return function(){return(0,n.sH)(e,void 0,void 0,(function(){return(0,n.YH)(this,(function(n){switch(n.label){case 0:return[4,u.e(6720).then(u.bind(u,5492))];case 1:return n.sent().closeTeamsConversationHandler(t),[2]}}))}))}}({getCurrentDocumentInfo:f,onConversationClose:E,health:Mn}),k=function(t){var e=this;return function(){return(0,n.sH)(e,void 0,void 0,(function(){return(0,n.YH)(this,(function(n){switch(n.label){case 0:return[4,u.e(6720).then(u.bind(u,5492))];case 1:return n.sent().navigateBackToHostHandler(t),[2]}}))}))}}({getCurrentDocumentInfo:f,onNavigateBack:W,health:Mn}),D=function(t){var e=this;return function(o){return(0,n.sH)(e,void 0,void 0,(function(){return(0,n.YH)(this,(function(n){switch(n.label){case 0:return[4,u.e(6720).then(u.bind(u,5492))];case 1:return n.sent().accessibilityLoopCompleteHandler(t,o),[2]}}))}))}}({getCurrentDocumentInfo:f,onReturnFocus:N,health:Mn}),O=function(t){var e=this;return function(o){return(0,n.sH)(e,void 0,void 0,(function(){return(0,n.YH)(this,(function(n){switch(n.label){case 0:return[4,u.e(6720).then(u.bind(u,5492))];case 1:return[4,n.sent().getClientUrlCompleteHandler(t,o)];case 2:return n.sent(),[2]}}))}))}}({getCurrentDocumentInfo:f,hostClientType:On,logger:Dn,openInMobileAppCallback:L,health:Mn}),j=function(t){var e=this;return function(){return(0,n.sH)(e,void 0,void 0,(function(){return(0,n.YH)(this,(function(n){switch(n.label){case 0:return[4,u.e(6720).then(u.bind(u,5492))];case 1:return[4,n.sent().loadingStatusHandler(t)];case 2:return n.sent(),[2]}}))}))}}({getCurrentDocumentInfo:f,channelId:jn,officeDocumentSession:r,appUrlPromise:d,health:Mn}),K=function(t){var e=this;return function(o){return(0,n.sH)(e,void 0,void 0,(function(){return(0,n.YH)(this,(function(n){switch(n.label){case 0:return[4,u.e(6720).then(u.bind(u,5492))];case 1:return[4,n.sent().getWebUrlCompleteHandler(t,o)];case 2:return n.sent(),[2]}}))}))}}({getCurrentDocumentInfo:f,hostClientType:On,logger:Dn,health:Mn}),V=(0,Z.RC)({getCurrentDocumentInfo:f,fetchItemFromNetwork:H,officeDocumentSession:r,appUrlPromise:d,logger:Dn,health:Mn}),q=(0,Z.bn)({getCurrentDocumentInfo:f,fetchItemFromNetwork:H,officeDocumentSession:r,appUrlPromise:d,logger:Dn,health:Mn}),z=function(t){var e=this;return function(o){return(0,n.sH)(e,void 0,void 0,(function(){return(0,n.YH)(this,(function(n){switch(n.label){case 0:return[4,u.e(6720).then(u.bind(u,5492))];case 1:return n.sent().actionCompleteHandler(t,o),[2]}}))}))}}({getCurrentDocumentInfo:f,logger:Dn,webUrl:null!==(l=o.webUrl)&&void 0!==l?l:"",health:Mn}),tn=function(t){var e=this;return function(){return(0,n.sH)(e,void 0,void 0,(function(){return(0,n.YH)(this,(function(n){switch(n.label){case 0:return[4,u.e(6720).then(u.bind(u,5492))];case 1:return n.sent().openInBrowserHandler(t),[2]}}))}))}}({getCurrentDocumentInfo:f,logger:Dn,webUrl:null!==(c=o.webUrl)&&void 0!==c?c:"",health:Mn,correlationId:Zn}),en=function(t){var e=this;return function(o){return(0,n.sH)(e,void 0,void 0,(function(){return(0,n.YH)(this,(function(n){switch(n.label){case 0:return[4,u.e(6720).then(u.bind(u,5492))];case 1:return n.sent().openInMobileAppHandler(t,o),[2]}}))}))}}({getCurrentDocumentInfo:f,logger:Dn,openInMobileAppCallback:L,health:Mn,correlationId:Zn}),rn={appUrlPromise:d,container:U,fetchAccessToken:I,fetchItemFromNetwork:H,getCurrentDocumentInfo:f,host:null==M?void 0:M.uiHostName,health:Mn,logger:Dn,officeDocumentSession:r,wopiHostData:o,sessionConfig:A,uiHostConfig:M,initPackageParams:vn},un=null!=cn?cn:function(t){var e=this;return function(o){return(0,n.sH)(e,void 0,void 0,(function(){return(0,n.YH)(this,(function(n){switch(n.label){case 0:return[4,u.e(6720).then(u.bind(u,5492))];case 1:return[4,n.sent().moveToFolderFilePickerHandler(t,o)];case 2:return n.sent(),[2]}}))}))}}(rn),sn=null!=dn?dn:function(t){var e=this;return function(o){return(0,n.sH)(e,void 0,void 0,(function(){return(0,n.YH)(this,(function(n){switch(n.label){case 0:return[4,u.e(6720).then(u.bind(u,5492))];case 1:return[4,n.sent().commonPickerHandler(t,o)];case 2:return n.sent(),[2]}}))}))}}(rn),an=function(t){var e=this;return function(){return(0,n.sH)(e,void 0,void 0,(function(){return(0,n.YH)(this,(function(n){switch(n.label){case 0:return[4,u.e(6720).then(u.bind(u,5492))];case 1:return[4,n.sent().getCustomAuthConfigHandler(t)];case 2:return n.sent(),[2]}}))}))}}({customAuthConfigValue:null==A?void 0:A.customAuthConfigValue,getCurrentDocumentInfo:f,officeDocumentSession:r,appUrlPromise:d,logger:Dn,health:Mn}),pn=function(t){var e=this;return function(o){return(0,n.sH)(e,void 0,void 0,(function(){return(0,n.YH)(this,(function(n){switch(n.label){case 0:return[4,u.e(6720).then(u.bind(u,5492))];case 1:return n.sent().pushStateHandler(t,o),[2]}}))}))}}({getCurrentDocumentInfo:f,supportsPopAndPushState:null==M?void 0:M.supportsPopAndPushState,logger:Dn,sharingLinkTokenProvider:G,health:Mn}),bn=function(t){var e=this;return function(o){return(0,n.sH)(e,void 0,void 0,(function(){return(0,n.YH)(this,(function(n){switch(n.label){case 0:return[4,u.e(6720).then(u.bind(u,5492))];case 1:return n.sent().caaeMessageHandler(t,o),[2]}}))}))}}({getCurrentDocumentInfo:f,onCAAEMessage:$,health:Mn}),gn=function(t){var e=this,o=t.onAcquireOAuthTokenTeams;return function(t){return(0,n.sH)(e,void 0,void 0,(function(){return(0,n.YH)(this,(function(n){return console.log("AcquireOAuthTokenTeamsHandler"),o?(o(t.AuthUrl),[2]):[2]}))}))}}({getCurrentDocumentInfo:f,onAcquireOAuthTokenTeams:nn,health:Mn}),Sn=function(t){var e=this;return function(o){return(0,n.sH)(e,void 0,void 0,(function(){return(0,n.YH)(this,(function(n){switch(n.label){case 0:return[4,u.e(6720).then(u.bind(u,5492))];case 1:return n.sent().popStateCallback(t,o),[2]}}))}))}}({getCurrentDocumentInfo:f,appUrlPromise:d,logger:Dn,officeDocumentSession:r,health:Mn});!function(n){var t=n.onPopState;n.supportsPopAndPushState&&window.addEventListener("popstate",t)}({getCurrentDocumentInfo:f,onPopState:Sn,supportsPopAndPushState:null==M?void 0:M.supportsPopAndPushState,health:Mn});var Hn=function(t){var e=this;return function(o){return(0,n.sH)(e,void 0,void 0,(function(){return(0,n.YH)(this,(function(n){switch(n.label){case 0:return[4,u.e(6720).then(u.bind(u,5492))];case 1:return n.sent().frameChangedHandler(t,o),[2]}}))}))}}({getCurrentDocumentInfo:f,onFrameChange:hn,health:Mn});return{documentRebootHandler:h,renameHandler:p,sessionRefreshInfoHandler:m,shareHandler:w,userAccessHandler:b,userActivityHandler:g,createNewHandler:C,getAuthTokenHandler:y,sendConversationIdHandler:T,closeTeamsConversationHandler:P,navigateBackToHostHandler:k,accessibilityLoopCompleteHandler:D,getClientUrlCompleteHandler:O,getWebUrlCompleteHandler:K,loadingStatusHandler:j,wopiInfoFromUrlHandler:V,davUrlFromIdsHandler:q,onCloseHandler:function(){null==Dn||Dn.ULS.sendTraceTag(575545427,t.n.vo,e.k.Info,"Handle UI_Close post message from WAC. onCloseHandler exist: ".concat(R?"true":"false")),R&&R()},actionCompleteHandler:z,openInBrowserHandler:tn,openInMobileAppHandler:en,moveToFolderPickerHandler:un,commonFilePickerHandler:sn,getCustomAuthConfigHandler:an,pushStateHandler:pn,caaeMessageHandler:bn,frameChangedHandler:Hn,fileEmbedHandler:function(){wn&&wn()},dismissSplashScreenHandler:function(){var n=document.getElementById("splashscreen-container");n&&(n.style.display="none")},acquireOAuthTokenTeamsHandler:gn}},Jn=(null==vn?void 0:vn.jsApiUrlInfos)?null==vn?void 0:vn.jsApiUrlInfos:new Map;0===Jn.size&&Jn.set(h.p.Word,{jsApiUrl:null===(s=null==vn?void 0:vn.wordBootstrapperUrlInfo)||void 0===s?void 0:s.url,jsApiSri:null===(a=null==vn?void 0:vn.wordBootstrapperUrlInfo)||void 0===a?void 0:a.sri,jsApiBackupUrl:null===(l=null==vn?void 0:vn.wordBootstrapperUrlInfo)||void 0===l?void 0:l.url,PreloadedInBootStrapper:null===(w=null==vn?void 0:vn.wordBootstrapperUrlInfo)||void 0===w?void 0:w.wordJsApiPreloadedInBootStrapper});var qn,zn=(0,z.Az)(S,kn,H,M,A,k,!1,D,(function(n,t,e,o){qn=n;var i=new p.t(e),r=Gn(t,i,o),u=r.documentRebootHandler,s=r.renameHandler,a=r.sessionRefreshInfoHandler,l=r.shareHandler,c=r.userAccessHandler,d=r.userActivityHandler,f=r.createNewHandler,v=r.getAuthTokenHandler,h=r.sendConversationIdHandler,m=r.closeTeamsConversationHandler,w=r.navigateBackToHostHandler,b=r.accessibilityLoopCompleteHandler,g=r.getClientUrlCompleteHandler,S=r.getWebUrlCompleteHandler,H=r.loadingStatusHandler,C=r.wopiInfoFromUrlHandler,I=r.davUrlFromIdsHandler,A=r.onCloseHandler,y=r.actionCompleteHandler,U=r.openInBrowserHandler,T=r.openInMobileAppHandler,P=r.moveToFolderPickerHandler,k=r.commonFilePickerHandler,N=r.getCustomAuthConfigHandler,E=r.pushStateHandler,W=r.caaeMessageHandler,F=r.frameChangedHandler,R=r.fileEmbedHandler,j=r.dismissSplashScreenHandler,_=r.acquireOAuthTokenTeamsHandler,B=(0,on.SI)(on.dT.FeatureGate_UseNewEuplReporting,null==M?void 0:M.featureGates);Bn=function(n){var t=n.data;switch(n.type){case V.Reboot:u(t);break;case V.FileRenamed:s(t);break;case V.UserAccessAndPermissions:c(t);break;case V.Share:l(t);break;case V.UserActivity:d(t);break;case V.CreateNewDocument:f(t);break;case V.RefreshSessionInfo:a(t);break;case V.GetAuthToken:v(t);break;case V.AccessibilityLoopCompleted:b(t);break;case V.AcquireOAuthTokenTeams:_(t);break;case V.GetClientUrlComplete:g(t);break;case V.LoadingStatus:H(t);break;case V.GetWebUrlComplete:S(t);break;case V.NavigateBackToHost:w(t);break;case V.SendConversationId:h(t);break;case V.CloseTeamsConversation:m(t);break;case V.GetWopiInfoFromUrl:C(t);break;case V.Close:A();break;case V.ActionCompleted:y(t);break;case V.OpenInBrowser:U(t);break;case V.OpenInMobileApp:T(t);break;case V.MoveToFolder:P(t);break;case V.SharedFilePicker:k(t);break;case V.GetCustomAuthConfig:N(t);break;case V.GetDavUrlFromIds:I(t);break;case V.PushState:E(t);break;case V.CAAEMessage:W(t);break;case V.FrameChanged:F(t);break;case V.FileEmbed:R();break;case V.InitEnd:B&&(null==D||D(B));break;case V.SplashScreenShown:B&&(null==O||O()),j()}},qn.addEventListener(Bn)}),xn,Jn,In),Zn=zn.correlationId,Qn=zn.bootstrapperObservable,Xn=zn.fileNamePromise,Yn=zn.applicationUrlPromise;null==Dn||Dn.ULS.sendTraceTag(546182048,t.n.vo,e.k.Info,"BootApp: Load document returned"),Xn.then((function(n){return null==T?void 0:T(n)})).catch((function(){return"obligatory catch"}));var $n,nt=void 0,tt=void 0,et=void 0,ot=void 0,it=new en.Z(Dn),rt=new en.Z(Dn),ut=new m.B7,st=function(n){(0,Q.Q)(X.Ph.PostMessage_HostSendConversationId,{conversationId:n},Yn,nt,Dn)},at=function(n){var i=(0,o.u_)(),r=(0,o.Wv)();Un.PostWacTokenStartTime=Tn.PostWacTokenStartTime=i,Un.PostWacTokenAttempted=Tn.PostWacTokenAttempted=!0,null==Mn||Mn.recordKpiUsage(Y.ex.qo,v.v.SuccessBased,Y.S2.FC_Owl,void 0),null==Dn||Dn.ULS.sendTraceTag(507597022,t.n.vo,e.k.Important,"postWacToken flow initiated"),Ln&&(null==Dn||Dn.ULS.sendTraceTag(507377673,t.n.vo,e.k.Warning,"Calling postWacToken after usage telemetry has been logged")),Promise.race([it,rt]).then((function(u){u.run?(null==Dn||Dn.ULS.sendTraceTag(507597021,t.n.vo,e.k.Info,"officeDocSession created after ".concat((0,o.u_)()-i," ms")),u.run(f.Y.postWacToken,{wacToken:n,postWacTokenStart:r}).then((function(n){Tn.PostWacTokenResult=n.completion,Tn.PostWacTokenEndTime=(0,o.u_)(),n.data&&void 0!==n.data.TokenAlreadySet&&(Tn.TokenAlreadySet=n.data.TokenAlreadySet),yn.resolve(tn.Completed)})).catch((function(n){Tn.PostWacTokenResult="Unexpected JSAPI V2 error",Tn.PostWacTokenEndTime=(0,o.u_)(),null==Dn||Dn.ULS.sendTraceTag(507852515,t.n.vo,e.k.Warning,"Caught error running postWacToken flow: ".concat(n)),yn.resolve(tn.Completed)}))):u.PostWacToken?(null==Dn||Dn.ULS.sendTraceTag(507597020,t.n.vo,e.k.Info,"wopiPending created after ".concat((0,o.u_)()-i," ms")),Tn.flush=function(){yn.resolve(tn.Completed)},u.PostWacToken(n,r,Tn)):(Tn.PostWacTokenResult="Unexpected OWL error",Tn.PostWacTokenEndTime=(0,o.u_)(),null==Dn||Dn.ULS.sendTraceTag(507852514,t.n.vo,e.k.Warning,"postWacToken: WopiPending or OfficeDocumentSession is not defined. This should never happen, the catch callback should be hit instead."),yn.resolve(tn.Completed))})).catch((function(){Tn.PostWacTokenResult="Error occurred instantiating JSAPI session in OWL",Tn.PostWacTokenEndTime=(0,o.u_)(),null==Dn||Dn.ULS.sendTraceTag(507852513,t.n.vo,e.k.Warning,"Neither JSAPI v1 or v2 applications were created"),yn.resolve(tn.Completed)}))};return et=function(n,t,e){return n.pipe(j((function(n){return n({container:t,flushTime:e})}),void 0,1))}(Qn,U,g).subscribe((function(i){var r=i.officeApplication,u=i.bootedDocumentInfo,s=i.wopiHostData,a=i.wopiPendingApp,l=i.officeDocumentSession,c=i.wacBootDiagnostics;if(qn=r,tt=a,nt=l)it.resolve(nt);else if(tt)rt.resolve(tt);else{var d="No session found";it.reject(d),rt.reject(d)}var f=(0,on.SI)(on.dT.FeatureGate_OwlPostWacTokenForTeamsHosts,null==M?void 0:M.featureGates);f&&!un.Q5&&En&&(Dn.ULS.sendTraceTag(507347490,t.n.vo,e.k.Important,"WAC token posted after jsapi boot use postWacToken method"),null==Mn||Mn.recordKpiSuccess(Y.ex.Ro,{extendedProperties:new Map([["scenario","postWacTokenAfterBoot"]])}),null==En||En.then((function(n){at(n)})).catch((function(n){Dn.ULS.sendTraceTag(507347290,t.n.vo,e.k.Error,"WAC token atempted to be posted after jsapi boot using postWacToken method, but failed: ".concat(n))}))),f&&(0,un.r$)();var v=y(window,"message").pipe(K((function(n){return!!n.data&&!!n.origin&&n.origin.endsWith(bn)})),C((function(n){return JSON.parse(n.data)})),K((function(n){return!(!n||!n.MessageId)})));if(!_n){var p=Gn(s,u,l),m=p.documentRebootHandler,w=p.renameHandler,g=p.sessionRefreshInfoHandler,H=p.shareHandler,I=p.userAccessHandler,U=p.userActivityHandler,T=p.createNewHandler,k=p.getAuthTokenHandler,N=p.sendConversationIdHandler,E=p.closeTeamsConversationHandler,W=p.navigateBackToHostHandler,F=p.accessibilityLoopCompleteHandler,R=p.getClientUrlCompleteHandler,D=p.getWebUrlCompleteHandler,O=p.loadingStatusHandler,j=p.wopiInfoFromUrlHandler,_=p.davUrlFromIdsHandler,B=p.onCloseHandler,x=p.actionCompleteHandler,L=p.openInBrowserHandler,V=p.moveToFolderPickerHandler,G=p.commonFilePickerHandler,J=p.getCustomAuthConfigHandler,q=p.pushStateHandler,z=p.caaeMessageHandler,Z=p.fileEmbedHandler,Q=p.acquireOAuthTokenTeamsHandler;Kn=[[X.bi.PostMessage_SendConversationId,N],[X.bi.PostMessage_CloseTeamsConversation,E],[X.bi.PostMessage_NavigateBackToHost,W],[X.bi.PostMessage_AccessibilityLoopComplete,F],[X.bi.PostMessage_GetClientUrlComplete,R],[X.bi.PostMessage_GetWebUrlComplete,D],[X.bi.PostMessage_LoadingStatus,O],[X.O5.Event_DocumentReboot,m],[X.bi.PostMessage_FileRenamed,w],[X.bi.PostMessage_CheckUserAccess,I],[X.bi.PostMessage_Share,H],[X.bi.PostMessage_UserActivity,U],[X.bi.PostMessage_AppCreateNewDocument,T],[X.bi.PostMessage_OpenInBrowser,L],[X.O5.Event_MoveToFolder,V],[X.O5.Event_SharedFilePicker,G],[X.O5.Event_GetCustomAuthConfig,J],[X.bi.PostMessage_CAAEMessage,z],[X.bi.PostMessage_AcquireOAuthTokenTeams,Q]],S.fileType===h.p.Excel&&(Kn.push([X.O5.Event_GetWopiInfoFromUrl,j]),Kn.push([X.O5.Event_GetDavUrlFromIds,_])),Kn.forEach((function(t){var e=(0,n.zs)(t,2),o=e[0],i=e[1];r.RegisterEventHandler(o,i)})),ot=v.subscribe((function(n){switch(n.MessageId){case X.bi.PostMessage_AppRefreshSessionInfo:g(n.Values);break;case X.bi.PostMessage_GetAuthToken:k(n.Values);break;case X.bi.PostMessage_Close:B();break;case X.bi.PostMessage_ActionComplete:x(n.Values);break;case X.bi.PostMessage_AppPushState:q(n.Values);break;case X.bi.PostMessage_FileEmbed:Z()}}))}if(P){null==Dn||Dn.ULS.sendTraceTag(546182049,t.n.vo,e.k.Info,"BootApp: About to execute OnBootComplete"),(0,o.l8)(sn.ls.OwlOnBootComplete);var $=(0,sn.nC)((0,sn.nu)("owl"));if(null==Dn||Dn.ULS.sendTraceTag(508568928,t.n.vo,e.k.Important,"FileType: ".concat(S.fileType,", Environment: ").concat(A.wiseEnvironment,", Feature Gates: ").concat((null==M?void 0:M.featureGates)?(0,an.c)(null==M?void 0:M.featureGates):"{}",", UiHost: ").concat(null==M?void 0:M.uiHostName,", Integration Type: ").concat(null==M?void 0:M.uiHostIntegrationType,", OwlTraditional Telemetry Data: ").concat(JSON.stringify($))),"PRODUCTION"===A.wiseEnvironment){var nn=(0,on.SI)(on.dT.FeatureGate_EnableJsapiTags,null==M?void 0:M.featureGates);setTimeout((function(){return(0,n.sH)(b,void 0,void 0,(function(){var t,e;return(0,n.YH)(this,(function(n){return t=document.createElement("div"),document.body.appendChild(t),pn(t,S.fileType,Dn,nn),e=setInterval((function(){pn(t,S.fileType,Dn,nn)}),18e5),An.push(e),[2]}))}))}),3e4)}null==Mn||Mn.recordKpiSuccess(Y.ex.Jo),P(S,c)}}),(function(n){k&&(null==Dn||Dn.ULS.sendTraceTag(546182050,t.n.vo,e.k.Info,"BootApp: About to execute OnBootFailure"),null==Mn||Mn.recordKpiFailure(Y.ex.Jo,n.errorName,!0,!1,{extendedProperties:new Map([["errorMessage",n.errorMessage],["wacErrorName",n.wacErrorName],["qosErrorName",n.qosErrorName]])}),k(n)),null==et||et.unsubscribe(),null==ot||ot.unsubscribe()})),{endSession:Vn,sessionEndObservable:ut.asObservable(),hostAccessibilityLoopComplete:function(n){return(0,Q.Q)(X.Ph.PostMessage_HostAccessibilityLoopComplete,{Direction:n?"forward":"backward"},Yn,nt,Dn),!0},hostGetClientUrl:function(){(0,Q.Q)(X.Ph.PostMessage_HostGetClientUrl,{},Yn,nt,Dn)},hostGetWebUrl:function(){(0,Q.Q)(X.Ph.PostMessage_HostGetWebUrl,{},Yn,nt,Dn)},hostBackButtonPressed:function(){return(0,Q.Q)(X.Ph.PostMessage_HostBackButtonPressed,{},Yn,nt,Dn),!0},hostSendConversationId:st,postWacToken:at,completeCreateNew:function(n){rn.W.sessionPromise.then((function(o){o?o.run(f.Y.completeCreateNew,n).then((function(n){return rn.W.completeCreateNew(n)})).catch((function(n){Dn.ULS.sendTraceTag(507778315,t.n.vo,e.k.Warning,"Caught error running completeCreateNew flow: ".concat(n)),rn.W.failCreateNew(n)})):(Dn.ULS.sendTraceTag(507778314,t.n.vo,e.k.Warning,"Attempting to run completeCreateNew flow without an OfficeDocumentSession."),rn.W.failCreateNew(new Error("session is undefined")))})).catch((function(n){Dn.ULS.sendTraceTag(507331607,t.n.vo,e.k.Error,"Encountered error in completeCreateNew: ".concat(n))}))}}}var kn=u(8790);var Nn,En,Wn,Fn,Rn,Dn,On,jn=u(2394),Mn=u(4056),_n=new en.Z,Bn="owl-container",xn=new en.Z,Ln=!1;function Kn(n){var t,e,o;if(!(null===(t=null==n?void 0:n.clientVersion)||void 0===t?void 0:t.trim()))throw new Error("invalid clientVersion");if(!n.exposure||n.exposure<=0||n.exposure>100)throw new Error("invalid exposure ("+(null!==(e=n.exposure)&&void 0!==e?e:"undefined")+")");n.wiseEnvironment=null===(o=n.wiseEnvironment)||void 0===o?void 0:o.toLocaleUpperCase(),Nn=n}function Vn(n,t){var e=document.createElement("div");return e.id=t,n.appendChild(e)}function Gn(n){Wn?Wn(n):xn.then((function(t){return t(n)})).catch((function(n){return null==Fn?void 0:Fn.ULS.sendTraceTag(507331606,t.n.vo,e.k.Error,"createNewComplete encountered error: ".concat(n))}))}function Jn(u){var s,l,c,d=(0,o.u_)();(0,o.l8)(sn.ls.OwlWithCustomFunctionsStart),function(){var n;!((null===(n=window.performance.getEntriesByName(sn.ls.OwlHostTimeOrigin))||void 0===n?void 0:n.length)>0)&&window.performance.mark(sn.ls.OwlHostTimeOrigin,{startTime:0,detail:window.performance.timeOrigin})}(),On=null!==(s=null!=On?On:null==Nn?void 0:Nn.wiseEnvironment)&&void 0!==s?s:u.sessionConfig.wiseEnvironment;var f=function(){return{Hidden:document.hidden,VisibilityState:document.visibilityState,HasFocus:document.hasFocus(),Timestamp:(0,o.u_)()}},v=[f()];window.addEventListener("visibilitychange",(function(){return v.push(f())})),window.addEventListener("focus",(function(){return v.push(f())})),window.addEventListener("blur",(function(){return v.push(f())})),Un.BootAttempted=!0,Un.Environment=Tn.Environment=On,Un.Application=Tn.Application=u.documentBootInfo.fileType,Un.BootStartTime=Tn.BootStartTime=(0,o.u_)(),Un.StateEvents=Tn.StateEvents=v,u.uiHostConfig&&(u.uiHostConfig.uiHostName&&(Un.UiHost=Tn.UiHost=u.uiHostConfig.uiHostName),u.uiHostConfig.uiHostIntegrationType&&(Un.UiHostIntegrationType=Tn.UiHostIntegrationType=u.uiHostConfig.uiHostIntegrationType)),u.sessionConfig&&(u.sessionConfig.hostCorrelationId&&(Un.HostCorrelationId=Tn.HostCorrelationId=u.sessionConfig.hostCorrelationId),Un.IsAnonymous=Tn.IsAnonymous=!!u.sessionConfig.isAnonymous,Un.IsSynthetic=Tn.IsSynthetic=!!u.sessionConfig.isSynthetic),u.sessionConfig.sessionId=null!==(l=u.sessionConfig.sessionId)&&void 0!==l?l:(0,i.O)()[0],u.sessionConfig.owlRollout="".concat(On,".").concat(null==Nn?void 0:Nn.exposure),u.sessionConfig.owlVersion=null==Nn?void 0:Nn.clientVersion;var h=!!u.sessionConfig.health;!function(n,o,i,r){var u,s;if(n.sessionConfig.logger||(n.sessionConfig.logger=new kn.hK(r,i).logger),!n.sessionConfig.health){var a=null!=o?o:{},l=a.exposure,c=a.clientVersion,d=null!==(u=n.sessionConfig.bootDiagnostics)&&void 0!==u?u:{},f=d.ringId,v=d.isOdcMigrated,h=null!==(s=n.uiHostConfig)&&void 0!==s?s:{},p=h.uiHostName,m=h.uiHostIntegrationType;n.sessionConfig.health=function(n,o,i,r,u,s,a,l,c,d,f,v,h,p,m,w,b){var g=new kn.R7(n,i,o,c,l,d,r,u,s,f,v,h).health;if(g)return g.addOrUpdatePartCDimension("HostCorrelationId",a),g.addOrUpdatePartCDimension("AppSessionId",n),g.addOrUpdatePartCDimension("HostRingId",null!=p?p:"n/a"),g.addOrUpdatePartCDimension("IsNewFile",(!!m).toString()),g.addOrUpdatePartCDimension("isOdcMigrated",(!!w).toString()),g.addOrUpdatePartCDimension("IsTestMode",window.location.pathname.endsWith("/test").toString()),g.addQosPillar("Open"),g;null==b||b.ULS.sendTraceTag(507340064,t.n.vo,e.k.Warning,"Failed to initialize health logger.")}(r,i,n.documentBootInfo.fileType,n.documentBootInfo.uiCulture,n.documentBootInfo.puid,n.sessionConfig.tenantId,n.sessionConfig.hostCorrelationId,l,c,n.sessionConfig.isSynthetic,p,m,n.documentBootInfo.wdOrigin,f,n.documentBootInfo.isNewFile,v)}}(u,Nn,On,u.sessionConfig.sessionId),h||(Rn=u.sessionConfig.health),Fn||(Fn=u.sessionConfig.logger),function(n,o){var i=n.onBootComplete,r=n.onBootFailure,u=function(n){Ln?null==o||o.ULS.sendTraceTag(507540254,t.n.vo,e.k.Warning,"Calling success or failure callback after another callback has already been called. Calling ".concat(n)):(null==o||o.ULS.sendTraceTag(507540255,t.n.vo,e.k.Important,JSON.stringify(Un)),Ln=!0,Un={BootAttempted:!1,BootSucceeded:!1,PostWacTokenAttempted:!1})};n.onBootComplete=function(n,t){Un.BootSucceeded=Tn.BootSucceeded=!0,u("onBootComplete"),_n.resolve(!0),i&&i(n,t)},n.onBootFailure=function(n,t){Tn.BootSucceeded=!1,u("onBootFailure"),_n.resolve(!1),r&&r(n,t)}}(u,Fn),function(n){var i=Promise.all([_n,yn]).then((function(n){return n[1]})),r=new Promise((function(n){return window.addEventListener("beforeunload",(function(t){return n(tn.Unloaded)}))})),u=new Promise((function(n){return setTimeout((function(){return n(tn.Timeout)}),In)}));Promise.race([i,r,u]).then((function(i){var r=i===tn.Unloaded;Tn.PostWacTokenLoggerFlushTime=(0,o.u_)(),Tn.Unloaded=r,Tn.flush&&delete Tn.flush,n&&(n.ULS.sendTraceTag(507540257,t.n.vo,e.k.Important,JSON.stringify(Tn)),r?n.ULS.flushOnClose():n.ULS.flush()),Tn={}})).catch((function(){n&&n.ULS.sendTraceTag(507540256,t.n.vo,e.k.Warning,"Failed to log PostWacTokenTelemetry")}))}(Fn),function(n,t){var e,o,i,r,u,s,a;n.sessionConfig.bootDiagnostics=n.sessionConfig.bootDiagnostics||{},n.sessionConfig.bootDiagnostics.packageEntryTime=n.sessionConfig.bootDiagnostics.packageEntryTime||t,n.sessionConfig.bootDiagnostics.perfNavigationTiming=n.sessionConfig.bootDiagnostics.perfNavigationTiming||(0,kn.Ip)(),n.sessionConfig.bootDiagnostics.perfOwlTiming=n.sessionConfig.bootDiagnostics.perfOwlTiming||(0,kn.wR)(),n.sessionConfig.bootDiagnostics.loadManifestStartTime=n.sessionConfig.bootDiagnostics.loadManifestStartTime||(null===(e=null==Nn?void 0:Nn.owlBootstrapperDiagnostics)||void 0===e?void 0:e.loadManifestStartTime)||0,n.sessionConfig.bootDiagnostics.loadManifestEndTime=n.sessionConfig.bootDiagnostics.loadManifestEndTime||(null===(o=null==Nn?void 0:Nn.owlBootstrapperDiagnostics)||void 0===o?void 0:o.loadManifestEndTime)||(null===(i=null==Nn?void 0:Nn.owlBootstrapperDiagnostics)||void 0===i?void 0:i.getManifestFromRemoteTimeElapsed),n.sessionConfig.bootDiagnostics.getManifestFromRemoteTimeElapsed=n.sessionConfig.bootDiagnostics.getManifestFromRemoteTimeElapsed||(null===(r=null==Nn?void 0:Nn.owlBootstrapperDiagnostics)||void 0===r?void 0:r.getManifestFromRemoteTimeElapsed),n.sessionConfig.bootDiagnostics.loadManifestServerTimeElapsed=n.sessionConfig.bootDiagnostics.loadManifestServerTimeElapsed||(null===(u=null==Nn?void 0:Nn.owlBootstrapperDiagnostics)||void 0===u?void 0:u.loadManifestServerTimeElapsed),n.sessionConfig.bootDiagnostics.loadOwlStartTime=n.sessionConfig.bootDiagnostics.loadOwlStartTime||(null===(s=null==Nn?void 0:Nn.owlBootstrapperDiagnostics)||void 0===s?void 0:s.loadOwlStartTime),n.sessionConfig.bootDiagnostics.loadOwlEndTime=n.sessionConfig.bootDiagnostics.loadOwlEndTime||(null===(a=null==Nn?void 0:Nn.owlBootstrapperDiagnostics)||void 0===a?void 0:a.loadOwlEndTime)}(u,d);var p=u.container;Dn=function(n){var t;return null!==(t=document.getElementById(Bn))&&void 0!==t?t:Vn(n,Bn)}(u.container),u.container=Dn;var m,w,b=(m=u.documentBootInfo,(w=(0,r.x9)(m))&&a.L?a.L.getItem(w):null),g=u.sessionConfig.sessionId===b,S=u.onBootFailure;u.onBootFailure=function(n,t){var e,i;if(null==Rn||Rn.recordQosError(n.qosErrorName,["UnifiedUiHostBootstrappingFailed"],(0,jn.yC)(n),(0,jn.wA)(n.wacErrorName),!0,!0,{inStaging:null===(e=n.inStaging)||void 0===e||e,extendedProperties:(0,Mn.C)(n)}),g){var r=new Map;r.set("FailureTime",(new Date).toUTCString()),r.set("Error",n.error),t&&r.set("DocumentBootInfo",JSON.stringify(t)),n.httpErrorCode&&r.set("HttpErrorCode",n.httpErrorCode),null==Rn||Rn.recordKpiFailure(Y.ex.Zo,"PrebootDocumentOpenFailed",!1,!0,{durationMs:(0,o.u_)()-((null===(i=u.sessionConfig.bootDiagnostics)||void 0===i?void 0:i.packageEntryTime)||d),extendedProperties:r})}S&&S(n,t),null==Rn||Rn.shutdown()};var H=(0,n.Cl)((0,n.Cl)({},u),{initPackageParams:Nn});(null!==(c=H.initializeTwoStepCreateNew)&&void 0!==c?c:rn.d)(H,Fn);var C=Pn(H);C.endSession,C.hostAccessibilityLoopComplete,C.hostGetClientUrl,C.hostGetWebUrl,C.hostBackButtonPressed,Wn=C.completeCreateNew,xn.resolve(Wn);var I=function(t){var e=t.subscribe((function(t){var r,s;if(t&&(null===(r=u.uiHostConfig)||void 0===r?void 0:r.supportsInternalReboot)){var a=(0,n.zs)((0,i.O)(),1)[0],l=new kn.hK(a,On);u.sessionConfig.sessionId=l.sessionId,u.sessionConfig.logger=l.logger,u.sessionConfig.bootDiagnostics=(s=u.sessionConfig.bootDiagnostics,{tabsCacheHit:!0,packageEntryTime:(0,o.u_)(),isTestMode:null==s?void 0:s.isTestMode,isPrebooted:!1,ringId:null==s?void 0:s.ringId,teamsContextStartTime:0,teamsContextEndTime:0,perfNavigationTiming:(0,kn.Ip)(),meetingLiveDiagnostics:void 0,perfOwlTiming:(0,kn.wR)()}),u.sessionConfig.highContrastMode=t.theme,p&&Dn&&Dn.parentNode===p&&p.removeChild(Dn),Dn=Vn(p,Bn);var c=Pn((0,n.Cl)((0,n.Cl)({},u),{container:Dn,documentBootInfo:t.documentBootInfo,initPackageParams:Nn}));c.endSession,c.hostAccessibilityLoopComplete,c.hostGetClientUrl,c.hostGetWebUrl,c.hostBackButtonPressed,Wn=c.completeCreateNew,xn.resolve(Wn),e.unsubscribe(),I(c.sessionEndObservable)}else p&&Dn&&Dn.parentNode===p&&p.removeChild(Dn),e.unsubscribe();null==Rn||Rn.shutdown()}))};return I(C.sessionEndObservable),(0,o.l8)([sn.ls.OwlEnd,sn.ls.OwlWithCustomFunctionsEnd]),C}u.nc=window.nonce}(),((Microsoft=void 0===Microsoft?{}:Microsoft).Office=Microsoft.Office||{}).OWL=s}();